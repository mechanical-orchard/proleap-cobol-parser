000100******************************************************************        
000200 IDENTIFICATION DIVISION.                                                 
000300******************************************************************        
000400                                                                          
000500 PROGRAM-ID. TRKUP225.                                                    
000600 AUTHOR.     ALICE EBERT * MARGARET MORRISON * THERESE RAMSEYER.          
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                                   
000800 DATE-WRITTEN. MAY 1998.                                                  
000900 DATE-COMPILED.                                                           
001000                                                                          
001100******************************************************************        
001200*                                                                *        
001300*                                                                *        
001400*                                                                *        
001500******************************************************************        
001600* 10/31/03  TKMA643                                                       
001700*              CHANGED TO GET IMPRT VENDOR NAME AND IMPRT FCTRY           
001800*              NAME FROM 'TENTNME' INSTEAD OF 'TPURCHS'.                  
001600* 08/15/22  JEAN KURK                    CHG0272895                       
001700*             REMOVE TABLES TIMRCUP, TIMRCVS, TAURCUP, TAURCVS,           
001800*             TENTNME, XLT_SKU, XLT_VND_STYL                              
001900*****************************************************************         
002000******************************************************************        
002100 ENVIRONMENT DIVISION.                                                    
002200******************************************************************        
002300                                                                          
002400 CONFIGURATION SECTION.                                                   
002500                                                                          
002600 SOURCE-COMPUTER.        IBM-3090.                                        
002700 OBJECT-COMPUTER.        IBM-3090.                                        
002800                                                                          
002900 INPUT-OUTPUT SECTION.                                                    
003000                                                                          
003100 FILE-CONTROL.                                                            
003200                                                                          
003300     SELECT TR025-RECEIVING-FILE                                          
003400         ASSIGN TO INP01.                                                 
003500                                                                          
003600******************************************************************        
003700 DATA DIVISION.                                                           
003800******************************************************************        
003900                                                                          
004000 FILE SECTION.                                                            
004100                                                                          
004200 FD  TR025-RECEIVING-FILE                                                 
004300     RECORDING MODE IS F                                                  
004400     LABEL RECORDS ARE STANDARD                                           
004500     BLOCK CONTAINS 0 RECORDS.                                            
004600                                                                          
004700 01  TR025-RECEIVING-RECORD          PIC X(300).                          
004800                                                                          
004900******************************************************************        
005000 WORKING-STORAGE SECTION.                                                 
005100******************************************************************        
005200                                                                          
005300******************************************************************        
005400*  DB2 FORMATTED MESSAGE AREA                                             
005500******************************************************************        
005600     COPY DPWS004.                                                        
005700                                                                          
005800******************************************************************        
005900*  COMMUNICATIONS AREA FOR DB2                                            
006000******************************************************************        
006100     EXEC SQL                                                             
006200          INCLUDE SQLCA                                                   
006300     END-EXEC.                                                            
006400                                                                          
006500******************************************************************        
006600*  DB2 TABLE DECLARATION - LOGISTICS DOMAIN ITEM TABLE                    
006700*      (XLT00003)                                                         
006800******************************************************************        
006900*    EXEC SQL                                                             
007000*         INCLUDE XLT00003                                                
007100*    END-EXEC.                                                            
007200                                                                          
007300******************************************************************        
007400*  DB2 TABLE DECLARATION - LOGISTICS DOMAIN ITEM TABLE                    
007500*      (XLT00004)                                                         
007600******************************************************************        
007700*    EXEC SQL                                                             
007800*         INCLUDE XLT00004                                                
007900*    END-EXEC.                                                            
008000                                                                          
008100******************************************************************        
008200*  DB2 TABLE DECLARATION - IMPORT PURCHASE ORDER RECEIVING ORIGIN         
008300*                          TABLE.                                         
008400*      (TIMRCPO)                                                          
008500******************************************************************        
008600     EXEC SQL                                                             
008700          INCLUDE TIMRCPO                                                 
008800     END-EXEC.                                                            
008900                                                                          
009000                                                                          
009100 01  WORK-AREA-TIMRCPO.                                                   
009200      10 W-IMRCPO-PO-NBR              PIC  S9(9) COMP.                    
009300      10 W-IMRCPO-PO-RCVD-SEQ-NBR     PIC  S9(4) COMP.                    
009400      10 W-IMRCPO-PO-RCVD-DELY-TMST   PIC  X(26).                         
009500      10 FILLER      REDEFINES W-IMRCPO-PO-RCVD-DELY-TMST.                
009600         15 W-IMRCPO-PO-RCVD-DELY-DTE    PIC   X(10).                     
009700         15 FILLER                       PIC   X(16).                     
009800      10 W-IMRCPO-EXTL-REF-NBR        PIC   X(15).                        
009900      10 W-IMRCPO-ORGN-SHPD-FR-CDE    PIC   X(3).                         
010000******************************************************************        
010100*  DB2 TABLE DECLARATION - IMPORT VENDOR STYLE RECEIVING ORIGIN           
010200*                          TABLE.                                         
010300*      (TIMRCVS)                                                          
010400******************************************************************        
010500*    EXEC SQL                                                             
010600*         INCLUDE TIMRCVS                                                 
010700*    END-EXEC.                                                            
010800                                                                          
010900******************************************************************        
011000*  DB2 TABLE DECLARATION - IMPORT UPC RECEIVING ORIGIN TABLE.             
011100*      (TIMRCUP)                                                          
011200******************************************************************        
011300*    EXEC SQL                                                             
011400*         INCLUDE TIMRCUP                                                 
011500*    END-EXEC.                                                            
011600                                                                          
011700******************************************************************        
011800*  DB2 TABLE DECLARATION - IMPORT PURCHASE ORDER RECEIVING ORIGIN         
011900*                          AUDIT TABLE.                                   
012000*      (TAURCPO)                                                          
012100******************************************************************        
012200     EXEC SQL                                                             
012300          INCLUDE TAURCPO                                                 
012400     END-EXEC.                                                            
012500                                                                          
012600******************************************************************        
012700*  DB2 TABLE DECLARATION - IMPORT VENDOR STYLE RECEIVING ORIGIN           
012800*                          AUDIT TABLE.                                   
012900*      (TAURCVS)                                                          
013000******************************************************************        
013100*    EXEC SQL                                                             
013200*         INCLUDE TAURCVS                                                 
013300*    END-EXEC.                                                            
013400                                                                          
013500******************************************************************        
013600*  DB2 TABLE DECLARATION - IMPORT UPC RECEIVING ORIGIN AUDIT TABLE        
013700*      (TAURCUP)                                                          
013800******************************************************************        
013900*    EXEC SQL                                                             
014000*         INCLUDE TAURCUP                                                 
014100*    END-EXEC.                                                            
014200                                                                          
014300******************************************************************        
014400*  DB2 TABLE DECLARATION - PURCHASE ORDER TABLE.                          
014500*      (TPURCHS)                                                          
014600******************************************************************        
014700     EXEC SQL                                                             
014800          INCLUDE TPURCHS                                                 
014900     END-EXEC.                                                            
015000                                                                          
015100******************************************************************        
015200*  DB2 TABLE DECLARATION - PURCHASE ORDER LINE TABLE.                     
015300*      (TPURITM)                                                          
015400******************************************************************        
015500*    EXEC SQL                                                             
015600*         INCLUDE TPURITM                                                 
015700*    END-EXEC.                                                            
015800                                                                          
015900******************************************************************        
016000*  DB2 TABLE DECLARATION - IMPORT PORT OF ENTRY TABLE.                    
016100*      (TIMPOE)                                                           
016200******************************************************************        
016300*    EXEC SQL                                                             
016400*         INCLUDE TIMPOE                                                  
016500*    END-EXEC.                                                            
016600                                                                          
016700******************************************************************        
016800*  DB2 TABLE DECLARATION - IMPORT FREE ON BOARD TABLE.                    
016900*      (TIMFOB)                                                           
017000******************************************************************        
017100     EXEC SQL                                                             
017200          INCLUDE TIMFOB                                                  
017300     END-EXEC.                                                            
017400                                                                          
017500******************************************************************        
017600*  DB2 TABLE DECLARATION - COUNTRY TABLE.                                 
017700*      (TCNTRY)                                                           
017800******************************************************************        
017900*    EXEC SQL                                                             
018000*         INCLUDE TCNTRY                                                  
018100*    END-EXEC.                                                            
018200                                                                          
018300******************************************************************        
018400*  DB2 TABLE DECLARATION - UPC SKU TABLE.                                 
018500*      (TUPCSKU)                                                          
018600******************************************************************        
018700*    EXEC SQL                                                             
018800*         INCLUDE TUPCSKU                                                 
018900*    END-EXEC.                                                            
019000                                                                          
019100******************************************************************        
019200*  DB2 TABLE DECLARATION - DETAIL AND ERROR REPORT WORK TABLE.            
019300*      (TOUTTR7)                                                          
019400******************************************************************        
019500     EXEC SQL                                                             
019600          INCLUDE TOUTTR7                                                 
019700     END-EXEC.                                                            
019800                                                                          
019900******************************************************************        
020000*  DB2 TABLE DECLARATION - TRUOBLE NOTIFICATION WORK TABLE.               
020100*      (TOUTTM1)                                                          
020200******************************************************************        
020300     EXEC SQL                                                             
020400          INCLUDE TOUTTM1                                                 
020500     END-EXEC.                                                            
020600                                                                          
020700******************************************************************        
020800*  DB2 TABLE DECLARATION - EXTERNAL ENTERPRISE NAME.                      
020900*      (TENTNME)                                                          
021000******************************************************************        
021100*    EXEC SQL                                                             
021200*         INCLUDE TENTNME                                                 
021300*    END-EXEC.                                                            
021400                                                                          
021500******************************************************************        
021600*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)        
021700*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT             
021800*  INTERVALS.                                                             
021900******************************************************************        
022000     EXEC SQL                                                             
022100         INCLUDE TCKRSTCN                                                 
022200     END-EXEC.                                                            
022300                                                                          
022400******************************************************************        
022500*  DB2 TABLE DECLARATION - CHECKPOINT RESTART         (TCKRSTINF)         
022600*  THIS TABLE IS BEING USED IN THIS PROGRAM TO CONTROL COMMIT             
022700*  INTERVALS.                                                             
022800******************************************************************        
022900     EXEC SQL                                                             
023000         INCLUDE TCKRSTIN                                                 
023100     END-EXEC.                                                            
023200                                                                          
023300******************************************************************        
023400*    IMPORT ORIGIN RECEIVING RECORD LAYOUT.                               
023500******************************************************************        
023600     COPY TRRD025.                                                        
023700 EJECT                                                                    
023800                                                                          
023900******************************************************************        
024000*        ORIGIN RECEIVING DETAIL/ERROR REPORT RECORD LAYOUT      *        
024100*            (EXTRACT FOR THE DETAIL AND ERROR REPORTS)          *        
024200*  IT IS USED TO FORMAT THE DETAIL AND ERROR RECORDS. THEY ARE   *        
024300*  THEN INSERTED TO TOUTTR7, A DB2 WORK TABLE.                   *        
024400*  LATER IT IS USED IN OTHER PROGRAMS TO CREATE A DETAIL REPORT  *        
024500*  AND AN ERROR REPORT OF RECEIVING RECORDS.                     *        
024600******************************************************************        
024700     COPY TRRD221.                                                        
024800 EJECT                                                                    
024900                                                                          
025000******************************************************************        
025100* COPYBOOK FOR TOUTTM1 WORK TABLE - TROUBLE NOTIFICATION EXTRACT          
025200******************************************************************        
025300     COPY TMRD606.                                                        
025400 EJECT                                                                    
025500*****************************************************************         
025600*    SUPPLY CHAIN MANAGEMENT MQ MESSAGE RECORD                            
025700*****************************************************************         
025800     COPY TRRD405.                                                        
025900                                                                          
026000 EJECT                                                                    
026100                                                                          
026200******************************************************************        
026300*  DB2 TABLE DECLARATION - SCM MQ SERIES MSG WORK TABLE                   
026400*      (TRTW_RCVG_CKPR)                                                   
026500******************************************************************        
026600     EXEC SQL                                                             
026700          INCLUDE TRT00042                                                
026800     END-EXEC.                                                            
026900 EJECT                                                                    
027000                                                                          
027100     COPY DPWS500.                                                        
027200 EJECT                                                                    
027300                                                                          
027400 01  ABEND-CODE                      PIC S9(04)    VALUE +0               
027500                                                   COMP SYNC.             
027600 01  PA-PROGRAM-ACCUMULATORS.                                             
027700     05  PA-TOTALS.                                                       
027800         10 PA-TOTAL-COMMITS          PIC  S9(13)  VALUE +0               
027900                                                     COMP-3.              
028000         10 PA-TOTAL-ISA-RECS-READ    PIC  S9(13)  VALUE +0               
028100                                                     COMP-3.              
028200         10 PA-TOTAL-RECS-LOADED      PIC  S9(13)  VALUE +0               
028300                                                     COMP-3.              
028400         10 PA-TOT-ERD-RECS-READ      PIC  S9(13)  VALUE +0               
028500                                                     COMP-3.              
028600         10 PA-TOT-ERDRSN-RECS-READ   PIC  S9(13)  VALUE +0               
028700                                                     COMP-3.              
028800         10 PA-TOT-LOG-RECS-READ      PIC  S9(13)  VALUE +0               
028900                                                     COMP-3.              
029000*        10 PA-TOT-LOGVS-RECS-READ    PIC  S9(13)  VALUE +0               
029100*                                                    COMP-3.              
029200*        10 PA-TOT-LOGUPC-RECS-READ   PIC  S9(13)  VALUE +0               
029300*                                                    COMP-3.              
029400         10 PA-TOT-BAD-REC-TYP        PIC  S9(13)  VALUE +0               
029500                                                     COMP-3.              
029600         10 PA-TOTAL-ERROR-COUNT      PIC  S9(13)  VALUE +0               
029700                                                     COMP-3.              
029800         10 PA-TOTAL-DETAIL-COUNT     PIC  S9(13)  VALUE +0               
029900                                                     COMP-3.              
030000         10 PA-TOT-TRN-TYP-A          PIC  S9(13)  VALUE +0               
030100                                                     COMP-3.              
030200         10 PA-TOT-TRN-TYP-B          PIC  S9(13)  VALUE +0               
030300                                                     COMP-3.              
030400         10 PA-TOT-TRN-TYP-C          PIC  S9(13)  VALUE +0               
030500                                                     COMP-3.              
030600         10 PA-TOT-TRN-TYP-D          PIC  S9(13)  VALUE +0               
030700                                                     COMP-3.              
030800         10 PA-TOT-BAD-TRN-TYP        PIC  S9(13)  VALUE +0               
030900                                                     COMP-3.              
031000         10 PA-TOT-RECS-INSERTED      PIC  S9(13)  VALUE +0               
031100                                                     COMP-3.              
031200         10 PA-TOT-RCPO-INSERTS       PIC  S9(13)  VALUE +0               
031300                                                     COMP-3.              
031400         10 PA-TOT-TOUTTM1-INSERTS    PIC  S9(13)  VALUE +0               
031500                                                     COMP-3.              
031600*        10 PA-TOT-RCVS-INSERTS       PIC  S9(13)  VALUE +0               
031700*                                                    COMP-3.              
031800*        10 PA-TOT-RCUPC-INSERTS      PIC  S9(13)  VALUE +0               
031900*                                                    COMP-3.              
032000         10 PA-TOT-RECS-AUDITED       PIC  S9(13)  VALUE +0               
032100                                                     COMP-3.              
032200         10 PA-TOT-RCPO-AUDITS        PIC  S9(13)  VALUE +0               
032300                                                     COMP-3.              
032400*        10 PA-TOT-RCVS-AUDITS        PIC  S9(13)  VALUE +0               
032500*                                                    COMP-3.              
032600*        10 PA-TOT-RCUPC-AUDITS       PIC  S9(13)  VALUE +0               
032700*                                                    COMP-3.              
032800         10 PA-TOT-RECS-DELETED       PIC  S9(13)  VALUE +0               
032900                                                     COMP-3.              
033000         10 PA-TOT-RCPO-DELETES       PIC  S9(13)  VALUE +0               
033100                                                     COMP-3.              
033200*        10 PA-TOT-RCVS-DELETES       PIC  S9(13)  VALUE +0               
033300*                                                    COMP-3.              
033400*        10 PA-TOT-RCUPC-DELETES      PIC  S9(13)  VALUE +0               
033500*                                                    COMP-3.              
033600         10 PA-TOT-RECS-CHANGED       PIC  S9(13)  VALUE +0               
033700                                                     COMP-3.              
033800         10 PA-TOT-RCPO-CHANGES       PIC  S9(13)  VALUE +0               
033900                                                     COMP-3.              
034000*        10 PA-TOT-RCVS-CHANGES       PIC  S9(13)  VALUE +0               
034100*                                                    COMP-3.              
034200*        10 PA-TOT-RCUP-CHANGES       PIC  S9(13)  VALUE +0               
034300*                                                    COMP-3.              
034400         10 PA-TOT-RECS-CHANGED-B     PIC  S9(13)  VALUE +0               
034500                                                     COMP-3.              
034600         10 PA-TOT-RCPO-CHANGES-B     PIC  S9(13)  VALUE +0               
034700                                                     COMP-3.              
034800*        10 PA-TOT-RCVS-CHANGES-B     PIC  S9(13)  VALUE +0               
034900*                                                    COMP-3.              
035000*        10 PA-TOT-RCUP-CHANGES-B     PIC  S9(13)  VALUE +0               
035100*                                                    COMP-3.              
035200         10 PA-TOT-RECS-CHANGED-Z     PIC  S9(13)  VALUE +0               
035300                                                     COMP-3.              
035400*        10 PA-TOT-RCVS-CHANGES-Z     PIC  S9(13)  VALUE +0               
035500*                                                    COMP-3.              
035600*        10 PA-TOT-RCUP-CHANGES-Z     PIC  S9(13)  VALUE +0               
035700*                                                    COMP-3.              
035800         10 PA-TOT-RECS-DELETED-E     PIC  S9(13)  VALUE +0               
035900                                                     COMP-3.              
036000*        10 PA-TOT-RCVS-DELETES-E     PIC  S9(13)  VALUE +0               
036100*                                                    COMP-3.              
036200*        10 PA-TOT-RCUP-DELETES-E     PIC  S9(13)  VALUE +0               
036300*                                                    COMP-3.              
036400                                                                          
036500 01  PS-PROGRAM-SWITCHES.                                                 
036600     05  PS-END-OF-INPUT-SW            PIC  X(01)    VALUE 'N'.           
036700         88  PS-END-OF-INPUT                         VALUE 'Y'.           
036800         88  PS-END-OF-INPUT-NO                      VALUE 'N'.           
036900     05  PS-EDIT-ERROR-SW              PIC  X(01)    VALUE 'N'.           
037000         88  PS-EDIT-ERROR                           VALUE 'Y'.           
037100         88  PS-EDIT-ERROR-NO                        VALUE 'N'.           
037200     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.           
037300         88  NORMAL-RUN                              VALUE '0'.           
037400         88  RESTART-RUN                             VALUE '9'.           
037500     05  PS-COMMITS-TAKEN-SW           PIC  X(01)    VALUE 'N'.           
037600         88  COMMITS-TAKEN                           VALUE 'T'.           
037700         88  NO-COMMITS-TAKEN                        VALUE 'N'.           
037800     05  PS-SAME-COMMIT-FIELDS-SW      PIC  X(01)    VALUE 'N'.           
037900         88  PS-SAME-COMMIT-FIELDS                   VALUE 'Y'.           
038000         88  PS-NOT-SAME-COMMIT-FIELDS               VALUE 'N'.           
038100     05  PS-GOOD-RCPO-INSERT-SW        PIC  X(01)    VALUE 'N'.           
038200         88  PS-GOOD-RCPO-INSERT                     VALUE 'Y'.           
038300         88  PS-GOOD-RCPO-INSERT-NO                  VALUE 'N'.           
038400*    05  PS-GOOD-RCUPC-INSERT-SW       PIC  X(01)    VALUE 'N'.           
038500*        88  PS-GOOD-RCUPC-INSERT                    VALUE 'Y'.           
038600*        88  PS-GOOD-RCUPC-INSERT-NO                 VALUE 'N'.           
038700*    05  PS-GOOD-RCVD-INSERT-SW        PIC  X(01)    VALUE 'N'.           
038800*        88  PS-GOOD-RCVD-INSERT                     VALUE 'Y'.           
038900*        88  PS-GOOD-RCVD-INSERT-NO                  VALUE 'N'.           
039000     05  PS-GOOD-RCPO-DELETE-SW        PIC  X(01)    VALUE 'N'.           
039100         88  PS-GOOD-RCPO-DELETE                     VALUE 'Y'.           
039200         88  PS-GOOD-RCPO-DELETE-NO                  VALUE 'N'.           
039300*    05  PS-GOOD-RCVS-DELETE-SW        PIC  X(01)    VALUE 'N'.           
039400*        88  PS-GOOD-RCVS-DELETE                     VALUE 'Y'.           
039500*        88  PS-GOOD-RCVS-DELETE-NO                  VALUE 'N'.           
039600*    05  PS-GOOD-RCUPC-DELETE-SW       PIC  X(01)    VALUE 'N'.           
039700*        88  PS-GOOD-RCUPC-DELETE                    VALUE 'Y'.           
039800*        88  PS-GOOD-RCUPC-DELETE-NO                 VALUE 'N'.           
039900*    05  PS-EOC-RCUPC-CURSOR-SW        PIC  X(01)    VALUE 'N'.           
040000*        88  PS-EOC-RCUPC-CURSOR                     VALUE 'Y'.           
040100*        88  PS-EOC-RCUPC-CURSOR-NO                  VALUE 'N'.           
040200*    05  PS-EOC-RCVS-CURSOR-SW         PIC  X(01)    VALUE 'N'.           
040300*        88  PS-EOC-RCVS-CURSOR                      VALUE 'Y'.           
040400*        88  PS-EOC-RCVS-CURSOR-NO                   VALUE 'N'.           
040500     05  PS-PO-EXISTS-SW               PIC  X(01)    VALUE 'N'.           
040600         88  PS-PO-EXISTS                            VALUE 'Y'.           
040700         88  PS-PO-EXISTS-NO                         VALUE 'N'.           
040800     05  PS-VS-EXISTS-SW               PIC  X(01)    VALUE 'N'.           
040900         88  PS-VS-EXISTS                            VALUE 'Y'.           
041000         88  PS-VS-EXISTS-NO                         VALUE 'N'.           
041100     05  PS-UPC-EXISTS-SW              PIC  X(01)    VALUE 'N'.           
041200         88  PS-UPC-EXISTS                           VALUE 'Y'.           
041300         88  PS-UPC-EXISTS-NO                        VALUE 'N'.           
041400     05  PS-NEW-PO-SW                  PIC  X(01)    VALUE 'N'.           
041500         88  PS-NEW-PO                               VALUE 'Y'.           
041600         88  PS-NEW-PO-NO                            VALUE 'N'.           
041700     05  PS-NEW-VS-SW                  PIC  X(01)    VALUE 'N'.           
041800         88  PS-NEW-VS                               VALUE 'Y'.           
041900         88  PS-NEW-VS-NO                            VALUE 'N'.           
042000     05  PS-NEW-UPC-SW                 PIC  X(01)    VALUE 'N'.           
042100         88  PS-NEW-UPC                              VALUE 'Y'.           
042200         88  PS-NEW-UPC-NO                           VALUE 'N'.           
042300     05  PS-FIELD-NUMERIC-SW           PIC  X(01)    VALUE 'N'.           
042400         88  PS-FIELD-NUMERIC                        VALUE 'Y'.           
042500         88  PS-FIELD-NUMERIC-NO                     VALUE 'N'.           
042600     05  PS-TRN-TYP-ADD-SW             PIC  X(01)    VALUE 'N'.           
042700         88  PS-TRN-TYP-ADD                          VALUE 'Y'.           
042800         88  PS-TRN-TYP-ADD-NO                       VALUE 'N'.           
042900     05  PS-WARNING-TIME-SW            PIC  X(01)    VALUE 'N'.           
043000         88  PS-WARNING-TIME                         VALUE 'Y'.           
043100         88  PS-WARNING-TIME-NO                      VALUE 'N'.           
043200     05  PS-WARNING-DATE-SW            PIC  X(01)    VALUE 'N'.           
043300         88  PS-WARNING-DATE                         VALUE 'Y'.           
043400         88  PS-WARNING-DATE-NO                      VALUE 'N'.           
043500     05  PS-GOOD-REC-TYP-CDE-SW        PIC  X(01)    VALUE 'N'.           
043600         88  PS-GOOD-REC-TYP-CDE                     VALUE 'Y'.           
043700         88  PS-GOOD-REC-TYP-CDE-NO                  VALUE 'N'.           
043800     05  PS-TIMRCPO-ROW-IS-THERE-SW    PIC X(01)     VALUE 'U'.           
043900         88  PS-TIMRCPO-ROW-IS-THERE-UNSURE          VALUE 'U'.           
044000         88  PS-TIMRCPO-ROW-IS-THERE                 VALUE 'Y'.           
044100         88  PS-TIMRCPO-ROW-IS-THERE-NO              VALUE 'N'.           
044200     05  PS-RCPO-7006-ROW-FOUND-SW     PIC X(01)     VALUE 'U'.           
044300         88  PS-RCPO-7006-ROW-FOUND-UNSURE           VALUE 'U'.           
044400         88  PS-RCPO-7006-ROW-FOUND                  VALUE 'Y'.           
044500         88  PS-RCPO-7006-ROW-NOT-FOUND              VALUE 'N'.           
044600     05  PS-RCPO-7003-ROW-FOUND-SW     PIC X(01)     VALUE 'U'.           
044700         88  PS-RCPO-7003-ROW-FOUND-UNSURE           VALUE 'U'.           
044800         88  PS-RCPO-7003-ROW-FOUND                  VALUE 'Y'.           
044900         88  PS-RCPO-7003-ROW-NOT-FOUND              VALUE 'N'.           
045000*    05  PS-TIMRCVS-ROW-IS-THERE-SW    PIC X(01)     VALUE 'U'.           
045100*        88  PS-TIMRCVS-ROW-IS-THERE-UNSURE          VALUE 'U'.           
045200*        88  PS-TIMRCVS-ROW-IS-THERE                 VALUE 'Y'.           
045300*        88  PS-TIMRCVS-ROW-IS-THERE-NO              VALUE 'N'.           
045400*    05  PS-TIMRCUP-ROW-IS-THERE-SW    PIC X(01)     VALUE 'U'.           
045500*        88  PS-TIMRCUP-ROW-IS-THERE-UNSURE          VALUE 'U'.           
045600*        88  PS-TIMRCUP-ROW-IS-THERE                 VALUE 'Y'.           
045700*        88  PS-TIMRCUP-ROW-IS-THERE-NO              VALUE 'N'.           
045800     05  PS-TIMRCPO-ADDED-SW           PIC X(01)     VALUE 'N'.           
045900         88  PS-TIMRCPO-ADDED                        VALUE 'Y'.           
046000         88  PS-TIMRCPO-ADDED-NO                     VALUE 'N'.           
046100*    05  PS-TIMRCVS-ADDED-SW           PIC X(01)     VALUE 'N'.           
046200*        88  PS-TIMRCVS-ADDED                        VALUE 'Y'.           
046300*        88  PS-TIMRCVS-ADDED-NO                     VALUE 'N'.           
046400     05  PS-KEY-FIELDS-CHANGED-SW      PIC X(01)     VALUE 'N'.           
046500         88  PS-KEY-FIELDS-CHANGED                   VALUE 'Y'.           
046600         88  PS-KEY-FIELDS-CHANGED-NO                VALUE 'N'.           
046700*    05  PS-INVALID-POE-CDE-SW         PIC X(01)     VALUE 'N'.           
046800*        88  PS-VALID-POE-CDE                        VALUE 'Y'.           
046900*        88  PS-INVALID-POE-CDE                      VALUE 'N'.           
047000     05  PS-INVALID-FOB-CDE-SW         PIC X(01)     VALUE 'N'.           
047100         88  PS-VALID-FOB-CDE                        VALUE 'Y'.           
047200         88  PS-INVALID-FOB-CDE                      VALUE 'N'.           
047300*    05  PS-INVALID-CNTRY-CDE-SW       PIC X(01)     VALUE 'N'.           
047400*        88  PS-VALID-CNTRY-CDE                      VALUE 'Y'.           
047500*        88  PS-INVALID-CNTRY-CDE                    VALUE 'N'.           
047600     05  PS-TPURCHS-ACTIVE-SW          PIC X(01)     VALUE 'N'.           
047700         88  PS-TPURCHS-ACTIVE                       VALUE 'Y'.           
047800         88  PS-TPURCHS-ACTIVE-NO                    VALUE 'N'.           
047900*    05  PS-VS-ON-TPURITM-SW           PIC X(01)     VALUE 'N'.           
048000*        88  PS-VS-ON-TPURITM                        VALUE 'Y'.           
048100*        88  PS-VS-ON-TPURITM-NO                     VALUE 'N'.           
048200*    05  PS-UPC-ON-TPURITM-SW          PIC X(01)     VALUE 'N'.           
048300*        88  PS-UPC-ON-TPURITM                       VALUE 'Y'.           
048400*        88  PS-UPC-ON-TPURITM-NO                    VALUE 'N'.           
048500     05  PS-RCPO-FOUND-SW              PIC X(01)     VALUE 'N'.           
048600         88  PS-RCPO-FOUND                           VALUE 'Y'.           
048700         88  PS-RCPO-FOUND-NO                        VALUE 'N'.           
048800     05  PS-RCUP-FOUND-SW              PIC X(01)     VALUE 'N'.           
048900         88  PS-RCUP-FOUND                           VALUE 'Y'.           
049000         88  PS-RCUP-FOUND-NO                        VALUE 'N'.           
049100     05  PS-GOOD-RECORD-SW             PIC X(01)     VALUE 'N'.           
049200         88  PS-GOOD-RECORD                          VALUE 'Y'.           
049300         88  PS-GOOD-RECORD-NO                       VALUE 'N'.           
049400*    05  PS-EOC-RCVS-UPC-CURSOR-SW     PIC  X(01)    VALUE 'N'.           
049500*        88  PS-EOC-RCVS-UPC-CURSOR                  VALUE 'Y'.           
049600*        88  PS-EOC-RCVS-UPC-CURSOR-NO               VALUE 'N'.           
049700*    05  PS-EOC-UPC-CURSOR-SW          PIC  X(01)    VALUE 'N'.           
049800*        88  PS-EOC-UPC-CURSOR                       VALUE 'Y'.           
049900*        88  PS-EOC-UPC-CURSOR-NO                    VALUE 'N'.           
050000*    05  PS-TABLE-VS-UPC-FOUND-SW      PIC  X(01)    VALUE 'N'.           
050100*        88  PS-TABLE-VS-UPC-FOUND                   VALUE 'Y'.           
050200*        88  PS-TABLE-VS-UPC-NOT-FOUND               VALUE 'N'.           
050300     05  PS-CHANGE-FOUND-PO-SW         PIC  X(01)    VALUE 'N'.           
050400         88  PS-CHANGE-FOUND-PO                      VALUE 'Y'.           
050500         88  PS-CHANGE-FOUND-PO-NO                   VALUE 'N'.           
050600*    05  PS-CHANGE-FOUND-VS-SW         PIC  X(01)    VALUE 'N'.           
050700*        88  PS-CHANGE-FOUND-VS                      VALUE 'Y'.           
050800*        88  PS-CHANGE-FOUND-VS-NO                   VALUE 'N'.           
050900*    05  PS-CHANGE-FOUND-UPC-SW        PIC  X(01)    VALUE 'N'.           
051000*        88  PS-CHANGE-FOUND-UPC                     VALUE 'Y'.           
051100*        88  PS-CHANGE-FOUND-UPC-NO                  VALUE 'N'.           
051200     05  PS-CHANGE-FOUND-SW            PIC  X(01)    VALUE 'N'.           
051300         88  PS-CHANGE-FOUND                         VALUE 'Y'.           
051400         88  PS-CHANGE-FOUND-NO                      VALUE 'N'.           
051500*    05  PS-VS-E-DELETE-SW             PIC  X(01)    VALUE 'N'.           
051600*        88  PS-VS-E-DELETE                          VALUE 'Y'.           
051700*        88  PS-VS-E-DELETE-NO                       VALUE 'N'.           
051800*    05  PS-UPC-E-DELETE-SW            PIC  X(01)    VALUE 'N'.           
051900*        88  PS-UPC-E-DELETE                         VALUE 'Y'.           
052000*        88  PS-UPC-E-DELETE-NO                      VALUE 'N'.           
052100     05  PS-CHANGE-ADD-SW              PIC  X(01)    VALUE 'N'.           
052200         88  PS-CHANGE-ADD                           VALUE 'Y'.           
052300         88  PS-CHANGE-ADD-NO                        VALUE 'N'.           
052400     05  PS-CHANGE-ADD-B-SW            PIC  X(01)    VALUE 'N'.           
052500         88  PS-CHANGE-ADD-B                         VALUE 'Y'.           
052600         88  PS-CHANGE-ADD-B-NO                      VALUE 'N'.           
052700*    05  PS-DELETE-E-VS-SW             PIC  X(01)    VALUE 'N'.           
052800*        88  PS-DELETE-E-VS                          VALUE 'Y'.           
052900*        88  PS-DELETE-E-VS-NO                       VALUE 'N'.           
053000*    05  PS-DELETE-E-UPC-SW            PIC  X(01)    VALUE 'N'.           
053100*        88  PS-DELETE-E-UPC                         VALUE 'Y'.           
053200*        88  PS-DELETE-E-UPC-NO                      VALUE 'N'.           
053300     05  PS-ERD-ERDRSN-LOG-LOOP-SW     PIC  X(01)    VALUE 'N'.           
053400         88  PS-ERD-ERDRSN-LOG-LOOP                  VALUE 'Y'.           
053500         88  PS-ERD-ERDRSN-LOG-LOOP-NO               VALUE 'N'.           
053600     05  PS-ADD-FOR-CHANGES-SW         PIC  X(01)    VALUE 'N'.           
053700         88  PS-ADD-FOR-CHANGES-DONE                 VALUE 'Y'.           
053800         88  PS-ADD-FOR-CHANGES-DONE-NO              VALUE 'N'.           
053900*    05  PS-CHANGE-ADD-VS-OR-UPC-SW    PIC  X(01)    VALUE 'N'.           
054000*        88  PS-CHANGE-ADD-VS-OR-UPC                 VALUE 'Y'.           
054100*        88  PS-CHANGE-ADD-VS-OR-UPC-NO              VALUE 'N'.           
054200*    05  PS-CHANGE-C-VS-SW             PIC  X(01)    VALUE 'N'.           
054300*        88  PS-CHANGE-C-VS                          VALUE 'Y'.           
054400*        88  PS-CHANGE-C-VS-NO                       VALUE 'N'.           
054500*    05  PS-CHANGE-C-UPC-SW            PIC  X(01)    VALUE 'N'.           
054600*        88  PS-CHANGE-C-UPC                         VALUE 'Y'.           
054700*        88  PS-CHANGE-C-UPC-NO                      VALUE 'N'.           
054800     05  PS-POE-LBD-SW                 PIC  X(01)    VALUE 'N'.           
054900         88  PS-POE-LBD                              VALUE 'Y'.           
055000         88  PS-POE-LBD-NO                           VALUE 'N'.           
055100                                                                          
055200 01  PC-PROGRAM-CONSTANTS.                                                
055300     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)     VALUE                  
055400         'TRKUP225'.                                                      
055500     05  PC-99                       PIC X(02)     VALUE '99'.            
055600     05  PC-1                        PIC X(01)     VALUE '1'.             
055700     05  PC-2                        PIC X(01)     VALUE '2'.             
055800     05  PC-3                        PIC X(01)     VALUE '3'.             
055900     05  PC-10                       PIC X(02)     VALUE '10'.            
056000     05  PC-21                       PIC X(02)     VALUE '21'.            
056100     05  PC-A                        PIC X(01)     VALUE 'A'.             
056200     05  PC-B                        PIC X(01)     VALUE 'B'.             
056300     05  PC-C                        PIC X(01)     VALUE 'C'.             
056400     05  PC-D                        PIC X(01)     VALUE 'D'.             
056500     05  PC-E                        PIC X(01)     VALUE 'E'.             
056600     05  PC-O                        PIC X(01)     VALUE 'O'.             
056700     05  PC-U                        PIC X(01)     VALUE 'U'.             
056800     05  PC-Z                        PIC X(01)     VALUE 'Z'.             
056900     05  PC-AP                       PIC X(02)     VALUE 'AP'.            
057000     05  PC-AC                       PIC X(02)     VALUE 'AC'.            
057100     05  PC-RC                       PIC X(02)     VALUE 'RC'.            
057200     05  PC-RD                       PIC X(02)     VALUE 'RD'.            
057300     05  PC-ISA                      PIC X(03)     VALUE 'ISA'.           
057400     05  PC-ERD                      PIC X(06)     VALUE 'ERD   '.        
057500     05  PC-ERDRSN                   PIC X(06)     VALUE 'ERDRSN'.        
057600     05  PC-LOG                      PIC X(06)     VALUE 'LOG   '.        
057700     05  PC-LOGVS                    PIC X(06)     VALUE 'LOGVS '.        
057800     05  PC-LOGUPC                   PIC X(06)     VALUE 'LOGUPC'.        
057900     05  PC-WARNING                  PIC X(03)     VALUE 'WRN'.           
058000     05  PC-ERROR                    PIC X(03)     VALUE 'ERR'.           
058100     05  PC-HDR                      PIC X(06)     VALUE 'HDR   '.        
058200     05  PC-HEADER1                  PIC X(03)     VALUE 'HD1'.           
058300     05  PC-HEADER2                  PIC X(03)     VALUE 'HD2'.           
058400     05  PC-EDI                      PIC X(03)     VALUE 'EDI'.           
058500     05  PC-DASH                     PIC X(01)     VALUE '-'.             
058600     05  PC-SLASH                    PIC X(01)     VALUE '/'.             
058700     05  PC-DECIMAL                  PIC X(01)     VALUE '.'.             
058800     05  PC-DEFAULT-SECONDS          PIC X(10)     VALUE                  
058900                                     '.00.000000'.                        
059000     05  PC-DEFAULT-TMST             PIC X(26)     VALUE                  
059100                                     '0001-01-01-00.00.00.000000'.        
059200     05  PC-DEFAULT-DTE              PIC X(10)     VALUE                  
059300                                     '0001-01-01'.                        
059400     05  PC-DEFAULT-DTE-NO-DASHES    PIC X(08)     VALUE                  
059500                                     '00010101'.                          
059600     05  PC-MAX-RETRIES              PIC S9(03)    VALUE +5               
059700                                                     COMP-3.              
059800     05  PC-IN-PROCESS-CODE          PIC X(01)     VALUE '9'.             
059900     05  PC-RUN-COMPLETE-CODE        PIC X(01)     VALUE '0'.             
060000     05  PC-VEND-ID-EXDO             PIC X(09)     VALUE                  
060100                                                   '035239425'.           
060200                                                                          
060300 01  PV-PROGRAM-VARIABLES.                                                
060400     05  PV-RECORD-TYP               PIC X(06).                           
060500         88  PV-RECORD-TYP-ERD                     VALUE 'ERD   '.        
060600         88  PV-RECORD-TYP-ERDRSN                  VALUE 'ERDRSN'.        
060700         88  PV-RECORD-TYP-LOG                     VALUE 'LOG   '.        
060800         88  PV-RECORD-TYP-LOGVS                   VALUE 'LOGVS '.        
060900         88  PV-RECORD-TYP-LOGUPC                  VALUE 'LOGUPC'.        
061000         88  PV-RECORD-TYP-ISA                     VALUE 'ISA   '.        
061100                                                                          
061200     05  PV-ISA-CHECK                PIC X(03).                           
061300         88  PV-ISA-RECORD                         VALUE 'ISA'.           
061400                                                                          
061500     05  PV-IMPRT-FCTRY-NAME.                                             
061600         10  PV-IMPRT-FCTRY-NAME-10  PIC X(10)     VALUE SPACES.          
061700         10  FILLER                  PIC X(25)     VALUE SPACES.          
061800                                                                          
061900     05  PV-RCVD-SEQ-NBR-MAX         PIC S9(04)    VALUE +0 COMP.         
062000                                                                          
062100     05  PV-CURRENT-TMST             PIC X(26)     VALUE SPACES.          
062200                                                                          
062300     05  PV-DPRTR-TMST               PIC X(26)     VALUE SPACES.          
062400                                                                          
062500*    05  PV-HOLD-CURSOR-VS-NBR       PIC X(20)     VALUE SPACES.          
062600*    05  PV-UPC-CURSOR-VS-NBR        PIC X(20)     VALUE SPACES.          
062700*    05  PV-UPC-CURSOR-UPC-NBR       PIC S9(15)V   VALUE ZEROES           
062800*                                                  COMP-3.                
062900     05  PV-ENT-ID-SIGNED            PIC S9(09)    VALUE +0               
063000                                                   COMP.                  
063100     05  PV-HOLD-EDI-RECORD.                                              
063200         10  FILLER                  PIC X(32)     VALUE SPACES.          
063300         10  PV-EDI-VEND-ID-QUAL     PIC X(02)     VALUE SPACES.          
063400         10  FILLER                  PIC X(01)     VALUE SPACES.          
063500         10  PV-EDI-VEND-ID          PIC X(15)     VALUE SPACES.          
063600         10  FILLER                  PIC X(20)     VALUE SPACES.          
063700         10  PV-EDI-CONSOL-TRNS-DTE  PIC X(06)     VALUE SPACES.          
063800         10  FILLER                  PIC X(01)     VALUE SPACES.          
063900         10  PV-EDI-CONSOL-TRNS-TM   PIC X(04)     VALUE SPACES.          
064000         10  FILLER                  PIC X(09)     VALUE SPACES.          
064100         10  PV-EDI-CONSOL-FIL-ID    PIC X(09)     VALUE SPACES.          
064200         10  FILLER                  PIC X(51)     VALUE SPACES.          
064300                                                                          
064400******************************************************************        
064500*          HOLD RECORD FIELDS START HERE                                  
064600******************************************************************        
064700     05  SAVE1-DATA-VALUE                PIC X(06)  VALUE SPACES.         
064800     05  PV-HOLD-TR025-TRN-TYP           PIC X(01)  VALUE SPACES.         
064900     05  PV-HOLD-TR025-REC-TYP-CDE       PIC X(06)  VALUE SPACES.         
065000     05  PV-HOLD-TR025-PO-NBR            PIC 9(09)  VALUE ZEROES.         
065100     05  PV-TR025-PO-NBR-SIGNED          PIC S9(09) COMP VALUE +0.        
065200     05  PV-HOLD-TR025-EXTL-REF-NBR      PIC X(15)  VALUE SPACES.         
065300     05  PV-HOLD-TR025-PO-RCVD-DELY-DTE  PIC X(08)  VALUE SPACES.         
065400     05  PV-HOLD-TR025-PO-RCVD-DELY-TM   PIC X(04)  VALUE SPACES.         
065500     05  PV-HOLD-ORGN-SHPD-FR-CDE        PIC X(03)  VALUE SPACES.         
065600     05  PV-HOLD-TR025-VS-NBR            PIC X(20)  VALUE SPACES.         
065700     05  PV-HOLD-TR025-UPC-NBR           PIC 9(15)  VALUE ZEROES.         
065800     05  PV-HOLD-TR025-PROCESS-SEQ-NBR   PIC 9(06)  VALUE ZEROES.         
065900     05  PV-HOLD-DAT-SRC-ENT-ID          PIC 9(09)  VALUE ZEROES.         
066000     05  PV-HOLD-PROCESS-SEQ-NBR-ERD                                      
066100                                  PIC 9(06)  VALUE ZEROES.                
066200     05  PV-HOLD-PROCESS-SEQ-NBR-ERDRSN                                   
066300                                  PIC 9(06)  VALUE ZEROES.                
066400     05  PV-HOLD-PROCESS-SEQ-NBR-LOG                                      
066500                                  PIC 9(06)  VALUE ZEROES.                
066600     05  PV-SEQ-NBR-ERD                                                   
066700                                  PIC 9(06)  VALUE ZEROES.                
066800     05  PV-SEQ-NBR-ERDRSN                                                
066900                                  PIC 9(06)  VALUE ZEROES.                
067000     05  PV-SEQ-NBR-LOG                                                   
067100                                  PIC 9(06)  VALUE ZEROES.                
067200                                                                          
067300     05  PV-HOLD-STR221-ERROR-TYPE    PIC X(03)     VALUE SPACES.         
067400     05  PV-HOLD-TR221-ERROR-MSG     PIC X(50)     VALUE SPACES.          
067500                                                                          
067600     05  PV-HOLD-LAST-TRN-TYP        PIC X(01)     VALUE SPACES.          
067700                                                                          
067800     05  PV-EVAL-TRN-TYP-CDE         PIC X(01).                           
067900         88  TRN-TYP-ADD-A                         VALUE 'A'.             
068000         88  TRN-TYP-ADD-B                         VALUE 'B'.             
068100         88  TRN-TYP-ADD-Z                         VALUE 'Z'.             
068200         88  TRN-TYP-CHG                           VALUE 'C'.             
068300         88  TRN-TYP-DEL-D                         VALUE 'D'.             
068400         88  TRN-TYP-DEL-E                         VALUE 'E'.             
068500                                                                          
068600                                                                          
068700     05  PV-REC-TYP-ERD              PIC X(06)     VALUE 'ERD   '.        
068800     05  PV-REC-TYP-ERDRSN           PIC X(06)     VALUE 'ERDRSN'.        
068900     05  PV-REC-TYP-LOG              PIC X(06)     VALUE 'LOG   '.        
069000                                                                          
069100     05  PV-CHECK-REC-TYP-CDE        PIC X(06).                           
069200         88  VALID-REC-TYP-CDE                     VALUE 'ISA   ',        
069300                                                         'ERD   ',        
069400                                                         'ERDRSN',        
069500                                                         'LOG   ',        
069600                                                         'LOGVS ',        
069700                                                         'LOGUPC',        
069800                                                         'CTT   ',        
069900                                                         'IEA   '.        
070000     05  PV-EDI-RECORDS              PIC  X(03).                          
070100         88  EDI-RECORD                            VALUE 'CTT',           
070200                                                         'IEA',           
070300                                                         'ISA'.           
070400         88  EDI-IEA-RECORD                        VALUE 'IEA'.           
070500                                                                          
070600     05  PV-TMST                     PIC X(26)     VALUE SPACES.          
070700     05  PV-HOLD-TMST                PIC X(26)     VALUE SPACES.          
070800     05  PV-CKPT-STAT-CODE           PIC X(01)     VALUE SPACES.          
070900     05  PA-TOTAL-RECS-READ          PIC 9(09)     VALUE ZERO             
071000                                                    COMP-3.               
071100     05  PV-RETRY-COUNTER            PIC S9(04)    VALUE +0               
071200                                                    COMP SYNC.            
071300                                                                          
071400     05  PV-FORMAT-TMST.                                                  
071500         10  PV-FORMAT-TMST-DTE.                                          
071600             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.          
071700             15  PV-FORMAT-TMST-DTE-D1  PIC X(01)  VALUE '-'.             
071800             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.          
071900             15  PV-FORMAT-TMST-DTE-D2  PIC X(01)  VALUE '-'.             
072000             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.          
072100             15  PV-FORMAT-TMST-DTE-D3  PIC X(01)  VALUE '-'.             
072200         10  PV-FORMAT-TMST-TM.                                           
072300             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.          
072400             15  PV-FORMAT-TMST-TM-D1   PIC X(01)  VALUE '.'.             
072500             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.          
072600             15  PV-FORMAT-TMST-TM-D2   PIC X(10)  VALUE                  
072700                                                     '.00.000000'.        
072800     05  PV-WORK-DATE                     PIC 9999B99B99.                 
072900     05  PV-WORK-DATE-R REDEFINES PV-WORK-DATE  PIC X(10).                
073000     05  PV-WORK-DATE-G REDEFINES PV-WORK-DATE-R.                         
073100         10  FILLER                       PIC 9(4).                       
073200         10  PV-WORK-DASH1                PIC X.                          
073300         10  FILLER                       PIC 9(2).                       
073400         10  PV-WORK-DASH2                PIC X.                          
073500         10  FILLER                       PIC 9(2).                       
073600     05  PV-REFORMAT-TMST.                                                
073700         10  PV-REFORMAT-TMST-DTE.                                        
073800             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.        
073900             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.        
074000             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.        
074100         10  PV-REFORMAT-TMST-TM.                                         
074200             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.        
074300             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.        
074400                                                                          
074500     05  PV-REFORMAT-TO-DB2-DTE.                                          
074600         10  PV-REFORMAT-TO-DB2-CY    PIC X(04)  VALUE SPACES.            
074700         10  PV-REFORMAT-TODB2-DASH1  PIC X(01)  VALUE '-'.               
074800         10  PV-REFORMAT-TO-DB2-MM    PIC X(02)  VALUE SPACES.            
074900         10  PV-REFORMAT-TODB2-DASH2  PIC X(01)  VALUE '-'.               
075000         10  PV-REFORMAT-TO-DB2-DD    PIC X(02)  VALUE SPACES.            
075100                                                                          
075200     05  PV-REFORMAT-10BYTE-FIELD     PIC X(10)  VALUE SPACES.            
075300                                                                          
075400     05  PV-REFORMAT-DPTR-TO-DB2-DTE.                                     
075500         10  PV-REFORMAT-DPTR-TO-DB2-CY  PIC X(04)  VALUE SPACES.         
075600         10  PV-REFORMAT-DPTR-TODB2-DASH1 PIC X(01)  VALUE '-'.           
075700         10  PV-REFORMAT-DPTR-TO-DB2-MM  PIC X(02)  VALUE SPACES.         
075800         10  PV-REFORMAT-DPTR-TODB2-DASH2 PIC X(01)  VALUE '-'.           
075900         10  PV-REFORMAT-DPTR-TO-DB2-DD  PIC X(02)  VALUE SPACES.         
076000                                                                          
076100     05  PV-REFORMAT-10BYTE-DPTR-DTE      PIC X(10)  VALUE SPACES.        
076200     05  PV-REFORMAT-10BYTE-DPTR-PRT-DT   PIC X(10) VALUE SPACES.         
076300                                                                          
076400     05  PV-HDR-CONSOL-TRNS-DTE.                                          
076500         10  PV-HDR-CONSOL-TRNS-DTE-CC    PIC X(02)  VALUE SPACES.        
076600         10  PV-HDR-CONSOL-TRNS-DTE-REST  PIC X(06)  VALUE SPACES.        
076700                                                                          
076800*01  PV-VENDOR-STYLE-UPC-TABLE.                                           
076900*    05  PV-VS-UPC-TABLE OCCURS 2000 TIMES                                
077000*                                INDEXED BY VS-INDX.                      
077100*        10  PV-TABLE-VS-NBR       PIC X(20).                             
077200*        10  PV-TABLE-UPC-NBR      PIC 9(15).                             
077300                                                                          
077400 01  CKPT-RESTART-INFO.                                                   
077500     05  CR-INPUT-FILE-SW            PIC X(01)     VALUE 'I'.             
077600         88  INPUT-RECEIVING-FILE                  VALUE 'I'.             
077700     05  CR-RECEIVING-RECS-WORKED    PIC 9(09)     VALUE ZERO.            
077800                                                                          
077900*                                                                         
078000*  CURSOR DECLARATION TO OBTAIN RECEIVING UPC INFORMATION FOR             
078100*  PO LEVEL DELETES                                                       
078200*                                                                         
078300*    EXEC SQL                                                             
078400*         DECLARE RCUPC_CSR CURSOR WITH HOLD FOR                          
078500*            SELECT PO_NBR,                                               
078600*                   PO_RCVD_SEQ_NBR,                                      
078700*                   VS_NBR,                                               
078800*                   UPC_NBR,                                              
078900*                   UPC_CART_CNT,                                         
079000*                   UPC_CBMT_QTY,                                         
079100*                   UPC_WT_KGRM_QTY,                                      
079200*                   UPC_UNT_QTY,                                          
079300*                   CRE_BY_USR_ID,                                        
079400*                   CRE_TMST,                                             
079500*                   LAST_UPD_BY_USR_ID,                                   
079600*                   LAST_UPD_TMST                                         
079700*              FROM TIMRCUP                                               
079800*             WHERE PO_NBR           = :IMRCUP-PO-NBR                     
079900*               AND PO_RCVD_SEQ_NBR  = :IMRCUP-PO-RCVD-SEQ-NBR            
080000*    END-EXEC.                                                            
080100                                                                          
080200*                                                                         
080300*  CURSOR DECLARATION TO OBTAIN RECEIVING VENDOR STYLE                    
080400*  INFORMATION FOR PO LEVEL DELETES                                       
080500*                                                                         
080600*    EXEC SQL                                                             
080700*         DECLARE RCVS_CSR CURSOR WITH HOLD FOR                           
080800*            SELECT PO_NBR,                                               
080900*                   PO_RCVD_SEQ_NBR,                                      
081000*                   VS_NBR,                                               
081100*                   HTS_ID,                                               
081200*                   VS_CART_CNT,                                          
081300*                   VS_CBMT_QTY,                                          
081400*                   VS_WT_KGRM_QTY,                                       
081500*                   VS_UNT_QTY,                                           
081600*                   QTA_CTG_IND,                                          
081700*                   CRE_BY_USR_ID,                                        
081800*                   CRE_TMST,                                             
081900*                   LAST_UPD_BY_USR_ID,                                   
082000*                   LAST_UPD_TMST                                         
082100*              FROM TIMRCVS                                               
082200*             WHERE PO_NBR           = :IMRCVS-PO-NBR                     
082300*               AND PO_RCVD_SEQ_NBR  = :IMRCVS-PO-RCVD-SEQ-NBR            
082400*     END-EXEC.                                                           
082500                                                                          
082600*                                                                         
082700*  CURSOR DECLARATION TO OBTAIN VENDOR STYLE AND UPC INFORMATION          
082800*  FOR THE INTERNAL VS/UPC TABLE.                                         
082900*                                                                         
083000*    EXEC SQL                                                             
083100*         DECLARE RCVS_UPC_CUR CURSOR WITH HOLD FOR                       
083200*            SELECT DISTINCT                                              
083300*                   B.VS_NBR,                                             
083400*                   B.UPC_NBR                                             
083500*              FROM TIMRCVS  A                                            
083600*                  ,TIMRCUP  B                                            
083700*             WHERE A.PO_NBR         = :IMRCPO-PO-NBR                     
083800*               AND A.PO_NBR         =  B.PO_NBR                          
083900*               AND A.PO_RCVD_SEQ_NBR = :IMRCPO-PO-RCVD-SEQ-NBR           
084000*               AND A.PO_RCVD_SEQ_NBR = B.PO_RCVD_SEQ_NBR                 
084100*          ORDER BY B.VS_NBR,                                             
084200*                   B.UPC_NBR                                             
084300*    END-EXEC.                                                            
084400                                                                          
084500*                                                                         
084600*  CURSOR DECLARATION TO OBTAIN UPC INFORMATION FOR THE INTERNAL          
084700*  VS/UPC TABLE.                                                          
084800*                                                                         
084900*    EXEC SQL                                                             
085000*         DECLARE UPC_CUR CURSOR WITH HOLD FOR                            
085100*            SELECT DISTINCT                                              
085200*                   A.PO_NBR,                                             
085300*                   A.PO_RCVD_SEQ_NBR,                                    
085400*                   A.VS_NBR,                                             
085500*                   A.UPC_NBR,                                            
085600*                   A.UPC_CART_CNT,                                       
085700*                   A.UPC_CBMT_QTY,                                       
085800*                   A.UPC_WT_KGRM_QTY,                                    
085900*                   A.UPC_UNT_QTY,                                        
086000*                   A.CRE_BY_USR_ID,                                      
086100*                   A.CRE_TMST,                                           
086200*                   A.LAST_UPD_BY_USR_ID,                                 
086300*                   A.LAST_UPD_TMST                                       
086400*              FROM TIMRCUP  A                                            
086500*             WHERE A.PO_NBR         = :IMRCPO-PO-NBR                     
086600*               AND A.PO_RCVD_SEQ_NBR = :IMRCPO-PO-RCVD-SEQ-NBR           
086700*               AND A.VS_NBR         = :PV-UPC-CURSOR-VS-NBR              
086800*          ORDER BY A.VS_NBR,                                             
086900*                   A.UPC_NBR                                             
087000*    END-EXEC.                                                            
087100                                                                          
087200*---------------------------------------------------------------*         
087300*    CURSOR DECLARATION FOR SELECTING ON ORGN-SHPD-FR-CDE                 
087400*---------------------------------------------------------------*         
087500     EXEC SQL                                                             
087600        DECLARE ORGN_CUR CURSOR FOR                                       
087700          SELECT PO_NBR                                                   
087800                ,PO_RCVD_SEQ_NBR                                          
087900                ,EXTL_REF_NBR                                             
088000                ,PO_RCVD_DELY_TMST                                        
088100                ,ORGN_SHPD_FR_CDE                                         
088200         FROM TIMRCPO                                                     
088300          WHERE PO_NBR      = :W-IMRCPO-PO-NBR                            
088400          AND EXTL_REF_NBR  = :TR025-ERD-EXTL-REF-NBR                     
088500          AND ORGN_SHPD_FR_CDE = :TR025-ERD-ORGN-SHPD-FR-CDE              
088600        ORDER BY  PO_RCVD_SEQ_NBR DESC                                    
088700     END-EXEC.                                                            
088800                                                                          
088900*---------------------------------------------------------------*         
089000*    CURSOR DECLARATION FOR SELECTING ON DELIVERY TIMESTAMP               
089100*---------------------------------------------------------------*         
089200     EXEC SQL                                                             
089300        DECLARE TMST_CUR CURSOR FOR                                       
089400          SELECT PO_NBR                                                   
089500                ,PO_RCVD_SEQ_NBR                                          
089600                ,EXTL_REF_NBR                                             
089700                ,PO_RCVD_DELY_TMST                                        
089800                ,ORGN_SHPD_FR_CDE                                         
089900           FROM TIMRCPO                                                   
090000          WHERE PO_NBR           = :W-IMRCPO-PO-NBR                       
090100            AND EXTL_REF_NBR     = :TR025-ERD-EXTL-REF-NBR                
090200            AND DATE(PO_RCVD_DELY_TMST)                                   
090300                              = :PV-WORK-DATE-R                           
090400          ORDER BY PO_RCVD_SEQ_NBR DESC                                   
090500     END-EXEC.                                                            
090600*---------------------------------------------------------------*         
090700*    CURSOR DECLARATION FOR SELECTING POE CODE AIR              *         
090800*---------------------------------------------------------------*         
090900*                                                                         
091000*    EXEC SQL                                                             
091100*         DECLARE  POE-CSR-AIR CURSOR                                     
091200*             FOR  SELECT DISTINCT                                        
091300*                  A.POE_CDE                                              
091400*            FROM  TIMPOE  A                                              
091500*           WHERE  A.STD_IATA_CDE  =  :TR025-ERD-DEST-POE-CDE             
091600*             AND  A.STAT_CDE      =  'A'                                 
091700*        ORDER BY  POE_CDE                                                
091800*    END-EXEC.                                                            
091900*                                                                         
092000*EJECT                                                                    
092100*---------------------------------------------------------------*         
092200*    CURSOR DECLARATION FOR SELECTING POE CODE OCEAN            *         
092300*---------------------------------------------------------------*         
092400*                                                                         
092500*    EXEC SQL                                                             
092600*         DECLARE  POE-CSR-OCEAN CURSOR                                   
092700*             FOR  SELECT DISTINCT                                        
092800*                  A.POE_CDE                                              
092900*            FROM  TIMPOE  A                                              
093000*           WHERE  A.POE_STD_EDI_CDE  = :TR025-ERD-DEST-POE-CDE           
093100*             AND  A.STAT_CDE         = 'A'                               
093200*        ORDER BY  POE_CDE                                                
093300*    END-EXEC.                                                            
093400*                                                                         
093500*EJECT                                                                    
093600******************************************************************        
093700 LINKAGE SECTION.                                                         
093800******************************************************************        
093900                                                                          
094000******************************************************************        
094100 PROCEDURE DIVISION.                                                      
094200******************************************************************        
094300                                                                          
094400******************************************************************        
094500*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *        
094600******************************************************************        
094700 0000-PROGRAM-MAINLINE.                                                   
094800                                                                          
094900     PERFORM 1000-INITIALIZE.                                             
095000                                                                          
095100     PERFORM 2000-PROCESS-RCVD-RECORDS                                    
095200         UNTIL PS-END-OF-INPUT.                                           
095300                                                                          
095400     PERFORM 8000-EOJ-ROUTINE.                                            
095500     STOP RUN.                                                            
095600                                                                          
095700******************************************************************        
095800*  1000-INITIALIZE -  OPENS FILES, INITIALIZES FIELDS,     AND   *        
095900*  OTHER BEGINNING OF JOB PROCESSES.                             *        
096000******************************************************************        
096100 1000-INITIALIZE.                                                         
096200                                                                          
096300     OPEN INPUT  TR025-RECEIVING-FILE                                     
096400                                                                          
096500     PERFORM 4000-GET-CHECKPOINT-CNTL.                                    
096600     MOVE PV-CKPT-STAT-CODE  TO  PS-RUN-TYPE-SW.                          
096700                                                                          
096800     IF RESTART-RUN                                                       
096900         PERFORM 4110-CHECKPOINT-RESTART                                  
097000     ELSE                                                                 
097100         PERFORM 1010-CONTINUE-INITIALIZE                                 
097200     END-IF.                                                              
097300                                                                          
097400     PERFORM 4020-SET-COMMIT-TIME.                                        
097500                                                                          
097600                                                                          
097700 1010-CONTINUE-INITIALIZE.                                                
097800                                                                          
097900     INITIALIZE  TR025-REC-TYP-ERD.                                       
098000                                                                          
098100     SET PS-GOOD-RECORD-NO TO TRUE.                                       
098200                                                                          
098300     PERFORM 6000-READ-RCVD-FILE                                          
098400         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                         
098500                                                                          
098600     IF PS-END-OF-INPUT                                                   
098700         CONTINUE                                                         
098800     ELSE                                                                 
098900         MOVE TR025-ERD-TRN-TYP             TO                            
099000                PV-HOLD-TR025-TRN-TYP                                     
099100         MOVE TR025-ERD-PO-NBR              TO                            
099200                PV-HOLD-TR025-PO-NBR                                      
099300         MOVE TR025-ERD-EXTL-REF-NBR        TO                            
099400                PV-HOLD-TR025-EXTL-REF-NBR                                
099500         MOVE TR025-ERD-PO-RCVD-DELY-DTE    TO                            
099600                PV-HOLD-TR025-PO-RCVD-DELY-DTE                            
099700         MOVE TR025-ERD-PO-RCVD-DELY-TM     TO                            
099800                PV-HOLD-TR025-PO-RCVD-DELY-TM                             
099900         MOVE TR025-ERD-ENT-ID              TO                            
100000                PV-HOLD-DAT-SRC-ENT-ID                                    
100100         MOVE TR025-ERD-PROCESS-SEQ-NBR     TO                            
100200                PV-HOLD-TR025-PROCESS-SEQ-NBR                             
100300         MOVE TR025-ERD-REC-TYP-CDE         TO                            
100400                PV-HOLD-TR025-REC-TYP-CDE                                 
100500         MOVE TR025-ERD-ORGN-SHPD-FR-CDE    TO                            
100600                PV-HOLD-ORGN-SHPD-FR-CDE                                  
100700                                                                          
100800         EVALUATE TR025-ERD-REC-TYP-CDE                                   
100900                                                                          
101000             WHEN PC-LOGVS                                                
101100                 MOVE TR025-LOGVS-VS-NBR   TO                             
101200                        TR221-LOGVS-VS-NBR                                
101300             WHEN PC-LOGUPC                                               
101400                 MOVE TR025-LOGVS-VS-NBR   TO                             
101500                        TR221-LOGVS-VS-NBR                                
101600                 MOVE TR025-LOGUPC-UPC-NBR   TO                           
101700                        TR221-LOGUPC-UPC-NBR                              
101800         END-EVALUATE                                                     
101900                                                                          
102000     END-IF.                                                              
102100 EJECT                                                                    
102200                                                                          
102300******************************************************************        
102400* MAIN PROCESSING PARAGRAPH.                                     *        
102500******************************************************************        
102600 2000-PROCESS-RCVD-RECORDS.                                               
102700                                                                          
102800     SET PS-KEY-FIELDS-CHANGED-NO   TO TRUE                               
102900                                                                          
103000     EVALUATE TR025-ERD-TRN-TYP                                           
103100         WHEN 'A'                                                         
103200             ADD +1     TO PA-TOT-TRN-TYP-A                               
103300                                                                          
103400             PERFORM 2100-GROUP-ADD UNTIL                                 
103500                 PS-KEY-FIELDS-CHANGED OR PS-END-OF-INPUT                 
103600         WHEN 'C'                                                         
103700             PERFORM 2300-CHANGE UNTIL                                    
103800                 PS-KEY-FIELDS-CHANGED OR PS-END-OF-INPUT                 
103900             ADD +1     TO PA-TOT-TRN-TYP-C                               
104000             IF TR025-ERD-REC-TYP-CDE = PC-ERD OR                         
104100                PS-END-OF-INPUT                                           
104200               IF PS-CHANGE-FOUND-NO                                      
104300                   PERFORM 2399-NO-CHG-WRN-MSG                            
104400               ELSE                                                       
104500                   SET PS-CHANGE-FOUND-NO TO TRUE                         
104600               END-IF                                                     
104700*              SET PS-VS-E-DELETE-NO  TO TRUE                             
104800*              SET PS-UPC-E-DELETE-NO TO TRUE                             
104900             END-IF                                                       
105000                                                                          
105100         WHEN 'D'                                                         
105200             PERFORM 2400-GROUP-DELETE UNTIL                              
105300                 PS-KEY-FIELDS-CHANGED OR PS-END-OF-INPUT                 
105400             ADD +1     TO PA-TOT-TRN-TYP-D                               
105500         WHEN OTHER                                                       
105600             MOVE PC-E                TO TR221-RPT-TYP                    
105700             MOVE 'TRN TYP'           TO TR221-DATA-IN-ERROR              
105800             MOVE TR025-ERD-TRN-TYP   TO TR221-DATA-VALUE                 
105900             MOVE PC-ERROR            TO TR221-ERROR-TYPE                 
106000             MOVE 'INVALID TRN TYP'   TO TR221-ERROR-MSG                  
106100             ADD +1     TO PA-TOT-BAD-TRN-TYP                             
106200             ADD +1     TO PA-TOTAL-ERROR-COUNT                           
106300             PERFORM 6250-MOVE-LIKE-RPT-FIELDS                            
106400             PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                          
106500             PERFORM 7300-INSERT-TOUTTR7-RPT                              
106600             PERFORM 2600-CHECK-HOLD-FIELDS                               
106700                                                                          
106800             SET PS-GOOD-RECORD-NO TO TRUE                                
106900             PERFORM 6000-READ-RCVD-FILE                                  
107000                UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT                   
107100                                                                          
107200             PERFORM 2610-RESET-SWITCHES                                  
107300                                                                          
107400     END-EVALUATE.                                                        
107500                                                                          
107600     PERFORM 2615-CHECK-COMMIT-FIELDS.                                    
107700                                                                          
107800     IF PS-NOT-SAME-COMMIT-FIELDS                                         
107900         PERFORM 4100-COMMIT-CHECK                                        
108000     END-IF.                                                              
108100                                                                          
108200 EJECT                                                                    
108300                                                                          
108400******************************************************************        
108500* AN ADD WHERE BOTH ERD AND LOG RECORD TYPES ARE PRESENT AND     *        
108600* ERDRSN, LOGVS, AND LOGUPC MAY OR MAY NOT BE PRESENT.           *        
108700******************************************************************        
108800 2100-GROUP-ADD.                                                          
108900                                                                          
109000     EVALUATE TR025-ERD-REC-TYP-CDE                                       
109100         WHEN PC-ERD                                                      
109200             ADD +1 TO PA-TOT-ERD-RECS-READ                               
109300             MOVE TR025-ERD-PO-NBR      TO IMRCPO-PO-NBR                  
109400             MOVE TR025-ERD-PO-RCVD-DELY-DTE (1:4) TO                     
109500                 PV-REFORMAT-TO-DB2-CY                                    
109600             MOVE TR025-ERD-PO-RCVD-DELY-DTE (5:2) TO                     
109700                 PV-REFORMAT-TO-DB2-MM                                    
109800             MOVE TR025-ERD-PO-RCVD-DELY-DTE (7:2) TO                     
109900                 PV-REFORMAT-TO-DB2-DD                                    
110000             MOVE PV-REFORMAT-TO-DB2-DTE           TO                     
110100                 PV-REFORMAT-10BYTE-FIELD                                 
110200             PERFORM 7000-SELECT-TIMRCPO                                  
110300             IF PS-TIMRCPO-ROW-IS-THERE                                   
110400                 INITIALIZE TR221-RECORD                                  
110500                 INITIALIZE TR221-REC-TYP-ERD                             
110600                 PERFORM 6300-PO-THERE-ON-ADD-ERROR                       
110700                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        
110800                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      
110900                 PERFORM 7300-INSERT-TOUTTR7-RPT                          
111000             ELSE                                                         
111100                 MOVE SPACES TO IMRCPO-VOY-CHG-RSN-DESC                   
111200                 MOVE TR025-ERD-PROCESS-SEQ-NBR                           
111300                         TO PV-HOLD-PROCESS-SEQ-NBR-ERD                   
111400                 PERFORM 3000-ERD-EDITS                                   
111500                 PERFORM 7010-SELECT-RCVD-SEQ-NBR-MAX                     
111600                 PERFORM 6425-LIKE-MOVES-INSERT-TIMRCPO                   
111700                 PERFORM 6450-MOVES-INSERT-TIMRCPO                        
111800             END-IF                                                       
111900                                                                          
112000         WHEN PC-ERDRSN                                                   
112100             ADD +1                  TO PA-TOT-ERDRSN-RECS-READ           
112200             IF PS-TIMRCPO-ROW-IS-THERE                                   
112300                 INITIALIZE TR221-RECORD                                  
112400                 INITIALIZE TR221-REC-TYP-ERDRSN                          
112500                 PERFORM 6300-PO-THERE-ON-ADD-ERROR                       
112600                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        
112700                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      
112800                 PERFORM 7300-INSERT-TOUTTR7-RPT                          
112900             ELSE                                                         
113000                 MOVE TR025-ERD-PROCESS-SEQ-NBR   TO                      
113100                            PV-HOLD-PROCESS-SEQ-NBR-ERDRSN                
113200                 PERFORM 6450-MOVES-INSERT-TIMRCPO                        
113300             END-IF                                                       
113400         WHEN PC-LOG                                                      
113500             ADD +1                  TO PA-TOT-LOG-RECS-READ              
113600             IF PS-TIMRCPO-ROW-IS-THERE                                   
113700                 INITIALIZE TR221-RECORD                                  
113800                 INITIALIZE TR221-REC-TYP-LOG                             
113900                 PERFORM 6300-PO-THERE-ON-ADD-ERROR                       
114000                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        
114100                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      
114200                 PERFORM 7300-INSERT-TOUTTR7-RPT                          
114300             ELSE                                                         
114400                 MOVE TR025-ERD-PROCESS-SEQ-NBR   TO                      
114500                            PV-HOLD-PROCESS-SEQ-NBR-LOG                   
114600*                PERFORM 3030-EDIT-CNTRY                                  
114700***              PERFORM 3035-EDIT-FCTRY-NAME                             
114800                 PERFORM 6450-MOVES-INSERT-TIMRCPO                        
114900                 PERFORM 7020-INSERT-TIMRCPO                              
115000                 IF PS-TIMRCPO-ADDED                                      
115100                     PERFORM 6700-SCM-PO-RCVG-ADD                         
115200                     PERFORM 3025-CHECK-SAIL-DTE                          
115300                 ELSE                                                     
115400                     CONTINUE                                             
115500                 END-IF                                                   
115600                 IF PS-TIMRCPO-ADDED                                      
115700                  AND PS-TPURCHS-ACTIVE                                   
115800                   INITIALIZE TM606-RECORD                                
115900                   MOVE PC-RC TO TM606-EXTR-PRCG-APPL-CDE                 
116000                   PERFORM A000-INSERT-TOUTTM1                            
116100                 END-IF                                                   
116200                 PERFORM 7280-ERD-ERDRSN-LOG-DETAIL                       
116300*                SET PS-POE-LBD-NO TO TRUE                                
116400             END-IF                                                       
116500         WHEN PC-LOGVS                                                    
116600*            ADD +1                  TO PA-TOT-LOGVS-RECS-READ            
116700             IF PS-TIMRCPO-ADDED                                          
116700                 CONTINUE                                                 
116800*                MOVE TR025-LOGVS-PO-NBR  TO IMRCVS-PO-NBR                
116900*                PERFORM 7100-SELECT-TIMRCVS                              
117000*                IF PS-TIMRCVS-ROW-IS-THERE                               
117100*                   INITIALIZE TR221-RECORD                               
117200*                   INITIALIZE TR221-REC-TYP-LOGVS                        
117300*                   PERFORM 6310-VS-THERE-ON-ADD-ERROR                    
117400*                   PERFORM 6250-MOVE-LIKE-RPT-FIELDS                     
117500*                   PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                   
117600*                   PERFORM 7300-INSERT-TOUTTR7-RPT                       
117700*                ELSE                                                     
117800*                   PERFORM 3200-EDIT-LOGVS                               
117900*                   PERFORM 6460-MOVES-INSERT-TIMRCVS                     
118000*                   PERFORM 7110-INSERT-TIMRCVS                           
118100*                   PERFORM 7285-PREP-DETAIL-TOUTTR7-VS                   
118200*                END-IF                                                   
118300             ELSE                                                         
118400                 INITIALIZE TR221-RECORD                                  
118500                 INITIALIZE TR221-REC-TYP-LOGVS                           
118600                 PERFORM 6300-PO-THERE-ON-ADD-ERROR                       
118700                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        
118800                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      
118900                 PERFORM 7300-INSERT-TOUTTR7-RPT                          
119000             END-IF                                                       
119100                                                                          
119200         WHEN PC-LOGUPC                                                   
119300*            ADD +1                  TO PA-TOT-LOGUPC-RECS-READ           
119400*            IF (PS-TIMRCPO-ADDED  AND                                    
119500*                PS-TIMRCVS-ADDED)                                        
119600*                PERFORM 3300-EDIT-LOGUPC                                 
119700*                PERFORM 6470-MOVES-INSERT-TIMRCUP                        
119800*                PERFORM 7210-INSERT-TIMRCUP                              
119900*                IF SQLCODE = +0                                          
120000*                    INITIALIZE TR221-RECORD                              
120100*                    INITIALIZE TR221-REC-TYP-LOGUPC                      
120200*                    PERFORM 7290-PREP-DETAIL-TOUTTR7-UPC                 
120300*                    PERFORM 7300-INSERT-TOUTTR7-RPT                      
120400*                ELSE                                                     
120500*                  INITIALIZE TR221-RECORD                                
120600*                  INITIALIZE TR221-REC-TYP-LOGUPC                        
120700*                  MOVE PC-E                          TO                  
120800*                      TR221-RPT-TYP                                      
120900*                  MOVE 'UPC NUMBER'                  TO                  
121000*                      TR221-DATA-IN-ERROR                                
121100*                  MOVE TR025-LOGUPC-UPC-NBR          TO                  
121200*                      TR221-DATA-VALUE                                   
121300*                  MOVE PC-ERROR                      TO                  
121400*                      TR221-ERROR-TYPE                                   
121500*                  MOVE                                                   
121600*                  'ADD SENT, UPC PREVIOUSLY SENT-NOT PROCESSED'          
121700*                   TO TR221-ERROR-MSG                                    
121800*                  PERFORM 6250-MOVE-LIKE-RPT-FIELDS                      
121900*                  PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                    
122000*                  PERFORM 7300-INSERT-TOUTTR7-RPT                        
122100*                END-IF                                                   
122200*            ELSE                                                         
122300                 IF PS-TIMRCPO-ROW-IS-THERE                               
122400                     INITIALIZE TR221-RECORD                              
122500                     INITIALIZE TR221-REC-TYP-LOGUPC                      
122600                     PERFORM 6300-PO-THERE-ON-ADD-ERROR                   
122700                     PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    
122800                     PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  
122900                     PERFORM 7300-INSERT-TOUTTR7-RPT                      
123000*                ELSE                                                     
123100*                    IF PS-TIMRCVS-ROW-IS-THERE                           
123200*                        INITIALIZE TR221-RECORD                          
123300*                        INITIALIZE TR221-REC-TYP-LOGUPC                  
123400*                        PERFORM 6310-VS-THERE-ON-ADD-ERROR               
123500*                        PERFORM 6250-MOVE-LIKE-RPT-FIELDS                
123600*                        PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS              
123700*                        PERFORM 7300-INSERT-TOUTTR7-RPT                  
123800*                    END-IF                                               
123900                 END-IF                                                   
124000*            END-IF                                                       
124100                                                                          
124200         WHEN OTHER                                                       
124300             INITIALIZE TR221-RECORD                                      
124400             PERFORM 6250-MOVE-LIKE-RPT-FIELDS                            
124500                 MOVE PC-E                          TO                    
124600                    TR221-RPT-TYP                                         
124700                 MOVE 'RECORD TYPE'                 TO                    
124800                    TR221-DATA-IN-ERROR                                   
124900                 MOVE TR025-ERD-REC-TYP-CDE         TO                    
125000                    SAVE1-DATA-VALUE                                      
125100                 MOVE PC-ERROR                      TO                    
125200                    TR221-ERROR-TYPE                                      
125300             MOVE 'INVALID RECORD TYPE--NOT PROCESSED'                    
125400                                       TO TR221-ERROR-MSG                 
125500             PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                          
125600             PERFORM 7300-INSERT-TOUTTR7-RPT                              
125700     END-EVALUATE.                                                        
125800                                                                          
125900     PERFORM 2600-CHECK-HOLD-FIELDS.                                      
126000                                                                          
126100     SET PS-GOOD-RECORD-NO TO TRUE.                                       
126200     PERFORM 6000-READ-RCVD-FILE                                          
126300         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                         
126400                                                                          
126500     PERFORM 2610-RESET-SWITCHES.                                         
126600                                                                          
126700 EJECT                                                                    
126800                                                                          
126900******************************************************************        
127000* PROCESS CHANGE TRANSACTIONS.                                   *        
127100******************************************************************        
127200 2300-CHANGE.                                                             
127300                                                                          
127400     EVALUATE TR025-ERD-REC-TYP-CDE                                       
127500         WHEN PC-ERD                                                      
127600         WHEN PC-ERDRSN                                                   
127700         WHEN PC-LOG                                                      
127800             PERFORM 2305-PROCESS-ERD-LOG-CHG                             
127900                                                                          
128000         WHEN PC-LOGVS                                                    
128100*            PERFORM 2335-PROCESS-LOGVS-CHG                               
128200             PERFORM 2600-CHECK-HOLD-FIELDS                               
128300             SET PS-GOOD-RECORD-NO TO TRUE                                
128400             PERFORM 6000-READ-RCVD-FILE                                  
128500                 UNTIL PS-GOOD-RECORD OR                                  
128600                       PS-END-OF-INPUT                                    
128700             PERFORM 2610-RESET-SWITCHES                                  
128800                                                                          
128900         WHEN PC-LOGUPC                                                   
129000*            PERFORM 2355-PROCESS-LOGUPC-CHG                              
129100             PERFORM 2600-CHECK-HOLD-FIELDS                               
129200             SET PS-GOOD-RECORD-NO TO TRUE                                
129300             PERFORM 6000-READ-RCVD-FILE                                  
129400                 UNTIL PS-GOOD-RECORD OR                                  
129500                       PS-END-OF-INPUT                                    
129600             PERFORM 2610-RESET-SWITCHES                                  
129700                                                                          
129800     END-EVALUATE.                                                        
129900                                                                          
130000******************************************************************        
130100* PROCESS CHANGE TRANSACTIONS FOR ERD, ERDRSN, AND LOG RECORDS.  *        
130200******************************************************************        
130300 2305-PROCESS-ERD-LOG-CHG.                                                
130400                                                                          
130500*    INITIALIZE PV-VENDOR-STYLE-UPC-TABLE.                                
130600*    SET VS-INDX TO +1.                                                   
130700                                                                          
130800     MOVE TR025-ERD-PO-NBR                   TO                           
130900           IMRCPO-PO-NBR.                                                 
131000     MOVE TR025-ERD-PO-RCVD-DELY-DTE (1:4)   TO                           
131100           PV-REFORMAT-TO-DB2-CY.                                         
131200     MOVE TR025-ERD-PO-RCVD-DELY-DTE (5:2)   TO                           
131300           PV-REFORMAT-TO-DB2-MM.                                         
131400     MOVE TR025-ERD-PO-RCVD-DELY-DTE (7:2)   TO                           
131500           PV-REFORMAT-TO-DB2-DD.                                         
131600     MOVE PV-REFORMAT-TO-DB2-DTE             TO                           
131700           PV-REFORMAT-10BYTE-FIELD.                                      
131800     PERFORM 7000-SELECT-TIMRCPO.                                         
131900                                                                          
132000     IF PS-TIMRCPO-ROW-IS-THERE                                           
132100         PERFORM 2310-PROCESS-ERD-LOG-LOOP                                
132200     ELSE                                                                 
132300         INITIALIZE TR221-RECORD                                          
132400         INITIALIZE TR221-REC-TYP-ERD                                     
132500         SET PS-CHANGE-FOUND      TO TRUE                                 
132600         SET PS-CHANGE-ADD        TO TRUE                                 
132700         MOVE PC-E                TO TR221-RPT-TYP                        
132800         MOVE 'PO NUMBER'         TO TR221-DATA-IN-ERROR                  
132900         MOVE TR025-ERD-PO-NBR    TO TR221-DATA-VALUE                     
133000         MOVE PC-WARNING          TO TR221-ERROR-TYPE                     
133100         MOVE 'CHANGE SENT & PO NOT FOUND, PO ADDED'  TO                  
133200               TR221-ERROR-MSG                                            
133300         PERFORM 6250-MOVE-LIKE-RPT-FIELDS                                
133400         PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                              
133500         PERFORM 7300-INSERT-TOUTTR7-RPT                                  
133600         SET PS-ADD-FOR-CHANGES-DONE-NO TO TRUE                           
133700         PERFORM 2325-ADD-FOR-CHANGES                                     
133800             UNTIL PS-ADD-FOR-CHANGES-DONE  OR                            
133900                   PS-END-OF-INPUT                                        
134000     END-IF.                                                              
134100                                                                          
134200******************************************************************        
134300* PROCESS ERD, ERDRSN, & LOG RECORD CHANGE TRANSACTIONS.  THIS   *        
134400* PARAGRAPH PERFORMS PARA 2315- WHICH MOVES TR025 INPUT FIELDS   *        
134500* INTO THE TIMRCPO DCLGEN FIELDS.                                *        
134600******************************************************************        
134700 2310-PROCESS-ERD-LOG-LOOP.                                               
134800                                                                          
134900     PERFORM 7630-MOVES-AUDIT-TAURCPO.                                    
135000                                                                          
135100     SET PS-CHANGE-FOUND-PO-NO  TO TRUE.                                  
135200     SET PS-ERD-ERDRSN-LOG-LOOP TO TRUE.                                  
135300     MOVE SPACES  TO IMRCPO-VOY-CHG-RSN-DESC.                             
135400     MOVE ZEROES  TO PV-SEQ-NBR-ERD                                       
135500                     PV-SEQ-NBR-ERDRSN                                    
135600                     PV-SEQ-NBR-LOG.                                      
135700                                                                          
135800     PERFORM 2315-PROCESS-ERD-LOG-SENT                                    
135900         UNTIL (TR025-ERD-REC-TYP-CDE           NOT =                     
136000                PC-ERD AND PC-ERDRSN AND PC-LOG)        OR                
136100                PS-ERD-ERDRSN-LOG-LOOP-NO               OR                
136200                PS-END-OF-INPUT.                                          
136300                                                                          
136400     PERFORM 2320-COMPARE-FOR-CHANGES                                     
136500     IF PS-CHANGE-FOUND-PO                                                
136600         PERFORM 7635-DELETE-TIMRCPO                                      
136700         PERFORM 7645-INSERT-TAURCPO                                      
136800         PERFORM 7999-SET-CURRENT-TMST                                    
136900         MOVE PC-CURRENT-PROGRAM-NAME      TO                             
137000               IMRCPO-LAST-UPD-BY-USR-ID                                  
137100         MOVE PV-CURRENT-TMST              TO                             
137200               IMRCPO-LAST-UPD-TMST                                       
137300         PERFORM 7020-INSERT-TIMRCPO                                      
137400         PERFORM 3025-CHECK-SAIL-DTE                                      
137500         PERFORM 7282-TIMRCPO-DCLGEN-TO-DETAIL                            
137600         ADD +1 TO PA-TOT-RCPO-CHANGES                                    
137700         ADD +1 TO PA-TOT-RECS-CHANGED                                    
137800     END-IF.                                                              
137900                                                                          
138000******************************************************************        
138100* MOVE INPUT FIELDS TO TIMRCPO DCLGEN FIELDS.                    *        
138200******************************************************************        
138300 2315-PROCESS-ERD-LOG-SENT.                                               
138400                                                                          
138500     EVALUATE TR025-ERD-REC-TYP-CDE                                       
138600         WHEN PC-ERD                                                      
138700             PERFORM 3000-ERD-EDITS                                       
138800             MOVE TR025-ERD-PROCESS-SEQ-NBR      TO                       
138900                   PV-SEQ-NBR-ERD                                         
139000         WHEN PC-ERDRSN                                                   
139100             MOVE TR025-ERDRSN-PROCESS-SEQ-NBR   TO                       
139200                   PV-SEQ-NBR-ERDRSN                                      
139300         WHEN PC-LOG                                                      
139400*            PERFORM 3030-EDIT-CNTRY                                      
139500***          PERFORM 3035-EDIT-FCTRY-NAME                                 
139600             MOVE TR025-LOG-PROCESS-SEQ-NBR      TO                       
139700                   PV-SEQ-NBR-LOG                                         
139800     END-EVALUATE.                                                        
139900                                                                          
140000     PERFORM 6450-MOVES-INSERT-TIMRCPO.                                   
140100                                                                          
140200*    IF TR025-ERD-REC-TYP-CDE = PC-LOG                                    
140300*        SET PS-POE-LBD-NO TO TRUE                                        
140400*    END-IF.                                                              
140500                                                                          
140600     PERFORM 2600-CHECK-HOLD-FIELDS.                                      
140700                                                                          
140800     SET PS-GOOD-RECORD-NO TO TRUE.                                       
140900     PERFORM 6000-READ-RCVD-FILE                                          
141000         UNTIL PS-GOOD-RECORD OR                                          
141100               PS-END-OF-INPUT.                                           
141200                                                                          
141300     PERFORM 2610-RESET-SWITCHES.                                         
141400                                                                          
141500******************************************************************        
141600* COMPARE THE INPUT FIELDS THAT WERE LOADED INTO THE TIMRCPO     *        
141700* DCLGEN FIELDS AGAINST THE TIMRCPO FIELDS THAT WERE LOADED INTO *        
141800* THE TAURCPO FIELDS TO SEE IF A CHANGE HAS OCCURRED.            *        
141900******************************************************************        
142000 2320-COMPARE-FOR-CHANGES.                                                
142100                                                                          
142200     IF (AURCPO-IMPRT-TRIP-ID      NOT EQUAL                              
142300                                  IMRCPO-IMPRT-TRIP-ID)       OR          
142400        (AURCPO-CARR-SCAC-ID       NOT EQUAL                              
142500                                  IMRCPO-CARR-SCAC-ID)        OR          
142600        (AURCPO-IMPRT-VEH-NM       NOT EQUAL                              
142700                                  IMRCPO-IMPRT-VEH-NM)        OR          
142800        (AURCPO-FOB-CDE            NOT EQUAL                              
142900                                  IMRCPO-FOB-CDE)             OR          
143000        (AURCPO-DEST-POE-CDE       NOT EQUAL                              
143100                                  IMRCPO-DEST-POE-CDE)        OR          
143200        (AURCPO-TRIP-TYP-CDE       NOT EQUAL                              
143300                                  IMRCPO-TRIP-TYP-CDE)        OR          
143400        (AURCPO-POE-DELY-TMST      NOT EQUAL                              
143500                                  IMRCPO-POE-DELY-TMST)       OR          
143600        (AURCPO-DPRTR-TMST         NOT EQUAL                              
143700                                  IMRCPO-DPRTR-TMST)          OR          
143800        (AURCPO-VOY-CHG-RSN-DESC   NOT EQUAL                              
143900                                  IMRCPO-VOY-CHG-RSN-DESC)    OR          
144000        (AURCPO-PO-CART-CNT        NOT EQUAL                              
144100                                  IMRCPO-PO-CART-CNT)         OR          
144200        (AURCPO-PO-UNT-QTY         NOT EQUAL                              
144300                                  IMRCPO-PO-UNT-QTY)          OR          
144400        (AURCPO-PROD-FCTRY-NM      NOT EQUAL                              
144500                                  IMRCPO-PROD-FCTRY-NM)       OR          
144600        (AURCPO-C-O-PROD-CDE       NOT EQUAL                              
144700                                  IMRCPO-C-O-PROD-CDE)        OR          
144800        (AURCPO-PO-CBMT-QTY        NOT EQUAL                              
144900                                  IMRCPO-PO-CBMT-QTY)         OR          
145000        (AURCPO-PO-WT-KGRM-QTY     NOT EQUAL                              
145100                                  IMRCPO-PO-WT-KGRM-QTY)      OR          
145200        (AURCPO-ORGN-SHPD-FR-CDE   NOT EQUAL                              
145300                                  IMRCPO-ORGN-SHPD-FR-CDE)    OR          
145400        (AURCPO-CONSLR-SCAC-ID     NOT EQUAL                              
145500                                  IMRCPO-CONSLR-SCAC-ID)      OR          
145600        (AURCPO-EST-LBD-NM         NOT EQUAL                              
145700                                  IMRCPO-EST-LBD-NM)          OR          
145800        (AURCPO-EST-LBD-TMST       NOT EQUAL                              
145900                                  IMRCPO-EST-LBD-TMST)                    
146000        SET PS-CHANGE-FOUND-PO  TO TRUE                                   
146100        SET PS-CHANGE-FOUND     TO TRUE                                   
146200     END-IF.                                                              
146300                                                                          
146400******************************************************************        
146500* PROCESS ERD, ERDRSN, AND LOG ADDS FOR CHANGE TRANSACTIONS.     *        
146600* THESE TRANSACTIONS ARE REFERED TO AS 'B' CHANGE ADDS.          *        
146700******************************************************************        
146800 2325-ADD-FOR-CHANGES.                                                    
146900                                                                          
147000     EVALUATE TR025-ERD-REC-TYP-CDE                                       
147100         WHEN PC-ERD                                                      
147200             MOVE SPACES TO IMRCPO-VOY-CHG-RSN-DESC                       
147300             ADD +1 TO PA-TOT-ERD-RECS-READ                               
147400             MOVE TR025-ERD-PROCESS-SEQ-NBR TO                            
147500                   PV-HOLD-PROCESS-SEQ-NBR-ERD                            
147600             PERFORM 3000-ERD-EDITS                                       
147700             PERFORM 7010-SELECT-RCVD-SEQ-NBR-MAX                         
147800             PERFORM 6425-LIKE-MOVES-INSERT-TIMRCPO                       
147900             PERFORM 6450-MOVES-INSERT-TIMRCPO                            
148000                                                                          
148100         WHEN PC-ERDRSN                                                   
148200             ADD +1                  TO PA-TOT-ERDRSN-RECS-READ           
148300             MOVE TR025-ERD-PROCESS-SEQ-NBR      TO                       
148400                   PV-HOLD-PROCESS-SEQ-NBR-ERDRSN                         
148500             PERFORM 6450-MOVES-INSERT-TIMRCPO                            
148600                                                                          
148700         WHEN PC-LOG                                                      
148800             ADD +1                  TO PA-TOT-LOG-RECS-READ              
148900             MOVE TR025-ERD-PROCESS-SEQ-NBR      TO                       
149000                   PV-HOLD-PROCESS-SEQ-NBR-LOG                            
149100*            PERFORM 3030-EDIT-CNTRY                                      
149200***          PERFORM 3035-EDIT-FCTRY-NAME                                 
149300             PERFORM 6450-MOVES-INSERT-TIMRCPO                            
149400             PERFORM 6600-SCM-NAIL-DOWN-CHANGE                            
149500             PERFORM 7020-INSERT-TIMRCPO                                  
149600             PERFORM 3025-CHECK-SAIL-DTE                                  
149700             ADD +1                  TO PA-TOT-RCPO-CHANGES-B             
149800             ADD +1                  TO PA-TOT-RECS-CHANGED-B             
149900             SET PS-CHANGE-ADD       TO TRUE                              
150000             PERFORM 7280-ERD-ERDRSN-LOG-DETAIL                           
150100             SET PS-CHANGE-ADD-NO    TO TRUE                              
150200             SET PS-CHANGE-ADD-B     TO TRUE                              
150300*            SET PS-POE-LBD-NO       TO TRUE                              
150400                                                                          
150500         WHEN PC-LOGVS                                                    
151800             CONTINUE                                                     
150600*            SET PS-CHANGE-ADD       TO TRUE                              
150700*            PERFORM 2347-CHANGE-ADD-VS-ERROR                             
150800*            ADD +1                  TO PA-TOT-LOGVS-RECS-READ            
150900*            PERFORM 3200-EDIT-LOGVS                                      
151000*            PERFORM 6460-MOVES-INSERT-TIMRCVS                            
151100*            PERFORM 7110-INSERT-TIMRCVS                                  
151200*            PERFORM 7285-PREP-DETAIL-TOUTTR7-VS                          
151300*            SET PS-CHANGE-ADD-NO    TO TRUE                              
151400*            ADD +1                  TO PA-TOT-RCVS-CHANGES-B             
151500*            ADD +1                  TO PA-TOT-RECS-CHANGED-B             
151600                                                                          
151700         WHEN PC-LOGUPC                                                   
151800             CONTINUE                                                     
151800*            SET PS-CHANGE-ADD       TO TRUE                              
151900*            PERFORM 2357-CHANGE-ADD-UPC-ERROR                            
152000*            ADD +1                  TO PA-TOT-LOGUPC-RECS-READ           
152100*            PERFORM 3300-EDIT-LOGUPC                                     
152200*            PERFORM 6470-MOVES-INSERT-TIMRCUP                            
152300*            PERFORM 7210-INSERT-TIMRCUP                                  
152400*            IF SQLCODE = +0                                              
152500*                PERFORM 7290-PREP-DETAIL-TOUTTR7-UPC                     
152600*                PERFORM 7300-INSERT-TOUTTR7-RPT                          
152700*                SET PS-CHANGE-ADD-NO    TO TRUE                          
152800*                ADD +1              TO PA-TOT-RCUP-CHANGES-B             
152900*                ADD +1              TO PA-TOT-RECS-CHANGED-B             
153000*            ELSE                                                         
153100*                INITIALIZE TR221-RECORD                                  
153200*                INITIALIZE TR221-REC-TYP-LOGUPC                          
153300*                MOVE PC-E                  TO TR221-RPT-TYP              
153400*                MOVE 'UPC NUMBER'          TO TR221-DATA-IN-ERROR        
153500*                MOVE TR025-LOGUPC-UPC-NBR  TO TR221-DATA-VALUE           
153600*                MOVE PC-ERROR              TO TR221-ERROR-TYPE           
153700*                MOVE 'UPC FOUND SO UPC NOT ADDED'  TO                    
153800*                      TR221-ERROR-MSG                                    
153900*                PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        
154000*                PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      
154100*                PERFORM 7300-INSERT-TOUTTR7-RPT                          
154200*                SET PS-CHANGE-ADD-NO       TO TRUE                       
154300*            END-IF                                                       
154400                                                                          
154500     END-EVALUATE.                                                        
154600                                                                          
154700     PERFORM 2600-CHECK-HOLD-FIELDS.                                      
154800                                                                          
154900     SET PS-GOOD-RECORD-NO TO TRUE.                                       
155000     PERFORM 6000-READ-RCVD-FILE                                          
155100         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                         
155200                                                                          
155300     PERFORM 2610-RESET-SWITCHES.                                         
155400                                                                          
155500******************************************************************        
155600* PROCESS LOGVS AND LOGUPC ADDS FOR CHANGE TRANSACTIONS.         *        
155700* THESE TRANSACTIONS ARE REFERED TO AS 'Z' CHANGE ADDS.          *        
155800******************************************************************        
155900*2330-ADD-FOR-CHANGES-VS-UPC.                                             
156000                                                                          
156100*    EVALUATE TR025-ERD-REC-TYP-CDE                                       
156200*        WHEN PC-LOGVS                                                    
156300*            ADD +1                  TO PA-TOT-LOGVS-RECS-READ            
156400*            SET PS-CHANGE-ADD-VS-OR-UPC TO TRUE                          
156500*            PERFORM 3200-EDIT-LOGVS                                      
156600*            PERFORM 6460-MOVES-INSERT-TIMRCVS                            
156700*            PERFORM 7110-INSERT-TIMRCVS                                  
156800*            PERFORM 7285-PREP-DETAIL-TOUTTR7-VS                          
156900*            SET PS-CHANGE-ADD-VS-OR-UPC-NO TO TRUE                       
157000*            IF PS-CHANGE-ADD-B                                           
157100*                CONTINUE                                                 
157200*            ELSE                                                         
157300*                ADD +1 TO PA-TOT-RCVS-CHANGES-Z                          
157400*                ADD +1 TO PA-TOT-RECS-CHANGED-Z                          
157500*                PERFORM 2350-LOAD-VS-UPC-TABLE-VS                        
157600*            END-IF                                                       
157700                                                                          
157800*        WHEN PC-LOGUPC                                                   
157900*            ADD +1                  TO PA-TOT-LOGUPC-RECS-READ           
158000*            SET PS-CHANGE-ADD-VS-OR-UPC TO TRUE                          
158100*            PERFORM 3300-EDIT-LOGUPC                                     
158200*            PERFORM 6470-MOVES-INSERT-TIMRCUP                            
158300*            PERFORM 7210-INSERT-TIMRCUP                                  
158400*            PERFORM 7290-PREP-DETAIL-TOUTTR7-UPC                         
158500*            PERFORM 7300-INSERT-TOUTTR7-RPT                              
158600*            SET PS-CHANGE-ADD-VS-OR-UPC-NO TO TRUE                       
158700*            IF PS-CHANGE-ADD-B                                           
158800*                CONTINUE                                                 
158900*            ELSE                                                         
159000*                ADD +1 TO PA-TOT-RCUP-CHANGES-Z                          
159100*                ADD +1 TO PA-TOT-RECS-CHANGED-Z                          
159200*                PERFORM 2370-LOAD-VS-UPC-TABLE-UPC                       
159300*            END-IF                                                       
159400*                                                                         
159500*    END-EVALUATE.                                                        
159600                                                                          
159700******************************************************************        
159800* PROCESS VENDOR STYLE RECORD CHANGE TRANSACTIONS.               *        
159900******************************************************************        
160000*2335-PROCESS-LOGVS-CHG.                                                  
160100                                                                          
160200*    SET PS-CHANGE-FOUND-VS-NO TO TRUE.                                   
160300*                                                                         
160400*    MOVE TR025-LOGVS-PO-NBR TO IMRCVS-PO-NBR.                            
160500*    PERFORM 7100-SELECT-TIMRCVS.                                         
160600*    IF PS-TIMRCVS-ROW-IS-THERE                                           
160700*        PERFORM 2340-PROCESS-LOGVS-CHG-LOGVS                             
160800*    ELSE                                                                 
160900*        SET PS-CHANGE-ADD-VS-OR-UPC TO TRUE                              
161000*        PERFORM 2347-CHANGE-ADD-VS-ERROR                                 
161100*        SET PS-CHANGE-ADD-VS-OR-UPC-NO TO TRUE                           
161200*        PERFORM 2330-ADD-FOR-CHANGES-VS-UPC                              
161300*        SET PS-CHANGE-FOUND TO TRUE                                      
161400*    END-IF.                                                              
161500                                                                          
161600******************************************************************        
161700* PROCESS VENDOR STYLE RECORD CHANGE TRANSACTIONS.               *        
161800******************************************************************        
161900*2340-PROCESS-LOGVS-CHG-LOGVS.                                            
162000                                                                          
162100*    SET PS-CHANGE-C-VS  TO TRUE.                                         
162200*                                                                         
162300*    PERFORM 7530-MOVES-AUDIT-TAURCVS.                                    
162400*                                                                         
162500*    PERFORM 3200-EDIT-LOGVS.                                             
162600*                                                                         
162700*    PERFORM 6460-MOVES-INSERT-TIMRCVS.                                   
162800*                                                                         
162900*    PERFORM 2345-COMPARE-LOGVS-CHG.                                      
163000*    IF PS-CHANGE-FOUND-VS                                                
163100*        PERFORM 7540-DELETE-TIMRCVS-CHG                                  
163200*        PERFORM 7545-INSERT-TAURCVS                                      
163300*        PERFORM 7110-INSERT-TIMRCVS                                      
163400*        PERFORM 7285-PREP-DETAIL-TOUTTR7-VS                              
163500*        ADD +1 TO PA-TOT-RCVS-CHANGES                                    
163600*        ADD +1 TO PA-TOT-RECS-CHANGED                                    
163700*    END-IF.                                                              
163800                                                                          
163900*    SET PS-CHANGE-C-VS-NO  TO TRUE.                                      
164000                                                                          
164100*    PERFORM 2350-LOAD-VS-UPC-TABLE-VS.                                   
164200                                                                          
164300******************************************************************        
164400* COMPARE TAURCVS DCLGEN FIELDS AGAINST TIMRCVS DCLGEN FIELDS TO *        
164500* SEE IF A CHANGE HAS OCCURRED.                                  *        
164600******************************************************************        
164700*2345-COMPARE-LOGVS-CHG.                                                  
164800                                                                          
164900*    IF (AURCVS-VS-CART-CNT          NOT EQUAL                            
165000*                                 IMRCVS-VS-CART-CNT)         OR          
165100*       (AURCVS-VS-UNT-QTY           NOT EQUAL                            
165200*                                 IMRCVS-VS-UNT-QTY)          OR          
165300*       (AURCVS-VS-CBMT-QTY          NOT EQUAL                            
165400*                                 IMRCVS-VS-CBMT-QTY)         OR          
165500*       (AURCVS-VS-WT-KGRM-QTY       NOT EQUAL                            
165600*                                 IMRCVS-VS-WT-KGRM-QTY)                  
165700*       SET PS-CHANGE-FOUND-VS TO TRUE                                    
165800*       SET PS-CHANGE-FOUND    TO TRUE                                    
165900*    END-IF.                                                              
166000                                                                          
166100******************************************************************        
166200* ERROR FOR CONDITION WHERE A VS CHANGE IS SENT AND NO VS EXISTS.*        
166300******************************************************************        
166400*2347-CHANGE-ADD-VS-ERROR.                                                
166500                                                                          
166600*    INITIALIZE TR221-RECORD.                                             
166700*    INITIALIZE TR221-REC-TYP-LOGVS.                                      
166800*    MOVE PC-E                TO TR221-RPT-TYP.                           
166900*    MOVE 'VS NUMBER'         TO TR221-DATA-IN-ERROR.                     
167000*    MOVE TR025-LOGVS-VS-NBR  TO TR221-DATA-VALUE.                        
167100*    MOVE PC-WARNING          TO TR221-ERROR-TYPE.                        
167200*    MOVE 'CHANGE SENT & VS NOT FOUND, VS ADDED'  TO                      
167300*          TR221-ERROR-MSG.                                               
167400*    PERFORM 6250-MOVE-LIKE-RPT-FIELDS.                                   
167500*    PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS.                                 
167600*    PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
167700                                                                          
167800******************************************************************        
167900* MOAD THE VENDOR STYLE / UPC TABLE WITH THE VENDOR STYLE NBR.   *        
168000******************************************************************        
168100*2350-LOAD-VS-UPC-TABLE-VS.                                               
168200                                                                          
168300*    MOVE TR025-LOGVS-VS-NBR TO PV-TABLE-VS-NBR (VS-INDX).                
168400*    SET VS-INDX UP BY +1.                                                
168500                                                                          
168600******************************************************************        
168700* PROCESS UPC RECORD CHANGE TRANSACTIONS.                        *        
168800******************************************************************        
168900*2355-PROCESS-LOGUPC-CHG.                                                 
169000                                                                          
169100*    SET PS-CHANGE-FOUND-UPC-NO TO TRUE.                                  
169200*                                                                         
169300*    MOVE TR025-LOGUPC-PO-NBR  TO IMRCUP-PO-NBR.                          
169400*    MOVE TR025-LOGUPC-VS-NBR  TO IMRCUP-VS-NBR.                          
169500*    MOVE TR025-LOGUPC-UPC-NBR TO IMRCUP-UPC-NBR.                         
169600*    PERFORM 7200-SELECT-TIMRCUP.                                         
169700*    IF PS-TIMRCUP-ROW-IS-THERE                                           
169800*        PERFORM 2360-PROCESS-LOGUPC-CHG-LOGUPC                           
169900*    ELSE                                                                 
170000*        SET PS-CHANGE-ADD-VS-OR-UPC TO TRUE                              
170100*        PERFORM 2357-CHANGE-ADD-UPC-ERROR                                
170200*        SET PS-CHANGE-ADD-VS-OR-UPC-NO TO TRUE                           
170300*        PERFORM 2330-ADD-FOR-CHANGES-VS-UPC                              
170400*        SET PS-CHANGE-FOUND TO TRUE                                      
170500*    END-IF.                                                              
170600                                                                          
170700******************************************************************        
170800* ERROR FOR CONDITION WHERE UPC CHANGE IS SENT AND NO UPC EXISTS.*        
170900******************************************************************        
171000*2357-CHANGE-ADD-UPC-ERROR.                                               
171100                                                                          
171200*    INITIALIZE TR221-RECORD.                                             
171300*    INITIALIZE TR221-REC-TYP-LOGUPC.                                     
171400*    MOVE PC-E                  TO TR221-RPT-TYP.                         
171500*    MOVE 'UPC NUMBER'          TO TR221-DATA-IN-ERROR.                   
171600*    MOVE TR025-LOGUPC-UPC-NBR  TO TR221-DATA-VALUE.                      
171700*    MOVE PC-WARNING            TO TR221-ERROR-TYPE.                      
171800*    MOVE 'CHANGE SENT & UPC NOT FOUND, UPC ADDED'  TO                    
171900*          TR221-ERROR-MSG.                                               
172000*    PERFORM 6250-MOVE-LIKE-RPT-FIELDS.                                   
172100*    PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS.                                 
172200*    PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
172300                                                                          
172400******************************************************************        
172500* PROCESS UPC RECORD CHANGE TRANSACTIONS.                        *        
172600******************************************************************        
172700*2360-PROCESS-LOGUPC-CHG-LOGUPC.                                          
172800                                                                          
172900*    SET PS-CHANGE-C-UPC  TO TRUE.                                        
173000*                                                                         
173100*    PERFORM 7430-MOVES-AUDIT-TAURCUP.                                    
173200*                                                                         
173300*    PERFORM 3300-EDIT-LOGUPC.                                            
173400*                                                                         
173500*    PERFORM 6470-MOVES-INSERT-TIMRCUP.                                   
173600*                                                                         
173700*    PERFORM 2365-COMPARE-LOGUPC-CHG                                      
173800*    IF PS-CHANGE-FOUND-UPC                                               
173900*        PERFORM 7440-DELETE-TIMRCUP-CHG                                  
174000*        PERFORM 7445-INSERT-TAURCUP                                      
174100*        PERFORM 7210-INSERT-TIMRCUP                                      
174200*        PERFORM 7290-PREP-DETAIL-TOUTTR7-UPC                             
174300*        PERFORM 7300-INSERT-TOUTTR7-RPT                                  
174400*        ADD +1 TO PA-TOT-RCUP-CHANGES                                    
174500*        ADD +1 TO PA-TOT-RECS-CHANGED                                    
174600*    END-IF.                                                              
174700*                                                                         
174800*    SET PS-CHANGE-C-UPC-NO  TO TRUE.                                     
174900                                                                          
175000*    PERFORM 2370-LOAD-VS-UPC-TABLE-UPC.                                  
175100                                                                          
175200******************************************************************        
175300* COMPARE TAURCUP DCLGEN FIELDS WITH TIMRCUP DCLGEN FIELDS TO    *        
175400* SEE IF A CHANGE HAS OCCURRED.                                  *        
175500******************************************************************        
175600*2365-COMPARE-LOGUPC-CHG.                                                 
175700                                                                          
175800*    IF (AURCUP-UPC-CART-CNT       NOT EQUAL                              
175900*                                 IMRCUP-UPC-CART-CNT)        OR          
176000*       (AURCUP-UPC-UNT-QTY        NOT EQUAL                              
176100*                                 IMRCUP-UPC-UNT-QTY)         OR          
176200*       (AURCUP-UPC-CBMT-QTY       NOT EQUAL                              
176300*                                 IMRCUP-UPC-CBMT-QTY)        OR          
176400*       (AURCUP-UPC-WT-KGRM-QTY    NOT EQUAL                              
176500*                                 IMRCUP-UPC-WT-KGRM-QTY)                 
176600*       SET PS-CHANGE-FOUND-UPC TO TRUE                                   
176700*       SET PS-CHANGE-FOUND     TO TRUE                                   
176800*    END-IF.                                                              
176900                                                                          
177000******************************************************************        
177100* LOAD THE VENDOR STYLE / UPC TABLE WITH THE UPC NUMBER.         *        
177200******************************************************************        
177300*2370-LOAD-VS-UPC-TABLE-UPC.                                              
177400                                                                          
177500*    SET VS-INDX TO +1.                                                   
177600*                                                                         
177700*    SEARCH PV-VS-UPC-TABLE VARYING VS-INDX                               
177800*                                                                         
177900*       AT END                                                            
178000*              CONTINUE                                                   
178100*       WHEN TR025-LOGUPC-VS-NBR EQUAL PV-TABLE-VS-NBR (VS-INDX)          
178200*           IF PV-TABLE-UPC-NBR (VS-INDX) EQUAL ZEROES                    
178300*               MOVE TR025-LOGUPC-UPC-NBR       TO                        
178400*                         PV-TABLE-UPC-NBR (VS-INDX)                      
178500*           ELSE                                                          
178600*               PERFORM UNTIL PV-TABLE-VS-NBR (VS-INDX)                   
178700*                              EQUAL SPACES OR                            
178800*                              VS-INDX > 2000                             
178900*                   SET VS-INDX UP BY +1                                  
179000*               END-PERFORM                                               
179100*               MOVE TR025-LOGUPC-VS-NBR        TO                        
179200*                         PV-TABLE-VS-NBR (VS-INDX)                       
179300*               MOVE TR025-LOGUPC-UPC-NBR       TO                        
179400*                         PV-TABLE-UPC-NBR (VS-INDX)                      
179500*           END-IF                                                        
179600*    END-SEARCH.                                                          
179700                                                                          
179800*    SET VS-INDX UP BY +1.                                                
179900                                                                          
180000******************************************************************        
180100* DETERMINE IF IT'S TIME TO PROCESS THE VS/UPC INTERNAL TABLE.   *        
180200******************************************************************        
180300*2375-TABLE-COMPARE-CHECK.                                                
180400                                                                          
180500*    PERFORM 7350-OPEN-RCVS-UPC-CURSOR.                                   
180600*    PERFORM 7360-FETCH-RCVS-UPC-CURSOR.                                  
180700*                                                                         
180800*    IF PS-EOC-RCVS-UPC-CURSOR                                            
180900*        PERFORM 7355-CLOSE-RCVS-UPC-CURSOR                               
181000*    ELSE                                                                 
181100*        MOVE PV-UPC-CURSOR-VS-NBR TO PV-HOLD-CURSOR-VS-NBR               
181200*        PERFORM 2380-TABLE-CURSOR-COMPARE                                
181300*            UNTIL PS-EOC-RCVS-UPC-CURSOR                                 
181400*        SET PS-EOC-RCVS-UPC-CURSOR-NO TO TRUE                            
181500*    END-IF.                                                              
181600*                                                                         
181700******************************************************************        
181800* COMPARE THE VENDOR STYLES / UPCS ON THE INTERNAL TABLE (WHICH  *        
181900* WAS LOADED WITH INPUT DATA) WITH THE ONES IN THE CURSOR FROM   *        
182000* THE TIMRCVS AND TIMRCUP TABLES.  THE OBJECTIVE OF THIS COMPARE *        
182100* IS TO IDENTIFY THE VENDOR STYLES AND/OR UPC'S ON THE DB2       *        
182200* TABLES (THESE ROWS WOULD BE IN THE CURSOR) THAT WERE NOT SENT  *        
182300* WITH THE INPUT CHANGE TRANSACTION ( THESE RECORDS WOULD BE IN  *        
182400* THE INTERNAL TABLE) AND DELETE THESE ROWS FROM THE TIMRCVS AND *        
182500* TIMRCUP TABLES.  THESE RECORDS ARE REFERED TO AS 'E' DELETES.  *        
182600******************************************************************        
182700*2380-TABLE-CURSOR-COMPARE.                                               
182800                                                                          
182900*    SET VS-INDX       TO +1.                                             
183000*    SEARCH PV-VS-UPC-TABLE VARYING VS-INDX                               
183100*                                                                         
183200*          AT END                                                         
183300*            PERFORM 2385-PROCESS-SEARCH-AT-END-ERR                       
183400*            PERFORM 7355-CLOSE-RCVS-UPC-CURSOR                           
183500*                                                                         
183600*          WHEN PV-TABLE-VS-NBR (VS-INDX) EQUAL SPACES                    
183700*              PERFORM 2390-PROCESS-VS-E-DELETE-REC                       
183800*              IF PV-UPC-CURSOR-VS-NBR NOT EQUAL                          
183900*                 PV-HOLD-CURSOR-VS-NBR                                   
184000*                  MOVE PV-UPC-CURSOR-VS-NBR TO                           
184100*                        PV-HOLD-CURSOR-VS-NBR                            
184200*                  PERFORM 7360-FETCH-RCVS-UPC-CURSOR                     
184300*                      UNTIL (PV-UPC-CURSOR-VS-NBR NOT =                  
184400*                            PV-HOLD-CURSOR-VS-NBR)    OR                 
184500*                            PS-EOC-RCVS-UPC-CURSOR                       
184600*                  IF PS-EOC-RCVS-UPC-CURSOR                              
184700*                      PERFORM 7355-CLOSE-RCVS-UPC-CURSOR                 
184800*                  END-IF                                                 
184900*              ELSE                                                       
185000*              PERFORM UNTIL (PV-UPC-CURSOR-VS-NBR NOT EQUAL              
185100*                             PV-HOLD-CURSOR-VS-NBR)    OR                
185200*                             PS-EOC-RCVS-UPC-CURSOR                      
185300*                 MOVE PV-UPC-CURSOR-VS-NBR TO                            
185400*                       PV-HOLD-CURSOR-VS-NBR                             
185500*                 PERFORM 7360-FETCH-RCVS-UPC-CURSOR                      
185600*                 IF PS-EOC-RCVS-UPC-CURSOR                               
185700*                     PERFORM 7355-CLOSE-RCVS-UPC-CURSOR                  
185800*                 END-IF                                                  
185900*              END-PERFORM                                                
186000*              END-IF                                                     
186100*                                                                         
186200*          WHEN PV-TABLE-VS-NBR (VS-INDX) EQUAL                           
186300*                PV-UPC-CURSOR-VS-NBR                                     
186400*              MOVE PV-UPC-CURSOR-VS-NBR  TO                              
186500*                    PV-HOLD-CURSOR-VS-NBR                                
186600*              PERFORM UNTIL (PV-UPC-CURSOR-VS-NBR NOT EQUAL              
186700*                       PV-HOLD-CURSOR-VS-NBR)     OR                     
186800*                       PS-EOC-RCVS-UPC-CURSOR                            
186900*                                                                         
187000*                  SEARCH PV-VS-UPC-TABLE VARYING VS-INDX                 
187100*                        AT END                                           
187200*                          PERFORM 2385-PROCESS-SEARCH-AT-END-ERR         
187300*                          PERFORM 7355-CLOSE-RCVS-UPC-CURSOR             
187400*                                                                         
187500*                        WHEN PV-TABLE-UPC-NBR (VS-INDX) = ZEROES         
187600*                            PERFORM 2395-PROCESS-UPC-E-DELETE-REC        
187700*                            MOVE PV-UPC-CURSOR-VS-NBR TO                 
187800*                                  PV-HOLD-CURSOR-VS-NBR                  
187900*                            PERFORM 7360-FETCH-RCVS-UPC-CURSOR           
188000*                            SET VS-INDX TO +1                            
188100*                            IF PS-EOC-RCVS-UPC-CURSOR                    
188200*                                PERFORM                                  
188300*                                  7355-CLOSE-RCVS-UPC-CURSOR             
188400*                            END-IF                                       
188500*                                                                         
188600*                        WHEN (PV-UPC-CURSOR-UPC-NBR EQUAL                
188700*                              PV-TABLE-UPC-NBR (VS-INDX))                
188800*                             AND                                         
188900*                             (PV-UPC-CURSOR-VS-NBR EQUAL                 
189000*                              PV-TABLE-VS-NBR (VS-INDX))                 
189100*                             MOVE PV-UPC-CURSOR-VS-NBR TO                
189200*                                   PV-HOLD-CURSOR-VS-NBR                 
189300*                             PERFORM 7360-FETCH-RCVS-UPC-CURSOR          
189400*                             SET VS-INDX TO +1                           
189500*                             IF PS-EOC-RCVS-UPC-CURSOR                   
189600*                                 PERFORM                                 
189700*                                   7355-CLOSE-RCVS-UPC-CURSOR            
189800*                             END-IF                                      
189900*                  END-SEARCH                                             
190000*              END-PERFORM                                                
190100*    END-SEARCH.                                                          
190200                                                                          
190300******************************************************************        
190400* THE INTERNAL VS/UPC TABLE HAS EXCEEDED ITS SIZE LIMIT.         *        
190500* NOTE:  SOME VS AND/OR UPC'S THAT SHOULD HAVE BEEN DELETED MAY  *        
190600* NOT HAVE BEEN DELETED.                                         *        
190700******************************************************************        
190800*2385-PROCESS-SEARCH-AT-END-ERR.                                          
190900*                                                                         
191000*    INITIALIZE TR221-RECORD.                                             
191100*    INITIALIZE TR221-REC-TYP-ERD.                                        
191200*    MOVE PC-E                          TO TR221-RPT-TYP.                 
191300*    MOVE PV-HOLD-TR025-PO-NBR          TO TR221-PO-NBR.                  
191400*    MOVE PV-HOLD-TR025-EXTL-REF-NBR    TO TR221-EXTL-REF-NBR.            
191500*    MOVE PV-HOLD-TR025-PO-RCVD-DELY-DTE                                  
191600*                                      TO TR221-PO-RCVD-DELY-DTE.         
191700*    MOVE PV-HOLD-ORGN-SHPD-FR-CDE                                        
191800*                                      TO TR221-ORGN-SHPD-FR-CDE.         
191900*    MOVE PV-HOLD-TR025-PROCESS-SEQ-NBR                                   
192000*                                      TO TR221-PROCESS-SEQ-NBR.          
192100*    MOVE PV-HOLD-DAT-SRC-ENT-ID       TO TR221-DAT-SRC-ENT-ID.           
192200*    MOVE SPACES                       TO TR221-REC-TYP-ERD               
192300*                                          TR221-DATA-IN-ERROR            
192400*                                          TR221-DATA-VALUE               
192500*                                          TR221-TRN-TYP                  
192600*                                          TR221-PO-RCVD-DELY-TM.         
192700*    MOVE PC-ERROR                      TO TR221-ERROR-TYPE.              
192800*    MOVE 'CALL PROGRAMMING- INTERNAL TABLE SIZE EXCEEDED'                
192900*                                       TO TR221-ERROR-MSG.               
193000*    PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
193100                                                                          
193200******************************************************************        
193300* THE VENDOR STYLE ROW ON THE TIMRCVS TABLE WAS NOT SENT ON THE  *        
193400* CHANGE TRANSACTION SO IT WILL NEED TO BE DELETED OFF OF THE    *        
193500* DB2 TABLE.                                                     *        
193600******************************************************************        
193700*2390-PROCESS-VS-E-DELETE-REC.                                            
193800*                                                                         
193900*    MOVE PV-UPC-CURSOR-VS-NBR  TO IMRCVS-VS-NBR.                         
194000*    PERFORM 7105-SELECT-TIMRCVS-CHG.                                     
194100*    PERFORM 7530-MOVES-AUDIT-TAURCVS.                                    
194200*    PERFORM 7540-DELETE-TIMRCVS-CHG.                                     
194300*    SET PS-VS-E-DELETE TO TRUE.                                          
194400*    PERFORM 7545-INSERT-TAURCVS.                                         
194500*    PERFORM 2397-DISPLAY-E-VS.                                           
194600*    ADD +1 TO PA-TOT-RCVS-DELETES-E.                                     
194700*    ADD +1 TO PA-TOT-RECS-DELETED-E.                                     
194800*                                                                         
194900*    PERFORM 7365-OPEN-UPC-CURSOR.                                        
195000*    PERFORM 7375-FETCH-UPC-CURSOR.                                       
195100*    IF PS-EOC-UPC-CURSOR                                                 
195200*        PERFORM 7370-CLOSE-UPC-CURSOR                                    
195300*    ELSE                                                                 
195400*        PERFORM UNTIL PS-EOC-UPC-CURSOR                                  
195500*           PERFORM 7430-MOVES-AUDIT-TAURCUP                              
195600*           PERFORM 7440-DELETE-TIMRCUP-CHG                               
195700*           PERFORM 7445-INSERT-TAURCUP                                   
195800*           PERFORM 2398-DISPLAY-E-UPC                                    
195900*           PERFORM 7375-FETCH-UPC-CURSOR                                 
196000*           ADD +1 TO PA-TOT-RCUP-DELETES-E                               
196100*           ADD +1 TO PA-TOT-RECS-DELETED-E                               
196200*           IF PS-EOC-UPC-CURSOR                                          
196300*               PERFORM 7370-CLOSE-UPC-CURSOR                             
196400*           END-IF                                                        
196500*        END-PERFORM                                                      
196600*    END-IF.                                                              
196700                                                                          
196800******************************************************************        
196900* THE UPC ROW ON THE TIMRCUP TABLE WAS NOT SENT ON THE CHANGE    *        
197000* TRANSACTION SO IT WILL NEED TO BE DELETED OFF OF THE DB2       *        
197100* TABLE.                                                         *        
197200******************************************************************        
197300*2395-PROCESS-UPC-E-DELETE-REC.                                           
197400                                                                          
197500*    PERFORM 7205-SELECT-TIMRCUP-CHG.                                     
197600*    PERFORM 7430-MOVES-AUDIT-TAURCUP.                                    
197700*    MOVE PV-UPC-CURSOR-VS-NBR  TO IMRCUP-VS-NBR.                         
197800*    PERFORM 7440-DELETE-TIMRCUP-CHG.                                     
197900*    SET PS-UPC-E-DELETE TO TRUE.                                         
198000*    PERFORM 7445-INSERT-TAURCUP.                                         
198100*    PERFORM 2398-DISPLAY-E-UPC.                                          
198200*    ADD +1 TO PA-TOT-RCUP-DELETES-E.                                     
198300*    ADD +1 TO PA-TOT-RECS-DELETED-E.                                     
198400                                                                          
198500******************************************************************        
198600* DISPLAY THE VENDOR STYLE 'E' DELETE INFORMATION.               *        
198700******************************************************************        
198800*2397-DISPLAY-E-VS.                                                       
198900                                                                          
199000*    DISPLAY '**********************************'.                        
199100*    DISPLAY '** TIMRCVS  E RECORD DELETE     **'.                        
199200*    DISPLAY '** TIMRCVS PO NBR      = ' IMRCVS-PO-NBR.                   
199300*    DISPLAY '** TIMRCVS VS NBR      = ' IMRCVS-VS-NBR.                   
199400*    DISPLAY '**********************************'.                        
199500                                                                          
199600******************************************************************        
199700* DISPLAY THE UPC 'E' DELETE INFORMATION.                        *        
199800******************************************************************        
199900*2398-DISPLAY-E-UPC.                                                      
200000                                                                          
200100*    DISPLAY '**********************************'.                        
200200*    DISPLAY '** TIMRCUP  E  RECORD DELETE    **'.                        
200300*    DISPLAY '** TIMRCUP PO NBR      = ' IMRCUP-PO-NBR.                   
200400*    DISPLAY '** TIMRCUP VS NBR      = ' IMRCUP-VS-NBR.                   
200500*    DISPLAY '** TIMRCUP UPC NBR     = ' IMRCUP-UPC-NBR.                  
200600*    DISPLAY '**********************************'.                        
200700                                                                          
200800******************************************************************        
200900* CHECK TO SEE IF ANYTHING REALLY CHANGED ON THE RECEIVING       *        
201000* RECORDS. IF NO CHANGES, WRITE WARNING MESSAGE TO ERROR REPORT. *        
201100******************************************************************        
201200 2399-NO-CHG-WRN-MSG.                                                     
201300                                                                          
201400     INITIALIZE TR221-RECORD.                                             
201500     INITIALIZE TR221-REC-TYP-ERD.                                        
201600     MOVE PC-E                 TO TR221-RPT-TYP.                          
201700     MOVE 'PO NUMBER'          TO TR221-DATA-IN-ERROR.                    
201800     MOVE PV-HOLD-TR025-PO-NBR TO TR221-DATA-VALUE.                       
201900     MOVE PC-WARNING           TO TR221-ERROR-TYPE.                       
202000*    IF PS-VS-E-DELETE                                                    
202100*      MOVE 'CHANGE SENT & NOTHING CHANGED - VS DELETED'                  
202200*                             TO TR221-ERROR-MSG                          
202300*    ELSE                                                                 
202400*      IF PS-UPC-E-DELETE                                                 
202500*        MOVE 'CHANGE SENT & NOTHING CHANGED - UPC DELETED'               
202600*                             TO TR221-ERROR-MSG                          
202700*      ELSE                                                               
202800         MOVE 'CHANGE SENT & NOTHING CHANGED - NOT PROCESSED'             
202900                              TO TR221-ERROR-MSG                          
203000*      END-IF                                                             
203100*    END-IF.                                                              
203200     MOVE PV-SEQ-NBR-ERD        TO TR221-PROCESS-SEQ-NBR.                 
203300     MOVE PV-HOLD-DAT-SRC-ENT-ID TO TR221-DAT-SRC-ENT-ID.                 
203400     MOVE PV-HOLD-TR025-TRN-TYP TO TR221-TRN-TYP.                         
203500     MOVE PV-REC-TYP-ERD        TO TR221-REC-TYP-ERD-CDE.                 
203600     MOVE PC-10                 TO TR221-ERD-SEQ-NBR.                     
203700     MOVE PV-HOLD-TR025-PO-NBR  TO TR221-PO-NBR.                          
203800     MOVE PV-HOLD-TR025-EXTL-REF-NBR TO TR221-EXTL-REF-NBR.               
203900     MOVE PV-HOLD-TR025-PO-RCVD-DELY-DTE TO                               
204000           TR221-PO-RCVD-DELY-DTE.                                        
204100     MOVE PV-HOLD-TR025-PO-RCVD-DELY-TM TO                                
204200           TR221-PO-RCVD-DELY-TM.                                         
204300     MOVE PV-HOLD-ORGN-SHPD-FR-CDE TO                                     
204400           TR221-ORGN-SHPD-FR-CDE.                                        
204500     MOVE IMRCPO-IMPRT-TRIP-ID   TO TR221-ERD-IMPRT-TRIP-ID.              
204600     MOVE IMRCPO-CARR-SCAC-ID    TO TR221-ERD-CARR-SCAC-ID.               
204700     MOVE IMRCPO-IMPRT-VEH-NM    TO TR221-ERD-IMPRT-VEH-NM.               
204800     MOVE IMRCPO-POE-DELY-TMST (1:4)   TO                                 
204900           TR221-ERD-POE-DELY-DTE (1:4).                                  
205000     MOVE IMRCPO-POE-DELY-TMST (6:2)   TO                                 
205100           TR221-ERD-POE-DELY-DTE (5:2).                                  
205200     MOVE IMRCPO-POE-DELY-TMST (9:2)   TO                                 
205300           TR221-ERD-POE-DELY-DTE (7:2).                                  
205400     MOVE IMRCPO-POE-DELY-TMST (12:2)  TO                                 
205500           TR221-ERD-POE-DELY-TM (1:2).                                   
205600     MOVE IMRCPO-POE-DELY-TMST (15:2)  TO                                 
205700           TR221-ERD-POE-DELY-TM (3:2).                                   
205800                                                                          
205900     MOVE IMRCPO-FOB-CDE         TO TR221-ERD-FOB-CDE.                    
206000     MOVE IMRCPO-DEST-POE-CDE    TO TR221-ERD-DEST-POE-CDE.               
206100     MOVE IMRCPO-TRIP-TYP-CDE    TO TR221-ERD-TRIP-TYP-CDE.               
206200     MOVE IMRCPO-EST-LBD-NM      TO TR221-ERD-EST-LBD-NM.                 
206300     MOVE IMRCPO-DPRTR-TMST (1:4)      TO                                 
206400           TR221-ERD-DPRTR-DTE (1:4).                                     
206500     MOVE IMRCPO-DPRTR-TMST (6:2)      TO                                 
206600           TR221-ERD-DPRTR-DTE (5:2).                                     
206700     MOVE IMRCPO-DPRTR-TMST (9:2)      TO                                 
206800           TR221-ERD-DPRTR-DTE (7:2).                                     
206900     MOVE IMRCPO-DPRTR-TMST (12:2)     TO                                 
207000           TR221-ERD-DPRTR-TM (1:2).                                      
207100     MOVE IMRCPO-DPRTR-TMST (15:2)     TO                                 
207200           TR221-ERD-DPRTR-TM (3:2).                                      
207300                                                                          
207400     PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
207500                                                                          
207600******************************************************************        
207700* THIS IS A DELETE FOR ALL LEVELS (PO, VS, UPC). A 'D' DELETE    *        
207800* WILL INCLUDE THE LOG REC-TYP ONLY. THESE RECORDS COME FROM THE *        
207900* CONSOLIDATOR AND INCLUDE: PO, EXTL-REF-NBR, PO-RCVD-DELY-DTE.  *        
208000* THE DELETE IS DONE ON ALL (PO, VS, UPC  LEVELS).               *        
208100******************************************************************        
208200 2400-GROUP-DELETE.                                                       
208300                                                                          
208400     EVALUATE TR025-LOG-REC-TYP-CDE                                       
208500                                                                          
208600      WHEN PC-LOG                                                         
208700*       MOVE TR025-ERD-PO-NBR      TO IMRCPO-PO-NBR                       
208800        MOVE TR025-ERD-PO-RCVD-DELY-DTE (1:4) TO                          
208900            PV-REFORMAT-TO-DB2-CY                                         
209000        MOVE TR025-ERD-PO-RCVD-DELY-DTE (5:2) TO                          
209100            PV-REFORMAT-TO-DB2-MM                                         
209200        MOVE TR025-ERD-PO-RCVD-DELY-DTE (7:2) TO                          
209300            PV-REFORMAT-TO-DB2-DD                                         
209400        MOVE PV-REFORMAT-TO-DB2-DTE           TO                          
209500            PV-REFORMAT-10BYTE-FIELD                                      
209600        PERFORM 7000-SELECT-TIMRCPO                                       
209700           IF PS-TIMRCPO-ROW-IS-THERE                                     
209800*            MOVE IMRCPO-PO-NBR          TO IMRCUP-PO-NBR                 
209900*                                           IMRCVS-PO-NBR                 
210000*            MOVE IMRCPO-PO-RCVD-SEQ-NBR TO IMRCUP-PO-RCVD-SEQ-NBR        
210100*                                           IMRCVS-PO-RCVD-SEQ-NBR        
210200*            SET PS-EOC-RCUPC-CURSOR-NO  TO TRUE                          
210300*            PERFORM 7400-OPEN-RCUPC-CURSOR                               
210400*            PERFORM 7410-PROCESS-RCUPC-DELETE                            
210500*                    UNTIL PS-EOC-RCUPC-CURSOR                            
210600*            SET PS-EOC-RCVS-CURSOR-NO   TO TRUE                          
210700*            PERFORM 7500-OPEN-RCVS-CURSOR                                
210800*            PERFORM 7510-PROCESS-RCVS-DELETE                             
210900*                    UNTIL PS-EOC-RCVS-CURSOR                             
211000             PERFORM 6800-SCM-PO-RCVG-DEL                                 
211100             PERFORM 7610-PROCESS-RCPO-DELETE                             
211200                 IF PS-GOOD-RCPO-DELETE                                   
211200*                IF (PS-GOOD-RCUPC-DELETE OR                              
211300*                    PS-GOOD-RCVS-DELETE  OR                              
211400*                    PS-GOOD-RCPO-DELETE)                                 
211500                     INITIALIZE TR221-RECORD                              
211600                     INITIALIZE TR221-REC-TYP-LOGUPC                      
211700                     MOVE PC-D              TO TR221-RPT-TYP              
211800                     PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    
211900                     PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  
212000                     PERFORM 7300-INSERT-TOUTTR7-RPT                      
212100                 ELSE                                                     
212200                     CONTINUE                                             
212300                 END-IF                                                   
212400           ELSE                                                           
212500             MOVE PC-E                   TO TR221-RPT-TYP                 
212600             MOVE 'PO NBR'               TO TR221-DATA-IN-ERROR           
212700             MOVE TR025-LOG-PO-NBR       TO TR221-DATA-VALUE              
212800             MOVE PC-ERROR               TO TR221-ERROR-TYPE              
212900             MOVE 'DELETE SENT, PO NOT FOUND, PO NOT DELETED'             
213000                                         TO TR221-ERROR-MSG               
213100             PERFORM 6250-MOVE-LIKE-RPT-FIELDS                            
213200             PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                          
213300             PERFORM 7300-INSERT-TOUTTR7-RPT                              
213400           END-IF                                                         
213500                                                                          
213600     END-EVALUATE.                                                        
213700                                                                          
213800     PERFORM 2600-CHECK-HOLD-FIELDS.                                      
213900                                                                          
214000     SET PS-GOOD-RECORD-NO TO TRUE.                                       
214100     PERFORM 6000-READ-RCVD-FILE                                          
214200         UNTIL PS-GOOD-RECORD OR PS-END-OF-INPUT.                         
214300                                                                          
214400     PERFORM 2610-RESET-SWITCHES.                                         
214500                                                                          
214600 EJECT                                                                    
214700                                                                          
214800******************************************************************        
214900* BEFORE NEXT READ CHECK IF THE KEY FIELDS HAVE CHANGED. IF THEY *        
215000* HAVE, MOVE NEW FIELDS TO HOLD.                                 *        
215100******************************************************************        
215200 2600-CHECK-HOLD-FIELDS.                                                  
215300                                                                          
215400     IF TR025-ERD-TRN-TYP       = PV-HOLD-TR025-TRN-TYP AND               
215500        TR025-ERD-PO-NBR        = PV-HOLD-TR025-PO-NBR   AND              
215600        TR025-ERD-EXTL-REF-NBR  = PV-HOLD-TR025-EXTL-REF-NBR AND          
215700        TR025-ERD-PO-RCVD-DELY-DTE =                                      
215800                     PV-HOLD-TR025-PO-RCVD-DELY-DTE      AND              
215900        TR025-ERD-PO-RCVD-DELY-TM =                                       
216000                     PV-HOLD-TR025-PO-RCVD-DELY-TM      AND               
216100        TR025-ERD-ORGN-SHPD-FR-CDE =                                      
216200                           PV-HOLD-ORGN-SHPD-FR-CDE                       
216300        CONTINUE                                                          
216400     ELSE                                                                 
216500        MOVE TR025-ERD-TRN-TYP       TO PV-HOLD-TR025-TRN-TYP             
216600        MOVE TR025-ERD-PO-NBR        TO PV-HOLD-TR025-PO-NBR              
216700        MOVE TR025-ERD-ENT-ID        TO PV-HOLD-DAT-SRC-ENT-ID            
216800        MOVE TR025-ERD-EXTL-REF-NBR  TO PV-HOLD-TR025-EXTL-REF-NBR        
216900        MOVE TR025-ERD-REC-TYP-CDE   TO PV-HOLD-TR025-REC-TYP-CDE         
217000        MOVE TR025-ERD-PO-RCVD-DELY-DTE TO                                
217100            PV-HOLD-TR025-PO-RCVD-DELY-DTE                                
217200        MOVE TR025-ERD-PO-RCVD-DELY-TM TO                                 
217300            PV-HOLD-TR025-PO-RCVD-DELY-TM                                 
217400        MOVE TR025-ERD-ORGN-SHPD-FR-CDE TO                                
217500            PV-HOLD-ORGN-SHPD-FR-CDE                                      
217600        INITIALIZE PV-HOLD-TR025-VS-NBR                                   
217700                   PV-HOLD-TR025-UPC-NBR                                  
217800     END-IF.                                                              
217900                                                                          
218000     EVALUATE TR025-ERD-REC-TYP-CDE                                       
218100         WHEN PC-LOGVS                                                    
218200             IF TR025-LOGVS-VS-NBR   = PV-HOLD-TR025-VS-NBR               
218300                 CONTINUE                                                 
218400             ELSE                                                         
218500                MOVE TR025-LOGVS-VS-NBR TO PV-HOLD-TR025-VS-NBR           
218600                MOVE TR025-LOGVS-REC-TYP-CDE  TO                          
218700                      PV-HOLD-TR025-REC-TYP-CDE                           
218800             END-IF                                                       
218900         WHEN PC-LOGUPC                                                   
219000             IF TR025-LOGVS-VS-NBR   = PV-HOLD-TR025-VS-NBR AND           
219100                TR025-LOGUPC-UPC-NBR = PV-HOLD-TR025-UPC-NBR              
219200                CONTINUE                                                  
219300             ELSE                                                         
219400               MOVE TR025-LOGVS-VS-NBR  TO PV-HOLD-TR025-VS-NBR           
219500               MOVE TR025-LOGUPC-UPC-NBR TO PV-HOLD-TR025-UPC-NBR         
219600               MOVE TR025-LOGUPC-REC-TYP-CDE  TO                          
219700                      PV-HOLD-TR025-REC-TYP-CDE                           
219800             END-IF                                                       
219900                                                                          
220000     END-EVALUATE.                                                        
220100                                                                          
220200******************************************************************        
220300* AFTER READ CHECK IF THE KEY FIELDS HAVE CHANGED. IF THEY HAVE  *        
220400* RESET THOSE SWITCHES THAT DEPEND ON THE KEY BEING THE SAME.    *        
220500******************************************************************        
220600 2610-RESET-SWITCHES.                                                     
220700                                                                          
220800     IF (TR025-ERD-TRN-TYP       = PV-HOLD-TR025-TRN-TYP      AND         
220900        TR025-ERD-PO-NBR         = PV-HOLD-TR025-PO-NBR       AND         
221000        TR025-ERD-EXTL-REF-NBR   = PV-HOLD-TR025-EXTL-REF-NBR AND         
221100        TR025-ERD-PO-RCVD-DELY-DTE =                                      
221200                    PV-HOLD-TR025-PO-RCVD-DELY-DTE            AND         
221300        TR025-ERD-PO-RCVD-DELY-TM =                                       
221400                    PV-HOLD-TR025-PO-RCVD-DELY-TM         AND             
221500        TR025-ERD-ORGN-SHPD-FR-CDE =                                      
221600                    PV-HOLD-ORGN-SHPD-FR-CDE)          AND                
221700        PS-END-OF-INPUT-NO                                                
221800         CONTINUE                                                         
221900     ELSE                                                                 
222000        INITIALIZE PV-HOLD-PROCESS-SEQ-NBR-ERD                            
222100                   PV-HOLD-PROCESS-SEQ-NBR-ERDRSN                         
222200                   PV-HOLD-PROCESS-SEQ-NBR-LOG                            
222300        SET PS-TIMRCPO-ROW-IS-THERE-UNSURE    TO TRUE                     
222400        SET PS-TIMRCPO-ADDED-NO               TO TRUE                     
222500        SET PS-KEY-FIELDS-CHANGED             TO TRUE                     
222600        SET PS-ERD-ERDRSN-LOG-LOOP-NO         TO TRUE                     
222700        SET PS-ADD-FOR-CHANGES-DONE           TO TRUE                     
222800                                                                          
222900        IF PV-HOLD-TR025-TRN-TYP = PC-C                                   
223000          IF PS-CHANGE-ADD-B                                              
223100              SET PS-CHANGE-ADD-B-NO TO TRUE                              
223200*         ELSE                                                            
223300*             PERFORM 2375-TABLE-COMPARE-CHECK                            
223400          END-IF                                                          
223500        END-IF                                                            
223600     END-IF.                                                              
223700                                                                          
223800*    EVALUATE TR025-ERD-REC-TYP-CDE                                       
223900*        WHEN PC-LOGVS                                                    
224000*        WHEN PC-LOGUPC                                                   
224100*            IF TR025-LOGVS-VS-NBR = PV-HOLD-TR025-VS-NBR                 
224200*                CONTINUE                                                 
224300*            ELSE                                                         
224400*                SET PS-TIMRCVS-ROW-IS-THERE-UNSURE TO TRUE               
224500*                SET PS-TIMRCVS-ADDED-NO         TO TRUE                  
224600*            END-IF                                                       
224700*    END-EVALUATE.                                                        
224800                                                                          
224900******************************************************************        
225000* CHECK HOLD FIELDS TO SEE IF A COMMIT NEEDS TO BE TAKEN.        *        
225100******************************************************************        
225200 2615-CHECK-COMMIT-FIELDS.                                                
225300                                                                          
225400     IF TR025-ERD-PO-NBR         = PV-HOLD-TR025-PO-NBR        OR         
225500        TR025-ERD-EXTL-REF-NBR   = PV-HOLD-TR025-EXTL-REF-NBR             
225600         SET PS-SAME-COMMIT-FIELDS TO TRUE                                
225700     ELSE                                                                 
225800         SET PS-NOT-SAME-COMMIT-FIELDS TO TRUE                            
225900     END-IF.                                                              
226000                                                                          
226100******************************************************************        
226200* EDITS PERTAINING TO FIELDS COMING FROM THE ERD RECORD TYPE.    *        
226300* ALSO INCLUDES EDITS THAT PERTAIN TO MULTIPLE RECORD TYPES.     *        
226400******************************************************************        
226500 3000-ERD-EDITS.                                                          
226600                                                                          
226700     MOVE TR025-ERD-PO-NBR         TO  IMRCPO-PO-NBR.                     
226800     PERFORM 7310-SELECT-TPURCHS.                                         
226900     SET PS-TPURCHS-ACTIVE-NO      TO  TRUE.                              
227000                                                                          
227100     EVALUATE TRUE                                                        
227200         WHEN  SQLCODE = +0                                               
227300              IF PURCHS-STATUS-CDE = (PC-AC OR PC-AP)                     
227400                 SET PS-TPURCHS-ACTIVE  TO TRUE                           
227500              ELSE                                                        
227600                 INITIALIZE TR221-RECORD                                  
227700                 INITIALIZE TR221-REC-TYP-ERD                             
227800                 MOVE PC-E                          TO                    
227900                    TR221-RPT-TYP                                         
228000                 MOVE 'PO NUMBER'                   TO                    
228100                    TR221-DATA-IN-ERROR                                   
228200                 MOVE TR025-ERD-PO-NBR              TO                    
228300                    TR221-DATA-VALUE                                      
228400                 MOVE PC-WARNING                    TO                    
228500                    TR221-ERROR-TYPE                                      
228600                 MOVE 'PO NOT ACTIVE OR APPROVED ON MAINFRAME'            
228700                                       TO TR221-ERROR-MSG                 
228800                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        
228900                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      
229000                 PERFORM 7300-INSERT-TOUTTR7-RPT                          
229100              END-IF                                                      
229200                                                                          
229300         WHEN SQLCODE = +100                                              
229400                 INITIALIZE TR221-RECORD                                  
229500                 INITIALIZE TR221-REC-TYP-ERD                             
229600                 MOVE PC-E                              TO                
229700                         TR221-RPT-TYP                                    
229800                 MOVE 'PO NBR'                          TO                
229900                         TR221-DATA-IN-ERROR                              
230000                 MOVE PC-WARNING                        TO                
230100                         TR221-ERROR-TYPE                                 
230200                 MOVE TR025-ERD-PO-NBR                  TO                
230300                    TR221-DATA-VALUE                                      
230400                 MOVE 'PO NOT ON MAINFRAME'             TO                
230500                         TR221-ERROR-MSG                                  
230600                 PERFORM 6250-MOVE-LIKE-RPT-FIELDS                        
230700                 PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                      
230800                 PERFORM 7300-INSERT-TOUTTR7-RPT                          
230900       END-EVALUATE.                                                      
231000                                                                          
231100*      PERFORM 3025-CHECK-SAIL-DTE.                                       
231200*      PERFORM 3010-EDIT-POE-LBD.                                         
231300                                                                          
231400*      ***************  10594 = EXPEDITOR                                 
231500       IF TR025-ERD-ENT-ID = 10594                                        
231600           CONTINUE                                                       
231700       ELSE                                                               
231800           PERFORM 3020-EDIT-FOB                                          
231900       END-IF.                                                            
232000                                                                          
232100 EJECT                                                                    
232200******************************************************************        
232300* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *        
232400* ALSO, CHECKS THE LANDBRIGDE NAME.                              *        
232500******************************************************************        
232600*3010-EDIT-POE-LBD.                                                       
232700*                                                                         
232800*    IF TR025-ERD-DEST-POE-CDE = SPACES  AND                              
232900*       TR025-ERD-EST-LBD-NM   = SPACES                                   
233000*        INITIALIZE TR221-RECORD                                          
233100*        INITIALIZE TR221-REC-TYP-ERD                                     
233200*        MOVE PC-E              TO TR221-RPT-TYP                          
233300*        MOVE PC-WARNING        TO TR221-ERROR-TYPE                       
233400*        MOVE 'DEST-POE-CDE'    TO TR221-DATA-IN-ERROR                    
233500*        MOVE TR025-ERD-DEST-POE-CDE  TO TR221-DATA-VALUE                 
233600*        MOVE 'POE CDE AND/OR LANDBRIDGE NAME NOT SENT' TO                
233700*              TR221-ERROR-MSG                                            
233800*        MOVE SPACES          TO IMRCPO-DEST-POE-CDE                      
233900*                                IMRCPO-EST-LBD-NM                        
234000*        MOVE PC-DEFAULT-TMST TO IMRCPO-POE-DELY-TMST                     
234100*                                IMRCPO-EST-LBD-TMST                      
234200*        SET PS-POE-LBD       TO TRUE                                     
234300*        PERFORM 6250-MOVE-LIKE-RPT-FIELDS                                
234400*        PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                              
234500*        PERFORM 7300-INSERT-TOUTTR7-RPT                                  
234600*    ELSE                                                                 
234700*        IF TR025-ERD-EST-LBD-NM = SPACES                                 
234800*            MOVE SPACES          TO IMRCPO-EST-LBD-NM                    
234900*            MOVE PC-DEFAULT-TMST TO IMRCPO-EST-LBD-TMST                  
235000*            SET PS-POE-LBD       TO TRUE                                 
235100*            PERFORM 3015-POE-CHECK                                       
235200*        ELSE                                                             
235300*            IF TR025-ERD-DEST-POE-CDE = SPACES                           
235400*                MOVE TR025-ERD-EST-LBD-NM TO IMRCPO-EST-LBD-NM           
235500*                MOVE TR025-ERD-POE-DELY-DTE (1:4)  TO                    
235600*                      IMRCPO-EST-LBD-TMST (1:4)                          
235700*                MOVE PC-DASH                       TO                    
235800*                      IMRCPO-EST-LBD-TMST (5:1)                          
235900*                MOVE TR025-ERD-POE-DELY-DTE (5:2)  TO                    
236000*                      IMRCPO-EST-LBD-TMST (6:2)                          
236100*                MOVE PC-DASH                       TO                    
236200*                      IMRCPO-EST-LBD-TMST (8:1)                          
236300*                MOVE TR025-ERD-POE-DELY-DTE (7:2)  TO                    
236400*                      IMRCPO-EST-LBD-TMST (9:2)                          
236500*                MOVE PC-DASH                       TO                    
236600*                      IMRCPO-EST-LBD-TMST (11:1)                         
236700*                MOVE TR025-ERD-POE-DELY-TM (1:2)   TO                    
236800*                      IMRCPO-EST-LBD-TMST  (12:2)                        
236900*                MOVE PC-DECIMAL                    TO                    
237000*                      IMRCPO-EST-LBD-TMST (14:1)                         
237100*                MOVE TR025-ERD-POE-DELY-TM (3:2)   TO                    
237200*                      IMRCPO-EST-LBD-TMST (15:2)                         
237300*                MOVE PC-DECIMAL                    TO                    
237400*                      IMRCPO-EST-LBD-TMST (17:1)                         
237500*                MOVE ZEROES                        TO                    
237600*                      IMRCPO-EST-LBD-TMST (18:2)                         
237700*                MOVE PC-DECIMAL                    TO                    
237800*                      IMRCPO-EST-LBD-TMST (20:1)                         
237900*                MOVE ZEROES                        TO                    
238000*                      IMRCPO-EST-LBD-TMST (21:6)                         
238100*                MOVE SPACES              TO IMRCPO-DEST-POE-CDE          
238200*                MOVE PC-DEFAULT-TMST     TO IMRCPO-POE-DELY-TMST         
238300*                SET PS-POE-LBD           TO TRUE                         
238400*            ELSE                                                         
238500*                MOVE TR025-ERD-EST-LBD-NM TO IMRCPO-EST-LBD-NM           
238600*                MOVE TR025-ERD-POE-DELY-DTE (1:4)  TO                    
238700*                      IMRCPO-EST-LBD-TMST (1:4)                          
238800*                MOVE PC-DASH                       TO                    
238900*                      IMRCPO-EST-LBD-TMST (5:1)                          
239000*                MOVE TR025-ERD-POE-DELY-DTE (5:2)  TO                    
239100*                      IMRCPO-EST-LBD-TMST (6:2)                          
239200*                MOVE PC-DASH                       TO                    
239300*                      IMRCPO-EST-LBD-TMST (8:1)                          
239400*                MOVE TR025-ERD-POE-DELY-DTE (7:2)  TO                    
239500*                      IMRCPO-EST-LBD-TMST (9:2)                          
239600*                MOVE PC-DASH                       TO                    
239700*                      IMRCPO-EST-LBD-TMST (11:1)                         
239800*                MOVE TR025-ERD-POE-DELY-TM (1:2)   TO                    
239900*                      IMRCPO-EST-LBD-TMST  (12:2)                        
240000*                MOVE PC-DECIMAL                    TO                    
240100*                      IMRCPO-EST-LBD-TMST (14:1)                         
240200*                MOVE TR025-ERD-POE-DELY-TM (3:2)   TO                    
240300*                      IMRCPO-EST-LBD-TMST (15:2)                         
240400*                MOVE PC-DECIMAL                    TO                    
240500*                      IMRCPO-EST-LBD-TMST (17:1)                         
240600*                MOVE ZEROES                        TO                    
240700*                      IMRCPO-EST-LBD-TMST (18:2)                         
240800*                MOVE PC-DECIMAL                    TO                    
240900*                      IMRCPO-EST-LBD-TMST (20:1)                         
241000*                MOVE ZEROES                        TO                    
241100*                      IMRCPO-EST-LBD-TMST (21:6)                         
241200*                SET PS-POE-LBD            TO TRUE                        
241300*                PERFORM 3015-POE-CHECK                                   
241400*            END-IF                                                       
241500*        END-IF                                                           
241600*    END-IF.                                                              
241700*                                                                         
241800******************************************************************        
241900* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *        
242000******************************************************************        
242100*3015-POE-CHECK.                                                          
242200*                                                                         
242300*    EVALUATE TRUE                                                        
242400*        WHEN TR025-ERD-TRIP-TYP-CDE = PC-A                               
242500*            PERFORM 7040-OPEN-POE-CURSOR-AIR                             
242600*            PERFORM 7044-FETCH-POE-CURSOR-AIR                            
242700*            PERFORM 7042-CLOSE-POE-CURSOR-AIR                            
242800*                                                                         
242900*        WHEN TR025-ERD-TRIP-TYP-CDE = PC-O                               
243000*            PERFORM 7050-OPEN-POE-CURSOR-OCEAN                           
243100*            PERFORM 7054-FETCH-POE-CURSOR-OCEAN                          
243200*            PERFORM 7052-CLOSE-POE-CURSOR-OCEAN                          
243300*    END-EVALUATE.                                                        
243400*                                                                         
243500*    IF PS-VALID-POE-CDE                                                  
243600*        MOVE TR025-ERD-DEST-POE-CDE  TO IMRCPO-DEST-POE-CDE              
243700*        MOVE TR025-ERD-POE-DELY-DTE (1:4)  TO                            
243800*              IMRCPO-POE-DELY-TMST (1:4)                                 
243900*        MOVE PC-DASH                       TO                            
244000*              IMRCPO-POE-DELY-TMST (5:1)                                 
244100*        MOVE TR025-ERD-POE-DELY-DTE (5:2)  TO                            
244200*              IMRCPO-POE-DELY-TMST (6:2)                                 
244300*        MOVE PC-DASH                       TO                            
244400*              IMRCPO-POE-DELY-TMST (8:1)                                 
244500*        MOVE TR025-ERD-POE-DELY-DTE (7:2)  TO                            
244600*              IMRCPO-POE-DELY-TMST (9:2)                                 
244700*        MOVE PC-DASH                       TO                            
244800*              IMRCPO-POE-DELY-TMST (11:1)                                
244900*        MOVE TR025-ERD-POE-DELY-TM (1:2)   TO                            
245000*              IMRCPO-POE-DELY-TMST (12:2)                                
245100*        MOVE PC-DECIMAL                    TO                            
245200*              IMRCPO-POE-DELY-TMST (14:1)                                
245300*        MOVE TR025-ERD-POE-DELY-TM (3:2)   TO                            
245400*              IMRCPO-POE-DELY-TMST (15:2)                                
245500*        MOVE PC-DECIMAL                    TO                            
245600*              IMRCPO-POE-DELY-TMST (17:1)                                
245700*        MOVE ZEROES                        TO                            
245800*              IMRCPO-POE-DELY-TMST (18:2)                                
245900*        MOVE PC-DECIMAL                    TO                            
246000*              IMRCPO-POE-DELY-TMST (20:1)                                
246100*        MOVE ZEROES                        TO                            
246200*              IMRCPO-POE-DELY-TMST (21:6)                                
246300*        SET PS-POE-LBD TO TRUE                                           
246400*    ELSE                                                                 
246500*        MOVE SPACES                  TO IMRCPO-DEST-POE-CDE              
246600*        MOVE TR025-ERD-POE-DELY-DTE (1:4)  TO                            
246700*              IMRCPO-POE-DELY-TMST (1:4)                                 
246800*        MOVE PC-DASH                       TO                            
246900*              IMRCPO-POE-DELY-TMST (5:1)                                 
247000*        MOVE TR025-ERD-POE-DELY-DTE (5:2)  TO                            
247100*              IMRCPO-POE-DELY-TMST (6:2)                                 
247200*        MOVE PC-DASH                       TO                            
247300*              IMRCPO-POE-DELY-TMST (8:1)                                 
247400*        MOVE TR025-ERD-POE-DELY-DTE (7:2)  TO                            
247500*              IMRCPO-POE-DELY-TMST (9:2)                                 
247600*        MOVE PC-DASH                       TO                            
247700*              IMRCPO-POE-DELY-TMST (11:1)                                
247800*        MOVE TR025-ERD-POE-DELY-TM (1:2)   TO                            
247900*              IMRCPO-POE-DELY-TMST (12:2)                                
248000*        MOVE PC-DECIMAL                    TO                            
248100*              IMRCPO-POE-DELY-TMST (14:1)                                
248200*        MOVE TR025-ERD-POE-DELY-TM (3:2)   TO                            
248300*              IMRCPO-POE-DELY-TMST (15:2)                                
248400*        MOVE PC-DECIMAL                    TO                            
248500*              IMRCPO-POE-DELY-TMST (17:1)                                
248600*        MOVE ZEROES                        TO                            
248700*              IMRCPO-POE-DELY-TMST (18:2)                                
248800*        MOVE PC-DECIMAL                    TO                            
248900*              IMRCPO-POE-DELY-TMST (20:1)                                
249000*        MOVE ZEROES                        TO                            
249100*              IMRCPO-POE-DELY-TMST (21:6)                                
249200*        SET PS-POE-LBD TO TRUE                                           
249300*        INITIALIZE TR221-RECORD                                          
249400*        INITIALIZE TR221-REC-TYP-ERD                                     
249500*        MOVE PC-E                   TO TR221-RPT-TYP                     
249600*        MOVE PC-WARNING             TO TR221-ERROR-TYPE                  
249700*        MOVE 'DEST-POE-CDE'         TO TR221-DATA-IN-ERROR               
249800*        MOVE TR025-ERD-DEST-POE-CDE TO TR221-DATA-VALUE                  
249900*        MOVE 'INVALID POE CODE ON MAINFRAME' TO TR221-ERROR-MSG          
250000*        PERFORM 6250-MOVE-LIKE-RPT-FIELDS                                
250100*        PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                              
250200*        PERFORM 7300-INSERT-TOUTTR7-RPT                                  
250300*    END-IF.                                                              
250400*                                                                         
250500******************************************************************        
250600* CHECKS TO SEE IF THE FOB-CDE ON MAINFRAME IS VALID (ACTIVE).   *        
250700******************************************************************        
250800 3020-EDIT-FOB.                                                           
250900                                                                          
251000     IF TR025-ERD-FOB-CDE = SPACES                                        
251100         CONTINUE                                                         
251200     ELSE                                                                 
251300         EVALUATE TRUE                                                    
251400             WHEN TR025-ERD-TRIP-TYP-CDE = PC-A                           
251500                 PERFORM 7055-SELECT-FOB-AIR                              
251600                                                                          
251700             WHEN TR025-ERD-TRIP-TYP-CDE = PC-O                           
251800                 PERFORM 7060-SELECT-FOB-OCEAN                            
251900         END-EVALUATE                                                     
252000                                                                          
252100         IF (TR025-ERD-TRIP-TYP-CDE = PC-A OR PC-O) AND                   
252200             PS-INVALID-FOB-CDE                                           
252300             INITIALIZE TR221-RECORD                                      
252400             INITIALIZE TR221-REC-TYP-ERD                                 
252500             MOVE PC-E              TO TR221-RPT-TYP                      
252600             MOVE PC-WARNING        TO TR221-ERROR-TYPE                   
252700             MOVE 'FOB CDE'         TO TR221-DATA-IN-ERROR                
252800             MOVE TR025-ERD-FOB-CDE               TO                      
252900                   TR221-DATA-VALUE                                       
253000             MOVE 'INVALID FOB CODE ON MAINFRAME' TO                      
253100                   TR221-ERROR-MSG                                        
253200                   PERFORM 6250-MOVE-LIKE-RPT-FIELDS                      
253300                   PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                    
253400                   PERFORM 7300-INSERT-TOUTTR7-RPT                        
253500         END-IF                                                           
253600     END-IF.                                                              
253700                                                                          
253800 EJECT                                                                    
253900******************************************************************        
254000* SEND A WRN LEVEL ERROR MESSAGE IF THE CONSLR SENDS A DEPARTURE          
254100* DATE THAT IS DIFFERENT FROM WHAT IS CURRENTLY LOADED ON TIMRCPO         
254200* FOR EACH PO/REFERENCE.                                                  
254300******************************************************************        
254400 3025-CHECK-SAIL-DTE.                                                     
254500                                                                          
254600     PERFORM                                                              
254700         WITH TEST AFTER                                                  
254800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
254900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
255000                 SQLCODE = ZERO                     OR                    
255100                 SQLCODE = -811                     OR                    
255200                 SQLCODE = +100                                           
255300                                                                          
255400     EXEC SQL                                                             
255500        SELECT A.DPRTR_TMST                                               
255600         INTO  :PV-DPRTR-TMST                                             
255700         FROM  TIMRCPO A                                                  
255800        WHERE  A.DPRTR_TMST ^=                                            
255900                              :IMRCPO-DPRTR-TMST                          
256000         AND A.PO_NBR =       :IMRCPO-PO-NBR                              
256100         AND A.EXTL_REF_NBR = :IMRCPO-EXTL-REF-NBR                        
256200     END-EXEC                                                             
256300                                                                          
256400         EVALUATE TRUE                                                    
256500             WHEN SQLCODE = +0                                            
256600             WHEN SQLCODE = -811                                          
256700              INITIALIZE TR221-RECORD                                     
256800              INITIALIZE TR221-REC-TYP-ERD                                
256900              MOVE PC-E              TO TR221-RPT-TYP                     
257000              MOVE PC-WARNING        TO TR221-ERROR-TYPE                  
257100              MOVE 'SAIL DTE'        TO TR221-DATA-IN-ERROR               
257200              INITIALIZE PV-REFORMAT-10BYTE-DPTR-PRT-DT                   
257300              MOVE PV-DPRTR-TMST (6:2)  TO                                
257400                          PV-REFORMAT-10BYTE-DPTR-PRT-DT (1:2)            
257500              MOVE PC-SLASH TO                                            
257600                          PV-REFORMAT-10BYTE-DPTR-PRT-DT (3:1)            
257700              MOVE PV-DPRTR-TMST (9:2)  TO                                
257800                          PV-REFORMAT-10BYTE-DPTR-PRT-DT (4:2)            
257900              MOVE PC-SLASH TO                                            
258000                          PV-REFORMAT-10BYTE-DPTR-PRT-DT (6:1)            
258100              MOVE PV-DPRTR-TMST (1:4)  TO                                
258200                          PV-REFORMAT-10BYTE-DPTR-PRT-DT (7:4)            
258300              MOVE PV-REFORMAT-10BYTE-DPTR-PRT-DT      TO                 
258400                    TR221-DATA-VALUE                                      
258500              MOVE 'SAIL DTE DIFFERENT THAN SAME PO/REF PREV SENT'        
258600                    TO TR221-ERROR-MSG                                    
258700                    PERFORM 6250-MOVE-LIKE-RPT-FIELDS                     
258800                    PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                   
258900                    PERFORM 7300-INSERT-TOUTTR7-RPT                       
259000             WHEN SQLCODE = +100                                          
259100                 CONTINUE                                                 
259200                                                                          
259300             WHEN SQLWARN0 NOT EQUAL SPACE                                
259400             WHEN SQLCODE NOT EQUAL ZERO                                  
259500               DISPLAY '**************************************'           
259600               DISPLAY '** ABEND                            **'           
259700               DISPLAY '** PROGRAM = TRKUP225               **'           
259800               DISPLAY '** PARAGRAPH = 3025-CHECK-SAIL-DTE  **'           
259900               DISPLAY '** SELECT FROM TIMRCPO              **'           
260000               DISPLAY '** PO NBR   = ' PV-HOLD-TR025-PO-NBR              
260100               DISPLAY '** XREF NBR = ' PV-HOLD-TR025-EXTL-REF-NBR        
260200               DISPLAY '**************************************'           
260300               PERFORM 9100-SQL-ABEND                                     
260400         END-EVALUATE                                                     
260500     END-PERFORM.                                                         
260600                                                                          
260700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
260800         (SQLCODE NOT = ZERO AND                                          
260900             SQLCODE NOT = +100)                                          
261000         DISPLAY '****************************************'               
261100         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
261200         DISPLAY '** SELECT FROM TIMRCPO                **'               
261300         DISPLAY '** PARAGRAPH = 3025-CHECK-SAIL-DTE    **'               
261400         DISPLAY '** PO NBR   = ' PV-HOLD-TR025-PO-NBR                    
261500         DISPLAY '** XREF NBR = ' PV-HOLD-TR025-EXTL-REF-NBR              
261600         DISPLAY '****************************************'               
261700         PERFORM 9100-SQL-ABEND                                           
261800     END-IF.                                                              
261900                                                                          
262000 EJECT                                                                    
262100******************************************************************        
262200* CHECKS TO SEE IF THE CNTRY-CDE IS VALID ON TCNTRY (ACTIVE).    *        
262300******************************************************************        
262400*3030-EDIT-CNTRY.                                                         
262500*                                                                         
262600*        IF TR025-LOG-C-O-PROD-CDE = SPACES                               
262700*            INITIALIZE TR221-RECORD                                      
262800*            INITIALIZE TR221-REC-TYP-LOG                                 
262900*            MOVE PC-E              TO TR221-RPT-TYP                      
263000*            MOVE PC-WARNING        TO TR221-ERROR-TYPE                   
263100*            MOVE 'PRD CNTRY'       TO TR221-DATA-IN-ERROR                
263200*            MOVE TR025-LOG-C-O-PROD-CDE           TO                     
263300*                  TR221-DATA-VALUE                                       
263400*            MOVE 'NO DATA SENT'                   TO                     
263500*                  TR221-ERROR-MSG                                        
263600*                  PERFORM 6250-MOVE-LIKE-RPT-FIELDS                      
263700*                  PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                    
263800*                  PERFORM 7300-INSERT-TOUTTR7-RPT                        
263900*        ELSE                                                             
264000*            PERFORM 7035-SELECT-CNTRY-CDE                                
264100*        END-IF.                                                          
264200*                                                                         
264300*        IF PS-INVALID-CNTRY-CDE                                          
264400*               INITIALIZE TR221-RECORD                                   
264500*               INITIALIZE TR221-REC-TYP-LOG                              
264600*               MOVE PC-E              TO TR221-RPT-TYP                   
264700*               MOVE PC-WARNING        TO TR221-ERROR-TYPE                
264800*               MOVE 'CNTRY-CDE'       TO TR221-DATA-IN-ERROR             
264900*               MOVE TR025-LOG-C-O-PROD-CDE           TO                  
265000*                     TR221-DATA-VALUE                                    
265100*               MOVE 'INVALID CNTRY-CDE ON MAINFRAME' TO                  
265200*                     TR221-ERROR-MSG                                     
265300*               PERFORM 6250-MOVE-LIKE-RPT-FIELDS                         
265400*               PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                       
265500*               PERFORM 7300-INSERT-TOUTTR7-RPT                           
265600*        END-IF.                                                          
265700*                                                                         
265800*EJECT                                                                    
265900*                                                                         
266000******************************************************************        
266100* EDIT ERD FCTRY NAME AGAINST THE IMPRT FCTRY NAME ON TPURCHS.   *        
266200******************************************************************        
266300*3035-EDIT-FCTRY-NAME.                                                    
266400                                                                          
266500*    PERFORM 7340-GET-IMPRT-FCTRY-NAME.                                   
266600*    MOVE ENTNME-ENT-NAME-DESC    TO PV-IMPRT-FCTRY-NAME.                 
266700*                                                                         
266800*    IF TR025-LOG-PROD-FCTRY-NM (1:10) = PV-IMPRT-FCTRY-NAME-10           
266900*        CONTINUE                                                         
267000*    ELSE                                                                 
267100*        PERFORM 7345-GET-IMPRT-VEND-NAME                                 
267200*        MOVE ENTNME-ENT-NAME-DESC   TO PV-IMPRT-FCTRY-NAME               
267300*        IF TR025-LOG-PROD-FCTRY-NM (1:10) =                              
267400*             PV-IMPRT-FCTRY-NAME-10                                      
267500*            INITIALIZE TR221-RECORD                                      
267600*            INITIALIZE TR221-REC-TYP-ERD                                 
267700*            MOVE PC-E                    TO TR221-RPT-TYP                
267800*            MOVE 'FCTRY NAME'            TO TR221-DATA-IN-ERROR          
267900*            MOVE PC-WARNING              TO TR221-ERROR-TYPE             
268000*            MOVE TR025-LOG-PROD-FCTRY-NM TO TR221-DATA-VALUE             
268100*            MOVE 'FACTORY NAME MATCHES MAKER ON MAINFRAME' TO            
268200*                  TR221-ERROR-MSG                                        
268300*            PERFORM 6250-MOVE-LIKE-RPT-FIELDS                            
268400*            PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                          
268500*            PERFORM 7300-INSERT-TOUTTR7-RPT                              
268600*        ELSE                                                             
268700*            INITIALIZE TR221-RECORD                                      
268800*            INITIALIZE TR221-REC-TYP-ERD                                 
268900*            MOVE PC-E                    TO TR221-RPT-TYP                
269000*            MOVE 'FCTRY NAME'            TO TR221-DATA-IN-ERROR          
269100*            MOVE PC-WARNING              TO TR221-ERROR-TYPE             
269200*            MOVE TR025-LOG-PROD-FCTRY-NM TO TR221-DATA-VALUE             
269300*            MOVE 'FACTORY NAME DOES NOT MATCH MAINFRAME'  TO             
269400*                  TR221-ERROR-MSG                                        
269500*            PERFORM 6250-MOVE-LIKE-RPT-FIELDS                            
269600*            PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                          
269700*            PERFORM 7300-INSERT-TOUTTR7-RPT                              
269800*        END-IF                                                           
269900*    END-IF.                                                              
270000                                                                          
270100******************************************************************        
270200* CHECKS TO SEE IF THE PO LINE(S) ARE ACTIVE OR APPROVED ON THE  *        
270300* MAINFRAME, AND IF THE VS IS ON THE MAINFRAME.                  *        
270400******************************************************************        
270500*3200-EDIT-LOGVS.                                                         
270600                                                                          
270700*    SET PS-VS-ON-TPURITM-NO TO TRUE.                                     
270800*    MOVE TR025-LOGVS-PO-NBR TO PURITM-PO-NBR.                            
270900*    PERFORM 7315-SELECT-TPURITM-FOR-PO.                                  
271000*                                                                         
271100*    IF PS-VS-ON-TPURITM                                                  
271200*        CONTINUE                                                         
271300*    ELSE                                                                 
271400*        INITIALIZE TR221-RECORD                                          
271500*        INITIALIZE TR221-REC-TYP-LOGVS                                   
271600*        MOVE PC-E                TO TR221-RPT-TYP                        
271700*        MOVE 'VS NUMBER'         TO TR221-DATA-IN-ERROR                  
271800*        MOVE TR025-LOGVS-VS-NBR  TO TR221-DATA-VALUE                     
271900*        MOVE PC-WARNING          TO TR221-ERROR-TYPE                     
272000*        MOVE 'VS NOT FOUND ON MAINFRAME PO'                              
272100*                                 TO TR221-ERROR-MSG                      
272200*        PERFORM 6250-MOVE-LIKE-RPT-FIELDS                                
272300*        PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                              
272400*        PERFORM 7300-INSERT-TOUTTR7-RPT                                  
272500*    END-IF.                                                              
272600                                                                          
272700 EJECT                                                                    
272800******************************************************************        
272900* CHECKS TO SEE IF THE UPC IS ON MULTIPLE LINES ON THE MAINFRAME,*        
273000* IF THE UPC IS ACTIVE OR APPROVED ON THE MAINFRAME, AND IF THE  *        
273100* UPC IS ON THE MAINFRAME.                                       *        
273200******************************************************************        
273300*3300-EDIT-LOGUPC.                                                        
273400                                                                          
273500*    SET PS-UPC-ON-TPURITM-NO  TO TRUE.                                   
273600*    MOVE TR025-LOGUPC-UPC-NBR TO TUPCSKU-UPC-NBR.                        
273700*    MOVE TR025-ERD-PO-NBR     TO PURITM-PO-NBR.                          
273800                                                                          
273900*    PERFORM 7325-SELECT-TPURITM-MULT-UPC.                                
274000*    IF PS-UPC-ON-TPURITM                                                 
274100*       IF  SQLCODE = -811                                                
274200*            INITIALIZE TR221-RECORD                                      
274300*            INITIALIZE TR221-REC-TYP-LOGUPC                              
274400*            MOVE PC-E                    TO TR221-RPT-TYP                
274500*            MOVE PC-WARNING              TO TR221-ERROR-TYPE             
274600*            MOVE TR025-LOGUPC-UPC-NBR    TO TR221-DATA-VALUE             
274700*            MOVE 'UPC NUMBER'         TO TR221-DATA-IN-ERROR             
274800*            MOVE 'UPC ON MULTIPLE PO LINES ON MAINFRAME'                 
274900*                                         TO TR221-ERROR-MSG              
275000*            PERFORM 6250-MOVE-LIKE-RPT-FIELDS                            
275100*            PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                          
275200*            PERFORM 7300-INSERT-TOUTTR7-RPT                              
275300*       END-IF                                                            
275400*       PERFORM 7330-SELECT-TPURITM-ACT-UPC                               
275500*       EVALUATE TRUE                                                     
275600*           WHEN SQLCODE = +0                                             
275700*           WHEN SQLCODE = -811                                           
275800*               INITIALIZE TR221-RECORD                                   
275900*               INITIALIZE TR221-REC-TYP-LOGUPC                           
276000*               MOVE PC-E              TO TR221-RPT-TYP                   
276100*               MOVE PC-WARNING        TO TR221-ERROR-TYPE                
276200*               MOVE TR025-LOGUPC-UPC-NBR TO TR221-DATA-VALUE             
276300*               MOVE 'UPC NUMBER'      TO TR221-DATA-IN-ERROR             
276400*               MOVE                                                      
276500*               'UPC ON BOTH AC/AP & NON AC/AP LINES ON MAINFRAME'        
276600*                                      TO TR221-ERROR-MSG                 
276700*               PERFORM 6250-MOVE-LIKE-RPT-FIELDS                         
276800*               PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                       
276900*               PERFORM 7300-INSERT-TOUTTR7-RPT                           
277000*       END-EVALUATE                                                      
277100*    ELSE                                                                 
277200*        MOVE TR025-LOGUPC-UPC-NBR TO TUPCSKU-UPC-NBR                     
277300*        MOVE TR025-LOGUPC-PO-NBR  TO PURITM-PO-NBR                       
277400*        PERFORM 7330-SELECT-TPURITM-ACT-UPC                              
277500*            EVALUATE TRUE                                                
277600*                WHEN SQLCODE = +0                                        
277700*                WHEN SQLCODE = -811                                      
277800*                    INITIALIZE TR221-RECORD                              
277900*                    INITIALIZE TR221-REC-TYP-LOGUPC                      
278000*                    MOVE PC-E         TO TR221-RPT-TYP                   
278100*                    MOVE PC-WARNING   TO TR221-ERROR-TYPE                
278200*                    MOVE TR025-LOGUPC-UPC-NBR                            
278300*                                      TO TR221-DATA-VALUE                
278400*                    MOVE 'UPC NUMBER' TO TR221-DATA-IN-ERROR             
278500*                    MOVE                                                 
278600*                     'UPC NOT ACTIVE OR APPROVED ON MAINFRAME'           
278700*                                      TO TR221-ERROR-MSG                 
278800*                    PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    
278900*                    PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  
279000*                    PERFORM 7300-INSERT-TOUTTR7-RPT                      
279100*                WHEN SQLCODE = +100                                      
279200*                    INITIALIZE TR221-RECORD                              
279300*                    INITIALIZE TR221-REC-TYP-LOGUPC                      
279400*                    MOVE PC-E         TO TR221-RPT-TYP                   
279500*                    MOVE PC-WARNING   TO TR221-ERROR-TYPE                
279600*                    MOVE TR025-LOGUPC-UPC-NBR                            
279700*                                      TO TR221-DATA-VALUE                
279800*                    MOVE 'UPC NUMBER' TO TR221-DATA-IN-ERROR             
279900*                    MOVE 'UPC NOT ON MAINFRAME PO'                       
280000*                                      TO TR221-ERROR-MSG                 
280100*                    PERFORM 6250-MOVE-LIKE-RPT-FIELDS                    
280200*                    PERFORM 6400-MOVE-UNIQUE-RPT-FIELDS                  
280300*                    PERFORM 7300-INSERT-TOUTTR7-RPT                      
280400*            END-EVALUATE                                                 
280500*    END-IF.                                                              
280600                                                                          
280700 EJECT                                                                    
280800                                                                          
280900******************************************************************        
281000*    SELECT CHECKPOINT RESTART CONTROL INFORMATION.              *        
281100******************************************************************        
281200 4000-GET-CHECKPOINT-CNTL.                                                
281300                                                                          
281400     PERFORM WITH TEST AFTER                                              
281500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
281600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                     
281700                 SQLCODE = ZERO                                           
281800                                                                          
281900         EXEC SQL                                                         
282000           SELECT  CKPT_STAT_CODE                                         
282100             INTO :PV-CKPT-STAT-CODE                                      
282200             FROM  TCKRSTCNTL                                             
282300            WHERE  PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                   
282400         END-EXEC                                                         
282500                                                                          
282600         EVALUATE TRUE                                                    
282700             WHEN SQLCODE = ZERO                                          
282800             WHEN SQLCODE = -904                                          
282900             WHEN SQLCODE = -913                                          
283000                  CONTINUE                                                
283100                                                                          
283200             WHEN SQLWARN0 NOT EQUAL SPACE                                
283300             WHEN SQLCODE NOT EQUAL ZERO                                  
283400                 DISPLAY '**************************************'         
283500                 DISPLAY '** ABEND                            **'         
283600                 DISPLAY '** PROGRAM = TRKUP225               **'         
283700                 DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT- **'         
283800                 DISPLAY '**                  CNTL            **'         
283900                 DISPLAY '** SELECT FROM TCKRSTCNTL           **'         
284000                 DISPLAY '**CKPT-STAT-CODE ='                             
284100                 DISPLAY              TCKRSTCNTL-CKPT-STAT-CODE           
284200                 DISPLAY '**************************************'         
284300                 PERFORM 9100-SQL-ABEND                                   
284400         END-EVALUATE                                                     
284500     END-PERFORM.                                                         
284600                                                                          
284700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
284800         SQLCODE NOT = ZERO                                               
284900         DISPLAY '****************************************'               
285000         DISPLAY '** MAX RETRIES EXCEEDED ON SELECT     **'               
285100         DISPLAY '** FROM TCKRSTCNTL                    **'               
285200         DISPLAY '** PARAGRAPH = 4000-GET-CHECKPOINT-CNTL*'               
285300         DISPLAY '****************************************'               
285400         PERFORM 9100-SQL-ABEND                                           
285500     END-IF.                                                              
285600                                                                          
285700 EJECT                                                                    
285800                                                                          
285900******************************************************************        
286000*    SELECT CHECKPOINT RESTART WORKING STORAGE DESCRIPTION INFO  *        
286100******************************************************************        
286200 4010-GET-CHECKPOINT-INFO.                                                
286300                                                                          
286400     PERFORM                                                              
286500         WITH TEST AFTER                                                  
286600         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
286700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
286800                 SQLCODE = ZERO                                           
286900                                                                          
287000         EXEC SQL                                                         
287100           SELECT WORK_STRG_DESC                                          
287200           INTO :TCKRSTINF-WORK-STRG-DESC                                 
287300           FROM TCKRSTINF                                                 
287400           WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                     
287500         END-EXEC                                                         
287600                                                                          
287700         EVALUATE TRUE                                                    
287800             WHEN SQLCODE = ZERO                                          
287900             WHEN SQLCODE = -904                                          
288000             WHEN SQLCODE = -913                                          
288100                  CONTINUE                                                
288200                                                                          
288300             WHEN SQLWARN0 NOT EQUAL SPACE                                
288400             WHEN SQLCODE NOT EQUAL ZERO                                  
288500                 DISPLAY '**************************************'         
288600                 DISPLAY '** ABEND                            **'         
288700                 DISPLAY '** PROGRAM = TRKUP225               **'         
288800                 DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT- **'         
288900                 DISPLAY '**                  INFO            **'         
289000                 DISPLAY '** SELECT FROM TCKRSTINF            **'         
289100                 DISPLAY '**************************************'         
289200                 PERFORM 9100-SQL-ABEND                                   
289300         END-EVALUATE                                                     
289400     END-PERFORM.                                                         
289500                                                                          
289600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
289700         SQLCODE NOT = ZERO                                               
289800         DISPLAY '****************************************'               
289900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
290000         DISPLAY '** SELECT FROM TCKRSTINF              **'               
290100         DISPLAY '** PARAGRAPH = 4010-GET-CHECKPOINT-INFO*'               
290200         DISPLAY '****************************************'               
290300         PERFORM 9100-SQL-ABEND                                           
290400     END-IF.                                                              
290500                                                                          
290600 EJECT                                                                    
290700******************************************************************        
290800*    SET THE TIME FOR THE NEXT CHECKPOINT.                       *        
290900******************************************************************        
291000 4020-SET-COMMIT-TIME.                                                    
291100                                                                          
291200      EXEC SQL                                                            
291300          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)            
291400          INTO :PV-HOLD-TMST                                              
291500          FROM TCKRSTCNTL                                                 
291600          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                      
291700      END-EXEC.                                                           
291800                                                                          
291900     EVALUATE TRUE                                                        
292000         WHEN SQLWARN0 NOT EQUAL SPACE                                    
292100         WHEN SQLCODE NOT EQUAL ZERO                                      
292200     DISPLAY '**********************************'                         
292300     DISPLAY '** ABEND **'                                                
292400     DISPLAY '** PROGRAM = TRKUP225 **'                                   
292500     DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME**'                      
292600     DISPLAY '**UNSUCESSFUL SET OF COMMIT INTERVAL**'                     
292700     DISPLAY 'IMRCPO PO NUMBER       = ' IMRCPO-PO-NBR                    
292800     DISPLAY 'IMRCPO EXTL REF NBR    = ' IMRCPO-EXTL-REF-NBR              
292900     DISPLAY 'IMRCPO PO RCVD DELY DTE = '                                 
293000                IMRCPO-PO-RCVD-DELY-TMST (1:4)                            
293100                IMRCPO-PO-RCVD-DELY-TMST (6:2)                            
293200                IMRCPO-PO-RCVD-DELY-TMST (9:2)                            
293300     DISPLAY 'IMRCPO PO RCVD DELY TM  = '                                 
293400                IMRCPO-PO-RCVD-DELY-TMST (12:2)                           
293500                IMRCPO-PO-RCVD-DELY-TMST (15:2)                           
293600     DISPLAY 'IMRCPO ORGN SHPD FR CDE = ' IMRCPO-ORGN-SHPD-FR-CDE         
293700     DISPLAY 'RECEIVING INPUT COUNT  = ' PA-TOTAL-RECS-READ               
293800     DISPLAY 'RCPO RECS INSERT COUNT = ' PA-TOT-RCPO-INSERTS              
293900     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS           
294000*    DISPLAY 'RCVS RECS INSERT COUNT = ' PA-TOT-RCVS-INSERTS              
294100*    DISPLAY 'RCUP RECS INSERT COUNT = ' PA-TOT-RCUPC-INSERTS             
294200     DISPLAY 'ARCPO REC INSERT COUNT = ' PA-TOT-RCPO-AUDITS               
294300*    DISPLAY 'ARCVS REC INSERT COUNT = ' PA-TOT-RCVS-AUDITS               
294400*    DISPLAY 'ARCUP REC INSERT COUNT = ' PA-TOT-RCUPC-AUDITS              
294500     DISPLAY 'RCPO RECS DELETE COUNT = ' PA-TOT-RCPO-DELETES              
294600*    DISPLAY 'RCVS RECS DELETE COUNT = ' PA-TOT-RCVS-DELETES              
294700*    DISPLAY 'RCUP RECS DELETE COUNT = ' PA-TOT-RCUPC-DELETES             
294800     DISPLAY 'RCPO RECS CHANGE COUNT = ' PA-TOT-RCPO-CHANGES              
294900*    DISPLAY 'RCVS RECS CHANGE COUNT = ' PA-TOT-RCVS-CHANGES              
295000*    DISPLAY 'RCUP RECS CHANGE COUNT = ' PA-TOT-RCUP-CHANGES              
295100     DISPLAY 'RCPO CHANGE ADDS - B   = ' PA-TOT-RCPO-CHANGES-B            
295200*    DISPLAY 'RCVS CHANGE ADDS - B   = ' PA-TOT-RCVS-CHANGES-B            
295300*    DISPLAY 'RCUP CHANGE ADDS - B   = ' PA-TOT-RCUP-CHANGES-B            
295400*    DISPLAY 'RCVS CHANGE ADDS - Z   = ' PA-TOT-RCVS-CHANGES-Z            
295500*    DISPLAY 'RCUP CHANGE ADDS - Z   = ' PA-TOT-RCUP-CHANGES-Z            
295600*    DISPLAY 'RCVS DELETES     - E   = ' PA-TOT-RCVS-DELETES-E            
295700*    DISPLAY 'RCUP DELETES     - E   = ' PA-TOT-RCUP-DELETES-E            
295800     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS                 
295900     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED             
296000     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT             
296100     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT            
296200     DISPLAY '**********************************'                         
296300                                                                          
296400             PERFORM 9100-SQL-ABEND                                       
296500     END-EVALUATE.                                                        
296600                                                                          
296700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
296800         SQLCODE NOT = ZERO                                               
296900         DISPLAY '****************************************'               
297000         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
297100         DISPLAY '** SELECT FROM TCKRSTCNTL             **'               
297200         DISPLAY '** PARAGRAPH = 4020-SET-COMMIT-TIME   **'               
297300         DISPLAY '****************************************'               
297400         PERFORM 9100-SQL-ABEND                                           
297500     END-IF.                                                              
297600                                                                          
297700 EJECT                                                                    
297800                                                                          
297900******************************************************************        
298000*    CHECK TO SEE IF A COMMIT SHOULD BE TAKEN.                   *        
298100******************************************************************        
298200 4100-COMMIT-CHECK.                                                       
298300                                                                          
298400     EXEC SQL                                                             
298500       SET :PV-TMST = CURRENT TIMESTAMP                                   
298600     END-EXEC.                                                            
298700                                                                          
298800     EVALUATE TRUE                                                        
298900         WHEN SQLWARN0 NOT EQUAL SPACE                                    
299000         WHEN SQLCODE NOT EQUAL ZERO                                      
299100     DISPLAY '**********************************'                         
299200     DISPLAY '** ABEND **'                                                
299300     DISPLAY '** PROGRAM = TRKUP225***'                                   
299400     DISPLAY '** PARAGRAPH = 4100-COMMIT-CHECK**'                         
299500     DISPLAY '**UNSUCCESSFUL SELECT TIMESTAMP**'                          
299600     DISPLAY 'IMRCPO PO NUMBER       = ' IMRCPO-PO-NBR                    
299700     DISPLAY 'IMRCPO EXTL REF NBR    = ' IMRCPO-EXTL-REF-NBR              
299800     DISPLAY 'IMRCPO PO RCVD DELY DTE = '                                 
299900                IMRCPO-PO-RCVD-DELY-TMST (1:4)                            
300000                IMRCPO-PO-RCVD-DELY-TMST (6:2)                            
300100                IMRCPO-PO-RCVD-DELY-TMST (9:2)                            
300200     DISPLAY 'IMRCPO PO RCVD DELY TM  = '                                 
300300                IMRCPO-PO-RCVD-DELY-TMST (12:2)                           
300400                IMRCPO-PO-RCVD-DELY-TMST (15:2)                           
300500     DISPLAY 'IMRCPO ORGN SHPD FR CDE = ' IMRCPO-ORGN-SHPD-FR-CDE         
300600     DISPLAY 'RECEIVING INPUT COUNT    = ' PA-TOTAL-RECS-READ             
300700     DISPLAY 'RCPO RECS INSERT COUNT = ' PA-TOT-RCPO-INSERTS              
300800     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS           
300900*    DISPLAY 'RCVS RECS INSERT COUNT = ' PA-TOT-RCVS-INSERTS              
301000*    DISPLAY 'RCUP RECS INSERT COUNT = ' PA-TOT-RCUPC-INSERTS             
301100     DISPLAY 'ARCPO REC INSERT COUNT = ' PA-TOT-RCPO-AUDITS               
301200*    DISPLAY 'ARCVS REC INSERT COUNT = ' PA-TOT-RCVS-AUDITS               
301300*    DISPLAY 'ARCUP REC INSERT COUNT = ' PA-TOT-RCUPC-AUDITS              
301400     DISPLAY 'RCPO RECS DELETE COUNT = ' PA-TOT-RCPO-DELETES              
301500*    DISPLAY 'RCVS RECS DELETE COUNT = ' PA-TOT-RCVS-DELETES              
301600*    DISPLAY 'RCUP RECS DELETE COUNT = ' PA-TOT-RCUPC-DELETES             
301700     DISPLAY 'RCPO RECS CHANGE COUNT = ' PA-TOT-RCPO-CHANGES              
301800*    DISPLAY 'RCVS RECS CHANGE COUNT = ' PA-TOT-RCVS-CHANGES              
301900*    DISPLAY 'RCUP RECS CHANGE COUNT = ' PA-TOT-RCUP-CHANGES              
302000     DISPLAY 'RCPO CHANGE ADDS - B   = ' PA-TOT-RCPO-CHANGES-B            
302100*    DISPLAY 'RCVS CHANGE ADDS - B   = ' PA-TOT-RCVS-CHANGES-B            
302200*    DISPLAY 'RCUP CHANGE ADDS - B   = ' PA-TOT-RCUP-CHANGES-B            
302300*    DISPLAY 'RCVS CHANGE ADDS - Z   = ' PA-TOT-RCVS-CHANGES-Z            
302400*    DISPLAY 'RCUP CHANGE ADDS - Z   = ' PA-TOT-RCUP-CHANGES-Z            
302500*    DISPLAY 'RCVS DELETES     - E   = ' PA-TOT-RCVS-DELETES-E            
302600*    DISPLAY 'RCUP DELETES     - E   = ' PA-TOT-RCUP-DELETES-E            
302700     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS                 
302800     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED             
302900     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT             
303000     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT            
303100     DISPLAY '**********************************'                         
303200                                                                          
303300             PERFORM 9100-SQL-ABEND                                       
303400     END-EVALUATE.                                                        
303500                                                                          
303600     IF PV-TMST > PV-HOLD-TMST                                            
303700         IF NO-COMMITS-TAKEN                                              
303800             MOVE PC-IN-PROCESS-CODE TO PV-CKPT-STAT-CODE                 
303900             PERFORM 4200-UPDATE-TCKRSTCNTL                               
304000             SET COMMITS-TAKEN TO TRUE                                    
304100         END-IF                                                           
304200        PERFORM 4210-UPDATE-TCKRSTINF                                     
304300        PERFORM 4300-COMMIT                                               
304400        DISPLAY 'COMMIT TAKEN AT '                                        
304500        DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)        
304600         '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2)        
304700        DISPLAY 'IMRCPO PO NUMBER       = ' IMRCPO-PO-NBR                 
304800        DISPLAY 'IMRCPO EXTL REF NBR    = ' IMRCPO-EXTL-REF-NBR           
304900        DISPLAY 'IMRCPO PO RCVD DELY DTE = '                              
305000                   IMRCPO-PO-RCVD-DELY-TMST (1:4)                         
305100                   IMRCPO-PO-RCVD-DELY-TMST (6:2)                         
305200                   IMRCPO-PO-RCVD-DELY-TMST (9:2)                         
305300        DISPLAY 'IMRCPO PO RCVD DELY TM  = '                              
305400                   IMRCPO-PO-RCVD-DELY-TMST (12:2)                        
305500                   IMRCPO-PO-RCVD-DELY-TMST (15:2)                        
305600        DISPLAY 'IMRCPO ORGN SHPD FR CDE = '                              
305700                   IMRCPO-ORGN-SHPD-FR-CDE                                
305800        DISPLAY 'RECEIVING INPUT COUNT  = ' PA-TOTAL-RECS-READ            
305900        DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS              
306000        DISPLAY 'TOTAL LOADED COUNT     = ' PA-TOTAL-RECS-LOADED          
306100        DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT          
306200        DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT         
306300        PERFORM 4020-SET-COMMIT-TIME                                      
306400     END-IF.                                                              
306500                                                                          
306600 EJECT                                                                    
306700                                                                          
306800******************************************************************        
306900*    CHECK TO SEE IF A CHECKPOINT RESTART SHOULD BE DONE.        *        
307000******************************************************************        
307100 4110-CHECKPOINT-RESTART.                                                 
307200                                                                          
307300     PERFORM 4010-GET-CHECKPOINT-INFO.                                    
307400     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.             
307500                                                                          
307600     DISPLAY '***********************************************'.           
307700     DISPLAY '** TRKUP225 CHECKPOINT RESTART **'.                         
307800     DISPLAY '** RECEIVING RECS BYPASSED ON RESTART = '.                  
307900     DISPLAY  CR-RECEIVING-RECS-WORKED.                                   
308000     DISPLAY '***********************************************'.           
308100                                                                          
308200     IF INPUT-RECEIVING-FILE                                              
308300         PERFORM 6000-READ-RCVD-FILE                                      
308400             CR-RECEIVING-RECS-WORKED TIMES                               
308500*        PERFORM 6000-READ-RCVD-FILE                                      
308600     ELSE                                                                 
308700         MOVE CR-RECEIVING-RECS-WORKED TO PA-TOTAL-RECS-READ              
308800         SET PS-END-OF-INPUT TO TRUE                                      
308900     END-IF.                                                              
309000 EJECT                                                                    
309100                                                                          
309200******************************************************************        
309300*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *        
309400*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *        
309500******************************************************************        
309600 4200-UPDATE-TCKRSTCNTL.                                                  
309700                                                                          
309800     PERFORM WITH TEST AFTER                                              
309900             VARYING PV-RETRY-COUNTER FROM 1 BY 1                         
310000             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                 
310100                     SQLCODE = ZERO                                       
310200                                                                          
310300         EXEC SQL                                                         
310400             UPDATE TCKRSTCNTL                                            
310500             SET CKPT_STAT_CODE = :PV-CKPT-STAT-CODE                      
310600             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME              
310700         END-EXEC                                                         
310800                                                                          
310900         EVALUATE TRUE                                                    
311000             WHEN SQLCODE = ZERO                                          
311100             WHEN SQLCODE = -904                                          
311200             WHEN SQLCODE = -913                                          
311300                  CONTINUE                                                
311400                                                                          
311500             WHEN SQLWARN0 NOT EQUAL SPACE                                
311600             WHEN SQLCODE NOT EQUAL ZERO                                  
311700                 DISPLAY '**************************************'         
311800                 DISPLAY '** ABEND                            **'         
311900                 DISPLAY '** PROGRAM = TRKUP225               **'         
312000                 DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL*'         
312100                 DISPLAY '** UPDATE TCKRSTCNTL                **'         
312200                 DISPLAY '**' PV-CKPT-STAT-CODE                           
312300                 DISPLAY '**************************************'         
312400                 PERFORM 9100-SQL-ABEND                                   
312500         END-EVALUATE                                                     
312600     END-PERFORM.                                                         
312700                                                                          
312800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
312900         SQLCODE NOT = ZERO                                               
313000         DISPLAY '****************************************'               
313100         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
313200         DISPLAY '** UPDATE TO TCKRSTCNTL               **'               
313300         DISPLAY '** PARAGRAPH = 4200-UPDATE-TCKRSTCNTL **'               
313400         DISPLAY '**' PV-CKPT-STAT-CODE                                   
313500         DISPLAY '****************************************'               
313600         PERFORM 9100-SQL-ABEND                                           
313700     END-IF.                                                              
313800                                                                          
313900 EJECT                                                                    
314000                                                                          
314100******************************************************************        
314200*    UPDATES THE CHECKPOINT RESTART INFO TABLE.  THE WORKING     *        
314300*    STORAGE DESCRIPTION FIELD IS UPDATED WITH THE CURRENT INPUT *        
314400*    FILE RECORD COUNTS AND THE FILE PROCESSOR INDICATOR.        *        
314500******************************************************************        
314600 4210-UPDATE-TCKRSTINF.                                                   
314700                                                                          
314800     MOVE PA-TOTAL-RECS-READ  TO CR-RECEIVING-RECS-WORKED.                
314900     MOVE CKPT-RESTART-INFO   TO TCKRSTINF-WORK-STRG-DESC-TEXT.           
315000     MOVE 4022                TO TCKRSTINF-WORK-STRG-DESC-LEN.            
315100                                                                          
315200     PERFORM WITH TEST AFTER                                              
315300             VARYING PV-RETRY-COUNTER FROM 1 BY 1                         
315400             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR                 
315500                     SQLCODE = ZERO                                       
315600                                                                          
315700         EXEC SQL                                                         
315800             UPDATE TCKRSTINF                                             
315900             SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC             
316000             WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME              
316100         END-EXEC                                                         
316200                                                                          
316300         EVALUATE TRUE                                                    
316400             WHEN SQLCODE = ZERO                                          
316500             WHEN SQLCODE = -904                                          
316600             WHEN SQLCODE = -913                                          
316700                  CONTINUE                                                
316800                                                                          
316900             WHEN SQLWARN0 NOT EQUAL SPACE                                
317000             WHEN SQLCODE NOT EQUAL ZERO                                  
317100                 DISPLAY '**************************************'         
317200                 DISPLAY '** ABEND                            **'         
317300                 DISPLAY '** PROGRAM = TRKUP225               **'         
317400                 DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF**'         
317500                 DISPLAY '** UPDATE TCKRSTINF                 **'         
317600                 DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                    
317700                 DISPLAY '**************************************'         
317800                 PERFORM 9100-SQL-ABEND                                   
317900         END-EVALUATE                                                     
318000     END-PERFORM.                                                         
318100                                                                          
318200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
318300         SQLCODE NOT = ZERO                                               
318400         DISPLAY '****************************************'               
318500         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
318600         DISPLAY '** UPDATE TCKRSTINF                   **'               
318700         DISPLAY '** PARAGRAPH = 4210-UPDATE-TCKRSTINF  **'               
318800         DISPLAY '**' TCKRSTINF-WORK-STRG-DESC                            
318900         DISPLAY '****************************************'               
319000         PERFORM 9100-SQL-ABEND                                           
319100     END-IF.                                                              
319200                                                                          
319300 EJECT                                                                    
319400                                                                          
319500******************************************************************        
319600*  ISSUES AN SQL COMMIT AFTER A LOGICAL UNIT OF WORK HAS BEEN    *        
319700*  COMPLETED.                                                    *        
319800******************************************************************        
319900 4300-COMMIT.                                                             
320000                                                                          
320100     EXEC SQL                                                             
320200         COMMIT                                                           
320300     END-EXEC.                                                            
320400                                                                          
320500     EVALUATE TRUE                                                        
320600         WHEN SQLWARN0 NOT EQUAL SPACE                                    
320700         WHEN SQLCODE NOT EQUAL ZERO                                      
320800     DISPLAY '**********************************'                         
320900     DISPLAY 'IMRCPO PO NUMBER       = ' IMRCPO-PO-NBR                    
321000     DISPLAY 'IMRCPO EXTL REF NBR    = ' IMRCPO-EXTL-REF-NBR              
321100     DISPLAY 'IMRCPO PO RCVD DELY DTE = '                                 
321200                IMRCPO-PO-RCVD-DELY-TMST (1:4)                            
321300                IMRCPO-PO-RCVD-DELY-TMST (6:2)                            
321400                IMRCPO-PO-RCVD-DELY-TMST (9:2)                            
321500     DISPLAY 'IMRCPO PO RCVD DELY TM  = '                                 
321600                IMRCPO-PO-RCVD-DELY-TMST (12:2)                           
321700                IMRCPO-PO-RCVD-DELY-TMST (15:2)                           
321800     DISPLAY 'IMRCPO ORGN SHPD FR CDE = ' IMRCPO-ORGN-SHPD-FR-CDE         
321900     DISPLAY 'RECEIVING INPUT COUNT  = ' PA-TOTAL-RECS-READ               
322000     DISPLAY 'RCPO RECS INSERT COUNT = ' PA-TOT-RCPO-INSERTS              
322100     DISPLAY 'TOUTTM1 R INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS           
322200*    DISPLAY 'RCVS RECS INSERT COUNT = ' PA-TOT-RCVS-INSERTS              
322300*    DISPLAY 'RCUP RECS INSERT COUNT = ' PA-TOT-RCUPC-INSERTS             
322400     DISPLAY 'ARCPO REC INSERT COUNT = ' PA-TOT-RCPO-AUDITS               
322500*    DISPLAY 'ARCVS REC INSERT COUNT = ' PA-TOT-RCVS-AUDITS               
322600*    DISPLAY 'ARCUP REC INSERT COUNT = ' PA-TOT-RCUPC-AUDITS              
322700     DISPLAY 'RCPO RECS DELETE COUNT = ' PA-TOT-RCPO-DELETES              
322800*    DISPLAY 'RCVS RECS DELETE COUNT = ' PA-TOT-RCVS-DELETES              
322900*    DISPLAY 'RCUP RECS DELETE COUNT = ' PA-TOT-RCUPC-DELETES             
323000     DISPLAY 'RCPO RECS CHANGE COUNT = ' PA-TOT-RCPO-CHANGES              
323100*    DISPLAY 'RCVS RECS CHANGE COUNT = ' PA-TOT-RCVS-CHANGES              
323200*    DISPLAY 'RCUP RECS CHANGE COUNT = ' PA-TOT-RCUP-CHANGES              
323300     DISPLAY 'RCPO CHANGE ADDS - B   = ' PA-TOT-RCPO-CHANGES-B            
323400*    DISPLAY 'RCVS CHANGE ADDS - B   = ' PA-TOT-RCVS-CHANGES-B            
323500*    DISPLAY 'RCUP CHANGE ADDS - B   = ' PA-TOT-RCUP-CHANGES-B            
323600*    DISPLAY 'RCVS CHANGE ADDS - Z   = ' PA-TOT-RCVS-CHANGES-Z            
323700*    DISPLAY 'RCUP CHANGE ADDS - Z   = ' PA-TOT-RCUP-CHANGES-Z            
323800*    DISPLAY 'RCVS DELETES     - E   = ' PA-TOT-RCVS-DELETES-E            
323900*    DISPLAY 'RCUP DELETES     - E   = ' PA-TOT-RCUP-DELETES-E            
324000     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS                 
324100     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED             
324200     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT             
324300     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT            
324400     DISPLAY '**********************************'                         
324500     DISPLAY '** ABEND **'                                                
324600     DISPLAY '** PROGRAM = TRKUP225 **'                                   
324700     DISPLAY '** PARAGRAPH = 4300-COMMIT**'                               
324800     DISPLAY '**UNSUCCESSFUL COMMIT**'                                    
324900     DISPLAY '**********************************'                         
325000             PERFORM 9100-SQL-ABEND                                       
325100         WHEN SQLCODE EQUAL ZERO                                          
325200             ADD +1 TO PA-TOTAL-COMMITS                                   
325300     END-EVALUATE.                                                        
325400 EJECT                                                                    
325500                                                                          
325600******************************************************************        
325700* READ THE RECEIVING FILE.                                       *        
325800******************************************************************        
325900 6000-READ-RCVD-FILE.                                                     
326000                                                                          
326100     READ TR025-RECEIVING-FILE                                            
326200         INTO TR025-REC-TYP-ERD                                           
326300         AT END                                                           
326400           SET PS-END-OF-INPUT TO TRUE.                                   
326500                                                                          
326600     IF PS-END-OF-INPUT                                                   
326700         CONTINUE                                                         
326800     ELSE                                                                 
326900         MOVE TR025-RECEIVING-RECORD (1:3) TO PV-EDI-RECORDS              
327000         IF EDI-RECORD                                                    
327100             ADD +1 TO PA-TOTAL-RECS-READ                                 
327200             IF TR025-RECEIVING-RECORD (1:3) = PC-ISA                     
327300                 MOVE TR025-RECEIVING-RECORD TO                           
327400                       PV-HOLD-EDI-RECORD                                 
327500             END-IF                                                       
327600         ELSE                                                             
327700             SET PS-GOOD-RECORD TO TRUE                                   
327800             ADD +1 TO PA-TOTAL-RECS-READ                                 
327900         END-IF                                                           
328000     END-IF.                                                              
328100                                                                          
328200                                                                          
328300*****************************************************************         
328400* SETUP THE TR221 RECORD BY MOVING FIELDS THAT ARE INCLUDED IN  *         
328500* BOTH DETAIL AND ERROR RECORDS REGARDLESS OF WHETHER THE       *         
328600* RECORD TYPES ARE ERD, ERDRSN, LOG, LOGVS, LOGUPC.             *         
328700* THESE FIELDS INCLUDE THE HOLD AND KEY FIELDS FOR THE RECORD.  *         
328800*****************************************************************         
328900 6250-MOVE-LIKE-RPT-FIELDS.                                               
329000                                                                          
329100     IF PS-CHANGE-ADD                                                     
329200         MOVE PC-B                     TO TR221-TRN-TYP                   
329300     ELSE                                                                 
329400*        IF PS-CHANGE-ADD-VS-OR-UPC                                       
329500*            MOVE PC-Z                 TO TR221-TRN-TYP                   
329600*        ELSE                                                             
329700             MOVE TR025-ERD-TRN-TYP    TO TR221-TRN-TYP                   
329800*        END-IF                                                           
329900     END-IF.                                                              
330000                                                                          
330100     MOVE TR025-ERD-REC-TYP-CDE        TO TR221-REC-TYP-ERD-CDE           
330200     MOVE TR025-ERD-SEQ-NBR            TO TR221-ERD-SEQ-NBR               
330300     MOVE TR025-ERD-PO-NBR             TO TR221-PO-NBR.                   
330400     MOVE TR025-ERD-EXTL-REF-NBR       TO TR221-EXTL-REF-NBR.             
330500     MOVE TR025-ERD-PO-RCVD-DELY-DTE   TO TR221-PO-RCVD-DELY-DTE.         
330600     MOVE TR025-ERD-PO-RCVD-DELY-TM    TO TR221-PO-RCVD-DELY-TM.          
330700     MOVE TR025-ERD-ORGN-SHPD-FR-CDE   TO TR221-ORGN-SHPD-FR-CDE.         
330800                                                                          
330900     MOVE TR025-ERD-PROCESS-SEQ-NBR TO TR221-PROCESS-SEQ-NBR.             
331000     MOVE TR025-ERD-ENT-ID          TO TR221-DAT-SRC-ENT-ID.              
331100                                                                          
331200 EJECT                                                                    
331300                                                                          
331400*****************************************************************         
331500* LOAD THE ERROR FIELDS WHEN PO IS ALREADY ON TIMRCPO AND THE   *         
331600* CONSOLIDATOR HAS SENT AN ADD.                                 *         
331700*****************************************************************         
331800 6300-PO-THERE-ON-ADD-ERROR.                                              
331900                                                                          
332000     MOVE PC-E                          TO                                
332100        TR221-RPT-TYP.                                                    
332200     MOVE 'PO NUMBER'                   TO                                
332300        TR221-DATA-IN-ERROR.                                              
332400     MOVE TR025-ERD-PO-NBR              TO                                
332500        TR221-DATA-VALUE.                                                 
332600     MOVE PC-ERROR                      TO                                
332700        TR221-ERROR-TYPE.                                                 
332800     MOVE 'ADD SENT, PO PREVIOUSLY SENT-NOT PROCESSED' TO                 
332900        TR221-ERROR-MSG.                                                  
333000                                                                          
333100*****************************************************************         
333200* LOAD THE ERROR FIELDS WHEN VS IS ALREADY ON TIMRCVS AND THE   *         
333300* CONSOLIDATOR HAS SENT AN ADD.                                 *         
333400*****************************************************************         
333500*6310-VS-THERE-ON-ADD-ERROR.                                              
333600                                                                          
333700*    MOVE PC-E                          TO                                
333800*       TR221-RPT-TYP.                                                    
333900*    MOVE 'VS NUMBER'                   TO                                
334000*       TR221-DATA-IN-ERROR.                                              
334100*    MOVE TR025-LOGVS-VS-NBR            TO                                
334200*       TR221-DATA-VALUE.                                                 
334300*    MOVE PC-ERROR                      TO                                
334400*       TR221-ERROR-TYPE.                                                 
334500*    MOVE 'ADD SENT, VS PREVIOUSLY SENT-NOT PROCESSED' TO                 
334600*       TR221-ERROR-MSG.                                                  
334700                                                                          
334800*****************************************************************         
334900* MOVE THE FIELDS THAT ARE UNIQUE TO EACH RECORD TYPE (ERD,               
335000* ERDRSN, LOG, LOGVS, LOGUPC). THIS COMPLETES THE RECORD SETUP            
335100* PRIOR TO INSERTING TO THE DB2 WORKTABLE (TOUTTR7).                      
335200*****************************************************************         
335300 6400-MOVE-UNIQUE-RPT-FIELDS.                                             
335400                                                                          
335500         EVALUATE TR025-ERD-REC-TYP-CDE                                   
335600             WHEN PC-ERD                                                  
335700                 MOVE TR025-ERD-IMPRT-TRIP-ID        TO                   
335800                       TR221-ERD-IMPRT-TRIP-ID                            
335900                 MOVE TR025-ERD-CARR-SCAC-ID         TO                   
336000                       TR221-ERD-CARR-SCAC-ID                             
336100                 MOVE TR025-ERD-IMPRT-VEH-NM           TO                 
336200                       TR221-ERD-IMPRT-VEH-NM                             
336300                 MOVE TR025-ERD-POE-DELY-DTE         TO                   
336400                       TR221-ERD-POE-DELY-DTE                             
336500                 MOVE TR025-ERD-POE-DELY-TM          TO                   
336600                       TR221-ERD-POE-DELY-TM                              
336700                 MOVE TR025-ERD-DPRTR-DTE            TO                   
336800                       TR221-ERD-DPRTR-DTE                                
336900                 MOVE TR025-ERD-DPRTR-TM             TO                   
337000                       TR221-ERD-DPRTR-TM                                 
337100                 MOVE TR025-ERD-FOB-CDE              TO                   
337200                       TR221-ERD-FOB-CDE                                  
337300                 MOVE TR025-ERD-DEST-POE-CDE         TO                   
337400                       TR221-ERD-DEST-POE-CDE                             
337500                 MOVE TR025-ERD-TRIP-TYP-CDE         TO                   
337600                       TR221-ERD-TRIP-TYP-CDE                             
337700                 MOVE TR025-ERD-EST-LBD-NM           TO                   
337800                       TR221-ERD-EST-LBD-NM                               
337900             WHEN PC-ERDRSN                                               
338000                 MOVE TR025-ERDRSN-VOY-CHG-RSN-DESC  TO                   
338100                       TR221-ERDRSN-VOY-CHG-RSN-DESC                      
338200             WHEN PC-LOG                                                  
338300                 MOVE TR025-LOG-PROD-FCTRY-NM        TO                   
338400                       TR221-LOG-PROD-FCTRY-NM                            
338500                 MOVE TR025-LOG-C-O-PROD-CDE         TO                   
338600                       TR221-LOG-C-O-PROD-CDE                             
338700                 IF TR025-LOG-PO-CART-CNT NUMERIC                         
338800                     MOVE TR025-LOG-PO-CART-CNT      TO                   
338900                           TR221-LOG-PO-CART-CNT                          
339000                 ELSE                                                     
339100                     MOVE TR025-LOG-PO-CART-CNT-X    TO                   
339200                           TR221-LOG-PO-CART-CNT-X                        
339300                 END-IF                                                   
339400                 IF TR025-LOG-PO-UNT-QTY NUMERIC                          
339500                     MOVE TR025-LOG-PO-UNT-QTY       TO                   
339600                           TR221-LOG-PO-UNT-QTY                           
339700                 ELSE                                                     
339800                     MOVE TR025-LOG-PO-UNT-QTY-X     TO                   
339900                           TR221-LOG-PO-UNT-QTY-X                         
340000                 END-IF                                                   
340100                 IF TR025-LOG-PO-CBMT-QTY NUMERIC                         
340200                     MOVE TR025-LOG-PO-CBMT-QTY      TO                   
340300                           TR221-LOG-PO-CBMT-QTY                          
340400                 ELSE                                                     
340500                     MOVE TR025-LOG-PO-CBMT-QTY-X    TO                   
340600                           TR221-LOG-PO-CBMT-QTY-X                        
340700                 END-IF                                                   
340800                 IF TR025-LOG-PO-WT-KGRM-QTY NUMERIC                      
340900                     MOVE TR025-LOG-PO-WT-KGRM-QTY   TO                   
341000                           TR221-LOG-PO-WT-KGRM-QTY                       
341100                 ELSE                                                     
341200                     MOVE TR025-LOG-PO-WT-KGRM-QTY-X TO                   
341300                           TR221-LOG-PO-WT-KGRM-QTY-X                     
341400                 END-IF                                                   
341500                 MOVE TR025-LOG-CONSOL-SCAC-ID       TO                   
341600                       TR221-LOG-CONSOL-SCAC-ID                           
341700             WHEN PC-LOGVS                                                
341800                 MOVE TR025-LOGVS-VS-NBR             TO                   
341900                       TR221-LOGVS-VS-NBR                                 
342000                 IF TR025-LOGVS-VS-CART-CNT NUMERIC                       
342100                     MOVE TR025-LOGVS-VS-CART-CNT    TO                   
342200                           TR221-LOGVS-VS-CART-CNT                        
342300                 ELSE                                                     
342400                     MOVE TR025-LOGVS-VS-CART-CNT-X  TO                   
342500                           TR221-LOGVS-VS-CART-CNT-X                      
342600                 END-IF                                                   
342700                 IF TR025-LOGVS-VS-UNT-QTY NUMERIC                        
342800                     MOVE TR025-LOGVS-VS-UNT-QTY     TO                   
342900                           TR221-LOGVS-VS-UNT-QTY                         
343000                 ELSE                                                     
343100                     MOVE TR025-LOGVS-VS-UNT-QTY-X   TO                   
343200                           TR221-LOGVS-VS-UNT-QTY-X                       
343300                 END-IF                                                   
343400                 IF TR025-LOGVS-VS-CBMT-QTY NUMERIC                       
343500                     MOVE TR025-LOGVS-VS-CBMT-QTY    TO                   
343600                           TR221-LOGVS-VS-CBMT-QTY                        
343700                 ELSE                                                     
343800                     MOVE TR025-LOGVS-VS-CBMT-QTY-X  TO                   
343900                           TR221-LOGVS-VS-CBMT-QTY-X                      
344000                 END-IF                                                   
344100                 IF TR025-LOGVS-VS-WT-KGRM-QTY NUMERIC                    
344200                     MOVE TR025-LOGVS-VS-WT-KGRM-QTY   TO                 
344300                           TR221-LOGVS-VS-WT-KGRM-QTY                     
344400                 ELSE                                                     
344500                     MOVE TR025-LOGVS-VS-WT-KGRM-QTY-X TO                 
344600                           TR221-LOGVS-VS-WT-KGRM-QTY-X                   
344700                 END-IF                                                   
344800             WHEN PC-LOGUPC                                               
344900                 MOVE TR025-LOGUPC-VS-NBR              TO                 
345000                       TR221-LOGUPC-VS-NBR                                
345100                 IF TR025-LOGUPC-UPC-NBR NUMERIC                          
345200                     MOVE TR025-LOGUPC-UPC-NBR         TO                 
345300                           TR221-LOGUPC-UPC-NBR                           
345400                 ELSE                                                     
345500                     MOVE TR025-LOGUPC-UPC-NBR-X       TO                 
345600                           TR221-LOGUPC-UPC-NBR-X                         
345700                 END-IF                                                   
345800                 IF TR025-LOGUPC-UPC-CART-CNT NUMERIC                     
345900                     MOVE TR025-LOGUPC-UPC-CART-CNT    TO                 
346000                           TR221-LOGUPC-UPC-CART-CNT                      
346100                 ELSE                                                     
346200                     MOVE TR025-LOGUPC-UPC-CART-CNT-X  TO                 
346300                           TR221-LOGUPC-UPC-CART-CNT-X                    
346400                 END-IF                                                   
346500                 IF TR025-LOGUPC-UPC-UNT-QTY NUMERIC                      
346600                     MOVE TR025-LOGUPC-UPC-UNT-QTY     TO                 
346700                           TR221-LOGUPC-UPC-UNT-QTY                       
346800                 ELSE                                                     
346900                     MOVE TR025-LOGUPC-UPC-UNT-QTY-X   TO                 
347000                           TR221-LOGUPC-UPC-UNT-QTY-X                     
347100                 END-IF                                                   
347200                 IF TR025-LOGUPC-UPC-CBMT-QTY NUMERIC                     
347300                     MOVE TR025-LOGUPC-UPC-CBMT-QTY    TO                 
347400                           TR221-LOGUPC-UPC-CBMT-QTY                      
347500                 ELSE                                                     
347600                     MOVE TR025-LOGUPC-UPC-CBMT-QTY-X  TO                 
347700                           TR221-LOGUPC-UPC-CBMT-QTY-X                    
347800                 END-IF                                                   
347900                 IF TR025-LOGUPC-UPC-WT-KGRM-QTY NUMERIC                  
348000                     MOVE TR025-LOGUPC-UPC-WT-KGRM-QTY   TO               
348100                           TR221-LOGUPC-UPC-WT-KGRM-QTY                   
348200                 ELSE                                                     
348300                     MOVE TR025-LOGUPC-UPC-WT-KGRM-QTY-X TO               
348400                           TR221-LOGUPC-UPC-WT-KGRM-QTY-X                 
348500                 END-IF                                                   
348600         END-EVALUATE.                                                    
348700                                                                          
348800 EJECT                                                                    
348900                                                                          
349000*****************************************************************         
349100* SETUP THE DCLGEN FIELDS PRIOR TO INSERT BY MOVING THE FIELDS  *         
349200* THAT ARE ON EACH RECORD REGARDLESS OF WHETHER THE             *         
349300* RECORD TYPES ARE ERD, ERDRSN, LOG, LOGVS, LOGUPC.             *         
349400* THESE FIELDS INCLUDE THE HOLD AND KEY FIELDS FOR THE RECORD.  *         
349500*****************************************************************         
349600 6425-LIKE-MOVES-INSERT-TIMRCPO.                                          
349700                                                                          
349800     MOVE TR025-ERD-PO-NBR                        TO                      
349900              IMRCPO-PO-NBR.                                              
350000     MOVE PV-RCVD-SEQ-NBR-MAX                     TO                      
350100              IMRCPO-PO-RCVD-SEQ-NBR.                                     
350200     MOVE TR025-ERD-PO-RCVD-DELY-DTE (1:4)        TO                      
350300              IMRCPO-PO-RCVD-DELY-TMST (1:4)                              
350400     MOVE PC-DASH                                 TO                      
350500              IMRCPO-PO-RCVD-DELY-TMST (5:1)                              
350600     MOVE TR025-ERD-PO-RCVD-DELY-DTE (5:2)        TO                      
350700              IMRCPO-PO-RCVD-DELY-TMST (6:2)                              
350800     MOVE PC-DASH                                 TO                      
350900              IMRCPO-PO-RCVD-DELY-TMST (8:1)                              
351000     MOVE TR025-ERD-PO-RCVD-DELY-DTE (7:2)        TO                      
351100              IMRCPO-PO-RCVD-DELY-TMST (9:2)                              
351200     MOVE PC-DASH                                 TO                      
351300              IMRCPO-PO-RCVD-DELY-TMST (11:1)                             
351400     MOVE TR025-ERD-PO-RCVD-DELY-TM (1:2)         TO                      
351500              IMRCPO-PO-RCVD-DELY-TMST (12:2)                             
351600     MOVE PC-DECIMAL                              TO                      
351700              IMRCPO-PO-RCVD-DELY-TMST (14:1)                             
351800     MOVE TR025-ERD-PO-RCVD-DELY-TM (3:2)         TO                      
351900              IMRCPO-PO-RCVD-DELY-TMST (15:2)                             
352000     MOVE PC-DECIMAL                              TO                      
352100              IMRCPO-PO-RCVD-DELY-TMST (17:1)                             
352200     MOVE ZEROES                                  TO                      
352300              IMRCPO-PO-RCVD-DELY-TMST (18:2)                             
352400     MOVE PC-DECIMAL                              TO                      
352500              IMRCPO-PO-RCVD-DELY-TMST (20:1)                             
352600     MOVE ZEROES                                  TO                      
352700              IMRCPO-PO-RCVD-DELY-TMST (21:6)                             
352800     MOVE TR025-ERD-EXTL-REF-NBR                  TO                      
352900              IMRCPO-EXTL-REF-NBR.                                        
353000     MOVE TR025-ERD-ORGN-SHPD-FR-CDE              TO                      
353100              IMRCPO-ORGN-SHPD-FR-CDE.                                    
353200     MOVE SPACES                                  TO                      
353300              IMRCPO-PO-EXC-APVL-CDE.                                     
353400     MOVE SPACES                                  TO                      
353500              IMRCPO-PO-EXC-APVL-USR-ID.                                  
353600     MOVE PC-DEFAULT-TMST                         TO                      
353700              IMRCPO-PO-EXC-APVL-TMST.                                    
353800     MOVE SPACES                                  TO                      
353900              IMRCPO-PO-EXC-RSN-DESC.                                     
354000     MOVE TR025-ERD-ENT-ID                        TO                      
354100              PV-ENT-ID-SIGNED.                                           
354200     MOVE PV-ENT-ID-SIGNED                        TO                      
354300              IMRCPO-DAT-SRC-ENT-ID.                                      
354400     MOVE PC-CURRENT-PROGRAM-NAME                 TO                      
354500              IMRCPO-CRE-BY-USR-ID.                                       
354600     PERFORM 7999-SET-CURRENT-TMST.                                       
354700     MOVE PV-CURRENT-TMST                         TO                      
354800              IMRCPO-CRE-TMST.                                            
354900     MOVE PC-CURRENT-PROGRAM-NAME                 TO                      
355000              IMRCPO-LAST-UPD-BY-USR-ID.                                  
355100     MOVE PV-CURRENT-TMST                         TO                      
355200              IMRCPO-LAST-UPD-TMST.                                       
355300                                                                          
355400 EJECT                                                                    
355500                                                                          
355600*****************************************************************         
355700* SETUP THE DCLGEN FIELDS PRIOR TO INSERT BY MOVING THE FIELDS  *         
355800* THAT ARE UNIQUE TO EACH RECORD TYPE.                          *         
355900* RECORD TYPES ARE ERD, ERDRSN, LOG.                            *         
356000*****************************************************************         
356100 6450-MOVES-INSERT-TIMRCPO.                                               
356200                                                                          
356300         EVALUATE TR025-ERD-REC-TYP-CDE                                   
356400             WHEN PC-ERD                                                  
356500                                                                          
356600                 IF PS-ERD-ERDRSN-LOG-LOOP-NO                             
356700                     MOVE PV-RCVD-SEQ-NBR-MAX       TO                    
356800                          IMRCPO-PO-RCVD-SEQ-NBR                          
356900                 END-IF                                                   
357000                 MOVE TR025-ERD-IMPRT-TRIP-ID       TO                    
357100                          IMRCPO-IMPRT-TRIP-ID                            
357200                 MOVE TR025-ERD-DPRTR-DTE (1:4)     TO                    
357300                          IMRCPO-DPRTR-TMST (1:4)                         
357400                 MOVE PC-DASH                       TO                    
357500                          IMRCPO-DPRTR-TMST (5:1)                         
357600                 MOVE TR025-ERD-DPRTR-DTE (5:2)     TO                    
357700                          IMRCPO-DPRTR-TMST (6:2)                         
357800                 MOVE PC-DASH                       TO                    
357900                          IMRCPO-DPRTR-TMST (8:1)                         
358000                 MOVE TR025-ERD-DPRTR-DTE (7:2)     TO                    
358100                          IMRCPO-DPRTR-TMST (9:2)                         
358200                 MOVE PC-DASH                       TO                    
358300                          IMRCPO-DPRTR-TMST (11:1)                        
358400                 MOVE TR025-ERD-DPRTR-TM (1:2)      TO                    
358500                          IMRCPO-DPRTR-TMST (12:2)                        
358600                 MOVE PC-DECIMAL                    TO                    
358700                          IMRCPO-DPRTR-TMST (14:1)                        
358800                 MOVE TR025-ERD-DPRTR-TM (3:2)      TO                    
358900                          IMRCPO-DPRTR-TMST (15:2)                        
359000                 MOVE PC-DECIMAL                    TO                    
359100                          IMRCPO-DPRTR-TMST (17:1)                        
359200                 MOVE ZEROES                        TO                    
359300                          IMRCPO-DPRTR-TMST (18:2)                        
359400                 MOVE PC-DECIMAL                    TO                    
359500                          IMRCPO-DPRTR-TMST (20:1)                        
359600                 MOVE ZEROES                        TO                    
359700                          IMRCPO-DPRTR-TMST (21:6)                        
359800                                                                          
359900*                IF PS-POE-LBD-NO                                         
360000                     MOVE TR025-ERD-POE-DELY-DTE (1:4)  TO                
360100                           IMRCPO-POE-DELY-TMST (1:4)                     
360200                           IMRCPO-EST-LBD-TMST (1:4)                      
360300                     MOVE PC-DASH                       TO                
360400                           IMRCPO-POE-DELY-TMST (5:1)                     
360500                           IMRCPO-EST-LBD-TMST (5:1)                      
360600                     MOVE TR025-ERD-POE-DELY-DTE (5:2)  TO                
360700                           IMRCPO-POE-DELY-TMST (6:2)                     
360800                           IMRCPO-EST-LBD-TMST (6:2)                      
360900                     MOVE PC-DASH                       TO                
361000                           IMRCPO-POE-DELY-TMST (8:1)                     
361100                           IMRCPO-EST-LBD-TMST (8:1)                      
361200                     MOVE TR025-ERD-POE-DELY-DTE (7:2)  TO                
361300                           IMRCPO-POE-DELY-TMST (9:2)                     
361400                           IMRCPO-EST-LBD-TMST (9:2)                      
361500                     MOVE PC-DASH                       TO                
361600                           IMRCPO-POE-DELY-TMST (11:1)                    
361700                           IMRCPO-EST-LBD-TMST (11:1)                     
361800                     MOVE TR025-ERD-POE-DELY-TM (1:2)   TO                
361900                           IMRCPO-POE-DELY-TMST (12:2)                    
362000                           IMRCPO-EST-LBD-TMST (12:2)                     
362100                     MOVE PC-DECIMAL                    TO                
362200                           IMRCPO-POE-DELY-TMST (14:1)                    
362300                           IMRCPO-EST-LBD-TMST (14:1)                     
362400                     MOVE TR025-ERD-POE-DELY-TM (3:2)   TO                
362500                           IMRCPO-POE-DELY-TMST (15:2)                    
362600                           IMRCPO-EST-LBD-TMST (15:2)                     
362700                     MOVE PC-DECIMAL                    TO                
362800                           IMRCPO-POE-DELY-TMST (17:1)                    
362900                           IMRCPO-EST-LBD-TMST (17:1)                     
363000                     MOVE ZEROES                        TO                
363100                           IMRCPO-POE-DELY-TMST (18:2)                    
363200                           IMRCPO-EST-LBD-TMST (18:2)                     
363300                     MOVE PC-DECIMAL                    TO                
363400                           IMRCPO-POE-DELY-TMST (20:1)                    
363500                           IMRCPO-EST-LBD-TMST (20:1)                     
363600                     MOVE ZEROES                        TO                
363700                           IMRCPO-POE-DELY-TMST (21:6)                    
363800                           IMRCPO-EST-LBD-TMST (21:6)                     
363900                     MOVE TR025-ERD-DEST-POE-CDE        TO                
364000                           IMRCPO-DEST-POE-CDE                            
364100                     MOVE TR025-ERD-EST-LBD-NM          TO                
364200                           IMRCPO-EST-LBD-NM                              
364300*                END-IF                                                   
364400                                                                          
364500                 MOVE TR025-ERD-CARR-SCAC-ID        TO                    
364600                          IMRCPO-CARR-SCAC-ID                             
364700                 MOVE TR025-ERD-FOB-CDE             TO                    
364800                          IMRCPO-FOB-CDE                                  
364900                 MOVE TR025-ERD-IMPRT-VEH-NM        TO                    
365000                          IMRCPO-IMPRT-VEH-NM                             
365100                 MOVE TR025-ERD-TRIP-TYP-CDE        TO                    
365200                          IMRCPO-TRIP-TYP-CDE                             
365300                                                                          
365400             WHEN PC-ERDRSN                                               
365500                 MOVE TR025-ERDRSN-VOY-CHG-RSN-DESC TO                    
365600                          IMRCPO-VOY-CHG-RSN-DESC                         
365700                 MOVE TR025-ERDRSN-DPRTR-DTE (1:4)  TO                    
365800                          IMRCPO-DPRTR-TMST (1:4)                         
365900                 MOVE PC-DASH                       TO                    
366000                          IMRCPO-DPRTR-TMST (5:1)                         
366100                 MOVE TR025-ERDRSN-DPRTR-DTE (5:2)  TO                    
366200                          IMRCPO-DPRTR-TMST (6:2)                         
366300                 MOVE PC-DASH                       TO                    
366400                          IMRCPO-DPRTR-TMST (8:1)                         
366500                 MOVE TR025-ERDRSN-DPRTR-DTE (7:2)  TO                    
366600                          IMRCPO-DPRTR-TMST (9:2)                         
366700                 MOVE PC-DASH                       TO                    
366800                          IMRCPO-DPRTR-TMST (11:1)                        
366900                 MOVE TR025-ERDRSN-DPRTR-TM (1:2)   TO                    
367000                          IMRCPO-DPRTR-TMST (12:2)                        
367100                 MOVE PC-DECIMAL                    TO                    
367200                          IMRCPO-DPRTR-TMST (14:1)                        
367300                 MOVE TR025-ERDRSN-DPRTR-TM (3:2)   TO                    
367400                          IMRCPO-DPRTR-TMST (15:2)                        
367500                 MOVE PC-DECIMAL                    TO                    
367600                          IMRCPO-DPRTR-TMST (17:1)                        
367700                 MOVE ZEROES                        TO                    
367800                          IMRCPO-DPRTR-TMST (18:2)                        
367900                 MOVE PC-DECIMAL                    TO                    
368000                          IMRCPO-DPRTR-TMST (20:1)                        
368100                 MOVE ZEROES                        TO                    
368200                          IMRCPO-DPRTR-TMST (21:6)                        
368300*                IF PS-POE-LBD-NO                                         
368400                     MOVE TR025-ERDRSN-POE-DELY-DTE (1:4) TO              
368500                           IMRCPO-POE-DELY-TMST (1:4)                     
368600                     MOVE PC-DASH                       TO                
368700                           IMRCPO-POE-DELY-TMST (5:1)                     
368800                     MOVE TR025-ERDRSN-POE-DELY-DTE (5:2) TO              
368900                           IMRCPO-POE-DELY-TMST (6:2)                     
369000                     MOVE PC-DASH                       TO                
369100                           IMRCPO-POE-DELY-TMST (8:1)                     
369200                     MOVE TR025-ERDRSN-POE-DELY-DTE (7:2) TO              
369300                           IMRCPO-POE-DELY-TMST (9:2)                     
369400                     MOVE PC-DASH                       TO                
369500                           IMRCPO-POE-DELY-TMST (11:1)                    
369600                     MOVE TR025-ERDRSN-POE-DELY-TM (1:2) TO               
369700                           IMRCPO-POE-DELY-TMST (12:2)                    
369800                     MOVE PC-DECIMAL                    TO                
369900                           IMRCPO-POE-DELY-TMST (14:1)                    
370000                     MOVE TR025-ERDRSN-POE-DELY-TM (3:2) TO               
370100                           IMRCPO-POE-DELY-TMST (15:2)                    
370200                     MOVE PC-DECIMAL                    TO                
370300                           IMRCPO-POE-DELY-TMST (17:1)                    
370400                     MOVE ZEROES                        TO                
370500                           IMRCPO-POE-DELY-TMST (18:2)                    
370600                     MOVE PC-DECIMAL                    TO                
370700                           IMRCPO-POE-DELY-TMST (20:1)                    
370800                     MOVE ZEROES                        TO                
370900                           IMRCPO-POE-DELY-TMST (21:6)                    
371000*                END-IF                                                   
371100                                                                          
371200             WHEN PC-LOG                                                  
371300                 MOVE TR025-LOG-CONSOL-SCAC-ID      TO                    
371400                          IMRCPO-CONSLR-SCAC-ID                           
371500                 MOVE TR025-LOG-ORGN-SHPD-FR-CDE    TO                    
371600                          IMRCPO-ORGN-SHPD-FR-CDE                         
371700                 MOVE TR025-LOG-C-O-PROD-CDE        TO                    
371800                          IMRCPO-C-O-PROD-CDE                             
371900                 MOVE TR025-LOG-PROD-FCTRY-NM       TO                    
372000                          IMRCPO-PROD-FCTRY-NM                            
372100                 MOVE TR025-LOG-PO-CART-CNT         TO                    
372200                          IMRCPO-PO-CART-CNT                              
372300                 MOVE TR025-LOG-PO-CBMT-QTY         TO                    
372400                          IMRCPO-PO-CBMT-QTY                              
372500                 MOVE TR025-LOG-PO-WT-KGRM-QTY      TO                    
372600                          IMRCPO-PO-WT-KGRM-QTY                           
372700                 MOVE TR025-LOG-PO-UNT-QTY          TO                    
372800                          IMRCPO-PO-UNT-QTY                               
372900         END-EVALUATE.                                                    
373000                                                                          
373100 EJECT                                                                    
373200                                                                          
373300*****************************************************************         
373400* SETUP THE DCLGEN FIELDS PRIOR TO INSERT BY MOVING THE FIELDS  *         
373500* THAT ARE ON THE VS TABLE, AND THE PO-RCVD-SEQ-NBR WHICH COMES *         
373600* FROM THE PO TABLE.                                            *         
373700*****************************************************************         
373800*6460-MOVES-INSERT-TIMRCVS.                                               
373900                                                                          
374000*    MOVE TR025-ERD-PO-NBR               TO IMRCVS-PO-NBR.                
374100*                                                                         
374200*    IF PS-CHANGE-ADD-VS-OR-UPC OR                                        
374300*       PS-CHANGE-C-VS                                                    
374400*        MOVE IMRCPO-PO-RCVD-SEQ-NBR TO IMRCVS-PO-RCVD-SEQ-NBR            
374500*    ELSE                                                                 
374600*        MOVE PV-RCVD-SEQ-NBR-MAX    TO IMRCVS-PO-RCVD-SEQ-NBR            
374700*    END-IF.                                                              
374800*                                                                         
374900*    MOVE TR025-LOGVS-VS-NBR         TO IMRCVS-VS-NBR.                    
375000*    MOVE SPACES                     TO IMRCVS-HTS-ID.                    
375100*    MOVE TR025-LOGVS-VS-CART-CNT    TO IMRCVS-VS-CART-CNT.               
375200*    MOVE TR025-LOGVS-VS-CBMT-QTY    TO IMRCVS-VS-CBMT-QTY.               
375300*    MOVE TR025-LOGVS-VS-WT-KGRM-QTY TO IMRCVS-VS-WT-KGRM-QTY.            
375400*    MOVE TR025-LOGVS-VS-UNT-QTY     TO IMRCVS-VS-UNT-QTY.                
375500*                                                                         
375600*    MOVE SPACE                      TO IMRCVS-QTA-CTG-IND.               
375700*    MOVE PC-CURRENT-PROGRAM-NAME    TO IMRCVS-CRE-BY-USR-ID.             
375800*    PERFORM 7999-SET-CURRENT-TMST.                                       
375900*                                                                         
376000*    IF PS-CHANGE-C-VS                                                    
376100*       CONTINUE                                                          
376200*    ELSE                                                                 
376300*       MOVE PV-CURRENT-TMST         TO IMRCVS-CRE-TMST                   
376400*    END-IF.                                                              
376500*                                                                         
376600*    MOVE PC-CURRENT-PROGRAM-NAME    TO                                   
376700*                            IMRCVS-LAST-UPD-BY-USR-ID.                   
376800*    MOVE PV-CURRENT-TMST            TO IMRCVS-LAST-UPD-TMST.             
376900*                                                                         
377000 EJECT                                                                    
377100                                                                          
377200*****************************************************************         
377300* SETUP THE DCLGEN FIELDS PRIOR TO INSERT BY MOVING THE FIELDS  *         
377400* THAT ARE ON THE UPC TABLE, AND THE PO-RCVD-SEQ-NBR WHICH COMES *        
377500* FROM THE PO TABLE.                                            *         
377600*****************************************************************         
377700*6470-MOVES-INSERT-TIMRCUP.                                               
377800*                                                                         
377900*    MOVE TR025-LOGUPC-PO-NBR        TO IMRCUP-PO-NBR.                    
378000*                                                                         
378100*    IF PS-CHANGE-ADD-VS-OR-UPC   OR                                      
378200*       PS-CHANGE-C-UPC                                                   
378300*        MOVE IMRCPO-PO-RCVD-SEQ-NBR TO IMRCUP-PO-RCVD-SEQ-NBR            
378400*    ELSE                                                                 
378500*        MOVE PV-RCVD-SEQ-NBR-MAX    TO IMRCUP-PO-RCVD-SEQ-NBR            
378600*    END-IF.                                                              
378700*                                                                         
378800*    MOVE TR025-LOGUPC-VS-NBR        TO IMRCUP-VS-NBR.                    
378900*    MOVE TR025-LOGUPC-UPC-NBR       TO IMRCUP-UPC-NBR.                   
379000*    MOVE TR025-LOGUPC-UPC-CART-CNT  TO IMRCUP-UPC-CART-CNT.              
379100*    MOVE TR025-LOGUPC-UPC-CBMT-QTY  TO IMRCUP-UPC-CBMT-QTY.              
379200*    MOVE TR025-LOGUPC-UPC-WT-KGRM-QTY TO IMRCUP-UPC-WT-KGRM-QTY.         
379300*    MOVE TR025-LOGUPC-UPC-UNT-QTY   TO IMRCUP-UPC-UNT-QTY.               
379400*    MOVE PC-CURRENT-PROGRAM-NAME    TO IMRCUP-CRE-BY-USR-ID.             
379500*    PERFORM 7999-SET-CURRENT-TMST.                                       
379600*                                                                         
379700*    IF PS-CHANGE-C-UPC                                                   
379800*       CONTINUE                                                          
379900*    ELSE                                                                 
380000*       MOVE PV-CURRENT-TMST         TO IMRCUP-CRE-TMST                   
380100*    END-IF.                                                              
380200*                                                                         
380300*    MOVE PC-CURRENT-PROGRAM-NAME    TO                                   
380400*                            IMRCUP-LAST-UPD-BY-USR-ID.                   
380500*    MOVE PV-CURRENT-TMST            TO IMRCUP-LAST-UPD-TMST.             
380600*                                                                         
380700 EJECT                                                                    
380800                                                                          
380900*****************************************************************         
381000*  MAKE SELECTION BASED ON PO, EXTERNAL REF, AND ORIGIN                   
381100*     IF FOUND AND DATES MATCH, DO NOTHING                                
381200*     IF FOUND AND DATES DO NOT MATCH, SEND SCM A 'CHANGE' MESSAGE        
381300*     IF NOT FOUND                                                        
381400*          MAKE SELECTION BASED ON PO, EXTERNAL REF, AND DATE             
381500*            IF FOUND AND ORIGINS DO NOT MATCH, SEND SCM AN               
381600*                ADD MESSAGE (MATCHING ORIGINS DEALT WITH IN              
381700*                             FIRST SELECTION)                            
381800*            IF NOT FOUND, SEND SCM AND ADD MESSAGE                       
381900*****************************************************************         
382000 6600-SCM-NAIL-DOWN-CHANGE.                                               
382100     MOVE TR025-ERD-PO-NBR           TO W-IMRCPO-PO-NBR.                  
382200     MOVE TR025-ERD-PO-RCVD-DELY-DTE TO PV-WORK-DATE.                     
382300     MOVE '-'                        TO PV-WORK-DASH1                     
382400                                        PV-WORK-DASH2.                    
382500     INITIALIZE TR405-MESSAGE-LAYOUT                                      
382600     PERFORM 7003-SCM-FETCH-ON-ORGN-TIMRCPO                               
382700                                                                          
382800     IF PS-RCPO-7003-ROW-FOUND                                            
382900         IF W-IMRCPO-PO-RCVD-DELY-DTE                                     
383000                 = PV-WORK-DATE-R                                         
383100             NEXT SENTENCE                                                
383200         ELSE                                                             
383300             INITIALIZE TR405-MESSAGE-LAYOUT                              
383400             MOVE 'C'                 TO TR405-ACTN-CDE                   
383500             PERFORM 6900-SCM-PO-RCVG-ADD-CHG                             
383600         END-IF                                                           
383700     ELSE                                                                 
383800         MOVE TR025-ERD-PO-NBR TO W-IMRCPO-PO-NBR                         
383900         PERFORM 7006-SCM-FETCH-ON-DATE-TIMRCPO                           
384000         IF PS-RCPO-7006-ROW-FOUND                                        
384100             IF W-IMRCPO-ORGN-SHPD-FR-CDE                                 
384200                     = TR025-ERD-ORGN-SHPD-FR-CDE                         
384300                NEXT SENTENCE                                             
384400             ELSE                                                         
384500                 INITIALIZE TR405-MESSAGE-LAYOUT                          
384600                 MOVE 'A'             TO TR405-ACTN-CDE                   
384700                 PERFORM 6900-SCM-PO-RCVG-ADD-CHG                         
384800             END-IF                                                       
384900         ELSE                                                             
385000           INITIALIZE TR405-MESSAGE-LAYOUT                                
385100           MOVE 'A'                   TO TR405-ACTN-CDE                   
385200           PERFORM 6900-SCM-PO-RCVG-ADD-CHG                               
385300         END-IF                                                           
385400     END-IF.                                                              
385500 EJECT                                                                    
385600*****************************************************************         
385700* INSERT A RECEIVING PO MESSAGE TO WORKTABLE TRTW_RCVG_CKPR               
385800* WHEN THE ADD EVENT OCCURS. THIS MESSAGE WILL EVENTUALLY BE FED          
385900* BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES.                        
386000*****************************************************************         
386100 6700-SCM-PO-RCVG-ADD.                                                    
386200     IF IMRCPO-PO-RCVD-DELY-TMST (1:4) > '0001'                           
386300         INITIALIZE TR405-MESSAGE-LAYOUT                                  
386400         MOVE 'A'                      TO TR405-ACTN-CDE                  
386500         MOVE 'RECEIVED'               TO TR405-EVENT-TYP                 
386600         MOVE TR025-LOG-PO-NBR         TO TR405-PO-NBR                    
386700         MOVE TR025-LOG-EXTL-REF-NBR   TO TR405-EXTL-REF-NBR              
386800         MOVE TR025-LOG-PO-RCVD-DELY-DTE                                  
386900                                   TO TR405-EVENT-DTE                     
387000         MOVE TR025-LOG-ORGN-SHPD-FR-CDE                                  
387100                                   TO TR405-ORGN-SHPD-FR-CDE              
387200         MOVE TR405-MESSAGE-LAYOUT TO TRT00042-CKPR-REC-1-TXT             
387300         PERFORM 7700-INSERT-SCM-MESSAGE.                                 
387400                                                                          
387500 EJECT                                                                    
387600*****************************************************************         
387700* INSERT A RECEIVING PO MESSAGE TO WORKTABLE TRTW_RCVG_CKPR               
387800* WHEN THE DEL EVENT OCCURS. THIS MESSAGE WILL EVENTUALLY                 
387900* BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES.                        
388000*****************************************************************         
388100 6800-SCM-PO-RCVG-DEL.                                                    
388200     INITIALIZE TR405-MESSAGE-LAYOUT                                      
388300     MOVE 'D'                          TO TR405-ACTN-CDE                  
388400     MOVE 'RECEIVED'                   TO TR405-EVENT-TYP                 
388500     MOVE TR025-LOG-PO-NBR             TO TR405-PO-NBR                    
388600     MOVE TR025-LOG-EXTL-REF-NBR       TO TR405-EXTL-REF-NBR              
388700     MOVE TR025-LOG-ORGN-SHPD-FR-CDE                                      
388800                               TO TR405-ORGN-SHPD-FR-CDE                  
388900     MOVE TR405-MESSAGE-LAYOUT TO TRT00042-CKPR-REC-1-TXT                 
389000     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
389100                                                                          
389200 EJECT                                                                    
389300*****************************************************************         
389400* INSERT A RECEIVING PO MESSAGE TO WORKTABLE TRTW_RCVG_CKPR               
389500* WHEN AN ADD OR CHANGE EVENT OCCURS. THIS MESSAGE WILL EVENTUALLY        
389600* BE FED INTO TRKUT405 FOR LOADING INTO MQ SERIES.                        
389700*****************************************************************         
389800 6900-SCM-PO-RCVG-ADD-CHG.                                                
389900     MOVE 'RECEIVED'               TO TR405-EVENT-TYP                     
390000     MOVE TR025-LOG-PO-NBR         TO TR405-PO-NBR                        
390100     MOVE TR025-LOG-EXTL-REF-NBR   TO TR405-EXTL-REF-NBR                  
390200     MOVE TR025-LOG-PO-RCVD-DELY-DTE                                      
390300                                   TO TR405-EVENT-DTE                     
390400     MOVE TR025-LOG-ORGN-SHPD-FR-CDE                                      
390500                                   TO TR405-ORGN-SHPD-FR-CDE              
390600     MOVE TR405-MESSAGE-LAYOUT TO TRT00042-CKPR-REC-1-TXT                 
390700     PERFORM 7700-INSERT-SCM-MESSAGE.                                     
390800                                                                          
390900 EJECT                                                                    
391000******************************************************************        
391100* SELECT A ROW FROM THE IMPORT RECEIVING PURCHASE ORDER TABLE             
391200* (TIMRCPO).                                                              
391300******************************************************************        
391400 7000-SELECT-TIMRCPO.                                                     
391500                                                                          
391600     PERFORM                                                              
391700         WITH TEST AFTER                                                  
391800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
391900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
392000                 SQLCODE = ZERO                     OR                    
392100                 SQLCODE = +100                                           
392200                                                                          
392300                                                                          
392400         EXEC SQL                                                         
392500             SELECT PO_NBR,                                               
392600                    PO_RCVD_SEQ_NBR,                                      
392700                    PO_RCVD_DELY_TMST,                                    
392800                    EXTL_REF_NBR,                                         
392900                    CONSLR_SCAC_ID,                                       
393000                    IMPRT_TRIP_ID,                                        
393100                    DPRTR_TMST,                                           
393200                    POE_DELY_TMST,                                        
393300                    CARR_SCAC_ID,                                         
393400                    FOB_CDE,                                              
393500                    IMPRT_VEH_NM,                                         
393600                    TRIP_TYP_CDE,                                         
393700                    DEST_POE_CDE,                                         
393800                    EST_LBD_NM,                                           
393900                    ORGN_SHPD_FR_CDE,                                     
394000                    C_O_PROD_CDE,                                         
394100                    PROD_FCTRY_NM,                                        
394200                    PO_CART_CNT,                                          
394300                    PO_CBMT_QTY,                                          
394400                    PO_WT_KGRM_QTY,                                       
394500                    PO_UNT_QTY,                                           
394600                    PO_EXC_APVL_CDE,                                      
394700                    PO_EXC_APVL_USR_ID,                                   
394800                    PO_EXC_APVL_TMST,                                     
394900                    PO_EXC_RSN_DESC,                                      
395000                    EST_LBD_TMST,                                         
395100                    VOY_CHG_RSN_DESC,                                     
395200                    DAT_SRC_ENT_ID,                                       
395300                    CRE_BY_USR_ID,                                        
395400                    CRE_TMST,                                             
395500                    LAST_UPD_BY_USR_ID,                                   
395600                    LAST_UPD_TMST                                         
395700              INTO :IMRCPO-PO-NBR,                                        
395800                   :IMRCPO-PO-RCVD-SEQ-NBR,                               
395900                   :IMRCPO-PO-RCVD-DELY-TMST,                             
396000                   :IMRCPO-EXTL-REF-NBR,                                  
396100                   :IMRCPO-CONSLR-SCAC-ID,                                
396200                   :IMRCPO-IMPRT-TRIP-ID,                                 
396300                   :IMRCPO-DPRTR-TMST,                                    
396400                   :IMRCPO-POE-DELY-TMST,                                 
396500                   :IMRCPO-CARR-SCAC-ID,                                  
396600                   :IMRCPO-FOB-CDE,                                       
396700                   :IMRCPO-IMPRT-VEH-NM,                                  
396800                   :IMRCPO-TRIP-TYP-CDE,                                  
396900                   :IMRCPO-DEST-POE-CDE,                                  
397000                   :IMRCPO-EST-LBD-NM,                                    
397100                   :IMRCPO-ORGN-SHPD-FR-CDE,                              
397200                   :IMRCPO-C-O-PROD-CDE,                                  
397300                   :IMRCPO-PROD-FCTRY-NM,                                 
397400                   :IMRCPO-PO-CART-CNT,                                   
397500                   :IMRCPO-PO-CBMT-QTY,                                   
397600                   :IMRCPO-PO-WT-KGRM-QTY,                                
397700                   :IMRCPO-PO-UNT-QTY,                                    
397800                   :IMRCPO-PO-EXC-APVL-CDE,                               
397900                   :IMRCPO-PO-EXC-APVL-USR-ID,                            
398000                   :IMRCPO-PO-EXC-APVL-TMST,                              
398100                   :IMRCPO-PO-EXC-RSN-DESC,                               
398200                   :IMRCPO-EST-LBD-TMST,                                  
398300                   :IMRCPO-VOY-CHG-RSN-DESC,                              
398400                   :IMRCPO-DAT-SRC-ENT-ID,                                
398500                   :IMRCPO-CRE-BY-USR-ID,                                 
398600                   :IMRCPO-CRE-TMST,                                      
398700                   :IMRCPO-LAST-UPD-BY-USR-ID,                            
398800                   :IMRCPO-LAST-UPD-TMST                                  
398900                                                                          
399000               FROM TIMRCPO                                               
399100              WHERE PO_NBR           = :IMRCPO-PO-NBR                     
399200                AND DATE(PO_RCVD_DELY_TMST) =                             
399300                                    :PV-REFORMAT-10BYTE-FIELD             
399400                AND EXTL_REF_NBR     = :TR025-ERD-EXTL-REF-NBR            
399500                AND ORGN_SHPD_FR_CDE = :TR025-ERD-ORGN-SHPD-FR-CDE        
399600         END-EXEC                                                         
399700                                                                          
399800         EVALUATE TRUE                                                    
399900             WHEN SQLCODE = ZERO                                          
400000                 SET PS-TIMRCPO-ROW-IS-THERE TO TRUE                      
400100                                                                          
400200             WHEN SQLCODE = +100                                          
400300                 SET PS-TIMRCPO-ROW-IS-THERE-NO TO TRUE                   
400400                                                                          
400500             WHEN SQLWARN0 NOT EQUAL SPACE                                
400600             WHEN SQLCODE NOT EQUAL ZERO                                  
400700                 DISPLAY '**************************************'         
400800                 DISPLAY '** ABEND                            **'         
400900                 DISPLAY '** PROGRAM = TRKUP225               **'         
401000                 DISPLAY '** PARAGRAPH = 7000-SELECT-TIMRCPO  **'         
401100                 DISPLAY '** SELECT TIMRCPO                   **'         
401200                 DISPLAY '** PO NUMBER    = '                             
401300                 DISPLAY            TR025-ERD-PO-NBR                      
401400                 DISPLAY '** HOLD PO NBR  = '                             
401500                 DISPLAY            PV-HOLD-TR025-PO-NBR                  
401600                 DISPLAY '** EXTL REF NBR = '                             
401700                 DISPLAY            TR025-ERD-EXTL-REF-NBR                
401800                 DISPLAY '** PO RCVD DELY DTE = '                         
401900                 DISPLAY            TR025-ERD-PO-RCVD-DELY-DTE            
402000                 DISPLAY '** PO RCVD DELY TM = '                          
402100                 DISPLAY            TR025-ERD-PO-RCVD-DELY-TM             
402200                 DISPLAY '** ORGN SHPD FR CDE = '                         
402300                 DISPLAY            TR025-ERD-ORGN-SHPD-FR-CDE            
402400                 DISPLAY '**************************************'         
402500                 PERFORM 9100-SQL-ABEND                                   
402600         END-EVALUATE                                                     
402700     END-PERFORM.                                                         
402800                                                                          
402900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
403000         (SQLCODE NOT = ZERO AND                                          
403100             SQLCODE NOT = +100)                                          
403200         DISPLAY '****************************************'               
403300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
403400         DISPLAY '** SELECT FROM TIMRCPO                **'               
403500         DISPLAY '** PARAGRAPH = 7000-SELECT-TIMRCPO    **'               
403600         DISPLAY '** PO NUMBER    = ' TR025-ERD-PO-NBR                    
403700         DISPLAY '** HOLD PO NBR  = ' PV-HOLD-TR025-PO-NBR                
403800         DISPLAY '** EXTL REF NBR = ' TR025-ERD-EXTL-REF-NBR              
403900         DISPLAY '** HOLD EXTL REF NBR ='                                 
404000                                 PV-HOLD-TR025-EXTL-REF-NBR               
404100         DISPLAY '** PO RCVD DELY DTE   ='                                
404200                                 TR025-ERD-PO-RCVD-DELY-DTE               
404300         DISPLAY '** HOLD PO RCVD DELY DTE ='                             
404400                                 PV-HOLD-ORGN-SHPD-FR-CDE                 
404500         DISPLAY '** ORGN SHPD FR CDE = '                                 
404600                                 TR025-ERD-ORGN-SHPD-FR-CDE               
404700         DISPLAY '** HOLD ORGN SHPD FROM CDE = '                          
404800                          PV-HOLD-ORGN-SHPD-FR-CDE                        
404900         DISPLAY '****************************************'               
405000         PERFORM 9100-SQL-ABEND                                           
405100     END-IF.                                                              
405200                                                                          
405300 EJECT                                                                    
405400                                                                          
405500*---------------------------------------------------------------*         
405600*   SELECT RECEIVING PO NUMBERS USING ONLY THE PO NUMBER,                 
405700*   EXTERNAL REFERENCE AND THE ORGN_SHPD_FR_CDE TO GET THE                
405800*   PO_RCVD_DELY_TMST.                                                    
405900*---------------------------------------------------------------*         
406000 7003-SCM-FETCH-ON-ORGN-TIMRCPO.                                          
406100     SET PS-RCPO-7003-ROW-FOUND-UNSURE  TO TRUE                           
406200     PERFORM 7850-SCM-OPEN-ORGN-CURSOR.                                   
406300                                                                          
406400** GET THE FIRST ROW ONLY.  (THE HIGHEST SEQUENCE NUMBER)                 
406500                                                                          
406600     EXEC SQL                                                             
406700        FETCH ORGN_CUR                                                    
406800         INTO :W-IMRCPO-PO-NBR                                            
406900             ,:W-IMRCPO-PO-RCVD-SEQ-NBR                                   
407000             ,:W-IMRCPO-EXTL-REF-NBR                                      
407100             ,:W-IMRCPO-PO-RCVD-DELY-TMST                                 
407200             ,:W-IMRCPO-ORGN-SHPD-FR-CDE                                  
407300     END-EXEC.                                                            
407400                                                                          
407500     EVALUATE TRUE                                                        
407600         WHEN SQLCODE = ZERO                                              
407700             SET PS-RCPO-7003-ROW-FOUND  TO TRUE                          
407800                                                                          
407900         WHEN SQLCODE = +100                                              
408000             SET PS-RCPO-7003-ROW-NOT-FOUND TO TRUE                       
408100                                                                          
408200         WHEN SQLWARN0 NOT EQUAL SPACE                                    
408300         WHEN SQLCODE NOT EQUAL ZERO                                      
408400             DISPLAY '***************************************'            
408500             DISPLAY '** ABEND                             **'            
408600             DISPLAY '** PROGRAM = TRKUP225                **'            
408700             DISPLAY '** PARAGRAPH = 7003-SCM-FETCH-ORGN-'                
408800                     'TIMRCPO  **'                                        
408900             DISPLAY '** SELECT TIMRCPO                    **'            
409000             DISPLAY '** PO NUMBER    = '                                 
409100             DISPLAY            TR025-LOG-PO-NBR                          
409200             DISPLAY '** HOLD PO NBR  = '                                 
409300             DISPLAY            PV-HOLD-TR025-PO-NBR                      
409400             DISPLAY '** EXTL REF NBR = '                                 
409500             DISPLAY            TR025-LOG-EXTL-REF-NBR                    
409600             DISPLAY '** PO RCVD DELY DTE = '                             
409700             DISPLAY            TR025-LOG-PO-RCVD-DELY-DTE                
409800             DISPLAY '** PO RCVD DELY TM = '                              
409900             DISPLAY            TR025-LOG-PO-RCVD-DELY-TM                 
410000             DISPLAY '** ORGN SHPD FR CDE = '                             
410100             DISPLAY            TR025-LOG-ORGN-SHPD-FR-CDE                
410200             DISPLAY '**************************************'             
410300             PERFORM 9100-SQL-ABEND                                       
410400     END-EVALUATE.                                                        
410500                                                                          
410600     PERFORM 7860-SCM-CLOS-ORGN-CURSOR.                                   
410700 EJECT                                                                    
410800                                                                          
410900*---------------------------------------------------------------*         
411000*   SELECT RECEIVING PO NUMBERS USING ONLY THE PO NUMBER,                 
411100*   EXTERNAL REFERENCE AND THE PO_RCVD_DELY-TMST TO GET THE               
411200*   ORGN_SHPD_FR_CDE.                                                     
411300*---------------------------------------------------------------*         
411400 7006-SCM-FETCH-ON-DATE-TIMRCPO.                                          
411500     SET PS-RCPO-7006-ROW-FOUND-UNSURE  TO TRUE                           
411600     PERFORM 7800-SCM-OPEN-TMST-CURSOR.                                   
411700                                                                          
411800** GET THE FIRST ROW ONLY.  (THE HIGHEST SEQUENCE NUMBER)                 
411900     EXEC SQL                                                             
412000        FETCH TMST_CUR                                                    
412100         INTO :W-IMRCPO-PO-NBR                                            
412200             ,:W-IMRCPO-PO-RCVD-SEQ-NBR                                   
412300             ,:W-IMRCPO-EXTL-REF-NBR                                      
412400             ,:W-IMRCPO-PO-RCVD-DELY-TMST                                 
412500             ,:W-IMRCPO-ORGN-SHPD-FR-CDE                                  
412600     END-EXEC.                                                            
412700                                                                          
412800     EVALUATE TRUE                                                        
412900         WHEN SQLCODE = ZERO                                              
413000             SET PS-RCPO-7006-ROW-FOUND  TO TRUE                          
413100                                                                          
413200         WHEN SQLCODE = +100                                              
413300             SET PS-RCPO-7006-ROW-NOT-FOUND  TO TRUE                      
413400                                                                          
413500         WHEN SQLWARN0 NOT EQUAL SPACE                                    
413600         WHEN SQLCODE NOT EQUAL ZERO                                      
413700             DISPLAY '***************************************'            
413800             DISPLAY '** ABEND                             **'            
413900             DISPLAY '** PROGRAM = TRKUP225                **'            
414000             DISPLAY '** PARAGRAPH = 7006-SCM-FETCH-DATE-'                
414100                     'TIMRCPO  **'                                        
414200             DISPLAY '** SELECT TIMRCPO                    **'            
414300             DISPLAY '** PO NUMBER    = '                                 
414400             DISPLAY            TR025-LOG-PO-NBR                          
414500             DISPLAY '** HOLD PO NBR  = '                                 
414600             DISPLAY            PV-HOLD-TR025-PO-NBR                      
414700             DISPLAY '** EXTL REF NBR = '                                 
414800             DISPLAY            TR025-LOG-EXTL-REF-NBR                    
414900             DISPLAY '** PO RCVD DELY DTE = '                             
415000             DISPLAY            TR025-LOG-PO-RCVD-DELY-DTE                
415100             DISPLAY '** PO RCVD DELY TM = '                              
415200             DISPLAY            TR025-LOG-PO-RCVD-DELY-TM                 
415300             DISPLAY '** ORGN SHPD FR CDE = '                             
415400             DISPLAY            TR025-LOG-ORGN-SHPD-FR-CDE                
415500             DISPLAY '**************************************'             
415600             PERFORM 9100-SQL-ABEND                                       
415700     END-EVALUATE.                                                        
415800                                                                          
415900     PERFORM 7810-SCM-CLOS-TMST-CURSOR.                                   
416000                                                                          
416100 EJECT                                                                    
416200                                                                          
416300******************************************************************        
416400* FIND THE MAX RCVD-SEQ-NBR SO IT CAN BE INCREMENTED WITH ADD TRAN        
416500******************************************************************        
416600 7010-SELECT-RCVD-SEQ-NBR-MAX.                                            
416700                                                                          
416800     PERFORM                                                              
416900         WITH TEST AFTER                                                  
417000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
417100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
417200                 SQLCODE = ZERO                     OR                    
417300                 SQLCODE = -305                     OR                    
417400                 SQLCODE = +100                                           
417500                                                                          
417600         EXEC SQL                                                         
417700          SELECT                                                          
417800               (CASE                                                      
417900                 WHEN MAX(COALESCE(B.PO_RCVD_SEQ_NBR,0)) >                
418000                      MAX(COALESCE(A.PO_RCVD_SEQ_NBR,0))                  
418100                  THEN  MAX(COALESCE(B.PO_RCVD_SEQ_NBR,0))                
418200                 WHEN MAX(COALESCE(A.PO_RCVD_SEQ_NBR,0)) >                
418300                      MAX(COALESCE(B.PO_RCVD_SEQ_NBR,0))                  
418400                  THEN  MAX(COALESCE(A.PO_RCVD_SEQ_NBR,0))                
418500                 WHEN MAX(COALESCE(A.PO_RCVD_SEQ_NBR,0)) =                
418600                      MAX(COALESCE(B.PO_RCVD_SEQ_NBR,0))                  
418700                  THEN  MAX(COALESCE(A.PO_RCVD_SEQ_NBR,0))                
418800                END)                                                      
418900            INTO :PV-RCVD-SEQ-NBR-MAX                                     
419000            FROM TIMRCPO B                                                
419100            FULL OUTER JOIN TAURCPO A                                     
419200              ON  A.PO_NBR         = B.PO_NBR                             
419300            WHERE A.PO_NBR         = :IMRCPO-PO-NBR                       
419400              OR  B.PO_NBR         = :IMRCPO-PO-NBR                       
419500         END-EXEC                                                         
419600                                                                          
419700         EVALUATE TRUE                                                    
419800             WHEN SQLCODE = ZERO                                          
419900                 ADD +1 TO PV-RCVD-SEQ-NBR-MAX                            
420000                                                                          
420100             WHEN SQLCODE  = +100                                         
420200             WHEN SQLCODE  = -305                                         
420300                 MOVE +1 TO PV-RCVD-SEQ-NBR-MAX                           
420400                                                                          
420500             WHEN SQLWARN0 NOT EQUAL SPACE                                
420600             WHEN SQLCODE NOT EQUAL ZERO                                  
420700                 DISPLAY '**************************************'         
420800                 DISPLAY '** ABEND                            **'         
420900                 DISPLAY '** PROGRAM = TRKUP225               **'         
421000                 DISPLAY '** PARAGRAPH = 7010-SELECT-RCVD-     **'        
421100                 DISPLAY '**                  SEQ-NBR-MAX     **'         
421200                 DISPLAY '** SELECT TIMRCPO                   **'         
421300                 DISPLAY '** PO NBR    = ' IMRCPO-PO-NBR                  
421400                 DISPLAY '** EXTL REF NBR = '                             
421500                 DISPLAY              IMRCPO-EXTL-REF-NBR                 
421600                 DISPLAY '**************************************'         
421700                 PERFORM 9100-SQL-ABEND                                   
421800         END-EVALUATE                                                     
421900     END-PERFORM.                                                         
422000                                                                          
422100     IF  PV-RETRY-COUNTER < PC-MAX-RETRIES AND                            
422200         (SQLCODE NOT = ZERO               OR                             
422300             SQLCODE NOT = -305            OR                             
422400             SQLCODE NOT = +100)                                          
422500         CONTINUE                                                         
422600     ELSE                                                                 
422700         DISPLAY '****************************************'               
422800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
422900         DISPLAY '** SELECT FROM TIMRCPO                **'               
423000         DISPLAY '** PARAGRAPH = 7010-SELECT-RCVD-SEQ-   **'              
423100         DISPLAY '**                  NBR-MAX           **'               
423200         DISPLAY '** PO NBR       = ' IMRCPO-PO-NBR                       
423300         DISPLAY '** EXTL REF NBR = ' IMRCPO-EXTL-REF-NBR                 
423400         DISPLAY '****************************************'               
423500         PERFORM 9100-SQL-ABEND                                           
423600     END-IF.                                                              
423700                                                                          
423800 EJECT                                                                    
423900                                                                          
424000******************************************************************        
424100* INSERT A ROW TO THE RECEIVING TABLE  (TIMRCPO).                *        
424200******************************************************************        
424300 7020-INSERT-TIMRCPO.                                                     
424400                                                                          
424500     PERFORM                                                              
424600         WITH TEST AFTER                                                  
424700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
424800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
424900                 SQLCODE = ZERO                     OR                    
425000                 SQLCODE = -803                                           
425100                                                                          
425200         EXEC SQL                                                         
425300             INSERT INTO TIMRCPO                                          
425400                   (PO_NBR,                                               
425500                    PO_RCVD_SEQ_NBR,                                      
425600                    PO_RCVD_DELY_TMST,                                    
425700                    EXTL_REF_NBR,                                         
425800                    ORGN_SHPD_FR_CDE,                                     
425900                    CONSLR_SCAC_ID,                                       
426000                    IMPRT_TRIP_ID,                                        
426100                    DPRTR_TMST,                                           
426200                    POE_DELY_TMST,                                        
426300                    CARR_SCAC_ID,                                         
426400                    FOB_CDE,                                              
426500                    IMPRT_VEH_NM,                                         
426600                    TRIP_TYP_CDE,                                         
426700                    DEST_POE_CDE,                                         
426800                    C_O_PROD_CDE,                                         
426900                    PROD_FCTRY_NM,                                        
427000                    PO_CART_CNT,                                          
427100                    PO_CBMT_QTY,                                          
427200                    PO_WT_KGRM_QTY,                                       
427300                    PO_UNT_QTY,                                           
427400                    PO_EXC_APVL_CDE,                                      
427500                    PO_EXC_APVL_USR_ID,                                   
427600                    PO_EXC_APVL_TMST,                                     
427700                    PO_EXC_RSN_DESC,                                      
427800                    EST_LBD_NM,                                           
427900                    EST_LBD_TMST,                                         
428000                    VOY_CHG_RSN_DESC,                                     
428100                    DAT_SRC_ENT_ID,                                       
428200                    CRE_BY_USR_ID,                                        
428300                    CRE_TMST,                                             
428400                    LAST_UPD_BY_USR_ID,                                   
428500                    LAST_UPD_TMST)                                        
428600           VALUES (:IMRCPO-PO-NBR,                                        
428700                   :IMRCPO-PO-RCVD-SEQ-NBR,                               
428800                   :IMRCPO-PO-RCVD-DELY-TMST,                             
428900                   :IMRCPO-EXTL-REF-NBR,                                  
429000                   :IMRCPO-ORGN-SHPD-FR-CDE,                              
429100                   :IMRCPO-CONSLR-SCAC-ID,                                
429200                   :IMRCPO-IMPRT-TRIP-ID,                                 
429300                   :IMRCPO-DPRTR-TMST,                                    
429400                   :IMRCPO-POE-DELY-TMST,                                 
429500                   :IMRCPO-CARR-SCAC-ID,                                  
429600                   :IMRCPO-FOB-CDE,                                       
429700                   :IMRCPO-IMPRT-VEH-NM,                                  
429800                   :IMRCPO-TRIP-TYP-CDE,                                  
429900                   :IMRCPO-DEST-POE-CDE,                                  
430000                   :IMRCPO-C-O-PROD-CDE,                                  
430100                   :IMRCPO-PROD-FCTRY-NM,                                 
430200                   :IMRCPO-PO-CART-CNT,                                   
430300                   :IMRCPO-PO-CBMT-QTY,                                   
430400                   :IMRCPO-PO-WT-KGRM-QTY,                                
430500                   :IMRCPO-PO-UNT-QTY,                                    
430600                   :IMRCPO-PO-EXC-APVL-CDE,                               
430700                   :IMRCPO-PO-EXC-APVL-USR-ID,                            
430800                   :IMRCPO-PO-EXC-APVL-TMST,                              
430900                   :IMRCPO-PO-EXC-RSN-DESC,                               
431000                   :IMRCPO-EST-LBD-NM,                                    
431100                   :IMRCPO-EST-LBD-TMST,                                  
431200                   :IMRCPO-VOY-CHG-RSN-DESC,                              
431300                   :IMRCPO-DAT-SRC-ENT-ID,                                
431400                   :IMRCPO-CRE-BY-USR-ID,                                 
431500                   :IMRCPO-CRE-TMST,                                      
431600                   :IMRCPO-LAST-UPD-BY-USR-ID,                            
431700                   :IMRCPO-LAST-UPD-TMST)                                 
431800                                                                          
431900         END-EXEC                                                         
432000                                                                          
432100         EVALUATE TRUE                                                    
432200             WHEN SQLCODE = ZERO                                          
432300                 ADD +1 TO PA-TOT-RCPO-INSERTS                            
432400                 ADD +1 TO PA-TOT-RECS-INSERTED                           
432500                 SET PS-TIMRCPO-ADDED       TO TRUE                       
432600                                                                          
432700             WHEN SQLCODE = -803                                          
432800                 SET PS-TIMRCPO-ADDED-NO    TO TRUE                       
432900             WHEN SQLWARN0 NOT EQUAL SPACE                                
433000             WHEN SQLCODE NOT EQUAL ZERO                                  
433100                 DISPLAY '**************************************'         
433200                 DISPLAY '** ABEND                            **'         
433300                 DISPLAY '** PROGRAM = TRKUP225               **'         
433400                 DISPLAY '** PARAGRAPH = 7020-INSERT-TIMRCPO  **'         
433500                 DISPLAY '** INSERT TIMRCPO                   **'         
433600                 DISPLAY '** PO NUMBER    = '                             
433700                 DISPLAY            TR025-ERD-PO-NBR                      
433800                 DISPLAY '** EXTL REF NBR = '                             
433900                 DISPLAY            TR025-ERD-EXTL-REF-NBR                
434000                 DISPLAY '** PO RCVD DELY DTE = '                         
434100                 DISPLAY            TR025-ERD-PO-RCVD-DELY-DTE            
434200                 DISPLAY '** ORGN SHPD FR CDE = '                         
434300                 DISPLAY            TR025-ERD-ORGN-SHPD-FR-CDE            
434400                 DISPLAY '**************************************'         
434500                 PERFORM 9100-SQL-ABEND                                   
434600         END-EVALUATE                                                     
434700     END-PERFORM.                                                         
434800                                                                          
434900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
435000         (SQLCODE NOT = ZERO AND                                          
435100             SQLCODE NOT = -803)                                          
435200         DISPLAY '****************************************'               
435300         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
435400         DISPLAY '** INSERT TO TIMRCPO                  **'               
435500         DISPLAY '** PARAGRAPH = 7020-INSERT-TIMRCPO    **'               
435600         DISPLAY '** PO NUMBER    = ' TR025-ERD-PO-NBR                    
435700         DISPLAY '** EXTL REF NBR = ' TR025-ERD-EXTL-REF-NBR              
435800         DISPLAY '****************************************'               
435900         PERFORM 9100-SQL-ABEND                                           
436000     END-IF.                                                              
436100                                                                          
436200 EJECT                                                                    
436300                                                                          
436400******************************************************************        
436500* SELECT COUNTRY CODE.                                           *        
436600******************************************************************        
436700*7035-SELECT-CNTRY-CDE.                                                   
436800*                                                                         
436900*    PERFORM                                                              
437000*        WITH TEST AFTER                                                  
437100*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
437200*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
437300*                SQLCODE = ZERO                     OR                    
437400*                SQLCODE = +100                                           
437500*                                                                         
437600*        EXEC SQL                                                         
437700*            SELECT A.CNTRY_CDE                                           
437800*             INTO :CNTRY-CNTRY-CDE                                       
437900*              FROM TCNTRY  A                                             
438000*             WHERE A.CNTRY_CDE   =  :TR025-LOG-C-O-PROD-CDE              
438100*               AND A.STAT_CDE    =   'A'                                 
438200*        END-EXEC                                                         
438300*                                                                         
438400*        EVALUATE TRUE                                                    
438500*            WHEN SQLCODE = ZERO                                          
438600*                SET PS-VALID-CNTRY-CDE    TO TRUE                        
438700*                                                                         
438800*            WHEN SQLCODE = +100                                          
438900*                SET PS-INVALID-CNTRY-CDE  TO TRUE                        
439000*                                                                         
439100*            WHEN SQLWARN0 NOT EQUAL SPACE                                
439200*            WHEN SQLCODE NOT EQUAL ZERO                                  
439300*                DISPLAY '**************************************'         
439400*                DISPLAY '** ABEND                            **'         
439500*                DISPLAY '** PROGRAM = TRKUP225               **'         
439600*                DISPLAY '** PARAGRAPH = 7335-SELECT-CNTRY-CDE**'         
439700*                DISPLAY '** SELECT TCNTRY CNTRY CDE          **'         
439800*                DISPLAY '** PO NBR       = ' TR025-LOG-PO-NBR            
439900*              DISPLAY '** EXTL REF NBR = ' TR025-LOG-EXTL-REF-NBR        
440000*              DISPLAY '** CNTRY CODE   = ' TR025-LOG-C-O-PROD-CDE        
440100*                DISPLAY '**************************************'         
440200*                PERFORM 9100-SQL-ABEND                                   
440300*        END-EVALUATE                                                     
440400*    END-PERFORM.                                                         
440500*                                                                         
440600*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
440700*        (SQLCODE NOT = ZERO    AND                                       
440800*            SQLCODE NOT = +100)                                          
440900*        DISPLAY '****************************************'               
441000*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
441100*        DISPLAY '** SELECT FROM TCNTRY                 **'               
441200*        DISPLAY '** PARAGRAPH = 7335-SELECT-CNTRY-CDE  **'               
441300*        DISPLAY '** PO-NBR       = ' TR025-LOG-PO-NBR                    
441400*        DISPLAY '** EXTL REF NBR = ' TR025-LOG-EXTL-REF-NBR              
441500*        DISPLAY '** CNTRY CODE   = ' TR025-LOG-C-O-PROD-CDE              
441600*        DISPLAY '****************************************'               
441700*        PERFORM 9100-SQL-ABEND                                           
441800*    END-IF.                                                              
441900*                                                                         
442000*EJECT                                                                    
442100*                                                                         
442200******************************************************************        
442300*   OPEN THE POE CODE AIR CURSOR                                 *        
442400******************************************************************        
442500*7040-OPEN-POE-CURSOR-AIR.                                                
442600*                                                                         
442700*    PERFORM                                                              
442800*        WITH TEST AFTER                                                  
442900*        VARYING PV-RETRY-COUNTER                                         
443000*        FROM 1 BY 1                                                      
443100*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
443200*                  OR (SQLCODE = ZERO))                                   
443300*                                                                         
443400*        EXEC SQL                                                         
443500*             OPEN POE-CSR-AIR                                            
443600*        END-EXEC                                                         
443700*                                                                         
443800*        EVALUATE TRUE                                                    
443900*            WHEN SQLCODE = ZERO                                          
444000*                CONTINUE                                                 
444100*            WHEN SQLWARN0 NOT EQUAL SPACE                                
444200*            WHEN SQLCODE NOT EQUAL ZERO                                  
444300*                DISPLAY '**************************************'         
444400*                DISPLAY '** ABEND                            **'         
444500*                DISPLAY '** PROGRAM = TRKUP225               **'         
444600*                DISPLAY '** PARAGRAPH = 7040-OPEN-POE-CSR-AIR *'         
444700*                DISPLAY '** OPEN POE CODE AIR CURSOR         **'         
444800*                DISPLAY '**************************************'         
444900*                PERFORM 9100-SQL-ABEND                                   
445000*        END-EVALUATE                                                     
445100*    END-PERFORM.                                                         
445200*                                                                         
445300*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
445400*        (SQLCODE NOT = ZERO)                                             
445500*        DISPLAY '****************************************'               
445600*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
445700*        DISPLAY '** OPEN POE CODE AIR CURSOR           **'               
445800*        DISPLAY '** PARAGRAPH = 7040-OPEN-POE-CURSOR-AIR*'               
445900*        DISPLAY '****************************************'               
446000*        PERFORM 9100-SQL-ABEND                                           
446100*    END-IF.                                                              
446200*                                                                         
446300*EJECT                                                                    
446400******************************************************************        
446500*   CLOSE THE POE CODE AIR CURSOR                                *        
446600******************************************************************        
446700*7042-CLOSE-POE-CURSOR-AIR.                                               
446800*                                                                         
446900*    PERFORM                                                              
447000*        WITH TEST AFTER                                                  
447100*        VARYING PV-RETRY-COUNTER                                         
447200*        FROM 1 BY 1                                                      
447300*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
447400*                  OR (SQLCODE = ZERO))                                   
447500*                                                                         
447600*        EXEC SQL                                                         
447700*            CLOSE POE-CSR-AIR                                            
447800*        END-EXEC                                                         
447900*                                                                         
448000*        EVALUATE TRUE                                                    
448100*            WHEN SQLCODE = ZERO                                          
448200*                CONTINUE                                                 
448300*            WHEN SQLWARN0 NOT EQUAL SPACE                                
448400*            WHEN SQLCODE NOT EQUAL ZERO                                  
448500*                DISPLAY '**************************************'         
448600*                DISPLAY '** ABEND                            **'         
448700*                DISPLAY '** PROGRAM = TRKUP225               **'         
448800*                DISPLAY '** PARAGRAPH = 7042-CLOSE-POE-CSR-AIR*'         
448900*                DISPLAY '** CLOSE POE CODE AIR CURSOR        **'         
449000*                DISPLAY '**************************************'         
449100*                PERFORM 9100-SQL-ABEND                                   
449200*        END-EVALUATE                                                     
449300*    END-PERFORM.                                                         
449400*                                                                         
449500*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
449600*        (SQLCODE NOT = ZERO)                                             
449700*        DISPLAY '****************************************'               
449800*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
449900*        DISPLAY '** CLOSE POE CODE AIR CURSOR          **'               
450000*        DISPLAY '** PARAGRAPH = 7042-CLOSE-POE-CSR-AIR **'               
450100*        DISPLAY '****************************************'               
450200*        PERFORM 9100-SQL-ABEND                                           
450300*    END-IF.                                                              
450400*                                                                         
450500*EJECT                                                                    
450600******************************************************************        
450700*    FETCH THE POE CODE AIR CURSOR                               *        
450800******************************************************************        
450900*7044-FETCH-POE-CURSOR-AIR.                                               
451000*                                                                         
451100*    EXEC SQL                                                             
451200*         FETCH POE-CSR-AIR                                               
451300*         INTO  :IMPOE-POE-CDE                                            
451400*    END-EXEC.                                                            
451500*                                                                         
451600*    EVALUATE TRUE                                                        
451700*        WHEN SQLCODE = ZERO                                              
451800*        WHEN SQLCODE = -811                                              
451900*            SET PS-VALID-POE-CDE    TO TRUE                              
452000*                                                                         
452100*        WHEN SQLCODE = +100                                              
452200*            SET PS-INVALID-POE-CDE  TO TRUE                              
452300*                                                                         
452400*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
452500*        WHEN SQLCODE NOT EQUAL ZERO                                      
452600*            DISPLAY '**************************************'             
452700*            DISPLAY '** ABEND                            **'             
452800*            DISPLAY '** PROGRAM = TRKUP225               **'             
452900*            DISPLAY '** PARAGRAPH = 7044-FETCH-POE-CSR-AIR*'             
453000*            DISPLAY '** FETCH TIMPOE POE CODE AIR        **'             
453100*            DISPLAY '** POE CDE AIR = ' TR025-ERD-DEST-POE-CDE           
453200*            DISPLAY '**************************************'             
453300*            PERFORM 9100-SQL-ABEND                                       
453400*    END-EVALUATE.                                                        
453500*                                                                         
453600*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
453700*        (SQLCODE NOT = ZERO    AND                                       
453800*         SQLCODE NOT = -811    AND                                       
453900*         SQLCODE NOT = +100)                                             
454000*        DISPLAY '****************************************'               
454100*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
454200*        DISPLAY '** FETCH FROM TIMPOE                  **'               
454300*        DISPLAY '** PARAGRAPH = 7044-FETCH-POE-CSR-AIR **'               
454400*        DISPLAY '** POE CDE AIR = ' TR025-ERD-DEST-POE-CDE               
454500*        DISPLAY '****************************************'               
454600*        PERFORM 9100-SQL-ABEND                                           
454700*    END-IF.                                                              
454800*                                                                         
454900*EJECT                                                                    
455000******************************************************************        
455100*   OPEN THE POE CODE OCEAN CURSOR                               *        
455200******************************************************************        
455300*7050-OPEN-POE-CURSOR-OCEAN.                                              
455400*                                                                         
455500*    PERFORM                                                              
455600*        WITH TEST AFTER                                                  
455700*        VARYING PV-RETRY-COUNTER                                         
455800*        FROM 1 BY 1                                                      
455900*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
456000*                  OR (SQLCODE = ZERO))                                   
456100*                                                                         
456200*        EXEC SQL                                                         
456300*             OPEN POE-CSR-OCEAN                                          
456400*        END-EXEC                                                         
456500*                                                                         
456600*        EVALUATE TRUE                                                    
456700*            WHEN SQLCODE = ZERO                                          
456800*                CONTINUE                                                 
456900*            WHEN SQLWARN0 NOT EQUAL SPACE                                
457000*            WHEN SQLCODE NOT EQUAL ZERO                                  
457100*                DISPLAY '**************************************'         
457200*                DISPLAY '** ABEND                            **'         
457300*                DISPLAY '** PROGRAM = TRKUP225               **'         
457400*                DISPLAY '** PARAGRAPH = 7050-OPEN-POE-CSR-OCN**'         
457500*                DISPLAY '** OPEN POE CODE OCEAN CURSOR       **'         
457600*                DISPLAY '**************************************'         
457700*                PERFORM 9100-SQL-ABEND                                   
457800*        END-EVALUATE                                                     
457900*    END-PERFORM.                                                         
458000*                                                                         
458100*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
458200*        (SQLCODE NOT = ZERO)                                             
458300*        DISPLAY '****************************************'               
458400*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
458500*        DISPLAY '** OPEN POE CODE OCEAN CURSOR         **'               
458600*        DISPLAY '** PARAGRAPH = 7050-OPEN-POE-CURSOR-OCN*'               
458700*        DISPLAY '****************************************'               
458800*        PERFORM 9100-SQL-ABEND                                           
458900*    END-IF.                                                              
459000*                                                                         
459100*EJECT                                                                    
459200******************************************************************        
459300*   CLOSE THE POE CODE OCEAN CURSOR                              *        
459400******************************************************************        
459500*7052-CLOSE-POE-CURSOR-OCEAN.                                             
459600*                                                                         
459700*    PERFORM                                                              
459800*        WITH TEST AFTER                                                  
459900*        VARYING PV-RETRY-COUNTER                                         
460000*        FROM 1 BY 1                                                      
460100*        UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
460200*                  OR (SQLCODE = ZERO))                                   
460300*                                                                         
460400*        EXEC SQL                                                         
460500*            CLOSE POE-CSR-OCEAN                                          
460600*        END-EXEC                                                         
460700*                                                                         
460800*        EVALUATE TRUE                                                    
460900*            WHEN SQLCODE = ZERO                                          
461000*                CONTINUE                                                 
461100*            WHEN SQLWARN0 NOT EQUAL SPACE                                
461200*            WHEN SQLCODE NOT EQUAL ZERO                                  
461300*                DISPLAY '**************************************'         
461400*                DISPLAY '** ABEND                            **'         
461500*                DISPLAY '** PROGRAM = TRKUP225               **'         
461600*                DISPLAY '** PARAGRAPH = 7052-CLOSE-POE-CSR-OCN*'         
461700*                DISPLAY '** CLOSE POE CODE OCEAN CURSOR      **'         
461800*                DISPLAY '**************************************'         
461900*                PERFORM 9100-SQL-ABEND                                   
462000*        END-EVALUATE                                                     
462100*    END-PERFORM.                                                         
462200*                                                                         
462300*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
462400*        (SQLCODE NOT = ZERO)                                             
462500*        DISPLAY '****************************************'               
462600*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
462700*        DISPLAY '** CLOSE POE CODE OCEAN CURSOR        **'               
462800*        DISPLAY '** PARAGRAPH = 7052-CLOSE-POE-CSR-OCN **'               
462900*        DISPLAY '****************************************'               
463000*        PERFORM 9100-SQL-ABEND                                           
463100*    END-IF.                                                              
463200*                                                                         
463300*EJECT                                                                    
463400******************************************************************        
463500*    FETCH THE POE CODE OCEAN CURSOR                             *        
463600******************************************************************        
463700*7054-FETCH-POE-CURSOR-OCEAN.                                             
463800*                                                                         
463900*    EXEC SQL                                                             
464000*         FETCH POE-CSR-OCEAN                                             
464100*         INTO  :IMPOE-POE-CDE                                            
464200*    END-EXEC.                                                            
464300*                                                                         
464400*    EVALUATE TRUE                                                        
464500*        WHEN SQLCODE = ZERO                                              
464600*        WHEN SQLCODE = -811                                              
464700*            SET PS-VALID-POE-CDE    TO TRUE                              
464800*                                                                         
464900*        WHEN SQLCODE = +100                                              
465000*            SET PS-INVALID-POE-CDE  TO TRUE                              
465100*                                                                         
465200*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
465300*        WHEN SQLCODE NOT EQUAL ZERO                                      
465400*            DISPLAY '**************************************'             
465500*            DISPLAY '** ABEND                            **'             
465600*            DISPLAY '** PROGRAM = TRKUP225               **'             
465700*            DISPLAY '** PARAGRAPH = 7054-FETCH-POE-CSR-OCN*'             
465800*            DISPLAY '** FETCH TIMPOE POE CODE OCEAN      **'             
465900*            DISPLAY '** POE CDE OCEAN = ' TR025-ERD-DEST-POE-CDE         
466000*            DISPLAY '**************************************'             
466100*            PERFORM 9100-SQL-ABEND                                       
466200*    END-EVALUATE.                                                        
466300*                                                                         
466400*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
466500*        (SQLCODE NOT = ZERO    AND                                       
466600*         SQLCODE NOT = -811    AND                                       
466700*         SQLCODE NOT = +100)                                             
466800*        DISPLAY '****************************************'               
466900*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
467000*        DISPLAY '** FETCH FROM TIMPOE                  **'               
467100*        DISPLAY '** PARAGRAPH = 7054-FETCH-POE-CSR-OCN **'               
467200*        DISPLAY '** POE CDE OCEAN = ' TR025-ERD-DEST-POE-CDE             
467300*        DISPLAY '****************************************'               
467400*        PERFORM 9100-SQL-ABEND                                           
467500*    END-IF.                                                              
467600*                                                                         
467700*EJECT                                                                    
467800******************************************************************        
467900* SELECT FOB CODE FOR AIR.                                       *        
468000******************************************************************        
468100 7055-SELECT-FOB-AIR.                                                     
468200                                                                          
468300     PERFORM                                                              
468400         WITH TEST AFTER                                                  
468500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
468600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
468700                 SQLCODE = ZERO                     OR                    
468800                 SQLCODE = -811                     OR                    
468900                 SQLCODE = +100                                           
469000                                                                          
469100         EXEC SQL                                                         
469200             SELECT A.FOB_CDE                                             
469300              INTO :IMFOB-FOB-CDE                                         
469400               FROM TIMFOB  A                                             
469500              WHERE A.FOB_CDE     =   :TR025-ERD-FOB-CDE                  
469600                AND A.STAT_CDE    =   'A'                                 
469700         END-EXEC                                                         
469800                                                                          
469900         EVALUATE TRUE                                                    
470000             WHEN SQLCODE = ZERO                                          
470100             WHEN SQLCODE = -811                                          
470200                 SET PS-VALID-FOB-CDE    TO TRUE                          
470300                                                                          
470400             WHEN SQLCODE = +100                                          
470500                 SET PS-INVALID-FOB-CDE  TO TRUE                          
470600                                                                          
470700             WHEN SQLWARN0 NOT EQUAL SPACE                                
470800             WHEN SQLCODE NOT EQUAL ZERO                                  
470900                 DISPLAY '**************************************'         
471000                 DISPLAY '** ABEND                            **'         
471100                 DISPLAY '** PROGRAM = TRKUP225               **'         
471200                 DISPLAY '** PARAGRAPH = 7055-SELECT-FOB-AIR  **'         
471300                 DISPLAY '** SELECT TIMFOB FOB CODE           **'         
471400                 DISPLAY '** PO NBR       = ' TR025-ERD-PO-NBR            
471500              DISPLAY '** EXTL REF NBR = ' TR025-ERD-EXTL-REF-NBR         
471600                 DISPLAY '** FOB CODE     = ' TR025-ERD-FOB-CDE           
471700                 DISPLAY '**************************************'         
471800                 PERFORM 9100-SQL-ABEND                                   
471900         END-EVALUATE                                                     
472000     END-PERFORM.                                                         
472100                                                                          
472200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
472300         (SQLCODE NOT = ZERO    AND                                       
472400          SQLCODE NOT = -811    AND                                       
472500          SQLCODE NOT = +100)                                             
472600         DISPLAY '****************************************'               
472700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
472800         DISPLAY '** SELECT FROM TIMFOB                 **'               
472900         DISPLAY '** PARAGRAPH = 7055-SELECT-FOB-AIR    **'               
473000         DISPLAY '** PO NBR       = ' TR025-ERD-PO-NBR                    
473100         DISPLAY '** EXTL REF NBR = ' TR025-ERD-EXTL-REF-NBR              
473200         DISPLAY '** FOB CODE     = ' TR025-ERD-FOB-CDE                   
473300         DISPLAY '****************************************'               
473400         PERFORM 9100-SQL-ABEND                                           
473500     END-IF.                                                              
473600                                                                          
473700 EJECT                                                                    
473800******************************************************************        
473900* SELECT FOB CODE FOR OCEAN.                                     *        
474000******************************************************************        
474100 7060-SELECT-FOB-OCEAN.                                                   
474200                                                                          
474300     PERFORM                                                              
474400         WITH TEST AFTER                                                  
474500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
474600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
474700                 SQLCODE = ZERO                     OR                    
474800                 SQLCODE = -811                     OR                    
474900                 SQLCODE = +100                                           
475000                                                                          
475100         EXEC SQL                                                         
475200             SELECT A.FOB_CDE                                             
475300              INTO :IMFOB-FOB-CDE                                         
475400               FROM TIMFOB  A                                             
475500              WHERE A.FOB_STD_EDI_CDE  = :TR025-ERD-FOB-CDE               
475600                AND A.STAT_CDE         = 'A'                              
475700         END-EXEC                                                         
475800                                                                          
475900         EVALUATE TRUE                                                    
476000             WHEN SQLCODE = ZERO                                          
476100             WHEN SQLCODE = -811                                          
476200                 SET PS-VALID-FOB-CDE    TO TRUE                          
476300                                                                          
476400             WHEN SQLCODE = +100                                          
476500                 SET PS-INVALID-FOB-CDE  TO TRUE                          
476600                                                                          
476700             WHEN SQLWARN0 NOT EQUAL SPACE                                
476800             WHEN SQLCODE NOT EQUAL ZERO                                  
476900                 DISPLAY '**************************************'         
477000                 DISPLAY '** ABEND                            **'         
477100                 DISPLAY '** PROGRAM = TRKUP225               **'         
477200                 DISPLAY '** PARAGRAPH = 7060-SELECT-FOB-OCEAN**'         
477300                 DISPLAY '** SELECT TIMFOB FOB CODE           **'         
477400                 DISPLAY '** PO NBR       = ' TR025-ERD-PO-NBR            
477500               DISPLAY '** EXTL REF NBR = ' TR025-ERD-EXTL-REF-NBR        
477600                 DISPLAY '** FOB CODE     = ' TR025-ERD-FOB-CDE           
477700                 DISPLAY '**************************************'         
477800                 PERFORM 9100-SQL-ABEND                                   
477900         END-EVALUATE                                                     
478000     END-PERFORM.                                                         
478100                                                                          
478200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
478300         (SQLCODE NOT = ZERO    AND                                       
478400          SQLCODE NOT = -811 AND                                          
478500          SQLCODE NOT = +100)                                             
478600         DISPLAY '****************************************'               
478700         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
478800         DISPLAY '** SELECT FROM TIMFOB                 **'               
478900         DISPLAY '** PARAGRAPH = 7060-SELECT-FOB-OCEAN  **'               
479000         DISPLAY '** PO NBR       = ' TR025-ERD-PO-NBR                    
479100         DISPLAY '** EXTL REF NBR = ' TR025-ERD-EXTL-REF-NBR              
479200         DISPLAY '** FOB CODE     = ' TR025-ERD-FOB-CDE                   
479300         DISPLAY '****************************************'               
479400         PERFORM 9100-SQL-ABEND                                           
479500     END-IF.                                                              
479600                                                                          
479700 EJECT                                                                    
479800******************************************************************        
479900* SELECT A ROW FROM THE RECEIVING VENDOR STYLE TABLE  (TIMRCVS). *        
480000******************************************************************        
480100*7100-SELECT-TIMRCVS.                                                     
480200                                                                          
480300*    PERFORM                                                              
480400*        WITH TEST AFTER                                                  
480500*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
480600*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
480700*                SQLCODE = ZERO                     OR                    
480800*                SQLCODE = +100                                           
480900*                                                                         
481000*        EXEC SQL                                                         
481100*            SELECT PO_NBR,                                               
481200*                   PO_RCVD_SEQ_NBR,                                      
481300*                   VS_NBR,                                               
481400*                   HTS_ID,                                               
481500*                   VS_CART_CNT,                                          
481600*                   VS_CBMT_QTY,                                          
481700*                   VS_WT_KGRM_QTY,                                       
481800*                   VS_UNT_QTY,                                           
481900*                   QTA_CTG_IND,                                          
482000*                   CRE_BY_USR_ID,                                        
482100*                   CRE_TMST,                                             
482200*                   LAST_UPD_BY_USR_ID,                                   
482300*                   LAST_UPD_TMST                                         
482400*             INTO :IMRCVS-PO-NBR,                                        
482500*                  :IMRCVS-PO-RCVD-SEQ-NBR,                               
482600*                  :IMRCVS-VS-NBR,                                        
482700*                  :IMRCVS-HTS-ID,                                        
482800*                  :IMRCVS-VS-CART-CNT,                                   
482900*                  :IMRCVS-VS-CBMT-QTY,                                   
483000*                  :IMRCVS-VS-WT-KGRM-QTY,                                
483100*                  :IMRCVS-VS-UNT-QTY,                                    
483200*                  :IMRCVS-QTA-CTG-IND,                                   
483300*                  :IMRCVS-CRE-BY-USR-ID,                                 
483400*                  :IMRCVS-CRE-TMST,                                      
483500*                  :IMRCVS-LAST-UPD-BY-USR-ID,                            
483600*                  :IMRCVS-LAST-UPD-TMST                                  
483700*                                                                         
483800*              FROM TIMRCVS                                               
483900*             WHERE PO_NBR           = :IMRCVS-PO-NBR                     
484000*               AND VS_NBR           = :TR025-LOGVS-VS-NBR                
484100*               AND PO_RCVD_SEQ_NBR  = :IMRCPO-PO-RCVD-SEQ-NBR            
484200*        END-EXEC                                                         
484300*                                                                         
484400*        EVALUATE TRUE                                                    
484500*            WHEN SQLCODE = ZERO                                          
484600*                SET PS-TIMRCVS-ROW-IS-THERE TO TRUE                      
484700*                                                                         
484800*            WHEN SQLCODE = +100                                          
484900*                SET PS-TIMRCVS-ROW-IS-THERE-NO TO TRUE                   
485000*                                                                         
485100*            WHEN SQLWARN0 NOT EQUAL SPACE                                
485200*            WHEN SQLCODE NOT EQUAL ZERO                                  
485300*                DISPLAY '**************************************'         
485400*                DISPLAY '** ABEND                            **'         
485500*                DISPLAY '** PROGRAM = TRKUP225               **'         
485600*                DISPLAY '** PARAGRAPH = 7100-SELECT-TIMRCVS  **'         
485700*                DISPLAY '** SELECT TIMRCVS                   **'         
485800*                DISPLAY '** PO NUMBER    = '                             
485900*                DISPLAY            TR025-LOGVS-PO-NBR                    
486000*                DISPLAY '** VENDOR STYLE = '                             
486100*                DISPLAY            TR025-LOGVS-VS-NBR                    
486200*                DISPLAY '** EXTL REF NBR = '                             
486300*                DISPLAY            TR025-LOGVS-EXTL-REF-NBR              
486400*                DISPLAY '**************************************'         
486500*                PERFORM 9100-SQL-ABEND                                   
486600*        END-EVALUATE                                                     
486700*    END-PERFORM.                                                         
486800                                                                          
486900*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
487000*        (SQLCODE NOT = ZERO AND                                          
487100*            SQLCODE NOT = +100)                                          
487200*        DISPLAY '****************************************'               
487300*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
487400*        DISPLAY '** SELECT FROM TIMRCVS                **'               
487500*        DISPLAY '** PARAGRAPH = 7100-SELECT-TIMRCVS    **'               
487600*        DISPLAY '** PO NUMBER    = ' TR025-LOGVS-PO-NBR                  
487700*        DISPLAY '** VENDOR STYLE = ' TR025-LOGVS-VS-NBR                  
487800*        DISPLAY '** EXTL REF NBR = ' TR025-LOGVS-EXTL-REF-NBR            
487900*        DISPLAY '****************************************'               
488000*        PERFORM 9100-SQL-ABEND                                           
488100*    END-IF.                                                              
488200                                                                          
488300 EJECT                                                                    
488400                                                                          
488500******************************************************************        
488600* SELECT A ROW FROM THE RECEIVING VENDOR STYLE TABLE  (TIMRCVS). *        
488700******************************************************************        
488800*7105-SELECT-TIMRCVS-CHG.                                                 
488900                                                                          
489000*    PERFORM                                                              
489100*        WITH TEST AFTER                                                  
489200*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
489300*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
489400*                SQLCODE = ZERO                     OR                    
489500*                SQLCODE = +100                                           
489600*                                                                         
489700*        EXEC SQL                                                         
489800*            SELECT PO_NBR,                                               
489900*                   PO_RCVD_SEQ_NBR,                                      
490000*                   VS_NBR,                                               
490100*                   HTS_ID,                                               
490200*                   VS_CART_CNT,                                          
490300*                   VS_CBMT_QTY,                                          
490400*                   VS_WT_KGRM_QTY,                                       
490500*                   VS_UNT_QTY,                                           
490600*                   QTA_CTG_IND,                                          
490700*                   CRE_BY_USR_ID,                                        
490800*                   CRE_TMST,                                             
490900*                   LAST_UPD_BY_USR_ID,                                   
491000*                   LAST_UPD_TMST                                         
491100*             INTO :IMRCVS-PO-NBR,                                        
491200*                  :IMRCVS-PO-RCVD-SEQ-NBR,                               
491300*                  :IMRCVS-VS-NBR,                                        
491400*                  :IMRCVS-HTS-ID,                                        
491500*                  :IMRCVS-VS-CART-CNT,                                   
491600*                  :IMRCVS-VS-CBMT-QTY,                                   
491700*                  :IMRCVS-VS-WT-KGRM-QTY,                                
491800*                  :IMRCVS-VS-UNT-QTY,                                    
491900*                  :IMRCVS-QTA-CTG-IND,                                   
492000*                  :IMRCVS-CRE-BY-USR-ID,                                 
492100*                  :IMRCVS-CRE-TMST,                                      
492200*                  :IMRCVS-LAST-UPD-BY-USR-ID,                            
492300*                  :IMRCVS-LAST-UPD-TMST                                  
492400*                                                                         
492500*              FROM TIMRCVS                                               
492600*             WHERE PO_NBR           = :IMRCPO-PO-NBR                     
492700*               AND PO_RCVD_SEQ_NBR  = :IMRCPO-PO-RCVD-SEQ-NBR            
492800*               AND VS_NBR           = :IMRCVS-VS-NBR                     
492900*        END-EXEC                                                         
493000*                                                                         
493100*        EVALUATE TRUE                                                    
493200*            WHEN SQLCODE = ZERO                                          
493300*                CONTINUE                                                 
493400*                                                                         
493500*            WHEN SQLCODE = +100                                          
493600*                PERFORM 7107-TIMRCVS-SELECT-ERROR                        
493700*                                                                         
493800*            WHEN SQLWARN0 NOT EQUAL SPACE                                
493900*            WHEN SQLCODE NOT EQUAL ZERO                                  
494000*                DISPLAY '**************************************'         
494100*                DISPLAY '** ABEND                            **'         
494200*                DISPLAY '** PROGRAM = TRKUP225               **'         
494300*                DISPLAY '** PARAGRAPH = 7105-SELECT-TIMRCVS-CHG'         
494400*                DISPLAY '** SELECT TIMRCVS                   **'         
494500*                DISPLAY '** PO NUMBER   = ' IMRCPO-PO-NBR                
494600*              DISPLAY '** RCVD SEQ NBR= ' IMRCPO-PO-RCVD-SEQ-NBR         
494700*                DISPLAY '** VENDOR STYLE = ' IMRCVS-VS-NBR               
494800*                DISPLAY '**************************************'         
494900*                PERFORM 9100-SQL-ABEND                                   
495000*        END-EVALUATE                                                     
495100*    END-PERFORM.                                                         
495200*                                                                         
495300*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
495400*        (SQLCODE NOT = ZERO AND                                          
495500*            SQLCODE NOT = +100)                                          
495600*        DISPLAY '****************************************'               
495700*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
495800*        DISPLAY '** SELECT FROM TIMRCVS                **'               
495900*        DISPLAY '** PARAGRAPH = 7105-SELECT-TIMRCVS-CHG**'               
496000*        DISPLAY '** PO NUMBER    = ' IMRCPO-PO-NBR                       
496100*        DISPLAY '** RCVD SEQ NBR  = ' IMRCPO-PO-RCVD-SEQ-NBR             
496200*        DISPLAY '** VENDOR STYLE = ' IMRCVS-VS-NBR                       
496300*        DISPLAY '****************************************'               
496400*        PERFORM 9100-SQL-ABEND                                           
496500*    END-IF.                                                              
496600                                                                          
496700 EJECT                                                                    
496800                                                                          
496900******************************************************************        
497000* INSERT A ROW TO THE RECEIVING VENDOR STYLE TABLE  (TIMRCVS).  *         
497100******************************************************************        
497200*7107-TIMRCVS-SELECT-ERROR.                                               
497300                                                                          
497400*    INITIALIZE TR221-RECORD.                                             
497500*    INITIALIZE TR221-REC-TYP-LOGVS.                                      
497600*                                                                         
497700*    MOVE PC-E                  TO TR221-RPT-TYP.                         
497800*    MOVE 'VS NUMBER'           TO TR221-DATA-IN-ERROR.                   
497900*    MOVE PV-UPC-CURSOR-VS-NBR  TO TR221-DATA-VALUE                       
498000*                                  TR221-LOGVS-VS-NBR.                    
498100*    MOVE PC-ERROR              TO TR221-ERROR-TYPE.                      
498200*    MOVE 'CONTACT PROGRAMMING - SEE PARAGRAPH 2390' TO                   
498300*          TR221-ERROR-MSG.                                               
498400*    MOVE PC-E                  TO TR221-TRN-TYP.                         
498500*    MOVE PC-LOGVS              TO TR221-REC-TYP-LOGVS-CDE.               
498600*    MOVE PC-21                 TO TR221-LOGVS-SEQ-NBR.                   
498700*    MOVE IMRCPO-PO-NBR         TO TR221-PO-NBR.                          
498800*    MOVE IMRCPO-EXTL-REF-NBR   TO TR221-EXTL-REF-NBR.                    
498900*    MOVE IMRCPO-PO-RCVD-DELY-TMST (1:4) TO                               
499000*          TR221-PO-RCVD-DELY-DTE (1:4).                                  
499100*    MOVE IMRCPO-PO-RCVD-DELY-TMST (6:2) TO                               
499200*          TR221-PO-RCVD-DELY-DTE (5:2).                                  
499300*    MOVE IMRCPO-PO-RCVD-DELY-TMST (9:2) TO                               
499400*          TR221-PO-RCVD-DELY-DTE (7:2).                                  
499500*    MOVE IMRCPO-PO-RCVD-DELY-TMST (12:2) TO                              
499600*          TR221-PO-RCVD-DELY-TM (1:2).                                   
499700*    MOVE IMRCPO-PO-RCVD-DELY-TMST (15:2) TO                              
499800*          TR221-PO-RCVD-DELY-TM (3:2).                                   
499900*    MOVE IMRCPO-ORGN-SHPD-FR-CDE        TO                               
500000*          TR221-ORGN-SHPD-FR-CDE.                                        
500100*                                                                         
500200*    COMPUTE TR221-PROCESS-SEQ-NBR =                                      
500300*             (TR025-ERD-PROCESS-SEQ-NBR - 1).                            
500400*    MOVE PV-HOLD-DAT-SRC-ENT-ID   TO TR221-DAT-SRC-ENT-ID.               
500500*                                                                         
500600*    PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
500700                                                                          
500800******************************************************************        
500900* INSERT A ROW TO THE RECEIVING VENDOR STYLE TABLE  (TIMRCVS).   *        
501000******************************************************************        
501100*7110-INSERT-TIMRCVS.                                                     
501200                                                                          
501300*    PERFORM                                                              
501400*        WITH TEST AFTER                                                  
501500*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
501600*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
501700*                SQLCODE = ZERO                     OR                    
501800*                SQLCODE = -803                                           
501900*                                                                         
502000*        EXEC SQL                                                         
502100*            INSERT INTO TIMRCVS                                          
502200*                  (PO_NBR,                                               
502300*                   PO_RCVD_SEQ_NBR,                                      
502400*                   VS_NBR,                                               
502500*                   HTS_ID,                                               
502600*                   VS_CART_CNT,                                          
502700*                   VS_CBMT_QTY,                                          
502800*                   VS_WT_KGRM_QTY,                                       
502900*                   VS_UNT_QTY,                                           
503000*                   QTA_CTG_IND,                                          
503100*                   CRE_BY_USR_ID,                                        
503200*                   CRE_TMST,                                             
503300*                   LAST_UPD_BY_USR_ID,                                   
503400*                   LAST_UPD_TMST)                                        
503500*           VALUES                                                        
503600*                 (:IMRCVS-PO-NBR,                                        
503700*                  :IMRCVS-PO-RCVD-SEQ-NBR,                               
503800*                  :IMRCVS-VS-NBR,                                        
503900*                  :IMRCVS-HTS-ID,                                        
504000*                  :IMRCVS-VS-CART-CNT,                                   
504100*                  :IMRCVS-VS-CBMT-QTY,                                   
504200*                  :IMRCVS-VS-WT-KGRM-QTY,                                
504300*                  :IMRCVS-VS-UNT-QTY,                                    
504400*                  :IMRCVS-QTA-CTG-IND,                                   
504500*                  :IMRCVS-CRE-BY-USR-ID,                                 
504600*                  :IMRCVS-CRE-TMST,                                      
504700*                  :IMRCVS-LAST-UPD-BY-USR-ID,                            
504800*                  :IMRCVS-LAST-UPD-TMST)                                 
504900*                                                                         
505000*        END-EXEC                                                         
505100*                                                                         
505200*        EVALUATE TRUE                                                    
505300*            WHEN SQLCODE = ZERO                                          
505400*                MOVE PC-D            TO TR221-RPT-TYP                    
505500*                ADD +1               TO PA-TOT-RCVS-INSERTS              
505600*                ADD +1               TO PA-TOT-RECS-INSERTED             
505700*                SET PS-TIMRCVS-ADDED       TO TRUE                       
505800*                                                                         
505900*            WHEN SQLCODE = -803                                          
506000*                SET PS-TIMRCVS-ADDED-NO    TO TRUE                       
506100*                                                                         
506200*            WHEN SQLWARN0 NOT EQUAL SPACE                                
506300*            WHEN SQLCODE NOT EQUAL ZERO                                  
506400*                DISPLAY '**************************************'         
506500*                DISPLAY '** ABEND                            **'         
506600*                DISPLAY '** PROGRAM = TRKUP225               **'         
506700*                DISPLAY '** PARAGRAPH = 7110-INSERT-TIMRCVS  **'         
506800*                DISPLAY '** INSERT TIMRCVS                   **'         
506900*                DISPLAY '** PO NUMBER    = '                             
507000*                DISPLAY            TR025-LOGVS-PO-NBR                    
507100*                DISPLAY '** VENDOR STYLE = '                             
507200*                DISPLAY            TR025-LOGVS-VS-NBR                    
507300*                DISPLAY '** EXTL REF NBR = '                             
507400*                DISPLAY            TR025-LOGVS-EXTL-REF-NBR              
507500*                DISPLAY '** PO RCVD DELY DTE = '                         
507600*                DISPLAY            TR025-LOGVS-PO-RCVD-DELY-DTE          
507700*                DISPLAY '** ORGN SHPD FR CDE = '                         
507800*                DISPLAY            TR025-LOGVS-ORGN-SHPD-FR-CDE          
507900*                DISPLAY '**************************************'         
508000*                PERFORM 9100-SQL-ABEND                                   
508100*        END-EVALUATE                                                     
508200*    END-PERFORM.                                                         
508300*                                                                         
508400*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
508500*        (SQLCODE NOT = ZERO AND                                          
508600*            SQLCODE NOT = -803)                                          
508700*        DISPLAY '****************************************'               
508800*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
508900*        DISPLAY '** INSERT INTO TIMRCVS                **'               
509000*        DISPLAY '** PARAGRAPH = 7110-INSERT-TIMRCVS    **'               
509100*        DISPLAY '** PO NUMBER    = ' TR025-LOGVS-PO-NBR                  
509200*        DISPLAY '** VENDOR STYLE = ' TR025-LOGVS-VS-NBR                  
509300*        DISPLAY '** EXTL REF NBR = ' TR025-LOGVS-EXTL-REF-NBR            
509400*        DISPLAY '****************************************'               
509500*        PERFORM 9100-SQL-ABEND                                           
509600*    END-IF.                                                              
509700                                                                          
509800 EJECT                                                                    
509900                                                                          
510000******************************************************************        
510100* SELECT A ROW FROM THE RECEIVING UPC TABLE  (TIMRCUP).          *        
510200******************************************************************        
510300*7200-SELECT-TIMRCUP.                                                     
510400*                                                                         
510500*    PERFORM                                                              
510600*        WITH TEST AFTER                                                  
510700*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
510800*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
510900*                SQLCODE = ZERO                     OR                    
511000*                SQLCODE = +100                                           
511100*                                                                         
511200*        EXEC SQL                                                         
511300*            SELECT PO_NBR,                                               
511400*                   PO_RCVD_SEQ_NBR,                                      
511500*                   VS_NBR,                                               
511600*                   UPC_NBR,                                              
511700*                   UPC_CART_CNT,                                         
511800*                   UPC_CBMT_QTY,                                         
511900*                   UPC_WT_KGRM_QTY,                                      
512000*                   UPC_UNT_QTY,                                          
512100*                   CRE_BY_USR_ID,                                        
512200*                   CRE_TMST,                                             
512300*                   LAST_UPD_BY_USR_ID,                                   
512400*                   LAST_UPD_TMST                                         
512500*             INTO :IMRCUP-PO-NBR,                                        
512600*                  :IMRCUP-PO-RCVD-SEQ-NBR,                               
512700*                  :IMRCUP-VS-NBR,                                        
512800*                  :IMRCUP-UPC-NBR,                                       
512900*                  :IMRCUP-UPC-CART-CNT,                                  
513000*                  :IMRCUP-UPC-CBMT-QTY,                                  
513100*                  :IMRCUP-UPC-WT-KGRM-QTY,                               
513200*                  :IMRCUP-UPC-UNT-QTY,                                   
513300*                  :IMRCUP-CRE-BY-USR-ID,                                 
513400*                  :IMRCUP-CRE-TMST,                                      
513500*                  :IMRCUP-LAST-UPD-BY-USR-ID,                            
513600*                  :IMRCUP-LAST-UPD-TMST                                  
513700*                                                                         
513800*              FROM TIMRCUP                                               
513900*             WHERE PO_NBR           = :IMRCUP-PO-NBR                     
514000*               AND VS_NBR           = :IMRCUP-VS-NBR                     
514100*               AND UPC_NBR          = :IMRCUP-UPC-NBR                    
514200*               AND PO_RCVD_SEQ_NBR  = :IMRCPO-PO-RCVD-SEQ-NBR            
514300*        END-EXEC                                                         
514400*                                                                         
514500*        EVALUATE TRUE                                                    
514600*            WHEN SQLCODE = ZERO                                          
514700*                SET PS-TIMRCUP-ROW-IS-THERE            TO TRUE           
514800*                                                                         
514900*            WHEN SQLCODE = +100                                          
515000*                SET PS-TIMRCUP-ROW-IS-THERE-NO         TO TRUE           
515100*                                                                         
515200*            WHEN SQLWARN0 NOT EQUAL SPACE                                
515300*            WHEN SQLCODE NOT EQUAL ZERO                                  
515400*                DISPLAY '**************************************'         
515500*                DISPLAY '** ABEND                            **'         
515600*                DISPLAY '** PROGRAM = TRKUP225               **'         
515700*                DISPLAY '** PARAGRAPH = 7200-SELECT-TIMRCUP  **'         
515800*                DISPLAY '** SELECT TIMRCUP                   **'         
515900*                DISPLAY '** PO NUMBER    = '                             
516000*                DISPLAY            TR025-LOGUPC-PO-NBR                   
516100*                DISPLAY '** VENDOR STYLE = '                             
516200*                DISPLAY            TR025-LOGUPC-VS-NBR                   
516300*                DISPLAY '** UPC NUMBER   = '                             
516400*                DISPLAY            TR025-LOGUPC-UPC-NBR                  
516500*                DISPLAY '** EXTL REF NBR = '                             
516600*                DISPLAY            TR025-LOGUPC-EXTL-REF-NBR             
516700*                DISPLAY '**************************************'         
516800*                PERFORM 9100-SQL-ABEND                                   
516900*        END-EVALUATE                                                     
517000*    END-PERFORM.                                                         
517100                                                                          
517200*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
517300*        (SQLCODE NOT = ZERO AND                                          
517400*            SQLCODE NOT = +100)                                          
517500*        DISPLAY '****************************************'               
517600*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
517700*        DISPLAY '** SELECT FROM TIMRCUP                **'               
517800*        DISPLAY '** PARAGRAPH = 7200-SELECT-TIMRCUP    **'               
517900*        DISPLAY '** PO NUMBER    = ' TR025-LOGUPC-PO-NBR                 
518000*        DISPLAY '** VENDOR STYLE = ' TR025-LOGUPC-VS-NBR                 
518100*        DISPLAY '** UPC NUMBER   = ' TR025-LOGUPC-UPC-NBR                
518200*        DISPLAY '** EXTL REF NBR = ' TR025-LOGUPC-EXTL-REF-NBR           
518300*        DISPLAY '****************************************'               
518400*        PERFORM 9100-SQL-ABEND                                           
518500*    END-IF.                                                              
518600                                                                          
518700 EJECT                                                                    
518800                                                                          
518900******************************************************************        
519000* SELECT A ROW FROM THE RECEIVING UPC TABLE  (TIMRCUP).          *        
519100******************************************************************        
519200*7205-SELECT-TIMRCUP-CHG.                                                 
519300                                                                          
519400*    PERFORM                                                              
519500*        WITH TEST AFTER                                                  
519600*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
519700*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
519800*                SQLCODE = ZERO                     OR                    
519900*                SQLCODE = +100                                           
520000*                                                                         
520100*        EXEC SQL                                                         
520200*            SELECT PO_NBR,                                               
520300*                   PO_RCVD_SEQ_NBR,                                      
520400*                   VS_NBR,                                               
520500*                   UPC_NBR,                                              
520600*                   UPC_CART_CNT,                                         
520700*                   UPC_CBMT_QTY,                                         
520800*                   UPC_WT_KGRM_QTY,                                      
520900*                   UPC_UNT_QTY,                                          
521000*                   CRE_BY_USR_ID,                                        
521100*                   CRE_TMST,                                             
521200*                   LAST_UPD_BY_USR_ID,                                   
521300*                   LAST_UPD_TMST                                         
521400*             INTO :IMRCUP-PO-NBR,                                        
521500*                  :IMRCUP-PO-RCVD-SEQ-NBR,                               
521600*                  :IMRCUP-VS-NBR,                                        
521700*                  :IMRCUP-UPC-NBR,                                       
521800*                  :IMRCUP-UPC-CART-CNT,                                  
521900*                  :IMRCUP-UPC-CBMT-QTY,                                  
522000*                  :IMRCUP-UPC-WT-KGRM-QTY,                               
522100*                  :IMRCUP-UPC-UNT-QTY,                                   
522200*                  :IMRCUP-CRE-BY-USR-ID,                                 
522300*                  :IMRCUP-CRE-TMST,                                      
522400*                  :IMRCUP-LAST-UPD-BY-USR-ID,                            
522500*                  :IMRCUP-LAST-UPD-TMST                                  
522600*                                                                         
522700*              FROM TIMRCUP                                               
522800*             WHERE PO_NBR           = :IMRCPO-PO-NBR                     
522900*               AND PO_RCVD_SEQ_NBR  = :IMRCPO-PO-RCVD-SEQ-NBR            
523000*               AND VS_NBR           = :PV-UPC-CURSOR-VS-NBR              
523100*               AND UPC_NBR          = :PV-UPC-CURSOR-UPC-NBR             
523200*        END-EXEC                                                         
523300*                                                                         
523400*        EVALUATE TRUE                                                    
523500*            WHEN SQLCODE = ZERO                                          
523600*                CONTINUE                                                 
523700*                                                                         
523800*            WHEN SQLCODE = +100                                          
523900*                CONTINUE                                                 
524000*                                                                         
524100*            WHEN SQLWARN0 NOT EQUAL SPACE                                
524200*            WHEN SQLCODE NOT EQUAL ZERO                                  
524300*                DISPLAY '**************************************'         
524400*                DISPLAY '** ABEND                            **'         
524500*                DISPLAY '** PROGRAM = TRKUP225               **'         
524600*                DISPLAY '** PARAGRAPH = 7205-SELECT-TIMRCUP-CHG'         
524700*                DISPLAY '** SELECT TIMRCUP                   **'         
524800*                DISPLAY '** PO NUMBER   = ' IMRCPO-PO-NBR                
524900*              DISPLAY '** RCVD SEQ NBR = ' IMRCPO-PO-RCVD-SEQ-NBR        
525000*                DISPLAY '** VENDOR STYLE= ' PV-UPC-CURSOR-VS-NBR         
525100*                DISPLAY '** UPC NUMBER  = ' PV-UPC-CURSOR-UPC-NBR        
525200*                DISPLAY '**************************************'         
525300*                PERFORM 9100-SQL-ABEND                                   
525400*        END-EVALUATE                                                     
525500*    END-PERFORM.                                                         
525600*                                                                         
525700*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
525800*        (SQLCODE NOT = ZERO AND                                          
525900*            SQLCODE NOT = +100)                                          
526000*        DISPLAY '****************************************'               
526100*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
526200*        DISPLAY '** SELECT FROM TIMRCUP                **'               
526300*        DISPLAY '** PARAGRAPH = 7205-SELECT-TIMRCUP-CHG**'               
526400*        DISPLAY '** PO NUMBER   = ' IMRCPO-PO-NBR                        
526500*        DISPLAY '** RCVD SEQ NBR = ' IMRCPO-PO-RCVD-SEQ-NBR              
526600*        DISPLAY '** VENDOR STYLE= ' PV-UPC-CURSOR-VS-NBR                 
526700*        DISPLAY '** UPC NUMBER  = ' PV-UPC-CURSOR-UPC-NBR                
526800*        DISPLAY '****************************************'               
526900*        PERFORM 9100-SQL-ABEND                                           
527000*    END-IF.                                                              
527100                                                                          
527200 EJECT                                                                    
527300                                                                          
527400******************************************************************        
527500* INSERT A ROW INTO THE RECEIVING UPC TABLE  (TIMRCUP).          *        
527600******************************************************************        
527700*7210-INSERT-TIMRCUP.                                                     
527800                                                                          
527900*    PERFORM                                                              
528000*        WITH TEST AFTER                                                  
528100*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
528200*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
528300*                SQLCODE = ZERO                     OR                    
528400*                SQLCODE = -803                                           
528500*                                                                         
528600*        EXEC SQL                                                         
528700*            INSERT INTO TIMRCUP                                          
528800*                  (PO_NBR,                                               
528900*                   PO_RCVD_SEQ_NBR,                                      
529000*                   VS_NBR,                                               
529100*                   UPC_NBR,                                              
529200*                   UPC_CART_CNT,                                         
529300*                   UPC_CBMT_QTY,                                         
529400*                   UPC_WT_KGRM_QTY,                                      
529500*                   UPC_UNT_QTY,                                          
529600*                   CRE_BY_USR_ID,                                        
529700*                   CRE_TMST,                                             
529800*                   LAST_UPD_BY_USR_ID,                                   
529900*                   LAST_UPD_TMST)                                        
530000*          VALUES (:IMRCUP-PO-NBR,                                        
530100*                  :IMRCUP-PO-RCVD-SEQ-NBR,                               
530200*                  :IMRCUP-VS-NBR,                                        
530300*                  :IMRCUP-UPC-NBR,                                       
530400*                  :IMRCUP-UPC-CART-CNT,                                  
530500*                  :IMRCUP-UPC-CBMT-QTY,                                  
530600*                  :IMRCUP-UPC-WT-KGRM-QTY,                               
530700*                  :IMRCUP-UPC-UNT-QTY,                                   
530800*                  :IMRCUP-CRE-BY-USR-ID,                                 
530900*                  :IMRCUP-CRE-TMST,                                      
531000*                  :IMRCUP-LAST-UPD-BY-USR-ID,                            
531100*                  :IMRCUP-LAST-UPD-TMST)                                 
531200*                                                                         
531300*        END-EXEC                                                         
531400*                                                                         
531500*        EVALUATE TRUE                                                    
531600*            WHEN SQLCODE = ZERO                                          
531700*                ADD +1                 TO PA-TOT-RCUPC-INSERTS           
531800*                ADD +1                 TO PA-TOT-RECS-INSERTED           
531900*                MOVE PC-D              TO TR221-RPT-TYP                  
532000*                SET PS-GOOD-RCUPC-INSERT TO TRUE                         
532100*                                                                         
532200*            WHEN SQLCODE = -803                                          
532300*                SET PS-UPC-EXISTS          TO TRUE                       
532400*                SET PS-GOOD-RCUPC-INSERT-NO TO TRUE                      
532500*                                                                         
532600*            WHEN SQLWARN0 NOT EQUAL SPACE                                
532700*            WHEN SQLCODE NOT EQUAL ZERO                                  
532800*                DISPLAY '**************************************'         
532900*                DISPLAY '** ABEND                            **'         
533000*                DISPLAY '** PROGRAM = TRKUP225               **'         
533100*                DISPLAY '** PARAGRAPH = 7210-INSERT-TIMRCUP  **'         
533200*                DISPLAY '** INSERT TIMRCUP                   **'         
533300*                DISPLAY '** PO NUMBER    = '                             
533400*                DISPLAY            TR025-LOGUPC-PO-NBR                   
533500*                DISPLAY '** VENDOR STYLE = '                             
533600*                DISPLAY            TR025-LOGUPC-VS-NBR                   
533700*                DISPLAY '** UPC NUMBER   = '                             
533800*                DISPLAY            TR025-LOGUPC-UPC-NBR                  
533900*                DISPLAY '** EXTL REF NBR = '                             
534000*                DISPLAY            TR025-LOGUPC-EXTL-REF-NBR             
534100*                DISPLAY '**************************************'         
534200*                PERFORM 9100-SQL-ABEND                                   
534300*        END-EVALUATE                                                     
534400*    END-PERFORM.                                                         
534500*                                                                         
534600*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
534700*        (SQLCODE NOT = ZERO AND                                          
534800*            SQLCODE NOT = -803)                                          
534900*        DISPLAY '****************************************'               
535000*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
535100*        DISPLAY '** INSERT INTO TIMRCUP                **'               
535200*        DISPLAY '** PARAGRAPH = 7210-SELECT-TIMRCUP    **'               
535300*        DISPLAY '** PO NUMBER    = ' TR025-LOGUPC-PO-NBR                 
535400*        DISPLAY '** VENDOR STYLE = ' TR025-LOGUPC-VS-NBR                 
535500*        DISPLAY '** UPC NUMBER   = ' TR025-LOGUPC-UPC-NBR                
535600*        DISPLAY '** EXTL REF NBR = ' TR025-LOGUPC-EXTL-REF-NBR           
535700*        DISPLAY '****************************************'               
535800*        PERFORM 9100-SQL-ABEND                                           
535900*    END-IF.                                                              
536000                                                                          
536100 EJECT                                                                    
536200                                                                          
536300******************************************************************        
536400* DETERMINE THE RECORD TYPE PRIOR TO INSERTING THE DETAIL LINE   *        
536500* INTO THE WORKTABLE (TOUTTR7).                                  *        
536600* THE RECORD TYPES ARE ERD (1), ERDRSN (2), LOG (3)              *        
536700* THE PV-HOLD-ERD-ADD-SEQ-NBR AND PV-HOLD-ERDRSN-ADD-SEQ-NBR AND *        
536800* THE PV-HOLD-LOG-ADD-SEQ-NBR FIELDS ARE INITIALIZED IN P. 2000- *        
536900* FIELD MOVES UNIQUE TO EACH RECORD TYPE ARE PERFORMED,          *        
537000* 7300-INSERT-TOUTTR7-RPT IS PERFORMED TO PRODUCE A DETAIL LINE  *        
537100* FOR EACH RECORD TYPE.                                          *        
537200* FIELD: TR221-RPT-TYP ALREADY CONTAINS A 'D'.                   *        
537300******************************************************************        
537400 7280-ERD-ERDRSN-LOG-DETAIL.                                              
537500                                                                          
537600     INITIALIZE TR221-RECORD.                                             
537700     INITIALIZE TR221-REC-TYP-ERD.                                        
537800                                                                          
537900     MOVE PV-HOLD-PROCESS-SEQ-NBR-ERD          TO                         
538000           TR221-PROCESS-SEQ-NBR.                                         
538100     MOVE TR025-ERD-ENT-ID    TO TR221-DAT-SRC-ENT-ID.                    
538200                                                                          
538300     IF PS-CHANGE-ADD                                                     
538400         MOVE PC-B               TO TR221-TRN-TYP                         
538500     ELSE                                                                 
538600         MOVE TR025-ERD-TRN-TYP  TO TR221-TRN-TYP                         
538700     END-IF.                                                              
538800                                                                          
538900     MOVE PV-REC-TYP-ERD                       TO                         
539000           TR221-REC-TYP-ERD-CDE.                                         
539100                                                                          
539200     IF TR025-LOG-PO-NBR NUMERIC                                          
539300         MOVE TR025-LOG-PO-NBR    TO TR221-PO-NBR                         
539400     ELSE                                                                 
539500         MOVE TR025-LOG-PO-NBR-X  TO TR221-PO-NBR-X                       
539600     END-IF.                                                              
539700                                                                          
539800     MOVE TR025-LOG-EXTL-REF-NBR               TO                         
539900           TR221-EXTL-REF-NBR.                                            
540000     MOVE TR025-LOG-PO-RCVD-DELY-DTE           TO                         
540100           TR221-PO-RCVD-DELY-DTE.                                        
540200     MOVE TR025-LOG-PO-RCVD-DELY-TM            TO                         
540300           TR221-PO-RCVD-DELY-TM.                                         
540400     MOVE TR025-LOG-ORGN-SHPD-FR-CDE           TO                         
540500           TR221-ORGN-SHPD-FR-CDE.                                        
540600     MOVE IMRCPO-IMPRT-TRIP-ID                 TO                         
540700           TR221-ERD-IMPRT-TRIP-ID.                                       
540800     MOVE IMRCPO-CARR-SCAC-ID                  TO                         
540900           TR221-ERD-CARR-SCAC-ID.                                        
541000     MOVE IMRCPO-IMPRT-VEH-NM                  TO                         
541100           TR221-ERD-IMPRT-VEH-NM.                                        
541200     MOVE IMRCPO-POE-DELY-TMST (1:4)           TO                         
541300           TR221-ERD-POE-DELY-DTE (1:4).                                  
541400     MOVE IMRCPO-POE-DELY-TMST (6:2)           TO                         
541500           TR221-ERD-POE-DELY-DTE (5:2).                                  
541600     MOVE IMRCPO-POE-DELY-TMST (9:2)           TO                         
541700           TR221-ERD-POE-DELY-DTE (7:2).                                  
541800     MOVE IMRCPO-POE-DELY-TMST (12:2)          TO                         
541900           TR221-ERD-POE-DELY-TM (1:2).                                   
542000     MOVE IMRCPO-POE-DELY-TMST (15:2)          TO                         
542100           TR221-ERD-POE-DELY-TM (3:2).                                   
542200     MOVE IMRCPO-FOB-CDE                       TO                         
542300           TR221-ERD-FOB-CDE.                                             
542400     MOVE IMRCPO-DEST-POE-CDE                  TO                         
542500           TR221-ERD-DEST-POE-CDE.                                        
542600     MOVE IMRCPO-EST-LBD-NM                    TO                         
542700           TR221-ERD-EST-LBD-NM.                                          
542800     MOVE IMRCPO-TRIP-TYP-CDE                  TO                         
542900           TR221-ERD-TRIP-TYP-CDE.                                        
543000     MOVE IMRCPO-DPRTR-TMST (1:4)              TO                         
543100           TR221-ERD-DPRTR-DTE (1:4).                                     
543200     MOVE IMRCPO-DPRTR-TMST (6:2)              TO                         
543300           TR221-ERD-DPRTR-DTE (5:2).                                     
543400     MOVE IMRCPO-DPRTR-TMST (9:2)              TO                         
543500           TR221-ERD-DPRTR-DTE (7:2).                                     
543600     MOVE IMRCPO-DPRTR-TMST (12:2)             TO                         
543700           TR221-ERD-DPRTR-TM (1:2).                                      
543800     MOVE IMRCPO-DPRTR-TMST (15:2)             TO                         
543900           TR221-ERD-DPRTR-TM (3:2).                                      
544000     MOVE PC-D                                 TO                         
544100         TR221-RPT-TYP.                                                   
544200                                                                          
544300     PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
544400                                                                          
544500     IF PV-HOLD-PROCESS-SEQ-NBR-ERDRSN = ZERO                             
544600          CONTINUE                                                        
544700     ELSE                                                                 
544800          INITIALIZE TR221-RECORD                                         
544900          INITIALIZE TR221-REC-TYP-ERDRSN                                 
545000          MOVE PV-HOLD-PROCESS-SEQ-NBR-ERDRSN TO                          
545100                TR221-PROCESS-SEQ-NBR                                     
545200          MOVE TR025-ERD-ENT-ID  TO TR221-DAT-SRC-ENT-ID                  
545300                                                                          
545400          IF PS-CHANGE-ADD                                                
545500              MOVE PC-B               TO TR221-TRN-TYP                    
545600          ELSE                                                            
545700              MOVE TR025-LOG-TRN-TYP  TO TR221-TRN-TYP                    
545800          END-IF                                                          
545900                                                                          
546000          MOVE PV-REC-TYP-ERDRSN                    TO                    
546100                TR221-REC-TYP-ERDRSN-CDE                                  
546200                                                                          
546300          IF TR025-LOG-PO-NBR NUMERIC                                     
546400              MOVE TR025-LOG-PO-NBR    TO TR221-PO-NBR                    
546500          ELSE                                                            
546600              MOVE TR025-LOG-PO-NBR-X  TO TR221-PO-NBR-X                  
546700          END-IF                                                          
546800                                                                          
546900          MOVE TR025-LOG-EXTL-REF-NBR               TO                    
547000                TR221-EXTL-REF-NBR                                        
547100          MOVE TR025-LOG-PO-RCVD-DELY-DTE           TO                    
547200                TR221-PO-RCVD-DELY-DTE                                    
547300          MOVE TR025-LOG-PO-RCVD-DELY-TM            TO                    
547400                TR221-PO-RCVD-DELY-TM                                     
547500          MOVE TR025-LOG-ORGN-SHPD-FR-CDE           TO                    
547600                TR221-ORGN-SHPD-FR-CDE                                    
547700          MOVE IMRCPO-IMPRT-TRIP-ID                 TO                    
547800                TR221-ERDRSN-IMPRT-TRIP-ID                                
547900          MOVE IMRCPO-CARR-SCAC-ID                  TO                    
548000                TR221-ERDRSN-CARR-SCAC-ID                                 
548100          MOVE IMRCPO-POE-DELY-TMST (1:4)           TO                    
548200                TR221-ERDRSN-POE-DELY-DTE (1:4)                           
548300          MOVE IMRCPO-POE-DELY-TMST (6:2)           TO                    
548400                TR221-ERDRSN-POE-DELY-DTE (5:2)                           
548500          MOVE IMRCPO-POE-DELY-TMST (9:2)           TO                    
548600                TR221-ERDRSN-POE-DELY-DTE (7:2)                           
548700          MOVE IMRCPO-POE-DELY-TMST (12:2)          TO                    
548800                TR221-ERDRSN-POE-DELY-TM (1:2)                            
548900          MOVE IMRCPO-POE-DELY-TMST (15:2)          TO                    
549000                TR221-ERDRSN-POE-DELY-TM (3:2)                            
549100          MOVE IMRCPO-VOY-CHG-RSN-DESC              TO                    
549200                TR221-ERDRSN-VOY-CHG-RSN-DESC                             
549300          MOVE IMRCPO-DPRTR-TMST (1:4)              TO                    
549400                TR221-ERDRSN-DPRTR-DTE (1:4)                              
549500          MOVE IMRCPO-DPRTR-TMST (6:2)              TO                    
549600                TR221-ERDRSN-DPRTR-DTE (5:2)                              
549700          MOVE IMRCPO-DPRTR-TMST (9:2)              TO                    
549800                TR221-ERDRSN-DPRTR-DTE (7:2)                              
549900          MOVE IMRCPO-DPRTR-TMST (12:2)             TO                    
550000                TR221-ERDRSN-DPRTR-TM (1:2)                               
550100          MOVE IMRCPO-DPRTR-TMST (15:2)             TO                    
550200                TR221-ERDRSN-DPRTR-TM (3:2)                               
550300          MOVE PC-D                                 TO                    
550400             TR221-RPT-TYP                                                
550500          PERFORM 7300-INSERT-TOUTTR7-RPT                                 
550600     END-IF.                                                              
550700                                                                          
550800                                                                          
550900     INITIALIZE TR221-RECORD.                                             
551000     INITIALIZE TR221-REC-TYP-LOG.                                        
551100                                                                          
551200     MOVE PV-HOLD-PROCESS-SEQ-NBR-LOG          TO                         
551300           TR221-PROCESS-SEQ-NBR.                                         
551400     MOVE TR025-ERD-ENT-ID  TO TR221-DAT-SRC-ENT-ID.                      
551500                                                                          
551600     IF PS-CHANGE-ADD                                                     
551700         MOVE PC-B               TO TR221-TRN-TYP                         
551800     ELSE                                                                 
551900         MOVE TR025-LOG-TRN-TYP  TO TR221-TRN-TYP                         
552000     END-IF.                                                              
552100                                                                          
552200     MOVE TR025-LOG-REC-TYP-CDE                TO                         
552300           TR221-REC-TYP-LOG-CDE.                                         
552400                                                                          
552500     IF TR025-LOG-PO-NBR NUMERIC                                          
552600         MOVE TR025-LOG-PO-NBR    TO TR221-PO-NBR                         
552700     ELSE                                                                 
552800         MOVE TR025-LOG-PO-NBR-X  TO TR221-PO-NBR-X                       
552900     END-IF.                                                              
553000                                                                          
553100     MOVE TR025-LOG-EXTL-REF-NBR               TO                         
553200           TR221-EXTL-REF-NBR.                                            
553300     MOVE TR025-LOG-PO-RCVD-DELY-DTE           TO                         
553400           TR221-PO-RCVD-DELY-DTE.                                        
553500     MOVE TR025-LOG-PO-RCVD-DELY-TM            TO                         
553600           TR221-PO-RCVD-DELY-TM.                                         
553700     MOVE TR025-LOG-ORGN-SHPD-FR-CDE           TO                         
553800           TR221-ORGN-SHPD-FR-CDE.                                        
553900                                                                          
554000     IF TR025-LOG-PO-CART-CNT NUMERIC                                     
554100         MOVE TR025-LOG-PO-CART-CNT   TO TR221-LOG-PO-CART-CNT            
554200     ELSE                                                                 
554300         MOVE TR025-LOG-PO-CART-CNT-X TO TR221-LOG-PO-CART-CNT-X          
554400     END-IF.                                                              
554500                                                                          
554600     IF TR025-LOG-PO-UNT-QTY NUMERIC                                      
554700         MOVE TR025-LOG-PO-UNT-QTY    TO TR221-LOG-PO-UNT-QTY             
554800     ELSE                                                                 
554900         MOVE TR025-LOG-PO-UNT-QTY-X  TO TR221-LOG-PO-UNT-QTY-X           
555000     END-IF.                                                              
555100                                                                          
555200     IF TR025-LOG-PO-CBMT-QTY NUMERIC                                     
555300         MOVE TR025-LOG-PO-CBMT-QTY   TO TR221-LOG-PO-CBMT-QTY            
555400     ELSE                                                                 
555500         MOVE TR025-LOG-PO-CBMT-QTY-X TO TR221-LOG-PO-CBMT-QTY-X          
555600     END-IF.                                                              
555700                                                                          
555800     IF TR025-LOG-PO-WT-KGRM-QTY NUMERIC                                  
555900         MOVE TR025-LOG-PO-WT-KGRM-QTY    TO                              
556000               TR221-LOG-PO-WT-KGRM-QTY                                   
556100     ELSE                                                                 
556200         MOVE TR025-LOG-PO-WT-KGRM-QTY-X  TO                              
556300               TR221-LOG-PO-WT-KGRM-QTY-X                                 
556400     END-IF.                                                              
556500                                                                          
556600     MOVE TR025-LOG-PROD-FCTRY-NM              TO                         
556700           TR221-LOG-PROD-FCTRY-NM.                                       
556800     MOVE TR025-LOG-C-O-PROD-CDE               TO                         
556900           TR221-LOG-C-O-PROD-CDE.                                        
557000     MOVE TR025-LOG-CONSOL-SCAC-ID             TO                         
557100           TR221-LOG-CONSOL-SCAC-ID.                                      
557200     MOVE PC-D                                 TO                         
557300         TR221-RPT-TYP.                                                   
557400                                                                          
557500     PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
557600                                                                          
557700 EJECT                                                                    
557800                                                                          
557900******************************************************************        
558000* MOVE TIMRCPO DCLGEN FIELDS TO DETAIL LINE PRIOR TO INSERTING   *        
558100* INTO THE WORKTABLE (TOUTTR7).                                  *        
558200******************************************************************        
558300 7282-TIMRCPO-DCLGEN-TO-DETAIL.                                           
558400                                                                          
558500     INITIALIZE TR221-RECORD.                                             
558600     INITIALIZE TR221-REC-TYP-ERD.                                        
558700                                                                          
558800     MOVE PV-SEQ-NBR-ERD                TO TR221-PROCESS-SEQ-NBR.         
558900     MOVE PV-HOLD-DAT-SRC-ENT-ID        TO TR221-DAT-SRC-ENT-ID.          
559000     MOVE PV-HOLD-TR025-TRN-TYP         TO TR221-TRN-TYP.                 
559100     MOVE PV-REC-TYP-ERD                TO TR221-REC-TYP-ERD-CDE.         
559200     MOVE PV-HOLD-TR025-PO-NBR          TO TR221-PO-NBR.                  
559300     MOVE PV-HOLD-TR025-EXTL-REF-NBR    TO TR221-EXTL-REF-NBR.            
559400     MOVE PV-HOLD-TR025-PO-RCVD-DELY-DTE                                  
559500                                      TO TR221-PO-RCVD-DELY-DTE.          
559600     MOVE PV-HOLD-TR025-PO-RCVD-DELY-TM TO TR221-PO-RCVD-DELY-TM.         
559700     MOVE PV-HOLD-ORGN-SHPD-FR-CDE      TO                                
559800                                        TR221-ORGN-SHPD-FR-CDE.           
559900     MOVE PC-D                          TO TR221-RPT-TYP.                 
560000                                                                          
560100     MOVE IMRCPO-IMPRT-TRIP-ID        TO TR221-ERD-IMPRT-TRIP-ID.         
560200     MOVE IMRCPO-CARR-SCAC-ID         TO TR221-ERD-CARR-SCAC-ID.          
560300     MOVE IMRCPO-IMPRT-VEH-NM         TO TR221-ERD-IMPRT-VEH-NM.          
560400                                                                          
560500     MOVE IMRCPO-POE-DELY-TMST (1:4)    TO                                
560600           TR221-ERD-POE-DELY-DTE (1:4).                                  
560700     MOVE IMRCPO-POE-DELY-TMST (6:2)    TO                                
560800           TR221-ERD-POE-DELY-DTE (5:2).                                  
560900     MOVE IMRCPO-POE-DELY-TMST (9:2)    TO                                
561000           TR221-ERD-POE-DELY-DTE (7:2).                                  
561100     MOVE IMRCPO-POE-DELY-TMST (12:2)   TO                                
561200           TR221-ERD-POE-DELY-TM (1:2).                                   
561300     MOVE IMRCPO-POE-DELY-TMST (15:2)   TO                                
561400           TR221-ERD-POE-DELY-TM (3:2).                                   
561500                                                                          
561600     MOVE IMRCPO-FOB-CDE                TO TR221-ERD-FOB-CDE.             
561700     MOVE IMRCPO-DEST-POE-CDE           TO TR221-ERD-DEST-POE-CDE.        
561800     MOVE IMRCPO-EST-LBD-NM             TO TR221-ERD-EST-LBD-NM.          
561900     MOVE IMRCPO-TRIP-TYP-CDE           TO TR221-ERD-TRIP-TYP-CDE.        
562000                                                                          
562100     MOVE IMRCPO-DPRTR-TMST (1:4)       TO                                
562200           TR221-ERD-DPRTR-DTE (1:4).                                     
562300     MOVE IMRCPO-DPRTR-TMST (6:2)       TO                                
562400           TR221-ERD-DPRTR-DTE (5:2).                                     
562500     MOVE IMRCPO-DPRTR-TMST (9:2)       TO                                
562600           TR221-ERD-DPRTR-DTE (7:2).                                     
562700     MOVE IMRCPO-DPRTR-TMST (12:2)      TO                                
562800           TR221-ERD-DPRTR-TM (1:2).                                      
562900     MOVE IMRCPO-DPRTR-TMST (15:2)      TO                                
563000           TR221-ERD-DPRTR-TM (3:2).                                      
563100                                                                          
563200     PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
563300                                                                          
563400     IF PV-SEQ-NBR-ERDRSN = ZERO                                          
563500          CONTINUE                                                        
563600     ELSE                                                                 
563700          INITIALIZE TR221-RECORD                                         
563800          INITIALIZE TR221-REC-TYP-ERDRSN                                 
563900          MOVE PV-SEQ-NBR-ERDRSN     TO TR221-PROCESS-SEQ-NBR             
564000          MOVE PV-HOLD-DAT-SRC-ENT-ID TO TR221-DAT-SRC-ENT-ID             
564100          MOVE PV-HOLD-TR025-TRN-TYP TO TR221-TRN-TYP                     
564200          MOVE PV-REC-TYP-ERDRSN     TO TR221-REC-TYP-ERDRSN-CDE          
564300          MOVE PV-HOLD-TR025-PO-NBR  TO TR221-PO-NBR                      
564400          MOVE PV-HOLD-TR025-EXTL-REF-NBR TO TR221-EXTL-REF-NBR           
564500          MOVE PV-HOLD-TR025-PO-RCVD-DELY-DTE TO                          
564600                              TR221-PO-RCVD-DELY-DTE                      
564700          MOVE PV-HOLD-TR025-PO-RCVD-DELY-TM TO                           
564800                              TR221-PO-RCVD-DELY-TM                       
564900          MOVE PV-HOLD-ORGN-SHPD-FR-CDE             TO                    
565000                              TR221-ORGN-SHPD-FR-CDE                      
565100          MOVE PC-D                  TO TR221-RPT-TYP                     
565200                                                                          
565300          MOVE IMRCPO-IMPRT-TRIP-ID TO TR221-ERDRSN-IMPRT-TRIP-ID         
565400          MOVE IMRCPO-CARR-SCAC-ID  TO TR221-ERDRSN-CARR-SCAC-ID          
565500                                                                          
565600          MOVE IMRCPO-POE-DELY-TMST (1:4)           TO                    
565700                TR221-ERDRSN-POE-DELY-DTE (1:4)                           
565800          MOVE IMRCPO-POE-DELY-TMST (6:2)           TO                    
565900                TR221-ERDRSN-POE-DELY-DTE (5:2)                           
566000          MOVE IMRCPO-POE-DELY-TMST (9:2)           TO                    
566100                TR221-ERDRSN-POE-DELY-DTE (7:2)                           
566200          MOVE IMRCPO-POE-DELY-TMST (12:2)           TO                   
566300                TR221-ERDRSN-POE-DELY-TM (1:2)                            
566400          MOVE IMRCPO-POE-DELY-TMST (15:2)           TO                   
566500                TR221-ERDRSN-POE-DELY-TM (3:2)                            
566600          MOVE IMRCPO-VOY-CHG-RSN-DESC              TO                    
566700                TR221-ERDRSN-VOY-CHG-RSN-DESC                             
566800          MOVE IMRCPO-DPRTR-TMST (1:4)              TO                    
566900                TR221-ERDRSN-DPRTR-DTE (1:4)                              
567000          MOVE IMRCPO-DPRTR-TMST (6:2)              TO                    
567100                TR221-ERDRSN-DPRTR-DTE (5:2)                              
567200          MOVE IMRCPO-DPRTR-TMST (9:2)              TO                    
567300                TR221-ERDRSN-DPRTR-DTE (7:2)                              
567400          MOVE IMRCPO-DPRTR-TMST (12:2)             TO                    
567500                TR221-ERDRSN-DPRTR-TM (1:2)                               
567600          MOVE IMRCPO-DPRTR-TMST (15:2)             TO                    
567700                TR221-ERDRSN-DPRTR-TM (3:2)                               
567800          PERFORM 7300-INSERT-TOUTTR7-RPT                                 
567900     END-IF.                                                              
568000                                                                          
568100                                                                          
568200     INITIALIZE TR221-RECORD.                                             
568300     INITIALIZE TR221-REC-TYP-LOG.                                        
568400                                                                          
568500     MOVE PV-SEQ-NBR-LOG              TO TR221-PROCESS-SEQ-NBR.           
568600     MOVE PV-HOLD-DAT-SRC-ENT-ID      TO TR221-DAT-SRC-ENT-ID.            
568700     MOVE PV-HOLD-TR025-TRN-TYP       TO TR221-TRN-TYP.                   
568800     MOVE PV-REC-TYP-LOG              TO TR221-REC-TYP-LOG-CDE.           
568900     MOVE PV-HOLD-TR025-PO-NBR        TO TR221-PO-NBR.                    
569000     MOVE PV-HOLD-TR025-EXTL-REF-NBR  TO TR221-EXTL-REF-NBR.              
569100     MOVE PV-HOLD-TR025-PO-RCVD-DELY-DTE TO                               
569200                              TR221-PO-RCVD-DELY-DTE.                     
569300     MOVE PV-HOLD-TR025-PO-RCVD-DELY-TM TO                                
569400                           TR221-PO-RCVD-DELY-TM.                         
569500     MOVE PV-HOLD-ORGN-SHPD-FR-CDE    TO                                  
569600                           TR221-ORGN-SHPD-FR-CDE.                        
569700     MOVE PC-D                        TO TR221-RPT-TYP.                   
569800                                                                          
569900     MOVE IMRCPO-PO-CART-CNT          TO TR221-LOG-PO-CART-CNT.           
570000     MOVE IMRCPO-PO-UNT-QTY           TO TR221-LOG-PO-UNT-QTY.            
570100     MOVE IMRCPO-PROD-FCTRY-NM        TO TR221-LOG-PROD-FCTRY-NM.         
570200     MOVE IMRCPO-C-O-PROD-CDE         TO TR221-LOG-C-O-PROD-CDE.          
570300     MOVE IMRCPO-PO-CBMT-QTY          TO TR221-LOG-PO-CBMT-QTY.           
570400     MOVE IMRCPO-PO-WT-KGRM-QTY       TO TR221-LOG-PO-WT-KGRM-QTY.        
570500     MOVE IMRCPO-ORGN-SHPD-FR-CDE     TO                                  
570600                                      TR221-ORGN-SHPD-FR-CDE.             
570700     MOVE IMRCPO-CONSLR-SCAC-ID       TO TR221-LOG-CONSOL-SCAC-ID.        
570800                                                                          
570900     PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
571000                                                                          
571100 EJECT                                                                    
571200                                                                          
571300******************************************************************        
571400* MAKE FIELD MOVES PRIOR TO INSERTING TO THE WORK TABLE (TOUTTR7).        
571500******************************************************************        
571600*7285-PREP-DETAIL-TOUTTR7-VS.                                             
571700                                                                          
571800*    INITIALIZE TR221-RECORD                                              
571900*    INITIALIZE TR221-REC-TYP-LOGVS                                       
572000*                                                                         
572100*    MOVE TR025-ERD-PROCESS-SEQ-NBR    TO                                 
572200*               TR221-PROCESS-SEQ-NBR.                                    
572300*    MOVE TR025-ERD-ENT-ID    TO TR221-DAT-SRC-ENT-ID.                    
572400*                                                                         
572500*    IF PS-CHANGE-ADD                                                     
572600*        MOVE PC-B                   TO TR221-TRN-TYP                     
572700*    ELSE                                                                 
572800*        IF PS-CHANGE-ADD-VS-OR-UPC                                       
572900*            MOVE PC-Z               TO TR221-TRN-TYP                     
573000*        ELSE                                                             
573100*            MOVE TR025-ERD-TRN-TYP  TO TR221-TRN-TYP                     
573200*        END-IF                                                           
573300*    END-IF.                                                              
573400                                                                          
573500*    MOVE TR025-ERD-REC-TYP-CDE   TO TR221-REC-TYP-LOGVS-CDE.             
573600*                                                                         
573700*    IF TR025-ERD-PO-NBR NUMERIC                                          
573800*        MOVE TR025-ERD-PO-NBR    TO TR221-PO-NBR                         
573900*    ELSE                                                                 
574000*        MOVE TR025-ERD-PO-NBR-X  TO TR221-PO-NBR-X                       
574100*    END-IF.                                                              
574200*                                                                         
574300*    MOVE TR025-ERD-EXTL-REF-NBR       TO                                 
574400*          TR221-EXTL-REF-NBR.                                            
574500*    MOVE TR025-ERD-PO-RCVD-DELY-DTE   TO                                 
574600*          TR221-PO-RCVD-DELY-DTE.                                        
574700*    MOVE TR025-ERD-PO-RCVD-DELY-TM    TO                                 
574800*          TR221-PO-RCVD-DELY-TM.                                         
574900*    MOVE TR025-ERD-ORGN-SHPD-FR-CDE   TO                                 
575000*          TR221-ORGN-SHPD-FR-CDE.                                        
575100*    MOVE IMRCVS-VS-NBR                TO                                 
575200*          TR221-LOGVS-VS-NBR.                                            
575300*                                                                         
575400*    IF TR025-LOGVS-VS-CART-CNT NUMERIC                                   
575500*        MOVE TR025-LOGVS-VS-CART-CNT    TO                               
575600*              TR221-LOGVS-VS-CART-CNT                                    
575700*    ELSE                                                                 
575800*        MOVE TR025-LOGVS-VS-CART-CNT-X  TO                               
575900*              TR221-LOGVS-VS-CART-CNT-X                                  
576000*    END-IF.                                                              
576100*                                                                         
576200*    IF TR025-LOGVS-VS-UNT-QTY NUMERIC                                    
576300*        MOVE TR025-LOGVS-VS-UNT-QTY  TO TR221-LOGVS-VS-UNT-QTY           
576400*    ELSE                                                                 
576500*        MOVE TR025-LOGVS-VS-UNT-QTY-X  TO                                
576600*              TR221-LOGVS-VS-UNT-QTY-X                                   
576700*    END-IF.                                                              
576800                                                                          
576900*    IF TR025-LOGVS-VS-CBMT-QTY NUMERIC                                   
577000*        MOVE TR025-LOGVS-VS-CBMT-QTY   TO                                
577100*              TR221-LOGVS-VS-CBMT-QTY                                    
577200*    ELSE                                                                 
577300*        MOVE TR025-LOGVS-VS-CBMT-QTY-X TO                                
577400*              TR221-LOGVS-VS-CBMT-QTY-X                                  
577500*    END-IF.                                                              
577600                                                                          
577700*    IF TR025-LOGVS-VS-WT-KGRM-QTY NUMERIC                                
577800*        MOVE TR025-LOGVS-VS-WT-KGRM-QTY    TO                            
577900*              TR221-LOGVS-VS-WT-KGRM-QTY                                 
578000*    ELSE                                                                 
578100*        MOVE TR025-LOGVS-VS-WT-KGRM-QTY-X  TO                            
578200*              TR221-LOGVS-VS-WT-KGRM-QTY-X                               
578300*    END-IF.                                                              
578400*                                                                         
578500*    MOVE PC-D       TO TR221-RPT-TYP.                                    
578600*                                                                         
578700*    PERFORM 7300-INSERT-TOUTTR7-RPT.                                     
578800                                                                          
578900******************************************************************        
579000* MAKE FIELD MOVES PRIOR TO INSERTING TO THE WORK TABLE (TOUTTR7).        
579100******************************************************************        
579200*7290-PREP-DETAIL-TOUTTR7-UPC.                                            
579300                                                                          
579400*         INITIALIZE TR221-RECORD.                                        
579500*         INITIALIZE TR221-REC-TYP-LOGUPC.                                
579600*                                                                         
579700*         MOVE TR025-ERD-PROCESS-SEQ-NBR            TO                    
579800*               TR221-PROCESS-SEQ-NBR.                                    
579900*         MOVE TR025-ERD-ENT-ID                                           
580000*                              TO TR221-DAT-SRC-ENT-ID.                   
580100*                                                                         
580200*         IF PS-CHANGE-ADD                                                
580300*             MOVE PC-B                   TO TR221-TRN-TYP                
580400*         ELSE                                                            
580500*             IF PS-CHANGE-ADD-VS-OR-UPC                                  
580600*                 MOVE PC-Z               TO TR221-TRN-TYP                
580700*             ELSE                                                        
580800*                 MOVE TR025-ERD-TRN-TYP  TO TR221-TRN-TYP                
580900*             END-IF                                                      
581000*         END-IF.                                                         
581100*                                                                         
581200*         MOVE TR025-ERD-REC-TYP-CDE                TO                    
581300*               TR221-REC-TYP-ERD-CDE.                                    
581400*                                                                         
581500*         IF TR025-ERD-PO-NBR NUMERIC                                     
581600*             MOVE TR025-ERD-PO-NBR                 TO                    
581700*                   TR221-PO-NBR                                          
581800*         ELSE                                                            
581900*             MOVE TR025-ERD-PO-NBR-X               TO                    
582000*                   TR221-PO-NBR-X                                        
582100*         END-IF.                                                         
582200*                                                                         
582300*         MOVE TR025-ERD-EXTL-REF-NBR               TO                    
582400*               TR221-EXTL-REF-NBR.                                       
582500*         MOVE TR025-ERD-PO-RCVD-DELY-DTE           TO                    
582600*               TR221-PO-RCVD-DELY-DTE.                                   
582700*         MOVE TR025-ERD-PO-RCVD-DELY-TM            TO                    
582800*               TR221-PO-RCVD-DELY-TM.                                    
582900*         MOVE TR025-ERD-ORGN-SHPD-FR-CDE           TO                    
583000*               TR221-ORGN-SHPD-FR-CDE.                                   
583100*                                                                         
583200*         MOVE IMRCUP-VS-NBR                        TO                    
583300*               TR221-LOGUPC-VS-NBR.                                      
583400*         MOVE IMRCUP-UPC-NBR                       TO                    
583500*               TR221-LOGUPC-UPC-NBR.                                     
583600*                                                                         
583700*         IF TR025-LOGUPC-UPC-CART-CNT NUMERIC                            
583800*             MOVE TR025-LOGUPC-UPC-CART-CNT   TO                         
583900*                   TR221-LOGUPC-UPC-CART-CNT                             
584000*         ELSE                                                            
584100*             MOVE TR025-LOGUPC-UPC-CART-CNT-X TO                         
584200*                   TR221-LOGUPC-UPC-CART-CNT-X                           
584300*         END-IF.                                                         
584400                                                                          
584500*         IF TR025-LOGUPC-UPC-UNT-QTY NUMERIC                             
584600*             MOVE TR025-LOGUPC-UPC-UNT-QTY    TO                         
584700*                   TR221-LOGUPC-UPC-UNT-QTY                              
584800*         ELSE                                                            
584900*             MOVE TR025-LOGUPC-UPC-UNT-QTY-X  TO                         
585000*                   TR221-LOGUPC-UPC-UNT-QTY-X                            
585100*         END-IF.                                                         
585200*                                                                         
585300*         IF TR025-LOGUPC-UPC-CBMT-QTY NUMERIC                            
585400*             MOVE TR025-LOGUPC-UPC-CBMT-QTY   TO                         
585500*                   TR221-LOGUPC-UPC-CBMT-QTY                             
585600*         ELSE                                                            
585700*             MOVE TR025-LOGUPC-UPC-CBMT-QTY-X TO                         
585800*                   TR221-LOGUPC-UPC-CBMT-QTY-X                           
585900*         END-IF.                                                         
586000*                                                                         
586100*         IF TR025-LOGUPC-UPC-WT-KGRM-QTY NUMERIC                         
586200*             MOVE TR025-LOGUPC-UPC-WT-KGRM-QTY   TO                      
586300*                   TR221-LOGUPC-UPC-WT-KGRM-QTY                          
586400*         ELSE                                                            
586500*             MOVE TR025-LOGUPC-UPC-WT-KGRM-QTY-X TO                      
586600*                   TR221-LOGUPC-UPC-WT-KGRM-QTY-X                        
586700*         END-IF.                                                         
586800*                                                                         
586900*         MOVE PC-D                                 TO                    
587000*             TR221-RPT-TYP.                                              
587100                                                                          
587200******************************************************************        
587300* INSERT A ROW INTO THE DB2 WORK TABLE (TOUTTR7).                *        
587400******************************************************************        
587500 7300-INSERT-TOUTTR7-RPT.                                                 
587600                                                                          
587700     MOVE TR221-RECORD          TO OUTTR7-RCVD-RPTS-ODR.                  
587800                                                                          
587900     IF TR221-RPT-TYP = PC-D                                              
588000        ADD +1                  TO PA-TOTAL-DETAIL-COUNT                  
588100        ADD +1                  TO PA-TOTAL-RECS-LOADED                   
588200     ELSE                                                                 
588300        ADD +1                  TO PA-TOTAL-ERROR-COUNT                   
588400        ADD +1                  TO PA-TOTAL-RECS-LOADED                   
588500     END-IF                                                               
588600                                                                          
588700       PERFORM                                                            
588800         WITH TEST AFTER                                                  
588900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
589000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
589100                 SQLCODE = ZERO                                           
589200                                                                          
589300     EXEC SQL                                                             
589400         INSERT INTO TOUTTR7                                              
589500             (RCVD_RPTS_ODR)                                              
589600            VALUES  (:OUTTR7-RCVD-RPTS-ODR)                               
589700     END-EXEC                                                             
589800                                                                          
589900         EVALUATE TRUE                                                    
590000             WHEN SQLCODE = ZERO                                          
590100                 CONTINUE                                                 
590200                                                                          
590300             WHEN SQLWARN0 NOT EQUAL SPACE                                
590400             WHEN SQLCODE NOT EQUAL ZERO                                  
590500                 DISPLAY '**************************************'         
590600                 DISPLAY '** ABEND                            **'         
590700                 DISPLAY '** PROGRAM = TRKUP225               **'         
590800              DISPLAY '** PARAGRAPH = 7300-INSERT-TOUTTR7-RPT **'         
590900                 DISPLAY '** INSERT INTO TOUTTR7              **'         
591000                 DISPLAY '*TR221-PO-NBR = '     TR025-ERD-PO-NBR          
591100                 DISPLAY '*TR221-PROCESS-SEQ-NBR = '                      
591200                                             TR221-PROCESS-SEQ-NBR        
591300                 DISPLAY '**************************************'         
591400                 PERFORM 9100-SQL-ABEND                                   
591500         END-EVALUATE                                                     
591600     END-PERFORM.                                                         
591700                                                                          
591800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
591900         (SQLCODE NOT = ZERO)                                             
592000        DISPLAY '****************************************'                
592100        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'            
592200        DISPLAY '** INSERT TO TOUTTR7                      **'            
592300        DISPLAY '** PARAGRAPH = 7300-INSERT-TOUTTR7-RPT    **'            
592400        DISPLAY '* TR025-PO-NBR     = ' TR025-ERD-PO-NBR                  
592500        DISPLAY '* TR025-EXTL-REF-NBR=' TR025-ERD-EXTL-REF-NBR            
592600        DISPLAY '****************************************'                
592700      PERFORM 9100-SQL-ABEND                                              
592800     END-IF.                                                              
592900                                                                          
593000 EJECT                                                                    
593100                                                                          
593200******************************************************************        
593300* SELECT A ROW FROM THE PURCHASE ORDER TABLE  (TPURCHS).         *        
593400* THIS IS A CHECK TO SEE IF A PO IS ACTIVE OR APPROVED, OR       *        
593500* IF A PO IS ON THE MAINFRAME SYSTEM.                            *        
593600******************************************************************        
593700 7310-SELECT-TPURCHS.                                                     
593800                                                                          
593900     PERFORM                                                              
594000         WITH TEST AFTER                                                  
594100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
594200         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
594300                 SQLCODE = ZERO                     OR                    
594400                 SQLCODE = +100                                           
594500                                                                          
594600         EXEC SQL                                                         
594700             SELECT PO_NBR,                                               
594800                    STATUS_CDE,                                           
594900                    IMPRT_FCTRY_ID,                                       
595000                    IMPRT_VND_ID                                          
595100              INTO :PURCHS-PO-NBR,                                        
595200                   :PURCHS-STATUS-CDE,                                    
595300                   :PURCHS-IMPRT-FCTRY-ID,                                
595400                   :PURCHS-IMPRT-VND-ID                                   
595500                                                                          
595600               FROM TPURCHS                                               
595700              WHERE PO_NBR           = :IMRCPO-PO-NBR                     
595800                AND VER_STATUS_CDE   = 'A'                                
595900         END-EXEC                                                         
596000                                                                          
596100         EVALUATE TRUE                                                    
596200             WHEN SQLCODE = ZERO                                          
596300             WHEN SQLCODE = +100                                          
596400                 CONTINUE                                                 
596500                                                                          
596600             WHEN SQLWARN0 NOT EQUAL SPACE                                
596700             WHEN SQLCODE NOT EQUAL ZERO                                  
596800                 DISPLAY '**************************************'         
596900                 DISPLAY '** ABEND                            **'         
597000                 DISPLAY '** PROGRAM = TRKUP225               **'         
597100                 DISPLAY '** PARAGRAPH = 7310-CHECK-PO-ON-TPURCHS'        
597200                 DISPLAY '** SELECT FROM TPURCHS              **'         
597300                 DISPLAY '*PURCHS-PO-NUMBER = ' IMRCPO-PO-NBR             
597400                 DISPLAY '*PURCHS-STATUS-CDE= ' PURCHS-STATUS-CDE         
597500                 DISPLAY '**************************************'         
597600                 PERFORM 9100-SQL-ABEND                                   
597700         END-EVALUATE                                                     
597800     END-PERFORM.                                                         
597900                                                                          
598000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
598100         (SQLCODE NOT = ZERO AND                                          
598200             SQLCODE NOT = +100)                                          
598300         DISPLAY '****************************************'               
598400         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
598500         DISPLAY '** SELECT FROM TPURCHS                **'               
598600         DISPLAY '** PARAGRAPH = 7310-CHECK-PO-ON-TPURCHS '               
598700         DISPLAY '*PURCHS-PO-NUMBER = ' IMRCPO-PO-NBR                     
598800         DISPLAY '*PURCHS-STATUS-CDE= ' PURCHS-STATUS-CDE                 
598900         DISPLAY '****************************************'               
599000         PERFORM 9100-SQL-ABEND                                           
599100     END-IF.                                                              
599200                                                                          
599300 EJECT                                                                    
599400                                                                          
599500******************************************************************        
599600* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *        
599700******************************************************************        
599800*7315-SELECT-TPURITM-FOR-PO.                                              
599900                                                                          
600000*    PERFORM                                                              
600100*        WITH TEST AFTER                                                  
600200*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
600300*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
600400*                SQLCODE = ZERO                     OR                    
600500*                SQLCODE = +100                     OR                    
600600*                SQLCODE = -811                                           
600700*                                                                         
600800*        EXEC SQL                                                         
600900*            SELECT C.VS_NBR                                              
601000*              INTO :XLT00004-VS-NBR                                      
601100*              FROM TPURITM      A                                        
601200*                 , XLT_SKU      B                                        
601300*                 , XLT_VND_STYL C                                        
601400*             WHERE A.PO_NBR         = :PURITM-PO-NBR                     
601500*               AND A.VER_STATUS_CDE = 'A'                                
601600*               AND A.STATUS_CDE     IN ('AC', 'AP', 'RV')                
601700*               AND A.ITM_NBR        = B.ITM_NBR                          
601800*               AND B.STYL_ID        = C.STYL_ID                          
601900*               AND C.VS_NBR         = :TR025-LOGVS-VS-NBR                
602000*        END-EXEC                                                         
602100*                                                                         
602200*        EVALUATE TRUE                                                    
602300*            WHEN SQLCODE = +0                                            
602400*            WHEN SQLCODE = -811                                          
602500*                SET PS-VS-ON-TPURITM        TO TRUE                      
602600*            WHEN SQLCODE = +100                                          
602700*                SET PS-VS-ON-TPURITM-NO     TO TRUE                      
602800*            WHEN SQLWARN0 NOT EQUAL SPACE                                
602900*            WHEN SQLCODE NOT EQUAL ZERO                                  
603000*                DISPLAY '**************************************'         
603100*                DISPLAY '** ABEND                            **'         
603200*                DISPLAY '** PROGRAM = TRKUP225               **'         
603300*                DISPLAY '** PARAGRAPH = 7315-SELECT-TPURITM  **'         
603400*                DISPLAY '** SELECT FROM TPURITM              **'         
603500*                DISPLAY '** PO NUMBER   = ' TR025-LOGVS-PO-NBR           
603600*                DISPLAY '** VS NUMBER   = ' TR025-LOGVS-VS-NBR           
603700*                DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE            
603800*                DISPLAY '**************************************'         
603900*                PERFORM 9100-SQL-ABEND                                   
604000*        END-EVALUATE                                                     
604100*    END-PERFORM.                                                         
604200*                                                                         
604300*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
604400*        (SQLCODE NOT = ZERO    AND                                       
604500*            SQLCODE NOT = +100 AND                                       
604600*            SQLCODE NOT = -811)                                          
604700*        DISPLAY '****************************************'               
604800*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
604900*        DISPLAY '** SELECT FROM TPURITM                **'               
605000*        DISPLAY '** PARAGRAPH = 7315-SELECT-TPURITM    **'               
605100*        DISPLAY '** PO NUMBER   = ' TR025-LOGVS-PO-NBR                   
605200*        DISPLAY '** VS NUMBER   = ' TR025-LOGVS-VS-NBR                   
605300*        DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE                    
605400*        DISPLAY '****************************************'               
605500*        PERFORM 9100-SQL-ABEND                                           
605600*    END-IF.                                                              
605700                                                                          
605800 EJECT                                                                    
605900                                                                          
606000******************************************************************        
606100* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *        
606200* CHECK IF UPC IS ON MULTIPLE LINES ON THE MAINFRAME.            *        
606300******************************************************************        
606400*7325-SELECT-TPURITM-MULT-UPC.                                            
606500                                                                          
606600*    PERFORM                                                              
606700*        WITH TEST AFTER                                                  
606800*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
606900*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
607000*                SQLCODE = ZERO                     OR                    
607100*                SQLCODE = +100                     OR                    
607200*                SQLCODE = -811                                           
607300*                                                                         
607400*        EXEC SQL                                                         
607500*            SELECT A.STATUS_CDE                                          
607600*                  ,A.APP_PO_LNE_NBR                                      
607700*              INTO :PURITM-STATUS-CDE                                    
607800*                  ,:PURITM-APP-PO-LNE-NBR                                
607900*              FROM TPURITM  A                                            
608000*                  ,TUPCSKU  B                                            
608100*             WHERE B.UPC_NBR        = :TUPCSKU-UPC-NBR                   
608200*               AND B.ITEM_NBR       = A.ITM_NBR                          
608300*               AND A.PO_NBR         = :PURITM-PO-NBR                     
608400*               AND A.VER_STATUS_CDE = 'A'                                
608500*               AND A.STATUS_CDE       IN  ('AC', 'AP', 'RV')             
608600*        END-EXEC                                                         
608700*                                                                         
608800*        EVALUATE TRUE                                                    
608900*                                                                         
609000*            WHEN SQLCODE = +0                                            
609100*            WHEN SQLCODE = -811                                          
609200*               SET PS-UPC-ON-TPURITM     TO TRUE                         
609300*                                                                         
609400*            WHEN SQLCODE = +100                                          
609500*               SET PS-UPC-ON-TPURITM-NO  TO TRUE                         
609600*                                                                         
609700*            WHEN SQLWARN0 NOT EQUAL SPACE                                
609800*            WHEN SQLCODE  NOT EQUAL ZERO                                 
609900*                DISPLAY '**************************************'         
610000*                DISPLAY '** ABEND                            **'         
610100*                DISPLAY '** PROGRAM = TRKUP225               **'         
610200*                DISPLAY '** PARAGRAPH = 7325-SELECT-TPURITM  **'         
610300*                DISPLAY '** SELECT FROM TPURITM              **'         
610400*                DISPLAY '** PO NUMBER   = ' TR025-LOGUPC-PO-NBR          
610500*                DISPLAY '** UPC NUMBER  = ' TR025-LOGUPC-UPC-NBR         
610600*                DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE            
610700*                DISPLAY '**************************************'         
610800*                PERFORM 9100-SQL-ABEND                                   
610900*        END-EVALUATE                                                     
611000*    END-PERFORM.                                                         
611100*                                                                         
611200*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
611300*        (SQLCODE NOT = ZERO    AND                                       
611400*            SQLCODE NOT = +100 AND                                       
611500*            SQLCODE NOT = -811)                                          
611600*        DISPLAY '****************************************'               
611700*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
611800*        DISPLAY '** SELECT FROM TPURITM                **'               
611900*        DISPLAY '** PARAGRAPH = 7325-SELECT-TPURITM'                     
612000*        DISPLAY '** PO NUMBER   = ' TR025-LOGUPC-PO-NBR                  
612100*        DISPLAY '** UPC NUMBER  = ' TR025-LOGUPC-UPC-NBR                 
612200*        DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE                    
612300*        DISPLAY '****************************************'               
612400*        PERFORM 9100-SQL-ABEND                                           
612500*    END-IF.                                                              
612600                                                                          
612700 EJECT                                                                    
612800                                                                          
612900******************************************************************        
613000* SELECT A ROW FROM THE PURCHASE ORDER ITEM TABLE  (TPURITM).    *        
613100* CHECK TO SEE IF THE UPC IS VALID (ACTIVE) AND APPROVED, ALSO   *        
613200* IF THE UPC IS ON THE MAINFRAME.                                *        
613300******************************************************************        
613400*7330-SELECT-TPURITM-ACT-UPC.                                             
613500                                                                          
613600*    PERFORM                                                              
613700*        WITH TEST AFTER                                                  
613800*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
613900*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
614000*                SQLCODE = ZERO                     OR                    
614100*                SQLCODE = +100                     OR                    
614200*                SQLCODE = -811                                           
614300*                                                                         
614400*        EXEC SQL                                                         
614500*            SELECT A.STATUS_CDE                                          
614600*                 , A.APP_PO_LNE_NBR                                      
614700*              INTO :PURITM-STATUS-CDE                                    
614800*                 , :PURITM-APP-PO-LNE-NBR                                
614900*              FROM TPURITM  A                                            
615000*                  ,TUPCSKU  B                                            
615100*             WHERE B.UPC_NBR        = :TUPCSKU-UPC-NBR                   
615200*               AND B.ITEM_NBR       = A.ITM_NBR                          
615300*               AND A.PO_NBR         = :PURITM-PO-NBR                     
615400*               AND A.VER_STATUS_CDE = 'A'                                
615500*               AND A.STATUS_CDE    NOT IN ('AC', 'AP', 'RV')             
615600*        END-EXEC                                                         
615700*                                                                         
615800*        EVALUATE TRUE                                                    
615900*            WHEN SQLCODE = +0                                            
616000*            WHEN SQLCODE = -811                                          
616100*            WHEN SQLCODE = +100                                          
616200*                CONTINUE                                                 
616300*            WHEN SQLWARN0 NOT EQUAL SPACE                                
616400*            WHEN SQLCODE NOT EQUAL ZERO                                  
616500*                DISPLAY '**************************************'         
616600*                DISPLAY '** ABEND                            **'         
616700*                DISPLAY '** PROGRAM = TRKUP225               **'         
616800*                DISPLAY '** PARAGRAPH = 7330-SELECT-TPURITM  **'         
616900*                DISPLAY '** SELECT FROM TPURITM              **'         
617000*                DISPLAY '** PO NUMBER   = ' TR025-LOGUPC-PO-NBR          
617100*                DISPLAY '** UPC NUMBER  = ' TR025-LOGUPC-UPC-NBR         
617200*                DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE            
617300*                DISPLAY '**************************************'         
617400*                PERFORM 9100-SQL-ABEND                                   
617500*        END-EVALUATE                                                     
617600*    END-PERFORM.                                                         
617700*                                                                         
617800*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
617900*        (SQLCODE NOT = ZERO    AND                                       
618000*            SQLCODE NOT = +100 AND                                       
618100*            SQLCODE NOT = -811)                                          
618200*        DISPLAY '****************************************'               
618300*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
618400*        DISPLAY '** SELECT FROM TPURITM                **'               
618500*        DISPLAY '** PARAGRAPH = 7330-SELECT-TPURITM    **'               
618600*        DISPLAY '** PO NUMBER   = ' TR025-LOGUPC-PO-NBR                  
618700*        DISPLAY '** UPC NUMBER  = ' TR025-LOGUPC-UPC-NBR                 
618800*        DISPLAY '** STATUS-CODE = ' PURITM-STATUS-CDE                    
618900*        DISPLAY '****************************************'               
619000*        PERFORM 9100-SQL-ABEND                                           
619100*    END-IF.                                                              
619200                                                                          
619300 EJECT                                                                    
619400                                                                          
619500******************************************************************        
619600* SELECT IMPRT FCTRY NAME FROM TENTNME TABLE.                    *        
619700******************************************************************        
619800*7340-GET-IMPRT-FCTRY-NAME.                                               
619900*                                                                         
620000*    INITIALIZE ENTNME-ENT-NAME-DESC.                                     
620100*                                                                         
620200*    PERFORM                                                              
620300*        WITH TEST AFTER                                                  
620400*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
620500*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
620600*                SQLCODE = ZERO                     OR                    
620700*                SQLCODE = +100                                           
620800*                                                                         
620900*        EXEC SQL                                                         
621000*            SELECT ENT_NAME_DESC                                         
621100*            INTO  :ENTNME-ENT-NAME-DESC                                  
621200*            FROM   TENTNME                                               
621300*            WHERE  ENT_ID = :PURCHS-IMPRT-FCTRY-ID                       
621400*            AND    TYPE_CDE = '01'                                       
621500*        END-EXEC                                                         
621600*                                                                         
621700*        EVALUATE TRUE                                                    
621800*            WHEN SQLCODE = ZERO                                          
621900*            WHEN SQLCODE = +100                                          
622000*                CONTINUE                                                 
622100*                                                                         
622200*            WHEN SQLWARN0 NOT EQUAL SPACE                                
622300*            WHEN SQLCODE NOT EQUAL ZERO                                  
622400*                DISPLAY '**************************************'         
622500*                DISPLAY '** ABEND                            **'         
622600*                DISPLAY '** PROGRAM = TRKUP225               **'         
622700*              DISPLAY '** PARAGRAPH = 7340-GET-IMPRT-FCTRY-NAME'         
622800*                DISPLAY '** SELECT FROM TENTNME              **'         
622900*                DISPLAY '**************************************'         
623000*                PERFORM 9100-SQL-ABEND                                   
623100*        END-EVALUATE                                                     
623200*    END-PERFORM.                                                         
623300                                                                          
623400*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
623500*        (SQLCODE NOT = ZERO AND                                          
623600*            SQLCODE NOT = +100)                                          
623700*        DISPLAY '****************************************'               
623800*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
623900*        DISPLAY '** SELECT FROM TENTNME                **'               
624000*        DISPLAY '** PARAGRAPH = 7340-GET-IMPRT-FCTRY-NAME'               
624100*        DISPLAY '****************************************'               
624200*        PERFORM 9100-SQL-ABEND                                           
624300*    END-IF.                                                              
624400                                                                          
624500 EJECT                                                                    
624600                                                                          
624700******************************************************************        
624800* SELECT IMPRT VENDOR NAME FROM TENTNME TABLE.                   *        
624900******************************************************************        
625000*7345-GET-IMPRT-VEND-NAME.                                                
625100                                                                          
625200*    INITIALIZE ENTNME-ENT-NAME-DESC.                                     
625300*                                                                         
625400*    PERFORM                                                              
625500*        WITH TEST AFTER                                                  
625600*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
625700*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
625800*                SQLCODE = ZERO                     OR                    
625900*                SQLCODE = +100                                           
626000*                                                                         
626100*        EXEC SQL                                                         
626200*            SELECT ENT_NAME_DESC                                         
626300*            INTO  :ENTNME-ENT-NAME-DESC                                  
626400*            FROM   TENTNME                                               
626500*            WHERE  ENT_ID = :PURCHS-IMPRT-VND-ID                         
626600*            AND    TYPE_CDE = '01'                                       
626700*        END-EXEC                                                         
626800*                                                                         
626900*        EVALUATE TRUE                                                    
627000*            WHEN SQLCODE = ZERO                                          
627100*            WHEN SQLCODE = +100                                          
627200*                CONTINUE                                                 
627300*                                                                         
627400*            WHEN SQLWARN0 NOT EQUAL SPACE                                
627500*            WHEN SQLCODE NOT EQUAL ZERO                                  
627600*                DISPLAY '**************************************'         
627700*                DISPLAY '** ABEND                            **'         
627800*                DISPLAY '** PROGRAM = TRKUP225               **'         
627900*              DISPLAY '** PARAGRAPH = 7345-GET-IMPRT-VEND-NAME '         
628000*                DISPLAY '** SELECT FROM TENTNME              **'         
628100*                DISPLAY '**************************************'         
628200*                PERFORM 9100-SQL-ABEND                                   
628300*        END-EVALUATE                                                     
628400*    END-PERFORM.                                                         
628500                                                                          
628600*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
628700*        (SQLCODE NOT = ZERO AND                                          
628800*            SQLCODE NOT = +100)                                          
628900*        DISPLAY '****************************************'               
629000*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
629100*        DISPLAY '** SELECT FROM TENTNME                **'               
629200*        DISPLAY '** PARAGRAPH = 7345-GET-IMPRT-VEND-NAME '               
629300*        DISPLAY '****************************************'               
629400*        PERFORM 9100-SQL-ABEND                                           
629500*    END-IF.                                                              
629600                                                                          
629700 EJECT                                                                    
629800                                                                          
629900******************************************************************        
630000* OPEN THE VENDOR STYLE / UPC CURSOR.                            *        
630100******************************************************************        
630200*7350-OPEN-RCVS-UPC-CURSOR.                                               
630300*                                                                         
630400*    EXEC SQL                                                             
630500*         OPEN RCVS_UPC_CUR                                               
630600*    END-EXEC.                                                            
630700*                                                                         
630800*    EVALUATE TRUE                                                        
630900*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
631000*        WHEN SQLCODE NOT EQUAL ZERO                                      
631100*            DISPLAY '** ABEND **'                                        
631200*            DISPLAY '** PROGRAM = TRKUP225 **'                           
631300*            DISPLAY '** PARAGRAPH = 7350-OPEN-RCVS-UPC-CURSOR**'         
631400*            PERFORM 9100-SQL-ABEND                                       
631500*    END-EVALUATE.                                                        
631600                                                                          
631700******************************************************************        
631800* CLOSE THE VENDOR STYLE / UPC CURSOR.                           *        
631900******************************************************************        
632000*7355-CLOSE-RCVS-UPC-CURSOR.                                              
632100*                                                                         
632200*    EXEC SQL                                                             
632300*        CLOSE RCVS_UPC_CUR                                               
632400*    END-EXEC.                                                            
632500*                                                                         
632600*    EVALUATE TRUE                                                        
632700*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
632800*        WHEN SQLCODE NOT EQUAL ZERO                                      
632900*            DISPLAY '** ABEND **'                                        
633000*            DISPLAY '** PROGRAM = TRKUP225 **'                           
633100*            DISPLAY '** PARAGRAPH = 7355-CLOSE-RCVS-UPC-CURSOR**'        
633200*            PERFORM 9100-SQL-ABEND                                       
633300*    END-EVALUATE.                                                        
633400                                                                          
633500******************************************************************        
633600* FETCH THE VENDOR STYLE / UPC CURSOR.                           *        
633700******************************************************************        
633800*7360-FETCH-RCVS-UPC-CURSOR.                                              
633900*                                                                         
634000*    EXEC SQL                                                             
634100*         FETCH RCVS_UPC_CUR                                              
634200*             INTO :PV-UPC-CURSOR-VS-NBR,                                 
634300*                  :PV-UPC-CURSOR-UPC-NBR                                 
634400*    END-EXEC.                                                            
634500*                                                                         
634600*    EVALUATE TRUE                                                        
634700*        WHEN SQLCODE = ZERO                                              
634800*             SET PS-EOC-RCVS-UPC-CURSOR-NO    TO TRUE                    
634900*                                                                         
635000*        WHEN SQLCODE = +100                                              
635100*             SET PS-EOC-RCVS-UPC-CURSOR       TO TRUE                    
635200*                                                                         
635300*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
635400*        WHEN SQLCODE NOT EQUAL ZERO                                      
635500*            DISPLAY '** ABEND **'                                        
635600*            DISPLAY '** PROGRAM = TRKUP225 **'                           
635700*            DISPLAY '** PARAGRAPH = 7360-FETCH-RCVS-UPC-CURSOR**'        
635800*            PERFORM 9100-SQL-ABEND                                       
635900*    END-EVALUATE.                                                        
636000                                                                          
636100 EJECT                                                                    
636200                                                                          
636300******************************************************************        
636400* OPEN THE UPC CURSOR.                                           *        
636500******************************************************************        
636600*7365-OPEN-UPC-CURSOR.                                                    
636700*                                                                         
636800*    EXEC SQL                                                             
636900*         OPEN UPC_CUR                                                    
637000*    END-EXEC.                                                            
637100*                                                                         
637200*    EVALUATE TRUE                                                        
637300*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
637400*        WHEN SQLCODE NOT EQUAL ZERO                                      
637500*            DISPLAY '** ABEND **'                                        
637600*            DISPLAY '** PROGRAM = TRKUP225 **'                           
637700*            DISPLAY '** PARAGRAPH = 7365-OPEN-UPC-CURSOR**'              
637800*            PERFORM 9100-SQL-ABEND                                       
637900*    END-EVALUATE.                                                        
638000                                                                          
638100******************************************************************        
638200* CLOSE THE UPC CUROSR.                                          *        
638300******************************************************************        
638400*7370-CLOSE-UPC-CURSOR.                                                   
638500*                                                                         
638600*    EXEC SQL                                                             
638700*        CLOSE UPC_CUR                                                    
638800*    END-EXEC.                                                            
638900*                                                                         
639000*    EVALUATE TRUE                                                        
639100*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
639200*        WHEN SQLCODE NOT EQUAL ZERO                                      
639300*            DISPLAY '** ABEND **'                                        
639400*            DISPLAY '** PROGRAM = TRKUP225 **'                           
639500*            DISPLAY '** PARAGRAPH = 7370-CLOSE-UPC-CURSOR**'             
639600*            PERFORM 9100-SQL-ABEND                                       
639700*    END-EVALUATE.                                                        
639800                                                                          
639900******************************************************************        
640000* FETCH THE UPC CURSOR.                                          *        
640100******************************************************************        
640200*7375-FETCH-UPC-CURSOR.                                                   
640300*                                                                         
640400*    EXEC SQL                                                             
640500*         FETCH UPC_CUR                                                   
640600*             INTO :IMRCUP-PO-NBR,                                        
640700*                  :IMRCUP-PO-RCVD-SEQ-NBR,                               
640800*                  :IMRCUP-VS-NBR,                                        
640900*                  :IMRCUP-UPC-NBR,                                       
641000*                  :IMRCUP-UPC-CART-CNT,                                  
641100*                  :IMRCUP-UPC-CBMT-QTY,                                  
641200*                  :IMRCUP-UPC-WT-KGRM-QTY,                               
641300*                  :IMRCUP-UPC-UNT-QTY,                                   
641400*                  :IMRCUP-CRE-BY-USR-ID,                                 
641500*                  :IMRCUP-CRE-TMST,                                      
641600*                  :IMRCUP-LAST-UPD-BY-USR-ID,                            
641700*                  :IMRCUP-LAST-UPD-TMST                                  
641800*    END-EXEC.                                                            
641900*                                                                         
642000*    EVALUATE TRUE                                                        
642100*        WHEN SQLCODE = ZERO                                              
642200*             SET PS-EOC-UPC-CURSOR-NO    TO TRUE                         
642300*                                                                         
642400*        WHEN SQLCODE = +100                                              
642500*             SET PS-EOC-UPC-CURSOR       TO TRUE                         
642600*                                                                         
642700*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
642800*        WHEN SQLCODE NOT EQUAL ZERO                                      
642900*            DISPLAY '** ABEND **'                                        
643000*            DISPLAY '** PROGRAM = TRKUP225 **'                           
643100*            DISPLAY '** PARAGRAPH = 7375-FETCH-UPC-CURSOR**'             
643200*            PERFORM 9100-SQL-ABEND                                       
643300*    END-EVALUATE.                                                        
643400                                                                          
643500 EJECT                                                                    
643600                                                                          
643700******************************************************************        
643800* OPEN THE UPC CURSOR                                            *        
643900******************************************************************        
644000*7400-OPEN-RCUPC-CURSOR.                                                  
644100*                                                                         
644200*    EXEC SQL                                                             
644300*         OPEN RCUPC_CSR                                                  
644400*    END-EXEC.                                                            
644500*                                                                         
644600*    EVALUATE TRUE                                                        
644700*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
644800*        WHEN SQLCODE NOT EQUAL ZERO                                      
644900*            DISPLAY '** ABEND **'                                        
645000*            DISPLAY '** PROGRAM = TRKUP225 **'                           
645100*            DISPLAY '** PARAGRAPH = 7400-OPEN-RCUPC-CURSOR **'           
645200*            DISPLAY '*PO NBR           = ' TR025-LOG-PO-NBR              
645300*            DISPLAY '*PO RCVD SEQ NBR = ' TR025-LOG-SEQ-NBR              
645400*            DISPLAY '*UPC NBR          = ' TR025-LOGUPC-UPC-NBR          
645500*            PERFORM 9100-SQL-ABEND                                       
645600*    END-EVALUATE.                                                        
645700                                                                          
645800 EJECT                                                                    
645900                                                                          
646000******************************************************************        
646100* DELETE ALL OF THE UPC'S FOR EACH VENDOR STYLE                  *        
646200******************************************************************        
646300*7410-PROCESS-RCUPC-DELETE.                                               
646400                                                                          
646500*    PERFORM 7415-FETCH-RCUPC-CURSOR                                      
646600*       IF PS-EOC-RCUPC-CURSOR                                            
646700*          PERFORM 7420-CLOSE-RCUPC-CURSOR                                
646800*       ELSE                                                              
646900*          PERFORM 7430-MOVES-AUDIT-TAURCUP                               
647000*          SET PS-GOOD-RCUPC-DELETE-NO  TO TRUE                           
647100*          PERFORM 7435-DELETE-TIMRCUP                                    
647200*             IF PS-GOOD-RCUPC-DELETE                                     
647300*                PERFORM 7445-INSERT-TAURCUP                              
647400*       END-IF.                                                           
647500                                                                          
647600 EJECT                                                                    
647700                                                                          
647800******************************************************************        
647900* CURSOR FOR TIMRCUP       RETRIEVE MULTIPLE UPC ROWS            *        
648000******************************************************************        
648100*7415-FETCH-RCUPC-CURSOR.                                                 
648200                                                                          
648300*    EXEC SQL                                                             
648400*         FETCH RCUPC_CSR                                                 
648500*             INTO :IMRCUP-PO-NBR,                                        
648600*                  :IMRCUP-PO-RCVD-SEQ-NBR,                               
648700*                  :IMRCUP-VS-NBR,                                        
648800*                  :IMRCUP-UPC-NBR,                                       
648900*                  :IMRCUP-UPC-CART-CNT,                                  
649000*                  :IMRCUP-UPC-CBMT-QTY,                                  
649100*                  :IMRCUP-UPC-WT-KGRM-QTY,                               
649200*                  :IMRCUP-UPC-UNT-QTY,                                   
649300*                  :IMRCUP-CRE-BY-USR-ID,                                 
649400*                  :IMRCUP-CRE-TMST,                                      
649500*                  :IMRCUP-LAST-UPD-BY-USR-ID,                            
649600*                  :IMRCUP-LAST-UPD-TMST                                  
649700*    END-EXEC.                                                            
649800                                                                          
649900*    EVALUATE TRUE                                                        
650000*        WHEN SQLCODE = ZERO                                              
650100*             CONTINUE                                                    
650200*        WHEN SQLCODE = +100                                              
650300*             SET PS-EOC-RCUPC-CURSOR          TO TRUE                    
650400*                                                                         
650500*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
650600*        WHEN SQLCODE NOT EQUAL ZERO                                      
650700*            DISPLAY '** ABEND **'                                        
650800*            DISPLAY '** PROGRAM = TRKUP225 **'                           
650900*            DISPLAY '** PARAGRAPH = 7415-FETCH-RCUPC-CURSOR**'           
651000*            DISPLAY '*PO NBR           = ' TR025-LOG-PO-NBR              
651100*            DISPLAY '*PO RCVD SEQ NBR = ' TR025-LOG-SEQ-NBR              
651200*            DISPLAY '*UPC NBR          = ' TR025-LOGUPC-UPC-NBR          
651300*            PERFORM 9100-SQL-ABEND                                       
651400*    END-EVALUATE.                                                        
651500                                                                          
651600 EJECT                                                                    
651700                                                                          
651800******************************************************************        
651900* CLOSE THE TIMRCUP UPC CURSOR.                                  *        
652000******************************************************************        
652100*7420-CLOSE-RCUPC-CURSOR.                                                 
652200                                                                          
652300*    EXEC SQL                                                             
652400*        CLOSE RCUPC_CSR                                                  
652500*    END-EXEC.                                                            
652600*                                                                         
652700*    EVALUATE TRUE                                                        
652800*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
652900*        WHEN SQLCODE NOT EQUAL ZERO                                      
653000*            DISPLAY '** ABEND **'                                        
653100*            DISPLAY '** PROGRAM = TRKUP225 **'                           
653200*            DISPLAY '** PARAGRAPH = 7420-CLOSE-RCUPC-CURSOR**'           
653300*            DISPLAY '*PO NBR           = ' TR025-LOG-PO-NBR              
653400*            DISPLAY '*PO RCVD SEQ NBR = ' TR025-LOG-SEQ-NBR              
653500*            DISPLAY '*UPC NBR          = ' TR025-LOGUPC-UPC-NBR          
653600*            PERFORM 9100-SQL-ABEND                                       
653700*    END-EVALUATE.                                                        
653800                                                                          
653900 EJECT                                                                    
654000                                                                          
654100                                                                          
654200******************************************************************        
654300* SETUP DCLGEN FIELDS FOR AUDIT PRIOR TO DELETING A ROW          *        
654400******************************************************************        
654500*7430-MOVES-AUDIT-TAURCUP.                                                
654600                                                                          
654700*    INITIALIZE DCLTAURCUP.                                               
654800*                                                                         
654900*    MOVE IMRCUP-PO-NBR              TO AURCUP-PO-NBR.                    
655000*    MOVE IMRCUP-PO-RCVD-SEQ-NBR     TO AURCUP-PO-RCVD-SEQ-NBR.           
655100*    MOVE IMRCUP-VS-NBR              TO AURCUP-VS-NBR.                    
655200*    MOVE IMRCUP-UPC-NBR             TO AURCUP-UPC-NBR.                   
655300*    MOVE IMRCUP-UPC-CART-CNT        TO AURCUP-UPC-CART-CNT.              
655400*    MOVE IMRCUP-UPC-CBMT-QTY        TO AURCUP-UPC-CBMT-QTY.              
655500*    MOVE IMRCUP-UPC-WT-KGRM-QTY     TO AURCUP-UPC-WT-KGRM-QTY.           
655600*    MOVE IMRCUP-UPC-UNT-QTY         TO AURCUP-UPC-UNT-QTY.               
655700*    MOVE IMRCUP-LAST-UPD-BY-USR-ID  TO AURCUP-LAST-UPD-BY-USR-ID         
655800*    MOVE IMRCUP-LAST-UPD-TMST       TO AURCUP-LAST-UPD-TMST.             
655900*                                                                         
656000*    IF TR025-ERD-TRN-TYP = PC-D                                          
656100*        MOVE PC-D               TO AURCUP-AUD-FUNC-CDE                   
656200*    ELSE                                                                 
656300*        MOVE PC-U               TO AURCUP-AUD-FUNC-CDE                   
656400*    END-IF.                                                              
656500*                                                                         
656600*    PERFORM 7999-SET-CURRENT-TMST.                                       
656700*    MOVE PV-CURRENT-TMST            TO AURCUP-AUD-TMST.                  
656800                                                                          
656900 EJECT                                                                    
657000                                                                          
657100******************************************************************        
657200* DELETE A ROW FROM THE RECEIVING UPC TABLE  (TIMRCUP).          *        
657300******************************************************************        
657400*7435-DELETE-TIMRCUP.                                                     
657500                                                                          
657600*    PERFORM                                                              
657700*        WITH TEST AFTER                                                  
657800*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
657900*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
658000*                SQLCODE = ZERO                                           
658100*                                                                         
658200*        EXEC SQL                                                         
658300*             DELETE                                                      
658400*               FROM TIMRCUP                                              
658500*              WHERE CURRENT OF RCUPC_CSR                                 
658600*        END-EXEC                                                         
658700*                                                                         
658800*        EVALUATE TRUE                                                    
658900*            WHEN SQLCODE = ZERO                                          
659000*                ADD +1 TO PA-TOT-RCUPC-DELETES                           
659100*                ADD +1 TO PA-TOT-RECS-DELETED                            
659200*                SET PS-GOOD-RCUPC-DELETE   TO TRUE                       
659300*            WHEN SQLCODE = +100                                          
659400*                CONTINUE                                                 
659500*            WHEN SQLWARN0 NOT EQUAL SPACE                                
659600*            WHEN SQLCODE NOT EQUAL ZERO                                  
659700*                DISPLAY '**************************************'         
659800*                DISPLAY '** ABEND                            **'         
659900*                DISPLAY '** PROGRAM = TRKUP225               **'         
660000*                DISPLAY '** PARAGRAPH = 7435-DELETE-TIMRCUP  **'         
660100*                DISPLAY '** DELETE TIMRCUP                   **'         
660200*                DISPLAY '** PO NBR         = ' TR025-LOG-PO-NBR          
660300*                DISPLAY '** PO EXTL REF NBR= '                           
660400*                                       TR025-LOG-EXTL-REF-NBR            
660500*                DISPLAY '** PO RCVD DELY DTE= '                          
660600*                                      TR025-LOG-PO-RCVD-DELY-DTE         
660700*                DISPLAY '**************************************'         
660800*                PERFORM 9100-SQL-ABEND                                   
660900*        END-EVALUATE                                                     
661000*    END-PERFORM.                                                         
661100*                                                                         
661200*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
661300*        (SQLCODE NOT = ZERO AND                                          
661400*         SQLCODE NOT = +100)                                             
661500*        DISPLAY '****************************************'               
661600*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
661700*        DISPLAY '** DELETE FROM TIMRCUP                **'               
661800*        DISPLAY '** PARAGRAPH = 7435-DELETE-TIMRCVS    **'               
661900*        DISPLAY '** PO NBR         = ' TR025-ERD-PO-NBR                  
662000*        DISPLAY '** EXTL REF NBR   = ' TR025-ERD-EXTL-REF-NBR            
662100*        DISPLAY '** PO RCVD DELY DTE= '                                  
662200*                                 TR025-LOG-PO-RCVD-DELY-DTE              
662300*        DISPLAY '****************************************'               
662400*        PERFORM 9100-SQL-ABEND                                           
662500*    END-IF.                                                              
662600                                                                          
662700 EJECT                                                                    
662800                                                                          
662900******************************************************************        
663000* DELETE A ROW FROM THE RECEIVING UPC TABLE (TIMRCUP) FOR CHANGE *        
663100* TRANSACTIONS.                                                  *        
663200******************************************************************        
663300*7440-DELETE-TIMRCUP-CHG.                                                 
663400                                                                          
663500*    PERFORM                                                              
663608*        WITH TEST AFTER                                                  
663700*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
663800*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
663900*                SQLCODE = ZERO                                           
664000*                                                                         
664100*        EXEC SQL                                                         
664200*             DELETE                                                      
664300*               FROM TIMRCUP                                              
664400*              WHERE PO_NBR         =  :IMRCPO-PO-NBR                     
664500*                AND PO_RCVD_SEQ_NBR = :IMRCPO-PO-RCVD-SEQ-NBR            
664600*                AND VS_NBR         =  :IMRCUP-VS-NBR                     
664700*                AND UPC_NBR        =  :IMRCUP-UPC-NBR                    
664800*        END-EXEC                                                         
664900*                                                                         
665000*        EVALUATE TRUE                                                    
665100*            WHEN SQLCODE = ZERO                                          
665200*                ADD +1 TO PA-TOT-RCUPC-DELETES                           
665300*                ADD +1 TO PA-TOT-RECS-DELETED                            
665400*            WHEN SQLCODE = +100                                          
665500*                CONTINUE                                                 
665600*            WHEN SQLWARN0 NOT EQUAL SPACE                                
665700*            WHEN SQLCODE NOT EQUAL ZERO                                  
665800*                DISPLAY '**************************************'         
665900*                DISPLAY '** ABEND                            **'         
666000*                DISPLAY '** PROGRAM = TRKUP225               **'         
666100*                DISPLAY '** PARAGRAPH =                      **'         
666200*                DISPLAY '**        7440-DELETE-TIMRCUP-CHG   **'         
666300*                DISPLAY '** DELETE TIMRCUP                   **'         
666400*                DISPLAY '** PO NBR       =' IMRCPO-PO-NBR                
666500*              DISPLAY '** RCVD SEQ NBR  =' IMRCPO-PO-RCVD-SEQ-NBR        
666600*                DISPLAY '** VENDOR STYLE =' IMRCUP-VS-NBR                
666700*                DISPLAY '** UPC NUMBER   =' IMRCUP-UPC-NBR               
666800*                DISPLAY '**************************************'         
666900*                PERFORM 9100-SQL-ABEND                                   
667000*        END-EVALUATE                                                     
667100*    END-PERFORM.                                                         
667200*                                                                         
667300*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
667400*        (SQLCODE NOT = ZERO AND                                          
667500*         SQLCODE NOT = +100)                                             
667600*        DISPLAY '****************************************'               
667700*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
667800*        DISPLAY '** DELETE FROM TIMRCUP                **'               
667900*        DISPLAY '** PARAGRAPH = 7440-DELETE-TIMRCUP-CHG**'               
668000*        DISPLAY '** PO NBR       = ' IMRCPO-PO-NBR                       
668100*        DISPLAY '** RCVD SEQ NBR  = ' IMRCPO-PO-RCVD-SEQ-NBR             
668200*        DISPLAY '** VENDOR STYLE = ' IMRCUP-VS-NBR                       
668300*        DISPLAY '** UPC NUMBER   = ' IMRCUP-UPC-NBR                      
668400*        DISPLAY '****************************************'               
668500*        PERFORM 9100-SQL-ABEND                                           
668600*    END-IF.                                                              
668700                                                                          
668800 EJECT                                                                    
668900                                                                          
669000******************************************************************        
669100* AUDIT THE UPC ROW AFTER A SUCCESSFUL DELETE                    *        
669200******************************************************************        
669300*7445-INSERT-TAURCUP.                                                     
669400                                                                          
669500*    PERFORM                                                              
669600*        WITH TEST AFTER                                                  
669700*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
669800*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
669900*                SQLCODE = ZERO                                           
670000*                                                                         
670100*        EXEC SQL                                                         
670200*            INSERT INTO TAURCUP                                          
670300*                  (PO_NBR,                                               
670400*                   PO_RCVD_SEQ_NBR,                                      
670500*                   VS_NBR,                                               
670600*                   UPC_NBR,                                              
670700*                   UPC_CART_CNT,                                         
670800*                   UPC_CBMT_QTY,                                         
670900*                   UPC_WT_KGRM_QTY,                                      
671000*                   UPC_UNT_QTY,                                          
671100*                   LAST_UPD_BY_USR_ID,                                   
671200*                   LAST_UPD_TMST,                                        
671300*                   AUD_FUNC_CDE,                                         
671400*                   AUD_TMST)                                             
671500*            VALUES                                                       
671600*                 (:AURCUP-PO-NBR,                                        
671700*                  :AURCUP-PO-RCVD-SEQ-NBR,                               
671800*                  :AURCUP-VS-NBR,                                        
671900*                  :AURCUP-UPC-NBR,                                       
672000*                  :AURCUP-UPC-CART-CNT,                                  
672100*                  :AURCUP-UPC-CBMT-QTY,                                  
672200*                  :AURCUP-UPC-WT-KGRM-QTY,                               
672300*                  :AURCUP-UPC-UNT-QTY,                                   
672400*                  :AURCUP-LAST-UPD-BY-USR-ID,                            
672500*                  :AURCUP-LAST-UPD-TMST,                                 
672600*                  :AURCUP-AUD-FUNC-CDE,                                  
672700*                   CURRENT TIMESTAMP)                                    
672800*        END-EXEC                                                         
672900*                                                                         
673000*        EVALUATE TRUE                                                    
673100*            WHEN SQLCODE = ZERO                                          
673200*                ADD +1 TO PA-TOT-RCUPC-AUDITS                            
673300*                ADD +1 TO PA-TOT-RECS-AUDITED                            
673400*                                                                         
673500*            WHEN SQLCODE = -904                                          
673600*            WHEN SQLCODE = -913                                          
673700*                CONTINUE                                                 
673800*                                                                         
673900*            WHEN SQLWARN0 NOT EQUAL SPACE                                
674000*            WHEN SQLCODE NOT EQUAL ZERO                                  
674100*                DISPLAY '**************************************'         
674200*                DISPLAY '** ABEND                            **'         
674300*                DISPLAY '** PROGRAM = TRKUP225               **'         
674400*                DISPLAY '** PARAGRAPH = 7445-INSERT-TAURCUP  **'         
674500*                DISPLAY '** INSERT INTO TAURCUP              **'         
674600*                DISPLAY '*PO NBR           = ' TR025-LOG-PO-NBR          
674700*            DISPLAY '*PO RCVD SEQ NBR = ' TR025-LOG-SEQ-NBR              
674800*                DISPLAY '*UPC NBR    = ' TR025-LOGUPC-UPC-NBR            
674900*                DISPLAY '**************************************'         
675000*                PERFORM 9100-SQL-ABEND                                   
675100*        END-EVALUATE                                                     
675200*    END-PERFORM.                                                         
675300*                                                                         
675400*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
675500*        (SQLCODE NOT = ZERO AND                                          
675600*         SQLCODE NOT = -803)                                             
675700*        DISPLAY '****************************************'               
675800*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
675900*        DISPLAY '** INSERT TO TAURCUP                  **'               
676000*        DISPLAY '** PARAGRAPH = 7445-INSERT-TAURCUP    **'               
676100*        DISPLAY '*PO NBR           = ' IMRCUP-PO-NBR                     
676200*        DISPLAY '*PO RCVD SEQ NBR = ' IMRCUP-PO-RCVD-SEQ-NBR             
676300*        DISPLAY '*UPC NBR          = ' IMRCUP-UPC-NBR                    
676400*        DISPLAY '****************************************'               
676500*        PERFORM 9100-SQL-ABEND                                           
676600*    END-IF.                                                              
676700                                                                          
676800 EJECT                                                                    
676900                                                                          
677000******************************************************************        
677100* OPEN THE VENDOR STYLE CURSOR                                   *        
677200******************************************************************        
677300*7500-OPEN-RCVS-CURSOR.                                                   
677400                                                                          
677500*    EXEC SQL                                                             
677600*         OPEN RCVS_CSR                                                   
677700*    END-EXEC.                                                            
677800*                                                                         
677900*    EVALUATE TRUE                                                        
678000*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
678100*        WHEN SQLCODE NOT EQUAL ZERO                                      
678200*            DISPLAY '** ABEND **'                                        
678300*            DISPLAY '** PROGRAM = TRKUP225 **'                           
678400*            DISPLAY '** PARAGRAPH = 7500-OPEN-RCVS-CURSOR **'            
678500*            DISPLAY '*PO NBR           = ' TR025-LOG-PO-NBR              
678600*            DISPLAY '*PO RCVD SEQ NBR = ' TR025-LOG-SEQ-NBR              
678700*            DISPLAY '*VS NBR           = ' TR025-LOGVS-VS-NBR            
678800*            PERFORM 9100-SQL-ABEND                                       
678900*    END-EVALUATE.                                                        
679000                                                                          
679100 EJECT                                                                    
679200                                                                          
679300******************************************************************        
679400* DELETE ALL OF THE VENDOR STYLES FOR EACH PO                    *        
679500******************************************************************        
679600*7510-PROCESS-RCVS-DELETE.                                                
679700*                                                                         
679800*    PERFORM 7515-FETCH-RCVS-CURSOR                                       
679900*       IF PS-EOC-RCVS-CURSOR                                             
680000*          PERFORM 7520-CLOSE-RCVS-CURSOR                                 
680100*       ELSE                                                              
680200*             PERFORM 7530-MOVES-AUDIT-TAURCVS                            
680300*             SET PS-GOOD-RCVS-DELETE-NO    TO TRUE                       
680400*             PERFORM 7535-DELETE-TIMRCVS                                 
680500*                IF PS-GOOD-RCVS-DELETE                                   
680600*                   PERFORM 7545-INSERT-TAURCVS                           
680700*                END-IF                                                   
680800*       END-IF.                                                           
680900                                                                          
681000 EJECT                                                                    
681100                                                                          
681200******************************************************************        
681300* CURSOR FOR TIMRCVS       RETRIEVE MULTIPLE VS ROWS             *        
681400******************************************************************        
681500*7515-FETCH-RCVS-CURSOR.                                                  
681600                                                                          
681700*    EXEC SQL                                                             
681800*         FETCH RCVS_CSR                                                  
681900*             INTO :IMRCVS-PO-NBR,                                        
682000*                  :IMRCVS-PO-RCVD-SEQ-NBR,                               
682100*                  :IMRCVS-VS-NBR,                                        
682200*                  :IMRCVS-HTS-ID,                                        
682300*                  :IMRCVS-VS-CART-CNT,                                   
682400*                  :IMRCVS-VS-CBMT-QTY,                                   
682500*                  :IMRCVS-VS-WT-KGRM-QTY,                                
682600*                  :IMRCVS-VS-UNT-QTY,                                    
682700*                  :IMRCVS-QTA-CTG-IND,                                   
682800*                  :IMRCVS-CRE-BY-USR-ID,                                 
682900*                  :IMRCVS-CRE-TMST,                                      
683000*                  :IMRCVS-LAST-UPD-BY-USR-ID,                            
683100*                  :IMRCVS-LAST-UPD-TMST                                  
683200*    END-EXEC.                                                            
683300                                                                          
683400*    EVALUATE TRUE                                                        
683500*        WHEN SQLCODE = ZERO                                              
683600*             CONTINUE                                                    
683700*        WHEN SQLCODE = +100                                              
683800*             SET PS-EOC-RCVS-CURSOR           TO TRUE                    
683900*                                                                         
684000*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
684100*        WHEN SQLCODE NOT EQUAL ZERO                                      
684200*            DISPLAY '** ABEND **'                                        
684300*            DISPLAY '** PROGRAM = TRKUP225 **'                           
684400*            DISPLAY '** PARAGRAPH = 7515-FETCH-RCVS-CURSOR**'            
684500*            DISPLAY '*PO NBR         = ' TR025-LOG-PO-NBR                
684600*            DISPLAY '*PO RCVD SEQ NBR = ' TR025-LOG-SEQ-NBR              
684700*            DISPLAY '*VS NBR         = ' TR025-LOGVS-VS-NBR              
684800*            PERFORM 9100-SQL-ABEND                                       
684900*    END-EVALUATE.                                                        
685000                                                                          
685100 EJECT                                                                    
685200                                                                          
685300******************************************************************        
685400* CLOSE THE TIMRCVS VS CURSOR.                                   *        
685500******************************************************************        
685600*7520-CLOSE-RCVS-CURSOR.                                                  
685700                                                                          
685800*    EXEC SQL                                                             
685900*        CLOSE RCVS_CSR                                                   
686000*    END-EXEC.                                                            
686100                                                                          
686200*    EVALUATE TRUE                                                        
686300*        WHEN SQLWARN0 NOT EQUAL SPACE                                    
686400*        WHEN SQLCODE NOT EQUAL ZERO                                      
686500*            DISPLAY '** ABEND **'                                        
686600*            DISPLAY '** PROGRAM = TRKUP225 **'                           
686700*            DISPLAY '** PARAGRAPH = 7520-CLOSE-RCVS-CURSOR**'            
686800*            DISPLAY '*PO NBR         = ' TR025-LOG-PO-NBR                
686900*            DISPLAY '*PO RCVD SEQ NBR = ' TR025-LOG-SEQ-NBR              
687000*            DISPLAY '*VS NBR         = ' TR025-LOGVS-VS-NBR              
687100*            PERFORM 9100-SQL-ABEND                                       
687200*    END-EVALUATE.                                                        
687300                                                                          
687400 EJECT                                                                    
687500                                                                          
687600                                                                          
687700******************************************************************        
687800* SETUP DCLGEN FIELDS FOR AUDIT PRIOR TO DELETING A ROW          *        
687900******************************************************************        
688000*7530-MOVES-AUDIT-TAURCVS.                                                
688100                                                                          
688200*    INITIALIZE DCLTAURCVS.                                               
688300*                                                                         
688400*    MOVE IMRCVS-PO-NBR              TO AURCVS-PO-NBR.                    
688500*    MOVE IMRCVS-PO-RCVD-SEQ-NBR     TO AURCVS-PO-RCVD-SEQ-NBR.           
688600*    MOVE IMRCVS-VS-NBR              TO AURCVS-VS-NBR.                    
688700*    MOVE IMRCVS-HTS-ID              TO AURCVS-HTS-ID.                    
688800*    MOVE IMRCVS-VS-CART-CNT         TO AURCVS-VS-CART-CNT.               
688900*    MOVE IMRCVS-VS-CBMT-QTY         TO AURCVS-VS-CBMT-QTY.               
689000*    MOVE IMRCVS-VS-WT-KGRM-QTY      TO AURCVS-VS-WT-KGRM-QTY.            
689100*    MOVE IMRCVS-VS-UNT-QTY          TO AURCVS-VS-UNT-QTY.                
689200*    MOVE IMRCVS-QTA-CTG-IND         TO AURCVS-QTA-CTG-IND.               
689300*    MOVE IMRCVS-LAST-UPD-BY-USR-ID  TO AURCVS-LAST-UPD-BY-USR-ID.        
689400*    MOVE IMRCVS-LAST-UPD-TMST       TO AURCVS-LAST-UPD-TMST.             
689500*                                                                         
689600*    IF TR025-ERD-TRN-TYP = PC-D                                          
689700*        MOVE PC-D               TO AURCVS-AUD-FUNC-CDE                   
689800*    ELSE                                                                 
689900*        MOVE PC-U               TO AURCVS-AUD-FUNC-CDE                   
690000*    END-IF.                                                              
690100*                                                                         
690200*    PERFORM 7999-SET-CURRENT-TMST.                                       
690300*    MOVE PV-CURRENT-TMST            TO AURCVS-AUD-TMST.                  
690400                                                                          
690500 EJECT                                                                    
690600                                                                          
690700******************************************************************        
690800* DELETE A ROW FROM THE RECEIVING VS TABLE  (TIMRCVS).           *        
690900******************************************************************        
691000*7535-DELETE-TIMRCVS.                                                     
691100                                                                          
691200*    PERFORM                                                              
691300*        WITH TEST AFTER                                                  
691400*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
691500*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
691600*                SQLCODE = ZERO                                           
691700*                                                                         
691800*        EXEC SQL                                                         
691900*             DELETE                                                      
692000*               FROM TIMRCVS                                              
692100*              WHERE CURRENT OF RCVS_CSR                                  
692200*        END-EXEC                                                         
692300*                                                                         
692400*        EVALUATE TRUE                                                    
692500*            WHEN SQLCODE = ZERO                                          
692600*                ADD +1 TO PA-TOT-RCVS-DELETES                            
692700*                ADD +1 TO PA-TOT-RECS-DELETED                            
692800*                SET PS-GOOD-RCVS-DELETE    TO TRUE                       
692900*            WHEN SQLCODE = +100                                          
693000*                CONTINUE                                                 
693100*            WHEN SQLWARN0 NOT EQUAL SPACE                                
693200*            WHEN SQLCODE NOT EQUAL ZERO                                  
693300*                DISPLAY '**************************************'         
693400*                DISPLAY '** ABEND                            **'         
693500*                DISPLAY '** PROGRAM = TRKUP225               **'         
693600*                DISPLAY '** PARAGRAPH = 7535-DELETE-TIMRCVS  **'         
693700*                DISPLAY '** DELETE TIMRCVS                   **'         
693800*                DISPLAY '** PO NBR         = ' TR025-LOG-PO-NBR          
693900*                DISPLAY '** PO EXTL REF NBR= '                           
694000*                                       TR025-LOG-EXTL-REF-NBR            
694100*                DISPLAY '** PO RCVD DELY DTE= '                          
694200*                                      TR025-LOG-PO-RCVD-DELY-DTE         
694300*                DISPLAY '**************************************'         
694400*                PERFORM 9100-SQL-ABEND                                   
694500*        END-EVALUATE                                                     
694600*    END-PERFORM.                                                         
694700                                                                          
694800*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
694900*        (SQLCODE NOT = ZERO AND                                          
695000*         SQLCODE NOT = +100)                                             
695100*        DISPLAY '****************************************'               
695200*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
695300*        DISPLAY '** DELETE FROM TIMRCVS                **'               
695400*        DISPLAY '** PARAGRAPH = 7535-DELETE-TIMRCVS    **'               
695500*        DISPLAY '** PO NBR         = ' TR025-LOG-PO-NBR                  
695600*        DISPLAY '** EXTL REF NBR   = ' TR025-LOG-EXTL-REF-NBR            
695700*        DISPLAY '** PO RCVD DELY DTE= '                                  
695800*                                 TR025-LOG-PO-RCVD-DELY-DTE              
695900*        DISPLAY '****************************************'               
696000*        PERFORM 9100-SQL-ABEND                                           
696100*    END-IF.                                                              
696200                                                                          
696300 EJECT                                                                    
696400                                                                          
696500******************************************************************        
696600* DELETE A ROW FROM THE RECEIVING VS  TABLE (TIMRCVS) FOR CHANGE *        
696700* TRANSACTIONS.                                                  *        
696800******************************************************************        
696900*7540-DELETE-TIMRCVS-CHG.                                                 
697000                                                                          
697100*    PERFORM                                                              
697200*        WITH TEST AFTER                                                  
697300*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
697400*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
697500*                SQLCODE = ZERO                                           
697600*                                                                         
697700*        EXEC SQL                                                         
697800*             DELETE                                                      
697900*               FROM TIMRCVS                                              
698000*              WHERE PO_NBR         =  :IMRCPO-PO-NBR                     
698100*                AND PO_RCVD_SEQ_NBR = :IMRCPO-PO-RCVD-SEQ-NBR            
698200*                AND VS_NBR         =  :IMRCVS-VS-NBR                     
698300*        END-EXEC                                                         
698400*                                                                         
698500*        EVALUATE TRUE                                                    
698600*            WHEN SQLCODE = ZERO                                          
698700*                ADD +1 TO PA-TOT-RCVS-DELETES                            
698800*                ADD +1 TO PA-TOT-RECS-DELETED                            
698908*            WHEN SQLCODE = +100                                          
699000*                CONTINUE                                                 
699100*            WHEN SQLWARN0 NOT EQUAL SPACE                                
699200*            WHEN SQLCODE NOT EQUAL ZERO                                  
699300*                DISPLAY '**************************************'         
699400*                DISPLAY '** ABEND                            **'         
699500*                DISPLAY '** PROGRAM = TRKUP225               **'         
699600*                DISPLAY '** PARAGRAPH =                      **'         
699700*                DISPLAY '**        7540-DELETE-TIMRCVS-CHG   **'         
699800*                DISPLAY '** DELETE TIMRCVS                   **'         
699900*                DISPLAY '** PO NUMBER   = ' IMRCVS-PO-NBR                
700000*                DISPLAY '** RCVD SEQ NBR = '                             
700100*                                          IMRCVS-PO-RCVD-SEQ-NBR         
700200*                DISPLAY '** VENDOR STYLE = ' IMRCVS-VS-NBR               
700300*                DISPLAY '**************************************'         
700400*                PERFORM 9100-SQL-ABEND                                   
700500*        END-EVALUATE                                                     
700600*    END-PERFORM.                                                         
700700                                                                          
700800*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
700900*        (SQLCODE NOT = ZERO AND                                          
701000*         SQLCODE NOT = +100)                                             
701100*        DISPLAY '****************************************'               
701200*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
701300*        DISPLAY '** DELETE FROM TIMRCVS                **'               
701400*        DISPLAY '** PARAGRAPH = 7540-DELETE-TIMRCVS-CHG**'               
701500*        DISPLAY '** PO NUMBER    = ' IMRCVS-PO-NBR                       
701600*        DISPLAY '** RCVD SEQ NBR  = ' IMRCVS-PO-RCVD-SEQ-NBR             
701700*        DISPLAY '** VENDOR STYLE = ' IMRCVS-VS-NBR                       
701800*        DISPLAY '****************************************'               
701900*        PERFORM 9100-SQL-ABEND                                           
702000*    END-IF.                                                              
702100                                                                          
702200 EJECT                                                                    
702300                                                                          
702400******************************************************************        
702500* AUDIT THE VS ROW AFTER A SUCCESSFUL DELETE                     *        
702600******************************************************************        
702700*7545-INSERT-TAURCVS.                                                     
702800                                                                          
702900*    PERFORM                                                              
703000*        WITH TEST AFTER                                                  
703100*        VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
703200*        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
703300*                SQLCODE = ZERO                                           
703400*                                                                         
703500*        EXEC SQL                                                         
703600*            INSERT INTO TAURCVS                                          
703700*                  (PO_NBR,                                               
703800*                   PO_RCVD_SEQ_NBR,                                      
703900*                   VS_NBR,                                               
704000*                   HTS_ID,                                               
704100*                   VS_CART_CNT,                                          
704200*                   VS_CBMT_QTY,                                          
704300*                   VS_WT_KGRM_QTY,                                       
704400*                   VS_UNT_QTY,                                           
704500*                   QTA_CTG_IND,                                          
704600*                   LAST_UPD_BY_USR_ID,                                   
704700*                   LAST_UPD_TMST,                                        
704800*                   AUD_FUNC_CDE,                                         
704900*                   AUD_TMST)                                             
705000*            VALUES                                                       
705100*                 (:AURCVS-PO-NBR,                                        
705200*                  :AURCVS-PO-RCVD-SEQ-NBR,                               
705300*                  :AURCVS-VS-NBR,                                        
705400*                  :AURCVS-HTS-ID,                                        
705500*                  :AURCVS-VS-CART-CNT,                                   
705600*                  :AURCVS-VS-CBMT-QTY,                                   
705700*                  :AURCVS-VS-WT-KGRM-QTY,                                
705800*                  :AURCVS-VS-UNT-QTY,                                    
705900*                  :AURCVS-QTA-CTG-IND,                                   
706000*                  :AURCVS-LAST-UPD-BY-USR-ID,                            
706100*                  :AURCVS-LAST-UPD-TMST,                                 
706200*                  :AURCVS-AUD-FUNC-CDE,                                  
706300*                   CURRENT TIMESTAMP)                                    
706400*        END-EXEC                                                         
706500*                                                                         
706600*        EVALUATE TRUE                                                    
706700*            WHEN SQLCODE = ZERO                                          
706800*                ADD +1 TO PA-TOT-RCVS-AUDITS                             
706900*                ADD +1 TO PA-TOT-RECS-AUDITED                            
707000*                                                                         
707100*            WHEN SQLCODE = -904                                          
707200*            WHEN SQLCODE = -913                                          
707300*                CONTINUE                                                 
707400*                                                                         
707500*            WHEN SQLWARN0 NOT EQUAL SPACE                                
707600*            WHEN SQLCODE NOT EQUAL ZERO                                  
707700*                DISPLAY '**************************************'         
707800*                DISPLAY '** ABEND                            **'         
707900*                DISPLAY '** PROGRAM = TRKUP225               **'         
708000*                DISPLAY '** PARAGRAPH = 7545-INSERT-TAURCVS  **'         
708100*                DISPLAY '** INSERT INTO TAURCVS              **'         
708200*                DISPLAY '*PO NBR           = ' TR025-LOG-PO-NBR          
708300*             DISPLAY '*PO RCVD SEQ NBR = ' TR025-LOG-SEQ-NBR             
708400*                DISPLAY '*VS          = ' TR025-LOGVS-VS-NBR             
708500*                DISPLAY '**************************************'         
708600*                PERFORM 9100-SQL-ABEND                                   
708700*        END-EVALUATE                                                     
708800*    END-PERFORM.                                                         
708900*                                                                         
709000*    IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
709100*        (SQLCODE NOT = ZERO AND                                          
709200*         SQLCODE NOT = -803)                                             
709300*        DISPLAY '****************************************'               
709400*        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
709500*        DISPLAY '** INSERT TO TAURCVS                  **'               
709600*        DISPLAY '** PARAGRAPH = 7545-INSERT-TAURCUP    **'               
709700*        DISPLAY '*PO NBR           = ' IMRCUP-PO-NBR                     
709800*        DISPLAY '*PO RCVD SEQ NBR = ' IMRCUP-PO-RCVD-SEQ-NBR             
709900*        DISPLAY '*UPC NBR          = ' IMRCUP-UPC-NBR                    
710000*        DISPLAY '****************************************'               
710100*        PERFORM 9100-SQL-ABEND                                           
710200*    END-IF.                                                              
710300                                                                          
710400 EJECT                                                                    
710500                                                                          
710600******************************************************************        
710700* DELETE THE PO NBR AFTER DELETING VENDOR STYLES AND UPC'S       *        
710800******************************************************************        
710900 7610-PROCESS-RCPO-DELETE.                                                
711000                                                                          
711100     PERFORM 7630-MOVES-AUDIT-TAURCPO.                                    
711200     SET PS-GOOD-RCPO-DELETE-NO  TO TRUE.                                 
711300     PERFORM 7635-DELETE-TIMRCPO.                                         
711400     IF PS-GOOD-RCPO-DELETE                                               
711500        INITIALIZE TM606-RECORD                                           
711600        MOVE PC-RD TO TM606-EXTR-PRCG-APPL-CDE                            
711700        PERFORM A000-INSERT-TOUTTM1                                       
711800     END-IF.                                                              
711900     PERFORM 7645-INSERT-TAURCPO.                                         
712000                                                                          
712100 EJECT                                                                    
712200                                                                          
712300******************************************************************        
712400* SETUP THE TAURCPO DCLGEN FIELDS PRIOR TO INSERT                *        
712500******************************************************************        
712600 7630-MOVES-AUDIT-TAURCPO.                                                
712700                                                                          
712800     INITIALIZE DCLTAURCPO.                                               
712900                                                                          
713000     MOVE IMRCPO-PO-NBR                        TO                         
713100              AURCPO-PO-NBR.                                              
713200     MOVE IMRCPO-PO-RCVD-SEQ-NBR               TO                         
713300              AURCPO-PO-RCVD-SEQ-NBR.                                     
713400     MOVE IMRCPO-PO-RCVD-DELY-TMST             TO                         
713500              AURCPO-PO-RCVD-DELY-TMST                                    
713600     MOVE IMRCPO-EXTL-REF-NBR                  TO                         
713700              AURCPO-EXTL-REF-NBR.                                        
713800     MOVE IMRCPO-CONSLR-SCAC-ID                TO                         
713900              AURCPO-CONSLR-SCAC-ID.                                      
714000     MOVE IMRCPO-IMPRT-TRIP-ID                 TO                         
714100              AURCPO-IMPRT-TRIP-ID                                        
714200     MOVE IMRCPO-DPRTR-TMST                    TO                         
714300              AURCPO-DPRTR-TMST                                           
714400     MOVE IMRCPO-POE-DELY-TMST                 TO                         
714500              AURCPO-POE-DELY-TMST                                        
714600     MOVE IMRCPO-CARR-SCAC-ID                  TO                         
714700              AURCPO-CARR-SCAC-ID                                         
714800     MOVE IMRCPO-FOB-CDE                       TO                         
714900              AURCPO-FOB-CDE                                              
715000     MOVE IMRCPO-IMPRT-VEH-NM                  TO                         
715100              AURCPO-IMPRT-VEH-NM                                         
715200     MOVE IMRCPO-TRIP-TYP-CDE                  TO                         
715300              AURCPO-TRIP-TYP-CDE                                         
715400     MOVE IMRCPO-DEST-POE-CDE                  TO                         
715500              AURCPO-DEST-POE-CDE                                         
715600     MOVE IMRCPO-EST-LBD-NM                    TO                         
715700              AURCPO-EST-LBD-NM                                           
715800     MOVE IMRCPO-EST-LBD-TMST                  TO                         
715900              AURCPO-EST-LBD-TMST                                         
716000     MOVE IMRCPO-ORGN-SHPD-FR-CDE              TO                         
716100              AURCPO-ORGN-SHPD-FR-CDE                                     
716200     MOVE IMRCPO-C-O-PROD-CDE                  TO                         
716300              AURCPO-C-O-PROD-CDE                                         
716400     MOVE IMRCPO-PROD-FCTRY-NM                 TO                         
716500              AURCPO-PROD-FCTRY-NM                                        
716600     MOVE IMRCPO-PO-CART-CNT                   TO                         
716700              AURCPO-PO-CART-CNT                                          
716800     MOVE IMRCPO-PO-CBMT-QTY                   TO                         
716900              AURCPO-PO-CBMT-QTY                                          
717000     MOVE IMRCPO-PO-WT-KGRM-QTY                TO                         
717100              AURCPO-PO-WT-KGRM-QTY.                                      
717200     MOVE IMRCPO-PO-UNT-QTY                    TO                         
717300              AURCPO-PO-UNT-QTY                                           
717400     MOVE IMRCPO-PO-EXC-APVL-CDE               TO                         
717500              AURCPO-PO-EXC-APVL-CDE.                                     
717600     MOVE IMRCPO-PO-EXC-APVL-USR-ID            TO                         
717700              AURCPO-PO-EXC-APVL-USR-ID.                                  
717800     MOVE IMRCPO-PO-EXC-APVL-TMST              TO                         
717900              AURCPO-PO-EXC-APVL-TMST.                                    
718000     MOVE IMRCPO-PO-EXC-RSN-DESC               TO                         
718100              AURCPO-PO-EXC-RSN-DESC.                                     
718200     MOVE IMRCPO-VOY-CHG-RSN-DESC              TO                         
718300              AURCPO-VOY-CHG-RSN-DESC.                                    
718400     MOVE IMRCPO-DAT-SRC-ENT-ID                TO                         
718500              AURCPO-DAT-SRC-ENT-ID.                                      
718600     MOVE IMRCPO-LAST-UPD-BY-USR-ID            TO                         
718700              AURCPO-LAST-UPD-BY-USR-ID.                                  
718800     MOVE IMRCPO-LAST-UPD-TMST                 TO                         
718900              AURCPO-LAST-UPD-TMST.                                       
719000                                                                          
719100     IF TR025-ERD-TRN-TYP = PC-D                                          
719200         MOVE PC-D               TO AURCPO-AUD-FUNC-CDE                   
719300     ELSE                                                                 
719400         MOVE PC-U               TO AURCPO-AUD-FUNC-CDE                   
719500     END-IF.                                                              
719600                                                                          
719700     PERFORM 7999-SET-CURRENT-TMST.                                       
719800     MOVE PV-CURRENT-TMST                      TO                         
719900              AURCPO-AUD-TMST.                                            
720000                                                                          
720100 EJECT                                                                    
720200                                                                          
720300******************************************************************        
720400* DELETE A ROW FROM THE RECEIVING VS TABLE  (TIMRCVS).           *        
720500******************************************************************        
720600 7635-DELETE-TIMRCPO.                                                     
720700                                                                          
720800     PERFORM                                                              
720900         WITH TEST AFTER                                                  
721000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
721100         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
721200                 SQLCODE = ZERO                                           
721300                                                                          
721400         EXEC SQL                                                         
721500              DELETE                                                      
721600                FROM TIMRCPO                                              
721700               WHERE PO_NBR         =  :IMRCPO-PO-NBR                     
721800                 AND PO_RCVD_SEQ_NBR = :IMRCPO-PO-RCVD-SEQ-NBR            
721900         END-EXEC                                                         
722000                                                                          
722100         EVALUATE TRUE                                                    
722200             WHEN SQLCODE = ZERO                                          
722300                 ADD +1 TO PA-TOT-RCPO-DELETES                            
722400                 ADD +1 TO PA-TOT-RECS-DELETED                            
722500                 SET PS-GOOD-RCPO-DELETE    TO TRUE                       
722600             WHEN SQLCODE = +100                                          
722700                 CONTINUE                                                 
722800             WHEN SQLWARN0 NOT EQUAL SPACE                                
722900             WHEN SQLCODE NOT EQUAL ZERO                                  
723000                 DISPLAY '**************************************'         
723100                 DISPLAY '** ABEND                            **'         
723200                 DISPLAY '** PROGRAM = TRKUP225               **'         
723300                 DISPLAY '** PARAGRAPH = 7635-DELETE-TIMRCPO  **'         
723400                 DISPLAY '** DELETE TIMRCVS                   **'         
723500                 DISPLAY '** PO NBR         = ' TR025-LOG-PO-NBR          
723600                 DISPLAY '** PO EXTL REF NBR= '                           
723700                                        TR025-LOG-EXTL-REF-NBR            
723800                 DISPLAY '** PO RCVD DELY DTE= '                          
723900                                       TR025-LOG-PO-RCVD-DELY-DTE         
724000                 DISPLAY '**************************************'         
724100                 PERFORM 9100-SQL-ABEND                                   
724200         END-EVALUATE                                                     
724300     END-PERFORM.                                                         
724400                                                                          
724500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
724600         (SQLCODE NOT = ZERO AND                                          
724700          SQLCODE NOT = +100)                                             
724800         DISPLAY '****************************************'               
724900         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
725000         DISPLAY '** DELETE FROM TIMRCPO                **'               
725100         DISPLAY '** PARAGRAPH = 7635-DELETE-TIMRCPO    **'               
725200         DISPLAY '** PO NBR         = ' TR025-LOG-PO-NBR                  
725300         DISPLAY '** EXTL REF NBR   = ' TR025-LOG-EXTL-REF-NBR            
725400         DISPLAY '** PO RCVD DELY DTE= '                                  
725500                                  TR025-LOG-PO-RCVD-DELY-DTE              
725600         DISPLAY '****************************************'               
725700         PERFORM 9100-SQL-ABEND                                           
725800     END-IF.                                                              
725900                                                                          
726000 EJECT                                                                    
726100                                                                          
726200******************************************************************        
726300* AUDIT THE WHOLE PO ROW TO TABLE (TAURCPO) PRIOR TO DELETING    *        
726400******************************************************************        
726500 7645-INSERT-TAURCPO.                                                     
726600                                                                          
726700     PERFORM                                                              
726800         WITH TEST AFTER                                                  
726900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
727000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
727100                 SQLCODE = ZERO                                           
727200                                                                          
727300     EXEC SQL                                                             
727400         INSERT INTO TAURCPO                                              
727500               (PO_NBR,                                                   
727600                PO_RCVD_SEQ_NBR,                                          
727700                PO_RCVD_DELY_TMST,                                        
727800                EXTL_REF_NBR,                                             
727900                ORGN_SHPD_FR_CDE,                                         
728000                CONSLR_SCAC_ID,                                           
728100                IMPRT_TRIP_ID,                                            
728200                DPRTR_TMST,                                               
728300                POE_DELY_TMST,                                            
728400                CARR_SCAC_ID,                                             
728500                FOB_CDE,                                                  
728600                IMPRT_VEH_NM,                                             
728700                TRIP_TYP_CDE,                                             
728800                DEST_POE_CDE,                                             
728900                C_O_PROD_CDE,                                             
729000                PROD_FCTRY_NM,                                            
729100                PO_CART_CNT,                                              
729200                PO_CBMT_QTY,                                              
729300                PO_WT_KGRM_QTY,                                           
729400                PO_UNT_QTY,                                               
729500                PO_EXC_APVL_CDE,                                          
729600                PO_EXC_APVL_USR_ID,                                       
729700                PO_EXC_APVL_TMST,                                         
729800                PO_EXC_RSN_DESC,                                          
729900                EST_LBD_NM,                                               
730000                EST_LBD_TMST,                                             
730100                VOY_CHG_RSN_DESC,                                         
730200                DAT_SRC_ENT_ID,                                           
730300                LAST_UPD_BY_USR_ID,                                       
730400                LAST_UPD_TMST,                                            
730500                AUD_FUNC_CDE,                                             
730600                AUD_TMST)                                                 
730700       VALUES (:AURCPO-PO-NBR,                                            
730800               :AURCPO-PO-RCVD-SEQ-NBR,                                   
730900               :AURCPO-PO-RCVD-DELY-TMST,                                 
731000               :AURCPO-EXTL-REF-NBR,                                      
731100               :AURCPO-ORGN-SHPD-FR-CDE,                                  
731200               :AURCPO-CONSLR-SCAC-ID,                                    
731300               :AURCPO-IMPRT-TRIP-ID,                                     
731400               :AURCPO-DPRTR-TMST,                                        
731500               :AURCPO-POE-DELY-TMST,                                     
731600               :AURCPO-CARR-SCAC-ID,                                      
731700               :AURCPO-FOB-CDE,                                           
731800               :AURCPO-IMPRT-VEH-NM,                                      
731900               :AURCPO-TRIP-TYP-CDE,                                      
732000               :AURCPO-DEST-POE-CDE,                                      
732100               :AURCPO-C-O-PROD-CDE,                                      
732200               :AURCPO-PROD-FCTRY-NM,                                     
732300               :AURCPO-PO-CART-CNT,                                       
732400               :AURCPO-PO-CBMT-QTY,                                       
732500               :AURCPO-PO-WT-KGRM-QTY,                                    
732600               :AURCPO-PO-UNT-QTY,                                        
732700               :AURCPO-PO-EXC-APVL-CDE,                                   
732800               :AURCPO-PO-EXC-APVL-USR-ID,                                
732900               :AURCPO-PO-EXC-APVL-TMST,                                  
733000               :AURCPO-PO-EXC-RSN-DESC,                                   
733100               :AURCPO-EST-LBD-NM,                                        
733200               :AURCPO-EST-LBD-TMST,                                      
733300               :AURCPO-VOY-CHG-RSN-DESC,                                  
733400               :AURCPO-DAT-SRC-ENT-ID,                                    
733500               :AURCPO-LAST-UPD-BY-USR-ID,                                
733600               :AURCPO-LAST-UPD-TMST,                                     
733700               :AURCPO-AUD-FUNC-CDE,                                      
733800               :AURCPO-AUD-TMST)                                          
733900     END-EXEC                                                             
734000                                                                          
734100     EVALUATE TRUE                                                        
734200         WHEN SQLCODE = +0                                                
734300             ADD +1                      TO PA-TOT-RCPO-AUDITS            
734400             ADD +1                      TO PA-TOT-RECS-AUDITED           
734500                                                                          
734600         WHEN SQLCODE = -904                                              
734700         WHEN SQLCODE = -913                                              
734800             CONTINUE                                                     
734900                                                                          
735000         WHEN SQLWARN0 NOT EQUAL SPACE                                    
735100         WHEN SQLCODE NOT EQUAL ZERO                                      
735200             DISPLAY '** ABEND **'                                        
735300             DISPLAY '** PROGRAM = TRKUP225                  **'          
735400             DISPLAY '** PARAGRAPH = 7645-INSERT-TAURCPO     **'          
735500             DISPLAY '**UNSUCCESSFUL INSERT TO TAURCPO       **'          
735600             DISPLAY '**TR025-PO-NBR = ' TR025-LOG-PO-NBR                 
735700          DISPLAY '**TR025-EXTL-REF-NBR =' TR025-LOG-EXTL-REF-NBR         
735800          DISPLAY '**TR025-LOG-PO-RCVD-DELY-DTE ='                        
735900                                      TR025-LOG-PO-RCVD-DELY-DTE          
736000             PERFORM 9100-SQL-ABEND                                       
736100         END-EVALUATE                                                     
736200     END-PERFORM.                                                         
736300                                                                          
736400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
736500          SQLCODE NOT = ZERO                                              
736600                                                                          
736700         DISPLAY '****************************************'               
736800         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
736900         DISPLAY '** INSERT TO TAURCPO                  **'               
737000         DISPLAY '** PARAGRAPH = 7645-INSERT-TAURCPO    **'               
737100         DISPLAY '* PO NBR           = ' TR025-LOG-PO-NBR                 
737200         DISPLAY '* EXTL REF NBR     = ' TR025-LOG-EXTL-REF-NBR           
737300       DISPLAY '* PO RCVD DELY TMST = ' TR025-LOG-PO-RCVD-DELY-DTE        
737400         DISPLAY '****************************************'               
737500         PERFORM 9100-SQL-ABEND                                           
737600     END-IF.                                                              
737700                                                                          
737800 EJECT                                                                    
737900                                                                          
738000*****************************************************************         
738100* INSERT ROW INTO TRTW_RCVG_CKPR, THE WORKTABLE FOR                       
738200* SCM MQ PO TRIGGER FILE.                                                 
738300*****************************************************************         
738400 7700-INSERT-SCM-MESSAGE.                                                 
738500                                                                          
738600     PERFORM                                                              
738700         WITH TEST AFTER                                                  
738800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
738900         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR                    
739000                 SQLCODE = ZERO                                           
739100         EXEC SQL                                                         
739200              INSERT INTO TRTW_RCVG_CKPR                                  
739300                         (CKPR_REC_1_TXT)                                 
739400                 VALUES  (:TRT00042-CKPR-REC-1-TXT)                       
739500         END-EXEC                                                         
739600         EVALUATE TRUE                                                    
739700             WHEN SQLCODE = ZERO                                          
739800                 CONTINUE                                                 
739900                                                                          
740000             WHEN SQLWARN0 NOT EQUAL SPACE                                
740100             WHEN SQLCODE NOT EQUAL ZERO                                  
740200                 DISPLAY '**************************************'         
740300                 DISPLAY '** ABEND                            **'         
740400                 DISPLAY '** PROGRAM = TRKUP225               **'         
740500                 DISPLAY '** PARAGRAPH = 7700-INSERT-SCM-     **'         
740600                 DISPLAY '**                  MESSAGE         **'         
740700                 DISPLAY '** INSERT TRTW_RCVG_CKPR            **'         
740800                 DISPLAY '** TR405-RECORD = '                             
740900                 DISPLAY '*'    TR405-ACTN-CDE                            
741000                 DISPLAY '*'    TR405-EVENT-TYP                           
741100                 DISPLAY '*'    TR405-PO-NBR                              
741200                 DISPLAY '*'    TR405-EXTL-REF-NBR                        
741300                 DISPLAY '**************************************'         
741400                 PERFORM 9100-SQL-ABEND                                   
741500         END-EVALUATE                                                     
741600     END-PERFORM.                                                         
741700                                                                          
741800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
741900         SQLCODE NOT = ZERO                                               
742000         DISPLAY '****************************************'               
742100         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'               
742200         DISPLAY '** INSERT INTO TRTW_RCVG_CKPR         **'               
742300         DISPLAY '** PARAGRAPH = 7700-INSERT-SCM-MESSAGE**'               
742400         DISPLAY '** TR405-RECORD = '                                     
742500         DISPLAY '*'    TR405-ACTN-CDE                                    
742600         DISPLAY '*'    TR405-EVENT-TYP                                   
742700         DISPLAY '*'    TR405-PO-NBR                                      
742800         DISPLAY '*'    TR405-EXTL-REF-NBR                                
742900         DISPLAY '****************************************'               
743000         PERFORM 9100-SQL-ABEND                                           
743100     END-IF.                                                              
743200                                                                          
743300 EJECT                                                                    
743400******************************************************************        
743500* OPEN THE TMST CURSOR                                                    
743600******************************************************************        
743700 7800-SCM-OPEN-TMST-CURSOR.                                               
743800                                                                          
743900     EXEC SQL                                                             
744000          OPEN TMST_CUR                                                   
744100     END-EXEC.                                                            
744200                                                                          
744300     EVALUATE TRUE                                                        
744400         WHEN SQLCODE = ZERO                                              
744500             CONTINUE                                                     
744600         WHEN SQLWARN0 NOT EQUAL SPACE                                    
744700         WHEN SQLCODE NOT EQUAL ZERO                                      
744800             DISPLAY '** ABEND **'                                        
744900             DISPLAY '** PROGRAM = TRKUP225 **'                           
745000             DISPLAY '** PARAGRAPH = 7800-SCM-OPEN-TMST-CURSOR **'        
745100             DISPLAY '*PO NBR             = '                             
745200                                IMRCPO-PO-NBR                             
745300             DISPLAY '*ORGN SHPD FR CDE   = '                             
745400                                TR025-ERD-ORGN-SHPD-FR-CDE                
745500             DISPLAY '** EXTL REF NBR     = '                             
745600                                TR025-ERD-EXTL-REF-NBR                    
745700             DISPLAY '** PO RCVD DELY DTE = '                             
745800                                TR025-ERD-PO-RCVD-DELY-DTE                
745900             PERFORM 9100-SQL-ABEND                                       
746000     END-EVALUATE.                                                        
746100                                                                          
746200 EJECT                                                                    
746300 7810-SCM-CLOS-TMST-CURSOR.                                               
746400     EXEC SQL                                                             
746500         CLOSE TMST_CUR                                                   
746600     END-EXEC.                                                            
746700                                                                          
746800     EVALUATE TRUE                                                        
746900         WHEN SQLCODE = ZERO                                              
747000             CONTINUE                                                     
747100         WHEN SQLWARN0 NOT EQUAL SPACE                                    
747200         WHEN SQLCODE NOT EQUAL ZERO                                      
747300             DISPLAY '**************************************'             
747400             DISPLAY '** ABEND                            **'             
747500             DISPLAY '** PROGRAM = TRKUP225               **'             
747600             DISPLAY '** PARAGRAPH = 7810-SCM-CLOSE-TMST-CURSOR*'         
747700             DISPLAY '** CLOSE TMST_CUR CURSOR            **'             
747800             DISPLAY '**************************************'             
747900             PERFORM 9100-SQL-ABEND                                       
748000     END-EVALUATE.                                                        
748100                                                                          
748200 EJECT                                                                    
748300 7850-SCM-OPEN-ORGN-CURSOR.                                               
748400     EXEC SQL                                                             
748500          OPEN ORGN_CUR                                                   
748600     END-EXEC.                                                            
748700                                                                          
748800     EVALUATE TRUE                                                        
748900         WHEN SQLCODE = ZERO                                              
749000             CONTINUE                                                     
749100         WHEN SQLWARN0 NOT EQUAL SPACE                                    
749200         WHEN SQLCODE NOT EQUAL ZERO                                      
749300             DISPLAY '** ABEND **'                                        
749400             DISPLAY '** PROGRAM = TRKUP225 **'                           
749500             DISPLAY '** PARAGRAPH = 7850-SCM-OPEN-ORGN-CURSOR **'        
749600             DISPLAY '*PO NBR             = '                             
749700                                IMRCPO-PO-NBR                             
749800             DISPLAY '*ORGN SHPD FR CDE   = '                             
749900                                TR025-ERD-ORGN-SHPD-FR-CDE                
750000             DISPLAY '** EXTL REF NBR     = '                             
750100                                TR025-ERD-EXTL-REF-NBR                    
750200             DISPLAY '** PO RCVD DELY DTE = '                             
750300                                TR025-ERD-PO-RCVD-DELY-DTE                
750400             PERFORM 9100-SQL-ABEND                                       
750500     END-EVALUATE.                                                        
750600                                                                          
750700 EJECT                                                                    
750800 7860-SCM-CLOS-ORGN-CURSOR.                                               
750900     EXEC SQL                                                             
751000         CLOSE ORGN_CUR                                                   
751100     END-EXEC.                                                            
751200                                                                          
751300     EVALUATE TRUE                                                        
751400         WHEN SQLCODE = ZERO                                              
751500             CONTINUE                                                     
751600         WHEN SQLWARN0 NOT EQUAL SPACE                                    
751700         WHEN SQLCODE NOT EQUAL ZERO                                      
751800             DISPLAY '**************************************'             
751900             DISPLAY '** ABEND                            **'             
752000             DISPLAY '** PROGRAM = TRKUP225               **'             
752100             DISPLAY '** PARAGRAPH = 7860-SCM-CLOSE-ORGN-CURSOR*'         
752200             DISPLAY '** CLOSE ORGN_CUR CURSOR            **'             
752300             DISPLAY '**************************************'             
752400             PERFORM 9100-SQL-ABEND                                       
752500     END-EVALUATE.                                                        
752600                                                                          
752700 EJECT                                                                    
752800******************************************************************        
752900* TAKES A FINAL COMMIT, CLOSES THE INPUT FILE, AND DISPLAYS      *        
753000* MISCELLANEOUS JOB SUMMARY INFORMATION.                         *        
753100* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *        
753200* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *        
753300* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TOO LONG, THE EDI  *        
753400* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*        
753500* NO RETURN CODE OR MESSAGE IS SENT.                             *        
753600******************************************************************        
753700 8000-EOJ-ROUTINE.                                                        
753800                                                                          
753900                                                                          
754000     PERFORM 4300-COMMIT.                                                 
754100     DISPLAY 'COMMIT TAKEN AT '.                                          
754200     DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2) '/' PV-TMST (3:2)           
754300      '  ' PV-TMST (12:2) ':' PV-TMST (15:2) ':' PV-TMST (18:2).          
754400                                                                          
754500     CLOSE TR025-RECEIVING-FILE.                                          
754600                                                                          
754700     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.                      
754800     PERFORM 4200-UPDATE-TCKRSTCNTL.                                      
754900                                                                          
755000     DISPLAY '**************************************'.                    
755100     DISPLAY '** TRKUP225 SUMMARY **'.                                    
755200     DISPLAY 'TOTAL ERD    RECORDS   = ' PA-TOT-ERD-RECS-READ.            
755300     DISPLAY 'TOTAL ERDRSN RECORDS   = ' PA-TOT-ERDRSN-RECS-READ.         
755400     DISPLAY 'TOTAL LOG    RECORDS   = ' PA-TOT-LOG-RECS-READ.            
755500*    DISPLAY 'TOTAL LOGVS  RECORDS   = ' PA-TOT-LOGVS-RECS-READ.          
755600*    DISPLAY 'TOTAL LOGUPC RECORDS   = ' PA-TOT-LOGUPC-RECS-READ.         
755700     DISPLAY 'TOTAL INVALID REC TYPE = ' PA-TOT-BAD-REC-TYP.              
755800     DISPLAY 'TOTAL RECORDS READ     = ' PA-TOTAL-RECS-READ.              
755900     DISPLAY '**************************************'.                    
756000*                                                                         
756100     DISPLAY 'TOTAL TRANS TYPE = A   = ' PA-TOT-TRN-TYP-A.                
756200     DISPLAY 'TOTAL TRANS TYPE = C   = ' PA-TOT-TRN-TYP-C.                
756300     DISPLAY 'TOTAL TRANS TYPE = D   = ' PA-TOT-TRN-TYP-D.                
756400     DISPLAY 'TOTAL INVALID TRAN TYPE= ' PA-TOT-BAD-TRN-TYP.              
756500     DISPLAY '**************************************'.                    
756600*                                                                         
756700     DISPLAY 'TOTAL PO  INSERT COUNT = ' PA-TOT-RCPO-INSERTS.             
756800     DISPLAY 'TOTAL TM1 INSERT COUNT = ' PA-TOT-TOUTTM1-INSERTS.          
756900*    DISPLAY 'TOTAL VS  INSERT COUNT = ' PA-TOT-RCVS-INSERTS.             
757000*    DISPLAY 'TOTAL UPC INSERT COUNT = ' PA-TOT-RCUPC-INSERTS.            
757100     DISPLAY 'TOTAL RECORDS INSERTED = ' PA-TOT-RECS-INSERTED.            
757200     DISPLAY '**************************************'.                    
757300*                                                                         
757400     DISPLAY 'TOTAL PO  AUDIT  COUNT = ' PA-TOT-RCPO-AUDITS.              
757500*    DISPLAY 'TOTAL VS  AUDIT  COUNT = ' PA-TOT-RCVS-AUDITS.              
757600*    DISPLAY 'TOTAL UPC AUDIT  COUNT = ' PA-TOT-RCUPC-AUDITS.             
757700     DISPLAY 'TOTAL RECORDS AUDITED  = ' PA-TOT-RECS-AUDITED.             
757800     DISPLAY '**************************************'.                    
757900*                                                                         
758000     DISPLAY 'TOTAL PO  DELETE COUNT = ' PA-TOT-RCPO-DELETES.             
758100*    DISPLAY 'TOTAL VS  DELETE COUNT = ' PA-TOT-RCVS-DELETES.             
758200*    DISPLAY 'TOTAL UPC DELETE COUNT = ' PA-TOT-RCUPC-DELETES.            
758300     DISPLAY 'TOTAL RECORDS DELETED  = ' PA-TOT-RECS-DELETED.             
758400     DISPLAY '**************************************'.                    
758500*                                                                         
758600     DISPLAY 'TOTAL PO  CHANGE COUNT = ' PA-TOT-RCPO-CHANGES.             
758700*    DISPLAY 'TOTAL VS  CHANGE COUNT = ' PA-TOT-RCVS-CHANGES.             
758800*    DISPLAY 'TOTAL UPC CHANGE COUNT = ' PA-TOT-RCUP-CHANGES.             
758900     DISPLAY 'TOTAL C REC CHANGES    = ' PA-TOT-RECS-CHANGED.             
759000     DISPLAY '**************************************'.                    
759100*                                                                         
759200     DISPLAY 'TOTAL PO  CHANGE ADDS  = ' PA-TOT-RCPO-CHANGES-B.           
759300*    DISPLAY 'TOTAL VS  CHANGE ADDS  = ' PA-TOT-RCVS-CHANGES-B.           
759400*    DISPLAY 'TOTAL UPC CHANGE ADDS  = ' PA-TOT-RCUP-CHANGES-B.           
759500     DISPLAY 'TOTAL B CHANGE ADDS    = ' PA-TOT-RECS-CHANGED-B.           
759600     DISPLAY '**************************************'.                    
759700*                                                                         
759800*    DISPLAY 'TOTAL VS Z CHANGE ADDS = ' PA-TOT-RCVS-CHANGES-Z.           
759900*    DISPLAY 'TOTAL UPC Z CHANGE ADDS= ' PA-TOT-RCUP-CHANGES-Z.           
760000     DISPLAY 'TOTAL Z CHANGE ADDS    = ' PA-TOT-RECS-CHANGED-Z.           
760100     DISPLAY '**************************************'.                    
760200*                                                                         
760300*    DISPLAY 'TOTAL VS  E DELETES    = ' PA-TOT-RCVS-DELETES-E.           
760400*    DISPLAY 'TOTAL UPC E DELETES    = ' PA-TOT-RCUP-DELETES-E.           
760500     DISPLAY 'TOTAL E CHANGE DELETES = ' PA-TOT-RECS-DELETED-E.           
760600     DISPLAY '**************************************'.                    
760700*                                                                         
760800     DISPLAY 'TOTAL COMMITS          = ' PA-TOTAL-COMMITS.                
760900*                                                                         
761000     DISPLAY 'TOTAL ERROR COUNT      = ' PA-TOTAL-ERROR-COUNT.            
761100     DISPLAY 'TOTAL DETAIL COUNT     = ' PA-TOTAL-DETAIL-COUNT.           
761200     DISPLAY 'TOTAL RECORDS LOADED   = ' PA-TOTAL-RECS-LOADED.            
761300     DISPLAY '**************************************'.                    
761400                                                                          
761500 EJECT                                                                    
761600                                                                          
761700******************************************************************        
761800* SET THE CURRENT TIMESTAMP.                                     *        
761900******************************************************************        
762000 7999-SET-CURRENT-TMST.                                                   
762100                                                                          
762200          EXEC SQL                                                        
762300              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                    
762400          END-EXEC                                                        
762500                                                                          
762600         EVALUATE TRUE                                                    
762700             WHEN SQLCODE = ZERO                                          
762800                 CONTINUE                                                 
762900                                                                          
763000             WHEN SQLWARN0 NOT EQUAL SPACE                                
763100             WHEN SQLCODE NOT EQUAL ZERO                                  
763200                 DISPLAY '**************************************'         
763300                 DISPLAY '** ABEND                            **'         
763400                 DISPLAY '** PROGRAM = TRKUP225               **'         
763500                 DISPLAY '** PARAGRAPH = 7999-SET-CURRENT-TMST**'         
763600                 DISPLAY '** SET CURRENT TIMESTAMP            **'         
763700                 DISPLAY '** CURRENT TMST   = ' PV-CURRENT-TMST           
763800                 DISPLAY '**************************************'         
763900                 PERFORM 9100-SQL-ABEND                                   
764000         END-EVALUATE.                                                    
764100                                                                          
764200                                                                          
764300                                                                          
764400 EJECT                                                                    
764500                                                                          
764600******************************************************************        
764700* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *        
764800* ERROR OR WARNING CODE OCCURS.                                  *        
764900******************************************************************        
765000 9100-SQL-ABEND.                                                          
765100******************************************************************        
765200* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *        
765300* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *        
765400* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *        
765500* FORMAT.                                                        *        
765600******************************************************************        
765700                                                                          
765800     COPY DPPD004.                                                        
765900                                                                          
766000     DISPLAY 'PO ABEND         '  TR025-ERD-PO-NBR.                       
766100     DISPLAY 'X REF ABEND      '  TR025-ERD-EXTL-REF-NBR.                 
766200     DISPLAY 'PO RCVD DELY DTE ABEND  '                                   
766300                                TR025-ERD-PO-RCVD-DELY-DTE.               
766400     DISPLAY 'PO RCVD DELY TM  ABEND  ' TR025-ERD-PO-RCVD-DELY-TM.        
766500     DISPLAY 'ORGN SHPD FR CDE ABEND'  TR025-ERD-ORGN-SHPD-FR-CDE.        
766600     DISPLAY 'HOLD PO ABEND    '  PV-HOLD-TR025-PO-NBR.                   
766700     DISPLAY 'HOLD X REF ABEND '  PV-HOLD-TR025-EXTL-REF-NBR.             
766800     DISPLAY 'HOLD PO RCVD DELY DTE ABEND  '                              
766900                               TR025-ERD-PO-RCVD-DELY-DTE.                
767000     DISPLAY 'HOLD PO RCVD DELY TM  ABEND  '                              
767100                               TR025-ERD-PO-RCVD-DELY-TM.                 
767200     DISPLAY 'HOLD ORGN SHPD FR CDE ABEND'                                
767300                               PV-HOLD-ORGN-SHPD-FR-CDE.                  
767400     MOVE +4013 TO ABEND-CODE.                                            
767500     CALL 'ILBOABN0' USING ABEND-CODE.                                    
767600                                                                          
767700 EJECT                                                                    
767800                                                                          
767900******************************************************************        
768000* INSERT A ROW IN TOUTTM1 - TROUBLE NOTIFICATION EXTRACT WORK             
768100* TABLE PROCESSED IN JOB TMK625                                           
768200******************************************************************        
768300                                                                          
768400 A000-INSERT-TOUTTM1.                                                     
768500                                                                          
768600         MOVE PC-RC               TO TM606-DATA-SOURCE.                   
768700         MOVE PC-DEFAULT-DTE      TO TM606-STRT-FCTRY-DTE                 
768800                                     TM606-LAST-FCTRY-DTE                 
768900                                     TM606-PO-BKG-DELY-DTE                
769000                                     TM606-PO-RCVD-DELY-DTE               
769100                                     TM606-EST-DPRTR-DTE                  
769200                                     TM606-MOM-POE-DELY-DTE.              
769300         MOVE PC-DEFAULT-TMST     TO TM606-PURCHS-LAST-UPD-TMST           
769400                                     TM606-PLNSHP-LAST-UPD-TMST           
769500                                     TM606-IMBKPO-LAST-UPD-TMST           
769600                                     TM606-IMRCPO-LAST-UPD-TMST           
769700                                     TM606-IMCNPO-LAST-UPD-TMST.          
769800                                                                          
769900         MOVE IMRCPO-PO-NBR       TO TM606-PO-NBR.                        
770000         MOVE IMRCPO-PO-RCVD-SEQ-NBR                                      
770100                                  TO TM606-PO-RCVD-SEQ-NBR.               
770200         MOVE IMRCPO-PO-RCVD-DELY-TMST (1:10)                             
770300                                  TO TM606-PO-RCVD-DELY-DTE.              
770400         MOVE IMRCPO-LAST-UPD-TMST                                        
770500                                  TO TM606-IMRCPO-LAST-UPD-TMST           
770600                                                                          
770700         MOVE TM606-PO-NBR    TO OUTTM1-PO-NBR.                           
770800         MOVE TM606-ODR       TO OUTTM1-TRBL-ODR.                         
770900         MOVE TM606-TMST-ODR  TO OUTTM1-TRBL-TMST-ODR.                    
771000                                                                          
771100         EXEC SQL                                                         
771200             INSERT INTO TOUTTM1                                          
771300                 (PO_NBR                                                  
771400                 ,TRBL_ODR                                                
771500                 ,TRBL_TMST_ODR                                           
771600                  )                                                       
771700                VALUES                                                    
771800                 (:OUTTM1-PO-NBR                                          
771900                 ,:OUTTM1-TRBL-ODR                                        
772000                 ,:OUTTM1-TRBL-TMST-ODR                                   
772100                 )                                                        
772200         END-EXEC.                                                        
772300                                                                          
772400         EVALUATE TRUE                                                    
772500             WHEN SQLCODE = ZERO                                          
772600                 ADD +1 TO PA-TOT-TOUTTM1-INSERTS                         
772700                                                                          
772800             WHEN SQLCODE = -803                                          
772900                 CONTINUE                                                 
773000             WHEN SQLWARN0 NOT EQUAL SPACE                                
773100             WHEN SQLCODE NOT EQUAL ZERO                                  
773200                 DISPLAY '**************************************'         
773300                 DISPLAY '** ABEND                            **'         
773400                 DISPLAY '** PROGRAM = TRKUP225               **'         
773500                 DISPLAY '** PARAGRAPH = A000-INSERT-TOUTTM1  **'         
773600                 DISPLAY '** PO NUMBER    = '  TM606-PO-NBR-X             
773700                 DISPLAY '** PO BKG SEQ   = '                             
773800                 DISPLAY  TM606-PO-RCVD-SEQ-NBR-X                         
773900                 DISPLAY '**************************************'         
774000                 PERFORM 9100-SQL-ABEND                                   
774100         END-EVALUATE.                                                    
