000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.    XLKUT071.                                         00040000
000500 AUTHOR.        JOE LAROSA.                                       00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  01-2004.                                          00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*        LOCATION DOMAIN MODULE - BLACK BOX PROGRAM              *00100000
001100*    THIS PROGRAM CAN BE CALLED IN BATCH AND IN CICS AND NEEDS   *00110000
001200*    TO BE COMPILED EACH WAY AND TWO MOVES MADE TO PRODUCTION    *00120000
001300*    (ONE BATCH & ONE ON-LINE).  THE PROGRAM EXPECTS A LOCATION  *00130000
001400*    NUMBER AS INPUT & RETURNS SEVERAL RELATED FIELDS BACK.      *00140000
001500******************************************************************00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700******************************************************************00170000
001800 DATA DIVISION.                                                   00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000 01  WS-WORKING-STOAGE-VALUE     PIC X(35) VALUE                  00200000
002100         '*** WORKING STORAGE STARTS HERE ***'.                   00210000
002200                                                                  00220000
002300 01  PC-PROGRAM-CONSTANTS.                                        00230000
002400     05  PC-CURRENT-PROGRAM-NAME PIC X(08) VALUE 'XLKUT071'.      00240000
002500                                                                  00250000
002600 01  NI-NULL-INDICATORS.                                          00260000
002700     05  NI-REPLT-STR-NBR        PIC S9(4) VALUE +0 COMP.         00270000
002800     05  NI-DIST-NBR             PIC S9(4) VALUE +0 COMP.         00280000
002900     05  NI-STR-FMT-CDE          PIC S9(4) VALUE +0 COMP.         00290000
003000     05  NI-STD-TM-ZN-CDE        PIC S9(4) VALUE +0 COMP.         00300000
003100     05  NI-LOC-10-ABBR-NM       PIC S9(4) VALUE +0 COMP.         00310000
003200     05  NI-PHN-NBR              PIC S9(4) VALUE +0 COMP.         00320000
003300     05  NI-MGR-NM               PIC S9(4) VALUE +0 COMP.         00330000
003400     05  NI-FINCL-CLO-DTE        PIC S9(4) VALUE +0 COMP.         00340000
003500     05  NI-MN-SLS-INCL-DTE      PIC S9(4) VALUE +0 COMP.         00350000
003600     05  NI-YR-SLS-INCL-DTE      PIC S9(4) VALUE +0 COMP.         00360000
003700     05  NI-OCPNC-DTE            PIC S9(4) VALUE +0 COMP.         00370000
003800     05  NI-POS-RGST-BNK-QTY     PIC S9(4) VALUE +0 COMP.         00380000
003900     05  NI-DST-IND              PIC S9(4) VALUE +0 COMP.         00390000
004000     05  NI-E-BUS-IND            PIC S9(4) VALUE +0 COMP.         00400000
004100     05  NI-SLS-INCL-DTE-CDE     PIC S9(4) VALUE +0 COMP.         00410000
004200     05  NI-TOT-SLG-SQ-FTG-QTY   PIC S9(4) VALUE +0 COMP.         00420000
004300     05  NI-TOT-SQ-FTG-QTY       PIC S9(4) VALUE +0 COMP.         00430000
004400     05  NI-STP-ORD-DAYS-QTY     PIC S9(4) VALUE +0 COMP.         00440000
004500     05  NI-STRT-ORD-DAYS-QTY    PIC S9(4) VALUE +0 COMP.         00450000
004600     05  NI-ACQR-DTE             PIC S9(4) VALUE +0 COMP.         00460000
004700     05  NI-RMDL-DTE             PIC S9(4) VALUE +0 COMP.         00470000
004800     05  NI-MEDN-AGE-NBR         PIC S9(4) VALUE +0 COMP.         00480000
004900     05  NI-EST-HH-INCM-AMT      PIC S9(4) VALUE +0 COMP.         00490000
005000     05  NI-QTR-SLS-INCL-DTE     PIC S9(4) VALUE +0 COMP.         00500000
005100     05  NI-SEA-SLS-INCL-DTE     PIC S9(4) VALUE +0 COMP.         00510000
005200     05  NI-EXTD-MALL-NM         PIC S9(4) VALUE +0 COMP.         00520000
005300     05  NI-GRND-OPN-DTE         PIC S9(4) VALUE +0 COMP.         00530000
005400     05  NI-DIRNS-TXT            PIC S9(4) VALUE +0 COMP.         00540000
005500     05  NI-PRCHG-CRE-IND        PIC S9(4) VALUE +0 COMP.         00550000
005600     05  NI-IN-STR-PRCHG-IND     PIC S9(4) VALUE +0 COMP.         00560000
005700     05  NI-ASGMT-PO-DTE         PIC S9(4) VALUE +0 COMP.         00570000
005800                                                                  00580000
005900 01  PV-PROGRAM-VARIABLES.                                        00590000
006000     05  PV-LOC-NBR              PIC 9(04).                       00600000
006100     05  PV-SQLCODE              PIC S9(9).                       00610000
006200     05  PV-DISPLAY-SQLCODE      PIC -------999.                  00620000
           05  PV-INIT-DATE            PIC X(10) VALUE '9999-09-09'.    00621003
           05  PV-STOP-DATE            PIC X(10) VALUE '9999-99-09'.    00621106
013501******************************************************************00622003
006500*  COMMUNICATIONS AREA FOR DB2                                    00650000
006600******************************************************************00660000
006700     EXEC SQL                                                     00670000
006800         INCLUDE SQLCA                                            00680000
006900     END-EXEC.                                                    00690000
007000                                                                  00700000
007100******************************************************************00710000
007200* DCLGENS OF ASSOCIATED LOCATION TABLES.                          00720000
007300******************************************************************00730000
007400*XLT_LOC                                                          00740000
007500     EXEC SQL                                                     00750000
007600         INCLUDE XLT00010                                         00760000
007700     END-EXEC.                                                    00770000
007800                                                                  00780000
007900*XLT_DC_LOC_ASGMT                                                 00790000
008000     EXEC SQL                                                     00800000
008100         INCLUDE XLT00014                                         00810000
008200     END-EXEC.                                                    00820000
008300                                                                  00830000
008400*XLT_LOC_TYP_CDE                                                  00840000
008500     EXEC SQL                                                     00850000
008600         INCLUDE XLT00015                                         00860000
008700     END-EXEC.                                                    00870000
008800                                                                  00880000
008900*XLT_STD_TM_ZN_CDE                                                00890000
009000     EXEC SQL                                                     00900000
009100         INCLUDE XLT00016                                         00910000
009200     END-EXEC.                                                    00920000
009300                                                                  00930000
009400*XLT_STR_FMT_CDE                                                  00940000
009500     EXEC SQL                                                     00950000
009600         INCLUDE XLT00017                                         00960000
009700     END-EXEC.                                                    00970000
009800                                                                  00980000
009900******************************************************************00990000
010000 LINKAGE SECTION.                                                 01000000
010100     COPY XLWS071.                                                01010000
010200******************************************************************01020000
010300 PROCEDURE DIVISION USING XL071-COMMAREA-REC.                     01030000
010400******************************************************************01040000
010500 0000-MAIN-MODULE.                                                01050000
010600                                                                  01060000
010700     INITIALIZE XL071-RETURN-DATA.                                01070000
010800                                                                  01080000
010900     PERFORM 1000-GET-LOCATION.                                   01090000
011000                                                                  01100000
011100     GOBACK.                                                      01110000
011200                                                                  01120000
011300******************************************************************01130000
011400*  SELECT XLT_LOCATION ROW.                                      *01140000
011500******************************************************************01150000
011600 1000-GET-LOCATION.                                               01160000
011700                                                                  01170000
011800     MOVE XL071-LOCATION-NUMBER TO XLT00010-LOC-NBR.              01180000
011900     EXEC SQL                                                     01190000
012000         SELECT A.REPLT_STR_NBR                                   01200000
012100              , A.DIST_NBR                                        01210000
012200              , A.LOC_TYP_CDE                                     01220000
012300              , A.STR_FMT_CDE                                     01230000
012400              , A.STD_TM_ZN_CDE                                   01240000
012500              , A.LOC_NM                                          01250000
012600              , A.LOC_5_ABBR_NM                                   01260000
012700              , A.LNE_1_ADDR                                      01270000
012800              , A.LNE_2_ADDR                                      01280000
012900              , A.CTY_NM                                          01290000
013000              , A.ST_CDE                                          01300000
013100              , A.ZIP_10_CDE                                      01310000
013200              , A.OPN_DTE                                         01320000
                    , A.CLO_DTE                                         01330020
013400              , A.LOC_10_ABBR_NM                                  01340000
013500              , A.PHN_NBR                                         01350000
013600              , A.MGR_NM                                          01360000
013700              , A.FINCL_CLO_DTE                                   01370000
013800              , A.MN_SLS_INCL_DTE                                 01380000
013900              , A.YR_SLS_INCL_DTE                                 01390000
014000              , A.OCPNC_DTE                                       01400000
014100              , A.POS_RGST_BNK_QTY                                01410000
014200              , A.DST_IND                                         01420000
014300              , A.E_BUS_IND                                       01430000
014400              , A.SLS_INCL_DTE_CDE                                01440000
014500              , A.TOT_SLG_SQ_FTG_QTY                              01450000
014600              , A.TOT_SQ_FTG_QTY                                  01460000
014800              , A.STRT_ORD_DAYS_QTY                               01480000
014900              , A.ACQR_DTE                                        01490000
015000              , A.RMDL_DTE                                        01500000
015100              , A.MEDN_AGE_NBR                                    01510000
015200              , A.EST_HH_INCM_AMT                                 01520000
015300              , A.QTR_SLS_INCL_DTE                                01530000
015400              , A.SEA_SLS_INCL_DTE                                01540000
015500              , A.EXTD_MALL_NM                                    01550000
015600              , A.GRND_OPN_DTE                                    01560000
015700              , A.DIRNS_TXT                                       01570000
015800              , A.PRCHG_CRE_IND                                   01580000
015900              , A.IN_STR_PRCHG_IND                                01590000
016000              , A.LAST_UPD_TMST                                   01600000
016100              , B.LOC_TYP_DESC                                    01610000
016100              , A.STP_ORD_DAYS_QTY                                01611017
016100              , A.CLO_DTE - COALESCE(A.STP_ORD_DAYS_QTY,0) DAYS   01612023
016100                            AS STOP_DATE                          01613022
016200           INTO :XLT00010-REPLT-STR-NBR                           01620000
016300                  :NI-REPLT-STR-NBR                               01630000
016400              , :XLT00010-DIST-NBR                                01640000
016500                  :NI-DIST-NBR                                    01650000
016600              , :XLT00010-LOC-TYP-CDE                             01660000
016700              , :XLT00010-STR-FMT-CDE                             01670000
016800                  :NI-STR-FMT-CDE                                 01680000
016900              , :XLT00010-STD-TM-ZN-CDE                           01690000
017000                  :NI-STD-TM-ZN-CDE                               01700000
017100              , :XLT00010-LOC-NM                                  01710000
017200              , :XLT00010-LOC-5-ABBR-NM                           01720000
017300              , :XLT00010-LNE-1-ADDR                              01730000
017400              , :XLT00010-LNE-2-ADDR                              01740000
017500              , :XLT00010-CTY-NM                                  01750000
017600              , :XLT00010-ST-CDE                                  01760000
017700              , :XLT00010-ZIP-10-CDE                              01770000
017800              , :XLT00010-OPN-DTE                                 01780000
017900              , :XLT00010-CLO-DTE                                 01790000
018000              , :XLT00010-LOC-10-ABBR-NM                          01800000
018100                  :NI-LOC-10-ABBR-NM                              01810000
018200              , :XLT00010-PHN-NBR                                 01820000
018300                  :NI-PHN-NBR                                     01830000
018400              , :XLT00010-MGR-NM                                  01840000
018500                  :NI-MGR-NM                                      01850000
018600              , :XLT00010-FINCL-CLO-DTE                           01860000
018700                  :NI-FINCL-CLO-DTE                               01870000
018800              , :XLT00010-MN-SLS-INCL-DTE                         01880000
018900                  :NI-MN-SLS-INCL-DTE                             01890000
019000              , :XLT00010-YR-SLS-INCL-DTE                         01900000
019100                  :NI-YR-SLS-INCL-DTE                             01910000
019200              , :XLT00010-OCPNC-DTE                               01920000
019300                  :NI-OCPNC-DTE                                   01930000
019400              , :XLT00010-POS-RGST-BNK-QTY                        01940000
019500                  :NI-POS-RGST-BNK-QTY                            01950000
019600              , :XLT00010-DST-IND                                 01960000
019700                  :NI-DST-IND                                     01970000
019800              , :XLT00010-E-BUS-IND                               01980000
019900                  :NI-E-BUS-IND                                   01990000
020000              , :XLT00010-SLS-INCL-DTE-CDE                        02000000
020100                  :NI-SLS-INCL-DTE-CDE                            02010000
020200              , :XLT00010-TOT-SLG-SQ-FTG-QTY                      02020000
020300                  :NI-TOT-SLG-SQ-FTG-QTY                          02030000
020400              , :XLT00010-TOT-SQ-FTG-QTY                          02040000
020500                  :NI-TOT-SQ-FTG-QTY                              02050000
020800              , :XLT00010-STRT-ORD-DAYS-QTY                       02080000
020900                  :NI-STRT-ORD-DAYS-QTY                           02090000
021000              , :XLT00010-ACQR-DTE                                02100000
021100                  :NI-ACQR-DTE                                    02110000
021200              , :XLT00010-RMDL-DTE                                02120000
021300                  :NI-RMDL-DTE                                    02130000
021400              , :XLT00010-MEDN-AGE-NBR                            02140000
021500                  :NI-MEDN-AGE-NBR                                02150000
021600              , :XLT00010-EST-HH-INCM-AMT                         02160000
021700                  :NI-EST-HH-INCM-AMT                             02170000
021800              , :XLT00010-QTR-SLS-INCL-DTE                        02180000
021900                  :NI-QTR-SLS-INCL-DTE                            02190000
022000              , :XLT00010-SEA-SLS-INCL-DTE                        02200000
022100                  :NI-SEA-SLS-INCL-DTE                            02210000
022200              , :XLT00010-EXTD-MALL-NM                            02220000
022300                  :NI-EXTD-MALL-NM                                02230000
022400              , :XLT00010-GRND-OPN-DTE                            02240000
022500                  :NI-GRND-OPN-DTE                                02250000
022600              , :XLT00010-DIRNS-TXT                               02260000
022700                  :NI-DIRNS-TXT                                   02270000
022800              , :XLT00010-PRCHG-CRE-IND                           02280000
022900                  :NI-PRCHG-CRE-IND                               02290000
023000              , :XLT00010-IN-STR-PRCHG-IND                        02300000
023100                  :NI-IN-STR-PRCHG-IND                            02310000
023200              , :XLT00010-LAST-UPD-TMST                           02320000
023300              , :XLT00015-LOC-TYP-DESC                            02330000
022400              , :XLT00010-STP-ORD-DAYS-QTY                        02331017
022500                  :NI-STP-ORD-DAYS-QTY                            02332017
023300              , :PV-STOP-DATE                                     02333020
023400           FROM XLT_LOC A                                         02340000
023500              , XLT_LOC_TYP_CDE B                                 02350000
023600          WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 02360000
023700            AND A.LOC_TYP_CDE = B.LOC_TYP_CDE                     02370000
023800     END-EXEC.                                                    02380000
023900                                                                  02390000
024000     EVALUATE TRUE                                                02400000
024100       WHEN SQLCODE = ZERO                                        02410000
024200           IF NI-STD-TM-ZN-CDE = -1                               02420000
024300               MOVE SPACES TO XLT00010-STD-TM-ZN-CDE              02430000
024400                              XLT00016-STD-TM-ZN-DESC             02440000
024500           ELSE                                                   02450000
024600               PERFORM 1100-GET-STD-TM-ZN-DESC                    02460000
024700           END-IF                                                 02470000
024800           IF NI-STR-FMT-CDE   = -1                               02480000
024900               MOVE ZEROES TO XLT00010-STR-FMT-CDE                02490000
025000               MOVE SPACES TO XLT00017-STR-FMT-DESC               02500000
025100           ELSE                                                   02510000
025200               PERFORM 1200-GET-STR-FMT-DESC                      02520000
025300           END-IF                                                 02530000
025400                                                                  02540000
025500           PERFORM 1300-LOAD-COMMAREA                             02550000
025600                                                                  02560000
025700           PERFORM 1400-GET-DC-ASGMT                              02570000
025800                                                                  02580000
025900       WHEN SQLCODE = +100                                        02590000
026000           INITIALIZE XL071-RETURN-DATA                           02600000
026100           SET XL071-LOC-NOT-FOUND  TO TRUE                       02610000
026600           MOVE SQLCODE             TO XL071-SQLCODE-N            02611026
026200                                                                  02620000
026300       WHEN OTHER                                                 02630000
026400           INITIALIZE XL071-RETURN-DATA                           02640000
026500           MOVE SQLCA               TO XL071-SQLCA                02650000
026600           MOVE SQLCODE             TO PV-SQLCODE                 02660000
026600                                       XL071-SQLCODE-N            02661026
026700           MOVE PV-SQLCODE          TO PV-DISPLAY-SQLCODE         02670000
026800           MOVE PV-DISPLAY-SQLCODE  TO XL071-SQLCODE              02680000
026900           SET XL071-BAD-DB2-RETURN TO TRUE                       02690000
027000           MOVE 'XLT00010'          TO XL071-DB2-TABLE            02700000
027100                                                                  02710000
027200     END-EVALUATE.                                                02720000
027300                                                                  02730000
027400******************************************************************02740000
027500*  SELECT XLT_STD_TM_ZN ROW.                                     *02750000
027600******************************************************************02760000
027700 1100-GET-STD-TM-ZN-DESC.                                         02770000
027800                                                                  02780000
027900     EXEC SQL                                                     02790000
028000         SELECT STD_TM_ZN_DESC                                    02800000
028100           INTO :XLT00016-STD-TM-ZN-DESC                          02810000
028200           FROM XLT_STD_TM_ZN_CDE                                 02820000
028300          WHERE STD_TM_ZN_CDE = :XLT00010-STD-TM-ZN-CDE           02830000
028400     END-EXEC.                                                    02840000
028500                                                                  02850000
028600     EVALUATE TRUE                                                02860000
028700       WHEN SQLCODE = ZERO                                        02870000
028800           CONTINUE                                               02880000
028900                                                                  02890000
029000       WHEN SQLCODE = +100                                        02900000
029100           MOVE SPACES TO XLT00016-STD-TM-ZN-DESC                 02910000
029200                                                                  02920000
029300       WHEN OTHER                                                 02930000
029400           INITIALIZE XL071-RETURN-DATA                           02940000
029500           MOVE SQLCA               TO XL071-SQLCA                02950000
029600           MOVE SQLCODE             TO PV-SQLCODE                 02960000
026600                                       XL071-SQLCODE-N            02961026
029700           MOVE PV-SQLCODE          TO PV-DISPLAY-SQLCODE         02970000
029800           MOVE PV-DISPLAY-SQLCODE  TO XL071-SQLCODE              02980000
029900           SET XL071-BAD-DB2-RETURN TO TRUE                       02990000
030000           MOVE 'XLT00016'          TO XL071-DB2-TABLE            03000000
030100           GOBACK                                                 03010000
030200                                                                  03020000
030300     END-EVALUATE.                                                03030000
030400                                                                  03040000
030500******************************************************************03050000
030600*  SELECT XLT_STR_FMT ROW.                                       *03060000
030700******************************************************************03070000
030800 1200-GET-STR-FMT-DESC.                                           03080000
030900                                                                  03090000
031000     EXEC SQL                                                     03100000
031100         SELECT STR_FMT_DESC                                      03110000
031200           INTO :XLT00017-STR-FMT-DESC                            03120000
031300           FROM XLT_STR_FMT_CDE                                   03130000
031400          WHERE STR_FMT_CDE = :XLT00010-STR-FMT-CDE               03140000
031500     END-EXEC.                                                    03150000
031600                                                                  03160000
031700     EVALUATE TRUE                                                03170000
031800       WHEN SQLCODE = ZERO                                        03180000
031900           CONTINUE                                               03190000
032000                                                                  03200000
032100       WHEN SQLCODE = +100                                        03210000
032200           MOVE SPACES TO XLT00017-STR-FMT-DESC                   03220000
032300                                                                  03230000
032400       WHEN OTHER                                                 03240000
032500           INITIALIZE XL071-RETURN-DATA                           03250000
032600           MOVE SQLCA               TO XL071-SQLCA                03260000
032700           MOVE SQLCODE             TO PV-SQLCODE                 03270000
026600                                       XL071-SQLCODE-N            03271026
032800           MOVE PV-SQLCODE          TO PV-DISPLAY-SQLCODE         03280000
032900           MOVE PV-DISPLAY-SQLCODE  TO XL071-SQLCODE              03290000
033000           SET XL071-BAD-DB2-RETURN TO TRUE                       03300000
033100           MOVE 'XLT00017'          TO XL071-DB2-TABLE            03310000
033200           GOBACK                                                 03320000
033300                                                                  03330000
033400     END-EVALUATE.                                                03340000
033500                                                                  03350000
033600******************************************************************03360000
033700*  MOVE DB2 LOCATION FIELDS TO COMMAREA                          *03370000
033800******************************************************************03380000
033900 1300-LOAD-COMMAREA.                                              03390000
034000                                                                  03400000
034100     IF NI-REPLT-STR-NBR = -1                                     03410000
034200         MOVE ZEROES TO XL071-REPLT-STR-NBR                       03420000
034300     ELSE                                                         03430000
034400         MOVE XLT00010-REPLT-STR-NBR TO XL071-REPLT-STR-NBR       03440000
034500     END-IF.                                                      03450000
034600     IF NI-DIST-NBR = -1                                          03460000
034700         MOVE ZEROES              TO XL071-DIST-NBR               03470000
034800     ELSE                                                         03480000
034900         MOVE XLT00010-DIST-NBR   TO XL071-DIST-NBR               03490000
035000     END-IF.                                                      03500000
035100     MOVE XLT00010-LOC-NM         TO XL071-LOC-NM.                03510000
035200     MOVE XLT00010-LOC-5-ABBR-NM  TO XL071-LOC-5-ABBR-NM.         03520000
035300     MOVE XLT00010-LNE-1-ADDR     TO XL071-LNE-1-ADDR.            03530000
035400     MOVE XLT00010-LNE-2-ADDR     TO XL071-LNE-2-ADDR.            03540000
035500     MOVE XLT00010-CTY-NM         TO XL071-CTY-NM.                03550000
035600     MOVE XLT00010-ST-CDE         TO XL071-ST-CDE.                03560000
035700     MOVE XLT00010-ZIP-10-CDE     TO XL071-ZIP-10-CDE.            03570000
035800     MOVE XLT00010-OPN-DTE        TO XL071-OPN-DTE.               03580000
035900     MOVE XLT00010-CLO-DTE        TO XL071-CLO-DTE.               03590000
036000     IF NI-LOC-10-ABBR-NM = -1                                    03600000
036100         MOVE SPACES TO XL071-LOC-10-ABBR-NM                      03610000
036200     ELSE                                                         03620000
036300         MOVE XLT00010-LOC-10-ABBR-NM TO XL071-LOC-10-ABBR-NM     03630000
036400     END-IF.                                                      03640000
036500     IF NI-PHN-NBR = -1                                           03650000
036600         MOVE SPACES TO XL071-PHN-NBR                             03660000
036700     ELSE                                                         03670000
036800         MOVE XLT00010-PHN-NBR TO XL071-PHN-NBR                   03680000
036900     END-IF.                                                      03690000
037000     IF NI-MGR-NM = -1                                            03700000
037100         MOVE SPACES TO XL071-MGR-NM                              03710000
037200     ELSE                                                         03720000
037300         MOVE XLT00010-MGR-NM TO XL071-MGR-NM                     03730000
037400     END-IF.                                                      03740000
037500     IF NI-FINCL-CLO-DTE = -1                                     03750000
037600         MOVE SPACES TO XL071-FINCL-CLO-DTE                       03760000
037700     ELSE                                                         03770000
037800         MOVE XLT00010-FINCL-CLO-DTE TO XL071-FINCL-CLO-DTE       03780000
037900     END-IF.                                                      03790000
038000     IF NI-MN-SLS-INCL-DTE = -1                                   03800000
038100         MOVE SPACES TO XL071-MN-SLS-INCL-DTE                     03810000
038200     ELSE                                                         03820000
038300         MOVE XLT00010-MN-SLS-INCL-DTE TO XL071-MN-SLS-INCL-DTE   03830000
038400     END-IF.                                                      03840000
038500     IF NI-YR-SLS-INCL-DTE = -1                                   03850000
038600         MOVE SPACES TO XL071-YR-SLS-INCL-DTE                     03860000
038700     ELSE                                                         03870000
038800         MOVE XLT00010-YR-SLS-INCL-DTE TO XL071-YR-SLS-INCL-DTE   03880000
038900     END-IF.                                                      03890000
039000     IF NI-OCPNC-DTE = -1                                         03900000
039100         MOVE SPACES              TO XL071-OCPNC-DTE              03910000
039200     ELSE                                                         03920000
039300         MOVE XLT00010-OCPNC-DTE  TO XL071-OCPNC-DTE              03930000
039400     END-IF.                                                      03940000
039500     IF NI-POS-RGST-BNK-QTY = -1                                  03950000
039600         MOVE ZEROES              TO XL071-POS-RGST-BNK-QTY       03960000
039700     ELSE                                                         03970000
039800         MOVE XLT00010-POS-RGST-BNK-QTY                           03980000
039900                                  TO XL071-POS-RGST-BNK-QTY       03990000
040000     END-IF.                                                      04000000
040100     IF NI-DST-IND = -1                                           04010000
040200         MOVE SPACES              TO XL071-DST-IND                04020000
040300     ELSE                                                         04030000
040400         MOVE XLT00010-DST-IND    TO XL071-DST-IND                04040000
040500     END-IF.                                                      04050000
040600     IF NI-E-BUS-IND = -1                                         04060000
040700         MOVE SPACES              TO XL071-E-BUS-IND              04070000
040800     ELSE                                                         04080000
040900         MOVE XLT00010-E-BUS-IND  TO XL071-E-BUS-IND              04090000
041000     END-IF.                                                      04100000
041100     IF NI-SLS-INCL-DTE-CDE = -1                                  04110000
041200         MOVE SPACES              TO XL071-SLS-INCL-DTE-CDE       04120000
041300     ELSE                                                         04130000
041400         MOVE XLT00010-SLS-INCL-DTE-CDE                           04140000
041500                                  TO XL071-SLS-INCL-DTE-CDE       04150000
041600     END-IF.                                                      04160000
041700     IF NI-TOT-SLG-SQ-FTG-QTY = -1                                04170000
041800         MOVE ZEROES              TO XL071-TOT-SLG-SQ-FTG-QTY     04180000
041900     ELSE                                                         04190000
042000         MOVE XLT00010-TOT-SLG-SQ-FTG-QTY                         04200000
042100                                  TO XL071-TOT-SLG-SQ-FTG-QTY     04210000
042200     END-IF.                                                      04220000
042300     IF NI-TOT-SQ-FTG-QTY = -1                                    04230000
042400         MOVE ZEROES              TO XL071-TOT-SQ-FTG-QTY         04240000
042500     ELSE                                                         04250000
042600         MOVE XLT00010-TOT-SQ-FTG-QTY                             04260000
042700                                  TO XL071-TOT-SQ-FTG-QTY         04270000
042800     END-IF.                                                      04280000
042900     IF NI-STP-ORD-DAYS-QTY = -1                                  04290000
043000         MOVE ZEROES              TO XL071-STP-ORD-DAYS-QTY       04300000
043100     ELSE                                                         04310000
043200         MOVE XLT00010-STP-ORD-DAYS-QTY                           04320000
043300                                  TO XL071-STP-ORD-DAYS-QTY       04330000
043400     END-IF.                                                      04340000
043500     IF NI-STRT-ORD-DAYS-QTY = -1                                 04350000
043600         MOVE ZEROES              TO XL071-STRT-ORD-DAYS-QTY      04360000
043700     ELSE                                                         04370000
043800         MOVE XLT00010-STRT-ORD-DAYS-QTY                          04380000
043900                                  TO XL071-STRT-ORD-DAYS-QTY      04390000
044000     END-IF.                                                      04400000
044100     IF NI-ACQR-DTE = -1                                          04410000
044200         MOVE SPACES              TO XL071-ACQR-DTE               04420000
044300     ELSE                                                         04430000
044400         MOVE XLT00010-ACQR-DTE   TO XL071-ACQR-DTE               04440000
044500     END-IF.                                                      04450000
044600     IF NI-RMDL-DTE = -1                                          04460000
044700         MOVE SPACES              TO XL071-RMDL-DTE               04470000
044800     ELSE                                                         04480000
044900         MOVE XLT00010-RMDL-DTE                                   04490000
045000                                  TO XL071-RMDL-DTE               04500000
045100     END-IF.                                                      04510000
045200     IF NI-MEDN-AGE-NBR = -1                                      04520000
045300         MOVE ZEROES              TO XL071-MEDN-AGE-NBR           04530000
045400     ELSE                                                         04540000
045500         MOVE XLT00010-MEDN-AGE-NBR                               04550000
045600                                  TO XL071-MEDN-AGE-NBR           04560000
045700     END-IF.                                                      04570000
045800     IF NI-EST-HH-INCM-AMT = -1                                   04580000
045900         MOVE ZEROES              TO XL071-EST-HH-INCM-AMT        04590000
046000     ELSE                                                         04600000
046100         MOVE XLT00010-EST-HH-INCM-AMT                            04610000
046200                                  TO XL071-EST-HH-INCM-AMT        04620000
046300     END-IF.                                                      04630000
046400     IF NI-QTR-SLS-INCL-DTE = -1                                  04640000
046500         MOVE SPACES              TO XL071-QTR-SLS-INCL-DTE       04650000
046600     ELSE                                                         04660000
046700         MOVE XLT00010-QTR-SLS-INCL-DTE                           04670000
046800                                  TO XL071-QTR-SLS-INCL-DTE       04680000
046900     END-IF.                                                      04690000
047000     IF NI-SEA-SLS-INCL-DTE = -1                                  04700000
047100         MOVE SPACES              TO XL071-SEA-SLS-INCL-DTE       04710000
047200     ELSE                                                         04720000
047300         MOVE XLT00010-SEA-SLS-INCL-DTE                           04730000
047400                                  TO XL071-SEA-SLS-INCL-DTE       04740000
047500     END-IF.                                                      04750000
047600     IF NI-EXTD-MALL-NM = -1                                      04760000
047700         MOVE SPACES              TO XL071-EXTD-MALL-NM           04770000
047800     ELSE                                                         04780000
047900         MOVE XLT00010-EXTD-MALL-NM                               04790000
048000                                  TO XL071-EXTD-MALL-NM           04800000
048100     END-IF.                                                      04810000
048200     IF NI-GRND-OPN-DTE = -1                                      04820000
048300         MOVE SPACES              TO XL071-GRND-OPN-DTE           04830000
048400     ELSE                                                         04840000
048500         MOVE XLT00010-GRND-OPN-DTE                               04850000
048600                                  TO XL071-GRND-OPN-DTE           04860000
048700     END-IF.                                                      04870000
048800     IF NI-DIRNS-TXT = -1                                         04880000
048900         MOVE SPACES              TO XL071-DIRNS-TXT-TEXT         04890000
049000     ELSE                                                         04900000
049100         MOVE XLT00010-DIRNS-TXT  TO XL071-DIRNS-TXT-TEXT         04910000
049200     END-IF.                                                      04920000
049300     IF NI-PRCHG-CRE-IND = -1                                     04930000
049400         MOVE SPACES              TO XL071-PRCHG-CRE-IND          04940000
049500     ELSE                                                         04950000
049600         MOVE XLT00010-PRCHG-CRE-IND                              04960000
049700                                  TO XL071-PRCHG-CRE-IND          04970000
049800     END-IF.                                                      04980000
049900     IF NI-IN-STR-PRCHG-IND = -1                                  04990000
050000         MOVE SPACES              TO XL071-IN-STR-PRCHG-IND       05000000
050100     ELSE                                                         05010000
050200         MOVE XLT00010-IN-STR-PRCHG-IND                           05020000
050300                                  TO XL071-IN-STR-PRCHG-IND       05030000
050400     END-IF.                                                      05040000
050500     MOVE XLT00010-LAST-UPD-TMST  TO XL071-LAST-UPD-TMST.         05050000
050600                                                                  05060000
050700     MOVE XLT00010-LOC-TYP-CDE    TO XL071-LOC-TYP-CDE.           05070000
050800     MOVE XLT00015-LOC-TYP-DESC   TO XL071-LOC-TYP-DESC.          05080000
050900     MOVE XLT00010-STD-TM-ZN-CDE  TO XL071-STD-TM-ZN-CDE.         05090000
051000     MOVE XLT00016-STD-TM-ZN-DESC TO XL071-STD-TM-ZN-DESC.        05100000
051100     MOVE XLT00010-STR-FMT-CDE    TO XL071-STR-FMT-CDE.           05110000
051200     MOVE XLT00017-STR-FMT-DESC   TO XL071-STR-FMT-DESC.          05120000
051300                                                                  05130000
051400******************************************************************05140000
051500*  SELECT XLT_DC_LOC_ASGMT ROW.                                  *05150000
051600******************************************************************05160000
051700 1400-GET-DC-ASGMT.                                               05170000
                                                                        05170103
           MOVE ZEROS TO XL071-ASGMT-DC-NBR.                            05171003
           MOVE PV-INIT-DATE TO XL071-ASGMT-EFF-BEG-DTE,                05172003
                                XL071-ASGMT-EFF-STP-DTE,                05173003
                                XL071-ASGMT-PO-STRT-DTE,                05174003
                                XL071-ASGMT-PO-STP-DTE.                 05175003
051800                                                                  05180000
051900     EXEC SQL                                                     05190000
052000         SELECT A.EFF_BEG_DTE                                     05200000
052100              , A.PO_STRT_DTE                                     05210000
052200              , A.DC_NBR                                          05220000
052300           INTO :XLT00014-EFF-BEG-DTE                             05230000
052400              , :XLT00014-PO-STRT-DTE                             05240000
052500                  :NI-ASGMT-PO-DTE                                05250000
052600              , :XLT00014-DC-NBR                                  05260000
052700           FROM XLT_DC_LOC_ASGMT A                                05270000
052800          WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 05280000
052900            AND A.EFF_BEG_DTE =                                   05290000
053000                (SELECT MAX(EFF_BEG_DTE)                          05300000
053100                   FROM XLT_DC_LOC_ASGMT B                        05310000
053200                  WHERE B.LOC_NBR = :XLT00010-LOC-NBR             05320002
053210                    AND DATE(EFF_BEG_DTE) <= CURRENT DATE         05321002
053220                )                                                 05322002
053300     END-EXEC.                                                    05330000
053400                                                                  05340000
053500     EVALUATE TRUE                                                05350000
053600       WHEN SQLCODE = ZERO                                        05360003
                 IF XL071-CLO-DTE < '9999-09-09'                        05361006
                     IF NI-STP-ORD-DAYS-QTY = -1                        05361106
                       MOVE XL071-CLO-DTE TO XL071-ASGMT-EFF-STP-DTE    05362006
                       MOVE XL071-CLO-DTE TO XL071-ASGMT-PO-STP-DTE     05362106
                     ELSE                                               05363006
                       MOVE PV-STOP-DATE  TO XL071-ASGMT-EFF-STP-DTE    05364025
                       MOVE PV-STOP-DATE  TO XL071-ASGMT-PO-STP-DTE     05365006
                     END-IF                                             05366006
                 ELSE                                                   05368004
                     CONTINUE                                           05369004
                 END-IF                                                 05369104
                                                                        05369204
053700           MOVE XLT00014-EFF-BEG-DTE TO XL071-ASGMT-EFF-BEG-DTE   05370003
053800           IF NI-ASGMT-PO-DTE = -1                                05380000
053900               MOVE SPACES TO XL071-ASGMT-PO-STRT-DTE             05390003
054000           ELSE                                                   05400000
054100               MOVE XLT00014-PO-STRT-DTE                          05410003
                                 TO XL071-ASGMT-PO-STRT-DTE             05411003
054200           END-IF                                                 05420000
054300           MOVE XLT00014-DC-NBR TO XL071-ASGMT-DC-NBR             05430000
054400           SET XL071-NO-ERRORS  TO TRUE                           05440000
054500                                                                  05450000
054600       WHEN SQLCODE = +100                                        05460000
054700           SET XL071-DC-ASGMT-NOT-FND TO TRUE                     05470000
026600           MOVE SQLCODE             TO XL071-SQLCODE-N            05471026
054800                                                                  05480000
054900       WHEN OTHER                                                 05490000
055000           INITIALIZE XL071-RETURN-DATA                           05500000
055100           MOVE SQLCA               TO XL071-SQLCA                05510000
055200           MOVE SQLCODE             TO PV-SQLCODE                 05520000
026600                                       XL071-SQLCODE-N            05521026
055300           MOVE PV-SQLCODE          TO PV-DISPLAY-SQLCODE         05530000
055400           MOVE PV-DISPLAY-SQLCODE  TO XL071-SQLCODE              05540000
055500           SET XL071-BAD-DB2-RETURN TO TRUE                       05550000
055600           MOVE 'XLT00014'          TO XL071-DB2-TABLE            05560000
055700           GOBACK                                                 05570000
055800                                                                  05580000
055900     END-EVALUATE.                                                05590000
