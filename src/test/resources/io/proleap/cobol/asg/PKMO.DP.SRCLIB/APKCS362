000100*************************                                         00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300*************************                                         00030004
000400 PROGRAM-ID.    APKCS362.                                         00040004
000500 AUTHOR.        MARK BURNSIDE.                                    00050004
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
000700 DATE-WRITTEN.  01-15-99.                                         00070040
000800 DATE-COMPILED.                                                   00080004
000900******************************************************************00090004
001000*    A362 - ADJUSTMENT HEADER INQUIRY                            *00100004
001100*                                                                *00110004
001200*    THIS PROGRAM ALLOWS THE USER TO VIEW ADJUSTMENT HEADER      *00120004
001300*    DATA.                                                       *00130067
001400*    CONTROL WILL BE PASSED TO THE ADJUSTMENT DISTRIBUTION       *00140068
001500*    INQUIRY WHEN THE PF22 KEY IS PRESSED.                       *00150068
001600******************************************************************00160068
001700*                                                                *00170068
001800* CHANGE LOG:                                                    *00180068
001900* DATE  12/09/99                                                 *00190068
002000*    CHANGE MADE:  MODIFIED THE CHECK ON THE DATE ROUTINE TO     *00200068
002100*    COMPLY WITH Y2K STANDARDS.                                  *00210068
002200*    MADE BY: MARK BURNSIDE                   WR/IR #: 6041      *00220068
002300*                                                                *00230069
002400* DATE  08/23/00                                                 *00240069
002500*    CHANGE MADE:  ADDED CODE TO RETRIEVE AND DISPLAY 2 NEW COLS *00250069
002600*    FROM THE TADJRNL TABLE - MOS_DISC_PCT AND MOS_DISC_AMT.     *00260069
002700*    MADE BY: MIKE BESKE                      WR/IR #: 20224     *00270069
002800*                                                                *00280069
002900* DATE  12/12/2000                                               *00290072
003000*    CHANGE MADE:  CHANGED LENGTH OF VENDOR IDENTIFICATION FROM  *00300073
003100*    TEN CHARACTERS TO NINE CHARACTERS TO IMPROVE EFFICIENCY OF  *00310073
003200*    SQL CALL TO ADJUSTMENT JOURNAL HEADER DB2 TABLE.            *00320073
003300*    MADE BY: MARK BURNSIDE                   WR/IR #: 21699     *00330073
003400*                                                                *00340073
003500* DATE  01/24/2002                                               *00350078
003600*    CHANGE MADE: ADDED TWO MORE BYTES TO THE END OF THE         *00360076
003700*    DISCOUNT STORAGE FIELDS, SO THAT THE PERCENTAGE WILL NOT    *00370076
003800*    BE TRUNCATED AND STORED ON THE TADJRNL TABLE INCORRECTLY.   *00380076
003900*    MODIFIED PARAGRAPHS 4200 AND 5010, SO ON UPDATES THE        *00390076
004000*    DATABASE FIELDS WILL BE MOVED FOR PS_PSTG_IND, PS_BTCH_NBR, *00400076
004100*    ORGN_CDE, DOC_EXTR_IND, AND DOC_EXTR_DTE INSTEAD OF HARD    *00410076
004200*    CODING.                                                     *00420076
004300*    MADE BY: KEVIN CATLIN            WR/IR #:  PM00444221       *00430076
004400*                                                                *00440073
004500* DATE  05/16/2002                                               *00450085
004600*    CHANGE MADE:  NI-SKU CHANGES.  THE 3 BYTE SKU-SEQ FIELD IS  *00460079
004700*    REPLACED WITH A NUMERIC 8 BYTE SKU FIELD.  CHANGES MADE TO  *00470079
004800*    WORKING STORAGE FIELDS AND TO PARAGRAPHS 4018, 4200, 4400,  *00480079
004900*    AND 5010.                                                   *00490079
005000*    MADE BY: KEVIN CATLIN                    WR/IR #: 21278     *00500079
005100*                                                                *00510079
005200* DATE  07/28/2006                                               *00520087
005300*     CHANGE MADE:  RECOMPILE FROM PRODUCTION TO PICK UP CHANGES *00530087
005400*     TO APWS363 COPYBOOK.                                       *00540087
005500*     MADE BY: MIKE BESKE              WR/IR #: WR30824          *00550087
005600*                                                                *00560087
005700* DATE  07/31/2006                                               *00570088
005800*     CHANGE MADE:  ADDED CODE TO DISPLAY THE INVENTORY CUTOFF   *00580089
005900*     DATE ON THE CICS SCREEN.                                   *00590089
006000*     MOD PARAS: 4400-                                           *00600089
006100*     MADE BY: MIKE BESKE              WR/IR #: WR30990          *00610088
006200*                                                                *00620088
006210* DATE  01/26/2010                                               *00621092
006220*     CHANGE MADE:  DELETED THE INVENTORY CUTOFF DATE ON THE     *00622090
006230*     CICS SCREEN.                                               *00623090
006240*     MOD PARAS: 4400-                                           *00624090
006250*     MADE BY: BARB SCHULTZ            WR/IR #: WR37487          *00625090
006260*                                                                *00626090
006261* DATE  10/24/2022                                               *00626194
006262*     CHANGE MADE: ADD COPYBOOK DPWS930                          *00626295
006263*     CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API   *00626395
006264*     MADE BY: BOB MCASEY              WR/IR #: CHG0276864       *00626495
006300******************************************************************00630073
006400                                                                  00640073
006500 ENVIRONMENT DIVISION.                                            00650073
006600                                                                  00660073
006700 DATA DIVISION.                                                   00670073
006800                                                                  00680073
006900 WORKING-STORAGE SECTION.                                         00690073
007000                                                                  00700073
007100 01  DK-DB2-KEYS.                                                 00710073
007200     05  DK-DOCUMENT-NO-LOW             PIC  X(16)  VALUE         00720073
007300                                                      LOW-VALUES. 00730073
007400     05  DK-DOCUMENT-NO-HIGH            PIC  X(16)  VALUE         00740073
007500                                                      HIGH-VALUES.00750073
007600     05  DK-TRAN-CODE-LOW               PIC  X(02)  VALUE         00760073
007700                                                      LOW-VALUES. 00770073
007800     05  DK-TRAN-CODE-HIGH              PIC  X(02)  VALUE         00780073
007900                                                      HIGH-VALUES.00790073
008000     05  DK-VEND-NUMBER-LOW             PIC  X(09)  VALUE         00800073
008100                                                    LOW-VALUES.   00810073
008200     05  DK-VEND-NUMBER-HIGH            PIC  X(09)  VALUE         00820073
008300                                                    HIGH-VALUES.  00830073
008400     05  DK-PO-NBR-LOW                  PIC  S9(09) VALUE +0      00840073
008500                                                    COMP.         00850073
008600     05  DK-PO-NBR-HIGH                 PIC  S9(09) VALUE +0      00860073
008700                                                    COMP.         00870073
008800     05  DK-DOC-DATE-LOW                PIC   X(10) VALUE         00880073
008900                                                     '0001-01-01'.00890073
009000     05  DK-DOC-DATE-HIGH               PIC   X(10) VALUE         00900073
009100                                                     '9999-01-01'.00910073
009200*                                                                 00920073
009300 01  PC-PROGRAM-CONSTANTS.                                        00930073
009400     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'AP362A  '.  00940073
009500     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'APKM362 '.  00950073
009600     05  PC-APPL-MAP              PIC S9(04)  VALUE +1            00960073
009700                                              COMP.               00970073
009800     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'APKCS362'.  00980073
009900     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00990073
010000                                              COMP.               01000073
010100     05  PC-SEL-QUEUE-ITEM        PIC S9(04)  VALUE  +1           01010073
010200                                              COMP SYNC.          01020073
010300     05  PC-SEL-QUEUE-SEQ         PIC  9(01)  VALUE 3.            01030073
010400     05  PC-TSYMSG-NUMBERS.                                       01040073
010500         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       01050073
010600         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       01060073
010700         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       01070073
010800         10  PC-TSYMSG-01932      PIC  9(05)  VALUE  01932.       01080073
010900         10  PC-TSYMSG-01943      PIC  9(05)  VALUE  01943.       01090073
011000*                                                                 01100073
011100 01  PS-PROGRAM-SWITCHES.                                         01110073
011200     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01120073
011300         88  PS-ERROR                         VALUE  'Y'.         01130073
011400         88  PS-NO-ERROR                      VALUE  'N'.         01140073
011500*                                                                 01150073
011600 01  PV-PROGRAM-VARIABLES.                                        01160073
011700     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01170073
011800                                              COMP SYNC.          01180073
011900     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01190073
012000                                              COMP SYNC.          01200073
012100     05  PV-3V99                  PIC  ZZ9.99.                    01210073
012200     05  PV-3V99-X REDEFINES                                      01220073
012300         PV-3V99                  PIC  X(06).                     01230073
012400     05  PV-NUM9                  PIC  Z(09).                     01240073
012500     05  PV-NUM9-X REDEFINES                                      01250073
012600         PV-NUM9                  PIC  X(09).                     01260073
012700     05  PV-NUM4                  PIC  9(04).                     01270073
012800     05  PV-NUM4-X REDEFINES                                      01280073
012900         PV-NUM4                  PIC  X(04).                     01290073
013000     05  PV-NUM8                  PIC  9(08).                     01300079
013100     05  PV-NUM8-X REDEFINES                                      01310079
013200         PV-NUM8                  PIC  X(08).                     01320079
013300     05  PV-10V99                 PIC  ----------.99.             01330073
013400     05  PV-10V99-X REDEFINES                                     01340073
013500         PV-10V99                 PIC  X(13).                     01350073
013600     05  PV-6V99                  PIC  ------.99.                 01360073
013700     05  PV-6V99-X REDEFINES                                      01370073
013800         PV-6V99                  PIC  X(09).                     01380073
013900     05  PV-PERCENT-VARIABLE            PIC  S9(01)V9(4).         01390074
014000     05  PV-ENTRY-ID                    PIC  X(08).               01400073
014100     05  PV-SEL-QUEUE-NAME.                                       01410073
014200         10  PV-SEL-TERM-ID             PIC   X(04).              01420073
014300         10  PV-SEL-TASK-NUMBER         PIC  S9(05) COMP-3.       01430073
014400         10  PV-SEL-SEQ                 PIC   9(01).              01440073
014500     05  PV-TRAN-CODE-FETCH-IND         PIC  X(02).               01450073
014600         88  PV-TRANSFER-TRAN-CODE           VALUE '52'           01460073
014700                                                   '53'           01470073
014800                                                   '82'.          01480073
014900 EJECT                                                            01490073
015000******************************************************************01500073
015100*    RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.    *01510073
015200******************************************************************01520073
015300                                                                  01530073
015400     COPY APWS362.                                                01540073
015500     EJECT                                                        01550073
015600******************************************************************01560073
015700*     RECORD LAYOUT FOR TEMP STORAGE QUEUE FOR PASSING HEADER    *01570073
015800*     ADJUSTMENT DATA TO DETAIL SCREENS.                         *01580073
015900******************************************************************01590073
016000                                                                  01600073
016100     COPY APWS363.                                                01610073
016200                                                                  01620073
016300******************************************************************01630073
016400*    MAP LAYOUT                                                  *01640073
016500******************************************************************01650073
016600                                                                  01660073
016700     COPY APKM362.                                                01670073
016800                                                                  01680073
016900     EJECT                                                        01690073
017000******************************************************************01700073
017100*    ATTRIBUTE SETTINGS COPYBOOK.                                *01710073
017200******************************************************************01720073
017300                                                                  01730073
017400     COPY DPWS015.                                                01740073
017500                                                                  01750073
017600******************************************************************01760073
017700*    FUNCTION KEYS COPYBOOK                                      *01770073
017800******************************************************************01780073
017900                                                                  01790073
018000     COPY DPWS016.                                                01800073
018100 EJECT                                                            01810073
018200                                                                  01820073
018300******************************************************************01830073
018400*    WORK AREA FOR NUMERIC EDIT ROUTINE                          *01840073
018500******************************************************************01850073
018600     COPY DPWS010I.                                               01860073
018700******************************************************************01870073
018800* PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).       *01880073
018900******************************************************************01890073
019000     COPY DPWS030.                                                01900073
019010     COPY DPWS930.                                                01901095
019100 EJECT                                                            01910073
019200******************************************************************01920073
019300*    STANDARD COMMAREA.                                          *01930073
019400******************************************************************01940073
019500                                                                  01950073
019600     COPY DPWS020.                                                01960073
019700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01970073
019800                                                                  01980073
019900******************************************************************01990073
020000*    INTER-APPLICATION COMMAREA.                                 *02000073
020100******************************************************************02010073
020200                                                                  02020073
020300         10  INTER-APPL-COMM-AREA PIC X(200).                     02030073
020400     COPY APWS361.                                                02040073
020500******************************************************************02050073
020600*    SPECIFIC COMMMAREA FOR APKCS362.                            *02060073
020700******************************************************************02070073
020800         10  ASC-SPECIFIC-COMMAREA.                               02080073
020900             15  ASC-INT-APPL-FORMAT-IND     PIC  X(01).          02090073
021000                 88  ASC-INTER-APPL-CRIT-INQUIRE        VALUE '7'.02100073
021100                 88  ASC-INTER-APPL-LIST-INQUIRE        VALUE '8'.02110073
021200             15  ASC-RETURN-SW               PIC  X(01).          02120073
021300                 88  ASC-RETURN-FROM-DISTRO  VALUE 'D'.           02130073
021400                 88  ASC-OTHER-RETURN        VALUE ' '.           02140073
021500             15  ASC-REQUEST-SW              PIC  X(03).          02150073
021600                 88  ASC-DELETE-REQUESTED    VALUE 'DEL'.         02160073
021700                 88  ASC-UPDATE-REQUESTED    VALUE 'UPD'.         02170073
021800             15  ASC-ACTION-SW               PIC  X(03).          02180073
021900                 88  ASC-DELETE-ALLOWED      VALUE '   '.         02190073
022000                 88  ASC-NO-CHANGES-ALLOWED  VALUE 'NOC'.         02200073
022100                 88  ASC-DELETE-PENDING      VALUE 'DEL'.         02210073
022200                 88  ASC-UPDATE-PENDING      VALUE 'UPD'.         02220073
022300                 88  ASC-RETURN              VALUE 'RET'.         02230073
022400             15  ASC-DELETE-SUCCESSFUL-SW    PIC  X(01).          02240073
022500                 88  ASC-DELETE-SUCCESSFUL   VALUE 'Y'.           02250073
022600             15  ASC-ADD-SUCCESSFUL-SW       PIC  X(01).          02260073
022700                 88  ASC-ADD-NOT-SUCCESSFUL  VALUE ' '.           02270073
022800                 88  ASC-ADD-SUCCESSFUL      VALUE 'Y'.           02280073
022900             15  ASC-FIELDS-MODIFIED-SW      PIC  X(01).          02290073
023000                 88  ASC-FIELDS-MODIFIED     VALUE 'Y'.           02300073
023100             15  ASC-ADJUST-FOUND-SW         PIC  X(01).          02310073
023200                 88  ASC-ADJUST-FOUND        VALUE 'Y'.           02320073
023300                 88  ASC-ADJUST-NOT-FOUND    VALUE 'N'.           02330073
023400             15  ASC-DUP-DOC-NO-SW           PIC  X(01).          02340073
023500                 88  ASC-DUP-DOC                        VALUE 'Y'.02350073
023600                 88  ASC-NO-DUP-DOC                     VALUE 'N'.02360073
023700             15  ASC-SELECT-ACTION-SW        PIC   X(01).         02370073
023800                 88  ASC-SELECT-ADD                     VALUE 'A'.02380073
023900                 88  ASC-SELECT-UPDATE                  VALUE 'U'.02390073
024000                 88  ASC-SELECT-DELETE                  VALUE 'D'.02400073
024100             15  ASC-DOCUMENT-FOUND-SW       PIC   X(01).         02410073
024200                 88  ASC-DOCUMENT-FOUND                 VALUE 'Y'.02420073
024300                 88  ASC-DOCUMENT-NOT-FOUND             VALUE 'N'.02430073
024400                 88  ASC-MULTIPLE-DOCUMENTS             VALUE 'M'.02440073
024500             15  ASC-ALLOCATION-SW           PIC   X(01).         02450073
024600                 88 ASC-GROSS-COST-ALLOCATION          VALUE 'G'. 02460073
024700                 88 ASC-RETAIL-AMT-ALLOCATION          VALUE 'R'. 02470073
024800                 88 ASC-FREIGHT-COST-ALLOCATION        VALUE 'F'. 02480073
024900             15  ASC-MULT-DISTRO-IND         PIC  X(01).          02490073
025000                 88  ASC-MULT-DIST                      VALUE 'Y'.02500073
025100                 88  ASC-SINGLE-DIST                    VALUE 'N'.02510073
025200             15  ASC-KEY-FIELDS.                                  02520073
025300                 20  ASC-KEY-VEND-NUMBER     PIC  X(09).          02530073
025400                 20  ASC-KEY-PO-NBR          PIC  S9(09).         02540073
025500                 20  ASC-KEY-TRAN-CODE       PIC  X(02).          02550073
025600                 20  ASC-KEY-DOC-NUMBER      PIC  X(16).          02560073
025700                 20  ASC-KEY-DOC-DATE        PIC  X(10).          02570073
025800             15  ASC-ALPHA-FIELDS.                                02580073
025900                 20  ASC-ALP-PO-NBR          PIC  X(09).          02590073
026000                 20  ASC-ALP-PO-NBR-9  REDEFINES                  02600073
026100                         ASC-ALP-PO-NBR     PIC  9(09).           02610073
026200                 20  ASC-ALP-STORE-NBR       PIC  X(04).          02620073
026300                 20  ASC-ALP-NET-COST.                            02630073
026400                     25  ASC-ALP-NET-COST-9  PIC   9(10)V99.      02640073
026500                 20  ASC-ALP-RET-COST        PIC   X(13).         02650073
026600                 20  ASC-ALP-RET-COST-9  REDEFINES                02660073
026700                         ASC-ALP-RET-COST    PIC  -9(10)V99.      02670073
026800                 20  ASC-ALP-GROSS-COST      PIC   X(13).         02680073
026900                 20  ASC-ALP-GRO-COST-9  REDEFINES                02690073
027000                         ASC-ALP-GROSS-COST  PIC  -9(10)V99.      02700073
027100                 20  ASC-ALP-FREIGHT-COST    PIC   X(13).         02710073
027200                 20  ASC-ALP-FRT-COST-9  REDEFINES                02720073
027300                        ASC-ALP-FREIGHT-COST PIC  -9(10)V99.      02730073
027400                 20  ASC-ALP-MISC-CHG        PIC    X(13).        02740073
027500                 20  ASC-ALP-MISC-CHG-9  REDEFINES                02750073
027600                        ASC-ALP-MISC-CHG     PIC  -9(10)V99.      02760073
027700                 20  ASC-ALP-DISC-PCT        PIC    X(08).        02770074
027800                 20  ASC-ALP-DISC-PCT-9  REDEFINES                02780073
027900                        ASC-ALP-DISC-PCT     PIC   9(04)V9(4).    02790074
028000                 20  ASC-ALP-MOS-PCT         PIC    X(08).        02800074
028100                 20  ASC-ALP-MOS-PCT-9   REDEFINES                02810073
028200                        ASC-ALP-MOS-PCT      PIC   9(04)V9(4).    02820074
028300                 20  ASC-ALP-NEW-STR-PCT     PIC    X(08).        02830074
028400                 20  ASC-ALP-NEW-STR-PCT-9 REDEFINES              02840073
028500                        ASC-ALP-NEW-STR-PCT  PIC   9(04)V9(4).    02850074
028600                 20  ASC-ALP-TRADE-PCT       PIC    X(08).        02860074
028700                 20  ASC-ALP-TRADE-PCT-9   REDEFINES              02870073
028800                        ASC-ALP-TRADE-PCT    PIC   9(04)V9(4).    02880074
028900                 20  ASC-ALP-DET-COST        PIC   X(13).         02890073
029000                 20  ASC-ALP-DET-COST-9  REDEFINES                02900073
029100                         ASC-ALP-DET-COST    PIC  -9(10)V99.      02910073
029200                 20  ASC-ALP-DET-RETL        PIC   X(13).         02920073
029300                 20  ASC-ALP-DET-RETL-9  REDEFINES                02930073
029400                         ASC-ALP-DET-RETL    PIC  -9(10)V99.      02940073
029500                 20  ASC-ALP-DET-STORE       PIC   X(04).         02950073
029600                 20  ASC-ALP-DET-SKU         PIC   X(08).         02960081
029700                 20  ASC-ALP-DET-SKU-9   REDEFINES                02970079
029800                         ASC-ALP-DET-SKU     PIC   9(08).         02980081
029900             15  ASC-CURR-PSTG-FYR-NBR       PIC  X(04).          02990073
030000             15  ASC-CURR-PSTG-FMN-NBR       PIC  X(02).          03000073
030100             15  ASC-CURR-PSTG-FWK-NBR       PIC  X(02).          03010073
030200             15  ASC-PREV-PSTG-FYR-NBR       PIC  X(04).          03020073
030300             15  ASC-PREV-PSTG-FMN-NBR       PIC  X(02).          03030073
030400             15  ASC-PREV-PSTG-FWK-NBR       PIC  X(02).          03040073
030500             15  ASC-TRN-TYP-CDE             PIC  X(03).          03050073
030600             15  ASC-COST-PRCCTL-CDE         PIC  X(01).          03060073
030700             15  ASC-RTL-PRCCTL-CDE          PIC  X(01).          03070073
030800             15  ASC-PSTG-TYP-CDE            PIC  X(02).          03080073
030900             15  ASC-SKU-SEQ-REQR-IND        PIC  X(01).          03090073
031000             15  ASC-SUB-CL-REQR-IND         PIC  X(01).          03100073
031100             15  ASC-FRGT-REQR-IND           PIC  X(01).          03110073
031200             15  ASC-PS-BATCH-NBR            PIC  X(15).          03120076
031300             15  ASC-PS-POSTING-IND          PIC  X(01).          03130076
031400             15  ASC-DOC-EXTRACT-IND         PIC  X(01).          03140076
031500             15  ASC-DOC-EXTRACT-DTE         PIC  X(10).          03150076
031600             15  ASC-ORIGIN-CDE              PIC  X(01).          03160076
031700             15  ASC-DECIMAL-FIELDS.                              03170073
031800                 20  ASC-GROSS-CST-X         PIC  X(13).          03180073
031900                 20  ASC-RETAIL-AMT-X        PIC  X(13).          03190073
032000                 20  ASC-FREIGHT-AMT-X       PIC  X(13).          03200073
032100                 20  ASC-MISC-CHG-X          PIC  X(13).          03210073
032200                 20  ASC-DISC-PCT-X          PIC  X(08).          03220074
032300                 20  ASC-MOS-PCT-X           PIC  X(08).          03230074
032400                 20  ASC-NEWST-PCT-X         PIC  X(08).          03240074
032500                 20  ASC-TRADE-PCT-X         PIC  X(08).          03250074
032600                 20  ASC-NET-COST-X          PIC  X(13).          03260073
032700                 20  ASC-DET-COST-X          PIC  X(13).          03270073
032800                 20  ASC-DET-RETAIL-X        PIC  X(13).          03280073
032900                 20  ASC-DET-NET-X           PIC  X(13).          03290073
033000             15  ASC-CURRENT-DATE            PIC  X(10).          03300073
033100             15  ASC-SCREEN-FIELDS.                               03310073
033200                 20  ASC-TRAN-CD             PIC  X(02).          03320073
033300                 20  ASC-DOC-NUMBER          PIC  X(16).          03330073
033400                 20  ASC-VENDOR-NUMBER       PIC  X(09).          03340073
033500                 20  ASC-PO-NUMBER           PIC  S9(09).         03350073
033600                 20  ASC-VENDOR-NAME         PIC  X(25).          03360073
033700                 20  ASC-BARCODE             PIC  X(09).          03370073
033800                 20  ASC-STORE               PIC   9(04).         03380073
033900                 20  ASC-DOC-DATE            PIC  X(10).          03390073
034000                 20  ASC-DOC-DATE-RDF REDEFINES                   03400073
034100                     ASC-DOC-DATE.                                03410073
034200                     25  ASC-DOC-DATE-CC     PIC  X(02).          03420073
034300                     25  ASC-DOC-DATE-YY     PIC  X(02).          03430073
034400                     25  FILLER              PIC  X(01).          03440073
034500                     25  ASC-DOC-DATE-MM     PIC  X(02).          03450073
034600                     25  FILLER              PIC  X(01).          03460073
034700                     25  ASC-DOC-DATE-DD     PIC  X(02).          03470073
034800                 20  ASC-DEPARTMENT          PIC  X(03).          03480073
034900                 20  ASC-ACCT-NO             PIC  X(06).          03490073
035000                 20  ASC-VENDOR-AUTH         PIC  X(10).          03500073
035100                 20  ASC-GROSS-COST          PIC  S9(10)V99.      03510073
035200                 20  ASC-RETAIL-AMT          PIC  S9(10)V99.      03520073
035300                 20  ASC-FREIGHT-AMT         PIC  S9(10)V99.      03530073
035400                 20  ASC-MISC-CHG            PIC  S9(10)V99.      03540073
035500                 20  ASC-DISC-PCT            PIC  S9(03)V9(4).    03550074
035600                 20  ASC-DISC-AMT            PIC  S9(06)V99.      03560073
035700                 20  ASC-MOS-PCT             PIC  S9(03)V9(4).    03570074
035800                 20  ASC-MOS-AMT             PIC  S9(06)V99.      03580073
035900                 20  ASC-NEWST-PCT           PIC  S9(03)V9(4).    03590074
036000                 20  ASC-NEWST-AMT           PIC  S9(06)V99.      03600073
036100                 20  ASC-HOLD-STATUS         PIC  X(01).          03610073
036200                 20  ASC-TRADE-PCT           PIC  S9(03)V9(4).    03620074
036300                 20  ASC-TRADE-AMT           PIC  S9(06)V99.      03630073
036400                 20  ASC-NET-COST            PIC  S9(10)V99.      03640073
036500                 20  ASC-USER-ID             PIC  X(08).          03650073
036600                 20  ASC-PSTG-MTH            PIC  X(02).          03660073
036700                 20  ASC-PSTG-WEEK           PIC  X(02).          03670073
036800                 20  ASC-CUTOFF-DATE         PIC  X(10).          03680091
036900                 20  ASC-CUTOFF-DATE-RDF REDEFINES                03690091
037000                     ASC-CUTOFF-DATE.                             03700091
037100                     25  ASC-CUTOFF-CC       PIC  X(02).          03710091
037200                     25  ASC-CUTOFF-YY       PIC  X(02).          03720091
037300                     25  FILLER              PIC  X(01).          03730091
037400                     25  ASC-CUTOFF-MM       PIC  X(02).          03740091
037500                     25  FILLER              PIC  X(01).          03750091
037600                     25  ASC-CUTOFF-DD       PIC  X(02).          03760091
037700                 20  ASC-DUE-DATE            PIC  X(10).          03770073
037800                 20  ASC-DUE-DATE-RDF REDEFINES                   03780073
037900                     ASC-DUE-DATE.                                03790073
038000                     25  ASC-DUE-DATE-CC     PIC  X(02).          03800073
038100                     25  ASC-DUE-DATE-YY     PIC  X(02).          03810073
038200                     25  FILLER              PIC  X(01).          03820073
038300                     25  ASC-DUE-DATE-MM     PIC  X(02).          03830073
038400                     25  FILLER              PIC  X(01).          03840073
038500                     25  ASC-DUE-DATE-DD     PIC  X(02).          03850073
038600                 20  ASC-REASON-CODE1        PIC  X(50).          03860073
038700                 20  ASC-REASON-CODE2        PIC  X(50).          03870073
038800                 20  ASC-DET-STORE           PIC  9(04).          03880073
038900                 20  ASC-DET-CLASS           PIC  X(02).          03890073
039000                 20  ASC-DET-SKU             PIC  S9(08).         03900079
039100                 20  ASC-DET-COST            PIC  S9(10)V99.      03910073
039200                 20  ASC-DET-RETAIL          PIC  S9(10)V99.      03920073
039300                 20  ASC-DET-NET             PIC  S9(10)V99.      03930073
039400                 20  ASC-DET-DISTRB-SEQ      PIC  S9(09).         03940073
039500             15  ASC-USE-SELECTION-QUEUE-IND PIC  X(01).          03950073
039600                 88  ASC-USE-SELECTION-QUEUE            VALUE 'Y'.03960073
039700             15  ASC-SEL-QUEUE-NAME          PIC  X(08).          03970073
039800             15  ASC-TS-QUEUE-NAME           PIC  X(08).          03980073
039900             15  ASC-NUMBER-OF-TS-ITEMS      PIC  S9(05).         03990073
040000             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04000073
040100                                             PIC  S9(09).         04010073
040200             15  ASC-SEL-SUB                 PIC  S9(04).         04020073
040300             15  ASC-SEL-ITEM                PIC  S9(04)          04030073
040400                                                    COMP SYNC.    04040073
040500     EJECT                                                        04050073
040600******************************************************************04060073
040700*    ABEND PROCESSING COPYBOOK.                                  *04070073
040800******************************************************************04080073
040900                                                                  04090073
041000     COPY DPWS013.                                                04100073
041100                                                                  04110073
041200*    DB2 AREA FOR TADJRNL                                         04120073
041300                                                                  04130073
041400     EXEC SQL                                                     04140073
041500          INCLUDE TADJRNL                                         04150073
041600     END-EXEC.                                                    04160073
041700                                                                  04170073
041800*    DB2 AREA FOR TAJPSINT                                        04180073
041900                                                                  04190073
042000     EXEC SQL                                                     04200073
042100          INCLUDE TAJPSINT                                        04210073
042200     END-EXEC.                                                    04220073
042300                                                                  04230073
042400*    DB2 AREA FOR TADJDIS                                         04240073
042500                                                                  04250073
042600     EXEC SQL                                                     04260073
042700          INCLUDE TADJDIS                                         04270073
042800     END-EXEC.                                                    04280073
042900                                                                  04290073
043000*    DB2 AREA FOR TEXTENT                                         04300073
043100                                                                  04310073
043200     EXEC SQL                                                     04320073
043300          INCLUDE TEXTENT                                         04330073
043400     END-EXEC.                                                    04340073
043500                                                                  04350073
043600*    DB2 AREA FOR TENTNME                                         04360073
043700                                                                  04370073
043800     EXEC SQL                                                     04380073
043900          INCLUDE TENTNME                                         04390073
044000     END-EXEC.                                                    04400073
044100                                                                  04410073
044200*    DB2 AREA FOR COMMUNICATIONS                                  04420073
044300                                                                  04430073
044400     EXEC SQL                                                     04440073
044500          INCLUDE SQLCA                                           04450073
044600     END-EXEC.                                                    04460073
044700                                                                  04470073
044800 EJECT                                                            04480073
044900 LINKAGE SECTION.                                                 04490073
045000                                                                  04500073
045100 01  DFHCOMMAREA.                                                 04510073
045200     05  FILLER                         OCCURS  1 TO 4072 TIMES   04520073
045300                                        DEPENDING ON EIBCALEN.    04530073
045400         10  FILLER                     PIC  X(01).               04540073
045500                                                                  04550073
045600***************************************************************** 04560073
045700** THIS IS THE CURSOR TO GATHER ONE DISTRIBUTION LINE FOR AN   ** 04570073
045800** ADJUSTMENT.  ONLY ONE FETCH WILL OCCUR.                     ** 04580073
045900***************************************************************** 04590073
046000                                                                  04600073
046100     EXEC SQL                                                     04610073
046200          DECLARE DET-CSR CURSOR FOR                              04620073
046300          SELECT                                                  04630073
046400            VND_NBR                                               04640073
046500           ,DOC_NBR                                               04650073
046600           ,DOC_DTE                                               04660073
046700           ,AP_TRN_CDE                                            04670073
046800           ,DISTRB_SEQ_NBR                                        04680073
046900           ,STR_NBR                                               04690073
047000           ,DEPT_NBR                                              04700073
047100           ,CL_NBR                                                04710073
047200           ,SKU_NBR                                               04720079
047300           ,GRO_COST_AMT                                          04730073
047400           ,RTL_AMT                                               04740073
047500           ,FRGT_AMT                                              04750073
047600           ,MISC_CHRG_AMT                                         04760073
047700           ,DISC_AMT                                              04770073
047800           ,NET_COST_AMT                                          04780073
047900         FROM TADJDIS                                             04790073
048000         WHERE VND_NBR     = :ADJRNL-VND-NBR                      04800073
048100         AND   DOC_NBR     = :ADJRNL-DOC-NBR                      04810073
048200         AND   DOC_DTE     = :ADJRNL-DOC-DTE                      04820073
048300         AND AP_TRN_CDE    = :ADJRNL-AP-TRN-CDE                   04830073
048400         AND DISTRB_SEQ_NBR IS NOT NULL                           04840073
048500         ORDER BY VND_NBR, DOC_NBR, DOC_DTE, AP_TRN_CDE,          04850073
048600                  DISTRB_SEQ_NBR                                  04860073
048700     END-EXEC.                                                    04870073
048800                                                                  04880073
048900 PROCEDURE DIVISION.                                              04890073
049000***************************************************************** 04900073
049100** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 04910073
049200** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 04920073
049300** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 04930073
049400**                                                             ** 04940073
049500** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 04950073
049600** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 04960073
049700***************************************************************** 04970073
049800 0000-MAIN-MODULE.                                                04980073
049900     INITIALIZE DP030-CICS-API-FIELDS.                            04990073
050000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05000073
050100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05010073
050200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05020073
050300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05030073
050400     MOVE LENGTH OF AP362AI        TO DP030-MAP-LENGTH (1).       05040073
050500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05050073
050600     PERFORM 0001-CALL-CICS-ARCH-API.                             05060073
050700                                                                  05070073
050800     PERFORM 1000-CONTROL-PROCESSING.                             05080073
050900                                                                  05090073
051000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05100073
051100     PERFORM 0001-CALL-CICS-ARCH-API.                             05110073
051200                                                                  05120073
051300 0001-CALL-CICS-ARCH-API.                                         05130073
051400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05140094
051500                                    DFHCOMMAREA                   05150094
051600                                    DP030-CICS-API-FIELDS         05160094
051700                                    DP020-STANDARD-COMMAREA       05170094
051800                                    AP362AI.                      05180094
051900                                                                  05190073
052000     IF  DP030-RC-CALL-SUCCESSFUL                                 05200073
052100         CONTINUE                                                 05210073
052200     ELSE                                                         05220073
052300         SET DP013-NO-ROLLBACK                                    05230073
052400             DP013-XCTL-DISPLAY-RESTART                           05240073
052500             DP013-CICS-ABEND      TO TRUE                        05250073
052600         MOVE 'BEFORE 0000-MAIN-MODULE'                           05260073
052700                                   TO DP013-PARAGRAPH             05270073
052800         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05280095
052900-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05290095
053000         MOVE DP030-RETURN-CODE                                   05300073
053100                                   TO DP013-MESSAGE-TEXT (3)      05310073
053200         PERFORM DP013-0000-PROCESS-ABEND                         05320073
053300     END-IF.                                                      05330073
053400 EJECT                                                            05340073
053500******************************************************************05350073
053600*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05360073
053700*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05370073
053800******************************************************************05380073
053900                                                                  05390073
054000 1000-CONTROL-PROCESSING.                                         05400073
054100                                                                  05410073
054200     EVALUATE TRUE                                                05420073
054300         WHEN DP020-NEXT-ACT-INITIAL                              05430073
054400             INITIALIZE ASC-SPECIFIC-COMMAREA                     05440073
054500             PERFORM 1100-FIND-OBJECT-KEYS                        05450073
054600             IF PS-ERROR                                          05460073
054700                CONTINUE                                          05470073
054800             ELSE                                                 05480073
054900                PERFORM 4000-BUILD-INITIAL-PANEL                  05490073
055000                PERFORM 3200-RESET-ATTRIBUTES                     05500073
055100                IF ASC-DOCUMENT-NOT-FOUND                         05510073
055200                   SET DP020-NEXT-ACT-APPL-ERROR TO TRUE          05520073
055300                   MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER       05530073
055400                   SET DP020-MSG-INFORMATIONAL TO TRUE            05540073
055500                END-IF                                            05550073
055600             END-IF                                               05560073
055700                                                                  05570073
055800         WHEN DP020-NEXT-ACT-READ-MAP                             05580073
055900             PERFORM 2000-PROCESS-PANEL                           05590073
056000                                                                  05600073
056100         WHEN DP020-NEXT-ACT-RETURN                               05610073
056200              IF ASC-SELECT-UPDATE                                05620073
056300                 PERFORM 4000-BUILD-INITIAL-PANEL                 05630073
056400              ELSE                                                05640073
056500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05650073
056600              END-IF                                              05660073
056700              PERFORM 3200-RESET-ATTRIBUTES                       05670073
056800                                                                  05680073
056900         WHEN OTHER                                               05690073
057000             SET DP013-LOGIC-ABEND                                05700073
057100                 DP013-NO-ROLLBACK TO TRUE                        05710073
057200             MOVE '1000-CONTROL-PROCESSING'                       05720073
057300                                   TO DP013-PARAGRAPH             05730073
057400             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05740073
057500                                   TO DP013-MESSAGE-TEXT(1)       05750073
057600             MOVE DP020-NEXT-APPL-ACTIVITY                        05760073
057700                                   TO DP013-MESSAGE-TEXT(2)       05770073
057800             PERFORM DP013-0000-PROCESS-ABEND                     05780073
057900     END-EVALUATE.                                                05790073
058000                                                                  05800073
058100******************************************************************05810073
058200*    DETERMINE ACTIONS FOR SCREEN ON INITIAL ENTRY.              *05820073
058300******************************************************************05830073
058400 1100-FIND-OBJECT-KEYS.                                           05840073
058500                                                                  05850073
058600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05860073
058700                                                                  05870073
058800     MOVE AP361-VND-NBR TO ASC-KEY-VEND-NUMBER.                   05880073
058900     MOVE AP361-TRN-CDE TO ASC-KEY-TRAN-CODE.                     05890073
059000     IF AP361-PO-NUMB > ZERO                                      05900073
059100        MOVE AP361-PO-NUMB TO ASC-KEY-PO-NBR                      05910073
059200     END-IF.                                                      05920073
059300     MOVE AP361-DOC-NO     TO ASC-KEY-DOC-NUMBER.                 05930073
059400     MOVE AP361-DOC-DATE   TO ASC-KEY-DOC-DATE.                   05940073
059500                                                                  05950073
059600     MOVE DP020-INT-APPL-FORMAT-IND                               05960073
059700                           TO ASC-INT-APPL-FORMAT-IND.            05970073
059800                                                                  05980073
059900     EVALUATE TRUE                                                05990073
060000        WHEN ASC-INTER-APPL-CRIT-INQUIRE                          06000073
060100             CONTINUE                                             06010073
060200                                                                  06020073
060300        WHEN ASC-INTER-APPL-LIST-INQUIRE                          06030073
060400             SET ASC-USE-SELECTION-QUEUE TO TRUE                  06040073
060500             MOVE AP361-NUMBER-OF-SELECTED-ITEMS                  06050073
060600                                TO ASC-NUMBER-OF-SELECTED-ITEMS   06060073
060700             MOVE AP361-NUMBER-OF-TS-ITEMS                        06070073
060800                                TO ASC-NUMBER-OF-TS-ITEMS         06080073
060900             MOVE AP361-SEL-QUEUE-NAME                            06090073
061000                                TO ASC-SEL-QUEUE-NAME             06100073
061100             PERFORM 1120-PREPARE-LIST-ENTRY                      06110073
061200                                                                  06120073
061300        WHEN OTHER                                                06130073
061400             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             06140073
061500             SET DP020-MSG-FATAL                                  06150073
061600                 DP020-NEXT-ACT-APPL-ERROR                        06160073
061700                 PS-ERROR                 TO TRUE                 06170073
061800     END-EVALUATE.                                                06180073
061900                                                                  06190073
062000******************************************************************06200073
062100* ENTRY IS FROM A LIST.  GET THE FORMAT NUMBER FROM THE TEMP     *06210073
062200* STORAGE QUEUE PASSED FROM THE LIST.                            *06220073
062300******************************************************************06230073
062400 1120-PREPARE-LIST-ENTRY.                                         06240073
062500                                                                  06250073
062600     MOVE AP362-MAX-ITEMS         TO ASC-SEL-SUB.                 06260073
062700     MOVE ZERO                    TO ASC-SEL-ITEM.                06270073
062800     PERFORM 2105-GET-NEXT-RECORD.                                06280073
062900                                                                  06290073
063000******************************************************************06300073
063100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06310073
063200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06320073
063300* EDITS.                                                         *06330073
063400******************************************************************06340073
063500 2000-PROCESS-PANEL.                                              06350073
063600                                                                  06360073
063700     EVALUATE TRUE                                                06370073
063800         WHEN DP020-SRC-AID = DP016-CLEAR                         06380073
063900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06390073
064000             PERFORM 3200-RESET-ATTRIBUTES                        06400073
064100                                                                  06410073
064200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06420073
064300             SET DP030-DONT-ERASE                                 06430073
064400                 DP030-SEND-DATAONLY (PC-APPL-MAP)                06440073
064500                                     TO TRUE                      06450073
064600             PERFORM 4000-BUILD-INITIAL-PANEL                     06460073
064700                                                                  06470073
064800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06480073
064900             IF ASC-USE-SELECTION-QUEUE                           06490073
065000                PERFORM 2105-GET-NEXT-RECORD                      06500073
065100                PERFORM 4000-BUILD-INITIAL-PANEL                  06510073
065200             ELSE                                                 06520073
065300*               --- BOTTOM OF LIST ---                            06530073
065400                MOVE PC-TSYMSG-00070                              06540073
065500                                  TO DP020-MSG-NUMBER             06550073
065600                SET DP020-MSG-INFORMATIONAL                       06560073
065700                                  TO TRUE                         06570073
065800             END-IF                                               06580073
065900                                                                  06590073
066000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06600073
066100             IF ASC-USE-SELECTION-QUEUE                           06610073
066200                PERFORM 2120-GET-PREV-RECORD                      06620073
066300                PERFORM 4000-BUILD-INITIAL-PANEL                  06630073
066400             ELSE                                                 06640073
066500*               --- TOP OF LIST ---                               06650073
066600                MOVE PC-TSYMSG-00069                              06660073
066700                                  TO DP020-MSG-NUMBER             06670073
066800                SET DP020-MSG-INFORMATIONAL                       06680073
066900                                  TO TRUE                         06690073
067000             END-IF                                               06700073
067100                                                                  06710073
067200         WHEN OTHER                                               06720073
067300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06730073
067400             IF  PS-NO-ERROR                                      06740073
067500                 SET DP030-CONTINUE-GO TO TRUE                    06750073
067600                 PERFORM 2100-CHECK-FUNCTION-KEY                  06760073
067700             ELSE                                                 06770073
067800                 SET DP030-OVERRIDE-GO TO TRUE                    06780073
067900             END-IF                                               06790073
068000     END-EVALUATE.                                                06800073
068100                                                                  06810073
068200 EJECT                                                            06820073
068300******************************************************************06830073
068400** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **06840073
068500** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **06850073
068600** FROM THE CICS ARCHITECTURE API.                              **06860073
068700******************************************************************06870073
068800 2100-CHECK-FUNCTION-KEY.                                         06880073
068900                                                                  06890073
069000     EVALUATE TRUE                                                06900073
069100                                                                  06910073
069200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06920073
069300             INITIALIZE AP361-INTER-APPL-COMMAREA                 06930073
069400             SET ASC-SELECT-ADD TO TRUE                           06940073
069500             PERFORM 2110-PREPARE-INTER-APPL-COMM                 06950073
069600                                                                  06960073
069700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06970073
069800             INITIALIZE AP361-INTER-APPL-COMMAREA                 06980073
069900             MOVE ASC-KEY-DOC-NUMBER TO AP361-DOC-NO              06990073
070000             SET ASC-SELECT-UPDATE TO TRUE                        07000073
070100             PERFORM 2110-PREPARE-INTER-APPL-COMM                 07010073
070200                                                                  07020073
070300         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              07030073
070400             INITIALIZE AP361-INTER-APPL-COMMAREA                 07040073
070500             MOVE ASC-KEY-DOC-NUMBER TO AP361-DOC-NO              07050073
070600             SET ASC-SELECT-DELETE TO TRUE                        07060073
070700             PERFORM 2110-PREPARE-INTER-APPL-COMM                 07070073
070800                                                                  07080073
070900         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              07090073
071000             IF ASC-MULT-DIST                                     07100073
071100                PERFORM 5000-ADD-AP-KEY-ADJUSTMENT                07110073
071200                IF ASC-USE-SELECTION-QUEUE AND                    07120073
071300                   ASC-NUMBER-OF-SELECTED-ITEMS GREATER THAN ZERO 07130073
071400                   PERFORM 5500-UPDATE-SELECTION-QUEUE            07140073
071500                END-IF                                            07150073
071600                PERFORM 5900-WRITE-TS-QUEUE                       07160073
071700                MOVE ASC-KEY-DOC-NUMBER TO AP361-DOC-NO           07170073
071800                PERFORM 2110-PREPARE-INTER-APPL-COMM              07180073
071900                SET DP030-ERASE-UNPROT TO TRUE                    07190073
072000             ELSE                                                 07200073
072100                MOVE PC-TSYMSG-01932 TO DP020-MSG-NUMBER          07210073
072200                SET DP020-MSG-INFORMATIONAL TO TRUE               07220073
072300                SET DP030-OVERRIDE-GO TO TRUE                     07230073
072400             END-IF                                               07240073
072500                                                                  07250073
072600         WHEN DP020-SRC-AID = DP016-ENTER                         07260073
072700             CONTINUE                                             07270073
072800                                                                  07280073
072900         WHEN OTHER                                               07290073
073000             SET DP013-NO-ROLLBACK                                07300073
073100                 DP013-XCTL-DISPLAY-RESTART                       07310073
073200                 DP013-CICS-ABEND  TO TRUE                        07320073
073300             MOVE '2100-CHECK-FUNCTION-KEY'                       07330073
073400                                   TO DP013-PARAGRAPH             07340073
073500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07350073
073600                                   TO DP013-MESSAGE-TEXT (1)      07360073
073700             PERFORM DP013-0000-PROCESS-ABEND                     07370073
073800     END-EVALUATE.                                                07380073
073900 EJECT                                                            07390073
074000******************************************************************07400073
074100* GET NEXT RECORD FROM STORAGE QUEUE.                            *07410073
074200******************************************************************07420073
074300 2105-GET-NEXT-RECORD.                                            07430073
074400                                                                  07440073
074500     ADD +1                        TO ASC-SEL-SUB.                07450073
074600     IF ASC-SEL-SUB > AP362-MAX-ITEMS                             07460073
074700        ADD +1                     TO ASC-SEL-ITEM                07470073
074800        MOVE +1                    TO ASC-SEL-SUB                 07480073
074900     END-IF.                                                      07490073
075000                                                                  07500073
075100     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 07510073
075200        PERFORM 9100-READ-SEL-QUEUE                               07520073
075300        IF AP362-ITEM (ASC-SEL-SUB) > ZERO                        07530073
075400           MOVE AP362-VND-NBR     (ASC-SEL-SUB)                   07540073
075500                                  TO ASC-KEY-VEND-NUMBER          07550073
075600           MOVE AP362-DOC-NO      (ASC-SEL-SUB)                   07560073
075700                                  TO ASC-KEY-DOC-NUMBER           07570073
075800           MOVE AP362-DOC-DTE     (ASC-SEL-SUB)                   07580073
075900                                  TO ASC-KEY-DOC-DATE             07590073
076000           MOVE AP362-TRN-CDE     (ASC-SEL-SUB)                   07600073
076100                                  TO ASC-KEY-TRAN-CODE            07610073
076200           IF AP362-ACTION-SW     (ASC-SEL-SUB) > SPACES          07620073
076300              CONTINUE                                            07630073
076400           ELSE                                                   07640073
076500              SET AP362-INQ       (ASC-SEL-SUB) TO TRUE           07650073
076600              PERFORM 9200-REWRITE-LIST-QUEUE                     07660073
076700           END-IF                                                 07670073
076800        ELSE                                                      07680073
076900           SUBTRACT +1 FROM ASC-SEL-SUB                           07690073
077000*          MOVE AP362-MAX-ITEMS      TO ASC-SEL-SUB               07700073
077100           MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER          07710073
077200           SET DP020-MSG-INFORMATIONAL                            07720073
077300                                  TO TRUE                         07730073
077400        END-IF                                                    07740073
077500     ELSE                                                         07750073
077600        SUBTRACT +1 FROM ASC-SEL-ITEM                             07760073
077700        MOVE AP362-MAX-ITEMS         TO ASC-SEL-SUB               07770073
077800        MOVE PC-TSYMSG-00070         TO DP020-MSG-NUMBER          07780073
077900        SET DP020-MSG-INFORMATIONAL  TO TRUE                      07790073
078000     END-IF.                                                      07800073
078100                                                                  07810073
078200******************************************************************07820073
078300** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **07830073
078400** INTER-APPLICATION COMMAREA.                                  **07840073
078500******************************************************************07850073
078600 2110-PREPARE-INTER-APPL-COMM.                                    07860073
078700                                                                  07870073
078800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            07880073
078900                                TO AP361-NUMBER-OF-SELECTED-ITEMS.07890073
079000     MOVE ASC-NUMBER-OF-TS-ITEMS   TO AP361-NUMBER-OF-TS-ITEMS.   07900073
079100     MOVE ASC-SEL-QUEUE-NAME       TO AP361-SEL-QUEUE-NAME.       07910073
079200     MOVE ASC-KEY-VEND-NUMBER      TO AP361-VND-NBR.              07920073
079300     MOVE ASC-KEY-DOC-DATE         TO AP361-DOC-DATE.             07930073
079400     MOVE ASC-KEY-TRAN-CODE        TO AP361-TRN-CDE.              07940073
079500                                                                  07950073
079600******************************************************************07960073
079700* THIS PARAGRAPH WILL ATTEMPT TO GET THE PREVIOUS RECORD FROM    *07970073
079800* LIST INQUIRE.                                                  *07980073
079900******************************************************************07990073
080000 2120-GET-PREV-RECORD.                                            08000073
080100                                                                  08010073
080200     SUBTRACT +1 FROM ASC-SEL-SUB.                                08020073
080300     IF ASC-SEL-SUB < +1                                          08030073
080400        SUBTRACT +1 FROM ASC-SEL-ITEM                             08040073
080500        MOVE AP362-MAX-ITEMS     TO ASC-SEL-SUB                   08050073
080600     END-IF.                                                      08060073
080700                                                                  08070073
080800     IF ASC-SEL-ITEM > ZERO                                       08080073
080900        PERFORM 9100-READ-SEL-QUEUE                               08090073
081000        MOVE AP362-VND-NBR     (ASC-SEL-SUB)                      08100073
081100                               TO ASC-KEY-VEND-NUMBER             08110073
081200        MOVE AP362-DOC-NO      (ASC-SEL-SUB)                      08120073
081300                               TO ASC-KEY-DOC-NUMBER              08130073
081400        MOVE AP362-DOC-DTE     (ASC-SEL-SUB)                      08140073
081500                               TO ASC-KEY-DOC-DATE                08150073
081600     ELSE                                                         08160073
081700        MOVE +1                TO ASC-SEL-ITEM                    08170073
081800                                  ASC-SEL-SUB                     08180073
081900*       --- TOP OF LIST ---                                       08190073
082000        MOVE PC-TSYMSG-00069   TO DP020-MSG-NUMBER                08200073
082100        SET DP020-MSG-INFORMATIONAL                               08210073
082200                               TO TRUE                            08220073
082300     END-IF.                                                      08230073
082400                                                                  08240073
082500******************************************************************08250073
082600* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *08260073
082700* MAP.                                                           *08270073
082800******************************************************************08280073
082900 3200-RESET-ATTRIBUTES.                                           08290073
083000                                                                  08300073
083100     MOVE -1                     TO ATRANCDL.                     08310073
083200     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         08320073
083300                                                                  08330073
083400******************************************************************08340073
083500* PREPARE THE INITIAL PANEL FOR DISPLAYING AND POSITION THE      *08350073
083600* CURSOR ACCORDINGLY.                                            *08360073
083700******************************************************************08370073
083800 4000-BUILD-INITIAL-PANEL.                                        08380073
083900                                                                  08390073
084000     INITIALIZE DCLTADJRNL                                        08400073
084100                DCLTADJDIS                                        08410073
084200                DCLTEXTENT                                        08420073
084300                DCLTENTNME.                                       08430073
084400                                                                  08440073
084500     EXEC SQL                                                     08450073
084600         SET :ASC-CURRENT-DATE = CURRENT DATE                     08460073
084700     END-EXEC.                                                    08470073
084800                                                                  08480073
084900     IF ASC-KEY-DOC-NUMBER > SPACES                               08490073
085000        MOVE ASC-KEY-DOC-NUMBER TO DK-DOCUMENT-NO-LOW             08500073
085100                                   DK-DOCUMENT-NO-HIGH            08510073
085200     ELSE                                                         08520073
085300        MOVE LOW-VALUES         TO DK-DOCUMENT-NO-LOW             08530073
085400        MOVE HIGH-VALUES        TO DK-DOCUMENT-NO-HIGH            08540073
085500     END-IF.                                                      08550073
085600                                                                  08560073
085700     IF ASC-KEY-PO-NBR > +0                                       08570073
085800        MOVE ASC-KEY-PO-NBR        TO DK-PO-NBR-LOW               08580073
085900                                      DK-PO-NBR-HIGH              08590073
086000     ELSE                                                         08600073
086100        MOVE +0                    TO DK-PO-NBR-LOW               08610073
086200        MOVE +999999999            TO DK-PO-NBR-HIGH              08620073
086300     END-IF.                                                      08630073
086400                                                                  08640073
086500     IF ASC-KEY-TRAN-CODE > SPACES                                08650073
086600        MOVE ASC-KEY-TRAN-CODE     TO DK-TRAN-CODE-LOW            08660073
086700                                      DK-TRAN-CODE-HIGH           08670073
086800     ELSE                                                         08680073
086900        MOVE LOW-VALUES            TO DK-TRAN-CODE-LOW            08690073
087000        MOVE HIGH-VALUES           TO DK-TRAN-CODE-HIGH           08700073
087100     END-IF.                                                      08710073
087200                                                                  08720073
087300     IF ASC-KEY-VEND-NUMBER > SPACES                              08730073
087400        MOVE ASC-KEY-VEND-NUMBER   TO DK-VEND-NUMBER-LOW          08740073
087500                                      DK-VEND-NUMBER-HIGH         08750073
087600     ELSE                                                         08760073
087700        MOVE LOW-VALUES            TO DK-VEND-NUMBER-LOW          08770073
087800        MOVE HIGH-VALUES           TO DK-VEND-NUMBER-HIGH         08780073
087900     END-IF.                                                      08790073
088000     IF ASC-KEY-DOC-DATE > SPACES                                 08800073
088100        MOVE ASC-KEY-DOC-DATE      TO DK-DOC-DATE-LOW             08810073
088200                                      DK-DOC-DATE-HIGH            08820073
088300     ELSE                                                         08830073
088400        MOVE '0001-01-01'          TO DK-DOC-DATE-LOW             08840073
088500        MOVE '9999-12-31'          TO DK-DOC-DATE-HIGH            08850073
088600     END-IF.                                                      08860073
088700                                                                  08870073
088800     SET PS-NO-ERROR               TO TRUE.                       08880073
088900     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       08890073
089000     MOVE -1                       TO ATRANCDL.                   08900073
089100                                                                  08910073
089200     IF PS-NO-ERROR                                               08920073
089300        PERFORM 4005-VALIDATE-KEY-FIELDS                          08930073
089400     ELSE                                                         08940073
089500        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     08950073
089600     END-IF.                                                      08960073
089700                                                                  08970073
089800******************************************************************08980073
089900* THIS PARAGRAPH WILL CONTROL VALIDATION FOR KEY FIELDS PASSED   *08990073
090000* TO THIS PROGRAM FROM ANOTHER.                                  *09000073
090100******************************************************************09010073
090200 4005-VALIDATE-KEY-FIELDS.                                        09020073
090300                                                                  09030073
090400     PERFORM 4010-VALIDATE-DOC-EXISTENCE.                         09040073
090500     MOVE ADJRNL-AP-TRN-CDE TO PV-TRAN-CODE-FETCH-IND.            09050073
090600                                                                  09060073
090700     IF ASC-DOCUMENT-NOT-FOUND OR                                 09070073
090800        ASC-MULTIPLE-DOCUMENTS                                    09080073
090900        IF ASC-DOCUMENT-NOT-FOUND                                 09090073
091000**  DOCUMENT DOES NOT EXIST                                       09100073
091100           MOVE PC-TSYMSG-00148       TO DP020-MSG-NUMBER         09110073
091200           MOVE DP015-UNP-ALP-BRT-OFF TO ADOCNUMA                 09120073
091300           MOVE DP015-RED             TO ADOCNUMC                 09130073
091400           MOVE DP015-REVERSE         TO ADOCNUMH                 09140073
091500           MOVE -1                    TO ADOCNUML                 09150073
091600        ELSE                                                      09160073
091700**  DUPLICATE ADJUSTMENTS FOUND - NEED MORE INFORMATION           09170073
091800           MOVE PC-TSYMSG-01943       TO DP020-MSG-NUMBER         09180073
091900           IF DP020-NEXT-ACT-INITIAL                              09190073
092000              SET DP020-NEXT-ACT-APPL-ERROR                       09200073
092100                  DP020-MSG-FATAL                                 09210073
092200                                      TO TRUE                     09220073
092300           END-IF                                                 09230073
092400        END-IF                                                    09240073
092500     ELSE                                                         09250073
092600        IF NOT PV-TRANSFER-TRAN-CODE                              09260073
092700           PERFORM 4015-SELECT-AJPSINT                            09270073
092800        ELSE                                                      09280073
092900           INITIALIZE AJPSINT-VND-NBR                             09290073
093000                      AJPSINT-DOC-NBR                             09300073
093100                      AJPSINT-DOC-DTE                             09310073
093200                      AJPSINT-AP-TRN-CDE                          09320073
093300                      AJPSINT-DUE-DTE                             09330073
093400                      AJPSINT-DOC-HLD-CDE                         09340073
093500                      AJPSINT-RSN-1ST-LNE-TXT                     09350073
093600                      AJPSINT-RSN-2ND-LNE-TXT                     09360073
093700                      AJPSINT-AUTH-NBR                            09370073
093800        END-IF                                                    09380073
093900        PERFORM 4016-GET-FIRST-ADJDIS                             09390073
094000        PERFORM 4020-GET-REST-OF-DATA                             09400073
094100** THIS FETCH IS NEEDED TO DETERMINE IF THERE IS MORE THAN ONE    09410073
094200** DISTRIBUTION LINE FOR THIS ADJUSTMENT.  IF THE ASC-MULT-DISTRO 09420073
094300** SWITCH INDICATES THAT THERE ARE MORE DISTRIBUTION LINES        09430073
094400** REMAINING, THEN THERE IS MORE THAN ONE LINE OF DISTRIBUTION.   09440073
094500        PERFORM 4018-FETCH-DET-CSR                                09450073
094600        PERFORM 4019-CLOSE-DET-CSR                                09460073
094700     END-IF.                                                      09470073
094800                                                                  09480073
094900******************************************************************09490073
095000* THIS PARAGRAPH WILL RETRIEVE THE ADJUSTMENT DOCUMENT DATA      *09500073
095100* FOR DISPLAY.                                                   *09510073
095200******************************************************************09520073
095300 4010-VALIDATE-DOC-EXISTENCE.                                     09530073
095400                                                                  09540073
095500     EXEC SQL                                                     09550073
095600         SELECT VND_NBR                                           09560073
095700               ,DOC_NBR                                           09570073
095800               ,DOC_DTE                                           09580073
095900               ,AP_TRN_CDE                                        09590073
096000               ,PO_NBR                                            09600073
096100               ,DEPT_NBR                                          09610073
096200               ,GL_ACCT_NBR                                       09620073
096300               ,STR_NBR                                           09630073
096400               ,ENTR_TMST                                         09640073
096500               ,ENTR_ID                                           09650073
096600               ,ORGN_CDE                                          09660073
096700               ,GRO_COST_AMT                                      09670073
096800               ,RTL_AMT                                           09680073
096900               ,FRGT_AMT                                          09690073
097000               ,MISC_CHRG_AMT                                     09700073
097100               ,TERM_DISC_PCT                                     09710073
097200               ,TERM_DISC_AMT                                     09720073
097300               ,NW_STR_DISC_PCT                                   09730073
097400               ,NW_STR_DISC_AMT                                   09740073
097500               ,TRD_DISC_PCT                                      09750073
097600               ,TRD_DISC_AMT                                      09760073
097700               ,NET_COST_AMT                                      09770073
097800               ,INV_CTOFF_DTE                                     09780073
097900               ,TRN_TYP_CDE                                       09790073
098000               ,DOC_EXTR_IND                                      09800073
098100               ,DOC_EXTR_DTE                                      09810073
098200               ,PSTG_FYR_NBR                                      09820073
098300               ,PSTG_FMN_NBR                                      09830073
098400               ,PSTG_FWK_NBR                                      09840073
098500               ,BRCDE_NBR                                         09850073
098600               ,PS_BTCH_NBR                                       09860073
098700               ,PS_PSTG_IND                                       09870073
098800               ,ENT_ID                                            09880073
098900               ,MOS_DISC_PCT                                      09890073
099000               ,MOS_DISC_AMT                                      09900073
099100         INTO  :ADJRNL-VND-NBR                                    09910073
099200              ,:ADJRNL-DOC-NBR                                    09920073
099300              ,:ADJRNL-DOC-DTE                                    09930073
099400              ,:ADJRNL-AP-TRN-CDE                                 09940073
099500              ,:ADJRNL-PO-NBR                                     09950073
099600              ,:ADJRNL-DEPT-NBR                                   09960073
099700              ,:ADJRNL-GL-ACCT-NBR                                09970073
099800              ,:ADJRNL-STR-NBR                                    09980073
099900              ,:ADJRNL-ENTR-TMST                                  09990073
100000              ,:ADJRNL-ENTR-ID                                    10000073
100100              ,:ADJRNL-ORGN-CDE                                   10010073
100200              ,:ADJRNL-GRO-COST-AMT                               10020073
100300              ,:ADJRNL-RTL-AMT                                    10030073
100400              ,:ADJRNL-FRGT-AMT                                   10040073
100500              ,:ADJRNL-MISC-CHRG-AMT                              10050073
100600              ,:ADJRNL-TERM-DISC-PCT                              10060073
100700              ,:ADJRNL-TERM-DISC-AMT                              10070073
100800              ,:ADJRNL-NW-STR-DISC-PCT                            10080073
100900              ,:ADJRNL-NW-STR-DISC-AMT                            10090073
101000              ,:ADJRNL-TRD-DISC-PCT                               10100073
101100              ,:ADJRNL-TRD-DISC-AMT                               10110073
101200              ,:ADJRNL-NET-COST-AMT                               10120073
101300              ,:ADJRNL-INV-CTOFF-DTE                              10130073
101400              ,:ADJRNL-TRN-TYP-CDE                                10140073
101500              ,:ADJRNL-DOC-EXTR-IND                               10150073
101600              ,:ADJRNL-DOC-EXTR-DTE                               10160073
101700              ,:ADJRNL-PSTG-FYR-NBR                               10170073
101800              ,:ADJRNL-PSTG-FMN-NBR                               10180073
101900              ,:ADJRNL-PSTG-FWK-NBR                               10190073
102000              ,:ADJRNL-BRCDE-NBR                                  10200073
102100              ,:ADJRNL-PS-BTCH-NBR                                10210073
102200              ,:ADJRNL-PS-PSTG-IND                                10220073
102300              ,:ADJRNL-ENT-ID                                     10230073
102400              ,:ADJRNL-MOS-DISC-PCT                               10240073
102500              ,:ADJRNL-MOS-DISC-AMT                               10250073
102600         FROM TADJRNL                                             10260073
102700         WHERE   DOC_NBR BETWEEN :DK-DOCUMENT-NO-LOW              10270073
102800                             AND :DK-DOCUMENT-NO-HIGH             10280073
102900         AND     PO_NBR IS NOT NULL                               10290073
103000         AND     PO_NBR BETWEEN :DK-PO-NBR-LOW                    10300073
103100                            AND :DK-PO-NBR-HIGH                   10310073
103200         AND AP_TRN_CDE BETWEEN :DK-TRAN-CODE-LOW                 10320073
103300                            AND :DK-TRAN-CODE-HIGH                10330073
103400         AND VND_NBR    BETWEEN :DK-VEND-NUMBER-LOW               10340073
103500                            AND :DK-VEND-NUMBER-HIGH              10350073
103600         AND DOC_DTE    BETWEEN :DK-DOC-DATE-LOW                  10360073
103700                            AND :DK-DOC-DATE-HIGH                 10370073
103800     END-EXEC.                                                    10380073
103900                                                                  10390073
104000     EVALUATE TRUE                                                10400073
104100         WHEN SQLCODE = +0                                        10410073
104200             SET ASC-DOCUMENT-FOUND   TO TRUE                     10420073
104300         WHEN SQLCODE = -904                                      10430073
104400         WHEN SQLCODE = -913                                      10440073
104500             CONTINUE                                             10450073
104600         WHEN SQLCODE = -811                                      10460073
104700                                                                  10470073
104800             SET ASC-MULTIPLE-DOCUMENTS TO TRUE                   10480073
104900                                                                  10490073
105000         WHEN SQLCODE = +100                                      10500073
105100                                                                  10510073
105200             SET ASC-DOCUMENT-NOT-FOUND TO TRUE                   10520073
105300                                                                  10530073
105400         WHEN SQLWARN0 NOT = SPACES                               10540073
105500                                                                  10550073
105600             SET ASC-DOCUMENT-NOT-FOUND TO TRUE                   10560073
105700                                                                  10570073
105800         WHEN SQLWARN0 NOT = SPACES                               10580073
105900         WHEN SQLCODE < ZERO                                      10590073
106000         WHEN SQLCODE > ZERO                                      10600073
106100             MOVE '4010-SELECT-TADJRNL'                           10610073
106200                               TO DP013-PARAGRAPH                 10620073
106300             MOVE 'SELECT ON TADJRNL        '                     10630073
106400                               TO DP013-MESSAGE-TEXT (1)          10640073
106500             MOVE SQLCA   TO DP013-SQLCA                          10650073
106600             MOVE 'TADJRNL' TO DP013-DB2-TABLE-NAME (1)           10660073
106700             SET DP013-DB2-ABEND                                  10670073
106800                 DP013-XCTL-DISPLAY-RESTART                       10680073
106900                               TO TRUE                            10690073
107000             PERFORM DP013-0000-PROCESS-ABEND                     10700073
107100     END-EVALUATE.                                                10710073
107200                                                                  10720073
107300******************************************************************10730073
107400* THIS PARAGRAPH WILL RETRIEVE THE ADJUSTMENT PEOPLESOFT         *10740073
107500* INTERFACE DATA FROM THE DB2 TABLE AJPSINT.                     *10750073
107600******************************************************************10760073
107700 4015-SELECT-AJPSINT.                                             10770073
107800                                                                  10780073
107900     EXEC SQL                                                     10790073
108000        SELECT  VND_NBR                                           10800073
108100               ,DOC_NBR                                           10810073
108200               ,DOC_DTE                                           10820073
108300               ,AP_TRN_CDE                                        10830073
108400               ,DUE_DTE                                           10840073
108500               ,DOC_HLD_CDE                                       10850073
108600               ,RSN_1ST_LNE_TXT                                   10860073
108700               ,RSN_2ND_LNE_TXT                                   10870073
108800               ,AUTH_NBR                                          10880073
108900         INTO  :AJPSINT-VND-NBR                                   10890073
109000              ,:AJPSINT-DOC-NBR                                   10900073
109100              ,:AJPSINT-DOC-DTE                                   10910073
109200              ,:AJPSINT-AP-TRN-CDE                                10920073
109300              ,:AJPSINT-DUE-DTE                                   10930073
109400              ,:AJPSINT-DOC-HLD-CDE                               10940073
109500              ,:AJPSINT-RSN-1ST-LNE-TXT                           10950073
109600              ,:AJPSINT-RSN-2ND-LNE-TXT                           10960073
109700              ,:AJPSINT-AUTH-NBR                                  10970073
109800         FROM TAJPSINT                                            10980073
109900         WHERE DOC_NBR    =   :ADJRNL-DOC-NBR                     10990073
110000         AND   VND_NBR    =   :ADJRNL-VND-NBR                     11000073
110100         AND   DOC_DTE    =   :ADJRNL-DOC-DTE                     11010073
110200         AND   AP_TRN_CDE =   :ADJRNL-AP-TRN-CDE                  11020073
110300     END-EXEC.                                                    11030073
110400                                                                  11040073
110500     EVALUATE TRUE                                                11050073
110600         WHEN SQLCODE = +0                                        11060073
110700         WHEN SQLCODE = -904                                      11070073
110800         WHEN SQLCODE = -913                                      11080073
110900             CONTINUE                                             11090073
111000         WHEN SQLCODE = -811                                      11100073
111100                                                                  11110073
111200             CONTINUE                                             11120073
111300                                                                  11130073
111400         WHEN SQLCODE = +100                                      11140073
111500                                                                  11150073
111600             INITIALIZE AJPSINT-VND-NBR     AJPSINT-DOC-NBR       11160073
111700                        AJPSINT-DOC-DTE     AJPSINT-AP-TRN-CDE    11170073
111800                        AJPSINT-DUE-DTE     AJPSINT-DOC-HLD-CDE   11180073
111900                        AJPSINT-RSN-1ST-LNE-TXT                   11190073
112000                        AJPSINT-RSN-2ND-LNE-TXT                   11200073
112100                        AJPSINT-AUTH-NBR                          11210073
112200                                                                  11220073
112300         WHEN SQLWARN0 NOT = SPACES                               11230073
112400         WHEN SQLCODE < ZERO                                      11240073
112500         WHEN SQLCODE > ZERO                                      11250073
112600             MOVE '4015-SELECT-AJPSINT'                           11260073
112700                               TO DP013-PARAGRAPH                 11270073
112800             MOVE 'SELECT ON TAJPSINT       '                     11280073
112900                               TO DP013-MESSAGE-TEXT (1)          11290073
113000             MOVE SQLCA   TO DP013-SQLCA                          11300073
113100             MOVE 'AJPSINT' TO DP013-DB2-TABLE-NAME (1)           11310073
113200             SET DP013-DB2-ABEND                                  11320073
113300                 DP013-XCTL-DISPLAY-RESTART                       11330073
113400                               TO TRUE                            11340073
113500             PERFORM DP013-0000-PROCESS-ABEND                     11350073
113600     END-EVALUATE.                                                11360073
113700                                                                  11370073
113800******************************************************************11380073
113900* THIS PARAGRAPH WILL CONTROL PROCESSING OF THE CURSOR TO GATHER *11390073
114000* THE FIRST ROW OF ADJUSTMENT DETAIL.                            *11400073
114100******************************************************************11410073
114200 4016-GET-FIRST-ADJDIS.                                           11420073
114300                                                                  11430073
114400     PERFORM 4017-OPEN-DET-CSR.                                   11440073
114500     SET ASC-MULT-DIST TO TRUE.                                   11450073
114600     PERFORM 4018-FETCH-DET-CSR.                                  11460073
114700                                                                  11470073
114800******************************************************************11480073
114900* THIS PARAGRAPH WILL OPEN THE DETAIL CURSOR FOR THE FIRST ROW   *11490073
115000* OF ADJUSTMENT DISTRIBUTION.                                    *11500073
115100******************************************************************11510073
115200 4017-OPEN-DET-CSR.                                               11520073
115300                                                                  11530073
115400     EXEC SQL                                                     11540073
115500         OPEN DET-CSR                                             11550073
115600     END-EXEC.                                                    11560073
115700                                                                  11570073
115800     EVALUATE TRUE                                                11580073
115900         WHEN SQLCODE = +0                                        11590073
116000             CONTINUE                                             11600073
116100         WHEN OTHER                                               11610073
116200              MOVE '4017-OPEN-DET-CS'                             11620073
116300                               TO DP013-PARAGRAPH                 11630073
116400              MOVE 'OPEN DET-CSR         '                        11640073
116500                               TO DP013-MESSAGE-TEXT (1)          11650073
116600              MOVE SQLCA           TO DP013-SQLCA                 11660073
116700              SET DP013-DB2-ABEND                                 11670073
116800                               TO TRUE                            11680073
116900              PERFORM DP013-0000-PROCESS-ABEND                    11690073
117000     END-EVALUATE.                                                11700073
117100                                                                  11710073
117200 EJECT                                                            11720073
117300******************************************************************11730073
117400* THIS PARAGRAPH WILL FETCH THE FIRST ROW OF ADJUSTMENT DETAIL.  *11740073
117500******************************************************************11750073
117600 4018-FETCH-DET-CSR.                                              11760073
117700                                                                  11770073
117800     EXEC SQL                                                     11780073
117900          FETCH DET-CSR                                           11790073
118000          INTO  :ADJDIS-VND-NBR                                   11800073
118100               ,:ADJDIS-DOC-NBR                                   11810073
118200               ,:ADJDIS-DOC-DTE                                   11820073
118300               ,:ADJDIS-AP-TRN-CDE                                11830073
118400               ,:ADJDIS-DISTRB-SEQ-NBR                            11840073
118500               ,:ADJDIS-STR-NBR                                   11850073
118600               ,:ADJDIS-DEPT-NBR                                  11860073
118700               ,:ADJDIS-CL-NBR                                    11870073
118800               ,:ADJDIS-SKU-NBR                                   11880079
118900               ,:ADJDIS-GRO-COST-AMT                              11890073
119000               ,:ADJDIS-RTL-AMT                                   11900073
119100               ,:ADJDIS-FRGT-AMT                                  11910073
119200               ,:ADJDIS-MISC-CHRG-AMT                             11920073
119300               ,:ADJDIS-DISC-AMT                                  11930073
119400               ,:ADJDIS-NET-COST-AMT                              11940073
119500     END-EXEC.                                                    11950073
119600                                                                  11960073
119700     EVALUATE TRUE                                                11970073
119800         WHEN SQLCODE = ZERO                                      11980073
119900         WHEN SQLCODE = +100                                      11990073
120000              CONTINUE                                            12000073
120100         WHEN SQLWARN0 NOT = SPACE                                12010073
120200         WHEN SQLCODE NOT = ZERO                                  12020073
120300              MOVE '4018-FETCH-DET-CS'                            12030073
120400                               TO DP013-PARAGRAPH                 12040073
120500              MOVE 'FETCH DETAIL CURSOR    '                      12050073
120600                               TO DP013-MESSAGE-TEXT (1)          12060073
120700              MOVE SQLCA       TO DP013-SQLCA                     12070073
120800              SET DP013-DB2-ABEND                                 12080073
120900                               TO TRUE                            12090073
121000              PERFORM DP013-0000-PROCESS-ABEND                    12100073
121100     END-EVALUATE.                                                12110073
121200                                                                  12120073
121300     IF SQLCODE EQUAL +100                                        12130073
121400        SET ASC-SINGLE-DIST TO TRUE                               12140073
121500     END-IF.                                                      12150073
121600                                                                  12160073
121700******************************************************************12170073
121800* THIS PARAGRAPH WILL CLOSE THE DETAIL CURSOR AFTER THE FIRST    *12180073
121900* ADJUSTMENT DISTRIBUTION ROW IS RETRIEVED.                      *12190073
122000******************************************************************12200073
122100 4019-CLOSE-DET-CSR.                                              12210073
122200                                                                  12220073
122300     EXEC SQL                                                     12230073
122400         CLOSE DET-CSR                                            12240073
122500     END-EXEC.                                                    12250073
122600                                                                  12260073
122700                                                                  12270073
122800     EVALUATE TRUE                                                12280073
122900         WHEN SQLCODE = ZERO                                      12290073
123000             CONTINUE                                             12300073
123100         WHEN SQLWARN0 NOT = SPACES                               12310073
123200         WHEN SQLCODE < ZERO                                      12320073
123300         WHEN SQLCODE > ZERO                                      12330073
123400             MOVE '4019-CLOSE-DET-CS'                             12340073
123500                               TO DP013-PARAGRAPH                 12350073
123600             MOVE 'CLOSE DETAIL CURSOR     '                      12360073
123700                               TO DP013-MESSAGE-TEXT (1)          12370073
123800             MOVE SQLCA        TO DP013-SQLCA                     12380073
123900             MOVE 'TADJDIS '   TO DP013-DB2-TABLE-NAME (1)        12390073
124000             SET DP013-DB2-ABEND                                  12400073
124100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12410073
124200             PERFORM DP013-0000-PROCESS-ABEND                     12420073
124300     END-EVALUATE.                                                12430073
124400                                                                  12440073
124500 EJECT                                                            12450073
124600******************************************************************12460073
124700* THIS PARAGRAPH WILL CONTROL KEY VALIDATION ON THE VENDOR       *12470073
124800* NUMBER AND MOVING DATA TO THE SCREEN.                          *12480073
124900******************************************************************12490073
125000 4020-GET-REST-OF-DATA.                                           12500073
125100                                                                  12510073
125200     IF PS-NO-ERROR                                               12520073
125300        MOVE ADJRNL-VND-NBR TO EXTENT-DUN-NBR                     12530073
125400        PERFORM 4800-VALIDATE-VENDOR                              12540073
125500        PERFORM 4200-MOVE-DATABASE-TO-COMMAREA                    12550073
125600        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                      12560073
125700     END-IF.                                                      12570073
125800                                                                  12580073
125900******************************************************************12590073
126000* THIS PARAGRAPH WILL MOVE THE DISPLAYED FIELDS FROM THE         *12600073
126100* COMMAREA TO THE SCREEN.                                        *12610073
126200******************************************************************12620073
126300 4200-MOVE-DATABASE-TO-COMMAREA.                                  12630073
126400                                                                  12640073
126500     INITIALIZE PV-ENTRY-ID.                                      12650073
126600                                                                  12660073
126700     MOVE ADJRNL-VND-NBR             TO ASC-VENDOR-NUMBER         12670073
126800                                        ASC-KEY-VEND-NUMBER       12680073
126900                                        AP363-VND-NBR.            12690073
127000     MOVE ENTNME-ENT-NAME-DESC       TO ASC-VENDOR-NAME.          12700073
127100     MOVE ADJRNL-DOC-NBR             TO ASC-DOC-NUMBER            12710073
127200                                        ASC-KEY-DOC-NUMBER        12720073
127300                                        AP363-DOC-NBR.            12730073
127400     MOVE ADJRNL-DOC-DTE             TO ASC-DOC-DATE              12740073
127500                                        ASC-KEY-DOC-DATE          12750073
127600                                        AP363-DOC-DTE.            12760073
127700     MOVE ADJRNL-AP-TRN-CDE          TO ASC-TRAN-CD               12770073
127800                                        ASC-KEY-TRAN-CODE         12780073
127900                                        AP363-AP-TRN-CDE.         12790073
128000     MOVE ADJRNL-PO-NBR              TO ASC-PO-NUMBER             12800073
128100                                        ASC-ALP-PO-NBR-9.         12810073
128200     MOVE ADJRNL-DEPT-NBR            TO ASC-DEPARTMENT.           12820073
128300     MOVE ADJRNL-GL-ACCT-NBR         TO ASC-ACCT-NO.              12830073
128400     MOVE ADJRNL-STR-NBR             TO ASC-ALP-STORE-NBR         12840073
128500                                        ASC-STORE.                12850073
128600     MOVE ADJRNL-ENTR-ID             TO PV-ENTRY-ID.              12860073
128700     MOVE ADJRNL-GRO-COST-AMT        TO ASC-GROSS-COST            12870073
128800                                        ASC-ALP-GRO-COST-9.       12880073
128900     MOVE ADJRNL-RTL-AMT             TO ASC-RETAIL-AMT            12890073
129000                                        ASC-ALP-RET-COST-9.       12900073
129100     MOVE ADJRNL-FRGT-AMT            TO ASC-FREIGHT-AMT           12910073
129200                                        ASC-ALP-FRT-COST-9.       12920073
129300     MOVE ADJRNL-MISC-CHRG-AMT       TO ASC-MISC-CHG              12930073
129400                                        ASC-ALP-MISC-CHG-9.       12940073
129500     COMPUTE ASC-DISC-PCT =                                       12950073
129600             ADJRNL-TERM-DISC-PCT * 100.                          12960073
129700     MOVE ASC-DISC-PCT               TO ASC-ALP-DISC-PCT-9.       12970073
129800     MOVE ADJRNL-TERM-DISC-AMT       TO ASC-DISC-AMT.             12980073
129900                                                                  12990073
130000     COMPUTE ASC-MOS-PCT =                                        13000073
130100             ADJRNL-MOS-DISC-PCT * 100.                           13010073
130200     MOVE ASC-MOS-PCT                TO ASC-ALP-MOS-PCT-9.        13020073
130300     MOVE ADJRNL-MOS-DISC-AMT        TO ASC-MOS-AMT.              13030073
130400                                                                  13040073
130500     COMPUTE ASC-NEWST-PCT =                                      13050073
130600             ADJRNL-NW-STR-DISC-PCT * 100.                        13060073
130700     MOVE ASC-NEWST-PCT              TO ASC-ALP-NEW-STR-PCT-9.    13070073
130800     MOVE ADJRNL-NW-STR-DISC-AMT     TO ASC-NEWST-AMT.            13080073
130900                                                                  13090073
131000     COMPUTE ASC-TRADE-PCT =                                      13100073
131100             ADJRNL-TRD-DISC-PCT * 100.                           13110073
131200     MOVE ASC-TRADE-PCT              TO ASC-ALP-TRADE-PCT-9.      13120073
131300     MOVE ADJRNL-TRD-DISC-AMT        TO ASC-TRADE-AMT.            13130073
131400                                                                  13140073
131500     MOVE ADJRNL-NET-COST-AMT        TO ASC-NET-COST.             13150073
131600     MOVE ADJRNL-PSTG-FMN-NBR        TO ASC-PSTG-MTH.             13160073
131700     MOVE ADJRNL-PSTG-FWK-NBR        TO ASC-PSTG-WEEK.            13170073
131800     MOVE ADJRNL-ENTR-ID             TO ASC-USER-ID.              13180073
131900     MOVE ADJRNL-INV-CTOFF-DTE       TO ASC-CUTOFF-DATE.          13190091
132000     MOVE ADJRNL-BRCDE-NBR           TO ASC-BARCODE.              13200073
132100                                                                  13210073
132200     IF ADJRNL-GRO-COST-AMT EQUAL ZERO AND                        13220073
132300        ADJRNL-FRGT-AMT NOT EQUAL ZERO                            13230073
132400         SET ASC-FREIGHT-COST-ALLOCATION TO TRUE                  13240073
132500     END-IF.                                                      13250073
132600                                                                  13260073
132700     MOVE ADJRNL-PS-BTCH-NBR         TO ASC-PS-BATCH-NBR.         13270076
132800     MOVE ADJRNL-PS-PSTG-IND         TO ASC-PS-POSTING-IND.       13280076
132900     MOVE ADJRNL-DOC-EXTR-IND        TO ASC-DOC-EXTRACT-IND.      13290076
133000     MOVE ADJRNL-DOC-EXTR-DTE        TO ASC-DOC-EXTRACT-DTE.      13300076
133100     MOVE ADJRNL-ORGN-CDE            TO ASC-ORIGIN-CDE.           13310076
133200                                                                  13320075
133300     MOVE AJPSINT-DUE-DTE            TO ASC-DUE-DATE.             13330073
133400     MOVE AJPSINT-DOC-HLD-CDE        TO ASC-HOLD-STATUS.          13340073
133500     MOVE AJPSINT-RSN-1ST-LNE-TXT    TO ASC-REASON-CODE1.         13350073
133600     MOVE AJPSINT-RSN-2ND-LNE-TXT    TO ASC-REASON-CODE2.         13360073
133700     MOVE AJPSINT-AUTH-NBR           TO ASC-VENDOR-AUTH.          13370073
133800                                                                  13380073
133900     MOVE ADJDIS-STR-NBR             TO ASC-DET-STORE             13390073
134000                                        ASC-ALP-DET-STORE.        13400073
134100     MOVE ADJDIS-CL-NBR              TO ASC-DET-CLASS.            13410073
134200     MOVE ADJDIS-SKU-NBR             TO ASC-DET-SKU               13420079
134300                                        ASC-ALP-DET-SKU-9.        13430079
134400     IF ASC-FREIGHT-COST-ALLOCATION                               13440073
134500        MOVE ADJDIS-FRGT-AMT         TO ASC-DET-COST              13450073
134600                                        ASC-ALP-DET-COST-9        13460073
134700     ELSE                                                         13470073
134800        MOVE ADJDIS-GRO-COST-AMT     TO ASC-DET-COST              13480073
134900                                        ASC-ALP-DET-COST-9        13490073
135000     END-IF.                                                      13500073
135100     MOVE ADJDIS-RTL-AMT             TO ASC-DET-RETAIL            13510073
135200                                        ASC-ALP-DET-RETL-9.       13520073
135300     MOVE ADJDIS-NET-COST-AMT        TO ASC-DET-NET.              13530073
135400     MOVE ADJDIS-DISTRB-SEQ-NBR      TO ASC-DET-DISTRB-SEQ.       13540073
135500                                                                  13550073
135600******************************************************************13560073
135700*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *13570073
135800******************************************************************13580073
135900 4400-MOVE-COMMAREA-TO-SCREEN.                                    13590073
136000     MOVE ASC-TRAN-CD              TO ATRANCDO.                   13600073
136100     MOVE ASC-DOC-NUMBER           TO ADOCNUMO.                   13610073
136200     MOVE ASC-VENDOR-NUMBER        TO AVENDNOO.                   13620073
136300                                                                  13630073
136400     IF ASC-ALP-PO-NBR NUMERIC                                    13640073
136500        IF ASC-PO-NUMBER = +0                                     13650073
136600           MOVE SPACES             TO APONUMO                     13660073
136700                                      ASC-ALP-PO-NBR              13670073
136800        ELSE                                                      13680073
136900           MOVE ASC-PO-NUMBER      TO PV-NUM9                     13690073
137000           MOVE PV-NUM9-X          TO APONUMO                     13700073
137100                                      ASC-ALP-PO-NBR              13710073
137200        END-IF                                                    13720073
137300     ELSE                                                         13730073
137400        MOVE ASC-ALP-PO-NBR        TO APONUMO                     13740073
137500     END-IF.                                                      13750073
137600                                                                  13760073
137700     MOVE ASC-VENDOR-NAME          TO AVENDNMO.                   13770073
137800     MOVE ASC-BARCODE              TO ABARCDO.                    13780073
137900     IF ASC-ALP-STORE-NBR NUMERIC                                 13790073
138000        MOVE ASC-STORE             TO PV-NUM4                     13800073
138100        MOVE PV-NUM4-X             TO ASTRNMO                     13810073
138200     ELSE                                                         13820073
138300        MOVE ASC-ALP-STORE-NBR     TO ASTRNMO                     13830073
138400     END-IF.                                                      13840073
138500                                                                  13850073
138600     MOVE ASC-DEPARTMENT           TO ADEPTO.                     13860073
138700     MOVE ASC-ACCT-NO              TO AACCNOO.                    13870073
138800     STRING ASC-DOC-DATE-MM,                                      13880073
138900            '/',                                                  13890073
139000            ASC-DOC-DATE-DD,                                      13900073
139100            '/',                                                  13910073
139200            ASC-DOC-DATE-YY                                       13920073
139300           DELIMITED BY SIZE                                      13930073
139400           INTO ADOCDTEO                                          13940073
139500     END-STRING.                                                  13950073
139600     MOVE ASC-VENDOR-AUTH          TO AVENDAO.                    13960073
139700                                                                  13970073
139800     IF ASC-ALP-GROSS-COST(2:12) NUMERIC                          13980073
139900        IF ASC-GROSS-COST = +0                                    13990073
140000           MOVE SPACES             TO AGRCSTO                     14000073
140100                                      ASC-ALP-GROSS-COST          14010073
140200        ELSE                                                      14020073
140300           MOVE ASC-GROSS-COST     TO PV-10V99                    14030073
140400           MOVE PV-10V99           TO AGRCSTO                     14040073
140500                                      ASC-ALP-GROSS-COST          14050073
140600         END-IF                                                   14060073
140700     ELSE                                                         14070073
140800         MOVE ASC-ALP-GROSS-COST   TO AGRCSTO                     14080073
140900     END-IF.                                                      14090073
141000                                                                  14100073
141100     IF ASC-ALP-RET-COST(2:12) NUMERIC                            14110073
141200        IF ASC-RETAIL-AMT = +0                                    14120073
141300           MOVE SPACES             TO ARETCSTO                    14130073
141400                                      ASC-ALP-RET-COST            14140073
141500        ELSE                                                      14150073
141600           MOVE ASC-RETAIL-AMT     TO PV-10V99                    14160073
141700           MOVE PV-10V99           TO ARETCSTO                    14170073
141800                                      ASC-ALP-RET-COST            14180073
141900         END-IF                                                   14190073
142000     ELSE                                                         14200073
142100         MOVE ASC-ALP-RET-COST     TO ARETCSTO                    14210073
142200     END-IF.                                                      14220073
142300                                                                  14230073
142400     IF ASC-ALP-FREIGHT-COST(2:12) NUMERIC                        14240073
142500        IF ASC-FREIGHT-AMT = +0                                   14250073
142600           MOVE SPACES             TO AFRAMTO                     14260073
142700                                      ASC-ALP-FREIGHT-COST        14270073
142800        ELSE                                                      14280073
142900           MOVE ASC-FREIGHT-AMT    TO PV-10V99                    14290073
143000           MOVE PV-10V99           TO AFRAMTO                     14300073
143100                                      ASC-ALP-FREIGHT-COST        14310073
143200         END-IF                                                   14320073
143300     ELSE                                                         14330073
143400         MOVE ASC-ALP-FREIGHT-COST TO AFRAMTO                     14340073
143500     END-IF.                                                      14350073
143600                                                                  14360073
143700     IF ASC-ALP-MISC-CHG(2:12) NUMERIC                            14370073
143800        IF ASC-MISC-CHG = +0                                      14380073
143900           MOVE SPACES             TO AMISCO                      14390073
144000                                      ASC-ALP-MISC-CHG            14400073
144100        ELSE                                                      14410073
144200           MOVE ASC-MISC-CHG       TO PV-10V99                    14420073
144300           MOVE PV-10V99           TO AMISCO                      14430073
144400                                      ASC-ALP-MISC-CHG            14440073
144500         END-IF                                                   14450073
144600     ELSE                                                         14460073
144700         MOVE ASC-ALP-MISC-CHG     TO AMISCO                      14470073
144800     END-IF.                                                      14480073
144900                                                                  14490073
145000     IF ASC-ALP-DISC-PCT NUMERIC                                  14500073
145100        IF ASC-DISC-PCT = +0                                      14510073
145200           MOVE SPACES             TO ADISCPCO                    14520073
145300                                      ASC-ALP-DISC-PCT            14530073
145400        ELSE                                                      14540073
145500           MOVE ASC-DISC-PCT       TO PV-3V99                     14550073
145600           MOVE PV-3V99            TO ADISCPCO                    14560073
145700                                      ASC-ALP-DISC-PCT            14570073
145800         END-IF                                                   14580073
145900     ELSE                                                         14590073
146000         MOVE ASC-ALP-DISC-PCT     TO ADISCPCO                    14600073
146100     END-IF.                                                      14610073
146200                                                                  14620073
146300     IF ASC-DISC-AMT NOT EQUAL 0                                  14630073
146400        MOVE ASC-DISC-AMT          TO PV-6V99                     14640073
146500        MOVE PV-6V99               TO ADISCAMO                    14650073
146600     ELSE                                                         14660073
146700        MOVE SPACES                TO ADISCAMO                    14670073
146800     END-IF.                                                      14680073
146900                                                                  14690073
147000     IF ASC-ALP-MOS-PCT NUMERIC                                   14700073
147100        IF ASC-MOS-PCT = +0                                       14710073
147200           MOVE SPACES             TO AMOSPCO                     14720073
147300                                      ASC-ALP-MOS-PCT             14730073
147400        ELSE                                                      14740073
147500           MOVE ASC-MOS-PCT        TO PV-3V99                     14750073
147600           MOVE PV-3V99            TO AMOSPCO                     14760073
147700                                      ASC-ALP-MOS-PCT             14770073
147800         END-IF                                                   14780073
147900     ELSE                                                         14790073
148000         MOVE ASC-ALP-MOS-PCT      TO AMOSPCO                     14800073
148100     END-IF.                                                      14810073
148200                                                                  14820073
148300     IF ASC-MOS-AMT NOT EQUAL 0                                   14830073
148400        MOVE ASC-MOS-AMT           TO PV-6V99                     14840073
148500        MOVE PV-6V99               TO AMOSAMO                     14850073
148600     ELSE                                                         14860073
148700        MOVE SPACES                TO AMOSAMO                     14870073
148800     END-IF.                                                      14880073
148900                                                                  14890073
149000     IF ASC-ALP-NEW-STR-PCT NUMERIC                               14900073
149100        IF ASC-NEWST-PCT = +0                                     14910073
149200           MOVE SPACES             TO ANSTRPCO                    14920073
149300                                      ASC-ALP-NEW-STR-PCT         14930073
149400        ELSE                                                      14940073
149500           MOVE ASC-NEWST-PCT      TO PV-3V99                     14950073
149600           MOVE PV-3V99            TO ANSTRPCO                    14960073
149700                                      ASC-ALP-NEW-STR-PCT         14970073
149800         END-IF                                                   14980073
149900     ELSE                                                         14990073
150000         MOVE ASC-ALP-NEW-STR-PCT  TO ANSTRPCO                    15000073
150100     END-IF.                                                      15010073
150200                                                                  15020073
150300     IF ASC-NEWST-AMT NOT EQUAL 0                                 15030073
150400        MOVE ASC-NEWST-AMT         TO PV-6V99                     15040073
150500        MOVE PV-6V99               TO ANSTRAMO                    15050073
150600     ELSE                                                         15060073
150700        MOVE SPACES                TO ANSTRAMO                    15070073
150800     END-IF.                                                      15080073
150900                                                                  15090073
151000     IF ASC-HOLD-STATUS > SPACES                                  15100073
151100        MOVE ASC-HOLD-STATUS       TO AHOLDO                      15110073
151200     ELSE                                                         15120073
151300        MOVE 'N'                   TO AHOLDO                      15130073
151400     END-IF.                                                      15140073
151500                                                                  15150073
151600     IF ASC-ALP-TRADE-PCT NUMERIC                                 15160073
151700        IF ASC-TRADE-PCT = +0                                     15170073
151800           MOVE SPACES             TO ATRADPCO                    15180073
151900                                      ASC-ALP-TRADE-PCT           15190073
152000        ELSE                                                      15200073
152100           MOVE ASC-TRADE-PCT      TO PV-3V99                     15210073
152200           MOVE PV-3V99            TO ATRADPCO                    15220073
152300                                      ASC-ALP-TRADE-PCT           15230073
152400         END-IF                                                   15240073
152500     ELSE                                                         15250073
152600         MOVE ASC-ALP-TRADE-PCT    TO ATRADPCO                    15260073
152700     END-IF.                                                      15270073
152800                                                                  15280073
152900     IF ASC-TRADE-AMT NOT EQUAL 0                                 15290073
153000        MOVE ASC-TRADE-AMT         TO PV-6V99                     15300073
153100        MOVE PV-6V99               TO ATRADAMO                    15310073
153200     ELSE                                                         15320073
153300        MOVE SPACES                TO ATRADAMO                    15330073
153400     END-IF.                                                      15340073
153500                                                                  15350073
153600     MOVE ASC-NET-COST             TO PV-10V99.                   15360073
153700     MOVE PV-10V99                 TO ANETCSTO.                   15370073
153800                                                                  15380073
153900     MOVE ASC-PSTG-MTH             TO AAPLMTHO.                   15390073
154000     MOVE ASC-PSTG-WEEK            TO AAPLWKO.                    15400073
154100     MOVE ASC-USER-ID              TO AENTRIDO.                   15410073
154200     IF ASC-DUE-DATE-MM > SPACE AND                               15420073
154300        ASC-DUE-DATE-DD > SPACE AND                               15430073
154400        ASC-DUE-DATE-YY > SPACE                                   15440073
154500        STRING ASC-DUE-DATE-MM,                                   15450073
154600               '/',                                               15460073
154700               ASC-DUE-DATE-DD,                                   15470073
154800               '/',                                               15480073
154900               ASC-DUE-DATE-YY                                    15490073
155000              DELIMITED BY SIZE                                   15500073
155100              INTO ADUEDTEO                                       15510073
155200        END-STRING                                                15520073
155300     ELSE                                                         15530073
155400        MOVE SPACES TO ADUEDTEO                                   15540073
155500     END-IF.                                                      15550073
155600                                                                  15560073
157200     MOVE ASC-REASON-CODE1         TO AREAS1O.                    15720073
157300     MOVE ASC-REASON-CODE2         TO AREAS2O.                    15730073
157400                                                                  15740073
157500     IF ASC-ALP-DET-STORE NUMERIC                                 15750073
157600        MOVE ASC-DET-STORE         TO PV-NUM4                     15760073
157700        MOVE PV-NUM4-X             TO ASTR01O                     15770073
157800     ELSE                                                         15780073
157900        MOVE ASC-ALP-DET-STORE     TO ASTR01O                     15790073
158000     END-IF.                                                      15800073
158100                                                                  15810073
158200     MOVE ASC-DET-CLASS            TO ACLS01O.                    15820073
158300                                                                  15830073
158400     IF ASC-ALP-DET-SKU NUMERIC                                   15840081
158500        IF ASC-DET-SKU = +0                                       15850081
158600           MOVE SPACES             TO ASKU01O                     15860083
158700                                      ASC-ALP-DET-SKU             15870083
158800        ELSE                                                      15880081
158900           MOVE ASC-DET-SKU        TO PV-NUM8                     15890083
159000           MOVE PV-NUM8-X          TO ASKU01O                     15900083
159100                                      ASC-ALP-DET-SKU             15910083
159200        END-IF                                                    15920081
159300     ELSE                                                         15930081
159400        MOVE ASC-ALP-DET-SKU       TO ASKU01O                     15940083
159500     END-IF                                                       15950081
159600                                                                  15960079
159700     IF ASC-ALP-DET-COST(2:12) NUMERIC                            15970073
159800        IF ASC-DET-COST = +0                                      15980073
159900           MOVE SPACES             TO ACST01O                     15990073
160000                                      ASC-ALP-DET-COST            16000073
160100        ELSE                                                      16010073
160200           MOVE ASC-DET-COST       TO PV-10V99                    16020073
160300           MOVE PV-10V99           TO ACST01O                     16030073
160400                                      ASC-ALP-DET-COST            16040073
160500         END-IF                                                   16050073
160600     ELSE                                                         16060073
160700         MOVE ASC-ALP-DET-COST     TO ACST01O                     16070073
160800     END-IF.                                                      16080073
160900                                                                  16090073
161000     IF ASC-ALP-DET-RETL(2:12) NUMERIC                            16100073
161100        IF ASC-DET-RETAIL = +0                                    16110073
161200           MOVE SPACES             TO ARET01O                     16120073
161300                                      ASC-ALP-DET-RETL            16130073
161400        ELSE                                                      16140073
161500           MOVE ASC-DET-RETAIL     TO PV-10V99                    16150073
161600           MOVE PV-10V99           TO ARET01O                     16160073
161700                                      ASC-ALP-DET-RETL            16170073
161800         END-IF                                                   16180073
161900     ELSE                                                         16190073
162000         MOVE ASC-ALP-DET-RETL     TO ARET01O                     16200073
162100     END-IF.                                                      16210073
162200                                                                  16220073
162300     IF ASC-DET-NET = +0                                          16230073
162400        MOVE SPACES             TO ANET01O                        16240073
162500                                   ASC-DET-NET-X                  16250073
162600     ELSE                                                         16260073
162700        MOVE ASC-DET-NET        TO PV-10V99                       16270073
162800        MOVE PV-10V99           TO ANET01O                        16280073
162900                                   ASC-DET-NET-X                  16290073
163000     END-IF.                                                      16300073
163100                                                                  16310073
163200******************************************************************16320073
163300* THIS PARAGRAPH WILL VALIDATE THE VENDOR NUMBER ENTERED IN THE  *16330073
163400* HEADER PORTION OF THE SCREEN.  THE VENDOR DESCRIPTION WILL BE  *16340073
163500* RETRIEVED FOR DISPLAY PURPOSES.                                *16350073
163600******************************************************************16360073
163700 4800-VALIDATE-VENDOR.                                            16370073
163800                                                                  16380073
163900     PERFORM                                                      16390073
164000        WITH TEST AFTER                                           16400073
164100         VARYING PV-RETRY-COUNTER                                 16410073
164200        FROM 1 BY 1                                               16420073
164300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16430073
164400                  OR (SQLCODE = ZERO)                             16440073
164500                   OR (SQLCODE = +100)                            16450073
164600                  OR (SQLCODE = -811))                            16460073
164700                                                                  16470073
164800     EXEC SQL                                                     16480073
164900         SELECT B.ENT_NAME_DESC                                   16490073
165000               ,A.ENT_ID                                          16500073
165100         INTO   :ENTNME-ENT-NAME-DESC                             16510073
165200               ,:EXTENT-ENT-ID                                    16520073
165300         FROM   TEXTENT A                                         16530073
165400               ,TENTNME B                                         16540073
165500         WHERE  A.DUN_NBR = :EXTENT-DUN-NBR                       16550073
165600         AND    A.ENT_ID  =  B.ENT_ID                             16560073
165700         AND   B.TYPE_CDE =  '01'                                 16570073
165800* 0723   AND A.STATUS_CDE =  'A'                                  16580073
165900     END-EXEC                                                     16590073
166000                                                                  16600073
166100     EVALUATE TRUE                                                16610073
166200         WHEN SQLCODE = ZERO                                      16620073
166300         WHEN SQLCODE = -811                                      16630073
166400             CONTINUE                                             16640073
166500         WHEN SQLCODE = -904                                      16650073
166600         WHEN SQLCODE = -913                                      16660073
166700         WHEN SQLWARN0 NOT = SPACES                               16670073
166800         WHEN SQLCODE < ZERO                                      16680073
166900         WHEN SQLCODE > ZERO                                      16690073
167000             MOVE '4800-VALIDATE-VEND'                            16700073
167100                               TO DP013-PARAGRAPH                 16710073
167200             MOVE 'SELECT TEXTENT         '                       16720073
167300                               TO DP013-MESSAGE-TEXT (1)          16730073
167400             MOVE SQLCA        TO DP013-SQLCA                     16740073
167500             MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)        16750073
167600             SET DP013-DB2-ABEND                                  16760073
167700                 DP013-XCTL-DISPLAY-RESTART                       16770073
167800                                     TO TRUE                      16780073
167900             PERFORM DP013-0000-PROCESS-ABEND                     16790073
168000     END-EVALUATE                                                 16800073
168100     END-PERFORM.                                                 16810073
168200                                                                  16820073
168300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         16830073
168400         MOVE '4800-VALIDATE-VEND'                                16840073
168500                                   TO DP013-PARAGRAPH             16850073
168600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     16860073
168700                                   TO DP013-MESSAGE-TEXT (1)      16870073
168800         MOVE 'ENTITY ID    '  TO DP013-MESSAGE-TEXT (2)          16880073
168900         MOVE SQLCA            TO DP013-SQLCA                     16890073
169000         MOVE 'TEXTENT'        TO DP013-DB2-TABLE-NAME (1)        16900073
169100         SET DP013-DB2-ABEND                                      16910073
169200             DP013-XCTL-DISPLAY-RESTART                           16920073
169300                                   TO TRUE                        16930073
169400         PERFORM DP013-0000-PROCESS-ABEND                         16940073
169500     END-IF.                                                      16950073
169600                                                                  16960073
169700******************************************************************16970073
169800* FORMAT THE ADJUSTMENT JOURNAL RECORDS FOR PASSING TO THE DETAIL*16980073
169900******************************************************************16990073
170000 5000-ADD-AP-KEY-ADJUSTMENT.                                      17000073
170100                                                                  17010073
170200     MOVE ASC-VENDOR-NUMBER       TO AP363-VND-NBR                17020073
170300                                     ASC-KEY-VEND-NUMBER.         17030073
170400                                                                  17040073
170500     PERFORM 5010-FORMAT-AP-ADJUSTMENT.                           17050073
170600                                                                  17060073
170700******************************************************************17070073
170800* THIS PARAGRAPH WILL FORMAT ADJUSTMENT DISTRIBUTION DATA FOR    *17080073
170900* PASSING TO THE DISTRIBUTION INQUIRY SCREEN.                    *17090073
171000******************************************************************17100073
171100 5010-FORMAT-AP-ADJUSTMENT.                                       17110073
171200                                                                  17120073
171300     MOVE ASC-DOC-NUMBER           TO AP363-DOC-NBR               17130073
171400                                      ASC-KEY-DOC-NUMBER.         17140073
171500     MOVE ASC-DOC-DATE             TO AP363-DOC-DTE               17150073
171600                                      ASC-KEY-DOC-DATE.           17160073
171700     MOVE ASC-TRAN-CD              TO AP363-AP-TRN-CDE            17170073
171800                                      ASC-KEY-TRAN-CODE.          17180073
171900     MOVE ASC-DEPARTMENT           TO AP363-DEPT-NBR.             17190073
172000     MOVE ASC-ACCT-NO              TO AP363-GL-ACCT-NBR.          17200073
172100     MOVE ASC-STORE                TO AP363-STR-NBR.              17210073
172200     MOVE ASC-PO-NUMBER            TO AP363-PO-NBR.               17220073
172300     MOVE DP020-USERID             TO AP363-ENTR-ID.              17230073
172400     MOVE ASC-PS-BATCH-NBR         TO AP363-PS-BTCH-NBR.          17240076
172500     MOVE ASC-PS-POSTING-IND       TO AP363-PS-PSTG-IND.          17250076
172600     MOVE ASC-DOC-EXTRACT-IND      TO AP363-DOC-EXTR-IND.         17260076
172700     MOVE ASC-DOC-EXTRACT-DTE      TO AP363-DOC-EXTR-DTE.         17270077
172800     MOVE ASC-ORIGIN-CDE           TO AP363-ORGN-CDE.             17280076
172900     MOVE ASC-GROSS-COST           TO AP363-GRO-COST-AMT.         17290073
173000     MOVE ASC-RETAIL-AMT           TO AP363-RTL-AMT.              17300073
173100     MOVE ASC-MOS-AMT              TO AP363-MOS-DISC-AMT.         17310073
173200     MOVE ASC-FREIGHT-AMT          TO AP363-FRGT-AMT.             17320073
173300     MOVE ASC-MISC-CHG             TO AP363-MISC-CHRG-AMT.        17330073
173400     INITIALIZE PV-PERCENT-VARIABLE.                              17340073
173500     COMPUTE PV-PERCENT-VARIABLE =                                17350073
173600             ASC-MOS-PCT / 100.                                   17360073
173700     MOVE PV-PERCENT-VARIABLE      TO AP363-MOS-DISC-PCT.         17370073
173800     INITIALIZE PV-PERCENT-VARIABLE.                              17380073
173900     COMPUTE PV-PERCENT-VARIABLE =                                17390073
174000             ASC-DISC-PCT / 100.                                  17400073
174100     MOVE PV-PERCENT-VARIABLE      TO AP363-TERM-DISC-PCT.        17410073
174200     MOVE ASC-DISC-AMT             TO AP363-TERM-DISC-AMT.        17420073
174300     INITIALIZE PV-PERCENT-VARIABLE.                              17430073
174400     COMPUTE PV-PERCENT-VARIABLE =                                17440073
174500             ASC-NEWST-PCT / 100.                                 17450073
174600     MOVE PV-PERCENT-VARIABLE      TO AP363-NW-STR-DISC-PCT.      17460073
174700     MOVE ASC-NEWST-AMT            TO AP363-NW-STR-DISC-AMT.      17470073
174800     INITIALIZE PV-PERCENT-VARIABLE.                              17480073
174900     COMPUTE PV-PERCENT-VARIABLE =                                17490073
175000             ASC-TRADE-PCT / 100.                                 17500073
175100     MOVE PV-PERCENT-VARIABLE      TO AP363-TRD-DISC-PCT.         17510073
175200     MOVE ASC-TRADE-AMT            TO AP363-TRD-DISC-AMT.         17520073
175300     MOVE ASC-NET-COST             TO AP363-NET-COST-AMT.         17530073
175400     MOVE ASC-CUTOFF-DATE          TO AP363-INV-CTOFF-DTE.        17540091
175500     MOVE ASC-TRN-TYP-CDE          TO AP363-TRN-TYP-CDE.          17550073
175600     MOVE ASC-BARCODE              TO AP363-BRCDE-NBR.            17560073
175700     MOVE ASC-VENDOR-NAME          TO AP363-VENDOR-NAME.          17570079
175800     MOVE ASC-DET-COST             TO AP363-DIS-GRO-COST-AMT.     17580079
175900     MOVE ASC-DET-STORE            TO AP363-DIS-STR-NBR.          17590079
176000     MOVE ASC-DET-CLASS            TO AP363-DIS-CL-NBR.           17600079
176100     MOVE ASC-DET-SKU              TO AP363-DIS-SKU-NBR.          17610079
176200     MOVE ASC-DET-RETAIL           TO AP363-DIS-RTL-AMT.          17620079
176300     MOVE ASC-DET-NET              TO AP363-DIS-NET-COST-AMT.     17630079
176400     MOVE ASC-DET-DISTRB-SEQ       TO AP363-DISTRB-SEQ-NBR.       17640079
176500     MOVE ASC-MULT-DISTRO-IND     TO AP363-MULT-DISTRO-IND.       17650079
176600     MOVE ASC-COST-PRCCTL-CDE     TO AP363-COST-PRCCTL-CDE.       17660073
176700     MOVE ASC-RTL-PRCCTL-CDE      TO AP363-RTL-PRCCTL-CDE.        17670073
176800     MOVE ASC-PSTG-TYP-CDE        TO AP363-PSTG-TYP-CDE.          17680073
176900     MOVE ASC-FRGT-REQR-IND       TO AP363-FRGT-REQR-IND.         17690073
177000     MOVE ASC-SKU-SEQ-REQR-IND    TO AP363-SKU-SEQ-REQR-IND.      17700073
177100     MOVE ASC-SUB-CL-REQR-IND     TO AP363-SUB-CL-REQR-IND.       17710073
177200     MOVE ASC-ALLOCATION-SW       TO AP363-ALLOCATION-SW.         17720073
177300                                                                  17730073
177400     PERFORM 5015-FORMAT-REMAIN-DTL-LAYOUT.                       17740073
177500                                                                  17750073
177600******************************************************************17760073
177700* THIS PARAGRAPH WILL FORMAT REMAINING APWS363 FIELDS.           *17770073
177800******************************************************************17780073
177900 5015-FORMAT-REMAIN-DTL-LAYOUT.                                   17790073
178000                                                                  17800073
178100     MOVE ASC-DUE-DATE            TO AP363-DUE-DTE.               17810073
178200     IF ASC-HOLD-STATUS > SPACES                                  17820073
178300        MOVE ASC-HOLD-STATUS      TO AP363-DOC-HLD-CDE            17830073
178400     ELSE                                                         17840073
178500        MOVE 'N'                  TO AP363-DOC-HLD-CDE            17850073
178600     END-IF.                                                      17860073
178700     MOVE ASC-REASON-CODE1        TO AP363-RSN-1ST-LNE-TXT.       17870073
178800     MOVE ASC-REASON-CODE2        TO AP363-RSN-2ND-LNE-TXT.       17880073
178900     MOVE ASC-VENDOR-AUTH         TO AP363-AUTH-NBR.              17890073
179000                                                                  17900073
179100******************************************************************17910073
179200* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *17920073
179300* OBJECT WAS UPDATED.                                            *17930073
179400******************************************************************17940073
179500 5500-UPDATE-SELECTION-QUEUE.                                     17950073
179600                                                                  17960073
179700      PERFORM 9100-READ-SEL-QUEUE.                                17970073
179800                                                                  17980073
179900      IF ASC-DELETE-SUCCESSFUL OR                                 17990073
180000         ASC-DELETE-REQUESTED                                     18000073
180100          SET AP362-DEL (ASC-SEL-SUB) TO TRUE                     18010073
180200      ELSE                                                        18020073
180300          IF ASC-UPDATE-REQUESTED                                 18030073
180400             SET AP362-UPD (ASC-SEL-SUB) TO TRUE                  18040073
180500          ELSE                                                    18050073
180600             SET AP362-INQ (ASC-SEL-SUB) TO TRUE                  18060073
180700          END-IF                                                  18070073
180800      END-IF.                                                     18080073
180900                                                                  18090073
181000      PERFORM 9200-REWRITE-LIST-QUEUE.                            18100073
181100                                                                  18110073
181200******************************************************************18120073
181300* THIS PARAGRAPH WILL PERFORM A WRITE TO THE TEMPORARY STORAGE   *18130073
181400* QUEUE.                                                         *18140073
181500******************************************************************18150073
181600 5900-WRITE-TS-QUEUE.                                             18160073
181700                                                                  18170073
181800     MOVE EIBTRMID                 TO PV-SEL-TERM-ID.             18180073
181900     MOVE DP020-SRC-TASK-NUMBER    TO PV-SEL-TASK-NUMBER.         18190073
182000     MOVE PC-SEL-QUEUE-SEQ         TO PV-SEL-SEQ.                 18200073
182100*    MOVE PV-SEL-QUEUE-NAME        TO ASC-SEL-QUEUE-NAME          18210073
182200*                                     AP361-SEL-QUEUE-NAME.       18220073
182300     MOVE PV-SEL-QUEUE-NAME        TO ASC-TS-QUEUE-NAME           18230073
182400                                      AP361-TS-QUEUE-NAME.        18240073
182500                                                                  18250073
182600     EXEC CICS                                                    18260073
182700          WRITEQ TS                                               18270073
182800              QUEUE (ASC-TS-QUEUE-NAME)                           18280073
182900              FROM  (AP363-ADJUST-HEADER-AREA)                    18290073
183000              ITEM  (PC-SEL-QUEUE-ITEM)                           18300073
183100              RESP  (PV-CICS-RESPONSE)                            18310073
183200     END-EXEC.                                                    18320073
183300                                                                  18330073
183400     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       18340073
183500         CONTINUE                                                 18350073
183600     ELSE                                                         18360073
183700         SET DP013-CICS-ABEND      TO TRUE                        18370073
183800         SET DP013-NO-ROLLBACK     TO TRUE                        18380073
183900         MOVE '5900-WRITE-TS-QUEUE'                               18390073
184000                                   TO DP013-PARAGRAPH             18400073
184100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          18410073
184200                                   TO DP013-MESSAGE-TEXT(1)       18420073
184300         PERFORM DP013-0000-PROCESS-ABEND                         18430073
184400     END-IF.                                                      18440073
184500                                                                  18450073
184600******************************************************************18460073
184700* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *18470073
184800******************************************************************18480073
184900 9100-READ-SEL-QUEUE.                                             18490073
185000                                                                  18500073
185100     EXEC CICS                                                    18510073
185200         READQ TS                                                 18520073
185300             QUEUE (ASC-SEL-QUEUE-NAME)                           18530073
185400             INTO  (AP362-ADJUSTMENT-SEL-REC)                     18540073
185500             ITEM  (ASC-SEL-ITEM)                                 18550073
185600             RESP  (PV-CICS-RESPONSE)                             18560073
185700     END-EXEC.                                                    18570073
185800                                                                  18580073
185900     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   18590073
186000         CONTINUE                                                 18600073
186100     ELSE                                                         18610073
186200         SET DP013-LOGIC-ABEND                                    18620073
186300             DP013-NO-ROLLBACK     TO TRUE                        18630073
186400         MOVE '9100-READ-SEL-QUEUE'                               18640073
186500                                   TO DP013-PARAGRAPH             18650073
186600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   18660073
186700                                   TO DP013-MESSAGE-TEXT (1)      18670073
186800         PERFORM DP013-0000-PROCESS-ABEND                         18680073
186900     END-IF.                                                      18690073
187000                                                                  18700073
187100******************************************************************18710073
187200* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *18720073
187300******************************************************************18730073
187400 9200-REWRITE-LIST-QUEUE.                                         18740073
187500                                                                  18750073
187600     EXEC CICS                                                    18760073
187700          WRITEQ TS                                               18770073
187800              QUEUE  (ASC-SEL-QUEUE-NAME)                         18780073
187900              FROM   (AP362-ADJUSTMENT-SEL-REC)                   18790073
188000              ITEM   (ASC-SEL-ITEM)                               18800073
188100              RESP   (PV-CICS-RESPONSE)                           18810073
188200              REWRITE                                             18820073
188300     END-EXEC.                                                    18830073
188400                                                                  18840073
188500     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               18850073
188600         SET DP013-CICS-ABEND                                     18860073
188700             DP013-NO-ROLLBACK     TO TRUE                        18870073
188800         MOVE '9200-REWRITE-LIST-QUEUE'                           18880073
188900                                   TO DP013-PARAGRAPH             18890073
189000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   18900073
189100                                   TO DP013-MESSAGE-TEXT (1)      18910073
189200         PERFORM DP013-0000-PROCESS-ABEND                         18920073
189300     END-IF.                                                      18930073
189400                                                                  18940073
189500******************************************************************18950073
189600                                                                  18960073
189700     COPY DPPD013.                                                18970073
