000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             ARKUT031.                                00050000
000600 AUTHOR.                 TAMARA KOLTUN.                           00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            6-26-95.                                 00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  12/07/95 AJR - MODIFIED THE PROGRAM TO READ IN A SELECT       *00120000
001300*      SYSTEM DATE FILE.  THIS DATE WILL BE USED IN THE HEADING  *00130000
001400*      OF THE REPORT.  IT WAS USING THE DATE FROM THE FIRST      *00140000
001500*      RECORD IN THE FILE, BUT THIS WAS NOT ALWAYS THE CORRECT   *00150000
001600*      SELECT SYSTEM DATE.                                       *00160000
001610******************************************************************00161000
001620*  02/23/04 BDH - CHANGED THE SIZE OF THE VARIABLE THAT HOLDS THE*00162000
001630*      STORE NUMBER TO A PIC (4) TO ACCOMODATE STORE NUMBERS     *00163000
001640*      GREATER THAN 999.                                         *00164000
001650******************************************************************00165000
001700*                                                                 00170000
001800***NOTE***                                                        00180000
001900***THIS PROGRAM CREATES A FILE USING 'DYNALC'. THIS FILE          00190000
002000***CANNOT BE FOUND IN THE JCL.  THE REASON IT CREATES THE         00200000
002100***FILE THIS WAY IS SO THAT THE SELECT SYSTEM DATE FROM           00210000
002200***THE GL FILE CAN BE USED IN NAMING THIS FILE. THE FILE          00220000
002300***IS CALLED PKMO.AR.BILLBAL.FILE.DTYYMMDD (WHERE YYMMDD IS       00230000
002400***THE TANDEM SELECT SYSTEM DATE.                                 00240000
002500******************************************************************00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700******************************************************************00270000
002800                                                                  00280000
002900 CONFIGURATION SECTION.                                           00290000
003000                                                                  00300000
003100 SOURCE-COMPUTER.        IBM-3090.                                00310000
003200 OBJECT-COMPUTER.        IBM-3090.                                00320000
003300                                                                  00330000
003400 INPUT-OUTPUT SECTION.                                            00340000
003500                                                                  00350000
003600 FILE-CONTROL.                                                    00360000
003700                                                                  00370000
003800      SELECT GL-UPDATE-SUMMARY-FILE   ASSIGN TO INP01.            00380000
003900      SELECT SD-SELECT-DATE-FILE      ASSIGN TO INP02.            00390000
004100      SELECT GL-UPDATE-DAILY-REPORT   ASSIGN TO RPT01.            00410000
004200                                                                  00420000
004300******************************************************************00430000
004400 DATA DIVISION.                                                   00440000
004500******************************************************************00450000
004600                                                                  00460000
004700 FILE SECTION.                                                    00470000
004800 FD  GL-UPDATE-SUMMARY-FILE                                       00480000
004900     LABEL RECORDS ARE STANDARD                                   00490000
005000     BLOCK CONTAINS 0 RECORDS                                     00500000
005100     RECORDING MODE IS F                                          00510000
005200     RECORD CONTAINS 81  CHARACTERS                               00520000
005300     DATA RECORD IS GL-UPDATE-SUMMARY-RECORD.                     00530000
005400                                                                  00540000
005500 01  GL-UPDATE-SUMMARY-RECORD        PIC X(81).                   00550000
005600                                                                  00560000
005700 FD  SD-SELECT-DATE-FILE                                          00570000
005800     LABEL RECORDS ARE STANDARD                                   00580000
005900     BLOCK CONTAINS 0 RECORDS                                     00590000
006000     RECORDING MODE IS F                                          00600000
006100     RECORD CONTAINS 80  CHARACTERS                               00610000
006200     DATA RECORD IS SD-SELECT-DATE-RECORD.                        00620000
006300                                                                  00630000
006400 01  SD-SELECT-DATE-RECORD           PIC X(80).                   00640000
006500                                                                  00650000
006600 FD  GL-UPDATE-DAILY-REPORT                                       00660000
006700     LABEL RECORDS ARE STANDARD                                   00670000
006800     BLOCK CONTAINS 0 RECORDS                                     00680000
006900     RECORDING MODE IS F                                          00690000
007000     RECORD CONTAINS 132 CHARACTERS                               00700000
007100     DATA RECORD IS GL-UPDATE-DAILY-RPT-RECORD.                   00710000
007200                                                                  00720000
007300 01  GL-UPDATE-DAILY-RPT-RECORD      PIC X(132).                  00730000
007400                                                                  00740000
008600*------------------------------------------------------*          00860000
008700 WORKING-STORAGE SECTION.                                         00870000
008800*------------------------------------------------------*          00880000
008900 01 PC-PROGRAM-CONSTANTS.                                         00890000
009000    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'ARKUT031'.  00900000
009100    05 PC-REPORT-NBR                 PIC 9(01) VALUE 1.           00910000
009200    05 PC-ACT-0020116                PIC 9(07) VALUE 0020116.     00920000
009300    05 PC-ACT-0010102                PIC 9(07) VALUE 0010102.     00930000
009400    05 PC-DEBIT                      PIC X(02) VALUE 'DR'.        00940000
009500    05 PC-CREDIT                     PIC X(02) VALUE 'CR'.        00950000
009600    05 PC-PLUS                       PIC X(01) VALUE '+'.         00960000
009700    05 PC-MINUS                      PIC X(01) VALUE '-'.         00970000
009800 01 PV-PROGRAM-VARIABLES.                                         00980000
009900    05 ABEND-CODE                    PIC S9(04)    VALUE +0       00990000
010000                                                   COMP SYNC.     01000000
010100    05 PV-SYSTEM-DATE.                                            01010000
010200       10 PV-SYSTEM-YY               PIC  9(02)    VALUE 0.       01020000
010300       10 PV-SYSTEM-MM               PIC  9(02)    VALUE 0.       01030000
010400       10 PV-SYSTEM-DD               PIC  9(02)    VALUE 0.       01040000
010500    05 PV-DATE-MMDDYY.                                            01050000
010600       10 PV-DATE-MM                 PIC  9(02)    VALUE 0.       01060000
010700       10 PV-DATE-DD                 PIC  9(02)    VALUE 0.       01070000
010800       10 PV-DATE-YY                 PIC  9(02)    VALUE 0.       01080000
010900    05 PV-CC                         PIC  9(02)    VALUE 0.       01090000
011000    05 PV-DATE-SQL-FORMAT.                                        01100000
011100       10 PV-DATE-SQL-CC             PIC X(2)      VALUE SPACES.  01110000
011200       10 PV-DATE-SQL-YY             PIC X(2)      VALUE SPACES.  01120000
011300       10 FILLER                     PIC X(1)      VALUE '-'.     01130000
011400       10 PV-DATE-SQL-MM             PIC X(2)      VALUE SPACES.  01140000
011500       10 FILLER                     PIC X(1)      VALUE '-'.     01150000
011600       10 PV-DATE-SQL-DD             PIC X(2)      VALUE SPACES.  01160000
011700    05 PV-CURRENT-TIME.                                           01170000
011800       10 PV-CURRENT-HH              PIC 9(02)     VALUE 0.       01180000
011900       10 PV-CURRENT-MM              PIC 9(02)     VALUE 0.       01190000
012000       10 FILLER                     PIC 9(04)     VALUE ZERO.    01200000
012100    05 PV-LINE-COUNT                 PIC S9(04)    VALUE 61       01210000
012200                                                   COMP.          01220000
012300    05 PV-PAGE-COUNT                 PIC S9(04)    VALUE 0.       01230000
012400    05 PV-ACT-NBR-HOLD               PIC  X(07)    VALUE ZERO.    01240000
012500    05 PV-DISPLAY-ERROR              PIC X(45)     VALUE SPACE.   01250000
012600    05 PV-BILL-TRAN-AMT-CREDIT       PIC 9(13)V99   VALUE ZERO.   01260051
012700    05 PV-BILL-TRAN-AMT-DEBIT        PIC 9(13)V99   VALUE ZERO.   01270051
012800                                                                  01280000
012900 01 PA-PROGRAM-ACCUMULATORS.                                      01290000
013000    05 PA-CREDIT-TOT-ACCUM           PIC S9(13)V99 COMP-3 VALUE 0.01300051
013100    05 PA-DEBIT-TOT-ACCUM            PIC S9(13)V99 COMP-3 VALUE 0.01310051
013200 01 PS-PROGRAM-SWITCHES.                                          01320000
013300    05 PS-END-OF-FILE-IND            PIC  X(01)    VALUE ' '.     01330000
013400       88 PS-EOF                                   VALUE 'E'.     01340000
013500    05 PS-INPUT-FILE-EMPTY-SW        PIC  X(01)    VALUE ' '.     01350000
013600       88 PS-INPUT-FILE-EMPTY                      VALUE 'Y'.     01360000
013700    05 PS-DEBIT-AMT-READ-SW          PIC  X(01)    VALUE ' '.     01370000
013800       88 PS-DEBIT-AMT-READ                        VALUE 'Y'.     01380000
013900    05 PS-CREDIT-AMT-READ-SW         PIC  X(01)    VALUE ' '.     01390000
014000       88 PS-CREDIT-AMT-READ                       VALUE 'Y'.     01400000
021300*                                                                 02130000
021400* ALLOCATED FILE NAME                                             02140000
021500*                                                                 02150000
021600                                                                  02160000
022500*** STANDARD HEADER LINE - 132 BYTES.                             02250000
022600     COPY DPWS132O.                                               02260000
022700***                                                               02270000
022800*-------------------------------------------------------------    02280000
022810* INPUT COPYBOOK                                                  02281000
022820*-------------------------------------------------------------    02282000
022900     COPY ARRD022.                                                02290000
023000     COPY ARRD009.                                                02300000
023100                                                                  02310000
023200 01 GL-UPDATE-DAILY-REPORT-AREA.                                  02320000
023300    05 GL-HEADER-LINE-2.                                          02330000
023400       10 FILLER                     PIC  X(47)      VALUE SPACE. 02340000
023500       10 FILLER                     PIC  X(40)      VALUE        02350000
023600                      'KOHLS CREDIT GENERAL LEDGER DAILY REPORT'. 02360000
023700       10 FILLER                     PIC  X(45)      VALUE SPACE. 02370000
023800                                                                  02380000
023900    05 GL-HEADER-LINE-3.                                          02390000
024000       10 FILLER                     PIC  X(52)      VALUE SPACE. 02400000
024100       10 FILLER                     PIC  X(17)      VALUE        02410000
024200                                         'TRANSACTION DATE '.     02420000
024300       10 GL-MM                      PIC 9(02).                   02430000
024400       10 FILLER                     PIC X(01) VALUE '/'.         02440000
024500       10 GL-DD                      PIC 9(02).                   02450000
024600       10 FILLER                     PIC X(01) VALUE '/'.         02460000
024700       10 GL-YY                      PIC 9(02).                   02470000
024800       10 FILLER                     PIC  X(55)      VALUE SPACE. 02480000
024900                                                                  02490000
025000    05 GL-HEADER-LINE-4.                                          02500000
025100       10 FILLER                     PIC  X(20)      VALUE SPACE. 02510000
025200       10 FILLER                     PIC  X(15)      VALUE        02520000
025300                                               'G/L ACCT NUMBER'. 02530000
025400       10 FILLER                     PIC  X(06)      VALUE SPACE. 02540000
025500       10 FILLER                     PIC  X(05)      VALUE        02550000
025600                                                'DR/CR'.          02560000
025700       10 FILLER                     PIC  X(06)      VALUE SPACE. 02570000
025800       10 FILLER                     PIC  X(23)      VALUE        02580000
025900                                       'TRANSACTION DESCRIPTION'. 02590000
026000       10 FILLER                     PIC  X(20)      VALUE SPACE. 02600000
026100       10 FILLER                     PIC  X(06)      VALUE        02610000
026200                                       'AMOUNT'.                  02620000
026300       10 FILLER                     PIC  X(31)      VALUE SPACE. 02630000
026400    05 GL-NO-ACTIVITY-MESSAGE.                                    02640000
026500       10 FILLER                     PIC  X(20)      VALUE SPACE. 02650000
026600       10 FILLER                     PIC  X(32)      VALUE        02660000
026700                     '*** THERE WAS NO GL ACTIVITY ***'.          02670000
026800       10 FILLER                     PIC  X(80)      VALUE SPACE. 02680000
026900    05 GL-DETAIL-LINE.                                            02690000
027000       10 FILLER                     PIC  X(21)      VALUE SPACE. 02700000
027100       10 GL-ASTERISK                PIC  X(01)      VALUE SPACE. 02710000
027200       10 GL-STORE-NBR               PIC  9(04).                  02720000
027300       10 FILLER                     PIC  X(01)      VALUE SPACE. 02730000
027400       10 GL-ACCOUNT-NUMBER          PIC  X(07).                  02740000
027500       10 FILLER                     PIC  X(09)      VALUE SPACE. 02750000
027600       10 GL-CR-DB                   PIC  X(02).                  02760000
027700       10 FILLER                     PIC  X(08)      VALUE SPACE. 02770000
027800       10 GL-TRANS-DESCRIPTION       PIC  X(32).                  02780000
027900       10 FILLER                     PIC  X(06)      VALUE SPACE. 02790000
028000       10 GL-AMT               PIC  ZZ,ZZZ,ZZZ,ZZZ.99.            02800056
028100       10 GL-SIGN                    PIC  X(01)      VALUE SPACE. 02810000
028200       10 FILLER                     PIC  X(23)      VALUE SPACE. 02820052
028300    05 GL-TOTAL-LINE-1.                                           02830053
028400       10 FILLER                     PIC  X(53)      VALUE SPACE. 02840000
028500       10 FILLER                     PIC  X(12)      VALUE        02850000
028600                                     'TOTAL DEBITS'.              02860000
028700       10 FILLER                     PIC  X(23)      VALUE SPACE. 02870058
028800       10 GL-DEBIT-AMT    PIC  Z,ZZZ,ZZZ,ZZZ,ZZZ.99.              02880055
028900       10 GL-DEBIT-PLUS              PIC  X(01)      VALUE '+'.   02890000
029000       10 FILLER                     PIC  X(23)      VALUE SPACE. 02900058
029100    05 GL-TOTAL-LINE-2.                                           02910000
029200       10 FILLER                     PIC  X(53)      VALUE SPACE. 02920000
029300       10 FILLER                     PIC  X(13)      VALUE        02930000
029400                                     'TOTAL CREDITS'.             02940000
029500       10 FILLER                     PIC  X(22)      VALUE SPACE. 02950058
029600       10 GL-CREDIT-AMT  PIC  Z,ZZZ,ZZZ,ZZZ,ZZZ.99.               02960055
029700       10 GL-CREDIT-MINUS            PIC  X(01)      VALUE '-'.   02970000
029800       10 FILLER                     PIC  X(23)      VALUE SPACE. 02980058
029900                                                                  02990000
030000********************************************************          03000000
030100 PROCEDURE DIVISION.                                              03010000
030200********************************************************          03020000
030300 0000-MAIN.                                                       03030000
030400     PERFORM 1000-INITIALIZATION       THRU 1000-EXIT.            03040000
030500     PERFORM 2000-PROCESS-INPUT        THRU 2000-EXIT             03050000
030600                            UNTIL PS-EOF.                         03060000
030700     IF PS-INPUT-FILE-EMPTY                                       03070000
030800        CONTINUE                                                  03080000
030900     ELSE                                                         03090000
031000        PERFORM 3000-WRITE-TOTALS      THRU 3000-EXIT             03100000
031300     END-IF.                                                      03130000
031400                                                                  03140000
031500     PERFORM 4000-FINISH               THRU 4000-EXIT.            03150000
031600                                                                  03160000
031700     STOP RUN.                                                    03170000
031800 0000-EXIT.                                                       03180000
031900                                                                  03190000
032000 1000-INITIALIZATION.                                             03200000
032100       ACCEPT PV-SYSTEM-DATE      FROM DATE.                      03210000
032200                                                                  03220000
032300       MOVE PV-SYSTEM-MM      TO DP132O-RUN-MONTH.                03230000
032400       MOVE PV-SYSTEM-DD      TO DP132O-RUN-DAY.                  03240000
032500       MOVE PV-SYSTEM-YY      TO DP132O-RUN-YEAR.                 03250000
032600                                                                  03260000
032700       ACCEPT PV-CURRENT-TIME     FROM TIME.                      03270000
032800       MOVE PV-CURRENT-HH     TO DP132O-RUN-HOUR.                 03280000
032900       MOVE PV-CURRENT-MM     TO DP132O-RUN-MINUTE.               03290000
033000                                                                  03300000
033100       MOVE PC-PROGRAM-NAME   TO DP132O-PROGRAM-NAME.             03310000
033200       MOVE PC-REPORT-NBR TO DP132O-REPORT-NUMBER.                03320000
033300                                                                  03330000
033400       INITIALIZE AR022-GL-INTERFACE.                             03340000
033500       INITIALIZE AR009-SYSTEM-DATE-RECORD.                       03350000
033600                                                                  03360000
033700                                                                  03370000
033800       OPEN INPUT     GL-UPDATE-SUMMARY-FILE                      03380000
033900            INPUT     SD-SELECT-DATE-FILE                         03390000
034000            OUTPUT    GL-UPDATE-DAILY-REPORT.                     03400000
034100                                                                  03410000
034200       READ GL-UPDATE-SUMMARY-FILE INTO AR022-GL-INTERFACE        03420000
034300            AT END                                                03430000
034400               SET PS-EOF              TO TRUE                    03440000
034500               SET PS-INPUT-FILE-EMPTY TO TRUE                    03450000
034600               DISPLAY '***********************************'      03460000
034700               DISPLAY 'FROM ARKUT031: INPUT FILE IS EMPTY.'      03470000
034800               DISPLAY '***********************************'      03480000
034900               PERFORM 2310-WRITE-HEADERS THRU 2310-EXIT          03490000
035000               WRITE GL-UPDATE-DAILY-RPT-RECORD                   03500000
035100                                  FROM GL-NO-ACTIVITY-MESSAGE     03510000
035200                     AFTER ADVANCING 2 LINES                      03520000
035300       END-READ.                                                  03530000
035400                                                                  03540000
035500                                                                  03550000
035600       READ SD-SELECT-DATE-FILE                                   03560000
035700           INTO AR009-SYSTEM-DATE-RECORD                          03570000
035800            AT END                                                03580000
035900               DISPLAY '** ABEND **'                              03590000
036000               DISPLAY '** PROGRAM = ' PC-PROGRAM-NAME            03600000
036100               DISPLAY '** PARA = 1000-INITIALIZATION'            03610000
036200               DISPLAY '** INPUT SYSTEM DATE FILE IS EMPTY **'    03620000
036300               MOVE +4003        TO ABEND-CODE                    03630000
036400               CALL 'ILBOABN0'   USING ABEND-CODE                 03640000
036500       END-READ.                                                  03650000
036600                                                                  03660000
036700       MOVE AR009-SYSTEM-MM      TO  GL-MM                        03670000
036900                                     PV-DATE-SQL-MM.              03690000
037000       MOVE AR009-SYSTEM-DD      TO  GL-DD                        03700000
037200                                     PV-DATE-SQL-DD.              03720000
037300       MOVE AR009-SYSTEM-YY      TO  GL-YY                        03730000
037500                                     PV-DATE-SQL-YY.              03750000
037600       MOVE AR009-SYSTEM-CC      TO  PV-DATE-SQL-CC.              03760000
037700                                                                  03770000
038100 1000-EXIT.  EXIT.                                                03810000
038200                                                                  03820000
038300 2000-PROCESS-INPUT.                                              03830000
038400       PERFORM 2100-MOVES             THRU 2100-EXIT.             03840000
038500       PERFORM 2200-ACCUMULATE-TOTALS THRU 2200-EXIT.             03850000
038600       PERFORM 2300-WRITE-REPORT      THRU 2300-EXIT.             03860000
038700       IF AR022-ACCOUNT = '0010202'                               03870000
038800          IF AR022-DEBIT                                          03880000
038900             ADD AR022-AMOUNT TO PV-BILL-TRAN-AMT-DEBIT           03890000
039000          ELSE                                                    03900000
039100             ADD AR022-AMOUNT TO PV-BILL-TRAN-AMT-CREDIT          03910000
039200          END-IF                                                  03920000
039300       END-IF.                                                    03930000
039400       PERFORM 2400-READ-INPUT-FILE   THRU 2400-EXIT.             03940000
039500 2000-EXIT.  EXIT.                                                03950000
039600                                                                  03960000
039700 2100-MOVES.                                                      03970000
039800                                                                  03980000
039900     IF (AR022-ACCOUNT =  PC-ACT-0020116 AND AR022-DEBIT)         03990000
040000        OR                                                        04000000
040100        (AR022-ACCOUNT =  PC-ACT-0010102 AND AR022-CREDIT)        04010000
040200        MOVE '*'       TO GL-ASTERISK                             04020000
040300     ELSE                                                         04030000
040400        MOVE ' '       TO GL-ASTERISK                             04040000
040500     END-IF                                                       04050000
040600                                                                  04060000
040700     MOVE AR022-STORE          TO GL-STORE-NBR.                   04070000
040800     MOVE AR022-ACCOUNT        TO GL-ACCOUNT-NUMBER               04080000
040900     MOVE AR022-AMOUNT         TO GL-AMT.                         04090000
041000     IF AR022-DEBIT                                               04100000
041100        MOVE PC-DEBIT          TO GL-CR-DB                        04110000
041200        MOVE PC-PLUS           TO GL-SIGN                         04120000
041300     ELSE                                                         04130000
041400        MOVE PC-CREDIT         TO GL-CR-DB                        04140000
041500        MOVE PC-MINUS          TO GL-SIGN                         04150000
041600     END-IF                                                       04160000
041700*    MOVE AR022-DB-CR-IND      TO GL-CR-DB.                       04170000
041800     MOVE AR022-DESCRIPTION    TO GL-TRANS-DESCRIPTION.           04180000
042400                                                                  04240000
042500 2100-EXIT.  EXIT.                                                04250000
042600                                                                  04260000
042700 2200-ACCUMULATE-TOTALS.                                          04270000
042800        IF  AR022-DEBIT                                           04280000
042900            ADD AR022-AMOUNT     TO PA-DEBIT-TOT-ACCUM            04290000
043000        END-IF.                                                   04300000
043100                                                                  04310000
043200        IF  AR022-CREDIT                                          04320000
043300            ADD AR022-AMOUNT     TO PA-CREDIT-TOT-ACCUM           04330000
043400        END-IF.                                                   04340000
043500 2200-EXIT.  EXIT.                                                04350000
043600                                                                  04360000
043700 2300-WRITE-REPORT.                                               04370000
043800     PERFORM 2310-WRITE-HEADERS    THRU 2310-EXIT                 04380000
043900                                                                  04390000
044000*    IF GL-ACCOUNT-NUMBER = PV-ACCOUNT-NBR-HOLD                   04400000
044100        WRITE GL-UPDATE-DAILY-RPT-RECORD FROM GL-DETAIL-LINE      04410000
044200               AFTER ADVANCING 1 LINE                             04420000
044300        ADD 1                         TO PV-LINE-COUNT.           04430000
044900 2300-EXIT.  EXIT.                                                04490000
045000                                                                  04500000
045100                                                                  04510000
045200 2310-WRITE-HEADERS.                                              04520000
045300      IF PV-LINE-COUNT > 60                                       04530000
045400         ADD  1                 TO PV-PAGE-COUNT                  04540000
045500         MOVE PV-PAGE-COUNT                                       04550000
045600                                TO DP132O-PAGE-NUMBER             04560000
045700         MOVE 0                 TO PV-LINE-COUNT                  04570000
045800         WRITE GL-UPDATE-DAILY-RPT-RECORD FROM                    04580000
045900                              DP132O-STANDRD-HEADER-132-COLS      04590000
046000                AFTER ADVANCING PAGE                              04600000
046100         WRITE GL-UPDATE-DAILY-RPT-RECORD FROM                    04610000
046200                                         GL-HEADER-LINE-2         04620000
046300                AFTER ADVANCING 2 LINE                            04630000
046400         WRITE GL-UPDATE-DAILY-RPT-RECORD FROM                    04640000
046500                                         GL-HEADER-LINE-3         04650000
046600                AFTER ADVANCING 1 LINE                            04660000
046700         WRITE GL-UPDATE-DAILY-RPT-RECORD FROM                    04670000
046800                                         GL-HEADER-LINE-4         04680000
046900                AFTER ADVANCING 2 LINES                           04690000
047000         ADD  11                TO PV-LINE-COUNT                  04700000
047100                                                                  04710000
047200      END-IF.                                                     04720000
047300 2310-EXIT.  EXIT.                                                04730000
047400                                                                  04740000
048900 2400-READ-INPUT-FILE.                                            04890000
049000       INITIALIZE AR022-GL-INTERFACE.                             04900000
049100       READ GL-UPDATE-SUMMARY-FILE INTO AR022-GL-INTERFACE        04910000
049200         AT END                                                   04920000
049300            SET PS-EOF    TO TRUE                                 04930000
049400       END-READ.                                                  04940000
049500 2400-EXIT.  EXIT.                                                04950000
049600                                                                  04960000
049700 3000-WRITE-TOTALS.                                               04970000
049800      MOVE   PA-CREDIT-TOT-ACCUM    TO GL-DEBIT-AMT               04980000
049900      MOVE   PA-DEBIT-TOT-ACCUM     TO GL-CREDIT-AMT              04990000
050000      WRITE GL-UPDATE-DAILY-RPT-RECORD FROM  GL-TOTAL-LINE-1      05000000
050100             AFTER ADVANCING 2 LINE.                              05010000
050200      WRITE GL-UPDATE-DAILY-RPT-RECORD FROM  GL-TOTAL-LINE-2      05020000
050300             AFTER ADVANCING 1 LINE.                              05030000
050400                                                                  05040000
050500                                                                  05050000
050600 3000-EXIT.  EXIT.                                                05060000
050700                                                                  05070000
055100                                                                  05510000
055200 4000-FINISH.                                                     05520000
055300     CLOSE  GL-UPDATE-SUMMARY-FILE                                05530000
055400            SD-SELECT-DATE-FILE                                   05540000
055600            GL-UPDATE-DAILY-REPORT.                               05560000
055700 4000-EXIT.                                                       05570000
055800                                                                  05580000
