000100 IDENTIFICATION DIVISION.                                         00010099
000200 PROGRAM-ID.    POKCS109.                                         00020099
000300 AUTHOR.        SUE BARTELT.                                      00030099
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040099
000500 DATE-WRITTEN.  11-01-99.                                         00050099
000600 DATE-COMPILED.                                                   00060099
000700                                                                  00070099
000800*---------------------------------------------------------------* 00080099
000900*    W109 - PO-PACK DC ALLOCATION INQUIRY                       * 00090099
001000*                                                               * 00100099
001100*    THIS PROGRAM DISPLAYS PACK PER DC ALLOCATION INFORMATION   * 00110099
001300*                                                               * 00120099
001400*---------------------------------------------------------------* 00130099
001000* 10/12/01 TKMA609                                               *00140099
001100*    CHANGED PROGRAM SO THAT INSTEAD OF READING IN ALL DC'S AT  * 00150099
001300*    ONCE, TWO AT A TIME ARE PROCESSED.                         * 00160099
001400*---------------------------------------------------------------* 00170099
C98147* 11/11/14 TKMA394  LINDA FRIESS              CHG0098147          00180099
C98147*    EXPANDED PO NUMBER TO 8 DIGITS IN MAP AND COMMAREA.          00190099
C98147*---------------------------------------------------------------* 00200099
204416* 07/17/18 TKMAC09  JIM HUNTER                CHG0204416          00210099
204416*    MAINFRAME REFACTORING COULD NOT BE PERFORMED BECAUSE         00220099
204416*    AN MQ NAME LENGTH EXCEEDED 8 CHARACTERS.                     00230099
204416*    ASC-SEL-QUEUE-NAME WAS DEFINED AS > 8 CHARACTERS DUE TO THE  00240099
204416*    FACT THAT ASC-DC-COUNTER AND ASC-DC-COUNTER-DC WERE DEFINED  00250099
204416*    AS 20 LEVEL FIELDS UNDER IT.  CHANGED THEM TO 15 LEVEL       00260099
204416*    FIELDS WHICH MAKES ASC-SEL-QUEUE-NAME AN 8 CHARACTER FIELD.  00270099
204416*---------------------------------------------------------------* 00280099
076319* DATE  10/27/2021                                                00281099
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00282099
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00283099
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00284099
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00285099
076312*                                                               * 00286099
076318*---------------------------------------------------------------* 00287099
CICS  *  CHANGED 11/16/2022    BY BARB SCHULTZ    WR: CHG0278485      * 00288099
CICS  *                                                               * 00289099
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00289199
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00289299
CICS  *---------------------------------------------------------------* 00289599
002100/                                                                 00290099
002200 ENVIRONMENT DIVISION.                                            00300099
002300                                                                  00310099
002400 DATA DIVISION.                                                   00320099
002500                                                                  00330099
002600 WORKING-STORAGE SECTION.                                         00340099
002700                                                                  00350099
002800 01  DK-DB2-KEYS.                                                 00360099
002900     05  DK-PO-NBR                 PIC S9(9) COMP VALUE +0.       00370099
003000     05  DK-CL-NBR-BEG             PIC X(2)  VALUE SPACES.        00380099
003100     05  DK-CL-NBR-END             PIC X(2)  VALUE SPACES.        00390099
003200     05  DK-STR-NBR                PIC S9(04) COMP VALUE +0.      00400099
003300     05  DK-AGRMT-TYP-ID           PIC X(01)  VALUE SPACES.       00410099
003400     05  DK-TYP-CDE                PIC S9(04) VALUE +0            00420099
003500                                              COMP.               00430099
           05  DK-DEPT-NBR               PIC X(03)  VALUE SPACES.       00440099
003600                                                                  00450099
003700 01  PC-PROGRAM-CONSTANTS.                                        00460099
003800     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00470099
003900                                                    'PO109A  '.   00480099
004000     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00490099
004100                                                    'POKM109 '.   00500099
004200     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00510099
004300                                                    'POKCS109'.   00520099
004400     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00530099
004500                                                    COMP.         00540099
004600     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00550099
004700     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00560099
004800     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00570099
004900     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +8      00580099
005000                                                    COMP SYNC.    00590099
004900     05  PC-DCS-PER-SCREEN              PIC S9(04)  VALUE +2      00600099
005000                                                    COMP SYNC.    00610099
005100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00620099
005200                                                    COMP SYNC.    00630099
005300     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00640099
005400                                                    +1000000      00650099
005500                                                    COMP-3.       00660099
005600     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00670099
005700                                                    COMP SYNC.    00680099
005800     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00690099
005900                                                    COMP-3.       00700099
006000     05  PC-CNT-MINUS-2                 PIC S9(04)  VALUE -2      00710099
006100                                                    COMP SYNC.    00720099
006200     05  PC-CNT-6                       PIC S9(04)  VALUE +6      00730099
006300                                                    COMP SYNC.    00740099
006400     05  PC-CNT-7                       PIC S9(04)  VALUE +7      00750099
006500                                                    COMP SYNC.    00760099
006600     05  PC-ACT                         PIC  X(03)  VALUE 'ACT'.  00770099
006700     05  PC-CMP                         PIC  X(03)  VALUE 'CMP'.  00780099
006800     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00790099
006900     05  PC-QUOTE                       PIC  X(01)  VALUE X'7D'.  00800099
           05  PC-DCX                         PIC S9(04)  COMP.         00810099
           05  PC-PREPACKX                    PIC S9(04)  COMP.         00820099
007000     05  PC-DC1-NAME                    PIC  X(07).               00830099
007000     05  PC-DC2-NAME                    PIC  X(07).               00840099
007200     05  PC-HEAD1-COL1                  PIC  X(22)  VALUE         00850099
007300         'ONORD       /     RECD'.                                00860099
007200     05  PC-HEAD1-COL2                  PIC  X(22)  VALUE         00870099
007300         'ONORD       /     RECD'.                                00880099
           05  PC-HEAD2-COL1                  PIC  X(32)  VALUE         00890099
               'CRTNS /   UNITS  CRTNS /   UNITS'.                      00900099
           05  PC-HEAD2-COL2                  PIC  X(32)  VALUE         00910099
               'CRTNS /   UNITS  CRTNS /   UNITS'.                      00920099
007800                                                                  00930099
007900                                                                  00940099
008000     05  PC-TSYMSG-NUMBERS.                                       00950099
008100         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00960099
008200         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00970099
008300         10  PC-TSYMSG-00017            PIC  9(05)  VALUE 00017.  00980099
008400         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  00990099
008500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01000099
008600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01010099
008700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01020099
008800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01030099
008900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01040099
009000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01050099
009100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01060099
009200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01070099
009300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01080099
009400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01090099
009500         10  PC-TSYMSG-00168            PIC  9(05)  VALUE 00168.  01100099
               10  PC-TSYMSG-00227            PIC  9(05)  VALUE 00227.  01110099
               10  PC-TSYMSG-00228            PIC  9(05)  VALUE 00228.  01120099
009600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01130099
009700         10  PC-TSYMSG-00310            PIC  9(05)  VALUE 00310.  01140099
009710         10  PC-TSYMSG-00317            PIC  9(05)  VALUE 00317.  01150099
009800         10  PC-TSYMSG-00330            PIC  9(05)  VALUE 00330.  01160099
               10  PC-TSYMSG-00461            PIC  9(05)  VALUE 00461.  01170099
009900         10  PC-TSYMSG-00486            PIC  9(05)  VALUE 00486.  01180099
010000         10  PC-TSYMSG-00587            PIC  9(05)  VALUE 00587.  01190099
010100         10  PC-TSYMSG-00588            PIC  9(05)  VALUE 00588.  01200099
010200         10  PC-TSYMSG-00620            PIC  9(05)  VALUE 00620.  01210099
010300         10  PC-TSYMSG-00621            PIC  9(05)  VALUE 00621.  01220099
               10  PC-TSYMSG-00994            PIC  9(05)  VALUE 00994.  01230099
                                                                        01240099
010400                                                                  01250099
010500 01  PS-PROGRAM-SWITCHES.                                         01260099
010510     05  PS-PURITM-SW                   PIC  X(01)  VALUE 'Y'.    01270099
010520         88  PS-206-PURITM                          VALUE 'Y'.    01280099
010530         88  PS-000-PURITM                          VALUE 'N'.    01290099
010600     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01300099
010700         88  PS-NO-ERROR                            VALUE 'Y'.    01310099
010800         88  PS-ERROR                               VALUE 'N'.    01320099
010900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01330099
011000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01340099
011100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01350099
011200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01360099
011300         88  PS-DONE                                VALUE 'Y'.    01370099
011400         88  PS-NOT-DONE                            VALUE 'N'.    01380099
011500     05  PS-SKIP-SW                     PIC  X(01)  VALUE 'N'.    01390099
011600         88  PS-DONT-SKIP                           VALUE 'N'.    01400099
011700         88  PS-SKIP                                VALUE 'Y'.    01410099
011800     05  PS-TPURITM-SW                  PIC  X(01)  VALUE 'N'.    01420099
011900         88  PS-DONT-USE-TPURITM                    VALUE 'N'.    01430099
012000         88  PS-USE-TPURITM                         VALUE 'Y'.    01440099
012100     05  PS-TENTNME-SW                  PIC  X(01)  VALUE 'N'.    01450099
012200         88  PS-DONT-USE-TENTNME                    VALUE 'N'.    01460099
012300         88  PS-USE-TENTNME                         VALUE 'Y'.    01470099
           05  PS-END-OF-DC-SW                PIC  X(01)  VALUE 'N'.    01480099
               88  PS-END-OF-DC                           VALUE 'Y'.    01490099
               88  PS-NOT-END-OF-DC                       VALUE 'N'.    01500099
           05  PS-TABLE-OVERFLOW-SW           PIC  X(01)  VALUE 'N'.    01510099
               88  PS-TABLE-OVERFLOW                      VALUE 'Y'.    01520099
               88  PS-NOT-TABLE-OVERFLOW                  VALUE 'N'.    01530099
    00                                                                  01540099
012500 01  PV-PROGRAM-VARIABLES.                                        01550099
012600     05  PV-HOLD-CC                     PIC X(02).                01560099
           05  PV-DC-COUNT                    PIC S9(09)  VALUE +0      01570099
                                                          COMP-3.       01580099
           05  PV-CURR-DC-CNT                 PIC S9(09)  VALUE +0      01590099
                                                          COMP-3.       01600099
012610     05  PV-SUB                         PIC S9(04)  VALUE +0      01610099
012700                                                    COMP SYNC.    01620099
012800     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01630099
012900                                                    COMP SYNC.    01640099
013000     05  PV-SELECT-BYTES                PIC S9(04)  VALUE +78     01650099
013100                                                    COMP SYNC.    01660099
013200     05  PV-STRING-POINTER-FROM         PIC S9(04)  VALUE +0      01670099
013300                                                    COMP   SYNC.  01680099
013400     05  PV-STRING-POINTER-WHERE        PIC S9(04)  VALUE +0      01690099
013500                                                    COMP   SYNC.  01700099
013600     05  PV-TALLY-1                     PIC S9(04)  VALUE +0      01710099
013700                                                    COMP   SYNC.  01720099
013800     05  PV-TALLY-2                     PIC S9(04)  VALUE +0      01730099
013900                                                    COMP   SYNC.  01740099
014000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01750099
014100                                                    COMP-3.       01760099
014200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01770099
014300                                                    COMP-3.       01780099
014400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01790099
014500                                                    COMP-3.       01800099
014600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01810099
014700                                                    COMP-3.       01820099
014800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01830099
014900                                                    COMP-3.       01840099
015000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01850099
015100                                                    COMP-3.       01860099
015200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01870099
015300                                                    COMP-3.       01880099
015400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01890099
015500                                                    COMP SYNC.    01900099
015600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01910099
015700                                                    COMP SYNC.    01920099
015800     05  PV-ITEM                        PIC S9(04)  VALUE +0      01930099
015900                                                    COMP SYNC.    01940099
016000     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01950099
016100                                                    COMP SYNC.    01960099
016200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01970099
016300                                                    COMP SYNC.    01980099
016400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01990099
016500                                                    COMP SYNC.    02000099
016600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02010099
016700                                                    COMP SYNC.    02020099
016800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02030099
016900                                                    COMP SYNC.    02040099
017000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02050099
017100                                                    COMP SYNC.    02060099
017200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02070099
017300                                                    COMP SYNC.    02080099
017400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02090099
017500                                                    COMP SYNC.    02100099
017600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02110099
017700                                                    COMP SYNC.    02120099
017800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02130099
017900                                                    COMP SYNC.    02140099
018000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02150099
018100                                                    COMP SYNC.    02160099
018200     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02170099
018300                                                    COMP SYNC.    02180099
018400                                                                  02190099
018500     05  PV-NULL-IND                    PIC S9(04)  VALUE +0 COMP.02200099
018600                                                                  02210099
018700     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      02220099
018800                                                    COMP-3.       02230099
018900     05  PV-DB2-COUNT2                  PIC S9(09)  VALUE +0      02240099
019000                                                    COMP-3.       02250099
019100     05  PV-DB2-DATE                    PIC  X(10).               02260099
019200     05  FILLER  REDEFINES PV-DB2-DATE.                           02270099
019300         10  PV-DB2-DATE-CC             PIC  X(02).               02280099
019400         10  PV-DB2-DATE-YY             PIC  X(02).               02290099
019500         10  FILLER                     PIC  X(01).               02300099
019600         10  PV-DB2-DATE-MM             PIC  X(02).               02310099
019700         10  FILLER                     PIC  X(01).               02320099
019800         10  PV-DB2-DATE-DD             PIC  X(02).               02330099
019900     05  PV-DISPLAY-DATE.                                         02340099
020000         10  PV-DISPLAY-DATE-MM         PIC  X(02).               02350099
020100         10  PV-DISPLAY-DATE-DD         PIC  X(02).               02360099
020200         10  PV-DISPLAY-DATE-YY         PIC  X(02).               02370099
020300     05  PV-DONT-SHIP-BEF-DTE           PIC  X(06).               02380099
020400     05  PV-CAN-IFNOT-SHIP-DTE          PIC  X(06).               02390099
020500     05  PV-AD-EVNT-DTE                 PIC  X(06).               02400099
020600                                                                  02410099
020700     05  PV-GP-DOLLARS-RECEIVED         PIC S9(15)V99 COMP-3.     02420099
020710     05  PV-DOLLARS-RECEIVED            PIC S9(15)V99 COMP-3.     02430099
020720     05  PV-UNITS-RECEIVED              PIC S9(15)    COMP-3.     02440099
020730     05  PV-PCT-AREA                    PIC S9(04)V999            02450099
020740                                                      COMP-3.     02460099
           05  PV-LINE-QTY                    PIC S9(07) VALUE +0       02470099
                                                         COMP-3.        02480099
           05  PV-DC-REC-QTY                  PIC S9(07) VALUE +0       02490099
                                                         COMP-3.        02500099
           05  PV-QUOTIENT                    PIC S9(05) VALUE +0       02510099
                                                         COMP.          02520099
020750                                                                  02530099
           05  PV-CRTN-CNT                    PIC S9(05) VALUE +0       02540099
                                                         COMP.          02550099
           05  PV-INNER-PKS                   PIC S9(05) VALUE +0       02560099
                                                         COMP.          02570099
020760     05  PV-TABLE-QUALIFIER.                                      02580099
020770         10 FILLER                      PIC X(03) VALUE 'DB2'.    02590099
020780         10 PV-QUALIFIER                PIC X(01) VALUE ' '.      02600099
020790         10 FILLER                      PIC X(03) VALUE 'DBA'.    02610099
020800         10 FILLER                      PIC X(01) VALUE '.'.      02620099
020900                                                                  02630099
021000     05  PV-TABLE-QUALIFIER-COMMA.                                02640099
021100         10 FILLER                      PIC X(04) VALUE ',DB2'.   02650099
021200         10 PV-QUALIFIER-COMMA          PIC X(01) VALUE ' '.      02660099
021300         10 FILLER                      PIC X(03) VALUE 'DBA'.    02670099
021400         10 FILLER                      PIC X(01) VALUE '.'.      02680099
021500                                                                  02690099
021600     05  PV-IMPRT-AGNT-PO-NBR           PIC 9(09) VALUE ZEROS.    02700099
021700     05  PV-ENT-NAME-DESC               PIC X(32) VALUE SPACES.   02710099
021800     05  PV-VEND-STYL-NME               PIC X(22) VALUE SPACES.   02720099
021900                                                                  02730099
022000     05  PV-SYSTEM-ID.                                            02740099
022100         10  FILLER                     PIC  X(04)  VALUE SPACE.  02750099
022200         10  PV-REGION-IND              PIC  X(01).               02760099
022300             88  PV-TEST-CICS                 VALUE 'T'.          02770099
022400             88  PV-QA-CICS                   VALUE 'Q'.          02780099
022500             88  PV-PROD-CICS                 VALUE 'P'.          02790099
022600             88  PV-LEARN-CICS                VALUE 'L'.          02800099
022700         10  FILLER                     PIC X(01)    VALUE SPACES.02810099
022800     05  FILLER                         PIC X(02)    VALUE SPACES.02820099
022900                                                                  02830099
036000     05  PV-DC1-LINE.                                             02840099
               10  PV-DC1-CRTNS-ONORD         PIC ZZZZ9.                02850099
036200         10  PV-DC1-CRTNS-ONORD-X REDEFINES                       02860099
036300             PV-DC1-CRTNS-ONORD         PIC X(05).                02870099
036400         10  FILLER                     PIC X(03) VALUE ' / '.    02880099
               10  PV-DC1-UNITS-ONORD         PIC ZZZZZZ9.              02890099
036500         10  PV-DC1-UNITS-ONORD-X REDEFINES                       02900099
036600             PV-DC1-UNITS-ONORD         PIC X(07).                02910099
               10  FILLER                     PIC X(02) VALUE SPACE.    02920099
               10  PV-DC1-CRTNS-RECD          PIC ZZZZ9.                02930099
036800         10  PV-DC1-CRTNS-RECD-X REDEFINES                        02940099
036900             PV-DC1-CRTNS-RECD          PIC X(05).                02950099
               10  FILLER                     PIC X(03) VALUE ' / '.    02960099
               10  PV-DC1-UNITS-RECD          PIC ZZZZZZ9.              02970099
037000         10  PV-DC1-UNITS-RECD-X REDEFINES                        02980099
                   PV-DC1-UNITS-RECD          PIC X(07).                02990099
                                                                        03000099
036000     05  PV-DC2-LINE.                                             03010099
               10 PV-DC2-CRTNS-ONORD         PIC ZZZZ9.                 03020099
036200         10 PV-DC2-CRTNS-ONORD-X REDEFINES                        03030099
036300            PV-DC2-CRTNS-ONORD         PIC X(05).                 03040099
036400         10  FILLER                    PIC X(03) VALUE ' / '.     03050099
               10  PV-DC2-UNITS-ONORD        PIC ZZZZZZ9.               03060099
036500         10  PV-DC2-UNITS-ONORD-X REDEFINES                       03070099
036600             PV-DC2-UNITS-ONORD        PIC X(07).                 03080099
               10  FILLER                    PIC X(02) VALUE SPACE.     03090099
               10  PV-DC2-CRTNS-RECD         PIC ZZZZ9.                 03100099
036800         10  PV-DC2-CRTNS-RECD-X REDEFINES                        03110099
036900             PV-DC2-CRTNS-RECD         PIC X(05).                 03120099
               10  FILLER                    PIC X(03) VALUE ' / '.     03130099
               10  PV-DC2-UNITS-RECD         PIC ZZZZZZ9.               03140099
037000         10  PV-DC2-UNITS-RECD-X REDEFINES                        03150099
                   PV-DC2-UNITS-RECD         PIC X(07).                 03160099
026500*---------------------------------------------------------------* 03170099
026600*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03180099
026700*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 03190099
026800*   APPLICATION-SPECIFIC COMMAREA.                              * 03200099
026900*---------------------------------------------------------------* 03210099
027000 01  LQW-LIST-QUEUE-WORK-AREA.                                    03220099
027100     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  03230099
027200     05  LQW-ITEM-ENTRIES               OCCURS 8 TIMES            03240099
027300                                        INDEXED BY LQW-IDX.       03250099
027400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03260099
027500         10  LQW-TEMP-SELECTED-SW       PIC X(01).                03270099
027600         10  LQW-SELECTED-SW            PIC X(01).                03280099
027700             88  LQW-SELECT                         VALUE 'S'.    03290099
027800             88  LQW-DESELECT                       VALUE ' '.    03300099
027900         10  LQW-PACK-ID                PIC 9(04).                03310099
               10  LQW-PREPK-TYP-CDE          PIC X(01).                03320099
               10  LQW-INPK-UNT-QTY           PIC S9(09)                03330099
                                                  COMP.                 03340099
               10  LQW-OTPK-UNT-QTY           PIC S9(09)                03350099
                                                  COMP.                 03360099
               10  LQW-DC-ARRAY.                                        03370099
                   15  LQW-DC-QTY OCCURS 2 TIMES.                       03380099
028000                 20  LQW-ONORD-CRTNS    PIC 9(05).                03390099
028100                 20  LQW-ONORD-UNITS    PIC 9(07).                03400099
028200                 20  LQW-RECD-CRTNS     PIC 9(05).                03410099
028300                 20  LQW-RECD-UNITS     PIC 9(07).                03420099
029600/                                                                 03430099
029700*---------------------------------------------------------------* 03440099
029800*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 03450099
029900*---------------------------------------------------------------* 03460099
030000                                                                  03470099
030100     COPY POWS012.                                                03480099
030200                                                                  03490099
030300/                                                                 03500099
030400*---------------------------------------------------------------* 03510099
030500*    MAP LAYOUT                                                 * 03520099
030600*---------------------------------------------------------------* 03530099
030700                                                                  03540099
030800     COPY POKM109.                                                03550099
030900                                                                  03560099
031000 01  MR-OCCURS-LAYOUT                   REDEFINES  PO109AO.       03570099
031100     05  FILLER                         PIC X(48).                03580099
                                                                        03590099
           05  FILLER                         PIC X(05).                03600099
           05  MR-PO-NBR-X.                                             03610099
C98147         10  MR-PO-NBR                  PIC Z(08).                03620099
                                                                        03630099
           05  FILLER                         PIC X(05).                03640099
           05  MR-DC1-NAME                    PIC X(09).                03650099
           05  FILLER                         PIC X(05).                03660099
           05  MR-DC2-NAME                    PIC X(09).                03670099
                                                                        03680099
           05  FILLER                         PIC X(05).                03690099
           05  MR-H1COL1                      PIC X(22).                03700099
           05  FILLER                         PIC X(05).                03710099
           05  MR-H1COL2                      PIC X(22).                03720099
                                                                        03730099
           05  FILLER                         PIC X(05).                03740099
           05  MR-H2COL1                      PIC X(32).                03750099
           05  FILLER                         PIC X(05).                03760099
           05  MR-H2COL2                      PIC X(32).                03770099
031200                                                                  03780099
031300     05  MR-SCROLL-AREA                 OCCURS 13 TIMES.          03790099
031400         10  MR-SELECTL                 PIC S9(04) COMP.          03800099
031500         10  MR-SELECTA                 PIC X(01).                03810099
031600         10  MR-SELECTC                 PIC X(01).                03820099
031700         10  MR-SELECTH                 PIC X(01).                03830099
031800         10  MR-SELECT                  PIC X(01).                03840099
031900                                                                  03850099
032000         10  FILLER                     PIC X(05).                03860099
032500         10  MR-PACK-ID-X.                                        03870099
032600             15  MR-PACK-ID             PIC ZZZZ.                 03880099
034800                                                                  03890099
034900         10  FILLER                     PIC X(05).                03900099
035000         10  MR-LINE-AREA-DC1           PIC X(32).                03910099
035100                                                                  03920099
034900         10  FILLER                     PIC X(05).                03930099
035000         10  MR-LINE-AREA-DC2           PIC X(32).                03940099
035900                                                                  03950099
       01  MR-DC-NAME1.                                                 03960099
           05  MR-DC1-NBR                     PIC X(04).                03970099
           05  FILLER                         PIC X(01) VALUE SPACE.    03980099
           05  FILLER                         PIC X(01) VALUE '-'.      03990099
           05  FILLER                         PIC X(01) VALUE SPACE.    04000099
           05  MR-DC1-SHORT-NAME              PIC X(02).                04010099
                                                                        04020099
       01  MR-DC-NAME2.                                                 04030099
           05  MR-DC2-NBR                     PIC X(04).                04040099
           05  FILLER                         PIC X(01) VALUE SPACE.    04050099
           05  FILLER                         PIC X(01) VALUE '-'.      04060099
           05  FILLER                         PIC X(01) VALUE SPACE.    04070099
           05  MR-DC2-SHORT-NAME              PIC X(02).                04080099
                                                                        04090099
                                                                        04100099
040300/                                                                 04110099
040400*---------------------------------------------------------------* 04120099
040500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04130099
040600*---------------------------------------------------------------* 04140099
040700                                                                  04150099
040800     COPY DPWS015.                                                04160099
040900                                                                  04170099
041000*---------------------------------------------------------------* 04180099
041100*    FUNCTION KEYS COPYBOOK.                                    * 04190099
041200*---------------------------------------------------------------* 04200099
041300                                                                  04210099
041400     COPY DPWS016.                                                04220099
041500                                                                  04230099
041600*---------------------------------------------------------------* 04240099
041700*    NUMERIC EDIT LAYOUT.                                       * 04250099
041800*---------------------------------------------------------------* 04260099
041900                                                                  04270099
042000     COPY DPWS010I.                                               04280099
042100                                                                  04290099
042200/                                                                 04300099
042300*---------------------------------------------------------------* 04310099
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04320099
042500*---------------------------------------------------------------* 04330099
042600                                                                  04340099
042700     COPY DPWS030.                                                04350099
CICS       COPY DPWS930.                                                04351099
042800                                                                  04360099
042900/                                                                 04370099
043000*---------------------------------------------------------------* 04380099
043100*    STANDARD COMMAREA.                                         * 04390099
043200*---------------------------------------------------------------* 04400099
043300                                                                  04410099
043400     COPY DPWS020.                                                04420099
043500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04430099
043600                                                                  04440099
043700*---------------------------------------------------------------* 04450099
043800* INTER-APPLICATION COMMAREA.                                   * 04460099
043900*---------------------------------------------------------------* 04470099
044000                                                                  04480099
044100         10  INTER-APPL-COMM-AREA       PIC X(200).               04490099
044200     COPY POWS013.                                                04500099
044300     COPY POWS017.                                                04510099
044800*---------------------------------------------------------------* 04520099
044900*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04530099
045000*---------------------------------------------------------------* 04540099
045100         10  ASC-SPECIFIC-COMMAREA.                               04550099
045400             15  ASC-LIST-KEYS.                                   04560099
045500                 20  ASC-KEY-PO-NBR       PIC S9(9) COMP.         04570099
                                                                        04580099
      * IF WE HAVE > 12 DC'S, BUMP UP THE NUMBER OF OCCURS.             04590099
                   15  ASC-DC-TABLE OCCURS 12 TIMES.                    04600099
                       20  ASC-DC-NBR           PIC S9(4)               04610099
                                                COMP SYNC.              04620099
                       20  ASC-DC-NAME          PIC X(3).               04630099
                                                                        04640099
                                                                        04650099
048000             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           04660099
048100                 20  ASC-BLOCK-MODIFIED-SW                        04670099
048200                                        PIC X(01).                04680099
048300                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     04690099
048400                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     04700099
048500                                                                  04710099
048600                 20  ASC-ITEM-ARRAY.                              04720099
048700                     25  ASC-ITEM-ENTRIES OCCURS 8 TIMES.         04730099
048800                         30  ASC-LIST-ITEM-NUMBER                 04740099
048900                                        PIC S9(09) COMP-3.        04750099
049000                         30  ASC-TEMP-SELECTED-SW                 04760099
049100                                        PIC X(01).                04770099
049200                             88  ASC-VALID-SELECT  VALUE ' '      04780099
049300                                                         'S'      04790099
049400                                                         'B'      04800099
049500                                                         'E'.     04810099
049600                             88  ASC-TEMP-NO-SELECT               04820099
049700                                                   VALUE ' '.     04830099
049800                             88  ASC-TEMP-SELECT   VALUE 'S'.     04840099
049900                             88  ASC-TEMP-BEGIN    VALUE 'B'.     04850099
050000                             88  ASC-TEMP-END      VALUE 'E'.     04860099
050100                         30  ASC-SELECTED-SW                      04870099
050200                                        PIC X(01).                04880099
050300                             88  ASC-NO-SELECT     VALUE ' '.     04890099
050400                             88  ASC-SELECT        VALUE 'S'.     04900099
050500                             88  ASC-BEGIN         VALUE 'B'.     04910099
050600                             88  ASC-END           VALUE 'E'.     04920099
050700                         30  ASC-PACK-ID           PIC 9(04).     04930099
                               30  ASC-PREPK-TYP-CDE     PIC X(01).     04940099
                               30  ASC-INPK-UNT-QTY      PIC S9(09)     04950099
                                                             COMP.      04960099
                               30  ASC-OTPK-UNT-QTY      PIC S9(09)     04970099
                                                             COMP.      04980099
                               30  ASC-DC-ARRAY.                        04990099
                                   35 ASC-DC-QTY OCCURS 2 TIMES.        05000099
                                      40 ASC-DC-ONORD-CRTNS PIC X(05).  05010099
                                      40 ASC-DC-ONORD-UNITS PIC X(07).  05020099
                                      40 ASC-DC-RECD-CRTNS PIC X(05).   05030099
                                      40 ASC-DC-RECD-UNITS PIC X(07).   05040099
052300                                                                  05050099
052400             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     05060099
052500             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     05070099
                   15  ASC-DC-SUB             PIC S9(04) COMP SYNC.     05080099
052600             15  ASC-NUMBER-OF-ITEMS-READ                         05090099
052700                                        PIC S9(09) COMP-3.        05100099
052800             15  ASC-NUMBER-OF-SELECTED-ITEMS                     05110099
052900                                        PIC S9(09) COMP-3.        05120099
053000             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        05130099
053100             15  ASC-ITEM-AT-TOP-OF-PANEL                         05140099
053200                                        PIC S9(09) COMP-3.        05150099
053300             15  ASC-ITEM-AT-BOT-OF-PANEL                         05160099
053400                                        PIC S9(09) COMP-3.        05170099
053500             15  ASC-HIGHEST-BLOCK-WRITTEN                        05180099
053600                                        PIC S9(04) COMP SYNC.     05190099
053700             15  ASC-START-OF-SELECTED-RANGE                      05200099
053800                                        PIC S9(09) COMP-3.        05210099
053900             15  ASC-END-OF-SELECTED-RANGE                        05220099
054000                                        PIC S9(09) COMP-3.        05230099
                   15  ASC-DC-END-SW          PIC X(01).                05240099
                       88  ASC-DC-END         VALUE 'Y'.                05250099
                       88  ASC-NOT-DC-END     VALUE 'N'.                05260099
                   15  ASC-NEXT-DC-SW         PIC X(01).                05270099
                       88  ASC-MORE-DC        VALUE 'Q'.                05280099
                       88  ASC-NO-MORE-DC     VALUE 'F'.                05290099
054100             15  ASC-ITEMS-LEFT-INDICATOR                         05300099
054200                                        PIC X(01).                05310099
054300                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05320099
054400                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05330099
054500             15  ASC-TEMP-QUEUE-UPDATE-SW                         05340099
054600                                        PIC X(01).                05350099
054700                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05360099
054800                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05370099
054900             15  ASC-LIST-QUEUE-NAME.                             05380099
055000                 20  ASC-LIST-TERM-ID   PIC X(04).                05390099
055100                 20  ASC-LIST-TASK-NUMBER                         05400099
055200                                        PIC S9(05) COMP-3.        05410099
055300                 20  ASC-LIST-SEQ       PIC 9(01).                05420099
055400             15  ASC-SEL-QUEUE-NAME.                              05430099
055500                 20  ASC-SEL-TERM-ID    PIC X(04).                05440099
055600                 20  ASC-SEL-TASK-NUMBER                          05450099
055700                                        PIC S9(05) COMP-3.        05460099
055800                 20  ASC-SEL-SEQ        PIC 9(01).                05470099
204416             15  ASC-DC-COUNTER         PIC S9(09) COMP.          05480099
204416             15  ASC-DC-COUNTER-DC      PIC S9(04) COMP.          05490099
055900                                                                  05500099
056500             15  ASC-START-ITEM-REQUEST.                          05510099
056600                 20  ASC-START-ITEM-REQUEST-N                     05520099
056700                                        PIC 9(07).                05530099
057100/                                                                 05540099
057200*---------------------------------------------------------------* 05550099
057300*    ABEND PROCESSING COPYBOOK.                                 * 05560099
057400*---------------------------------------------------------------* 05570099
057500                                                                  05580099
057600     COPY DPWS013.                                                05590099
057700                                                                  05600099
057800/                                                                 05610099
057900*---------------------------------------------------------------* 05620099
058000*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 05630099
058100*---------------------------------------------------------------* 05640099
058200     EXEC SQL                                                     05650099
058300          INCLUDE TPURCHS                                         05660099
058400     END-EXEC.                                                    05670099
058500                                                                  05680099
058600/                                                                 05690099
058700*---------------------------------------------------------------* 05700099
058800*    DB2 AREA FOR THE PURCHASE ORDER LINE ITEM TABLE            * 05710099
058900*---------------------------------------------------------------* 05720099
059000     EXEC SQL                                                     05730099
059100          INCLUDE TPURITM                                         05740099
059200     END-EXEC.                                                    05750099
059300                                                                  05760099
059400/                                                                 05770099
059500*---------------------------------------------------------------* 05780099
059600*    DB2 AREA FOR THE DC SPLIT TABLE                            * 05790099
059700*---------------------------------------------------------------* 05800099
059800     EXEC SQL                                                     05810099
059900          INCLUDE TALLPLN                                         05820099
060000     END-EXEC.                                                    05830099
060100                                                                  05840099
060200/                                                                 05850099
061900*---------------------------------------------------------------* 05860099
062000*    DB2 AREA FOR THE PURCHASE ORDER PREPACK TABLE              * 05870099
062100*---------------------------------------------------------------* 05880099
062200     EXEC SQL                                                     05890099
062300          INCLUDE TPOPRPK                                         05900099
062400     END-EXEC.                                                    05910099
062500                                                                  05920099
065000/                                                                 05930099
064300*---------------------------------------------------------------* 05940099
064400*    DB2 AREA FOR THE LOCATION TABLE                            * 05950099
064500*---------------------------------------------------------------* 05960099
064600     EXEC SQL                                                     05970099
064700          INCLUDE XMT00001                                        05980099
064800     END-EXEC.                                                    05990099
064900                                                                  06000099
065000/                                                                 06010099
066000*---------------------------------------------------------------* 06020099
066100*    DB2 AREA FOR THE RECEIVING ITEM TABLE                     *  06030099
066200*---------------------------------------------------------------* 06040099
066300                                                                  06050099
066400     EXEC SQL                                                     06060099
066500         INCLUDE TRECITM                                          06070099
066600     END-EXEC.                                                    06080099
066700                                                                  06090099
066800                                                                  06100099
066900/                                                                 06110099
067000*---------------------------------------------------------------* 06120099
067100*    DB2 AREA FOR THE RECEIVING DISTRIBUTION TABLE             *  06130099
067200*---------------------------------------------------------------* 06140099
067300                                                                  06150099
067400     EXEC SQL                                                     06160099
067500         INCLUDE TRECDIS                                          06170099
067600     END-EXEC.                                                    06180099
067700                                                                  06190099
067800/                                                                 06200099
068700*---------------------------------------------------------------* 06210099
068800*    DB2 AREA FOR COMMUNICATIONS                                * 06220099
068900*---------------------------------------------------------------* 06230099
069000     EXEC SQL                                                     06240099
069100          INCLUDE SQLCA                                           06250099
069200     END-EXEC.                                                    06260099
069300                                                                  06270099
069500/                                                                 06280099
                                                                        06290099
      *---------------------------------------------------------------* 06300099
      *    DC CURSOR                                                  * 06310099
      *---------------------------------------------------------------* 06320099
                                                                        06330099
           EXEC SQL                                                     06340099
                DECLARE DC-CSR CURSOR FOR                               06350099
                SELECT LOC_NBR,                                         06360099
                       LOC_5_ABBR_NM                                    06370099
                  FROM XMT_LOC C                                        06380099
                 WHERE LOC_TYP_CDE = 'DC'                               06390099
                   AND CLO_DTE > CURRENT DATE                           06400099
                   AND EXISTS (SELECT *                                 06410099
                               FROM TALLPLN B                           06420099
                 WHERE PO_NBR = :ASC-KEY-PO-NBR                         06430099
                   AND DEST_NBR = C.LOC_NBR)                            06440099
                ORDER BY LOC_NBR                                        06450099
           END-EXEC.                                                    06460099
                                                                        06470099
      *----------------------------------------------------------------*06480099
      *    CURSOR TO SELECT PRE-PACK SUMMARY INFO                      *06490099
      *----------------------------------------------------------------*06500099
                                                                        06510099
           EXEC SQL                                                     06520099
                DECLARE PREPACK-CSR CURSOR FOR                          06530099
                SELECT PREPK_TYP_CDE                                    06540099
                      ,PO_PREPK_ID                                      06550099
                      ,PREPK_DESC                                       06560099
                      ,INPK_UNT_QTY                                     06570099
                      ,OTPK_UNT_QTY                                     06580099
                      ,OTPK_ORD_QTY                                     06590099
                  FROM TPOPRPK                                          06600099
                WHERE  PO_NBR = :ASC-KEY-PO-NBR                         06610099
           END-EXEC.                                                    06620099
                                                                        06630099
069600 LINKAGE SECTION.                                                 06640099
069700                                                                  06650099
069800 01  DFHCOMMAREA.                                                 06660099
069900     05  FILLER                         OCCURS  1 TO 4072 TIMES   06670099
070000                                        DEPENDING ON EIBCALEN.    06680099
070100         10  FILLER                     PIC X.                    06690099
070200                                                                  06700099
070300/                                                                 06710099
070400 PROCEDURE DIVISION.                                              06720099
070500*---------------------------------------------------------------* 06730099
070600*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 06740099
070700*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 06750099
070800*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 06760099
070900*---------------------------------------------------------------* 06770099
071000 0000-MAIN-MODULE.                                                06780099
071100                                                                  06790099
071200     INITIALIZE DP030-CICS-API-FIELDS.                            06800099
071300                                                                  06810099
071400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06820099
071500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06830099
071600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06840099
071700                                                                  06850099
071800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06860099
071900                                                                  06870099
072000     MOVE LENGTH OF PO109AI        TO DP030-MAP-LENGTH (1).       06880099
072100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06890099
072200                                                                  06900099
072300     PERFORM 0001-CALL-CICS-ARCH-API.                             06910099
072400     PERFORM 1000-CONTROL-PROCESSING                              06920099
072500                                                                  06930099
072600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06940099
072700     PERFORM 0001-CALL-CICS-ARCH-API.                             06950099
072800                                                                  06960099
072900*---------------------------------------------------------------* 06970099
073000*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 06980099
073100*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 06990099
073200*---------------------------------------------------------------* 07000099
073300 0001-CALL-CICS-ARCH-API.                                         07010099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07020099
073500                                    DFHCOMMAREA                   07030099
073600                                    DP030-CICS-API-FIELDS         07040099
073700                                    DP020-STANDARD-COMMAREA       07050099
073800                                    PO109AI.                      07060099
073900                                                                  07070099
074000     IF  DP030-RC-CALL-SUCCESSFUL                                 07080099
074100         CONTINUE                                                 07090099
074200     ELSE                                                         07100099
074300         SET DP013-NO-ROLLBACK                                    07110099
074400             DP013-XCTL-DISPLAY-RESTART                           07120099
074500             DP013-CICS-ABEND      TO TRUE                        07130099
074600         MOVE '0001-CALL-CICS-ARCH-API'                           07140099
074700                                   TO DP013-PARAGRAPH             07150099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07160099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07170099
075000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07180099
075100         PERFORM DP013-0000-PROCESS-ABEND                         07190099
075200     END-IF.                                                      07200099
075300                                                                  07210099
075400*----------------------------------------------------------------*07220099
075500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07230099
075600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07240099
075700*                                                                *07250099
075800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07260099
075900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07270099
076000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07280099
076100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07290099
076200*----------------------------------------------------------------*07300099
076300                                                                  07310099
076400 1000-CONTROL-PROCESSING.                                         07320099
076500                                                                  07330099
076600     EVALUATE TRUE                                                07340099
076700         WHEN DP020-NEXT-ACT-INITIAL                              07350099
076800             INITIALIZE ASC-SPECIFIC-COMMAREA                     07360099
076900                                                                  07370099
077500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07380099
077600                                      ASC-SEL-TERM-ID             07390099
077700             MOVE DP020-SRC-TASK-NUMBER                           07400099
077800                                   TO ASC-LIST-TASK-NUMBER        07410099
077900                                      ASC-SEL-TASK-NUMBER         07420099
078000             MOVE PC-LIST-QUEUE-SEQ                               07430099
078100                                   TO ASC-LIST-SEQ                07440099
078200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 07450099
078300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07460099
078400             IF  PS-COMMAREA-NOT-VALID                            07470099
078500                 SET DP020-NEXT-ACT-APPL-ERROR                    07480099
078600                                   TO TRUE                        07490099
078700             ELSE                                                 07500099
                       PERFORM 1200-LOAD-DC-TABLE                       07510099
078800                 PERFORM 4000-BUILD-INITIAL-PANEL                 07520099
078900             END-IF                                               07530099
079000                                                                  07540099
079100         WHEN DP020-NEXT-ACT-READ-MAP                             07550099
079200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        07560099
079300                                   TO PV-TOP-ITEM                 07570099
079400             PERFORM 2000-PROCESS-PANEL                           07580099
079500                                                                  07590099
079600         WHEN DP020-NEXT-ACT-RETURN                               07600099
079700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        07610099
079800                                   TO PV-TOP-ITEM                 07620099
079900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    07630099
080000             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 07640099
                   PERFORM 4350-CALC-QTYS                               07650099
080100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07660099
080200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07670099
080300                                                                  07680099
080400         WHEN OTHER                                               07690099
080500             SET DP013-LOGIC-ABEND TO TRUE                        07700099
080600             SET DP013-NO-ROLLBACK TO TRUE                        07710099
080700             MOVE '1000-CONTROL-PROCESSING'                       07720099
080800                                   TO DP013-PARAGRAPH             07730099
080900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07740099
081000                                   TO DP013-MESSAGE-TEXT(1)       07750099
081100             PERFORM DP013-0000-PROCESS-ABEND                     07760099
081200     END-EVALUATE.                                                07770099
081300                                                                  07780099
081400/                                                                 07790099
081500*----------------------------------------------------------------*07800099
081600* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *07810099
081700*----------------------------------------------------------------*07820099
081800                                                                  07830099
081900 1100-PROCESS-INTER-APPL-COMM.                                    07840099
082000                                                                  07850099
082100     SET PS-COMMAREA-VALID         TO TRUE.                       07860099
082200     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07870099
082300                                                                  07880099
082400     IF  PO017-PO-NBR = ZEROES                                    07890099
082500         MOVE PC-TSYMSG-00461                                     07900099
082600                                   TO DP020-MSG-NUMBER            07910099
082700         SET PS-ERROR                                             07920099
082800             PS-COMMAREA-NOT-VALID                                07930099
082900             DP020-MSG-FATAL                                      07940099
083000                                 TO TRUE                          07950099
092800     END-IF.                                                      07960099
092900                                                                  07970099
093000     IF  PS-NO-ERROR                                              07980099
093100         MOVE PO017-PO-NBR       TO ASC-KEY-PO-NBR                07990099
098000     END-IF.                                                      08000099
098100                                                                  08010099
098200/                                                                 08020099
                                                                        08030099
      *----------------------------------------------------------------*08040099
      * LOADS A DC TABLE WITH ALL OF THE VALID DC NAMES.               *08050099
      *----------------------------------------------------------------*08060099
                                                                        08070099
       1200-LOAD-DC-TABLE.                                              08080099
                                                                        08090099
           SET PS-NOT-END-OF-DC TO TRUE.                                08100099
           SET PS-NOT-TABLE-OVERFLOW TO TRUE.                           08110099
                                                                        08120099
           PERFORM 4100-OPEN-DC-CURSOR.                                 08130099
           PERFORM 4105-PROCESS-DC-CURSOR.                              08140099
           PERFORM 4110-CLOSE-DC-CURSOR.                                08150099
                                                                        08160099
           IF PS-TABLE-OVERFLOW                                         08170099
               SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    08180099
               SET DP020-MSG-FATAL TO TRUE                              08190099
               MOVE PC-TSYMSG-00994 TO DP020-MSG-NUMBER                 08200099
           END-IF.                                                      08210099
120700*----------------------------------------------------------------*08220099
120800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08230099
120900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08240099
121000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08250099
121100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08260099
121200* FUNCTION KEYS CAN GET THIS FAR.                                *08270099
121300*----------------------------------------------------------------*08280099
121400                                                                  08290099
121500 2000-PROCESS-PANEL.                                              08300099
121600     EVALUATE TRUE                                                08310099
121700         WHEN DP020-SRC-AID = DP016-CLEAR                         08320099
121900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08330099
122000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08340099
122100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08350099
122200                                                                  08360099
122300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08370099
122500             PERFORM 2050-DELETE-LIST-QUEUE                       08380099
122600             PERFORM 4000-BUILD-INITIAL-PANEL                     08390099
122700                                                                  08400099
122800         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   08410099
122900             PERFORM 2140-DESELECT-ALL-ITEMS                      08420099
123000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08430099
123100                                                                  08440099
123200         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 08450099
123300              PERFORM 2150-SELECT-ALL-ITEMS                       08460099
123400              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08470099
123500                                                                  08480099
123600         WHEN OTHER                                               08490099
123700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08500099
123800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08510099
123900             IF  PS-NO-ERROR                                      08520099
124000                 SET DP030-CONTINUE-GO TO TRUE                    08530099
124100                 PERFORM 2100-CHECK-FUNCTION-KEY                  08540099
124200             ELSE                                                 08550099
124300                 SET DP030-OVERRIDE-GO TO TRUE                    08560099
124400             END-IF                                               08570099
124500     END-EVALUATE.                                                08580099
124600                                                                  08590099
124700/                                                                 08600099
124800*----------------------------------------------------------------*08610099
124900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *08620099
125000*----------------------------------------------------------------*08630099
125100 2050-DELETE-LIST-QUEUE.                                          08640099
125200                                                                  08650099
125300     EXEC CICS                                                    08660099
125400         DELETEQ TS                                               08670099
125500           QUEUE (ASC-LIST-QUEUE-NAME)                            08680099
125600            RESP (PV-CICS-RESP)                                   08690099
125700     END-EXEC.                                                    08700099
125800                                                                  08710099
126400     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       08720099
126500        (PV-CICS-RESP = DFHRESP(QIDERR))                          08730099
126600         CONTINUE                                                 08740099
126700     ELSE                                                         08750099
126800         SET DP013-CICS-ABEND      TO TRUE                        08760099
126900         SET DP013-NO-ROLLBACK     TO TRUE                        08770099
127000                                                                  08780099
127100         MOVE '2050-DELETE-LIST-QUEUE'                            08790099
127200                                   TO DP013-PARAGRAPH             08800099
127300         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    08810099
127400                                   TO DP013-MESSAGE-TEXT (1)      08820099
127500         PERFORM DP013-0000-PROCESS-ABEND                         08830099
127600     END-IF.                                                      08840099
127700                                                                  08850099
127800     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  08860099
127900                                                                  08870099
128000/                                                                 08880099
128100*----------------------------------------------------------------*08890099
128200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*08900099
128300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *08910099
128400* CICS ARCHITECTURE API.                                         *08920099
128500*----------------------------------------------------------------*08930099
128600 2100-CHECK-FUNCTION-KEY.                                         08940099
128700                                                                  08950099
128800     EVALUATE TRUE                                                08960099
      *  F13 KEY - I DETL                                               08970099
128900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08980099
129100              IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO             08990099
129200                  INITIALIZE PO013-INTER-APPL-COMMAREA            09000099
                        PERFORM 2105-GET-DEPT-NBR                       09010099
129300                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               09020099
129400                                TO PO013-NUMBER-OF-SELECTED-ITEMS 09030099
                        MOVE ASC-KEY-PO-NBR       TO PO013-PO-NBR       09040099
                        MOVE PURCHS-PKGNG-CDE     TO PO013-PO-PKGNG-CDE 09050099
                        MOVE DK-DEPT-NBR          TO PO013-DEPT-NBR     09060099
129500                                                                  09070099
129600                  PERFORM 5000-PREPARE-SEL-QUEUE                  09080099
129700              ELSE                                                09090099
129800                  SET DP030-OVERRIDE-GO                           09100099
129900                      DP020-MSG-WARNING                           09110099
130000                                TO TRUE                           09120099
130100                  MOVE PC-TSYMSG-00057                            09130099
130200                                TO DP020-MSG-NUMBER               09140099
130300              END-IF                                              09150099
130400                                                                  09160099
      *  F14 KEY - M DETL                                               09170099
128900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09180099
129100              IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO             09190099
129200                  INITIALIZE PO013-INTER-APPL-COMMAREA            09200099
                        PERFORM 2105-GET-DEPT-NBR                       09210099
129300                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               09220099
129400                                TO PO013-NUMBER-OF-SELECTED-ITEMS 09230099
                        MOVE ASC-KEY-PO-NBR       TO PO013-PO-NBR       09240099
                        MOVE PURCHS-PKGNG-CDE     TO PO013-PO-PKGNG-CDE 09250099
                        MOVE DK-DEPT-NBR          TO PO013-DEPT-NBR     09260099
129500                                                                  09270099
129600                  PERFORM 5000-PREPARE-SEL-QUEUE                  09280099
129700              ELSE                                                09290099
129800                  SET DP030-OVERRIDE-GO                           09300099
129900                      DP020-MSG-WARNING                           09310099
130000                                TO TRUE                           09320099
130100                  MOVE PC-TSYMSG-00057                            09330099
130200                                TO DP020-MSG-NUMBER               09340099
130300              END-IF                                              09350099
                                                                        09360099
130500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  09370099
130600             MOVE +1               TO PV-TOP-ITEM                 09380099
130700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09390099
130800             PERFORM 3200-RESET-ATTRIBUTES                        09400099
130900                                                                  09410099
131000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   09420099
131100             PERFORM 2110-BROWSE-BACKWARD                         09430099
131200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09440099
131300             PERFORM 3200-RESET-ATTRIBUTES                        09450099
131400                                                                  09460099
131500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   09470099
131600             PERFORM 2120-BROWSE-FORWARD                          09480099
131700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09490099
131800             PERFORM 3200-RESET-ATTRIBUTES                        09500099
131900                                                                  09510099
132000         WHEN DP020-SRC-AID = DP016-ENTER                         09520099
132200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   09530099
132300             IF  PS-ERROR                                         09540099
132400                 CONTINUE                                         09550099
132500             ELSE                                                 09560099
132600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09570099
132700             END-IF                                               09580099
132800                                                                  09590099
      *  F23 KEY - PRE DCAL                                             09600099
132900         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               09610099
                 SET ASC-MORE-DC TO TRUE                                09620099
                 SUBTRACT +2 FROM ASC-DC-COUNTER                        09630099
                 SUBTRACT +2 FROM ASC-DC-SUB                            09640099
                 IF ASC-DC-COUNTER < 1                                  09650099
                   IF ASC-DC-COUNTER < -1                               09660099
                     MOVE PC-TSYMSG-00227 TO DP020-MSG-NUMBER           09670099
                     SET DP020-MSG-INFORMATIONAL TO TRUE                09680099
                     ADD 2 TO ASC-DC-COUNTER                            09690099
                     ADD 2 TO ASC-DC-SUB                                09700099
                   END-IF                                               09710099
                 END-IF                                                 09720099
                 MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM           09730099
                 PERFORM 4350-CALC-QTYS                                 09740099
                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   09750099
                 PERFORM 3200-RESET-ATTRIBUTES                          09760099
                                                                        09770099
133300                                                                  09780099
      *  F24 KEY - DCALLOC                                              09790099
133400         WHEN DP020-FK-LOCAL-FUNC-04(DP020-SRC-AID)               09800099
               IF ASC-MORE-DC                                           09810099
                 ADD +2 TO ASC-DC-COUNTER                               09820099
                 ADD +2 TO ASC-DC-SUB                                   09830099
                 IF ASC-DC-COUNTER >= (ASC-DC-COUNTER-DC)               09840099
                    SUBTRACT +2 FROM ASC-DC-COUNTER                     09850099
                    SUBTRACT +2 FROM ASC-DC-SUB                         09860099
                    MOVE PC-TSYMSG-00228 TO DP020-MSG-NUMBER            09870099
                    SET DP020-MSG-INFORMATIONAL TO TRUE                 09880099
                    SET ASC-NO-MORE-DC TO TRUE                          09890099
                 END-IF                                                 09900099
                                                                        09910099
                 IF ASC-DC-COUNTER = 12 AND ASC-DC-COUNTER-DC < 12      09920099
                    SUBTRACT +2 FROM ASC-DC-COUNTER                     09930099
                    SUBTRACT +2 FROM ASC-DC-SUB                         09940099
                    MOVE PC-TSYMSG-00228 TO DP020-MSG-NUMBER            09950099
                    SET DP020-MSG-INFORMATIONAL TO TRUE                 09960099
                    SET ASC-NO-MORE-DC TO TRUE                          09970099
                 ELSE                                                   09980099
                    IF ASC-DC-COUNTER = 12                              09990099
                    SET ASC-NO-MORE-DC TO TRUE                          10000099
                    MOVE PC-TSYMSG-00228 TO DP020-MSG-NUMBER            10010099
                    SET DP020-MSG-INFORMATIONAL TO TRUE                 10020099
                    END-IF                                              10030099
                 END-IF                                                 10040099
               ELSE                                                     10050099
                    MOVE PC-TSYMSG-00228 TO DP020-MSG-NUMBER            10060099
                    SET DP020-MSG-INFORMATIONAL TO TRUE                 10070099
               END-IF                                                   10080099
                   IF ASC-DC-NBR(ASC-DC-COUNTER + 1) = 0                10090099
                      MOVE PC-TSYMSG-00228 TO DP020-MSG-NUMBER          10100099
                      SET DP020-MSG-INFORMATIONAL TO TRUE               10110099
                   ELSE                                                 10120099
133600             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         10130099
                   PERFORM 4350-CALC-QTYS                               10140099
133700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10150099
                   END-IF                                               10160099
133800                                                                  10170099
133900         WHEN OTHER                                               10180099
134100             SET DP013-NO-ROLLBACK                                10190099
134200                 DP013-XCTL-DISPLAY-RESTART                       10200099
134300                 DP013-CICS-ABEND  TO TRUE                        10210099
134400             MOVE '2100-CHECK-FUNCTION-KEY'                       10220099
134500                                   TO DP013-PARAGRAPH             10230099
134600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10240099
134700                                   TO DP013-MESSAGE-TEXT (1)      10250099
134800             PERFORM DP013-0000-PROCESS-ABEND                     10260099
134900     END-EVALUATE.                                                10270099
135000                                                                  10280099
135100/                                                                 10290099
      *----------------------------------------------------------------*10300099
      *    GET DEPARTMENT NUMBER FROM TPURCHS                          *10310099
      *----------------------------------------------------------------*10320099
                                                                        10330099
       2105-GET-DEPT-NBR.                                               10340099
                                                                        10350099
           PERFORM                                                      10360099
               WITH TEST AFTER                                          10370099
               VARYING PV-RETRY-COUNTER                                 10380099
               FROM 1 BY 1                                              10390099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10400099
                  OR (SQLCODE = +0))                                    10410099
                                                                        10420099
            EXEC SQL                                                    10430099
                 SELECT DEPT_NBR                                        10440099
                       ,PKGNG_CDE                                       10450099
                 INTO   :PURCHS-DEPT-NBR                                10460099
                       ,:PURCHS-PKGNG-CDE                               10470099
                 FROM    TPURCHS                                        10480099
                 WHERE   PO_NBR = :ASC-KEY-PO-NBR                       10490099
                 AND     VER_STATUS_CDE = 'A'                           10500099
            END-EXEC                                                    10510099
                                                                        10520099
            EVALUATE TRUE                                               10530099
                WHEN SQLCODE = 0                                        10540099
                     MOVE PURCHS-DEPT-NBR TO DK-DEPT-NBR                10550099
                WHEN SQLCODE = +100                                     10560099
                     MOVE '2105-GET-DEPT-NBR' TO DP013-PARAGRAPH        10570099
                     MOVE 'UNSUCCESSFUL SELECT GET DEPT NBR '           10580099
                                       TO DP013-MESSAGE-TEXT (1)        10590099
                     MOVE SQLCA        TO DP013-SQLCA                   10600099
                     MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)      10610099
                     SET DP013-DB2-ABEND                                10620099
                         DP013-XCTL-DISPLAY-RESTART                     10630099
                                       TO TRUE                          10640099
                     PERFORM DP013-0000-PROCESS-ABEND                   10650099
                WHEN SQLCODE = -904                                     10660099
                WHEN SQLCODE = -913                                     10670099
                     CONTINUE                                           10680099
                WHEN SQLWARN0 NOT = SPACES                              10690099
                WHEN SQLCODE < +0                                       10700099
                WHEN SQLCODE > +0                                       10710099
                     MOVE '2105-GET-DEPT-NBR' TO DP013-PARAGRAPH        10720099
                     MOVE 'UNSUCCESSFUL SELECT GET DEPT NBR '           10730099
                                       TO DP013-MESSAGE-TEXT (1)        10740099
                     MOVE SQLCA        TO DP013-SQLCA                   10750099
                     MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)      10760099
                     SET DP013-DB2-ABEND                                10770099
                         DP013-XCTL-DISPLAY-RESTART                     10780099
                                       TO TRUE                          10790099
                     PERFORM DP013-0000-PROCESS-ABEND                   10800099
            END-EVALUATE                                                10810099
           END-PERFORM.                                                 10820099
                                                                        10830099
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         10840099
              MOVE '2105-GET-DEPT-NBR' TO DP013-PARAGRAPH               10850099
              MOVE 'MAX RETRIES EXCEEDED ON SELECT  TPURCHS'            10860099
                                       TO DP013-MESSAGE-TEXT (1)        10870099
              MOVE SQLCA               TO DP013-SQLCA                   10880099
              MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (1)      10890099
              SET DP013-DB2-ABEND                                       10900099
                  DP013-XCTL-DISPLAY-RESTART                            10910099
                                       TO TRUE                          10920099
              PERFORM DP013-0000-PROCESS-ABEND                          10930099
           END-IF.                                                      10940099
135200*----------------------------------------------------------------*10950099
135300*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10960099
135400*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10970099
135500*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10980099
135600*    MESSAGE.                                                    *10990099
135700*----------------------------------------------------------------*11000099
135800                                                                  11010099
135900 2110-BROWSE-BACKWARD.                                            11020099
136000                                                                  11030099
136100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11040099
136200         GIVING PV-TOP-ITEM.                                      11050099
136300                                                                  11060099
136400     IF  ((PV-TOP-ITEM < +1)                                      11070099
136500       OR (PV-TOP-ITEM = +1))                                     11080099
136600         MOVE +1                   TO PV-TOP-ITEM                 11090099
136700*        -- TOP OF LIST --                                        11100099
136800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11110099
136900         SET DP020-MSG-INFORMATIONAL                              11120099
137000                                   TO TRUE                        11130099
137100     END-IF.                                                      11140099
137200                                                                  11150099
137300/                                                                 11160099
137400*----------------------------------------------------------------*11170099
137500*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11180099
137600*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11190099
137700*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11200099
137800*----------------------------------------------------------------*11210099
137900                                                                  11220099
138000 2120-BROWSE-FORWARD.                                             11230099
138100                                                                  11240099
138200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11250099
138300         GIVING PV-TOP-ITEM.                                      11260099
138400                                                                  11270099
138500     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11280099
138600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11290099
138700                                   TO PV-TOP-ITEM                 11300099
138800*        -- BOTTOM OF LIST --                                     11310099
138900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11320099
139000         SET DP020-MSG-INFORMATIONAL                              11330099
139100                                   TO TRUE                        11340099
139200     ELSE                                                         11350099
139300         COMPUTE PV-BOTTOM-ITEM =                                 11360099
139400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11370099
139500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11380099
139600*            -- BOTTOM OF LIST --                                 11390099
139700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11400099
139800             SET DP020-MSG-INFORMATIONAL                          11410099
139900                                   TO TRUE                        11420099
140000         END-IF                                                   11430099
140100     END-IF.                                                      11440099
140200                                                                  11450099
140300/                                                                 11460099
140400*----------------------------------------------------------------*11470099
140500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11480099
140600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11490099
140700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11500099
140800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11510099
140900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11520099
141000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11530099
141100*----------------------------------------------------------------*11540099
141200                                                                  11550099
141300 2130-CHECK-FOR-JUMP-BROWSE.                                      11560099
141400                                                                  11570099
141500     SET PS-NO-ERROR               TO TRUE.                       11580099
141600     IF (ASC-START-ITEM-REQUEST = SPACE)                          11590099
141700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11600099
141800                                   TO PV-TOP-ITEM                 11610099
141900     ELSE                                                         11620099
142000         MOVE ASC-START-ITEM-REQUEST                              11630099
142100                                   TO DP010I-UNEDITED-FIELD       11640099
142200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11650099
142300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11660099
142400         SET DP010I-NEGATIVE-NOT-ALLOWED                          11670099
142500                                   TO TRUE                        11680099
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11691099
264230                         USING DP010I-NUMERIC-EDIT-AREA           11692099
142700                                                                  11700099
142800         IF  NOT DP010I-ERROR-DETECTED                            11710099
142900             MOVE DP010I-NUMERIC-FIELD                            11720099
143000                                   TO ASC-START-ITEM-REQUEST-N    11730099
143100             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11740099
143200                 IF  ASC-START-ITEM-REQUEST-N >                   11750099
143300                                          ASC-NUMBER-OF-ITEMS-READ11760099
143400                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11770099
143500                     COMPUTE PV-TOP-ITEM =                        11780099
143600                             ASC-NUMBER-OF-ITEMS-READ             11790099
143700                             - PC-ITEMS-PER-PANEL + 1             11800099
143800                     IF  PV-TOP-ITEM < +1                         11810099
143900                         MOVE +1   TO PV-TOP-ITEM                 11820099
144000                         MOVE PC-TSYMSG-00070                     11830099
144100                                   TO DP020-MSG-NUMBER            11840099
144200                         SET DP020-MSG-INFORMATIONAL              11850099
144300                                   TO TRUE                        11860099
144400                     END-IF                                       11870099
144500                 ELSE                                             11880099
144600                     MOVE ASC-START-ITEM-REQUEST-N                11890099
144700                                   TO PV-TOP-ITEM                 11900099
144800                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11910099
144900                     COMPUTE PV-BOTTOM-ITEM =                     11920099
145000                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11930099
145100                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11940099
145200*                        -- BOTTOM OF LIST --                     11950099
145300                         MOVE PC-TSYMSG-00070                     11960099
145400                                   TO DP020-MSG-NUMBER            11970099
145500                         SET DP020-MSG-INFORMATIONAL              11980099
145600                                   TO TRUE                        11990099
145700                     END-IF                                       12000099
145800                 END-IF                                           12010099
145900             ELSE                                                 12020099
146000*                --- VALUE OUT OF RANGE ----                      12030099
146100                 MOVE PC-TSYMSG-00101                             12040099
146200                                   TO DP020-MSG-NUMBER            12050099
146300                 MOVE -1           TO ASTRTITL                    12060099
146400                 SET DP030-SET-CURSOR-APPL-1                      12070099
146500                                   TO TRUE                        12080099
146600                 MOVE DP015-REVERSE                               12090099
146700                                   TO ASTRTITH                    12100099
146800                 MOVE DP015-RED    TO ASTRTITC                    12110099
146900                 MOVE DP015-UNP-NUM-BRT-MDT                       12120099
147000                                   TO ASTRTITA                    12130099
147100                 SET DP020-MSG-FATAL                              12140099
147200                                   TO TRUE                        12150099
147300                 SET PS-ERROR      TO TRUE                        12160099
147400             END-IF                                               12170099
147500                                                                  12180099
147600         ELSE                                                     12190099
147700             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12200099
147800             MOVE -1               TO ASTRTITL                    12210099
147900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12220099
148000             MOVE DP015-REVERSE    TO ASTRTITH                    12230099
148100             MOVE DP015-RED        TO ASTRTITC                    12240099
148200             MOVE DP015-UNP-NUM-BRT-MDT                           12250099
148300                                   TO ASTRTITA                    12260099
148400             SET DP020-MSG-FATAL   TO TRUE                        12270099
148500             SET PS-ERROR          TO TRUE                        12280099
148600         END-IF                                                   12290099
148700     END-IF.                                                      12300099
148800                                                                  12310099
148900/                                                                 12320099
149000*----------------------------------------------------------------*12330099
149100*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12340099
149200*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12350099
149300*----------------------------------------------------------------*12360099
149400 2140-DESELECT-ALL-ITEMS.                                         12370099
149500                                                                  12380099
149600     MOVE +1                       TO ASC-BLK-SUB.                12390099
149700                                                                  12400099
149800     PERFORM 2141-CLEAR-SELECTED-INDS                             12410099
149900         VARYING ASC-ITEM-SUB                                     12420099
150000         FROM 1 BY 1                                              12430099
150100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12440099
150200                                                                  12450099
150300     ADD +1                        TO ASC-BLK-SUB.                12460099
150400                                                                  12470099
150500     PERFORM 2141-CLEAR-SELECTED-INDS                             12480099
150600         VARYING ASC-ITEM-SUB                                     12490099
150700         FROM 1 BY 1                                              12500099
150800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12510099
150900                                                                  12520099
151000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12530099
151100                                   TO PV-LIST-ITEM-NUMBER.        12540099
151200                                                                  12550099
151300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12560099
151400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12570099
151500                                                                  12580099
151600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12590099
151700        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12600099
151800         MOVE +1                   TO ASC-BLK-SUB                 12610099
151900                                                                  12620099
152000         PERFORM 5100-WRITE-TEMP-STORAGE                          12630099
152100                                                                  12640099
152200         MOVE +1                   TO PV-BLOCK-NUMBER             12650099
152300                                                                  12660099
152400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12670099
152500             PV-FIRST-BLOCK-IN-ARRAY - 1                          12680099
152600                                                                  12690099
152700         PERFORM                                                  12700099
152800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12710099
152900                                                                  12720099
153000             PERFORM 4410-READ-TEMP-STORAGE                       12730099
153100                                                                  12740099
153200             PERFORM 2141-CLEAR-SELECTED-INDS                     12750099
153300                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 12760099
153400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12770099
153500                                                                  12780099
153600             PERFORM 5100-WRITE-TEMP-STORAGE                      12790099
153700                                                                  12800099
153800             ADD +1                TO PV-BLOCK-NUMBER             12810099
153900                                                                  12820099
154000         END-PERFORM                                              12830099
154100                                                                  12840099
154200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12850099
154300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12860099
154400                                                                  12870099
154500         PERFORM                                                  12880099
154600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12890099
154700                   ASC-HIGHEST-BLOCK-WRITTEN                      12900099
154800                                                                  12910099
154900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12920099
155000                                   TO PV-BLOCK-NUMBER             12930099
155100                                                                  12940099
155200             PERFORM 4410-READ-TEMP-STORAGE                       12950099
155300                                                                  12960099
155400             PERFORM 2141-CLEAR-SELECTED-INDS                     12970099
155500                 VARYING ASC-ITEM-SUB                             12980099
155600                 FROM 1 BY 1                                      12990099
155700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13000099
155800                                                                  13010099
155900             PERFORM 5100-WRITE-TEMP-STORAGE                      13020099
156000                                                                  13030099
156100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13040099
156200                                                                  13050099
156300         END-PERFORM                                              13060099
156400                                                                  13070099
156500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13080099
156600                                   TO PV-BLOCK-NUMBER             13090099
156700                                                                  13100099
156800         PERFORM 4410-READ-TEMP-STORAGE                           13110099
156900     END-IF.                                                      13120099
157000                                                                  13130099
157100                                                                  13140099
157200     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS13150099
157300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.13160099
157400     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  13170099
157500                                                                  13180099
157600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13190099
157700                                                                  13200099
157800/                                                                 13210099
157900*----------------------------------------------------------------*13220099
158000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13230099
158100*----------------------------------------------------------------*13240099
158200                                                                  13250099
158300 2141-CLEAR-SELECTED-INDS.                                        13260099
158400                                                                  13270099
158500     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          13280099
158600             NOT EQUAL ZERO                                       13290099
158700         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13300099
158800             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13310099
158900                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13320099
159000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13330099
159100                                   TO TRUE                        13340099
159200         END-IF                                                   13350099
159300     END-IF.                                                      13360099
159400                                                                  13370099
159500/                                                                 13380099
159600*----------------------------------------------------------------*13390099
159700*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13400099
159800*  FOR ALL ITEMS.                                                *13410099
159900*----------------------------------------------------------------*13420099
160000                                                                  13430099
160100 2150-SELECT-ALL-ITEMS.                                           13440099
160200                                                                  13450099
160300     MOVE +1                       TO ASC-BLK-SUB.                13460099
160400                                                                  13470099
160500     PERFORM 2151-SET-SELECTED-INDS                               13480099
160600         VARYING ASC-ITEM-SUB                                     13490099
160700         FROM 1 BY 1                                              13500099
160800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13510099
160900                                                                  13520099
161000     ADD +1                        TO ASC-BLK-SUB.                13530099
161100                                                                  13540099
161200     PERFORM 2151-SET-SELECTED-INDS                               13550099
161300         VARYING ASC-ITEM-SUB                                     13560099
161400         FROM 1 BY 1                                              13570099
161500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13580099
161600                                                                  13590099
161700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13600099
161800                                   TO PV-LIST-ITEM-NUMBER.        13610099
161900                                                                  13620099
162000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13630099
162100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13640099
162200                                                                  13650099
162300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13660099
162400        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13670099
162500         MOVE +1                   TO ASC-BLK-SUB                 13680099
162600                                                                  13690099
162700         PERFORM 5100-WRITE-TEMP-STORAGE                          13700099
162800                                                                  13710099
162900         MOVE +1                   TO PV-BLOCK-NUMBER             13720099
163000                                                                  13730099
163100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13740099
163200             PV-FIRST-BLOCK-IN-ARRAY - 1                          13750099
163300                                                                  13760099
163400         PERFORM                                                  13770099
163500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13780099
163600                                                                  13790099
163700             PERFORM 4410-READ-TEMP-STORAGE                       13800099
163800                                                                  13810099
163900             PERFORM 2151-SET-SELECTED-INDS                       13820099
164000                 VARYING ASC-ITEM-SUB                             13830099
164100                 FROM 1 BY 1                                      13840099
164200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13850099
164300                                                                  13860099
164400             PERFORM 5100-WRITE-TEMP-STORAGE                      13870099
164500                                                                  13880099
164600             ADD +1                TO PV-BLOCK-NUMBER             13890099
164700         END-PERFORM                                              13900099
164800                                                                  13910099
164900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13920099
165000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13930099
165100                                                                  13940099
165200         PERFORM                                                  13950099
165300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13960099
165400                   ASC-HIGHEST-BLOCK-WRITTEN                      13970099
165500                                                                  13980099
165600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13990099
165700                                   TO PV-BLOCK-NUMBER             14000099
165800                                                                  14010099
165900             PERFORM 4410-READ-TEMP-STORAGE                       14020099
166000                                                                  14030099
166100             PERFORM 2151-SET-SELECTED-INDS                       14040099
166200                 VARYING ASC-ITEM-SUB                             14050099
166300                 FROM 1 BY 1                                      14060099
166400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14070099
166500                                                                  14080099
166600             PERFORM 5100-WRITE-TEMP-STORAGE                      14090099
166700                                                                  14100099
166800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14110099
166900         END-PERFORM                                              14120099
167000                                                                  14130099
167100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14140099
167200                                   TO PV-BLOCK-NUMBER             14150099
167300                                                                  14160099
167400         PERFORM 4410-READ-TEMP-STORAGE                           14170099
167500     END-IF.                                                      14180099
167600                                                                  14190099
167700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             14200099
167800          ASC-NUMBER-OF-SELECTED-ITEMS.                           14210099
167900                                                                  14220099
168000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14230099
168100                                                                  14240099
168200/                                                                 14250099
168300*----------------------------------------------------------------*14260099
168400*    MARK EACH ITEM AS BEING SELECTED.                           *14270099
168500*----------------------------------------------------------------*14280099
168600                                                                  14290099
168700 2151-SET-SELECTED-INDS.                                          14300099
168800                                                                  14310099
168900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14320099
169000             NOT EQUAL ZERO                                       14330099
169100         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14340099
169200             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14350099
169300                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14360099
169400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14370099
169500                                   TO TRUE                        14380099
169600         END-IF                                                   14390099
169700     END-IF.                                                      14400099
169800                                                                  14410099
169900/                                                                 14420099
170000*----------------------------------------------------------------*14430099
170100*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *14440099
170200*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *14450099
170300*----------------------------------------------------------------*14460099
170400 2200-MOVE-SCREEN-TO-COMMAREA.                                    14470099
170500                                                                  14480099
170600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14490099
170700     MOVE +1                       TO PV-SUB.                     14500099
170800                                                                  14510099
170900     PERFORM 3100-SET-SUBSCRIPTS.                                 14520099
171000                                                                  14530099
171100     IF  ASTRTITL > ZERO                                          14540099
171200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      14550099
171300     ELSE                                                         14560099
171400         IF  ASTRTITF = DP015-ERASE-EOF                           14570099
171500             INITIALIZE ASC-START-ITEM-REQUEST                    14580099
171600         END-IF                                                   14590099
171700     END-IF.                                                      14600099
171800                                                                  14610099
171900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14620099
172000         VARYING PV-SUB                                           14630099
172100         FROM 1 BY 1                                              14640099
172200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      14650099
172300                                                                  14660099
172400/                                                                 14670099
172500*----------------------------------------------------------------*14680099
172600*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *14690099
172700*----------------------------------------------------------------*14700099
172800 2210-MOVE-LINES-TO-COMMAREA.                                     14710099
172900                                                                  14720099
173000     IF  MR-SELECTL (PV-SUB) > ZERO                               14730099
173100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     14740099
173200                                   TO TRUE                        14750099
173300         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        14760099
173400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14770099
173500     ELSE                                                         14780099
173600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                14790099
173700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         14800099
173800             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        14810099
173900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14820099
174000         END-IF                                                   14830099
174100     END-IF.                                                      14840099
174200                                                                  14850099
174300     ADD +1                        TO ASC-ITEM-SUB.               14860099
174400                                                                  14870099
174500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        14880099
174600         ADD +1                    TO ASC-BLK-SUB                 14890099
174700         MOVE +1                   TO ASC-ITEM-SUB                14900099
174800     END-IF.                                                      14910099
174900                                                                  14920099
175000/                                                                 14930099
175100*----------------------------------------------------------------*14940099
175200*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *14950099
175300*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *14960099
175400*----------------------------------------------------------------*14970099
175500 3000-EDIT-DATA-IN-COMMAREA.                                      14980099
175600                                                                  14990099
175700     SET PS-NO-ERROR               TO TRUE.                       15000099
175800                                                                  15010099
175900     PERFORM 3200-RESET-ATTRIBUTES.                               15020099
176000                                                                  15030099
176100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     15040099
176200**                                                                15050099
176300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              15060099
176400* EDITTING IS DONE FROM THE BOTTOM UP.                            15070099
176500**                                                                15080099
176600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       15090099
176700         ASC-ITEMS-DISPLAYED - 1.                                 15100099
176800                                                                  15110099
176900     PERFORM 3100-SET-SUBSCRIPTS.                                 15120099
177000     PERFORM 3300-EDIT-SELECTIONS                                 15130099
177100         VARYING PV-SUB                                           15140099
177200         FROM PV-SUB BY -1                                        15150099
177300         UNTIL PV-SUB < +1                                        15160099
177400                                                                  15170099
177500     IF  PS-NO-ERROR                                              15180099
177600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        15190099
177700     END-IF.                                                      15200099
177800                                                                  15210099
177900     IF  ((PS-NO-ERROR)                                           15220099
178000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   15230099
178100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    15240099
178200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  15250099
178300     END-IF.                                                      15260099
178400                                                                  15270099
178500/                                                                 15280099
178600*----------------------------------------------------------------*15290099
178700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *15300099
178800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*15310099
178900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *15320099
179000*                                                                *15330099
179100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *15340099
179200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *15350099
179300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15360099
179400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15370099
179500*----------------------------------------------------------------*15380099
179600                                                                  15390099
179700 3100-SET-SUBSCRIPTS.                                             15400099
179800                                                                  15410099
179900     COMPUTE ASC-ITEM-SUB =                                       15420099
180000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15430099
180100                                                                  15440099
180200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15450099
180300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15460099
180400                                                                  15470099
180500         MOVE PC-MAX-BLOCKS-IN-ARRAY                              15480099
180600                                   TO ASC-BLK-SUB                 15490099
180700     ELSE                                                         15500099
180800         MOVE +1                   TO ASC-BLK-SUB                 15510099
180900     END-IF.                                                      15520099
181000                                                                  15530099
181100*----------------------------------------------------------------*15540099
181200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *15550099
181300*----------------------------------------------------------------*15560099
181400                                                                  15570099
181500 3200-RESET-ATTRIBUTES.                                           15580099
181600                                                                  15590099
181700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   15600099
181800     MOVE DP015-GREEN              TO ASTRTITC.                   15610099
181900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   15620099
182000                                                                  15630099
182100     IF DP020-NEXT-ACT-RETURN                                     15640099
182200     OR DP020-NEXT-ACT-READ-MAP                                   15650099
182300        PERFORM                                                   15660099
182400            VARYING PV-SUB                                        15670099
182500            FROM 1 BY 1                                           15680099
182600            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    15690099
182700            MOVE DP015-UNP-ALP-NOR-OFF                            15700099
182800                                      TO MR-SELECTA (PV-SUB)      15710099
182900            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      15720099
183000            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      15730099
183100        END-PERFORM                                               15740099
183200     ELSE                                                         15750099
183300        PERFORM                                                   15760099
183400            VARYING PV-SUB                                        15770099
183500            FROM 1 BY 1                                           15780099
183600            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     15790099
183700            MOVE DP015-UNP-ALP-NOR-OFF                            15800099
183800                                      TO MR-SELECTA (PV-SUB)      15810099
183900            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      15820099
184000            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      15830099
184100        END-PERFORM                                               15840099
184200     END-IF.                                                      15850099
184300                                                                  15860099
184400/                                                                 15870099
184500*----------------------------------------------------------------*15880099
184600*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *15890099
184700*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *15900099
184800*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *15910099
184900*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *15920099
185000*----------------------------------------------------------------*15930099
185100 3300-EDIT-SELECTIONS.                                            15940099
185200                                                                  15950099
185300     EVALUATE TRUE                                                15960099
185400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     15970099
185500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         15980099
185600                 CONTINUE                                         15990099
185700                                                                  16000099
185800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16010099
185900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16020099
186000                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS16030099
186100                 MOVE ASC-TEMP-SELECTED-SW                        16040099
186200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16050099
186300                                   TO ASC-SELECTED-SW             16060099
186400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16070099
186500             END-IF                                               16080099
186600                                                                  16090099
186700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16100099
186800                 = SPACE                                          16110099
186900             EVALUATE TRUE                                        16120099
187000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       16130099
187100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS16140099
187200                     MOVE SPACE    TO ASC-SELECTED-SW             16150099
187300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16160099
187400                                                                  16170099
187500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        16180099
187600                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 16190099
187700                     MOVE SPACE    TO ASC-SELECTED-SW             16200099
187800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16210099
187900                                                                  16220099
188000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          16230099
188100                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   16240099
188200                     MOVE SPACE    TO ASC-SELECTED-SW             16250099
188300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16260099
188400             END-EVALUATE                                         16270099
188500                                                                  16280099
188600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           16290099
188700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16300099
188800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16310099
188900             END-IF                                               16320099
189000             PERFORM 3310-EDIT-RANGE                              16330099
189100                                                                  16340099
189200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             16350099
189300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16360099
189400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16370099
189500             END-IF                                               16380099
189600             PERFORM 3310-EDIT-RANGE                              16390099
189700                                                                  16400099
189800         WHEN OTHER                                               16410099
189900             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            16420099
190000             SET DP020-MSG-FATAL   TO TRUE                        16430099
190100             MOVE -1               TO MR-SELECTL (PV-SUB)         16440099
190200             SET DP030-SET-CURSOR-APPL-1                          16450099
190300                                   TO TRUE                        16460099
190400             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         16470099
190500             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         16480099
190600             SET PS-ERROR          TO TRUE                        16490099
190700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16500099
190800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     16510099
190900                 MOVE SPACE        TO ASC-SELECTED-SW             16520099
191000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16530099
191100             END-IF                                               16540099
191200     END-EVALUATE.                                                16550099
191300                                                                  16560099
191400     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             16570099
191500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               16580099
191600                                                                  16590099
191700     IF  ASC-ITEM-SUB < 1                                         16600099
191800         SUBTRACT +1 FROM ASC-BLK-SUB                             16610099
191900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                16620099
192000     END-IF.                                                      16630099
192100                                                                  16640099
192200*----------------------------------------------------------------*16650099
192300*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *16660099
192400*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *16670099
192500*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *16680099
192600*  THE ENDING.                                                   *16690099
192700*----------------------------------------------------------------*16700099
192800 3310-EDIT-RANGE.                                                 16710099
192900                                                                  16720099
193000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                16730099
193100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   16740099
193200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)16750099
193300                                   TO ASC-SELECTED-SW             16760099
193400                                        (ASC-BLK-SUB ASC-ITEM-SUB)16770099
193500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 16780099
193600         ELSE                                                     16790099
193700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     16800099
193800                 CONTINUE                                         16810099
193900             ELSE                                                 16820099
194000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        16830099
194100                 MOVE PC-TSYMSG-00054                             16840099
194200                                   TO DP020-MSG-NUMBER            16850099
194300                 SET DP020-MSG-FATAL                              16860099
194400                                   TO TRUE                        16870099
194500                 MOVE -1           TO MR-SELECTL (PV-SUB)         16880099
194600                 SET DP030-SET-CURSOR-APPL-1                      16890099
194700                                   TO TRUE                        16900099
194800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         16910099
194900                 MOVE DP015-UNDERLINE                             16920099
195000                                   TO MR-SELECTH (PV-SUB)         16930099
195100                 SET PS-ERROR      TO TRUE                        16940099
195200             END-IF                                               16950099
195300         END-IF                                                   16960099
195400     ELSE                                                         16970099
195500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     16980099
195600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16990099
195700                                   TO ASC-SELECTED-SW             17000099
195800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17010099
195900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   17020099
196000         ELSE                                                     17030099
196100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       17040099
196200                 CONTINUE                                         17050099
196300             ELSE                                                 17060099
196400*                -- ONLY ONE END-OF-RANGE ALLOWED --              17070099
196500                 MOVE PC-TSYMSG-00055                             17080099
196600                                   TO DP020-MSG-NUMBER            17090099
196700                 SET DP020-MSG-FATAL                              17100099
196800                                   TO TRUE                        17110099
196900                 MOVE -1           TO MR-SELECTL (PV-SUB)         17120099
197000                 SET DP030-SET-CURSOR-APPL-1                      17130099
197100                                   TO TRUE                        17140099
197200                 SET PS-ERROR      TO TRUE                        17150099
197300             END-IF                                               17160099
197400         END-IF                                                   17170099
197500     END-IF.                                                      17180099
197600                                                                  17190099
197700*----------------------------------------------------------------*17200099
197800*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *17210099
197900*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *17220099
198000*----------------------------------------------------------------*17230099
198100 3400-CHECK-RANGE-SEQUENCE.                                       17240099
198200                                                                  17250099
198300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       17260099
198400       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      17270099
198500       AND  ASC-START-OF-SELECTED-RANGE >                         17280099
198600                                         ASC-END-OF-SELECTED-RANGE17290099
198700*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                17300099
198800         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            17310099
198900         SET DP020-MSG-FATAL       TO TRUE                        17320099
199000         SET PS-ERROR              TO TRUE                        17330099
199100         PERFORM 3410-POSITION-AT-ERROR                           17340099
199200     END-IF.                                                      17350099
199300                                                                  17360099
199400*----------------------------------------------------------------*17370099
199500*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *17380099
199600*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *17390099
199700*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *17400099
199800*----------------------------------------------------------------*17410099
199900 3410-POSITION-AT-ERROR.                                          17420099
200000                                                                  17430099
200100     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       17440099
200200                                                                  17450099
200300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 17460099
200400                    - PV-TOP-ITEM + 1.                            17470099
200500                                                                  17480099
200600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17490099
200700         CONTINUE                                                 17500099
200800     ELSE                                                         17510099
200900         MOVE -1                   TO MR-SELECTL (PV-SUB)         17520099
201000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         17530099
201100         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         17540099
201200     END-IF.                                                      17550099
201300                                                                  17560099
201400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   17570099
201500                    - PV-TOP-ITEM + 1.                            17580099
201600                                                                  17590099
201700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17600099
201800         CONTINUE                                                 17610099
201900     ELSE                                                         17620099
202000         MOVE -1                   TO MR-SELECTL (PV-SUB)         17630099
202100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         17640099
202200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         17650099
202300     END-IF.                                                      17660099
202400                                                                  17670099
202500/                                                                 17680099
202600*----------------------------------------------------------------*17690099
202700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *17700099
202800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *17710099
202900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *17720099
203000*----------------------------------------------------------------*17730099
203100                                                                  17740099
203200 3500-MARK-RANGE-AS-SELECTED.                                     17750099
203300                                                                  17760099
203400     MOVE +1                       TO ASC-BLK-SUB.                17770099
203500                                                                  17780099
203600     PERFORM 3510-MARK-SELECTED-INDS                              17790099
203700         VARYING ASC-ITEM-SUB                                     17800099
203800         FROM 1 BY 1                                              17810099
203900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17820099
204000                                                                  17830099
204100     ADD +1                        TO ASC-BLK-SUB.                17840099
204200                                                                  17850099
204300     PERFORM 3510-MARK-SELECTED-INDS                              17860099
204400         VARYING ASC-ITEM-SUB                                     17870099
204500         FROM 1 BY 1                                              17880099
204600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17890099
204700                                                                  17900099
204800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17910099
204900                                   TO PV-LIST-ITEM-NUMBER.        17920099
205000                                                                  17930099
205100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17940099
205200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17950099
205300               PC-ITEMS-PER-PANEL).                               17960099
205400                                                                  17970099
205500     MOVE ASC-START-OF-SELECTED-RANGE                             17980099
205600                                   TO PV-START-OF-SELECTED-RANGE. 17990099
205700                                                                  18000099
205800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            18010099
205900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  18020099
206000               PC-ITEMS-PER-PANEL).                               18030099
206100                                                                  18040099
206200     MOVE ASC-END-OF-SELECTED-RANGE                               18050099
206300                                   TO PV-END-OF-SELECTED-RANGE.   18060099
206400                                                                  18070099
206500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             18080099
206600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    18090099
206700               PC-ITEMS-PER-PANEL).                               18100099
206800                                                                  18110099
206900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             18120099
207000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             18130099
207100                                                                  18140099
207200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    18150099
207300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        18160099
207400         MOVE +1                   TO ASC-BLK-SUB                 18170099
207500         PERFORM 5100-WRITE-TEMP-STORAGE                          18180099
207600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18190099
207700             PV-FIRST-BLOCK-IN-ARRAY - 1                          18200099
207800                                                                  18210099
207900         PERFORM                                                  18220099
208000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      18230099
208100                   PV-PREV-BLOCK-IN-ARRAY                         18240099
208200             MOVE PV-FIRST-BLOCK-IN-RANGE                         18250099
208300                                   TO PV-BLOCK-NUMBER             18260099
208400             PERFORM 4410-READ-TEMP-STORAGE                       18270099
208500             PERFORM 3510-MARK-SELECTED-INDS                      18280099
208600                 VARYING ASC-ITEM-SUB                             18290099
208700                 FROM 1 BY 1                                      18300099
208800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18310099
208900             PERFORM 5100-WRITE-TEMP-STORAGE                      18320099
209000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     18330099
209100         END-PERFORM                                              18340099
209200                                                                  18350099
209300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18360099
209400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18370099
209500         PERFORM                                                  18380099
209600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18390099
209700                   PV-LAST-BLOCK-IN-RANGE                         18400099
209800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18410099
209900                                   TO PV-BLOCK-NUMBER             18420099
210000             PERFORM 4410-READ-TEMP-STORAGE                       18430099
210100             PERFORM 3510-MARK-SELECTED-INDS                      18440099
210200                 VARYING ASC-ITEM-SUB                             18450099
210300                 FROM 1 BY 1                                      18460099
210400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18470099
210500             PERFORM 5100-WRITE-TEMP-STORAGE                      18480099
210600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18490099
210700         END-PERFORM                                              18500099
210800                                                                  18510099
210900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18520099
211000                                   TO PV-BLOCK-NUMBER             18530099
211100         PERFORM 4410-READ-TEMP-STORAGE                           18540099
211200     END-IF.                                                      18550099
211300                                                                  18560099
211400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 18570099
211500                                      ASC-END-OF-SELECTED-RANGE.  18580099
211600                                                                  18590099
211700/                                                                 18600099
211800*----------------------------------------------------------------*18610099
211900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *18620099
212000*----------------------------------------------------------------*18630099
212100                                                                  18640099
212200 3510-MARK-SELECTED-INDS.                                         18650099
212300                                                                  18660099
212400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         18670099
212500         ASC-START-OF-SELECTED-RANGE)                             18680099
212600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         18690099
212700         ASC-START-OF-SELECTED-RANGE)                             18700099
212800                                                                  18710099
212900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     18720099
213000             ASC-END-OF-SELECTED-RANGE)                           18730099
213100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     18740099
213200             ASC-END-OF-SELECTED-RANGE)                           18750099
213300                                                                  18760099
213400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18770099
213500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   18780099
213600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   18790099
213700                                   TO TRUE                        18800099
213800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              18810099
213900                                   TO TRUE                        18820099
214000                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS18830099
214100             END-IF                                               18840099
214200         END-IF                                                   18850099
214300     END-IF.                                                      18860099
214400                                                                  18870099
214500/                                                                 18880099
214600*----------------------------------------------------------------*18890099
214700*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *18900099
214800*    INITIALIZE ALL COUNTERS AND FLAGS.                          *18910099
214900*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *18920099
215000*    DISPLAY THE PANEL TO USER.                                  *18930099
215100*----------------------------------------------------------------*18940099
215200                                                                  18950099
215300 4000-BUILD-INITIAL-PANEL.                                        18960099
215400                                                                  18970099
215500     INITIALIZE ASC-BLOCK-ENTRIES (1)                             18980099
215600                ASC-BLOCK-ENTRIES (2).                            18990099
215700*    SET ASC-DISPLAY-DOLLAR TO TRUE.                              19000099
215800                                                                  19010099
215900     MOVE +1                       TO ASC-BLK-SUB                 19020099
                                            ASC-DC-SUB.                 19030099
                                                                        19040099
216300     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       19050099
216400                                                                  19060099
216500     MOVE +0                       TO ASC-ITEM-SUB                19070099
216600                                      ASC-NUMBER-OF-ITEMS-READ    19080099
216700                                      ASC-NUMBER-OF-SELECTED-ITEMS19090099
216800                                      ASC-HIGHEST-BLOCK-WRITTEN   19100099
216900                                      ASC-START-OF-SELECTED-RANGE 19110099
217000                                      ASC-END-OF-SELECTED-RANGE   19120099
217100                                      ASC-ITEM-AT-TOP-OF-PANEL.   19130099
217200                                                                  19140099
217300     EXEC CICS ASSIGN                                             19150099
217400               APPLID(PV-SYSTEM-ID)                               19160099
217500     END-EXEC.                                                    19170099
217600                                                                  19180099
217700     MOVE PV-REGION-IND TO PV-QUALIFIER                           19190099
217800                           PV-QUALIFIER-COMMA.                    19200099
218100                                                                  19210099
218200     PERFORM 4100-OPEN-PREPACK-CURSOR.                            19220099
218800                                                                  19230099
218900     PERFORM 4300-READ-ITEMS-FROM-DB.                             19240099
219000                                                                  19250099
219100     PERFORM 4040-CLOSE-PREPACK-CURSOR.                           19260099
219200                                                                  19270099
219300     MOVE +1                       TO PV-TOP-ITEM.                19280099
219400                                                                  19290099
219500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          19300099
219600         SET DP020-NEXT-ACT-APPL-ERROR                            19310099
219700                                   TO TRUE                        19320099
219800         SET DP020-MSG-FATAL       TO TRUE                        19330099
219900         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            19340099
220000     ELSE                                                         19350099
220100         MOVE -1                   TO MR-SELECTL (1)              19360099
220200         SET DP030-SET-CURSOR-APPL-1                              19370099
220300                                   TO TRUE                        19380099
               MOVE 1 TO ASC-DC-SUB                                     19390099
               PERFORM 4350-CALC-QTYS                                   19400099
220400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     19410099
220500     END-IF.                                                      19420099
220600                                                                  19430099
220700/                                                                 19440099
224700*----------------------------------------------------------------*19450099
224800* OPEN THE PREPACK CURSOR                                        *19460099
224900*----------------------------------------------------------------*19470099
225000                                                                  19480099
225100 4100-OPEN-PREPACK-CURSOR.                                        19490099
225200                                                                  19500099
225300     PERFORM                                                      19510099
225400         WITH TEST AFTER                                          19520099
225500         VARYING PV-RETRY-COUNTER                                 19530099
225600         FROM 1 BY 1                                              19540099
225700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19550099
225800            OR (SQLCODE = +0))                                    19560099
225900                                                                  19570099
226000         EXEC SQL                                                 19580099
226100             OPEN PREPACK-CSR                                     19590099
226200         END-EXEC                                                 19600099
226300                                                                  19610099
226400         EVALUATE TRUE                                            19620099
226500             WHEN SQLCODE = +0                                    19630099
226600                  CONTINUE                                        19640099
226700             WHEN SQLCODE = -904                                  19650099
226800             WHEN SQLCODE = -913                                  19660099
226900                  CONTINUE                                        19670099
227000             WHEN SQLWARN0 NOT = SPACE                            19680099
227100             WHEN SQLCODE  NOT = +0                               19690099
227200                  MOVE '4100-OPEN-CURSOR'                         19700099
227300                                   TO DP013-PARAGRAPH             19710099
227400                  MOVE 'OPEN PREPACK CURSOR'                      19720099
227500                                   TO DP013-MESSAGE-TEXT (1)      19730099
227600                  MOVE SQLCA       TO DP013-SQLCA                 19740099
227700                  MOVE 'TPOPRPK'   TO DP013-DB2-TABLE-NAME (1)    19750099
228100                  SET DP013-DB2-ABEND                             19760099
228200                                   TO TRUE                        19770099
228300                  PERFORM DP013-0000-PROCESS-ABEND                19780099
228400         END-EVALUATE                                             19790099
228500     END-PERFORM.                                                 19800099
228600                                                                  19810099
228700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19820099
228800         MOVE '4100-OPEN-PREPACK-CURSOR'   TO DP013-PARAGRAPH     19830099
228900         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              19840099
229000                                   TO DP013-MESSAGE-TEXT (1)      19850099
229100         MOVE SQLCA                TO DP013-SQLCA                 19860099
229200         SET DP013-DB2-ABEND       TO TRUE                        19870099
229300         PERFORM DP013-0000-PROCESS-ABEND                         19880099
229400     END-IF.                                                      19890099
229500                                                                  19900099
229600/                                                                 19910099
229700*----------------------------------------------------------------*19920099
229800* CLOSE THE PREPACK CURSOR.                                      *19930099
229900*----------------------------------------------------------------*19940099
230000                                                                  19950099
230100 4040-CLOSE-PREPACK-CURSOR.                                       19960099
230200                                                                  19970099
230300     EXEC SQL                                                     19980099
230400         CLOSE PREPACK-CSR                                        19990099
230500     END-EXEC.                                                    20000099
230600                                                                  20010099
230700     EVALUATE TRUE                                                20020099
230800         WHEN SQLCODE = +0                                        20030099
230900              CONTINUE                                            20040099
231000         WHEN SQLWARN0 NOT = SPACE                                20050099
231100         WHEN SQLCODE  NOT = +0                                   20060099
231200              MOVE '4040-CLOSE-PREPACK-CURSOR'                    20070099
231300                                   TO DP013-PARAGRAPH             20080099
231400              MOVE 'CLOSE PREPACK CURSOR'                         20090099
231500                                   TO DP013-MESSAGE-TEXT (1)      20100099
231600              MOVE SQLCA           TO DP013-SQLCA                 20110099
231700              MOVE 'TPOPRPK'       TO DP013-DB2-TABLE-NAME (1)    20120099
232100              SET DP013-DB2-ABEND  TO TRUE                        20130099
232200              PERFORM DP013-0000-PROCESS-ABEND                    20140099
232300     END-EVALUATE.                                                20150099
232400                                                                  20160099
232500/                                                                 20170099
232600*----------------------------------------------------------------*20180099
232800*    OPEN THE DC CURSOR                                          *20190099
232900*----------------------------------------------------------------*20200099
233000                                                                  20210099
233100 4100-OPEN-DC-CURSOR.                                             20220099
233200                                                                  20230099
           PERFORM                                                      20240099
               WITH TEST AFTER                                          20250099
               VARYING PV-RETRY-COUNTER                                 20260099
               FROM 1 BY 1                                              20270099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20280099
                         OR (SQLCODE = ZERO))                           20290099
                                                                        20300099
                       EXEC SQL                                         20310099
                            OPEN DC-CSR                                 20320099
                       END-EXEC                                         20330099
                                                                        20340099
               EVALUATE TRUE                                            20350099
                   WHEN SQLCODE = ZERO                                  20360099
                   WHEN SQLCODE = -904                                  20370099
                   WHEN SQLCODE = -913                                  20380099
                       CONTINUE                                         20390099
                   WHEN SQLWARN0 NOT = SPACES                           20400099
                   WHEN SQLCODE < ZERO                                  20410099
                   WHEN SQLCODE > ZERO                                  20420099
                       MOVE '4100-OPEN-DC-CURSOR'                       20430099
                                         TO DP013-PARAGRAPH             20440099
                       MOVE 'OPEN DC CURSOR - '                         20450099
                                         TO DP013-MESSAGE-TEXT (1)      20460099
                       MOVE SQLCA        TO DP013-SQLCA                 20470099
                       MOVE 'XMT_LOC '   TO DP013-DB2-TABLE-NAME (1)    20480099
                       SET DP013-DB2-ABEND                              20490099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           20500099
                       PERFORM DP013-0000-PROCESS-ABEND                 20510099
               END-EVALUATE                                             20520099
           END-PERFORM.                                                 20530099
                                                                        20540099
            IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                       20550099
                MOVE '4100-OPEN-DC-CURSOR'  TO DP013-PARAGRAPH          20560099
                MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'  20570099
                                            TO DP013-MESSAGE-TEXT (1)   20580099
                MOVE SQLCA                  TO DP013-SQLCA              20590099
                MOVE 'XMT_LOC '             TO DP013-DB2-TABLE-NAME (1) 20600099
                SET DP013-DB2-ABEND                                     20610099
                    DP013-XCTL-DISPLAY-RESTART                          20620099
                                            TO TRUE                     20630099
                PERFORM DP013-0000-PROCESS-ABEND                        20640099
            END-IF.                                                     20650099
                                                                        20660099
259100                                                                  20670099
      *----------------------------------------------------------------*20680099
      *    PROCESS THE DC CURSOR                                       *20690099
      *----------------------------------------------------------------*20700099
                                                                        20710099
       4105-PROCESS-DC-CURSOR.                                          20720099
                                                                        20730099
           PERFORM VARYING PV-DC-COUNT                                  20740099
              FROM 1 BY 1                                               20750099
             UNTIL PS-END-OF-DC OR PS-TABLE-OVERFLOW                    20760099
                                                                        20770099
                 PERFORM 4106-FETCH-DC-CSR                              20780099
                 IF PS-END-OF-DC                                        20790099
                     CONTINUE                                           20800099
                 ELSE                                                   20810099
      *  IF WE HAVE MORE THAN 12 DIST CENTERS, BUMP THE NUMBER UP FROM  20820099
      *  12 TO THE NUMBER OF OCCURS IN THE ASC-DC-TABLE.                20830099
                    IF PV-DC-COUNT > 12                                 20840099
                        SET PS-TABLE-OVERFLOW TO TRUE                   20850099
                    ELSE                                                20860099
                        ADD +1 TO ASC-DC-COUNTER-DC                     20870099
                        MOVE XMT00001-LOC-NBR                           20880099
                          TO ASC-DC-NBR(PV-DC-COUNT)                    20890099
                        MOVE XMT00001-LOC-5-ABBR-NM(4:2)                20900099
                          TO ASC-DC-NAME(PV-DC-COUNT)                   20910099
                    END-IF                                              20920099
                 END-IF                                                 20930099
           END-PERFORM.                                                 20940099
                 IF ASC-DC-COUNTER-DC > 0                               20950099
                    SET ASC-MORE-DC TO TRUE                             20960099
                 ELSE                                                   20970099
                    SET ASC-NO-MORE-DC TO TRUE                          20980099
                 END-IF                                                 20990099
            MOVE 1 TO PV-DC-COUNT.                                      21000099
315300/                                                                 21010099
      *----------------------------------------------------------------*21020099
      *    FETCH THE DC CURSOR                                         *21030099
      *----------------------------------------------------------------*21040099
                                                                        21050099
       4106-FETCH-DC-CSR.                                               21060099
                                                                        21070099
           EXEC SQL                                                     21080099
                FETCH DC-CSR                                            21090099
                INTO :XMT00001-LOC-NBR,                                 21100099
                     :XMT00001-LOC-5-ABBR-NM                            21110099
           END-EXEC.                                                    21120099
                                                                        21130099
           EVALUATE TRUE                                                21140099
               WHEN SQLCODE = ZERO                                      21150099
                    CONTINUE                                            21160099
               WHEN SQLCODE = +100                                      21170099
                    SET PS-END-OF-DC TO TRUE                            21180099
               WHEN SQLWARN0 NOT = ZERO                                 21190099
                    MOVE '4016-FETCH-DC-CSR'                            21200099
                                         TO DP013-PARAGRAPH             21210099
                    MOVE 'FETCH DC CURSOR'                              21220099
                                         TO DP013-MESSAGE-TEXT (1)      21230099
                    MOVE SQLCA           TO DP013-SQLCA                 21240099
                    SET DP013-DB2-ABEND  TO TRUE                        21250099
                    PERFORM DP013-0000-PROCESS-ABEND                    21260099
           END-EVALUATE.                                                21270099
                                                                        21280099
      *----------------------------------------------------------------*21290099
      *   CLOSE THE DC CURSOR                                          *21300099
      *----------------------------------------------------------------*21310099
                                                                        21320099
       4110-CLOSE-DC-CURSOR.                                            21330099
                                                                        21340099
           EXEC SQL                                                     21350099
                CLOSE DC-CSR                                            21360099
           END-EXEC.                                                    21370099
                                                                        21380099
           EVALUATE TRUE                                                21390099
               WHEN SQLCODE = ZERO                                      21400099
                    CONTINUE                                            21410099
               WHEN SQLWARN0 NOT = SPACES                               21420099
               WHEN SQLCODE < ZERO                                      21430099
               WHEN SQLCODE > ZERO                                      21440099
                    MOVE '4110-CLOSE-DC-CURSOR'                         21450099
                                          TO DP013-PARAGRAPH            21460099
                    MOVE 'CLOSE DC CURSOR '                             21470099
                                          TO DP013-MESSAGE-TEXT (1)     21480099
                    MOVE SQLCA            TO DP013-SQLCA                21490099
                    MOVE 'XMT_LOC'        TO DP013-DB2-TABLE-NAME (1)   21500099
                    SET DP013-DB2-ABEND                                 21510099
                        DP013-XCTL-DISPLAY-RESTART TO TRUE              21520099
                    PERFORM DP013-0000-PROCESS-ABEND                    21530099
           END-EVALUATE.                                                21540099
317900*----------------------------------------------------------------*21550099
318000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21560099
318100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *21570099
318200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *21580099
318300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *21590099
318400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *21600099
318500*                                                                *21610099
318600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21620099
318700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21630099
318800*    UPON INITIALIZATION.                                        *21640099
318900*----------------------------------------------------------------*21650099
319000                                                                  21660099
319100 4300-READ-ITEMS-FROM-DB.                                         21670099
319200                                                                  21680099
319300     PERFORM                                                      21690099
319400         VARYING PV-READ-COUNT                                    21700099
319500         FROM 1 BY 1                                              21710099
319600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21720099
319700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21730099
319800                                                                  21740099
319900         PERFORM 4310-FETCH                                       21750099
320000                                                                  21760099
320100         MOVE 'N'                  TO PS-SKIP-SW                  21770099
322900                                                                  21780099
324600         IF  ASC-ITEMS-LEFT-ON-DB                                 21790099
324700         AND PS-DONT-SKIP                                         21800099
324800             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                21810099
324900                 ADD +1            TO ASC-ITEM-SUB                21820099
325000             ELSE                                                 21830099
325100                 ADD +1            TO ASC-BLK-SUB                 21840099
                                            ASC-DC-SUB                  21850099
325200                 MOVE +1           TO ASC-ITEM-SUB                21860099
325300                                                                  21870099
325400                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         21880099
325500                     MOVE +1       TO ASC-BLK-SUB                 21890099
                                            ASC-DC-SUB                  21900099
325600                     SET ASC-BLOCK-MODIFIED (1)                   21910099
325700                                   TO TRUE                        21920099
325800                     PERFORM 5100-WRITE-TEMP-STORAGE              21930099
325900                     MOVE ASC-BLOCK-ENTRIES                       21940099
326000                               (PC-MAX-BLOCKS-IN-ARRAY)           21950099
326100                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21960099
326200                     ADD +1        TO ASC-BLK-SUB                 21970099
                                            ASC-DC-SUB                  21980099
326300                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   21990099
326400                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      22000099
326500                                   TO TRUE                        22010099
326600                 END-IF                                           22020099
326700             END-IF                                               22030099
326800             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    22040099
326900             MOVE ASC-NUMBER-OF-ITEMS-READ                        22050099
327000                                   TO ASC-LIST-ITEM-NUMBER        22060099
327100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22070099
                                                                        22080099
                                                                        22090099
                   MOVE POPRPK-PO-PREPK-ID TO ASC-PACK-ID               22100099
                                              (ASC-BLK-SUB ASC-ITEM-SUB)22110099
                   MOVE POPRPK-PREPK-TYP-CDE TO ASC-PREPK-TYP-CDE       22120099
                                              (ASC-BLK-SUB ASC-ITEM-SUB)22130099
                   MOVE POPRPK-INPK-UNT-QTY   TO ASC-INPK-UNT-QTY       22140099
                                              (ASC-BLK-SUB ASC-ITEM-SUB)22150099
                   MOVE POPRPK-OTPK-UNT-QTY TO ASC-OTPK-UNT-QTY         22160099
                                              (ASC-BLK-SUB ASC-ITEM-SUB)22170099
                                                                        22180099
337100         END-IF                                                   22190099
337200     END-PERFORM.                                                 22200099
337300                                                                  22210099
337400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          22220099
337500         MOVE +1                   TO ASC-BLK-SUB                 22230099
                                            ASC-DC-SUB                  22240099
337600         PERFORM 5100-WRITE-TEMP-STORAGE                          22250099
337700         ADD +1                    TO ASC-BLK-SUB                 22260099
                                            ASC-DC-SUB                  22270099
337800         PERFORM 5100-WRITE-TEMP-STORAGE                          22280099
337900                                                                  22290099
338000         MOVE 1                    TO ASC-BLK-SUB                 22300099
338100                                      PV-BLOCK-NUMBER             22310099
                                            ASC-DC-SUB                  22320099
338200         PERFORM 4410-READ-TEMP-STORAGE                           22330099
338300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             22340099
338400             MOVE 2                TO ASC-BLK-SUB                 22350099
338500                                      PV-BLOCK-NUMBER             22360099
                                            ASC-DC-SUB                  22370099
338600             PERFORM 4410-READ-TEMP-STORAGE                       22380099
338700         END-IF                                                   22390099
338800     END-IF.                                                      22400099
                                                                        22410099
339000/                                                                 22420099
339100*----------------------------------------------------------------*22430099
339200*    FETCH A VENDOR ROW                                          *22440099
339300*----------------------------------------------------------------*22450099
339400                                                                  22460099
339500 4310-FETCH.                                                      22470099
339600                                                                  22480099
339700     EXEC SQL                                                     22490099
339800         FETCH PREPACK-CSR                                        22500099
339900          INTO :POPRPK-PREPK-TYP-CDE                              22510099
340000              ,:POPRPK-PO-PREPK-ID                                22520099
340100              ,:POPRPK-PREPK-DESC                                 22530099
340200              ,:POPRPK-INPK-UNT-QTY                               22540099
340300              ,:POPRPK-OTPK-UNT-QTY                               22550099
340300              ,:POPRPK-OTPK-ORD-QTY                               22560099
340400     END-EXEC.                                                    22570099
340500                                                                  22580099
340600     EVALUATE TRUE                                                22590099
340700         WHEN SQLCODE = +0                                        22600099
340800              CONTINUE                                            22610099
340900         WHEN SQLCODE = +100                                      22620099
341000              SET ASC-NO-ITEMS-LEFT-ON-DB                         22630099
341100                                   TO TRUE                        22640099
341200         WHEN SQLWARN0 NOT = SPACE                                22650099
341300         WHEN SQLCODE < +0                                        22660099
341400         WHEN SQLCODE > +0                                        22670099
341500              MOVE '4310-FETCH-CURSOR'                            22680099
341600                                   TO DP013-PARAGRAPH             22690099
341700              MOVE 'FETCH PREPACK CURSOR'                         22700099
341800                                   TO DP013-MESSAGE-TEXT (1)      22710099
341900              MOVE SQLCA           TO DP013-SQLCA                 22720099
342000              MOVE 'TPOPRPK'       TO DP013-DB2-TABLE-NAME (1)    22730099
342400              SET DP013-DB2-ABEND  TO TRUE                        22740099
342500              PERFORM DP013-0000-PROCESS-ABEND                    22750099
342600     END-EVALUATE.                                                22760099
342700                                                                  22770099
342800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22780099
342900         MOVE '4310-FETCH-CURSOR'  TO DP013-PARAGRAPH             22790099
343000         MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             22800099
343100                                   TO DP013-MESSAGE-TEXT (1)      22810099
343200         MOVE SQLCA                TO DP013-SQLCA                 22820099
343300         SET DP013-DB2-ABEND                                      22830099
343400             DP013-XCTL-DISPLAY-RESTART                           22840099
343500                                   TO TRUE                        22850099
343600         PERFORM DP013-0000-PROCESS-ABEND                         22860099
343700     END-IF.                                                      22870099
343800                                                                  22880099
343900/                                                                 22890099
       4350-CALC-QTYS.                                                  22900099
                                                                        22910099
           MOVE +1                       TO ASC-BLK-SUB.                22920099
                                                                        22930099
           PERFORM 4360-GET-UNT-QTYS                                    22940099
               VARYING ASC-ITEM-SUB                                     22950099
               FROM 1 BY 1                                              22960099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22970099
                                                                        22980099
           ADD +1                        TO ASC-BLK-SUB.                22990099
                                                                        23000099
           PERFORM 4360-GET-UNT-QTYS                                    23010099
               VARYING ASC-ITEM-SUB                                     23020099
               FROM 1 BY 1                                              23030099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23040099
                                                                        23050099
           MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23060099
                                         TO PV-LIST-ITEM-NUMBER.        23070099
                                                                        23080099
           COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23090099
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    23100099
                                                                        23110099
                                                                        23120099
           IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     23130099
              (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    23140099
               MOVE +1                   TO ASC-BLK-SUB                 23150099
                                                                        23160099
               PERFORM 5100-WRITE-TEMP-STORAGE                          23170099
                                                                        23180099
               MOVE +1                   TO PV-BLOCK-NUMBER             23190099
                                                                        23200099
               COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23210099
                   PV-FIRST-BLOCK-IN-ARRAY - 1                          23220099
                                                                        23230099
               PERFORM                                                  23240099
                   UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       23250099
                                                                        23260099
                   PERFORM 4410-READ-TEMP-STORAGE                       23270099
                                                                        23280099
                   PERFORM 4360-GET-UNT-QTYS                            23290099
                       VARYING ASC-ITEM-SUB                             23300099
                       FROM 1 BY 1                                      23310099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23320099
                                                                        23330099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      23340099
                                                                        23350099
                   ADD +1                TO PV-BLOCK-NUMBER             23360099
               END-PERFORM                                              23370099
                                                                        23380099
               COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23390099
                   PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     23400099
                                                                        23410099
               PERFORM                                                  23420099
                   UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23430099
                         ASC-HIGHEST-BLOCK-WRITTEN                      23440099
                   MOVE PV-NEXT-BLOCK-IN-ARRAY                          23450099
                                         TO PV-BLOCK-NUMBER             23460099
                                                                        23470099
                   PERFORM 4410-READ-TEMP-STORAGE                       23480099
                                                                        23490099
                   PERFORM 4360-GET-UNT-QTYS                            23500099
                       VARYING ASC-ITEM-SUB                             23510099
                       FROM 1 BY 1                                      23520099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23530099
                                                                        23540099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      23550099
                                                                        23560099
                   ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23570099
               END-PERFORM                                              23580099
               MOVE PV-FIRST-BLOCK-IN-ARRAY                             23590099
                                         TO PV-BLOCK-NUMBER             23600099
                                                                        23610099
               PERFORM 4410-READ-TEMP-STORAGE                           23620099
           END-IF.                                                      23630099
                                                                        23640099
      ******************************************************************23650099
       4360-GET-UNT-QTYS.                                               23660099
           IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           23670099
                   NOT EQUAL ZERO                                       23680099
                                                                        23690099
             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE                23700099
                                                                        23710099
             MOVE ASC-PACK-ID (ASC-BLK-SUB ASC-ITEM-SUB)                23720099
                                               TO PC-PREPACKX           23730099
             PERFORM                                                    23740099
               VARYING PV-DC-COUNT                                      23750099
               FROM 1 BY 1                                              23760099
               UNTIL (PV-DC-COUNT > PC-DCS-PER-SCREEN)                  23770099
               COMPUTE PV-CURR-DC-CNT EQUAL                             23780099
                    ASC-DC-COUNTER + PV-DC-COUNT                        23790099
               MOVE ASC-DC-NBR(PV-CURR-DC-CNT) TO PC-DCX                23800099
                                                                        23810099
               PERFORM 4361-GET-UNITS-ORDERED                           23820099
               MOVE PV-LINE-QTY TO                                      23830099
                ASC-DC-ONORD-UNITS(ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)23840099
               INSPECT ASC-DC-ONORD-UNITS                               23850099
                                  (ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)23860099
               REPLACING LEADING '0' BY ' '                             23870099
                                                                        23880099
               PERFORM 4362-GET-UNT-CRTN-COUNT                          23890099
                                                                        23900099
               PERFORM 4363-GET-VERIFIED-UNITS                          23910099
               MOVE PV-DC-REC-QTY TO                                    23920099
                 ASC-DC-RECD-UNITS(ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)23930099
               INSPECT ASC-DC-RECD-UNITS                                23940099
                                  (ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)23950099
               REPLACING LEADING '0' BY ' '                             23960099
                                                                        23970099
               PERFORM 4364-GET-VER-UNT-CRTN-COUNT                      23980099
             END-PERFORM                                                23990099
           END-IF.                                                      24000099
339000/                                                                 24010099
      *----------------------------------------------------------------*24020099
      * GET UNITS ORDERED                                              *24030099
      *----------------------------------------------------------------*24040099
                                                                        24050099
       4361-GET-UNITS-ORDERED.                                          24060099
                                                                        24070099
           INITIALIZE PV-LINE-QTY                                       24080099
                                                                        24090099
           PERFORM                                                      24100099
               WITH TEST AFTER                                          24110099
               VARYING PV-RETRY-COUNTER                                 24120099
               FROM 1 BY 1                                              24130099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24140099
                         OR (SQLCODE = ZERO)                            24150099
                         OR (SQLCODE = 100))                            24160099
               EXEC SQL                                                 24170099
                   SELECT SUM(A.CURR_SPLIT_QTY)                         24180099
                     INTO :PV-LINE-QTY:PV-NULL-IND                      24190099
                     FROM  TALLPLN A                                    24200099
                          ,TPURITM B                                    24210099
                    WHERE  A.PO_NBR = :ASC-KEY-PO-NBR                   24220099
                      AND  A.CURR_SPLIT_QTY > +0                        24230099
                      AND  A.DEST_NBR = :PC-DCX                         24240099
                      AND  B.VER_STATUS_CDE = 'A'                       24250099
                      AND  B.PO_NBR = A.PO_NBR                          24260099
                      AND  B.PO_LNE_NBR = A.PO_LNE_NBR                  24270099
                      AND  B.STATUS_CDE NOT IN ('CA')                   24280099
                      AND  B.PO_PREPK_ID = :PC-PREPACKX                 24290099
               END-EXEC                                                 24300099
                                                                        24310099
               EVALUATE TRUE                                            24320099
                   WHEN SQLCODE = +0                                    24330099
                        CONTINUE                                        24340099
                   WHEN SQLCODE = +100                                  24350099
                        CONTINUE                                        24360099
                   WHEN SQLCODE = -904                                  24370099
                   WHEN SQLCODE = -913                                  24380099
                        CONTINUE                                        24390099
                   WHEN SQLWARN0 NOT = SPACES                           24400099
                   WHEN SQLCODE < ZERO                                  24410099
                   WHEN SQLCODE > ZERO                                  24420099
                        MOVE '4361-GET-UNITS-ORDERED'                   24430099
                                          TO DP013-PARAGRAPH            24440099
                        MOVE 'RETRIEVING UNITS ORDERED'                 24450099
                                          TO DP013-MESSAGE-TEXT (1)     24460099
                        MOVE SQLCA        TO DP013-SQLCA                24470099
                        MOVE 'TALLPLN'    TO DP013-DB2-TABLE-NAME (1)   24480099
                        MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)   24490099
                        SET DP013-DB2-ABEND                             24500099
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          24510099
                        PERFORM DP013-0000-PROCESS-ABEND                24520099
               END-EVALUATE                                             24530099
           END-PERFORM.                                                 24540099
                                                                        24550099
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         24560099
              MOVE '4361-GET-UNITS-ORDERED' TO DP013-PARAGRAPH          24570099
              MOVE 'MAXIMUM RETRIES EXCEEDED'                           24580099
                                            TO DP013-MESSAGE-TEXT (1)   24590099
              MOVE SQLCA                    TO DP013-SQLCA              24600099
              MOVE 'TALLPLN'                TO DP013-DB2-TABLE-NAME (1) 24610099
              MOVE 'TPURITM'                TO DP013-DB2-TABLE-NAME (2) 24620099
              SET DP013-DB2-ABEND                                       24630099
                  DP013-XCTL-DISPLAY-RESTART                            24640099
                                            TO TRUE                     24650099
              PERFORM DP013-0000-PROCESS-ABEND                          24660099
           END-IF.                                                      24670099
      *----------------------------------------------------------------*24680099
      * GET UNIT CARTON COUNT                                          *24690099
      *----------------------------------------------------------------*24700099
                                                                        24710099
       4362-GET-UNT-CRTN-COUNT.                                         24720099
                                                                        24730099
           DIVIDE PV-LINE-QTY                                           24740099
           BY ASC-INPK-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                24750099
           GIVING PV-QUOTIENT                                           24760099
           REMAINDER PV-REMAINDER                                       24770099
           IF PV-REMAINDER = ZEROES                                     24780099
              IF ASC-PREPK-TYP-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = 'I'     24790099
                 COMPUTE PV-INNER-PKS =                                 24800099
                 ASC-OTPK-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)/            24810099
                 ASC-INPK-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)             24820099
                 DIVIDE PV-QUOTIENT BY PV-INNER-PKS                     24830099
                 GIVING PV-CRTN-CNT                                     24840099
                 REMAINDER PV-REMAINDER                                 24850099
              ELSE                                                      24860099
                 MOVE PV-QUOTIENT TO PV-CRTN-CNT                        24870099
              END-IF                                                    24880099
           ELSE                                                         24890099
              CONTINUE                                                  24900099
           END-IF                                                       24910099
           IF PV-REMAINDER = ZEROES                                     24920099
              MOVE PV-CRTN-CNT TO                                       24930099
              ASC-DC-ONORD-CRTNS(ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)  24940099
              INSPECT ASC-DC-ONORD-CRTNS                                24950099
                                 (ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT) 24960099
              REPLACING LEADING '0' BY ' '                              24970099
           ELSE                                                         24980099
              MOVE 'INVLD' TO                                           24990099
              ASC-DC-ONORD-CRTNS(ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)  25000099
           END-IF.                                                      25010099
      *----------------------------------------------------------------*25020099
      * GET VERIFIED UNITS                                             *25030099
      *----------------------------------------------------------------*25040099
                                                                        25050099
       4363-GET-VERIFIED-UNITS.                                         25060099
                                                                        25070099
           INITIALIZE PV-DC-REC-QTY                                     25080099
                                                                        25090099
           PERFORM WITH TEST AFTER                                      25100099
           VARYING PV-RETRY-COUNTER                                     25110099
           FROM 1 BY 1                                                  25120099
           UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                   25130099
                     OR (SQLCODE = ZERO)                                25140099
                     OR (SQLCODE = 100))                                25150099
               EXEC SQL                                                 25160099
                   SELECT SUM(AP_VERIFY_ITM_QTY)                        25170099
                   INTO :PV-DC-REC-QTY:PV-NULL-IND                      25180099
                   FROM  TRECITM A                                      25190099
                        ,TRECDIS B                                      25200099
                  WHERE  A.ORD_NBR = :ASC-KEY-PO-NBR                    25210099
                    AND  A.VER_STATUS_CDE = 'A'                         25220099
                    AND  A.OPER_UNT_ID = :PC-DCX                        25230099
                    AND  A.STATUS_CDE = 'VE'                            25240099
                    AND  A.ORD_NBR = B.ORD_NBR                          25250099
                    AND  A.ORD_LNE_NBR = B.ORD_LNE_NBR                  25260099
                    AND  A.REC_SEQ_NBR = B.REC_SEQ_NBR                  25270099
                    AND  A.OPER_UNT_ID = B.OPER_UNT_ID                  25280099
                    AND  A.FCLTY_ID = B.FCLTY_ID                        25290099
                    AND  B.VER_STATUS_CDE = 'A'                         25300099
                    AND  A.PREPK_ID = :PC-PREPACKX                      25310099
               END-EXEC                                                 25320099
                                                                        25330099
               EVALUATE TRUE                                            25340099
                   WHEN SQLCODE = ZERO                                  25350099
                       CONTINUE                                         25360099
                   WHEN SQLCODE = +100                                  25370099
                       MOVE +0 TO PV-DC-REC-QTY                         25380099
                   WHEN SQLCODE = -904                                  25390099
                   WHEN SQLCODE = -913                                  25400099
                       CONTINUE                                         25410099
                   WHEN SQLWARN0 NOT = SPACES                           25420099
                   WHEN SQLCODE < ZERO                                  25430099
                   WHEN SQLCODE > ZERO                                  25440099
                       MOVE '4353-GET-VERIFIED-UNITS'                   25450099
                                           TO DP013-PARAGRAPH           25460099
                       MOVE 'RETRIEVING VERIFIED UNITS'                 25470099
                                           TO DP013-MESSAGE-TEXT (1)    25480099
                       MOVE SQLCA          TO DP013-SQLCA               25490099
                       MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)  25500099
                       MOVE 'TRECDIS'      TO DP013-DB2-TABLE-NAME (2)  25510099
                       MOVE 'TPURITM'      TO DP013-DB2-TABLE-NAME (3)  25520099
                       SET DP013-DB2-ABEND                              25530099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           25540099
                       PERFORM DP013-0000-PROCESS-ABEND                 25550099
               END-EVALUATE                                             25560099
           END-PERFORM.                                                 25570099
                                                                        25580099
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         25590099
              MOVE '4353-GET-VERIFIED-UNITS'                            25600099
                                            TO DP013-PARAGRAPH          25610099
              MOVE 'MAXIMUM RETRIES EXCEEDED'                           25620099
                                            TO DP013-MESSAGE-TEXT (1)   25630099
              MOVE SQLCA                    TO DP013-SQLCA              25640099
              MOVE 'TRECITM'                TO DP013-DB2-TABLE-NAME (1) 25650099
              MOVE 'TRECIDS'                TO DP013-DB2-TABLE-NAME (2) 25660099
              MOVE 'TPURITM'                TO DP013-DB2-TABLE-NAME (3) 25670099
              SET DP013-DB2-ABEND                                       25680099
                  DP013-XCTL-DISPLAY-RESTART                            25690099
                                            TO TRUE                     25700099
              PERFORM DP013-0000-PROCESS-ABEND                          25710099
           END-IF.                                                      25720099
      *----------------------------------------------------------------*25730099
      * GET VERIFIED UNIT CARTON COUNT                                 *25740099
      *----------------------------------------------------------------*25750099
                                                                        25760099
       4364-GET-VER-UNT-CRTN-COUNT.                                     25770099
                                                                        25780099
           DIVIDE PV-DC-REC-QTY                                         25790099
           BY ASC-INPK-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                25800099
           GIVING PV-QUOTIENT                                           25810099
           REMAINDER PV-REMAINDER                                       25820099
           IF PV-REMAINDER = ZEROES                                     25830099
              IF ASC-PREPK-TYP-CDE (ASC-BLK-SUB ASC-ITEM-SUB) = 'I'     25840099
                 COMPUTE PV-INNER-PKS =                                 25850099
                 ASC-OTPK-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)/            25860099
                 ASC-INPK-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)             25870099
                 DIVIDE PV-QUOTIENT BY PV-INNER-PKS                     25880099
                 GIVING PV-CRTN-CNT                                     25890099
                 REMAINDER PV-REMAINDER                                 25900099
              ELSE                                                      25910099
                 MOVE PV-QUOTIENT TO PV-CRTN-CNT                        25920099
              END-IF                                                    25930099
           ELSE                                                         25940099
              CONTINUE                                                  25950099
           END-IF                                                       25960099
           IF PV-REMAINDER = ZEROES                                     25970099
              MOVE PV-CRTN-CNT TO                                       25980099
              ASC-DC-RECD-CRTNS(ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)   25990099
              INSPECT ASC-DC-RECD-CRTNS                                 26000099
                               (ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)   26010099
              REPLACING LEADING '0' BY ' '                              26020099
           ELSE                                                         26030099
              MOVE 'INVLD' TO                                           26040099
              ASC-DC-RECD-CRTNS (ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)  26050099
           END-IF.                                                      26060099
391100/                                                                 26070099
391200*----------------------------------------------------------------*26080099
391300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *26090099
391400*----------------------------------------------------------------*26100099
391500                                                                  26110099
391600 4400-MOVE-COMMAREA-TO-SCREEN.                                    26120099
391700                                                                  26130099
391800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             26140099
391900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          26150099
392000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          26160099
392100             MOVE +1               TO ASC-BLK-SUB                 26170099
392200             PERFORM 5100-WRITE-TEMP-STORAGE                      26180099
392300             ADD +1                TO ASC-BLK-SUB                 26190099
392400             PERFORM 5100-WRITE-TEMP-STORAGE                      26200099
392500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             26210099
392600                 GIVING PV-BLOCK-NUMBER                           26220099
392700                 REMAINDER PV-REMAINDER                           26230099
392800             IF  PV-REMAINDER > ZERO                              26240099
392900                 ADD +1            TO PV-BLOCK-NUMBER             26250099
393000             END-IF                                               26260099
393100             MOVE +1               TO ASC-BLK-SUB                 26270099
393200             PERFORM 4410-READ-TEMP-STORAGE                       26280099
393300             ADD +1                TO ASC-BLK-SUB                 26290099
393400                                      PV-BLOCK-NUMBER             26300099
393500             PERFORM 4410-READ-TEMP-STORAGE                       26310099
393600     END-IF.                                                      26320099
393700                                                                  26330099
393800     MOVE +1                       TO ASC-BLK-SUB.                26340099
393900                                                                  26350099
394000     COMPUTE ASC-ITEM-SUB =                                       26360099
394100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              26370099
394200         + PC-ITEMS-PER-PANEL).                                   26380099
394300                                                                  26390099
394400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        26400099
394500         ADD +1                    TO ASC-BLK-SUB                 26410099
394600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            26420099
394700     END-IF.                                                      26430099
394800                                                                  26440099
394900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           26450099
395000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                26460099
395100                                                                  26470099
395200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        26480099
395300     PERFORM 4420-FORMAT-LIST-LINES                               26490099
395400         VARYING PV-SUB                                           26500099
395500         FROM PC-ITEMS-PER-PANEL BY -1                            26510099
395600         UNTIL PV-SUB < +1.                                       26520099
395700                                                                  26530099
395800     COMPUTE ASC-ITEMS-DISPLAYED =                                26540099
395900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          26550099
396000                                                                  26560099
396100     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    26570099
396200                                      ASTRTITO.                   26580099
396400     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    26590099
396500     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    26600099
396600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26610099
396700                                   TO ASELITO.                    26620099
396300                                                                  26630099
           MOVE ASC-KEY-PO-NBR TO APONUMO                               26640099
                                                                        26650099
            MOVE ASC-DC-NBR(ASC-DC-COUNTER + 1) TO MR-DC1-NBR           26660099
            MOVE ASC-DC-NAME(ASC-DC-COUNTER + 1) TO MR-DC1-SHORT-NAME   26670099
            IF MR-DC1-NBR = '000'                                       26680099
               MOVE SPACES TO MR-DC1-NAME                               26690099
            ELSE                                                        26700099
               MOVE MR-DC-NAME1 TO MR-DC1-NAME                          26710099
            END-IF                                                      26720099
396800                                                                  26730099
           MOVE ASC-DC-NBR(ASC-DC-COUNTER + 2)  TO MR-DC2-NBR           26740099
           MOVE ASC-DC-NAME(ASC-DC-COUNTER + 2) TO MR-DC2-SHORT-NAME    26750099
           IF MR-DC2-NBR = '000'                                        26760099
              MOVE SPACES TO MR-DC2-NAME                                26770099
           ELSE                                                         26780099
              MOVE MR-DC-NAME2 TO MR-DC2-NAME                           26790099
           END-IF                                                       26800099
                                                                        26810099
400600     IF  DP020-MSG-NUMBER-X = SPACE                               26820099
400700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  26830099
400800*            --- MORE ITEMS TO DISPLAY ----                       26840099
400900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            26850099
401000             SET DP020-MSG-INFORMATIONAL                          26860099
401100                                   TO TRUE                        26870099
401200         END-IF                                                   26880099
401300     END-IF.                                                      26890099
401400                                                                  26900099
401500*----------------------------------------------------------------*26910099
401600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *26920099
401700*----------------------------------------------------------------*26930099
401800                                                                  26940099
401900 4410-READ-TEMP-STORAGE.                                          26950099
402000                                                                  26960099
402100     EXEC CICS                                                    26970099
402200         READQ TS                                                 26980099
402300             QUEUE (ASC-LIST-QUEUE-NAME)                          26990099
402400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27000099
402500             ITEM  (PV-BLOCK-NUMBER)                              27010099
402600             RESP  (PV-CICS-RESP)                                 27020099
402700     END-EXEC.                                                    27030099
402800                                                                  27040099
402900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       27050099
403000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     27060099
403100         CONTINUE                                                 27070099
403200     ELSE                                                         27080099
403300         SET DP013-CICS-ABEND      TO TRUE                        27090099
403400         SET DP013-NO-ROLLBACK     TO TRUE                        27100099
403500         MOVE '4410-READ-TEMP-STORAGE'                            27110099
403600                                   TO DP013-PARAGRAPH             27120099
403700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      27130099
403800                                   TO DP013-MESSAGE-TEXT(1)       27140099
403900         PERFORM DP013-0000-PROCESS-ABEND                         27150099
404000     END-IF.                                                      27160099
404100                                                                  27170099
404200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      27180099
404300                                   TO TRUE.                       27190099
404400                                                                  27200099
404500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         27210099
404600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               27220099
404700     END-IF.                                                      27230099
404800/                                                                 27240099
404900*----------------------------------------------------------------*27250099
405000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *27260099
405100*----------------------------------------------------------------*27270099
405200                                                                  27280099
405300 4420-FORMAT-LIST-LINES.                                          27290099
405400                                                                  27300099
405500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      27310099
405600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                27320099
405700         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         27330099
405800         MOVE SPACES               TO MR-SELECT  (PV-SUB)         27340099
                                            MR-PACK-ID-X (PV-SUB)       27350099
406700                                      MR-LINE-AREA-DC1 (PV-SUB)   27360099
406700                                      MR-LINE-AREA-DC2 (PV-SUB)   27370099
406800     ELSE                                                         27380099
406900         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27390099
407000                                                   > SPACE        27400099
407100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 27410099
407200                                   TO MR-SELECT (PV-SUB)          27420099
407300         ELSE                                                     27430099
407400             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      27440099
407500                                   TO MR-SELECT (PV-SUB)          27450099
407600         END-IF                                                   27460099
407700                                                                  27470099
407800         IF  DP030-SET-CURSOR-TRAILER                             27480099
407900             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)27490099
408000                 > SPACE)                                         27500099
408100               OR (PV-SUB = 1))                                   27510099
408200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               27520099
408300                MOVE -1            TO MR-SELECTL (PV-SUB)         27530099
408400             END-IF                                               27540099
408500         END-IF                                                   27550099
408600                                                                  27560099
                   MOVE ASC-PACK-ID (ASC-BLK-SUB ASC-ITEM-SUB)          27570099
                                         TO MR-PACK-ID (PV-SUB)         27580099
                   MOVE ASC-DC-ONORD-CRTNS                              27590099
                   (ASC-BLK-SUB ASC-ITEM-SUB 1) TO                      27600099
                                            PV-DC1-CRTNS-ONORD-X        27610099
                                                                        27620099
                   MOVE ASC-DC-ONORD-UNITS                              27630099
                   (ASC-BLK-SUB ASC-ITEM-SUB 1) TO                      27640099
                                            PV-DC1-UNITS-ONORD-X        27650099
                                                                        27660099
                   MOVE ASC-DC-RECD-CRTNS                               27670099
                   (ASC-BLK-SUB ASC-ITEM-SUB 1) TO                      27680099
                                           PV-DC1-CRTNS-RECD-X          27690099
                   INSPECT PV-DC1-CRTNS-RECD-X                          27700099
                   REPLACING LEADING '0' BY ' '                         27710099
                                                                        27720099
                   MOVE ASC-DC-RECD-UNITS                               27730099
                   (ASC-BLK-SUB ASC-ITEM-SUB 1) TO                      27740099
                                           PV-DC1-UNITS-RECD-X          27750099
                   INSPECT PV-DC1-UNITS-RECD-X                          27760099
                   REPLACING LEADING '0' BY ' '                         27770099
                                                                        27780099
                   IF ASC-DC-NBR(ASC-DC-COUNTER + 1) = 0                27790099
                      MOVE SPACES TO MR-LINE-AREA-DC1(PV-SUB)           27800099
                   ELSE                                                 27810099
                      MOVE PV-DC1-LINE TO MR-LINE-AREA-DC1(PV-SUB)      27820099
                                                                        27830099
                   MOVE ASC-DC-ONORD-CRTNS                              27840099
                   (ASC-BLK-SUB ASC-ITEM-SUB 2) TO                      27850099
                                            PV-DC2-CRTNS-ONORD-X        27860099
                                                                        27870099
                   MOVE ASC-DC-ONORD-UNITS                              27880099
                   (ASC-BLK-SUB ASC-ITEM-SUB 2) TO                      27890099
                                            PV-DC2-UNITS-ONORD-X        27900099
                                                                        27910099
                   MOVE ASC-DC-RECD-CRTNS                               27920099
                   (ASC-BLK-SUB ASC-ITEM-SUB 2) TO                      27930099
                                           PV-DC2-CRTNS-RECD-X          27940099
                                                                        27950099
                   MOVE ASC-DC-RECD-UNITS                               27960099
                   (ASC-BLK-SUB ASC-ITEM-SUB 2) TO                      27970099
                                           PV-DC2-UNITS-RECD-X          27980099
                   END-IF                                               27990099
                   IF ASC-DC-NBR(ASC-DC-COUNTER + 2) = 0                28000099
                      MOVE SPACES TO MR-LINE-AREA-DC2(PV-SUB)           28010099
                   ELSE                                                 28020099
                      MOVE PV-DC2-LINE TO MR-LINE-AREA-DC2(PV-SUB)      28030099
                   END-IF                                               28040099
                                                                        28050099
                                                                        28060099
411000                                                                  28070099
411700     END-IF.                                                      28080099
411800                                                                  28090099
411900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               28100099
412000                                                                  28110099
412100     IF  ASC-ITEM-SUB < + 1                                       28120099
412200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                28130099
412300         MOVE +1                   TO ASC-BLK-SUB                 28140099
412400     END-IF.                                                      28150099
412500                                                                  28160099
418500                                                                  28170099
418600*----------------------------------------------------------------*28180099
418700*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *28190099
418800*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *28200099
418900*  ISSUE A WARNING.                                              *28210099
419000*----------------------------------------------------------------*28220099
419100 4430-CHECK-FOR-BEGIN-AND-END.                                    28230099
419200                                                                  28240099
419300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       28250099
419400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     28260099
419500*            -- NO END-OF-RANGE SPECFIED ---                      28270099
419600             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            28280099
419700             SET DP020-MSG-WARNING TO TRUE                        28290099
419800             PERFORM 4431-POSITION-AT-WARNING                     28300099
419900         END-IF                                                   28310099
420000     ELSE                                                         28320099
420100         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     28330099
420200*            -- NO BEGINNING-OF-RANGE SPECFIED ---                28340099
420300             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            28350099
420400             SET DP020-MSG-WARNING TO TRUE                        28360099
420500             PERFORM 4431-POSITION-AT-WARNING                     28370099
420600         END-IF                                                   28380099
420700     END-IF.                                                      28390099
420800                                                                  28400099
420900*----------------------------------------------------------------*28410099
421000*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *28420099
421100*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *28430099
421200*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *28440099
421300*  POSITION THE CURSOR THERE.                                    *28450099
421400*----------------------------------------------------------------*28460099
421500 4431-POSITION-AT-WARNING.                                        28470099
421600                                                                  28480099
421700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 28490099
421800                    - PV-TOP-ITEM + 1.                            28500099
421900                                                                  28510099
422000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28520099
422100         CONTINUE                                                 28530099
422200     ELSE                                                         28540099
422300         SET DP030-SET-CURSOR-APPL-1                              28550099
422400                                   TO TRUE                        28560099
422500         MOVE -1                   TO MR-SELECTL (PV-SUB)         28570099
422600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         28580099
422700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         28590099
422800     END-IF.                                                      28600099
422900                                                                  28610099
423000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   28620099
423100                    - PV-TOP-ITEM + 1.                            28630099
423200                                                                  28640099
423300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      28650099
423400         CONTINUE                                                 28660099
423500     ELSE                                                         28670099
423600         SET DP030-SET-CURSOR-APPL-1                              28680099
423700                                   TO TRUE                        28690099
423800         MOVE -1                   TO MR-SELECTL (PV-SUB)         28700099
423900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         28710099
424000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         28720099
424100     END-IF.                                                      28730099
424200                                                                  28740099
424300/                                                                 28750099
424400*----------------------------------------------------------------*28760099
424500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *28770099
424600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *28780099
424700* FOR THE SELECTED ITEMS QUEUE.                                  *28790099
424800*                                                                *28800099
424900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *28810099
425000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *28820099
425100* THE ARRAY IS FULL.                                             *28830099
425200*----------------------------------------------------------------*28840099
425300                                                                  28850099
425400 5000-PREPARE-SEL-QUEUE.                                          28860099
425500                                                                  28870099
425600     MOVE +1                       TO ASC-BLK-SUB.                28880099
425700     PERFORM 5100-WRITE-TEMP-STORAGE.                             28890099
425800     ADD +1                        TO ASC-BLK-SUB.                28900099
425900     PERFORM 5100-WRITE-TEMP-STORAGE.                             28910099
426000                                                                  28920099
426100     MOVE ASC-SEL-QUEUE-NAME       TO PO013-SEL-QUEUE-NAME.       28930099
426200     PERFORM 6010-DELETE-SEL-QUEUE.                               28940099
426300                                                                  28950099
426400     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      28960099
426500         SET ASC-UPDATE-TSQ        TO TRUE                        28970099
426600     END-IF.                                                      28980099
426700                                                                  28990099
426800     SET PO012-IDX                 TO 1.                          29000099
426900     MOVE ZERO                     TO PO013-NUMBER-OF-TS-ITEMS.   29010099
427000     INITIALIZE PO012-SELECTED-ITEM-ARRAY.                        29020099
427100                                                                  29030099
427200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           29040099
427300             VARYING PV-ITEM                                      29050099
427400             FROM 1 BY 1                                          29060099
427500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     29070099
427600                                                                  29080099
427700     IF  PO012-IDX > 1                                            29090099
427800         PERFORM 5205-WRITE-SEL-QUEUE                             29100099
427900         ADD +1                    TO PO013-NUMBER-OF-TS-ITEMS    29110099
428000     END-IF.                                                      29120099
428100                                                                  29130099
428200/                                                                 29140099
428300*----------------------------------------------------------------*29150099
428400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *29160099
428500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *29170099
428600*----------------------------------------------------------------*29180099
428700                                                                  29190099
428800 5100-WRITE-TEMP-STORAGE.                                         29200099
428900                                                                  29210099
429000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     29220099
429100                                   TO PV-LIST-ITEM-NUMBER.        29230099
429200     COMPUTE PV-BLOCK-NUMBER =                                    29240099
429300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    29250099
429400                                                                  29260099
429500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             29270099
429600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             29280099
429700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      29290099
429800             PERFORM 5105-REWRITE-ASC-LISTQ                       29300099
429900         END-IF                                                   29310099
430000     ELSE                                                         29320099
430100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       29330099
430200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            29340099
430300         PERFORM 5110-WRITE-ASC-LISTQ                             29350099
430400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   29360099
430500     END-IF.                                                      29370099
430600                                                                  29380099
430700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      29390099
430800                                   TO TRUE.                       29400099
430900                                                                  29410099
431000/                                                                 29420099
431100*----------------------------------------------------------------*29430099
431200*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *29440099
431300*  SPECIFIC COMMAREA.                                            *29450099
431400*----------------------------------------------------------------*29460099
431500 5105-REWRITE-ASC-LISTQ.                                          29470099
431600                                                                  29480099
431700     EXEC CICS                                                    29490099
431800         WRITEQ TS                                                29500099
431900             QUEUE (ASC-LIST-QUEUE-NAME)                          29510099
432000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               29520099
432100             ITEM  (PV-BLOCK-NUMBER)                              29530099
432200             REWRITE                                              29540099
432300             RESP  (PV-CICS-RESP)                                 29550099
432400     END-EXEC.                                                    29560099
432500                                                                  29570099
432600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           29580099
432700         CONTINUE                                                 29590099
432800     ELSE                                                         29600099
432900         SET DP013-CICS-ABEND      TO TRUE                        29610099
433000         SET DP013-NO-ROLLBACK     TO TRUE                        29620099
433100         MOVE '5105-REWRITE-ASC-LISTQ'                            29630099
433200                                   TO DP013-PARAGRAPH             29640099
433300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     29650099
433400                                   TO DP013-MESSAGE-TEXT(1)       29660099
433500         PERFORM DP013-0000-PROCESS-ABEND                         29670099
433600     END-IF.                                                      29680099
433700                                                                  29690099
433800/                                                                 29700099
433900*----------------------------------------------------------------*29710099
434000*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *29720099
434100*  SPECIFIC COMMAREA.                                            *29730099
434200*----------------------------------------------------------------*29740099
434300 5110-WRITE-ASC-LISTQ.                                            29750099
434400                                                                  29760099
434500     EXEC CICS                                                    29770099
434600         WRITEQ TS                                                29780099
434700             QUEUE (ASC-LIST-QUEUE-NAME)                          29790099
434800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               29800099
434900             ITEM  (PV-BLOCK-NUMBER)                              29810099
435000             RESP  (PV-CICS-RESP)                                 29820099
435100     END-EXEC.                                                    29830099
435200                                                                  29840099
435300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      29850099
435400         SET DP013-CICS-ABEND      TO TRUE                        29860099
435500         SET DP013-NO-ROLLBACK     TO TRUE                        29870099
435600         MOVE '5110-WRITE-ASC-LISTQ'                              29880099
435700                                   TO DP013-PARAGRAPH             29890099
435800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           29900099
435900                                   TO DP013-MESSAGE-TEXT(1)       29910099
436000         PERFORM DP013-0000-PROCESS-ABEND                         29920099
436100     END-IF.                                                      29930099
436200                                                                  29940099
436300/                                                                 29950099
436400*----------------------------------------------------------------*29960099
436500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *29970099
436600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *29980099
436700*----------------------------------------------------------------*29990099
436800                                                                  30000099
436900 5200-FILL-SEL-QUEUE-RECORD.                                      30010099
437000                                                                  30020099
437100     PERFORM 6112-READ-LIST-QUEUE.                                30030099
437200                                                                  30040099
437300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       30050099
437400         PERFORM                                                  30060099
437500         VARYING LQW-IDX                                          30070099
437600         FROM 1 BY 1                                              30080099
437700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            30090099
437800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          30100099
437900                                                                  30110099
438000             IF  LQW-SELECT (LQW-IDX)                             30120099
438100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              30130099
438200                                   TO PO012-ITEM (PO012-IDX)      30140099
438300                 MOVE LQW-PACK-ID (LQW-IDX)                       30150099
438400                           TO PO012-PACK-ID (PO012-IDX)           30160099
438500                 MOVE 'I'          TO PO012-ACTION-SW (PO012-IDX) 30170099
438600                 SET PO012-IDX UP BY 1                            30180099
438700                 IF  PO012-IDX > PO012-MAX-ITEMS                  30190099
438800                     PERFORM 5205-WRITE-SEL-QUEUE                 30200099
438900                     ADD +1        TO PO013-NUMBER-OF-TS-ITEMS    30210099
439000                     INITIALIZE PO012-SELECTED-ITEM-ARRAY         30220099
439100                     SET PO012-IDX TO 1                           30230099
439200                 END-IF                                           30240099
439300             END-IF                                               30250099
439400         END-PERFORM                                              30260099
439500     END-IF.                                                      30270099
439600                                                                  30280099
439700/                                                                 30290099
439800*----------------------------------------------------------------*30300099
439900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *30310099
440000*----------------------------------------------------------------*30320099
440100                                                                  30330099
440200 5205-WRITE-SEL-QUEUE.                                            30340099
440300                                                                  30350099
440400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            30360099
440500                                   TO PO012-SELECTED-ITEMS.       30370099
440600                                                                  30380099
440700     EXEC CICS                                                    30390099
440800          WRITEQ TS                                               30400099
440900              QUEUE (ASC-SEL-QUEUE-NAME)                          30410099
441000              FROM  (PO012-PO-SELECT-RECORD)                      30420099
441100              ITEM  (PV-SEL-QUEUE-ITEM)                           30430099
441200              RESP  (PV-CICS-RESP)                                30440099
441300     END-EXEC.                                                    30450099
441400                                                                  30460099
441500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          30470099
441600         CONTINUE                                                 30480099
441700     ELSE                                                         30490099
441800         SET DP013-CICS-ABEND      TO TRUE                        30500099
441900         SET DP013-NO-ROLLBACK     TO TRUE                        30510099
442000         MOVE '5205-WRITE-SEL-QUEUE'                              30520099
442100                                   TO DP013-PARAGRAPH             30530099
442200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          30540099
442300                                   TO DP013-MESSAGE-TEXT(1)       30550099
442400         PERFORM DP013-0000-PROCESS-ABEND                         30560099
442500     END-IF.                                                      30570099
442600                                                                  30580099
442700/                                                                 30590099
442800*----------------------------------------------------------------*30600099
442900*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *30610099
443000*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *30620099
443100*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *30630099
443200*  THE USER.                                                     *30640099
443300*----------------------------------------------------------------*30650099
443400 6000-REFRESH-PANEL-FROM-TEMP.                                    30660099
443500                                                                  30670099
443600     IF  ASC-UPDATE-TSQ                                           30680099
443700         SET ASC-NO-TSQ-UPDATE     TO TRUE                        30690099
443800         MOVE ZERO                 TO PV-SAVE-ITEM                30700099
443900                                      PV-SEL-QUEUE-ITEM           30710099
444000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        30720099
444100                                   TO PV-HOLD-SELECTED-ITEMS      30730099
444200                                                                  30740099
444300         PERFORM 6100-UPDATE-TSQ                                  30750099
444400             UNTIL PV-ITEMS-PROCESSED >                           30760099
444500                                     ASC-NUMBER-OF-SELECTED-ITEMS 30770099
444600         PERFORM 6010-DELETE-SEL-QUEUE                            30780099
444700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         30790099
444800                    ASC-BLOCK-ENTRIES (2)                         30800099
444900     END-IF.                                                      30810099
445000                                                                  30820099
445100/                                                                 30830099
445200*----------------------------------------------------------------*30840099
445300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *30850099
445400*----------------------------------------------------------------*30860099
445500 6010-DELETE-SEL-QUEUE.                                           30870099
445600                                                                  30880099
445700     EXEC CICS                                                    30890099
445800         DELETEQ TS                                               30900099
445900             QUEUE (ASC-SEL-QUEUE-NAME)                           30910099
446000             RESP  (PV-CICS-RESP)                                 30920099
446100     END-EXEC.                                                    30930099
446200                                                                  30940099
446300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      30950099
446400         (PV-CICS-RESP = DFHRESP(QIDERR)))                        30960099
446500         CONTINUE                                                 30970099
446600     ELSE                                                         30980099
446700         SET DP013-CICS-ABEND      TO TRUE                        30990099
446800         SET DP013-NO-ROLLBACK     TO TRUE                        31000099
446900         MOVE '6010-DELETE-SEL-QUEUE'                             31010099
447000                                   TO DP013-PARAGRAPH             31020099
447100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         31030099
447200                                   TO DP013-MESSAGE-TEXT (1)      31040099
447300         PERFORM DP013-0000-PROCESS-ABEND                         31050099
447400     END-IF.                                                      31060099
447500                                                                  31070099
447600/                                                                 31080099
447700*----------------------------------------------------------------*31090099
447800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *31100099
447900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *31110099
448000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *31120099
448100*    THE TEMP QUEUE.                                             *31130099
448200*----------------------------------------------------------------*31140099
448300                                                                  31150099
448400 6100-UPDATE-TSQ.                                                 31160099
448500                                                                  31170099
448600     ADD 1                         TO PV-SEL-QUEUE-ITEM.          31180099
448700     PERFORM 6105-READ-SEL-QUEUE.                                 31190099
448800                                                                  31200099
448900     PERFORM                                                      31210099
449000         VARYING PO012-IDX                                        31220099
449100         FROM 1 BY 1                                              31230099
449200         UNTIL ((PV-ITEMS-PROCESSED >                             31240099
449300                              PV-HOLD-SELECTED-ITEMS)             31250099
449400         OR (PO012-IDX GREATER THAN PO012-MAX-ITEMS))             31260099
449500         IF  PO012-ACTION-SW (PO012-IDX) > SPACE                  31270099
449600             PERFORM 6110-PROCESS-ITEMS                           31280099
449700         END-IF                                                   31290099
449800         ADD +1                    TO PV-ITEMS-PROCESSED          31300099
449900     END-PERFORM.                                                 31310099
450000                                                                  31320099
450100     PERFORM 6111-WRITE-LIST-QUEUE.                               31330099
450200                                                                  31340099
450300/                                                                 31350099
450400*----------------------------------------------------------------*31360099
450500*    READ THE LIST QUEUE RECORD.                                 *31370099
450600*----------------------------------------------------------------*31380099
450700                                                                  31390099
450800 6105-READ-SEL-QUEUE.                                             31400099
450900                                                                  31410099
451000     EXEC CICS                                                    31420099
451100          READQ TS                                                31430099
451200              QUEUE (ASC-SEL-QUEUE-NAME)                          31440099
451300              INTO  (PO012-PO-SELECT-RECORD)                      31450099
451400              ITEM  (PV-SEL-QUEUE-ITEM)                           31460099
451500              RESP  (PV-CICS-RESP)                                31470099
451600     END-EXEC.                                                    31480099
451700                                                                  31490099
451800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31500099
451900         CONTINUE                                                 31510099
452000     ELSE                                                         31520099
452100         SET DP013-CICS-ABEND      TO TRUE                        31530099
452200         SET DP013-NO-ROLLBACK     TO TRUE                        31540099
452300         MOVE '6105-READ-SEL-QUEUE'                               31550099
452400                                   TO DP013-PARAGRAPH             31560099
452500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           31570099
452600                                   TO DP013-MESSAGE-TEXT(1)       31580099
452700         PERFORM DP013-0000-PROCESS-ABEND                         31590099
452800     END-IF.                                                      31600099
452900                                                                  31610099
453000/                                                                 31620099
453100*----------------------------------------------------------------*31630099
453200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*31640099
453300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*31650099
453400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *31660099
453500*----------------------------------------------------------------*31670099
453600                                                                  31680099
453700 6110-PROCESS-ITEMS.                                              31690099
453800                                                                  31700099
453900     COMPUTE PV-ITEM = 1 + ((PO012-ITEM (PO012-IDX) - 1)          31710099
454000                     / PC-ITEMS-PER-PANEL).                       31720099
454100                                                                  31730099
454200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           31740099
454300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          31750099
454400             PERFORM 6111-WRITE-LIST-QUEUE                        31760099
454500         END-IF                                                   31770099
454600         MOVE PV-ITEM              TO PV-SAVE-ITEM                31780099
454700                                                                  31790099
454800         PERFORM 6112-READ-LIST-QUEUE                             31800099
454900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               31810099
455000             CONTINUE                                             31820099
455100         END-IF                                                   31830099
455200     END-IF.                                                      31840099
455300                                                                  31850099
455400     COMPUTE PV-SUB = (PO012-ITEM (PO012-IDX)                     31860099
455500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              31870099
455600                                                                  31880099
455700     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       31890099
455800     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        31900099
455900                                     (PV-SUB).                    31910099
456000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                31920099
456100                                                                  31930099
456200/                                                                 31940099
456300*----------------------------------------------------------------*31950099
456400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *31960099
456500*----------------------------------------------------------------*31970099
456600                                                                  31980099
456700 6111-WRITE-LIST-QUEUE.                                           31990099
456800                                                                  32000099
456900     EXEC CICS                                                    32010099
457000         WRITEQ TS                                                32020099
457100             QUEUE (ASC-LIST-QUEUE-NAME)                          32030099
457200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     32040099
457300             ITEM  (PV-SAVE-ITEM)                                 32050099
457400             REWRITE                                              32060099
457500             RESP  (PV-CICS-RESP)                                 32070099
457600     END-EXEC.                                                    32080099
457700                                                                  32090099
457800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32100099
457900         CONTINUE                                                 32110099
458000     ELSE                                                         32120099
458100         SET DP013-CICS-ABEND      TO TRUE                        32130099
458200         SET DP013-NO-ROLLBACK     TO TRUE                        32140099
458300         MOVE '6111-WRITE-LIST-QUEUE'                             32150099
458400                                   TO DP013-PARAGRAPH             32160099
458500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  32170099
458600                                   TO DP013-MESSAGE-TEXT(1)       32180099
458700         PERFORM DP013-0000-PROCESS-ABEND                         32190099
458800     END-IF.                                                      32200099
458900                                                                  32210099
459000/                                                                 32220099
459100*----------------------------------------------------------------*32230099
459200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*32240099
459300*----------------------------------------------------------------*32250099
459400                                                                  32260099
459500 6112-READ-LIST-QUEUE.                                            32270099
459600                                                                  32280099
459700     EXEC CICS                                                    32290099
459800         READQ TS                                                 32300099
459900             QUEUE (ASC-LIST-QUEUE-NAME)                          32310099
460000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     32320099
460100             ITEM  (PV-ITEM)                                      32330099
460200             RESP  (PV-CICS-RESP)                                 32340099
460300     END-EXEC.                                                    32350099
460400                                                                  32360099
460500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32370099
460600         CONTINUE                                                 32380099
460700     ELSE                                                         32390099
460800         SET DP013-CICS-ABEND      TO TRUE                        32400099
460900         SET DP013-NO-ROLLBACK     TO TRUE                        32410099
461000         MOVE '6112-READ-LIST-QUEUE'                              32420099
461100                                   TO DP013-PARAGRAPH             32430099
461200         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    32440099
461300                                   TO DP013-MESSAGE-TEXT(1)       32450099
461400         PERFORM DP013-0000-PROCESS-ABEND                         32460099
461500     END-IF.                                                      32470099
461600                                                                  32480099
461700/                                                                 32490099
461800*----------------------------------------------------------------*32500099
461900*    ABEND PROCESSOR MODULE                                      *32510099
462000*----------------------------------------------------------------*32520099
462100                                                                  32530099
462200     COPY DPPD013.                                                32540099
