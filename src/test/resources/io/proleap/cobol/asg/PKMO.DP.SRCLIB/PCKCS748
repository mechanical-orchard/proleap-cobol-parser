000100*-----------------------*                                         00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030002
000400 PROGRAM-ID.    PCKCS748.                                         00040002
000500 AUTHOR.        DEANNA BRANTNER                                   00050002
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060002
000700 DATE-WRITTEN.  NOVEMBER, 2001.                                   00070002
000800 DATE-COMPILED.                                                   00080073
000900*----------------------------------------------------------------*00090002
001000*    S748 - PC - UNITS WORKED - CRITERIA SPECIFICATION SCREEN    *00100002
001100*----------------------------------------------------------------*00110074
001110* DATE  11/04/2021                                                00111099
001120*            - CHANGE CALL OF 'DPKUT100' TO                     * 00112099
001130*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00113099
001140*              MAKING THE CALL DYNAMIC VS STATIC                * 00114099
001150*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00115099
001160*-----------------------------------------------------------------00116099
1122RM* DATE  11/07/2022                                              * 00117099
1122RM*            - ADD COPYBOOK DPWS930                             * 00118099
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00119099
1122RM*              DYNAMIC.                                         * 00119199
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00119299
1122RM*-----------------------------------------------------------------00119399
001200 ENVIRONMENT DIVISION.                                            00120074
001300 DATA DIVISION.                                                   00130074
001400                                                                  00140074
001500 WORKING-STORAGE SECTION.                                         00150074
001600*----------------------------------------------------------------*00160074
001700*   PROGRAM CONSTANTS                                            *00170074
001800*----------------------------------------------------------------*00180074
001900 01  PC-PROGRAM-CONSTANTS.                                        00190074
002000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'PC748A  '.  00200074
002100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'PCKM748 '.  00210074
002200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'PCKCS748'.  00220074
002201     05  PC-REPORT-PGM             PIC  X(08)  VALUE 'PCKCS011'.  00220199
002202     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00220299
002300     05  PC-OP-CO-NBR              PIC  X(02)  VALUE '03'.        00230074
002400     05  PC-000                    PIC  X(03)  VALUE '000'.       00240074
002500     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE  0001.       00250074
002600     05  PC-01                     PIC  X(02)  VALUE '01'.        00260074
002700     05  PC-3                      PIC  S9(4) COMP VALUE 3.       00270074
002800     05  PC-85                     PIC  9(04)  VALUE 0085.        00280074
002900     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE 'DPKUT500'.  00290074
003000     05  PC-ALL                    PIC  X(04)  VALUE 'ALL '.      00300074
003010     05  PC-MGMX                   PIC  X(04)  VALUE 'MGMX'.      00301099
003100     05  PC-A                      PIC  X(01)  VALUE 'A'.         00310074
003101     05  PC-S                      PIC  X(01)  VALUE 'S'.         00310199
003110     05  PC-TIMEZN                 PIC  X(06)  VALUE 'TIMEZN'.    00311074
003111     05  PC-POHIST                 PIC  X(06)  VALUE 'POHIST'.    00311199
003120                                                                  00312074
003130*-----------------------------------------------------------------00313074
003140*  DB2 KEYS                                                       00314074
003150*-----------------------------------------------------------------00315074
003160 01  DB-KEYS.                                                     00316074
003170     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.00317074
003180                                                                  00318074
003190*----------------------------------------------------------------*00319074
003200*  SYSTEM MESSAGES                                               *00320074
003300*----------------------------------------------------------------*00330074
003400*   00005 = INVALID VALUE                                         00340074
003500*   00007 = REQUIRED ENTRY                                        00350074
003600*   00008 = MUST BE NUMERIC                                       00360074
003700*   00009 = INVALID DATE                                          00370074
003800*   00045 = INVALID FUNCTION KEY                                  00380074
003810*   00397 = ENTER AN 'S' TO SELECT                                00381099
003820*   00746 = INVALID PRINTER DESTINATION                           00382099
003900*   00973 = ONLY ONE MAY BE SELECTED.                             00390074
004000*   21040 = YOU ARE NOT AUTHORIZED TO VIEW THIS DATA              00400074
004100*   02221 = CREATE FROM DATE MUST BE BEFORE CREATE TO DATE        00410074
004200*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                  00420074
004300*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          00430074
004400*   02378 - YOU CANNOT USE A DATE RANGE FOR THIS SEARCH           00440076
004410*   02416 - INVALID DATE OR DATE RANGE                            00441099
004420*   02572 - INVALID VALUE - OPER UNIT ID MUST BE A DC LOCATION    00442099
004500*   02698 - DATE RANGE INVALID                                    00450074
004510*   02873 - F-KEY NOT FUNCTIONAL-CAN ONLY VIEW PO LVL FOR SPCFC DC00451076
004520*   02874 - PO LEVEL DATA NOT AVAILABLE - DATA RETAINED ONLY THROU00452091
004600*                                                                 00460074
004700*----------------------------------------------------------------*00470074
004800 01  PC-TSYMSG-NUMBERS.                                           00480074
004900     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          00490074
005000     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          00500074
005100     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          00510074
005200     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          00520074
005300     05  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.          00530074
005400     05  PC-TSYMSG-00045       PIC  9(05)  VALUE  00045.          00540074
005500     05  PC-TSYMSG-00397       PIC  9(05)  VALUE  00397.          00550099
005501     05  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.          00550199
005510     05  PC-TSYMSG-00973       PIC  9(05)  VALUE  00973.          00551085
005600     05  PC-TSYMSG-21040       PIC  9(05)  VALUE  21040.          00560074
005700     05  PC-TSYMSG-02221       PIC  9(05)  VALUE  02221.          00570074
005800     05  PC-TSYMSG-02224       PIC  9(05)  VALUE  02224.          00580074
005900     05  PC-TSYMSG-02227       PIC  9(05)  VALUE  02227.          00590074
006000     05  PC-TSYMSG-02307       PIC  9(05)  VALUE  02307.          00600074
006010     05  PC-TSYMSG-02378       PIC  9(05)  VALUE  02378.          00601076
006100     05  PC-TSYMSG-02416       PIC  9(05)  VALUE  02416.          00610074
006200     05  PC-TSYMSG-02516       PIC  9(05)  VALUE  02516.          00620074
006210     05  PC-TSYMSG-02572       PIC  9(05)  VALUE  02572.          00621099
006300     05  PC-TSYMSG-02697       PIC  9(05)  VALUE  02697.          00630074
006400     05  PC-TSYMSG-02698       PIC  9(05)  VALUE  02698.          00640074
006410     05  PC-TSYMSG-02873       PIC  9(05)  VALUE  02873.          00641076
006420     05  PC-TSYMSG-02874       PIC  9(05)  VALUE  02874.          00642091
006500                                                                  00650074
006600*----------------------------------------------------------------*00660074
006700*   PROGRAM MESSAGES                                             *00670074
006800*----------------------------------------------------------------*00680074
006900 01  PM-PROGRAM-MESSAGES.                                         00690074
007000     05  PM-ABEND-INFO-A.                                         00700074
007100         10  FILLER                PIC X(15)   VALUE              00710074
007200                                   'DP020-SRC-AID: '.             00720074
007300         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00730074
007400         10  FILLER                PIC X(19)   VALUE              00740074
007500                                   '. DP020-FK-ACTION: '.         00750074
007600         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      00760074
007700         10  FILLER                PIC X(22)   VALUE              00770074
007800                                   '. DP020-FK-DISPN-IND: '.      00780074
007900         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      00790074
008000         10  FILLER                PIC X(01)   VALUE '.'.         00800074
008100         10  FILLER                PIC X(19)   VALUE SPACE.       00810074
008200                                                                  00820074
008300*----------------------------------------------------------------*00830074
008400*   SWITCHES                                                     *00840074
008500*----------------------------------------------------------------*00850074
008600 01  PS-PROGRAM-SWITCHES.                                         00860074
008700     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00870074
008800         88  PS-ERROR                          VALUE  'Y'.        00880074
008900         88  PS-NO-ERROR                       VALUE  'N'.        00890074
009000     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   00900074
009100         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   00910074
009200         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   00920074
009210     05  PS-VALID-POHIST-DATE-SW        PIC  X(01)  VALUE  ' '.   00921077
009220         88  PS-VALID-POHIST-DATE                   VALUE  'Y'.   00922077
009230         88  PS-INVALID-POHIST-DATE                 VALUE  'N'.   00923077
009240     05  PS-VALID-PRINTER-SW             PIC  X(01)  VALUE 'Y'.   00924078
009250         88  PS-VALID-PRINTER                        VALUE 'Y'.   00925081
009260         88  PS-INVALID-PRINTER                      VALUE 'N'.   00926081
009270     05  PS-RETURN-SWITCH                PIC  X(01)  VALUE ' '.   00927099
009280         88  PS-RETURN-TRUE                          VALUE 'Y'.   00928099
009290         88  PS-NOT-RETURN                           VALUE 'N'.   00929099
009291     05  PS-CHECK-OVERLAPPING-SHFTS-SW   PIC  X(01)  VALUE 'Y'.   00929199
009292         88  PS-CONTINUE-CHECKING                    VALUE 'Y'.   00929299
009293         88  PS-DONE-CHECKING                        VALUE 'N'.   00929399
009300                                                                  00930074
009400*----------------------------------------------------------------*00940074
009500*   PROGRAM VARIABLES                                            *00950074
009600*----------------------------------------------------------------*00960074
009700 01  PV-PROGRAM-VARIABLES.                                        00970074
009800     05  PV-RACF-ERROR-CODE       PIC  9(04)  VALUE ZEROES.       00980074
010300     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0.           01030074
010400     05  PV-CICS-RESPONSE         PIC S9(08)  VALUE ZEROES        01040074
010500                                   COMP SYNC.                     01050074
010600     05  PV-CICS-MSG-AREA2        PIC  X(100) VALUE SPACE.        01060074
010700     05  PV-CURRENT-TMST          PIC  X(26)  VALUE SPACES.       01070074
010800     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             01080074
010900         10  PV-CURR-YY           PIC  9(04).                     01090074
011000         10  FILLER               PIC  X(01).                     01100074
011100         10  PV-CURR-MM           PIC  9(02).                     01110074
011200         10  FILLER               PIC  X(01).                     01120074
011300         10  PV-CURR-DD           PIC  9(02).                     01130074
011400         10  FILLER               PIC  X(01).                     01140074
011500         10  PV-CURR-HH           PIC  9(02).                     01150074
011600         10  FILLER               PIC  X(01).                     01160074
011700         10  PV-CURR-MN           PIC  9(02).                     01170074
011800         10  FILLER               PIC  X(01).                     01180074
011900         10  PV-CURR-SS           PIC  9(02).                     01190074
012000         10  FILLER               PIC  X(07).                     01200074
012100     05  PV-BUSINES-DATE          PIC  X(26)  VALUE SPACES.       01210074
012200     05  PV-BUSINES-DATE-R REDEFINES PV-BUSINES-DATE.             01220074
012300         10  PV-BUSN-YY           PIC  9(04).                     01230074
012400         10  FILLER               PIC  X(01).                     01240074
012500         10  PV-BUSN-MM           PIC  9(02).                     01250074
012600         10  FILLER               PIC  X(01).                     01260074
012700         10  PV-BUSN-DD           PIC  9(02).                     01270074
012800         10  FILLER               PIC  X(01).                     01280074
012810         10  PV-BUSN-HH           PIC  9(02).                     01281074
012820         10  FILLER               PIC  X(01).                     01282074
012830         10  PV-BUSN-MN           PIC  9(02).                     01283074
012840         10  FILLER               PIC  X(01).                     01284074
012850         10  PV-BUSN-SS           PIC  9(02).                     01285074
012860         10  FILLER               PIC  X(07).                     01286074
012861     05  PV-BUSINES-DATE-PREV            PIC  X(26)  VALUE SPACES.01286199
012862     05  PV-BUSINES-DATE-R-PREV REDEFINES PV-BUSINES-DATE-PREV.   01286299
012864         10  PV-BUSN-YY-PREV             PIC  9(04).              01286499
012865         10  FILLER                      PIC  X(01).              01286599
012866         10  PV-BUSN-MM-PREV             PIC  9(02).              01286699
012867         10  FILLER                      PIC  X(01).              01286799
012868         10  PV-BUSN-DD-PREV             PIC  9(02).              01286899
012869         10  FILLER                      PIC  X(01).              01286999
012870         10  PV-BUSN-HH-PREV             PIC  9(02).              01287099
012871         10  FILLER                      PIC  X(01).              01287199
012872         10  PV-BUSN-MN-PREV             PIC  9(02).              01287299
012873         10  FILLER                      PIC  X(01).              01287399
012874         10  PV-BUSN-SS-PREV             PIC  9(02).              01287499
012875         10  FILLER                      PIC  X(07).              01287599
012876     05  PV-POHIST-DATE           PIC  X(26)  VALUE SPACES.       01287677
012877     05  PV-COMPARE-DATE.                                         01287794
012878         10   PV-CMPR-YY                PIC  X(04).               01287894
012879         10   FILLER                    PIC  X(01) VALUE '-'.     01287994
012880         10   PV-CMPR-MM                PIC  X(02).               01288094
012881         10   FILLER                    PIC  X(01) VALUE '-'.     01288194
012882         10   PV-CMPR-DD                PIC  X(02).               01288294
012883     05  PV-KEY-DATE              PIC  X(10)  VALUE SPACES.       01288374
012884     05  PV-KEY-DATE-R REDEFINES PV-KEY-DATE.                     01288474
012890         10  PV-KEY-YY            PIC  9(04).                     01289074
012900         10  PV-DASH-1            PIC  X(01).                     01290074
013000         10  PV-KEY-MM            PIC  9(02).                     01300074
013100         10  PV-DASH-2            PIC  X(01).                     01310074
013200         10  PV-KEY-DD            PIC  9(02).                     01320074
013300     05  PV-KEY-WEEK.                                             01330074
013400         10  PV-KEY-YEAR          PIC X(04) VALUE SPACES.         01340074
013500         10  PV-KEY-WK            PIC X(02) VALUE SPACES.         01350074
013510     05  PV-KEY-MNTH.                                             01351074
013520         10  PV-KEY-YR            PIC X(04) VALUE SPACES.         01352074
013530         10  PV-KEY-MN            PIC X(02) VALUE SPACES.         01353074
013540     05  PV-SHIFT-TIME            PIC  X(08)  VALUE SPACES.       01354074
013550     05  PV-SHIFT-TIME-R REDEFINES PV-SHIFT-TIME.                 01355074
013560         10  PV-SHFT-HH           PIC  9(02).                     01356074
013570         10  PV-PERIOD-1          PIC  X(01).                     01357074
013580         10  PV-SHFT-MN           PIC  9(02).                     01358074
013590         10  PV-PERIOD-2          PIC  X(01).                     01359074
013600         10  PV-SHFT-SS           PIC  9(02).                     01360074
013700     05  PV-END-TM                PIC  X(08) VALUE '24.00.00'.    01370074
013701     05  PC-BEG-TM                PIC  X(08) VALUE '00.00.00'.    01370199
013800     05  PV-TIMEZN-HRS            PIC S9(2) COMP VALUE ZEROES.    01380074
013900     05  PV-TIMEZN-DAYS           PIC S9(4) COMP VALUE ZEROES.    01390074
014000                                                                  01400074
014100*----------------------------------------------------------------*01410074
014200*    MAP LAYOUT                                                  *01420074
014300*----------------------------------------------------------------*01430074
014400     COPY PCKM748.                                                01440074
014500                                                                  01450074
014510*----------------------------------------------------------------*01451078
014520*  SENDING/RECEIVING AREA FOR THE                                *01452078
014530*  PRINTER VALIDATION ROUTING (DPKCS060)                         *01453078
014540*----------------------------------------------------------------*01454078
014550     COPY DPWS072.                                                01455078
014560                                                                  01456078
014600*----------------------------------------------------------------*01460074
014700*    ATTRIBUTE SETTINGS COPYBOOK.                                *01470074
014800*----------------------------------------------------------------*01480074
014900     COPY DPWS015.                                                01490074
015000                                                                  01500074
015100*----------------------------------------------------------------*01510074
015200*    FUNCTION KEYS COPYBOOK                                      *01520074
015300*----------------------------------------------------------------*01530074
015400     COPY DPWS016.                                                01540074
015500                                                                  01550074
015600*----------------------------------------------------------------*01560074
015700*    ABEND PROCESSING COPYBOOK.                                  *01570074
015800*----------------------------------------------------------------*01580074
015900     COPY DPWS013.                                                01590074
016000                                                                  01600074
016100*----------------------------------------------------------------*01610074
016200*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *01620074
016300*  SUB-ROUTINE (DPKUT100).                                       *01630074
016400*----------------------------------------------------------------*01640074
016500     COPY DPWS010I.                                               01650074
016600                                                                  01660074
016700*----------------------------------------------------------------*01670074
016800*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *01680074
016900*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *01690074
017000*----------------------------------------------------------------*01700074
017100     COPY DPWS030.                                                01710074
1122RM     COPY DPWS930.                                                01711099
017200                                                                  01720074
017300*----------------------------------------------------------------*01730074
017400*    STANDARD COMMAREA.                                          *01740074
017500*----------------------------------------------------------------*01750074
017600     COPY DPWS020.                                                01760074
017700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01770074
017800                                                                  01780074
017900*----------------------------------------------------------------*01790074
018000*    INTER-APPLICATION COMMAREA.                                 *01800074
018100*----------------------------------------------------------------*01810074
018200         10  INTER-APPL-COMM-AREA PIC X(200).                     01820074
018300     COPY PCWS213.                                                01830074
018400                                                                  01840074
018500*----------------------------------------------------------------*01850074
018600*    SPECIFIC COMMMAREA FOR PCKCS748.                            *01860074
018700*----------------------------------------------------------------*01870074
018800         10  ASC-SPECIFIC-COMMAREA.                               01880074
018900             15  ASC-OPER-UNT-ID-X           PIC  X(04).          01890074
019000             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID-X.   01900074
019100                 20  ASC-OPER-UNT-ID         PIC  9(04).          01910074
019200             15  ASC-OPER-NAME               PIC  X(25).          01920074
019210             15  ASC-POHIST-DATE             PIC  X(10).          01921093
019300             15  ASC-CRNT-BUS-DTE.                                01930074
019400                20  ASC-CRNT-BUS-YY          PIC X(4).            01940074
019500                20  ASC-CRNT-BUS-MM          PIC X(2).            01950074
019600                20  ASC-CRNT-BUS-DD          PIC X(2).            01960074
019700             15  ASC-FROM-DATE.                                   01970074
019800                20  ASC-FROM-DTE-MM          PIC X(2).            01980074
019900                20  ASC-FROM-DTE-DD          PIC X(2).            01990074
020000                20  ASC-FROM-DTE-YY          PIC X(4).            02000074
020100             15  ASC-TO-DATE.                                     02010074
020200                20  ASC-TO-DTE-MM            PIC X(2).            02020074
020300                20  ASC-TO-DTE-DD            PIC X(2).            02030074
020400                20  ASC-TO-DTE-YY            PIC X(4).            02040074
020500             15  ASC-FISCAL-WEEK.                                 02050074
020600                20  ASC-FSL-WK-YY            PIC X(4).            02060074
020700                20  ASC-FSL-WK-WK            PIC X(2).            02070074
020800             15  ASC-FISCAL-MONTH.                                02080074
020900                20  ASC-FSL-MN-YY            PIC X(4).            02090074
021000                20  ASC-FSL-MN-MN            PIC X(2).            02100074
021100             15  ASC-PRINTER-ID.                                  02110079
021120                20  ASC-PRINTER-ID-1-3       PIC X(3).            02112079
021130                20  ASC-PRINTER-ID-4-8       PIC X(5).            02113079
021140             15  ASC-SEL-1                   PIC X(1).            02114099
021150             15  ASC-SEL-2                   PIC X(1).            02115099
021160             15  ASC-SEL-3                   PIC X(1).            02116099
021170             15  ASC-SEL-4                   PIC X(1).            02117099
021200                                                                  02120074
021300*-----------------------------------------------------------------02130074
021400*  LOCATION TABLE                                                 02140099
021500*-----------------------------------------------------------------02150074
021600     EXEC SQL                                                     02160074
021700          INCLUDE XLT00010                                        02170099
021800     END-EXEC.                                                    02180074
021900                                                                  02190074
022000*-----------------------------------------------------------------02200074
022100*  DATE TABLE                                                     02210074
022200*-----------------------------------------------------------------02220074
022300     EXEC SQL                                                     02230074
022400          INCLUDE TDTATTR                                         02240074
022500     END-EXEC.                                                    02250074
022600                                                                  02260074
022700*-----------------------------------------------------------------02270074
022800*  SHIFT HOURS TABLE                                              02280074
022900*-----------------------------------------------------------------02290074
023000     EXEC SQL                                                     02300074
023100          INCLUDE PCT00004                                        02310074
023200     END-EXEC.                                                    02320074
023300                                                                  02330074
023400*-----------------------------------------------------------------02340074
023500*  PARM TABLE                                                     02350074
023600*-----------------------------------------------------------------02360074
023700     EXEC SQL                                                     02370074
023800          INCLUDE TKRPRPM                                         02380074
023900     END-EXEC.                                                    02390074
024000                                                                  02400074
024100*-----------------------------------------------------------------02410074
024200*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                02420074
024300*-----------------------------------------------------------------02430074
024400     EXEC SQL                                                     02440074
024500          INCLUDE SQLCA                                           02450074
024600     END-EXEC.                                                    02460074
024700                                                                  02470074
024800*-----------------------------------------------------------------02480074
024900 LINKAGE SECTION.                                                 02490074
025000*-----------------------------------------------------------------02500074
025100 01  DFHCOMMAREA.                                                 02510074
025200     05  FILLER                         OCCURS  1 TO 4072 TIMES   02520074
025300                                        DEPENDING ON EIBCALEN.    02530074
025400         10  FILLER                     PIC X.                    02540074
025500                                                                  02550074
025600                                                                  02560074
025700 PROCEDURE DIVISION.                                              02570074
025800*----------------------------------------------------------------*02580074
025900*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *02590074
026000*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *02600074
026100*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *02610074
026200*                                                                *02620074
026300*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *02630074
026400*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *02640074
026500*----------------------------------------------------------------*02650074
026600 0000-MAIN-MODULE.                                                02660074
026700     INITIALIZE DP030-CICS-API-FIELDS.                            02670074
026800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02680074
026900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02690074
027000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02700074
027100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02710074
027200     MOVE LENGTH OF PC748AI        TO DP030-MAP-LENGTH (1).       02720074
027300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02730074
027400     PERFORM 0001-CALL-CICS-ARCH-API.                             02740074
027500                                                                  02750074
027600     PERFORM 1000-CONTROL-PROCESSING                              02760074
027700                                                                  02770074
027800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02780074
027900     PERFORM 0001-CALL-CICS-ARCH-API.                             02790074
028000                                                                  02800074
028100*----------------------------------------------------------------*02810074
028200 0001-CALL-CICS-ARCH-API.                                         02820074
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               02830099
1122RM     CALL DP930-CICS-ARCH-API                                     02831099
1122RM                     USING DFHEIBLK                               02832099
028400                           DFHCOMMAREA                            02840074
028500                           DP030-CICS-API-FIELDS                  02850074
028600                           DP020-STANDARD-COMMAREA                02860074
028700                           PC748AI.                               02870074
028800                                                                  02880074
028900     IF  DP030-RC-CALL-SUCCESSFUL                                 02890074
029000         CONTINUE                                                 02900074
029100     ELSE                                                         02910074
029200         SET DP013-NO-ROLLBACK                                    02920074
029300             DP013-XCTL-DISPLAY-RESTART                           02930074
029400             DP013-CICS-ABEND      TO TRUE                        02940074
029500         MOVE 'BEFORE 0000-MAIN-MODULE'                           02950074
029600                                   TO DP013-PARAGRAPH             02960074
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL'                   02970099
1122RM*                                  TO DP013-MESSAGE-TEXT (2)      02980099
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02981099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02982099
029900         MOVE  SPACES              TO DP013-MESSAGE-TEXT (3)      02990074
030000         STRING  'RETURN CODE - '     DELIMITED BY SIZE           03000074
030100                  DP030-RETURN-CODE   DELIMITED BY SIZE           03010074
030200                                 INTO DP013-MESSAGE-TEXT (3)      03020074
030300         PERFORM DP013-0000-PROCESS-ABEND                         03030074
030400     END-IF.                                                      03040074
030500                                                                  03050074
030600*----------------------------------------------------------------*03060074
030700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03070074
030800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03080074
030900*----------------------------------------------------------------*03090074
031000 1000-CONTROL-PROCESSING.                                         03100074
031100                                                                  03110074
031200     EVALUATE TRUE                                                03120074
031300         WHEN DP020-NEXT-ACT-INITIAL                              03130074
031400             INITIALIZE ASC-SPECIFIC-COMMAREA                     03140074
031500             PERFORM 4000-BUILD-INITIAL-PANEL                     03150074
031600             PERFORM 3200-RESET-ATTRIBUTES                        03160074
031700                                                                  03170074
031800         WHEN DP020-NEXT-ACT-READ-MAP                             03180074
031900             PERFORM 2000-FKEY-PROCESSING                         03190074
032000                                                                  03200074
032100         WHEN DP020-NEXT-ACT-RETURN                               03210074
032200*            INITIALIZE ASC-SPECIFIC-COMMAREA                     03220074
032300             PERFORM 3200-RESET-ATTRIBUTES                        03230095
032310             SET PS-RETURN-TRUE TO TRUE                           03231099
032400             PERFORM 4000-BUILD-INITIAL-PANEL                     03240074
032410             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03241095
032600                                                                  03260074
032700         WHEN OTHER                                               03270074
032800             SET DP013-LOGIC-ABEND                                03280074
032900                 DP013-NO-ROLLBACK TO TRUE                        03290074
033000             MOVE 'PCKCS748 - 1000-CONTROL-PROCESSING'            03300074
033100                                   TO  DP013-PARAGRAPH            03310074
033200             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03320074
033300                                   TO  DP013-MESSAGE-TEXT(1)      03330074
033400             MOVE DP020-NEXT-APPL-ACTIVITY                        03340074
033500                                   TO DP013-MESSAGE-TEXT(2)       03350074
033600             PERFORM DP013-0000-PROCESS-ABEND                     03360074
033700     END-EVALUATE.                                                03370074
033800                                                                  03380074
033900*----------------------------------------------------------------*03390074
034000* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03400074
034100* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03410074
034200* EDITS.                                                         *03420074
034300*----------------------------------------------------------------*03430074
034400 2000-FKEY-PROCESSING.                                            03440074
034500                                                                  03450074
034600     EVALUATE TRUE                                                03460074
034700                                                                  03470074
034800         WHEN DP020-SRC-AID = DP016-CLEAR                         03480074
034900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03490074
035000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03500074
035100                                                                  03510074
035200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03520074
035300             INITIALIZE ASC-SPECIFIC-COMMAREA                     03530074
035400                        ASEL1O                                    03540074
035500                        ASEL2O                                    03550074
035600                        ASEL3O                                    03560074
035700                        ASEL4O                                    03570074
035800             PERFORM 4000-BUILD-INITIAL-PANEL                     03580074
035900             PERFORM 3200-RESET-ATTRIBUTES                        03590074
036000                                                                  03600074
036100         WHEN OTHER                                               03610074
036200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03620074
036300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03630074
036400                                                                  03640074
036500             IF  PS-NO-ERROR                                      03650074
036600                 SET DP030-CONTINUE-GO TO TRUE                    03660074
036700                 PERFORM 2100-CHECK-FUNCTION-KEY                  03670074
036800                 IF  PS-NO-ERROR                                  03680074
036900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         03690074
037000                 ELSE                                             03700074
037100                     SET DP030-OVERRIDE-GO TO TRUE                03710074
037200                 END-IF                                           03720074
037300             ELSE                                                 03730074
037400                 SET DP030-OVERRIDE-GO TO TRUE                    03740074
037500             END-IF                                               03750074
037600     END-EVALUATE.                                                03760074
037700                                                                  03770074
037800*----------------------------------------------------------------*03780074
037900*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *03790074
038000*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *03800074
038100*  FROM THE CICS ARCHITECTURE API.                               *03810074
038200*----------------------------------------------------------------*03820074
038300 2100-CHECK-FUNCTION-KEY.                                         03830074
038400*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *03840074
038500*  VALIDATE THE DATE THE ASSOCIATE ENTERS.                       *03850074
038600*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *03860074
038700     IF ASC-CRNT-BUS-DTE > SPACES                                 03870074
038800         MOVE ASC-CRNT-BUS-YY   TO PV-KEY-YY                      03880074
038801         MOVE ASC-CRNT-BUS-MM   TO PV-KEY-MM                      03880174
038802         MOVE ASC-CRNT-BUS-DD   TO PV-KEY-DD                      03880274
038803         MOVE '-'               TO PV-DASH-1                      03880374
038804                                   PV-DASH-2                      03880474
038805         PERFORM 2105-VALIDATE-DATE                               03880574
038806         MOVE ASC-CRNT-BUS-MM   TO ASC-TO-DTE-MM                  03880699
038807         MOVE ASC-CRNT-BUS-DD   TO ASC-TO-DTE-DD                  03880799
038808         MOVE ASC-CRNT-BUS-YY   TO ASC-TO-DTE-YY                  03880899
038809     ELSE                                                         03880974
038810         IF ASC-FROM-DATE > SPACES                                03881074
038811             MOVE ASC-FROM-DTE-YY   TO PV-KEY-YY                  03881174
038812             MOVE ASC-FROM-DTE-MM   TO PV-KEY-MM                  03881274
038813             MOVE ASC-FROM-DTE-DD   TO PV-KEY-DD                  03881374
038814             MOVE '-'               TO PV-DASH-1                  03881474
038815                                       PV-DASH-2                  03881574
038816             PERFORM 2105-VALIDATE-DATE                           03881674
038817             MOVE PV-KEY-MM       TO  ASC-FROM-DTE-MM             03881799
038818             MOVE PV-KEY-DD       TO  ASC-FROM-DTE-DD             03881899
038819             MOVE PV-KEY-YY       TO  ASC-FROM-DTE-YY             03881999
038820             IF PS-NO-ERROR                                       03882074
038821                 MOVE ASC-TO-DTE-YY   TO PV-KEY-YY                03882174
038822                 MOVE ASC-TO-DTE-MM   TO PV-KEY-MM                03882274
038823                 MOVE ASC-TO-DTE-DD   TO PV-KEY-DD                03882374
038824                 MOVE '-'             TO PV-DASH-1                03882474
038825                                         PV-DASH-2                03882574
038826                 PERFORM 2105-VALIDATE-DATE                       03882674
038827                 MOVE PV-KEY-MM       TO  ASC-TO-DTE-MM           03882799
038828                 MOVE PV-KEY-DD       TO  ASC-TO-DTE-DD           03882899
038829                 MOVE PV-KEY-YY       TO  ASC-TO-DTE-YY           03882999
038830             END-IF                                               03883074
038831         ELSE                                                     03883174
038832             IF ASC-FISCAL-WEEK > SPACES                          03883274
038833                 MOVE ASC-FSL-WK-WK TO PV-KEY-WK                  03883374
038834                 MOVE ASC-FSL-WK-YY TO PV-KEY-YEAR                03883474
038835                 PERFORM 2106-VALIDATE-WEEK                       03883574
038836             ELSE                                                 03883674
038837                 IF ASC-FISCAL-MONTH > SPACES                     03883774
038838                     MOVE ASC-FSL-MN-YY TO PV-KEY-YR              03883874
038839                     MOVE ASC-FSL-MN-MN TO PV-KEY-MN              03883974
038840                     PERFORM 2107-VALIDATE-MNTH                   03884074
038841                 END-IF                                           03884174
038842             END-IF                                               03884274
038843         END-IF                                                   03884374
038844     END-IF.                                                      03884474
038845                                                                  03884574
038846     IF PS-NO-ERROR                                               03884674
038847         EVALUATE TRUE                                            03884774
038848                                                                  03884874
038849* ENTER                                                           03884974
038850             WHEN DP020-SRC-AID = DP016-ENTER                     03885074
038870                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             03887074
038880                                                                  03888074
038890* F17 - UNITS WORKED BY PO                                        03889074
038900             WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)          03890074
039000                 IF ASC-OPER-UNT-ID-X  = SPACES                   03900074
039100                     SET PS-ERROR                                 03910074
039200                         DP020-MSG-FATAL         TO TRUE          03920074
039300                     MOVE PC-TSYMSG-02873    TO DP020-MSG-NUMBER  03930076
039400                     MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA        03940074
039500                     MOVE DP015-RED              TO AOPERC        03950074
039600                     MOVE DP015-REVERSE          TO AOPERH        03960074
039700                     MOVE -1                     TO AOPERL        03970074
039800                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          03980074
039900                 END-IF                                           03990074
040000                 IF ASC-SEL-1 = SPACES                            04000099
040100                     SET PS-ERROR                                 04010074
040200                         DP020-MSG-FATAL         TO TRUE          04020074
040300                     MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER  04030074
040400                     MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A        04040074
040500                     MOVE DP015-RED              TO ASEL1C        04050074
040600                     MOVE DP015-REVERSE          TO ASEL1H        04060074
040700                     MOVE -1                     TO ASEL1L        04070074
040710                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          04071074
040720                 END-IF                                           04072074
040721                 IF ASC-SEL-2 = PC-S OR ASC-SEL-3 = PC-S OR       04072199
040722                    ASC-SEL-4 = PC-S                              04072299
040723                     SET PS-ERROR                                 04072376
040724                         DP020-MSG-FATAL         TO TRUE          04072476
040725                     MOVE PC-TSYMSG-02378    TO DP020-MSG-NUMBER  04072576
040726                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          04072676
040727                     IF ASC-SEL-2  = PC-S                         04072799
040728                         MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL2A    04072876
040729                         MOVE DP015-RED              TO ASEL2C    04072976
040730                         MOVE DP015-REVERSE          TO ASEL2H    04073076
040731                         MOVE -1                     TO ASEL2L    04073176
040732                     ELSE                                         04073276
040733                         IF ASC-SEL-3 = PC-S                      04073399
040734                             MOVE DP015-UNP-ALP-BRT-OFF TO ASEL3A 04073476
040735                             MOVE DP015-RED             TO ASEL3C 04073576
040736                             MOVE DP015-REVERSE         TO ASEL3H 04073676
040737                             MOVE -1                    TO ASEL3L 04073776
040738                         ELSE                                     04073876
040739                             IF ASC-SEL-4 = PC-S                  04073999
040740                             MOVE DP015-UNP-ALP-BRT-OFF TO ASEL4A 04074076
040741                             MOVE DP015-RED             TO ASEL4C 04074176
040742                             MOVE DP015-REVERSE         TO ASEL4H 04074276
040743                             MOVE -1                    TO ASEL4L 04074376
040744                             END-IF                               04074476
040745                         END-IF                                   04074576
040746                     END-IF                                       04074676
040747                 END-IF                                           04074777
040749                 IF PS-NO-ERROR                                   04074977
040750                     PERFORM 2300-CHECK-PO-HISTORY-DATE           04075094
040751                     IF PS-VALID-POHIST-DATE                      04075177
040752                         PERFORM 2110-PREPARE-INTER-APPL-COMM     04075277
040753                     ELSE                                         04075377
040754                         SET PS-ERROR                             04075477
040755                             DP020-MSG-FATAL         TO TRUE      04075577
040756                         MOVE ASC-POHIST-DATE  TO DP020-MSG-TEXT  04075693
040757                         MOVE PC-TSYMSG-02874 TO DP020-MSG-NUMBER 04075792
040758                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      04075892
040759                         MOVE DP015-UNP-ALP-BRT-OFF TO ACRMMA     04075992
040760                                                       ACRDDA     04076092
040761                                                       ACRYYA     04076192
040762                         MOVE DP015-RED             TO ACRMMC     04076292
040763                                                       ACRDDC     04076392
040764                                                       ACRYYC     04076492
040765                         MOVE DP015-REVERSE         TO ACRMMH     04076592
040766                                                       ACRDDH     04076692
040767                                                       ACRYYH     04076792
040768                         MOVE -1                    TO ACRMML     04076892
040769                                                       ACRDDL     04076992
040770                                                       ACRYYL     04077092
040771                     END-IF                                       04077192
040772                 END-IF                                           04077292
040773*                                                                 04077392
040774* F18 - UNITS WORKED BY PROCESS AREA                              04077492
040780             WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          04078074
040790                 IF PS-NO-ERROR                                   04079074
040800                     PERFORM 2110-PREPARE-INTER-APPL-COMM         04080074
040900                 END-IF                                           04090074
041000                                                                  04100074
041100* F20 - LIST OF AREAS AND GROUPS ASSOCIATIONS.                    04110099
041200             WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)          04120099
041300                 IF PS-NO-ERROR                                   04130074
041400                     PERFORM 2110-PREPARE-INTER-APPL-COMM         04140074
041500                 END-IF                                           04150074
041600                                                                  04160074
041610* F21 - LIST OF DC TIMEZONE AND SHIFTS                            04161099
041620             WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)          04162099
041630                 IF PS-NO-ERROR                                   04163099
041640                     PERFORM 2110-PREPARE-INTER-APPL-COMM         04164099
041650                 END-IF                                           04165099
041660                                                                  04166099
041700* F22 - COMPARE PREVIOUS YEAR INFO TO CURRENT YEAR                04170074
041800             WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)          04180074
041900                 IF PS-NO-ERROR                                   04190074
042000                     PERFORM 2110-PREPARE-INTER-APPL-COMM         04200074
042100                 END-IF                                           04210074
042200                                                                  04220074
042300* F23 - UNITS BY PROCESS GROUP                                    04230074
042400             WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)          04240099
042500                 IF PS-NO-ERROR                                   04250074
042600                     PERFORM 2110-PREPARE-INTER-APPL-COMM         04260074
042700                 END-IF                                           04270074
042710                                                                  04271074
042711* F24 - UNITS WORKED BY OPER UNIT ID                              04271174
042712             WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)          04271274
042713                 IF PS-NO-ERROR                                   04271374
042714                     PERFORM 2110-PREPARE-INTER-APPL-COMM         04271474
042715                 END-IF                                           04271574
042716                                                                  04271674
042717             WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)             04271774
042718             WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)               04271874
042719                  PERFORM 2110-PREPARE-INTER-APPL-COMM            04271974
042720*                                                                 04272074
042730* OTHER                                                           04273074
042740             WHEN OTHER                                           04274074
042750                 SET DP013-NO-ROLLBACK                            04275074
042760                     DP013-XCTL-DISPLAY-RESTART                   04276074
042770                     DP013-CICS-ABEND  TO TRUE                    04277074
042780                 MOVE '2100-CHECK-FUNCTION-KEY'                   04278074
042790                                       TO DP013-PARAGRAPH         04279074
042800                 MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'  04280074
042900                                       TO DP013-MESSAGE-TEXT (1)  04290074
043000              MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:'04300074
043100                                       TO DP013-MESSAGE-TEXT (2)  04310074
043200                 MOVE DP020-SRC-AID    TO PM-A-SRC-AID            04320074
043300                 MOVE DP020-FK-ACTION (DP020-SRC-AID)             04330074
043400                                       TO PM-A-FK-ACTION          04340074
043500                 MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)          04350074
043600                                       TO PM-A-FK-DISPN           04360074
043700                 MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)  04370074
043800                 MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'    04380074
043900                                       TO DP013-MESSAGE-TEXT (4)  04390074
044000                 PERFORM DP013-0000-PROCESS-ABEND                 04400074
044100         END-EVALUATE                                             04410074
044200     END-IF.                                                      04420074
044300                                                                  04430074
044400*----------------------------------------------------------------*04440074
044500*  CHECK THE TDTATTR TABLE TO VALIDATE THE DATE ENTERED BY THE    04450074
044600*  ASSOCIATE.                                                     04460074
044700*----------------------------------------------------------------*04470074
044800 2105-VALIDATE-DATE.                                              04480074
044900     EXEC SQL                                                     04490074
045000          SELECT KY_DTE                                           04500074
045010                ,FSCL_YR_NBR                                      04501099
045020                ,FSCL_MN_NBR                                      04502099
045030                ,FSCL_WK_NBR                                      04503099
045100            INTO :DTATTR-KY-DTE                                   04510074
045110                ,:DTATTR-FSCL-YR-NBR                              04511099
045120                ,:DTATTR-FSCL-MN-NBR                              04512099
045130                ,:DTATTR-FSCL-WK-NBR                              04513099
045200            FROM TDTATTR                                          04520074
045300          WHERE KY_DTE   =  :PV-KEY-DATE                          04530074
045310      END-EXEC.                                                   04531074
045320                                                                  04532074
045330     EVALUATE TRUE                                                04533074
045340         WHEN SQLCODE = +0                                        04534074
045350             MOVE DTATTR-FSCL-YR-NBR  TO  ASC-FSL-WK-YY           04535099
045351                                          ASC-FSL-MN-YY           04535199
045352             MOVE DTATTR-FSCL-MN-NBR  TO  ASC-FSL-MN-MN           04535299
045353             MOVE DTATTR-FSCL-WK-NBR  TO  ASC-FSL-WK-WK           04535399
045367         WHEN OTHER                                               04536774
045370             SET PS-ERROR                                         04537074
045380                 DP020-MSG-FATAL         TO TRUE                  04538074
045390             MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER      04539074
045391             IF ASC-CRNT-BUS-DTE > SPACES                         04539174
045392                 MOVE DP015-UNP-ALP-BRT-OFF  TO ACRYYA            04539274
045393                                                ACRMMA            04539374
045394                                                ACRDDA            04539474
045395                 MOVE DP015-RED              TO ACRYYC            04539574
045396                                                ACRMMC            04539674
045397                                                ACRDDC            04539774
045398                 MOVE DP015-REVERSE          TO ACRYYH            04539874
045399                                                ACRMMH            04539974
045400                                                ACRDDH            04540074
045401                 MOVE -1                     TO ACRMML            04540174
045402                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04540274
045403             ELSE                                                 04540374
045404                 IF ASC-FROM-DATE > SPACES                        04540474
045405                     MOVE DP015-UNP-ALP-BRT-OFF  TO AFRYYA        04540574
045406                                                    AFRMMA        04540674
045407                                                    AFRDDA        04540774
045408                     MOVE DP015-RED              TO AFRYYC        04540874
045409                                                    AFRMMC        04540974
045410                                                    AFRDDC        04541074
045411                     MOVE DP015-REVERSE          TO AFRYYH        04541174
045412                                                    AFRMMH        04541274
045413                                                    AFRDDH        04541374
045414                     MOVE -1                     TO AFRMML        04541474
045415                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          04541574
045416                     MOVE DP015-UNP-ALP-BRT-OFF  TO ATOYYA        04541674
045417                                                    ATOMMA        04541774
045418                                                    ATODDA        04541874
045419                     MOVE DP015-RED              TO ATOYYC        04541974
045420                                                    ATOMMC        04542074
045421                                                    ATODDC        04542174
045422                     MOVE DP015-REVERSE          TO ATOYYH        04542274
045423                                                    ATOMMH        04542374
045424                                                    ATODDH        04542474
045425                 END-IF                                           04542574
045426             END-IF                                               04542674
045427      END-EVALUATE.                                               04542774
045428                                                                  04542874
045429*----------------------------------------------------------------*04542974
045430*  CHECK THE TDTATTR TABLE TO VALIDATE THE WEEK ENTERED BY THE    04543074
045440*  ASSOCIATE.                                                     04544074
045450*----------------------------------------------------------------*04545074
045451 2106-VALIDATE-WEEK.                                              04545174
045452                                                                  04545274
045453     EXEC SQL                                                     04545374
045454          SELECT DISTINCT(FSCL_WK_NBR)                            04545474
045455                 ,FSCL_MN_NBR                                     04545599
045456                 ,FSCL_YR_NBR                                     04545699
045457                 ,FSCL_WK_BEG_DTE                                 04545799
045458                 ,FSCL_WK_END_DTE                                 04545899
045459            INTO :DTATTR-FSCL-WK-NBR                              04545999
045460                ,:DTATTR-FSCL-MN-NBR                              04546099
045461                ,:DTATTR-FSCL-YR-NBR                              04546199
045462                ,:DTATTR-FSCL-WK-BEG-DTE                          04546299
045463                ,:DTATTR-FSCL-WK-END-DTE                          04546399
045464            FROM  TDTATTR                                         04546499
045465           WHERE  FSCL_YR_NBR   =  :PV-KEY-YEAR                   04546599
045466             AND  FSCL_WK_NBR   =  :PV-KEY-WK                     04546699
045467     END-EXEC.                                                    04546799
045468                                                                  04546899
045469     EVALUATE TRUE                                                04546999
045470         WHEN SQLCODE = +0                                        04547099
045471             MOVE DTATTR-FSCL-YR-NBR     TO  ASC-FSL-WK-YY        04547199
045472                                             ASC-FSL-MN-YY        04547299
045473             MOVE DTATTR-FSCL-MN-NBR     TO  ASC-FSL-MN-MN        04547399
045474             MOVE DTATTR-FSCL-WK-NBR     TO  ASC-FSL-WK-WK        04547499
045475             MOVE DTATTR-FSCL-WK-BEG-DTE TO  PV-KEY-DATE          04547599
045476             MOVE PV-KEY-MM              TO  ASC-FROM-DTE-MM      04547699
045478             MOVE PV-KEY-DD              TO  ASC-FROM-DTE-DD      04547899
045480             MOVE PV-KEY-YY              TO  ASC-FROM-DTE-YY      04548099
045482             MOVE DTATTR-FSCL-WK-END-DTE TO  PV-KEY-DATE          04548299
045483             MOVE PV-KEY-MM              TO  ASC-TO-DTE-MM        04548399
045484             MOVE PV-KEY-DD              TO  ASC-TO-DTE-DD        04548499
045485             MOVE PV-KEY-YY              TO  ASC-TO-DTE-YY        04548599
045486         WHEN OTHER                                               04548699
045487             SET PS-ERROR                                         04548799
045488                 DP020-MSG-FATAL         TO TRUE                  04548899
045489             MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER      04548999
045490             MOVE DP015-UNP-ALP-BRT-OFF  TO AWKYYA                04549099
045491                                            AWKWKA                04549199
045492             MOVE DP015-RED              TO AWKYYC                04549299
045493                                            AWKWKC                04549399
045494             MOVE DP015-REVERSE          TO AWKYYH                04549499
045495                                            AWKWKH                04549599
045496             MOVE -1                     TO AWKYYL                04549699
045497             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04549799
045498     END-EVALUATE.                                                04549899
045499                                                                  04549999
045500*----------------------------------------------------------------*04550099
045501*  CHECK THE TDTATTR TABLE TO VALIDATE THE MONTH ENTERED BY THE   04550199
045502*  ASSOCIATE.                                                     04550299
045503*----------------------------------------------------------------*04550399
045504 2107-VALIDATE-MNTH.                                              04550499
045505                                                                  04550599
045506     EXEC SQL                                                     04550699
045507          SELECT DISTINCT(FSCL_MN_NBR)                            04550799
045508                 ,FSCL_YR_NBR                                     04550899
045509                 ,FSCL_MN_BEG_DTE                                 04550999
045510                 ,FSCL_MN_END_DTE                                 04551099
045511            INTO :DTATTR-FSCL-MN-NBR                              04551199
045512                ,:DTATTR-FSCL-YR-NBR                              04551299
045513                ,:DTATTR-FSCL-MN-BEG-DTE                          04551399
045514                ,:DTATTR-FSCL-MN-END-DTE                          04551499
045515            FROM  TDTATTR                                         04551599
045516           WHERE  FSCL_YR_NBR   =  :PV-KEY-YR                     04551699
045517             AND  FSCL_MN_NBR   =  :PV-KEY-MN                     04551799
045518     END-EXEC.                                                    04551899
045519                                                                  04551999
045520     EVALUATE TRUE                                                04552099
045521         WHEN SQLCODE = +0                                        04552199
045522             MOVE DTATTR-FSCL-YR-NBR     TO  ASC-FSL-MN-YY        04552299
045523             MOVE DTATTR-FSCL-MN-NBR     TO  ASC-FSL-MN-MN        04552399
045524             MOVE DTATTR-FSCL-MN-BEG-DTE TO  PV-KEY-DATE          04552499
045525             MOVE PV-KEY-MM              TO  ASC-FROM-DTE-MM      04552599
045526             MOVE PV-KEY-DD              TO  ASC-FROM-DTE-DD      04552699
045527             MOVE PV-KEY-YY              TO  ASC-FROM-DTE-YY      04552799
045528             MOVE DTATTR-FSCL-MN-END-DTE TO  PV-KEY-DATE          04552899
045529             MOVE PV-KEY-MM              TO  ASC-TO-DTE-MM        04552999
045530             MOVE PV-KEY-DD              TO  ASC-TO-DTE-DD        04553099
045531             MOVE PV-KEY-YY              TO  ASC-TO-DTE-YY        04553199
045532         WHEN OTHER                                               04553299
045533             SET PS-ERROR                                         04553399
045534                 DP020-MSG-FATAL         TO TRUE                  04553499
045535             MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER      04553599
045536             MOVE DP015-UNP-ALP-BRT-OFF  TO AMNYYA                04553699
045537                                            AMNMNA                04553799
045538             MOVE DP015-RED              TO AMNYYC                04553899
045539                                            AMNMNC                04553999
045540             MOVE DP015-REVERSE          TO AMNYYH                04554099
045541                                            AMNMNH                04554199
045542             MOVE -1                     TO AMNYYL                04554299
045543             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04554399
045544     END-EVALUATE.                                                04554499
045545                                                                  04554599
045546*----------------------------------------------------------------*04554699
045547*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *04554799
045548*  INTER-APPLICATION COMMAREA.                                   *04554899
045549*----------------------------------------------------------------*04554974
045550 2110-PREPARE-INTER-APPL-COMM.                                    04555074
045551                                                                  04555174
045560     INITIALIZE PC213-INTER-APPL-COMMAREA.                        04556074
045570                                                                  04557074
045580     MOVE ASC-OPER-UNT-ID         TO PC213-OPER-UNT-ID.           04558074
045581     IF ASC-SEL-1 = PC-S                                          04558199
045590         MOVE ASC-CRNT-BUS-DTE    TO PC213-CRNT-BUS-DTE           04559099
045591     ELSE                                                         04559199
045592         MOVE SPACES              TO PC213-CRNT-BUS-DTE           04559299
045593                                     ASC-CRNT-BUS-DTE             04559399
045594     END-IF.                                                      04559499
045595     IF ASC-SEL-2 = PC-S                                          04559599
045600         MOVE ASC-FROM-DATE       TO PC213-FROM-DATE              04560099
045700         MOVE ASC-TO-DATE         TO PC213-TO-DATE                04570099
045710     ELSE                                                         04571099
045720         MOVE SPACES              TO PC213-FROM-DATE              04572099
045721                                     PC213-TO-DATE                04572199
045722                                     ASC-FROM-DATE                04572299
045723                                     ASC-TO-DATE                  04572399
045730     END-IF.                                                      04573099
045740     IF ASC-SEL-3 = PC-S                                          04574099
045800         MOVE ASC-FISCAL-WEEK     TO PC213-FISCAL-WEEK            04580099
045810     ELSE                                                         04581099
045820         MOVE SPACES              TO PC213-FISCAL-WEEK            04582099
045830                                     ASC-FISCAL-WEEK              04583099
045840     END-IF.                                                      04584099
045850     IF ASC-SEL-4 = PC-S                                          04585099
045900         MOVE ASC-FISCAL-MONTH    TO PC213-FISCAL-MONTH           04590099
045901     ELSE                                                         04590199
045902         MOVE SPACES              TO PC213-FISCAL-MONTH           04590299
045903                                     ASC-FISCAL-MONTH             04590399
045904     END-IF.                                                      04590499
045910     MOVE ASC-PRINTER-ID          TO PC213-PRINTER-ID.            04591099
046000                                                                  04600099
046100*----------------------------------------------------------------*04610074
046200* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04620074
046300* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04630074
046400* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04640074
046500*----------------------------------------------------------------*04650074
046600 2200-MOVE-SCREEN-TO-COMMAREA.                                    04660074
046700                                                                  04670074
046800* OPER UNIT ID                                                    04680074
046900     IF  AOPERI   = SPACES                                        04690074
047000         MOVE ZEROES     TO AOPERL                                04700074
047100         MOVE SPACES     TO ASC-OPER-UNT-ID-X                     04710074
047200     ELSE                                                         04720074
047300         IF  AOPERF  = DP015-ERASE-EOF                            04730099
047400             MOVE SPACES           TO ASC-OPER-UNT-ID-X           04740099
047500         ELSE                                                     04750099
047600             IF  AOPERL  > ZERO                                   04760099
047610                 MOVE AOPERI           TO ASC-OPER-UNT-ID-X       04761099
047700*            ELSE                                                 04770099
047710*                MOVE SPACES           TO ASC-OPER-UNT-ID-X       04771099
047720             END-IF                                               04772099
047730         END-IF                                                   04773099
047800     END-IF.                                                      04780074
047900                                                                  04790074
048000* SELECTION                                                       04800074
048100     IF  ASEL1I   = SPACES                                        04810074
048200         MOVE ZEROES     TO ASEL1L                                04820074
048300         MOVE SPACES     TO ASC-CRNT-BUS-DTE                      04830074
048310                            ASC-SEL-1                             04831099
048400     ELSE                                                         04840074
048410         IF  ASEL1F  = DP015-ERASE-EOF                            04841099
048420             MOVE SPACES     TO ASC-CRNT-BUS-MM                   04842099
048430                                ASC-CRNT-BUS-DD                   04843099
048440                                ASC-CRNT-BUS-YY                   04844099
048441                                ASC-SEL-1                         04844199
048450         ELSE                                                     04845099
048460             IF ((ASEL1L   > ZERO) AND                            04846099
048461                (ACRMML   > ZERO OR ACRDDL > ZERO OR ACRYYL > 0)) 04846199
048462                 MOVE ACRMMI     TO ASC-CRNT-BUS-MM               04846299
048463                 MOVE ACRDDI     TO ASC-CRNT-BUS-DD               04846399
048464                 MOVE ACRYYI     TO ASC-CRNT-BUS-YY               04846499
048465                 MOVE PC-S       TO ASC-SEL-1                     04846599
048475             END-IF                                               04847599
048476         END-IF                                                   04847699
048480     END-IF.                                                      04848074
048481     IF  ACRMMF  = DP015-ERASE-EOF                                04848199
048482     OR  ACRDDF  = DP015-ERASE-EOF                                04848299
048483     OR  ACRYYF  = DP015-ERASE-EOF                                04848399
048484         MOVE SPACES     TO ASC-CRNT-BUS-DTE                      04848499
048486     END-IF.                                                      04848699
048490                                                                  04849074
048500     IF  ASEL2I   = SPACES                                        04850074
048600         MOVE ZEROES     TO ASEL2L                                04860074
048700         MOVE SPACES     TO ASC-FROM-DATE                         04870074
048800                            ASC-TO-DATE                           04880074
048810                            ASC-SEL-2                             04881099
048900     ELSE                                                         04890074
049000         IF  ASEL2F  =  DP015-ERASE-EOF                           04900099
049100             MOVE SPACES     TO ASC-FROM-DTE-MM                   04910099
049200                                ASC-FROM-DTE-DD                   04920099
049300                                ASC-FROM-DTE-YY                   04930099
049400                                ASC-TO-DTE-MM                     04940099
049500                                ASC-TO-DTE-DD                     04950099
049600                                ASC-TO-DTE-YY                     04960099
049610                                ASC-SEL-2                         04961099
049700         ELSE                                                     04970099
049800             IF ((ASEL2L   > ZERO) AND                            04980099
049810                (AFRMML   > ZERO OR AFRDDL > ZERO OR AFRYYL > 0 OR04981099
049820                 ATOMML   > ZERO OR ATODDL > ZERO OR ATOYYL > 0)) 04982099
049900                 MOVE AFRMMI     TO ASC-FROM-DTE-MM               04990099
049910                 MOVE AFRDDI     TO ASC-FROM-DTE-DD               04991099
049920                 MOVE AFRYYI     TO ASC-FROM-DTE-YY               04992099
049930                 MOVE ATOMMI     TO ASC-TO-DTE-MM                 04993099
049940                 MOVE ATODDI     TO ASC-TO-DTE-DD                 04994099
049950                 MOVE ATOYYI     TO ASC-TO-DTE-YY                 04995099
049960                 MOVE PC-S       TO ASC-SEL-2                     04996099
050020             END-IF                                               05002099
050030         END-IF                                                   05003099
050100     END-IF.                                                      05010074
050110     IF  AFRMMF  = DP015-ERASE-EOF                                05011099
050120     OR  AFRDDF  = DP015-ERASE-EOF                                05012099
050130     OR  AFRYYF  = DP015-ERASE-EOF                                05013099
050131         MOVE SPACES     TO ASC-FROM-DATE                         05013199
050132     END-IF.                                                      05013299
050133     IF  ATOMMF  = DP015-ERASE-EOF                                05013399
050134     OR  ATODDF  = DP015-ERASE-EOF                                05013499
050135     OR  ATOYYF  = DP015-ERASE-EOF                                05013599
050141         MOVE SPACES     TO ASC-TO-DATE                           05014199
050150     END-IF.                                                      05015099
050200                                                                  05020074
050300     IF  ASEL3I   = SPACES                                        05030074
050310         MOVE ZEROES     TO ASEL3L                                05031074
050320         MOVE SPACES     TO ASC-FISCAL-WEEK                       05032074
050321                            ASC-SEL-3                             05032199
050330     ELSE                                                         05033074
050340         IF  ASEL3F  =  DP015-ERASE-EOF                           05034099
050350             MOVE SPACES     TO ASC-FSL-WK-YY                     05035099
050360                                ASC-FSL-WK-WK                     05036099
050361                                ASC-SEL-3                         05036199
050370         ELSE                                                     05037099
050380             IF ((ASEL3L   > ZERO) AND                            05038099
050381                (AWKYYL   > ZERO OR AWKWKL > ZERO))               05038199
050382                 MOVE AWKYYI     TO ASC-FSL-WK-YY                 05038299
050383                 MOVE AWKWKI     TO ASC-FSL-WK-WK                 05038399
050384                 MOVE PC-S       TO ASC-SEL-3                     05038499
050394             END-IF                                               05039499
050395         END-IF                                                   05039599
050400     END-IF.                                                      05040074
050410     IF  AWKYYF  = DP015-ERASE-EOF                                05041099
050420     OR  AWKWKF  = DP015-ERASE-EOF                                05042099
050440         MOVE SPACES     TO ASC-FISCAL-WEEK                       05044099
050450     END-IF.                                                      05045099
050500                                                                  05050074
050600     IF  ASEL4I   = SPACES                                        05060074
050700         MOVE ZEROES     TO ASEL4L                                05070074
050800         MOVE SPACES     TO ASC-FISCAL-MONTH                      05080074
050810                            ASC-SEL-4                             05081099
050900     ELSE                                                         05090074
051000         IF  ASEL4F  =  DP015-ERASE-EOF                           05100099
051100             MOVE SPACES     TO ASC-FSL-MN-YY                     05110099
051200                                ASC-FSL-MN-MN                     05120099
051210                                ASC-SEL-4                         05121099
051300         ELSE                                                     05130099
051400             IF ((ASEL4L  > ZERO) AND                             05140099
051401                (AMNYYL   > ZERO OR AMNMNL > ZERO))               05140199
051410                 MOVE AMNYYI     TO ASC-FSL-MN-YY                 05141099
051420                 MOVE AMNMNI     TO ASC-FSL-MN-MN                 05142099
051430                 MOVE PC-S       TO ASC-SEL-4                     05143099
051520             END-IF                                               05152099
051530         END-IF                                                   05153099
051600     END-IF.                                                      05160074
051610     IF  AMNYYF  = DP015-ERASE-EOF                                05161099
051620     OR  AMNMNF  = DP015-ERASE-EOF                                05162099
051630         MOVE SPACES     TO ASC-FISCAL-MONTH                      05163099
051640     END-IF.                                                      05164099
051700                                                                  05170074
051800* PRINTER ID                                                      05180074
051900     IF  APRTRL   > ZERO                                          05190074
052000         MOVE APRTRI          TO ASC-PRINTER-ID                   05200089
052300     ELSE                                                         05230089
052310         MOVE SPACES          TO ASC-PRINTER-ID                   05231089
052320     END-IF.                                                      05232089
052400                                                                  05240074
052410******************************************************************05241094
052420** MAKE SURE THERE IS PO DATA FOR THE DATE REQUESTED              05242094
052430******************************************************************05243094
052440 2300-CHECK-PO-HISTORY-DATE.                                      05244094
052450     MOVE ASC-CRNT-BUS-YY TO  PV-CMPR-YY.                         05245094
052460     MOVE ASC-CRNT-BUS-MM TO  PV-CMPR-MM.                         05246094
052470     MOVE ASC-CRNT-BUS-DD TO  PV-CMPR-DD.                         05247094
052480     EXEC SQL                                                     05248094
052490         SELECT CURRENT DATE - FUNC_QTY DAYS                      05249094
052491           INTO   :PV-POHIST-DATE                                 05249194
052492           FROM  TKRPRPM                                          05249294
052493          WHERE SYS_PRC_FUNC_CDE = 'POHIST'                       05249394
052494            AND LOC_ID           = 90                             05249499
052495      END-EXEC.                                                   05249594
052496                                                                  05249694
052497       EVALUATE TRUE                                              05249794
052498          WHEN SQLCODE = +0                                       05249894
052499              IF PV-COMPARE-DATE >= PV-POHIST-DATE                05249994
052500                 SET PS-VALID-POHIST-DATE TO TRUE                 05250094
052501             ELSE                                                 05250194
052502                 SET PS-INVALID-POHIST-DATE TO TRUE               05250294
052503             END-IF                                               05250394
052504          WHEN OTHER                                              05250494
052505              MOVE '2300-CHECK-PO-HISTORY-DAT' TO DP013-PARAGRAPH 05250594
052506              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)05250694
052507              MOVE SQLCA   TO DP013-SQLCA                         05250794
052508              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         05250894
052509              SET DP013-DB2-ABEND                                 05250994
052510                  DP013-XCTL-DISPLAY-RESTART TO TRUE              05251094
052511              PERFORM DP013-0000-PROCESS-ABEND                    05251194
052512      END-EVALUATE.                                               05251294
052513                                                                  05251394
052520*----------------------------------------------------------------*05252074
052600* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *05260074
052700* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *05270074
052800* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*05280074
052900* IN THE DESTINATION PROGRAM, NOT HERE.                          *05290074
053000*----------------------------------------------------------------*05300074
053100 3000-EDIT-DATA-IN-COMMAREA.                                      05310074
053200                                                                  05320074
053300     PERFORM 3200-RESET-ATTRIBUTES.                               05330074
053400                                                                  05340074
053500*-----------------------------------------------------------------05350074
053600* VERIFY THAT OPER UNIT ID IS NUMERIC                             05360074
053700*-----------------------------------------------------------------05370074
053800     IF  PS-NO-ERROR                                              05380074
053900         IF  ASC-OPER-UNT-ID-X NOT = SPACES                       05390099
054000             MOVE ASC-OPER-UNT-ID-X      TO DP010I-UNEDITED-FIELD 05400099
054100             MOVE LENGTH OF ASC-OPER-UNT-ID-X  TO                 05410099
054200                                            DP010I-MAXIMUM-DIGITS 05420074
054300             MOVE ZERO TO DP010I-MAXIMUM-DECIMALS                 05430074
054400             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              05440074
054510             CALL DP010I-NUMERIC-EDIT-ROUTINE                     05451099
054520                         USING DP010I-NUMERIC-EDIT-AREA           05452099
054600             IF  DP010I-ERROR-DETECTED                            05460074
054700                 SET PS-ERROR                                     05470074
054800                     DP020-MSG-FATAL         TO TRUE              05480074
054900                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  05490074
055000                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            05500074
055100                 MOVE DP015-RED              TO AOPERC            05510074
055200                 MOVE DP015-REVERSE          TO AOPERH            05520074
055300                 MOVE -1                     TO AOPERL            05530074
055400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05540074
055500             ELSE                                                 05550074
055600                 MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID     05560074
055700                 MOVE ASC-OPER-UNT-ID      TO AOPERO              05570074
055800             END-IF                                               05580074
055900         END-IF                                                   05590074
056000     END-IF.                                                      05600074
056100                                                                  05610074
056200*-----------------------------------------------------------------05620074
056300* VERIFY THAT OPER UNIT IS A DC                                   05630099
056400*-----------------------------------------------------------------05640074
056500     IF  PS-NO-ERROR                                              05650074
056600         IF  ASC-OPER-UNT-ID >  ZEROES                            05660074
056700             MOVE  ASC-OPER-UNT-ID TO  DK-OPER-UNT-ID             05670074
056800             EXEC SQL                                             05680074
056900                  SELECT LOC_NM                                   05690099
056910                        ,LOC_TYP_CDE                              05691099
057000                    INTO :XLT00010-LOC-NM                         05700099
057010                        ,:XLT00010-LOC-TYP-CDE                    05701099
057100                    FROM XLT_LOC                                  05710099
057200                  WHERE LOC_NBR  =  :DK-OPER-UNT-ID               05720099
057300              END-EXEC                                            05730074
057400                                                                  05740074
057500              EVALUATE TRUE                                       05750074
057600                  WHEN SQLCODE = +0                               05760074
057700                      IF XLT00010-LOC-TYP-CDE = 'DC'              05770099
057710                         MOVE XLT00010-LOC-NM    TO ASC-OPER-NAME 05771099
057720                      ELSE                                        05772099
057730                          MOVE SPACES            TO ASC-OPER-NAME 05773099
057740                          SET PS-ERROR                            05774099
057750                              DP020-MSG-FATAL    TO TRUE          05775099
057760                           MOVE PC-TSYMSG-02572 TO                05776099
057761                                                 DP020-MSG-NUMBER 05776199
057770                           MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA  05777099
057780                           MOVE DP015-RED              TO AOPERC  05778099
057790                           MOVE DP015-REVERSE          TO AOPERH  05779099
057791                           MOVE -1                     TO AOPERL  05779199
057792                           SET DP030-SET-CURSOR-APPL-1 TO TRUE    05779299
057793                      END-IF                                      05779399
057800                  WHEN SQLCODE = +100                             05780074
057900                       MOVE SPACES      TO ASC-OPER-NAME          05790074
058000                       SET PS-ERROR                               05800074
058100                           DP020-MSG-FATAL         TO TRUE        05810074
058200                       MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER 05820074
058300                       MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA      05830074
058400                       MOVE DP015-RED              TO AOPERC      05840074
058500                       MOVE DP015-REVERSE          TO AOPERH      05850074
058600                       MOVE -1                     TO AOPERL      05860074
058700                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        05870074
058800                  WHEN OTHER                                      05880074
058900                      MOVE '3000-EDIT-DATA-IN-COMMAREA'           05890074
059000                                               TO DP013-PARAGRAPH 05900074
059100                      MOVE 'VALIDATE OPER NBR'                    05910099
059200                                       TO DP013-MESSAGE-TEXT (1)  05920074
059300                      MOVE SQLCA   TO DP013-SQLCA                 05930074
059400                      MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1) 05940099
059500                      SET DP013-DB2-ABEND                         05950074
059600                          DP013-XCTL-DISPLAY-RESTART TO TRUE      05960074
059700                      PERFORM DP013-0000-PROCESS-ABEND            05970074
059800             END-EVALUATE                                         05980074
059900         END-IF                                                   05990074
060000     END-IF.                                                      06000074
060100                                                                  06010074
060200*-----------------------------------------------------------------06020074
060300* MAKE SURE THAT ONLY ONE OPTION IS SELECTED                      06030074
060400*-----------------------------------------------------------------06040074
060500     IF  PS-NO-ERROR                                              06050074
060600         IF  ASC-SEL-1  =  SPACES  AND ASC-SEL-2 = SPACES AND     06060099
060700             ASC-SEL-3  =  SPACES  AND ASC-SEL-4 = SPACES         06070099
060800             SET PS-ERROR                                         06080074
060900                 DP020-MSG-FATAL         TO TRUE                  06090074
061000             MOVE PC-TSYMSG-00397        TO DP020-MSG-NUMBER      06100099
061100             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A                06110074
061200                                            ASEL2A                06120074
061300                                            ASEL3A                06130074
061400                                            ASEL4A                06140074
061500             MOVE DP015-RED              TO ASEL1C                06150074
061600                                            ASEL2C                06160074
061700                                            ASEL3C                06170074
061800                                            ASEL4C                06180074
061900             MOVE DP015-REVERSE          TO ASEL1H                06190074
062000                                            ASEL2H                06200074
062100                                            ASEL3H                06210074
062200                                            ASEL4H                06220074
062300             MOVE -1                     TO ASEL1L                06230074
062400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06240074
062500         ELSE                                                     06250074
062600         IF  ASC-SEL-1  =  PC-S  AND ASC-SEL-2 = PC-S  AND        06260099
062700             ASC-SEL-3  =  PC-S                                   06270099
062800             SET PS-ERROR                                         06280074
062900                 DP020-MSG-FATAL         TO TRUE                  06290074
063000             MOVE PC-TSYMSG-00973        TO DP020-MSG-NUMBER      06300074
063100             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A                06310074
063200                                            ASEL2A                06320074
063300                                            ASEL3A                06330074
063400             MOVE DP015-RED              TO ASEL1C                06340074
063500                                            ASEL2C                06350074
063600                                            ASEL3C                06360074
063700             MOVE DP015-REVERSE          TO ASEL1H                06370074
063800                                            ASEL2H                06380074
063900                                            ASEL3H                06390074
064000             MOVE -1                     TO ASEL1L                06400074
064100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06410074
064200         ELSE                                                     06420074
064300         IF  ASC-SEL-1  = PC-S  AND ASC-SEL-2 = PC-S              06430099
064400             SET PS-ERROR                                         06440074
064500                 DP020-MSG-FATAL         TO TRUE                  06450074
064600             MOVE PC-TSYMSG-00973        TO DP020-MSG-NUMBER      06460074
064700             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A                06470074
064800                                            ASEL2A                06480074
064900             MOVE DP015-RED              TO ASEL1C                06490074
065000                                            ASEL2C                06500074
065100             MOVE DP015-REVERSE          TO ASEL1H                06510074
065200                                            ASEL2H                06520074
065300             MOVE -1                     TO ASEL1L                06530074
065400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06540074
065500         ELSE                                                     06550074
065600         IF  ASC-SEL-1  =  PC-S  AND ASC-SEL-3 = PC-S AND         06560099
065700             ASC-SEL-4  =  PC-S                                   06570099
065800             SET PS-ERROR                                         06580074
065900                 DP020-MSG-FATAL         TO TRUE                  06590074
066000             MOVE PC-TSYMSG-00973        TO DP020-MSG-NUMBER      06600074
066100             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A                06610074
066200                                            ASEL3A                06620074
066300                                            ASEL4A                06630074
066400             MOVE DP015-RED              TO ASEL1C                06640074
066500                                            ASEL3C                06650074
066600                                            ASEL4C                06660074
066700             MOVE DP015-REVERSE          TO ASEL1H                06670074
066800                                            ASEL3H                06680074
066900                                            ASEL4H                06690074
067000             MOVE -1                     TO ASEL1L                06700074
067100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06710074
067200         ELSE                                                     06720074
067300         IF  ASC-SEL-1  = PC-S  AND  ASC-SEL-3 = PC-S             06730099
067400             SET PS-ERROR                                         06740074
067500                 DP020-MSG-FATAL         TO TRUE                  06750074
067600             MOVE PC-TSYMSG-00973        TO DP020-MSG-NUMBER      06760074
067700             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A                06770074
067800                                            ASEL3A                06780074
067900             MOVE DP015-RED              TO ASEL1C                06790074
068000                                            ASEL3C                06800074
068100             MOVE DP015-REVERSE          TO ASEL1H                06810074
068200                                            ASEL3H                06820074
068300             MOVE -1                     TO ASEL1L                06830074
068400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06840074
068500         ELSE                                                     06850074
068600         IF  ASC-SEL-1  =  PC-S  AND ASC-SEL-4 = PC-S             06860099
068700             SET PS-ERROR                                         06870074
068800                 DP020-MSG-FATAL         TO TRUE                  06880074
068900             MOVE PC-TSYMSG-00973     TO DP020-MSG-NUMBER         06890074
069000             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A                06900074
069100                                            ASEL4A                06910074
069200             MOVE DP015-RED              TO ASEL1C                06920074
069300                                            ASEL4C                06930074
069400             MOVE DP015-REVERSE          TO ASEL1H                06940074
069500                                            ASEL4H                06950074
069600             MOVE -1                     TO ASEL1L                06960074
069700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06970074
069800         ELSE                                                     06980074
069900         IF  ASC-SEL-2  =  PC-S  AND ASC-SEL-3 = PC-S AND         06990099
070000             ASC-SEL-4  =  PC-S                                   07000099
070100             SET PS-ERROR                                         07010074
070200                 DP020-MSG-FATAL         TO TRUE                  07020074
070300             MOVE PC-TSYMSG-00973     TO DP020-MSG-NUMBER         07030074
070400             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL2A                07040074
070500                                            ASEL3A                07050074
070600                                            ASEL4A                07060074
070700             MOVE DP015-RED              TO ASEL2C                07070074
070800                                            ASEL3C                07080074
070900                                            ASEL4C                07090074
071000             MOVE DP015-REVERSE          TO ASEL2H                07100074
071100                                            ASEL3H                07110074
071200                                            ASEL4H                07120074
071300             MOVE -1                     TO ASEL2L                07130074
071400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07140074
071500         ELSE                                                     07150074
071600         IF  ASC-SEL-2  =  PC-S  AND ASC-SEL-3 = PC-S             07160099
071700             SET PS-ERROR                                         07170074
071800                 DP020-MSG-FATAL         TO TRUE                  07180074
071900             MOVE PC-TSYMSG-00973     TO DP020-MSG-NUMBER         07190074
072000             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL2A                07200074
072100                                            ASEL3A                07210074
072200             MOVE DP015-RED              TO ASEL2C                07220074
072300                                            ASEL3C                07230074
072400             MOVE DP015-REVERSE          TO ASEL2H                07240074
072500                                            ASEL3H                07250074
072600             MOVE -1                     TO ASEL2L                07260074
072700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07270074
072800         ELSE                                                     07280074
072900         IF  ASC-SEL-2  =  PC-S  AND ASC-SEL-4 = PC-S             07290099
073000             SET PS-ERROR                                         07300074
073100                 DP020-MSG-FATAL         TO TRUE                  07310074
073200             MOVE PC-TSYMSG-00973     TO DP020-MSG-NUMBER         07320074
073300             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL2A                07330074
073400                                            ASEL4A                07340074
073500             MOVE DP015-RED              TO ASEL2C                07350074
073600                                            ASEL4C                07360074
073700             MOVE DP015-REVERSE          TO ASEL2H                07370074
073800                                            ASEL4H                07380074
073900             MOVE -1                     TO ASEL2L                07390074
074000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07400074
074100         ELSE                                                     07410074
074200         IF  ASC-SEL-3  =  PC-S  AND ASC-SEL-4 = PC-S             07420099
074300             SET PS-ERROR                                         07430074
074400                 DP020-MSG-FATAL         TO TRUE                  07440074
074500             MOVE PC-TSYMSG-00973     TO DP020-MSG-NUMBER         07450074
074600             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL3A                07460074
074700                                            ASEL4A                07470074
074800             MOVE DP015-RED              TO ASEL3C                07480074
074900                                            ASEL4C                07490074
075000             MOVE DP015-REVERSE          TO ASEL3H                07500074
075100                                            ASEL4H                07510074
075200             MOVE -1                     TO ASEL3L                07520074
075300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07530074
075400     END-IF.                                                      07540074
075500                                                                  07550074
075623*-----------------------------------------------------------------07562399
075624* IF A DATE IS SELECTED, ENSURE THAT A DATE IS ENTERED            07562499
075625*-----------------------------------------------------------------07562599
075626     IF  PS-NO-ERROR                                              07562699
075627         IF  ASC-SEL-1  =  PC-S AND ASC-CRNT-BUS-DTE <= SPACES    07562799
075630               SET PS-ERROR                                       07563099
075631                   DP020-MSG-FATAL         TO TRUE                07563199
075632               MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER         07563299
075633               MOVE DP015-UNP-ALP-BRT-OFF  TO ACRDDA              07563399
075634                                              ACRMMA              07563499
075635                                              ACRYYA              07563599
075636               MOVE DP015-RED              TO ACRDDC              07563699
075637                                              ACRMMC              07563799
075638                                              ACRYYC              07563899
075639               MOVE DP015-REVERSE          TO ACRDDH              07563999
075640                                              ACRMMH              07564099
075641                                              ACRYYH              07564199
075642               MOVE -1                     TO ACRMML              07564299
075643               SET DP030-SET-CURSOR-APPL-1 TO TRUE                07564399
075644         END-IF                                                   07564499
075645     END-IF.                                                      07564599
075646                                                                  07564699
075647*-----------------------------------------------------------------07564799
075648* IF DATE RANGE SELECTED, ENSURE THAT A FROM DATE IS ENTERED      07564899
075649*-----------------------------------------------------------------07564999
075650     IF  PS-NO-ERROR                                              07565099
075651         IF  ASC-SEL-2  =  PC-S AND ASC-FROM-DATE <= SPACES       07565199
075652               SET PS-ERROR                                       07565299
075653                   DP020-MSG-FATAL         TO TRUE                07565399
075654               MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER         07565499
075655               MOVE DP015-UNP-ALP-BRT-OFF  TO AFRDDA              07565599
075656                                              AFRMMA              07565699
075657                                              AFRYYA              07565799
075658               MOVE DP015-RED              TO AFRDDC              07565899
075659                                              AFRMMC              07565999
075660                                              AFRYYC              07566099
075661               MOVE DP015-REVERSE          TO AFRDDH              07566199
075662                                              AFRMMH              07566299
075663                                              AFRYYH              07566399
075664               MOVE -1                     TO AFRMML              07566499
075665               SET DP030-SET-CURSOR-APPL-1 TO TRUE                07566599
075666         END-IF                                                   07566699
075667     END-IF.                                                      07566799
075668                                                                  07566899
075669*-----------------------------------------------------------------07566999
075670* IF FISCAL WEEK SELECTED, ENSURE THAT A WEEK IS ENTERED          07567099
075671*-----------------------------------------------------------------07567199
075672     IF  PS-NO-ERROR                                              07567299
075673         IF  ASC-SEL-3  =  PC-S AND ASC-FISCAL-WEEK <= SPACES     07567399
075674               SET PS-ERROR                                       07567499
075675                   DP020-MSG-FATAL         TO TRUE                07567599
075676               MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER         07567699
075677               MOVE DP015-UNP-ALP-BRT-OFF  TO AWKYYA              07567799
075678                                              AWKWKA              07567899
075679               MOVE DP015-RED              TO AWKYYC              07567999
075680                                              AWKWKC              07568099
075681               MOVE DP015-REVERSE          TO AWKYYH              07568199
075682                                              AWKWKH              07568299
075683               MOVE -1                     TO AWKYYL              07568399
075684               SET DP030-SET-CURSOR-APPL-1 TO TRUE                07568499
075685         END-IF                                                   07568599
075686     END-IF.                                                      07568699
075687                                                                  07568799
075688*-----------------------------------------------------------------07568899
075689* IF FISCAL MONTH SELECTED, ENSURE THAT A MONTH IS ENTERED        07568999
075690*-----------------------------------------------------------------07569099
075691     IF  PS-NO-ERROR                                              07569199
075692         IF  ASC-SEL-4  =  PC-S AND ASC-FISCAL-MONTH <= SPACES    07569299
075693               SET PS-ERROR                                       07569399
075694                   DP020-MSG-FATAL         TO TRUE                07569499
075695               MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER         07569599
075696               MOVE DP015-UNP-ALP-BRT-OFF  TO AMNYYA              07569699
075697                                              AMNMNA              07569799
075698               MOVE DP015-RED              TO AMNYYC              07569899
075699                                              AMNMNC              07569999
075700               MOVE DP015-REVERSE          TO AMNYYH              07570099
075701                                              AMNMNH              07570199
075702               MOVE -1                     TO AMNYYL              07570299
075703               SET DP030-SET-CURSOR-APPL-1 TO TRUE                07570399
075704         END-IF                                                   07570499
075705     END-IF.                                                      07570599
075706                                                                  07570699
075707*-----------------------------------------------------------------07570799
075708* VERIFY PRINTER ID IS VALID                                      07570899
075709*-----------------------------------------------------------------07570999
075710     IF  PS-NO-ERROR                                              07571099
075711         IF  ASC-PRINTER-ID >  SPACES                             07571199
075712             PERFORM 5000-VALIDATE-PRINTER                        07571299
075713             IF  PS-INVALID-PRINTER                               07571399
075714                   SET PS-ERROR                                   07571499
075715                       DP020-MSG-FATAL         TO TRUE            07571599
075716                   MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER     07571699
075717                   MOVE DP015-UNP-ALP-BRT-OFF  TO APRTRA          07571799
075718                   MOVE DP015-RED              TO APRTRC          07571899
075719                   MOVE DP015-REVERSE          TO APRTRH          07571999
075720                   MOVE -1                     TO APRTRL          07572099
075721                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            07572199
075722              END-IF                                              07572299
075723         END-IF                                                   07572399
075724     END-IF.                                                      07572499
075725                                                                  07572599
075726*----------------------------------------------------------------*07572699
075730*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *07573099
075800*  MAP.                                                          *07580074
075900*----------------------------------------------------------------*07590074
076000 3200-RESET-ATTRIBUTES.                                           07600074
076100                                                                  07610074
076200     MOVE DP015-ASK-NOR-MDT        TO ANAMEA.                     07620074
076300                                                                  07630074
076400     MOVE DP015-UNP-ALP-NOR-MDT    TO ASEL1A                      07640074
076500                                      ASEL2A                      07650074
076600                                      ASEL3A                      07660074
076700                                      ASEL4A                      07670099
076710                                      APRTRA.                     07671099
076800                                                                  07680074
076900     MOVE DP015-UNP-NUM-NOR-MDT    TO AOPERA                      07690074
077000                                      ACRMMA                      07700074
077100                                      ACRDDA                      07710074
077200                                      ACRYYA                      07720074
077300                                      AFRMMA                      07730074
077400                                      AFRDDA                      07740074
077500                                      AFRYYA                      07750074
077600                                      ATOMMA                      07760074
077700                                      ATODDA                      07770074
077800                                      ATOYYA                      07780074
077900                                      AWKYYA                      07790074
078000                                      AWKWKA                      07800074
078100                                      AMNYYA                      07810074
078200                                      AMNMNA.                     07820099
078400                                                                  07840074
078500     MOVE DP015-GREEN              TO AOPERC                      07850074
078600                                      ASEL1C                      07860074
078700                                      ASEL2C                      07870074
078800                                      ASEL3C                      07880074
078900                                      ASEL4C                      07890074
079000                                      ACRMMC                      07900074
079100                                      ACRDDC                      07910074
079200                                      ACRYYC                      07920074
079300                                      AFRMMC                      07930074
079400                                      AFRDDC                      07940074
079500                                      AFRYYC                      07950074
079600                                      ATOMMC                      07960074
079700                                      ATODDC                      07970074
079800                                      ATOYYC                      07980074
079900                                      AWKYYC                      07990074
080000                                      AWKWKC                      08000074
080100                                      AMNYYC                      08010074
080200                                      AMNMNC                      08020074
080300                                      APRTRC                      08030074
080400                                                                  08040074
080500     MOVE DP015-BLUE               TO ANAMEC.                     08050074
080600                                                                  08060074
080700     MOVE DP015-UNDERLINE          TO AOPERH                      08070074
080800                                      ASEL1H                      08080074
080900                                      ASEL2H                      08090074
081000                                      ASEL3H                      08100074
081100                                      ASEL4H                      08110074
081200                                      ACRMMH                      08120074
081300                                      ACRDDH                      08130074
081400                                      ACRYYH                      08140074
081500                                      AFRMMH                      08150074
081600                                      AFRDDH                      08160074
081700                                      AFRYYH                      08170074
081800                                      ATOMMH                      08180074
081900                                      ATODDH                      08190074
082000                                      ATOYYH                      08200074
082100                                      AWKYYH                      08210074
082200                                      AWKWKH                      08220074
082300                                      AMNYYH                      08230074
082400                                      AMNMNH                      08240074
082500                                      APRTRH.                     08250074
082600                                                                  08260074
082700*----------------------------------------------------------------*08270074
082800*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *08280074
082900*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *08290074
083000*  IT HERE.                                                      *08300074
083100*----------------------------------------------------------------*08310074
083200 4000-BUILD-INITIAL-PANEL.                                        08320074
083300     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       08330074
083400                                                                  08340074
083500     PERFORM 4100-CHECK-OPER-UNT.                                 08350074
083600     PERFORM 4200-GET-TKRPRPM.                                    08360074
083700     PERFORM 4300-GET-SHIFT.                                      08370074
083701     IF ASC-FSL-MN-YY   > SPACES                                  08370199
083702         MOVE ASC-FSL-MN-YY  TO PV-KEY-YR                         08370299
083703         MOVE ASC-FSL-MN-MN  TO PV-KEY-MN                         08370399
083704         MOVE -1              TO ASEL4L                           08370499
083705         MOVE PC-S            TO ASEL4O                           08370599
083706                                ASC-SEL-4                         08370699
083707         PERFORM 2107-VALIDATE-MNTH                               08370799
083718     ELSE                                                         08371899
083719         IF ASC-FSL-WK-YY       > SPACES                          08371999
083720             MOVE ASC-FSL-WK-YY  TO PV-KEY-YEAR                   08372099
083721             MOVE ASC-FSL-WK-WK  TO PV-KEY-WK                     08372199
083722             MOVE -1              TO ASEL3L                       08372299
083723             MOVE PC-S            TO ASEL3O                       08372399
083724                                     ASC-SEL-3                    08372499
083725             PERFORM 2106-VALIDATE-WEEK                           08372599
083726         ELSE                                                     08372699
083727             IF ASC-FROM-DTE-YY       > SPACES                    08372799
083728                 MOVE ASC-FROM-DTE-YY TO PV-KEY-YY                08372899
083729                 MOVE ASC-FROM-DTE-MM TO PV-KEY-MM                08372999
083730                 MOVE ASC-FROM-DTE-DD TO PV-KEY-DD                08373099
083731                 PERFORM 4351-GET-TDTATTR                         08373199
083732                 MOVE -1              TO ASEL2L                   08373299
083733                 MOVE PC-S            TO ASEL2O                   08373399
083734                                         ASC-SEL-2                08373499
083735             ELSE                                                 08373599
083736                 IF ASC-CRNT-BUS-YY       > SPACES                08373699
083737                     MOVE ASC-CRNT-BUS-YY TO PV-KEY-YY            08373799
083738                     MOVE ASC-CRNT-BUS-MM TO PV-KEY-MM            08373899
083739                     MOVE ASC-CRNT-BUS-DD TO PV-KEY-DD            08373999
083740                     PERFORM 4350-GET-TDTATTR                     08374099
083741                     MOVE -1              TO ASEL1L               08374199
083742                     MOVE PC-S            TO ASEL1O               08374299
083743                                             ASC-SEL-1            08374399
083744                 ELSE                                             08374499
083745                     PERFORM 4350-GET-TDTATTR                     08374599
083746                     MOVE -1              TO ASEL1L               08374699
083747                     MOVE PC-S            TO ASEL1O               08374799
083748                                             ASC-SEL-1            08374899
083749                 END-IF                                           08374999
083750             END-IF                                               08375099
083751         END-IF                                                   08375199
083752     END-IF.                                                      08375299
083753     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     08375374
083760     MOVE ASC-OPER-NAME            TO ANAMEO.                     08376074
083770     MOVE ASC-CRNT-BUS-MM          TO ACRMMO.                     08377074
083780     MOVE ASC-CRNT-BUS-DD          TO ACRDDO.                     08378074
083790     MOVE ASC-CRNT-BUS-YY          TO ACRYYO.                     08379074
083800     MOVE ASC-FROM-DTE-MM          TO AFRMMO.                     08380074
083900     MOVE ASC-FROM-DTE-DD          TO AFRDDO.                     08390074
084000     MOVE ASC-FROM-DTE-YY          TO AFRYYO.                     08400074
084100     MOVE ASC-TO-DTE-MM            TO ATOMMO.                     08410074
084200     MOVE ASC-TO-DTE-DD            TO ATODDO.                     08420074
084300     MOVE ASC-TO-DTE-YY            TO ATOYYO.                     08430074
084400     MOVE ASC-FSL-WK-YY            TO AWKYYO.                     08440074
084500     MOVE ASC-FSL-WK-WK            TO AWKWKO.                     08450074
084600     MOVE ASC-FSL-MN-YY            TO AMNYYO.                     08460074
084700     MOVE ASC-FSL-MN-MN            TO AMNMNO.                     08470074
084800     MOVE ASC-PRINTER-ID           TO APRTRO.                     08480079
084900                                                                  08490074
085000*----------------------------------------------------------------*08500074
085100*  CHECK TO SEE IF ASSOCIATE IS FROM A DC.  IF YES, USE THAT OPER 08510074
085200*  UNIT ID ON THE SCREEN.                                        *08520074
085300*----------------------------------------------------------------*08530074
085400 4100-CHECK-OPER-UNT.                                             08540074
085500                                                                  08550074
085600     IF ASC-OPER-UNT-ID > ZEROES                                  08560075
085610         MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID                08561075
085611     ELSE                                                         08561175
085620         MOVE DP020-LOCATION-NBR TO DK-OPER-UNT-ID                08562099
085630     END-IF.                                                      08563075
085700     EXEC SQL                                                     08570074
085800          SELECT LOC_NM                                           08580099
085900                ,LOC_NBR                                          08590099
086000                ,LOC_TYP_CDE                                      08600099
086100            INTO :XLT00010-LOC-NM                                 08610099
086200                ,:XLT00010-LOC-NBR                                08620099
086300                ,:XLT00010-LOC-TYP-CDE                            08630099
086400            FROM XLT_LOC                                          08640099
086500          WHERE LOC_NBR  =  :DK-OPER-UNT-ID                       08650099
086600      END-EXEC.                                                   08660074
086700                                                                  08670074
086800      EVALUATE TRUE                                               08680074
086900          WHEN SQLCODE = +0                                       08690074
087000              IF PS-RETURN-TRUE  AND ASC-OPER-UNT-ID <= ZEROS     08700099
087001                  MOVE SPACES            TO ASC-OPER-UNT-ID-X     08700199
087002                                            ASC-OPER-NAME         08700299
087003              ELSE                                                08700399
087010                  IF XLT00010-LOC-TYP-CDE = 'DC'                  08701099
087100                      MOVE XLT00010-LOC-NBR   TO ASC-OPER-UNT-ID  08710099
087200                      MOVE XLT00010-LOC-NM    TO ASC-OPER-NAME    08720099
087300                  ELSE                                            08730099
087400                      MOVE SPACES            TO ASC-OPER-UNT-ID-X 08740099
087500                                                ASC-OPER-NAME     08750099
087600                  END-IF                                          08760099
087610              END-IF                                              08761099
087700          WHEN SQLCODE = +100                                     08770074
087800              MOVE SPACES            TO ASC-OPER-UNT-ID-X         08780074
087900                                        ASC-OPER-NAME             08790074
088000          WHEN OTHER                                              08800074
088100              MOVE '4100-CHECK-OPER-UNT'   TO DP013-PARAGRAPH     08810074
088200              MOVE 'CHECKING FOR DC' TO DP013-MESSAGE-TEXT (1)    08820074
088300              MOVE SQLCA   TO DP013-SQLCA                         08830074
088400              MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)         08840099
088500              SET DP013-DB2-ABEND                                 08850074
088600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              08860074
088700              PERFORM DP013-0000-PROCESS-ABEND                    08870074
088800      END-EVALUATE.                                               08880074
088900                                                                  08890074
089000*----------------------------------------------------------------*08900074
089100*    RETRIEVE THE TIMEZN SYS-PRC-FUNC-CDE TO DETERMINE THE NUMBER 08910074
089200*    OF HOURS TO ADD OR SUBTRACT FROM THE CURRENT TIME INORDER    08920074
089210*    TO BE IN THE CORRECT TIMEZONE.                               08921074
089220*----------------------------------------------------------------*08922074
089230 4200-GET-TKRPRPM.                                                08923074
089240                                                                  08924074
089250     IF ASC-OPER-UNT-ID-X = SPACES                                08925074
089260         MOVE PC-85 TO DK-OPER-UNT-ID                             08926074
089270     END-IF                                                       08927074
089271                                                                  08927174
089272     EXEC SQL                                                     08927274
089273         SELECT (CURRENT TIMESTAMP  + FUNC_QTY HOURS)             08927374
089274               ,(CURRENT TIMESTAMP  + FUNC_QTY HOURS) + 1 DAY     08927474
089275               ,(CURRENT TIMESTAMP  + FUNC_QTY HOURS) - 1 DAY     08927599
089276           INTO   :PV-CURRENT-TMST                                08927674
089277                 ,:PV-BUSINES-DATE                                08927774
089278                 ,:PV-BUSINES-DATE-PREV                           08927899
089279           FROM   TKRPRPM                                         08927999
089280          WHERE LOC_ID           = :DK-OPER-UNT-ID                08928099
089281            AND SYS_PRC_FUNC_CDE = :PC-TIMEZN                     08928199
089282      END-EXEC.                                                   08928299
089290                                                                  08929074
089300       EVALUATE TRUE                                              08930074
089310          WHEN SQLCODE = +0                                       08931074
089311              MOVE PV-CURR-HH  TO PV-SHFT-HH                      08931174
089312              MOVE PV-CURR-MN  TO PV-SHFT-MN                      08931274
089313              MOVE PV-CURR-SS  TO PV-SHFT-SS                      08931374
089314              MOVE '.'         TO PV-PERIOD-1                     08931474
089315                                  PV-PERIOD-2                     08931574
089316          WHEN OTHER                                              08931674
089317              MOVE '4200-GET-TKRPRPM   '   TO DP013-PARAGRAPH     08931774
089318              MOVE 'GETTING TIMEZN INFO' TO DP013-MESSAGE-TEXT (1)08931874
089319              MOVE SQLCA   TO DP013-SQLCA                         08931974
089320              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         08932074
089330              SET DP013-DB2-ABEND                                 08933074
089331                  DP013-XCTL-DISPLAY-RESTART TO TRUE              08933174
089332              PERFORM DP013-0000-PROCESS-ABEND                    08933274
089333      END-EVALUATE.                                               08933374
089334                                                                  08933474
089366*----------------------------------------------------------------*08936677
089367*    LOOK AT SHIFT TABLE TO SEE IF DATE NEEDS TO BE INCREMENTED.  08936777
089368*----------------------------------------------------------------*08936877
089369 4300-GET-SHIFT.                                                  08936977
089370                                                                  08937077
089371     EXEC SQL                                                     08937177
089372         SELECT SHFT_BEG_TM                                       08937296
089373               ,SHFT_END_TM                                       08937396
089374               ,SHFT_NBR                                          08937496
089376           INTO :PCT00004-SHFT-BEG-TM                             08937696
089377               ,:PCT00004-SHFT-END-TM                             08937796
089378               ,:PCT00004-SHFT-NBR                                08937896
089380           FROM   PCT_SHFT                                        08938096
089381          WHERE OPER_UNT_ID      = :DK-OPER-UNT-ID                08938196
089390            AND ((SHFT_BEG_TM <= :PV-SHIFT-TIME                   08939097
089391            AND   SHFT_END_TM >= :PV-SHIFT-TIME)                  08939197
089392             OR  (SHFT_END_TM >= :PV-SHIFT-TIME                   08939297
089393            AND   SHFT_BEG_TM > SHFT_END_TM)                      08939397
089394             OR  (SHFT_BEG_TM <= :PV-SHIFT-TIME                   08939497
089400            AND   SHFT_BEG_TM > SHFT_END_TM))                     08940097
089500      END-EXEC.                                                   08950074
089600                                                                  08960074
089700       EVALUATE TRUE                                              08970074
089800          WHEN SQLCODE = +0                                       08980074
089810            MOVE '-'               TO PV-DASH-1                   08981099
089820                                      PV-DASH-2                   08982099
089900            IF  PCT00004-SHFT-BEG-TM > PCT00004-SHFT-END-TM       08990099
089901                IF PCT00004-SHFT-NBR = 2                          08990199
089902                   PERFORM 4250-CHECK-OVERLAPPING-SHIFTS          08990299
089903                END-IF                                            08990399
089904                IF PS-DONE-CHECKING                               08990499
089905                   CONTINUE                                       08990599
089906                ELSE                                              08990699
089910                  IF  PV-SHIFT-TIME >= PCT00004-SHFT-BEG-TM       08991099
089920                  AND PV-SHIFT-TIME < PV-END-TM                   08992099
089930                      MOVE PV-BUSN-YY      TO PV-KEY-YY           08993099
089940                      MOVE PV-BUSN-MM      TO PV-KEY-MM           08994099
089950                      MOVE PV-BUSN-DD      TO PV-KEY-DD           08995099
090500                  ELSE                                            09050099
090600                      MOVE PV-CURR-YY      TO PV-KEY-YY           09060099
090700                      MOVE PV-CURR-MM      TO PV-KEY-MM           09070099
090800                      MOVE PV-CURR-DD      TO PV-KEY-DD           09080099
090830                  END-IF                                          09083099
090831                END-IF                                            09083199
090832            ELSE                                                  09083299
090833                MOVE PV-CURR-YY        TO PV-KEY-YY               09083399
090834                MOVE PV-CURR-MM        TO PV-KEY-MM               09083499
090835                MOVE PV-CURR-DD        TO PV-KEY-DD               09083599
090836            END-IF                                                09083699
090840          WHEN SQLCODE = +100                                     09084074
090841            MOVE '-'               TO PV-DASH-1                   09084199
090842                                      PV-DASH-2                   09084299
090850            MOVE PV-CURR-YY        TO PV-KEY-YY                   09085099
090860            MOVE PV-CURR-MM        TO PV-KEY-MM                   09086099
090870            MOVE PV-CURR-DD        TO PV-KEY-DD                   09087099
090900          WHEN OTHER                                              09090074
091000            MOVE '4300-GET-SHIFT     '   TO DP013-PARAGRAPH       09100099
091100            MOVE 'GETTING SHIFT INFO' TO DP013-MESSAGE-TEXT (1)   09110099
091200            MOVE SQLCA   TO DP013-SQLCA                           09120099
091300            MOVE 'PCT_SHFT' TO DP013-DB2-TABLE-NAME (1)           09130099
091400            SET DP013-DB2-ABEND                                   09140099
091500                DP013-XCTL-DISPLAY-RESTART TO TRUE                09150099
091600            PERFORM DP013-0000-PROCESS-ABEND                      09160099
091700      END-EVALUATE.                                               09170074
091800                                                                  09180074
091801*----------------------------------------------------------------*09180199
091802*    CHECK FOR THE CORRECT BUSINESS DATE WHEN A SHIFT SPANS TWO   09180299
091803*    DAYS.                                                        09180399
091804*----------------------------------------------------------------*09180499
091810 4250-CHECK-OVERLAPPING-SHIFTS.                                   09181099
091820     IF  (PCT00004-SHFT-BEG-TM  < PV-END-TM AND                   09182099
091830          PCT00004-SHFT-END-TM  > PC-BEG-TM )                     09183099
091840            IF PV-SHIFT-TIME > PCT00004-SHFT-BEG-TM AND           09184099
091850               PV-SHIFT-TIME < PV-END-TM                          09185099
091880                  MOVE PV-CURR-YY        TO PV-KEY-YY             09188099
091891                  MOVE PV-CURR-MM        TO PV-KEY-MM             09189199
091893                  MOVE PV-CURR-DD        TO PV-KEY-DD             09189399
091895                 SET PS-DONE-CHECKING    TO TRUE                  09189599
091896            ELSE                                                  09189699
091899                 MOVE PV-BUSN-YY-PREV    TO PV-KEY-YY             09189999
091901                 MOVE PV-BUSN-MM-PREV    TO PV-KEY-MM             09190199
091903                 MOVE PV-BUSN-DD-PREV    TO PV-KEY-DD             09190399
091905                 SET PS-DONE-CHECKING    TO TRUE                  09190599
091906            END-IF                                                09190699
091907     ELSE                                                         09190799
091908            SET PS-CONTINUE-CHECKING TO TRUE                      09190899
091909     END-IF.                                                      09190999
091910                                                                  09191099
091920*----------------------------------------------------------------*09192074
092000*    VALIDATE THE DATE AND RETRIEVE THE FISCAL WEEK, MONTH, AND   09200074
092100*    YEAR.                                                        09210074
092200*----------------------------------------------------------------*09220074
092300 4350-GET-TDTATTR.                                                09230074
092400                                                                  09240074
092500     EXEC SQL                                                     09250074
092600          SELECT FSCL_YR_NBR                                      09260074
092700                ,FSCL_MN_NBR                                      09270074
092800                ,FSCL_WK_NBR                                      09280074
092900            INTO :DTATTR-FSCL-YR-NBR                              09290074
093000                ,:DTATTR-FSCL-MN-NBR                              09300074
093100                ,:DTATTR-FSCL-WK-NBR                              09310074
093200            FROM TDTATTR                                          09320074
093300          WHERE KY_DTE   =  :PV-KEY-DATE                          09330074
093400      END-EXEC.                                                   09340074
093500                                                                  09350074
093600      EVALUATE TRUE                                               09360074
093700          WHEN SQLCODE = +0                                       09370074
093800              MOVE PV-KEY-YY          TO ASC-TO-DTE-YY            09380074
093900                                         ASC-CRNT-BUS-YY          09390074
094000              MOVE PV-KEY-MM          TO ASC-TO-DTE-MM            09400074
094100                                         ASC-CRNT-BUS-MM          09410074
094200              MOVE PV-KEY-DD          TO ASC-TO-DTE-DD            09420074
094300                                         ASC-CRNT-BUS-DD          09430074
094400              MOVE DTATTR-FSCL-YR-NBR TO ASC-FSL-WK-YY            09440074
094500                                         ASC-FSL-MN-YY            09450074
094600              MOVE DTATTR-FSCL-MN-NBR TO ASC-FSL-MN-MN            09460074
094700              MOVE DTATTR-FSCL-WK-NBR TO ASC-FSL-WK-WK            09470074
094800          WHEN SQLCODE = +100                                     09480074
094900              SET PS-ERROR                                        09490074
095000                  DP020-MSG-FATAL         TO TRUE                 09500074
095100              MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER     09510074
095200              MOVE DP015-UNP-ALP-BRT-OFF  TO ACRYYA               09520074
095300                                             ACRMMA               09530074
095400                                             ACRDDA               09540074
095500              MOVE DP015-RED              TO ACRYYC               09550074
095600                                             ACRMMC               09560074
095700                                             ACRDDC               09570074
095800              MOVE DP015-REVERSE          TO ACRYYH               09580074
095900                                             ACRMMH               09590074
096000                                             ACRDDH               09600074
096100              MOVE -1                     TO ACRMML               09610074
096200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 09620074
096300          WHEN OTHER                                              09630074
096400              MOVE '4350-GET-TDTATTR   '   TO DP013-PARAGRAPH     09640074
096500              MOVE 'GETTING TDTATTR  ' TO DP013-MESSAGE-TEXT (1)  09650074
096600              MOVE SQLCA   TO DP013-SQLCA                         09660074
096700              MOVE 'TDTATTR ' TO DP013-DB2-TABLE-NAME (1)         09670074
096800              SET DP013-DB2-ABEND                                 09680074
096900                  DP013-XCTL-DISPLAY-RESTART TO TRUE              09690074
097000              PERFORM DP013-0000-PROCESS-ABEND                    09700074
097100      END-EVALUATE.                                               09710074
097200                                                                  09720074
097300*----------------------------------------------------------------*09730074
097400*    VALIDATE THE DATE RANGE                                      09740074
097500*----------------------------------------------------------------*09750074
097600 4351-GET-TDTATTR.                                                09760074
097700                                                                  09770074
097800     EXEC SQL                                                     09780074
097900          SELECT FSCL_YR_NBR                                      09790074
098000                ,FSCL_MN_NBR                                      09800074
098100                ,FSCL_WK_NBR                                      09810074
098200            INTO :DTATTR-FSCL-YR-NBR                              09820074
098300                ,:DTATTR-FSCL-MN-NBR                              09830074
098400                ,:DTATTR-FSCL-WK-NBR                              09840074
098500            FROM TDTATTR                                          09850074
098600          WHERE KY_DTE   =  :PV-KEY-DATE                          09860074
098700      END-EXEC.                                                   09870074
098800                                                                  09880074
098900      EVALUATE TRUE                                               09890074
099000          WHEN SQLCODE = +0                                       09900074
099070              MOVE DTATTR-FSCL-YR-NBR TO ASC-FSL-WK-YY            09907099
099080                                         ASC-FSL-MN-YY            09908099
099090              MOVE DTATTR-FSCL-MN-NBR TO ASC-FSL-MN-MN            09909099
099091              MOVE DTATTR-FSCL-WK-NBR TO ASC-FSL-WK-WK            09909199
099200          WHEN SQLCODE = +100                                     09920074
099300              SET PS-ERROR                                        09930074
099400                  DP020-MSG-FATAL         TO TRUE                 09940074
099500              MOVE PC-TSYMSG-02416        TO DP020-MSG-NUMBER     09950074
099600              MOVE DP015-UNP-ALP-BRT-OFF  TO AFRYYA               09960074
099700                                             AFRMMA               09970074
099800                                             AFRDDA               09980074
099900              MOVE DP015-RED              TO AFRYYC               09990074
100000                                             AFRMMC               10000074
100100                                             AFRDDC               10010074
100200              MOVE DP015-REVERSE          TO AFRYYH               10020074
100300                                             AFRMMH               10030074
100400                                             AFRDDH               10040074
100500              MOVE -1                     TO AFRMML               10050074
100600              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 10060074
100700          WHEN OTHER                                              10070074
100800              MOVE '4351-GET-TDTATTR   '   TO DP013-PARAGRAPH     10080074
100900              MOVE 'GETTING TDTATTR  ' TO DP013-MESSAGE-TEXT (1)  10090074
101000              MOVE SQLCA   TO DP013-SQLCA                         10100074
101100              MOVE 'TDTATTR ' TO DP013-DB2-TABLE-NAME (1)         10110074
101200              SET DP013-DB2-ABEND                                 10120074
101300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              10130074
101400              PERFORM DP013-0000-PROCESS-ABEND                    10140074
101500      END-EVALUATE.                                               10150074
101600                                                                  10160074
101700*----------------------------------------------------------------*10170074
101800*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *10180074
101900*----------------------------------------------------------------*10190074
102000 4400-MOVE-COMMAREA-TO-SCREEN.                                    10200074
102100     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     10210074
102200     MOVE ASC-OPER-NAME            TO ANAMEO.                     10220074
102300     MOVE ASC-CRNT-BUS-MM          TO ACRMMO.                     10230074
102400     MOVE ASC-CRNT-BUS-DD          TO ACRDDO.                     10240074
102500     MOVE ASC-CRNT-BUS-YY          TO ACRYYO.                     10250074
102600     MOVE ASC-FROM-DTE-MM          TO AFRMMO.                     10260099
102700     MOVE ASC-FROM-DTE-DD          TO AFRDDO.                     10270099
102800     MOVE ASC-FROM-DTE-YY          TO AFRYYO.                     10280099
102810     MOVE ASC-TO-DTE-MM            TO ATOMMO.                     10281099
102820     MOVE ASC-TO-DTE-DD            TO ATODDO.                     10282099
102830     MOVE ASC-TO-DTE-YY            TO ATOYYO.                     10283099
102900     MOVE ASC-FSL-WK-YY            TO AWKYYO.                     10290074
103000     MOVE ASC-FSL-WK-WK            TO AWKWKO.                     10300074
103100     MOVE ASC-FSL-MN-YY            TO AMNYYO.                     10310074
103200     MOVE ASC-FSL-MN-MN            TO AMNMNO.                     10320074
103300     MOVE ASC-PRINTER-ID           TO APRTRO.                     10330079
103400                                                                  10340074
103410*-----------------------------------------------------------------10341079
103420* VALIDATE PRINTER ID.                                            10342079
103430*-----------------------------------------------------------------10343079
103440 5000-VALIDATE-PRINTER.                                           10344079
103450                                                                  10345079
103471     MOVE DP020-LOCATION-NBR TO  DP072-ORIGIN-OPER-UNT-ID         10347199
103472                                 DP072-OPER-UNT-ID.               10347290
103482     MOVE PC-01              TO  DP072-RPT-PGM-TYP-ID.            10348299
103490     MOVE 1                  TO  DP072-ORIGIN-FCLTY-ID            10349099
103491                                 DP072-FCLTY-ID.                  10349199
103492     MOVE ASC-PRINTER-ID     TO  DP072-PRINTER-ID.                10349299
103493     SET DP072-VALIDATE      TO  TRUE.                            10349399
103495     MOVE PC-REPORT-PGM      TO  DP072-RPT-PGM-NME.               10349599
103501                                                                  10350179
103502     EXEC CICS                                                    10350279
103503          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  10350379
103504               COMMAREA (DP072-COMM-AREA)                         10350479
103505               RESP     (PV-CICS-RESPONSE)                        10350579
103506     END-EXEC                                                     10350679
103507                                                                  10350779
103508     EVALUATE TRUE                                                10350879
103509         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10350979
103510             CONTINUE                                             10351085
103519         WHEN OTHER                                               10351979
103520             SET PS-INVALID-PRINTER    TO  TRUE                   10352080
103522     END-EVALUATE.                                                10352279
103523                                                                  10352379
103524     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               10352485
103525         SET PS-INVALID-PRINTER    TO  TRUE                       10352585
103526         SET  PS-ERROR                                            10352685
103527              DP020-MSG-FATAL         TO TRUE                     10352785
103528         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         10352885
103529         MOVE DP015-UNP-ALP-BRT-OFF   TO APRTRA                   10352986
103530         MOVE DP015-RED               TO APRTRC                   10353086
103531         MOVE DP015-REVERSE           TO APRTRH                   10353186
103532         MOVE -1                      TO APRTRL                   10353286
103533         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     10353385
103534     END-IF.                                                      10353485
103535                                                                  10353585
103536     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  10353685
103537         SET PS-VALID-PRINTER      TO  TRUE                       10353785
103539     ELSE                                                         10353985
103540         SET PS-INVALID-PRINTER    TO  TRUE                       10354085
103541         SET  PS-ERROR                                            10354185
103542              DP020-MSG-FATAL         TO TRUE                     10354285
103543         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         10354385
103544         MOVE DP015-UNP-ALP-BRT-OFF   TO APRTRA                   10354486
103545         MOVE DP015-RED               TO APRTRC                   10354586
103546         MOVE DP015-REVERSE           TO APRTRH                   10354686
103547         MOVE -1                      TO APRTRL                   10354786
103548         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     10354885
103549     END-IF.                                                      10354985
103550                                                                  10355085
103560*----------------------------------------------------------------*10356074
103600*    ABEND PROCESSOR MODULE                                      *10360074
103700*----------------------------------------------------------------*10370074
103800     COPY DPPD013.                                                10380074
103900                                                                  10390074
