000100******************************************************************00010044
000200 IDENTIFICATION DIVISION.                                         00020044
000300******************************************************************00030044
000400                                                                  00040044
000500 PROGRAM-ID.   PCKRP042.                                          00050044
000600 AUTHOR.       SUBASH T.                                          00060044
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070044
000800 DATE-WRITTEN. AUGUST, 2013.                                      00080044
000900 DATE-COMPILED.                                                   00090044
001000                                                                  00100044
001100******************************************************************00110044
001200* THIS PROGRAM WILL CREATE PO SET LIST REPORT - PCK94105         *00120044
001300******************************************************************00130044
001400 ENVIRONMENT DIVISION.                                            00140044
001500******************************************************************00150044
001600                                                                  00160044
001700 CONFIGURATION SECTION.                                           00170044
001800                                                                  00180044
001900 SOURCE-COMPUTER.        IBM-3090.                                00190044
002000 OBJECT-COMPUTER.        IBM-3090.                                00200044
002100                                                                  00210044
002200 INPUT-OUTPUT SECTION.                                            00220044
002300                                                                  00230044
002400 FILE-CONTROL.                                                    00240044
002500                                                                  00250044
002600     SELECT SET-DAT-EXT                                           00260044
002700         ASSIGN TO INP01.                                         00270044
002800                                                                  00280044
002900     SELECT TK-SET-DET                                            00290044
003000         ASSIGN TO INP02.                                         00300044
003100                                                                  00310044
003200     SELECT PO-SET-RPT                                            00320044
003300         ASSIGN TO RPT01.                                         00330044
003400                                                                  00340044
003500******************************************************************00350044
003600 DATA DIVISION.                                                   00360044
003700******************************************************************00370044
003800                                                                  00380044
003900 FILE SECTION.                                                    00390044
004000                                                                  00400044
004100 FD  SET-DAT-EXT                                                  00410044
004200     RECORDING MODE IS F                                          00420044
004300     LABEL RECORDS ARE STANDARD                                   00430044
004400     BLOCK CONTAINS 0 RECORDS.                                    00440044
004500                                                                  00450044
004600 01  SET-DAT-EXT-RECORD            PIC X(200).                    00460044
004700                                                                  00470044
004800 FD  TK-SET-DET                                                   00480044
004900     RECORDING MODE IS F                                          00490044
005000     LABEL RECORDS ARE STANDARD                                   00500044
005100     BLOCK CONTAINS 0 RECORDS.                                    00510044
005200                                                                  00520044
005300 01  TK-SET-DET-RECORD             PIC X(30).                     00530044
005400                                                                  00540044
005500 FD  PO-SET-RPT                                                   00550044
005600     RECORDING MODE IS F                                          00560044
005700     LABEL RECORDS ARE STANDARD                                   00570044
005800     BLOCK CONTAINS 0 RECORDS.                                    00580044
005900                                                                  00590044
006000 01  PO-SET-RPT-RECORD             PIC X(132).                    00600044
006100                                                                  00610044
006200******************************************************************00620044
006300 WORKING-STORAGE SECTION.                                         00630044
006400******************************************************************00640044
006500                                                                  00650044
006600     COPY DPWS132O.                                               00660044
006700                                                                  00670044
006800 01  PA-PROGRAM-ACCUMULATORS.                                     00680044
006900     05  PA-TOTALS.                                               00690044
007000         10 PA-INPUT-COUNT         PIC S9(13) VALUE +0 COMP-3.    00700044
007100                                                                  00710044
007200 01  PS-PROGRAM-SWITCHES.                                         00720044
007300     05  PS-END-OF-INP01-SW        PIC X(01)  VALUE 'N'.          00730044
007400         88  PS-END-OF-INP01                  VALUE 'Y'.          00740044
007500         88  PS-END-OF-INP01-NO               VALUE 'N'.          00750044
007600                                                                  00760044
007700     05  PS-END-OF-INP02-SW        PIC X(01)  VALUE 'N'.          00770044
007800         88  PS-END-OF-INP02                  VALUE 'Y'.          00780044
007900         88  PS-END-OF-INP02-NO               VALUE 'N'.          00790044
008000                                                                  00800044
008100     05  PS-END-OF-SEARCH-SW       PIC X(01)  VALUE 'N'.          00810044
008200         88  PS-END-OF-SEARCH                 VALUE 'Y'.          00820044
008300         88  PS-NOT-END-OF-SEARCH             VALUE 'N'.          00830044
008400                                                                  00840044
008500 01 PC-PROGRAM-CONSTANT.                                          00850044
008600     05  PC-PGM-NAME               PIC X(08)  VALUE 'PCKRP042'.   00860044
008700     05  PC-PAGE-SIZE-041          PIC 9(02)  VALUE 41.           00870044
008800     05  PC-CLOSE-PARANTHESIS      PIC X(01)  VALUE ')'.          00880044
008900                                                                  00890044
009000 01 PV-PROGRAM-VARIABLES.                                         00900044
009100     05  PV-PAGE-NUMBER            PIC S9(7).                     00910044
009200     05  PV-SET-CDE-PREV           PIC X(5).                      00920044
009300     05  PV-WRITE-COUNT            PIC 9(02).                     00930044
009400     05  PV-INPUT-COUNT            PIC Z(12)9.                    00940044
009500     05  PV-SET-NAME-TEMP          PIC X(25).                     00950044
009600     05  PV-TALLY                  PIC 9(02).                     00960044
009700     05  PV-LENGTH                 PIC 9(02).                     00970044
009800                                                                  00980044
009900     COPY PCRD074.                                                00990044
010000     COPY PCRD075.                                                01000044
010100                                                                  01010044
010200 01 WS-RPT-DATE.                                                  01020044
010300     05  WS-RPT-MM                 PIC X(2).                      01030044
010400     05  FILLER                    PIC X(1)   VALUE '/'.          01040044
010500     05  WS-RPT-DD                 PIC X(2).                      01050044
010600     05  FILLER                    PIC X(1)   VALUE '/'.          01060044
010700     05  WS-RPT-YY                 PIC X(2).                      01070046
010800                                                                  01080044
010900 01 WS-DTE.                                                       01090044
011000     10 WS-DTE-CC              PIC X(2).                          01100046
011010     10 WS-DTE-YY              PIC X(2).                          01101046
011100     10 FILLER                 PIC X.                             01110044
011200     10 WS-DTE-MM              PIC X(2).                          01120044
011300     10 FILLER                 PIC X.                             01130044
011400     10 WS-DTE-DD              PIC X(2).                          01140044
011500                                                                  01150044
011600 01 WS-SET-NAME-TABLE.                                            01160044
011700    05 WS-SET-NAME-TABLE-ENTRIES OCCURS 10 TIMES                  01170044
011800                                 INDEXED BY SETCDE-IND.           01180044
011900       10 WS-SET-CDE               PIC X(5).                      01190044
012000       10 WS-SET-CDE-NAME          PIC X(25).                     01200044
012100                                                                  01210044
012200                                                                  01220044
012300 01 WS-DTL1-RPT.                                                  01230044
012400     05  RPT-TKID-DTL1             PIC X(07).                     01240044
012500     05  FILLER                    PIC X(01)  VALUE SPACES.       01250044
012600     05  FILLER                    PIC X(01)  VALUE '-'.          01260044
012700     05  FILLER                    PIC X(01)  VALUE SPACES.       01270044
012800     05  RPT-YEAR-DTL1             PIC 9(04).                     01280044
012900     05  FILLER                    PIC X(01)  VALUE SPACES.       01290044
013000     05  FILLER                    PIC X(01)  VALUE ':'.          01300044
013100     05  FILLER                    PIC X(01)  VALUE SPACES.       01310044
013200     05  RPT-SET-CDE-DTL1          PIC X(05).                     01320044
013300     05  FILLER                    PIC X(110) VALUE SPACES.       01330044
013400                                                                  01340044
013500 01 WS-DTL2-RPT.                                                  01350044
013600     05  RPT-TKID-DTL2             PIC X(07).                     01360044
013700     05  FILLER                    PIC X(125) VALUE SPACES.       01370044
013800                                                                  01380044
013900 01 WS-DTL3-RPT.                                                  01390044
014000     05  FILLER                    PIC X(03)  VALUE 'SET'.        01400044
014100     05  FILLER                    PIC X(01)  VALUE SPACES.       01410044
014200     05  FILLER                    PIC X(01)  VALUE ':'.          01420044
014300     05  FILLER                    PIC X(01)  VALUE SPACES.       01430044
014400     05  RPT-YEAR-DTL3             PIC 9(04).                     01440044
014500     05  FILLER                    PIC X(01)  VALUE SPACES.       01450044
014600     05  FILLER                    PIC X(01)  VALUE '-'.          01460044
014700     05  FILLER                    PIC X(01)  VALUE SPACES.       01470044
014800     05  RPT-SET-CDE-DTL3          PIC X(05).                     01480044
014900     05  FILLER                    PIC X(01)  VALUE SPACES.       01490044
015000     05  FILLER                    PIC X(01)  VALUE '('.          01500044
015100     05  RPT-SET-NAME-DTL3         PIC X(26).                     01510044
015200     05  FILLER                    PIC X(86)  VALUE SPACES.       01520044
015300                                                                  01530044
015400 01 WS-DTL4-RPT.                                                  01540044
015500     05  RPT-PO-NUMBER             PIC Z(7)9.                     01550044
015600     05  FILLER                    PIC X(01)  VALUE SPACES.       01560044
015700     05  RPT-ENT-NAME-DESC         PIC X(30).                     01570044
015800     05  FILLER                    PIC X(01)  VALUE SPACES.       01580044
015900     05  RPT-PO-TYP-CDE            PIC X(04).                     01590044
016000     05  FILLER                    PIC X(01)  VALUE SPACES.       01600044
016100     05  RPT-DEPT-NBR              PIC X(04).                     01610044
016200     05  FILLER                    PIC X(01)  VALUE SPACES.       01620044
016300     05  RPT-DONT-SHIP-BEF-DTE     PIC X(08).                     01630045
016400     05  FILLER                    PIC X(01)  VALUE SPACES.       01640044
016500     05  RPT-CAN-IFNOT-SHIP-DTE    PIC X(08).                     01650045
016510     05  FILLER                    PIC X(01)  VALUE SPACES.       01651045
016520     05  RPT-EXTENDED-CANCEL-DTE   PIC X(08).                     01652045
016600     05  FILLER                    PIC X(01)  VALUE SPACES.       01660044
016700     05  RPT-OTB-PER-NBR           PIC X(06).                     01670044
016800     05  FILLER                    PIC X(02)  VALUE SPACES.       01680044
016900     05  RPT-PKGNG-CDE             PIC X(01).                     01690044
017000     05  FILLER                    PIC X(03)  VALUE SPACES.       01700044
017100     05  RPT-NEW-STR-PO-IND        PIC X(01).                     01710044
017200     05  FILLER                    PIC X(02)  VALUE SPACES.       01720044
017300     05  RPT-CRSDCK-UNT-QTY        PIC Z(8)9.                     01730044
017400     05  FILLER                    PIC X(01)  VALUE SPACES.       01740044
017500     05  RPT-P2L-UNT-QTY           PIC Z(8)9.                     01750044
017600     05  FILLER                    PIC X(01)  VALUE SPACES.       01760044
017700     05  RPT-TOT-UNT-QTY           PIC Z(8)9.                     01770044
017800     05  FILLER                    PIC X(02)  VALUE SPACES.       01780044
018100     05  RPT-SEASET-SHRT-NM        PIC X(06).                     01810044
018200     05  FILLER                    PIC X(04)  VALUE SPACES.       01820044
018300                                                                  01830044
018400 01 WS-DTL-EMPTY-RPT.                                             01840044
018500     05  FILLER                    PIC X(53)  VALUE SPACES.       01850044
018600     05  RPT-DTL-EMPTY-RPT         PIC X(25)  VALUE               01860044
018700         '*** NO DATA TO REPORT ***'.                             01870044
018800     05  FILLER                    PIC X(54)  VALUE SPACES.       01880044
018900                                                                  01890044
019000 01 WS-DTL-END-OF-RPT.                                            01900044
019100     05  FILLER                    PIC X(52)  VALUE SPACES.       01910044
019200     05  RPT-DTL-END-RPT           PIC X(27)  VALUE               01920044
019300         '****** END OF REPORT ******'.                           01930044
019400     05  FILLER                    PIC X(53)  VALUE SPACES.       01940044
019500                                                                  01950044
019600                                                                  01960044
019700 01  WS-CURRENT-DATETIME.                                         01970044
019800     05  WS-CURRENT-DATE           PIC X(08)  VALUE SPACES.       01980044
019900     05  FILLER REDEFINES WS-CURRENT-DATE.                        01990044
020000         10 WS-CURRENT-DATE-CCYY   PIC X(04).                     02000044
020100         10 WS-CURRENT-DATE-MM     PIC X(02).                     02010044
020200         10 WS-CURRENT-DATE-DD     PIC X(02).                     02020044
020300     05  WS-CURRENT-TIME           PIC X(06)  VALUE SPACES.       02030044
020400     05  FILLER REDEFINES WS-CURRENT-TIME.                        02040044
020500         10 WS-CURRENT-TIME-HH     PIC X(02).                     02050044
020600         10 WS-CURRENT-TIME-MM     PIC X(02).                     02060044
020700         10 WS-CURRENT-TIME-SS     PIC X(02).                     02070044
020800                                                                  02080044
020900 01  REPORT-HEADING-1.                                            02090044
021000     05  FILLER                    PIC X(53)  VALUE SPACES.       02100044
021100     05  FILLER                    PIC X(11)  VALUE               02110044
021200         'PO-SET LIST'.                                           02120044
021300     05  FILLER                    PIC X(68)  VALUE SPACES.       02130044
021400                                                                  02140044
021500 01  REPORT-HEADING-2.                                            02150044
021600     05  FILLER                    PIC X(68)  VALUE SPACES.       02160048
021700     05  FILLER                    PIC X(08)  VALUE 'EXTENDED'.   02170047
021800     05  FILLER                    PIC X(08)  VALUE SPACES.       02180049
021810     05  FILLER                    PIC X(03)  VALUE 'PKG'.        02181045
021820     05  FILLER                    PIC X(01)  VALUE SPACES.       02182045
021900     05  FILLER                    PIC X(03)  VALUE 'NEW'.        02190044
022000     05  FILLER                    PIC X(02)  VALUE SPACES.       02200044
022100     05  FILLER                    PIC X(08)  VALUE 'CRS DOCK'.   02210044
022200     05  FILLER                    PIC X(04)  VALUE SPACES.       02220044
022300     05  FILLER                    PIC X(03)  VALUE 'P2L'.        02230044
022400     05  FILLER                    PIC X(07)  VALUE SPACES.       02240051
022500     05  FILLER                    PIC X(03)  VALUE 'TOT'.        02250044
022800     05  FILLER                    PIC X(11)  VALUE SPACES.       02280051
022900                                                                  02290044
023000 01  REPORT-HEADING-3.                                            02300044
023100     05  FILLER                    PIC X(03)  VALUE SPACES.       02310044
023200     05  FILLER                    PIC X(02)  VALUE 'PO'.         02320044
023300     05  FILLER                    PIC X(13)  VALUE SPACES.       02330044
023400     05  FILLER                    PIC X(04)  VALUE 'NAME'.       02340044
023500     05  FILLER                    PIC X(18)  VALUE SPACES.       02350044
023600     05  FILLER                    PIC X(04)  VALUE 'TYPE'.       02360044
023700     05  FILLER                    PIC X(01)  VALUE SPACES.       02370044
023800     05  FILLER                    PIC X(04)  VALUE 'DEPT'.       02380044
023900     05  FILLER                    PIC X(03)  VALUE SPACES.       02390045
024000     05  FILLER                    PIC X(04)  VALUE 'SHIP'.       02400044
024100     05  FILLER                    PIC X(04)  VALUE SPACES.       02410045
024200     05  FILLER                    PIC X(06)  VALUE 'CANCEL'.     02420044
024300     05  FILLER                    PIC X(03)  VALUE SPACES.       02430045
024310     05  FILLER                    PIC X(06)  VALUE 'CANCEL'.     02431047
024320     05  FILLER                    PIC X(03)  VALUE SPACES.       02432049
024400     05  FILLER                    PIC X(03)  VALUE 'OTB'.        02440044
024500     05  FILLER                    PIC X(03)  VALUE SPACES.       02450044
024600     05  FILLER                    PIC X(03)  VALUE 'CDE'.        02460044
024700     05  FILLER                    PIC X(01)  VALUE SPACES.       02470044
024800     05  FILLER                    PIC X(03)  VALUE 'STR'.        02480044
024900     05  FILLER                    PIC X(03)  VALUE SPACES.       02490044
025000     05  FILLER                    PIC X(05)  VALUE 'UNITS'.      02500044
025100     05  FILLER                    PIC X(05)  VALUE SPACES.       02510044
025200     05  FILLER                    PIC X(05)  VALUE 'UNITS'.      02520044
025300     05  FILLER                    PIC X(05)  VALUE SPACES.       02530051
025400     05  FILLER                    PIC X(05)  VALUE 'UNITS'.      02540044
025500     05  FILLER                    PIC X(03)  VALUE SPACES.       02550051
025800     05  FILLER                    PIC X(06)  VALUE 'SEASET'.     02580044
025900     05  FILLER                    PIC X(04)  VALUE SPACES.       02590044
026000                                                                  02600044
026100 01  REPORT-HEADING-4.                                            02610044
026200     05  FILLER                    PIC X(08)  VALUE               02620044
026300         '--------'.                                              02630044
026400     05  FILLER                    PIC X(01)  VALUE SPACES.       02640044
026500     05  FILLER                    PIC X(30)  VALUE               02650044
026600         '------------------------------'.                        02660044
026700     05  FILLER                    PIC X(01)  VALUE SPACES.       02670044
026800     05  FILLER                    PIC X(04)  VALUE               02680044
026900         '----'.                                                  02690044
027000     05  FILLER                    PIC X(01)  VALUE SPACES.       02700044
027100     05  FILLER                    PIC X(04)  VALUE               02710044
027200         '----'.                                                  02720044
027300     05  FILLER                    PIC X(01)  VALUE SPACES.       02730044
027400     05  FILLER                    PIC X(08)  VALUE               02740045
027500         '--------'.                                              02750045
027600     05  FILLER                    PIC X(01)  VALUE SPACES.       02760044
027700     05  FILLER                    PIC X(08)  VALUE               02770045
027800         '--------'.                                              02780045
027810     05  FILLER                    PIC X(01)  VALUE SPACES.       02781045
027820     05  FILLER                    PIC X(08)  VALUE               02782045
027830         '--------'.                                              02783045
027900     05  FILLER                    PIC X(01)  VALUE SPACES.       02790044
028000     05  FILLER                    PIC X(06)  VALUE               02800044
028100         '------'.                                                02810044
028200     05  FILLER                    PIC X(01)  VALUE SPACES.       02820044
028300     05  FILLER                    PIC X(03)  VALUE               02830044
028400         '---'.                                                   02840044
028500     05  FILLER                    PIC X(01)  VALUE SPACES.       02850044
028600     05  FILLER                    PIC X(03)  VALUE               02860044
028700         '---'.                                                   02870044
028800     05  FILLER                    PIC X(01)  VALUE SPACES.       02880044
028900     05  FILLER                    PIC X(09)  VALUE '---------'.  02890044
029000     05  FILLER                    PIC X(01)  VALUE SPACES.       02900044
029100     05  FILLER                    PIC X(09)  VALUE '---------'.  02910044
029200     05  FILLER                    PIC X(01)  VALUE SPACES.       02920044
029300     05  FILLER                    PIC X(09)  VALUE               02930044
029400         '---------'.                                             02940044
029500     05  FILLER                    PIC X(01)  VALUE SPACES.       02950044
029900     05  FILLER                    PIC X(06)  VALUE               02990044
030000         '------'.                                                03000044
030100     05  FILLER                    PIC X(04)  VALUE SPACES.       03010044
030200                                                                  03020044
030300 PROCEDURE DIVISION.                                              03030044
030400******************************************************************03040044
030500*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *03050044
030600******************************************************************03060044
030700 0000-PROGRAM-MAINLINE.                                           03070044
030800                                                                  03080044
030900     PERFORM 1000-INITIALIZE.                                     03090044
031000                                                                  03100044
031100     PERFORM 2000-MAIN-PROCESS UNTIL PS-END-OF-INP01.             03110044
031200                                                                  03120044
031300     PERFORM 8400-WRITE-END-OF-RPT                                03130044
031400                                                                  03140044
031500     PERFORM 9000-EOJ-ROUTINE.                                    03150044
031600                                                                  03160044
031700     STOP RUN.                                                    03170044
031800                                                                  03180044
031900******************************************************************03190044
032000*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *03200044
032100*  JOB PROCESSES.                                                *03210044
032200******************************************************************03220044
032300 1000-INITIALIZE.                                                 03230044
032400                                                                  03240044
032500     OPEN INPUT  SET-DAT-EXT                                      03250044
032600                 TK-SET-DET                                       03260044
032700          OUTPUT PO-SET-RPT.                                      03270044
032800                                                                  03280044
032900     INITIALIZE PV-PROGRAM-VARIABLES                              03290044
033000                PA-PROGRAM-ACCUMULATORS                           03300044
033100                WS-SET-NAME-TABLE.                                03310044
033200                                                                  03320044
033300     DISPLAY 'START OF PROGRAM : ' PC-PGM-NAME.                   03330044
033400     MOVE FUNCTION CURRENT-DATE      TO WS-CURRENT-DATETIME.      03340044
033500     MOVE PC-PGM-NAME                TO DP132O-PROGRAM-NAME.      03350044
033600     MOVE 1                          TO DP132O-REPORT-NUMBER.     03360044
033700     MOVE WS-CURRENT-DATE-MM         TO DP132O-RUN-MONTH.         03370044
033800     MOVE WS-CURRENT-DATE-DD         TO DP132O-RUN-DAY.           03380044
033900     MOVE WS-CURRENT-DATE-CCYY       TO DP132O-RUN-YEAR.          03390044
034000     MOVE WS-CURRENT-TIME-HH         TO DP132O-RUN-HOUR.          03400044
034100     MOVE WS-CURRENT-TIME-MM         TO DP132O-RUN-MINUTE.        03410044
034200     PERFORM 3000-READ-SET-CDE-EXTRACT-FILE.                      03420044
034300     IF PS-END-OF-INP01-NO                                        03430044
034400        PERFORM 3100-READ-TK-SET-YEAR-DATA                        03440044
034500        PERFORM 4000-BUILD-REPORT                                 03450044
034600        ADD 1                        TO PA-INPUT-COUNT            03460044
034700     ELSE                                                         03470044
034800        PERFORM 8300-WRITE-NO-DATA                                03480044
034900     END-IF.                                                      03490044
035000                                                                  03500044
035100 EJECT                                                            03510044
035200******************************************************************03520044
035300* PERFORMS THE MAIN PROCESSING OF THE PROGRAM                    *03530044
035400******************************************************************03540044
035500 2000-MAIN-PROCESS.                                               03550044
035600                                                                  03560044
035700     PERFORM 3000-READ-SET-CDE-EXTRACT-FILE.                      03570044
035800     IF PS-END-OF-INP01-NO                                        03580044
035900        PERFORM 4000-BUILD-REPORT                                 03590044
036000        ADD 1                        TO PA-INPUT-COUNT            03600044
036100     END-IF.                                                      03610044
036200                                                                  03620044
036300 EJECT                                                            03630044
036400*                                                                 03640044
036500******************************************************************03650044
036600* READS THE SET CODE INPUT DB2 UNLOAD FILE                       *03660044
036700******************************************************************03670044
036800 3000-READ-SET-CDE-EXTRACT-FILE.                                  03680044
036900                                                                  03690044
037000     READ SET-DAT-EXT INTO PC074-SET-CDE-EXT-REC                  03700044
037100         AT END                                                   03710044
037200           SET PS-END-OF-INP01       TO TRUE.                     03720044
037300                                                                  03730044
037400 EJECT                                                            03740044
037500*                                                                 03750044
037600******************************************************************03760044
037700* READS THE TK ID AND SET YEAR FROM I02 FILE                     *03770044
037800******************************************************************03780044
037900 3100-READ-TK-SET-YEAR-DATA.                                      03790044
038000                                                                  03800044
038100     READ TK-SET-DET INTO PC075-SET-CDE-TK-YEAR-REC               03810044
038200         AT END                                                   03820044
038300           SET PS-END-OF-INP02       TO TRUE.                     03830044
038400     IF PS-END-OF-INP02-NO                                        03840044
038500        SET SETCDE-IND               TO 1                         03850044
038600        PERFORM 3200-SET-CODE-NAME-FILE                           03860044
038700            UNTIL PS-END-OF-INP02 OR SETCDE-IND > 10              03870044
038800     END-IF.                                                      03880044
038900                                                                  03890044
039000 EJECT                                                            03900044
039100*                                                                 03910044
039200******************************************************************03920044
039300* READS THE SET CODE AND SET NAME FROM I02 FILE AND BUILDS THE   *03930044
039400* SET CODE AND SET NAME TABLE                                    *03940044
039500******************************************************************03950044
039600 3200-SET-CODE-NAME-FILE.                                         03960044
039700                                                                  03970044
039800     READ TK-SET-DET                                              03980044
039900         AT END                                                   03990044
040000           SET PS-END-OF-INP02       TO TRUE.                     04000044
040100     IF PS-END-OF-INP02-NO                                        04010044
040200        MOVE TK-SET-DET-RECORD(1:5)  TO WS-SET-CDE(SETCDE-IND)    04020044
040300        MOVE TK-SET-DET-RECORD(6:25) TO                           04030044
040400                                       WS-SET-CDE-NAME(SETCDE-IND)04040044
040500        SET SETCDE-IND UP BY 1                                    04050044
040600     END-IF.                                                      04060044
040700                                                                  04070044
040800 EJECT                                                            04080044
040900*                                                                 04090044
041000******************************************************************04100044
041100* BUILDS THE DATA FOR REPORT PCK94105                            *04110044
041200******************************************************************04120044
041300 4000-BUILD-REPORT.                                               04130044
041400     INITIALIZE WS-DTL4-RPT.                                      04140044
041500     MOVE PC074-PO-NBR               TO RPT-PO-NUMBER.            04150044
041600     MOVE PC074-ENT-NAME-DESC        TO RPT-ENT-NAME-DESC.        04160044
041700     MOVE PC074-PO-TYP-CDE           TO RPT-PO-TYP-CDE.           04170044
041800     MOVE PC074-DEPT-NBR             TO RPT-DEPT-NBR.             04180044
041810*                                                                 04181046
041900     MOVE PC074-DONT-SHIP-BEF-DTE    TO WS-DTE.                   04190044
042000     MOVE WS-DTE-MM                  TO WS-RPT-MM.                04200044
042100     MOVE WS-DTE-DD                  TO WS-RPT-DD.                04210044
042200     MOVE WS-DTE-YY                  TO WS-RPT-YY.                04220046
042300     MOVE WS-RPT-DATE                TO RPT-DONT-SHIP-BEF-DTE.    04230044
042400     MOVE PC074-CAN-IFNOT-SHIP-DTE   TO WS-DTE.                   04240044
042500     MOVE WS-DTE-MM                  TO WS-RPT-MM.                04250044
042600     MOVE WS-DTE-DD                  TO WS-RPT-DD.                04260044
042700     MOVE WS-DTE-YY                  TO WS-RPT-YY.                04270046
042800     MOVE WS-RPT-DATE                TO RPT-CAN-IFNOT-SHIP-DTE.   04280044
042801     IF  PC074-EXT-CAN-DTE  =  '0001-01-01'                       04280150
042802         MOVE SPACES                 TO RPT-EXTENDED-CANCEL-DTE   04280250
042803     ELSE                                                         04280350
042804         MOVE PC074-EXT-CAN-DTE      TO WS-DTE                    04280450
042805         MOVE WS-DTE-MM              TO WS-RPT-MM                 04280550
042806         MOVE WS-DTE-DD              TO WS-RPT-DD                 04280650
042807         MOVE WS-DTE-YY              TO WS-RPT-YY                 04280750
042810         MOVE WS-RPT-DATE            TO RPT-EXTENDED-CANCEL-DTE   04281050
042811     END-IF.                                                      04281150
042820*                                                                 04282046
042900     MOVE PC074-OTB-PER-NBR          TO RPT-OTB-PER-NBR.          04290044
043000     MOVE PC074-PKGNG-CDE            TO RPT-PKGNG-CDE.            04300044
043100     MOVE PC074-NEW-STR-PO-IND       TO RPT-NEW-STR-PO-IND.       04310044
043200     MOVE PC074-TOT-UNT-QTY          TO RPT-TOT-UNT-QTY.          04320044
043300     MOVE PC074-CROSS-DOCK-QTY       TO RPT-CRSDCK-UNT-QTY.       04330044
043400     MOVE PC074-PACK-TO-LIGHT-QTY    TO RPT-P2L-UNT-QTY.          04340044
043600     MOVE PC074-SEASET-SHRT-NM       TO RPT-SEASET-SHRT-NM.       04360044
043700                                                                  04370044
043800     IF PC074-SEASET-SHRT-NM = PV-SET-CDE-PREV                    04380044
043900        PERFORM 8100-WRITE-EXTRACT-DETAIL                         04390044
044000     ELSE                                                         04400044
044100        MOVE PC074-SEASET-SHRT-NM    TO PV-SET-CDE-PREV           04410044
044200        PERFORM 4100-SEARCH-SET-CDE-TABLE                         04420044
044300        PERFORM 7000-WRITE-HEADER1                                04430044
044400        PERFORM 8000-WRITE-TK-SET-DETAIL                          04440044
044500        PERFORM 7100-WRITE-HEADER2                                04450044
044600        IF PC074-PO-NBR > ZEROES                                  04460044
044700           PERFORM 8100-WRITE-EXTRACT-DETAIL                      04470044
044800        ELSE                                                      04480044
044900           PERFORM 8300-WRITE-NO-DATA                             04490044
045000        END-IF                                                    04500044
045100     END-IF.                                                      04510044
045200                                                                  04520044
045300 EJECT                                                            04530044
045400******************************************************************04540044
045500* SEARCHES THE SET CODE TABLE TO GET THE SET NAME                *04550044
045600******************************************************************04560044
045700 4100-SEARCH-SET-CDE-TABLE.                                       04570044
045800                                                                  04580044
045900     SET SETCDE-IND                  TO 1.                        04590044
046000     SET PS-NOT-END-OF-SEARCH        TO TRUE.                     04600044
046100     INITIALIZE RPT-SET-NAME-DTL3                                 04610044
046200                PV-SET-NAME-TEMP                                  04620044
046300                PV-TALLY                                          04630044
046400                PV-LENGTH.                                        04640044
046500     PERFORM UNTIL PS-END-OF-SEARCH OR SETCDE-IND > 10            04650044
046600          SEARCH WS-SET-NAME-TABLE-ENTRIES                        04660044
046700              WHEN WS-SET-CDE(SETCDE-IND) = PC074-SEASET-SHRT-NM  04670044
046800                 MOVE WS-SET-CDE-NAME(SETCDE-IND)                 04680044
046900                                     TO PV-SET-NAME-TEMP          04690044
047000                 SET PS-END-OF-SEARCH                             04700044
047100                                     TO TRUE                      04710044
047200          END-SEARCH                                              04720044
047300     END-PERFORM.                                                 04730044
047400     INSPECT FUNCTION REVERSE(PV-SET-NAME-TEMP)                   04740044
047500                     TALLYING PV-TALLY FOR LEADING SPACES.        04750044
047600     COMPUTE PV-LENGTH = LENGTH OF PV-SET-NAME-TEMP - PV-TALLY.   04760044
047700     MOVE PV-SET-NAME-TEMP(1:PV-LENGTH)                           04770044
047800                                     TO RPT-SET-NAME-DTL3.        04780044
047900     MOVE PC-CLOSE-PARANTHESIS       TO                           04790044
048000                               RPT-SET-NAME-DTL3(PV-LENGTH + 1:1).04800044
048100                                                                  04810044
048200 EJECT                                                            04820044
048300******************************************************************04830044
048400* WRITES THE STANDARD KOHLS HEADER AND REPORT TITLE              *04840044
048500******************************************************************04850044
048600 7000-WRITE-HEADER1.                                              04860044
048700                                                                  04870044
048800     INITIALIZE PV-WRITE-COUNT.                                   04880044
048900     ADD  1                          TO PV-PAGE-NUMBER.           04890044
049000     MOVE PV-PAGE-NUMBER             TO DP132O-PAGE-NUMBER.       04900044
049100     INITIALIZE PO-SET-RPT-RECORD.                                04910044
049200     WRITE PO-SET-RPT-RECORD FROM                                 04920044
049300                 DP132O-STANDRD-HEADER-132-COLS                   04930044
049400                 AFTER ADVANCING PAGE.                            04940044
049500     INITIALIZE PO-SET-RPT-RECORD.                                04950044
049600     WRITE PO-SET-RPT-RECORD FROM REPORT-HEADING-1.               04960044
049700     ADD  2                          TO PV-WRITE-COUNT.           04970044
049800                                                                  04980044
049900 EJECT                                                            04990044
050000******************************************************************05000044
050100* WRITES THE REPORT HEADER AND FORMAT RECORD                     *05010044
050200******************************************************************05020044
050300 7100-WRITE-HEADER2.                                              05030044
050400                                                                  05040044
050500     INITIALIZE PO-SET-RPT-RECORD.                                05050044
050600     WRITE PO-SET-RPT-RECORD FROM REPORT-HEADING-2.               05060044
050700     INITIALIZE PO-SET-RPT-RECORD.                                05070044
050800     WRITE PO-SET-RPT-RECORD FROM REPORT-HEADING-3.               05080044
050900     INITIALIZE PO-SET-RPT-RECORD.                                05090044
051000     WRITE PO-SET-RPT-RECORD FROM REPORT-HEADING-4.               05100044
051100     ADD  3                          TO PV-WRITE-COUNT.           05110044
051200                                                                  05120044
051300 EJECT                                                            05130044
051400******************************************************************05140044
051500* WRITES THE TK ID SET CODE AND YEAR RECORD                      *05150044
051600******************************************************************05160044
051700 8000-WRITE-TK-SET-DETAIL.                                        05170044
051800                                                                  05180044
051900     MOVE PC075-SET-CDE-TK-YEAR-REC  TO RPT-TKID-DTL1             05190044
052000                                        RPT-TKID-DTL2.            05200044
052100     MOVE PC075-SET-CDE-YEAR         TO RPT-YEAR-DTL1             05210044
052200                                        RPT-YEAR-DTL3.            05220044
052300     MOVE PC074-SEASET-SHRT-NM       TO RPT-SET-CDE-DTL1          05230044
052400                                        RPT-SET-CDE-DTL3.         05240044
052500     PERFORM 8200-WRITE-BLANK-REC.                                05250044
052600     INITIALIZE PO-SET-RPT-RECORD.                                05260044
052700     WRITE PO-SET-RPT-RECORD  FROM WS-DTL1-RPT.                   05270044
052800     PERFORM 8200-WRITE-BLANK-REC 2 TIMES.                        05280044
052900     INITIALIZE PO-SET-RPT-RECORD.                                05290044
053000     WRITE PO-SET-RPT-RECORD  FROM WS-DTL2-RPT.                   05300044
053100     INITIALIZE PO-SET-RPT-RECORD.                                05310044
053200     WRITE PO-SET-RPT-RECORD  FROM WS-DTL3-RPT.                   05320044
053300     PERFORM 8200-WRITE-BLANK-REC.                                05330044
053400     ADD  3                          TO PV-WRITE-COUNT.           05340044
053500                                                                  05350044
053600 EJECT                                                            05360044
053700******************************************************************05370044
053800* WRITES THE PO SET DETAIL RECORD                                *05380044
053900******************************************************************05390044
054000 8100-WRITE-EXTRACT-DETAIL.                                       05400044
054100                                                                  05410044
054200     IF PV-WRITE-COUNT >= PC-PAGE-SIZE-041                        05420044
054300        INITIALIZE PV-WRITE-COUNT                                 05430044
054400        PERFORM 7000-WRITE-HEADER1                                05440044
054500        PERFORM 8000-WRITE-TK-SET-DETAIL                          05450044
054600        PERFORM 7100-WRITE-HEADER2                                05460044
054700     END-IF.                                                      05470044
054800     INITIALIZE PO-SET-RPT-RECORD.                                05480044
054900     WRITE PO-SET-RPT-RECORD  FROM WS-DTL4-RPT.                   05490044
055000     ADD 1                           TO PV-WRITE-COUNT.           05500044
055100                                                                  05510044
055200 EJECT                                                            05520044
055300******************************************************************05530044
055400* WRITES THE EMPTY RECORD FOR REPORT FORMATTING                  *05540044
055500******************************************************************05550044
055600 8200-WRITE-BLANK-REC.                                            05560044
055700                                                                  05570044
055800     INITIALIZE PO-SET-RPT-RECORD.                                05580044
055900     WRITE PO-SET-RPT-RECORD.                                     05590044
056000     ADD  1                          TO PV-WRITE-COUNT.           05600044
056100                                                                  05610044
056200 EJECT                                                            05620044
056300******************************************************************05630044
056400* WRITES NO DATA RECORD IN THE REPORT IF INPUT FILE HAS NO DATA  *05640044
056500* IN IT                                                          *05650044
056600******************************************************************05660044
056700 8300-WRITE-NO-DATA.                                              05670044
056800                                                                  05680044
056900     INITIALIZE PO-SET-RPT-RECORD.                                05690044
057000     WRITE PO-SET-RPT-RECORD FROM                                 05700044
057100                 WS-DTL-EMPTY-RPT                                 05710044
057200           AFTER ADVANCING 1 LINE.                                05720044
057300                                                                  05730044
057400 EJECT                                                            05740044
057500******************************************************************05750044
057600* WRITES END OF REPORT RECORD AT THE END OF INPUT FILE PROCESSING*05760044
057700******************************************************************05770044
057800 8400-WRITE-END-OF-RPT.                                           05780044
057900                                                                  05790044
058000     INITIALIZE PO-SET-RPT-RECORD.                                05800044
058100     WRITE PO-SET-RPT-RECORD FROM                                 05810044
058200                 WS-DTL-END-OF-RPT                                05820044
058300           AFTER ADVANCING 1 LINE.                                05830044
058400                                                                  05840044
058500 EJECT                                                            05850044
058600******************************************************************05860044
058700* CLOSES THE INPUT/OUTPUT FILE AND DISPLAYS PROGRAM STATISTICS   *05870044
058800******************************************************************05880044
058900 9000-EOJ-ROUTINE.                                                05890044
059000                                                                  05900044
059100     CLOSE SET-DAT-EXT                                            05910044
059200           TK-SET-DET                                             05920044
059300           PO-SET-RPT.                                            05930044
059400                                                                  05940044
059500     MOVE PA-INPUT-COUNT             TO PV-INPUT-COUNT.           05950044
059600     DISPLAY '*************************************************'. 05960044
059700     DISPLAY '**               PCKRP042 SUMMARY             **'.  05970044
059800     DISPLAY '*************************************************'. 05980044
059900     DISPLAY 'TOTAL EXTRACTED RECORDS READ = ' PV-INPUT-COUNT.    05990044
060000     DISPLAY '*************************************************'. 06000044
060100     DISPLAY 'END OF PROGRAM   : ' PC-PGM-NAME.                   06010044
060200                                                                  06020044
060300 EJECT                                                            06030044
