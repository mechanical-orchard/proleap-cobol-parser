000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.   RVKUT027.                                          00050099
000600 AUTHOR.       AL PETERS.                                         00060099
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070099
000800 DATE-WRITTEN. FEBRUARY 2007.                                     00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200*  RTV - GENCO FILES: ADD HDR RETURN-TYPE TO DETAIL FILE          00120099
001300*                     VALIDATE DEPT, SUB CLASS AND SKU            00130099
001400*                     UPDATE CHANGES TO OUTPUT FILE               00140099
001500*                     PRINT ERROR REPORT                          00150099
001600******************************************************************00160099
001700* !!! IMPORTANT !!! THE LOGIC IN THIS PROGRAM CRITICALLY DEPENDS  00170099
001800* UPON THE 2 INPUT FILES BEING SORTED AS FOLLOWS:                 00180099
001900*                                                                 00190099
002000* HDR FILE: SORT FIELDS=(01,12,CH,A)    DFCT ORD ID               00200099
002100*                                                                 00210099
002200* DTL FILE: SORT FIELDS=(1,12,CH,A,      DFCT ORD ID              00220099
002300*                       81,10,CH,A,     DEPT                      00230099
002400*                       91,10,CH,A,     CLASS/SUBCLASS            00240099
002500*                       16,10,CH,A)     SKU                       00250099
002600*-----------------------------------------------------------------00260099
002700* DATE:        10/30/2011                                         00270099
002800* PROJ#:       3219  GENCO/RTV UPGRADE PROJECT                    00280099
002900* WR/IR#:      WR40134                                            00290099
003000* PROGRAMMER:  JOHN HUTCHINSON / CHRIS STRODTHOFF                 00300099
003100* DESCRIPTION: USING NEW RV051-TO-LOC-NBR LOCATION, SELECT FROM   00310099
003200*              XLT_LOC TABLE. FORMAT REPORT FOR RTV LOCATION      00320099
003300*              AND NAME. ADD LOCATION TO OUTPUT RVRD051 RECORD.   00330099
003400*--------------------------------------------------------------*  00340099
003500*                                                                 00350099
003600*                                                                 00360099
003700*                                                                 00370099
003800*                                                                 00380099
003900*                                                                 00390099
004000******************************************************************00400099
004100 ENVIRONMENT DIVISION.                                            00410099
004200******************************************************************00420099
004300                                                                  00430099
004400 CONFIGURATION SECTION.                                           00440099
004500                                                                  00450099
004600 SOURCE-COMPUTER.        IBM-3090.                                00460099
004700 OBJECT-COMPUTER.        IBM-3090.                                00470099
004800                                                                  00480099
004900 INPUT-OUTPUT SECTION.                                            00490099
005000                                                                  00500099
005100 FILE-CONTROL.                                                    00510099
005200                                                                  00520099
005300     SELECT RTV-HEADER-FILE                                       00530099
005400         ASSIGN TO INP01.                                         00540099
005500                                                                  00550099
005600     SELECT RTV-DTL-FILE                                          00560099
005700         ASSIGN TO INP02.                                         00570099
005800                                                                  00580099
005900     SELECT RTV-DTL-CONTROL-FILE                                  00590099
006000         ASSIGN TO INP03.                                         00600099
006100                                                                  00610099
006200     SELECT RTV-NEW-DTL-FILE                                      00620099
006300         ASSIGN TO OUT01.                                         00630099
006400                                                                  00640099
006500     SELECT MESSAGE-FILE                                          00650099
006600         ASSIGN TO OUT02.                                         00660099
006700                                                                  00670099
006800     SELECT ERROR-REPORT                                          00680099
006900         ASSIGN TO RPT01.                                         00690099
007000******************************************************************00700099
007100 DATA DIVISION.                                                   00710099
007200******************************************************************00720099
007300                                                                  00730099
007400 FILE SECTION.                                                    00740099
007500                                                                  00750099
007600 FD  RTV-HEADER-FILE                                              00760099
007700     RECORDING MODE IS F                                          00770099
007800     LABEL RECORDS ARE STANDARD                                   00780099
007900     BLOCK CONTAINS 0 RECORDS.                                    00790099
008000                                                                  00800099
008100 01  RTV-HEADER-RECORD               PIC X(550).                  00810099
008200                                                                  00820099
008300 FD  RTV-DTL-FILE                                                 00830099
008400     RECORDING MODE IS F                                          00840099
008500     LABEL RECORDS ARE STANDARD                                   00850099
008600     BLOCK CONTAINS 0 RECORDS.                                    00860099
008700                                                                  00870099
008800 01  RTV-DTL-RECORD                   PIC X(200).                 00880099
008900                                                                  00890099
009000 FD  RTV-DTL-CONTROL-FILE                                         00900099
009100     RECORDING MODE IS F                                          00910099
009200     LABEL RECORDS ARE STANDARD                                   00920099
009300     BLOCK CONTAINS 0 RECORDS.                                    00930099
009400                                                                  00940099
009500 01  RTV-DTL-CONTROL-RECORD           PIC X(200).                 00950099
009600                                                                  00960099
009700 FD  RTV-NEW-DTL-FILE                                             00970099
009800     RECORDING MODE IS F                                          00980099
009900     LABEL RECORDS ARE STANDARD                                   00990099
010000     BLOCK CONTAINS 0 RECORDS.                                    01000099
010100                                                                  01010099
010200 01  RTV-NEW-DTL-RECORD               PIC X(200).                 01020099
010300                                                                  01030099
010400 FD  MESSAGE-FILE                                                 01040099
010500     RECORDING MODE IS F                                          01050099
010600     LABEL RECORDS ARE STANDARD                                   01060099
010700     BLOCK CONTAINS 0 RECORDS.                                    01070099
010800                                                                  01080099
010900 01  MESSAGE-REC                      PIC X(80).                  01090099
011000                                                                  01100099
011100 FD  ERROR-REPORT                                                 01110099
011200     RECORDING MODE IS F                                          01120099
011300     LABEL RECORDS ARE STANDARD                                   01130099
011400     BLOCK CONTAINS 0 RECORDS.                                    01140099
011500                                                                  01150099
011600 01  ERROR-RPT-RECORD                 PIC X(132).                 01160099
011700******************************************************************01170099
011800 WORKING-STORAGE SECTION.                                         01180099
011900******************************************************************01190099
012000                                                                  01200099
012100******************************************************************01210099
012200* INPUT LAYOUT - RV050-GENCO-RTV-HEADER-RECORD.                   01220099
012300******************************************************************01230099
012400     COPY RVRD050.                                                01240099
012500                                                                  01250099
012600******************************************************************01260099
012700* INPUT LAYOUT - RV050-GENCO-RTV-DETAIL-RECORD.                   01270099
012800******************************************************************01280099
012900     COPY RVRD051.                                                01290099
013000                                                                  01300099
013100******************************************************************01310099
013200* INPUT LAYOUT - RV052-GENCO-RTV-DTL-CNTL-RECORD.                 01320099
013300******************************************************************01330099
013400     COPY RVRD052.                                                01340099
013500                                                                  01350099
013600***  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT               01360099
013700     COPY DPWS132.                                                01370099
013800                                                                  01380099
013900***  CALENDAR ROUTINE COPYBOOK                                    01390099
014000     COPY DPWS500.                                                01400099
014100                                                                  01410099
014200**  JH  10/30/2011 BEG                                            01420099
014300******************************************************************01430099
014400*  DB2 TABLE DECLARATION                                          01440099
014500*  (XLT_LOC    - LOGISTICS LOCATION TABLE)                        01450099
014600******************************************************************01460099
014700     EXEC SQL                                                     01470099
014800         INCLUDE XLT00010                                         01480099
014900     END-EXEC.                                                    01490099
015000**  JH  10/30/2011 END                                            01500099
015100                                                                  01510099
015200******************************************************************01520099
015300*  DB2 TABLE DECLARATION                                          01530099
015400*  (XLT_SKU - LOGISTICS SKU TABLE)                                01540099
015500******************************************************************01550099
015600     EXEC SQL                                                     01560099
015700         INCLUDE XLT00003                                         01570099
015800     END-EXEC.                                                    01580099
015900                                                                  01590099
016000******************************************************************01600099
016100*  DB2 TABLE DECLARATION                                          01610099
016200*  (XLT_SUB_CL - LOGISTICS SUB CLASS TABLE)                       01620099
016300******************************************************************01630099
016400     EXEC SQL                                                     01640099
016500         INCLUDE XLT00023                                         01650099
016600     END-EXEC.                                                    01660099
016700**  JH  10/30/2011  BEG                                           01670099
016800                                                                  01680099
016900***************************************************************** 01690099
017000**   TCOCNTL TABLE                                                01700099
017100***************************************************************** 01710099
017200     EXEC SQL                                                     01720099
017300          INCLUDE TCOCNTL                                         01730099
017400     END-EXEC.                                                    01740099
017500                                                                  01750099
017600**  JH  10/30/2011  END                                           01760099
017700                                                                  01770099
017800******************************************************************01780099
017900*  COMMUNICATIONS AREA FOR DB2                                    01790099
018000******************************************************************01800099
018100     EXEC SQL                                                     01810099
018200         INCLUDE SQLCA                                            01820099
018300     END-EXEC.                                                    01830099
018400                                                                  01840099
018500******************************************************************01850099
018600*  DB2 FORMATTED MESSAGE AREA                                     01860099
018700******************************************************************01870099
018800     COPY DPWS004.                                                01880099
018900                                                                  01890099
019000                                                                  01900099
019100*01  ABEND-CODE                      PIC S9(04)    VALUE +0       01910099
019200*VML                                               COMP SYNC.     01920099
019300 01  DK-DB2-KEYS.                                                 01930099
019400     05  DK-SKU-NBR                   PIC S9(08) VALUE +0 COMP-3. 01940099
019500**  JH  10/30/2011 BEG                                            01950099
019600     05  DK-LOC-NBR                   PIC S9(04) VALUE +0 COMP.   01960099
019700**  JH  10/30/2011 END                                            01970099
019800                                                                  01980099
019900***  PROGRAM ACCUMULATORS                                         01990099
020000 01  PA-PROGRAM-ACCUMULATORS.                                     02000099
020100     05  PA-TOTALS.                                               02010099
020200         10 PA-TOT-RECS-READ          PIC S9(09) VALUE +0 COMP-3. 02020099
020300         10 PA-TOT-HDR-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 02030099
020400         10 PA-TOT-DTL-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 02040099
020500         10 PA-TOT-DTLCNTL-RECS-READ  PIC S9(09) VALUE +0 COMP-3. 02050099
020600         10 PA-TOT-DTL-WRITTEN        PIC S9(09) VALUE +0 COMP-3. 02060099
020700                                                                  02070099
020800***  QTY COUNTS                                                   02080099
020900         10 PA-R-TQTY                 PIC 9(09)  VALUE ZERO.      02090099
021000         10 PA-M-TQTY                 PIC 9(09)  VALUE ZERO.      02100099
021100         10 PA-D-TQTY                 PIC 9(09)  VALUE ZERO.      02110099
021200                                                                  02120099
021300***  TYPE RTV TOTALS                                              02130099
021400         10 PA-R-UNIT-TOTAL        PIC S9(09)V99 VALUE +0 COMP-3. 02140099
021500         10 PA-R-RETAIL-TOTAL      PIC S9(09)V99 VALUE +0 COMP-3. 02150099
021600                                                                  02160099
021700***  TYPE MOS TOTALS                                              02170099
021800         10 PA-M-UNIT-TOTAL        PIC S9(09)V99 VALUE +0 COMP-3. 02180099
021900         10 PA-M-RETAIL-TOTAL      PIC S9(09)V99 VALUE +0 COMP-3. 02190099
022000                                                                  02200099
022100***  TYPE D&D TOTALS                                              02210099
022200         10 PA-D-UNIT-TOTAL        PIC S9(09)V99 VALUE +0 COMP-3. 02220099
022300         10 PA-D-RETAIL-TOTAL      PIC S9(09)V99 VALUE +0 COMP-3. 02230099
022400                                                                  02240099
022500***  TYPE FINAL TOTALS                                            02250099
022600         10 PA-FINAL-QTY           PIC 9(09)  VALUE ZERO.         02260099
022700         10 PA-FINAL-UNIT-AMT      PIC S9(09)V99 VALUE +0 COMP-3. 02270099
022800         10 PA-FINAL-RETAIL-AMT    PIC S9(09)V99 VALUE +0 COMP-3. 02280099
022900                                                                  02290099
023000************  ACCUMULATORS FOR CHECKING CONTROL RECORD            02300099
023100     05  PA-CONTROL-CNTS-AMTS.                                    02310099
023200***  QTY COUNTS                                                   02320099
023300         10 PA-RTV-CNTL-QTY        PIC  9(13)    VALUE ZERO.      02330099
023400         10 PA-MOS-CNTL-QTY        PIC  9(13)    VALUE ZERO.      02340099
023500         10 PA-DND-CNTL-QTY        PIC  9(13)    VALUE ZERO.      02350099
023600***  TYPE RTV TOTALS                                              02360099
023700         10 PA-RTV-CNTL-COST       PIC S9(13)V99 VALUE +0.        02370099
023800         10 PA-RTV-CNTL-RETL       PIC S9(13)V99 VALUE +0.        02380099
023900***  TYPE MOS TOTALS                                              02390099
024000         10 PA-MOS-CNTL-COST       PIC S9(13)V99 VALUE +0.        02400099
024100         10 PA-MOS-CNTL-RETL       PIC S9(13)V99 VALUE +0.        02410099
024200***  TYPE D&D TOTALS                                              02420099
024300         10 PA-DND-CNTL-COST       PIC S9(13)V99 VALUE +0.        02430099
024400         10 PA-DND-CNTL-RETL       PIC S9(13)V99 VALUE +0.        02440099
024500***  TYPE FINAL TOTALS                                            02450099
024600         10 PA-FIN-CNTL-QTY        PIC  9(13)    VALUE ZERO.      02460099
024700         10 PA-FIN-CNTL-COST       PIC S9(13)V99 VALUE +0.        02470099
024800         10 PA-FIN-CNTL-RETL       PIC S9(13)V99 VALUE +0.        02480099
024900                                                                  02490099
025000***  PROGRAM SWITCHES                                             02500099
025100 01  PS-PROGRAM-SWITCHES.                                         02510099
025200     05  PS-END-OF-HDR-INPUT-SW        PIC  X(01)    VALUE 'N'.   02520099
025300         88  PS-END-OF-HDR-INPUT-YES                 VALUE 'Y'.   02530099
025400         88  PS-END-OF-HDR-INPUT-NO                  VALUE 'N'.   02540099
025500     05  PS-END-OF-DTL-INPUT-SW        PIC  X(01)    VALUE 'N'.   02550099
025600         88  PS-END-OF-DTL-INPUT-YES                 VALUE 'Y'.   02560099
025700         88  PS-END-OF-DTL-INPUT-NO                  VALUE 'N'.   02570099
025800     05  PS-END-OF-DTLCNTL-INPUT-SW    PIC  X(01)    VALUE 'N'.   02580099
025900         88  PS-END-OF-DTLCNTL-INPUT-YES             VALUE 'Y'.   02590099
026000         88  PS-END-OF-DTLCNTL-INPUT-NO              VALUE 'N'.   02600099
026100     05  PS-ERROR-SW                   PIC  X(01)    VALUE 'N'.   02610099
026200         88  PS-ERROR-YES                            VALUE 'Y'.   02620099
026300         88  PS-ERROR-NO                             VALUE 'N'.   02630099
026400     05  PS-SUBCL-SW                   PIC  X(01)    VALUE 'N'.   02640099
026500         88  PS-SUBCL-FOUND                          VALUE 'Y'.   02650099
026600         88  PS-SUBCL-NOT-FOUND                      VALUE 'N'.   02660099
026700     05  PS-REC-TYPE-SW                PIC  X(01)    VALUE ' '.   02670099
026800         88  PS-RTV                                  VALUE 'R'.   02680099
026900         88  PS-MOS                                  VALUE 'M'.   02690099
027000         88  PS-DND                                  VALUE 'D'.   02700099
027100     05  PS-BAD-AMOUNT-SW              PIC  X(01)    VALUE 'N'.   02710099
027200         88  PS-BAD-AMOUNT                           VALUE 'Y'.   02720099
027300         88  PS-BAD-AMOUNT-NO                        VALUE 'N'.   02730099
027400                                                                  02740099
027500***  CONTROL CARD                                                 02750099
027600**  JH  10/30/2011  BEG                                           02760099
027700 01  CC-CONTROL-CARD.                                             02770099
027800     05  CC-RTV-LOCATION             PIC 9(04).                   02780099
027900**  JH  10/30/2011  END                                           02790099
028000                                                                  02800099
028100***  PROGRAM CONSTANTS                                            02810099
028200 01  PC-PROGRAM-CONSTANTS.                                        02820099
028300     05  PC-MAX-REPORT-LINES         PIC 9(02)  VALUE 55.         02830099
028400     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'RVKUT027'. 02840099
028500     05  PC-SPACE                    PIC X(01)  VALUE ' '.        02850099
028600*    05  PC-UNIT-AMT                 PIC Z,ZZZ,ZZ9.99.            02860099
028700*    05  PC-RETAIL-AMT               PIC Z,ZZZ,ZZ9.99.            02870099
028800     05  PC-R-TYPE                   PIC X(01) VALUE 'R'.         02880099
028900     05  PC-M-TYPE                   PIC X(01) VALUE 'M'.         02890099
029000     05  PC-D-TYPE                   PIC X(01) VALUE 'D'.         02900099
029100     05  PC-RTV                      PIC X(03) VALUE 'RTV'.       02910099
029200     05  PC-MOS                      PIC X(03) VALUE 'MOS'.       02920099
029300     05  PC-DAD                      PIC X(03) VALUE 'D&D'.       02930099
029400                                                                  02940099
029500***  PROGRAM VARIABLES                                            02950099
029600 01  PV-PROGRAM-VARIABLES.                                        02960099
029700                                                                  02970099
029800**  JH  10/30/2011  BEG                                           02980099
029900     05  PV-PD-DTE.                                               02990099
030000         10  PV-PD-CY                PIC 9(04)  VALUE ZERO.       03000099
030100         10  FILLER                  PIC X(01).                   03010099
030200         10  PV-PD-MM                PIC 9(02)  VALUE ZERO.       03020099
030300         10  FILLER                  PIC X(01).                   03030099
030400         10  PV-PD-DD                PIC 9(02)  VALUE ZERO.       03040099
030500**  JH  10/30/2011  END                                           03050099
030600     05  PV-PAGE-COUNT               PIC 9(05) VALUE 0.           03060099
030700     05  PV-REPT-LINE-COUNT          PIC 9(02) VALUE 0.           03070099
030800     05  PV-REC-WRITTEN              PIC 9(09) VALUE 0.           03080099
030900                                                                  03090099
031000     05  PV-SKU-REDEFINE.                                         03100099
031100         10  PV-INPUT-SKU-DEPT       PIC X(03) VALUE SPACE.       03110099
031200         10  PV-INPUT-SKU-CLASS      PIC X(02) VALUE SPACE.       03120099
031300         10  PV-INPUT-SKU-SEQ        PIC X(03) VALUE SPACE.       03130099
031400         10  PV-INPUT-SKU-FILLER     PIC X(02) VALUE SPACE.       03140099
031500                                                                  03150099
031600     05  PV-SUBCLASS-REDEFINE.                                    03160099
031700         10  PV-INPUT-SUBCLASS-PADDING PIC X(02) VALUE SPACE.     03170099
031800         10  PV-INPUT-SUBCLASS       PIC X(02) VALUE SPACE.       03180099
031900         10  PV-INPUT-SUBCLASS-FILLER  PIC X(06) VALUE SPACE.     03190099
032000                                                                  03200099
032100     05  PV-DEPT-REDEFINE.                                        03210099
032200         10  PV-INPUT-DEPT-PADDING   PIC X(01) VALUE SPACE.       03220099
032300         10  PV-INPUT-DEPT           PIC X(03) VALUE SPACE.       03230099
032400         10  PV-INPUT-DEPT-FILLER    PIC X(06) VALUE SPACE.       03240099
032500                                                                  03250099
032600     05  PV-INPUT-DEPT-9            PIC 9(03) VALUE ZERO.         03260099
032700     05  PV-INPUT-SUBCLASS-9        PIC 9(02) VALUE ZERO.         03270099
032800     05  PV-INPUT-DEPT-COMP3        PIC S9(04) VALUE +0           03280099
032900                                               COMP-3.            03290099
033000     05  PV-INPUT-SUBCLASS-COMP3    PIC S9(04) VALUE +0           03300099
033100                                               COMP-3.            03310099
033200                                                                  03320099
033300     05  PV-INPUT-SUBCLASS-2.                                     03330099
033400         10  PV-INPUT-SUBCLASS-A    PIC X(01) VALUE SPACE.        03340099
033500         10  PV-INPUT-SUBCLASS-B    PIC X(01) VALUE SPACE.        03350099
033600                                                                  03360099
033700     05  PV-INPUT-SUBCLASS-OLD      PIC X(02) VALUE SPACE.        03370099
033800     05  PV-SAVE-SUB-CL             PIC X(10) VALUE SPACE.        03380099
033900     05  PV-DISPLAY-QTY             PIC ZZZ,ZZZ,ZZZ,ZZ9.          03390099
034000     05  PV-DISPLAY-AMT             PIC ZZZ,ZZZ,ZZZ,ZZ9.99.       03400099
034100 01  PV-BAD-QTY-LINE.                                             03410099
034200     05  PV-BCA-KOHLS-LEG-Q         PIC X(20) VALUE SPACE.        03420099
034300     05  FILLER                     PIC X(05) VALUE SPACE.        03430099
034400     05  PV-BCA-QTY-KOHLS           PIC ZZZ,ZZZ,ZZ9.              03440099
034500     05  FILLER                     PIC X(05) VALUE SPACE.        03450099
034600     05  PV-BCA-GENCO-LEG-Q         PIC X(20) VALUE SPACE.        03460099
034700     05  FILLER                     PIC X(02) VALUE SPACE.        03470099
034800     05  PV-BCA-QTY-GENCO           PIC ZZZ,ZZZ,ZZ9.              03480099
034900 01  PV-BAD-AMT-LINE.                                             03490099
035000     05  PV-BCA-KOHLS-LEG-A         PIC X(20) VALUE SPACE.        03500099
035100     05  FILLER                     PIC X(05) VALUE SPACE.        03510099
035200     05  PV-BCA-AMT-KOHLS           PIC ZZZ,ZZZ,ZZ9.99.           03520099
035300     05  FILLER                     PIC X(02) VALUE SPACE.        03530099
035400     05  PV-BCA-GENCO-LEG-A         PIC X(20) VALUE SPACE.        03540099
035500     05  FILLER                     PIC X(02) VALUE SPACE.        03550099
035600     05  PV-BCA-AMT-GENCO           PIC ZZZ,ZZZ,ZZ9.99.           03560099
035700 01  PV-BLANK-LINE                  PIC X(60) VALUE SPACE.        03570099
035800                                                                  03580099
035900 01  PV-ABEND-VARIABLES.                                          03590099
036000     05  PV-ABEND-SKU               PIC X(10)  VALUE SPACE.       03600099
036100     05  PV-ABEND-ORD-ID            PIC 9(12)  VALUE ZERO.        03610099
036200     05  PV-ABEND-DEPT              PIC X(10)  VALUE SPACE.       03620099
036300     05  PV-ABEND-SUBCL             PIC X(10)  VALUE SPACE.       03630099
036400     05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.03640099
036500**  JH  10/30/2011 BEG                                            03650099
036600     05  PV-ABEND-LOC               PIC X(10)  VALUE SPACE.       03660099
036700**  JH  10/30/2011 END                                            03670099
036800     05  PV-ERROR-MSG               PIC  X(60) VALUE SPACE.       03680099
036900     05  PV-PARAGRAPH               PIC  X(30) VALUE SPACE.       03690099
037000     05  PV-ABEND-MESSAGE           PIC  X(30) VALUE SPACE.       03700099
037100     05  PV-SQLCODE                 PIC  S9(9) VALUE ZEROES.      03710099
037200     05  PV-ABEND-TABLE-1           PIC  X(20) VALUE SPACES.      03720099
037300                                                                  03730099
037400***  SYSTEM DATE VARIABLES                                        03740099
037500 01  SD-SYSTEM-DATE.                                              03750099
037600     05  SD-SYSTEM-CCYY              PIC  9(04)  VALUE ZEROS.     03760099
037700     05  SD-SYSTEM-MONTH             PIC  9(02)  VALUE ZEROS.     03770099
037800     05  SD-SYSTEM-DAY               PIC  9(02)  VALUE ZEROS.     03780099
037900                                                                  03790099
038000***  SYSTEM TIME VARIABLES                                        03800099
038100 01  ST-SYSTEM-TIME.                                              03810099
038200     05  ST-SYSTEM-HOUR              PIC  9(02)  VALUE ZEROS.     03820099
038300     05  ST-SYSTEM-MINUTE            PIC  9(02)  VALUE ZEROS.     03830099
038400                                                                  03840099
038500***  REPORT HEADING AND DETAIL LINES                              03850099
038600 01  PH2-PAGE-HEADING-2.                                          03860099
038700     05  FILLER                          PIC  X(37)  VALUE SPACE. 03870099
038800     05  FILLER                          PIC  X(51)  VALUE        03880099
038900         'DEPT/CLASS/SKU CHANGES    GENCO DATA TO RTV TABLES '.   03890099
039000     05  FILLER                          PIC  X(06)  VALUE        03900099
039100         'REPORT'.                                                03910099
039200                                                                  03920099
039300 01  PH3-PAGE-HEADING-3.                                          03930099
039400     05  FILLER                          PIC  X(54)  VALUE SPACE. 03940099
039500     05  FILLER                          PIC  X(16)  VALUE        03950099
039600         'PROCESSING DATE '.                                      03960099
039700**  JH  10/30/2011  BEG                                           03970099
039800     05  PH3-DATE.                                                03980099
039900         10  PH3-DATE-MM                 PIC  9(2).               03990099
040000         10  FILLER                      PIC  X      VALUE '/'.   04000099
040100         10  PH3-DATE-DD                 PIC  9(2).               04010099
040200         10  FILLER                      PIC  X      VALUE '/'.   04020099
040300         10  PH3-DATE-CCYY               PIC  9(4).               04030099
040400     05  FILLER                          PIC  X(52)  VALUE SPACE. 04040099
040500                                                                  04050099
040600 01  PH4-PAGE-HEADING-4.                                          04060099
040700     05  FILLER                          PIC  X(17)  VALUE        04070099
040800         '  RTV LOCATION:  '.                                     04080099
040900     05  PH4-RTV-LOC                     PIC  X(06).              04090099
041000     05  FILLER                          PIC  X(02)  VALUE SPACE. 04100099
041100     05  PH4-RTV-NAME                    PIC  X(10).              04110099
041200**  JH  10/30/2011 END                                            04120099
041300                                                                  04130099
041400 01  DH1-DETAIL-HEADING-1.                                        04140099
041500     05  FILLER                          PIC  X(03)  VALUE SPACE. 04150099
041600     05  FILLER                          PIC  X(06)  VALUE        04160099
041700         'DEFECT'.                                                04170099
041800     05  FILLER                          PIC  X(02)  VALUE SPACE. 04180099
041900     05  FILLER                          PIC  X(06)  VALUE        04190099
042000         'RETURN'.                                                04200099
042100     05  FILLER                          PIC  X(13)  VALUE SPACE. 04210099
042200     05  FILLER                          PIC  X(03)  VALUE        04220099
042300         'OLD'.                                                   04230099
042400     05  FILLER                          PIC  X(09)  VALUE SPACE. 04240099
042500     05  FILLER                          PIC  X(03)  VALUE        04250099
042600         'NEW'.                                                   04260099
042700     05  FILLER                          PIC  X(10)  VALUE SPACE. 04270099
042800     05  FILLER                          PIC  X(03)  VALUE        04280099
042900         'OLD'.                                                   04290099
043000     05  FILLER                          PIC  X(10)  VALUE SPACE. 04300099
043100     05  FILLER                          PIC  X(03)  VALUE        04310099
043200         'NEW'.                                                   04320099
043300     05  FILLER                          PIC  X(15)  VALUE SPACE. 04330099
043400     05  FILLER                          PIC  X(06)  VALUE        04340099
043500         'RETAIL'.                                                04350099
043600     05  FILLER                          PIC  X(15)  VALUE SPACE. 04360099
043700     05  FILLER                          PIC  X(04)  VALUE        04370099
043800         'COST'.                                                  04380099
043900                                                                  04390099
044000 01  DH2-DETAIL-HEADING-2.                                        04400099
044100     05  FILLER                          PIC  X(03)  VALUE SPACE. 04410099
044200     05  FILLER                          PIC  X(06)  VALUE        04420099
044300         'ORD ID'.                                                04430099
044400     05  FILLER                          PIC  X(03)  VALUE SPACE. 04440099
044500     05  FILLER                          PIC  X(04)  VALUE        04450099
044600         'TYPE'.                                                  04460099
044700     05  FILLER                          PIC  X(04)  VALUE SPACE. 04470099
044800     05  FILLER                          PIC  X(04)  VALUE        04480099
044900         'DEPT'.                                                  04490099
045000     05  FILLER                          PIC  X(05)  VALUE SPACE. 04500099
045100     05  FILLER                          PIC  X(06)  VALUE        04510099
045200         'SUB CL'.                                                04520099
045300     05  FILLER                          PIC  X(06)  VALUE SPACE. 04530099
045400     05  FILLER                          PIC  X(06)  VALUE        04540099
045500         'SUB CL'.                                                04550099
045600     05  FILLER                          PIC  X(08)  VALUE SPACE. 04560099
045700     05  FILLER                          PIC  X(03)  VALUE        04570099
045800         'SKU'.                                                   04580099
045900     05  FILLER                          PIC  X(10)  VALUE SPACE. 04590099
046000     05  FILLER                          PIC  X(03)  VALUE        04600099
046100         'SKU'.                                                   04610099
046200     05  FILLER                          PIC  X(15)  VALUE SPACE. 04620099
046300     05  FILLER                          PIC  X(06)  VALUE        04630099
046400         'AMOUNT'.                                                04640099
046500     05  FILLER                          PIC  X(13)  VALUE SPACE. 04650099
046600     05  FILLER                          PIC  X(06)  VALUE        04660099
046700         'AMOUNT'.                                                04670099
046800                                                                  04680099
046900 01  DH3-DETAIL-HEADING-3.                                        04690099
047000     05  FILLER                          PIC  X(132) VALUE        04700099
047100                                                       ALL '-'.   04710099
047200 01  DL1-DETAIL-LINE.                                             04720099
047300     05  FILLER                          PIC  X(03)  VALUE SPACE. 04730099
047400     05  DL1-ORD-ID-X.                                            04740099
047500         10  DL1-ORD-ID-9                PIC  9(12).              04750099
047600     05  FILLER                          PIC  X(02)  VALUE SPACE. 04760099
047700     05  DL1-RETURN-TYPE                 PIC  X(01).              04770099
047800     05  FILLER                          PIC  X(05)  VALUE SPACE. 04780099
047900     05  DL1-DEPT                        PIC  X(03).              04790099
048000     05  FILLER                          PIC  X(04)  VALUE SPACE. 04800099
048100     05  DL1-OLD-SUB-CL                  PIC  X(10).              04810099
048200     05  FILLER                          PIC  X(02)  VALUE SPACE. 04820099
048300     05  DL1-NEW-SUB-CL                  PIC  X(10).              04830099
048400     05  FILLER                          PIC  X(02)  VALUE SPACE. 04840099
048500     05  DL1-OLD-SKU                     PIC  X(10).              04850099
048600     05  FILLER                          PIC  X(03)  VALUE SPACE. 04860099
048700     05  DL1-NEW-SKU                     PIC  X(10).              04870099
048800     05  FILLER                          PIC  X(04)  VALUE SPACE. 04880099
048900     05  DL1-RETAIL-AMT                  PIC  ZZZ,ZZZ,ZZZ.99-.    04890099
049000     05  FILLER                          PIC  X(04)  VALUE SPACE. 04900099
049100     05  DL1-COST-AMT                    PIC  ZZZ,ZZZ,ZZZ.99-.    04910099
049200                                                                  04920099
049300 01  TL1-TOTAL-LINE-HDR.                                          04930099
049400     05  FILLER                          PIC  X(03)  VALUE SPACE. 04940099
049500     05  FILLER                          PIC  X(05)  VALUE        04950099
049600         'TOTAL'.                                                 04960099
049700     05  FILLER                          PIC  X(13)  VALUE SPACE. 04970099
049800     05  FILLER                          PIC  X(03)  VALUE        04980099
049900         'QTY'.                                                   04990099
050000     05  FILLER                          PIC  X(16)  VALUE SPACE. 05000099
050100     05  FILLER                          PIC  X(06)  VALUE        05010099
050200         'RETAIL'.                                                05020099
050300     05  FILLER                          PIC  X(14)  VALUE SPACE. 05030099
050400     05  FILLER                          PIC  X(04)  VALUE        05040099
050500         'COST'.                                                  05050099
050600                                                                  05060099
050700 01  TL2-TOTAL-LINE-DTL.                                          05070099
050800     05  FILLER                          PIC  X(03)  VALUE SPACE. 05080099
050900     05  TL2-TOT-TYPE                    PIC  X(03).              05090099
051000     05  FILLER                          PIC  X(07)  VALUE SPACE. 05100099
051100     05  TL2-QTY                         PIC  ZZZ,ZZZ,ZZ9.        05110099
051200     05  FILLER                          PIC  X(08)  VALUE SPACE. 05120099
051300     05  TL2-TOT-RETAIL                  PIC  ZZZ,ZZZ,ZZ9.99.     05130099
051400     05  FILLER                          PIC  X(04)  VALUE SPACE. 05140099
051500     05  TL2-TOT-COST                    PIC  ZZZ,ZZZ,ZZ9.99.     05150099
051600                                                                  05160099
051700                                                                  05170099
051800 01  FT1-FTOTAL-LINE.                                             05180099
051900     05  FILLER                          PIC  X(03)  VALUE SPACE. 05190099
052000     05  FILLER                          PIC  X(06)  VALUE        05200099
052100         'FTOTAL'.                                                05210099
052200     05  FILLER                          PIC  X(04)  VALUE SPACE. 05220099
052300     05  FL1-QTY                         PIC  ZZZ,ZZZ,ZZ9.        05230099
052400     05  FILLER                          PIC  X(08)  VALUE SPACE. 05240099
052500     05  FL1-TOT-RETAIL                  PIC  ZZZ,ZZZ,ZZ9.99.     05250099
052600     05  FILLER                          PIC  X(04)  VALUE SPACE. 05260099
052700     05  FL1-TOT-COST                    PIC  ZZZ,ZZZ,ZZ9.99.     05270099
052800                                                                  05280099
052900 01  BLANK-LINE.                                                  05290099
053000     05  FILLER                          PIC  X(132) VALUE SPACE. 05300099
053100                                                                  05310099
053200 01  END-OF-REPORT-LINE.                                          05320099
053300     05  FILLER                          PIC  X(54)  VALUE SPACE. 05330099
053400     05  FILLER                          PIC  X(25)  VALUE        05340099
053500         '***** END OF REPORT *****'.                             05350099
053600     05  FILLER                          PIC  X(53)  VALUE SPACE. 05360099
053700                                                                  05370099
053800 01  PV-NO-ERROR-LINE.                                            05380099
053900     05  FILLER                          PIC  X(43)  VALUE SPACE. 05390099
054000     05  FILLER                          PIC  X(47)  VALUE        05400099
054100         '******** THERE ARE NO ERRORS TO REPORT ********'.       05410099
054200     05  FILLER                          PIC  X(42)  VALUE SPACE. 05420099
054300                                                                  05430099
054400******************************************************************05440099
054500 LINKAGE SECTION.                                                 05450099
054600******************************************************************05460099
054700                                                                  05470099
054800                                                                  05480099
054900******************************************************************05490099
055000 PROCEDURE DIVISION.                                              05500099
055100******************************************************************05510099
055200******************************************************************05520099
055300*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *05530099
055400******************************************************************05540099
055500 0000-PROGRAM-MAINLINE.                                           05550099
055600                                                                  05560099
055700     DISPLAY '************ START OF RVKUT027 ***************'     05570099
055800**  JH  10/30/2011  BEG                                           05580099
055900     PERFORM 1000-INITIALIZE THRU 1000-EXIT.                      05590099
056000**  JH  10/30/2011  END                                           05600099
056100                                                                  05610099
056200     IF PS-END-OF-DTL-INPUT-NO                                    05620099
056210        AND PS-END-OF-HDR-INPUT-NO                                05621099
056300        PERFORM 1200-CONTINUE-PROCESSING                          05630099
056400**  JH  10/30/2011  BEG                                           05640099
056500        GOBACK                                                    05650099
056600**  JH  10/30/2011  END                                           05660099
056700     ELSE                                                         05670099
056800        IF PS-END-OF-DTL-INPUT-YES                                05680099
056900           DISPLAY ' '                                            05690099
057000           DISPLAY '***** NO RECORDS ON DETAIL INPUT FILE ****'   05700099
057100           DISPLAY ' '                                            05710099
057200        END-IF                                                    05720099
057210        IF PS-END-OF-HDR-INPUT-YES                                05721099
057220           DISPLAY ' '                                            05722099
057230           DISPLAY '***** NO RECORDS ON HEADER INPUT FILE ****'   05723099
057240           DISPLAY ' '                                            05724099
057250        END-IF                                                    05725099
057300        CLOSE RTV-HEADER-FILE                                     05730099
057400              RTV-DTL-FILE                                        05740099
057500              RTV-NEW-DTL-FILE                                    05750099
057600              MESSAGE-FILE                                        05760099
057700     END-IF.                                                      05770099
057800                                                                  05780099
057900     DISPLAY '************  END OF RVKUT027  ***************'     05790099
058000**  JH  10/30/2011  BEG                                           05800099
058100     GOBACK.                                                      05810099
058200**  JH  10/30/2011  END                                           05820099
058300                                                                  05830099
058400******************************************************************05840099
058500* INITIALIZE VARIABLES.                                           05850099
058600* OPEN FILES.                                                     05860099
058700* DO A PRIME READ FOR THE DTL (DRIVER) & HDR FILES                05870099
058800******************************************************************05880099
058900 1000-INITIALIZE.                                                 05890099
059000                                                                  05900099
059100     INITIALIZE   PA-PROGRAM-ACCUMULATORS                         05910099
059200                  ERROR-RPT-RECORD.                               05920099
059300                                                                  05930099
059400     OPEN INPUT  RTV-HEADER-FILE                                  05940099
059500                 RTV-DTL-CONTROL-FILE                             05950099
059600                 RTV-DTL-FILE.                                    05960099
059700                                                                  05970099
059800     OPEN OUTPUT RTV-NEW-DTL-FILE                                 05980099
059900                 ERROR-REPORT                                     05990099
060000                 MESSAGE-FILE.                                    06000099
060100**  JH  10/30/2011  BEG                                           06010099
060200                                                                  06020099
060300     PERFORM 5010-SELECT-TCOCNTL.                                 06030099
060400                                                                  06040099
060500     MOVE COCNTL-BTCH-PRC-DTE TO PV-PD-DTE.                       06050099
060600                                                                  06060099
060700     MOVE PV-PD-MM TO PH3-DATE-MM.                                06070099
060800     MOVE PV-PD-DD TO PH3-DATE-DD.                                06080099
060900     MOVE PV-PD-CY TO PH3-DATE-CCYY.                              06090099
061000                                                                  06100099
061100**  JH  10/30/2011  END                                           06110099
061200                                                                  06120099
061300     MOVE FUNCTION CURRENT-DATE (1:8) TO SD-SYSTEM-DATE.          06130099
061400     MOVE FUNCTION CURRENT-DATE (9:6) TO ST-SYSTEM-TIME.          06140099
061500                                                                  06150099
061600     MOVE SD-SYSTEM-CCYY   TO DP132-RUN-YEAR.                     06160099
061700     MOVE SD-SYSTEM-MONTH  TO DP132-RUN-MONTH.                    06170099
061800     MOVE SD-SYSTEM-DAY    TO DP132-RUN-DAY.                      06180099
061900                                                                  06190099
062000     MOVE ST-SYSTEM-HOUR   TO DP132-RUN-HOUR.                     06200099
062100     MOVE ST-SYSTEM-MINUTE TO DP132-RUN-MINUTE.                   06210099
062200                                                                  06220099
062300     MOVE 'RVKUT027'       TO DP132-PROGRAM-NAME.                 06230099
062400     MOVE 1                TO DP132-REPORT-NUMBER.                06240099
062500** THERE SHOULD BE ONLY CONTROL RECORD. CLOSE FILE AFTER 1 READ.  06250099
062600     INITIALIZE RV052-GENCO-DTL-CNTL-RECORD.                      06260099
062700     PERFORM 6005-READ-RTV-DTL-CNTL-FILE.                         06270099
062800     IF PA-TOT-DTLCNTL-RECS-READ > +0                             06280099
062900         CLOSE RTV-DTL-CONTROL-FILE                               06290099
063000     END-IF.                                                      06300099
063100                                                                  06310099
063200**PRIME READ OF HDR FILE                                          06320099
063300     PERFORM 6000-READ-RTV-HDR-FILE.                              06330099
063400                                                                  06340099
063500**PRIME READ OF DTL FILE                                          06350099
063600     PERFORM 6001-READ-RTV-DTL-FILE.                              06360099
063700                                                                  06370099
063800**  JH  10/30/2011 BEG                                            06380099
063900                                                                  06390099
064000     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           06400099
064100                                                                  06410099
064200**  CMS 10/30/2011 BEG                                            06420099
064300     IF PS-END-OF-HDR-INPUT-NO                                    06430099
064400         IF CC-RTV-LOCATION EQUAL RV050-OPER-UNT-ID               06440099
064500             NEXT SENTENCE                                        06450099
064600         ELSE                                                     06460099
064700             DISPLAY '*************************************'      06470099
064800             DISPLAY '**              ABEND              **'      06480099
064900             DISPLAY '** PROGRAM   = RVKUT027            **'      06490099
065000             DISPLAY '** PARAGRAPH = 1000-INITIALIZE     **'      06500099
065100             DISPLAY '** INPUT RTV LOCATION IS NOT EQUAL **'      06510099
065200             DISPLAY '** CNTL CARD RTV LOCATION          **'      06520099
065300             DISPLAY '**                                 **'      06530099
065400             DISPLAY '** INPUT RTV LOCATION : ' RV050-OPER-UNT-ID 06540099
065500             DISPLAY '** C.C.  RTV LOCATION : ' CC-RTV-LOCATION   06550099
065600             DISPLAY '*************************************'      06560099
065700             MOVE +4019 TO PV-ABEND-CODE                          06570099
065800             CALL 'ILBOABN0' USING PV-ABEND-CODE                  06580099
065900         END-IF                                                   06590099
066000     END-IF.                                                      06600099
066100**  CMS 10/30/2011 END                                            06610099
066200                                                                  06620099
066300     MOVE CC-RTV-LOCATION TO DK-LOC-NBR.                          06630099
066400                                                                  06640099
066500     PERFORM 6065-VALIDATE-LOCATION.                              06650099
066600                                                                  06660099
066700     PERFORM 4000-WRITE-PAGE-HEADING.                             06670099
066800                                                                  06680099
066900**  CMS 10/30/2011 BEG                                            06690099
067000**  CHECK FOR EMPTY HEADER RECORD AND END REPORT                  06700099
067100     IF PS-END-OF-HDR-INPUT-YES                                   06710099
067200         INITIALIZE DL1-DETAIL-LINE                               06720099
067300         MOVE END-OF-REPORT-LINE TO DL1-DETAIL-LINE               06730099
067400         WRITE ERROR-RPT-RECORD                                   06740099
067500             FROM DL1-DETAIL-LINE                                 06750099
067600             AFTER ADVANCING 2 LINES                              06760099
067700     END-IF.                                                      06770099
067800**  CMS 10/30/2011 END                                            06780099
067900                                                                  06790099
068000 1000-EXIT.                                                       06800099
068100     EXIT.                                                        06810099
068200**  JH  10/30/2011 END                                            06820099
068300                                                                  06830099
068400******************************************************************06840099
068500* PERFORM MAIN LOOP UNTIL EOF                                     06850099
068600* EOJ TASKS                                                       06860099
068700******************************************************************06870099
068800 1200-CONTINUE-PROCESSING.                                        06880099
068900                                                                  06890099
069000*PROCESS INPUT FILES TO EOF                                       06900099
069100     PERFORM 2000-REWRITE-DTL-FILE                                06910099
069200       UNTIL PS-END-OF-DTL-INPUT-YES.                             06920099
069300                                                                  06930099
069400*END OF INPUT PROCESSING.                                         06940099
069500                                                                  06950099
069600***  COMPARE CALCULATED CONTROL TOTALS WITH THE GENCO CONTROL     06960099
069700***  RECORD.  IF COUNTS AND AMOUNTS MATCH, CONTINUE.              06970099
069800***  IF COUNTS AND AMOUNTS DO NOT MATCH, ABEND PROGRAM.  THESE    06980099
069900***  VALUES MUST MATCH, BEFORE INTERFACING TO OTHER SYSTEMS OR    06990099
070000***  LOADING INTO THE RTV TABLES.                                 07000099
070100                                                                  07010099
070200     PERFORM 7500-COMPARE-CNTS-AMTS.                              07020099
070300                                                                  07030099
070400                                                                  07040099
070500*    COMPARE TOTAL DETAIL RECORDS READ AND WRITTEN                07050099
070600*    IF EQUAL THEN SUCCESSFUL EOJ                                 07060099
070700*    IF NOT - ABEND PROGRAM                                       07070099
070800                                                                  07080099
070900     IF PA-TOT-DTL-RECS-READ = PA-TOT-DTL-WRITTEN                 07090099
071000         PERFORM 8000-EOJ-ROUTINE                                 07100099
071100     ELSE                                                         07110099
071200         PERFORM 9200-NON-SQL-ABEND                               07120099
071300     END-IF.                                                      07130099
071400**   THIS WAS CAUSING A COND = 4, COMPILE ERROR.                  07140099
071500**   MOVED TO AFTER THE PERFORM OF THE PARAGRAPH.                 07150099
071600**   STOP RUN.                                                    07160099
071700                                                                  07170099
071800******************************************************************07180099
071900*                                                                 07190099
072000*                                                                 07200099
072100*                                                                 07210099
072200******************************************************************07220099
072300 2000-REWRITE-DTL-FILE.                                           07230099
072400                                                                  07240099
072500     IF RV051-DFCT-ORD-ID < PC-SPACE                              07250099
072600        PERFORM                                                   07260099
072700          UNTIL RV051-DFCT-ORD-ID > PC-SPACE                      07270099
072800             OR PS-END-OF-DTL-INPUT-YES                           07280099
072900                                                                  07290099
073000             PERFORM 7000-WRITE-NEW-DTL-FILE                      07300099
073100             IF PS-END-OF-DTL-INPUT-NO                            07310099
073200                PERFORM 6001-READ-RTV-DTL-FILE                    07320099
073300             END-IF                                               07330099
073400        END-PERFORM                                               07340099
073500     END-IF.                                                      07350099
073600                                                                  07360099
073700     IF RV051-DFCT-ORD-ID < RV050-DFCT-ORD-ID                     07370099
073800        PERFORM                                                   07380099
073900          UNTIL RV051-DFCT-ORD-ID >= RV050-DFCT-ORD-ID            07390099
074000               OR PS-END-OF-DTL-INPUT-YES                         07400099
074100             PERFORM 7000-WRITE-NEW-DTL-FILE                      07410099
074200             IF PS-END-OF-DTL-INPUT-NO                            07420099
074300                PERFORM 6001-READ-RTV-DTL-FILE                    07430099
074400             END-IF                                               07440099
074500        END-PERFORM                                               07450099
074600     END-IF.                                                      07460099
074700                                                                  07470099
074800     IF RV051-DFCT-ORD-ID = RV050-DFCT-ORD-ID                     07480099
074900        SET PS-ERROR-NO        TO TRUE                            07490099
075000        PERFORM 6050-VALIDATE-DEPT-SUBCL                          07500099
075100        PERFORM 6055-VALIDATE-SKU                                 07510099
075200        IF PS-ERROR-YES                                           07520099
075300            PERFORM 4400-BUILD-DETAIL-LINE                        07530099
075400            PERFORM 4100-WRITE-REPORT                             07540099
075500        END-IF                                                    07550099
075600                                                                  07560099
075700        MOVE RV050-RETURN-TYPE TO RV051-DTL-RETURN-TYPE           07570099
075800        PERFORM 5000-ACCUM-CNT-AMTS                               07580099
075900        PERFORM 7000-WRITE-NEW-DTL-FILE                           07590099
076000        IF PS-END-OF-DTL-INPUT-NO                                 07600099
076100            PERFORM 6001-READ-RTV-DTL-FILE                        07610099
076200        END-IF                                                    07620099
076300     ELSE                                                         07630099
076400                                                                  07640099
076500        IF RV051-DFCT-ORD-ID > RV050-DFCT-ORD-ID                  07650099
076600           IF PS-END-OF-HDR-INPUT-NO                              07660099
076700               PERFORM 6000-READ-RTV-HDR-FILE                     07670099
076800           END-IF                                                 07680099
076900        ELSE                                                      07690099
077000           IF PS-END-OF-DTL-INPUT-NO                              07700099
077100               PERFORM 6001-READ-RTV-DTL-FILE                     07710099
077200           END-IF                                                 07720099
077300        END-IF                                                    07730099
077400     END-IF.                                                      07740099
077500                                                                  07750099
077600******************************************************************07760099
077700*** 4000-WRITE-PAGE-HEADING.                                      07770099
077800***   - WRITE HEADING TO THE REPORT.                              07780099
077900***   - EXECUTES WHEN PAGE BREAK OCCURS.                          07790099
078000******************************************************************07800099
078100 4000-WRITE-PAGE-HEADING.                                         07810099
078200     ADD  1             TO PV-PAGE-COUNT.                         07820099
078300     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     07830099
078400                                                                  07840099
078500     WRITE ERROR-RPT-RECORD                                       07850099
078600         FROM DP132-STANDRD-HEADER-132-COLS                       07860099
078700         AFTER ADVANCING PAGE.                                    07870099
078800                                                                  07880099
078900     WRITE ERROR-RPT-RECORD                                       07890099
079000         FROM PH2-PAGE-HEADING-2                                  07900099
079100         AFTER ADVANCING 1 LINES.                                 07910099
079200                                                                  07920099
079300     WRITE ERROR-RPT-RECORD                                       07930099
079400         FROM PH3-PAGE-HEADING-3                                  07940099
079500         AFTER ADVANCING 1 LINES.                                 07950099
079600                                                                  07960099
079700**  JH  10/30/2011 BEG                                            07970099
079800     WRITE ERROR-RPT-RECORD                                       07980099
079900         FROM PH4-PAGE-HEADING-4                                  07990099
080000         AFTER ADVANCING 1 LINES.                                 08000099
080100**  JH  10/30/2011 END                                            08010099
080200                                                                  08020099
080300     WRITE ERROR-RPT-RECORD                                       08030099
080400         FROM BLANK-LINE                                          08040099
080500         AFTER ADVANCING 1 LINES.                                 08050099
080600                                                                  08060099
080700     WRITE ERROR-RPT-RECORD                                       08070099
080800         FROM DH1-DETAIL-HEADING-1                                08080099
080900         AFTER ADVANCING 1 LINES.                                 08090099
081000                                                                  08100099
081100     WRITE ERROR-RPT-RECORD                                       08110099
081200         FROM DH2-DETAIL-HEADING-2                                08120099
081300         AFTER ADVANCING 1 LINES.                                 08130099
081400                                                                  08140099
081500     WRITE ERROR-RPT-RECORD                                       08150099
081600         FROM DH3-DETAIL-HEADING-3                                08160099
081700         AFTER ADVANCING 1 LINES.                                 08170099
081800                                                                  08180099
081900     WRITE ERROR-RPT-RECORD                                       08190099
082000         FROM BLANK-LINE                                          08200099
082100         AFTER ADVANCING 1 LINES.                                 08210099
082200                                                                  08220099
082300     MOVE  6 TO PV-REPT-LINE-COUNT.                               08230099
082400                                                                  08240099
082500                                                                  08250099
082600******************************************************************08260099
082700*** 4100-WRITE-REPORT.                                            08270099
082800***   - WRITE DETAIL LINES TO THE REPORT.                         08280099
082900******************************************************************08290099
083000                                                                  08300099
083100 4100-WRITE-REPORT.                                               08310099
083200     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 08320099
083300         PERFORM 4000-WRITE-PAGE-HEADING                          08330099
083400     END-IF.                                                      08340099
083500                                                                  08350099
083600     WRITE ERROR-RPT-RECORD                                       08360099
083700         FROM DL1-DETAIL-LINE                                     08370099
083800         AFTER ADVANCING 2 LINES.                                 08380099
083900     ADD 2 TO PV-REPT-LINE-COUNT                                  08390099
084000     ADD 1 TO PV-REC-WRITTEN.                                     08400099
084100                                                                  08410099
084200     INITIALIZE DL1-DETAIL-LINE.                                  08420099
084300                                                                  08430099
084400******************************************************************08440099
084500* BUILD DETAIL LINE                                               08450099
084600******************************************************************08460099
084700 4400-BUILD-DETAIL-LINE.                                          08470099
084800                                                                  08480099
084900     MOVE RV051-DFCT-ORD-ID          TO DL1-ORD-ID-9.             08490099
085000     MOVE RV050-RETURN-TYPE          TO DL1-RETURN-TYPE.          08500099
085100     MOVE PV-INPUT-DEPT              TO DL1-DEPT.                 08510099
085200                                                                  08520099
085300*** BUILD RTV $AMTS AND QTY'S                                     08530099
085400     IF RV050-RETURN-TYPE = PC-R-TYPE                             08540099
085500         ADD +1                      TO PA-R-TQTY                 08550099
085600         ADD +1                      TO PA-FINAL-QTY              08560099
085700         ADD  RV051-UNIT-COST-AMT    TO PA-R-UNIT-TOTAL           08570099
085800                                        PA-FINAL-UNIT-AMT         08580099
085900         ADD  RV051-RTL-COST-AMT     TO PA-R-RETAIL-TOTAL         08590099
086000                                        PA-FINAL-RETAIL-AMT       08600099
086100     END-IF.                                                      08610099
086200                                                                  08620099
086300*** BUILD MOS $AMTS AND QTY'S                                     08630099
086400     IF RV050-RETURN-TYPE = PC-M-TYPE                             08640099
086500         ADD +1                      TO PA-M-TQTY                 08650099
086600         ADD +1                      TO PA-FINAL-QTY              08660099
086700         ADD  RV051-UNIT-COST-AMT    TO PA-M-UNIT-TOTAL           08670099
086800                                        PA-FINAL-UNIT-AMT         08680099
086900         ADD  RV051-RTL-COST-AMT     TO PA-M-RETAIL-TOTAL         08690099
087000                                        PA-FINAL-RETAIL-AMT       08700099
087100     END-IF.                                                      08710099
087200                                                                  08720099
087300*** BUILD D&D $AMTS AND QTY'S                                     08730099
087400     IF RV050-RETURN-TYPE = PC-D-TYPE                             08740099
087500         ADD +1                      TO PA-D-TQTY                 08750099
087600         ADD +1                      TO PA-FINAL-QTY              08760099
087700         ADD  RV051-UNIT-COST-AMT    TO PA-D-UNIT-TOTAL           08770099
087800                                        PA-FINAL-UNIT-AMT         08780099
087900         ADD  RV051-RTL-COST-AMT     TO PA-D-RETAIL-TOTAL         08790099
088000                                        PA-FINAL-RETAIL-AMT       08800099
088100     END-IF.                                                      08810099
088200                                                                  08820099
088300******************************************************************08830099
088400*** 4500-WRITE-FINAL-TOTALS                                       08840099
088500***   - BUILD AND WRITE TOTALS AND FINAL TOTALS TO THE REPORT.    08850099
088600******************************************************************08860099
088700                                                                  08870099
088800 4500-WRITE-FINAL-TOTALS.                                         08880099
088900     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 08890099
089000         PERFORM 4000-WRITE-PAGE-HEADING                          08900099
089100     END-IF.                                                      08910099
089200                                                                  08920099
089300     WRITE ERROR-RPT-RECORD                                       08930099
089400         FROM TL1-TOTAL-LINE-HDR                                  08940099
089500         AFTER ADVANCING 4 LINES.                                 08950099
089600     ADD 4 TO PV-REPT-LINE-COUNT.                                 08960099
089700     ADD 1 TO PV-REC-WRITTEN.                                     08970099
089800                                                                  08980099
089900     WRITE ERROR-RPT-RECORD                                       08990099
090000         FROM DH3-DETAIL-HEADING-3                                09000099
090100         AFTER ADVANCING 1 LINES.                                 09010099
090200     ADD 1 TO PV-REPT-LINE-COUNT.                                 09020099
090300                                                                  09030099
090400*** BUILD AND PRINT RTV TOTALS                                    09040099
090500     MOVE PC-RTV                TO TL2-TOT-TYPE.                  09050099
090600     MOVE PA-R-TQTY             TO TL2-QTY.                       09060099
090700     MOVE PA-R-RETAIL-TOTAL     TO TL2-TOT-RETAIL.                09070099
090800     MOVE PA-R-UNIT-TOTAL       TO TL2-TOT-COST.                  09080099
090900                                                                  09090099
091000     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 09100099
091100         PERFORM 4000-WRITE-PAGE-HEADING                          09110099
091200     END-IF.                                                      09120099
091300                                                                  09130099
091400     WRITE ERROR-RPT-RECORD                                       09140099
091500         FROM TL2-TOTAL-LINE-DTL                                  09150099
091600         AFTER ADVANCING 2 LINES.                                 09160099
091700     ADD 2 TO PV-REPT-LINE-COUNT                                  09170099
091800     ADD 1 TO PV-REC-WRITTEN.                                     09180099
091900                                                                  09190099
092000*** BUILD AND PRINT MOS TOTALS                                    09200099
092100     MOVE PC-MOS                TO TL2-TOT-TYPE.                  09210099
092200     MOVE PA-M-TQTY             TO TL2-QTY.                       09220099
092300     MOVE PA-M-RETAIL-TOTAL     TO TL2-TOT-RETAIL.                09230099
092400     MOVE PA-M-UNIT-TOTAL       TO TL2-TOT-COST.                  09240099
092500                                                                  09250099
092600     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 09260099
092700         PERFORM 4000-WRITE-PAGE-HEADING                          09270099
092800     END-IF.                                                      09280099
092900                                                                  09290099
093000     WRITE ERROR-RPT-RECORD                                       09300099
093100         FROM TL2-TOTAL-LINE-DTL                                  09310099
093200         AFTER ADVANCING 2 LINES.                                 09320099
093300     ADD 2 TO PV-REPT-LINE-COUNT                                  09330099
093400     ADD 1 TO PV-REC-WRITTEN.                                     09340099
093500                                                                  09350099
093600*** BUILD AND PRINT D&D TOTALS                                    09360099
093700     MOVE PC-DAD                TO TL2-TOT-TYPE.                  09370099
093800     MOVE PA-D-TQTY             TO TL2-QTY.                       09380099
093900     MOVE PA-D-RETAIL-TOTAL     TO TL2-TOT-RETAIL.                09390099
094000     MOVE PA-D-UNIT-TOTAL       TO TL2-TOT-COST.                  09400099
094100                                                                  09410099
094200     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 09420099
094300         PERFORM 4000-WRITE-PAGE-HEADING                          09430099
094400     END-IF.                                                      09440099
094500                                                                  09450099
094600     WRITE ERROR-RPT-RECORD                                       09460099
094700         FROM TL2-TOTAL-LINE-DTL                                  09470099
094800         AFTER ADVANCING 2 LINES.                                 09480099
094900     ADD 2 TO PV-REPT-LINE-COUNT                                  09490099
095000     ADD 1 TO PV-REC-WRITTEN.                                     09500099
095100                                                                  09510099
095200*** BUILD AND PRINT FINAL TOTALS                                  09520099
095300     MOVE PA-FINAL-QTY          TO FL1-QTY.                       09530099
095400     MOVE PA-FINAL-RETAIL-AMT   TO FL1-TOT-RETAIL.                09540099
095500     MOVE PA-FINAL-UNIT-AMT     TO FL1-TOT-COST.                  09550099
095600                                                                  09560099
095700     IF  PV-REPT-LINE-COUNT > PC-MAX-REPORT-LINES                 09570099
095800         PERFORM 4000-WRITE-PAGE-HEADING                          09580099
095900     END-IF.                                                      09590099
096000                                                                  09600099
096100     WRITE ERROR-RPT-RECORD                                       09610099
096200         FROM FT1-FTOTAL-LINE                                     09620099
096300         AFTER ADVANCING 2 LINES.                                 09630099
096400     ADD 2 TO PV-REPT-LINE-COUNT                                  09640099
096500     ADD 1 TO PV-REC-WRITTEN.                                     09650099
096600                                                                  09660099
096700******************************************************************09670099
096800* ACCUMULATE THE NUMBER OF RTV, MOS, DND RECORDS AND THE         *09680099
096900* COST AND RETAIL AMOUNTS TO VERIFY CONTROL RECORD FROM GENCO    *09690099
097000* THESE AMOUNTS WILL BE COMPARED TO THE CONTROL RECORD BEFORE    *09700099
097100* EOJ AND IF THEY DON'T MATCH A RETURN WILL BE SET AND JOB *      09710099
097200* STOPPED.     *                                                  09720099
097300******************************************************************09730099
097400 5000-ACCUM-CNT-AMTS.                                             09740099
097500     EVALUATE RV050-RETURN-TYPE                                   09750099
097600         WHEN 'R'                                                 09760099
097700             SET PS-RTV TO TRUE                                   09770099
097800         WHEN 'M'                                                 09780099
097900             SET PS-MOS TO TRUE                                   09790099
098000         WHEN 'D'                                                 09800099
098100             SET PS-DND TO TRUE                                   09810099
098200     END-EVALUATE.                                                09820099
098300                                                                  09830099
098400     IF PS-RTV                                                    09840099
098500         ADD 1                   TO PA-RTV-CNTL-QTY               09850099
098600                                    PA-FIN-CNTL-QTY               09860099
098700         ADD RV051-UNIT-COST-AMT TO PA-RTV-CNTL-COST              09870099
098800                                    PA-FIN-CNTL-COST              09880099
098900         ADD RV051-RTL-COST-AMT  TO PA-RTV-CNTL-RETL              09890099
099000                                    PA-FIN-CNTL-RETL              09900099
099100     END-IF.                                                      09910099
099200                                                                  09920099
099300     IF PS-MOS                                                    09930099
099400         ADD 1                   TO PA-MOS-CNTL-QTY               09940099
099500                                    PA-FIN-CNTL-QTY               09950099
099600         ADD RV051-UNIT-COST-AMT TO PA-MOS-CNTL-COST              09960099
099700                                    PA-FIN-CNTL-COST              09970099
099800         ADD RV051-RTL-COST-AMT  TO PA-MOS-CNTL-RETL              09980099
099900                                    PA-FIN-CNTL-RETL              09990099
100000     END-IF.                                                      10000099
100100                                                                  10010099
100200     IF PS-DND                                                    10020099
100300         ADD 1                   TO PA-DND-CNTL-QTY               10030099
100400                                    PA-FIN-CNTL-QTY               10040099
100500         ADD RV051-UNIT-COST-AMT TO PA-DND-CNTL-COST              10050099
100600                                    PA-FIN-CNTL-COST              10060099
100700         ADD RV051-RTL-COST-AMT  TO PA-DND-CNTL-RETL              10070099
100800                                    PA-FIN-CNTL-RETL              10080099
100900     END-IF.                                                      10090099
101000**  JH  10/30/2011  BEG                                           10100099
101100                                                                  10110099
101200 5010-SELECT-TCOCNTL.                                             10120099
101300                                                                  10130099
101400     MOVE '5000-SELECT-TCOCNTL'  TO PV-PARAGRAPH.                 10140099
101500                                                                  10150099
101600     EXEC SQL                                                     10160099
101700        SELECT  A.BTCH_PRC_DTE                                    10170099
101800          INTO :COCNTL-BTCH-PRC-DTE                               10180099
101900          FROM  TCOCNTL A                                         10190099
102000          WHERE A.OPER_UNT_ID   =  90                             10200099
102100     END-EXEC.                                                    10210099
102200                                                                  10220099
102300     EVALUATE TRUE                                                10230099
102400                                                                  10240099
102500         WHEN SQLCODE = ZEROS                                     10250099
102600             CONTINUE                                             10260099
102700         WHEN OTHER                                               10270099
102800             MOVE 'TCOCNTL' TO PV-ABEND-TABLE-1                   10280099
102900             PERFORM 9100-SQL-ERROR                               10290099
103000                                                                  10300099
103100     END-EVALUATE.                                                10310099
103200                                                                  10320099
103300**  JH  10/30/2011  END                                           10330099
103400                                                                  10340099
103500******************************************************************10350099
103600* READ THE RTV HEADER FILE                                       *10360099
103700******************************************************************10370099
103800 6000-READ-RTV-HDR-FILE.                                          10380099
103900                                                                  10390099
104000     READ RTV-HEADER-FILE                                         10400099
104100         INTO RV050-GENCO-RTV-HEADER-RECORD                       10410099
104200         AT END                                                   10420099
104300           SET PS-END-OF-HDR-INPUT-YES TO TRUE.                   10430099
104400                                                                  10440099
104500     IF PS-END-OF-HDR-INPUT-NO                                    10450099
104600        ADD +1  TO PA-TOT-RECS-READ                               10460099
104700                   PA-TOT-HDR-RECS-READ                           10470099
104800     END-IF.                                                      10480099
104900                                                                  10490099
105000******************************************************************10500099
105100* READ THE RTV DETAIL FILE                                       *10510099
105200******************************************************************10520099
105300 6001-READ-RTV-DTL-FILE.                                          10530099
105400                                                                  10540099
105500     READ RTV-DTL-FILE                                            10550099
105600         INTO RV051-GENCO-RTV-DETAIL-RECORD                       10560099
105700         AT END                                                   10570099
105800           SET PS-END-OF-DTL-INPUT-YES TO TRUE.                   10580099
105900                                                                  10590099
106000     IF PS-END-OF-DTL-INPUT-NO                                    10600099
106100        ADD +1  TO PA-TOT-RECS-READ                               10610099
106200                   PA-TOT-DTL-RECS-READ                           10620099
106300     END-IF.                                                      10630099
106400                                                                  10640099
106500******************************************************************10650099
106600* READ THE RTV DETAIL CONTROL FILE                                10660099
106700******************************************************************10670099
106800 6005-READ-RTV-DTL-CNTL-FILE.                                     10680099
106900                                                                  10690099
107000     READ RTV-DTL-CONTROL-FILE                                    10700099
107100         INTO RV052-GENCO-DTL-CNTL-RECORD                         10710099
107200         AT END                                                   10720099
107300           SET PS-END-OF-DTLCNTL-INPUT-YES TO TRUE.               10730099
107400                                                                  10740099
107500     IF PS-END-OF-DTLCNTL-INPUT-NO                                10750099
107600        ADD +1  TO PA-TOT-DTLCNTL-RECS-READ                       10760099
107700     END-IF.                                                      10770099
107800                                                                  10780099
107900******************************************************************10790099
108000* VALIDATE DEPT AND SUB-CLASS                                    *10800099
108100******************************************************************10810099
108200 6050-VALIDATE-DEPT-SUBCL.                                        10820099
108300                                                                  10830099
108400     MOVE RV051-SUB-CLASS-NBR   TO PV-SUBCLASS-REDEFINE.          10840099
108500     MOVE RV051-DEPT-NBR        TO PV-DEPT-REDEFINE.              10850099
108600     MOVE RV051-SKU             TO PV-SKU-REDEFINE.               10860099
108700     MOVE PV-INPUT-DEPT         TO PV-INPUT-DEPT-9.               10870099
108800     MOVE PV-INPUT-DEPT-9       TO PV-INPUT-DEPT-COMP3.           10880099
108900     MOVE PV-INPUT-SUBCLASS     TO PV-INPUT-SUBCLASS-9.           10890099
109000     MOVE PV-INPUT-SUBCLASS-9   TO PV-INPUT-SUBCLASS-COMP3.       10900099
109100     MOVE SPACE                 TO PV-SAVE-SUB-CL.                10910099
109200     SET PS-SUBCL-NOT-FOUND     TO TRUE.                          10920099
109300                                                                  10930099
109400     EXEC SQL                                                     10940099
109500       SELECT DEPT_NBR                                            10950099
109600             ,SUB_CL_NBR                                          10960099
109700       INTO   :XLT00023-DEPT-NBR                                  10970099
109800             ,:XLT00023-SUB-CL-NBR                                10980099
109900       FROM XLT_SUB_CL                                            10990099
110000         WHERE (DEPT_NBR      = :PV-INPUT-DEPT-COMP3              11000099
110100           AND  SUB_CL_NBR    = :PV-INPUT-SUBCLASS-COMP3)         11010099
110200     END-EXEC.                                                    11020099
110300                                                                  11030099
110400     EVALUATE TRUE                                                11040099
110500         WHEN SQLCODE = +0                                        11050099
110600         WHEN SQLCODE = -811                                      11060099
110700         SET PS-SUBCL-FOUND           TO TRUE                     11070099
110800             CONTINUE                                             11080099
110900         WHEN SQLCODE = +100                                      11090099
111000             SET PS-SUBCL-NOT-FOUND    TO TRUE                    11100099
111100             SET PS-ERROR-YES          TO TRUE                    11110099
111200             MOVE RV051-SUB-CLASS-NBR  TO PV-SAVE-SUB-CL          11120099
111300             MOVE RV051-SUB-CLASS-NBR  TO PV-SUBCLASS-REDEFINE    11130099
111400             MOVE PV-SUBCLASS-REDEFINE TO DL1-OLD-SUB-CL          11140099
111500*            MOVE RV051-UNIT-COST-AMT TO PC-UNIT-AMT              11150099
111600*            MOVE RV051-RTL-COST-AMT  TO PC-RETAIL-AMT            11160099
111700*            DISPLAY '******BEFORE IMAGE*******************'      11170099
111800*            DISPLAY '* DEFECT ORD ID: ' RV051-DFCT-ORD-ID        11180099
111900*            DISPLAY '*       SKU NBR: ' PV-SKU-REDEFINE          11190099
112000*            DISPLAY '*      DEPT NBR: ' PV-DEPT-REDEFINE         11200099
112100*            DISPLAY '*     SUB CLASS: ' PV-SUBCLASS-REDEFINE     11210099
112200*            DISPLAY '*                                    '      11220099
112300*            DISPLAY '*   RETAIL COST: ' PC-RETAIL-AMT            11230099
112400*            DISPLAY '*     UNIT COST: ' PC-UNIT-AMT              11240099
112500*            DISPLAY '*************************************'      11250099
112600*            DISPLAY ' '                                          11260099
112700                                                                  11270099
112800                                                                  11280099
112900             MOVE PV-INPUT-SUBCLASS    TO PV-INPUT-SUBCLASS-2     11290099
113000             MOVE ZERO                 TO PV-INPUT-SUBCLASS-B     11300099
113100             MOVE PV-INPUT-SUBCLASS-2  TO PV-INPUT-SUBCLASS       11310099
113200             MOVE PV-SUBCLASS-REDEFINE TO RV051-SUB-CLASS-NBR     11320099
113300                                                                  11330099
113400             MOVE PV-SUBCLASS-REDEFINE TO DL1-NEW-SUB-CL          11340099
113500             MOVE RV051-UNIT-COST-AMT  TO DL1-COST-AMT            11350099
113600             MOVE RV051-RTL-COST-AMT   TO DL1-RETAIL-AMT          11360099
113700                                                                  11370099
113800*            DISPLAY '******AFTER IMAGE TO MAJ CLASS*******'      11380099
113900*            DISPLAY '* DEFECT ORD ID: ' RV051-DFCT-ORD-ID        11390099
114000*            DISPLAY '*       SKU NBR: ' PV-SKU-REDEFINE          11400099
114100*            DISPLAY '*      DEPT NBR: ' PV-DEPT-REDEFINE         11410099
114200*            DISPLAY '*     SUB CLASS: ' PV-INPUT-SUBCLASS-2      11420099
114300*            DISPLAY '*                                    '      11430099
114400*            DISPLAY '*   RETAIL COST: ' PC-RETAIL-AMT            11440099
114500*            DISPLAY '*     UNIT COST: ' PC-UNIT-AMT              11450099
114600*            DISPLAY '*************************************'      11460099
114700*            DISPLAY ' '                                          11470099
114800                                                                  11480099
114900         WHEN SQLWARN0 NOT EQUAL SPACE                            11490099
115000         WHEN SQLCODE NOT EQUAL ZERO                              11500099
115100                                                                  11510099
115200             DISPLAY '** ABEND **'                                11520099
115300             DISPLAY '** PROGRAM = RVKUT027 **'                   11530099
115400             DISPLAY '** PARAGRAPH = 6050-VALIDATE-DEPT-SUBCL'    11540099
115500             MOVE RV051-DFCT-ORD-ID   TO PV-ABEND-ORD-ID          11550099
115600             MOVE RV051-SKU           TO PV-ABEND-SKU             11560099
115700             MOVE RV051-DEPT-NBR      TO PV-ABEND-DEPT            11570099
115800             MOVE RV051-SUB-CLASS-NBR TO PV-ABEND-SUBCL           11580099
115900             MOVE SQLCODE             TO PV-SQLCODE               11590099
116000             MOVE '6050-VALIDATE-DEPT-SUBCL'                      11600099
116100                                      TO PV-PARAGRAPH             11610099
116200             MOVE 'SELECT DEPT SUBCL' TO PV-ERROR-MSG             11620099
116300             MOVE 'XLT_SUB_CL'        TO PV-ABEND-TABLE-1         11630099
116400             PERFORM 9100-SQL-ERROR                               11640099
116500     END-EVALUATE.                                                11650099
116600                                                                  11660099
116700******************************************************************11670099
116800* VALIDATE SKU                                                   *11680099
116900******************************************************************11690099
117000 6055-VALIDATE-SKU.                                               11700099
117100                                                                  11710099
117200     INITIALIZE DCLXLT00003.                                      11720099
117300     MOVE RV051-SKU (1:8)   TO DK-SKU-NBR.                        11730099
117400                                                                  11740099
117500     EXEC SQL                                                     11750099
117600         SELECT SKU_NBR                                           11760099
117700           INTO :XLT00003-SKU-NBR                                 11770099
117800           FROM XLT_SKU                                           11780099
117900         WHERE SKU_NBR = :DK-SKU-NBR                              11790099
118000     END-EXEC.                                                    11800099
118100                                                                  11810099
118200     EVALUATE TRUE                                                11820099
118300         WHEN SQLCODE = +0                                        11830099
118400             CONTINUE                                             11840099
118500         WHEN SQLCODE = +100                                      11850099
118600*  CHECK FOR DUMMY SKU ON A NOT FOUND CONDITION                   11860099
118700*    IF SUB CLASS WAS FOUND ON TABLE AND                          11870099
118800*    SKU WAS NOT FOUND AND SKU WAS A DUMMY SKU                    11880099
118900*    THEN DO NOT PRINT SKU CHANGE REPORT                          11890099
119000*    BY SETTING PS-ERROR-NO TO TRUE                               11900099
119100*CHG0139186 START                                                 11910099
119110             IF PS-SUBCL-FOUND AND RV051-SKU (6:3) = ZERO         11911099
119120*CHG0139186 END                                                   11912099
119200                 SET PS-ERROR-NO       TO TRUE                    11920099
119300             ELSE                                                 11930099
119310*CHG0161815-START                                                 11931099
119320               IF PS-SUBCL-NOT-FOUND                              11932099
119330*CHG0161815-END                                                   11933099
119400*  OTHERWISE PRINT REPORT BY SETTING ON PS-ERROR-YES              11940099
119500                 SET PS-ERROR-YES          TO TRUE                11950099
119600                 IF PV-SAVE-SUB-CL = SPACE                        11960099
119700                   MOVE RV051-SUB-CLASS-NBR                       11970099
119800                                       TO DL1-OLD-SUB-CL          11980099
119900                 END-IF                                           11990099
120000                 MOVE RV051-SKU            TO PV-SKU-REDEFINE     12000099
120100                 MOVE PV-SKU-REDEFINE      TO DL1-OLD-SKU         12010099
120200                 MOVE RV051-UNIT-COST-AMT  TO DL1-COST-AMT        12020099
120300                 MOVE RV051-RTL-COST-AMT   TO DL1-RETAIL-AMT      12030099
120400*            DISPLAY '******BEFORE SKU IMAGE***************'      12040099
120500*            DISPLAY '* DEFECT ORD ID: ' RV051-DFCT-ORD-ID        12050099
120600*            DISPLAY '*       SEQ NBR: ' RV051-SEQ-NBR            12060099
120700*            DISPLAY '*       SKU NBR: ' RV051-SKU                12070099
120800*            DISPLAY '*      DEPT NBR: ' RV051-DEPT-NBR           12080099
120900*            DISPLAY '*     SUB CLASS: ' RV051-SUB-CLASS-NBR      12090099
121000*            DISPLAY '*                                    '      12100099
121100*            DISPLAY '*   RETAIL COST: ' PC-RETAIL-AMT            12110099
121200*            DISPLAY '*     UNIT COST: ' PC-UNIT-AMT              12120099
121300*            DISPLAY '*************************************'      12130099
121400*            DISPLAY ' '                                          12140099
121500                 MOVE PV-INPUT-DEPT-9    TO PV-INPUT-SKU-DEPT     12150099
121600                 MOVE PV-INPUT-SUBCLASS  TO PV-INPUT-SUBCLASS-2   12160099
121700                 MOVE ZERO               TO PV-INPUT-SUBCLASS-B   12170099
121800                 MOVE PV-INPUT-SUBCLASS-2 TO PV-INPUT-SKU-CLASS   12180099
121900                 MOVE PV-INPUT-SUBCLASS-2 TO PV-INPUT-SUBCLASS    12190099
122000                 MOVE ZERO               TO PV-INPUT-SKU-SEQ      12200099
122100                 MOVE PV-SKU-REDEFINE    TO RV051-SKU             12210099
122200                 MOVE PV-SUBCLASS-REDEFINE                        12220099
122300                                         TO RV051-SUB-CLASS-NBR   12230099
122400                 MOVE PV-SKU-REDEFINE    TO DL1-NEW-SKU           12240099
122500                 MOVE RV051-SUB-CLASS-NBR  TO DL1-NEW-SUB-CL      12250099
122600*            MOVE RV051-UNIT-COST-AMT  TO PC-UNIT-AMT             12260099
122700*            MOVE RV051-RTL-COST-AMT   TO PC-RETAIL-AMT           12270099
122800*            DISPLAY '******AFTER SKU IMAGE(DUMMY SKU)*****'      12280099
122900*            DISPLAY '* DEFECT ORD ID: ' RV051-DFCT-ORD-ID        12290099
123000*            DISPLAY '*       SEQ NBR: ' RV051-SEQ-NBR            12300099
123100*            DISPLAY '*       SKU NBR: ' PV-SKU-REDEFINE          12310099
123200*            DISPLAY '*      DEPT NBR: ' PV-INPUT-SKU-DEPT        12320099
123300*            DISPLAY '*     SKU CLASS: ' PV-INPUT-SKU-CLASS       12330099
123400*            DISPLAY '*                                    '      12340099
123500*            DISPLAY '*   RETAIL COST: ' PC-RETAIL-AMT            12350099
123600*            DISPLAY '*     UNIT COST: ' PC-UNIT-AMT              12360099
123700*            DISPLAY '*************************************'      12370099
123800*            DISPLAY ' '                                          12380099
123900*            DISPLAY ' '                                          12390099
124000*            DISPLAY ' '                                          12400099
124010*CHG0161815-START                                                 12401099
124020               ELSE                                               12402099
124030                 SET PS-ERROR-YES          TO TRUE                12403099
124040                 MOVE RV051-SKU            TO PV-SKU-REDEFINE     12404099
124050                 MOVE PV-SKU-REDEFINE      TO DL1-OLD-SKU         12405099
124060                 MOVE RV051-UNIT-COST-AMT  TO DL1-COST-AMT        12406099
124070                 MOVE RV051-RTL-COST-AMT   TO DL1-RETAIL-AMT      12407099
124080                 MOVE PV-INPUT-DEPT-9      TO PV-INPUT-SKU-DEPT   12408099
124090                 MOVE PV-INPUT-SUBCLASS    TO PV-INPUT-SUBCLASS-2 12409099
124091                 MOVE ZERO                 TO PV-INPUT-SUBCLASS-B 12409199
124092                 MOVE PV-INPUT-SUBCLASS-2  TO PV-INPUT-SKU-CLASS  12409299
124093                 MOVE ZERO                 TO PV-INPUT-SKU-SEQ    12409399
124094                 MOVE PV-SKU-REDEFINE      TO RV051-SKU           12409499
124095                 MOVE PV-SKU-REDEFINE      TO DL1-NEW-SKU         12409599
124096                 MOVE RV051-SUB-CLASS-NBR  TO DL1-NEW-SUB-CL      12409699
124097                                              DL1-OLD-SUB-CL      12409799
124098               END-IF                                             12409899
124099*CHG0161815-END                                                   12409999
124100             END-IF                                               12410099
124200                                                                  12420099
124300         WHEN SQLWARN0 NOT EQUAL SPACE                            12430099
124400         WHEN SQLCODE NOT EQUAL ZERO                              12440099
124500                                                                  12450099
124600             DISPLAY '** ABEND **'                                12460099
124700             DISPLAY '** PROGRAM = RVKUT027 **'                   12470099
124800             DISPLAY '** PARAGRAPH = 6055-VALIDATE-SKU **'        12480099
124900             MOVE RV051-DFCT-ORD-ID   TO PV-ABEND-ORD-ID          12490099
125000             MOVE RV051-SKU           TO PV-ABEND-SKU             12500099
125100             MOVE RV051-DEPT-NBR      TO PV-ABEND-DEPT            12510099
125200             MOVE RV051-SUB-CLASS-NBR TO PV-ABEND-SUBCL           12520099
125300             MOVE SQLCODE             TO PV-SQLCODE               12530099
125400             MOVE '6055-VALIDATE-SKU' TO PV-PARAGRAPH             12540099
125500             MOVE 'SELECT SKU'        TO PV-ERROR-MSG             12550099
125600             MOVE 'XLT_SKU'           TO PV-ABEND-TABLE-1         12560099
125700             PERFORM 9100-SQL-ERROR                               12570099
125800     END-EVALUATE.                                                12580099
125900**  JH  10/30/2011 BEG                                            12590099
126000                                                                  12600099
126100******************************************************************12610099
126200* VALIDATE THE LOCATION, MOVE LOC, NAME TO REPORT                *12620099
126300******************************************************************12630099
126400 6065-VALIDATE-LOCATION.                                          12640099
126500                                                                  12650099
126600     INITIALIZE DCLXLT00010.                                      12660099
126700                                                                  12670099
126800     EXEC SQL                                                     12680099
126900         SELECT  LOC_NBR                                          12690099
127000                ,LOC_10_ABBR_NM                                   12700099
127100           INTO  :XLT00010-LOC-NBR                                12710099
127200                ,:XLT00010-LOC-10-ABBR-NM                         12720099
127300           FROM XLT_LOC                                           12730099
127400         WHERE LOC_NBR = :DK-LOC-NBR                              12740099
127500     END-EXEC.                                                    12750099
127600                                                                  12760099
127700     EVALUATE TRUE                                                12770099
127800         WHEN SQLCODE = +0                                        12780099
127900             MOVE XLT00010-LOC-NBR        TO PH4-RTV-LOC          12790099
128000             MOVE XLT00010-LOC-10-ABBR-NM TO PH4-RTV-NAME         12800099
128100             CONTINUE                                             12810099
128200         WHEN SQLCODE = +100                                      12820099
128300         WHEN SQLWARN0 NOT EQUAL SPACE                            12830099
128400         WHEN SQLCODE  NOT EQUAL ZERO                             12840099
128500             DISPLAY '** ABEND **'                                12850099
128600             DISPLAY '** PROGRAM = RVKUT027 **'                   12860099
128700             DISPLAY '** PARAGRAPH = 6065-VALIDATE-LOCATION '     12870099
128800             DISPLAY '** CC-RTV-LOCATION   ' CC-RTV-LOCATION      12880099
128900             MOVE CC-RTV-LOCATION          TO PV-ABEND-LOC        12890099
129000             MOVE RV051-SKU                TO PV-ABEND-SKU        12900099
129100             MOVE RV051-DEPT-NBR           TO PV-ABEND-DEPT       12910099
129200             MOVE RV051-SUB-CLASS-NBR      TO PV-ABEND-SUBCL      12920099
129300             MOVE SQLCODE                  TO PV-SQLCODE          12930099
129400             MOVE '6065-VALIDATE-LOCATION' TO PV-PARAGRAPH        12940099
129500             MOVE 'SELECT XLT LOC   '      TO PV-ERROR-MSG        12950099
129600             MOVE 'XLT_LOC'                TO PV-ABEND-TABLE-1    12960099
129700             PERFORM 9100-SQL-ERROR                               12970099
129800     END-EVALUATE.                                                12980099
129900                                                                  12990099
130000**  JH  10/30/2011 END                                            13000099
130100                                                                  13010099
130200******************************************************************13020099
130300* WRITE THE NEW DTL RECORD FROM THE ORIGINAL DTL RECORD           13030099
130400* (THE ONLY DIFFERENCE IS THAT THE NEW DTL RECORD MAY HAVE        13040099
130500*  THE RV051-DTL-RERTURN-TYPE  FIELD POPULATED IF THE DTL         13050099
130600*  REC HAD A MATCHING HDR REC).                                   13060099
130700******************************************************************13070099
130800 7000-WRITE-NEW-DTL-FILE.                                         13080099
130900                                                                  13090099
131000     INITIALIZE RTV-NEW-DTL-RECORD.                               13100099
131100                                                                  13110099
131200**  JH  10/30/2011 BEG                                            13120099
131300     MOVE CC-RTV-LOCATION TO RV051-TO-LOC-NBR.                    13130099
131400**  JH  10/30/2011 END                                            13140099
131500                                                                  13150099
131600     WRITE RTV-NEW-DTL-RECORD                                     13160099
131700      FROM RV051-GENCO-RTV-DETAIL-RECORD.                         13170099
131800                                                                  13180099
131900     ADD +1 TO PA-TOT-DTL-WRITTEN.                                13190099
132000                                                                  13200099
132100******************************************************************13210099
132200* COMPARE THE CALCULATED COUNTS AND AMOUNTS FOR RTV, MOS AND D&D  13220099
132300* TO WHAT IS PASSED ON THE GENCO CONTROL RECORD.  IF EVERYTHING MA13230099
132400*  MATCHES, CONTINUE ELSE ABEND.                                  13240099
132500******************************************************************13250099
132600 7500-COMPARE-CNTS-AMTS.                                          13260099
132700     DISPLAY '********* 7500- COMPARE CNTS AND AMTS ********'     13270099
132800     IF PA-RTV-CNTL-QTY   = RV052-RTV-UNIT-QTY AND                13280099
132900         PA-MOS-CNTL-QTY  = RV052-MOS-UNIT-QTY AND                13290099
133000         PA-DND-CNTL-QTY  = RV052-DND-UNIT-QTY AND                13300099
133100         PA-RTV-CNTL-COST = RV052-RTV-UNIT-COST AND               13310099
133200         PA-RTV-CNTL-RETL = RV052-RTV-UNIT-RETL AND               13320099
133300         PA-MOS-CNTL-COST = RV052-MOS-UNIT-COST AND               13330099
133400         PA-MOS-CNTL-RETL = RV052-MOS-UNIT-RETL AND               13340099
133500         PA-DND-CNTL-COST = RV052-DND-UNIT-COST AND               13350099
133600         PA-DND-CNTL-RETL = RV052-DND-UNIT-RETL AND               13360099
133700         PA-FIN-CNTL-QTY  = RV052-GTOT-UNIT-QTY AND               13370099
133800         PA-FIN-CNTL-COST = RV052-GTOT-UNIT-COST AND              13380099
133900         PA-FIN-CNTL-RETL = RV052-GTOT-UNIT-RETL                  13390099
134000*VML     CONTINUE                                                 13400099
134100         DISPLAY '****** GOOD  COUNTS AND AMOUNTS **********'     13410099
134200****     RTV                                                      13420099
134300         DISPLAY '*****************   RTV  ****************'      13430099
134400         MOVE PA-RTV-CNTL-QTY      TO PV-DISPLAY-QTY              13440099
134500         DISPLAY 'KOHLS RTV QTY --> ' PV-DISPLAY-QTY              13450099
134600         MOVE RV052-RTV-UNIT-QTY   TO PV-DISPLAY-QTY              13460099
134700         DISPLAY 'GENCO RTV QTY --> ' PV-DISPLAY-QTY              13470099
134800         MOVE PA-RTV-CNTL-COST     TO PV-DISPLAY-AMT              13480099
134900         DISPLAY 'KOHLS RTV COST --> ' PV-DISPLAY-AMT             13490099
135000         MOVE RV052-RTV-UNIT-COST  TO PV-DISPLAY-QTY              13500099
135100         DISPLAY 'GENCO RTV COST --> ' PV-DISPLAY-QTY             13510099
135200         MOVE PA-RTV-CNTL-RETL     TO PV-DISPLAY-AMT              13520099
135300         DISPLAY 'KOHLS RTV RETL --> ' PV-DISPLAY-AMT             13530099
135400         MOVE RV052-RTV-UNIT-RETL  TO PV-DISPLAY-QTY              13540099
135500         DISPLAY 'GENCO RTV RETL --> ' PV-DISPLAY-QTY             13550099
135600****     MOS                                                      13560099
135700         DISPLAY '*****************   MOS  ****************'      13570099
135800         MOVE PA-MOS-CNTL-QTY      TO PV-DISPLAY-QTY              13580099
135900         DISPLAY 'KOHLS MOS QTY --> ' PV-DISPLAY-QTY              13590099
136000         MOVE RV052-MOS-UNIT-QTY   TO PV-DISPLAY-QTY              13600099
136100         DISPLAY 'GENCO MOS QTY --> ' PV-DISPLAY-QTY              13610099
136200         MOVE PA-MOS-CNTL-COST     TO PV-DISPLAY-AMT              13620099
136300         DISPLAY 'KOHLS MOS COST --> ' PV-DISPLAY-AMT             13630099
136400         MOVE RV052-MOS-UNIT-COST  TO PV-DISPLAY-QTY              13640099
136500         DISPLAY 'GENCO MOS COST --> ' PV-DISPLAY-QTY             13650099
136600         MOVE PA-MOS-CNTL-RETL     TO PV-DISPLAY-AMT              13660099
136700         DISPLAY 'KOHLS MOS RETL --> ' PV-DISPLAY-AMT             13670099
136800         MOVE RV052-MOS-UNIT-RETL  TO PV-DISPLAY-QTY              13680099
136900         DISPLAY 'GENCO MOS RETL --> ' PV-DISPLAY-QTY             13690099
137000****     D & D                                                    13700099
137100         DISPLAY '*****************  D & D ****************'      13710099
137200         MOVE PA-DND-CNTL-QTY      TO PV-DISPLAY-QTY              13720099
137300         DISPLAY 'KOHLS DND QTY --> ' PV-DISPLAY-QTY              13730099
137400         MOVE RV052-DND-UNIT-QTY   TO PV-DISPLAY-QTY              13740099
137500         DISPLAY 'GENCO DND QTY --> ' PV-DISPLAY-QTY              13750099
137600         MOVE PA-DND-CNTL-COST     TO PV-DISPLAY-AMT              13760099
137700         DISPLAY 'KOHLS DND COST --> ' PV-DISPLAY-AMT             13770099
137800         MOVE RV052-DND-UNIT-COST  TO PV-DISPLAY-QTY              13780099
137900         DISPLAY 'GENCO DND COST --> ' PV-DISPLAY-QTY             13790099
138000         MOVE PA-DND-CNTL-RETL     TO PV-DISPLAY-AMT              13800099
138100         DISPLAY 'KOHLS DND RETL --> ' PV-DISPLAY-AMT             13810099
138200         MOVE RV052-DND-UNIT-RETL  TO PV-DISPLAY-QTY              13820099
138300         DISPLAY 'GENCO DND RETL --> ' PV-DISPLAY-QTY             13830099
138400****     FINAL TOTALS                                             13840099
138500         DISPLAY '***************** TOTALS ****************'      13850099
138600         MOVE PA-FIN-CNTL-QTY      TO PV-DISPLAY-QTY              13860099
138700         DISPLAY 'KOHLS TOT QTY --> ' PV-DISPLAY-QTY              13870099
138800         MOVE RV052-GTOT-UNIT-QTY   TO PV-DISPLAY-QTY             13880099
138900         DISPLAY 'GENCO TOT QTY --> ' PV-DISPLAY-QTY              13890099
139000         MOVE PA-FIN-CNTL-COST     TO PV-DISPLAY-AMT              13900099
139100         DISPLAY 'KOHLS TOT COST --> ' PV-DISPLAY-AMT             13910099
139200         MOVE RV052-GTOT-UNIT-COST  TO PV-DISPLAY-QTY             13920099
139300         DISPLAY 'GENCO TOT COST --> ' PV-DISPLAY-QTY             13930099
139400         MOVE PA-FIN-CNTL-RETL     TO PV-DISPLAY-AMT              13940099
139500         DISPLAY 'KOHLS TOT RETL --> ' PV-DISPLAY-AMT             13950099
139600         MOVE RV052-GTOT-UNIT-RETL  TO PV-DISPLAY-QTY             13960099
139700         DISPLAY 'GENCO TOT RETL --> ' PV-DISPLAY-QTY             13970099
139800     ELSE                                                         13980099
139900         PERFORM 7600-BAD-AMOUNTS                                 13990099
140000     END-IF.                                                      14000099
140100                                                                  14010099
140200******************************************************************14020099
140300* ABEND PROGRAM WHEN COUNTS AND AMOUNTS DON'T MATCH CONTROL RECORD14030099
140400******************************************************************14040099
140500 7600-BAD-AMOUNTS.                                                14050099
140600*VML CLOSE RTV-HEADER-FILE                                        14060099
140700*VML       RTV-DTL-FILE                                           14070099
140800*VML       RTV-NEW-DTL-FILE                                       14080099
140900*VML       ERROR-REPORT.                                          14090099
141000     SET PS-BAD-AMOUNT TO TRUE.                                   14100099
141100     DISPLAY '****** BAD  COUNTS AND AMOUNTS **********'          14110099
141200****     RTV                                                      14120099
141300     DISPLAY '*****************   RTV  ****************'          14130099
141400         MOVE PA-RTV-CNTL-QTY      TO PV-DISPLAY-QTY              14140099
141500         DISPLAY 'KOHLS RTV QTY --> ' PV-DISPLAY-QTY              14150099
141600         MOVE RV052-RTV-UNIT-QTY   TO PV-DISPLAY-QTY              14160099
141700         DISPLAY 'GENCO RTV QTY --> ' PV-DISPLAY-QTY              14170099
141800         MOVE PA-RTV-CNTL-COST     TO PV-DISPLAY-AMT              14180099
141900         DISPLAY 'KOHLS RTV COST --> ' PV-DISPLAY-AMT             14190099
142000         MOVE RV052-RTV-UNIT-COST  TO PV-DISPLAY-QTY              14200099
142100         DISPLAY 'GENCO RTV COST --> ' PV-DISPLAY-QTY             14210099
142200         MOVE PA-RTV-CNTL-RETL     TO PV-DISPLAY-AMT              14220099
142300         DISPLAY 'KOHLS RTV RETL --> ' PV-DISPLAY-AMT             14230099
142400         MOVE RV052-RTV-UNIT-RETL  TO PV-DISPLAY-QTY              14240099
142500         DISPLAY 'GENCO RTV RETL --> ' PV-DISPLAY-QTY             14250099
142600                                                                  14260099
142700     MOVE 'KOHLS RTV QTY: ' TO PV-BCA-KOHLS-LEG-Q                 14270099
142800     MOVE PA-RTV-CNTL-QTY      TO PV-BCA-QTY-KOHLS                14280099
142900     MOVE 'GENCO RTV QTY: ' TO PV-BCA-GENCO-LEG-Q                 14290099
143000     MOVE RV052-RTV-UNIT-QTY   TO PV-BCA-QTY-GENCO                14300099
143100                                                                  14310099
143200         WRITE MESSAGE-REC         FROM PV-BAD-QTY-LINE           14320099
143300                                                                  14330099
143400         MOVE 'KOHLS RTV COST: ' TO PV-BCA-KOHLS-LEG-A            14340099
143500         MOVE PA-RTV-CNTL-COST     TO PV-BCA-AMT-KOHLS            14350099
143600         MOVE 'GENCO RTV COST: ' TO PV-BCA-GENCO-LEG-A            14360099
143700         MOVE RV052-RTV-UNIT-COST  TO PV-BCA-AMT-GENCO            14370099
143800                                                                  14380099
143900         WRITE MESSAGE-REC         FROM PV-BAD-AMT-LINE           14390099
144000                                                                  14400099
144100         MOVE 'KOHLS RTV RETL: ' TO PV-BCA-KOHLS-LEG-A            14410099
144200         MOVE PA-RTV-CNTL-RETL     TO PV-BCA-AMT-KOHLS            14420099
144300         MOVE 'GENCO RTV RETL: ' TO PV-BCA-GENCO-LEG-A            14430099
144400         MOVE RV052-RTV-UNIT-RETL  TO PV-BCA-AMT-GENCO            14440099
144500                                                                  14450099
144600         WRITE MESSAGE-REC         FROM PV-BAD-AMT-LINE           14460099
144700         WRITE MESSAGE-REC         FROM PV-BLANK-LINE             14470099
144800                                                                  14480099
144900****     MOS                                                      14490099
145000         DISPLAY '*****************   MOS  ****************'      14500099
145100         MOVE PA-MOS-CNTL-QTY      TO PV-DISPLAY-QTY              14510099
145200         DISPLAY 'KOHLS MOS QTY: ' PV-DISPLAY-QTY                 14520099
145300         MOVE RV052-MOS-UNIT-QTY   TO PV-DISPLAY-QTY              14530099
145400         DISPLAY 'GENCO MOS QTY: ' PV-DISPLAY-QTY                 14540099
145500         MOVE PA-MOS-CNTL-COST     TO PV-DISPLAY-AMT              14550099
145600         DISPLAY 'KOHLS MOS COST: ' PV-DISPLAY-AMT                14560099
145700         MOVE RV052-MOS-UNIT-COST  TO PV-DISPLAY-QTY              14570099
145800         DISPLAY 'GENCO MOS COST: ' PV-DISPLAY-QTY                14580099
145900         MOVE PA-MOS-CNTL-RETL     TO PV-DISPLAY-AMT              14590099
146000         DISPLAY 'KOHLS MOS RETL: ' PV-DISPLAY-AMT                14600099
146100         MOVE RV052-MOS-UNIT-RETL  TO PV-DISPLAY-QTY              14610099
146200         DISPLAY 'GENCO MOS RETL: ' PV-DISPLAY-QTY                14620099
146300                                                                  14630099
146400         MOVE 'KOHLS MOS QTY: ' TO PV-BCA-KOHLS-LEG-Q             14640099
146500         MOVE PA-MOS-CNTL-QTY      TO PV-BCA-QTY-KOHLS            14650099
146600         MOVE 'GENCO MOS QTY: ' TO PV-BCA-GENCO-LEG-Q             14660099
146700         MOVE RV052-MOS-UNIT-QTY   TO PV-BCA-QTY-GENCO            14670099
146800                                                                  14680099
146900         WRITE MESSAGE-REC         FROM PV-BAD-QTY-LINE           14690099
147000                                                                  14700099
147100         MOVE 'KOHLS MOS COST: ' TO PV-BCA-KOHLS-LEG-A            14710099
147200         MOVE PA-MOS-CNTL-COST     TO PV-BCA-AMT-KOHLS            14720099
147300         MOVE 'GENCO MOS COST: ' TO PV-BCA-GENCO-LEG-A            14730099
147400         MOVE RV052-MOS-UNIT-COST  TO PV-BCA-AMT-GENCO            14740099
147500                                                                  14750099
147600         WRITE MESSAGE-REC         FROM PV-BAD-AMT-LINE           14760099
147700                                                                  14770099
147800         MOVE 'KOHLS MOS RETL: ' TO PV-BCA-KOHLS-LEG-A            14780099
147900         MOVE PA-MOS-CNTL-RETL     TO PV-BCA-AMT-KOHLS            14790099
148000         MOVE 'GENCO MOS RETL: ' TO PV-BCA-GENCO-LEG-A            14800099
148100         MOVE RV052-MOS-UNIT-RETL  TO PV-BCA-AMT-GENCO            14810099
148200                                                                  14820099
148300         WRITE MESSAGE-REC         FROM PV-BAD-AMT-LINE           14830099
148400         WRITE MESSAGE-REC         FROM PV-BLANK-LINE             14840099
148500                                                                  14850099
148600****     D & D                                                    14860099
148700         DISPLAY '*****************  D & D ****************'      14870099
148800         MOVE PA-DND-CNTL-QTY      TO PV-DISPLAY-QTY              14880099
148900         DISPLAY 'KOHLS DND QTY --> ' PV-DISPLAY-QTY              14890099
149000         MOVE RV052-DND-UNIT-QTY   TO PV-DISPLAY-QTY              14900099
149100         DISPLAY 'GENCO DND QTY --> ' PV-DISPLAY-QTY              14910099
149200         MOVE PA-DND-CNTL-COST     TO PV-DISPLAY-AMT              14920099
149300         DISPLAY 'KOHLS DND COST --> ' PV-DISPLAY-AMT             14930099
149400         MOVE RV052-DND-UNIT-COST  TO PV-DISPLAY-QTY              14940099
149500         DISPLAY 'GENCO DND COST --> ' PV-DISPLAY-QTY             14950099
149600         MOVE PA-DND-CNTL-RETL     TO PV-DISPLAY-AMT              14960099
149700         DISPLAY 'KOHLS DND RETL --> ' PV-DISPLAY-AMT             14970099
149800         MOVE RV052-DND-UNIT-RETL  TO PV-DISPLAY-QTY              14980099
149900         DISPLAY 'GENCO DND RETL --> ' PV-DISPLAY-QTY             14990099
150000                                                                  15000099
150100         MOVE 'KOHLS DND QTY: ' TO PV-BCA-KOHLS-LEG-Q             15010099
150200         MOVE PA-DND-CNTL-QTY      TO PV-BCA-QTY-KOHLS            15020099
150300         MOVE 'GENCO DND QTY: ' TO PV-BCA-GENCO-LEG-Q             15030099
150400         MOVE RV052-DND-UNIT-QTY   TO PV-BCA-QTY-GENCO            15040099
150500                                                                  15050099
150600         WRITE MESSAGE-REC         FROM PV-BAD-QTY-LINE           15060099
150700                                                                  15070099
150800         MOVE 'KOHLS DND COST: ' TO PV-BCA-KOHLS-LEG-A            15080099
150900         MOVE PA-DND-CNTL-COST     TO PV-BCA-AMT-KOHLS            15090099
151000         MOVE 'GENCO DND COST: ' TO PV-BCA-GENCO-LEG-A            15100099
151100         MOVE RV052-DND-UNIT-COST  TO PV-BCA-AMT-GENCO            15110099
151200                                                                  15120099
151300         WRITE MESSAGE-REC         FROM PV-BAD-AMT-LINE           15130099
151400                                                                  15140099
151500         MOVE 'KOHLS DND RETL: ' TO PV-BCA-KOHLS-LEG-A            15150099
151600         MOVE PA-DND-CNTL-RETL     TO PV-BCA-AMT-KOHLS            15160099
151700         MOVE 'GENCO DND RETL: ' TO PV-BCA-GENCO-LEG-A            15170099
151800         MOVE RV052-DND-UNIT-RETL  TO PV-BCA-AMT-GENCO            15180099
151900                                                                  15190099
152000         WRITE MESSAGE-REC         FROM PV-BAD-AMT-LINE           15200099
152100         WRITE MESSAGE-REC         FROM PV-BLANK-LINE             15210099
152200                                                                  15220099
152300****     FINAL TOTALS                                             15230099
152400         DISPLAY '***************** TOTALS ****************'      15240099
152500         MOVE PA-FIN-CNTL-QTY      TO PV-DISPLAY-QTY              15250099
152600         DISPLAY 'KOHLS TOT QTY --> ' PV-DISPLAY-QTY              15260099
152700         MOVE RV052-GTOT-UNIT-QTY   TO PV-DISPLAY-QTY             15270099
152800         DISPLAY 'GENCO TOT QTY --> ' PV-DISPLAY-QTY              15280099
152900         MOVE PA-FIN-CNTL-COST     TO PV-DISPLAY-AMT              15290099
153000         DISPLAY 'KOHLS TOT COST --> ' PV-DISPLAY-AMT             15300099
153100         MOVE RV052-GTOT-UNIT-COST  TO PV-DISPLAY-QTY             15310099
153200         DISPLAY 'GENCO TOT COST --> ' PV-DISPLAY-QTY             15320099
153300         MOVE PA-FIN-CNTL-RETL     TO PV-DISPLAY-AMT              15330099
153400         DISPLAY 'KOHLS TOT RETL --> ' PV-DISPLAY-AMT             15340099
153500         MOVE RV052-GTOT-UNIT-RETL  TO PV-DISPLAY-QTY             15350099
153600         DISPLAY 'GENCO TOT RETL --> ' PV-DISPLAY-QTY.            15360099
153700                                                                  15370099
153800         MOVE 'KOHLS TOT QTY: ' TO PV-BCA-KOHLS-LEG-Q             15380099
153900         MOVE PA-FIN-CNTL-QTY      TO PV-BCA-QTY-KOHLS            15390099
154000         MOVE 'GENCO TOT QTY: ' TO PV-BCA-GENCO-LEG-Q             15400099
154100         MOVE RV052-GTOT-UNIT-QTY  TO PV-BCA-QTY-GENCO            15410099
154200                                                                  15420099
154300         WRITE MESSAGE-REC         FROM PV-BAD-QTY-LINE           15430099
154400                                                                  15440099
154500         MOVE 'KOHLS TOT COST: ' TO PV-BCA-KOHLS-LEG-A            15450099
154600         MOVE PA-FIN-CNTL-COST     TO PV-BCA-AMT-KOHLS            15460099
154700         MOVE 'GENCO TOT COST: ' TO PV-BCA-GENCO-LEG-A            15470099
154800         MOVE RV052-GTOT-UNIT-COST TO PV-BCA-AMT-GENCO            15480099
154900                                                                  15490099
155000         WRITE MESSAGE-REC         FROM PV-BAD-AMT-LINE           15500099
155100                                                                  15510099
155200         MOVE 'KOHLS TOT RETL: ' TO PV-BCA-KOHLS-LEG-A            15520099
155300         MOVE PA-FIN-CNTL-RETL     TO PV-BCA-AMT-KOHLS            15530099
155400         MOVE 'GENCO TOT RETL: ' TO PV-BCA-GENCO-LEG-A            15540099
155500         MOVE RV052-GTOT-UNIT-RETL TO PV-BCA-AMT-GENCO            15550099
155600                                                                  15560099
155700         WRITE MESSAGE-REC         FROM PV-BAD-AMT-LINE.          15570099
155800                                                                  15580099
155900******************************************************************15590099
156000* DISPLAY SUMMARY STATS AND CLOSE FILES.                          15600099
156100******************************************************************15610099
156200 8000-EOJ-ROUTINE.                                                15620099
156300      PERFORM 4500-WRITE-FINAL-TOTALS.                            15630099
156400                                                                  15640099
156500      CLOSE RTV-HEADER-FILE                                       15650099
156600            RTV-DTL-FILE                                          15660099
156700            RTV-NEW-DTL-FILE                                      15670099
156800            ERROR-REPORT                                          15680099
156900            MESSAGE-FILE.                                         15690099
157000                                                                  15700099
157100     DISPLAY '***********************************************'.   15710099
157200     DISPLAY '**    * RVKUT027 SUMMARY STATISTICS *        **'.   15720099
157300     DISPLAY '**                                           **'.   15730099
157400     DISPLAY '**      ---------------------------          **'.   15740099
157500     DISPLAY '**        REFORMAT GENCO DTL FILE            **'.   15750099
157600     DISPLAY '**      ---------------------------          **'.   15760099
157700     DISPLAY '** TOT RECS READ       :' PA-TOT-RECS-READ.         15770099
157800     DISPLAY '** TOT HDR RECS READ   :' PA-TOT-HDR-RECS-READ.     15780099
157900     DISPLAY '** TOT DTL RECS READ   :' PA-TOT-DTL-RECS-READ.     15790099
158000     DISPLAY '** TOT DTL RECS WRITTEN:' PA-TOT-DTL-WRITTEN.       15800099
158100     DISPLAY '***********************************************'.   15810099
158200                                                                  15820099
158300     IF PS-BAD-AMOUNT                                             15830099
158400         MOVE +4008        TO RETURN-CODE                         15840099
158500*        MOVE +4094        TO PV-ABEND-CODE                       15850099
158600*        CALL 'ILBOABN0' USING PV-ABEND-CODE                      15860099
158700     END-IF.                                                      15870099
158800                                                                  15880099
158900******************************************************************15890099
159000* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *15900099
159100* ERROR OR WARNING CODE OCCURS.                                  *15910099
159200******************************************************************15920099
159300 9100-SQL-ERROR.                                                  15930099
159400     DISPLAY '************************************************'.  15940099
159500     DISPLAY '********** PROGRAM ABEND ***********************'.  15950099
159600     DISPLAY '** PROGRAM       : ' PC-CURRENT-PROGRAM-NAME.       15960099
159700     DISPLAY '** PARAGRAPH     : ' PV-PARAGRAPH.                  15970099
159800     DISPLAY '** TABLE         : ' PV-ABEND-TABLE-1.              15980099
159900     DISPLAY '** ERROR MESSAGE : ' PV-ERROR-MSG.                  15990099
160000     DISPLAY '***********************************************'.   16000099
160100     MOVE +4013 TO PV-ABEND-CODE.                                 16010099
160200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         16020099
160300                                                                  16030099
160400****************************************************************  16040099
160500** PERFORM NON SQL ABEND PROCESSING                               16050099
160600****************************************************************  16060099
160700 9200-NON-SQL-ABEND.                                              16070099
160800                                                                  16080099
160900     DISPLAY '************************************************'.  16090099
161000     DISPLAY '********** PROGRAM ABEND ***********************'.  16100099
161100     DISPLAY '** PROGRAM:    ', PC-CURRENT-PROGRAM-NAME.          16110099
161200     DISPLAY '***********************************'.               16120099
161300     DISPLAY '* CURRENT STATS AT TIME OF ABEND  *'.               16130099
161400     DISPLAY '* DETAIL RECS READ DOES NOT MATCH *'.               16140099
161500     DISPLAY '* DETAIL RECS WRITTEN             *'.               16150099
161600     DISPLAY '***********************************'.               16160099
161700     DISPLAY '** TOT RECS READ       :' PA-TOT-RECS-READ.         16170099
161800     DISPLAY '** TOT HDR RECS READ   :' PA-TOT-HDR-RECS-READ.     16180099
161900     DISPLAY '** TOT DTL RECS READ   :' PA-TOT-DTL-RECS-READ.     16190099
162000     DISPLAY '** TOT DTL RECS WRITTEN:' PA-TOT-DTL-WRITTEN.       16200099
162100     DISPLAY '***********************************************'.   16210099
162200     MOVE +4013 TO PV-ABEND-CODE.                                 16220099
162300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         16230099
162400                                                                  16240099
162500******************************************************************16250099
162600*                       END OF PROGRAM                            16260099
162700******************************************************************16270099
