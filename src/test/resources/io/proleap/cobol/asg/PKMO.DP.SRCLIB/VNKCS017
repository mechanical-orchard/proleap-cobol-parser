000100*-----------------------*                                         00010035
000200 IDENTIFICATION DIVISION.                                         00020035
000300*-----------------------*                                         00030035
000400 PROGRAM-ID.    VNKCS017.                                         00040035
000500 AUTHOR.        LARRY SCHLEICHER.                                 00050035
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060035
000700 DATE-WRITTEN.  04/19/95.                                         00070035
000800 DATE-COMPILED.                                                   00080035
000900*----------------------------------------------------------------*00090035
001000*    V017 - VENDOR DC UPDATE                                     *00100035
001100*                                                                *00110035
001200*    THIS PROGRAM ALLOWS THE USER TO UPDATE THE 856 AND 214      *00120035
001300*    EDI INDICATORS ON THE VENDOR FILE.                          *00130035
001400*                                                                *00140035
001500*    IN MAY 97 THE SCREEN WAS CHANGED TO SHOW ONLY THE THREE     *00150035
001600*    VENDOR FIELDS FOR EDI VENDORS AND ONLY THE TWO CARRIER      *00160035
001700*    FIELDS FOR EDI CARRIERS.  ALL FIELDS ARE ON THE MAP, BUT    *00170035
001800*    THOSE NOT NEEDED ARE BLOCKED OUT.  THE SCREEN IS ENTERED    *00180035
001900*    EITHER FROM THE CRIT SCREEN OR FROM THE LIST SCREEN AFTER   *00190035
002000*    THE CRIT SCREEN.  IN EITHER CASE CARRIER OR VENDOR IS CHOSEN*00200035
002100*    FROM THE CRIT SCREEN.                                       *00210035
002101*                                                                *00220039
002102*    IN JULY 00 THE SCREEN WAS CHANGED TO SHOW THE UCC128        *00230039
002103*    INDICATOR FOR BOTH EDI VENDORS AND EDI CARRIERS.            *00240039
002101*                                                                *00220039
002101*    CHANGE LOG:                                                * 00220039
002101*    DATE:  01/05/2023                                          * 00220039
001420*            - CHANGE CALL OF DPKCS030 TO DYNAMIC               *         
001450*      MADE BY: JEAN KURK               WR/IR #: CHG0277999      *        
002200*----------------------------------------------------------------*00250035
002300                                                                  00260035
002400 ENVIRONMENT DIVISION.                                            00270035
002500                                                                  00280035
002600 DATA DIVISION.                                                   00290035
002700                                                                  00300035
002710     EJECT                                                        00300035
002720                                                                  00300035
002800 WORKING-STORAGE SECTION.                                         00310035
002900                                                                  00320035
003000 01  DK-DB2-KEYS.                                                 00330035
003100     05  DK-OPERATING-COMPANY           PIC  X(02)  VALUE SPACE.  00340035
003200     05  DK-APLSYS-CDE                  PIC  X(02)  VALUE SPACE.  00350035
003300     05  DK-MESSAGE-NUMBER              PIC S9(05)  COMP-3        00360035
003400                                                    VALUE ZERO.   00370035
003500*                                                                 00380035
003600 01  PC-PROGRAM-CONSTANTS.                                        00390035
003700     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'VNKCS017'.  00400035
003800     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'VN017A  '.  00410035
003900     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'VNKM017 '.  00420035
004000     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00430035
004100                                              COMP.               00440035
004200     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00450035
004300                                              COMP.               00460035
004400     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE  +1           00470035
004500                                              COMP.               00480035
004600     05  PC-INTER-APPL-CODES.                                     00490035
004700         10  PC-INTER-APPL-CRIT-SPEC                              00500035
004800                                  PIC  X(01)  VALUE '1'.          00510035
004900         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          00520035
005000     05  PC-CARRIER               PIC  X(08)  VALUE 'CARRIER:'.   00530035
005100     05  PC-VENDOR                PIC  X(08)  VALUE 'VENDOR: '.   00540035
005200     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00550035
005300     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00560035
005400     05  PC-M                     PIC  X(01)  VALUE 'M'.          00570035
005500     05  PC-C                     PIC  X(01)  VALUE 'C'.          00580035
005600                                                                  00590035
005700     05  PC-TSYMSG-NUMBERS.                                       00600035
005800         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00610035
005900         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00620035
006000         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00630035
006100         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00640035
006200         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00650035
006300         10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00660035
006400         10  PC-TSYMSG-00368      PIC  9(05)  VALUE  00368.       00670035
006500         10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       00680035
006600         10  PC-TSYMSG-00487      PIC  9(05)  VALUE  00487.       00690035
006700         10  PC-TSYMSG-00174      PIC  9(05)  VALUE  00174.       00700035
006800         10  PC-TSYMSG-00953      PIC  9(05)  VALUE  00953.       00710035
006900         10  PC-TSYMSG-01575      PIC  9(05)  VALUE  01575.       00720035
007000         10  PC-TSYMSG-01576      PIC  9(05)  VALUE  01576.       00730035
007100         10  PC-TSYMSG-01577      PIC  9(05)  VALUE  01577.       00740035
007200         10  PC-TSYMSG-01578      PIC  9(05)  VALUE  01578.       00750035
007300         10  PC-TSYMSG-01579      PIC  9(05)  VALUE  01579.       00760035
007400         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       00770035
007500*                                                                 00780035
007600 01  PS-PROGRAM-SWITCHES.                                         00790035
007700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00800035
007800         88  PS-ERROR                         VALUE  'Y'.         00810035
007900         88  PS-NO-ERROR                      VALUE  'N'.         00820035
008000*                                                                 00830035
008100 01  PV-PROGRAM-VARIABLES.                                        00840035
008200     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00850035
008300                                              COMP SYNC.          00860035
008400     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00870035
008500                                              COMP SYNC.          00880035
008600     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            00890035
008700                                              COMP SYNC.          00900035
008800*                                                                         
008900                                                                  00920035
009000     EJECT                                                        00930035
009100**--------------------------------------------------------------**00940035
009200** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **00950035
009300** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **00960035
009400**--------------------------------------------------------------**00970035
009500     COPY VNWS003.                                                00980035
009600 EJECT                                                            00990035
009700                                                                  01000035
009800*----------------------------------------------------------------*01010035
009900*    MAP LAYOUT                                                  *01020035
010000*----------------------------------------------------------------*01030035
010100                                                                  01040035
010200     COPY VNKM017.                                                01050035
010300                                                                  01060035
010400 EJECT                                                            01070035
010500*----------------------------------------------------------------*01080035
010600*    ATTRIBUTE SETTINGS COPYBOOK.                                *01090035
010700*----------------------------------------------------------------*01100035
010800                                                                  01110035
010900     COPY DPWS015.                                                01120035
011000                                                                  01130035
011100*----------------------------------------------------------------*01140035
011200*    FUNCTION KEYS COPYBOOK                                      *01150035
011300*----------------------------------------------------------------*01160035
011400                                                                  01170035
011500     COPY DPWS016.                                                01180035
011600                                                                  01190035
011700 EJECT                                                            01200035
011800**--------------------------------------------------------------**01210035
011900** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01220035
012000** SUB-ROUTINE (DPKUT100).                                      **01230035
012100**--------------------------------------------------------------**01240035
012200     COPY DPWS010I.                                               01250035
012300 EJECT                                                            01260035
012400**--------------------------------------------------------------**01270035
012600** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **01290035
012700**--------------------------------------------------------------**01300035
012800     COPY DPWS030.                                                01310035
012800     COPY DPWS930.                                                01310035
012900 EJECT                                                            01320035
013000**--------------------------------------------------------------**01330035
013100*    STANDARD COMMAREA.                                           01340035
013200**--------------------------------------------------------------**01350035
013300                                                                  01360035
013400     COPY DPWS020.                                                01370035
013500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01380035
013600                                                                  01390035
013700***************************************************************** 01400035
013800*    INTER-APPLICATION COMMAREA.                                  01410035
013900***************************************************************** 01420035
014000                                                                  01430035
014100         10  INTER-APPL-COMM-AREA PIC X(200).                     01440035
014200     COPY VNWS001.                                                01450035
014300     COPY VNWS002.                                                01460035
014400***************************************************************** 01470035
014500*    SPECIFIC COMMMAREA FOR VNKCS017.                             01480035
014600***************************************************************** 01490035
014700         10  ASC-SPECIFIC-COMMAREA.                               01500035
014800             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            01510035
014900             15  ASC-LIST-KEYS.                                   01520035
015000                 20  ASC-ENT-ID                      PIC S9(09)   01530035
015100                                                     COMP.        01540035
015200                 20  ASC-KEY-VEND-NAME               PIC  X(30).  01550035
015600                 20  FILLER                          PIC  X(05).  01590035
015610                 20  ASC-KEY-DUNS-NBR                PIC  X(09).  01590035
015700                 20  ASC-ORD-DTE                     PIC  X(10).  01600035
015800                 20  ASC-ORDERS-COUNT             PIC  S9(9) COMP.01610035
015900                 20  ASC-MDSE-VEND-RANK           PIC  S9(9) COMP.01620035
016000                 20  ASC-MDSE-VEND-RANK-LY        PIC  S9(9) COMP.01630035
016100                 20  ASC-VEND-RANK-TY             PIC  S9(4) COMP.01640035
016200                 20  ASC-VEND-RANK-LY             PIC  S9(4) COMP.01650035
016300                 20  ASC-RANK-YEAR-TY             PIC   9(4).     01660035
016400                 20  ASC-RANK-YEAR-LY             PIC   9(4).     01670035
016500                                                                  01680035
016600             15  ASC-SCREEN-DATA.                                 01690035
016700                 20  ASC-EDI856-IND                  PIC  X(01).  01700035
016800                 20  ASC-EDI856-FORECAST-IND         PIC  X(01).  01710035
016900                 20  ASC-EDI214-IND                  PIC  X(01).  01720035
017000                 20  ASC-128CAR-IND                  PIC  X(01).  01730035
017100                 20  ASC-PRO856-IND                  PIC  X(01).  01740035
017200                 20  ASC-MDSE-VENDOR-IND             PIC  X(01).  01750035
017300                 20  ASC-CARRIER-IND                 PIC  X(01).  01760035
017400             15  ASC-USE-SELECTION-QUEUE-IND                      01770035
017500                                           PIC  X(01).            01780035
017600                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 01790035
017700             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            01800035
017800             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    01810035
017900             15  ASC-NUMBER-OF-SELECTED-ITEMS                     01820035
018000                                           PIC S9(09)  COMP-3.    01830035
018100             15  ASC-SEL-SUB               PIC S9(04)  COMP.      01840035
018200             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      01850035
018300     EJECT                                                        01860035
018400*----------------------------------------------------------------*01870035
018500*    ABEND PROCESSING COPYBOOK.                                  *01880035
018600*----------------------------------------------------------------*01890035
018700                                                                  01900035
018800     COPY DPWS013.                                                01910035
018900                                                                  01920035
019000 EJECT                                                            01930035
019100*---------------------------------------------------------------* 01940035
019200*    DB2 AREA FOR EXTERNAL ENTERPRISE                           * 01950035
019300*---------------------------------------------------------------* 01960035
019400     EXEC SQL                                                     01970035
019500          INCLUDE TEXTENT                                         01980035
019600     END-EXEC.                                                    01990035
019700*---------------------------------------------------------------* 02000035
019800*    DB2 AREA FOR ENTERPRISE NAME                               * 02010035
019900*---------------------------------------------------------------* 02020035
020000     EXEC SQL                                                     02030035
020100          INCLUDE TENTNME                                         02040035
020200     END-EXEC.                                                    02050035
020900*---------------------------------------------------------------* 02120035
021000*    DB2 AREA FOR TPURCHS PO PURCHASE ORDER TABLE               * 02130035
021100*---------------------------------------------------------------* 02140035
021200     EXEC SQL                                                     02150035
021300          INCLUDE TPURCHS                                         02160035
021400     END-EXEC.                                                    02170035
021500*---------------------------------------------------------------* 02180035
021600*    DB2 AREA FOR COMMUNICATIONS                                * 02190035
021700*---------------------------------------------------------------* 02200035
021800                                                                  02210035
021900     EXEC SQL                                                     02220035
022000          INCLUDE SQLCA                                           02230035
022100     END-EXEC.                                                    02240035
022200                                                                  02250035
022300 EJECT                                                            02260035
022400 LINKAGE SECTION.                                                 02270035
022500                                                                  02280035
022600 01  DFHCOMMAREA.                                                 02290035
022700     05  FILLER                         OCCURS  1 TO 4072 TIMES   02300035
022800                                        DEPENDING ON EIBCALEN.    02310035
022900         10  FILLER                     PIC X.                    02320035
023000                                                                  02330035
023100                                                                  02340035
023200 PROCEDURE DIVISION.                                              02350035
023300***************************************************************** 02360035
023400** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02370035
023500** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02380035
023600** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02390035
023700**                                                             ** 02400035
023800** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02410035
023900** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02420035
024000***************************************************************** 02430035
024100 0000-MAIN-MODULE.                                                02440035
024200     INITIALIZE DP030-CICS-API-FIELDS.                            02450035
024300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02460035
024400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02470035
024500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02480035
024600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02490035
024700     MOVE LENGTH OF VN017AI        TO DP030-MAP-LENGTH (1).       02500035
024800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02510035
024900     PERFORM 0001-CALL-CICS-ARCH-API.                             02520035
025000*                                                                 02530035
025100     PERFORM 1000-CONTROL-PROCESSING                              02540035
025200*                                                                 02550035
025300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02560035
025400     PERFORM 0001-CALL-CICS-ARCH-API.                             02570035
025500                                                                  02580035
025600 0001-CALL-CICS-ARCH-API.                                         02590035
025700*    CALL 'DPKCS030' USING DFHEIBLK                               02600035
025700     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02600035
025800                           DFHCOMMAREA                            02610035
025900                           DP030-CICS-API-FIELDS                  02620035
026000                           DP020-STANDARD-COMMAREA                02630035
026100                           VN017AI.                               02640035
026200*                                                                 02650035
026300     IF  DP030-RC-CALL-SUCCESSFUL                                 02660035
026400         CONTINUE                                                 02670035
026500     ELSE                                                         02680035
026600         SET DP013-NO-ROLLBACK                                    02690035
026700             DP013-XCTL-DISPLAY-RESTART                           02700035
026800             DP013-CICS-ABEND      TO TRUE                        02710035
026900         MOVE 'BEFORE 0000-MAIN-MODULE'                           02720035
027000                                   TO DP013-PARAGRAPH             02730035
027100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX02740035
027200*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      02750035
027100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02740035
027200-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02750035
027300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      02760035
027400         PERFORM DP013-0000-PROCESS-ABEND                         02770035
027500     END-IF.                                                      02780035
027600 EJECT                                                            02790035
027700*----------------------------------------------------------------*02800035
027800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02810035
027900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02820035
028000*----------------------------------------------------------------*02830035
028100                                                                  02840035
028200 1000-CONTROL-PROCESSING.                                         02850035
028300                                                                  02860035
028400     EVALUATE TRUE                                                02870035
028500         WHEN DP020-NEXT-ACT-INITIAL                              02880035
028600              PERFORM 1100-FIND-OBJECT-KEYS                       02890035
028700              IF  PS-ERROR                                        02900035
028800                  CONTINUE                                        02910035
028900              ELSE                                                02920035
029000                  PERFORM 4000-BUILD-INITIAL-PANEL                02930035
029100                  IF  SQLCODE = +100                              02940035
029200                      SET DP020-NEXT-ACT-APPL-ERROR TO TRUE       02950035
029300                      MOVE PC-TSYMSG-00148                        02960035
029400                                   TO DP020-MSG-NUMBER            02970035
029500                      SET DP020-MSG-INFORMATIONAL TO TRUE         02980035
029600                  END-IF                                          02990035
029700              END-IF                                              03000035
029800                                                                  03010035
029900         WHEN DP020-NEXT-ACT-READ-MAP                             03020035
030000             PERFORM 2000-PROCESS-PANEL                           03030035
030100                                                                  03040035
030200         WHEN DP020-NEXT-ACT-RETURN                               03050035
030300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03060035
030400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03070035
030500                                                                  03080035
030600         WHEN OTHER                                               03090035
030700             SET DP013-LOGIC-ABEND TO TRUE                        03100035
030800             SET DP013-NO-ROLLBACK TO TRUE                        03110035
030900             MOVE '1000-CONTROL-PROCESSING'                       03120035
031000                                   TO DP013-PARAGRAPH             03130035
031100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03140035
031200                                   TO DP013-MESSAGE-TEXT(1)       03150035
031300             MOVE DP020-NEXT-APPL-ACTIVITY                        03160035
031400                                   TO DP013-MESSAGE-TEXT(2)       03170035
031500             PERFORM DP013-0000-PROCESS-ABEND                     03180035
031600     END-EVALUATE.                                                03190035
031700******************************************************************03200035
031800** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **03210035
031900** INTER-APPLICATION FORMAT CODE.                               **03220035
032000******************************************************************03230035
032100 1100-FIND-OBJECT-KEYS.                                           03240035
032200     INITIALIZE ASC-SPECIFIC-COMMAREA.                            03250035
032300     MOVE DP020-INT-APPL-FORMAT-IND                               03260035
032400                                   TO ASC-INT-APPL-FORMAT-IND.    03270035
032500     EVALUATE DP020-INT-APPL-FORMAT-IND                           03280035
032600         WHEN PC-INTER-APPL-CRIT-SPEC                             03290035
032700             IF  VN001-DUNS-NUMBER > SPACES                       03300035
032800                 MOVE VN001-DUNS-NUMBER TO ASC-KEY-DUNS-NBR       03310035
032900             ELSE                                                 03320035
033000                 IF VN001-VENDOR-NAME > SPACES                    03330035
033100                     MOVE VN001-VENDOR-NAME TO ASC-KEY-VEND-NAME  03340035
033200                 END-IF                                           03350035
035210             END-IF                                               03550035
035300                                                                  03560035
035400         WHEN PC-INTER-APPL-LIST                                  03570035
035500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  03580035
035600             MOVE VN002-NUMBER-OF-SELECTED-ITEMS                  03590035
035700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS03600035
035800             MOVE VN002-NUMBER-OF-TS-ITEMS                        03610035
035900                                   TO ASC-NUMBER-OF-TS-ITEMS      03620035
036000             MOVE VN002-SEL-QUEUE-NAME                            03630035
036100                                   TO ASC-SEL-QUEUE-NAME          03640035
036200             PERFORM 1120-PREPARE-LIST-ENTRY                      03650035
036300                                                                  03660035
036400         WHEN OTHER                                               03670035
036500             MOVE PC-TSYMSG-00148                                 03680035
036600                               TO DP020-MSG-NUMBER                03690035
036700             SET DP020-MSG-FATAL                                  03700035
036800                 DP020-NEXT-ACT-APPL-ERROR                        03710035
036900                               TO TRUE                            03720035
037000     END-EVALUATE.                                                03730035
037100*----------------------------------------------------------------*03740035
037200* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *03750035
037300* STORAGE QUEUE PASSED FROM THE LIST.                            *03760035
037400*----------------------------------------------------------------*03770035
037500 1120-PREPARE-LIST-ENTRY.                                         03780035
037600     MOVE VN003-MAX-ITEMS          TO ASC-SEL-SUB.                03790035
037700     MOVE ZERO                     TO ASC-SEL-ITEM.               03800035
037800     PERFORM 2110-GET-NEXT-VENDOR.                                03810035
037900*----------------------------------------------------------------*03820035
038000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *03830035
038100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *03840035
038200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *03850035
038300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *03860035
038400* FUNCTION KEYS CAN GET THIS FAR.                                *03870035
038500*----------------------------------------------------------------*03880035
038600                                                                  03890035
038700 2000-PROCESS-PANEL.                                              03900035
038800                                                                  03910035
038900     EVALUATE TRUE                                                03920035
039000                                                                  03930035
039100         WHEN DP020-SRC-AID = DP016-CLEAR                         03940035
039200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03950035
039300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03960035
039400                                                                  03970035
039500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03980035
039600             SET DP030-DONT-ERASE                                 03990035
039700                 DP030-SEND-DATAONLY (PC-APPL-MAP)                04000035
039800                                   TO TRUE                        04010035
039900             PERFORM 4000-BUILD-INITIAL-PANEL                     04020035
040000             PERFORM 3200-RESET-ATTRIBUTES                        04030035
040100                                                                  04040035
040200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             04050035
040300             IF  ASC-USE-SELECTION-QUEUE                          04060035
040400                 PERFORM 2110-GET-NEXT-VENDOR                     04070035
040500                 PERFORM 4000-BUILD-INITIAL-PANEL                 04080035
040600                 PERFORM 3200-RESET-ATTRIBUTES                    04090035
040700             ELSE                                                 04100035
040800*                --- BOTTOM OF LIST ---                           04110035
040900                 MOVE PC-TSYMSG-00070                             04120035
041000                                   TO DP020-MSG-NUMBER            04130035
041100                 SET DP020-MSG-INFORMATIONAL                      04140035
041200                                   TO TRUE                        04150035
041300             END-IF                                               04160035
041400                                                                  04170035
041500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             04180035
041600             IF  ASC-USE-SELECTION-QUEUE                          04190035
041700                 PERFORM 2120-GET-PREV-VENDOR                     04200035
041800                 PERFORM 4000-BUILD-INITIAL-PANEL                 04210035
041900                 PERFORM 3200-RESET-ATTRIBUTES                    04220035
042000             ELSE                                                 04230035
042100*                --- TOP OF LIST ---                              04240035
042200                 MOVE PC-TSYMSG-00069                             04250035
042300                                   TO DP020-MSG-NUMBER            04260035
042400                 SET DP020-MSG-INFORMATIONAL                      04270035
042500                                   TO TRUE                        04280035
042600             END-IF                                               04290035
042700                                                                  04300035
042800         WHEN OTHER                                               04310035
042900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04320035
043000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04330035
043100             IF  PS-NO-ERROR                                      04340035
043200                 SET DP030-CONTINUE-GO                            04350035
043300                                   TO TRUE                        04360035
043400                 PERFORM 2100-CHECK-FUNCTION-KEY                  04370035
043500             ELSE                                                 04380035
043600                 SET DP030-OVERRIDE-GO                            04390035
043700                                   TO TRUE                        04400035
043800             END-IF                                               04410035
043900     END-EVALUATE.                                                04420035
044000*----------------------------------------------------------------*04430035
044100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *04440035
044200* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *04450035
044300* FROM THE CICS ARCHITECTURE API.                                *04460035
044400*----------------------------------------------------------------*04470035
044500                                                                  04480035
044600 2100-CHECK-FUNCTION-KEY.                                         04490035
044700     EVALUATE TRUE                                                04500035
044800         WHEN DP020-SRC-AID = DP016-ENTER                         04510035
044900             CONTINUE                                             04520035
045000                                                                  04530035
045100         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04540035
045200             SET DP030-CONTINUE-GO TO TRUE                        04550035
045300             PERFORM 5000-UPDATE-VENDOR                           04560035
045400*            --- UPDATES SUCCESSFUL ---                           04570035
045500             MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER            04580035
045600             SET DP020-MSG-INFORMATIONAL                          04590035
045700                                   TO TRUE                        04600035
045800                                                                  04610035
045900         WHEN OTHER                                               04620035
046000             SET DP013-NO-ROLLBACK                                04630035
046100                 DP013-XCTL-DISPLAY-RESTART                       04640035
046200                 DP013-CICS-ABEND  TO TRUE                        04650035
046300             MOVE '2000-PROCESS-PANEL'                            04660035
046400                                   TO DP013-PARAGRAPH             04670035
046500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      04680035
046600                                   TO DP013-MESSAGE-TEXT (1)      04690035
046700             PERFORM DP013-0000-PROCESS-ABEND                     04700035
046800     END-EVALUATE.                                                04710035
046900                                                                  04720035
047000 2110-GET-NEXT-VENDOR.                                            04730035
047100     ADD +1                        TO ASC-SEL-SUB.                04740035
047200     IF  ASC-SEL-SUB > VN003-MAX-ITEMS                            04750035
047300         ADD +1                    TO ASC-SEL-ITEM                04760035
047400         MOVE +1                   TO ASC-SEL-SUB                 04770035
047500     END-IF.                                                      04780035
047600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                04790035
047700         PERFORM 9100-READ-SEL-QUEUE                              04800035
047800         IF  VN003-ENT-ID (ASC-SEL-SUB) > ZERO                    04810035
047900             MOVE VN003-ENT-ID (ASC-SEL-SUB)                      04820035
048000                                   TO ASC-ENT-ID                  04830035
048100             SET VN003-INQ (ASC-SEL-SUB)                          04840035
048200                                   TO TRUE                        04850035
048300             PERFORM 9200-REWRITE-LIST-QUEUE                      04860035
048400         ELSE                                                     04870035
048500             SUBTRACT +1 FROM ASC-SEL-SUB                         04880035
048600*            --- BOTTOM OF LIST ---                               04890035
048700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            04900035
048800             SET DP020-MSG-INFORMATIONAL                          04910035
048900                                   TO TRUE                        04920035
049000         END-IF                                                   04930035
049100     ELSE                                                         04940035
049200         SUBTRACT +1 FROM ASC-SEL-ITEM                            04950035
049300         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 04960035
049400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            04970035
049500         SET DP020-MSG-INFORMATIONAL                              04980035
049600                                   TO TRUE                        04990035
049700     END-IF.                                                      05000035
049800******************************************************************05010035
049900** GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED        **05020035
050000** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **05030035
050100******************************************************************05040035
050200 2120-GET-PREV-VENDOR.                                            05050035
050300     SUBTRACT +1 FROM ASC-SEL-SUB.                                05060035
050400     IF  ASC-SEL-SUB < +1                                         05070035
050500         SUBTRACT +1 FROM ASC-SEL-ITEM                            05080035
050600         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 05090035
050700     END-IF.                                                      05100035
050800*                                                                 05110035
050900     IF  ASC-SEL-ITEM > ZERO                                      05120035
051000         PERFORM 9100-READ-SEL-QUEUE                              05130035
051100         MOVE VN003-ENT-ID (ASC-SEL-SUB)                          05140035
051200                                   TO ASC-ENT-ID                  05150035
051300     ELSE                                                         05160035
051400         MOVE +1                   TO ASC-SEL-ITEM                05170035
051500                                      ASC-SEL-SUB                 05180035
051600*        --- TOP OF LIST ---                                      05190035
051700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            05200035
051800         SET DP020-MSG-INFORMATIONAL                              05210035
051900                                   TO TRUE                        05220035
052000     END-IF.                                                      05230035
052100 EJECT                                                            05240035
052200 EJECT                                                            05250035
052300*----------------------------------------------------------------*05260035
052400* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *05270035
052500* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *05280035
052600* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *05290035
052700*----------------------------------------------------------------*05300035
052800                                                                  05310035
052900 2200-MOVE-SCREEN-TO-COMMAREA.                                    05320035
053000     IF  A856ASNL > ZERO                                          05330035
053100         MOVE A856ASNI             TO ASC-EDI856-IND              05340035
053200     ELSE                                                         05350035
053300         IF  A856ASNF = DP015-ERASE-EOF                           05360035
053400             MOVE SPACE            TO ASC-EDI856-IND              05370035
053500         END-IF                                                   05380035
053600     END-IF.                                                      05390035
053700                                                                  05400035
053800     IF  A856FORL > ZERO                                          05410035
053900         MOVE A856FORI             TO ASC-EDI856-FORECAST-IND     05420035
054000     ELSE                                                         05430035
054100         IF  A856FORF = DP015-ERASE-EOF                           05440035
054200             MOVE SPACES           TO ASC-EDI856-FORECAST-IND     05450035
054300         END-IF                                                   05460035
054400     END-IF.                                                      05470035
054500                                                                  05480035
054600     IF  A214FORL > ZERO                                          05490035
054700         MOVE A214FORI             TO ASC-EDI214-IND              05500035
054800     ELSE                                                         05510035
054900         IF  A214FORF = DP015-ERASE-EOF                           05520035
055000             MOVE SPACES           TO ASC-EDI214-IND              05530035
055100         END-IF                                                   05540035
055200     END-IF.                                                      05550035
055300                                                                  05560035
055400     IF  A128CARL > ZERO                                          05570035
055500         MOVE A128CARI             TO ASC-128CAR-IND              05580035
055600     ELSE                                                         05590035
055700         IF  A128CARF = DP015-ERASE-EOF                           05600035
055800             MOVE SPACES           TO ASC-128CAR-IND              05610035
055900         END-IF                                                   05620035
056000     END-IF.                                                      05630035
056100                                                                  05640035
056200     IF  APROASNL > ZERO                                          05650035
056300         MOVE APROASNI             TO ASC-PRO856-IND              05660035
056400     ELSE                                                         05670035
056500         IF  APROASNF = DP015-ERASE-EOF                           05680035
056600             MOVE SPACE            TO ASC-PRO856-IND              05690035
056700         END-IF                                                   05700035
056800     END-IF.                                                      05710035
056900                                                                  05720035
057000 EJECT                                                            05730035
057100*----------------------------------------------------------------*05740035
057200* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *05750035
057300* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *05760035
057400* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *05770035
057500*----------------------------------------------------------------*05780035
057600                                                                  05790035
057700 3000-EDIT-DATA-IN-COMMAREA.                                      05800035
057800     PERFORM 3200-RESET-ATTRIBUTES.                               05810035
057900                                                                  05820035
058000     IF  ASC-EDI214-IND = 'Y' OR 'N' OR SPACE                     05830035
058100         IF ASC-EDI214-IND = SPACE                                05840035
058200             MOVE 'N' TO ASC-EDI214-IND                           05850035
058300         ELSE                                                     05860035
058400             CONTINUE                                             05870035
058500         END-IF                                                   05880035
058600     ELSE                                                         05890035
058700         SET PS-ERROR              TO TRUE                        05900035
058800         SET DP020-MSG-FATAL       TO TRUE                        05910035
058900         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            05920035
059000         MOVE DP015-UNP-ALP-BRT-OFF                               05930035
059100                                   TO A214FORA                    05940035
059200         MOVE DP015-RED            TO A214FORC                    05950035
059300         MOVE DP015-REVERSE        TO A214FORH                    05960035
059400         MOVE -1                   TO A214FORL                    05970035
059500         SET DP030-SET-CURSOR-APPL-1                              05980035
059600                                   TO TRUE                        05990035
059700     END-IF.                                                      06000035
059800                                                                  06010035
059900     IF  ASC-EDI214-IND = 'Y'                                     06020035
060000         IF ASC-CARRIER-IND = 'Y'                                 06030035
060100             CONTINUE                                             06040035
060200         ELSE                                                     06050035
060300             SET PS-ERROR          TO TRUE                        06060035
060400             SET DP020-MSG-FATAL   TO TRUE                        06070035
060500             MOVE PC-TSYMSG-01576  TO DP020-MSG-NUMBER            06080035
060600             MOVE DP015-UNP-ALP-BRT-OFF                           06090035
060700                                   TO A214FORA                    06100035
060800             MOVE DP015-RED        TO A214FORC                    06110035
060900             MOVE DP015-REVERSE    TO A214FORH                    06120035
061000             MOVE -1               TO A214FORL                    06130035
061100             SET DP030-SET-CURSOR-APPL-1                          06140035
061200                                   TO TRUE                        06150035
061300         END-IF                                                   06160035
061400     END-IF.                                                      06170035
061500                                                                  06180035
061600     IF  ASC-EDI856-FORECAST-IND = 'Y' OR 'N' OR SPACE            06190035
061700         IF ASC-EDI856-FORECAST-IND = SPACE                       06200035
061800             MOVE 'N' TO ASC-EDI856-FORECAST-IND                  06210035
061900         ELSE                                                     06220035
062000             CONTINUE                                             06230035
062100         END-IF                                                   06240035
062200     ELSE                                                         06250035
062300         SET PS-ERROR              TO TRUE                        06260035
062400         SET DP020-MSG-FATAL       TO TRUE                        06270035
062500         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            06280035
062600         MOVE DP015-UNP-ALP-BRT-OFF                               06290035
062700                                   TO A856FORA                    06300035
062800         MOVE DP015-RED            TO A856FORC                    06310035
062900         MOVE DP015-REVERSE        TO A856FORH                    06320035
063000         MOVE -1                   TO A856FORL                    06330035
063100         SET DP030-SET-CURSOR-APPL-1                              06340035
063200                                   TO TRUE                        06350035
063300     END-IF.                                                      06360035
063400                                                                  06370035
063500     IF  ASC-EDI856-FORECAST-IND = 'Y'                            06380035
063600         IF ASC-MDSE-VENDOR-IND = 'Y'                             06390035
063700             CONTINUE                                             06400035
063800         ELSE                                                     06410035
063900             SET PS-ERROR              TO TRUE                    06420035
064000             SET DP020-MSG-FATAL       TO TRUE                    06430035
064100             MOVE PC-TSYMSG-00174      TO DP020-MSG-NUMBER        06440035
064200             MOVE DP015-UNP-ALP-BRT-OFF                           06450035
064300                                       TO A856FORA                06460035
064400             MOVE DP015-RED            TO A856FORC                06470035
064500             MOVE DP015-REVERSE        TO A856FORH                06480035
064600             MOVE -1                   TO A856FORL                06490035
064700             SET DP030-SET-CURSOR-APPL-1                          06500035
064800                                       TO TRUE                    06510035
064900         END-IF                                                   06520035
065000     END-IF.                                                      06530035
065100                                                                  06540035
065200     IF  ASC-EDI856-IND = 'Y' OR 'N' OR 'P' OR SPACE              06550035
065300         IF ASC-EDI856-IND = SPACE                                06560035
065400             MOVE 'N' TO ASC-EDI856-IND                           06570035
065500         ELSE                                                     06580035
065600             CONTINUE                                             06590035
065700         END-IF                                                   06600035
065800     ELSE                                                         06610035
065900         SET PS-ERROR              TO TRUE                        06620035
066000         SET DP020-MSG-FATAL       TO TRUE                        06630035
066100         MOVE PC-TSYMSG-00953      TO DP020-MSG-NUMBER            06640035
066200         MOVE DP015-UNP-ALP-BRT-OFF                               06650035
066300                                   TO A856ASNA                    06660035
066400         MOVE DP015-RED            TO A856ASNC                    06670035
066500         MOVE DP015-REVERSE        TO A856ASNH                    06680035
066600         MOVE -1                   TO A856ASNL                    06690035
066700         SET DP030-SET-CURSOR-APPL-1                              06700035
066800                                   TO TRUE                        06710035
066900     END-IF.                                                      06720035
067000                                                                  06730035
067100     IF  ASC-EDI856-IND = 'Y' OR 'P'                              06740035
067200         IF ASC-MDSE-VENDOR-IND = 'Y'                             06750035
067300             CONTINUE                                             06760035
067400         ELSE                                                     06770035
067500             SET PS-ERROR              TO TRUE                    06780035
067600             SET DP020-MSG-FATAL       TO TRUE                    06790035
067700             MOVE PC-TSYMSG-00174      TO DP020-MSG-NUMBER        06800035
067800             MOVE DP015-UNP-ALP-BRT-OFF                           06810035
067900                                       TO A856ASNA                06820035
068000             MOVE DP015-RED            TO A856ASNC                06830035
068100             MOVE DP015-REVERSE        TO A856ASNH                06840035
068200             MOVE -1                   TO A856ASNL                06850035
068300             SET DP030-SET-CURSOR-APPL-1                          06860035
068400                                       TO TRUE                    06870035
068500         END-IF                                                   06880035
068600     END-IF.                                                      06890035
068700                                                                  06900035
068800     IF  ASC-EDI856-FORECAST-IND = 'Y'                            06910035
068900         IF ASC-EDI856-IND = 'Y' OR 'P'                           06920035
069000             CONTINUE                                             06930035
069100         ELSE                                                     06940035
069200             SET PS-ERROR              TO TRUE                    06950035
069300             SET DP020-MSG-FATAL       TO TRUE                    06960035
069400             MOVE PC-TSYMSG-01578      TO DP020-MSG-NUMBER        06970035
069500             MOVE DP015-UNP-ALP-BRT-OFF                           06980035
069600                                       TO A856ASNA                06990035
069700             MOVE DP015-RED            TO A856ASNC                07000035
069800             MOVE DP015-REVERSE        TO A856ASNH                07010035
069900             MOVE -1                   TO A856ASNL                07020035
070000             SET DP030-SET-CURSOR-APPL-1                          07030035
070100                                       TO TRUE                    07040035
070200         END-IF                                                   07050035
070300     END-IF.                                                      07060035
070400                                                                  07070035
070500     IF  ASC-128CAR-IND = 'Y' OR 'N' OR SPACE                     07080035
070600         IF ASC-128CAR-IND = SPACE                                07090035
070700             MOVE 'N' TO ASC-128CAR-IND                           07100035
070800         ELSE                                                     07110035
070900             CONTINUE                                             07120035
071000         END-IF                                                   07130035
071100     ELSE                                                         07140035
071200         SET PS-ERROR              TO TRUE                        07150035
071300         SET DP020-MSG-FATAL       TO TRUE                        07160035
071400         MOVE PC-TSYMSG-00368      TO DP020-MSG-NUMBER            07170035
071500         MOVE DP015-UNP-ALP-BRT-OFF                               07180035
071600                                   TO A128CARA                    07190035
071700         MOVE DP015-RED            TO A128CARC                    07200035
071800         MOVE DP015-REVERSE        TO A128CARH                    07210035
071900         MOVE -1                   TO A128CARL                    07220035
072000         SET DP030-SET-CURSOR-APPL-1                              07230035
072100                                   TO TRUE                        07240035
072200     END-IF.                                                      07250035
072300                                                                  07260035
072400     IF  ASC-128CAR-IND = 'Y'                                     07270035
072500         IF (ASC-CARRIER-IND = 'Y' AND ASC-PRO856-IND = 'P')      07280037
072600            CONTINUE                                              07290035
072700         ELSE                                                     07300035
072800            IF ASC-EDI856-IND = 'P'                               07310035
072900               CONTINUE                                           07320035
073000            ELSE                                                  07330035
073100               SET PS-ERROR              TO TRUE                  07340035
073200               SET DP020-MSG-FATAL       TO TRUE                  07350035
073300               SET DP030-SET-CURSOR-APPL-1                        07360038
073400                                         TO TRUE                  07370038
073500               IF ASC-CARRIER-IND = 'Y'                           07380038
073600                  MOVE PC-TSYMSG-01579      TO DP020-MSG-NUMBER   07390038
073700                  MOVE DP015-UNP-ALP-BRT-OFF                      07400038
073800                                            TO APROASNA           07410038
073900                  MOVE DP015-RED            TO APROASNC           07420038
074000                  MOVE DP015-REVERSE        TO APROASNH           07430038
074100                  MOVE -1                   TO APROASNL           07440038
074200               ELSE                                               07450038
074300                  MOVE PC-TSYMSG-01579      TO DP020-MSG-NUMBER   07460038
074400                  MOVE DP015-UNP-ALP-BRT-OFF                      07470038
074500                                            TO A856ASNA           07480038
074600                  MOVE DP015-RED            TO A856ASNC           07490038
074700                  MOVE DP015-REVERSE        TO A856ASNH           07500038
074800                  MOVE -1                   TO A856ASNL           07510038
074900               END-IF                                             07520038
075000            END-IF                                                07530038
075100         END-IF                                                   07540035
075200     END-IF.                                                      07550035
075300                                                                  07560035
075400     IF  ASC-PRO856-IND = 'Y' OR 'N' OR 'P' OR SPACE              07570035
075500         IF ASC-PRO856-IND = SPACE                                07580035
075600             MOVE 'N' TO ASC-PRO856-IND                           07590035
075700         ELSE                                                     07600035
075800             CONTINUE                                             07610035
075900         END-IF                                                   07620035
076000     ELSE                                                         07630035
076100         SET PS-ERROR              TO TRUE                        07640035
076200         SET DP020-MSG-FATAL       TO TRUE                        07650035
076300         MOVE PC-TSYMSG-00953      TO DP020-MSG-NUMBER            07660035
076400         MOVE DP015-UNP-ALP-BRT-OFF                               07670035
076500                                   TO APROASNA                    07680035
076600         MOVE DP015-RED            TO APROASNC                    07690035
076700         MOVE DP015-REVERSE        TO APROASNH                    07700035
076800         MOVE -1                   TO APROASNL                    07710035
076900         SET DP030-SET-CURSOR-APPL-1                              07720035
077000                                   TO TRUE                        07730035
077100     END-IF.                                                      07740035
077200*WITH THE SCREEN SHOWING ONLY CARRIER FIELDS FOR CARRIERS AND     07750035
077300*VENDOR FIELDS FOR VENDORS THE FOLLOWING 'IF SHOULDN'T EXECUTE.   07760035
077400     IF  ASC-PRO856-IND = 'Y' OR 'P'                              07770035
077500         IF ASC-CARRIER-IND = 'Y'                                 07780035
077600             CONTINUE                                             07790035
077700         ELSE                                                     07800035
077800             SET PS-ERROR              TO TRUE                    07810035
077900             SET DP020-MSG-FATAL       TO TRUE                    07820035
078000             MOVE PC-TSYMSG-00174      TO DP020-MSG-NUMBER        07830035
078100                                                                  07840035
078200             MOVE DP015-UNP-ALP-BRT-OFF                           07850035
078300                                       TO APROASNA                07860035
078400             MOVE DP015-RED            TO APROASNC                07870035
078500             MOVE DP015-REVERSE        TO APROASNH                07880035
078600             MOVE -1                   TO APROASNL                07890035
078700             SET DP030-SET-CURSOR-APPL-1                          07900035
078800                                       TO TRUE                    07910035
078900         END-IF                                                   07920035
079000     END-IF.                                                      07930035
079100                                                                  07940035
079200*                                                                 07950035
079300     IF  PS-NO-ERROR                                              07960035
079400         IF ASC-MDSE-VENDOR-IND    = 'Y'                          07970035
079500             MOVE -1               TO A856ASNL                    07980035
079600         ELSE                                                     07990035
079700             IF ASC-CARRIER-IND            = 'Y'                  08000035
079800                 MOVE -1               TO A214FORL                08010035
079900             END-IF                                               08020035
080000         END-IF                                                   08030035
080100         SET DP030-SET-CURSOR-APPL-1                              08040035
080200                                   TO TRUE                        08050035
080300     END-IF.                                                      08060035
080400*                                                                 08070035
080500*----------------------------------------------------------------*08080035
080600* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *08090035
080700* MAP.                                                           *08100035
080800*----------------------------------------------------------------*08110035
080900 3200-RESET-ATTRIBUTES.                                           08120035
081000     IF ASC-MDSE-VENDOR-IND            = 'Y'                      08130035
081100         MOVE DP015-UNP-ALP-NOR-OFF        TO A856ASNA            08140035
081200                                              A856FORA            08150035
081300                                              A128CARA            08160035
081400         MOVE DP015-GREEN                  TO A856ASNC            08170035
081500                                              A856FORC            08180036
081600                                              A128CARC            08190035
081700         MOVE DP015-UNDERLINE              TO A856ASNH            08200035
081800                                              A856FORH            08210035
081900                                              A128CARH            08220035
082000     ELSE                                                         08230035
082100         IF ASC-CARRIER-IND            = 'Y'                      08240035
082200             MOVE DP015-UNP-ALP-NOR-OFF    TO A214FORA            08250035
082300                                              APROASNA            08260035
082400                                              A128CARA            08270036
082500             MOVE DP015-GREEN              TO A214FORC            08280035
082600                                              APROASNC            08290035
082700                                              A128CARC            08300036
082800             MOVE DP015-UNDERLINE          TO A214FORH            08310035
082900                                              APROASNH            08320035
083000                                              A128CARH            08330036
083100         END-IF                                                   08340035
083200     END-IF.                                                      08350035
083300 EJECT                                                            08360035
083400*----------------------------------------------------------------*08370035
083500*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *08380035
083600*    ENTRY.                                                      *08390035
083700*----------------------------------------------------------------*08400035
083800                                                                  08410035
083900 4000-BUILD-INITIAL-PANEL.                                        08420035
084000                                                                  08430035
084100     EVALUATE DP020-INT-APPL-FORMAT-IND                           08440035
084200         WHEN PC-INTER-APPL-CRIT-SPEC                             08450035
084300             IF ASC-KEY-VEND-NAME > SPACES                        08460035
084400                 PERFORM 4100-GET-ENT-VIA-NAME                    08470035
084500                 IF SQLCODE = ZERO                                08480035
084600                     PERFORM 4330-GET-VENDOR-FROM-ENT             08490035
084700                 END-IF                                           08500035
084800             ELSE                                                 08510035
084900             IF ASC-KEY-DUNS-NBR > SPACES                         08520035
085000                 PERFORM 4200-GET-ENT-VIA-DUNS                    08530035
085100                 IF SQLCODE = ZERO                                08540035
085200                     PERFORM 4330-GET-VENDOR-FROM-ENT             08550035
085300                 END-IF                                           08560035
085900             END-IF                                               08620035
086000             END-IF                                               08630035
086100                                                                  08640035
086200         WHEN PC-INTER-APPL-LIST                                  08650035
086300             PERFORM 4330-GET-VENDOR-FROM-ENT                     08660035
086400     END-EVALUATE.                                                08670035
086500                                                                  08680035
086600     IF  SQLCODE = ZERO                                           08690035
086700         PERFORM 4220-CHECK-VEND-TYPE                             08700035
086800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     08710035
086900     END-IF.                                                      08720035
087000                                                                  08730035
087100*----------------------------------------------------------------*08740035
087200* GET ENT ID FROM CRITERIA FIELD ENTERED                         *08750035
087300*----------------------------------------------------------------*08760035
087400                                                                  08770035
087500 4100-GET-ENT-VIA-NAME.                                           08780035
087600     PERFORM                                                      08790035
087700         WITH TEST AFTER                                          08800035
087800         VARYING PV-RETRY-COUNTER                                 08810035
087900         FROM 1 BY 1                                              08820035
088000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08830035
088100                   OR (SQLCODE = ZERO)                            08840035
088200                   OR (SQLCODE = +100))                           08850035
088300             EXEC SQL                                             08860035
088400                  SELECT B.ENT_ID                                 08870035
088500                  INTO  :ASC-ENT-ID                               08880035
088600                  FROM TENTNME A,                                 08890035
088700                       TEXTENT B                                  08900035
088800                  WHERE A.ENT_NAME_DESC = :ASC-KEY-VEND-NAME      08910035
088900                    AND B.ENT_ID = A.ENT_ID                       08920035
089000             END-EXEC                                             08930035
089100         EVALUATE TRUE                                            08940035
089200             WHEN SQLCODE = ZERO                                  08950035
089300             WHEN SQLCODE = +100                                  08960035
089400             WHEN SQLCODE = -904                                  08970035
089500             WHEN SQLCODE = -913                                  08980035
089600                 CONTINUE                                         08990035
089700             WHEN SQLWARN0 NOT = SPACES                           09000035
089800             WHEN SQLCODE < ZERO                                  09010035
089900             WHEN SQLCODE > ZERO                                  09020035
090000                 MOVE '4100-GET-ENT-VIA-NAMEE'                    09030035
090100                                   TO DP013-PARAGRAPH             09040035
090200                 MOVE 'SELECT TENTNME'                            09050035
090300                                   TO DP013-MESSAGE-TEXT (1)      09060035
090400                 MOVE SQLCA        TO DP013-SQLCA                 09070035
090500                 MOVE 'TENTNME '   TO DP013-DB2-TABLE-NAME (1)    09080035
090600                 SET DP013-DB2-ABEND                              09090035
090700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           09100035
090800                 PERFORM DP013-0000-PROCESS-ABEND                 09110035
090900         END-EVALUATE                                             09120035
091000     END-PERFORM                                                  09130035
091100                                                                  09140035
091200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09150035
091300         MOVE '4100-GET-ENT-VIA-NAME'                             09160035
091400                                   TO DP013-PARAGRAPH             09170035
091500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ    '   09180035
091600                                   TO DP013-MESSAGE-TEXT (1)      09190035
091700         MOVE SQLCA                TO DP013-SQLCA                 09200035
091800         MOVE 'TENTNME '           TO DP013-DB2-TABLE-NAME (1)    09210035
091900         SET DP013-DB2-ABEND                                      09220035
092000             DP013-XCTL-DISPLAY-RESTART                           09230035
092100                                   TO TRUE                        09240035
092200         PERFORM DP013-0000-PROCESS-ABEND                         09250035
092300     END-IF.                                                      09260035
092400                                                                  09270035
092500 4200-GET-ENT-VIA-DUNS.                                           09280035
092600     PERFORM                                                      09290035
092700         WITH TEST AFTER                                          09300035
092800         VARYING PV-RETRY-COUNTER                                 09310035
092900         FROM 1 BY 1                                              09320035
093000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09330035
093100                   OR (SQLCODE = ZERO)                            09340035
093200                   OR (SQLCODE = +100))                           09350035
093300             EXEC SQL                                             09360035
093400                  SELECT ENT_ID                                   09370035
093500                  INTO  :ASC-ENT-ID                               09380035
093600                  FROM TEXTENT                                    09390035
093700                  WHERE DUN_NBR = :ASC-KEY-DUNS-NBR               09400035
093800             END-EXEC                                             09410035
093900         EVALUATE TRUE                                            09420035
094000             WHEN SQLCODE = ZERO                                  09430035
094100             WHEN SQLCODE = +100                                  09440035
094200             WHEN SQLCODE = -904                                  09450035
094300             WHEN SQLCODE = -913                                  09460035
094400                 CONTINUE                                         09470035
094500             WHEN SQLWARN0 NOT = SPACES                           09480035
094600             WHEN SQLCODE < ZERO                                  09490035
094700             WHEN SQLCODE > ZERO                                  09500035
094800                 MOVE '4200-GET-ENT-VIA-DUNS'                     09510035
094900                                   TO DP013-PARAGRAPH             09520035
095000                 MOVE 'SELECT TEXTENT'                            09530035
095100                                   TO DP013-MESSAGE-TEXT (1)      09540035
095200                 MOVE SQLCA        TO DP013-SQLCA                 09550035
095300                 MOVE 'TEXTENT '   TO DP013-DB2-TABLE-NAME (1)    09560035
095400                 SET DP013-DB2-ABEND                              09570035
095500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           09580035
095600                 PERFORM DP013-0000-PROCESS-ABEND                 09590035
095700         END-EVALUATE                                             09600035
095800     END-PERFORM                                                  09610035
095900                                                                  09620035
096000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09630035
096100         MOVE '4200-GET-ENT-VIA-DUNS'                             09640035
096200                                   TO DP013-PARAGRAPH             09650035
096300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ    '   09660035
096400                                   TO DP013-MESSAGE-TEXT (1)      09670035
096500         MOVE SQLCA                TO DP013-SQLCA                 09680035
096600         MOVE 'TEXTENT '           TO DP013-DB2-TABLE-NAME (1)    09690035
096700         SET DP013-DB2-ABEND                                      09700035
096800             DP013-XCTL-DISPLAY-RESTART                           09710035
096900                                   TO TRUE                        09720035
097000         PERFORM DP013-0000-PROCESS-ABEND                         09730035
097100     END-IF.                                                      09740035
097200                                                                  09750035
097300*----------------------------------------------------------------*09760035
097400* CHECK VENDOR TYPE - MUST BE MDSE VENDOR OR CARRIER             *09770035
097500*----------------------------------------------------------------*09780035
097600                                                                  09790035
097700 4220-CHECK-VEND-TYPE.                                            09800035
097800                                                                  09810035
097900     EVALUATE DP020-INT-APPL-FORMAT-IND                           09820035
098000         WHEN PC-INTER-APPL-CRIT-SPEC                             09830035
098100*            MOVE VN001-VENDOR-TYPE   TO                          09840035
098200*                VN001-VENDOR-TYPE                                09850035
098300*        WHEN PC-INTER-APPL-LIST                                  09860035
098400*            MOVE VN003-VEND-TYPE (ASC-SEL-SUB)   TO              09870035
098500*                PV-VENDOR-TYPE                                   09880035
098600     IF VN001-VENDOR-TYPE = PC-M                                  09890035
098700         IF EXTENT-MDSE-VENDOR-IND = PC-Y                         09900035
098800             CONTINUE                                             09910035
098900         ELSE                                                     09920035
099000             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                09930035
099100             MOVE PC-TSYMSG-01575                                 09940035
099200                 TO DP020-MSG-NUMBER                              09950035
099300             SET DP020-MSG-INFORMATIONAL TO TRUE                  09960035
099400         END-IF                                                   09970035
099500     ELSE                                                         09980035
099600         IF VN001-VENDOR-TYPE = PC-C                              09990035
099700             IF EXTENT-CARRIER-IND = PC-Y                         10000035
099800                 CONTINUE                                         10010035
099900             ELSE                                                 10020035
100000                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            10030035
100100                 MOVE PC-TSYMSG-01576                             10040035
100200                     TO DP020-MSG-NUMBER                          10050035
100300                 SET DP020-MSG-INFORMATIONAL TO TRUE              10060035
100400             END-IF                                               10070035
100500         ELSE                                                     10080035
100600             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                10090035
100700             MOVE PC-TSYMSG-01577                                 10100035
100800                TO DP020-MSG-NUMBER                               10110035
100900             SET DP020-MSG-INFORMATIONAL TO TRUE                  10120035
101000         END-IF                                                   10130035
101100     END-IF                                                       10140035
101200     WHEN OTHER                                                   10150035
101300         CONTINUE                                                 10160035
101400     END-EVALUATE.                                                10170035
101500                                                                  10180035
106600                                                                  10690035
106700*----------------------------------------------------------------*10700035
106800* GET NON LIST SCREEN FIELDS FROM ENTERPRISE                     *10710035
106900*----------------------------------------------------------------*10720035
107000                                                                  10730035
107100 4330-GET-VENDOR-FROM-ENT.                                        10740035
107200     PERFORM                                                      10750035
107300         WITH TEST AFTER                                          10760035
107400         VARYING PV-RETRY-COUNTER                                 10770035
107500         FROM 1 BY 1                                              10780035
107600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10790035
107700                   OR (SQLCODE = ZERO)                            10800035
107800                   OR (SQLCODE = +100))                           10810035
107900             EXEC SQL                                             10820035
108000                  SELECT ASN_TRSCP_IND,                           10830035
108100                         CRE_ASN_FCST_IND,                        10840035
108200                         CRE_SHIPT_FCST_IND,                      10850035
108300                         MDSE_VENDOR_IND,                         10860035
108400                         CARRIER_IND,                             10870035
108500                         VLD_CART_LBL_IND,                        10880035
108600                         ENT_NAME_DESC                            10890035
108700                  INTO  :EXTENT-ASN-TRSCP-IND,                    10900035
108800                        :EXTENT-CRE-ASN-FCST-IND,                 10910035
108900                        :EXTENT-CRE-SHIPT-FCST-IND,               10920035
109000                        :EXTENT-MDSE-VENDOR-IND,                  10930035
109100                        :EXTENT-CARRIER-IND,                      10940035
109200                        :EXTENT-VLD-CART-LBL-IND,                 10950035
109300                        :ENTNME-ENT-NAME-DESC                     10960035
109400                  FROM TEXTENT A,                                 10970035
109500                       TENTNME B                                  10980035
109600                  WHERE A.ENT_ID = :ASC-ENT-ID                    10990035
109700                    AND A.ENT_ID = B.ENT_ID                       11000035
109800                    AND B.TYPE_CDE = '01'                         11010035
109900             END-EXEC                                             11020035
110000         EVALUATE TRUE                                            11030035
110100             WHEN SQLCODE = ZERO                                  11040035
110200             WHEN SQLCODE = +100                                  11050035
110300             WHEN SQLCODE = -904                                  11060035
110400             WHEN SQLCODE = -913                                  11070035
110500                 CONTINUE                                         11080035
110600             WHEN SQLWARN0 NOT = SPACES                           11090035
110700             WHEN SQLCODE < ZERO                                  11100035
110800             WHEN SQLCODE > ZERO                                  11110035
110900                 MOVE '4330-GET-VENDOR-FROM-ENT'                  11120035
111000                                   TO DP013-PARAGRAPH             11130035
111100                 MOVE 'SELECT TEXTENT'                            11140035
111200                                   TO DP013-MESSAGE-TEXT (1)      11150035
111300                 MOVE SQLCA        TO DP013-SQLCA                 11160035
111400                 MOVE 'TEXTENT '   TO DP013-DB2-TABLE-NAME (1)    11170035
111500                 SET DP013-DB2-ABEND                              11180035
111600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11190035
111700                 PERFORM DP013-0000-PROCESS-ABEND                 11200035
111800         END-EVALUATE                                             11210035
111900     END-PERFORM                                                  11220035
112000                                                                  11230035
112100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11240035
112200         MOVE '4330-GET-VENDOR-FROM-ENT'                          11250035
112300                                   TO DP013-PARAGRAPH             11260035
112400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ    '   11270035
112500                                   TO DP013-MESSAGE-TEXT (1)      11280035
112600         MOVE SQLCA                TO DP013-SQLCA                 11290035
112700         MOVE 'TEXTENT '           TO DP013-DB2-TABLE-NAME (1)    11300035
112800         SET DP013-DB2-ABEND                                      11310035
112900             DP013-XCTL-DISPLAY-RESTART                           11320035
113000                                   TO TRUE                        11330035
113100         PERFORM DP013-0000-PROCESS-ABEND                         11340035
113200     END-IF.                                                      11350035
113300                                                                  11360035
113400     IF SQLCODE = ZERO                                            11370035
113500         IF EXTENT-MDSE-VENDOR-IND = 'Y'                          11380035
113600             MOVE 'N'                   TO ASC-PRO856-IND         11390035
113700             MOVE EXTENT-ASN-TRSCP-IND  TO ASC-EDI856-IND         11400035
113800         ELSE                                                     11410035
113900             MOVE 'N'                   TO ASC-EDI856-IND         11420035
114000             MOVE EXTENT-ASN-TRSCP-IND  TO ASC-PRO856-IND         11430035
114100         END-IF                                                   11440035
114200         MOVE EXTENT-CRE-ASN-FCST-IND   TO ASC-EDI856-FORECAST-IND11450035
114300         MOVE EXTENT-CRE-SHIPT-FCST-IND TO ASC-EDI214-IND         11460035
114400         MOVE EXTENT-VLD-CART-LBL-IND   TO ASC-128CAR-IND         11470035
114500         MOVE EXTENT-MDSE-VENDOR-IND    TO ASC-MDSE-VENDOR-IND    11480035
114600         MOVE EXTENT-CARRIER-IND        TO ASC-CARRIER-IND        11490035
114700     END-IF.                                                      11500035
114800                                                                  11510035
114900*----------------------------------------------------------------*11520035
115000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *11530035
115100*----------------------------------------------------------------*11540035
115200                                                                  11550035
115300 4400-MOVE-COMMAREA-TO-SCREEN.                                    11560035
115400                                                                  11570035
115500     IF ASC-MDSE-VENDOR-IND            = 'Y'                      11580035
115600         MOVE PC-VENDOR                TO AVENDO1O                11590035
115700         MOVE ASC-EDI856-IND           TO A856ASNO                11600035
115800         MOVE ASC-EDI856-FORECAST-IND  TO A856FORO                11610035
115900         MOVE ASC-128CAR-IND           TO A128CARO                11620035
116000         MOVE DP015-PRO-DRK-OFF        TO A214FO1A                11630035
116100                                          A214FORA                11640035
116200                                          A214FO2A                11650035
116300                                          A214FO3A                11660035
116400                                          A214FO4A                11670035
116500                                          APROAS1A                11680035
116600                                          APROASNA                11690035
116700                                          APROAS2A                11700035
116800                                          APROAS3A                11710035
116900                                          APROAS4A                11720035
117000                                          APROAS5A                11730035
117100         MOVE DP015-HL-OFF             TO A214FORH                11740035
117200                                          APROASNH                11750035
117300         MOVE -1                       TO A856ASNL                11760035
117400     ELSE                                                         11770035
117500         IF ASC-CARRIER-IND            = 'Y'                      11780035
117600             MOVE PC-CARRIER           TO AVENDO1O                11790035
117700             MOVE ASC-EDI214-IND       TO A214FORO                11800035
117800             MOVE ASC-PRO856-IND       TO APROASNO                11810035
117900             MOVE ASC-128CAR-IND       TO A128CARO                11820035
118000             MOVE DP015-PRO-DRK-OFF    TO A856AS1A                11830035
118100                                          A856ASNA                11840035
118200                                          A856AS2A                11850035
118300                                          A856AS3A                11860035
118400                                          A856AS4A                11870035
118500                                          A856AS5A                11880035
118600                                          A856FO1A                11890035
118700                                          A856FORA                11900035
118800                                          A856FO2A                11910035
118900                                          A856FO3A                11920035
119000                                          A856FO4A                11930035
119100             MOVE DP015-HL-OFF         TO A856ASNH                11940035
119200                                          A856FORH                11950035
119300             MOVE -1                   TO A214FORL                11960035
119400         END-IF                                                   11970035
119500     END-IF.                                                      11980035
119600                                                                  11990035
119700     MOVE ENTNME-ENT-NAME-DESC             TO AVENDORO.           12000035
119800     SET DP030-SET-CURSOR-APPL-1           TO TRUE.               12010035
119900                                                                  12020035
120000 EJECT                                                            12030035
120100*----------------------------------------------------------------*12040035
120200* APPLY THE CHANGES TO THE MESSAGE TO THE DB2 TABLE.             *12050035
120300*----------------------------------------------------------------*12060035
120400 5000-UPDATE-VENDOR.                                              12070035
120500                                                                  12080035
120600     IF ASC-CARRIER-IND = 'Y'                                     12090035
120700         MOVE ASC-PRO856-IND   TO EXTENT-ASN-TRSCP-IND            12100035
120800     ELSE                                                         12110035
120900         MOVE ASC-EDI856-IND   TO EXTENT-ASN-TRSCP-IND            12120035
121000     END-IF.                                                      12130035
121100                                                                  12140035
121200     MOVE ASC-EDI856-FORECAST-IND                                 12150035
121300                               TO EXTENT-CRE-ASN-FCST-IND.        12160035
121400     MOVE ASC-EDI214-IND       TO EXTENT-CRE-SHIPT-FCST-IND.      12170035
121500     MOVE ASC-128CAR-IND       TO EXTENT-VLD-CART-LBL-IND.        12180035
121600     PERFORM 5100-UPDATE-TEXTENT.                                 12190035
121700                                                                  12200035
121800     IF  ASC-USE-SELECTION-QUEUE                                  12210035
121900         PERFORM 5200-UPDATE-SELECTION-QUEUE                      12220035
122000     END-IF.                                                      12230035
122100******************************************************************12240035
122200** UPDATE THE ROW ON THE DB2 TABLE.                             **12250035
122300******************************************************************12260035
122400 5100-UPDATE-TEXTENT.                                             12270035
122500                                                                  12280035
122600     PERFORM                                                      12290035
122700         WITH TEST AFTER                                          12300035
122800         VARYING PV-RETRY-COUNTER                                 12310035
122900         FROM 1 BY 1                                              12320035
123000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12330035
123100                   OR (SQLCODE = ZERO))                           12340035
123200         EXEC SQL                                                 12350035
123300             UPDATE TEXTENT                                       12360035
123400                 SET ASN_TRSCP_IND   = :EXTENT-ASN-TRSCP-IND,     12370035
123500                     CRE_SHIPT_FCST_IND                           12380035
123600                                     = :EXTENT-CRE-SHIPT-FCST-IND,12390035
123700                     CRE_ASN_FCST_IND                             12400035
123800                                     = :EXTENT-CRE-ASN-FCST-IND,  12410035
123900                     LAST_UPD_BY_UID = :DP020-USERID,             12420035
124000                     LAST_UPD_TMST   = CURRENT TIMESTAMP,         12430035
124100                     VLD_CART_LBL_IND = :EXTENT-VLD-CART-LBL-IND  12440035
124200             WHERE ENT_ID  = :ASC-ENT-ID                          12450035
124300         END-EXEC                                                 12460035
124400                                                                  12470035
124500         EVALUATE TRUE                                            12480035
124600             WHEN SQLCODE = ZERO                                  12490035
124700             WHEN SQLCODE = -904                                  12500035
124800             WHEN SQLCODE = -913                                  12510035
124900                 CONTINUE                                         12520035
125000             WHEN SQLWARN0 NOT = SPACES                           12530035
125100             WHEN SQLCODE < ZERO                                  12540035
125200             WHEN SQLCODE > ZERO                                  12550035
125300                 MOVE '5100-UPDATE-TEXTENT'                       12560035
125400                                   TO DP013-PARAGRAPH             12570035
125500                 MOVE 'UPDATE A ROW ON THE EXTERNAL ENT TABLE'    12580035
125600                                   TO DP013-MESSAGE-TEXT(1)       12590035
125700                 MOVE SQLCA        TO DP013-SQLCA                 12600035
125800                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    12610035
125900                 SET DP013-DB2-ABEND                              12620035
126000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           12630035
126100                 PERFORM DP013-0000-PROCESS-ABEND                 12640035
126200         END-EVALUATE                                             12650035
126300     END-PERFORM.                                                 12660035
126400                                                                  12670035
126500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12680035
126600         MOVE '5100-UPDATE-TEXTENT'                               12690035
126700                                   TO DP013-PARAGRAPH             12700035
126800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A VEN12710035
126900-             'DOR'                TO DP013-MESSAGE-TEXT (1)      12720035
127000         MOVE SQLCA                TO DP013-SQLCA                 12730035
127100         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    12740035
127200         SET DP013-DB2-ABEND                                      12750035
127300             DP013-XCTL-DISPLAY-RESTART                           12760035
127400                                   TO TRUE                        12770035
127500         PERFORM DP013-0000-PROCESS-ABEND                         12780035
127600     END-IF.                                                      12790035
127700                                                                  12800035
127800*----------------------------------------------------------------*12810035
127900* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *12820035
128000* OBJECT WAS UDPATED.                                            *12830035
128100*----------------------------------------------------------------*12840035
128200 5200-UPDATE-SELECTION-QUEUE.                                     12850035
128300     PERFORM 9100-READ-SEL-QUEUE.                                 12860035
128400     SET VN003-UPD (ASC-SEL-SUB) TO TRUE.                         12870035
128500     PERFORM 9200-REWRITE-LIST-QUEUE.                             12880035
128600 EJECT                                                            12890035
128700*----------------------------------------------------------------*12900035
128800* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *12910035
128900*----------------------------------------------------------------*12920035
129000                                                                  12930035
129100 9100-READ-SEL-QUEUE.                                             12940035
129200     EXEC CICS                                                    12950035
129300         READQ TS                                                 12960035
129400             QUEUE (ASC-SEL-QUEUE-NAME)                           12970035
129500             INTO  (VN003-VENDOR-SEL-REC)                         12980035
129600             ITEM  (ASC-SEL-ITEM)                                 12990035
129700             RESP  (PV-CICS-RESPONSE)                             13000035
129800     END-EXEC.                                                    13010035
129900                                                                  13020035
130000     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   13030035
130100         CONTINUE                                                 13040035
130200     ELSE                                                         13050035
130300         SET DP013-LOGIC-ABEND                                    13060035
130400             DP013-NO-ROLLBACK     TO TRUE                        13070035
130500         MOVE '9100-READ-SEL-QUEUE'                               13080035
130600                                   TO DP013-PARAGRAPH             13090035
130700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   13100035
130800                                   TO DP013-MESSAGE-TEXT (1)      13110035
130900         PERFORM DP013-0000-PROCESS-ABEND                         13120035
131000     END-IF.                                                      13130035
131100*----------------------------------------------------------------*13140035
131200* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *13150035
131300*----------------------------------------------------------------*13160035
131400 9200-REWRITE-LIST-QUEUE.                                         13170035
131500     EXEC CICS                                                    13180035
131600          WRITEQ TS                                               13190035
131700              QUEUE  (ASC-SEL-QUEUE-NAME)                         13200035
131800              FROM   (VN003-VENDOR-SEL-REC)                       13210035
131900              ITEM   (ASC-SEL-ITEM)                               13220035
132000              RESP   (PV-CICS-RESPONSE)                           13230035
132100              REWRITE                                             13240035
132200     END-EXEC.                                                    13250035
132300                                                                  13260035
132400     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               13270035
132500         SET DP013-CICS-ABEND                                     13280035
132600             DP013-NO-ROLLBACK     TO TRUE                        13290035
132700         MOVE '9200-REWRITE-LIST-QUEUE'                           13300035
132800                                   TO DP013-PARAGRAPH             13310035
132900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   13320035
133000                                   TO DP013-MESSAGE-TEXT (1)      13330035
133100         PERFORM DP013-0000-PROCESS-ABEND                         13340035
133200     END-IF.                                                      13350035
133300                                                                  13360035
133400 EJECT                                                            13370035
133500*----------------------------------------------------------------*13380035
133600*    ABEND PROCESSOR MODULE                                      *13390035
133700*----------------------------------------------------------------*13400035
133800                                                                  13410035
133900     COPY DPPD013.                                                13420035
