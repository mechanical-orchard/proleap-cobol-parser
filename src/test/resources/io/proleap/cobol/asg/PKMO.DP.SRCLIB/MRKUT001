00001 ***************************************************************** 09/13/95
00002  IDENTIFICATION DIVISION.                                         MRKUT001
00003 *****************************************************************    LV001
00004                                                                   MRKUT001
00005  PROGRAM-ID.             MRKUT001.                                MRKUT001
00006  AUTHOR.                 CHRISTINE FOLEY.                         MRKUT001
00007  INSTALLATION.           KOHLS DEPARTMENT STORES.                 MRKUT001
00008  DATE-WRITTEN            10-XX-92.                                MRKUT001
00009  DATE-COMPILED.                                                   MRKUT001
00010                                                                   MRKUT001
00011 ***************************************************************** MRKUT001
00012 *     PROFILE SERVICES SALES HISTORY CREATION                   * MRKUT001
00013 *                                                               * MRKUT001
00014 *  THIS PROGRAM WILL UPDATE THE RUN MODE FIELD ON TH CONTROL    * MRKUT001
00015 *  FILE SYSTEM RECORD.                                          * MRKUT001
00016 ***************************************************************** MRKUT001
00017 *  CHANGE MADE:                                                 * MRKUT001
00018 *                                                               * MRKUT001
00019 ***************************************************************** MRKUT001
00020 * CHANGED XX/XX/XX BY XXXXXXXXXXXXXXXXXXXXXXXXXX                  MRKUT001
00021 *   WR# XXXXXXXXXXXX                                              MRKUT001
00022 *            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  MRKUT001
00023 *            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  MRKUT001
00024 *            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  MRKUT001
00025 *            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  MRKUT001
00026 ***************************************************************** MRKUT001
00027  ENVIRONMENT DIVISION.                                            MRKUT001
00028 ***************************************************************** MRKUT001
00029                                                                   MRKUT001
00030  CONFIGURATION SECTION.                                           MRKUT001
00031                                                                   MRKUT001
00032  SOURCE-COMPUTER.        IBM-3090.                                MRKUT001
00033  OBJECT-COMPUTER.        IBM-3090.                                MRKUT001
00034                                                                   MRKUT001
00035  INPUT-OUTPUT SECTION.                                            MRKUT001
00036                                                                   MRKUT001
00037  FILE-CONTROL.                                                    MRKUT001
00038 *                                                                 MRKUT001
00039      SELECT ICCTL-CNTL-FILE     ASSIGN        TO INP01            MRKUT001
00040                                 ORGANIZATION  IS INDEXED          MRKUT001
00041                                 ACCESS        IS RANDOM           MRKUT001
00042                                 RECORD KEY    IS ICCTL-KEY        MRKUT001
00043                                 FILE STATUS   IS PV-VSAM-STATUS.  MRKUT001
00044 *                                                                 MRKUT001
00045 ***************************************************************** MRKUT001
00046  DATA DIVISION.                                                   MRKUT001
00047 ***************************************************************** MRKUT001
00048 *                                                                 MRKUT001
00049  FILE SECTION.                                                    MRKUT001
00050 *                                                                 MRKUT001
00051  FD  ICCTL-CNTL-FILE.                                             MRKUT001
00052  01  ICCTL-CNTL-REC.                                              MRKUT001
00053      05  ICCTL-KEY                   PIC X(21).                   MRKUT001
00054      05  FILLER                      PIC X(379).                  MRKUT001
00055 *                                                                 MRKUT001
00056  WORKING-STORAGE SECTION.                                         MRKUT001
00057 *                                                                 MRKUT001
00058  01  FILLER.                                                      MRKUT001
00059      05  FILLER                      PIC  X(36)    VALUE          MRKUT001
00060          ' ***** WORKING STORAGE PGM=MRKUT001 '.                  MRKUT001
00061      05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   MRKUT001
00062      05  FILLER                      PIC  X(10)    VALUE          MRKUT001
00063          ' LOCATION='.                                            MRKUT001
00064      05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   MRKUT001
00065      05  FILLER                      PIC  X(06)    VALUE          MRKUT001
00066          ' *****'.                                                MRKUT001
00067  EJECT                                                            MRKUT001
00068  01  PROGRAM-SWITCHES.                                            MRKUT001
00069      05  PS-END-OF-SYSTEM-REC        PIC  X(01)    VALUE 'N'.     MRKUT001
00070          88  END-OF-SYSTEM-REC                     VALUE 'Y'.     MRKUT001
00071      05  PS-END-OF-PARM-REC          PIC  X(01)    VALUE 'N'.     MRKUT001
00072          88  END-OF-PARM-REC                       VALUE 'Y'.     MRKUT001
00073 *                                                                 MRKUT001
00074 /                                                                 MRKUT001
00075  01  PC-CONSTANTS.                                                MRKUT001
00076      05  PC-PLUS-1                   PIC S9(04)    VALUE +1       MRKUT001
00077                                                    COMP SYNC.     MRKUT001
00078      05  PC-PLUS-2                   PIC S9(04)    VALUE +2       MRKUT001
00079                                                    COMP SYNC.     MRKUT001
00080      05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     MRKUT001
00081                                                    COMP SYNC.     MRKUT001
00082      05  PC-1                        PIC S9(03)    VALUE +1       MRKUT001
00083                                                    COMP-3.        MRKUT001
00084      05  PC-M                        PIC  X(01)    VALUE 'M'.     MRKUT001
00085      05  PC-N                        PIC  X(01)    VALUE 'N'.     MRKUT001
00086      05  PC-P                        PIC  X(01)    VALUE 'P'.     MRKUT001
00087      05  PC-U                        PIC  X(01)    VALUE 'U'.     MRKUT001
00088      05  PC-Y                        PIC  X(01)    VALUE 'Y'.     MRKUT001
00089      05  PC-RCD-TYPE                 PIC  X(03)    VALUE 'SYS'.   MRKUT001
00090      05  PC-DASH                     PIC  X(01)    VALUE '-'.     MRKUT001
00091      05  PC-SLASH                    PIC  X(01)    VALUE '/'.     MRKUT001
00092      05  PC-MRKUT001                 PIC  X(08)    VALUE          MRKUT001
00093                                                    'MRKUT00X'.    MRKUT001
00094      05  PC-ASTERISK                 PIC  X(30)    VALUE          MRKUT001
00095          '*****************************'.                         MRKUT001
00096  EJECT                                                            MRKUT001
00097 *                                                                 MRKUT001
00098  01  PV-NULL-INDICATORS.                                          MRKUT001
00099      05  PV-DTL-ORD-QTY-UM-CDE-NULL  PIC S9(04)    VALUE +0       MRKUT001
00100                                                    COMP SYNC.     MRKUT001
00101 *                                                                 MRKUT001
00102  01  PV-ACCUMULATOR-FIELDS.                                       MRKUT001
00103      05  PV-SYSTEM-INPUT-CNT         PIC S9(03)    VALUE ZERO     MRKUT001
00104                                                    COMP-3.        MRKUT001
00105      05  PV-PARM-INPUT-CNT           PIC S9(03)    VALUE ZERO     MRKUT001
00106                                                    COMP-3.        MRKUT001
00107      05  PV-SYSTEM-OUTPUT-CNT        PIC S9(04)    VALUE ZERO     MRKUT001
00108                                                    COMP-3.        MRKUT001
00109  EJECT                                                            MRKUT001
00110 *                                                                 MRKUT001
00111  01  PV-MISC-FIELDS.                                              MRKUT001
00112      05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     MRKUT001
00113                                                    COMP SYNC.     MRKUT001
00114      05  PV-RBA                      PIC S9(09)    VALUE ZERO     MRKUT001
00115                                                    COMP SYNC.     MRKUT001
00116      05  PV-VSAM-STATUS              PIC  X(02) VALUE SPACE.      MRKUT001
00117          88  PV-VSAM-SUCCESSFUL                 VALUE '00'.       MRKUT001
00118          88  PV-VSAM-NOT-FOUND                  VALUE '23'.       MRKUT001
00119      05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  MRKUT001
00120      05  PV-TODAYS-DAY               PIC  9(01)    VALUE ZERO.    MRKUT001
00121      05  PV-TODAYS-DATE.                                          MRKUT001
00122          10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    MRKUT001
00123          10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    MRKUT001
00124          10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    MRKUT001
00125      05  PV-MMDDYY.                                               MRKUT001
00126          10  PV-MM                   PIC  9(02)    VALUE ZERO.    MRKUT001
00127          10  PV-DD                   PIC  9(02)    VALUE ZERO.    MRKUT001
00128          10  PV-YY                   PIC  9(02)    VALUE ZERO.    MRKUT001
00129      05  PV-YYMMDD                   PIC  9(06)    VALUE ZERO.    MRKUT001
00130      05  PV-TODAYS-TIME.                                          MRKUT001
00131          10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    MRKUT001
00132          10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    MRKUT001
00133          10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    MRKUT001
00134          10  FILLER                  PIC  9(02)    VALUE ZERO.    MRKUT001
00135  EJECT                                                            MRKUT001
00136 *                                                                 MRKUT001
00137      COPY MRRD001I.                                               MRKUT001
00138  EJECT                                                            MRKUT001
00139  01  SYSTEM-RECORD.                                               MRKUT001
00140      COPY ICI005C.                                                MRKUT001
00141  EJECT                                                            MRKUT001
00142 *                                                                 MRKUT001
00143 ***************************************************************** MRKUT001
00144 *PROCEDURE DIVISION.                                              MRKUT001
00145 ***************************************************************** MRKUT001
00146  PROCEDURE DIVISION.                                              MRKUT001
00147 *                                                                 MRKUT001
00148  A000-MAINLINE-PROCESSING.                                        MRKUT001
00149 *                                                                 MRKUT001
00150      PERFORM A100-INITIALIZATION.                                 MRKUT001
00151 *                                                                 MRKUT001
00152      PERFORM B000-PROCESS-SYSTEM-RECORD.                          MRKUT001
00153 *                                                                 MRKUT001
00154      PERFORM Y100-END-ROUTINE.                                    MRKUT001
00155 *                                                                 MRKUT001
00156      GOBACK.                                                      MRKUT001
00157 *                                                                 MRKUT001
00158  EJECT                                                            MRKUT001
00159 ******************************************************************MRKUT001
00160 ** OPEN THE SYSTEM FILE AND ACCEPT CONTROL CARDS.                 MRKUT001
00161 ******************************************************************MRKUT001
00162  A100-INITIALIZATION.                                             MRKUT001
00163 *                                                                 MRKUT001
00164      OPEN    I-O ICCTL-CNTL-FILE.                                 MRKUT001
00165 *                                                                 MRKUT001
00166      IF  PV-VSAM-SUCCESSFUL                                       MRKUT001
00167         CONTINUE                                                  MRKUT001
00168      ELSE                                                         MRKUT001
00169         IF PV-VSAM-NOT-FOUND                                      MRKUT001
00170            DISPLAY '** ABEND **'                                  MRKUT001
00171            DISPLAY '** PROGRAM    = MRKUT001'                     MRKUT001
00172            DISPLAY '** PARAGRAPH  = R000-READ-SYSTEM-RECORD'      MRKUT001
00173            DISPLAY '** MESSAGE    = '                             MRKUT001
00174                    'FILE NOT FOUND,  STATUS: ' PV-VSAM-STATUS     MRKUT001
00175            MOVE +4005           TO PV-ABEND-CODE                  MRKUT001
00176            CALL 'ILBOABN0'      USING PV-ABEND-CODE               MRKUT001
00177         ELSE                                                      MRKUT001
00178            DISPLAY '** ABEND **'                                  MRKUT001
00179            DISPLAY '** PROGRAM    = MRKUT001'                     MRKUT001
00180            DISPLAY '** PARAGRAPH  = R000-READ-SYSTEM-RECORD'      MRKUT001
00181            DISPLAY '** MESSAGE    = '                             MRKUT001
00182                    'BAD VSAM READ, STATUS = ' PV-VSAM-STATUS      MRKUT001
00183            MOVE +4005           TO PV-ABEND-CODE                  MRKUT001
00184            CALL 'ILBOABN0'      USING PV-ABEND-CODE               MRKUT001
00185         END-IF                                                    MRKUT001
00186      END-IF.                                                      MRKUT001
00187 *                                                                 MRKUT001
00188      ACCEPT PARAMETER-INPUT-RECORD.                               MRKUT001
00189 *                                                                 MRKUT001
00190      IF MR001I-S-RUN-MODE = PC-P OR PC-U OR PC-M                  MRKUT001
00191         CONTINUE                                                  MRKUT001
00192      ELSE                                                         MRKUT001
00193          DISPLAY '** ABEND ** IN PROGRAM MRKUT001'                MRKUT001
00194          DISPLAY 'MRKUT001 - CONTROL-CARD ERROR = '               MRKUT001
00195                   PARAMETER-INPUT-RECORD                          MRKUT001
00196          MOVE +4003 TO PV-ABEND-CODE                              MRKUT001
00197          CALL 'ILBOABN0' USING PV-ABEND-CODE                      MRKUT001
00198      END-IF.                                                      MRKUT001
00199 *                                                                 MRKUT001
00200  EJECT                                                            MRKUT001
00201 ******************************************************************MRKUT001
00202 *  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *MRKUT001
00203 *  SYSTEM RECORD.                                                *MRKUT001
00204 ******************************************************************MRKUT001
00205  B000-PROCESS-SYSTEM-RECORD.                                      MRKUT001
00206 *                                                                 MRKUT001
00207      MOVE MR001I-S-SYS-ID    TO   S-SYS-ID.                       MRKUT001
00208      MOVE PC-RCD-TYPE        TO   S-RCD-TYPE.                     MRKUT001
00209      MOVE LOW-VALUES         TO   S-RCD-ID.                       MRKUT001
00210      MOVE S-KEY              TO   ICCTL-KEY.                      MRKUT001
00211 *                                                                 MRKUT001
00212      PERFORM R000-READ-SYSTEM-RECORD.                             MRKUT001
00213 *                                                                 MRKUT001
00214      MOVE MR001I-S-RUN-MODE  TO   S-RUN-MODE.                     MRKUT001
00215 *                                                                 MRKUT001
00216      PERFORM W000-WRITE-SYSTEM-RECORD.                            MRKUT001
00217 *                                                                 MRKUT001
00218  EJECT                                                            MRKUT001
00219 ******************************************************************MRKUT001
00220 *   READ THE SYSTEM RECORD FOR PROCESSING                        *MRKUT001
00221 ******************************************************************MRKUT001
00222  R000-READ-SYSTEM-RECORD.                                         MRKUT001
00223 *                                                                 MRKUT001
00224      READ ICCTL-CNTL-FILE INTO  SYSTEM-RECORD                     MRKUT001
00225                                 KEY IS ICCTL-KEY.                 MRKUT001
00226 *                                                                 MRKUT001
00227      IF  PV-VSAM-SUCCESSFUL                                       MRKUT001
00228         CONTINUE                                                  MRKUT001
00229      ELSE                                                         MRKUT001
00230         IF PV-VSAM-NOT-FOUND                                      MRKUT001
00231            DISPLAY '** ABEND **'                                  MRKUT001
00232            DISPLAY '** PROGRAM    = MRKUT001'                     MRKUT001
00233            DISPLAY '** PARAGRAPH  = R000-READ-SYSTEM-RECORD'      MRKUT001
00234            DISPLAY '** MESSAGE    = '                             MRKUT001
00235                    'RECORD NOT FOUND,STATUS: ' PV-VSAM-STATUS     MRKUT001
00236            MOVE +4005           TO PV-ABEND-CODE                  MRKUT001
00237            CALL 'ILBOABN0'      USING PV-ABEND-CODE               MRKUT001
00238         ELSE                                                      MRKUT001
00239            DISPLAY '** ABEND **'                                  MRKUT001
00240            DISPLAY '** PROGRAM    = MRKUT001'                     MRKUT001
00241            DISPLAY '** PARAGRAPH  = R000-READ-SYSTEM-RECORD'      MRKUT001
00242            DISPLAY '** MESSAGE    = '                             MRKUT001
00243                    'BAD VSAM READ, STATUS = ' PV-VSAM-STATUS      MRKUT001
00244            MOVE +4005           TO PV-ABEND-CODE                  MRKUT001
00245            CALL 'ILBOABN0'      USING PV-ABEND-CODE               MRKUT001
00246         END-IF                                                    MRKUT001
00247      END-IF.                                                      MRKUT001
00248 *                                                                 MRKUT001
00249      ADD PC-PLUS-1 TO PV-SYSTEM-INPUT-CNT.                        MRKUT001
00250 *                                                                 MRKUT001
00251  EJECT                                                            MRKUT001
00252 ******************************************************************MRKUT001
00253 *     WRITES THE REVISED SYSTEM RECORD.                          *MRKUT001
00254 *                                                                *MRKUT001
00255 ******************************************************************MRKUT001
00256  W000-WRITE-SYSTEM-RECORD.                                        MRKUT001
00257 *                                                                 MRKUT001
00258      MOVE 'W000'                  TO PGM-LOCATION.                MRKUT001
00259      MOVE 'W000-WRITE-SYSTEM-RECORD   '                           MRKUT001
00260                                   TO PV-ABEND-PARAGRAPH.          MRKUT001
00261 *                                                                 MRKUT001
00262      REWRITE ICCTL-CNTL-REC       FROM SYSTEM-RECORD.             MRKUT001
00263 *                                                                 MRKUT001
00264      IF (PV-VSAM-SUCCESSFUL                                       MRKUT001
00265      OR  PV-VSAM-NOT-FOUND)                                       MRKUT001
00266         CONTINUE                                                  MRKUT001
00267      ELSE                                                         MRKUT001
00268         DISPLAY '** ABEND **'                                     MRKUT001
00269         DISPLAY '** PROGRAM    = MRKUT001'                        MRKUT001
00270         DISPLAY '** PARAGRAPH  = W000-WRITE-SYSTEM-RECORD'        MRKUT001
00271         DISPLAY '** MESSAGE    = '                                MRKUT001
00272                 'BAD VSAM WRITE,STATUS = ' PV-VSAM-STATUS         MRKUT001
00273         MOVE +4005              TO PV-ABEND-CODE                  MRKUT001
00274         CALL 'ILBOABN0'         USING PV-ABEND-CODE               MRKUT001
00275      END-IF.                                                      MRKUT001
00276 *                                                                 MRKUT001
00277      ADD PC-PLUS-1 TO PV-SYSTEM-OUTPUT-CNT.                       MRKUT001
00278 *                                                                 MRKUT001
00279  EJECT                                                            MRKUT001
00280 ******************************************************************MRKUT001
00281 *   CLOSES FILES AND DISPLAYS MESSAGES.                          *MRKUT001
00282 ******************************************************************MRKUT001
00283  Y100-END-ROUTINE.                                                MRKUT001
00284 *                                                                 MRKUT001
00285      CLOSE  ICCTL-CNTL-FILE.                                      MRKUT001
00286 *                                                                 MRKUT001
00287  EJECT                                                            MRKUT001
00288 ******************************************************************MRKUT001
