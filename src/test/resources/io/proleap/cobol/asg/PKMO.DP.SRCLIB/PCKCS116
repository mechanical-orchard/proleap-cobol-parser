000100*-----------------------*                                         00010009
000200 IDENTIFICATION DIVISION.                                         00020009
000300*-----------------------*                                         00030009
000400 PROGRAM-ID.    PCKCS116.                                         00040009
000500 AUTHOR.        ANNE YEKO.                                        00050009
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060009
000700 DATE-WRITTEN.  03-01-93.                                         00070009
000800 DATE-COMPILED.                                                   00080009
000900                                                                  00090009
001000*----------------------------------------------------------------*00100009
001100*    E116 - SHIPPING MANIFEST LABEL REQUEST                      *00110009
001200*                                                                *00120009
001300*    THIS PROGRAM ALLOWS THE USER TO ENTER CRITERIA ABOUT A      *00130009
001400*    SHIPPING MANIFEST LABEL.  WHEN THE "ADD" PF KEY IS DEPRESSED*00140009
001500*    THE PROGRAM WILL ROUTE THE SHIPPING MANIFEST LABEL TO THE   *00150009
001600*    PRINTER SPECIFIED.                                          *00160009
001700*----------------------------------------------------------------*00170009
001710* DATE  11/04/2021                                                00171047
001720*            - CHANGE CALL OF 'DPKUT100' TO                     * 00172047
001730*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00173047
001740*              MAKING THE CALL DYNAMIC VS STATIC                * 00174047
001750*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00175048
1122RM*---------------------------------------------------------------- 00175149
1122RM* DATE  11/07/2022                                              * 00175249
1122RM*            - ADD COPYBOOK DPWS930                             * 00175349
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00175449
1122RM*              DYNAMIC.                                         * 00175549
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00175649
001760*-----------------------------------------------------------------00176047
001800                                                                  00180009
001900 ENVIRONMENT DIVISION.                                            00190009
002000                                                                  00200009
002100 DATA DIVISION.                                                   00210009
002200                                                                  00220009
002300 WORKING-STORAGE SECTION.                                         00230009
002400                                                                  00240009
002500 01  DK-DB2-KEYS.                                                 00250009
002600     05  DK-OPER-UNT-ID.                                          00260009
002700         10 FILLER                PIC  X(01).                     00270009
002800         10 DK-OPER-UNT-ID-3      PIC  X(03).                     00280009
002900     05  DK-OPER-UNT-ID-2         PIC S9(04) COMP.                00290009
003000     05  DK-STR-NBR               PIC S9(04) COMP.                00300009
003100     05  DK-DC-OPER-UNIT-ID       PIC  9(04).                     00310009
003200     05  DK-DC-OPER-UNIT-ID-R REDEFINES DK-DC-OPER-UNIT-ID.       00320009
003300         10 FILLER                PIC  X(01).                     00330009
003400         10 DK-DC-OPER-UNIT-ID-2  PIC  X(03).                     00340009
003500                                                                  00350009
003600 01  PC-PROGRAM-CONSTANTS.                                        00360009
003700     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'PC116A  '.  00370009
003800     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'PCKM116 '.  00380009
003900     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'PCKCS116'.  00390009
004000     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00400009
004100                                              COMP.               00410009
004200     05  PC-LABEL-FORMAT          PIC  9(03)  VALUE  4.           00420009
004300     05  PC-OP-CO-NBR             PIC  X(02)  VALUE  '03'.        00430009
004400     05  PC-ALL                   PIC  X(03)  VALUE  'ALL'.       00440009
004500     05  PC-NINES                 PIC  X(10)  VALUE '9999-09-09'. 00450009
004600     05  PC-OPER-UNT-ID           PIC S9(04)  VALUE  +0 COMP.     00460009
004700     05  PC-FCLTY-ID              PIC S9(04)  VALUE  +0 COMP.     00470009
004800     05  PC-A                     PIC  X(01)  VALUE  'A'.         00480009
004900     05  PC-00                    PIC  9(02)  VALUE  00.          00490009
005000     05  PC-01                    PIC  X(02)  VALUE  '01'.        00500009
005100     05  PC-90                    PIC  X(02)  VALUE  '90'.        00510009
005200     05  PC-PRTR-VALIDATION-PGM   PIC  X(08)  VALUE  'DPKCS060'.  00520009
005300     05  PC-LOSS-PREV-MSG-1       PIC  X(17)  VALUE               00530009
005400                                              'MISLOAD TEST     '.00540009
005500     05  PC-LOSS-PREV-MSG-2       PIC  X(17)  VALUE               00550009
005600                                              'DO NOT RETURN    '.00560009
005700     05  PC-LOSS-PREV-STR-NM-1    PIC  X(10)  VALUE               00570009
005800                                              'MISLOAD   '.       00580009
005900     05  PC-LOSS-PREV-STR-NM-2    PIC  X(25)  VALUE               00590009
006000                                      'LOSS PREVENTION - MISLOAD'.00600009
006100*----------------------------------------------------------------*00610009
006200* SYSTEM MESSAGES                                                *00620009
006300*----------------------------------------------------------------*00630009
006400* 00005-INVALID VALUE                                             00640009
006500* 00007-REQUIRED ENTRY                                            00650009
006600* 00008-MUST BE NUMERIC                                           00660009
006700* 00017-STORE DOES NOT EXIST                                      00670009
006710* 00045-INVALID FKEY                                              00671010
006800* 00098-A PRINT REQUEST HAS BEEN SUBMITTED FOR THE SELECTED ITEM  00680009
006900* 00746-INVALID PRINTER DESTINATION                               00690009
006910* 00984- DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES             00691009
006920* 01945-STORE IS NOT SET-UP TO RECEIVE MERCHANDISE - F2 TO CONFIRM00692009
006930* 02050-BOTH SET YEAR AND SET SHORT NAME MUST BE KEYED TO USE     00693009
006940*       SEASONAL SET                                              00694009
006950* 02051-SEASONAL SET NO LONGER ACTIVE FOR SPECIAL DIVERT - PAST   00695009
006960*       RELEASE DATE                                              00696009
006970* 02052-SEASONAL SET CANNOT BE USE - INACTIVATED                  00697009
006980* 02053-SEASONAL SET IS NOT VALID - NOT DEFINED AS A SEASONAL SET 00698009
006990* 02122-LABEL REQUEST FAILED DUE TO COMMUNICATION ERROR           00699009
006991* 02772-STORE IS CURRENTLY NOT ASSIGNED TO THIS DC                00699111
007000* 02319-INVALID DISTRIBUTION CENTER                               00700009
007010* 03775-DC NOT SETUP TO PRINT IN P2L STORE ORDER                  00701016
007020* 03804-AMAZON RETURNS CENTER - LABEL PRINT NOT ALLOWED           00702025
007030* 03806-DC NOT SETUP TO PRINT AMAZON RETURNS CENTER LABELS        00703030
007040* 03816-LBL PRT OPT SELECTED NOT AVAILABLE AT THIS TIME           00704044
007100*----------------------------------------------------------------*00710009
007200                                                                  00720009
007300     05  PC-TSYMSG-NUMBERS.                                       00730009
007400         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00740009
007500         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00750009
007600         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00760009
007700         10  PC-TSYMSG-00017      PIC  9(05)  VALUE  00017.       00770009
007710         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00771010
007800         10  PC-TSYMSG-00098      PIC  9(05)  VALUE  00098.       00780009
007900         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       00790009
008000         10  PC-TSYMSG-00984      PIC  9(05)  VALUE  00984.       00800009
008100         10  PC-TSYMSG-01945      PIC  9(05)  VALUE  01945.       00810009
008200         10  PC-TSYMSG-02050      PIC  9(05)  VALUE  02050.       00820009
008300         10  PC-TSYMSG-02051      PIC  9(05)  VALUE  02051.       00830009
008400         10  PC-TSYMSG-02052      PIC  9(05)  VALUE  02052.       00840009
008500         10  PC-TSYMSG-02053      PIC  9(05)  VALUE  02053.       00850009
008600         10  PC-TSYMSG-02122      PIC  9(05)  VALUE  02122.       00860009
008610         10  PC-TSYMSG-02772      PIC  9(05)  VALUE  02772.       00861011
008700         10  PC-TSYMSG-02319      PIC  9(05)  VALUE  02319.       00870009
008800         10  PC-TSYMSG-03088      PIC  9(05)  VALUE  03088.       00880009
008810         10  PC-TSYMSG-03775      PIC  9(05)  VALUE  03775.       00881016
008820         10  PC-TSYMSG-03804      PIC  9(05)  VALUE  03804.       00882025
008830         10  PC-TSYMSG-03806      PIC  9(05)  VALUE  03806.       00883030
008840         10  PC-TSYMSG-03816      PIC  9(05)  VALUE  03816.       00884044
008900                                                                  00890009
009000 01  PM-PROGRAM-MESSAGES.                                         00900009
009100     05  PM-PROGRAM-MESSAGE-1.                                    00910009
009200         10  PM-RET-CDE           PIC  X(02)  VALUE SPACES.       00920009
009300         10  FILLER               PIC  X(01)  VALUE '-'.          00930009
009400         10  PM-RET-MSG           PIC  X(25)  VALUE SPACES.       00940009
009500         10  FILLER               PIC  X(48)  VALUE SPACES.       00950009
009600                                                                  00960009
009700 01  PS-PROGRAM-SWITCHES.                                         00970009
009800     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00980009
009900         88  PS-ERROR                         VALUE  'Y'.         00990009
010000         88  PS-NO-ERROR                      VALUE  'N'.         01000009
010100     05  PS-END-OF-OPEN-STORE-SW  PIC  X(01)  VALUE  'N'.         01010009
010200         88  PS-END-OF-OPEN-STORE-CSR         VALUE  'Y'.         01020009
010300     05  FACILITY-EDIT-SW         PIC  X(01)  VALUE  ' '.         01030009
010400         88  ERROR-ON-FACILITY-EDIT           VALUE  ' '.         01040009
010500         88  NO-ERROR-ON-FACILITY-EDIT        VALUE  'X'.         01050009
010600     05  OP-UNIT-EDIT-SW          PIC  X(01)  VALUE  ' '.         01060009
010700         88  ERROR-ON-OP-UNIT-EDIT            VALUE  ' '.         01070009
010800         88  NO-ERROR-ON-OP-UNIT-EDIT         VALUE  'X'.         01080009
010900     05  PRINTER-EDIT-SW          PIC  X(01)  VALUE  ' '.         01090009
011000         88  ERROR-ON-PRINTER-EDIT            VALUE  ' '.         01100009
011100         88  NO-ERROR-ON-PRINTER-EDIT         VALUE  'X'.         01110009
011200     05  STORE-RECEIPT-EDIT-SW    PIC  X(01)  VALUE  ' '.         01120009
011300         88  ERROR-ON-RECEIPT-EDIT            VALUE  ' '.         01130009
011400         88  NO-ERROR-ON-RECEIPT-EDIT         VALUE  'X'.         01140009
011500     05  SET-SEASET-EDIT-SW       PIC  X(01)  VALUE  ' '.         01150009
011600         88  ERROR-ON-SEASET-EDIT             VALUE  ' '.         01160009
011700         88  NO-ERROR-ON-SEASET-EDIT          VALUE  'X'.         01170009
011701* DMH 02/24/16 - BEGIN                                            01170116
011702     05  SML-ORD-EDIT-SW          PIC  X(01)  VALUE  'N'.         01170220
011703         88  ERROR-ON-SML-ORDER               VALUE  'Y'.         01170320
011704         88  NO-ERROR-ON-SML-ORDER            VALUE  'N'.         01170420
011705     05  DOOR-ON-LABEL-EDIT-SW    PIC  X(01)  VALUE  'N'.         01170520
011706         88  ERROR-ON-DOOR-ON-LABEL           VALUE  'Y'.         01170620
011707         88  NO-ERROR-ON-DOOR-ON-LABEL        VALUE  'N'.         01170720
011730* DMH 02/24/16 - BEGIN                                            01173016
011800     05  PS-EOF-STRZNE-CSR-SW     PIC  X(01)  VALUE  'N'.         01180009
011900         88  PS-EOF-STRZNE-CSR                VALUE  'Y'.         01190009
012000         88  PS-MORE-STRZNE-CSR               VALUE  'N'.         01200009
012100     05  PS-FIRST-PASS-SW         PIC  X(01)  VALUE  'Y'.         01210009
012200         88  PS-FIRST-PASS                    VALUE  'Y'.         01220009
012300         88  PS-NOT-FIRST-PASS                VALUE  'N'.         01230009
012310* DMH 07/18/2018                                                  01231028
012320     05  PS-AMAZON-RETURN-CENTER-SW PIC X(01) VALUE  'N'.         01232028
012330         88  PS-AMAZON-RETURN-CENTER-YES      VALUE  'Y'.         01233028
012340         88  PS-AMAZON-RETURN-CENTER-NO       VALUE  'N'.         01234028
012350     05  PS-DC-PRINT-AMAZON-LBL-SW  PIC X(01) VALUE  'N'.         01235028
012360         88  PS-DC-PRINT-AMAZON-LBL-YES       VALUE  'Y'.         01236028
012370         88  PS-DC-PRINT-AMAZON-LBL-NO        VALUE  'N'.         01237028
012400                                                                  01240009
012500 01  PV-PROGRAM-VARIABLES.                                        01250009
012600     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01260009
012700                                              COMP SYNC.          01270009
012800     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01280009
012900                                              COMP SYNC.          01290009
013000     05  PV-PRINTER-ID            PIC S9(04)  VALUE +0            01300009
013100                                              COMP.               01310009
013200     05  PV-OPER-UNT-ID           PIC S9(04)  VALUE +0            01320009
013300                                              COMP.               01330009
013400     05  PV-FCLTY-ID              PIC S9(04)  VALUE +0            01340009
013500                                              COMP.               01350009
013600     05  PV-NO-OF-LBLS-COMP       PIC S9(04)  VALUE +0            01360009
013700                                              COMP.               01370009
013800     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0            01380009
013900                                              COMP.               01390009
014000     05  PV-PICX-FOUR             PIC X(04)   VALUE SPACES.       01400009
014100     05  PV-PIC9-FOUR REDEFINES                                   01410009
014200         PV-PICX-FOUR             PIC 9(04).                      01420009
014300     05  PV-SUPPRESS-FOUR         PIC ZZZ9.                       01430009
014400     05  PV-PICX-THREE            PIC X(03)   VALUE SPACES.       01440009
014500     05  PV-PIC9-THREE REDEFINES                                  01450009
014600         PV-PICX-THREE            PIC 9(03).                      01460009
014700     05  PV-SUPPRESS-THREE        PIC ZZ9.                        01470009
014800     05  PV-STORE-NBR             PIC X(04)   VALUE ZEROES JUST.  01480009
014900     05  PV-STORE-NUMBER.                                         01490009
015000         10  FILLER               PIC X(01)   VALUE '0'.          01500009
015100         10  PV-STORE-NUMBER-3    PIC X(03)   VALUE '000'.        01510009
015200                                                                  01520009
015300     05  PV-CURRENT-DATE          PIC X(10).                      01530009
015400     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             01540009
015500         15  PV-CURRENT-CCYY      PIC  9(04).                     01550009
015600         15  FILLER               PIC  X(01).                     01560009
015700         15  PV-CURRENT-MM        PIC  9(02).                     01570009
015800         15  FILLER               PIC  X(01).                     01580009
015900         15  PV-CURRENT-DD        PIC  9(02).                     01590009
016000     05  PV-DATE-HOLD             PIC S9(08)  VALUE ZEROES.       01600009
016100     05  PV-DATE-HOLD-R REDEFINES PV-DATE-HOLD.                   01610009
016200         15  PV-HOLD-CCYY         PIC  9(04).                     01620009
016300         15  PV-HOLD-MM           PIC  9(02).                     01630009
016400         15  PV-HOLD-DD           PIC  9(02).                     01640009
016500     05  PV-DC1-DATE.                                             01650009
016600         15  PV-DC1-CCYY          PIC  9(04).                     01660009
016700         15  FILLER               PIC  X(01).                     01670009
016800         15  PV-DC1-MM            PIC  9(02).                     01680009
016900         15  FILLER               PIC  X(01).                     01690009
017000         15  PV-DC1-DD            PIC  9(02).                     01700009
017100     05  PV-DC1-HOLD              PIC S9(08)  VALUE ZEROES.       01710009
017200     05  PV-DC1-HOLD-R REDEFINES PV-DC1-HOLD.                     01720009
017300         15  PV-HDC1-CCYY         PIC  9(04).                     01730009
017400         15  PV-HDC1-MM           PIC  9(02).                     01740009
017500         15  PV-HDC1-DD           PIC  9(02).                     01750009
017600     05  PV-DC2-DATE.                                             01760009
017700         15  PV-DC2-CCYY          PIC  9(04).                     01770009
017800         15  FILLER               PIC  X(01).                     01780009
017900         15  PV-DC2-MM            PIC  9(02).                     01790009
018000         15  FILLER               PIC  X(01).                     01800009
018100         15  PV-DC2-DD            PIC  9(02).                     01810009
018200     05  PV-DC2-HOLD              PIC S9(08)  VALUE ZEROES.       01820009
018300     05  PV-DC2-HOLD-R REDEFINES PV-DC2-HOLD.                     01830009
018400         15  PV-HDC2-CCYY         PIC  9(04).                     01840009
018500         15  PV-HDC2-MM           PIC  9(02).                     01850009
018600         15  PV-HDC2-DD           PIC  9(02).                     01860009
018700     05 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.      01870009
018800     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          01880009
018900         10 FILLER                   PIC  X(03).                  01890009
019000         10 PV-2-DIGIT-DC-ABBR       PIC  X(02).                  01900009
019100                                                                  01910009
019200     05  PV-PCKCS721                  PIC X(08)  VALUE 'PCKCS721'.01920009
019300     05  PV-DONE-PROCESSING-SW        PIC X(01)  VALUE 'N'.       01930009
019400         88  PV-DONE-PROCESSING                  VALUE 'Y'.       01940009
019500     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.01950009
019600     05  PV-SQL-CODE                     PIC  9(09)  VALUE ZERO.  01960009
019700     05  PV-KRPRPM-FUNC-QTY              PIC  S9(9) COMP.         01970009
019800     05  PV-KRPRPM-FUNC-QTY-X            PIC  Z(09).              01980009
019900     05  PV-KRPRPM-TRACK                 PIC  X(25).              01990009
020000         88  PV-MFST-TRACK-YES                VALUE 'Y'.          02000009
020100         88  PV-MFST-TRACK-NO                 VALUE 'N'.          02010009
020200                                                                  02020009
020300     05  PV-DIVERT-WORK               PIC 9(04) VALUE ZEROES.     02030009
020400     05  PV-DIVERT-WORK-R REDEFINES PV-DIVERT-WORK.               02040009
020500         10  PV-DIVERT-POS-1-2        PIC 9(02).                  02050009
020600         10  PV-DIVERT-POS-3          PIC 9.                      02060009
020700         10  PV-DIVERT-POS-4          PIC 9.                      02070009
020800                                                                  02080009
020810     05  PV-GENERIC-SML-LINE-1        PIC X(20) VALUE SPACES.     02081013
020820     05  PV-GENERIC-SML-LINE-2        PIC X(20) VALUE SPACES.     02082013
020830     05  PV-GENERIC-SML-LINE-3        PIC X(20) VALUE SPACES.     02083013
020831*                                                                 02083115
020832*** DMH 2/25/16 BEGIN                                             02083215
020840     05  PV-PARM-DOOR-LABEL           PIC X(01) VALUE 'N'.        02084015
020841     05  PV-PARM-SML-ORD              PIC X(01) VALUE 'S'.        02084115
020851*** DMH 2/25/16 END                                               02085115
020860*                                                                 02086015
020870     05  PV-NULL-IND                  PIC S9(04)  VALUE ZEROS     02087035
020880                                                  COMP SYNC.      02088035
020890     05  PV-NULL-IND-1                PIC S9(04)  VALUE ZEROS     02089042
020891                                                  COMP SYNC.      02089142
020892     05  PV-NULL-IND-2                PIC S9(04)  VALUE ZEROS     02089242
020893                                                  COMP SYNC.      02089342
020894     05  PV-NULL-IND-3                PIC S9(04)  VALUE ZEROS     02089442
020895                                                  COMP SYNC.      02089542
020900                                                                  02090009
021000 EJECT                                                            02100009
021100*----------------------------------------------------------------*02110009
021200*  SENDING/RECEIVING AREA FOR THE                                *02120009
021300*  PRINTER VALIDATION ROUTING (DPKCS060)                         *02130009
021400*----------------------------------------------------------------*02140009
021500     COPY DPWS072.                                                02150009
021600                                                                  02160009
021700 EJECT                                                            02170009
021800*----------------------------------------------------------------*02180009
021900*    CALLING PARMS USED TO COMMUNICATE TO ARCH PROGRAM DPKCS030  *02190009
022000*----------------------------------------------------------------*02200009
022100                                                                  02210009
022200     COPY DPWS030.                                                02220009
1122RM     COPY DPWS930.                                                02221049
022300 EJECT                                                            02230009
022400                                                                  02240009
022500*----------------------------------------------------------------*02250009
022600*    NUMERIC EDIT COPYBOOK                                       *02260009
022700*----------------------------------------------------------------*02270009
022800                                                                  02280009
022900     COPY DPWS010I.                                               02290009
023000 EJECT                                                            02300009
023100                                                                  02310009
023200*----------------------------------------------------------------*02320009
023300*    STANDARD COMMAREA.                                          *02330009
023400*----------------------------------------------------------------*02340009
023500                                                                  02350009
023600     COPY DPWS020.                                                02360009
023700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02370009
023800                                                                  02380009
023900*----------------------------------------------------------------*02390009
024000*    INTER-APPLICATION COMMAREA.                                 *02400009
024100*----------------------------------------------------------------*02410009
024200                                                                  02420009
024300         10  INTER-APPL-COMM-AREA PIC X(200).                     02430009
024400*----------------------------------------------------------------*02440009
024500*    SPECIFIC COMMMAREA FOR PCKCS116.                            *02450009
024600*----------------------------------------------------------------*02460009
024700         10  ASC-SPECIFIC-COMMAREA.                               02470009
024800             15  ASC-PRTR-ID.                                     02480009
024900                 20  ASC-PRTR-ID-N           PIC  9(03).          02490009
025000             15  ASC-PRTR-DESC               PIC  X(25).          02500009
025100             15  FILLER                      PIC  X(08).          02510009
025200             15  ASC-STR-NBR                 PIC  X(04).          02520009
025300                 88  ASC-LOSS-PREVENTION     VALUE                02530009
025400                     'LP ' ' LP' 'LP' 'LP  ' ' LP ' '  LP'.       02540009
025500                 88  ASC-ALL-STORES          VALUE                02550009
025600                     'ALL' 'ALL ' ' ALL'.                         02560009
025700             15  ASC-STR-NBR-N    REDEFINES                       02570009
025800                 ASC-STR-NBR                 PIC  9(04).          02580009
025900             15  ASC-STR-NAME                PIC  X(25).          02590009
026000             15  ASC-STR-NAME-CHAR10-ABBR    PIC  X(10).          02600009
026100             15  ASC-NO-OF-LBLS.                                  02610009
026200                 20  ASC-NO-OF-LBLS-N        PIC  9(04).          02620009
026300             15  ASC-MFST-NBR                PIC  9(11).          02630009
026400             15  ASC-OPER-UNT-ID             PIC X(04).           02640009
026500             15  ASC-OPER-UNT-ID-N REDEFINES                      02650009
026600                 ASC-OPER-UNT-ID             PIC 9(04).           02660009
026700             15  ASC-FCLTY-ID                PIC X(04).           02670009
026800             15  ASC-FCLTY-ID-N       REDEFINES                   02680009
026900                 ASC-FCLTY-ID                PIC 9(04).           02690009
027000             15  ASC-OP-UNIT-NAME            PIC X(24).           02700009
027100             15  ASC-SEASONAL-SET-YEAR       PIC X(04).           02710009
027200             15  ASC-SEASONAL-SET-SHORT-NAME PIC X(05).           02720009
027300             15  ASC-DIVERT-PFX-NBR          PIC 9(02).           02730009
027400             15  ASC-SPEC-INST-LINE-1        PIC X(17).           02740009
027500             15  ASC-SPEC-INST-LINE-2        PIC X(17).           02750009
027600             15  ASC-CUR-OPER-UNT-ID         PIC 9(04).           02760009
027700             15  ASC-SSCC-18-IND             PIC X(01).           02770009
027800             15  ASC-MANIFEST-TRACKING       PIC X(01).           02780009
027900                 88  ASC-MFST-TRACK-YES          VALUE 'Y'.       02790009
028000                 88  ASC-MFST-TRACK-NO           VALUE 'N'.       02800009
028010             15  ASC-CONFIRM-NEEDED-SW       PIC X(01).           02801009
028020                 88  ASC-CONFIRM-NEEDED-NO       VALUE 'N'.       02802009
028030                 88  ASC-CONFIRM-NEEDED-YES      VALUE 'Y'.       02803009
028031* DMH 02/24/16 - BEGIN                                            02803120
028032             15  ASC-PARM-DOOR-LABEL         PIC X(01).           02803218
028033                 88 ASC-DOOR-ON-LABEL        VALUE 'Y'.           02803319
028034                 88 ASC-DOOR-NOT-ON-LABEL    VALUE 'N' ' '.       02803419
028035                 88 ASC-VALID-DOOR-PARM      VALUE 'Y' 'N' ' '.   02803519
028039             15  ASC-PARM-SML-ORD            PIC X(01).           02803919
028040                 88 ASC-SML-STORE-ORDER      VALUE 'S'.           02804019
028041                 88 ASC-SML-P2L-ORDER        VALUE 'P'.           02804119
028042                 88 ASC-SML-SHIP-DOOR-ORDER  VALUE 'D'.           02804219
028043                 88 ASC-SML-P2L-SEPHORA-ORD  VALUE 'A'.           02804344
028044                 88 ASC-VALID-SML-ORD-PARM   VALUE                02804444
028045                                             'S' 'P' 'D' 'A'.     02804544
028046             15  ASC-LABEL-LINE-1            PIC X(19).           02804644
028047             15  ASC-LABEL-LINE-2            PIC X(19).           02804744
028048             15  ASC-LABEL-LINE-3            PIC X(19).           02804844
028049* DMH 02/24/16 - END                                              02804944
028050         10  FILLER                          PIC X(2674).         02805044
028051     EJECT                                                        02805144
028060*----------------------------------------------------------------*02806009
028070*    LABEL COMMUNICATION AREA USING SOCKETS - PCKCS707           *02807009
028080*----------------------------------------------------------------*02808009
028090     COPY PCWS140.                                                02809009
028100                                                                  02810009
028200*----------------------------------------------------------------*02820009
028300*    TEXT AREA FOR TUPLDER                                       *02830009
028400*----------------------------------------------------------------*02840009
028500     COPY PCWS263.                                                02850009
028600                                                                  02860009
028700*----------------------------------------------------------------*02870009
028800*    COMMUNICATION AREA FOR LOCATION MODULE - XLKUT071           *02880009
028900*----------------------------------------------------------------*02890009
029000     COPY XLWS071.                                                02900009
029100                                                                  02910009
029200*----------------------------------------------------------------*02920009
029300*    ABEND PROCESSING COPYBOOK.                                  *02930009
029400*----------------------------------------------------------------*02940009
029500                                                                  02950009
029600     COPY DPWS013.                                                02960009
029700                                                                  02970009
029800     EJECT                                                        02980009
029900*----------------------------------------------------------------*02990009
030000*    ATTRIBUTE SETTINGS COPYBOOK.                                *03000009
030100*----------------------------------------------------------------*03010009
030200                                                                  03020009
030300     COPY DPWS015.                                                03030009
030400                                                                  03040009
030500*----------------------------------------------------------------*03050009
030600*    FUNCTION KEYS COPYBOOK                                      *03060009
030700*----------------------------------------------------------------*03070009
030800                                                                  03080009
030900     COPY DPWS016.                                                03090009
031000                                                                  03100009
031100*----------------------------------------------------------------*03110009
031200*    MAP LAYOUT                                                  *03120009
031300*----------------------------------------------------------------*03130009
031400                                                                  03140009
031500     COPY PCKM116.                                                03150009
031600                                                                  03160009
031700*----------------------------------------------------------------*03170009
031800*    STORE MANIFEST LAYOUT.                                       03180009
031900*----------------------------------------------------------------*03190009
032000     COPY PCWS187.                                                03200009
032100                                                                  03210009
032200*----------------------------------------------------------------*03220009
032300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       03230009
032400*  LOCATION MASTER TABLE (XLT_LOC)                                03240009
032500*----------------------------------------------------------------*03250009
032600     EXEC SQL                                                     03260009
032700          INCLUDE XLT00010                                        03270009
032800     END-EXEC.                                                    03280009
032900                                                                  03290009
033700*----------------------------------------------------------------*03370009
033800*    DB2 AREA FOR THE COMPANY CONTROL TABLE                      *03380009
033900*----------------------------------------------------------------*03390009
034000     EXEC SQL                                                     03400009
034100         INCLUDE TCOCNTL                                          03410009
034200     END-EXEC.                                                    03420009
034300                                                                  03430009
034400*----------------------------------------------------------------*03440009
034500*    DB2 AREA FOR THE SEASONAL SET TABLE                         *03450009
034600*----------------------------------------------------------------*03460009
034700     EXEC SQL                                                     03470009
034800         INCLUDE TSEASET                                          03480009
034900     END-EXEC.                                                    03490009
035000                                                                  03500009
035100*----------------------------------------------------------------*03510009
035200*    DB2 AREA FOR THE PARAMETER TABLE                            *03520009
035300*----------------------------------------------------------------*03530009
035400     EXEC SQL                                                     03540009
035500         INCLUDE TKRPRPM                                          03550009
035600     END-EXEC.                                                    03560009
035700                                                                  03570009
035800*----------------------------------------------------------------*03580009
035900*    DB2 AREA FOR THE UPLOAD ERROR TABLE                         *03590009
036000*    WILL BE USING THIS TO TRACK MANIFEST NUMBERS                *03600009
036100*----------------------------------------------------------------*03610009
036200     EXEC SQL                                                     03620009
036300         INCLUDE TUPLDER                                          03630009
036400     END-EXEC.                                                    03640009
036500                                                                  03650009
036510*----------------------------------------------------------------*03651016
036520*    WST_INTGRTN_TYP                                             *03652016
036530* DMH 2/24/16                                                    *03653016
036540*----------------------------------------------------------------*03654016
036550     EXEC SQL                                                     03655016
036560         INCLUDE WST00008                                         03656016
036570     END-EXEC.                                                    03657016
036580                                                                  03658016
036590*----------------------------------------------------------------*03659016
036591*    WST_ATTR_ELEM                                               *03659116
036592* DMH 2/24/16                                                    *03659216
036593*----------------------------------------------------------------*03659316
036594     EXEC SQL                                                     03659416
036595         INCLUDE WST00009                                         03659516
036596     END-EXEC.                                                    03659616
036597                                                                  03659716
036598*----------------------------------------------------------------*03659816
036599*    WST_ATTR_DEFN                                               *03659916
036600* DMH 2/24/16                                                    *03660016
036601*----------------------------------------------------------------*03660116
036602     EXEC SQL                                                     03660216
036603         INCLUDE WST00010                                         03660316
036604     END-EXEC.                                                    03660416
036605                                                                  03660516
036610*----------------------------------------------------------------*03661009
036700*    DB2 AREA FOR COMMUNICATIONS                                  03670009
036800*----------------------------------------------------------------*03680009
036900                                                                  03690009
037000     EXEC SQL                                                     03700009
037100          INCLUDE SQLCA                                           03710009
037200     END-EXEC.                                                    03720009
037300                                                                  03730009
038100                                                                  03810009
038200                                                                  03820009
038300 EJECT                                                            03830009
038400 LINKAGE SECTION.                                                 03840009
038500                                                                  03850009
038600 01  DFHCOMMAREA.                                                 03860009
038700     05  FILLER                         OCCURS  1 TO 4072 TIMES   03870009
038800                                        DEPENDING ON EIBCALEN.    03880009
038900         10  FILLER                     PIC X.                    03890009
039000                                                                  03900009
039100                                                                  03910009
039200 PROCEDURE DIVISION.                                              03920009
039300*----------------------------------------------------------------*03930009
039400*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *03940009
039500*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *03950009
039600*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *03960009
039700*                                                                *03970009
039800*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *03980009
039900*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *03990009
040000*----------------------------------------------------------------*04000009
040100 0000-MAIN-MODULE.                                                04010009
040200                                                                  04020009
040300     INITIALIZE DP030-CICS-API-FIELDS.                            04030009
040400                                                                  04040009
040500     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         04050009
040600     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            04060009
040700     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           04070009
040800                                                                  04080009
040900     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         04090009
041000                                                                  04100009
041100     MOVE LENGTH OF PC116AI      TO DP030-MAP-LENGTH (1).         04110009
041200     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       04120009
041300                                                                  04130009
041400     PERFORM 0001-CALL-CICS-ARCH-API.                             04140009
041500                                                                  04150009
041600     PERFORM 1000-CONTROL-PROCESSING.                             04160009
041700                                                                  04170009
041800     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       04180009
041900                                                                  04190009
042000     PERFORM 0001-CALL-CICS-ARCH-API.                             04200009
042100                                                                  04210009
042200                                                                  04220009
042300 0001-CALL-CICS-ARCH-API.                                         04230009
042400                                                                  04240009
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               04250049
1122RM     CALL DP930-CICS-ARCH-API                                     04251049
1122RM                     USING DFHEIBLK                               04252049
042600                           DFHCOMMAREA                            04260009
042700                           DP030-CICS-API-FIELDS                  04270009
042800                           DP020-STANDARD-COMMAREA                04280009
042900                           PC116AI.                               04290009
043000                                                                  04300009
043100     IF  DP030-RC-CALL-SUCCESSFUL                                 04310009
043200         CONTINUE                                                 04320009
043300     ELSE                                                         04330009
043400         SET DP013-NO-ROLLBACK   TO TRUE                          04340009
043500         SET DP013-XCTL-DISPLAY-RESTART                           04350009
043600                                 TO TRUE                          04360009
043700         SET DP013-CICS-ABEND    TO TRUE                          04370009
043800         MOVE 'BEFORE 0000-MAIN-MODULE'                           04380009
043900                                 TO DP013-PARAGRAPH               04390009
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04400049
1122RM*             'T LINE'           TO DP013-MESSAGE-TEXT (2)        04410049
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04411049
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04412049
044200         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        04420009
044300         PERFORM DP013-0000-PROCESS-ABEND                         04430009
044400     END-IF.                                                      04440009
044500 EJECT                                                            04450009
044600*----------------------------------------------------------------*04460009
044700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04470009
044800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04480009
044900*                                                                *04490009
045000*    PERFORMED BY 0000-MAIN-MODULE.                              *04500009
045100*----------------------------------------------------------------*04510009
045200                                                                  04520009
045300 1000-CONTROL-PROCESSING.                                         04530009
045400                                                                  04540009
045500     EVALUATE TRUE                                                04550009
045600         WHEN DP020-NEXT-ACT-INITIAL                              04560009
045700             INITIALIZE ASC-SPECIFIC-COMMAREA                     04570009
045800             MOVE -1         TO APRTRL                            04580009
045900             PERFORM 3000-BUILD-INITIAL-PANEL                     04590009
046000                                                                  04600009
046100         WHEN DP020-NEXT-ACT-READ-MAP                             04610009
046200             PERFORM 2000-FKEY-PROCESSING                         04620009
046300                                                                  04630009
046400         WHEN DP020-NEXT-ACT-RETURN                               04640009
046500             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 04650009
046600             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   04660009
046700             PERFORM 3200-DISPLAY-PANEL                           04670009
046800                                                                  04680009
046900         WHEN OTHER                                               04690009
047000             SET DP013-LOGIC-ABEND                                04700009
047100                                 TO TRUE                          04710009
047200             SET DP013-NO-ROLLBACK                                04720009
047300                                 TO TRUE                          04730009
047400             MOVE '1000-CONTROL-PROCESSING'                       04740009
047500                                 TO DP013-PARAGRAPH               04750009
047600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04760009
047700                                 TO DP013-MESSAGE-TEXT(1)         04770009
047800             MOVE DP020-NEXT-APPL-ACTIVITY                        04780009
047900                                 TO DP013-MESSAGE-TEXT(2)         04790009
048000             PERFORM DP013-0000-PROCESS-ABEND                     04800009
048100     END-EVALUATE.                                                04810009
048200                                                                  04820009
048300*----------------------------------------------------------------*04830009
048400*   DETERMINE THE PROCESSING PATH HERE.                          *04840009
048500*                                                                *04850009
048600*   PERFORMED BY 3000.                                           *04860009
048700*----------------------------------------------------------------*04870009
048800                                                                  04880009
048900 2000-FKEY-PROCESSING.                                            04890009
049000                                                                  04900009
049100     EVALUATE TRUE                                                04910009
049200         WHEN DP020-SRC-AID = DP016-CLEAR                         04920009
049300             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 04930009
049400             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   04940009
049500             PERFORM 3200-DISPLAY-PANEL                           04950009
049600                                                                  04960009
049700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04970009
049800             INITIALIZE ASC-SPECIFIC-COMMAREA                     04980009
049900             SET  ASC-CONFIRM-NEEDED-NO  TO  TRUE                 04990009
050000             IF  ASC-PRTR-ID-N  > 0                               05000009
050100                 MOVE -1         TO ASTRL                         05010009
050200             ELSE                                                 05020009
050300                 MOVE -1         TO APRTRL                        05030009
050400             END-IF                                               05040009
050500             PERFORM 3000-BUILD-INITIAL-PANEL                     05050009
050600             PERFORM 2210-RESET-ATTRIBUTES                        05060009
050700             PERFORM 3200-DISPLAY-PANEL                           05070009
050800             MOVE SPACES         TO ASC-PRTR-ID                   05080009
050900                                    ASC-NO-OF-LBLS                05090009
051000             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 05100009
051100                                                                  05110009
051200         WHEN DP020-SRC-AID = DP016-ENTER                         05120009
051300             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 05130009
051400             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   05140009
051500             IF  ASC-PRTR-ID-N  > 0                               05150009
051600                 IF  ASC-STR-NBR    > 0                           05160009
051700                     IF  ASC-NO-OF-LBLS-N > 0                     05170009
051800                         CONTINUE                                 05180009
051900                     ELSE                                         05190009
052000                         MOVE -1         TO ALBLSL                05200009
052100                     END-IF                                       05210009
052200                 ELSE                                             05220009
052300                     MOVE -1         TO ASTRL                     05230009
052400             ELSE                                                 05240009
052500                 MOVE -1         TO APRTRL                        05250009
052600             END-IF                                               05260009
052700             PERFORM 3200-DISPLAY-PANEL                           05270009
052800                                                                  05280009
052900** 3/18  WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 05290009
053000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05300009
053100         WHEN (DP020-FK-CONFIRM (DP020-SRC-AID) AND               05310009
053200               ASC-CONFIRM-NEEDED-YES)                            05320009
053300             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 05330009
053400             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   05340009
053500             IF  PS-ERROR                                         05350009
053600                 SET DP030-OVERRIDE-GO                            05360009
053700                                 TO TRUE                          05370009
053800                 PERFORM 3200-DISPLAY-PANEL                       05380009
053900             ELSE                                                 05390009
054000                 SET DP030-CONTINUE-GO                            05400009
054100                                 TO TRUE                          05410009
054200                                                                  05420009
054300                 PERFORM 4000-SETUP-COM-LABEL                     05430009
054400                                                                  05440009
054500                 IF  PC140-CRA-SUCCESSFUL                         05450009
054600                     SET DP020-MSG-INFORMATIONAL                  05460009
054700                                 TO TRUE                          05470009
054800                     MOVE SPACES TO ASC-NO-OF-LBLS                05480009
054900                                    ASC-STR-NBR                   05490009
055000                                    ASC-STR-NAME                  05500009
055100                     IF  ASC-SPEC-INST-LINE-1                     05510009
055200                         = PC-LOSS-PREV-MSG-1                     05520009
055300                         MOVE SPACES                              05530009
055400                           TO ASC-SPEC-INST-LINE-1                05540009
055500                     END-IF                                       05550009
055600                     IF  ASC-SPEC-INST-LINE-2                     05560009
055700                         = PC-LOSS-PREV-MSG-2                     05570009
055800                         MOVE SPACES                              05580009
055900                           TO ASC-SPEC-INST-LINE-2                05590009
056000                     END-IF                                       05600009
056100                     PERFORM 2300-MOVE-COMMAREA-TO-SCREEN         05610009
056200                     MOVE -1     TO ASTRL                         05620009
056300                     PERFORM 3000-BUILD-INITIAL-PANEL             05630009
056400                 END-IF                                           05640009
056500             END-IF                                               05650009
056600*                                                                 05660009
056700*** 3/18/13 BEGIN                                                 05670009
056800             EVALUATE TRUE                                        05680009
056900                 WHEN (DP020-FK-CONFIRM (DP020-SRC-AID) AND       05690009
056901                       ASC-CONFIRM-NEEDED-YES)                    05690109
056902                       SET  ASC-CONFIRM-NEEDED-NO  TO  TRUE       05690209
056903             END-EVALUATE                                         05690309
056904*** 3/18/13 END                                                   05690409
056905*                                                                 05690509
056906                                                                  05690609
056907         WHEN OTHER                                               05690709
056908                                                                  05690844
056992             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 05699210
056993             SET  PS-ERROR                                        05699310
056994                  DP020-MSG-FATAL  TO TRUE                        05699410
056995             MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER            05699510
056996             SET  ASC-CONFIRM-NEEDED-NO  TO  TRUE                 05699610
056997                                                                  05699710
057010     END-EVALUATE.                                                05701009
057300                                                                  05730010
057301                                                                  05730110
057310*----------------------------------------------------------------*05731009
057400*    HERE WE SIMPLY MOVE DATA ENTERED ON THE SCREEN TO THE COMM  *05740009
057500*    AREA.                                                       *05750009
057600*                                                                *05760009
057700*    PERFORMED BY 2000-FKEY-PROCESSING.                          *05770009
057800*----------------------------------------------------------------*05780009
057900                                                                  05790009
058000 2100-MOVE-SCREEN-TO-COMMAREA.                                    05800009
058100                                                                  05810009
058200     IF AOPUNITL > ZERO                                           05820009
058300         MOVE AOPUNITI           TO ASC-OPER-UNT-ID               05830009
058400     ELSE                                                         05840009
058500         IF AOPUNITF = DP015-ERASE-EOF                            05850009
058600             MOVE SPACE          TO ASC-OPER-UNT-ID               05860009
058700         END-IF                                                   05870009
058800     END-IF                                                       05880009
058900                                                                  05890009
059000     IF AFACILL  > ZERO                                           05900009
059100         MOVE AFACILI            TO ASC-FCLTY-ID                  05910009
059200     ELSE                                                         05920009
059300         IF AFACILF  = DP015-ERASE-EOF                            05930009
059400             MOVE SPACE          TO ASC-FCLTY-ID                  05940009
059500         END-IF                                                   05950009
059600     END-IF                                                       05960009
059700                                                                  05970009
059800     IF  APRTRL > ZERO                                            05980009
059900         MOVE APRTRI             TO ASC-PRTR-ID                   05990009
060000     ELSE                                                         06000009
060100         IF  APRTRF = DP015-ERASE-EOF                             06010009
060200             MOVE SPACE          TO ASC-PRTR-ID                   06020009
060300         END-IF                                                   06030009
060400     END-IF.                                                      06040009
060500                                                                  06050009
060600     IF  ASTRL > ZERO                                             06060009
060700         MOVE ASTRI              TO ASC-STR-NBR                   06070009
060800     ELSE                                                         06080009
060900         IF  ASTRF = DP015-ERASE-EOF                              06090009
061000             MOVE SPACE          TO ASC-STR-NBR                   06100009
061100         END-IF                                                   06110009
061200     END-IF.                                                      06120009
061300                                                                  06130009
061400     IF  ALBLSL > ZERO                                            06140009
061500         MOVE ALBLSI             TO ASC-NO-OF-LBLS                06150009
061600     ELSE                                                         06160009
061700         IF  ALBLSF = DP015-ERASE-EOF                             06170009
061800             MOVE SPACE          TO ASC-NO-OF-LBLS                06180009
061900         END-IF                                                   06190009
062000     END-IF.                                                      06200009
062100                                                                  06210009
062200     IF  SSYRL > ZERO                                             06220009
062300         MOVE SSYRI              TO ASC-SEASONAL-SET-YEAR         06230009
062400     ELSE                                                         06240009
062500         IF  SSYRF = DP015-ERASE-EOF                              06250009
062600             MOVE SPACE          TO ASC-SEASONAL-SET-YEAR         06260009
062700         END-IF                                                   06270009
062800     END-IF.                                                      06280009
062900                                                                  06290009
063000     IF  SSNML > ZERO                                             06300009
063100         MOVE SSNMI              TO ASC-SEASONAL-SET-SHORT-NAME   06310009
063200     ELSE                                                         06320009
063300         IF  SSNMF = DP015-ERASE-EOF                              06330009
063400             MOVE SPACE          TO ASC-SEASONAL-SET-SHORT-NAME   06340009
063500         END-IF                                                   06350009
063600     END-IF.                                                      06360009
063700                                                                  06370009
063800     IF  INST1L > ZERO                                            06380009
063900         MOVE INST1I             TO ASC-SPEC-INST-LINE-1          06390009
064000     ELSE                                                         06400009
064100         IF  INST1F = DP015-ERASE-EOF                             06410009
064200             MOVE SPACE          TO ASC-SPEC-INST-LINE-1          06420009
064300         END-IF                                                   06430009
064400     END-IF.                                                      06440009
064500                                                                  06450009
064600     IF  INST2L > ZERO                                            06460009
064700         MOVE INST2I             TO ASC-SPEC-INST-LINE-2          06470009
064800     ELSE                                                         06480009
064900         IF  INST2F = DP015-ERASE-EOF                             06490009
065000             MOVE SPACE          TO ASC-SPEC-INST-LINE-2          06500009
065100         END-IF                                                   06510009
065200     END-IF.                                                      06520009
065300                                                                  06530044
065310     IF  SHDRL  > ZERO                                            06531019
065320         MOVE SHDRI              TO ASC-PARM-DOOR-LABEL           06532019
065330     ELSE                                                         06533019
065340         IF  SHDRF  = DP015-ERASE-EOF                             06534019
065350             MOVE SPACE          TO ASC-PARM-DOOR-LABEL           06535019
065360         END-IF                                                   06536019
065370     END-IF.                                                      06537019
065371     IF  LBLORDL > ZERO                                           06537119
065372         MOVE LBLORDI             TO ASC-PARM-SML-ORD             06537219
065373     ELSE                                                         06537319
065374         IF  LBLORDF = DP015-ERASE-EOF                            06537419
065375             MOVE SPACE          TO ASC-PARM-SML-ORD              06537519
065376         END-IF                                                   06537619
065377     END-IF.                                                      06537719
065380                                                                  06538044
065390                                                                  06539019
065400*----------------------------------------------------------------*06540009
065500*    HERE WE SIMPLY ENSURE THE DATA IS CORRECT.  IF NOT, ISSUE   *06550009
065600*    APPROPRIATE ERRORS.                                         *06560009
065700*                                                                *06570009
065800*    PERFORMED BY 2000-FKEY-PROCESSING.                          *06580009
065900*----------------------------------------------------------------*06590009
066000                                                                  06600009
066100 2200-EDIT-DATA-IN-COMMAREA.                                      06610009
066200                                                                  06620009
066300     PERFORM 2210-RESET-ATTRIBUTES.                               06630009
066400                                                                  06640009
066500     EXEC SQL                                                     06650009
066600         SET :PV-CURRENT-DATE = CURRENT DATE                      06660009
066700     END-EXEC.                                                    06670009
066800     IF SQLCODE = ZERO                                            06680009
066900         CONTINUE                                                 06690009
067000     ELSE                                                         06700009
067100         MOVE '2200-EDIT-DATA-IN-COMMAREA'                        06710009
067200                         TO DP013-PARAGRAPH                       06720009
067300         MOVE 'GET CURRENT DATE'                                  06730009
067400                         TO DP013-MESSAGE-TEXT (1)                06740009
067500         MOVE SQLCA      TO DP013-SQLCA                           06750009
067600         MOVE SPACES     TO DP013-DB2-TABLE-NAME (1)              06760009
067700         SET DP013-DB2-ABEND                                      06770009
067800                         TO TRUE                                  06780009
067900         SET DP013-XCTL-DISPLAY-RESTART                           06790009
068000                         TO TRUE                                  06800009
068100         PERFORM DP013-0000-PROCESS-ABEND                         06810009
068200     END-IF.                                                      06820009
068300                                                                  06830009
068400     IF  ASC-NO-OF-LBLS = SPACES                                  06840009
068500         SET PS-ERROR            TO TRUE                          06850009
068600         SET DP020-MSG-FATAL     TO TRUE                          06860009
068700         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              06870009
068800         MOVE DP015-UNP-NUM-BRT-OFF                               06880009
068900                                 TO ALBLSA                        06890009
069000         MOVE DP015-RED          TO ALBLSC                        06900009
069100         MOVE DP015-REVERSE      TO ALBLSH                        06910009
069200         MOVE -1                 TO ALBLSL                        06920009
069300         SET DP030-SET-CURSOR-APPL-1                              06930009
069400                                 TO TRUE                          06940009
069500     ELSE                                                         06950009
069600         PERFORM 2220-EDIT-NO-OF-LBLS                             06960009
069700         IF  PS-NO-ERROR                                          06970009
069800             IF ASC-ALL-STORES                                    06980009
069900                 PERFORM 3900-SEL-KRPRPM-LABEL-QTY                06990009
070000             ELSE                                                 07000009
070100                 PERFORM 3800-SEL-KRPRPM-RQST-QTY                 07010009
070200             END-IF                                               07020009
070300             IF   ASC-NO-OF-LBLS-N > PV-KRPRPM-FUNC-QTY AND       07030009
070400                  PV-KRPRPM-FUNC-QTY > 0                          07040009
070500                  SET PS-ERROR            TO TRUE                 07050009
070600                  SET DP020-MSG-FATAL     TO TRUE                 07060009
070700                  MOVE PC-TSYMSG-03088    TO DP020-MSG-NUMBER     07070009
070800                  MOVE PV-KRPRPM-FUNC-QTY TO PV-KRPRPM-FUNC-QTY-X 07080009
070900                  MOVE PV-KRPRPM-FUNC-QTY-X TO DP020-MSG-TEXT     07090009
071000                  MOVE DP015-UNP-NUM-BRT-OFF                      07100009
071100                                          TO ALBLSA               07110009
071200                  MOVE DP015-RED          TO ALBLSC               07120009
071300                  MOVE DP015-REVERSE      TO ALBLSH               07130009
071400                  MOVE -1                 TO ALBLSL               07140009
071500                  SET DP030-SET-CURSOR-APPL-1                     07150009
071600                                          TO TRUE                 07160009
071700             END-IF                                               07170009
071800         END-IF                                                   07180009
071900*                                                                 07190009
072000*** ADDED TKRPRM SELECT TO DETERMINE IF WE WILL BE TRACKING       07200009
072100*** THE CARTON MANIFEST NUMBER                                    07210009
072200*** ADDED DMH - 6/20/12                                           07220009
072300*                                                                 07230009
072400         IF  PS-NO-ERROR                                          07240009
072500             PERFORM 3910-CHECK-MANIFEST-TRACKING                 07250009
072600         END-IF                                                   07260009
072700*                                                                 07270009
072800     END-IF.                                                      07280009
072900                                                                  07290009
073000     IF  ASC-STR-NBR = SPACES OR ZEROS                            07300009
073100         SET PS-ERROR            TO TRUE                          07310009
073200         SET DP020-MSG-FATAL     TO TRUE                          07320009
073300         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              07330009
073400         MOVE DP015-UNP-ALP-BRT-OFF                               07340009
073500                                 TO ASTRA                         07350009
073600         MOVE DP015-RED          TO ASTRC                         07360009
073700         MOVE DP015-REVERSE      TO ASTRH                         07370009
073800         MOVE -1                 TO ASTRL                         07380009
073900         SET DP030-SET-CURSOR-APPL-1                              07390009
074000                                 TO TRUE                          07400009
074100     ELSE                                                         07410009
074200         IF ASC-ALL-STORES        OR                              07420009
074300            ASC-LOSS-PREVENTION                                   07430009
074400            SET NO-ERROR-ON-RECEIPT-EDIT TO TRUE                  07440009
074500         ELSE                                                     07450009
074600            SET NO-ERROR-ON-RECEIPT-EDIT TO TRUE                  07460009
074700            PERFORM 2230-EDIT-STORE-NBR                           07470009
074800         END-IF                                                   07480009
074900     END-IF.                                                      07490009
075000                                                                  07500009
075100     SET ERROR-ON-FACILITY-EDIT TO TRUE                           07510009
075200     PERFORM 2243-EDIT-FACILITY.                                  07520009
075300                                                                  07530009
075400     SET ERROR-ON-OP-UNIT-EDIT TO TRUE                            07540009
075500     PERFORM 2242-EDIT-OPERATING-UNIT.                            07550009
075600                                                                  07560009
075700     SET ERROR-ON-PRINTER-EDIT TO TRUE                            07570009
075800     PERFORM 2244-EDIT-PRINTER-ID.                                07580009
075900                                                                  07590009
076014     SET ERROR-ON-SML-ORDER  TO  TRUE.                            07601416
076020     PERFORM 2282-VALIDATE-SML-ORDER.                             07602015
076030                                                                  07603015
076033     SET ERROR-ON-DOOR-ON-LABEL  TO  TRUE.                        07603316
076034     PERFORM 2284-VALIDATE-DOOR-ON-LABEL.                         07603416
076050                                                                  07605015
076100     EVALUATE TRUE                                                07610009
076200     WHEN ASC-SEASONAL-SET-YEAR       > SPACES AND                07620009
076300          ASC-SEASONAL-SET-SHORT-NAME > SPACES                    07630009
076400         PERFORM 2275-EDIT-SEASONAL-SET                           07640009
076500     WHEN ASC-SEASONAL-SET-YEAR       NOT > SPACES AND            07650009
076600          ASC-SEASONAL-SET-SHORT-NAME NOT > SPACES                07660009
076700         SET NO-ERROR-ON-SEASET-EDIT TO TRUE                      07670009
076800         MOVE SPACES TO ASC-SEASONAL-SET-SHORT-NAME               07680009
076900         MOVE PC-00  TO ASC-DIVERT-PFX-NBR                        07690009
077000     WHEN OTHER                                                   07700009
077100         SET ERROR-ON-SEASET-EDIT    TO TRUE                      07710009
077200         SET PS-ERROR                TO TRUE                      07720009
077300         SET DP020-MSG-FATAL         TO TRUE                      07730009
077400         MOVE PC-TSYMSG-02050        TO DP020-MSG-NUMBER          07740009
077500         MOVE DP015-UNP-ALP-BRT-OFF  TO SSYRA                     07750009
077600                                        SSNMA                     07760009
077700         MOVE DP015-RED              TO SSYRC                     07770009
077800                                        SSNMC                     07780009
077900         MOVE DP015-REVERSE          TO SSYRH                     07790009
078000                                        SSNMH                     07800009
078100         MOVE -1                     TO SSYRL                     07810009
078200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07820009
078300     END-EVALUATE.                                                07830009
078400                                                                  07840009
078500     IF NO-ERROR-ON-FACILITY-EDIT AND                             07850009
078600        NO-ERROR-ON-OP-UNIT-EDIT  AND                             07860009
078700        NO-ERROR-ON-PRINTER-EDIT  AND                             07870009
078800        NO-ERROR-ON-RECEIPT-EDIT  AND                             07880009
078900        NO-ERROR-ON-SEASET-EDIT   AND                             07890016
078910        NO-ERROR-ON-SML-ORDER     AND                             07891016
078920        NO-ERROR-ON-DOOR-ON-LABEL                                 07892016
079000            PERFORM 2260-VALIDATE-PRINTER                         07900009
079100            IF PS-NO-ERROR                                        07910009
079200                PERFORM 2265-VALIDATE-PRINTER-ID                  07920009
079300                MOVE DP072-PRTR-LOC-DESC TO ASC-PRTR-DESC         07930009
079400                                            APRDESCO              07940009
079500                MOVE DP072-PRTR-IP-ADDRESS                        07950009
079600                                     TO PC140-SML-IP-ADDRESS      07960009
079700                MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE               07970009
079800                                     TO PC140-SML-OS-RLSE-CDE     07980009
079900                MOVE DP072-PRTR-DATA-XFER-MODE-ID                 07990009
080000                                     TO PC140-SML-XFER-MODE-ID    08000009
080100                MOVE DP072-XMIT-INTFC-CDE                         08010009
080200                                     TO PC140-XMIT-INTFC-CDE      08020009
080300                MOVE DP072-PRTR-TYP-CDE                           08030009
080400                                     TO PC140-SML-PRTR-TYPE       08040009
080500                                                                  08050009
080600                MOVE DP072-PRTR-OPER-UNT-ID TO PC-OPER-UNT-ID     08060009
080700                                                                  08070009
080800                PERFORM 2290-GET-DC-LOCATION                      08080009
080900            END-IF                                                08090009
081000     END-IF.                                                      08100009
081100                                                                  08110009
081200     IF  PS-NO-ERROR                                              08120009
081300         IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                08130009
081400         OR (DP020-FK-CONFIRM (DP020-SRC-AID)  AND                08140009
081500             ASC-CONFIRM-NEEDED-YES)                              08150009
081600            MOVE -1                 TO ASTRL                      08160009
081700            SET DP030-SET-CURSOR-APPL-1                           08170009
081800                                    TO TRUE                       08180009
081900            IF ASC-MFST-NBR = ZEROS       AND                     08190009
082000               NOT ASC-ALL-STORES                                 08200009
082100                MOVE PC-OPER-UNT-ID       TO DK-DC-OPER-UNIT-ID   08210009
082200                MOVE ASC-STR-NBR          TO DK-STR-NBR           08220009
082300                                                                  08230009
082400                IF ASC-LOSS-PREVENTION                            08240009
082500                   MOVE ASC-OPER-UNT-ID-N   TO PC187-STR-NBR      08250009
082600                ELSE                                              08260009
082700                   MOVE ASC-STR-NBR         TO PC187-STR-NBR      08270009
082800                END-IF                                            08280009
082900                                                                  08290009
083000                MOVE  ASC-NO-OF-LBLS-N   TO PC187-NO-OF-LBLS      08300009
083100***                                                               08310009
083200* BEGIN 2/19/13 DMH                                               08320009
083300* INCREASE NUMBER OF LABELS REQUESTED BY 1 TO SKIP ONE            08330009
083400* TRYING TO RESOLVE PRINTER ISSUE CAUSING DUPLICATE LABELS        08340009
083500*                                                                 08350009
083600                ADD  1  TO  PC187-NO-OF-LBLS                      08360009
083700* END 2/19/13 DMH                                                 08370009
083800***                                                               08380009
083900                PERFORM 4750-LINK-PCKCS721                        08390009
084000                MOVE  PC187-START-MFST-NBR                        08400009
084100                                     TO ASC-MFST-NBR              08410009
084200            END-IF                                                08420009
084300         END-IF                                                   08430009
084400     END-IF.                                                      08440009
084500                                                                  08450009
084600     IF  ASC-LOSS-PREVENTION                                      08460009
084700         MOVE PC-LOSS-PREV-STR-NM-2  TO ASC-STR-NAME              08470009
084800                                        ASTRNMO                   08480009
084900         MOVE PC-LOSS-PREV-STR-NM-1  TO ASC-STR-NAME-CHAR10-ABBR  08490009
085000         IF  ASC-SPEC-INST-LINE-1  >  SPACES  OR                  08500009
085100             ASC-SPEC-INST-LINE-2  >  SPACES                      08510009
085200             CONTINUE                                             08520009
085300         ELSE                                                     08530009
085400             MOVE  PC-LOSS-PREV-MSG-1 TO ASC-SPEC-INST-LINE-1     08540009
085500                                         INST1O                   08550009
085600             MOVE  PC-LOSS-PREV-MSG-2 TO ASC-SPEC-INST-LINE-2     08560009
085700                                         INST2O                   08570009
085800         END-IF                                                   08580009
085900     END-IF.                                                      08590009
086000                                                                  08600009
086100                                                                  08610009
086200 2210-RESET-ATTRIBUTES.                                           08620009
086300                                                                  08630009
086400     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRA                         08640009
086500                                    AOPUNITA                      08650009
086600                                    AFACILA                       08660009
086700                                    SSYRA                         08670009
086800                                    SSNMA                         08680016
086810                                    SHDRA                         08681016
086820                                    LBLORDA.                      08682016
086900     MOVE DP015-UNP-NUM-NOR-OFF  TO APRTRA                        08690009
087000                                    ALBLSA.                       08700009
087100     MOVE DP015-GREEN            TO APRTRC                        08710009
087200                                    ASTRC                         08720009
087300                                    ALBLSC                        08730009
087400                                    AOPUNITC                      08740009
087500                                    AFACILC                       08750009
087600                                    SSYRC                         08760009
087700                                    SSNMC                         08770016
087710                                    SHDRC                         08771016
087720                                    LBLORDC.                      08772016
087800     MOVE DP015-UNDERLINE        TO APRTRH                        08780009
087900                                    ASTRH                         08790009
088000                                    ALBLSH                        08800009
088100                                    AOPUNITH                      08810009
088200                                    AFACILH                       08820009
088300                                    SSYRH                         08830009
088400                                    SSNMH                         08840016
088410                                    SHDRH                         08841016
088420                                    LBLORDH.                      08842016
088500                                                                  08850009
088600*----------------------------------------------------------------*08860009
088700*    CHECK THE NUMBER OF LABELS FOR NUMERIC                      *08870009
088800*----------------------------------------------------------------*08880009
088900                                                                  08890009
089000 2220-EDIT-NO-OF-LBLS.                                            08900009
089100                                                                  08910009
089200     MOVE ASC-NO-OF-LBLS         TO DP010I-UNEDITED-FIELD.        08920009
089300     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        08930009
089400     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      08940009
089500                                                                  08950009
089600     SET DP010I-NEGATIVE-NOT-ALLOWED                              08960009
089700                                 TO TRUE.                         08970009
089800                                                                  08980009
089910     CALL DP010I-NUMERIC-EDIT-ROUTINE                             08991046
089920                         USING DP010I-NUMERIC-EDIT-AREA           08992046
090000                                                                  09000009
090100     IF DP010I-NO-ERROR-DETECTED                                  09010009
090200         MOVE DP010I-NUMERIC-FIELD                                09020009
090300                                 TO ASC-NO-OF-LBLS-N              09030009
090400         MOVE ASC-NO-OF-LBLS     TO ALBLSO                        09040009
090500         IF ASC-NO-OF-LBLS NOT > ZERO                             09050009
090600             SET PS-ERROR        TO TRUE                          09060009
090700             SET DP020-MSG-FATAL TO TRUE                          09070009
090800             MOVE PC-TSYMSG-00005                                 09080009
090900                                 TO DP020-MSG-NUMBER              09090009
091000             MOVE DP015-UNP-NUM-BRT-OFF                           09100009
091100                                 TO ALBLSA                        09110009
091200             MOVE DP015-RED      TO ALBLSC                        09120009
091300             MOVE DP015-REVERSE  TO ALBLSH                        09130009
091400             MOVE -1             TO ALBLSL                        09140009
091500             SET DP030-SET-CURSOR-APPL-1                          09150009
091600                                 TO TRUE                          09160009
091700         END-IF                                                   09170009
091800     ELSE                                                         09180009
091900         SET PS-ERROR            TO TRUE                          09190009
092000         SET DP020-MSG-FATAL     TO TRUE                          09200009
092100         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              09210009
092200         MOVE DP015-UNP-NUM-BRT-OFF                               09220009
092300                                 TO ALBLSA                        09230009
092400         MOVE DP015-RED          TO ALBLSC                        09240009
092500         MOVE DP015-REVERSE      TO ALBLSH                        09250009
092600         MOVE -1                 TO ALBLSL                        09260009
092700         SET DP030-SET-CURSOR-APPL-1                              09270009
092800                                 TO TRUE                          09280009
092900     END-IF.                                                      09290009
093000                                                                  09300009
093100                                                                  09310009
093200*----------------------------------------------------------------*09320009
093300*    CHECK THE STORE NUMBER FOR NUMERIC                          *09330009
093400*----------------------------------------------------------------*09340009
093500                                                                  09350009
093600 2230-EDIT-STORE-NBR.                                             09360009
093700                                                                  09370009
093800     MOVE ASC-STR-NBR            TO DP010I-UNEDITED-FIELD.        09380009
093900     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        09390009
094000     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      09400009
094100                                                                  09410009
094200     SET DP010I-NEGATIVE-NOT-ALLOWED                              09420009
094300                                 TO TRUE.                         09430009
094400                                                                  09440009
094510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09451046
094520                         USING DP010I-NUMERIC-EDIT-AREA           09452046
094600                                                                  09460009
094700     IF DP010I-NO-ERROR-DETECTED                                  09470009
094800         MOVE DP010I-NUMERIC-FIELD                                09480009
094900                                 TO ASC-STR-NBR-N                 09490009
095000         MOVE ASC-STR-NBR        TO ASTRO                         09500009
095100         PERFORM 2240-GET-STORE-NAME                              09510009
095200         EVALUATE TRUE                                            09520009
095300             WHEN XL071-NO-ERRORS                                 09530009
095400                 MOVE XL071-LOC-NM                                09540009
095500                                       TO ASC-STR-NAME            09550009
095600                                          ASTRNMO                 09560009
095700                 MOVE XL071-LOC-10-ABBR-NM                        09570009
095800                                       TO ASC-STR-NAME-CHAR10-ABBR09580009
095900             WHEN XL071-LOC-NOT-FOUND                             09590009
096000                 SET PS-ERROR        TO TRUE                      09600009
096100                 SET DP020-MSG-FATAL TO TRUE                      09610009
096200                 MOVE PC-TSYMSG-00017                             09620009
096300                                     TO DP020-MSG-NUMBER          09630009
096400                 MOVE DP015-UNP-ALP-BRT-OFF                       09640009
096500                                     TO ASTRA                     09650009
096600                 MOVE DP015-RED      TO ASTRC                     09660009
096700                 MOVE DP015-REVERSE  TO ASTRH                     09670009
096800                 MOVE -1             TO ASTRL                     09680009
096900                 SET DP030-SET-CURSOR-APPL-1                      09690009
097000                                     TO TRUE                      09700009
097100                 MOVE SPACES         TO ASTRNMO                   09710009
097200                                        ASC-STR-NAME              09720009
097300                                        ASC-STR-NAME-CHAR10-ABBR  09730009
097310                                        ASC-STR-NAME-CHAR10-ABBR  09731023
097320                                                                  09732023
097330* DMH - 07/17/2018 BEGIN                                          09733023
097331             WHEN XL071-DC-ASGMT-NOT-FND                          09733124
097332                  PERFORM 2400-CHECK-AMAZON-RETURN                09733224
097333                  IF  PS-AMAZON-RETURN-CENTER-NO                  09733325
097334                      SET PS-ERROR            TO TRUE             09733425
097335                      SET DP020-MSG-FATAL     TO TRUE             09733525
097339                      MOVE PC-TSYMSG-02772 TO DP020-MSG-NUMBER    09733935
097341                      MOVE DP015-UNP-ALP-BRT-OFF                  09734125
097342                                              TO ASTRA            09734225
097343                      MOVE DP015-RED          TO ASTRC            09734325
097344                      MOVE DP015-REVERSE      TO ASTRH            09734425
097345                      MOVE -1                 TO ASTRL            09734525
097346                      SET DP030-SET-CURSOR-APPL-1                 09734625
097347                                              TO TRUE             09734725
097348                  ELSE                                            09734825
097349                  IF  PS-AMAZON-RETURN-CENTER-YES AND             09734925
097350                      PS-DC-PRINT-AMAZON-LBL-NO                   09735029
097351                      SET PS-ERROR            TO TRUE             09735129
097352                      SET DP020-MSG-FATAL     TO TRUE             09735225
097353                      MOVE PC-TSYMSG-03806 TO DP020-MSG-NUMBER    09735331
097354                      MOVE DP015-UNP-ALP-BRT-OFF                  09735425
097355                                              TO ASTRA            09735525
097356                      MOVE DP015-RED          TO ASTRC            09735625
097357                      MOVE DP015-REVERSE      TO ASTRH            09735725
097358                      MOVE -1                 TO ASTRL            09735825
097359                      SET DP030-SET-CURSOR-APPL-1                 09735925
097360                                              TO TRUE             09736025
097361                  END-IF                                          09736125
097362                  END-IF                                          09736225
097363                                                                  09736325
097364* DMH - 07/17/2018 END                                            09736425
097370                                                                  09737023
097400             WHEN OTHER                                           09740009
097500                 SET PS-ERROR            TO TRUE                  09750011
097600                 SET DP020-MSG-FATAL     TO TRUE                  09760009
097610                 IF  XL071-DC-ASGMT-NOT-FND                       09761011
097700                     MOVE PC-TSYMSG-02772 TO DP020-MSG-NUMBER     09770011
097701                 ELSE                                             09770111
097710                     MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER     09771011
097720                 END-IF                                           09772011
097800                 MOVE DP015-UNP-ALP-BRT-OFF                       09780009
097900                                         TO ASTRA                 09790009
098000                 MOVE DP015-RED          TO ASTRC                 09800009
098100                 MOVE DP015-REVERSE      TO ASTRH                 09810009
098200                 MOVE -1                 TO ASTRL                 09820009
098300                 SET DP030-SET-CURSOR-APPL-1                      09830009
098400                                         TO TRUE                  09840009
098500         END-EVALUATE                                             09850009
098600     ELSE                                                         09860009
098700         SET ERROR-ON-RECEIPT-EDIT       TO TRUE                  09870009
098800         SET PS-ERROR                    TO TRUE                  09880009
098900         SET DP020-MSG-WARNING           TO TRUE                  09890009
099000         MOVE PC-TSYMSG-00005            TO DP020-MSG-NUMBER      09900009
099100         MOVE DP015-UNP-ALP-BRT-OFF      TO ASTRA                 09910009
099200         MOVE DP015-RED                  TO ASTRC                 09920009
099300         MOVE DP015-REVERSE              TO ASTRH                 09930009
099400         MOVE -1                         TO ASTRL                 09940009
099500         SET DP030-SET-CURSOR-APPL-1     TO TRUE                  09950009
099600     END-IF.                                                      09960009
099700                                                                  09970009
099800                                                                  09980009
099900*----------------------------------------------------------------*09990009
100000*    GET THE 10 CHARACTER ABBREVIATION OF THE STORE NAME         *10000009
100100*----------------------------------------------------------------*10010009
100200 2240-GET-STORE-NAME.                                             10020009
100300                                                                  10030009
100400     INITIALIZE  XL071-COMMAREA-REC.                              10040009
100500     MOVE ASC-STR-NBR  TO  XL071-LOCATION-NUMBER                  10050009
100600                                                                  10060009
100700     CALL XL071-LOCATION-MODULE USING                             10070009
100800          DFHEIBLK                                                10080009
100900          XL071-COMMAREA                                          10090009
101000          XL071-COMMAREA-REC.                                     10100009
101100                                                                  10110009
101200     EVALUATE TRUE                                                10120009
101300         WHEN XL071-NO-ERRORS                                     10130009
101400              IF  XL071-LOC-TYP-CDE = 'DC' OR                     10140009
101500                  XL071-LOC-TYP-CDE = 'DS' OR                     10150009
101600                  XL071-LOC-TYP-CDE = 'CS' OR                     10160009
101700                  XL071-LOC-TYP-CDE = 'RV'                        10170009
101800                  IF (DP020-FK-CONFIRM (DP020-SRC-AID) AND        10180009
101900                      ASC-CONFIRM-NEEDED-YES)                     10190009
102000                      CONTINUE                                    10200009
102100                  ELSE                                            10210009
102200                      PERFORM 2248-VALIDATE-RECEIPT               10220009
102300                  END-IF                                          10230009
102400                                                                  10240009
102500              ELSE                                                10250009
102600                                                                  10260009
102700                  SET PS-ERROR            TO TRUE                 10270009
102800                  SET DP020-MSG-FATAL     TO TRUE                 10280009
102900                  MOVE PC-TSYMSG-00017    TO DP020-MSG-NUMBER     10290009
103000                  MOVE DP015-UNP-NUM-BRT-OFF                      10300009
103100                                          TO ASTRA                10310009
103200                  MOVE DP015-RED          TO ASTRC                10320009
103300                  MOVE DP015-REVERSE      TO ASTRH                10330009
103400                  MOVE -1                 TO ASTRL                10340009
103500                  SET DP030-SET-CURSOR-APPL-1                     10350009
103600                                          TO TRUE                 10360009
103700                  MOVE SPACES         TO ASTRNMO                  10370009
103800                                         ASC-STR-NAME             10380009
103900                                         ASC-STR-NAME-CHAR10-ABBR 10390009
104000              END-IF                                              10400009
104100                                                                  10410009
104200         WHEN XL071-LOC-NOT-FOUND                                 10420009
104300              SET PS-ERROR                TO TRUE                 10430009
104400              SET DP020-MSG-FATAL         TO TRUE                 10440009
104500              MOVE PC-TSYMSG-00017        TO DP020-MSG-NUMBER     10450009
104600              MOVE DP015-UNP-NUM-BRT-OFF  TO ASTRA                10460009
104700              MOVE DP015-RED              TO ASTRC                10470009
104800              MOVE DP015-REVERSE          TO ASTRH                10480009
104900              MOVE -1                     TO ASTRL                10490009
105000              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 10500009
105100              MOVE SPACES             TO ASTRNMO                  10510009
105200                                         ASC-STR-NAME             10520009
105300                                         ASC-STR-NAME-CHAR10-ABBR 10530009
105400                                                                  10540009
105500         WHEN XL071-BAD-DB2-RETURN                                10550009
105600              INITIALIZE PV-CICS-MSG-AREA                         10560009
105700              STRING 'PCKCS116-CALL XLKUT071 - '                  10570009
105800                     'SQLCODE=' XL071-SQLCODE                     10580009
105900                     '  TABLE-' XL071-DB2-TABLE DELIMITED BY SIZE 10590009
106000                                        INTO PV-CICS-MSG-AREA     10600009
106100              MOVE LENGTH OF PV-CICS-MSG-AREA                     10610009
106200                                          TO PV-COMMAREA-LENGTH   10620009
106300              PERFORM 9990-WRITE-CICS                             10630009
106400                                                                  10640009
106500     END-EVALUATE.                                                10650009
106600                                                                  10660009
106700/                                                                 10670009
106800 2242-EDIT-OPERATING-UNIT.                                        10680009
106900                                                                  10690009
107000     IF ASC-OPER-UNT-ID NOT > SPACES                              10700009
107100         SET PS-ERROR            TO TRUE                          10710009
107200         SET DP020-MSG-FATAL     TO TRUE                          10720009
107300         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              10730009
107400         MOVE DP015-UNP-NUM-BRT-OFF                               10740009
107500                                 TO AOPUNITA                      10750009
107600         MOVE DP015-RED          TO AOPUNITC                      10760009
107700         MOVE DP015-REVERSE      TO AOPUNITH                      10770009
107800         MOVE -1                 TO AOPUNITL                      10780009
107900         SET DP030-SET-CURSOR-APPL-1                              10790009
108000                                 TO TRUE                          10800009
108100*        *---------------------------------*                      10810009
108200*        * CLEAN OUT THE OP UNIT NAME, TOO *                      10820009
108300*        *---------------------------------*                      10830009
108400         MOVE SPACES             TO AOPDESCO                      10840009
108500                                    ASC-OP-UNIT-NAME              10850009
108600                                                                  10860009
108700     ELSE                                                         10870009
108800                                                                  10880009
108900         MOVE ASC-OPER-UNT-ID-N      TO DP010I-UNEDITED-FIELD     10890009
109000         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     10900009
109100         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   10910009
109200                                                                  10920009
109300         SET DP010I-NEGATIVE-NOT-ALLOWED                          10930009
109400                                     TO TRUE                      10940009
109500                                                                  10950009
109610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10961046
109620                         USING DP010I-NUMERIC-EDIT-AREA           10962046
109700                                                                  10970009
109800         IF DP010I-NO-ERROR-DETECTED                              10980009
109900             MOVE DP010I-NUMERIC-FIELD                            10990009
110000                                     TO ASC-OPER-UNT-ID-N         11000009
110100                                        PV-SUPPRESS-FOUR          11010009
110200             MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                  11020009
110300             SET NO-ERROR-ON-OP-UNIT-EDIT TO TRUE                 11030009
110400             PERFORM 2245-GET-OP-UNIT-NAME                        11040009
110500             PERFORM 2246-GET-SSCC-18-IND                         11050009
110600         ELSE                                                     11060009
110700             SET PS-ERROR            TO TRUE                      11070009
110800             SET DP020-MSG-FATAL     TO TRUE                      11080009
110900             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          11090009
111000             MOVE DP015-UNP-NUM-BRT-OFF                           11100009
111100                                     TO AOPUNITA                  11110009
111200             MOVE DP015-RED          TO AOPUNITC                  11120009
111300             MOVE DP015-REVERSE      TO AOPUNITH                  11130009
111400             MOVE -1                 TO AOPUNITL                  11140009
111500             SET DP030-SET-CURSOR-APPL-1                          11150009
111600                                     TO TRUE                      11160009
111700*            *---------------------------------*                  11170009
111800*            * CLEAN OUT THE OP UNIT NAME, TOO *                  11180009
111900*            *---------------------------------*                  11190009
112000             MOVE SPACES             TO AOPDESCO                  11200009
112100                                        ASC-OP-UNIT-NAME          11210009
112200         END-IF                                                   11220009
112300     END-IF.                                                      11230009
112400/                                                                 11240009
112500 2243-EDIT-FACILITY.                                              11250009
112600                                                                  11260009
112700     IF ASC-FCLTY-ID NOT > SPACES                                 11270009
112800         SET PS-ERROR            TO TRUE                          11280009
112900         SET DP020-MSG-FATAL     TO TRUE                          11290009
113000         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              11300009
113100         MOVE DP015-UNP-NUM-BRT-OFF                               11310009
113200                                 TO AFACILA                       11320009
113300         MOVE DP015-RED          TO AFACILC                       11330009
113400         MOVE DP015-REVERSE      TO AFACILH                       11340009
113500         MOVE -1                 TO AFACILL                       11350009
113600         SET DP030-SET-CURSOR-APPL-1                              11360009
113700                                 TO TRUE                          11370009
113800                                                                  11380009
113900     ELSE                                                         11390009
114000                                                                  11400009
114100         MOVE ASC-FCLTY-ID-N         TO DP010I-UNEDITED-FIELD     11410009
114200         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     11420009
114300         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   11430009
114400                                                                  11440009
114500         SET DP010I-NEGATIVE-NOT-ALLOWED                          11450009
114600                                     TO TRUE                      11460009
114700                                                                  11470009
114810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11481046
114820                         USING DP010I-NUMERIC-EDIT-AREA           11482046
114900                                                                  11490009
115000         IF DP010I-NO-ERROR-DETECTED                              11500009
115100             MOVE DP010I-NUMERIC-FIELD                            11510009
115200                                     TO ASC-FCLTY-ID-N            11520009
115300                                        PV-SUPPRESS-FOUR          11530009
115400             MOVE PV-SUPPRESS-FOUR   TO AFACILO                   11540009
115500             SET NO-ERROR-ON-FACILITY-EDIT TO TRUE                11550009
115600         ELSE                                                     11560009
115700             SET PS-ERROR            TO TRUE                      11570009
115800             SET DP020-MSG-FATAL     TO TRUE                      11580009
115900             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          11590009
116000             MOVE DP015-UNP-NUM-BRT-OFF                           11600009
116100                                     TO AFACILA                   11610009
116200             MOVE DP015-RED          TO AFACILC                   11620009
116300             MOVE DP015-REVERSE      TO AFACILH                   11630009
116400             MOVE -1                 TO AFACILL                   11640009
116500             SET DP030-SET-CURSOR-APPL-1                          11650009
116600                                     TO TRUE                      11660009
116700         END-IF                                                   11670009
116800                                                                  11680009
116900     END-IF.                                                      11690009
117000/                                                                 11700009
117100*----------------------------------------------------------------*11710009
117200*    CHECK THE PRINTER NUMBER FOR NUMERIC                        *11720009
117300*----------------------------------------------------------------*11730009
117400 2244-EDIT-PRINTER-ID.                                            11740009
117500                                                                  11750009
117600     IF ASC-PRTR-ID NOT > SPACES                                  11760009
117700         SET PS-ERROR            TO TRUE                          11770009
117800         SET DP020-MSG-FATAL     TO TRUE                          11780009
117900         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              11790009
118000         MOVE DP015-UNP-NUM-BRT-OFF                               11800009
118100                                 TO APRTRA                        11810009
118200         MOVE DP015-RED          TO APRTRC                        11820009
118300         MOVE DP015-REVERSE      TO APRTRH                        11830009
118400         MOVE -1                 TO APRTRL                        11840009
118500         SET DP030-SET-CURSOR-APPL-1                              11850009
118600                                 TO TRUE                          11860009
118700*        *-----------------------------------------------*        11870009
118800*        * CLEAN OUT THE PRINTER DESTINATION DESCRIPTION *        11880009
118900*        *-----------------------------------------------*        11890009
119000         MOVE SPACES             TO APRDESCO                      11900009
119100                                    ASC-PRTR-DESC                 11910009
119200                                                                  11920009
119300     ELSE                                                         11930009
119400         MOVE ASC-PRTR-ID            TO DP010I-UNEDITED-FIELD     11940009
119500         MOVE +3                     TO DP010I-MAXIMUM-DIGITS     11950009
119600         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   11960009
119700                                                                  11970009
119800         SET DP010I-NEGATIVE-NOT-ALLOWED                          11980009
119900                                     TO TRUE                      11990009
120000                                                                  12000009
120110         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12011046
120120                         USING DP010I-NUMERIC-EDIT-AREA           12012046
120200                                                                  12020009
120300         IF DP010I-ERROR-DETECTED                                 12030009
120400             SET PS-ERROR            TO TRUE                      12040009
120500             SET DP020-MSG-FATAL     TO TRUE                      12050009
120600             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          12060009
120700             MOVE DP015-UNP-NUM-BRT-OFF                           12070009
120800                                     TO APRTRA                    12080009
120900             MOVE DP015-RED          TO APRTRC                    12090009
121000             MOVE DP015-REVERSE      TO APRTRH                    12100009
121100             MOVE -1                 TO APRTRL                    12110009
121200             SET DP030-SET-CURSOR-APPL-1                          12120009
121300                                     TO TRUE                      12130009
121400*            *-----------------------------------------------*    12140009
121500*            * CLEAN OUT THE PRINTER DESTINATION DESCRIPTION *    12150009
121600*            *-----------------------------------------------*    12160009
121700             MOVE SPACES             TO APRDESCO                  12170009
121800         ELSE                                                     12180009
121900             SET NO-ERROR-ON-PRINTER-EDIT TO TRUE                 12190009
122000             MOVE DP010I-NUMERIC-FIELD                            12200009
122100                                     TO ASC-PRTR-ID-N             12210009
122200                                        PV-SUPPRESS-THREE         12220009
122300             MOVE PV-SUPPRESS-THREE  TO APRTRO                    12230009
122400                                                                  12240009
122500         END-IF                                                   12250009
122600     END-IF.                                                      12260009
122700                                                                  12270009
122800/                                                                 12280009
122900 2245-GET-OP-UNIT-NAME.                                           12290009
123000                                                                  12300009
123100     MOVE SPACES            TO ASC-OP-UNIT-NAME                   12310009
123200     MOVE ASC-FCLTY-ID-N    TO PC-FCLTY-ID                        12320009
123300                               PC140-CRA-FACLTY-ID                12330009
123400     MOVE ASC-OPER-UNT-ID-N TO PC-OPER-UNT-ID                     12340009
123500                               DK-OPER-UNT-ID                     12350009
123600                                                                  12360009
123700     PERFORM                                                      12370009
123800         WITH TEST AFTER                                          12380009
123900         VARYING PV-RETRY-COUNTER                                 12390009
124000         FROM 1 BY 1                                              12400009
124100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12410009
124200                   OR (SQLCODE = +0)                              12420009
124300                   OR (SQLCODE = +100))                           12430009
124400                                                                  12440009
124500         EXEC SQL                                                 12450009
124600            SELECT  LOC_NM                                        12460009
124700              INTO :XLT00010-LOC-NM                               12470009
124800              FROM  XLT_LOC                                       12480009
124900             WHERE  LOC_NBR     = :PC-OPER-UNT-ID                 12490009
125000         END-EXEC                                                 12500009
125100                                                                  12510009
125200         EVALUATE TRUE                                            12520009
125300             WHEN SQLCODE = +0                                    12530009
125400                 MOVE XLT00010-LOC-NM  TO ASC-OP-UNIT-NAME        12540009
125500                                          AOPDESCO                12550009
125600             WHEN SQLCODE = +100                                  12560009
125700             WHEN SQLCODE = -811                                  12570009
125800             WHEN SQLCODE = -904                                  12580009
125900             WHEN SQLCODE = -913                                  12590009
126000                 CONTINUE                                         12600009
126100             WHEN SQLWARN0 NOT = SPACES                           12610009
126200             WHEN SQLCODE < +0                                    12620009
126300             WHEN SQLCODE > +0                                    12630009
126400                 MOVE '2245-GET-OP-UNIT-NAME'                     12640009
126500                                 TO DP013-PARAGRAPH               12650009
126600                 MOVE 'SELECT STORE NUMBER'                       12660009
126700                                 TO DP013-MESSAGE-TEXT (1)        12670009
126800                 MOVE SQLCA      TO DP013-SQLCA                   12680009
126900                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      12690009
127000                 SET DP013-DB2-ABEND                              12700009
127100                                 TO TRUE                          12710009
127200                 SET DP013-XCTL-DISPLAY-RESTART                   12720009
127300                                 TO TRUE                          12730009
127400                 PERFORM DP013-0000-PROCESS-ABEND                 12740009
127500         END-EVALUATE                                             12750009
127600     END-PERFORM.                                                 12760009
127700                                                                  12770009
127800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12780009
127900         MOVE '3010-VALIDATE-FCLTY-ID'                            12790009
128000                                 TO DP013-PARAGRAPH               12800009
128100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     12810009
128200                                 TO DP013-MESSAGE-TEXT (1)        12820009
128300         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        12830009
128400         MOVE SQLCA              TO DP013-SQLCA                   12840009
128500         MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)      12850009
128600         SET DP013-DB2-ABEND     TO TRUE                          12860009
128700         SET DP013-XCTL-DISPLAY-RESTART                           12870009
128800                                 TO TRUE                          12880009
128900         PERFORM DP013-0000-PROCESS-ABEND                         12890009
129000     END-IF.                                                      12900009
129100                                                                  12910009
129200                                                                  12920009
129300*----------------------------------------------------------------*12930009
129400*    GET SSCC-18-IND (TO SEE IF CREATE 20 OR 22 DIGIT BARCODES)  *12940009
129500*    ALSO USED TO CHECK IF VALUE ENTERED IS A VALID DC OR EFC.   *12950009
129600*----------------------------------------------------------------*12960009
129700 2246-GET-SSCC-18-IND.                                            12970009
129800                                                                  12980009
129900     EXEC SQL                                                     12990009
130000          SELECT  SSCC_18_IND                                     13000009
130100            INTO :COCNTL-SSCC-18-IND                              13010009
130200            FROM  TCOCNTL                                         13020009
130300           WHERE  OPER_UNT_ID = :PC-OPER-UNT-ID                   13030009
130400     END-EXEC.                                                    13040009
130500                                                                  13050009
130600     EVALUATE TRUE                                                13060009
130700         WHEN SQLCODE = +0                                        13070009
130800              MOVE COCNTL-SSCC-18-IND TO ASC-SSCC-18-IND          13080009
130900         WHEN SQLCODE = +100                                      13090009
131000              SET PS-ERROR                                        13100009
131100                  DP020-MSG-FATAL     TO TRUE                     13110009
131200              MOVE PC-TSYMSG-02319    TO DP020-MSG-NUMBER         13120009
131300              MOVE DP015-UNP-NUM-BRT-OFF                          13130009
131400                                      TO AOPUNITA                 13140009
131500              MOVE DP015-RED          TO AOPUNITC                 13150009
131600              MOVE DP015-REVERSE      TO AOPUNITH                 13160009
131700              MOVE -1                 TO AOPUNITL                 13170009
131800              SET DP030-SET-CURSOR-APPL-1                         13180009
131900                                      TO TRUE                     13190009
132000         WHEN SQLWARN0 NOT = SPACES                               13200009
132100         WHEN SQLCODE < +0                                        13210009
132200         WHEN SQLCODE > +0                                        13220009
132300              MOVE '2246-GET-SSCC-18-IND'                         13230009
132400                                 TO DP013-PARAGRAPH               13240009
132500              MOVE 'CHECK IF OPER UNIT IS FOR DC'                 13250009
132600                                 TO DP013-MESSAGE-TEXT (1)        13260009
132700              MOVE SQLCA      TO DP013-SQLCA                      13270009
132800              MOVE 'TCOCNTL'  TO DP013-DB2-TABLE-NAME (1)         13280009
132900              SET DP013-DB2-ABEND                                 13290009
133000                              TO TRUE                             13300009
133100              SET DP013-XCTL-DISPLAY-RESTART                      13310009
133200                              TO TRUE                             13320009
133300              PERFORM DP013-0000-PROCESS-ABEND                    13330009
133400     END-EVALUATE.                                                13340009
133500                                                                  13350009
133600                                                                  13360009
133700*----------------------------------------------------------------*13370009
133800*    CHECK THE PRINTER ID FOR NUMERIC                            *13380009
133900*----------------------------------------------------------------*13390009
134000 2248-VALIDATE-RECEIPT.                                           13400009
134100                                                                  13410009
134200     MOVE  PV-CURRENT-CCYY      TO  PV-HOLD-CCYY.                 13420009
134300     MOVE  PV-CURRENT-MM        TO  PV-HOLD-MM.                   13430009
134400     MOVE  PV-CURRENT-DD        TO  PV-HOLD-DD.                   13440009
134500                                                                  13450009
134600     MOVE  XL071-ASGMT-EFF-BEG-DTE     TO  PV-DC1-DATE.           13460009
134700     MOVE  PV-DC1-CCYY                 TO  PV-HDC1-CCYY.          13470009
134800     MOVE  PV-DC1-MM                   TO  PV-HDC1-MM.            13480009
134900     MOVE  PV-DC1-DD                   TO  PV-HDC1-DD.            13490009
135000                                                                  13500009
135100     IF (XL071-CLO-DTE           < PV-CURRENT-DATE)  OR           13510009
135200        (XL071-ASGMT-EFF-BEG-DTE = PC-NINES)                      13520009
135300             SET ERROR-ON-RECEIPT-EDIT   TO TRUE                  13530009
135400             SET PS-ERROR                TO TRUE                  13540009
135500             SET DP020-MSG-WARNING       TO TRUE                  13550009
135600             MOVE PC-TSYMSG-01945        TO DP020-MSG-NUMBER      13560009
135700             MOVE DP015-UNP-NUM-BRT-OFF  TO ASTRA                 13570009
135800             MOVE DP015-RED              TO ASTRC                 13580009
135900             MOVE DP015-REVERSE          TO ASTRH                 13590009
136000             MOVE -1                     TO ASTRL                 13600009
136100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13610009
136200             SET ASC-CONFIRM-NEEDED-YES  TO TRUE                  13620009
136300     ELSE                                                         13630009
136400     IF  PV-DC1-HOLD                  <= PV-DATE-HOLD     OR      13640009
136500         XL071-ASGMT-EFF-BEG-DTE      >= PV-CURRENT-DATE          13650009
136600             NEXT SENTENCE                                        13660009
136700     ELSE                                                         13670009
136800         SET PS-ERROR                    TO TRUE                  13680009
136900         SET DP020-MSG-WARNING           TO TRUE                  13690009
137000         MOVE PC-TSYMSG-01945            TO DP020-MSG-NUMBER      13700009
137100         MOVE DP015-UNP-NUM-BRT-OFF      TO ASTRA                 13710009
137200         MOVE DP015-RED                  TO ASTRC                 13720009
137300         MOVE DP015-REVERSE              TO ASTRH                 13730009
137400         MOVE -1                         TO ASTRL                 13740009
137500         SET DP030-SET-CURSOR-APPL-1     TO TRUE                  13750009
137600         SET ASC-CONFIRM-NEEDED-YES      TO TRUE                  13760009
137700     END-IF.                                                      13770009
137800                                                                  13780009
137900                                                                  13790009
138000/                                                                 13800009
138100 2250-VERIFY-STORE-NBR.                                           13810009
138200                                                                  13820009
138300     MOVE ASC-STR-NBR TO  PV-FCLTY-ID                             13830009
138400     PERFORM                                                      13840009
138500         WITH TEST AFTER                                          13850009
138600         VARYING PV-RETRY-COUNTER                                 13860009
138700         FROM 1 BY 1                                              13870009
138800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13880009
138900                   OR (SQLCODE = ZERO)                            13890009
139000                   OR (SQLCODE = +100))                           13900009
139100                                                                  13910009
139200         EXEC SQL                                                 13920009
139300            SELECT  LOC_NM                                        13930009
139400              INTO :XLT00010-LOC-NM                               13940009
139500              FROM  XLT_LOC                                       13950009
139600             WHERE  LOC_NBR     = :PV-FCLTY-ID                    13960009
139700         END-EXEC                                                 13970009
139800                                                                  13980009
139900         EVALUATE TRUE                                            13990009
140000             WHEN SQLCODE = ZERO                                  14000009
140100             WHEN SQLCODE = +100                                  14010009
140200             WHEN SQLCODE = -904                                  14020009
140300             WHEN SQLCODE = -913                                  14030009
140400                 CONTINUE                                         14040009
140500             WHEN SQLWARN0 NOT = SPACES                           14050009
140600             WHEN SQLCODE < ZERO                                  14060009
140700             WHEN SQLCODE > ZERO                                  14070009
140800                 MOVE '2250-VERIFY-STORE-NBR'                     14080009
140900                                 TO DP013-PARAGRAPH               14090009
141000                 MOVE 'SELECT STORE NAME'                         14100009
141100                                 TO DP013-MESSAGE-TEXT (1)        14110009
141200                 MOVE SQLCA      TO DP013-SQLCA                   14120009
141300                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      14130009
141400                 SET DP013-DB2-ABEND                              14140009
141500                                 TO TRUE                          14150009
141600                 SET DP013-XCTL-DISPLAY-RESTART                   14160009
141700                                 TO TRUE                          14170009
141800                 PERFORM DP013-0000-PROCESS-ABEND                 14180009
141900         END-EVALUATE                                             14190009
142000     END-PERFORM.                                                 14200009
142100                                                                  14210009
142200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14220009
142300         MOVE '2250-VERIFY-STORE-NBR'                             14230009
142400                                 TO DP013-PARAGRAPH               14240009
142500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14250009
142600                                 TO DP013-MESSAGE-TEXT (1)        14260009
142700         MOVE 'STORE NUMBER AND NAME'                             14270009
142800                                 TO DP013-MESSAGE-TEXT (2)        14280009
142900         MOVE SQLCA              TO DP013-SQLCA                   14290009
143000         MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)      14300009
143100         SET DP013-DB2-ABEND     TO TRUE                          14310009
143200         SET DP013-XCTL-DISPLAY-RESTART                           14320009
143300                                 TO TRUE                          14330009
143400         PERFORM DP013-0000-PROCESS-ABEND                         14340009
143500     END-IF.                                                      14350009
143600                                                                  14360009
143700                                                                  14370009
143800*----------------------------------------------------------------*14380009
143900*   2260-VALIDATE-PRINTER                                        *14390009
144000* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *14400009
144100*----------------------------------------------------------------*14410009
144200 2260-VALIDATE-PRINTER.                                           14420009
144300                                                                  14430009
144400     MOVE ASC-PRTR-ID-N           TO DP072-PRINTER-ID.            14440009
144500     MOVE PC-CURRENT-PROGRAM-NAME TO DP072-RPT-PGM-NME.           14450009
144600     MOVE PC-01                   TO DP072-RPT-PGM-TYP-ID.        14460009
144700     MOVE ASC-OPER-UNT-ID-N       TO DP072-ORIGIN-OPER-UNT-ID     14470009
144800                                     DP072-OPER-UNT-ID.           14480009
144900     MOVE ASC-FCLTY-ID-N          TO DP072-ORIGIN-FCLTY-ID        14490009
145000                                     DP072-FCLTY-ID.              14500009
145100                                                                  14510009
145200     SET DP072-VALIDATE           TO TRUE.                        14520009
145300                                                                  14530009
145400     EXEC CICS                                                    14540009
145500          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  14550009
145600               COMMAREA (DP072-COMM-AREA)                         14560009
145700               RESP     (PV-CICS-RESPONSE)                        14570009
145800     END-EXEC.                                                    14580009
145900                                                                  14590009
146000     EVALUATE TRUE                                                14600009
146100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14610009
146200              CONTINUE                                            14620009
146300         WHEN OTHER                                               14630009
146400              SET PS-ERROR                TO TRUE                 14640009
146500              SET DP020-MSG-FATAL         TO TRUE                 14650009
146600              MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER     14660009
146700              MOVE DP015-UNP-NUM-BRT-OFF  TO APRTRA               14670009
146800              MOVE DP015-RED              TO APRTRC               14680009
146900              MOVE DP015-REVERSE          TO APRTRH               14690009
147000              MOVE -1                     TO APRTRL               14700009
147100              MOVE SPACES                 TO ASC-PRTR-DESC        14710009
147200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 14720009
147300              PERFORM DP013-0000-PROCESS-ABEND                    14730009
147400     END-EVALUATE.                                                14740009
147500                                                                  14750009
147600 EJECT                                                            14760009
147700*----------------------------------------------------------------*14770009
147800*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *14780009
147900*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *14790009
148000*  CAN BE PRINTED ON THIS PRINTER.                               *14800009
148100*----------------------------------------------------------------*14810009
148200 2265-VALIDATE-PRINTER-ID.                                        14820009
148300                                                                  14830009
148400     IF  DP072-PRTR-PRTR-TRK-STAT-CDE =  PC-A                     14840009
148500         CONTINUE                                                 14850009
148600     ELSE                                                         14860009
148700         SET  PS-ERROR                TO TRUE                     14870009
148800         SET  DP020-MSG-FATAL         TO TRUE                     14880009
148900         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         14890009
149000         MOVE DP015-UNP-NUM-BRT-OFF   TO APRTRA                   14900009
149100         MOVE DP015-RED               TO APRTRC                   14910009
149200         MOVE DP015-REVERSE           TO APRTRH                   14920009
149300         MOVE -1                      TO APRTRL                   14930009
149400         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     14940009
149500     END-IF.                                                      14950009
149600                                                                  14960009
149700 EJECT                                                            14970009
149800*----------------------------------------------------------------*14980009
149900*    EDIT THE SEASONAL SET YEAR AND SHORT NAME COMBINATION       *14990009
150000*----------------------------------------------------------------*15000009
150100 2275-EDIT-SEASONAL-SET.                                          15010009
150200                                                                  15020009
150300     MOVE ASC-SEASONAL-SET-YEAR       TO SEASET-SEASET-YR.        15030009
150400     MOVE ASC-SEASONAL-SET-SHORT-NAME TO SEASET-SEASET-SHRT-NM.   15040009
150500                                                                  15050009
150600     PERFORM                                                      15060009
150700         WITH TEST AFTER                                          15070009
150800         VARYING PV-RETRY-COUNTER                                 15080009
150900         FROM 1 BY 1                                              15090009
151000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15100009
151100                   OR (SQLCODE = ZERO)                            15110009
151200                   OR (SQLCODE = +100))                           15120009
151300                                                                  15130009
151400         EXEC SQL                                                 15140009
151500             SELECT                                               15150009
151600                    SEASET_STAT_CDE                               15160009
151700                  , STR_RLSE_END_DTE                              15170009
151800                  , DIVERT_PFX_NBR                                15180009
151900*                 , CURRENT DATE                                  15190009
152000             INTO                                                 15200009
152100                   :SEASET-SEASET-STAT-CDE                        15210009
152200                  ,:SEASET-STR-RLSE-END-DTE                       15220009
152300                  ,:SEASET-DIVERT-PFX-NBR                         15230009
152400*                 ,:PV-CURRENT-DATE                               15240009
152500             FROM   TSEASET                                       15250009
152600             WHERE  SEASET_YR      = :SEASET-SEASET-YR            15260009
152700             AND    SEASET_SHRT_NM = :SEASET-SEASET-SHRT-NM       15270009
152800         END-EXEC                                                 15280009
152900                                                                  15290009
153000         EVALUATE TRUE                                            15300009
153100             WHEN SQLCODE = ZERO                                  15310009
153200             WHEN SQLCODE = +100                                  15320009
153300                 PERFORM 2280-CHECK-SEASET-RESULTS                15330009
153400             WHEN SQLCODE = -904                                  15340009
153500             WHEN SQLCODE = -913                                  15350009
153600                 CONTINUE                                         15360009
153700             WHEN SQLWARN0 NOT = SPACES                           15370009
153800             WHEN SQLCODE < ZERO                                  15380009
153900             WHEN SQLCODE > ZERO                                  15390009
154000                 MOVE '2275-EDIT-SEASONAL-SET'                    15400009
154100                                 TO DP013-PARAGRAPH               15410009
154200                 MOVE 'SELECT SEASONAL SET'                       15420009
154300                                 TO DP013-MESSAGE-TEXT (1)        15430009
154400                 MOVE SQLCA      TO DP013-SQLCA                   15440009
154500                 MOVE 'TSEASET'  TO DP013-DB2-TABLE-NAME (1)      15450009
154600                 SET DP013-DB2-ABEND                              15460009
154700                                 TO TRUE                          15470009
154800                 SET DP013-XCTL-DISPLAY-RESTART                   15480009
154900                                 TO TRUE                          15490009
155000                 PERFORM DP013-0000-PROCESS-ABEND                 15500009
155100         END-EVALUATE                                             15510009
155200     END-PERFORM.                                                 15520009
155300                                                                  15530009
155400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15540009
155500         MOVE '2275-EDIT-SEASONAL-SET'                            15550009
155600                                 TO DP013-PARAGRAPH               15560009
155700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     15570009
155800                                 TO DP013-MESSAGE-TEXT (1)        15580009
155900         MOVE 'SEASONAL SET'                                      15590009
156000                                 TO DP013-MESSAGE-TEXT (2)        15600009
156100         MOVE SQLCA              TO DP013-SQLCA                   15610009
156200         MOVE 'TSEASET'          TO DP013-DB2-TABLE-NAME (1)      15620009
156300         SET DP013-DB2-ABEND     TO TRUE                          15630009
156400         SET DP013-XCTL-DISPLAY-RESTART                           15640009
156500                                 TO TRUE                          15650009
156600         PERFORM DP013-0000-PROCESS-ABEND                         15660009
156700     END-IF.                                                      15670009
156800                                                                  15680009
156900 EJECT                                                            15690009
157000*----------------------------------------------------------------*15700009
157100*    CHECK THE SEASONAL SET COMBINATION FOR A NOT FOUND           15710009
157200*    CONDITION, INACTIVE STATUS CODE, AND A PAST RELEASE DATE     15720009
157300*----------------------------------------------------------------*15730009
157400 2280-CHECK-SEASET-RESULTS.                                       15740009
157500                                                                  15750009
157600     IF SQLCODE = +100                                            15760009
157700         SET ERROR-ON-SEASET-EDIT    TO TRUE                      15770009
157800         SET PS-ERROR                TO TRUE                      15780009
157900         SET DP020-MSG-FATAL         TO TRUE                      15790009
158000         MOVE PC-TSYMSG-02053        TO DP020-MSG-NUMBER          15800009
158100         MOVE DP015-UNP-ALP-BRT-OFF  TO SSYRA                     15810009
158200                                        SSNMA                     15820009
158300         MOVE DP015-RED              TO SSYRC                     15830009
158400                                        SSNMC                     15840009
158500         MOVE DP015-REVERSE          TO SSYRH                     15850009
158600                                        SSNMH                     15860009
158700         MOVE -1                     TO SSYRL                     15870009
158800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15880009
158900     END-IF.                                                      15890009
159000                                                                  15900009
159100     IF SQLCODE = ZERO                                            15910009
159200         IF SEASET-SEASET-STAT-CDE NOT = PC-A                     15920009
159300             SET ERROR-ON-SEASET-EDIT    TO TRUE                  15930009
159400             SET PS-ERROR                TO TRUE                  15940009
159500             SET DP020-MSG-FATAL         TO TRUE                  15950009
159600             MOVE PC-TSYMSG-02052        TO DP020-MSG-NUMBER      15960009
159700             MOVE DP015-UNP-ALP-BRT-OFF  TO SSYRA                 15970009
159800                                            SSNMA                 15980009
159900             MOVE DP015-RED              TO SSYRC                 15990009
160000                                            SSNMC                 16000009
160100             MOVE DP015-REVERSE          TO SSYRH                 16010009
160200                                            SSNMH                 16020009
160300             MOVE -1                     TO SSYRL                 16030009
160400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16040009
160500         ELSE                                                     16050009
160600             IF PV-CURRENT-DATE > SEASET-STR-RLSE-END-DTE         16060009
160700                 SET ERROR-ON-SEASET-EDIT    TO TRUE              16070009
160800                 SET PS-ERROR                TO TRUE              16080009
160900                 SET DP020-MSG-FATAL         TO TRUE              16090009
161000                 MOVE PC-TSYMSG-02051        TO DP020-MSG-NUMBER  16100009
161100                 MOVE DP015-UNP-ALP-BRT-OFF  TO SSYRA             16110009
161200                                                SSNMA             16120009
161300                 MOVE DP015-RED              TO SSYRC             16130009
161400                                                SSNMC             16140009
161500                 MOVE DP015-REVERSE          TO SSYRH             16150009
161600                                                SSNMH             16160009
161700                 MOVE -1                     TO SSYRL             16170009
161800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              16180009
161900             ELSE                                                 16190009
162000                 SET NO-ERROR-ON-SEASET-EDIT TO TRUE              16200009
162100                                                                  16210009
162200*DMH-11/17/04 - BEGIN                                             16220009
162300                MOVE SEASET-DIVERT-PFX-NBR TO PV-DIVERT-WORK      16230009
162400                IF  SEASET-DIVERT-PFX-NBR  >  9                   16240009
162500                    MOVE PV-DIVERT-POS-3   TO  ASC-DIVERT-PFX-NBR 16250009
162600                ELSE                                              16260009
162700                    MOVE PV-DIVERT-POS-4   TO  ASC-DIVERT-PFX-NBR 16270009
162800                END-IF                                            16280009
162900*DMH-11/17/04   MOVE SEASET-DIVERT-PFX-NBR TO ASC-DIVERT-PFX-NBR  16290009
163000*DMH-11/17/04 - END                                               16300009
163100                                                                  16310009
163200             END-IF                                               16320009
163300         END-IF                                                   16330009
163400     END-IF.                                                      16340009
163500                                                                  16350009
163501                                                                  16350116
163502*----------------------------------------------------------------*16350216
163503*    CHECK IF SML ORDER IS VALID - ONLY NEEDED WHEN ALL IS        16350316
163504*    SELECTED                                                     16350416
163505* DMH - 2/24/16                                                   16350516
163506*----------------------------------------------------------------*16350616
163507 2282-VALIDATE-SML-ORDER.                                         16350716
163508     SET ERROR-ON-SML-ORDER  TO  TRUE.                            16350816
163509                                                                  16350916
163510     IF  ASC-VALID-SML-ORD-PARM                                   16351016
163511         SET  NO-ERROR-ON-SML-ORDER      TO  TRUE                 16351116
163512     ELSE                                                         16351216
163513         SET ERROR-ON-SML-ORDER          TO TRUE                  16351316
163514         SET PS-ERROR                    TO TRUE                  16351416
163515         SET DP020-MSG-FATAL             TO TRUE                  16351516
163516         MOVE PC-TSYMSG-00005            TO DP020-MSG-NUMBER      16351616
163517         MOVE DP015-UNP-ALP-BRT-OFF      TO LBLORDA               16351716
163518         MOVE DP015-RED                  TO LBLORDC               16351816
163519         MOVE DP015-REVERSE              TO LBLORDH               16351916
163520         MOVE -1                         TO LBLORDL               16352016
163521         SET DP030-SET-CURSOR-APPL-1     TO TRUE                  16352116
163522     END-IF.                                                      16352216
163523                                                                  16352316
163524     IF  NO-ERROR-ON-SML-ORDER  AND                               16352416
163525         ASC-ALL-STORES         AND                               16352516
163526         ASC-SML-P2L-ORDER                                        16352616
163538         PERFORM 2283-CHECK-P2LSTORORD-PARM                       16353816
163539     END-IF.                                                      16353916
163540                                                                  16354016
163541     IF  NO-ERROR-ON-SML-ORDER  AND                               16354144
163542         ASC-ALL-STORES         AND                               16354245
163543         ASC-SML-P2L-SEPHORA-ORD                                  16354344
163544         PERFORM 2285-CHECK-P2LSEPHORD-PARM                       16354444
163545     END-IF.                                                      16354544
163546                                                                  16354644
163547                                                                  16354716
163548*----------------------------------------------------------------*16354816
163549*    IF SML ORDER SELECTED IS P-PACK-TO-LIGHT ORDER AND ALL       16354916
163550*    STORES HAVE BEEN REQUESTED, CHECK TO MAKE SURE THE DC IS     16355016
163551*    SETUP TO PRINT IN P2L STORE ORDER.                           16355116
163552* DMH - 2/24/16                                                   16355216
163553*----------------------------------------------------------------*16355316
163554 2283-CHECK-P2LSTORORD-PARM.                                      16355416
163555                                                                  16355516
163556     MOVE  ASC-OPER-UNT-ID-N TO WST00010-ATTR-ELEM-NBR.           16355616
163557                                                                  16355716
163558     EXEC SQL                                                     16355816
163559          SELECT C.ATTR_ELEM_NBR  AS DC_NBR                       16355916
163560            INTO :WST00010-ATTR-ELEM-NBR                          16356016
163561            FROM                                                  16356116
163562                 WST_INTGRTN_TYP A                                16356216
163563               , WST_ATTR_DEFN   B                                16356316
163564               , WST_ATTR_ELEM   C                                16356416
163565               , WST_ATTR_ELEM   D                                16356516
163566               , WST_ATTR_ELEM   E                                16356616
163567               , WST_ATTR_ELEM   F                                16356716
163568               , WST_ATTR_ELEM   G                                16356816
163569               , WST_ATTR_ELEM   H                                16356916
163570           WHERE                                                  16357016
163571                 A.INTGRTN_TYP_CDE   = 'P2LSTORORD'               16357116
163572             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          16357216
163573             AND B.ATTR_DEFN_SEQ_NBR = 1                          16357316
163574             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          16357416
163575             AND C.ATTR_DEFN_SEQ_NBR = 1                          16357516
163576             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          16357616
163577             AND D.ATTR_DEFN_SEQ_NBR = 2                          16357716
163578             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          16357816
163579             AND E.ATTR_DEFN_SEQ_NBR = 3                          16357916
163580             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          16358016
163581             AND F.ATTR_DEFN_SEQ_NBR = 4                          16358116
163582             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          16358216
163583             AND G.ATTR_DEFN_SEQ_NBR = 5                          16358316
163584             AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE          16358416
163585             AND H.ATTR_DEFN_SEQ_NBR = 6                          16358516
163586             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        16358616
163587             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        16358716
163588             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        16358816
163589             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        16358916
163590             AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR        16359016
163591             AND C.ATTR_ELEM_NBR     = :WST00010-ATTR-ELEM-NBR    16359116
163592             AND D.ATTR_ELEM_TXT     = 'AC'                       16359216
163593             AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          16359316
163594             AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP          16359416
163595       FETCH FIRST 1 ROW ONLY                                     16359516
163596       WITH UR                                                    16359616
163626     END-EXEC.                                                    16362616
163627                                                                  16362716
163628     EVALUATE TRUE                                                16362816
163629         WHEN SQLCODE = ZERO                                      16362916
163630         WHEN SQLCODE = -811                                      16363016
163631              SET  NO-ERROR-ON-SML-ORDER  TO  TRUE                16363116
163632         WHEN SQLCODE = +100                                      16363216
163633              SET ERROR-ON-SML-ORDER      TO TRUE                 16363316
163634              SET PS-ERROR                TO TRUE                 16363416
163635              SET DP020-MSG-FATAL         TO TRUE                 16363516
163636              MOVE PC-TSYMSG-03775        TO DP020-MSG-NUMBER     16363616
163637              MOVE DP015-UNP-ALP-BRT-OFF  TO LBLORDA              16363716
163638              MOVE DP015-RED              TO LBLORDC              16363816
163639              MOVE DP015-REVERSE          TO LBLORDH              16363916
163640              MOVE -1                     TO LBLORDL              16364016
163641              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 16364116
163643         WHEN SQLWARN0 NOT = SPACES                               16364316
163644             WHEN SQLCODE < ZERO                                  16364416
163645             WHEN SQLCODE > ZERO                                  16364516
163646                 MOVE '2283-CHECK-P2LSTORORD-PARM'                16364616
163647                                 TO DP013-PARAGRAPH               16364716
163648                 MOVE 'CHECK IF DC SETUP FOR P2L STORE ORDER'     16364816
163649                                 TO DP013-MESSAGE-TEXT (1)        16364916
163650                 MOVE SQLCA      TO DP013-SQLCA                   16365016
163651                 MOVE 'WST00008' TO DP013-DB2-TABLE-NAME (1)      16365116
163652                 MOVE 'WST00009' TO DP013-DB2-TABLE-NAME (2)      16365216
163653                 MOVE 'WST00010' TO DP013-DB2-TABLE-NAME (3)      16365316
163654                 SET DP013-DB2-ABEND                              16365416
163655                                 TO TRUE                          16365516
163656                 SET DP013-XCTL-DISPLAY-RESTART                   16365616
163657                                 TO TRUE                          16365716
163658                 PERFORM DP013-0000-PROCESS-ABEND                 16365816
163659         END-EVALUATE.                                            16365916
163660                                                                  16366016
163661                                                                  16366116
163662*----------------------------------------------------------------*16366216
163663*    CHECK IF DOOR ON LABEL CODE IS VALID                         16366316
163664* DMH - 2/24/16                                                   16366416
163665*----------------------------------------------------------------*16366516
163666 2284-VALIDATE-DOOR-ON-LABEL.                                     16366616
163667     SET ERROR-ON-DOOR-ON-LABEL  TO  TRUE.                        16366716
163668                                                                  16366816
163669     IF  ASC-VALID-DOOR-PARM                                      16366916
163670         SET  NO-ERROR-ON-DOOR-ON-LABEL  TO  TRUE                 16367016
163671     ELSE                                                         16367116
163672         SET ERROR-ON-DOOR-ON-LABEL      TO TRUE                  16367216
163673         SET PS-ERROR                    TO TRUE                  16367316
163674         SET DP020-MSG-FATAL             TO TRUE                  16367416
163675         MOVE PC-TSYMSG-00005            TO DP020-MSG-NUMBER      16367516
163676         MOVE DP015-UNP-ALP-BRT-OFF      TO SHDRA                 16367616
163677         MOVE DP015-RED                  TO SHDRC                 16367716
163678         MOVE DP015-REVERSE              TO SHDRH                 16367816
163679         MOVE -1                         TO SHDRL                 16367916
163680         SET DP030-SET-CURSOR-APPL-1     TO TRUE                  16368016
163681     END-IF.                                                      16368116
163682                                                                  16368216
163690                                                                  16369016
163691*----------------------------------------------------------------*16369144
163692*    IF SML ORDER SELECTED IS A-P2L SEPHORA STORE ORDER           16369244
163693*    CHECK TO MAKE SURE THE DC IS SET UP TO PRINT IN SEPHORA      16369344
163694*    STORE ORDER.                                                 16369444
163696*----------------------------------------------------------------*16369644
163697 2285-CHECK-P2LSEPHORD-PARM.                                      16369744
163698                                                                  16369844
163699     MOVE  ASC-OPER-UNT-ID-N TO WST00010-ATTR-ELEM-NBR.           16369944
163700                                                                  16370044
163701     EXEC SQL                                                     16370144
163702          SELECT C.ATTR_ELEM_NBR  AS DC_NBR                       16370244
163703            INTO :WST00010-ATTR-ELEM-NBR                          16370344
163704            FROM                                                  16370444
163705                 WST_INTGRTN_TYP A                                16370544
163706               , WST_ATTR_DEFN   B                                16370644
163707               , WST_ATTR_ELEM   C                                16370744
163708               , WST_ATTR_ELEM   D                                16370844
163709               , WST_ATTR_ELEM   E                                16370944
163710               , WST_ATTR_ELEM   F                                16371044
163711               , WST_ATTR_ELEM   G                                16371144
163712               , WST_ATTR_ELEM   H                                16371244
163713           WHERE                                                  16371344
163714                 A.INTGRTN_TYP_CDE   = 'P2LSEPHORD'               16371444
163715             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          16371544
163716             AND B.ATTR_DEFN_SEQ_NBR = 1                          16371644
163717             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          16371744
163718             AND C.ATTR_DEFN_SEQ_NBR = 1                          16371844
163719             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          16371944
163720             AND D.ATTR_DEFN_SEQ_NBR = 2                          16372044
163721             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          16372144
163722             AND E.ATTR_DEFN_SEQ_NBR = 3                          16372244
163723             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          16372344
163724             AND F.ATTR_DEFN_SEQ_NBR = 4                          16372444
163725             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          16372544
163726             AND G.ATTR_DEFN_SEQ_NBR = 5                          16372644
163727             AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE          16372744
163728             AND H.ATTR_DEFN_SEQ_NBR = 6                          16372844
163729             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        16372944
163730             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        16373044
163731             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        16373144
163732             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        16373244
163733             AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR        16373344
163734             AND C.ATTR_ELEM_NBR     = :WST00010-ATTR-ELEM-NBR    16373444
163735             AND D.ATTR_ELEM_TXT     = 'AC'                       16373544
163736             AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          16373644
163737             AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP          16373744
163738       FETCH FIRST 1 ROW ONLY                                     16373844
163739       WITH UR                                                    16373944
163740     END-EXEC.                                                    16374044
163741                                                                  16374144
163742     EVALUATE TRUE                                                16374244
163743         WHEN SQLCODE = ZERO                                      16374344
163744         WHEN SQLCODE = -811                                      16374444
163745              SET  NO-ERROR-ON-SML-ORDER  TO  TRUE                16374544
163746         WHEN SQLCODE = +100                                      16374644
163747              SET ERROR-ON-SML-ORDER      TO TRUE                 16374744
163748              SET PS-ERROR                TO TRUE                 16374844
163749              SET DP020-MSG-FATAL         TO TRUE                 16374944
163750              MOVE PC-TSYMSG-03816        TO DP020-MSG-NUMBER     16375044
163751              MOVE DP015-UNP-ALP-BRT-OFF  TO LBLORDA              16375144
163752              MOVE DP015-RED              TO LBLORDC              16375244
163753              MOVE DP015-REVERSE          TO LBLORDH              16375344
163754              MOVE -1                     TO LBLORDL              16375444
163755              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 16375544
163756         WHEN SQLWARN0 NOT = SPACES                               16375644
163757             WHEN SQLCODE < ZERO                                  16375744
163758             WHEN SQLCODE > ZERO                                  16375844
163759                 MOVE '2285-CHECK-P2LSEPHORD-PARM'                16375944
163760                                 TO DP013-PARAGRAPH               16376044
163761                 MOVE 'CHECK IF DC SETUP P2L SEPHORA STR ORD'     16376144
163762                                 TO DP013-MESSAGE-TEXT (1)        16376244
163763                 MOVE SQLCA      TO DP013-SQLCA                   16376344
163764                 MOVE 'WST00008' TO DP013-DB2-TABLE-NAME (1)      16376444
163765                 MOVE 'WST00009' TO DP013-DB2-TABLE-NAME (2)      16376544
163766                 MOVE 'WST00010' TO DP013-DB2-TABLE-NAME (3)      16376644
163767                 SET DP013-DB2-ABEND                              16376744
163768                                 TO TRUE                          16376844
163769                 SET DP013-XCTL-DISPLAY-RESTART                   16376944
163770                                 TO TRUE                          16377044
163771                 PERFORM DP013-0000-PROCESS-ABEND                 16377144
163772         END-EVALUATE.                                            16377244
163773                                                                  16377344
163774                                                                  16377444
163780*----------------------------------------------------------------*16378009
163800*                                                                *16380009
163900*----------------------------------------------------------------*16390009
164000 2290-GET-DC-LOCATION.                                            16400009
164100     EXEC SQL                                                     16410009
164200          SELECT LOC_5_ABBR_NM                                    16420009
164300          INTO  :PV-DC-5-CHAR-ABBR                                16430009
164400          FROM   XLT_LOC                                          16440009
164500          WHERE  LOC_TYP_CDE  = 'DC'                              16450009
164600          AND    LOC_NBR      = :PC-OPER-UNT-ID                   16460009
164700     END-EXEC.                                                    16470009
164800                                                                  16480009
164900     EVALUATE TRUE                                                16490009
165000         WHEN SQLCODE = ZERO                                      16500009
165100              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       16510009
165200              MOVE  PC-OPER-UNT-ID      TO  PC140-CRA-OPER-UNT-ID 16520009
165300                                                                  16530009
165400         WHEN SQLCODE = +100                                      16540009
165500              MOVE  PC-90   TO  PC140-CRA-DC-ID                   16550009
165600                                PC140-CRA-OPER-UNT-ID             16560009
165700                                                                  16570009
165800         WHEN SQLWARN0 NOT = SPACES                               16580009
165900         WHEN SQLCODE NOT EQUAL ZERO                              16590009
166000             MOVE '2290-GET-DC-LOCATION'                          16600009
166100                             TO DP013-PARAGRAPH                   16610009
166200             MOVE 'PCKCS115 - GET DC LOCATION CODE'               16620009
166300                             TO DP013-MESSAGE-TEXT(1)             16630009
166400             MOVE PC140-CRA-DC-ID                                 16640009
166500                             TO DP013-MESSAGE-TEXT(2)             16650009
166600             MOVE SQLCA      TO DP013-SQLCA                       16660009
166700             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           16670009
166800             SET DP013-DB2-ABEND                                  16680009
166900                             TO TRUE                              16690009
167000             SET DP013-NO-ROLLBACK                                16700009
167100                             TO TRUE                              16710009
167200             SET DP013-XCTL-DISPLAY-RESTART                       16720009
167300                             TO TRUE                              16730009
167400             PERFORM DP013-0000-PROCESS-ABEND                     16740009
167500     END-EVALUATE.                                                16750009
167600                                                                  16760009
167700                                                                  16770009
167800*----------------------------------------------------------------*16780009
167900*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *16790009
168000*                                                                *16800009
168100*----------------------------------------------------------------*16810009
168200                                                                  16820009
168300 2300-MOVE-COMMAREA-TO-SCREEN.                                    16830009
168400                                                                  16840009
168500     MOVE ASC-OPER-UNT-ID-N           TO PV-SUPPRESS-FOUR.        16850009
168600     MOVE PV-SUPPRESS-FOUR            TO AOPUNITO.                16860009
168700     MOVE ASC-OP-UNIT-NAME            TO AOPDESCO.                16870009
168800     MOVE ASC-FCLTY-ID-N              TO PV-SUPPRESS-FOUR.        16880009
168900     MOVE PV-SUPPRESS-FOUR            TO AFACILO.                 16890009
169000     MOVE ASC-PRTR-ID                 TO APRTRO.                  16900009
169100     MOVE ASC-PRTR-DESC               TO APRDESCO.                16910009
169200     MOVE ASC-STR-NBR                 TO ASTRO.                   16920009
169300     MOVE ASC-STR-NAME                TO ASTRNMO.                 16930009
169400     MOVE ASC-NO-OF-LBLS              TO ALBLSO.                  16940009
169500     MOVE ASC-SEASONAL-SET-YEAR       TO SSYRO.                   16950009
169600     MOVE ASC-SEASONAL-SET-SHORT-NAME TO SSNMO.                   16960009
169700     MOVE ASC-SPEC-INST-LINE-1        TO INST1O.                  16970009
169800     MOVE ASC-SPEC-INST-LINE-2        TO INST2O.                  16980009
169801*DMH 2/24/16                                                      16980115
169810     MOVE ASC-PARM-DOOR-LABEL         TO SHDRO.                   16981015
169820     MOVE ASC-PARM-SML-ORD            TO LBLORDO.                 16982018
169900                                                                  16990009
170000 EJECT                                                            17000009
170010                                                                  17001024
170011                                                                  17001124
170012*----------------------------------------------------------------*17001224
170013* CHECK IF THE STORE LOCATION IS FOR AN AMAZON RETURN CENTER     *17001324
170014* DMH - 07/17/2018                                               *17001424
170015*----------------------------------------------------------------*17001524
170016 2400-CHECK-AMAZON-RETURN.                                        17001624
170017                                                                  17001724
170018     SET  PS-AMAZON-RETURN-CENTER-NO  TO  TRUE                    17001824
170019     SET  PS-DC-PRINT-AMAZON-LBL-NO   TO  TRUE                    17001925
170020     MOVE  ASC-STR-NBR       TO WST00010-ATTR-ELEM-NBR.           17002032
170022                                                                  17002224
170023     EXEC SQL                                                     17002324
170024          SELECT                                                  17002425
170025                 J.LOC_NM                                         17002539
170026               , J.LOC_10_ABBR_NM                                 17002639
170027               , J.LOC_5_ABBR_NM                                  17002739
170028               , G.ATTR_ELEM_TXT                                  17002843
170029               , H.ATTR_ELEM_TXT                                  17002943
170030               , I.ATTR_ELEM_TXT                                  17003043
170031            INTO                                                  17003139
170032                 :XLT00010-LOC-NM                                 17003239
170033               , :XLT00010-LOC-10-ABBR-NM :PV-NULL-IND            17003339
170034               , :XLT00010-LOC-5-ABBR-NM                          17003439
170035               , :ASC-LABEL-LINE-1 :PV-NULL-IND-1                 17003543
170036               , :ASC-LABEL-LINE-2 :PV-NULL-IND-2                 17003643
170037               , :ASC-LABEL-LINE-3 :PV-NULL-IND-3                 17003743
170038            FROM                                                  17003839
170039                 WST_INTGRTN_TYP A                                17003939
170040               , WST_ATTR_DEFN   B                                17004039
170041               , WST_ATTR_ELEM   C                                17004139
170042               , WST_ATTR_ELEM   D                                17004239
170043               , WST_ATTR_ELEM   E                                17004339
170044               , WST_ATTR_ELEM   F                                17004439
170045               , WST_ATTR_ELEM   G                                17004539
170046               , WST_ATTR_ELEM   H                                17004639
170047               , WST_ATTR_ELEM   I                                17004739
170048               , XLT_LOC         J                                17004839
170049           WHERE                                                  17004939
170050                 A.INTGRTN_TYP_CDE   = 'AMAZONLOC'                17005039
170051             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          17005139
170052             AND B.ATTR_DEFN_SEQ_NBR = 1                          17005239
170053             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          17005339
170054             AND C.ATTR_DEFN_SEQ_NBR = 1                          17005439
170055             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          17005539
170056             AND D.ATTR_DEFN_SEQ_NBR = 2                          17005639
170057             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          17005739
170058             AND E.ATTR_DEFN_SEQ_NBR = 3                          17005839
170059             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          17005939
170060             AND F.ATTR_DEFN_SEQ_NBR = 4                          17006039
170061             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          17006139
170062             AND G.ATTR_DEFN_SEQ_NBR = 5                          17006239
170063             AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE          17006339
170064             AND H.ATTR_DEFN_SEQ_NBR = 6                          17006439
170065             AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE          17006539
170066             AND I.ATTR_DEFN_SEQ_NBR = 7                          17006639
170067             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        17006739
170068             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        17006839
170069             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        17006939
170070             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        17007039
170071             AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR        17007139
170072             AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR        17007239
170073             AND C.ATTR_ELEM_NBR     = :WST00010-ATTR-ELEM-NBR    17007339
170074             AND D.ATTR_ELEM_TXT     = 'Y'                        17007439
170075             AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          17007539
170076             AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP          17007639
170077             AND C.ATTR_ELEM_NBR     =  J.LOC_NBR                 17007740
170078             AND J.LOC_TYP_CDE       = 'ND'                       17007839
170079             AND J.OPN_DTE          <=  CURRENT DATE              17007939
170080             AND J.CLO_DTE          >=  CURRENT DATE              17008039
170081       WITH UR                                                    17008139
170082     END-EXEC.                                                    17008239
170083                                                                  17008339
170084     EVALUATE TRUE                                                17008439
170085         WHEN SQLCODE = ZERO                                      17008539
170086              MOVE XLT00010-LOC-NM     TO ASC-STR-NAME            17008639
170087                                          ASTRNMO                 17008739
170088              IF  PV-NULL-IND =  -1                               17008839
170089                  MOVE XLT00010-LOC-5-ABBR-NM                     17008939
170090                                       TO ASC-STR-NAME-CHAR10-ABBR17009039
170091              ELSE                                                17009139
170092                  MOVE XLT00010-LOC-10-ABBR-NM                    17009239
170093                                       TO ASC-STR-NAME-CHAR10-ABBR17009339
170094              END-IF                                              17009439
170095              IF  PV-NULL-IND-1 =  -1                             17009542
170096                  MOVE SPACES          TO ASC-LABEL-LINE-1        17009642
170097              END-IF                                              17009742
170098              IF  PV-NULL-IND-2 =  -1                             17009842
170099                  MOVE SPACES          TO ASC-LABEL-LINE-2        17009942
170100              END-IF                                              17010042
170101              IF  PV-NULL-IND-3 =  -1                             17010142
170102                  MOVE SPACES          TO ASC-LABEL-LINE-3        17010242
170103              END-IF                                              17010342
170104              SET  PS-AMAZON-RETURN-CENTER-YES                    17010439
170105                                       TO TRUE                    17010539
170106              PERFORM 2410-CHECK-DC-PRINT-AMAZON                  17010639
170107         WHEN SQLCODE = +100                                      17010739
170108              SET  PS-AMAZON-RETURN-CENTER-NO                     17010839
170109                                       TO TRUE                    17010939
170110         WHEN SQLWARN0 NOT = SPACES                               17011039
170111             WHEN SQLCODE < ZERO                                  17011139
170112             WHEN SQLCODE > ZERO                                  17011239
170113                 MOVE '2400-CHECK-AMAZON-RETURN'                  17011339
170114                                 TO DP013-PARAGRAPH               17011439
170115                 MOVE 'CHECK IF AMAZON RETURN CENTER        '     17011539
170116                                 TO DP013-MESSAGE-TEXT (1)        17011639
170117                 MOVE SQLCA      TO DP013-SQLCA                   17011739
170118                 MOVE 'WST00008' TO DP013-DB2-TABLE-NAME (1)      17011839
170119                 MOVE 'WST00009' TO DP013-DB2-TABLE-NAME (2)      17011939
170120                 MOVE 'WST00010' TO DP013-DB2-TABLE-NAME (3)      17012039
170121                 SET DP013-DB2-ABEND                              17012139
170122                                 TO TRUE                          17012239
170123                 SET DP013-XCTL-DISPLAY-RESTART                   17012339
170124                                 TO TRUE                          17012439
170125                 PERFORM DP013-0000-PROCESS-ABEND                 17012539
170126         END-EVALUATE.                                            17012639
170127                                                                  17012739
170128                                                                  17012839
170129*----------------------------------------------------------------*17012939
170130* IF STORE IS A AMAZON LOCATION - CHECK IS DC CAN PRINT LABELS   *17013039
170131* FOR AMAZON LOCATIONS                                           *17013139
170132* DMH - 07/17/2018                                               *17013239
170133*----------------------------------------------------------------*17013339
170134 2410-CHECK-DC-PRINT-AMAZON.                                      17013439
170135                                                                  17013539
170136     SET  PS-DC-PRINT-AMAZON-LBL-NO  TO  TRUE                     17013639
170137     MOVE ASC-OPER-UNT-ID-N TO WST00010-ATTR-ELEM-NBR.            17013739
170138                                                                  17013839
170139     EXEC SQL                                                     17013939
170140          SELECT                                                  17014039
170141                 D.ATTR_ELEM_TXT                                  17014139
170142            INTO                                                  17014239
170143                 :WST00010-ATTR-ELEM-TXT                          17014339
170144            FROM                                                  17014439
170145                 WST_INTGRTN_TYP A                                17014539
170146               , WST_ATTR_DEFN   B                                17014639
170147               , WST_ATTR_ELEM   C                                17014739
170148               , WST_ATTR_ELEM   D                                17014839
170149               , WST_ATTR_ELEM   E                                17014939
170150               , WST_ATTR_ELEM   F                                17015039
170151               , XLT_LOC         G                                17015139
170152           WHERE                                                  17015239
170153                 A.INTGRTN_TYP_CDE   = 'AMAZONLBL'                17015339
170154             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          17015439
170155             AND B.ATTR_DEFN_SEQ_NBR = 1                          17015539
170156             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          17015639
170157             AND C.ATTR_DEFN_SEQ_NBR = 1                          17015739
170158             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          17015839
170159             AND D.ATTR_DEFN_SEQ_NBR = 2                          17015939
170160             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          17016039
170161             AND E.ATTR_DEFN_SEQ_NBR = 3                          17016139
170162             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          17016239
170163             AND F.ATTR_DEFN_SEQ_NBR = 4                          17016339
170164             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        17016439
170165             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        17016539
170166             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        17016639
170167             AND C.ATTR_ELEM_NBR     = :WST00010-ATTR-ELEM-NBR    17016739
170168             AND D.ATTR_ELEM_TXT     = 'Y'                        17016839
170169             AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          17016939
170170             AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP          17017039
170171             AND C.ATTR_ELEM_NBR     =  G.LOC_NBR                 17017139
170172       WITH UR                                                    17017239
170173     END-EXEC.                                                    17017339
170174                                                                  17017439
170175     EVALUATE TRUE                                                17017539
170176         WHEN SQLCODE = ZERO                                      17017639
170177              SET  PS-DC-PRINT-AMAZON-LBL-YES                     17017726
170178                                       TO TRUE                    17017825
170179         WHEN SQLCODE = +100                                      17017925
170180         WHEN SQLCODE = -305                                      17018034
170181              SET  PS-DC-PRINT-AMAZON-LBL-NO                      17018134
170182                                       TO TRUE                    17018234
170183         WHEN SQLWARN0 NOT = SPACES                               17018334
170184             WHEN SQLCODE < ZERO                                  17018434
170185             WHEN SQLCODE > ZERO                                  17018534
170186                 MOVE '2410-CHECK-DC-PRINT-AMAZON'                17018634
170187                                 TO DP013-PARAGRAPH               17018734
170188                 MOVE 'CHECK IF DC CAN PRINT AMAZON SMLS    '     17018834
170189                                 TO DP013-MESSAGE-TEXT (1)        17018934
170190                 MOVE SQLCA      TO DP013-SQLCA                   17019034
170191                 MOVE 'WST00008' TO DP013-DB2-TABLE-NAME (1)      17019134
170192                 MOVE 'WST00009' TO DP013-DB2-TABLE-NAME (2)      17019234
170193                 MOVE 'WST00010' TO DP013-DB2-TABLE-NAME (3)      17019334
170194                 SET DP013-DB2-ABEND                              17019434
170195                                 TO TRUE                          17019534
170196                 SET DP013-XCTL-DISPLAY-RESTART                   17019634
170197                                 TO TRUE                          17019734
170198                 PERFORM DP013-0000-PROCESS-ABEND                 17019834
170199         END-EVALUATE.                                            17019934
170200                                                                  17020034
170201                                                                  17020134
170202*----------------------------------------------------------------*17020234
170210*    NO INFORMATION IS DEFAULTED TO, DISPLAY BLANK MAP.          *17021009
170300*----------------------------------------------------------------*17030009
170400                                                                  17040009
170500 3000-BUILD-INITIAL-PANEL.                                        17050009
170600                                                                  17060009
170700     SET DP030-SET-CURSOR-APPL-1 TO TRUE                          17070009
170800                                                                  17080009
170900                                                                  17090009
171000*    *-------------------------------------*                      17100009
171100*    * DEFAULT OPERATING UNIT AND FACILITY *                      17110009
171200*    *-------------------------------------*                      17120009
171300     PERFORM 3210-FORMAT-OP-UNIT                                  17130009
171400                                                                  17140009
171500     PERFORM 3220-FORMAT-FCLTY-ID                                 17150009
171501                                                                  17150115
171502* DMH - 2/24/16 - BEGIN                                           17150215
171503     EVALUATE TRUE                                                17150322
171504         WHEN DP020-NEXT-ACT-INITIAL                              17150422
171510              PERFORM 3230-GET-DC-DEFAULT-SML-ORDER               17151022
171511              MOVE ASC-PARM-SML-ORD    TO LBLORDO                 17151122
171520              PERFORM 3240-GET-DC-DFLT-DOOR-ON-LABEL              17152022
171523              MOVE ASC-PARM-DOOR-LABEL TO SHDRO                   17152322
171524     END-EVALUATE.                                                17152422
171530* DMH - 2/24/16 - END                                             17153015
171600                                                                  17160009
171700     PERFORM 3200-DISPLAY-PANEL.                                  17170009
171800                                                                  17180009
171900                                                                  17190009
172000*----------------------------------------------------------------*17200009
172100*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *17210009
172200*                                                                *17220009
172300*    PERFORMED BY 1000-CONTROL-PROCESSING.                       *17230009
172400*    PERFORMED BY 3000-PROCESS-PANEL.                            *17240009
172500*----------------------------------------------------------------*17250009
172600                                                                  17260009
172700 3200-DISPLAY-PANEL.                                              17270009
172800                                                                  17280009
172900     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            17290009
173000     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           17300009
173100                                                                  17310009
173200/                                                                 17320009
173300 3210-FORMAT-OP-UNIT.                                             17330009
173400                                                                  17340009
173500     MOVE DP020-LOCATION-NBR     TO DP010I-UNEDITED-FIELD         17350009
173600     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         17360009
173700     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       17370009
173800                                                                  17380009
173900     SET DP010I-NEGATIVE-NOT-ALLOWED                              17390009
174000                                 TO TRUE                          17400009
174100                                                                  17410009
174210     CALL DP010I-NUMERIC-EDIT-ROUTINE                             17421046
174220                         USING DP010I-NUMERIC-EDIT-AREA           17422046
174300                                                                  17430009
174400     IF DP010I-NO-ERROR-DETECTED                                  17440009
174500         MOVE DP010I-NUMERIC-FIELD                                17450009
174600                                 TO PV-PIC9-FOUR                  17460009
174700         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              17470009
174800         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      17480009
174900                                    ASC-OPER-UNT-ID               17490009
175000         MOVE PV-PIC9-FOUR       TO ASC-CUR-OPER-UNT-ID           17500009
175100     ELSE                                                         17510009
175200         MOVE DP020-LOCATION-NBR TO PV-PICX-FOUR                  17520009
175300         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              17530009
175400         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      17540009
175500                                    ASC-OPER-UNT-ID               17550009
175600         MOVE PV-PIC9-FOUR       TO ASC-CUR-OPER-UNT-ID           17560009
175700                                                                  17570009
175800     .                                                            17580009
175900 3220-FORMAT-FCLTY-ID.                                            17590009
176000                                                                  17600009
176100     MOVE DP020-FCLTY-ID         TO DP010I-UNEDITED-FIELD         17610009
176200     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         17620009
176300     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       17630009
176400                                                                  17640009
176500     SET DP010I-NEGATIVE-NOT-ALLOWED                              17650009
176600                                 TO TRUE                          17660009
176700                                                                  17670009
176810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             17681046
176820                         USING DP010I-NUMERIC-EDIT-AREA           17682046
176900                                                                  17690009
177000     IF DP010I-NO-ERROR-DETECTED                                  17700009
177100         MOVE DP010I-NUMERIC-FIELD                                17710009
177200                                 TO PV-PIC9-FOUR                  17720009
177300         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              17730009
177400         MOVE PV-SUPPRESS-FOUR   TO AFACILO                       17740009
177500                                    ASC-FCLTY-ID-N                17750009
177600     ELSE                                                         17760009
177700         MOVE DP020-LOCATION-NBR TO AFACILO                       17770009
177800                                    ASC-FCLTY-ID                  17780009
177900         SET PS-ERROR            TO TRUE                          17790009
178000         SET DP020-MSG-FATAL     TO TRUE                          17800009
178100         MOVE PC-TSYMSG-00005                                     17810009
178200                                 TO DP020-MSG-NUMBER              17820009
178300         MOVE DP015-UNP-ALP-BRT-OFF                               17830009
178400                                 TO AFACILA                       17840009
178500         MOVE DP015-RED          TO AFACILC                       17850009
178600         MOVE DP015-REVERSE      TO AFACILH                       17860009
178700         MOVE -1                 TO AFACILL                       17870009
178800         SET DP030-SET-CURSOR-APPL-1                              17880009
178900                                 TO TRUE                          17890009
179000     END-IF.                                                      17900015
179001                                                                  17900115
179002                                                                  17900215
179003******************************************************************17900315
179004* GET THE DEFAULT SML ORDER BY DC - WHEN ALL SELECTED WHAT ORDER *17900415
179005* WILL THE SML'S PRINT                                           *17900515
179006* DMH - 2/24/16 - BEGIN                                          *17900615
179007******************************************************************17900715
179010 3230-GET-DC-DEFAULT-SML-ORDER.                                   17901015
179011                                                                  17901115
179012     MOVE ASC-OPER-UNT-ID-N  TO KRPRPM-LOC-ID.                    17901215
179013                                                                  17901315
179014     EXEC SQL                                                     17901415
179015          SELECT FUNC_TXT                                         17901515
179016          INTO  :PV-PARM-SML-ORD                                  17901615
179017           FROM TKRPRPM                                           17901715
179018          WHERE LOC_ID             =  :KRPRPM-LOC-ID              17901815
179019            AND SYS_PRC_FUNC_CDE   = 'SMLORD'                     17901915
179020            AND  INTFC_SYS_CDE     = 'KHL'                        17902015
179021            AND  FUNC_PRC_STAT_CDE = 'AC'                         17902115
179022           WITH UR                                                17902215
179023     END-EXEC                                                     17902315
179024                                                                  17902415
179025     EVALUATE TRUE                                                17902515
179026         WHEN SQLCODE = ZERO                                      17902615
179028             MOVE  PV-PARM-SML-ORD  TO  ASC-PARM-SML-ORD          17902815
179029         WHEN SQLCODE = +100                                      17902915
179030             MOVE 'S'               TO  PV-PARM-SML-ORD           17903015
179031             MOVE  PV-PARM-SML-ORD  TO  ASC-PARM-SML-ORD          17903115
179032         WHEN SQLCODE = -904                                      17903215
179033         WHEN SQLCODE = -911                                      17903315
179034         WHEN SQLCODE = -913                                      17903415
179035             MOVE '3230-GET-DC-DEFAULT-SML-ORDER'                 17903515
179036                             TO DP013-PARAGRAPH                   17903615
179037             MOVE 'SELECT PARM SMLORD   '                         17903715
179038                             TO DP013-MESSAGE-TEXT (1)            17903815
179039             MOVE SQLCA      TO DP013-SQLCA                       17903915
179040             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          17904015
179041             SET DP013-DB2-ABEND                                  17904115
179042                             TO TRUE                              17904215
179043             SET DP013-XCTL-DISPLAY-RESTART                       17904315
179044                             TO TRUE                              17904415
179045             PERFORM DP013-0000-PROCESS-ABEND                     17904515
179046         WHEN SQLWARN0 NOT = SPACES                               17904615
179047         WHEN SQLCODE < ZERO                                      17904715
179048         WHEN SQLCODE > ZERO                                      17904815
179049             MOVE '3230-GET-DC-DEFAULT-SML-ORDER'                 17904915
179050                             TO DP013-PARAGRAPH                   17905015
179051             MOVE 'SELECT PARM SMLORD   '                         17905115
179052                             TO DP013-MESSAGE-TEXT (1)            17905215
179053             MOVE SQLCA      TO DP013-SQLCA                       17905315
179054             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          17905415
179055             SET DP013-DB2-ABEND                                  17905515
179056                             TO TRUE                              17905615
179057             SET DP013-XCTL-DISPLAY-RESTART                       17905715
179058                             TO TRUE                              17905815
179059             PERFORM DP013-0000-PROCESS-ABEND                     17905915
179060     END-EVALUATE.                                                17906015
179061                                                                  17906115
179062                                                                  17906215
179063******************************************************************17906315
179064* GET THE DEFAULT BY DC IF SHIPPING DOOR IS TO APPEAR ON THE     *17906415
179065* GENERIC SML ABOVE THE STORE NUMBER.                            *17906515
179066* DMH - 2/24/16 - BEGIN                                          *17906615
179067******************************************************************17906715
179070 3240-GET-DC-DFLT-DOOR-ON-LABEL.                                  17907018
179095                                                                  17909515
179096     MOVE ASC-OPER-UNT-ID-N  TO KRPRPM-LOC-ID.                    17909615
179097                                                                  17909715
179098     EXEC SQL                                                     17909815
179099          SELECT FUNC_TXT                                         17909915
179100          INTO  :PV-PARM-DOOR-LABEL                               17910015
179101           FROM TKRPRPM                                           17910115
179102          WHERE LOC_ID             =  :KRPRPM-LOC-ID              17910215
179103            AND SYS_PRC_FUNC_CDE   = 'SMLDOR'                     17910315
179104            AND  INTFC_SYS_CDE     = 'KHL'                        17910415
179105            AND  FUNC_PRC_STAT_CDE = 'AC'                         17910515
179106           WITH UR                                                17910615
179107     END-EXEC                                                     17910715
179108                                                                  17910815
179109     EVALUATE TRUE                                                17910915
179110         WHEN SQLCODE = ZERO                                      17911015
179112             MOVE  PV-PARM-DOOR-LABEL TO  ASC-PARM-DOOR-LABEL     17911215
179113         WHEN SQLCODE = +100                                      17911315
179114             MOVE 'N'                 TO  PV-PARM-DOOR-LABEL      17911415
179116             MOVE  PV-PARM-DOOR-LABEL TO  ASC-PARM-DOOR-LABEL     17911615
179117         WHEN SQLCODE = -904                                      17911715
179118         WHEN SQLCODE = -911                                      17911815
179119         WHEN SQLCODE = -913                                      17911915
179120             MOVE '3240-GET-DC-DFLT-DOOR-ON-LABEL'                17912018
179121                             TO DP013-PARAGRAPH                   17912115
179122             MOVE 'SELECT PARM SMLDOR   '                         17912215
179123                             TO DP013-MESSAGE-TEXT (1)            17912315
179124             MOVE SQLCA      TO DP013-SQLCA                       17912415
179125             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          17912515
179126             SET DP013-DB2-ABEND                                  17912615
179127                             TO TRUE                              17912715
179128             SET DP013-XCTL-DISPLAY-RESTART                       17912815
179129                             TO TRUE                              17912915
179130             PERFORM DP013-0000-PROCESS-ABEND                     17913015
179131         WHEN SQLWARN0 NOT = SPACES                               17913115
179132         WHEN SQLCODE < ZERO                                      17913215
179133         WHEN SQLCODE > ZERO                                      17913315
179134             MOVE '3240-GET-DC-DFLT-DOOR-ON-LABEL'                17913418
179135                             TO DP013-PARAGRAPH                   17913515
179136             MOVE 'SELECT PARM SMLDOR   '                         17913615
179137                             TO DP013-MESSAGE-TEXT (1)            17913715
179138             MOVE SQLCA      TO DP013-SQLCA                       17913815
179139             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          17913915
179140             SET DP013-DB2-ABEND                                  17914015
179141                             TO TRUE                              17914115
179142             SET DP013-XCTL-DISPLAY-RESTART                       17914215
179143                             TO TRUE                              17914315
179144             PERFORM DP013-0000-PROCESS-ABEND                     17914415
179145     END-EVALUATE.                                                17914515
179146                                                                  17914609
179150                                                                  17915015
179200******************************************************************17920009
179300 3800-SEL-KRPRPM-RQST-QTY.                                        17930009
179400******************************************************************17940009
179500                                                                  17950009
179600     MOVE ASC-OPER-UNT-ID-N  TO KRPRPM-LOC-ID.                    17960009
179700                                                                  17970009
179800     EXEC SQL                                                     17980009
179900          SELECT FUNC_QTY                                         17990009
180000          INTO  :PV-KRPRPM-FUNC-QTY                               18000009
180100           FROM TKRPRPM                                           18010009
180200          WHERE LOC_ID             =  :KRPRPM-LOC-ID              18020009
180300            AND SYS_PRC_FUNC_CDE   = 'REQQTY'                     18030009
180400            AND  INTFC_SYS_CDE     = 'KHL'                        18040009
180500            AND  FUNC_PRC_STAT_CDE = 'AC'                         18050009
180600     END-EXEC                                                     18060009
180700                                                                  18070009
180800     EVALUATE TRUE                                                18080009
180900         WHEN SQLCODE = ZERO                                      18090009
181000             CONTINUE                                             18100009
181100         WHEN SQLCODE = +100                                      18110009
181200             MOVE +0         TO PV-KRPRPM-FUNC-QTY                18120009
181300         WHEN SQLCODE = -904                                      18130009
181400         WHEN SQLCODE = -911                                      18140009
181500         WHEN SQLCODE = -913                                      18150009
181600             MOVE '3800-SEL-KRPRPM-RQST-QTY '                     18160009
181700                             TO DP013-PARAGRAPH                   18170009
181800             MOVE 'SELECT PARM REQST QTY'                         18180009
181900                             TO DP013-MESSAGE-TEXT (1)            18190009
182000             MOVE SQLCA      TO DP013-SQLCA                       18200009
182100             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          18210009
182200             SET DP013-DB2-ABEND                                  18220009
182300                             TO TRUE                              18230009
182400             SET DP013-XCTL-DISPLAY-RESTART                       18240009
182500                             TO TRUE                              18250009
182600             PERFORM DP013-0000-PROCESS-ABEND                     18260009
182700         WHEN SQLWARN0 NOT = SPACES                               18270009
182800         WHEN SQLCODE < ZERO                                      18280009
182900         WHEN SQLCODE > ZERO                                      18290009
183000             MOVE '3800-SEL-KRPRPM-RQST-QTY '                     18300009
183100                             TO DP013-PARAGRAPH                   18310009
183200             MOVE 'SELECT PARM RQSTL QTY'                         18320009
183300                             TO DP013-MESSAGE-TEXT (1)            18330009
183400             MOVE SQLCA      TO DP013-SQLCA                       18340009
183500             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          18350009
183600             SET DP013-DB2-ABEND                                  18360009
183700                             TO TRUE                              18370009
183800             SET DP013-XCTL-DISPLAY-RESTART                       18380009
183900                             TO TRUE                              18390009
184000             PERFORM DP013-0000-PROCESS-ABEND                     18400009
184100     END-EVALUATE.                                                18410009
184200/                                                                 18420009
184300******************************************************************18430009
184400 3900-SEL-KRPRPM-LABEL-QTY.                                       18440009
184500******************************************************************18450009
184600                                                                  18460009
184700     MOVE ASC-OPER-UNT-ID-N  TO KRPRPM-LOC-ID.                    18470009
184800                                                                  18480009
184900     EXEC SQL                                                     18490009
185000          SELECT FUNC_QTY                                         18500009
185100          INTO  :PV-KRPRPM-FUNC-QTY                               18510009
185200           FROM TKRPRPM                                           18520009
185300          WHERE LOC_ID             =  :KRPRPM-LOC-ID              18530009
185400            AND SYS_PRC_FUNC_CDE   = 'LBLQTY'                     18540009
185500            AND  INTFC_SYS_CDE     = 'KHL'                        18550009
185600            AND  FUNC_PRC_STAT_CDE = 'AC'                         18560009
185700     END-EXEC                                                     18570009
185800                                                                  18580009
185900     EVALUATE TRUE                                                18590009
186000         WHEN SQLCODE = ZERO                                      18600009
186100             CONTINUE                                             18610009
186200         WHEN SQLCODE = +100                                      18620009
186300             MOVE +0         TO PV-KRPRPM-FUNC-QTY                18630009
186400         WHEN SQLCODE = -904                                      18640009
186500         WHEN SQLCODE = -911                                      18650009
186600         WHEN SQLCODE = -913                                      18660009
186700             MOVE '3900-SEL-KRPRPM-LABEL-QTY'                     18670009
186800                             TO DP013-PARAGRAPH                   18680009
186900             MOVE 'SELECT PARM LABEL QTY'                         18690009
187000                             TO DP013-MESSAGE-TEXT (1)            18700009
187100             MOVE SQLCA      TO DP013-SQLCA                       18710009
187200             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          18720009
187300             SET DP013-DB2-ABEND                                  18730009
187400                             TO TRUE                              18740009
187500             SET DP013-XCTL-DISPLAY-RESTART                       18750009
187600                             TO TRUE                              18760009
187700             PERFORM DP013-0000-PROCESS-ABEND                     18770009
187800         WHEN SQLWARN0 NOT = SPACES                               18780009
187900         WHEN SQLCODE < ZERO                                      18790009
188000         WHEN SQLCODE > ZERO                                      18800009
188100             MOVE '3900-SEL-KRPRPM-LABEL-QTY'                     18810009
188200                             TO DP013-PARAGRAPH                   18820009
188300             MOVE 'SELECT PARM LABEL QTY'                         18830009
188400                             TO DP013-MESSAGE-TEXT (1)            18840009
188500             MOVE SQLCA      TO DP013-SQLCA                       18850009
188600             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          18860009
188700             SET DP013-DB2-ABEND                                  18870009
188800                             TO TRUE                              18880009
188900             SET DP013-XCTL-DISPLAY-RESTART                       18890009
189000                             TO TRUE                              18900009
189100             PERFORM DP013-0000-PROCESS-ABEND                     18910009
189200     END-EVALUATE.                                                18920009
189300                                                                  18930009
189400                                                                  18940009
189500*----------------------------------------------------------------*18950009
189600* CHECK TO SEE IF WE ARE TRACKING THE MANIFEST NUMBER SEQUENCE   *18960009
189700*----------------------------------------------------------------*18970009
189800 3910-CHECK-MANIFEST-TRACKING.                                    18980009
189900                                                                  18990009
190000     MOVE ASC-OPER-UNT-ID-N  TO KRPRPM-LOC-ID.                    19000009
190100                                                                  19010009
190200     EXEC SQL                                                     19020009
190300          SELECT FUNC_TXT                                         19030009
190400          INTO  :PV-KRPRPM-TRACK                                  19040009
190500           FROM TKRPRPM                                           19050009
190600          WHERE LOC_ID             =  :KRPRPM-LOC-ID              19060009
190700            AND SYS_PRC_FUNC_CDE   = 'LBLTRK'                     19070009
190800            AND  INTFC_SYS_CDE     = 'KHL'                        19080009
190900            AND  FUNC_PRC_STAT_CDE = 'AC'                         19090009
191000            AND  FUNC_TXT          = 'Y'                          19100009
191100     END-EXEC                                                     19110009
191200                                                                  19120009
191300     EVALUATE TRUE                                                19130009
191400         WHEN SQLCODE = ZERO                                      19140009
191500              SET  ASC-MFST-TRACK-YES  TO  TRUE                   19150009
191600         WHEN SQLCODE = +100                                      19160009
191700              SET  ASC-MFST-TRACK-NO   TO  TRUE                   19170009
191800         WHEN SQLCODE = -904                                      19180009
191900         WHEN SQLCODE = -911                                      19190009
192000         WHEN SQLCODE = -913                                      19200009
192100              SET  ASC-MFST-TRACK-NO   TO  TRUE                   19210009
192200             MOVE '3910-CHECK-MANIFEST-TRACKING'                  19220009
192300                             TO DP013-PARAGRAPH                   19230009
192400             MOVE 'CHECK DC TRACKING MFST NBR'                    19240009
192500                             TO DP013-MESSAGE-TEXT (1)            19250009
192600             MOVE SQLCA      TO DP013-SQLCA                       19260009
192700             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          19270009
192800             SET DP013-DB2-ABEND                                  19280009
192900                             TO TRUE                              19290009
193000             SET DP013-XCTL-DISPLAY-RESTART                       19300009
193100                             TO TRUE                              19310009
193200             PERFORM DP013-0000-PROCESS-ABEND                     19320009
193300         WHEN SQLWARN0 NOT = SPACES                               19330009
193400         WHEN SQLCODE < ZERO                                      19340009
193500         WHEN SQLCODE > ZERO                                      19350009
193600             MOVE '3910-CHECK-MANIFEST-TRACKING'                  19360009
193700                             TO DP013-PARAGRAPH                   19370009
193800             MOVE 'CHECK DC TRACKING MFST NBR'                    19380009
193900                             TO DP013-MESSAGE-TEXT (1)            19390009
194000             MOVE SQLCA      TO DP013-SQLCA                       19400009
194100             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          19410009
194200             SET DP013-DB2-ABEND                                  19420009
194300                             TO TRUE                              19430009
194400             SET DP013-XCTL-DISPLAY-RESTART                       19440009
194500                             TO TRUE                              19450009
194600             PERFORM DP013-0000-PROCESS-ABEND                     19460009
194700     END-EVALUATE.                                                19470009
194800                                                                  19480009
194900                                                                  19490009
195000                                                                  19500009
195010*----------------------------------------------------------------*19501013
195020* SELECT THE GENERIC SML LINES TO APPEAR ON THE LABELS           *19502013
195021* THIS REPLACES PRINTING THE STORE ZONES                         *19502113
195030*----------------------------------------------------------------*19503013
195040 3920-GET-GENERIC-SML-LINES.                                      19504013
195050                                                                  19505013
195060     MOVE ASC-OPER-UNT-ID-N  TO KRPRPM-LOC-ID.                    19506013
195070                                                                  19507013
195080     EXEC SQL                                                     19508013
195090          SELECT A.FUNC_TXT                                       19509013
195091               , B.FUNC_TXT                                       19509113
195092               , C.FUNC_TXT                                       19509213
195093           INTO  :PV-GENERIC-SML-LINE-1                           19509313
195094               , :PV-GENERIC-SML-LINE-2                           19509413
195095               , :PV-GENERIC-SML-LINE-3                           19509513
195096           FROM  TKRPRPM A                                        19509613
195097               , TKRPRPM B                                        19509713
195098               , TKRPRPM C                                        19509813
195099          WHERE  A.LOC_ID            =  :KRPRPM-LOC-ID            19509913
195100            AND  A.SYS_PRC_FUNC_CDE  = 'SMLLN1'                   19510013
195101            AND  A.INTFC_SYS_CDE     = 'KHL'                      19510113
195102            AND  A.FUNC_PRC_STAT_CDE = 'AC'                       19510213
195103            AND  B.LOC_ID            =  :KRPRPM-LOC-ID            19510313
195104            AND  B.SYS_PRC_FUNC_CDE  = 'SMLLN2'                   19510413
195105            AND  B.INTFC_SYS_CDE     = 'KHL'                      19510513
195106            AND  B.FUNC_PRC_STAT_CDE = 'AC'                       19510613
195107            AND  C.LOC_ID            =  :KRPRPM-LOC-ID            19510713
195108            AND  C.SYS_PRC_FUNC_CDE  = 'SMLLN3'                   19510813
195109            AND  C.INTFC_SYS_CDE     = 'KHL'                      19510913
195110            AND  C.FUNC_PRC_STAT_CDE = 'AC'                       19511013
195111          WITH UR                                                 19511113
195112     END-EXEC                                                     19511213
195113                                                                  19511313
195114     EVALUATE TRUE                                                19511413
195115         WHEN SQLCODE = ZERO                                      19511513
195116              SET  ASC-MFST-TRACK-YES  TO  TRUE                   19511613
195117         WHEN SQLCODE = +100                                      19511713
195118              MOVE SPACES  TO  PV-GENERIC-SML-LINE-1              19511813
195119                               PV-GENERIC-SML-LINE-2              19511913
195120                               PV-GENERIC-SML-LINE-3              19512013
195121         WHEN SQLCODE = -904                                      19512113
195122         WHEN SQLCODE = -911                                      19512213
195123         WHEN SQLCODE = -913                                      19512313
195124              MOVE SPACES  TO  PV-GENERIC-SML-LINE-1              19512413
195125                               PV-GENERIC-SML-LINE-2              19512513
195126                               PV-GENERIC-SML-LINE-3              19512613
195127             MOVE '3920-GET-GENERIC-SML-LINES'                    19512713
195128                             TO DP013-PARAGRAPH                   19512813
195129             MOVE 'GENERIC SML DESC-SMLLN1-3 '                    19512913
195130                             TO DP013-MESSAGE-TEXT (1)            19513013
195131             MOVE SQLCA      TO DP013-SQLCA                       19513113
195132             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          19513213
195133             SET DP013-DB2-ABEND                                  19513313
195134                             TO TRUE                              19513413
195135             SET DP013-XCTL-DISPLAY-RESTART                       19513513
195136                             TO TRUE                              19513613
195137             PERFORM DP013-0000-PROCESS-ABEND                     19513713
195138         WHEN SQLWARN0 NOT = SPACES                               19513813
195139         WHEN SQLCODE < ZERO                                      19513913
195140         WHEN SQLCODE > ZERO                                      19514013
195141             MOVE '3920-GET-GENERIC-SML-LINES'                    19514114
195142                             TO DP013-PARAGRAPH                   19514213
195143             MOVE 'GENERIC SML DESC-SMLLN1-3 '                    19514313
195144                             TO DP013-MESSAGE-TEXT (1)            19514413
195145             MOVE SQLCA      TO DP013-SQLCA                       19514513
195146             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)          19514613
195147             SET DP013-DB2-ABEND                                  19514713
195148                             TO TRUE                              19514813
195149             SET DP013-XCTL-DISPLAY-RESTART                       19514913
195150                             TO TRUE                              19515013
195151             PERFORM DP013-0000-PROCESS-ABEND                     19515113
195152     END-EVALUATE.                                                19515213
195153                                                                  19515313
195154                                                                  19515413
195155                                                                  19515513
195160*----------------------------------------------------------------*19516013
195200*    SELECT THE NEW MANIFEST NUMBER.  THE NUMBER OF LABELS WILL  *19520009
195300*    BE SUBTRACTED BACK OUT TO ARRIVE AT THE SETTING BEFORE THE  *19530009
195400*    MANIFEST NUMBER WAS UPDATED.  IT IS MANDATORY THAT THE      *19540009
195500*    MANIFEST NUMBER ALWAYS BE UNIQUE, SO IF THE SELECT WERE DONE*19550009
195600*    BEFORE THE UPDATE, SOMEONE COULD GET IN AND UPDATE THE      *19560009
195700*    NUMBER BEFORE THIS PROGRAM COULD UPDATE THE TABLE.  THIS    *19570009
195800*    WAY THE TABLE IS LOCKED FROM THE UPDATE AND DATA INTEGRITY  *19580009
195900*    IS MAINTAINED.                                              *19590009
196000*                                                                *19600009
196100*    PERFORMED BY 3000-PROCESS-PANEL.                            *19610009
196200*----------------------------------------------------------------*19620009
196300                                                                  19630009
196400                                                                  19640009
196500*    *----------------------------------------------------*       19650009
196600*    * SET THE COMMON SHIP MANIFEST LABEL FORMAT TO TRUE, *       19660009
196700*    * AND FILL IN THE GENERIC INFORMATION                *       19670009
196800*    *----------------------------------------------------*       19680009
196900 4000-SETUP-COM-LABEL.                                            19690009
197000                                                                  19700009
197100     SET PC140-COMMON-MFST-LBL-NBR TO TRUE.                       19710009
197200                                                                  19720009
197300     MOVE ASC-MANIFEST-TRACKING    TO PC140-MANIFEST-TRACKING.    19730009
197400     MOVE ASC-PRTR-ID              TO PC140-SML-PRTR-ID.          19740009
197500     MOVE ASC-STR-NAME-CHAR10-ABBR TO PC140-SML-STR-NAME.         19750009
197600     MOVE ASC-MFST-NBR             TO PC140-SML-STRT-MFST-NBR.    19760009
197700     MOVE ASC-NO-OF-LBLS-N         TO PC140-SML-TOT-CART.         19770009
197800     MOVE ASC-OPER-UNT-ID          TO PC140-SML-ORIGIN-DC.        19780009
197900     MOVE ASC-SEASONAL-SET-SHORT-NAME                             19790009
198000                                   TO PC140-SML-SHORT-NAME.       19800009
198100     MOVE ASC-DIVERT-PFX-NBR       TO PC140-SML-DIVERT-PFX.       19810009
198200     MOVE ASC-SSCC-18-IND          TO PC140-CRA-DC-SSCC-18-IND.   19820009
198300                                                                  19830009
198400     MOVE SPACES                   TO PC140-SML-ZNE-LINE-1        19840009
198500                                      PC140-SML-ZNE-LINE-2        19850009
198600                                      PC140-SML-ZNE-LINE-3.       19860009
198700                                                                  19870009
198800     IF  ASC-SEASONAL-SET-SHORT-NAME > SPACES                     19880009
198900         SET PC140-CRA-SPC-INSTR          TO TRUE                 19890009
199000         MOVE ASC-SEASONAL-SET-SHORT-NAME                         19900013
199010                                       TO PC140-SML-ZNE-LINE-1    19901013
199100         IF ASC-SPEC-INST-LINE-1  >  SPACES                       19910009
199200         OR ASC-SPEC-INST-LINE-2  >  SPACES                       19920009
199300             MOVE ASC-SPEC-INST-LINE-1 TO PC140-SML-ZNE-LINE-2    19930009
199400             MOVE ASC-SPEC-INST-LINE-2 TO PC140-SML-ZNE-LINE-3    19940009
199500         END-IF                                                   19950009
199600     ELSE                                                         19960009
199700         IF  ASC-SPEC-INST-LINE-1  >  SPACES                      19970009
199800         OR  ASC-SPEC-INST-LINE-2  >  SPACES                      19980009
199900             SET PC140-CRA-SPC-INSTR   TO TRUE                    19990009
200000             MOVE ASC-SPEC-INST-LINE-1 TO PC140-SML-ZNE-LINE-1    20000009
200100             MOVE ASC-SPEC-INST-LINE-2 TO PC140-SML-ZNE-LINE-2    20010009
200200         ELSE                                                     20020009
200201* DMH 07/18/2018 - BEGIN                                          20020141
200210             IF  PS-AMAZON-RETURN-CENTER-YES                      20021041
200220                 MOVE  ASC-LABEL-LINE-1                           20022041
200230                                       TO PC140-SML-ZNE-LINE-1    20023041
200240                 MOVE  ASC-LABEL-LINE-2                           20024041
200250                                       TO PC140-SML-ZNE-LINE-2    20025041
200260                 MOVE  ASC-LABEL-LINE-3                           20026041
200270                                       TO PC140-SML-ZNE-LINE-3    20027041
200271* DMH 07/18/2018 - BEGIN                                          20027141
200280             ELSE                                                 20028041
200300                 PERFORM 3920-GET-GENERIC-SML-LINES               20030041
200310                 MOVE  PV-GENERIC-SML-LINE-1                      20031041
200311                                       TO PC140-SML-ZNE-LINE-1    20031113
200320                 MOVE  PV-GENERIC-SML-LINE-2                      20032041
200321                                       TO PC140-SML-ZNE-LINE-2    20032113
200330                 MOVE  PV-GENERIC-SML-LINE-3                      20033041
200340                                       TO PC140-SML-ZNE-LINE-3    20034013
200350             END-IF                                               20035041
200400         END-IF                                                   20040009
200500     END-IF.                                                      20050009
200600                                                                  20060009
200700     IF  ASC-ALL-STORES        OR                                 20070009
200800         ASC-LOSS-PREVENTION                                      20080009
200900         MOVE ASC-OPER-UNT-ID-N    TO  PC140-CRA-LOC-ID           20090009
201000     ELSE                                                         20100009
201100         MOVE ASC-STR-NBR          TO  PC140-CRA-LOC-ID           20110009
201200     END-IF.                                                      20120009
201300                                                                  20130009
201400     MOVE ZEROES          TO PV-STORE-NUMBER.                     20140009
201500     MOVE ASC-STR-NBR     TO PV-STORE-NUMBER-3.                   20150009
201600     MOVE ASC-STR-NBR     TO PC140-SML-STR-NBR.                   20160009
201700                                                                  20170009
201710* DMH 2/24/16 BEGIN                                               20171021
201711     MOVE ASC-PARM-DOOR-LABEL  TO  PC140-PARM-DOOR-LABEL.         20171121
201712     MOVE ASC-PARM-SML-ORD     TO  PC140-PARM-SML-ORD.            20171221
201713* DMH 2/24/16 END                                                 20171321
201720                                                                  20172021
201800     PERFORM 4600-LINK-SOCKET-PRINT-ROUTINE.                      20180009
201900                                                                  20190009
202000     MOVE  ZEROES  TO  ASC-MFST-NBR.                              20200009
202100                                                                  20210009
202200                                                                  20220009
220300*----------------------------------------------------------------*22030009
220400*                                                                *22040009
220500*----------------------------------------------------------------*22050009
220600 4600-LINK-SOCKET-PRINT-ROUTINE.                                  22060009
220700                                                                  22070009
220800     IF  ASC-MFST-TRACK-YES                                       22080009
220810         PERFORM 4765-TRACK-LBL-REQ                               22081009
220820     END-IF.                                                      22082009
220830                                                                  22083009
220840     MOVE DP020-USERID           TO PC140-CRA-USERID.             22084009
220850     MOVE 400                    TO PV-COMMAREA-LENGTH.           22085009
220860                                                                  22086009
220870     EXEC CICS                                                    22087009
220880          LINK PROGRAM  ('PCKCS707')                              22088009
220890               COMMAREA (PC140-LABELMST)                          22089009
220900               LENGTH   (PV-COMMAREA-LENGTH)                      22090009
221000               RESP     (PV-CICS-RESPONSE)                        22100009
221100     END-EXEC.                                                    22110009
221200                                                                  22120009
221300     EVALUATE TRUE                                                22130009
221400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22140009
221500              CONTINUE                                            22150009
221600         WHEN OTHER                                               22160009
221700              PERFORM DP013-0000-PROCESS-ABEND                    22170009
221800     END-EVALUATE.                                                22180009
221900     IF PC140-CRA-SOCKET-COMM-ERROR                               22190009
222000         SET PS-ERROR            TO TRUE                          22200009
222100         SET DP020-MSG-FATAL     TO TRUE                          22210009
222200         MOVE PC-TSYMSG-02122    TO DP020-MSG-NUMBER              22220009
222300         MOVE DP015-UNP-NUM-BRT-OFF                               22230009
222400                                 TO APRTRA                        22240009
222500         MOVE DP015-RED          TO APRTRC                        22250009
222600         MOVE DP015-REVERSE      TO APRTRH                        22260009
222700         IF  ASC-PRTR-ID-N  > 0                                   22270009
222800             MOVE -1             TO ASTRL                         22280009
222900         ELSE                                                     22290009
223000             MOVE -1             TO APRTRL                        22300009
223100         END-IF                                                   22310009
223200         SET DP030-SET-CURSOR-APPL-1                              22320009
223300                                 TO TRUE                          22330009
223400     ELSE                                                         22340009
223500     IF PC140-CRA-INVALID-PRT-FMT                                 22350009
223600         SET PS-ERROR            TO TRUE                          22360009
223700         SET DP020-MSG-FATAL     TO TRUE                          22370009
223800         MOVE DP015-UNP-NUM-BRT-OFF                               22380009
223900                                 TO APRTRA                        22390009
224000         MOVE DP015-RED          TO APRTRC                        22400009
224100         MOVE DP015-REVERSE      TO APRTRH                        22410009
224200         IF  ASC-PRTR-ID-N  > 0                                   22420009
224300             MOVE -1             TO ASTRL                         22430009
224400         ELSE                                                     22440009
224500             MOVE -1             TO APRTRL                        22450009
224600         END-IF                                                   22460009
224700         SET DP030-SET-CURSOR-APPL-1                              22470009
224800                                 TO TRUE                          22480009
224900         MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                22490009
225000         MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                22500009
225100         MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT            22510009
225200     ELSE                                                         22520009
225300         SET DP020-MSG-INFORMATIONAL TO TRUE                      22530009
225400         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              22540009
225500         IF  ASC-PRTR-ID-N  > 0                                   22550009
225600             MOVE -1             TO ASTRL                         22560009
225700         ELSE                                                     22570009
225800             MOVE -1             TO APRTRL                        22580009
225900         END-IF                                                   22590009
226000         SET DP030-SET-CURSOR-APPL-1                              22600009
226100                                 TO TRUE                          22610009
226200     END-IF.                                                      22620009
226300                                                                  22630009
226400*----------------------------------------------------------------*22640009
226500*  LINK PCKCS721.                                                 22650009
226600*----------------------------------------------------------------*22660009
226700 4750-LINK-PCKCS721.                                              22670009
226800                                                                  22680009
226900     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   22690009
227000                                                                  22700009
227100     EXEC CICS                                                    22710009
227200         LINK PROGRAM  (PV-PCKCS721)                              22720009
227300              COMMAREA (PC187-COMMAREA-REC)                       22730009
227400              LENGTH   (PV-COMMAREA-LENGTH)                       22740009
227500              RESP     (PV-CICS-RESPONSE)                         22750009
227600     END-EXEC.                                                    22760009
227700                                                                  22770009
227800     EVALUATE TRUE                                                22780009
227900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22790009
228000              IF  PC187-CRA-SUCCESSFUL                            22800009
228100                  CONTINUE                                        22810009
228200              ELSE                                                22820009
228300                  SET PV-DONE-PROCESSING          TO TRUE         22830009
228400                  SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE         22840009
228500                  MOVE SQLCODE              TO PV-SQL-CODE        22850009
228600                  STRING ' PCKCS116 - '        DELIMITED BY SIZE  22860009
228700                         '4750-LINK-PCKCS721 ' DELIMITED BY SIZE  22870009
228800                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  22880009
228900                         PC187-CRA-RET-MSG     DELIMITED BY SIZE  22890009
229000                         '  PARA-'             DELIMITED BY SIZE  22900009
229100                         PC187-CRA-REQ-ID      DELIMITED BY SIZE  22910009
229200                                          INTO PV-CICS-MSG-AREA   22920009
229300                  MOVE LENGTH OF PV-CICS-MSG-AREA                 22930009
229400                                            TO PV-COMMAREA-LENGTH 22940009
229500                  PERFORM 9990-WRITE-CICS                         22950009
229600*                                                                 22960009
229700** DMH - 12/6/12 BEGIN                                            22970009
229800                  SET PS-ERROR            TO TRUE                 22980009
229900                  SET DP020-MSG-FATAL     TO TRUE                 22990009
230000                  MOVE PC-TSYMSG-00984                            23000009
230100                                          TO DP020-MSG-NUMBER     23010009
230200                  MOVE DP015-UNP-NUM-BRT-OFF                      23020009
230300                                          TO ALBLSA               23030009
230400                  MOVE DP015-RED          TO ALBLSC               23040009
230500                  MOVE DP015-REVERSE      TO ALBLSH               23050009
230600                  MOVE -1                 TO ALBLSL               23060009
230700                 SET DP030-SET-CURSOR-APPL-1                      23070009
230800                                          TO TRUE                 23080009
230900** DMH - 12/6/12 END                                              23090009
231000*                                                                 23100009
231100              END-IF                                              23110009
231200         WHEN OTHER                                               23120009
231300              SET PV-DONE-PROCESSING          TO TRUE             23130009
231400              SET PC140-CRA-SOCKET-COMM-ERROR TO TRUE             23140009
231500              MOVE SQLCODE              TO PV-SQL-CODE            23150009
231600              STRING ' PCKCS116 (OTHER) -' DELIMITED BY SIZE      23160009
231700                     '4750-LINK-PCKCS721 ' DELIMITED BY SIZE      23170009
231800                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      23180009
231900                     PC187-CRA-RET-MSG     DELIMITED BY SIZE      23190009
232000                     '  PARA-'             DELIMITED BY SIZE      23200009
232100                     PC187-CRA-REQ-ID      DELIMITED BY SIZE      23210009
232200                                      INTO PV-CICS-MSG-AREA       23220009
232300              MOVE LENGTH OF PV-CICS-MSG-AREA                     23230009
232400                                        TO PV-COMMAREA-LENGTH     23240009
232500              PERFORM 9990-WRITE-CICS                             23250009
232600*                                                                 23260009
232700** DMH - 12/6/12 BEGIN                                            23270009
232800                  SET PS-ERROR            TO TRUE                 23280009
232900                  SET DP020-MSG-FATAL     TO TRUE                 23290009
233000                  MOVE PC-TSYMSG-00984                            23300009
233100                                          TO DP020-MSG-NUMBER     23310009
233200                  MOVE DP015-UNP-NUM-BRT-OFF                      23320009
233300                                          TO ALBLSA               23330009
233400                  MOVE DP015-RED          TO ALBLSC               23340009
233500                  MOVE DP015-REVERSE      TO ALBLSH               23350009
233600                  MOVE -1                 TO ALBLSL               23360009
233700                 SET DP030-SET-CURSOR-APPL-1                      23370009
233800                                          TO TRUE                 23380009
233900** DMH - 12/6/12 END                                              23390009
234000*                                                                 23400009
234100     END-EVALUATE.                                                23410009
234200                                                                  23420009
234300***                                                               23430009
234400* BEGIN 2/19/13 DMH                                               23440009
234500* REDUCE BACK TO ORIGINAL REQUESTED AMOUNT                        23450009
234600* TRYING TO RESOLVE PRINTER ISSUE CAUSING DUPLICATE LABELS        23460009
234700*                                                                 23470009
234710                SUBTRACT  1  FROM  PC187-NO-OF-LBLS               23471009
234720                SUBTRACT  1  FROM  PC187-END-MFST-NBR             23472009
234730* END 2/19/13 DMH                                                 23473009
234740***                                                               23474009
234750                                                                  23475009
234760     IF  ASC-MFST-TRACK-YES                                       23476009
234770         PERFORM 4760-TRACK-MANIFEST                              23477009
234780     END-IF.                                                      23478009
234790                                                                  23479009
234800                                                                  23480009
234900*----------------------------------------------------------------*23490009
235000*                                                                 23500009
235100*----------------------------------------------------------------*23510009
235200 4760-TRACK-MANIFEST.                                             23520009
235300                                                                  23530009
235400     IF  ASC-ALL-STORES                                           23540009
235500         SET  PC263-SML-ALL-STORES  TO  TRUE                      23550009
235600     ELSE                                                         23560009
235700         SET  PC263-SML-SINGLE-STORE TO TRUE                      23570009
235800     END-IF.                                                      23580009
235900                                                                  23590009
236000     MOVE DP020-USERID              TO  PC263-USER-ID.            23600009
236100     MOVE PC187-STR-NBR             TO  PC263-STR-NBR.            23610009
236200     MOVE PC187-NO-OF-LBLS          TO  PC263-NO-OF-LBLS.         23620009
236300     MOVE ASC-PRTR-ID               TO  PC263-PRTR-ID.            23630009
236400     MOVE PC187-START-MFST-NBR      TO  PC263-START-MFST-NBR.     23640009
236500     MOVE PC187-END-MFST-NBR        TO  PC263-END-MFST-NBR.       23650009
236600     MOVE SQLCODE                   TO  PC263-SQLCODE.            23660009
236700     MOVE PC187-CRA-RET-CDE         TO  PC263-CRA-RET-CDE.        23670009
236800     MOVE PC187-CRA-RET-MSG         TO  PC263-CRA-RET-MSG.        23680009
236900     MOVE PC187-CRA-REQ-ID          TO  PC263-CRA-REQ-ID.         23690009
237000                                                                  23700009
237100     MOVE ASC-OPER-UNT-ID-N         TO UPLDER-OPER-UNT-ID.        23710009
237200     MOVE 'G'                       TO UPLDER-UPLD-TRN-CDE.       23720009
237300     MOVE '101'                     TO UPLDER-ERR-CDE.            23730009
237400     MOVE PC263-UPLOAD-ERROR-RECORD TO UPLDER-PKT-TXT.            23740009
237500     ADD  1                         TO UPLDER-UPLD-SEQ-NBR.       23750009
237600                                                                  23760009
237700     EXEC SQL                                                     23770009
237800         INSERT                                                   23780009
237900           INTO TUPLDER                                           23790009
238000             ( OPER_UNT_ID                                        23800009
238100             , UPLD_TRN_CDE                                       23810009
238200             , ERR_CDE                                            23820009
238300             , PRC_TMST                                           23830009
238400             , UPLD_SEQ_NBR                                       23840009
238500             , PKT_TXT                                            23850009
238600             )                                                    23860009
238700             VALUES                                               23870009
238800             ( :UPLDER-OPER-UNT-ID                                23880009
238900             , :UPLDER-UPLD-TRN-CDE                               23890009
239000             , :UPLDER-ERR-CDE                                    23900009
239100             ,  CURRENT TIMESTAMP                                 23910009
239200             , :UPLDER-UPLD-SEQ-NBR                               23920009
239300             , :UPLDER-PKT-TXT                                    23930009
239400             )                                                    23940009
239500     END-EXEC.                                                    23950009
239600                                                                  23960009
239700     EVALUATE TRUE                                                23970009
239800         WHEN SQLCODE = ZERO                                      23980009
239900             CONTINUE                                             23990009
240000         WHEN SQLCODE = -904                                      24000009
240100         WHEN SQLCODE = -911                                      24010009
240200         WHEN SQLCODE = -913                                      24020009
240300             MOVE '4760-TRACK-MANIFEST'                           24030009
240400                             TO DP013-PARAGRAPH                   24040009
240500             MOVE 'TRACK CARTON MANIFEST NBRS'                    24050009
240600                             TO DP013-MESSAGE-TEXT (1)            24060009
240700             MOVE SQLCA      TO DP013-SQLCA                       24070009
240800             MOVE 'TUPLDER'  TO DP013-DB2-TABLE-NAME (1)          24080009
240900             SET DP013-DB2-ABEND                                  24090009
241000                             TO TRUE                              24100009
241100             SET DP013-XCTL-DISPLAY-RESTART                       24110009
241200                             TO TRUE                              24120009
241300             PERFORM DP013-0000-PROCESS-ABEND                     24130009
241400         WHEN SQLWARN0 NOT = SPACES                               24140009
241500         WHEN SQLCODE < ZERO                                      24150009
241600         WHEN SQLCODE > ZERO                                      24160009
241700             MOVE '4760-TRACK-MANIFEST      '                     24170009
241800                             TO DP013-PARAGRAPH                   24180009
241900             MOVE 'TRACK CARTON MANIFEST NBRS'                    24190009
242000                             TO DP013-MESSAGE-TEXT (1)            24200009
242100             MOVE SQLCA      TO DP013-SQLCA                       24210009
242200             MOVE 'TUPLDER'  TO DP013-DB2-TABLE-NAME (1)          24220009
242300             SET DP013-DB2-ABEND                                  24230009
242400                             TO TRUE                              24240009
242500             SET DP013-XCTL-DISPLAY-RESTART                       24250009
242600                             TO TRUE                              24260009
242700             PERFORM DP013-0000-PROCESS-ABEND                     24270009
242800     END-EVALUATE.                                                24280009
242900                                                                  24290009
243000                                                                  24300009
243100*----------------------------------------------------------------*24310009
243200*                                                                 24320009
243300*----------------------------------------------------------------*24330009
243400 4765-TRACK-LBL-REQ.                                              24340009
243500                                                                  24350009
243510     IF  ASC-ALL-STORES                                           24351009
243520         SET  PC263-SML-ALL-STORES  TO  TRUE                      24352009
243530     ELSE                                                         24353009
243540         SET  PC263-SML-SINGLE-STORE TO TRUE                      24354009
243550     END-IF.                                                      24355009
243560                                                                  24356009
243570     MOVE DP020-USERID              TO  PC263-USER-ID.            24357009
243580     MOVE PC187-STR-NBR             TO  PC263-STR-NBR.            24358009
243590     MOVE PC187-NO-OF-LBLS          TO  PC263-NO-OF-LBLS.         24359009
243591     MOVE ASC-PRTR-ID               TO  PC263-PRTR-ID.            24359109
243592     MOVE PC187-START-MFST-NBR      TO  PC263-START-MFST-NBR.     24359209
243593     MOVE PC187-END-MFST-NBR        TO  PC263-END-MFST-NBR.       24359309
243594     MOVE SQLCODE                   TO  PC263-SQLCODE.            24359409
243595     MOVE PC187-CRA-RET-CDE         TO  PC263-CRA-RET-CDE.        24359509
243596     MOVE PC187-CRA-RET-MSG         TO  PC263-CRA-RET-MSG.        24359609
243597     MOVE PC187-CRA-REQ-ID          TO  PC263-CRA-REQ-ID.         24359709
243598                                                                  24359809
243599     MOVE ASC-OPER-UNT-ID-N         TO UPLDER-OPER-UNT-ID.        24359909
243600     MOVE 'G'                       TO UPLDER-UPLD-TRN-CDE.       24360009
243601     MOVE '103'                     TO UPLDER-ERR-CDE.            24360109
243602     MOVE PC263-UPLOAD-ERROR-RECORD TO UPLDER-PKT-TXT.            24360209
243603     ADD  1                         TO UPLDER-UPLD-SEQ-NBR.       24360309
243604                                                                  24360409
243605     EXEC SQL                                                     24360509
243606         INSERT                                                   24360609
243607           INTO TUPLDER                                           24360709
243608             ( OPER_UNT_ID                                        24360809
243609             , UPLD_TRN_CDE                                       24360909
243610             , ERR_CDE                                            24361009
243611             , PRC_TMST                                           24361109
243612             , UPLD_SEQ_NBR                                       24361209
243613             , PKT_TXT                                            24361309
243614             )                                                    24361409
243615             VALUES                                               24361509
243616             ( :UPLDER-OPER-UNT-ID                                24361609
243617             , :UPLDER-UPLD-TRN-CDE                               24361709
243618             , :UPLDER-ERR-CDE                                    24361809
243619             ,  CURRENT TIMESTAMP                                 24361909
243620             , :UPLDER-UPLD-SEQ-NBR                               24362009
243621             , :UPLDER-PKT-TXT                                    24362109
243622             )                                                    24362209
243623     END-EXEC.                                                    24362309
243624                                                                  24362409
243625     EVALUATE TRUE                                                24362509
243626         WHEN SQLCODE = ZERO                                      24362609
243627             CONTINUE                                             24362709
243628         WHEN SQLCODE = -904                                      24362809
243629         WHEN SQLCODE = -911                                      24362909
243630         WHEN SQLCODE = -913                                      24363009
243631             MOVE '4765-TRACK-LBL-REQ'                            24363109
243632                             TO DP013-PARAGRAPH                   24363209
243633             MOVE 'TRACK CARTON MANIFEST NBRS'                    24363309
243634                             TO DP013-MESSAGE-TEXT (1)            24363409
243635             MOVE SQLCA      TO DP013-SQLCA                       24363509
243636             MOVE 'TUPLDER'  TO DP013-DB2-TABLE-NAME (1)          24363609
243637             SET DP013-DB2-ABEND                                  24363709
243638                             TO TRUE                              24363809
243639             SET DP013-XCTL-DISPLAY-RESTART                       24363909
243640                             TO TRUE                              24364009
243641             PERFORM DP013-0000-PROCESS-ABEND                     24364109
243642         WHEN SQLWARN0 NOT = SPACES                               24364209
243643         WHEN SQLCODE < ZERO                                      24364309
243644         WHEN SQLCODE > ZERO                                      24364409
243645             MOVE '4765-TRACK-LBL-REQ       '                     24364509
243646                             TO DP013-PARAGRAPH                   24364609
243647             MOVE 'TRACK CARTON MANIFEST NBRS'                    24364709
243648                             TO DP013-MESSAGE-TEXT (1)            24364809
243649             MOVE SQLCA      TO DP013-SQLCA                       24364909
243650             MOVE 'TUPLDER'  TO DP013-DB2-TABLE-NAME (1)          24365009
243651             SET DP013-DB2-ABEND                                  24365109
243652                             TO TRUE                              24365209
243653             SET DP013-XCTL-DISPLAY-RESTART                       24365309
243654                             TO TRUE                              24365409
243655             PERFORM DP013-0000-PROCESS-ABEND                     24365509
243656     END-EVALUATE.                                                24365609
243657                                                                  24365709
243658                                                                  24365809
243659*----------------------------------------------------------------*24365909
243660*                                                                 24366009
243670*----------------------------------------------------------------*24367009
243680 9990-WRITE-CICS.                                                 24368009
243690     MOVE LENGTH OF PV-CICS-MSG-AREA  TO  PV-COMMAREA-LENGTH.     24369009
243700                                                                  24370009
243800     EXEC CICS WRITEQ TD                                          24380009
243900                      QUEUE('CSSL')                               24390009
244000                      FROM(PV-CICS-MSG-AREA)                      24400009
244100                      LENGTH(PV-COMMAREA-LENGTH)                  24410009
244200                      RESP (PV-CICS-RESPONSE)                     24420009
244300     END-EXEC.                                                    24430009
244400                                                                  24440009
244500     MOVE SPACES TO PV-CICS-MSG-AREA.                             24450009
244600*----------------------------------------------------------------*24460009
244700*    ABEND PROCESSOR MODULE                                      *24470009
244800*----------------------------------------------------------------*24480009
244900                                                                  24490009
245000     COPY DPPD013.                                                24500009
