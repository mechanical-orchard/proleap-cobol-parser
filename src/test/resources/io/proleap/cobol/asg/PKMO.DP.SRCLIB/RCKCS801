000100 IDENTIFICATION DIVISION.                                         00010074
000200 PROGRAM-ID.    RCKCS801.                                         00020074
000300 AUTHOR.        KAREN WALL                                        00030074
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040074
000500 DATE-WRITTEN.  09-01-99.                                         00050074
000600 DATE-COMPILED.                                                   00060074
000700                                                                  00070074
000800*---------------------------------------------------------------* 00080074
000900*    E801 - RECEIVER PACK DETAIL LIST PROGRAM                   * 00090074
001000*                                                               * 00100074
001100*    THIS PROGRAM GENERATES A LIST OF RECEIPT ITEMS FOR A       * 00110074
001200*    RECEIVER BASED ON ITEMS THAT ARE WITHIN THE PACK ID.       * 00120074
001300*                                                               * 00130074
001400*---------------------------------------------------------------* 00140074
001500* MAINTENANCE:                                                  * 00150074
001600*    DAVID FELLENZ 07/07/14   CHG0081355                        * 00160099
001700*      MTK PROJECT - PACKAGE CODE CHANGES.                      * 00170099
001800*        CHANGES IN PARAGRAPHS:                                 * 00180099
001900*            2104-CALC-QUICKCALC-VALUES                         * 00190099
002000*            4340-MOVE-HEAD-N-TOT-TO-COMM                       * 00200099
002100*            4423-CALL-VALIDATION-MODULE                        * 00210099
002200***************************************************************** 00220099
002300*  CHANGED 10/20/2014 BY CHERI PARMLEY                          * 00230099
002400*   CHG# 0094517  EXPANDED PO FROM 7 TO 8 DIGITS                * 00240099
002500*                 ONLY TO WRITE TO CICS LOG IF ERROR            * 00250099
002600*---------------------------------------------------------------* 00260074
002620* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00262099
002630* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00263099
002640* MAKING THE CALL DYNAMIC VS STATIC.                              00264099
002650*---------------------------------------------------------------* 00265099
002700/                                                                 00270074
002800 ENVIRONMENT DIVISION.                                            00280074
002900                                                                  00290074
003000 DATA DIVISION.                                                   00300074
003100                                                                  00310074
003200 WORKING-STORAGE SECTION.                                         00320074
003300                                                                  00330074
003400 01  DK-DB2-KEYS.                                                 00340074
003500*    REQUIRED FIELDS                                              00350074
003600     05  DK-ORD-NBR                     PIC S9(09)  COMP.         00360074
003700     05  DK-RCVR-SEQ-NBR                PIC S9(09)  COMP.         00370074
003800     05  DK-LINE-NBR                    PIC S9(04)  COMP.         00380074
003900     05  DK-OPR-ID                      PIC S9(04)  COMP.         00390074
004000     05  DK-FACT                        PIC S9(04)  COMP.         00400074
004100     05  DK-PACK-ID                     PIC S9(04)  COMP.         00410074
004200                                                                  00420074
004300 01  PC-PROGRAM-CONSTANTS.                                        00430074
004400     05  PC-CURRENT-MAP-NAME            PIC  X(08) VALUE          00440074
004500                                                    'RC801A  '.   00450074
004600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08) VALUE          00460074
004700                                                    'RCKM801 '.   00470074
004800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08) VALUE          00480074
004900                                                    'RCKCS801'.   00490074
005000     05  PC-CURRENT-PROGRAM-ERROR       PIC  X(03) VALUE '801'.   00500074
005100     05  PC-TROUBLE-RTN                 PIC X(08)  VALUE          00510074
005200                                                       'TMKCS520'.00520074
005300     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00530098
005400     05  PC-TROUBLE-RTN-LENGTH          PIC S9(04) VALUE +600     00540074
005500                                                   COMP.          00550074
005600     05  PC-AUDIT-RTN                   PIC X(08)  VALUE          00560074
005700                                                       'RCKCS290'.00570074
005800     05  PC-AUDIT-RTN-LENGTH          PIC S9(4) VALUE +300        00580074
005900                                                COMP SYNC.        00590074
006000     05  PC-CONVERT-PGM                 PIC X(08)  VALUE          00600074
006100                                                       'RCKCS811'.00610074
006200     05  PC-APPL-MAP                    PIC S9(04) VALUE  +1      00620074
006300                                                    COMP.         00630074
006400     05  PC-LIST-QUEUE-SEQ              PIC  9(01) VALUE 1.       00640074
006500     05  PC-SEL-QUEUE-SEQ               PIC  9(01) VALUE 2.       00650074
006600     05  PC-INTER-APPL-CODES.                                     00660074
006700         10 PC-INTER-APPL-PACK-UPD      PIC  X(01) VALUE '1'.     00670074
006800     05  PC-WORK-ORDER-DIST-SHEET       PIC  9(03) VALUE 001.     00680074
006900     05  PC-ITEMS-PER-PANEL             PIC S9(04) VALUE +7       00690074
007000                                                   COMP SYNC.     00700074
007100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04) VALUE +2       00710074
007200                                                    COMP SYNC.    00720074
007300     05  PC-MAX-ITEMS                   PIC S9(09) VALUE          00730074
007400                                                    +1000000      00740074
007500                                                    COMP-3.       00750074
007600     05  PC-MSG-NUMBER-LENGTH           PIC S9(04) VALUE +7       00760074
007700                                                   COMP SYNC.     00770074
007800     05  PC-MAX-RETRIES                 PIC S9(03) VALUE +3       00780074
007900                                                    COMP-3.       00790074
008000     05  PC-DEFAULT-TMST                PIC  X(26) VALUE          00800074
008100                                   '9999-09-09-09.09.09.999999'.  00810074
008200     05  PC-DEFAULT-DATE                PIC  X(10) VALUE          00820074
008300                                                '9999-09-09'.     00830074
008400     05  PC-OP-CO-NBR                   PIC  X(02)  VALUE '03'.   00840074
008500     05  PC-INACTIVE                    PIC X(01)  VALUE 'I'.     00850074
008600     05  PC-A                           PIC  X(01) VALUE 'A'.     00860074
008700     05  PC-B                           PIC  X(01) VALUE 'B'.     00870074
008800     05  PC-C                           PIC  X(01) VALUE 'C'.     00880074
008900     05  PC-M                           PIC  X(01) VALUE 'M'.     00890074
009000     05  PC-N                           PIC  X(01) VALUE 'N'.     00900074
009100     05  PC-I                           PIC  X(01) VALUE 'I'.     00910074
009200     05  PC-R                           PIC  X(01) VALUE 'R'.     00920074
009300     05  PC-S                           PIC  X(01) VALUE 'S'.     00930074
009400     05  PC-T                           PIC  X(01) VALUE 'T'.     00940074
009500     05  PC-U                           PIC  X(01) VALUE 'U'.     00950074
009600     05  PC-X                           PIC  X(01) VALUE 'X'.     00960074
009700     05  PC-Y                           PIC  X(01) VALUE 'Y'.     00970074
009800     05  PC-RV                          PIC  X(02) VALUE 'RV'.    00980074
009900     05  PC-INQ                         PIC  X(03) VALUE 'INQ'.   00990074
010000     05  PC-UPD                         PIC  X(03) VALUE 'UPD'.   01000074
010100     05  PC-DEL                         PIC  X(03) VALUE 'DEL'.   01010074
010200     05  PC-ERR                         PIC  X(03) VALUE 'ERR'.   01020074
010300     05  PC-VE                          PIC  X(02) VALUE 'VE'.    01030074
010400     05  PC-MULTIPLE-SKU-PPK            PIC  X(01) VALUE 'M'.     01040074
010500     05  PC-INNER-PPK                   PIC  X(01) VALUE 'I'.     01050074
010600     05  PC-PKG-NOT-FOUND               PIC  X(01) VALUE ' '.     01060074
010700                                                                  01070074
010800     05  PC-TSYMSG-NUMBERS.                                       01080074
010900         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01090074
011000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01100074
011100         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01110074
011200         10  PC-TSYMSG-00046            PIC  9(05)  VALUE 00046.  01120074
011300         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01130074
011400         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01140074
011500         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01150074
011600         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01160074
011700         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01170074
011800         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01180074
011900         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01190074
012000         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01200074
012100*            UPDATE(S) SUCCESSFUL                                 01210074
012200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01220074
012300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01230074
012400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01240074
012500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01250074
012600         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01260086
012700         10  PC-TSYMSG-00354            PIC  9(05)  VALUE 00354.  01270074
012800*  DELETE PENDING - F2 TO CONFIRM                                 01280074
012900         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01290074
013000         10  PC-TSYMSG-00736            PIC  9(05)  VALUE 00736.  01300074
013100         10  PC-TSYMSG-00737            PIC  9(05)  VALUE 00737.  01310074
013200         10  PC-TSYMSG-00815            PIC  9(05)  VALUE 00737.  01320074
013300         10  PC-TSYMSG-00854            PIC  9(05)  VALUE 00854.  01330074
013400         10  PC-TSYMSG-00928            PIC  9(05)  VALUE 00928.  01340074
013500         10  PC-TSYMSG-00929            PIC  9(05)  VALUE 00929.  01350074
013600                                                                  01360074
013700         10  PC-TSYMSG-00937          PIC 9(05)  VALUE 00937.     01370074
013800*            UNABLE TO REDISTRO DUE TO TROUBLE                    01380074
013900         10  PC-TSYMSG-00941          PIC 9(05)  VALUE 00941.     01390074
014000*            REDISTRO SUCCESSFUL BUT TROUBLE CREATED              01400074
014100         10  PC-TSYMSG-01196          PIC 9(05)  VALUE 01196.     01410074
014200*            RECEIVER HAS ALREADY BEEN VERIFIED                   01420074
014300         10  PC-TSYMSG-01256          PIC 9(05)  VALUE 01256.     01430074
014400* UPDATE NOT ALLOWED:ADJUSTMENTS HAVE BEEN MADE TO THE VERIFIED QU01440074
014500         10  PC-TSYMSG-01570          PIC 9(05)  VALUE 01570.     01450074
014600* SYSTEM ERROR, CONTACT HELP DESK                                 01460074
014700         10  PC-TSYMSG-01793          PIC 9(05)  VALUE 01793.     01470074
014800* 01793 - UNABLE TO RE-DISTRO - CASEPACK SPLIT PROCESS HAS BEEN   01480074
014900         10  PC-TSYMSG-01795          PIC 9(05)  VALUE 01795.     01490074
015000         10  PC-TSYMSG-02165          PIC 9(05)  VALUE 02165.     01500074
015100         10  PC-TSYMSG-02161          PIC 9(05)  VALUE 02161.     01510074
015200* UPDATE SUCCESSFUL; REDISTRO PERFORMED                           01520074
015300         10  PC-TSYMSG-02166          PIC 9(05)  VALUE 02166.     01530074
015400* ONLY PO WITH PKGNG CODE OF 'I' OR 'M' CAN USE PACK LIST         01540074
015500         10  PC-TSYMSG-02169          PIC 9(05)  VALUE 02169.     01550074
015600* REDISTRO WILL BE PERFORMED-F2 TO CONFIRM UPD AND REDISTRO       01560074
015700         10  PC-TSYMSG-02170          PIC 9(05)  VALUE 02170.     01570074
015800* STORE DISTRO WILL BE ADJUSTED TO NEW RATIO-F2 TO CONFIRM UPD AND01580074
015900* ADJ                                                             01590074
016000         10  PC-TSYMSG-02178          PIC 9(05)  VALUE 02178.     01600074
016100* FUNCTION NOT ALLOWED-PACK DOES NOT EXIST                        01610074
016200         10  PC-TSYMSG-02179          PIC 9(05)  VALUE 02179.     01620074
016300* DETAIL RATIO MUST BE > 0 ON AN UPDATE                           01630074
016400         10  PC-TSYMSG-02171          PIC 9(05)  VALUE 02171.     01640074
016500* RATIO HAS CHANGED BUT NOT DTL UNITS-F2 TO CONFIRM UPD AND ADJ   01650074
016600         10  PC-TSYMSG-02172          PIC 9(05)  VALUE 02172.     01660074
016700* RATIO HAS CHANGED BUT NOT DTL UNITS-F2 TO CONFIRM  UPD AND STORE01670074
016800* ADJ                                                             01680074
016900         10  PC-TSYMSG-02173          PIC 9(05)  VALUE 02173.     01690074
017000* UPD COMPLETE-STORE DISTRO WAS NOT FOUND FOR PACK                01700074
017100         10  PC-TSYMSG-02174          PIC 9(05)  VALUE 02174.     01710074
017200* CAN'T UPDATE LINE/PACK - CASEPACK SPLIT WAS PERFORMED           01720074
017300         10  PC-TSYMSG-02175          PIC 9(05)  VALUE 02175.     01730074
017400* CAN'T REMOVE LINE/PACK - CASEPACK SPLIT WAS PERFORMED           01740074
017500         10  PC-TSYMSG-02177          PIC 9(05)  VALUE 02177.     01750074
017600* QUICKCALC WAS PERFORMED, F15 TO UPDATE OR F5 TO REFRESH         01760074
017700         10  PC-TSYMSG-02180          PIC 9(05)  VALUE 02180.     01770074
017800* PRESS F2 TO CONFIRM DELETE OF ENTIRE PACK                       01780074
017900         10  PC-TSYMSG-02195          PIC 9(05)  VALUE 02195.     01790074
018000* UNTIED LINES, CAN'T UPDATE SEE ANALYST.                         01800074
018100         10  PC-TSYMSG-02228          PIC 9(05)  VALUE 02228.     01810074
018200* UPD COMPLETE-F14 TO REDISTRO OR F17 TO GO TO STORE DISTRO       01820074
018300         10  PC-TSYMSG-02229          PIC 9(05)  VALUE 02229.     01830074
018400* A PREPACK SYSTEM ERROR HAS OCCURRED (&VAR). PLEASE CONTACT HELP 01840074
018500         10  PC-TSYMSG-02239          PIC 9(05)  VALUE 02239.     01850074
018600* UPDATE SUCCESSFUL, REDISTRO NOT PERFORMED DUE TO TROUBLE        01860074
018700         10  PC-TSYMSG-02452          PIC 9(05)  VALUE 02452.     01870074
018800*  ALLOCATION IS INCORRECT; PLEASE REVIEW DISTRO                  01880074
018900         10  PC-TSYMSG-02762          PIC 9(5)   VALUE 02762.     01890074
019000* PACK IS NOT CONFIRMED                                           01900074
019100         10  PC-TSYMSG-03244          PIC  9(05)  VALUE 03244.    01910078
019200*  PACKSLIP EXISTS, DELETION OF LINES/PACKS IS NOT ALLOWED        01920074
019300         10  PC-TSYMSG-03538          PIC  9(05)  VALUE 03538.    01930078
019400*  UNABLE TO DELETE LINE FROM PACK, RCVG HAS BEGUN IN WMS         01940078
019500* JAK 05/2007 - ADD NEW MESSAGES FOR WMS                          01950099
019600         10  PC-TSYMSG-03546            PIC  9(05)  VALUE 03546.  01960099
019700*  ERROR IN WMS DOWNLOAD MOD - CONTACT HELP DESK                  01970099
019800         10  PC-TSYMSG-03569            PIC  9(05)  VALUE 03569.  01980099
019900*  REDISTRO SUCCESSFUL, ASN WILL BE DWNLD TO WMS, BUT TROUBLE     01990099
020000         10  PC-TSYMSG-03570            PIC  9(05)  VALUE 03570.  02000099
020100*  UPD SUCCESSFUL, REDISTRO PERFORMED & WILL BE DOWNLOADED TO WMS 02010099
020200         10  PC-TSYMSG-03578            PIC  9(05)  VALUE 03578.  02020099
020300*  DELETE SUCCESSFULAND WMOS UPDATED ACCORDINGLY                  02030099
020400* JAK 05/2007 - END                                               02040099
020500*----------------------------------------------------------------*02050074
020600* INCLUDED NEW CONSTANTS PC-000 AND PC-999.          WR # 230ZZ  *02060074
020700*----------------------------------------------------------------*02070074
020800     05  PC-000                       PIC X(03) VALUE '000'.      02080074
020900     05  PC-999                       PIC X(03) VALUE '999'.      02090074
021000*----------------------------------------------------------------*02100074
021100* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *02110074
021200*----------------------------------------------------------------*02120074
021300                                                                  02130074
021400                                                                  02140074
021500 01  PS-PROGRAM-SWITCHES.                                         02150074
021600     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02160074
021700         88  PS-NO-ERROR                            VALUE 'Y'.    02170074
021800         88  PS-ERROR                               VALUE 'N'.    02180074
021900     05  PS-PACKSLIP-EXISTS-SW          PIC  X(01)  VALUE 'Y'.    02190074
022000         88  PS-PACKSLIP-EXISTS                     VALUE 'Y'.    02200074
022100         88  PS-PACKSLIP-EXISTS-NO                  VALUE 'N'.    02210074
022200     05  PS-BLOCK-ERROR-SW               PIC  X(01) VALUE 'Y'.    02220074
022300         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02230074
022400         88  PS-BLOCK-ERROR                         VALUE 'N'.    02240074
022500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02250074
022600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02260074
022700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02270074
022800     05  PS-VERIFIED-RECEIVER-SW        PIC  X(01)  VALUE 'N'.    02280074
022900         88  PS-VERIFIED-RECEIVER                   VALUE 'Y'.    02290074
023000     05  PS-REDISTRO-SW               PIC X(01)  VALUE 'N'.       02300074
023100         88  PS-REDISTRO-OK                      VALUE 'Y'.       02310074
023200         88  PS-REDISTRO-NOT-OK                  VALUE 'N'.       02320074
023300     05  PS-LINE-VERIFIED-SW          PIC X(01)  VALUE 'N'.       02330074
023400         88  PS-LINE-VERIFIED                    VALUE 'Y'.       02340074
023500     05  PS-DISTHD-EXISTS-SW          PIC X(01)  VALUE 'N'.       02350074
023600         88  PS-DISTHD-EXISTS                    VALUE 'Y'.       02360074
023700         88  PS-NOT-DISTHD-EXISTS                VALUE 'N'.       02370074
023800     05  PS-EDIT-PASS-SW                PIC  X(01)  VALUE  '0'.   02380074
023900         88  PS-ANY-EDIT                            VALUE  '0'.   02390074
024000         88  PS-INITIAL-EDIT                        VALUE  '1'.   02400074
024100         88  PS-EDIT-BEFORE-MOVE                    VALUE  '2'.   02410074
024200     05  PS-DELETE-RECDIS-SW          PIC X(01)  VALUE 'N'.       02420074
024300         88  PS-DELETE-RECDIS                    VALUE 'Y'.       02430074
024400         88  PS-DONT-DELETE-RECDIS               VALUE 'N'.       02440074
024500     05  PS-UPDATE-CONFIRM-SW         PIC X(01)  VALUE 'N'.       02450074
024600         88  PS-UPDATE-CONFIRM                   VALUE 'Y'.       02460074
024700         88  PS-UPDATE-NOT-CONFIRM               VALUE 'N'.       02470074
024800     05  PS-UPDATE-NEEDED-SW          PIC X(01).                  02480074
024900         88  PS-UPDATE-NOT-NEEDED                  VALUE 'N'.     02490074
025000         88  PS-UPDATE-NEEDED                      VALUE 'Y'.     02500074
025100     05  PS-PACK-BY-ST-SW             PIC X(01)    VALUE SPACE.   02510074
025200         88  PS-PACK-BY-ST-SW-YES                  VALUE 'Y'.     02520074
025300     05  PS-EMPTY-PACK-SW               PIC  X(01)  VALUE 'N'.    02530074
025400         88  PS-EMPTY-PACK                          VALUE 'Y'.    02540074
025500         88  PS-PACK-NOT-EMPTY                      VALUE 'N'.    02550074
025600     05  PS-ASNS-TO-WMS-SW            PIC X(01) VALUE 'N'.        02560083
025700         88  PS-ASNS-TO-WMS-YES                 VALUE 'Y'.        02570083
025800         88  PS-ASNS-TO-WMS-NO                  VALUE 'N'.        02580083
025900     05  PS-RECEIVING-SW              PIC X(01) VALUE 'N'.        02590083
026000         88  PS-RECEIVING-BEGUN-YES             VALUE 'Y'.        02600083
026100         88  PS-RECEIVING-BEGUN-NO              VALUE 'N'.        02610083
026200*----------------------------------------------------------------*02620074
026300*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 230ZZ  *02630074
026400*----------------------------------------------------------------*02640074
026500     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        02650074
026600         88  PS-CALL-API-NO                     VALUE 'N'.        02660074
026700         88  PS-CALL-API-YES                    VALUE 'Y'.        02670074
026800*----------------------------------------------------------------*02680074
026900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *02690074
027000*----------------------------------------------------------------*02700074
027100                                                                  02710074
027200                                                                  02720074
027300 01  PV-PROGRAM-VARIABLES.                                        02730074
027400     05  PV-SUB                         PIC S9(04)  VALUE +0      02740074
027500                                                    COMP SYNC.    02750074
027600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02760074
027700                                                    COMP SYNC.    02770074
027800     05  PV-VALID-IDX                   PIC S9(04)  VALUE +0      02780074
027900                                                    COMP SYNC.    02790074
028000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02800074
028100                                                    COMP-3.       02810074
028200     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02820074
028300                                                    COMP-3.       02830074
028400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02840074
028500                                                    COMP-3.       02850074
028600     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02860074
028700                                                    COMP-3.       02870074
028800     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02880074
028900                                                    COMP-3.       02890074
029000     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02900074
029100                                                    COMP-3.       02910074
029200     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02920074
029300     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02930074
029400                                                                  02940074
029500     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02950074
029600                                                    COMP-3.       02960074
029700     05  PV-TEMP-BEST-CASE-UNITS        PIC S9(05).               02970074
029800     05  PV-TEMP-DTL-UNITS              PIC S9(05).               02980074
029900     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      02990074
030000                                                    COMP SYNC.    03000074
030100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03010093
030200                                                     COMP SYNC.   03020093
030300     05  PV-CICS-MSG-AREA             PIC X(75)  VALUE SPACE.     03030093
030400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03040074
030500                                                    COMP SYNC.    03050074
030600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03060074
030700                                                    COMP SYNC.    03070074
030800     05  PV-ITEM                        PIC S9(04)  VALUE +0      03080074
030900                                                    COMP SYNC.    03090074
031000     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03100074
031100                                                    COMP SYNC.    03110074
031200     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03120074
031300                                                    COMP SYNC.    03130074
031400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03140074
031500                                                    COMP SYNC.    03150074
031600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03160074
031700                                                    COMP SYNC.    03170074
031800     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03180074
031900                                                    COMP SYNC.    03190074
032000     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03200074
032100                                                    COMP SYNC.    03210074
032200     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03220074
032300                                                    COMP SYNC.    03230074
032400     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03240074
032500                                                    COMP SYNC.    03250074
032600     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03260074
032700                                                    COMP SYNC.    03270074
032800     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03280074
032900                                                    COMP SYNC.    03290074
033000     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03300074
033100                                                    COMP SYNC.    03310074
033200     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      03320074
033300                                                    COMP-3.       03330074
033400     05  PV-UNRSLVD-TRBL-COUNT          PIC S9(09)  VALUE ZERO    03340074
033500                                                    COMP-3.       03350074
033600     05  PV-RSLVD-TRBL-COUNT            PIC S9(09)  VALUE ZERO    03360074
033700                                                    COMP-3.       03370074
033800     05  PV-AP-VERIFY-ITM-QTY           PIC S9(05)  VALUE +0      03380074
033900                                                    COMP.         03390074
034000                                                                  03400074
034100     05  PV-CURRENT-TIMESTAMP           PIC  X(26).               03410074
034200     05  PV-DRV-LINE-NBR                PIC S9(9) COMP VALUE +0.  03420074
034300                                                                  03430074
034400                                                                  03440074
034500     05  PV-TOTAL-DTL-RATIO             PIC S9(04) COMP VALUE +0. 03450074
034600     05  PV-TOTAL-PO-RATIO              PIC S9(04) COMP VALUE +0. 03460074
034700     05  PV-TOTAL-PKSL-ITM-QTY          PIC S9(06) COMP VALUE +0. 03470074
034800     05  PV-TOTAL-DTL-CK-ITM-QTY        PIC S9(06) COMP VALUE +0. 03480074
034900     05  PV-TOTAL-ODD-UNIT-QTY          PIC S9(06) COMP VALUE +0. 03490074
035000     05  PV-TOTAL-AP-VERIFY-ITM-QTY     PIC S9(06) COMP VALUE +0. 03500074
035100     05  PV-TOTAL-CASE-PACK-QTY         PIC S9(03) COMP VALUE +0. 03510074
035200     05  PV-TOTAL-LINES-VERIFIED        PIC S9(03) COMP VALUE +0. 03520074
035300     05  PV-TOTAL-CASEPACK              PIC S9(03) COMP VALUE +0. 03530074
035400     05  PV-TEMP-MKING-APRON-TMST       PIC  X(26).               03540074
035500     05  PV-NBR-OF-PIC-AD               PIC S9(04) COMP.          03550074
035600     05  PV-NULL-IND                    PIC S9(02) COMP VALUE +0. 03560074
035700     05  PV-PREV-DTL-RATIO              PIC S9(04) COMP VALUE +0. 03570074
035800     05  PV-PACK-LINE-COUNT             PIC S9(04)   VALUE +0     03580074
035900                                                    COMP.         03590074
036000     05  PV-PACKSLIP-COUNT              PIC S9(04)   VALUE +0     03600074
036100                                                    COMP.         03610074
036200     05  PV-QTY-ENTRIES                 OCCURS 100 TIMES          03620074
036300                                        INDEXED BY PV-QTY-IDX.    03630074
036400         10 PV-DTL-CK-UNIT-SW           PIC X(01).                03640074
036500            88 PV-DTL-CK-UNIT-QTY                   VALUE 'Y'.    03650074
036600            88 PV-PKSL-UNIT-QTY                     VALUE 'N'.    03660074
036700         10 PV-LINE-SELECTED-SW         PIC X(01).                03670074
036800            88 PV-LINE-SELECTED                     VALUE 'Y'.    03680074
036900            88 PV-LINE-NOT-SELECTED                 VALUE 'N'.    03690074
037000*CLP 10/20/14                                                     03700099
037100     05  PV-DISP-PO-NBR                 PIC 9(8).                 03710099
037200     05  PV-DISP-REC-SEQ-NBR            PIC 9(4).                 03720074
037300     05  PV-DISP-PO-LNE-NBR             PIC 9(3).                 03730074
037400     05  PV-DISP-OPER-UNT-ID            PIC 9(4).                 03740074
037500     05  PV-DISP-FCLTY-ID               PIC 9(4).                 03750074
037600     05  PV-DISP-PACK-ID                PIC 9(4).                 03760074
037700                                                                  03770074
037800     05  PV-PO-NBR-PIC9               PIC S9(11) VALUE +0.        03780074
037900     05  PV-REC-SEQ-NBR-PIC9          PIC S9(11) VALUE +0.        03790074
038000     05  PV-PO-LNE-NBR-PIC9           PIC S9(11) VALUE +0.        03800074
038100                                                                  03810074
038200                                                                  03820074
038300* TOTAL QUICKCALC CALCULATIONS                                    03830074
038400     05  PV-TOTAL-QC-DTL-CK-ITM-QTY   PIC S9(06) COMP VALUE +0.   03840074
038500     05  PV-TOTAL-QC-DTL-RATIO        PIC S9(05) COMP VALUE +0.   03850074
038600     05  PV-TOTAL-QC-ODD-UNIT-QTY     PIC S9(06) COMP VALUE +0.   03860074
038700*----------------------------------------------------------------*03870074
038800*                                               **   WR # 230ZZ  *03880074
038900* ADDED NEW VARIABLES FOR PACK-ID AND                            *03890074
039000* ADDED THREE NEW VARIABLES - DK-SKU-SEQ, DK-ITM-NBR AND         *03900074
039100* PV-TEMP-SEQ-NBR.                                               *03910074
039200*----------------------------------------------------------------*03920074
039300     05  PV-FOUND-LINE-STATUS-IP      PIC X(01)   VALUE 'N'.      03930074
039400     05  PV-FOUND-LINE-STATUS-CM      PIC X(01)   VALUE 'N'.      03940074
039500     05  PV-FOUND-LINE-STATUS-VE      PIC X(01)   VALUE 'N'.      03950074
039600     05  PV-PREV-PACK-ID              PIC S9(02)  COMP            03960074
039700                                                  VALUE +0.       03970074
039800     05  PV-CURR-PACK-ID              PIC S9(02)  COMP            03980074
039900                                                  VALUE +0.       03990074
040000     05  DK-ITM-NBR                   PIC S9(15)V COMP-3.         04000074
040100     05  DK-SKU-SEQ                   PIC X(03).                  04010074
040200     05  PV-TEMP-SEQ-NBR              PIC 9(8).                   04020074
040300     05  PV-REC-LINE-STATUS           PIC X(2).                   04030074
040400*----------------------------------------------------------------*04040074
040500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *04050074
040600*----------------------------------------------------------------*04060074
040700                                                                  04070074
040800                                                                  04080074
040900*---------------------------------------------------------------* 04090074
041000*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 04100074
041100*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 04110074
041200*   APPLICATION-SPECIFIC COMMAREA.                              * 04120074
041300*---------------------------------------------------------------* 04130074
041400*----------------------------------------------------------------*04140074
041500*                                                **   WR # 230ZZ *04150074
041600* CHANGE THE STRUCTURE OF LQW TO MATCH WITH ASC STRUCTURE        *04160074
041700*----------------------------------------------------------------*04170074
041800 01  LQW-LIST-QUEUE-WORK-AREA.                                    04180074
041900     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  04190074
042000     05  LQW-ITEM-ENTRIES               OCCURS 7 TIMES            04200074
042100                                        INDEXED BY LQW-IDX.       04210074
042200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04220074
042300         10  LQW-TEMP-SELECTED-SW       PIC X(01).                04230074
042400         10  LQW-SELECTED-SW            PIC X(01).                04240074
042500             88  LQW-SELECT                         VALUE 'S'.    04250074
042600             88  LQW-DESELECT                       VALUE ' '.    04260074
042700         10  LQW-ACTION                 PIC X(3).                 04270074
042800         10  LQW-LINE-NUMBER            PIC 9(4).                 04280074
042900         10  LQW-REC-LINE-STATUS        PIC X(2).                 04290074
043000         10  LQW-SKU-SEQ                PIC 9(08).                04300074
043100         10  LQW-PO-PACK-RATIO          PIC 9(03).                04310074
043200         10  LQW-EXPD-PACK-RATIO        PIC 9(03).                04320074
043300         10  LQW-DTL-PACK-RATIO         PIC X(03).                04330074
043400         10  LQW-DTL-PACK-RATIO-N  REDEFINES                      04340074
043500                 LQW-DTL-PACK-RATIO     PIC 9(03).                04350074
043600         10  LQW-OTR-PACK-UNITS         PIC X(5).                 04360074
043700         10  LQW-PKSL-PACK-UNITS        PIC 9(5).                 04370074
043800         10  LQW-BEST-CASE-UNITS        PIC 9(5).                 04380074
043900         10  LQW-DTL-PACK-UNITS         PIC X(5).                 04390074
044000         10  LQW-DTL-PACK-UNITS-N       REDEFINES                 04400074
044100             LQW-DTL-PACK-UNITS         PIC 9(05).                04410074
044200         10  LQW-ODD-PACK-UNITS         PIC 9(5).                 04420074
044300         10  LQW-VRFD-PACK-UNITS        PIC 9(5).                 04430074
044400         10  LQW-PERCENT-VARIANCE       PIC 9(4).                 04440074
044500         10  LQW-PERCENT-VAR-SIGN-SW    PIC X(01).                04450074
044600             88  LQW-PACK-OVER                       VALUE 'O'.   04460074
044700             88  LQW-PACK-UNDER                      VALUE 'U'.   04470074
044800                                                                  04480074
044900         10  LQW-PURITM-UNT-QTY         PIC S9(09)                04490074
045000                                            COMP.                 04500074
045100         10  LQW-PURITM-UNT-RTL-PR-AMT  PIC S9(06)V99             04510074
045200                                            COMP-3.               04520074
045300         10  LQW-PURITM-GP-RTL-AMT      PIC S9(05)V99             04530074
045400                                            COMP-3.               04540074
045500         10  LQW-PURITM-GP-QTY          PIC S9(04)                04550074
045600                                            COMP.                 04560074
045700         10  LQW-LINE-TRBL-SW           PIC X(01).                04570074
045800         10  LQW-CASEPACK-SPLIT-SW      PIC X(01).                04580074
045900             88  LQW-CASEPACK-SPLIT-YES              VALUE 'Y'.   04590074
046000             88  LQW-CASEPACK-SPLIT-NO               VALUE 'N'.   04600074
046100         10  LQW-ERROR-ON-LINE-SW       PIC X(01).                04610074
046200             88  LQW-LINE-ERROR                      VALUE 'Y'.   04620074
046300             88  LQW-LINE-NO-ERROR                   VALUE 'N'.   04630074
046400         10  LQW-ERROR-ON-QTY-SW        PIC X(01).                04640074
046500             88  LQW-QTY-ERROR                       VALUE 'Y'.   04650074
046600             88  LQW-QTY-NO-ERROR                    VALUE 'N'.   04660074
046700         10  LQW-QC-HIGHLIGHT-LINE-SW   PIC X(01).                04670074
046800             88  LQW-QC-HIGHLIGHT                    VALUE 'Y'.   04680074
046900             88  LQW-QC-NO-HIGHLIGHT                 VALUE 'N'.   04690074
047000*----------------------------------------------------------------*04700074
047100*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                        04710074
047200*----------------------------------------------------------------*04720074
047300                                                                  04730074
047400                                                                  04740074
047500/                                                                 04750074
047600*---------------------------------------------------------------* 04760074
047700*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 04770074
047800*---------------------------------------------------------------* 04780074
047900                                                                  04790074
048000     COPY PCWS016.                                                04800074
048100                                                                  04810074
048200*---------------------------------------------------------------* 04820074
048300*  RECORD LAYOUT FOR THE PACKSLIP SELECTION TEMP STORAGE QUEUE. * 04830074
048400*---------------------------------------------------------------* 04840074
048500                                                                  04850074
048600     COPY RCWS013.                                                04860074
048700                                                                  04870074
048800*---------------------------------------------------------------* 04880074
048900*  TEMP STORAGE FOR TRECITM AUDIT TABLE.                        * 04890074
049000*---------------------------------------------------------------* 04900074
049100                                                                  04910074
049200     COPY RCWS031.                                                04920074
049300                                                                  04930074
049400                                                                  04940074
049500*---------------------------------------------------------------* 04950074
049600*  RECORD LAYOUT FOR THE PACK VALIDATION MODULE.                * 04960074
049700*---------------------------------------------------------------* 04970074
049800                                                                  04980074
049900     COPY RCWS806.                                                04990074
050000                                                                  05000074
050100*---------------------------------------------------------------* 05010074
050200*  TEMP STORAGE FOR CONVERT RECDIS PGM.                         * 05020074
050300*---------------------------------------------------------------* 05030074
050400                                                                  05040074
050500     COPY RCWS811.                                                05050074
050600                                                                  05060074
050700***************************************************************** 05070090
050800* COPYBOOK FOR WMS VENDOR SHIPMENT CONTROL MODULE               * 05080090
050900***************************************************************** 05090090
051000     COPY WSWS001.                                                05100090
051100                                                                  05110090
051200*---------------------------------------------------------------* 05120074
051300*  RECORD LAYOUT FOR THE TROUBLE ROUTINE                          05130074
051400*---------------------------------------------------------------* 05140074
051500                                                                  05150074
051600     COPY TMWS500.                                                05160074
051700                                                                  05170074
051800/                                                                 05180074
051900*----------------------------------------------------------------*05190074
052000*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 230ZZ  *05200074
052100*----------------------------------------------------------------*05210074
052200                                                                  05220074
052300     COPY XLWS001.                                                05230074
052400                                                                  05240074
052500*----------------------------------------------------------------*05250074
052600* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *05260074
052700*----------------------------------------------------------------*05270074
052800*---------------------------------------------------------------* 05280074
052900*    MAP LAYOUT                                                 * 05290074
053000*---------------------------------------------------------------* 05300074
053100                                                                  05310074
053200     COPY RCKM801.                                                05320074
053300                                                                  05330074
053400*----------------------------------------------------------------*05340074
053500*                                                    WR # 230ZZ  *05350074
053600* CHANGED THE FILLER OF MR-OCCURS-LAYOUT FROM X(234) TO X(241)   *05360074
053700* AS A NEW FIELD STATUS CODE IS ADDED IN THE MAP RCKM801.        *05370074
053800* INCREASED SIZE OF MR-SKU-SEQ-NBR  FROM X(3) TO X(8).           *05380074
053900*----------------------------------------------------------------*05390074
054000 01  MR-OCCURS-LAYOUT                   REDEFINES  RC801AO.       05400074
054100     05  FILLER                         PIC X(241).               05410074
054200     05  MR-SCROLL-AREA                 OCCURS  7 TIMES.          05420074
054300         10  MR-SELECTL                 PIC S9(04) COMP.          05430074
054400         10  MR-SELECTA                 PIC  X(01).               05440074
054500         10  MR-SELECTC                 PIC  X(01).               05450074
054600         10  MR-SELECTH                 PIC  X(01).               05460074
054700         10  MR-SELECT                  PIC  X(01).               05470074
054800                                                                  05480074
054900         10  MR-LINEL                   PIC S9(04) COMP.          05490074
055000         10  MR-LINEA                   PIC  X(01).               05500074
055100         10  MR-LINEC                   PIC  X(01).               05510074
055200         10  MR-LINEH                   PIC  X(01).               05520074
055300         10  MR-LINE.                                             05530074
055400             15  MR-LINE-N              PIC  ZZZ9.                05540074
055500                                                                  05550074
055600         10  MR-SKU-SEQ-NBRL            PIC S9(04) COMP.          05560074
055700         10  MR-SKU-SEQ-NBRA            PIC  X(01).               05570074
055800         10  MR-SKU-SEQ-NBRC            PIC  X(01).               05580074
055900         10  MR-SKU-SEQ-NBRH            PIC  X(01).               05590074
056000         10  MR-SKU-SEQ-NBR             PIC  X(08).               05600074
056100                                                                  05610074
056200         10  MR-PO-PACK-RATIOL          PIC S9(04) COMP.          05620074
056300         10  MR-PO-PACK-RATIOA          PIC  X(01).               05630074
056400         10  MR-PO-PACK-RATIOC          PIC  X(01).               05640074
056500         10  MR-PO-PACK-RATIOH          PIC  X(01).               05650074
056600         10  MR-PO-PACK-RATIO.                                    05660074
056700             15  MR-PO-PACK-RATIO-N     PIC  ZZ9.                 05670074
056800                                                                  05680074
056900*   THIS WILL CONTAIN SPACES FOR PHASE 1 OF THE PROJECT.          05690074
057000         10  MR-EXPD-PACK-RATIOL        PIC S9(04) COMP.          05700074
057100         10  MR-EXPD-PACK-RATIOA        PIC  X(01).               05710074
057200         10  MR-EXPD-PACK-RATIOC        PIC  X(01).               05720074
057300         10  MR-EXPD-PACK-RATIOH        PIC  X(01).               05730074
057400         10  MR-EXPD-PACK-RATIO.                                  05740074
057500             15  MR-EXPD-PACK-RATIO-N   PIC  X(03).               05750074
057600                                                                  05760074
057700         10  MR-DTL-PACK-RATIOL         PIC S9(04) COMP.          05770074
057800         10  MR-DTL-PACK-RATIOA         PIC  X(01).               05780074
057900         10  MR-DTL-PACK-RATIOC         PIC  X(01).               05790074
058000         10  MR-DTL-PACK-RATIOH         PIC  X(01).               05800074
058100         10  MR-DTL-PACK-RATIO.                                   05810074
058200             15  MR-DTL-PACK-RATIO-N    PIC  ZZ9.                 05820074
058300                                                                  05830074
058400         10  MR-OTR-PACK-UNITSL         PIC S9(04) COMP.          05840074
058500         10  MR-OTR-PACK-UNITSA         PIC  X(01).               05850074
058600         10  MR-OTR-PACK-UNITSC         PIC  X(01).               05860074
058700         10  MR-OTR-PACK-UNITSH         PIC  X(01).               05870074
058800         10  MR-OTR-PACK-UNITS          PIC  X(05).               05880074
058900                                                                  05890074
059000         10  MR-PKSL-PACK-UNITSL        PIC S9(04) COMP.          05900074
059100         10  MR-PKSL-PACK-UNITSA        PIC  X(01).               05910074
059200         10  MR-PKSL-PACK-UNITSC        PIC  X(01).               05920074
059300         10  MR-PKSL-PACK-UNITSH        PIC  X(01).               05930074
059400         10  MR-PKSL-PACK-UNITS.                                  05940074
059500             15  MR-PKSL-PACK-UNITS-N   PIC  ZZZZ9.               05950074
059600                                                                  05960074
059700         10  MR-BEST-CASE-UNITSL        PIC S9(04) COMP.          05970074
059800         10  MR-BEST-CASE-UNITSA        PIC  X(01).               05980074
059900         10  MR-BEST-CASE-UNITSC        PIC  X(01).               05990074
060000         10  MR-BEST-CASE-UNITSH        PIC  X(01).               06000074
060100         10  MR-BEST-CASE-UNITS.                                  06010074
060200             15  MR-BEST-CASE-UNITS-N   PIC  ZZZZ9.               06020074
060300                                                                  06030074
060400         10  MR-DTL-PACK-UNITSL         PIC S9(04) COMP.          06040074
060500         10  MR-DTL-PACK-UNITSA         PIC  X(01).               06050074
060600         10  MR-DTL-PACK-UNITSC         PIC  X(01).               06060074
060700         10  MR-DTL-PACK-UNITSH         PIC  X(01).               06070074
060800         10  MR-DTL-PACK-UNITS.                                   06080074
060900             15  MR-DTL-PACK-UNITS-N    PIC  ZZZZ9.               06090074
061000                                                                  06100074
061100         10  MR-ODD-PACK-UNITSL         PIC S9(04) COMP.          06110074
061200         10  MR-ODD-PACK-UNITSA         PIC  X(01).               06120074
061300         10  MR-ODD-PACK-UNITSC         PIC  X(01).               06130074
061400         10  MR-ODD-PACK-UNITSH         PIC  X(01).               06140074
061500         10  MR-ODD-PACK-UNITS.                                   06150074
061600             15  MR-ODD-PACK-UNITS-N    PIC  ZZZZ9.               06160074
061700                                                                  06170074
061800         10  MR-VRFD-PACK-UNITSL        PIC S9(04) COMP.          06180074
061900         10  MR-VRFD-PACK-UNITSA        PIC  X(01).               06190074
062000         10  MR-VRFD-PACK-UNITSC        PIC  X(01).               06200074
062100         10  MR-VRFD-PACK-UNITSH        PIC  X(01).               06210074
062200         10  MR-VRFD-PACK-UNITS.                                  06220074
062300             15  MR-VRFD-PACK-UNITS-N   PIC  ZZZZ9.               06230074
062400                                                                  06240074
062500         10  MR-PERCENT-VARIANCEL       PIC S9(04) COMP.          06250074
062600         10  MR-PERCENT-VARIANCEA       PIC  X(01).               06260074
062700         10  MR-PERCENT-VARIANCEC       PIC  X(01).               06270074
062800         10  MR-PERCENT-VARIANCEH       PIC  X(01).               06280074
062900         10  MR-PERCENT-VARIANCE.                                 06290074
063000             15 MR-PERCENT-VARIANCE-N   PIC  ZZZ9.                06300074
063100             15 MR-PER-VAR-SIGN         PIC  X.                   06310074
063200*----------------------------------------------------------------*06320074
063300* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *06330074
063400*----------------------------------------------------------------*06340074
063500                                                                  06350074
063600                                                                  06360074
063700     EJECT                                                        06370074
063800*---------------------------------------------------------------* 06380074
063900*    ATTRIBUTE SETTINGS COPYBOOK.                               * 06390074
064000*---------------------------------------------------------------* 06400074
064100                                                                  06410074
064200     COPY DPWS015.                                                06420074
064300                                                                  06430074
064400*---------------------------------------------------------------* 06440074
064500*    FUNCTION KEYS COPYBOOK.                                    * 06450074
064600*---------------------------------------------------------------* 06460074
064700                                                                  06470074
064800     COPY DPWS016.                                                06480074
064900                                                                  06490074
065000*---------------------------------------------------------------* 06500074
065100*    NUMERIC EDIT LAYOUT.                                       * 06510074
065200*---------------------------------------------------------------* 06520074
065300                                                                  06530074
065400     COPY DPWS010I.                                               06540074
065500                                                                  06550074
065600/                                                                 06560074
065700******************************************************************06570099
065800** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **06580099
065810** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **06581099
065900******************************************************************06590099
066000                                                                  06600074
066100     COPY DPWS030.                                                06610074
066110     COPY DPWS930.                                                06611099
066200                                                                  06620074
066300/                                                                 06630074
066400*---------------------------------------------------------------* 06640074
066500* TEMP STORAGE AREA FOR PACK AND RECEIVER INFORMATION           * 06650074
066600*---------------------------------------------------------------* 06660074
066700     COPY RCWS801.                                                06670074
066800                                                                  06680074
066900*---------------------------------------------------------------* 06690074
067000*    STANDARD COMMAREA.                                         * 06700074
067100*---------------------------------------------------------------* 06710074
067200                                                                  06720074
067300     COPY DPWS020.                                                06730074
067400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                06740074
067500                                                                  06750074
067600*---------------------------------------------------------------* 06760074
067700* INTER-APPLICATION COMMAREA.                                   * 06770074
067800* RCWS012 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP UPDT  * 06780074
067900* RCWS015 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP LIST  * 06790074
068000*---------------------------------------------------------------* 06800074
068100                                                                  06810074
068200         10  INTER-APPL-COMM-AREA       PIC X(200).               06820074
068300     COPY PCWS000.                                                06830074
068400     COPY POWS017.                                                06840074
068500     COPY RCWS800.                                                06850074
068600                                                                  06860074
068700     COPY RCWS012.                                                06870074
068800     COPY RCWS015.                                                06880074
068900                                                                  06890074
069000*---------------------------------------------------------------* 06900074
069100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06910074
069200*---------------------------------------------------------------* 06920074
069300*----------------------------------------------------------------*06930074
069400*                                             WR # 230ZZ         *06940074
069500* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA.       *06950074
069600* ASC-SKU-SEQ-NBR FIELD IS INCREASED FROM 9(03) TO 9(08).        *06960074
069700*----------------------------------------------------------------*06970074
069800         10  ASC-SPECIFIC-COMMAREA.                               06980074
069900             15  ASC-LIST-KEYS.                                   06990074
070000                 20  ASC-REC-NBR             PIC 9(08).           07000074
070100                 20  ASC-REC-SEQ-NBR         PIC 9(03).           07010074
070200                 20  ASC-REC-STAT            PIC X(02).           07020074
070300                 20  ASC-OPR-ID              PIC ZZZ9.            07030074
070400                 20  ASC-FACT                PIC ZZZ9.            07040074
070500                 20  ASC-PACK-ID             PIC 9(03).           07050074
070600             15  ASC-OTHER-TOP-OF-SCREEN-DATA.                    07060074
070700                 20  ASC-DEPT                PIC X(03).           07070074
070800                 20  ASC-ACT-NBR-OF-PACKS    PIC 9(05).           07080074
070900                 20  ASC-PO-UNITS-PER-CTN    PIC 9(03).           07090074
071000                 20  ASC-EXPD-UNITS-PER-CTN  PIC X(03).           07100074
071100                 20  ASC-ACT-UNITS-PER-CTN   PIC 9(03).           07110074
071200                 20  ASC-PKGNG-CDE           PIC X(01).           07120074
071300                 20  ASC-EXPD-PACKS-QTY      PIC 9(05).           07130074
071400                 20  ASC-OTR-PACK-QTY        PIC 9(05).           07140074
071500                 20  ASC-REC-TROUBLE-RSN     PIC X(11).           07150074
071600                 20  ASC-PACK-DESC           PIC X(36).           07160074
071700                 20  ASC-BEST-CASE-PACKS     PIC 9(05).           07170074
071800                 20  ASC-PREV-BEST-CASE-PACKS                     07180074
071900                                             PIC 9(05).           07190074
072000                 20  ASC-TPURITM-VEND-STYL-NAME                   07200074
072100                                             PIC X(16).           07210074
072200                 20  ASC-DISPLAY-STATUS      PIC X(02).           07220074
072300             15  ASC-TOTAL-DATA.                                  07230074
072400                 20  ASC-TOTAL-DTL-RATIO                          07240074
072500                                      PIC S9(04) COMP.            07250074
072600                 20  ASC-TOTAL-PO-RATIO                           07260074
072700                                      PIC S9(04) COMP.            07270074
072800                 20  ASC-TOTAL-PKSL-ITM-QTY                       07280074
072900                                      PIC S9(06) COMP.            07290074
073000                 20  ASC-TOTAL-DTL-CK-ITM-QTY                     07300074
073100                                      PIC S9(06) COMP.            07310074
073200                 20  ASC-TOTAL-OTR    PIC S9(06) COMP.            07320074
073300                 20  ASC-TOTAL-ODD-UNIT-QTY                       07330074
073400                                      PIC S9(06) COMP.            07340074
073500                 20  ASC-TOTAL-BEST-CASE-UNITS                    07350074
073600                                      PIC S9(06) COMP.            07360074
073700                 20  ASC-TOTAL-AP-VERIFY-ITM-QTY                  07370074
073800                                      PIC S9(06) COMP.            07380074
073900                 20  ASC-TOTAL-CASE-PACK-QTY                      07390074
074000                                      PIC S9(03) COMP.            07400074
074100             15  ASC-UPDATE-PENDING-SW                            07410074
074200                                      PIC X(01).                  07420074
074300                     88  ASC-UPDATE-NOT-PENDING    VALUE 'N'.     07430074
074400                     88  ASC-UPDATE-PENDING        VALUE 'Y'.     07440074
074500             15  ASC-REDISTRO-CALL-SW                             07450074
074600                                      PIC X(01).                  07460074
074700                     88  ASC-NO-CALL-REDISTRO      VALUE 'N'.     07470074
074800                     88  ASC-CALL-REDISTRO         VALUE 'Y'.     07480074
074900             15  ASC-STORE-ADJ-CALL-SW                            07490074
075000                                      PIC X(01).                  07500074
075100                     88  ASC-NO-CALL-STORE-ADJ     VALUE 'N'.     07510074
075200                     88  ASC-CALL-STORE-ADJ        VALUE 'Y'.     07520074
075300             15  ASC-DELETE-PENDING-SW                            07530074
075400                                      PIC X(01).                  07540074
075500                     88  ASC-DELETE-NOT-PENDING    VALUE 'N'.     07550074
075600                     88  ASC-DELETE-PENDING        VALUE 'Y'.     07560074
075700                                                                  07570074
075800             15  ASC-QUICKCALC-FUNCTION-SW                        07580074
075900                                      PIC X(01).                  07590074
076000                     88  ASC-UPDATE-FUNCTION       VALUE 'N'.     07600074
076100                     88  ASC-QUICKCALC-FUNCTION    VALUE 'Y'.     07610074
076200                     88  ASC-OTHER-FUNCTION        VALUE ' '.     07620074
076300                                                                  07630074
076400             15  ASC-CALL-TROUBLE-SW  PIC X(01).                  07640074
076500                     88  ASC-DONT-CALL-TROUBLE     VALUE 'N'.     07650074
076600                     88  ASC-CALL-TROUBLE          VALUE 'Y'.     07660074
076700                                                                  07670074
076800             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           07680074
076900                 20  ASC-BLOCK-MODIFIED-SW                        07690074
077000                                      PIC X(01).                  07700074
077100                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     07710074
077200                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     07720074
077300                 20  ASC-ITEM-ARRAY.                              07730074
077400                     25  ASC-ITEM-ENTRIES OCCURS 7 TIMES.         07740074
077500                         30  ASC-LIST-ITEM-NUMBER                 07750074
077600                                        PIC S9(09) COMP-3.        07760074
077700                         30  ASC-TEMP-SELECTED-SW                 07770074
077800                                        PIC X(01).                07780074
077900                             88  ASC-VALID-SELECT  VALUE ' '      07790074
078000                                                         'S'      07800074
078100                                                         'B'      07810074
078200                                                         'E'.     07820074
078300                             88  ASC-TEMP-NO-SELECT               07830074
078400                                                   VALUE ' '.     07840074
078500                             88  ASC-TEMP-SELECT   VALUE 'S'.     07850074
078600                             88  ASC-TEMP-BEGIN    VALUE 'B'.     07860074
078700                             88  ASC-TEMP-END      VALUE 'E'.     07870074
078800                         30  ASC-SELECTED-SW                      07880074
078900                                        PIC X(01).                07890074
079000                             88  ASC-NO-SELECT     VALUE ' '.     07900074
079100                             88  ASC-SELECT        VALUE 'S'.     07910074
079200                             88  ASC-BEGIN         VALUE 'B'.     07920074
079300                             88  ASC-END           VALUE 'E'.     07930074
079400                         30  ASC-ACTION            PIC X(03).     07940074
079500                         30  ASC-LINE-NUMBER       PIC 9(04).     07950074
079600                         30  ASC-REC-LINE-STATUS   PIC X(2).      07960074
079700                         30  ASC-SKU-SEQ-NBR       PIC 9(08).     07970074
079800                         30  ASC-PO-PACK-RATIO     PIC 9(03).     07980074
079900                         30  ASC-EXPD-PACK-RATIO   PIC 9(03).     07990074
080000                         30  ASC-DTL-PACK-RATIO    PIC X(03).     08000074
080100                         30  ASC-DTL-PACK-RATIO-N  REDEFINES      08010074
080200                             ASC-DTL-PACK-RATIO    PIC 9(3).      08020074
080300                         30  ASC-OTR-PACK-UNITS    PIC X(5).      08030074
080400                         30  ASC-OTR-PACK-UNITS-N  REDEFINES      08040074
080500                             ASC-OTR-PACK-UNITS    PIC 9(3) COMP. 08050074
080600                         30  ASC-PKSL-PACK-UNITS   PIC 9(5).      08060074
080700                         30  ASC-BEST-CASE-UNITS   PIC 9(5).      08070074
080800                         30  ASC-DTL-PACK-UNITS    PIC X(5).      08080074
080900                         30  ASC-DTL-PACK-UNITS-N  REDEFINES      08090074
081000                             ASC-DTL-PACK-UNITS    PIC 9(05).     08100074
081100                         30  ASC-ODD-PACK-UNITS    PIC 9(5).      08110074
081200                         30  ASC-VRFD-PACK-UNITS   PIC 9(5).      08120074
081300                         30  ASC-PERCENT-VARIANCE  PIC 9(4).      08130074
081400                         30  ASC-PERCENT-VAR-SIGN-SW              08140074
081500                                                   PIC X(01).     08150074
081600                             88  ASC-VARIANCE-OVER   VALUE 'O'.   08160074
081700                             88  ASC-VARIANCE-UNDER  VALUE 'U'.   08170074
081800                         30  ASC-FIELDS-TO-BE-PASSED.             08180074
081900                             35  ASC-PURITM-UNT-QTY               08190074
082000                                                   PIC S9(09)     08200074
082100                                                       COMP.      08210074
082200                             35  ASC-PURITM-UNT-RTL-PR-AMT        08220074
082300                                                   PIC S9(06)V99  08230074
082400                                                       COMP-3.    08240074
082500                             35  ASC-PURITM-GP-RTL-AMT            08250074
082600                                                   PIC S9(05)V99  08260074
082700                                                       COMP-3.    08270074
082800                             35  ASC-PURITM-GP-QTY PIC S9(04)     08280074
082900                                                       COMP.      08290074
083000                         30  ASC-LINE-TRBL-SW                     08300074
083100                                        PIC X(01).                08310074
083200                             88  ASC-LINE-IN-TROUBLE  VALUE 'Y'.  08320074
083300                             88  ASC-LINE-DISTRO-TRBL VALUE 'D'.  08330074
083400                         30  ASC-CASEPACK-SPLIT-SW                08340074
083500                                        PIC X(01).                08350074
083600                             88  ASC-CASEPACK-SPLIT-YES           08360074
083700                                                      VALUE 'Y'.  08370074
083800                             88  ASC-CASEPACK-SPLIT-NO            08380074
083900                                                      VALUE 'N'.  08390074
084000                         30  ASC-ERROR-ON-LINE-SW                 08400074
084100                                        PIC X(01).                08410074
084200                             88  ASC-LINE-ERROR       VALUE 'Y'.  08420074
084300                             88  ASC-LINE-NO-ERROR    VALUE 'N'.  08430074
084400                         30  ASC-ERROR-ON-QTY-SW                  08440074
084500                                        PIC X(01).                08450074
084600                             88  ASC-QTY-ERROR        VALUE 'Y'.  08460074
084700                             88  ASC-QTY-NO-ERROR     VALUE 'N'.  08470074
084800                         30  ASC-QC-HIGHLIGHT-LINE-SW             08480074
084900                                        PIC X(01).                08490074
085000                             88  ASC-QC-HIGHLIGHT     VALUE 'Y'.  08500074
085100                             88  ASC-QC-NO-HIGHLIGHT  VALUE 'N'.  08510074
085200                                                                  08520074
085300             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     08530074
085400             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     08540074
085500             15  ASC-SEL-SUB            PIC S9(04) COMP.          08550074
085600             15  ASC-SEL-ITEM           PIC S9(04) COMP.          08560074
085700             15  ASC-NUMBER-OF-ITEMS-READ                         08570074
085800                                        PIC S9(09) COMP-3.        08580074
085900             15  ASC-NUMBER-OF-SELECTED-ITEMS                     08590074
086000                                        PIC S9(09) COMP-3.        08600074
086100             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        08610074
086200             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        08620074
086300             15  ASC-ITEM-AT-TOP-OF-PANEL                         08630074
086400                                        PIC S9(09) COMP-3.        08640074
086500             15  ASC-ITEM-AT-BOT-OF-PANEL                         08650074
086600                                        PIC S9(09) COMP-3.        08660074
086700             15  ASC-HIGHEST-BLOCK-WRITTEN                        08670074
086800                                        PIC S9(04) COMP SYNC.     08680074
086900             15  ASC-START-OF-SELECTED-RANGE                      08690074
087000                                        PIC S9(09) COMP-3.        08700074
087100             15  ASC-END-OF-SELECTED-RANGE                        08710074
087200                                        PIC S9(09) COMP-3.        08720074
087300             15  ASC-NOTIF-NBR          PIC S9(09) COMP-3.        08730074
087400             15  ASC-ITEMS-LEFT-INDICATOR                         08740074
087500                                        PIC X(01).                08750074
087600                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     08760074
087700                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     08770074
087800             15  ASC-CASEPACK-SW        PIC X(01).                08780074
087900                 88  ASC-CASEPACK-YES                 VALUE 'Y'.  08790074
088000                 88  ASC-CASEPACK-NO                  VALUE 'N'.  08800074
088100             15  ASC-TEMP-QUEUE-UPDATE-SW                         08810074
088200                                        PIC X(01).                08820074
088300                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     08830074
088400                 88  ASC-UPDATE-TSQ2               VALUE '2'.     08840074
088500                 88  ASC-UPDATE-TSQ3               VALUE '3'.     08850074
088600                 88  ASC-UPDATE-TSQ4               VALUE '4'.     08860074
088700                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     08870074
088800             15  ASC-LIST-QUEUE-NAME.                             08880074
088900                 20  ASC-LIST-TERM-ID   PIC X(04).                08890074
089000                 20  ASC-LIST-TASK-NUMBER                         08900074
089100                                        PIC S9(05) COMP-3.        08910074
089200                 20  ASC-LIST-SEQ       PIC 9(01).                08920074
089300             15  ASC-SEL-QUEUE-NAME-IN   PIC X(08).               08930074
089400             15  ASC-SEL-QUEUE-NAME-OUT.                          08940074
089500                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               08950074
089600                 20  ASC-SEL-TASK-NUMBER-OUT                      08960074
089700                                         PIC S9(05) COMP-3.       08970074
089800                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               08980074
089900                                                                  08990074
090000             15  ASC-START-ITEM-REQUEST.                          09000074
090100                 20  ASC-START-ITEM-REQUEST-N  PIC 9(07).         09010074
090200             15  ASC-USE-SELECTION-QUEUE-IND   PIC X(01).         09020074
090300                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         09030074
090400             15  ASC-HOLD-INTER-APPL           PIC X(200).        09040074
090500             15  ASC-INTER-APPL-CODE-IND       PIC X(01).         09050074
090600                 88  ASC-INTER-APPL-PKSL-LIST  VALUE 'P'.         09060074
090700                 88  ASC-INTER-APPL-AUDT-LIST  VALUE '2'.         09070074
090800             15  ASC-DTL-RATIO-CHANGE-SW       PIC X(01).         09080074
090900                 88  ASC-UNITS-ONLY-CHANGE     VALUE 'N'.         09090074
091000                 88  ASC-RATIO-UNIT-CHANGE     VALUE 'Y'.         09100074
091100                 88  ASC-RATIO-ONLY-CHANGE     VALUE 'A'.         09110074
091200             15  ASC-UPDATE-OCCURRED-SW        PIC  X(01).        09120074
091300                 88  ASC-UPDATE-OCCURRED       VALUE 'Y'.         09130074
091400                 88  ASC-UPDATE-DIDNT-OCCUR    VALUE 'N'.         09140074
091500*----------------------------------------------------------------*09150074
091600* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *09160074
091700*----------------------------------------------------------------*09170074
091800                                                                  09180074
091900                                                                  09190074
092000/                                                                 09200074
092100*---------------------------------------------------------------* 09210074
092200*    ABEND PROCESSING COPYBOOK.                                 * 09220074
092300*---------------------------------------------------------------* 09230074
092400                                                                  09240074
092500     COPY DPWS013.                                                09250074
092600                                                                  09260074
092700/                                                                 09270074
092800*---------------------------------------------------------------* 09280074
092900*    OPEN TO RECEIVE COPYBOOK.                                  * 09290074
093000*---------------------------------------------------------------* 09300074
093100                                                                  09310074
093200     COPY PCWS020.                                                09320074
093300/                                                                 09330085
093400*---------------------------------------------------------------* 09340085
093500*    DB2 AREA                                                     09350085
093600*---------------------------------------------------------------* 09360085
093700     EXEC SQL                                                     09370085
093800          INCLUDE TKRPRPM                                         09380085
093900     END-EXEC.                                                    09390085
094000/                                                                 09400085
094100*---------------------------------------------------------------* 09410091
094200*    DB2 AREA FOR THE SHIPMT XREF                               * 09420091
094300*---------------------------------------------------------------* 09430091
094400     EXEC SQL                                                     09440091
094500          INCLUDE WST00001                                        09450091
094600     END-EXEC.                                                    09460091
094700/                                                                 09470091
094800*---------------------------------------------------------------* 09480085
094900*    DB2 AREA                                                     09490085
095000*---------------------------------------------------------------* 09500085
095100     EXEC SQL                                                     09510085
095200          INCLUDE TSHPTPO                                         09520085
095300     END-EXEC.                                                    09530085
095400/                                                                 09540085
095500*---------------------------------------------------------------* 09550085
095600*    DB2 AREA                                                     09560085
095700*---------------------------------------------------------------* 09570085
095800     EXEC SQL                                                     09580085
095900          INCLUDE TSHIPMT                                         09590085
096000     END-EXEC.                                                    09600085
096100                                                                  09610085
096200/                                                                 09620074
096300*---------------------------------------------------------------* 09630074
096400*    DB2 AREA FOR THE RECEIVER                                  * 09640074
096500*---------------------------------------------------------------* 09650074
096600     EXEC SQL                                                     09660074
096700          INCLUDE TRECEIV                                         09670074
096800     END-EXEC.                                                    09680074
096900                                                                  09690074
097000/                                                                 09700074
097100*---------------------------------------------------------------* 09710074
097200*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 09720074
097300*---------------------------------------------------------------* 09730074
097400     EXEC SQL                                                     09740074
097500          INCLUDE TPURCHS                                         09750074
097600     END-EXEC.                                                    09760074
097700                                                                  09770074
097800/                                                                 09780074
097900*---------------------------------------------------------------* 09790074
098000*    DB2 AREA FOR THE PURCHASE ORDER ITEM TABLE                 * 09800074
098100*---------------------------------------------------------------* 09810074
098200*    EXEC SQL                                                     09820074
098300*         INCLUDE TPURITM                                         09830074
098400*    END-EXEC.                                                    09840074
098500*                                                                 09850074
098600/                                                                 09860074
098700*---------------------------------------------------------------* 09870074
098800*    DB2 AREA FOR THE RECEIPT ITEM TABLE                        * 09880074
098900*---------------------------------------------------------------* 09890074
099000*    EXEC SQL                                                     09900074
099100*         INCLUDE TRECITM                                         09910074
099200*    END-EXEC.                                                    09920074
099300*                                                                 09930074
099400/                                                                 09940074
099500*---------------------------------------------------------------* 09950074
099600*    DB2 AREA FOR THE TRECDIS TABLE                             * 09960074
099700*---------------------------------------------------------------* 09970074
099800*    EXEC SQL                                                     09980074
099900*         INCLUDE TRECDIS                                         09990074
100000*    END-EXEC.                                                    10000074
100100*                                                                 10010074
100200/                                                                 10020074
100300*---------------------------------------------------------------* 10030074
100400*    DB2 AREA FOR THE PURCHASE ORDER PREPACK TABLE              * 10040074
100500*---------------------------------------------------------------* 10050074
100600     EXEC SQL                                                     10060074
100700          INCLUDE TPOPRPK                                         10070074
100800     END-EXEC.                                                    10080074
100900                                                                  10090074
101000/                                                                 10100074
101100*---------------------------------------------------------------* 10110074
101200*    DB2 AREA FOR THE TENTNME TABLE                             * 10120074
101300*---------------------------------------------------------------* 10130074
101400     EXEC SQL                                                     10140074
101500          INCLUDE TENTNME                                         10150074
101600     END-EXEC.                                                    10160074
101700                                                                  10170074
101800/                                                                 10180074
101900*---------------------------------------------------------------* 10190074
102000*    DB2 AREA FOR THE TPLNSHP TABLE                             * 10200074
102100*---------------------------------------------------------------* 10210074
102200     EXEC SQL                                                     10220074
102300          INCLUDE TPLNSHP                                         10230074
102400     END-EXEC.                                                    10240074
102500                                                                  10250074
102600/                                                                 10260074
102700*----------------------------------------------------------------*10270074
102800*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                10280074
102900*----------------------------------------------------------------*10290074
103000     EXEC SQL                                                     10300074
103100          INCLUDE TTRBNTF                                         10310074
103200     END-EXEC.                                                    10320074
103300                                                                  10330074
103400/                                                                 10340074
103500*----------------------------------------------------------------*10350074
103600*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      10360074
103700*----------------------------------------------------------------*10370074
103800     EXEC SQL                                                     10380074
103900          INCLUDE TTRBRSN                                         10390074
104000     END-EXEC.                                                    10400074
104100                                                                  10410074
104200/                                                                 10420074
104300*---------------------------------------------------------------* 10430074
104400*    DB2 AREA FOR THE PACKSLIP TABLE                            * 10440074
104500*---------------------------------------------------------------* 10450074
104600     EXEC SQL                                                     10460074
104700          INCLUDE TPKSLIP                                         10470074
104800     END-EXEC.                                                    10480074
104900                                                                  10490074
105000/                                                                 10500074
105100*---------------------------------------------------------------* 10510074
105200*    DB2 AREA FOR THE PACKITEM TABLE                            * 10520074
105300*---------------------------------------------------------------* 10530074
105400     EXEC SQL                                                     10540074
105500          INCLUDE TPKITEM                                         10550074
105600     END-EXEC.                                                    10560074
105700                                                                  10570074
105800                                                                  10580074
105900*---------------------------------------------------------------* 10590074
106000*    DC-DISTRIBUTION TRANSACTION HEADER                         * 10600074
106100*---------------------------------------------------------------* 10610074
106200     EXEC SQL                                                     10620074
106300          INCLUDE TDISTHD                                         10630074
106400     END-EXEC.                                                    10640074
106500                                                                  10650074
106600*---------------------------------------------------------------* 10660074
106700*    DB2 AREA FOR THE TWRKORD                                   * 10670074
106800*---------------------------------------------------------------* 10680074
106900     EXEC SQL                                                     10690074
107000          INCLUDE TWRKORD                                         10700074
107100     END-EXEC.                                                    10710074
107200                                                                  10720074
107300/                                                                 10730074
107400/                                                                 10740074
107500*---------------------------------------------------------------* 10750074
107600*    DB2 AREA FOR THE TWKORIN                                   * 10760074
107700*---------------------------------------------------------------* 10770074
107800     EXEC SQL                                                     10780074
107900          INCLUDE TWKORIN                                         10790074
108000     END-EXEC.                                                    10800074
108100                                                                  10810074
108200/                                                                 10820074
109100*---------------------------------------------------------------* 10910074
109200*    DB2 AREA FOR THE ODD UNIT TABLE                            * 10920074
109300*---------------------------------------------------------------* 10930074
109400     EXEC SQL                                                     10940074
109500          INCLUDE RCT00009                                        10950074
109600     END-EXEC.                                                    10960074
109700                                                                  10970074
109800/                                                                 10980074
109900*---------------------------------------------------------------* 10990074
110000*    DB2 AREA FOR COMMUNICATIONS                                * 11000074
110100*---------------------------------------------------------------* 11010074
110200     EXEC SQL                                                     11020074
110300          INCLUDE SQLCA                                           11030074
110400     END-EXEC.                                                    11040074
110500                                                                  11050074
110600/                                                                 11060074
110700*---------------------------------------------------------------* 11070074
110800*  CURSOR TO LIST TPURITM                                       * 11080074
110900*---------------------------------------------------------------* 11090074
111000*----------------------------------------------------------------*11100074
111100*                                               **   WR # 230ZZ  *11110074
111200* ADDED CODE TO RETRIEVE ITEM NUMBER FROM TPURITM AND            *11120074
111300* ADDED CODE TO RETRIEVE PRE PACK ID FROM TRECITM.               *11130074
111400*----------------------------------------------------------------*11140074
111500                                                                  11150074
111600     EXEC SQL                                                     11160074
111700          DECLARE TPURITM-CSR CURSOR FOR                          11170074
111800           SELECT A.PO_NBR                                        11180074
111900                , A.VER_NBR                                       11190074
112000                , A.SKU_SEQ_NBR                                   11200074
112100                , A.SKU_DESC                                      11210074
112200                , A.APP_PO_LNE_NBR                                11220074
112300                , A.VEND_STYL_NAME                                11230074
112400                , A.UNT_QTY                                       11240074
112500                , A.UNT_RTL_PR_AMT                                11250074
112600                , A.GP_RTL_AMT                                    11260074
112700                , A.GP_QTY                                        11270074
112800                , A.PO_LNE_NBR                                    11280074
112900                , A.PREPK_RATO_QTY                                11290074
113000                , A.STATUS_CDE                                    11300074
113100                , A.ITM_NBR                                       11310074
113200                , B.ORD_LNE_NBR                                   11320074
113300                , B.STATUS_CDE                                    11330074
113400                , B.CASE_PACK_QTY                                 11340074
113500                , B.DTL_CK_ITM_QTY                                11350074
113600                , B.PKSL_ITM_QTY                                  11360074
113700                , B.MKING_APRON_TMST                              11370074
113800                , B.PREPK_RATO_QTY                                11380074
113900                , B.PREPK_ODD_UNT_QTY                             11390074
114000                , B.PREPK_ID                                      11400074
114100           FROM   TPURITM A                                       11410074
114200                , TRECITM B                                       11420074
114300                , TRECEIV C                                       11430074
114400         WHERE    A.PO_NBR         = :DK-ORD-NBR                  11440074
114500             AND  A.VER_STATUS_CDE = 'A'                          11450074
114600             AND  B.ORD_NBR        = A.PO_NBR                     11460074
114700             AND  B.ORD_LNE_NBR    = A.APP_PO_LNE_NBR             11470074
114800             AND  B.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             11480074
114900             AND  B.PREPK_ID       = :DK-PACK-ID                  11490074
115000             AND (B.PREPK_RATO_QTY > 0  OR                        11500074
115100                 (B.PREPK_RATO_QTY = 0  AND                       11510074
115200                  B.DTL_CK_ITM_QTY > 0) OR                        11520074
115300                  B.PREPK_ID       = 99)                          11530074
115400             AND  B.VER_STATUS_CDE = 'A'                          11540074
115500             AND  B.OPER_UNT_ID    = :DK-OPR-ID                   11550074
115600             AND  B.FCLTY_ID       = :DK-FACT                     11560074
115700             AND  C.ORD_NBR        = B.ORD_NBR                    11570074
115800             AND  C.REC_SEQ_NBR    = B.REC_SEQ_NBR                11580074
115900             AND  C.OPER_UNT_ID    = B.OPER_UNT_ID                11590074
116000             AND  C.FCLTY_ID       = B.FCLTY_ID                   11600074
116100             AND  C.VER_STATUS_CDE = 'A'                          11610074
116200         ORDER BY APP_PO_LNE_NBR                                  11620074
116300     END-EXEC.                                                    11630074
116400*----------------------------------------------------------------*11640074
116500* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *11650074
116600*----------------------------------------------------------------*11660074
116700*                                                                 11670074
116800                                                                  11680074
116900     COPY DPWS277.                                                11690074
117000/                                                                 11700074
117100/                                                                 11710074
117200 LINKAGE SECTION.                                                 11720074
117300                                                                  11730074
117400 01  DFHCOMMAREA.                                                 11740074
117500     05  FILLER                         OCCURS  1 TO 4072 TIMES   11750074
117600                                        DEPENDING ON EIBCALEN.    11760074
117700         10  FILLER                     PIC X.                    11770074
117800                                                                  11780074
117900/                                                                 11790074
118000 PROCEDURE DIVISION.                                              11800074
118100*---------------------------------------------------------------* 11810074
118200*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 11820074
118300*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 11830074
118400*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 11840074
118500*---------------------------------------------------------------* 11850074
118600 0000-MAIN-MODULE.                                                11860074
118700                                                                  11870074
118800     INITIALIZE DP030-CICS-API-FIELDS.                            11880074
118900                                                                  11890074
119000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       11900074
119100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          11910074
119200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         11920074
119300                                                                  11930074
119400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       11940074
119500                                                                  11950074
119600     MOVE LENGTH OF RC801AI        TO DP030-MAP-LENGTH (1).       11960074
119700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     11970074
119800                                                                  11980074
119900     PERFORM 0001-CALL-CICS-ARCH-API.                             11990074
120000     PERFORM 1000-CONTROL-PROCESSING                              12000074
120100                                                                  12010074
120200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     12020074
120300     PERFORM 0001-CALL-CICS-ARCH-API.                             12030074
120400                                                                  12040074
120500                                                                  12050074
120600*---------------------------------------------------------------* 12060074
120700*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 12070074
120800*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 12080074
120900*---------------------------------------------------------------* 12090074
121000 0001-CALL-CICS-ARCH-API.                                         12100074
121110     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      12111099
121200                                    DFHCOMMAREA                   12120099
121300                                    DP030-CICS-API-FIELDS         12130099
121400                                    DP020-STANDARD-COMMAREA       12140099
121500                                    RC801AI.                      12150099
121600                                                                  12160074
121700     IF  DP030-RC-CALL-SUCCESSFUL OR                              12170074
121800         DP030-RC-APPL-ERROR                                      12180074
121900         CONTINUE                                                 12190074
122000     ELSE                                                         12200074
122100         SET DP013-NO-ROLLBACK                                    12210074
122200             DP013-XCTL-DISPLAY-RESTART                           12220074
122300             DP013-CICS-ABEND      TO TRUE                        12230074
122400         MOVE '0001-CALL-CICS-ARCH-API'                           12240074
122500                                   TO DP013-PARAGRAPH             12250074
122520         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O12252099
122530-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      12253099
122800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      12280074
122900         PERFORM DP013-0000-PROCESS-ABEND                         12290074
123000     END-IF.                                                      12300074
123100                                                                  12310074
123200                                                                  12320074
123300*----------------------------------------------------------------*12330074
123400* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *12340074
123500* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *12350074
123600*                                                                *12360074
123700* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *12370074
123800*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *12380074
123900*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *12390074
124000*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *12400074
124100*----------------------------------------------------------------*12410074
124200                                                                  12420074
124300 1000-CONTROL-PROCESSING.                                         12430074
124400                                                                  12440074
124500     EVALUATE TRUE                                                12450074
124600         WHEN DP020-NEXT-ACT-INITIAL                              12460074
124700             INITIALIZE ASC-SPECIFIC-COMMAREA                     12470074
124800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            12480074
124900                                      ASC-SEL-TERM-ID-OUT         12490074
125000             MOVE DP020-SRC-TASK-NUMBER                           12500074
125100                                   TO ASC-LIST-TASK-NUMBER        12510074
125200                                      ASC-SEL-TASK-NUMBER-OUT     12520074
125300             MOVE PC-LIST-QUEUE-SEQ                               12530074
125400                                   TO ASC-LIST-SEQ                12540074
125500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             12550074
125600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 12560074
125700             IF  PS-COMMAREA-NOT-VALID                            12570074
125800                 SET DP020-MSG-FATAL                              12580074
125900                     DP020-NEXT-ACT-APPL-ERROR TO TRUE            12590074
126000             ELSE                                                 12600074
126100                 MOVE INTER-APPL-COMM-AREA                        12610074
126200                                   TO ASC-HOLD-INTER-APPL         12620074
126300                 PERFORM 4000-BUILD-INITIAL-PANEL                 12630074
126400             END-IF                                               12640074
126500                                                                  12650074
126600         WHEN DP020-NEXT-ACT-READ-MAP                             12660074
126700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        12670074
126800                                   TO PV-TOP-ITEM                 12680074
126900             PERFORM 2000-PROCESS-PANEL                           12690074
127000                                                                  12700074
127100         WHEN DP020-NEXT-ACT-RETURN OR                            12710074
127200              ASC-UPDATE-PENDING                                  12720074
127300              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       12730074
127400                                   TO PV-TOP-ITEM                 12740074
127500              MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL    12750074
127600              SET ASC-UPDATE-NOT-PENDING                          12760074
127700                                   TO TRUE                        12770074
127800              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                12780074
127900              PERFORM 4100-PREPARE-CURSOR                         12790074
128000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                12800074
128100                                                                  12810074
128200         WHEN OTHER                                               12820074
128300             SET DP013-LOGIC-ABEND TO TRUE                        12830074
128400             SET DP013-NO-ROLLBACK TO TRUE                        12840074
128500             MOVE '1000-CONTROL-PROCESSING'                       12850074
128600                                   TO DP013-PARAGRAPH             12860074
128700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    12870074
128800                                   TO DP013-MESSAGE-TEXT(1)       12880074
128900             PERFORM DP013-0000-PROCESS-ABEND                     12890074
129000     END-EVALUATE.                                                12900074
129100                                                                  12910074
129200/                                                                 12920074
129300*----------------------------------------------------------------*12930074
129400* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *12940074
129500*----------------------------------------------------------------*12950074
129600 1100-PROCESS-INTER-APPL-COMM.                                    12960074
129700                                                                  12970074
129800     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INTER-APPL-CODE-IND    12980074
129900     EVALUATE TRUE                                                12990074
130000       WHEN ASC-INTER-APPL-AUDT-LIST                              13000074
130100         SET PS-COMMAREA-VALID         TO TRUE                    13010074
130200         MOVE RC800-REC-NBR-N          TO ASC-REC-NBR             13020074
130300         MOVE RC800-REC-SEQ-NBR-N      TO ASC-REC-SEQ-NBR         13030074
130400         MOVE RC800-OPER-UNIT-ID       TO ASC-OPR-ID              13040074
130500         MOVE RC800-FACILITY-ID        TO ASC-FACT                13050074
130600         MOVE RC800-LINE-NBR-N         TO ASC-PACK-ID             13060074
130700       WHEN OTHER                                                 13070074
130800         SET PS-COMMAREA-VALID         TO TRUE                    13080074
130900         MOVE SPACE                    TO ASC-START-ITEM-REQUEST  13090074
131000                                                                  13100074
131100         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    13110074
131200         MOVE RC800-NUMBER-OF-SELECTED-ITEMS                      13120074
131300                                   TO ASC-NUMBER-OF-SELECTED-ITEMS13130074
131400         MOVE RC800-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  13140074
131500         MOVE RC800-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   13150074
131600                                                                  13160074
131700         MOVE RC801-MAX-ITEMS          TO ASC-SEL-SUB             13170074
131800         MOVE ZERO                     TO ASC-SEL-ITEM            13180074
131900         PERFORM 2400-GET-NEXT-PKSL-RECORD                        13190074
132000                                                                  13200074
132100     END-EVALUATE.                                                13210074
132200/                                                                 13220074
132300*----------------------------------------------------------------*13230074
132400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *13240074
132500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *13250074
132600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *13260074
132700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *13270074
132800* FUNCTION KEYS CAN GET THIS FAR.                                *13280074
132900*----------------------------------------------------------------*13290074
133000                                                                  13300074
133100 2000-PROCESS-PANEL.                                              13310074
133200     EVALUATE TRUE                                                13320074
133300         WHEN DP020-SRC-AID = DP016-CLEAR                         13330074
133400             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13340074
133500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13350074
133600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13360074
133700                                                                  13370074
133800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13380074
133900             MOVE ' '           TO ASC-QUICKCALC-FUNCTION-SW      13390074
134000             PERFORM 2050-DELETE-LIST-QUEUE                       13400074
134100             PERFORM 4000-BUILD-INITIAL-PANEL                     13410074
134200                                                                  13420074
134300         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   13430074
134400             PERFORM 2140-DESELECT-ALL-ITEMS                      13440074
134500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13450074
134600                                                                  13460074
134700         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 13470074
134800              PERFORM 2150-SELECT-ALL-ITEMS                       13480074
134900              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                13490074
135000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                13500074
135100                                                                  13510074
135200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13520074
135300             IF ASC-USE-SELECTION-QUEUE                           13530074
135400                 PERFORM 6200-DEL-LIST-QUEUE                      13540074
135500                 IF ASC-INTER-APPL-PKSL-LIST                      13550074
135600                     PERFORM 2400-GET-NEXT-PKSL-RECORD            13560074
135700                 ELSE                                             13570074
135800                     PERFORM 2300-GET-NEXT-RECORD                 13580074
135900                 END-IF                                           13590074
136000                 PERFORM 4000-BUILD-INITIAL-PANEL                 13600074
136100             ELSE                                                 13610074
136200*                --- BOTTOM OF LIST ---                           13620074
136300                 MOVE PC-TSYMSG-00070                             13630074
136400                                   TO DP020-MSG-NUMBER            13640074
136500                 SET DP020-MSG-INFORMATIONAL                      13650074
136600                                   TO TRUE                        13660074
136700             END-IF                                               13670074
136800                                                                  13680074
136900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13690074
137000             IF ASC-USE-SELECTION-QUEUE                           13700074
137100                 PERFORM 6200-DEL-LIST-QUEUE                      13710074
137200                 IF ASC-INTER-APPL-PKSL-LIST                      13720074
137300                     PERFORM 2410-GET-PREV-PKSL-RECORD            13730074
137400                 ELSE                                             13740074
137500                     PERFORM 2310-GET-PREV-RECORD                 13750074
137600                 END-IF                                           13760074
137700                 PERFORM 4000-BUILD-INITIAL-PANEL                 13770074
137800             ELSE                                                 13780074
137900*                --- TOP OF LIST ---                              13790074
138000                 MOVE PC-TSYMSG-00069                             13800074
138100                                   TO DP020-MSG-NUMBER            13810074
138200                 SET PS-ERROR      TO TRUE                        13820074
138300                 SET DP020-MSG-INFORMATIONAL                      13830074
138400                                   TO TRUE                        13840074
138500             END-IF                                               13850074
138600         WHEN OTHER                                               13860074
138700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 13870074
138800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13880074
138900             IF  PS-NO-ERROR                                      13890074
139000                 SET DP030-CONTINUE-GO TO TRUE                    13900074
139100                 PERFORM 2100-CHECK-FUNCTION-KEY                  13910074
139200             ELSE                                                 13920074
139300                 SET DP030-OVERRIDE-GO TO TRUE                    13930074
139400             END-IF                                               13940074
139500     END-EVALUATE.                                                13950074
139600                                                                  13960074
139700/                                                                 13970074
139800*----------------------------------------------------------------*13980074
139900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *13990074
140000*----------------------------------------------------------------*14000074
140100 2050-DELETE-LIST-QUEUE.                                          14010074
140200                                                                  14020074
140300     EXEC CICS                                                    14030074
140400         DELETEQ TS                                               14040074
140500           QUEUE (ASC-LIST-QUEUE-NAME)                            14050074
140600            RESP (PV-CICS-RESP)                                   14060074
140700     END-EXEC.                                                    14070074
140800                                                                  14080074
140900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14090074
141000        (PV-CICS-RESP = DFHRESP(QIDERR))                          14100074
141100         CONTINUE                                                 14110074
141200     ELSE                                                         14120074
141300         SET DP013-CICS-ABEND      TO TRUE                        14130074
141400         SET DP013-NO-ROLLBACK     TO TRUE                        14140074
141500                                                                  14150074
141600         MOVE '2050-DELETE-LIST-QUEUE'                            14160074
141700                                   TO DP013-PARAGRAPH             14170074
141800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    14180074
141900                                   TO DP013-MESSAGE-TEXT (1)      14190074
142000         PERFORM DP013-0000-PROCESS-ABEND                         14200074
142100     END-IF.                                                      14210074
142200                                                                  14220074
142300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  14230074
142400                                                                  14240074
142500/                                                                 14250074
142600*----------------------------------------------------------------*14260074
142700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14270074
142800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14280074
142900* CICS ARCHITECTURE API.                                         *14290074
143000*----------------------------------------------------------------*14300074
143100 2100-CHECK-FUNCTION-KEY.                                         14310074
143200                                                                  14320074
143300     EVALUATE TRUE                                                14330074
143400*  REDISTRO                                                       14340074
143500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              14350074
143600             SET ASC-NO-CALL-REDISTRO                             14360074
143700                 ASC-OTHER-FUNCTION                               14370074
143800                 ASC-NO-CALL-STORE-ADJ                            14380074
143900                                   TO TRUE                        14390074
144000             PERFORM 2105-GENERAL-FKEY-EDITS                      14400074
144100             PERFORM 4100-PREPARE-CURSOR                          14410074
144200                                                                  14420074
144300             PERFORM 2170-DETERMINE-IF-PACK                       14430074
144400             IF PV-PACK-LINE-COUNT = 0                            14440074
144500                MOVE PC-TSYMSG-02178 TO DP020-MSG-NUMBER          14450074
144600                SET PS-ERROR                                      14460074
144700                    DP030-OVERRIDE-GO                             14470074
144800                    DP020-MSG-FATAL  TO TRUE                      14480074
144900                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              14490074
145000             ELSE                                                 14500074
145100                IF PS-NO-ERROR                                    14510074
145200                   PERFORM 6500-PROCESS-REDISTRO                  14520074
145300                   PERFORM 2050-DELETE-LIST-QUEUE                 14530074
145400                   PERFORM 4000-BUILD-INITIAL-PANEL               14540074
145500                END-IF                                            14550074
145600             END-IF                                               14560074
145700                                                                  14570074
145800* UPDATE                                                          14580074
145900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) OR           14590074
146000              (DP020-FK-CONFIRM (DP020-SRC-AID)     AND           14600074
146100               ASC-UPDATE-PENDING)                                14610074
146200             SET ASC-UPDATE-FUNCTION                              14620074
146300                 ASC-DELETE-NOT-PENDING                           14630074
146400                 ASC-UNITS-ONLY-CHANGE                            14640074
146500                                   TO TRUE                        14650074
146600             IF DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)             14660074
146700                SET ASC-NO-CALL-REDISTRO                          14670074
146800                    ASC-NO-CALL-STORE-ADJ                         14680074
146900                                   TO TRUE                        14690074
147000             END-IF                                               14700074
147100                                                                  14710074
147200             PERFORM 2105-GENERAL-FKEY-EDITS                      14720074
147300             IF PS-NO-ERROR                                       14730074
147400                IF ASC-UPDATE-DIDNT-OCCUR AND                     14740074
147500                   ASC-UPDATE-NOT-PENDING                         14750074
147600                     MOVE PC-TSYMSG-00046 TO DP020-MSG-NUMBER     14760074
147700                     SET DP020-MSG-WARNING                        14770074
147800                         DP030-OVERRIDE-GO                        14780074
147900                         PS-ERROR       TO TRUE                   14790074
148000                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          14800074
148100                ELSE                                              14810074
148200                PERFORM 5050-PREPARE-SEL-QUEUE2                   14820074
148300                                                                  14830074
148400                IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID) AND     14840074
148500                   ASC-NUMBER-OF-SELECTED-ITEMS = ZERO            14850074
148600                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     14860074
148700                     SET DP020-MSG-WARNING                        14870074
148800                         DP030-OVERRIDE-GO                        14880074
148900                         PS-ERROR       TO TRUE                   14890074
149000                ELSE                                              14900074
149100                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           14910074
149200                   IF ASC-UPDATE-PENDING OR                       14920074
149300                      PS-ERROR                                    14930074
149400                       CONTINUE                                   14940074
149500                   ELSE                                           14950074
149600                      MOVE ASC-HOLD-INTER-APPL                    14960074
149700                                        TO INTER-APPL-COMM-AREA   14970074
149800                      PERFORM 2050-DELETE-LIST-QUEUE              14980074
149900                      PERFORM 4000-BUILD-INITIAL-PANEL            14990074
150000                   END-IF                                         15000074
150100                END-IF                                            15010074
150200                END-IF                                            15020074
150300             END-IF                                               15030074
150400                                                                  15040074
150500                                                                  15050074
150600*** GOTO STORE DISTRO BY PACK (RCLPKST)                           15060074
150700          WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)             15070074
150800            SET ASC-OTHER-FUNCTION    TO TRUE                     15080074
150900            IF ASC-PACK-ID = 99                                   15090074
151000               MOVE PC-TSYMSG-02195   TO DP020-MSG-NUMBER         15100074
151100                SET PS-ERROR                                      15110074
151200                    DP020-MSG-FATAL                               15120074
151300                    DP030-OVERRIDE-GO TO TRUE                     15130074
151400                PERFORM 4000-BUILD-INITIAL-PANEL                  15140074
151500             ELSE                                                 15150074
151600                SET ASC-UPDATE-TSQ3   TO TRUE                     15160074
151700                PERFORM 4100-PREPARE-CURSOR                       15170074
151800                                                                  15180074
151900                PERFORM 2170-DETERMINE-IF-PACK                    15190074
152000                IF PV-PACK-LINE-COUNT = 0                         15200074
152100                   MOVE PC-TSYMSG-02178 TO DP020-MSG-NUMBER       15210074
152200                   SET PS-ERROR                                   15220074
152300                       DP030-OVERRIDE-GO                          15230074
152400                       DP020-MSG-FATAL  TO TRUE                   15240074
152500                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           15250074
152600                ELSE                                              15260074
152700                    PERFORM 5050-PREPARE-SEL-QUEUE2               15270074
152800                    PERFORM 7000-FORMAT-COMMAREA                  15280074
152900                END-IF                                            15290074
153000             END-IF                                               15300074
153100                                                                  15310074
153200                                                                  15320074
153300*** GOTO TROUBLE LIST (TMLDCLNE)                                  15330074
153400          WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)             15340074
153500             SET ASC-UPDATE-TSQ2                                  15350074
153600                 ASC-OTHER-FUNCTION    TO TRUE                    15360074
153700             PERFORM 5000-PREPARE-SEL-QUEUE                       15370074
153800             IF PC000-NUMBER-OF-SELECTED-ITEMS = 0                15380074
153900                MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER          15390074
154000                SET DP030-OVERRIDE-GO                             15400074
154100                    DP020-MSG-WARNING                             15410074
154200                    PS-ERROR         TO TRUE                      15420074
154300                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              15430074
154400             ELSE                                                 15440074
154500                 PERFORM 7000-FORMAT-COMMAREA                     15450074
154600             END-IF                                               15460074
154700                                                                  15470074
154800                                                                  15480074
154900*** CREATE TROUBLE (TRBLCRE)                                      15490074
155000         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              15500074
155100             SET ASC-UPDATE-TSQ2                                  15510074
155200                 ASC-OTHER-FUNCTION    TO TRUE                    15520074
155300             PERFORM 5050-PREPARE-SEL-QUEUE2                      15530074
155400             IF RC800-NUMBER-OF-SELECTED-ITEMS = 0                15540074
155500                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         15550074
155600                 SET DP030-OVERRIDE-GO                            15560074
155700                     DP020-MSG-WARNING                            15570074
155800                     PS-ERROR         TO TRUE                     15580074
155900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15590074
156000             ELSE                                                 15600074
156100                 MOVE ASC-REC-NBR     TO RC800-REC-NBR-N          15610074
156200                 MOVE ASC-REC-SEQ-NBR TO RC800-REC-SEQ-NBR-N      15620074
156300                 MOVE ASC-OPR-ID      TO RC800-OPER-UNIT-ID       15630074
156400                 MOVE ASC-FACT        TO RC800-FACILITY-ID        15640074
156500             END-IF                                               15650074
156600                                                                  15660074
156700                                                                  15670074
156800*** QUICKCALC - VIEW WHAT WILL BE UPDATED, WITHOUT UPDATING       15680074
156900         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              15690074
157000             PERFORM 2105-GENERAL-FKEY-EDITS                      15700074
157100             IF PS-NO-ERROR                                       15710074
157200                SET ASC-NO-CALL-REDISTRO                          15720074
157300                    ASC-NO-CALL-STORE-ADJ                         15730074
157400                    ASC-DELETE-NOT-PENDING                        15740074
157500                    ASC-QUICKCALC-FUNCTION                        15750074
157600                    ASC-UNITS-ONLY-CHANGE                         15760074
157700                                        TO TRUE                   15770074
157800                MOVE 0                  TO                        15780074
157900                                       ASC-EXPD-PACKS-QTY         15790074
158000                                       PV-TOTAL-QC-DTL-RATIO      15800074
158100                                       PV-TOTAL-QC-ODD-UNIT-QTY   15810074
158200                                       PV-TOTAL-QC-DTL-CK-ITM-QTY 15820074
158300                PERFORM 5050-PREPARE-SEL-QUEUE2                   15830074
158400                IF PS-NO-ERROR                                    15840074
158500                   IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO         15850074
158600                      MOVE ASC-HOLD-INTER-APPL                    15860074
158700                                        TO INTER-APPL-COMM-AREA   15870074
158800                      PERFORM 2104-CALC-QUICKCALC-VALUES          15880074
158900                      MOVE PC-TSYMSG-02177                        15890074
159000                                        TO DP020-MSG-NUMBER       15900074
159100                      SET DP020-MSG-INFORMATIONAL                 15910074
159200                          DP030-OVERRIDE-GO                       15920074
159300                                         TO TRUE                  15930074
159400                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        15940074
159500                   ELSE                                           15950074
159600                      MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER    15960074
159700                      SET DP020-MSG-WARNING                       15970074
159800                          ASC-OTHER-FUNCTION                      15980074
159900                          DP030-OVERRIDE-GO                       15990074
160000                          PS-ERROR         TO TRUE                16000074
160100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         16010074
160200                  END-IF                                          16020074
160300               END-IF                                             16030074
160400             END-IF                                               16040074
160500                                                                  16050074
160600                                                                  16060074
160700*** GOTO PRINT TICKET (RCSTCKT)                                   16070074
160800          WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)             16080074
160900             SET ASC-UPDATE-TSQ4                                  16090074
161000                 ASC-OTHER-FUNCTION    TO TRUE                    16100074
161100             PERFORM 5000-PREPARE-SEL-QUEUE                       16110074
161200             IF PC000-NUMBER-OF-SELECTED-ITEMS = 0                16120074
161300                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              16130074
161400                MOVE PC-TSYMSG-00057                              16140074
161500                                   TO DP020-MSG-NUMBER            16150074
161600                SET DP020-MSG-WARNING                             16160074
161700                    DP030-OVERRIDE-GO                             16170074
161800                    PS-ERROR       TO TRUE                        16180074
161900             ELSE                                                 16190074
162000                 PERFORM 7000-FORMAT-COMMAREA                     16200074
162100             END-IF                                               16210074
162200                                                                  16220074
162300*** GOTO PRINT PACK MARKING APRON (PCSPRINT)                      16230074
162400          WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)             16240074
162500             SET ASC-OTHER-FUNCTION    TO TRUE                    16250074
162600             IF ASC-PACK-ID = 99                                  16260074
162700                MOVE PC-TSYMSG-02195    TO DP020-MSG-NUMBER       16270074
162800                SET PS-ERROR                                      16280074
162900                    DP020-MSG-FATAL                               16290074
163000                    DP030-OVERRIDE-GO   TO TRUE                   16300074
163100                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              16310074
163200             ELSE                                                 16320074
163300                PERFORM 4100-PREPARE-CURSOR                       16330074
163400                PERFORM 2170-DETERMINE-IF-PACK                    16340074
163500                IF PV-PACK-LINE-COUNT = 0                         16350074
163600                   MOVE PC-TSYMSG-02178 TO DP020-MSG-NUMBER       16360074
163700                   SET PS-ERROR                                   16370074
163800                       DP020-MSG-FATAL                            16380074
163900                       DP030-OVERRIDE-GO                          16390074
164000                                        TO TRUE                   16400074
164100                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           16410074
164200                ELSE                                              16420074
164300                    SET ASC-UPDATE-TSQ3     TO TRUE               16430074
164400                    PERFORM 5000-PREPARE-SEL-QUEUE                16440074
164500                    PERFORM 7000-FORMAT-COMMAREA                  16450074
164600                END-IF                                            16460074
164700             END-IF                                               16470074
164800                                                                  16480074
164900*  REMOVE THE LINE(S) FROM THE PACK                               16490074
165000         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID) OR           16500079
165100              (DP020-FK-CONFIRM (DP020-SRC-AID) AND               16510079
165200               ASC-DELETE-PENDING)                                16520079
165300*KBW           PERFORM 3600-CHECK-WMS                             16530099
165400*KBW           IF PS-RECEIVING-BEGUN-NO                           16540099
165500                  SET ASC-UPDATE-NOT-PENDING                      16550099
165600                      ASC-NO-CALL-REDISTRO                        16560099
165700                      ASC-OTHER-FUNCTION                          16570099
165800                      ASC-NO-CALL-STORE-ADJ                       16580099
165900                                       TO TRUE                    16590099
166000                   PERFORM 2105-GENERAL-FKEY-EDITS                16600099
166100                   PERFORM 4100-PREPARE-CURSOR                    16610099
166200                                                                  16620099
166300                   PERFORM 2170-DETERMINE-IF-PACK                 16630079
166400                   IF PV-PACK-LINE-COUNT = 0                      16640079
166500                      MOVE PC-TSYMSG-02178 TO DP020-MSG-NUMBER    16650079
166600                      SET PS-ERROR                                16660079
166700                          DP030-OVERRIDE-GO                       16670079
166800                          DP020-MSG-FATAL  TO TRUE                16680079
166900                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        16690079
167000                   ELSE                                           16700079
167100                   IF PS-NO-ERROR                                 16710079
167200                      PERFORM 2200-MOVE-SCREEN-TO-COMMAREA        16720079
167300                      PERFORM 5050-PREPARE-SEL-QUEUE2             16730079
167400                      IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO AND  16740079
167500                         DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)   16750079
167600                          SET DP030-OVERRIDE-GO                   16760079
167700                              DP020-MSG-WARNING                   16770079
167800                              PS-ERROR       TO TRUE              16780079
167900                          MOVE PC-TSYMSG-00057                    16790079
168000                                             TO DP020-MSG-NUMBER  16800079
168100                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    16810079
168200                      ELSE                                        16820079
168300                         IF ASC-DELETE-PENDING OR                 16830079
168400                            PS-ERROR                              16840079
168500                             CONTINUE                             16850079
168600                         ELSE                                     16860079
168700                            MOVE ASC-HOLD-INTER-APPL              16870079
168800                               TO INTER-APPL-COMM-AREA            16880079
168900                            PERFORM 2050-DELETE-LIST-QUEUE        16890079
169000                            PERFORM 4000-BUILD-INITIAL-PANEL      16900079
169100                         END-IF                                   16910079
169200                      END-IF                                      16920079
169300                   END-IF                                         16930079
169400                   END-IF                                         16940079
169500*KBW           ELSE                                               16950099
169600*KBW              MOVE PC-TSYMSG-03538  TO DP020-MSG-NUMBER       16960099
169700*KBW              SET PS-ERROR                                    16970099
169800*KBW                  DP030-OVERRIDE-GO                           16980099
169900*KBW                  ASC-DELETE-NOT-PENDING                      16990099
170000*KBW                  DP020-MSG-FATAL TO TRUE                     17000099
170100*KBW              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            17010099
170200*KBW           END-IF                                             17020099
170300                                                                  17030074
170400                                                                  17040074
170500*  ADD ITEM                                                       17050074
170600         WHEN DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)              17060074
170700             SET ASC-OTHER-FUNCTION   TO TRUE                     17070074
170800             PERFORM 2105-GENERAL-FKEY-EDITS                      17080074
170900             IF PS-NO-ERROR                                       17090074
171000                MOVE +0               TO ASC-PREV-BEST-CASE-PACKS 17100074
171100                SET DP030-CONTINUE-GO TO TRUE                     17110074
171200                PERFORM 5050-PREPARE-SEL-QUEUE2                   17120074
171300                PERFORM 7000-FORMAT-COMMAREA                      17130074
171400             END-IF                                               17140074
171500                                                                  17150074
171600*  RECEIVER ITEM UPDATE SCREEN (INQUIRY ACCESS ONLY)              17160074
171700         WHEN DP020-FK-LOCAL-FUNC-11 (DP020-SRC-AID)              17170074
171800             SET ASC-OTHER-FUNCTION                               17180074
171900                 ASC-UPDATE-TSQ4         TO TRUE                  17190074
172000             PERFORM 5000-PREPARE-SEL-QUEUE                       17200074
172100             IF PC000-NUMBER-OF-SELECTED-ITEMS = 0                17210074
172200                MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER          17220074
172300                SET DP020-MSG-WARNING                             17230074
172400                    DP030-OVERRIDE-GO                             17240074
172500                    PS-ERROR             TO TRUE                  17250074
172600                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              17260074
172700             ELSE                                                 17270074
172800                PERFORM 7000-FORMAT-COMMAREA                      17280074
172900             END-IF                                               17290074
173000                                                                  17300074
173100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  17310074
173200             PERFORM 4100-PREPARE-CURSOR                          17320074
173300             MOVE +1               TO PV-TOP-ITEM                 17330074
173400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17340074
173500                                                                  17350074
173600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   17360074
173700             PERFORM 4100-PREPARE-CURSOR                          17370074
173800             PERFORM 2110-BROWSE-BACKWARD                         17380074
173900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17390074
174000                                                                  17400074
174100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   17410074
174200             PERFORM 4100-PREPARE-CURSOR                          17420074
174300             PERFORM 2120-BROWSE-FORWARD                          17430074
174400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17440074
174500                                                                  17450074
174600         WHEN DP020-SRC-AID = DP016-ENTER                         17460074
174700             PERFORM 4100-PREPARE-CURSOR                          17470074
174800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   17480074
174900             IF  PS-ERROR                                         17490074
175000                 CONTINUE                                         17500074
175100             ELSE                                                 17510074
175200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17520074
175300             END-IF                                               17530074
175400                                                                  17540074
175500         WHEN ASC-UPDATE-PENDING                                  17550074
175600             PERFORM 2050-DELETE-LIST-QUEUE                       17560074
175700             SET ASC-UPDATE-NOT-PENDING TO TRUE                   17570074
175800                                                                  17580074
175900* THIS WILL PREVENT AN ABEND IF THE USER HITS F2-CONFIRM WITHOUT  17590074
176000* UPDATING FIRST                                                  17600074
176100         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    17610074
176200          AND  NOT ASC-UPDATE-PENDING                             17620074
176300               SET DP030-OVERRIDE-GO TO TRUE                      17630074
176400*     INVALID FUNCTION KEY                                        17640074
176500               MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER          17650074
176600               SET PS-ERROR                                       17660074
176700                   DP020-MSG-FATAL   TO TRUE                      17670074
176800             PERFORM 4100-PREPARE-CURSOR                          17680074
176900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17690074
177000                                                                  17700074
177100         WHEN OTHER                                               17710074
177200             SET DP013-NO-ROLLBACK                                17720074
177300                 DP013-XCTL-DISPLAY-RESTART                       17730074
177400                 DP013-CICS-ABEND  TO TRUE                        17740074
177500             MOVE '2100-CHECK-FUNCTION-KEY'                       17750074
177600                                   TO DP013-PARAGRAPH             17760074
177700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      17770074
177800                                   TO DP013-MESSAGE-TEXT (1)      17780074
177900             PERFORM DP013-0000-PROCESS-ABEND                     17790074
178000     END-EVALUATE.                                                17800074
178100                                                                  17810074
178200/                                                                 17820074
178300*----------------------------------------------------------------*17830074
178400*  CALCULATE THE TEMP VALUES TO DISPLAY THE FOR THE QUICKCALC    *17840074
178500*  OPTION.                                                       *17850074
178600*----------------------------------------------------------------*17860074
178700 2104-CALC-QUICKCALC-VALUES.                                      17870074
178800     MOVE ZEROES                  TO ASC-ACT-UNITS-PER-CTN.       17880074
178900*    IF ASC-PKGNG-CDE = "M"                                       17890099
179000*       MOVE PV-TOTAL-QC-DTL-RATIO                                17900099
179100*                                 TO ASC-ACT-UNITS-PER-CTN        17910099
179200*    ELSE                                                         17920099
179300*       IF ASC-PKGNG-CDE = "I"                                    17930099
179400*          COMPUTE ASC-ACT-UNITS-PER-CTN =                        17940099
179500*                                PV-TOTAL-QC-DTL-RATIO *          17950099
179600*                                 RECITM-CASE-PACK-QTY.           17960099
179700                                                                  17970074
179800     IF ASC-PKGNG-CDE = "I"                                       17980099
179900           COMPUTE ASC-ACT-UNITS-PER-CTN =                        17990099
180000                                 PV-TOTAL-QC-DTL-RATIO *          18000099
180100                                  RECITM-CASE-PACK-QTY            18010099
180200     ELSE                                                         18020099
180300        IF ASC-PKGNG-CDE = "M"                                    18030099
180400           IF RECITM-CASE-PACK-QTY > 1                            18040099
180500              COMPUTE ASC-ACT-UNITS-PER-CTN =                     18050099
180600                                 PV-TOTAL-QC-DTL-RATIO *          18060099
180700                                  RECITM-CASE-PACK-QTY            18070099
180800           ELSE                                                   18080099
180900              MOVE PV-TOTAL-QC-DTL-RATIO                          18090099
181000                                  TO ASC-ACT-UNITS-PER-CTN.       18100099
181100                                                                  18110099
181200     MOVE PV-TOTAL-QC-DTL-RATIO   TO ASC-TOTAL-DTL-RATIO.         18120074
181300     MOVE PV-TOTAL-QC-ODD-UNIT-QTY                                18130074
181400                                  TO ASC-TOTAL-ODD-UNIT-QTY.      18140074
181500     MOVE PV-TOTAL-QC-DTL-CK-ITM-QTY                              18150074
181600                                  TO ASC-TOTAL-DTL-CK-ITM-QTY.    18160074
181700                                                                  18170074
181800                                                                  18180074
181900/                                                                 18190074
182000*----------------------------------------------------------------*18200074
182100*    THESE ARE GENERAL EDITS TO DETERMINE IF THE FKEY THAT THE   *18210074
182200*    USER HIT IS VALID BASED ON THE DATA DISPLAYED.              *18220074
182300*----------------------------------------------------------------*18230074
182400 2105-GENERAL-FKEY-EDITS.                                         18240074
182500                                                                  18250074
182600     PERFORM 4100-PREPARE-CURSOR.                                 18260074
182700                                                                  18270074
182800     IF ASC-PACK-ID = 99                                          18280074
182900        MOVE PC-TSYMSG-02195       TO DP020-MSG-NUMBER            18290074
183000        SET PS-ERROR               TO TRUE.                       18300074
183100                                                                  18310074
183200     IF ASC-REC-STAT = 'VE' AND                                   18320074
183300        PS-NO-ERROR                                               18330074
183400        MOVE PC-TSYMSG-01196       TO DP020-MSG-NUMBER            18340074
183500        SET PS-ERROR               TO TRUE.                       18350074
183600                                                                  18360074
183700     IF PS-NO-ERROR                                               18370074
183800        PERFORM 2160-CHECK-PACK-BY-STORE                          18380074
183900        IF PS-PACK-BY-ST-SW-YES                                   18390074
184000           MOVE PC-TSYMSG-00928    TO DP020-MSG-NUMBER            18400074
184100           SET PS-ERROR               TO TRUE.                    18410074
184200                                                                  18420074
184300     IF PS-NO-ERROR                                               18430074
184400        PERFORM 4470-DETERMINE-LINE-VE                            18440074
184500        IF PV-TOTAL-LINES-VERIFIED > 0                            18450074
184600           MOVE PC-TSYMSG-00929       TO DP020-MSG-NUMBER         18460074
184700           SET PS-ERROR               TO TRUE.                    18470074
184800                                                                  18480074
184900     IF PS-NO-ERROR                                               18490074
185000        PERFORM 4351-CK-CASEPACK-SPLIT-PROCESS                    18500074
185100        IF ASC-CASEPACK-YES                                       18510074
185200* IF REDISTRO                                                     18520074
185300           IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              18530074
185400              MOVE PC-TSYMSG-01793     TO DP020-MSG-NUMBER        18540074
185500           ELSE                                                   18550074
185600* IF REMOVE LINE                                                  18560074
185700             IF DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)            18570074
185800                MOVE PC-TSYMSG-02174     TO DP020-MSG-NUMBER      18580074
185900             ELSE                                                 18590074
186000* IF UPDATE LINE                                                  18600074
186100                MOVE PC-TSYMSG-02174     TO DP020-MSG-NUMBER      18610074
186200             END-IF                                               18620074
186300           END-IF                                                 18630074
186400           SET PS-ERROR                TO TRUE.                   18640074
186500                                                                  18650074
186600     IF PS-ERROR                                                  18660074
186700        SET DP030-OVERRIDE-GO                                     18670074
186800            DP020-MSG-FATAL            TO TRUE                    18680074
186900        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                     18690074
187000                                                                  18700074
187100                                                                  18710074
187200*----------------------------------------------------------------*18720074
187300*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *18730074
187400*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *18740074
187500*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *18750074
187600*    MESSAGE.                                                    *18760074
187700*----------------------------------------------------------------*18770074
187800 2110-BROWSE-BACKWARD.                                            18780074
187900                                                                  18790074
188000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    18800074
188100         GIVING PV-TOP-ITEM.                                      18810074
188200                                                                  18820074
188300     IF  ((PV-TOP-ITEM < +1)                                      18830074
188400       OR (PV-TOP-ITEM = +1))                                     18840074
188500         MOVE +1                   TO PV-TOP-ITEM                 18850074
188600*        -- TOP OF LIST --                                        18860074
188700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            18870074
188800         SET DP020-MSG-INFORMATIONAL                              18880074
188900                                   TO TRUE                        18890074
189000     END-IF.                                                      18900074
189100                                                                  18910074
189200/                                                                 18920074
189300*----------------------------------------------------------------*18930074
189400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *18940074
189500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *18950074
189600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *18960074
189700*----------------------------------------------------------------*18970074
189800                                                                  18980074
189900 2120-BROWSE-FORWARD.                                             18990074
190000                                                                  19000074
190100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              19010074
190200         GIVING PV-TOP-ITEM.                                      19020074
190300                                                                  19030074
190400     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   19040074
190500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            19050074
190600                                   TO PV-TOP-ITEM                 19060074
190700*        -- BOTTOM OF LIST --                                     19070074
190800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            19080074
190900         SET DP020-MSG-INFORMATIONAL                              19090074
191000                                   TO TRUE                        19100074
191100     ELSE                                                         19110074
191200         COMPUTE PV-BOTTOM-ITEM =                                 19120074
191300             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 19130074
191400         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            19140074
191500*            -- BOTTOM OF LIST --                                 19150074
191600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            19160074
191700             SET DP020-MSG-INFORMATIONAL                          19170074
191800                                   TO TRUE                        19180074
191900         END-IF                                                   19190074
192000     END-IF.                                                      19200074
192100                                                                  19210074
192200/                                                                 19220074
192300*----------------------------------------------------------------*19230074
192400*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *19240074
192500*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *19250074
192600*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *19260074
192700*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *19270074
192800*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *19280074
192900*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *19290074
193000*----------------------------------------------------------------*19300074
193100                                                                  19310074
193200 2130-CHECK-FOR-JUMP-BROWSE.                                      19320074
193300                                                                  19330074
193400     SET PS-NO-ERROR               TO TRUE.                       19340074
193500     IF (ASC-START-ITEM-REQUEST = SPACE)                          19350074
193600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            19360074
193700                                   TO PV-TOP-ITEM                 19370074
193800     ELSE                                                         19380074
193900         MOVE ASC-START-ITEM-REQUEST                              19390074
194000                                   TO DP010I-UNEDITED-FIELD       19400074
194100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       19410074
194200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     19420074
194300         SET DP010I-NEGATIVE-NOT-ALLOWED                          19430074
194400                                   TO TRUE                        19440074
194510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19451099
194520              USING DP010I-NUMERIC-EDIT-AREA                      19452099
194600                                                                  19460074
194700         IF  NOT DP010I-ERROR-DETECTED                            19470074
194800             MOVE DP010I-NUMERIC-FIELD                            19480074
194900                                   TO ASC-START-ITEM-REQUEST-N    19490074
195000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  19500074
195100                 IF  ASC-START-ITEM-REQUEST-N >                   19510074
195200                                          ASC-NUMBER-OF-ITEMS-READ19520074
195300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         19530074
195400                     COMPUTE PV-TOP-ITEM =                        19540074
195500                             ASC-NUMBER-OF-ITEMS-READ             19550074
195600                             - PC-ITEMS-PER-PANEL + 1             19560074
195700                     IF  PV-TOP-ITEM < +1                         19570074
195800                         MOVE +1   TO PV-TOP-ITEM                 19580074
195900                         MOVE PC-TSYMSG-00070                     19590074
196000                                   TO DP020-MSG-NUMBER            19600074
196100                         SET DP020-MSG-INFORMATIONAL              19610074
196200                                   TO TRUE                        19620074
196300                     END-IF                                       19630074
196400                 ELSE                                             19640074
196500                     MOVE ASC-START-ITEM-REQUEST-N                19650074
196600                                   TO PV-TOP-ITEM                 19660074
196700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      19670074
196800                     COMPUTE PV-BOTTOM-ITEM =                     19680074
196900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     19690074
197000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ19700074
197100*                        -- BOTTOM OF LIST --                     19710074
197200                         MOVE PC-TSYMSG-00070                     19720074
197300                                   TO DP020-MSG-NUMBER            19730074
197400                         SET DP020-MSG-INFORMATIONAL              19740074
197500                                   TO TRUE                        19750074
197600                     END-IF                                       19760074
197700                 END-IF                                           19770074
197800             ELSE                                                 19780074
197900*                --- VALUE OUT OF RANGE ----                      19790074
198000                 MOVE PC-TSYMSG-00101                             19800074
198100                                   TO DP020-MSG-NUMBER            19810074
198200                 MOVE -1           TO ASTRTITL                    19820074
198300                 SET DP030-SET-CURSOR-APPL-1                      19830074
198400                                   TO TRUE                        19840074
198500                 MOVE DP015-REVERSE                               19850074
198600                                   TO ASTRTITH                    19860074
198700                 MOVE DP015-RED    TO ASTRTITC                    19870074
198800                 MOVE DP015-UNP-NUM-BRT-MDT                       19880074
198900                                   TO ASTRTITA                    19890074
199000                 SET DP020-MSG-FATAL                              19900074
199100                                   TO TRUE                        19910074
199200                 SET PS-ERROR      TO TRUE                        19920074
199300             END-IF                                               19930074
199400                                                                  19940074
199500         ELSE                                                     19950074
199600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            19960074
199700             MOVE -1               TO ASTRTITL                    19970074
199800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19980074
199900             MOVE DP015-REVERSE    TO ASTRTITH                    19990074
200000             MOVE DP015-RED        TO ASTRTITC                    20000074
200100             MOVE DP015-UNP-NUM-BRT-MDT                           20010074
200200                                   TO ASTRTITA                    20020074
200300             SET DP020-MSG-FATAL   TO TRUE                        20030074
200400             SET PS-ERROR          TO TRUE                        20040074
200500         END-IF                                                   20050074
200600     END-IF.                                                      20060074
200700                                                                  20070074
200800/                                                                 20080074
200900*----------------------------------------------------------------*20090074
201000*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *20100074
201100*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *20110074
201200*----------------------------------------------------------------*20120074
201300 2140-DESELECT-ALL-ITEMS.                                         20130074
201400                                                                  20140074
201500     MOVE +1                       TO ASC-BLK-SUB.                20150074
201600                                                                  20160074
201700     PERFORM 2141-CLEAR-SELECTED-INDS                             20170074
201800         VARYING ASC-ITEM-SUB                                     20180074
201900         FROM 1 BY 1                                              20190074
202000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20200074
202100                                                                  20210074
202200     ADD +1                        TO ASC-BLK-SUB.                20220074
202300                                                                  20230074
202400     PERFORM 2141-CLEAR-SELECTED-INDS                             20240074
202500         VARYING ASC-ITEM-SUB                                     20250074
202600         FROM 1 BY 1                                              20260074
202700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20270074
202800                                                                  20280074
202900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20290074
203000                                   TO PV-LIST-ITEM-NUMBER.        20300074
203100                                                                  20310074
203200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20320074
203300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    20330074
203400                                                                  20340074
203500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     20350074
203600        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      20360074
203700         MOVE +1                   TO ASC-BLK-SUB                 20370074
203800                                                                  20380074
203900         PERFORM 5100-WRITE-TEMP-STORAGE                          20390074
204000                                                                  20400074
204100         MOVE +2                   TO ASC-BLK-SUB                 20410074
204200         PERFORM 5100-WRITE-TEMP-STORAGE                          20420074
204300                                                                  20430074
204400         MOVE +1                   TO ASC-BLK-SUB                 20440074
204500                                      PV-BLOCK-NUMBER             20450074
204600                                                                  20460074
204700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20470074
204800             PV-FIRST-BLOCK-IN-ARRAY - 1                          20480074
204900                                                                  20490074
205000         PERFORM                                                  20500074
205100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       20510074
205200                                                                  20520074
205300             PERFORM 4410-READ-TEMP-STORAGE                       20530074
205400                                                                  20540074
205500             PERFORM 2141-CLEAR-SELECTED-INDS                     20550074
205600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 20560074
205700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20570074
205800                                                                  20580074
205900             PERFORM 5100-WRITE-TEMP-STORAGE                      20590074
206000                                                                  20600074
206100             ADD +1                TO PV-BLOCK-NUMBER             20610074
206200                                                                  20620074
206300         END-PERFORM                                              20630074
206400                                                                  20640074
206500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20650074
206600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20660074
206700                                                                  20670074
206800         PERFORM                                                  20680074
206900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20690074
207000                   ASC-HIGHEST-BLOCK-WRITTEN                      20700074
207100                                                                  20710074
207200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20720074
207300                                   TO PV-BLOCK-NUMBER             20730074
207400                                                                  20740074
207500             PERFORM 4410-READ-TEMP-STORAGE                       20750074
207600                                                                  20760074
207700             PERFORM 2141-CLEAR-SELECTED-INDS                     20770074
207800                 VARYING ASC-ITEM-SUB                             20780074
207900                 FROM 1 BY 1                                      20790074
208000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20800074
208100                                                                  20810074
208200             PERFORM 5100-WRITE-TEMP-STORAGE                      20820074
208300                                                                  20830074
208400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20840074
208500                                                                  20850074
208600         END-PERFORM                                              20860074
208700                                                                  20870074
208800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20880074
208900                                   TO PV-BLOCK-NUMBER             20890074
209000                                                                  20900074
209100         PERFORM 4410-READ-TEMP-STORAGE                           20910074
209200     END-IF.                                                      20920074
209300                                                                  20930074
209400     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS20940074
209500                                      ASC-START-OF-SELECTED-RANGE 20950074
209600                                      ASC-END-OF-SELECTED-RANGE.  20960074
209700                                                                  20970074
209800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20980074
209900                                                                  20990074
210000                                                                  21000074
210100/                                                                 21010074
210200*----------------------------------------------------------------*21020074
210300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *21030074
210400*----------------------------------------------------------------*21040074
210500                                                                  21050074
210600 2141-CLEAR-SELECTED-INDS.                                        21060074
210700                                                                  21070074
210800     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          21080074
210900             NOT EQUAL ZERO                                       21090074
211000         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21100074
211100             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21110074
211200                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    21120074
211300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  21130074
211400                                   TO TRUE                        21140074
211500         END-IF                                                   21150074
211600     END-IF.                                                      21160074
211700                                                                  21170074
211800/                                                                 21180074
211900*----------------------------------------------------------------*21190074
212000*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *21200074
212100*  FOR ALL ITEMS.                                                *21210074
212200*----------------------------------------------------------------*21220074
212300                                                                  21230074
212400 2150-SELECT-ALL-ITEMS.                                           21240074
212500                                                                  21250074
212600     MOVE +1                       TO ASC-BLK-SUB.                21260074
212700                                                                  21270074
212800     PERFORM 2151-SET-SELECTED-INDS                               21280074
212900         VARYING ASC-ITEM-SUB                                     21290074
213000         FROM 1 BY 1                                              21300074
213100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21310074
213200                                                                  21320074
213300     ADD +1                        TO ASC-BLK-SUB.                21330074
213400                                                                  21340074
213500     PERFORM 2151-SET-SELECTED-INDS                               21350074
213600         VARYING ASC-ITEM-SUB                                     21360074
213700         FROM 1 BY 1                                              21370074
213800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21380074
213900                                                                  21390074
214000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21400074
214100                                   TO PV-LIST-ITEM-NUMBER.        21410074
214200                                                                  21420074
214300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21430074
214400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    21440074
214500                                                                  21450074
214600     IF PV-FIRST-BLOCK-IN-ARRAY  = +1                             21460074
214700        MOVE +1                    TO ASC-BLK-SUB                 21470074
214800        PERFORM 5100-WRITE-TEMP-STORAGE                           21480074
214900                                                                  21490074
215000        MOVE +2                    TO ASC-BLK-SUB                 21500074
215100        PERFORM 5100-WRITE-TEMP-STORAGE                           21510074
215200        MOVE +1                    TO ASC-BLK-SUB                 21520074
215300                                      PV-BLOCK-NUMBER             21530074
215400     END-IF.                                                      21540074
215500                                                                  21550074
215600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     21560074
215700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    21570074
215800         MOVE +1                   TO ASC-BLK-SUB                 21580074
215900         PERFORM 5100-WRITE-TEMP-STORAGE                          21590074
216000                                                                  21600074
216100         MOVE +2                   TO ASC-BLK-SUB                 21610074
216200         PERFORM 5100-WRITE-TEMP-STORAGE                          21620074
216300                                                                  21630074
216400         MOVE +1                   TO PV-BLOCK-NUMBER             21640074
216500                                      ASC-BLK-SUB                 21650074
216600                                                                  21660074
216700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21670074
216800             PV-FIRST-BLOCK-IN-ARRAY - 1                          21680074
216900                                                                  21690074
217000         PERFORM                                                  21700074
217100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       21710074
217200                                                                  21720074
217300             PERFORM 4410-READ-TEMP-STORAGE                       21730074
217400                                                                  21740074
217500             PERFORM 2151-SET-SELECTED-INDS                       21750074
217600                 VARYING ASC-ITEM-SUB                             21760074
217700                 FROM 1 BY 1                                      21770074
217800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21780074
217900                                                                  21790074
218000             PERFORM 5100-WRITE-TEMP-STORAGE                      21800074
218100                                                                  21810074
218200             ADD +1                TO PV-BLOCK-NUMBER             21820074
218300         END-PERFORM                                              21830074
218400                                                                  21840074
218500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21850074
218600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21860074
218700                                                                  21870074
218800         PERFORM                                                  21880074
218900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21890074
219000                   ASC-HIGHEST-BLOCK-WRITTEN                      21900074
219100                                                                  21910074
219200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21920074
219300                                   TO PV-BLOCK-NUMBER             21930074
219400                                                                  21940074
219500             PERFORM 4410-READ-TEMP-STORAGE                       21950074
219600                                                                  21960074
219700             PERFORM 2151-SET-SELECTED-INDS                       21970074
219800                 VARYING ASC-ITEM-SUB                             21980074
219900                 FROM 1 BY 1                                      21990074
220000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22000074
220100                                                                  22010074
220200             PERFORM 5100-WRITE-TEMP-STORAGE                      22020074
220300                                                                  22030074
220400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      22040074
220500         END-PERFORM                                              22050074
220600                                                                  22060074
220700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             22070074
220800                                   TO PV-BLOCK-NUMBER             22080074
220900                                                                  22090074
221000         PERFORM 4410-READ-TEMP-STORAGE                           22100074
221100     END-IF.                                                      22110074
221200                                                                  22120074
221300     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             22130074
221400          ASC-NUMBER-OF-SELECTED-ITEMS.                           22140074
221500                                                                  22150074
221600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        22160074
221700                                                                  22170074
221800/                                                                 22180074
221900*----------------------------------------------------------------*22190074
222000*    MARK EACH ITEM AS BEING SELECTED.                           *22200074
222100*----------------------------------------------------------------*22210074
222200                                                                  22220074
222300 2151-SET-SELECTED-INDS.                                          22230074
222400                                                                  22240074
222500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           22250074
222600             NOT EQUAL ZERO                                       22260074
222700         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             22270074
222800             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             22280074
222900                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        22290074
223000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  22300074
223100                                   TO TRUE                        22310074
223200         END-IF                                                   22320074
223300     END-IF.                                                      22330074
223400                                                                  22340074
223500*----------------------------------------------------------------*22350074
223600*    CHECK PACK BY STORE                                         *22360074
223700*----------------------------------------------------------------*22370074
223800 2160-CHECK-PACK-BY-STORE.                                        22380074
223900     PERFORM 4100-PREPARE-CURSOR.                                 22390074
224000                                                                  22400074
224100     EXEC SQL                                                     22410074
224200          SELECT PACK_BY_ST_IND                                   22420074
224300            INTO :PS-PACK-BY-ST-SW                                22430074
224400            FROM TRECEIV                                          22440074
224500           WHERE ORD_NBR         =  :DK-ORD-NBR                   22450074
224600             AND REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              22460074
224700             AND OPER_UNT_ID     =  :DK-OPR-ID                    22470074
224800             AND FCLTY_ID        =  :DK-FACT                      22480074
224900             AND VER_STATUS_CDE  =  'A'                           22490074
225000     END-EXEC.                                                    22500074
225100                                                                  22510074
225200     EVALUATE TRUE                                                22520074
225300         WHEN SQLCODE = ZERO                                      22530074
225400              CONTINUE                                            22540074
225500         WHEN SQLCODE = -904                                      22550074
225600         WHEN SQLCODE = -911                                      22560074
225700         WHEN SQLCODE = -913                                      22570074
225800              PERFORM 9900-SOFT-ABORT                             22580074
225900                                                                  22590074
226000         WHEN OTHER                                               22600074
226100              MOVE '2160-CHECK-PACK-BY-STORE'                     22610074
226200                               TO DP013-PARAGRAPH                 22620074
226300              MOVE 'SELECT TRECEIV'                               22630074
226400                               TO DP013-MESSAGE-TEXT (1)          22640074
226500              MOVE SQLCA       TO DP013-SQLCA                     22650074
226600              PERFORM 9950-FORMAT-ERROR-MSG                       22660074
226700              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        22670074
226800              SET DP013-DB2-ABEND                                 22680074
226900                               TO TRUE                            22690074
227000              PERFORM DP013-0000-PROCESS-ABEND                    22700074
227100     END-EVALUATE.                                                22710074
227200                                                                  22720074
227300                                                                  22730074
227400*************************************************************     22740074
227500* COUNT HOW MANY LINES CAME IN ON AN ASN TO DETERMINE IF    *     22750074
227600* A DELETE OF LINE FROM A PACK CAN BE DONE.                 *     22760074
227700*************************************************************     22770074
227800 2165-DETERMINE-IF-PKSLIP-EXIST.                                  22780074
227900     MOVE +0                      TO PV-PACKSLIP-COUNT.           22790074
228000                                                                  22800074
228100     EXEC SQL                                                     22810074
228200         SELECT COUNT(*)                                          22820074
228300         INTO :PV-PACKSLIP-COUNT                                  22830074
228400         FROM TRECITM A                                           22840074
228500         WHERE     A.ORD_NBR          = :DK-ORD-NBR               22850074
228600               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          22860074
228700               AND A.OPER_UNT_ID      = :DK-OPR-ID                22870074
228800               AND A.FCLTY_ID         = :DK-FACT                  22880074
228900               AND A.ORD_LNE_NBR      = :DK-LINE-NBR              22890074
229000               AND A.PKSL_ITM_QTY     > 0                         22900074
229100               AND A.PREPK_ID         = :DK-PACK-ID               22910074
229200               AND A.PREPK_RATO_QTY   > 0                         22920074
229300     END-EXEC.                                                    22930074
229400                                                                  22940074
229500     EVALUATE TRUE                                                22950074
229600         WHEN SQLCODE = ZERO                                      22960074
229700         WHEN SQLCODE = +100                                      22970074
229800             CONTINUE                                             22980074
229900         WHEN SQLCODE = -904                                      22990074
230000         WHEN SQLCODE = -911                                      23000074
230100         WHEN SQLCODE = -913                                      23010074
230200              PERFORM 9900-SOFT-ABORT                             23020074
230300         WHEN OTHER                                               23030074
230400             MOVE '2165-DETERMINE-IF-PKSLIP-EXIST'                23040074
230500                                 TO DP013-PARAGRAPH               23050074
230600             MOVE 'SELECT COUNT ON RECITM'                        23060074
230700                                 TO DP013-MESSAGE-TEXT (1)        23070074
230800             MOVE SQLCA          TO DP013-SQLCA                   23080074
230900             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      23090074
231000             PERFORM 9950-FORMAT-ERROR-MSG                        23100074
231100             SET DP013-DB2-ABEND                                  23110074
231200                             TO TRUE                              23120074
231300             SET DP013-XCTL-DISPLAY-RESTART                       23130074
231400                             TO TRUE                              23140074
231500             PERFORM DP013-0000-PROCESS-ABEND                     23150074
231600     END-EVALUATE.                                                23160074
231700                                                                  23170074
231800*----------------------------------------------------------------*23180074
231900*    IF THERE ARE NO LINES WITHIN THE PACK, CERTAIN FKEYS WILL   *23190074
232000*    BE INVALID.                                                 *23200074
232100*----------------------------------------------------------------*23210074
232200                                                                  23220074
232300 2170-DETERMINE-IF-PACK.                                          23230074
232400     MOVE +0                      TO PV-PACK-LINE-COUNT.          23240074
232500                                                                  23250074
232600     EXEC SQL                                                     23260074
232700         SELECT COUNT(*)                                          23270074
232800         INTO :PV-PACK-LINE-COUNT                                 23280074
232900         FROM TRECITM A                                           23290074
233000         WHERE     A.ORD_NBR          = :DK-ORD-NBR               23300074
233100               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          23310074
233200               AND A.OPER_UNT_ID      = :DK-OPR-ID                23320074
233300               AND A.FCLTY_ID         = :DK-FACT                  23330074
233400               AND A.ORD_LNE_NBR      > 0                         23340074
233500               AND A.PREPK_ID         = :DK-PACK-ID               23350074
233600               AND A.PREPK_RATO_QTY   > 0                         23360074
233700     END-EXEC.                                                    23370074
233800                                                                  23380074
233900     EVALUATE TRUE                                                23390074
234000         WHEN SQLCODE = ZERO                                      23400074
234100         WHEN SQLCODE = +100                                      23410074
234200             CONTINUE                                             23420074
234300         WHEN SQLCODE = -904                                      23430074
234400         WHEN SQLCODE = -911                                      23440074
234500         WHEN SQLCODE = -913                                      23450074
234600              PERFORM 9900-SOFT-ABORT                             23460074
234700                                                                  23470074
234800         WHEN OTHER                                               23480074
234900             MOVE '2170-DETERMINE-IF-PACK'                        23490074
235000                                 TO DP013-PARAGRAPH               23500074
235100             MOVE 'SELECT ON TRECITM'                             23510074
235200                                 TO DP013-MESSAGE-TEXT (1)        23520074
235300             MOVE SQLCA          TO DP013-SQLCA                   23530074
235400             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      23540074
235500             PERFORM 9950-FORMAT-ERROR-MSG                        23550074
235600             SET DP013-XCTL-DISPLAY-RESTART                       23560074
235700                 DP013-DB2-ABEND                                  23570074
235800                             TO TRUE                              23580074
235900             PERFORM DP013-0000-PROCESS-ABEND                     23590074
236000     END-EVALUATE.                                                23600074
236100                                                                  23610074
236200/                                                                 23620074
236300*----------------------------------------------------------------*23630074
236400*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *23640074
236500*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *23650074
236600*----------------------------------------------------------------*23660074
236700 2200-MOVE-SCREEN-TO-COMMAREA.                                    23670074
236800                                                                  23680074
236900     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             23690074
237000     MOVE +1                       TO PV-SUB.                     23700074
237100                                                                  23710074
237200     PERFORM 3100-SET-SUBSCRIPTS.                                 23720074
237300                                                                  23730074
237400     IF  ASTRTITL > ZERO                                          23740074
237500         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      23750074
237600     ELSE                                                         23760074
237700         IF  ASTRTITF = DP015-ERASE-EOF                           23770074
237800             INITIALIZE ASC-START-ITEM-REQUEST                    23780074
237900         END-IF                                                   23790074
238000     END-IF.                                                      23800074
238100                                                                  23810074
238200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          23820074
238300         VARYING PV-SUB                                           23830074
238400         FROM 1 BY 1                                              23840074
238500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      23850074
238600                                                                  23860074
238700/                                                                 23870074
238800*----------------------------------------------------------------*23880074
238900*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *23890074
239000*----------------------------------------------------------------*23900074
239100 2210-MOVE-LINES-TO-COMMAREA.                                     23910074
239200                                                                  23920074
239300     IF  MR-SELECTL (PV-SUB) > ZERO                               23930074
239400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     23940074
239500                                   TO TRUE                        23950074
239600         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        23960074
239700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      23970074
239800     ELSE                                                         23980074
239900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                23990074
240000             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         24000074
240100             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        24010074
240200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24020074
240300         END-IF                                                   24030074
240400     END-IF.                                                      24040074
240500                                                                  24050074
240600     PERFORM 2215-CHECK-ENTRY-FIELDS.                             24060074
240700                                                                  24070074
240800     ADD +1                        TO ASC-ITEM-SUB.               24080074
240900                                                                  24090074
241000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        24100074
241100         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB) OR                  24110074
241200             DP020-FK-NEXT-PAGE(DP020-SRC-AID) OR                 24120074
241300             DP020-FK-PREV-PAGE(DP020-SRC-AID)                    24130074
241400             COMPUTE PV-BLOCK-NUMBER  =                           24140074
241500                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         24150074
241600                    PC-ITEMS-PER-PANEL                            24160074
241700             PERFORM 5105-REWRITE-ASC-LISTQ                       24170074
241800         END-IF                                                   24180074
241900         ADD +1                    TO ASC-BLK-SUB                 24190074
242000         MOVE +1                   TO ASC-ITEM-SUB                24200074
242100         IF ASC-BLK-SUB  > PC-MAX-BLOCKS-IN-ARRAY                 24210074
242200             MOVE +1                   TO ASC-BLK-SUB             24220074
242300             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           24230074
242400             IF PV-BLOCK-NUMBER = 0                               24240074
242500                COMPUTE PV-BLOCK-NUMBER  =                        24250074
242600                   1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /      24260074
242700                       PC-ITEMS-PER-PANEL                         24270074
242800             END-IF                                               24280074
242900             PERFORM 4410-READ-TEMP-STORAGE                       24290074
243000         END-IF                                                   24300074
243100     ELSE                                                         24310074
243200     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             24320074
243300         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     24330074
243400             COMPUTE PV-BLOCK-NUMBER  =                           24340074
243500                 1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /        24350074
243600                     PC-ITEMS-PER-PANEL                           24360074
243700             PERFORM 5105-REWRITE-ASC-LISTQ                       24370074
243800         END-IF                                                   24380074
243900     END-IF.                                                      24390074
244000                                                                  24400074
244100                                                                  24410074
244200                                                                  24420074
244300******************************************************************24430074
244400* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *24440074
244500* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *24450074
244600******************************************************************24460074
244700 2215-CHECK-ENTRY-FIELDS.                                         24470074
244800                                                                  24480074
244900                                                                  24490074
245000                                                                  24500074
245100     IF  MR-DTL-PACK-RATIOL (PV-SUB) > ZERO                       24510074
245200         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     24520074
245300                                   TO TRUE                        24530074
245400         MOVE MR-DTL-PACK-RATIO (PV-SUB)                          24540074
245500                                   TO ASC-DTL-PACK-RATIO          24550074
245600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24560074
245700         SET ASC-UPDATE-OCCURRED   TO TRUE                        24570074
245800     END-IF.                                                      24580074
245900                                                                  24590074
246000     IF MR-DTL-PACK-UNITSL (PV-SUB)  > ZERO                       24600074
246100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     24610074
246200                                   TO TRUE                        24620074
246300         MOVE MR-DTL-PACK-UNITS-N (PV-SUB)                        24630074
246400                                   TO ASC-DTL-PACK-UNITS          24640074
246500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24650074
246600         SET ASC-UPDATE-OCCURRED   TO TRUE                        24660074
246700     END-IF.                                                      24670074
246800                                                                  24680074
246900                                                                  24690074
247000/                                                                 24700074
247100******************************************************************24710074
247200* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *24720074
247300* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *24730074
247400******************************************************************24740074
247500 2300-GET-NEXT-RECORD.                                            24750074
247600                                                                  24760074
247700     ADD +1                        TO ASC-SEL-SUB.                24770074
247800     IF ASC-SEL-SUB > RC801-MAX-ITEMS                             24780074
247900         ADD +1                    TO ASC-SEL-ITEM                24790074
248000         MOVE +1                   TO ASC-SEL-SUB                 24800074
248100     END-IF.                                                      24810074
248200     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 24820074
248300         PERFORM 9100-READ-SEL-QUEUE                              24830074
248400         IF RC801-ITEM (ASC-SEL-SUB) > ZERO                       24840074
248500             INITIALIZE ASC-LIST-KEYS                             24850074
248600             MOVE RC800-REC-NBR-N        TO ASC-REC-NBR           24860074
248700                                            DK-ORD-NBR            24870074
248800             MOVE RC800-REC-SEQ-NBR-N    TO ASC-REC-SEQ-NBR       24880074
248900                                            DK-RCVR-SEQ-NBR       24890074
249000             MOVE RC800-OPER-UNIT-ID     TO ASC-OPR-ID            24900074
249100                                            DK-OPR-ID             24910074
249200             MOVE RC800-FACILITY-ID      TO ASC-FACT              24920074
249300                                            DK-FACT               24930074
249400             SET RC801-INQ (ASC-SEL-SUB) TO TRUE                  24940074
249500             PERFORM 9200-REWRITE-LIST-QUEUE                      24950074
249600         ELSE                                                     24960074
249700             SUBTRACT +1 FROM ASC-SEL-SUB                         24970074
249800*            --- BOTTOM OF LIST ---                               24980074
249900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            24990074
250000             SET DP020-MSG-INFORMATIONAL                          25000074
250100                                   TO TRUE                        25010074
250200         END-IF                                                   25020074
250300     ELSE                                                         25030074
250400         SUBTRACT +1 FROM ASC-SEL-ITEM                            25040074
250500         MOVE RC801-MAX-ITEMS      TO ASC-SEL-SUB                 25050074
250600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            25060074
250700         SET DP020-MSG-INFORMATIONAL                              25070074
250800                                   TO TRUE                        25080074
250900     END-IF.                                                      25090074
251000                                                                  25100074
251100/                                                                 25110074
251200******************************************************************25120074
251300* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *25130074
251400* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *25140074
251500******************************************************************25150074
251600 2310-GET-PREV-RECORD.                                            25160074
251700                                                                  25170074
251800     SUBTRACT +1 FROM ASC-SEL-SUB.                                25180074
251900     IF ASC-SEL-SUB < +1                                          25190074
252000         SUBTRACT +1 FROM ASC-SEL-ITEM                            25200074
252100         MOVE RC801-MAX-ITEMS      TO ASC-SEL-SUB                 25210074
252200     END-IF.                                                      25220074
252300                                                                  25230074
252400     IF ASC-SEL-ITEM > ZERO                                       25240074
252500         PERFORM 9100-READ-SEL-QUEUE                              25250074
252600         INITIALIZE ASC-LIST-KEYS                                 25260074
252700         MOVE RC800-REC-NBR-N        TO ASC-REC-NBR               25270074
252800         MOVE RC800-REC-SEQ-NBR-N    TO ASC-REC-SEQ-NBR           25280074
252900         MOVE RC800-OPER-UNIT-ID     TO ASC-OPR-ID                25290074
253000                                        DK-OPR-ID                 25300074
253100         MOVE RC800-FACILITY-ID      TO ASC-FACT                  25310074
253200                                        DK-FACT                   25320074
253300     ELSE                                                         25330074
253400         MOVE +1                   TO ASC-SEL-ITEM                25340074
253500                                      ASC-SEL-SUB                 25350074
253600*        --- TOP OF LIST ---                                      25360074
253700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            25370074
253800         SET DP020-MSG-INFORMATIONAL                              25380074
253900                                   TO TRUE                        25390074
254000     END-IF.                                                      25400074
254100                                                                  25410074
254200/                                                                 25420074
254300******************************************************************25430074
254400* GET THE KEYS OF THE NEXT SELECTED PACKSLIP OBJECT FROM THE     *25440074
254500* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *25450074
254600******************************************************************25460074
254700 2400-GET-NEXT-PKSL-RECORD.                                       25470074
254800                                                                  25480074
254900     ADD +1                        TO ASC-SEL-SUB.                25490074
255000     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             25500074
255100         ADD +1                    TO ASC-SEL-ITEM                25510074
255200         MOVE +1                   TO ASC-SEL-SUB                 25520074
255300     END-IF.                                                      25530074
255400     IF  RC800-REC-NBR-N     = ZEROES                             25540074
255500         MOVE PC-TSYMSG-00736  TO DP020-MSG-NUMBER                25550074
255600         SET PS-ERROR                                             25560074
255700             PS-COMMAREA-NOT-VALID                                25570074
255800             DP020-NEXT-ACT-APPL-ERROR                            25580074
255900             DP020-MSG-FATAL   TO TRUE                            25590074
256000     END-IF                                                       25600074
256100     IF  RC800-REC-SEQ-NBR-N = ZEROES                             25610074
256200         MOVE PC-TSYMSG-00737  TO DP020-MSG-NUMBER                25620074
256300         SET PS-ERROR                                             25630074
256400             PS-COMMAREA-NOT-VALID                                25640074
256500             DP020-NEXT-ACT-APPL-ERROR                            25650074
256600             DP020-MSG-FATAL   TO TRUE                            25660074
256700     END-IF                                                       25670074
256800     IF  RC800-OPER-UNIT-ID = ZEROES                              25680074
256900     AND RC800-FACILITY-ID    = ZEROES                            25690074
257000         MOVE PC-TSYMSG-00815  TO DP020-MSG-NUMBER                25700074
257100         SET PS-ERROR                                             25710074
257200             DP020-MSG-FATAL                                      25720074
257300             PS-COMMAREA-NOT-VALID                                25730074
257400             DP020-NEXT-ACT-APPL-ERROR                            25740074
257500                               TO TRUE                            25750074
257600     END-IF                                                       25760074
257700     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 25770074
257800     AND PS-NO-ERROR                                              25780074
257900         PERFORM 9300-READ-PKSL-SEL-QUEUE                         25790074
258000         IF RC800-REC-NBR-N     > ZERO                            25800074
258100             INITIALIZE ASC-LIST-KEYS                             25810074
258200             MOVE RC800-REC-NBR-N     TO ASC-REC-NBR              25820074
258300                                         DK-ORD-NBR               25830074
258400             MOVE RC800-REC-SEQ-NBR-N TO ASC-REC-SEQ-NBR          25840074
258500                                         DK-RCVR-SEQ-NBR          25850074
258600             MOVE RC800-OPER-UNIT-ID  TO ASC-OPR-ID               25860074
258700                                         DK-OPR-ID                25870074
258800             MOVE RC800-FACILITY-ID   TO ASC-FACT                 25880074
258900                                         DK-FACT                  25890074
259000             IF RC801-TRBL-NOTIF-NBR (ASC-SEL-SUB) > 0            25900074
259100                MOVE RC801-TRBL-NOTIF-NBR (ASC-SEL-SUB)           25910074
259200                                       TO ASC-NOTIF-NBR           25920074
259300             ELSE                                                 25930074
259400                MOVE +0                TO ASC-NOTIF-NBR           25940074
259500             END-IF                                               25950074
259600                                                                  25960074
259700             EVALUATE DP020-INT-APPL-FORMAT-IND                   25970074
259800                                                                  25980074
259900             WHEN PC-INTER-APPL-PACK-UPD                          25990074
260000                MOVE RC800-PACK-ID    TO ASC-PACK-ID              26000074
260100                                         DK-PACK-ID               26010074
260200             WHEN OTHER                                           26020074
260300                IF RC801-PACK-ID (ASC-SEL-SUB) > 0                26030074
260400                   MOVE RC801-PACK-ID (ASC-SEL-SUB)               26040074
260500                                      TO ASC-PACK-ID              26050074
260600                                         DK-PACK-ID               26060074
260700                ELSE                                              26070074
260800                IF RC800-PACK-ID  > 0                             26080074
260900                   MOVE RC800-PACK-ID    TO ASC-PACK-ID           26090074
261000                                            DK-PACK-ID            26100074
261100                ELSE                                              26110074
261200                   MOVE PC-CURRENT-PROGRAM-ERROR                  26120074
261300                                         TO DP020-MSG-TEXT        26130074
261400                   MOVE PC-TSYMSG-02229  TO DP020-MSG-NUMBER      26140074
261500                   SET PS-ERROR                                   26150074
261600                       DP020-MSG-FATAL                            26160074
261700                       PS-COMMAREA-NOT-VALID                      26170074
261800                       DP020-NEXT-ACT-APPL-ERROR                  26180074
261900                                         TO TRUE                  26190074
262000                 END-IF                                           26200074
262100                END-IF                                            26210074
262200             END-EVALUATE                                         26220074
262300                                                                  26230074
262400             SET RC801-INQ (ASC-SEL-SUB)                          26240074
262500                                      TO TRUE                     26250074
262600             PERFORM 9400-REWRITE-PKSL-LIST-QUEUE                 26260074
262700         ELSE                                                     26270074
262800             SUBTRACT +1 FROM ASC-SEL-SUB                         26280074
262900*            --- BOTTOM OF LIST ---                               26290074
263000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            26300074
263100             SET DP020-MSG-INFORMATIONAL                          26310074
263200                                   TO TRUE                        26320074
263300         END-IF                                                   26330074
263400     ELSE                                                         26340074
263500         SUBTRACT +1 FROM ASC-SEL-ITEM                            26350074
263600         MOVE RC801-MAX-ITEMS      TO ASC-SEL-SUB                 26360074
263700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            26370074
263800         SET DP020-MSG-INFORMATIONAL                              26380074
263900                                   TO TRUE                        26390074
264000     END-IF.                                                      26400074
264100                                                                  26410074
264200/                                                                 26420074
264300******************************************************************26430074
264400* GET THE KEYS OF THE PREVIOUS SELECTED PACK SLIP OBJECT FROM THE*26440074
264500* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *26450074
264600******************************************************************26460074
264700 2410-GET-PREV-PKSL-RECORD.                                       26470074
264800                                                                  26480074
264900     SUBTRACT +1 FROM ASC-SEL-SUB.                                26490074
265000     IF ASC-SEL-SUB < +1                                          26500074
265100         SUBTRACT +1 FROM ASC-SEL-ITEM                            26510074
265200         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 26520074
265300     END-IF.                                                      26530074
265400                                                                  26540074
265500     IF ASC-SEL-ITEM > ZERO                                       26550074
265600         PERFORM 9300-READ-PKSL-SEL-QUEUE                         26560074
265700         INITIALIZE ASC-LIST-KEYS                                 26570074
265800         MOVE RC015-PO-NBR                     TO ASC-REC-NBR     26580074
265900         MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO                 26590074
266000              ASC-REC-SEQ-NBR                                     26600074
266100         MOVE RC015-OPER-UNT-ID                TO ASC-OPR-ID      26610074
266200                                                  DK-OPR-ID       26620074
266300         MOVE RC015-FCLTY-ID                   TO ASC-FACT        26630074
266400                                                  DK-FACT         26640074
266500     ELSE                                                         26650074
266600         MOVE +1                   TO ASC-SEL-ITEM                26660074
266700                                      ASC-SEL-SUB                 26670074
266800*        --- TOP OF LIST ---                                      26680074
266900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            26690074
267000         SET DP020-MSG-INFORMATIONAL                              26700074
267100                                   TO TRUE                        26710074
267200     END-IF.                                                      26720074
267300                                                                  26730074
267400/                                                                 26740074
267500*----------------------------------------------------------------*26750074
267600*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *26760074
267700*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *26770074
267800*----------------------------------------------------------------*26780074
267900 3000-EDIT-DATA-IN-COMMAREA.                                      26790074
268000                                                                  26800074
268100     SET PS-NO-ERROR               TO TRUE.                       26810074
268200                                                                  26820074
268300     PERFORM 3200-RESET-ATTRIBUTES.                               26830074
268400                                                                  26840074
268500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     26850074
268600**                                                                26860074
268700* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              26870074
268800* EDITTING IS DONE FROM THE BOTTOM UP.                            26880074
268900**                                                                26890074
269000     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       26900074
269100         ASC-ITEMS-DISPLAYED - 1.                                 26910074
269200                                                                  26920074
269300     PERFORM 3100-SET-SUBSCRIPTS.                                 26930074
269400                                                                  26940074
269500     PERFORM 3300-EDIT-SELECTIONS                                 26950074
269600         VARYING PV-SUB                                           26960074
269700         FROM PV-SUB BY -1                                        26970074
269800         UNTIL PV-SUB < +1.                                       26980074
269900                                                                  26990074
270000     IF PS-NO-ERROR                                               27000074
270100        PERFORM 3005-EDIT-COMMAREA-BLOCKS.                        27010074
270200                                                                  27020074
270300                                                                  27030074
270400     IF  PS-NO-ERROR                                              27040074
270500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        27050074
270600     END-IF.                                                      27060074
270700                                                                  27070074
270800     IF  ((PS-NO-ERROR)                                           27080074
270900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   27090074
271000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    27100074
271100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  27110074
271200     END-IF.                                                      27120074
271300                                                                  27130074
271400/                                                                 27140074
271500                                                                  27150074
271600*----------------------------------------------------------------*27160074
271700*   3005-EDIT-COMMAREA-BLOCKS                                    *27170074
271800*----------------------------------------------------------------*27180074
271900 3005-EDIT-COMMAREA-BLOCKS.                                       27190074
272000     MOVE +1                       TO PV-BLOCK-NUMBER.            27200074
272100     MOVE +1                       TO ASC-BLK-SUB.                27210074
272200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               27220074
272300                                                                  27230074
272400     COMPUTE PV-BLOCK-NUMBER  =                                   27240074
272500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 27250074
272600            PC-ITEMS-PER-PANEL.                                   27260074
272700                                                                  27270074
272800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          27280074
272900                                                                  27290074
273000     EVALUATE TRUE                                                27300074
273100         WHEN PS-EDIT-BEFORE-MOVE                                 27310074
273200                                                                  27320074
273300              COMPUTE PV-ITEMS-HOLD  =                            27330074
273400                  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +           27340074
273500                  PC-ITEMS-PER-PANEL - 1                          27350074
273600                                                                  27360074
273700              IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ      27370074
273800                  SUBTRACT  ASC-NUMBER-OF-ITEMS-READ              27380074
273900                      FROM  PV-ITEMS-HOLD                         27390074
274000                    GIVING  PV-ITEMS-DIFF                         27400074
274100                  SUBTRACT  PV-ITEMS-DIFF                         27410074
274200                      FROM  PC-ITEMS-PER-PANEL                    27420074
274300                    GIVING  PV-ITEMS-HOLD                         27430074
274400                  MOVE  PV-ITEMS-HOLD  TO  PV-SUB                 27440074
274500                                           ASC-ITEM-SUB           27450074
274600                                           ASC-ITEMS-DISPLAYED    27460074
274700              ELSE                                                27470074
274800                  MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB             27480074
274900                  MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB       27490074
275000              END-IF                                              27500074
275100              PERFORM 3300-EDIT-SELECTIONS                        27510074
275200                  VARYING PV-SUB                                  27520074
275300                     FROM PV-SUB BY -1                            27530074
275400                    UNTIL PV-SUB < +1                             27540074
275500                                                                  27550074
275600              MOVE +1               TO ASC-BLK-SUB                27560074
275700              PERFORM 5105-REWRITE-ASC-LISTQ                      27570074
275800                                                                  27580074
275900                                                                  27590074
276000         WHEN OTHER                                               27600074
276100             PERFORM                                              27610074
276200               UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN  27620074
276300                  OR PS-ERROR                                     27630074
276400                  OR PS-BLOCK-ERROR                               27640074
276500                                                                  27650074
276600                     COMPUTE PV-ITEMS-HOLD  =                     27660074
276700                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        27670074
276800                     PC-ITEMS-PER-PANEL - 1                       27680074
276900                                                                  27690074
277000                 IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ   27700074
277100                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           27710074
277200                         FROM  PV-ITEMS-HOLD                      27720074
277300                       GIVING  PV-ITEMS-DIFF                      27730074
277400                     SUBTRACT  PV-ITEMS-DIFF                      27740074
277500                         FROM  PC-ITEMS-PER-PANEL                 27750074
277600                       GIVING  PV-ITEMS-HOLD                      27760074
277700                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              27770074
277800                                              ASC-ITEM-SUB        27780074
277900                                              ASC-ITEMS-DISPLAYED 27790074
278000                 ELSE                                             27800074
278100                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          27810074
278200                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    27820074
278300                 END-IF                                           27830074
278400                 PERFORM 3300-EDIT-SELECTIONS                     27840074
278500                     VARYING PV-SUB                               27850074
278600                        FROM PV-SUB BY -1                         27860074
278700                       UNTIL PV-SUB < +1                          27870074
278800                                                                  27880074
278900                 MOVE +1               TO ASC-BLK-SUB             27890074
279000                                                                  27900074
279100                 PERFORM 5105-REWRITE-ASC-LISTQ                   27910074
279200                                                                  27920074
279300                 MOVE +1                TO ASC-BLK-SUB            27930074
279400                                                                  27940074
279500                 IF  PS-BLOCK-ERROR                               27950074
279600                     SET  PS-ERROR     TO TRUE                    27960074
279700                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    27970074
279800                                       TO PV-TOP-ITEM             27980074
279900                 ELSE                                             27990074
280000                     ADD  +1            TO PV-BLOCK-NUMBER        28000074
280100                     IF  PV-BLOCK-NUMBER >                        28010074
280200                         ASC-HIGHEST-BLOCK-WRITTEN                28020074
280300                         MOVE +2        TO ASC-BLK-SUB            28030074
280400                         PERFORM 4410-READ-TEMP-STORAGE           28040074
280500                         MOVE +1        TO ASC-BLK-SUB            28050074
280600                     ELSE                                         28060074
280700                         PERFORM 4410-READ-TEMP-STORAGE           28070074
280800                         ADD  +1        TO PV-BLOCK-NUMBER        28080074
280900                         MOVE +2        TO ASC-BLK-SUB            28090074
281000                         PERFORM 4410-READ-TEMP-STORAGE           28100074
281100                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        28110074
281200                         MOVE +1        TO ASC-BLK-SUB            28120074
281300                     END-IF                                       28130074
281400                 END-IF                                           28140074
281500             END-PERFORM                                          28150074
281600                                                                  28160074
281700             IF  PV-ORIGINAL-BLOCK  = +1    OR                    28170074
281800                 PS-ERROR                   OR                    28180074
281900                 PS-BLOCK-ERROR                                   28190074
282000                 CONTINUE                                         28200074
282100             ELSE                                                 28210074
282200                 MOVE +1                 TO PV-BLOCK-NUMBER       28220074
282300                 MOVE +1                 TO ASC-BLK-SUB           28230074
282400                 MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB          28240074
282500                 MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED   28250074
282600                 PERFORM 4410-READ-TEMP-STORAGE                   28260074
282700                                                                  28270074
282800                 PERFORM                                          28280074
282900                     UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK    28290074
283000                        OR PS-ERROR                               28300074
283100                        OR PS-BLOCK-ERROR                         28310074
283200                                                                  28320074
283300                     COMPUTE PV-ITEMS-HOLD  =                     28330074
283400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    28340074
283500                         PC-ITEMS-PER-PANEL - 1                   28350074
283600                                                                  28360074
283700                     IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ 28370074
283800                         SUBTRACT  ASC-NUMBER-OF-ITEMS-READ       28380074
283900                            FROM  PV-ITEMS-HOLD                   28390074
284000                           GIVING  PV-ITEMS-DIFF                  28400074
284100                         SUBTRACT  PV-ITEMS-DIFF                  28410074
284200                             FROM  PC-ITEMS-PER-PANEL             28420074
284300                           GIVING  PV-ITEMS-HOLD                  28430074
284400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            28440074
284500                                                 ASC-ITEM-SUB     28450074
284600                                               ASC-ITEMS-DISPLAYED28460074
284700                     ELSE                                         28470074
284800                         MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB      28480074
284900                         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB28490074
285000                     END-IF                                       28500074
285100                     PERFORM 3300-EDIT-SELECTIONS                 28510074
285200                         VARYING PV-SUB                           28520074
285300                            FROM PV-SUB BY -1                     28530074
285400                           UNTIL PV-SUB < +1                      28540074
285500                                                                  28550074
285600                     MOVE +1               TO ASC-BLK-SUB         28560074
285700                                                                  28570074
285800                     PERFORM 5105-REWRITE-ASC-LISTQ               28580074
285900                                                                  28590074
286000                     MOVE +1                TO ASC-BLK-SUB        28600074
286100                                                                  28610074
286200                     IF  PS-BLOCK-ERROR                           28620074
286300                         SET  PS-ERROR     TO TRUE                28630074
286400                         MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)28640074
286500                                           TO PV-TOP-ITEM         28650074
286600                     ELSE                                         28660074
286700                         ADD  +1            TO PV-BLOCK-NUMBER    28670074
286800                         IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK  28680074
286900                             MOVE +2        TO ASC-BLK-SUB        28690074
287000                             PERFORM 4410-READ-TEMP-STORAGE       28700074
287100                             MOVE +1        TO ASC-BLK-SUB        28710074
287200                         ELSE                                     28720074
287300                             PERFORM 4410-READ-TEMP-STORAGE       28730074
287400                             ADD  +1        TO PV-BLOCK-NUMBER    28740074
287500                             MOVE +2        TO ASC-BLK-SUB        28750074
287600                             PERFORM 4410-READ-TEMP-STORAGE       28760074
287700                             SUBTRACT +1  FROM PV-BLOCK-NUMBER    28770074
287800                             MOVE +1        TO ASC-BLK-SUB        28780074
287900                         END-IF                                   28790074
288000                     END-IF                                       28800074
288100                 END-PERFORM                                      28810074
288200             END-IF                                               28820074
288300     END-EVALUATE.                                                28830074
288400                                                                  28840074
288500                                                                  28850074
288600                                                                  28860074
288700*----------------------------------------------------------------*28870074
288800*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *28880074
288900*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*28890074
289000*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *28900074
289100*                                                                *28910074
289200*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *28920074
289300*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *28930074
289400*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *28940074
289500*    US IN THE 2ND BLOCK OF THE ARRAY.                           *28950074
289600*----------------------------------------------------------------*28960074
289700                                                                  28970074
289800 3100-SET-SUBSCRIPTS.                                             28980074
289900                                                                  28990074
290000     COMPUTE ASC-ITEM-SUB =                                       29000074
290100         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        29010074
290200                                                                  29020074
290300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         29030074
290400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            29040074
290500         MOVE PC-MAX-BLOCKS-IN-ARRAY                              29050074
290600                                   TO ASC-BLK-SUB                 29060074
290700     ELSE                                                         29070074
290800         MOVE +1                   TO ASC-BLK-SUB                 29080074
290900     END-IF.                                                      29090074
291000                                                                  29100074
291100*----------------------------------------------------------------*29110074
291200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *29120074
291300*----------------------------------------------------------------*29130074
291400                                                                  29140074
291500 3200-RESET-ATTRIBUTES.                                           29150074
291600                                                                  29160074
291700     MOVE DP015-UNP-NUM-NOR-OFF     TO ASTRTITA.                  29170074
291800     MOVE DP015-GREEN               TO ASTRTITC.                  29180074
291900     MOVE DP015-UNDERLINE           TO ASTRTITH.                  29190074
292000                                                                  29200074
292100     PERFORM                                                      29210074
292200         VARYING PV-SUB                                           29220074
292300         FROM 1 BY 1                                              29230074
292400         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        29240074
292500         MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)        29250074
292600         MOVE DP015-GREEN           TO MR-SELECTC (PV-SUB)        29260074
292700         MOVE DP015-UNDERLINE       TO MR-SELECTH (PV-SUB)        29270074
292800                                                                  29280074
292900         MOVE DP015-UNP-NUM-NOR-OFF TO                            29290074
293000                                  MR-DTL-PACK-RATIOA (PV-SUB)     29300074
293100         MOVE DP015-GREEN           TO                            29310074
293200                                  MR-DTL-PACK-RATIOC (PV-SUB)     29320074
293300         MOVE DP015-UNDERLINE       TO                            29330074
293400                                  MR-DTL-PACK-RATIOH (PV-SUB)     29340074
293500                                                                  29350074
293600         MOVE DP015-UNP-NUM-NOR-OFF TO                            29360074
293700                                  MR-DTL-PACK-UNITSA (PV-SUB)     29370074
293800         MOVE DP015-GREEN           TO                            29380074
293900                                 MR-DTL-PACK-UNITSC (PV-SUB)      29390074
294000         MOVE DP015-UNDERLINE       TO                            29400074
294100                                 MR-DTL-PACK-UNITSH (PV-SUB)      29410074
294200     END-PERFORM.                                                 29420074
294300                                                                  29430074
294400/                                                                 29440074
294500*----------------------------------------------------------------*29450074
294600*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *29460074
294700*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *29470074
294800*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *29480074
294900*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *29490074
295000*----------------------------------------------------------------*29500074
295100 3300-EDIT-SELECTIONS.                                            29510074
295200                                                                  29520074
295300     EVALUATE TRUE                                                29530074
295400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     29540074
295500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         29550074
295600                 CONTINUE                                         29560074
295700                                                                  29570074
295800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     29580074
295900              = SPACES AND                                        29590074
296000               ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         29600074
296100              = SPACES                                            29610074
296200                 CONTINUE                                         29620074
296300                                                                  29630074
296400         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         29640074
296500             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        29650074
296600                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS29660074
296700                 MOVE ASC-TEMP-SELECTED-SW                        29670074
296800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   29680074
296900                                   TO ASC-SELECTED-SW             29690074
297000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   29700074
297100             END-IF                                               29710074
297200                                                                  29720074
297300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     29730074
297400                 = SPACE                                          29740074
297500             EVALUATE TRUE                                        29750074
297600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       29760074
297700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS29770074
297800                     MOVE SPACE    TO ASC-SELECTED-SW             29780074
297900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   29790074
298000                                                                  29800074
298100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        29810074
298200                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 29820074
298300                     MOVE SPACE    TO ASC-SELECTED-SW             29830074
298400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   29840074
298500                                                                  29850074
298600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          29860074
298700                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   29870074
298800                     MOVE SPACE    TO ASC-SELECTED-SW             29880074
298900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   29890074
299000             END-EVALUATE                                         29900074
299100                                                                  29910074
299200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           29920074
299300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            29930074
299400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    29940074
299500             END-IF                                               29950074
299600             PERFORM 3310-EDIT-RANGE                              29960074
299700                                                                  29970074
299800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             29980074
299900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            29990074
300000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    30000074
300100             END-IF                                               30010074
300200             PERFORM 3310-EDIT-RANGE                              30020074
300300                                                                  30030074
300400         WHEN OTHER                                               30040074
300500             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            30050074
300600             SET DP020-MSG-FATAL   TO TRUE                        30060074
300700             MOVE -1               TO MR-SELECTL (PV-SUB)         30070074
300800             SET DP030-SET-CURSOR-APPL-1                          30080074
300900                                   TO TRUE                        30090074
301000             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         30100074
301100             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         30110074
301200             SET PS-ERROR          TO TRUE                        30120074
301300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            30130074
301400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     30140074
301500                 MOVE SPACE        TO ASC-SELECTED-SW             30150074
301600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   30160074
301700             END-IF                                               30170074
301800     END-EVALUATE.                                                30180074
301900                                                                  30190074
302000     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             30200074
302100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               30210074
302200                                                                  30220074
302300     IF  ASC-ITEM-SUB < 1                                         30230074
302400         SUBTRACT +1 FROM ASC-BLK-SUB                             30240074
302500         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                30250074
302600     END-IF.                                                      30260074
302700                                                                  30270074
302800*----------------------------------------------------------------*30280074
302900*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *30290074
303000*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *30300074
303100*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *30310074
303200*  THE ENDING.                                                   *30320074
303300*----------------------------------------------------------------*30330074
303400 3310-EDIT-RANGE.                                                 30340074
303500                                                                  30350074
303600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                30360074
303700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   30370074
303800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)30380074
303900                                   TO ASC-SELECTED-SW             30390074
304000                                        (ASC-BLK-SUB ASC-ITEM-SUB)30400074
304100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 30410074
304200         ELSE                                                     30420074
304300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     30430074
304400                 CONTINUE                                         30440074
304500             ELSE                                                 30450074
304600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        30460074
304700                 MOVE PC-TSYMSG-00054                             30470074
304800                                   TO DP020-MSG-NUMBER            30480074
304900                 SET DP020-MSG-FATAL                              30490074
305000                                   TO TRUE                        30500074
305100                 MOVE -1           TO MR-SELECTL (PV-SUB)         30510074
305200                 SET DP030-SET-CURSOR-APPL-1                      30520074
305300                                   TO TRUE                        30530074
305400                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         30540074
305500                 MOVE DP015-UNDERLINE                             30550074
305600                                   TO MR-SELECTH (PV-SUB)         30560074
305700                 SET PS-ERROR      TO TRUE                        30570074
305800             END-IF                                               30580074
305900         END-IF                                                   30590074
306000     ELSE                                                         30600074
306100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     30610074
306200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 30620074
306300                                   TO ASC-SELECTED-SW             30630074
306400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   30640074
306500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   30650074
306600         ELSE                                                     30660074
306700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       30670074
306800                 CONTINUE                                         30680074
306900             ELSE                                                 30690074
307000*                -- ONLY ONE END-OF-RANGE ALLOWED --              30700074
307100                 MOVE PC-TSYMSG-00055                             30710074
307200                                   TO DP020-MSG-NUMBER            30720074
307300                 SET DP020-MSG-FATAL                              30730074
307400                                   TO TRUE                        30740074
307500                 MOVE -1           TO MR-SELECTL (PV-SUB)         30750074
307600                 SET DP030-SET-CURSOR-APPL-1                      30760074
307700                                   TO TRUE                        30770074
307800                 SET PS-ERROR      TO TRUE                        30780074
307900             END-IF                                               30790074
308000         END-IF                                                   30800074
308100     END-IF.                                                      30810074
308200                                                                  30820074
308300*----------------------------------------------------------------*30830074
308400*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *30840074
308500*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *30850074
308600*----------------------------------------------------------------*30860074
308700 3400-CHECK-RANGE-SEQUENCE.                                       30870074
308800                                                                  30880074
308900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       30890074
309000       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      30900074
309100       AND  ASC-START-OF-SELECTED-RANGE >                         30910074
309200                                         ASC-END-OF-SELECTED-RANGE30920074
309300*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                30930074
309400         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            30940074
309500         SET DP020-MSG-FATAL       TO TRUE                        30950074
309600         SET PS-ERROR              TO TRUE                        30960074
309700         PERFORM 3410-POSITION-AT-ERROR                           30970074
309800     END-IF.                                                      30980074
309900                                                                  30990074
310000*----------------------------------------------------------------*31000074
310100*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *31010074
310200*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *31020074
310300*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *31030074
310400*----------------------------------------------------------------*31040074
310500 3410-POSITION-AT-ERROR.                                          31050074
310600                                                                  31060074
310700     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       31070074
310800                                                                  31080074
310900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 31090074
311000                    - PV-TOP-ITEM + 1.                            31100074
311100                                                                  31110074
311200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      31120074
311300         CONTINUE                                                 31130074
311400     ELSE                                                         31140074
311500        IF ASC-UPDATE-PENDING                                     31150074
311600         MOVE -1                   TO MR-DTL-PACK-RATIOL (PV-SUB) 31160074
311700         MOVE DP015-REVERSE        TO MR-DTL-PACK-RATIOH (PV-SUB) 31170074
311800         MOVE DP015-RED            TO MR-DTL-PACK-RATIOC (PV-SUB) 31180074
311900        ELSE                                                      31190074
312000         MOVE -1                   TO MR-SELECTL (PV-SUB)         31200074
312100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         31210074
312200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         31220074
312300     END-IF.                                                      31230074
312400                                                                  31240074
312500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   31250074
312600                    - PV-TOP-ITEM + 1.                            31260074
312700                                                                  31270074
312800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      31280074
312900         CONTINUE                                                 31290074
313000     ELSE                                                         31300074
313100         MOVE -1                   TO MR-SELECTL (PV-SUB)         31310074
313200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         31320074
313300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         31330074
313400     END-IF.                                                      31340074
313500                                                                  31350074
313600/                                                                 31360074
313700*----------------------------------------------------------------*31370074
313800*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *31380074
313900*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *31390074
314000*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *31400074
314100*----------------------------------------------------------------*31410074
314200                                                                  31420074
314300 3500-MARK-RANGE-AS-SELECTED.                                     31430074
314400                                                                  31440074
314500     MOVE +1                       TO ASC-BLK-SUB.                31450074
314600                                                                  31460074
314700     PERFORM 3510-MARK-SELECTED-INDS                              31470074
314800         VARYING ASC-ITEM-SUB                                     31480074
314900         FROM 1 BY 1                                              31490074
315000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 31500074
315100                                                                  31510074
315200     ADD +1                        TO ASC-BLK-SUB.                31520074
315300                                                                  31530074
315400     PERFORM 3510-MARK-SELECTED-INDS                              31540074
315500         VARYING ASC-ITEM-SUB                                     31550074
315600         FROM 1 BY 1                                              31560074
315700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 31570074
315800                                                                  31580074
315900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               31590074
316000                                   TO PV-LIST-ITEM-NUMBER.        31600074
316100                                                                  31610074
316200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            31620074
316300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         31630074
316400               PC-ITEMS-PER-PANEL).                               31640074
316500                                                                  31650074
316600     MOVE ASC-START-OF-SELECTED-RANGE                             31660074
316700                                   TO PV-START-OF-SELECTED-RANGE. 31670074
316800                                                                  31680074
316900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            31690074
317000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  31700074
317100               PC-ITEMS-PER-PANEL).                               31710074
317200                                                                  31720074
317300     MOVE ASC-END-OF-SELECTED-RANGE                               31730074
317400                                   TO PV-END-OF-SELECTED-RANGE.   31740074
317500                                                                  31750074
317600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             31760074
317700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    31770074
317800               PC-ITEMS-PER-PANEL).                               31780074
317900                                                                  31790074
318000     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             31800074
318100         PV-FIRST-BLOCK-IN-ARRAY + 1.                             31810074
318200                                                                  31820074
318300     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    31830074
318400        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        31840074
318500         MOVE +1                   TO ASC-BLK-SUB                 31850074
318600         PERFORM 5100-WRITE-TEMP-STORAGE                          31860074
318700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         31870074
318800             PV-FIRST-BLOCK-IN-ARRAY - 1                          31880074
318900                                                                  31890074
319000         PERFORM                                                  31900074
319100             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      31910074
319200                   PV-PREV-BLOCK-IN-ARRAY                         31920074
319300             MOVE PV-FIRST-BLOCK-IN-RANGE                         31930074
319400                                   TO PV-BLOCK-NUMBER             31940074
319500             PERFORM 4410-READ-TEMP-STORAGE                       31950074
319600             PERFORM 3510-MARK-SELECTED-INDS                      31960074
319700                 VARYING ASC-ITEM-SUB                             31970074
319800                 FROM 1 BY 1                                      31980074
319900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          31990074
320000             PERFORM 5100-WRITE-TEMP-STORAGE                      32000074
320100             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     32010074
320200         END-PERFORM                                              32020074
320300                                                                  32030074
320400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         32040074
320500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     32050074
320600         PERFORM                                                  32060074
320700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       32070074
320800                   PV-LAST-BLOCK-IN-RANGE                         32080074
320900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          32090074
321000                                   TO PV-BLOCK-NUMBER             32100074
321100             PERFORM 4410-READ-TEMP-STORAGE                       32110074
321200             PERFORM 3510-MARK-SELECTED-INDS                      32120074
321300                 VARYING ASC-ITEM-SUB                             32130074
321400                 FROM 1 BY 1                                      32140074
321500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          32150074
321600             PERFORM 5100-WRITE-TEMP-STORAGE                      32160074
321700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      32170074
321800         END-PERFORM                                              32180074
321900                                                                  32190074
322000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             32200074
322100                                   TO PV-BLOCK-NUMBER             32210074
322200         PERFORM 4410-READ-TEMP-STORAGE                           32220074
322300     END-IF.                                                      32230074
322400                                                                  32240074
322500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 32250074
322600                                      ASC-END-OF-SELECTED-RANGE.  32260074
322700                                                                  32270074
322800/                                                                 32280074
322900*----------------------------------------------------------------*32290074
323000* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *32300074
323100*----------------------------------------------------------------*32310074
323200                                                                  32320074
323300 3510-MARK-SELECTED-INDS.                                         32330074
323400                                                                  32340074
323500     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         32350074
323600         ASC-START-OF-SELECTED-RANGE)                             32360074
323700     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         32370074
323800         ASC-START-OF-SELECTED-RANGE)                             32380074
323900                                                                  32390074
324000         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     32400074
324100             ASC-END-OF-SELECTED-RANGE)                           32410074
324200         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     32420074
324300             ASC-END-OF-SELECTED-RANGE)                           32430074
324400                                                                  32440074
324500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          32450074
324600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   32460074
324700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   32470074
324800                                   TO TRUE                        32480074
324900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              32490074
325000                                   TO TRUE                        32500074
325100                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS32510074
325200             END-IF                                               32520074
325300         END-IF                                                   32530074
325400     END-IF.                                                      32540074
325500/                                                                 32550074
325600 3600-CHECK-WMS.                                                  32560080
325700     PERFORM 3601-CHECK-TKRPRPM-ASNDWN.                           32570087
325800     IF PS-ASNS-TO-WMS-YES                                        32580080
325900        PERFORM 3602-GET-TRIP                                     32590087
326000        PERFORM 3603-GET-SHPMT-XREF                               32600087
326100     ELSE                                                         32610080
326200        SET PS-RECEIVING-BEGUN-NO TO TRUE                         32620089
326300     END-IF.                                                      32630080
326400                                                                  32640080
326500 3601-CHECK-TKRPRPM-ASNDWN.                                       32650080
326600                                                                  32660080
326700     MOVE ASC-OPR-ID TO KRPRPM-LOC-ID.                            32670080
326800                                                                  32680080
326900     EXEC SQL                                                     32690080
327000          SELECT   FUNC_TXT                                       32700080
327100            INTO  :KRPRPM-FUNC-TXT                                32710080
327200            FROM                                                  32720080
327300                  TKRPRPM A                                       32730080
327400            WHERE                                                 32740080
327500                  LOC_ID            = :KRPRPM-LOC-ID              32750080
327600              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    32760080
327700              AND FUNC_PRC_STAT_CDE = 'AC'                        32770080
327800              AND INTFC_SYS_CDE     = 'KHL'                       32780080
327900              AND FUNC_TXT          = 'Y'                         32790080
328000              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            32800080
328100     END-EXEC.                                                    32810080
328200     EVALUATE TRUE                                                32820080
328300         WHEN SQLCODE = ZERO                                      32830080
328400              SET PS-ASNS-TO-WMS-YES    TO TRUE                   32840080
328500         WHEN SQLCODE = +100                                      32850080
328600              SET PS-ASNS-TO-WMS-NO  TO TRUE                      32860080
328700         WHEN SQLWARN0 NOT = SPACES                               32870080
328800         WHEN SQLCODE  NOT = ZERO                                 32880080
328900             MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)      32890080
329000             SET DP013-DB2-ABEND                                  32900080
329100                                 TO TRUE                          32910080
329200             SET DP013-XCTL-DISPLAY-RESTART                       32920080
329300                                 TO TRUE                          32930080
329400             PERFORM DP013-0000-PROCESS-ABEND                     32940080
329500     END-EVALUATE.                                                32950080
329600                                                                  32960080
329700/                                                                 32970080
329800 3602-GET-TRIP.                                                   32980080
329900                                                                  32990080
330000     MOVE DK-ORD-NBR TO SHPTPO-PO-NBR.                            33000094
330100     MOVE ASC-REC-SEQ-NBR TO SHPTPO-REC-SEQ-NBR.                  33010080
330200                                                                  33020080
330300     EXEC SQL                                                     33030088
330400          SELECT  B.TRIP_ID, B.SHIPT_ID                           33040088
330500            INTO  :SHIPMT-TRIP-ID                                 33050088
330600                , :SHIPMT-SHIPT-ID                                33060088
330700            FROM  TSHPTPO A,                                      33070088
330800                  TSHIPMT B                                       33080088
330900            WHERE A.PO_NBR = :SHPTPO-PO-NBR AND                   33090088
331000                  A.REC_SEQ_NBR = :SHPTPO-REC-SEQ-NBR AND         33100088
331100                  A.SHIPT_ID = B.SHIPT_ID AND                     33110099
331200                  A.PRIM_SHIPT_IND = 'Y'                          33120099
331300     END-EXEC.                                                    33130099
331400         EVALUATE TRUE                                            33140099
331500             WHEN SQLCODE = +0                                    33150099
331600                 MOVE SHIPMT-TRIP-ID TO WST00001-INTR-TRIP-ID     33160099
331700             WHEN SQLCODE = +100                                  33170080
331800             WHEN SQLCODE = -811                                  33180080
331900             WHEN SQLCODE = -904                                  33190080
332000             WHEN SQLCODE = -913                                  33200080
332100                 CONTINUE                                         33210080
332200                                                                  33220080
332300             WHEN SQLWARN0 NOT = SPACE                            33230080
332400             WHEN SQLCODE < +0                                    33240080
332500             WHEN SQLCODE > +0                                    33250080
332600                 MOVE '2500-GET-SHIPMENT-INFO'                    33260080
332700                                 TO DP013-PARAGRAPH               33270080
332800                 MOVE 'SELECT SHIPMENT TABLE'                     33280080
332900                                 TO DP013-MESSAGE-TEXT (1)        33290080
333000                 MOVE SQLCA      TO DP013-SQLCA                   33300080
333100                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      33310080
333200                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)      33320080
333300                 SET DP013-DB2-ABEND                              33330080
333400                                 TO TRUE                          33340080
333500                 SET DP013-XCTL-DISPLAY-RESTART                   33350080
333600                                 TO TRUE                          33360080
333700                 PERFORM DP013-0000-PROCESS-ABEND                 33370080
333800         END-EVALUATE.                                            33380080
333900/                                                                 33390080
334000 3603-GET-SHPMT-XREF.                                             33400080
334100                                                                  33410080
334200                                                                  33420080
334300         EXEC SQL                                                 33430089
334400            SELECT  A.RCPT_TMST                                   33440089
334500              INTO :WST00001-RCPT-TMST                            33450089
334600              FROM  WST_SHPMT_XREF_HDR A                          33460089
334700          WHERE A.INTR_TRIP_ID = :WST00001-INTR-TRIP-ID           33470089
334800            AND A.SOR_CDE      = 'RC'                             33480089
334900            AND A.RCPT_TMST  <> :PC-DEFAULT-TMST                  33490089
335000         END-EXEC                                                 33500089
335100         EVALUATE TRUE                                            33510080
335200             WHEN SQLCODE = +0                                    33520080
335300             WHEN SQLCODE = -811                                  33530080
335400                 SET PS-RECEIVING-BEGUN-YES TO TRUE               33540089
335500             WHEN SQLCODE = +100                                  33550080
335600                 SET PS-RECEIVING-BEGUN-NO TO TRUE                33560089
335700             WHEN SQLCODE = -904                                  33570080
335800             WHEN SQLCODE = -913                                  33580080
335900                 CONTINUE                                         33590080
336000             WHEN SQLWARN0 NOT = SPACE                            33600080
336100             WHEN SQLCODE < +0                                    33610080
336200             WHEN SQLCODE > +0                                    33620080
336300                 MOVE '2600-SELECT-WST-XREF '                     33630080
336400                                 TO DP013-PARAGRAPH               33640080
336500                 MOVE 'SELECT SHIPMENT TABLE'                     33650080
336600                                 TO DP013-MESSAGE-TEXT (1)        33660080
336700                 MOVE SQLCA      TO DP013-SQLCA                   33670080
336800                 MOVE 'WST_SHPMT_XREF' TO DP013-DB2-TABLE-NAME (1)33680080
336900                 SET DP013-DB2-ABEND                              33690080
337000                                 TO TRUE                          33700080
337100                 SET DP013-XCTL-DISPLAY-RESTART                   33710080
337200                                 TO TRUE                          33720080
337300                 PERFORM DP013-0000-PROCESS-ABEND                 33730080
337400         END-EVALUATE.                                            33740080
337500/                                                                 33750080
337600*----------------------------------------------------------------*33760080
337700* LINK TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKUT005) USING     33770080
337800*  COPYBOOK WSWS001.                                              33780080
337900*----------------------------------------------------------------*33790080
338000 3604-CALL-WMS-MODULE.                                            33800080
338100                                                                  33810080
338200     SET WS001-PKSLIP-INACTIVE TO TRUE.                           33820099
338300     MOVE SHIPMT-TRIP-ID TO WS001-TRIP-ID.                        33830080
338400     MOVE ASC-OPR-ID TO WS001-OPER-UNT-ID.                        33840080
338500     MOVE DP020-USERID TO WS001-USER-ID.                          33850080
338600     MOVE DK-ORD-NBR TO WS001-PO-NBR.                             33860084
338700     MOVE ASC-REC-SEQ-NBR TO WS001-RCVR-NBR.                      33870080
338800     MOVE DK-PACK-ID TO WS001-PREPK-ID.                           33880080
338900     MOVE ZEROS TO WS001-SKU-NBR.                                 33890080
339000     MOVE ZEROS TO WS001-KOHLS-SHIPT-ID.                          33900080
339100     MOVE 'RC' TO WS001-SHIPMENT-SOURCE.                          33910080
339200     MOVE SPACES TO WS001-DTL-ASN-LEVEL-IND.                      33920080
339300     MOVE DP020-SRC-TASK-NUMBER TO WS001-SRC-TASK-NUMBER.         33930099
339400     MOVE PC-CURRENT-PROGRAM-NAME TO WS001-CALLING-PROGRAM-NAME.  33940099
339500                                                                  33950080
339600     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         33960080
339700                                                                  33970080
339800     EXEC CICS                                                    33980080
339900         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       33990080
340000              COMMAREA (WS001-FIELDS)                             34000080
340100              LENGTH   (PV-COMMAREA-LENGTH)                       34010080
340200     END-EXEC.                                                    34020080
340300     EVALUATE TRUE                                                34030080
340400         WHEN WS001-SUCCESSFUL                                    34040080
340500              CONTINUE                                            34050080
340600         WHEN WS001-DATABASE-BUSY OR                              34060080
340700              WS001-INVALID-SQL                                   34070080
340800                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       34080080
340900                  SET DP020-MSG-WARNING TO TRUE                   34090080
341000                  SET DP030-OVERRIDE-GO TO TRUE                   34100080
341100                  SET PS-ERROR          TO TRUE                   34110080
341200                                                                  34120080
341300                                                                  34130080
341400              INITIALIZE PV-CICS-MSG-AREA                         34140080
341500              STRING 'RCKCS801-'                                  34150083
341600                     '3603-CALL-WMS-MODULE - '                    34160080
341700                                           DELIMITED BY SIZE      34170080
341800                                      INTO PV-CICS-MSG-AREA       34180080
341900              PERFORM 9903-WRITE-CICS-LOG                         34190080
342000                                                                  34200080
342100              INITIALIZE PV-CICS-MSG-AREA                         34210080
342200              STRING 'RCKCS801-'                                  34220083
342300                     WS001-CRA-RET-MSG                            34230080
342400                                           DELIMITED BY SIZE      34240080
342500                                      INTO PV-CICS-MSG-AREA       34250080
342600              PERFORM 9903-WRITE-CICS-LOG                         34260080
342700                                                                  34270080
342800                                                                  34280080
342900         WHEN WS001-ERROR                                         34290080
343000                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       34300080
343100                  SET DP020-MSG-WARNING TO TRUE                   34310080
343200                  SET DP030-OVERRIDE-GO TO TRUE                   34320080
343300                  SET PS-ERROR          TO TRUE                   34330080
343400                                                                  34340080
343500              INITIALIZE PV-CICS-MSG-AREA                         34350080
343600              STRING 'RCKCS801-'                                  34360083
343700                     '3603-CALL-WMS-MODULE - '                    34370080
343800                                           DELIMITED BY SIZE      34380080
343900                                      INTO PV-CICS-MSG-AREA       34390080
344000              PERFORM 9903-WRITE-CICS-LOG                         34400080
344100                                                                  34410080
344200              INITIALIZE PV-CICS-MSG-AREA                         34420080
344300              STRING 'RCKCS801-'                                  34430083
344400                     WS001-CRA-RET-MSG                            34440080
344500                                           DELIMITED BY SIZE      34450080
344600                                      INTO PV-CICS-MSG-AREA       34460080
344700              PERFORM 9903-WRITE-CICS-LOG                         34470080
344800                                                                  34480080
344900         WHEN OTHER                                               34490080
345000                                                                  34500080
345100              INITIALIZE PV-CICS-MSG-AREA                         34510080
345200              STRING 'RCKCS801-'                                  34520083
345300                     '3603-CALL-WMS-MODULE - '                    34530080
345400                                           DELIMITED BY SIZE      34540080
345500                                      INTO PV-CICS-MSG-AREA       34550080
345600              PERFORM 9903-WRITE-CICS-LOG                         34560080
345700                                                                  34570080
345800              INITIALIZE PV-CICS-MSG-AREA                         34580080
345900              STRING 'RCKCS801-'                                  34590083
346000                     WS001-CRA-RET-MSG                            34600080
346100                                           DELIMITED BY SIZE      34610080
346200                                      INTO PV-CICS-MSG-AREA       34620080
346300              PERFORM 9903-WRITE-CICS-LOG                         34630080
346400                                                                  34640080
346500             MOVE '3603-CALL-WMS-MODULE' TO DP013-PARAGRAPH       34650080
346600             MOVE 'UNSUCCESSFUL CALL TO WMS  MOD'                 34660080
346700                                         TO DP013-MESSAGE-TEXT (1)34670080
346800             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)34680080
346900*            MOVE WS001-SQLCA            TO DP013-SQLCA           34690080
347000             SET DP013-DB2-ABEND                                  34700080
347100                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              34710080
347200             SET PS-ERROR                    TO TRUE              34720080
347300             PERFORM DP013-0000-PROCESS-ABEND                     34730080
347400                                                                  34740080
347500     END-EVALUATE.                                                34750080
347600/                                                                 34760075
347700*----------------------------------------------------------------*34770074
347800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *34780074
347900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *34790074
348000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *34800074
348100*    DISPLAY THE PANEL TO USER.                                  *34810074
348200*----------------------------------------------------------------*34820074
348300                                                                  34830074
348400 4000-BUILD-INITIAL-PANEL.                                        34840074
348500                                                                  34850074
348600     INITIALIZE ASC-BLOCK-ENTRIES (1)                             34860074
348700                ASC-BLOCK-ENTRIES (2).                            34870074
348800                                                                  34880074
348900     MOVE +1                       TO ASC-BLK-SUB.                34890074
349000                                                                  34900074
349100     SET ASC-ITEMS-LEFT-ON-DB                                     34910074
349200         ASC-UPDATE-DIDNT-OCCUR                                   34920074
349300         ASC-UPDATE-NOT-PENDING    TO TRUE.                       34930074
349400                                                                  34940074
349500     MOVE +0                       TO ASC-ITEM-SUB                34950074
349600                                      ASC-NUMBER-OF-ITEMS-READ    34960074
349700                                      ASC-NUMBER-OF-SELECTED-ITEMS34970074
349800                                      ASC-HIGHEST-BLOCK-WRITTEN   34980074
349900                                      ASC-START-OF-SELECTED-RANGE 34990074
350000                                      ASC-END-OF-SELECTED-RANGE   35000074
350100                                      ASC-ITEM-AT-TOP-OF-PANEL    35010074
350200                                      PV-TOTAL-QC-DTL-RATIO       35020074
350300                                      PV-TOTAL-QC-ODD-UNIT-QTY    35030074
350400                                      PV-TOTAL-QC-DTL-CK-ITM-QTY. 35040074
350500     PERFORM 4100-PREPARE-CURSOR.                                 35050074
350600     PERFORM 4355-GET-TRECEIV-INFO.                               35060074
350700     EVALUATE TRUE                                                35070074
350800         WHEN SQLCODE = +100                                      35080074
350900              MOVE PC-X TO ASC-PKGNG-CDE                          35090074
351000         WHEN SQLCODE = +0                                        35100074
351100              PERFORM 4360-GET-TPURCHS-INFO                       35110074
351200              EVALUATE TRUE                                       35120074
351300                  WHEN DK-PACK-ID = 99                            35130074
351400                  WHEN SQLCODE = +0                               35140074
351500                       IF RECEIV-PKGNG-CDE > SPACES               35150074
351600                          MOVE RECEIV-PKGNG-CDE                   35160074
351700                               TO ASC-PKGNG-CDE                   35170074
351800                       ELSE                                       35180074
351900                        IF PURCHS-PKGNG-CDE > SPACES              35190074
352000                           MOVE PURCHS-PKGNG-CDE                  35200074
352100                               TO ASC-PKGNG-CDE                   35210074
352200                        ELSE                                      35220074
352300                           MOVE PC-X                              35230074
352400                                TO ASC-PKGNG-CDE                  35240074
352500                        END-IF                                    35250074
352600                       END-IF                                     35260074
352700                       MOVE RECEIV-STATUS-CDE                     35270074
352800                               TO ASC-REC-STAT                    35280074
352900                       PERFORM 4200-TROUBLE-DESC                  35290074
353000                       PERFORM 4100-PREPARE-CURSOR                35300074
353100                       PERFORM 4010-OPEN-CURSOR                   35310074
353200                       MOVE ZERO    TO ASC-TOTAL-BEST-CASE-UNITS  35320074
353300                       MOVE +1      TO PV-VALID-IDX               35330074
353400                       INITIALIZE RC806-PRODUCT-PACK-VALIDATION   35340074
353500                       MOVE +0      TO RC806-NBR-OF-LINES         35350074
353600                       PERFORM 4300-READ-ITEMS-FROM-DB            35360074
353700                       PERFORM 4020-CLOSE-CURSOR                  35370074
353800                       IF  ASC-NUMBER-OF-ITEMS-READ = ZERO        35380074
353900                           SET DP020-NEXT-ACT-APPL-ERROR          35390074
354000                               DP020-MSG-FATAL                    35400074
354100                                   TO TRUE                        35410074
354200                           MOVE PC-TSYMSG-00050                   35420074
354300                                   TO DP020-MSG-NUMBER            35430074
354400                       ELSE                                       35440074
354500                          MOVE +1  TO ASC-BLK-SUB                 35450074
354600                                      PV-BLOCK-NUMBER             35460074
354700                          PERFORM 4410-READ-TEMP-STORAGE          35470074
354800                          PERFORM 4423-CALL-VALIDATION-MODULE     35480074
354900                       END-IF                                     35490074
355000                  WHEN SQLCODE = +100                             35500074
355100                       MOVE PC-X TO ASC-PKGNG-CDE                 35510074
355200              END-EVALUATE                                        35520074
355300     END-EVALUATE.                                                35530074
355400                                                                  35540074
355500     MOVE +1                       TO PV-TOP-ITEM.                35550074
355600                                                                  35560074
355700     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           35570074
355800         MOVE -1                   TO MR-SELECTL (1)              35580074
355900         SET DP030-SET-CURSOR-APPL-1                              35590074
356000                                   TO TRUE                        35600074
356100         MOVE +1                   TO ASC-BLK-SUB                 35610074
356200                                     PV-BLOCK-NUMBER              35620074
356300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     35630074
356400     END-IF.                                                      35640074
356500                                                                  35650074
356600/                                                                 35660074
356700*----------------------------------------------------------------*35670074
356800* OPEN THE SHIPMENT CURSOR                                       *35680074
356900*----------------------------------------------------------------*35690074
357000                                                                  35700074
357100 4010-OPEN-CURSOR.                                                35710074
357200                                                                  35720074
357300     EXEC SQL                                                     35730074
357400         OPEN TPURITM-CSR                                         35740074
357500     END-EXEC.                                                    35750074
357600                                                                  35760074
357700     EVALUATE TRUE                                                35770074
357800         WHEN SQLCODE = +0                                        35780074
357900              CONTINUE                                            35790074
358000         WHEN SQLCODE = -904                                      35800074
358100         WHEN SQLCODE = -911                                      35810074
358200         WHEN SQLCODE = -913                                      35820074
358300              PERFORM 9900-SOFT-ABORT                             35830074
358400         WHEN OTHER                                               35840074
358500              MOVE '4010-OPEN-CURSOR'                             35850074
358600                               TO DP013-PARAGRAPH                 35860074
358700              MOVE 'OPEN CURSOR'                                  35870074
358800                               TO DP013-MESSAGE-TEXT (1)          35880074
358900              MOVE SQLCA       TO DP013-SQLCA                     35890074
359000              MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)        35900074
359100              PERFORM 9950-FORMAT-ERROR-MSG                       35910074
359200              SET DP013-DB2-ABEND                                 35920074
359300                               TO TRUE                            35930074
359400              PERFORM DP013-0000-PROCESS-ABEND                    35940074
359500     END-EVALUATE.                                                35950074
359600                                                                  35960074
359700/                                                                 35970074
359800*----------------------------------------------------------------*35980074
359900* CLOSE THE SHIPMENT CURSOR                                      *35990074
360000*----------------------------------------------------------------*36000074
360100 4020-CLOSE-CURSOR.                                               36010074
360200                                                                  36020074
360300     EXEC SQL                                                     36030074
360400          CLOSE TPURITM-CSR                                       36040074
360500     END-EXEC.                                                    36050074
360600                                                                  36060074
360700     EVALUATE TRUE                                                36070074
360800         WHEN SQLCODE = +0                                        36080074
360900              CONTINUE                                            36090074
361000         WHEN SQLCODE = -904                                      36100074
361100         WHEN SQLCODE = -911                                      36110074
361200         WHEN SQLCODE = -913                                      36120074
361300              PERFORM 9900-SOFT-ABORT                             36130074
361400         WHEN OTHER                                               36140074
361500              MOVE '4020-CLOSE-CURSOR'                            36150074
361600                                   TO DP013-PARAGRAPH             36160074
361700              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      36170074
361800              MOVE SQLCA           TO DP013-SQLCA                 36180074
361900              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    36190074
362000              SET DP013-DB2-ABEND  TO TRUE                        36200074
362100              PERFORM 9950-FORMAT-ERROR-MSG                       36210074
362200              PERFORM DP013-0000-PROCESS-ABEND                    36220074
362300     END-EVALUATE.                                                36230074
362400                                                                  36240074
362500/                                                                 36250074
362600*----------------------------------------------------------------*36260074
362700*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *36270074
362800*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *36280074
362900*----------------------------------------------------------------*36290074
363000 4100-PREPARE-CURSOR.                                             36300074
363100                                                                  36310074
363200     MOVE ASC-REC-NBR      TO DK-ORD-NBR                          36320074
363300     MOVE ASC-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR.                    36330074
363400     MOVE ASC-OPR-ID       TO DK-OPR-ID                           36340074
363500     MOVE ASC-FACT         TO DK-FACT.                            36350074
363600     MOVE ASC-PACK-ID      TO DK-PACK-ID.                         36360074
363700                                                                  36370074
363800/                                                                 36380074
363900*----------------------------------------------------------------*36390074
364000* FIRST DISPLAY ANY PACK LEVEL TROUBLE.  IF THERE ISN'T ANY, THEN*36400074
364100*   DISPLAY ANY RECEIVER LEVEL TROUBLE.                          *36410074
364200*----------------------------------------------------------------*36420074
364300 4200-TROUBLE-DESC.                                               36430074
364400                                                                  36440074
364500     EXEC SQL                                                     36450074
364600         SELECT B.TRBL_SHT_DESC                                   36460074
364700         INTO :TRBRSN-TRBL-SHT-DESC                               36470074
364800         FROM  TTRBNTF A                                          36480074
364900              ,TTRBRSN B                                          36490074
365000         WHERE A.PO_NBR               = :DK-ORD-NBR               36500074
365100               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          36510074
365200               AND A.RESOLVED_IND    IN (:PC-N, :PC-I)            36520074
365300               AND A.PO_LNE_NBR       = 0                         36530074
365400               AND A.OPER_UNT_ID      = :DK-OPR-ID                36540074
365500               AND A.FCLTY_ID         = :DK-FACT                  36550074
365600               AND A.PREPK_ID         = :DK-PACK-ID               36560074
365700               AND A.TRBL_RSN_CDE     = B.TRBL_RSN_CDE            36570074
365800     END-EXEC                                                     36580074
365900                                                                  36590074
366000     EVALUATE TRUE                                                36600074
366100         WHEN SQLCODE = +0                                        36610074
366200             MOVE TRBRSN-TRBL-SHT-DESC TO ASC-REC-TROUBLE-RSN     36620074
366300         WHEN SQLCODE = -811                                      36630074
366400             STRING TRBRSN-TRBL-SHT-DESC '*'                      36640074
366500                 DELIMITED BY SIZE                                36650074
366600                 INTO ASC-REC-TROUBLE-RSN                         36660074
366700         WHEN SQLCODE = +100                                      36670074
366800             MOVE SPACES         TO ASC-REC-TROUBLE-RSN           36680074
366900         WHEN SQLCODE = -904                                      36690074
367000         WHEN SQLCODE = -911                                      36700074
367100         WHEN SQLCODE = -913                                      36710074
367200             PERFORM 9900-SOFT-ABORT                              36720074
367300                                                                  36730074
367400         WHEN OTHER                                               36740074
367500             MOVE '4200-TROUBLE-DESC'                             36750074
367600                             TO DP013-PARAGRAPH                   36760074
367700             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     36770074
367800                             TO DP013-MESSAGE-TEXT (1)            36780074
367900             MOVE SQLCA          TO DP013-SQLCA                   36790074
368000             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      36800074
368100             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      36810074
368200             PERFORM 9950-FORMAT-ERROR-MSG                        36820074
368300             SET DP013-XCTL-DISPLAY-RESTART                       36830074
368400                 DP013-DB2-ABEND                                  36840074
368500                             TO TRUE                              36850074
368600             PERFORM DP013-0000-PROCESS-ABEND                     36860074
368700     END-EVALUATE.                                                36870074
368800                                                                  36880074
368900* IF PACK LEVEL TROUBLE ISN'T FOUND, SEARCH FOR LINE LEVEL        36890074
369000* TROUBLE.                                                        36900074
369100                                                                  36910074
369200     IF ASC-REC-TROUBLE-RSN  = SPACES                             36920074
369300        EXEC SQL                                                  36930074
369400            SELECT C.TRBL_SHT_DESC                                36940074
369500            INTO :TRBRSN-TRBL-SHT-DESC                            36950074
369600            FROM  TRECITM A                                       36960074
369700                 ,TTRBNTF B                                       36970074
369800                 ,TTRBRSN C                                       36980074
369900            WHERE A.ORD_NBR              = :DK-ORD-NBR            36990074
370000                  AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR       37000074
370100                  AND A.ORD_LNE_NBR      > 0                      37010074
370200                  AND A.VER_STATUS_CDE   = 'A'                    37020074
370300                  AND A.PREPK_ID         = :DK-PACK-ID            37030074
370400                  AND A.OPER_UNT_ID      = :DK-OPR-ID             37040074
370500                  AND A.FCLTY_ID         = :DK-FACT               37050074
370600                  AND B.PO_NBR           = A.ORD_NBR              37060074
370700                  AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR          37070074
370800                  AND B.OPER_UNT_ID      = A.OPER_UNT_ID          37080074
370900                  AND B.FCLTY_ID         = A.FCLTY_ID             37090074
371000                  AND B.PO_LNE_NBR       = A.ORD_LNE_NBR          37100074
371100                  AND B.RESOLVED_IND    IN (:PC-N, :PC-I)         37110074
371200                  AND C.TRBL_RSN_CDE     = B.TRBL_RSN_CDE         37120074
371300        END-EXEC                                                  37130074
371400                                                                  37140074
371500        EVALUATE TRUE                                             37150074
371600            WHEN SQLCODE = +0                                     37160074
371700                MOVE TRBRSN-TRBL-SHT-DESC TO ASC-REC-TROUBLE-RSN  37170074
371800            WHEN SQLCODE = -811                                   37180074
371900                STRING TRBRSN-TRBL-SHT-DESC '*'                   37190074
372000                    DELIMITED BY SIZE                             37200074
372100                    INTO ASC-REC-TROUBLE-RSN                      37210074
372200            WHEN SQLCODE = +100                                   37220074
372300                MOVE SPACES         TO ASC-REC-TROUBLE-RSN        37230074
372400            WHEN SQLCODE = -904                                   37240074
372500            WHEN SQLCODE = -911                                   37250074
372600            WHEN SQLCODE = -913                                   37260074
372700                PERFORM 9900-SOFT-ABORT                           37270074
372800                                                                  37280074
372900         WHEN OTHER                                               37290074
373000                MOVE '4200-TROUBLE-DESC'                          37300074
373100                                TO DP013-PARAGRAPH                37310074
373200                MOVE 'SELECT ON TTRBNTF/TTRBRSN'                  37320074
373300                                TO DP013-MESSAGE-TEXT (1)         37330074
373400                MOVE SQLCA          TO DP013-SQLCA                37340074
373500                MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)   37350074
373600                MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)   37360074
373700                PERFORM 9950-FORMAT-ERROR-MSG                     37370074
373800                SET DP013-XCTL-DISPLAY-RESTART                    37380074
373900                    DP013-DB2-ABEND                               37390074
374000                                TO TRUE                           37400074
374100                PERFORM DP013-0000-PROCESS-ABEND                  37410074
374200        END-EVALUATE.                                             37420074
374300                                                                  37430074
374400                                                                  37440074
374500*----------------------------------------------------------------*37450074
374600*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *37460074
374700*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *37470074
374800*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *37480074
374900*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *37490074
375000*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *37500074
375100*                                                                *37510074
375200*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *37520074
375300*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *37530074
375400*    UPON INITIALIZATION.                                        *37540074
375500*----------------------------------------------------------------*37550074
375600                                                                  37560074
375700 4200-CALC-OPEN-TO-REC.                                           37570074
375800                                                                  37580074
375900     SET DP277-LINE-LEVEL-OTR                                     37590074
376000         DP277-RECEIVER-OTR      TO TRUE                          37600074
376100                                                                  37610074
376200     INITIALIZE DP277-KEYS                                        37620074
376300     MOVE DK-ORD-NBR             TO DP277-PO-NBR                  37630074
376400     MOVE DK-LINE-NBR            TO DP277-PO-LNE-NBR              37640074
376500     MOVE DK-RCVR-SEQ-NBR        TO DP277-REC-SEQ-NBR             37650074
376600     MOVE DK-OPR-ID              TO DP277-OPER-UNT-ID             37660074
376700     MOVE DK-FACT                TO DP277-FCLTY-ID                37670074
376800     MOVE DK-PACK-ID             TO DP277-PO-PREPK-ID             37680074
376900                                                                  37690074
377000     COPY DPPD277.                                                37700074
377100                                                                  37710074
377200/                                                                 37720074
377300 4300-READ-ITEMS-FROM-DB.                                         37730074
377400                                                                  37740074
377500     PERFORM                                                      37750074
377600         VARYING PV-READ-COUNT                                    37760074
377700         FROM 1 BY 1                                              37770074
377800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    37780074
377900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         37790074
378000                                                                  37800074
378100*-----------------------------------------------**   WR # 230ZZ  *37810074
378200* INITIALIZED XL001-ITEM-COMMAREA               **   WR # 230ZZ  *37820074
378300*-----------------------------------------------**   WR # 230ZZ  *37830074
378400         INITIALIZE XL001-ITEM-COMMAREA                           37840074
378500                    PV-TEMP-SEQ-NBR                               37850074
378600*-----------------------------------------------**   WR # 230ZZ  *37860074
378700                                                                  37870074
378800         PERFORM 4310-FETCH                                       37880074
378900                                                                  37890074
379000         IF  ASC-ITEMS-LEFT-ON-DB                                 37900074
379100               IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL              37910074
379200                   ADD +1            TO ASC-ITEM-SUB              37920074
379300               ELSE                                               37930074
379400                   ADD +1            TO ASC-BLK-SUB               37940074
379500                   MOVE +1           TO ASC-ITEM-SUB              37950074
379600                                                                  37960074
379700                   IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY       37970074
379800                       MOVE +1       TO ASC-BLK-SUB               37980074
379900                       SET ASC-BLOCK-MODIFIED (1)                 37990074
380000                                     TO TRUE                      38000074
380100                       PERFORM 5100-WRITE-TEMP-STORAGE            38010074
380200                       MOVE ASC-BLOCK-ENTRIES                     38020074
380300                           (PC-MAX-BLOCKS-IN-ARRAY)               38030074
380400                           TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)      38040074
380500                       ADD +1        TO ASC-BLK-SUB               38050074
380600                       INITIALIZE ASC-BLOCK-ENTRIES(ASC-BLK-SUB)  38060074
380700                       SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)    38070074
380800                                     TO TRUE                      38080074
380900                   END-IF                                         38090074
381000               END-IF                                             38100074
381100                                                                  38110074
381200*-----------------------------------------------**   WR # 230ZZ  *38120074
381300* ADDED CODE TO CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *38130074
381400*-----------------------------------------------**   WR # 230ZZ  *38140074
381500                                                                  38150074
381600             IF (DK-SKU-SEQ = PC-000)                             38160074
381700                 MOVE '00000000' TO PV-TEMP-SEQ-NBR               38170074
381800             END-IF                                               38180074
381900                                                                  38190074
382000             IF (DK-SKU-SEQ = PC-999)                             38200074
382100                 MOVE '99999999' TO PV-TEMP-SEQ-NBR               38210074
382200             END-IF                                               38220074
382300                                                                  38230074
382400             IF    PS-CALL-API-YES          AND                   38240074
382500                 ((DK-SKU-SEQ NOT = PC-000) AND                   38250074
382600                  (DK-SKU-SEQ NOT = PC-999))                      38260074
382700                                                                  38270074
382800                PERFORM 4315-CALL-CICS-API-ARCH                   38280074
382900                                                                  38290074
383000             END-IF                                               38300074
383100*-----------------------------------------------**   WR # 230ZZ  *38310074
383200                                                                  38320074
383300             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    38330074
383400             MOVE ASC-NUMBER-OF-ITEMS-READ                        38340074
383500                                   TO ASC-LIST-ITEM-NUMBER        38350074
383600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38360074
383700             MOVE PURCHS-DEPT-NBR       TO ASC-DEPT               38370074
383800             MOVE DK-LINE-NBR           TO ASC-LINE-NUMBER        38380074
383900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38390074
384000             MOVE PV-TEMP-SEQ-NBR       TO ASC-SKU-SEQ-NBR        38400074
384100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38410074
384200             MOVE PURITM-UNT-QTY        TO ASC-PURITM-UNT-QTY     38420074
384300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38430074
384400             MOVE PURITM-UNT-RTL-PR-AMT TO                        38440074
384500                                       ASC-PURITM-UNT-RTL-PR-AMT  38450074
384600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38460074
384700             MOVE PURITM-GP-RTL-AMT     TO ASC-PURITM-GP-RTL-AMT  38470074
384800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38480074
384900             MOVE PURITM-GP-QTY         TO ASC-PURITM-GP-QTY      38490074
385000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38500074
385100             MOVE PURITM-PREPK-RATO-QTY TO ASC-PO-PACK-RATIO      38510074
385200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38520074
385300*      GET OPEN TO RECEIVE TOTALS                                 38530074
385400             PERFORM 4200-CALC-OPEN-TO-REC                        38540074
385500             MOVE DK-LINE-NBR           TO DP277-SEARCH-NBR       38550074
385600             PERFORM 4210-SEARCH-OTR                              38560074
385700             MOVE DP277-OTR-OUT-X       TO ASC-OTR-PACK-UNITS     38570074
385800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     38580074
385900                                                                  38590074
386000*----------------------------------------------** WR/IR 230ZZ --**38600074
386100* ADDED CODE TO MOVE SINGLE STATUS CODE TO THE HEADER BASED ON  **38610074
386200* THE VALUES IN THE ARRAY                                       **38620074
386300*----------------------------------------------** WR/IR 230ZZ --**38630074
386400             IF RECITM-STATUS-CDE = 'IP'                          38640074
386500                MOVE 'Y'              TO PV-FOUND-LINE-STATUS-IP  38650074
386600             ELSE                                                 38660074
386700                IF RECITM-STATUS-CDE = 'CM'                       38670074
386800                   MOVE 'Y'           TO PV-FOUND-LINE-STATUS-CM  38680074
386900                ELSE                                              38690074
387000                    IF RECITM-STATUS-CDE = 'VE'                   38700074
387100                       MOVE 'Y'        TO PV-FOUND-LINE-STATUS-VE 38710074
387200                    END-IF                                        38720074
387300                END-IF                                            38730074
387400             END-IF                                               38740074
387500*----------------------------------------------** WR/IR 230ZZ --**38750074
387600                                                                  38760074
387700             MOVE RECITM-PREPK-RATO-QTY TO ASC-DTL-PACK-RATIO-N   38770074
387800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     38780074
387900             MOVE RECITM-STATUS-CDE     TO ASC-REC-LINE-STATUS    38790074
388000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     38800074
388100             MOVE RECITM-DTL-CK-ITM-QTY TO ASC-DTL-PACK-UNITS-N   38810074
388200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     38820074
388300             MOVE RECITM-PKSL-ITM-QTY   TO ASC-PKSL-PACK-UNITS    38830074
388400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     38840074
388500                                                                  38850074
388600             MOVE +0                    TO PV-TOTAL-QC-DTL-RATIO  38860074
388700                                      PV-TOTAL-QC-ODD-UNIT-QTY    38870074
388800                                      PV-TOTAL-QC-DTL-CK-ITM-QTY  38880074
388900             PERFORM 4421-LOAD-VALIDATION-DATA                    38890074
389000                                                                  38900074
389100             PERFORM 4330-GET-VERIFY-QTY                          38910074
389200             MOVE PV-AP-VERIFY-ITM-QTY  TO                        38920074
389300                 ASC-VRFD-PACK-UNITS   (ASC-BLK-SUB ASC-ITEM-SUB) 38930074
389400                                                                  38940074
389500             IF ASC-REC-STAT NOT = PC-VE                          38950074
389600                 PERFORM 4370-FIND-LINE-TROUBLE                   38960074
389700                 EVALUATE TRUE                                    38970074
389800                     WHEN PV-UNRSLVD-TRBL-COUNT > ZERO            38980074
389900                         SET ASC-LINE-IN-TROUBLE                  38990074
390000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39000074
390100                                   TO TRUE                        39010074
390200                     WHEN PV-RSLVD-TRBL-COUNT > ZERO              39020074
390300                         SET ASC-LINE-DISTRO-TRBL                 39030074
390400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39040074
390500                                   TO TRUE                        39050074
390600                 END-EVALUATE                                     39060074
390700             END-IF                                               39070074
390800             PERFORM 4350-CK-CASEPACK-SPLIT-PROCESS               39080074
390900            END-IF                                                39090074
391000     END-PERFORM.                                                 39100074
391100                                                                  39110074
391200     PERFORM 4340-MOVE-HEAD-N-TOT-TO-COMM.                        39120074
391300                                                                  39130074
391400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          39140074
391500         MOVE +1                   TO ASC-BLK-SUB                 39150074
391600         PERFORM 5100-WRITE-TEMP-STORAGE                          39160074
391700         ADD +1                    TO ASC-BLK-SUB                 39170074
391800         PERFORM 5100-WRITE-TEMP-STORAGE                          39180074
391900                                                                  39190074
392000         MOVE 1                    TO ASC-BLK-SUB                 39200074
392100                                      PV-BLOCK-NUMBER             39210074
392200         PERFORM 4410-READ-TEMP-STORAGE                           39220074
392300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             39230074
392400             ADD +1                TO ASC-BLK-SUB                 39240074
392500                                      PV-BLOCK-NUMBER             39250074
392600             PERFORM 4410-READ-TEMP-STORAGE                       39260074
392700         END-IF                                                   39270074
392800     END-IF.                                                      39280074
392900*----------------------------------------------------------------*39290074
393000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *39300074
393100*----------------------------------------------------------------*39310074
393200/                                                                 39320074
393300*----------------------------------------------------------------*39330074
393400*    FETCH A TPURITM ROW                                         *39340074
393500*----------------------------------------------------------------*39350074
393600*----------------------------------------------------------------*39360074
393700*                                               **   WR # 230ZZ  *39370074
393800* ADDED CODE TO RETRIEVE ITEM NUMBER FROM TPURITM AND            *39380074
393900* ADDED CODE TO RETRIEVE PRE PACK ID FROM TRECITM.               *39390074
394000*                                                                *39400074
394100* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *39410074
394200* TO TRUE.                                                       *39420074
394300* ADDED A MOVE STATEMENT, TO MOVE VALUE OF PURITM-SKU-SEQ-NBR TO *39430074
394400* DK-SKU-SEQ.                                                    *39440074
394500* ADDED A MOVE STATEMENT, TO MOVE VALUE OF PURITM-ITM-NBR TO     *39450074
394600* DK-ITM-NBR.                                                    *39460074
394700*----------------------------------------------------------------*39470074
394800                                                                  39480074
394900 4310-FETCH.                                                      39490074
395000                                                                  39500074
395100     MOVE SPACES TO DK-SKU-SEQ.                                   39510074
395200     MOVE ZEROES TO DK-ITM-NBR.                                   39520074
395300                                                                  39530074
395400     EXEC SQL                                                     39540074
395500         FETCH TPURITM-CSR                                        39550074
395600            INTO :PURITM-PO-NBR                                   39560074
395700                ,:PURITM-VER-NBR                                  39570074
395800                ,:PURITM-SKU-SEQ-NBR                              39580074
395900                ,:PURITM-SKU-DESC                                 39590074
396000                ,:DK-LINE-NBR                                     39600074
396100                ,:PURITM-VEND-STYL-NAME                           39610074
396200                ,:PURITM-UNT-QTY                                  39620074
396300                ,:PURITM-UNT-RTL-PR-AMT                           39630074
396400                ,:PURITM-GP-RTL-AMT                               39640074
396500                ,:PURITM-GP-QTY                                   39650074
396600                ,:PURITM-PO-LNE-NBR                               39660074
396700                ,:PURITM-PREPK-RATO-QTY                           39670074
396800                ,:PURITM-STATUS-CDE                               39680074
396900                ,:PURITM-ITM-NBR                                  39690074
397000                ,:RECITM-ORD-LNE-NBR                              39700074
397100                ,:RECITM-STATUS-CDE                               39710074
397200                ,:RECITM-CASE-PACK-QTY                            39720074
397300                ,:RECITM-DTL-CK-ITM-QTY                           39730074
397400                ,:RECITM-PKSL-ITM-QTY                             39740074
397500                ,:RECITM-MKING-APRON-TMST                         39750074
397600                ,:RECITM-PREPK-RATO-QTY                           39760074
397700                ,:RECITM-PREPK-ODD-UNT-QTY                        39770074
397800                ,:RECITM-PREPK-ID                                 39780074
397900     END-EXEC.                                                    39790074
398000                                                                  39800074
398100     EVALUATE TRUE                                                39810074
398200         WHEN SQLCODE = +0                                        39820074
398300                                                                  39830074
398400              SET PS-CALL-API-YES            TO TRUE              39840074
398500              MOVE RECITM-PREPK-ID           TO DK-PACK-ID        39850074
398600              MOVE PURITM-SKU-SEQ-NBR        TO DK-SKU-SEQ        39860074
398700              MOVE PURITM-ITM-NBR            TO DK-ITM-NBR        39870074
398800                                                                  39880074
398900              IF PURITM-STATUS-CDE = PC-RV                        39890074
399000                  SET DP020-MSG-WARNING      TO TRUE              39900074
399100                  MOVE PC-TSYMSG-02762       TO DP020-MSG-NUMBER  39910074
399200              END-IF                                              39920074
399300                                                                  39930074
399400         WHEN SQLCODE = +100                                      39940074
399500              SET ASC-NO-ITEMS-LEFT-ON-DB                         39950074
399600                                   TO TRUE                        39960074
399700         WHEN SQLCODE = -904                                      39970074
399800         WHEN SQLCODE = -911                                      39980074
399900         WHEN SQLCODE = -913                                      39990074
400000              PERFORM 9900-SOFT-ABORT                             40000074
400100                                                                  40010074
400200         WHEN OTHER                                               40020074
400300              MOVE '4310-FETCH'                                   40030074
400400                                   TO DP013-PARAGRAPH             40040074
400500              MOVE 'FETCH TPURITM CURSOR'                         40050074
400600                                   TO DP013-MESSAGE-TEXT (1)      40060074
400700              MOVE SQLCA           TO DP013-SQLCA                 40070074
400800              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    40080074
400900              SET DP013-DB2-ABEND  TO TRUE                        40090074
401000              PERFORM 9950-FORMAT-ERROR-MSG                       40100074
401100              PERFORM DP013-0000-PROCESS-ABEND                    40110074
401200     END-EVALUATE.                                                40120074
401300*----------------------------------------------------------------*40130074
401400* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *40140074
401500*----------------------------------------------------------------*40150074
401600/                                                                 40160074
401700*----------------------------------------------------------------*40170074
401800*                                               **   WR # 230ZZ  *40180074
401900* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE         *40190074
402000*----------------------------------------------------------------*40200074
402100 4315-CALL-CICS-API-ARCH.                                         40210074
402200                                                                  40220074
402300        MOVE DK-ITM-NBR           TO XL001-KEY-ITM-NBR.           40230074
402400                                                                  40240074
402500        SET  XL001-BY-ITEM                                        40250074
402600             XL001-SELECT-SKU     TO TRUE.                        40260074
402700                                                                  40270074
402800        CALL XL001-VSM-PGM USING  DFHEIBLK                        40280074
402900                                  XL001-COMMAREA                  40290074
403000                                  XL001-ITEM-COMMAREA.            40300074
403100        EVALUATE TRUE                                             40310074
403200                                                                  40320074
403300         WHEN XL001-SKU-SQLCODE = +0                              40330074
403400           MOVE XL001-SKU-NBR     TO  PV-TEMP-SEQ-NBR             40340074
403500           CONTINUE                                               40350074
403600                                                                  40360074
403700         WHEN XL001-SKU-SQLCODE = +100                            40370074
403800           MOVE ZEROES            TO  PV-TEMP-SEQ-NBR             40380074
403900                                                                  40390074
404000         WHEN XL001-SKU-SQLCODE = -904                            40400074
404100         WHEN XL001-SKU-SQLCODE = -911                            40410074
404200         WHEN XL001-SKU-SQLCODE = -913                            40420074
404300           PERFORM 9900-SOFT-ABORT                                40430074
404400                                                                  40440074
404500         WHEN XL001-INVALID-ACCESS                                40450074
404600           MOVE '4315-CALL-CICS-API-ARCH'                         40460074
404700                                TO DP013-PARAGRAPH                40470074
404800           MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'              40480074
404900                                TO DP013-MESSAGE-TEXT (1)         40490074
405000           MOVE SQLCA           TO DP013-SQLCA                    40500074
405100           MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)       40510074
405200           PERFORM 9950-FORMAT-ERROR-MSG                          40520074
405300           SET DP013-DB2-ABEND  TO TRUE                           40530074
405400           PERFORM DP013-0000-PROCESS-ABEND                       40540074
405500                                                                  40550074
405600         WHEN OTHER                                               40560074
405700           MOVE '4315-CALL-CICS-API-ARCH'                         40570074
405800                                TO DP013-PARAGRAPH                40580074
405900           MOVE 'UNSUCCESSFUL SELECT OF ITEM NBR'                 40590074
406000                                TO DP013-MESSAGE-TEXT (1)         40600074
406100           MOVE XL001-SKU-SQLCODE                                 40610074
406200                                TO SQLCODE                        40620074
406300           MOVE SQLCA           TO DP013-SQLCA                    40630074
406400           MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)       40640074
406500           PERFORM 9950-FORMAT-ERROR-MSG                          40650074
406600           SET DP013-DB2-ABEND  TO TRUE                           40660074
406700           PERFORM DP013-0000-PROCESS-ABEND                       40670074
406800        END-EVALUATE.                                             40680074
406900*----------------------------------------------------------------*40690074
407000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *40700074
407100*----------------------------------------------------------------*40710074
407200 4320-GET-TRECITM-INFO.                                           40720074
407300                                                                  40730074
407400         EXEC SQL                                                 40740074
407500              SELECT  PKSL_ITM_QTY                                40750074
407600                     ,DTL_CK_ITM_QTY                              40760074
407700                     ,CASE_PACK_QTY                               40770074
407800                     ,RCPT_DISTR_UPD_CDE                          40780074
407900                     ,PREPK_ID                                    40790074
408000                     ,PREPK_RATO_QTY                              40800074
408100                     ,PREPK_DRV_LNE_CDE                           40810074
408200                     ,PREPK_ODD_UNT_QTY                           40820074
408300                INTO :RECITM-PKSL-ITM-QTY                         40830074
408400                    ,:RECITM-DTL-CK-ITM-QTY                       40840074
408500                    ,:RECITM-CASE-PACK-QTY                        40850074
408600                    ,:RECITM-RCPT-DISTR-UPD-CDE                   40860074
408700                    ,:RECITM-PREPK-ID                             40870074
408800                    ,:RECITM-PREPK-RATO-QTY                       40880074
408900                    ,:RECITM-PREPK-DRV-LNE-CDE                    40890074
409000                    ,:RECITM-PREPK-ODD-UNT-QTY                    40900074
409100                FROM TRECITM                                      40910074
409200               WHERE  ORD_NBR        = :DK-ORD-NBR                40920074
409300                 AND  ORD_LNE_NBR    = :DK-LINE-NBR               40930074
409400                 AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR           40940074
409500                 AND  OPER_UNT_ID    = :DK-OPR-ID                 40950074
409600                 AND  FCLTY_ID       = :DK-FACT                   40960074
409700                 AND  VER_STATUS_CDE = 'A'                        40970074
409800                 AND  PREPK_ID       = :DK-PACK-ID                40980074
409900         END-EXEC                                                 40990074
410000                                                                  41000074
410100         EVALUATE TRUE                                            41010074
410200             WHEN SQLCODE = +0                                    41020074
410300             WHEN SQLCODE = +100                                  41030074
410400                  CONTINUE                                        41040074
410500             WHEN SQLCODE = -904                                  41050074
410600             WHEN SQLCODE = -911                                  41060074
410700             WHEN SQLCODE = -913                                  41070074
410800                  PERFORM 9900-SOFT-ABORT                         41080074
410900                                                                  41090074
411000             WHEN OTHER                                           41100074
411100                  MOVE '4320-GET-TRECITM-INFO'                    41110074
411200                                  TO DP013-PARAGRAPH              41120074
411300                  MOVE 'UNSUCCESSFUL SELECT ON TRECITM'           41130074
411400                                  TO DP013-MESSAGE-TEXT (1)       41140074
411500                  MOVE SQLCA      TO DP013-SQLCA                  41150074
411600                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     41160074
411700                  PERFORM 9950-FORMAT-ERROR-MSG                   41170074
411800                  SET DP013-DB2-ABEND                             41180074
411900                      DP013-XCTL-DISPLAY-RESTART                  41190074
412000                                  TO TRUE                         41200074
412100                  PERFORM DP013-0000-PROCESS-ABEND                41210074
412200         END-EVALUATE.                                            41220074
412300                                                                  41230074
412400/                                                                 41240074
412500*----------------------------------------------------------------*41250074
412600*    GET SKU, SKU DESC, AND VENDOR STYLE FROM TPURCHS/TPURITM    *41260074
412700*----------------------------------------------------------------*41270074
412800 4330-GET-VERIFY-QTY.                                             41280074
412900                                                                  41290074
413000         EXEC SQL                                                 41300074
413100              SELECT SUM(AP_VERIFY_ITM_QTY)                       41310074
413200                INTO :PV-AP-VERIFY-ITM-QTY                        41320074
413300                FROM TRECDIS                                      41330074
413400               WHERE ORD_NBR           = :DK-ORD-NBR              41340074
413500                 AND ORD_LNE_NBR       = :DK-LINE-NBR             41350074
413600                 AND REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR         41360074
413700                 AND OPER_UNT_ID       = :DK-OPR-ID               41370074
413800                 AND FCLTY_ID          = :DK-FACT                 41380074
414000         END-EXEC                                                 41400074
414100                                                                  41410074
414200         EVALUATE TRUE                                            41420074
414300             WHEN SQLCODE = ZERO                                  41430074
414400                  CONTINUE                                        41440074
414500             WHEN SQLCODE = -904                                  41450074
414600             WHEN SQLCODE = -911                                  41460074
414700             WHEN SQLCODE = -913                                  41470074
414800                  PERFORM 9900-SOFT-ABORT                         41480074
414900             WHEN SQLCODE = +100                                  41490074
415000             WHEN SQLCODE = -305                                  41500074
415100                  MOVE +0  TO PV-AP-VERIFY-ITM-QTY                41510074
415200             WHEN OTHER                                           41520074
415300                  MOVE '4330-GET-VERIFY-QTY'                      41530074
415400                                   TO DP013-PARAGRAPH             41540074
415500                  MOVE 'SELECT TRECDIS'                           41550074
415600                                   TO DP013-MESSAGE-TEXT (1)      41560074
415700                  MOVE SQLCA       TO DP013-SQLCA                 41570074
415800                  PERFORM 9950-FORMAT-ERROR-MSG                   41580074
415900                  SET DP013-DB2-ABEND                             41590074
416000                                   TO TRUE                        41600074
416100                  PERFORM DP013-0000-PROCESS-ABEND                41610074
416200         END-EVALUATE.                                            41620074
416300                                                                  41630074
416400/                                                                 41640074
416500*----------------------------------------------------------------*41650074
416600* CALCULATES THE HEADER AND TOTAL LINES AND MOVES THEM TO        *41660074
416700* ASC FIELDS.                                                    *41670074
416800*----------------------------------------------------------------*41680074
416900 4340-MOVE-HEAD-N-TOT-TO-COMM.                                    41690074
417000                                                                  41700074
417100     IF DK-PACK-ID = 99                                           41710074
417200        MOVE 'MISSING PO PACK INFO'    TO ASC-PACK-DESC           41720074
417300     ELSE                                                         41730074
417400        MOVE POPRPK-PREPK-DESC         TO ASC-PACK-DESC.          41740074
417500                                                                  41750074
417600*      GET TOTAL INFORMATION                                      41760074
417700     PERFORM 4440-DETERMINE-TOTALS.                               41770074
417800     PERFORM 4450-DETERMINE-VERIFY-TOTAL.                         41780074
417900                                                                  41790074
418000     MOVE PV-TOTAL-DTL-RATIO    TO ASC-TOTAL-DTL-RATIO.           41800074
418100     MOVE PV-TOTAL-PO-RATIO     TO ASC-TOTAL-PO-RATIO.            41810074
418200     MOVE PV-TOTAL-PKSL-ITM-QTY TO ASC-TOTAL-PKSL-ITM-QTY.        41820074
418300     MOVE PV-TOTAL-DTL-CK-ITM-QTY                                 41830074
418400                                TO ASC-TOTAL-DTL-CK-ITM-QTY.      41840074
418500     MOVE PV-TOTAL-ODD-UNIT-QTY TO ASC-TOTAL-ODD-UNIT-QTY.        41850074
418600     MOVE PV-TOTAL-PO-RATIO     TO ASC-TOTAL-PO-RATIO.            41860074
418700     MOVE PV-TOTAL-AP-VERIFY-ITM-QTY                              41870074
418800                                TO ASC-TOTAL-AP-VERIFY-ITM-QTY    41880074
418900     MOVE DP277-TOTAL-OTR       TO ASC-TOTAL-OTR.                 41890074
419000                                                                  41900074
419100     IF DP277-PK-OTR-OUT > 0                                      41910074
419200        MOVE DP277-PK-OTR-OUT  TO ASC-OTR-PACK-QTY                41920074
419300     ELSE                                                         41930074
419400        MOVE ZEROES            TO ASC-OTR-PACK-QTY                41940074
419500     END-IF.                                                      41950074
419600                                                                  41960074
419700     PERFORM 5214-RETRIEVE-DRIVER-LINE.                           41970074
419800                                                                  41980074
419900     IF NOT ASC-QUICKCALC-FUNCTION                                41990074
420000        IF RECITM-PREPK-RATO-QTY > 0                              42000074
420100           IF RECITM-DTL-CK-ITM-QTY > 0                           42010074
420200              COMPUTE ASC-EXPD-PACKS-QTY =                        42020074
420300                                  RECITM-DTL-CK-ITM-QTY /         42030074
420400                                  RECITM-PREPK-RATO-QTY           42040074
420500           ELSE                                                   42050074
420600              COMPUTE ASC-EXPD-PACKS-QTY =                        42060074
420700                                  RECITM-PKSL-ITM-QTY /           42070074
420800                                  RECITM-PREPK-RATO-QTY           42080074
420900           END-IF                                                 42090074
421000        ELSE                                                      42100074
421100           MOVE ZEROES         TO ASC-EXPD-PACKS-QTY              42110074
421200        END-IF.                                                   42120074
421300                                                                  42130074
421400                                                                  42140074
421500     MOVE ZEROES               TO ASC-ACT-UNITS-PER-CTN.          42150074
421600*    IF ASC-PKGNG-CDE = "M"                                       42160099
421700*       MOVE ASC-TOTAL-DTL-RATIO                                  42170099
421800*                              TO ASC-ACT-UNITS-PER-CTN           42180099
421900*    ELSE                                                         42190099
422000*       IF ASC-PKGNG-CDE = "I"                                    42200099
422100*          COMPUTE ASC-ACT-UNITS-PER-CTN =                        42210099
422200*                                ASC-TOTAL-DTL-RATIO *            42220099
422300*                                 RECITM-CASE-PACK-QTY            42230099
422400*       END-IF                                                    42240099
422500*    END-IF.                                                      42250099
422600                                                                  42260099
422700     IF ASC-PKGNG-CDE = "I"                                       42270099
422800           COMPUTE ASC-ACT-UNITS-PER-CTN =                        42280099
422900                                 ASC-TOTAL-DTL-RATIO *            42290099
423000                                  RECITM-CASE-PACK-QTY            42300099
423100     ELSE                                                         42310099
423200        IF ASC-PKGNG-CDE = "M"                                    42320099
423300           IF RECITM-CASE-PACK-QTY > 1                            42330099
423400              COMPUTE ASC-ACT-UNITS-PER-CTN =                     42340099
423500                                 ASC-TOTAL-DTL-RATIO *            42350099
423600                                  RECITM-CASE-PACK-QTY            42360099
423700           ELSE                                                   42370099
423800              MOVE ASC-TOTAL-DTL-RATIO                            42380099
423900                                  TO ASC-ACT-UNITS-PER-CTN.       42390099
424000                                                                  42400074
424100*----------------------------------------------------------------*42410074
424200* CHECK TO SEE IF PO/RCVR/LINE HAS BEEN PROCESSED THROUGH        *42420074
424300* CASEPACK SPLIT PROCESS                                         *42430074
424400*----------------------------------------------------------------*42440074
424500 4350-CK-CASEPACK-SPLIT-PROCESS.                                  42450074
424600     EXEC SQL                                                     42460074
424700        SELECT ORD_NBR                                            42470074
424800              ,RCVR_SEQ_NBR                                       42480074
424900              ,ORD_LNE_NBR                                        42490074
425000              ,SYS_CRE_CDE                                        42500074
425100              ,TOT_CART_CNT                                       42510074
425200        INTO   :DISTHD-ORD-NBR                                    42520074
425300              ,:DISTHD-RCVR-SEQ-NBR                               42530074
425400              ,:DISTHD-ORD-LNE-NBR                                42540074
425500              ,:DISTHD-SYS-CRE-CDE                                42550074
425600              ,:DISTHD-TOT-CART-CNT                               42560074
425700        FROM  TDISTHD                                             42570074
425800        WHERE ORD_NBR        = :DK-ORD-NBR                        42580074
425900          AND RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                   42590074
426000          AND ORD_LNE_NBR    = :DK-LINE-NBR                       42600074
426100*KBW      AND SYS_CRE_CDE    = 'F'                                42610074
426200          AND TOT_CART_CNT   > +0                                 42620074
426300     END-EXEC.                                                    42630074
426400                                                                  42640074
426500     EVALUATE TRUE                                                42650074
426600         WHEN SQLCODE = +0                                        42660074
426700              SET ASC-CASEPACK-SPLIT-YES                          42670074
426800                  (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE            42680074
426900         WHEN SQLCODE = +100                                      42690074
427000              SET ASC-CASEPACK-SPLIT-NO                           42700074
427100                  (ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE            42710074
427200         WHEN SQLCODE = -904                                      42720074
427300         WHEN SQLCODE = -911                                      42730074
427400         WHEN SQLCODE = -913                                      42740074
427500              PERFORM 9900-SOFT-ABORT                             42750074
427600                                                                  42760074
427700         WHEN OTHER                                               42770074
427800              MOVE '4350-CK-CASEPACK-SPLIT-PROCESS'               42780074
427900                              TO DP013-PARAGRAPH                  42790074
428000              MOVE 'UNSUCCESSFUL SELECT ON TDISTHD'               42800074
428100                              TO DP013-MESSAGE-TEXT (1)           42810074
428200              MOVE SQLCA      TO DP013-SQLCA                      42820074
428300              MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)         42830074
428400              PERFORM 9950-FORMAT-ERROR-MSG                       42840074
428500              SET DP013-DB2-ABEND                                 42850074
428600                  DP013-XCTL-DISPLAY-RESTART                      42860074
428700                              TO TRUE                             42870074
428800              PERFORM DP013-0000-PROCESS-ABEND                    42880074
428900     END-EVALUATE.                                                42890074
429000                                                                  42900074
429100                                                                  42910074
429200*----------------------------------------------------------------*42920074
429300* CHECK TO SEE IF PO/RCVR/LINE HAS BEEN PROCESSED THROUGH        *42930074
429400* CASEPACK SPLIT PROCESS                                         *42940074
429500*----------------------------------------------------------------*42950074
429600 4351-CK-CASEPACK-SPLIT-PROCESS.                                  42960074
429700     EXEC SQL                                                     42970074
429800          SELECT                                                  42980074
429900                COUNT(*)                                          42990074
430000          INTO   :PV-TOTAL-CASEPACK   :PV-NULL-IND                43000074
430100          FROM  TRECITM  A                                        43010074
430200               ,TDISTHD  B                                        43020074
430300          WHERE A.ORD_NBR        = :DK-ORD-NBR                    43030074
430400            AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               43040074
430500            AND A.PREPK_ID       = :DK-PACK-ID                    43050074
430600            AND A.OPER_UNT_ID    = :DK-OPR-ID                     43060074
430700            AND A.FCLTY_ID       = :DK-FACT                       43070074
430800            AND B.ORD_NBR        = A.ORD_NBR                      43080074
430900            AND B.RCVR_SEQ_NBR   = A.REC_SEQ_NBR                  43090074
431000            AND B.ORD_LNE_NBR    = A.ORD_LNE_NBR                  43100074
431100            AND B.SYS_CRE_CDE    = 'F'                            43110074
431200            AND B.TOT_CART_CNT   > +0                             43120074
431300     END-EXEC.                                                    43130074
431400                                                                  43140074
431500     EVALUATE TRUE                                                43150074
431600         WHEN SQLCODE = +0                                        43160074
431700              IF PV-TOTAL-CASEPACK > 0                            43170074
431800                 SET ASC-CASEPACK-YES         TO TRUE             43180074
431900              ELSE                                                43190074
432000                 SET ASC-CASEPACK-NO          TO TRUE             43200074
432100              END-IF                                              43210074
432200         WHEN SQLCODE = +100                                      43220074
432300                 SET ASC-CASEPACK-NO          TO TRUE             43230074
432400         WHEN SQLCODE = -904                                      43240074
432500         WHEN SQLCODE = -911                                      43250074
432600         WHEN SQLCODE = -913                                      43260074
432700              PERFORM 9900-SOFT-ABORT                             43270074
432800                                                                  43280074
432900         WHEN OTHER                                               43290074
433000              MOVE '4350-CK-CASEPACK-SPLIT-PROCESS'               43300074
433100                              TO DP013-PARAGRAPH                  43310074
433200              MOVE 'UNSUCCESSFUL SELECT ON TDISTHD'               43320074
433300                              TO DP013-MESSAGE-TEXT (1)           43330074
433400              MOVE SQLCA      TO DP013-SQLCA                      43340074
433500              MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)         43350074
433600              PERFORM 9950-FORMAT-ERROR-MSG                       43360074
433700              SET DP013-DB2-ABEND                                 43370074
433800                  DP013-XCTL-DISPLAY-RESTART                      43380074
433900                              TO TRUE                             43390074
434000              PERFORM DP013-0000-PROCESS-ABEND                    43400074
434100     END-EVALUATE.                                                43410074
434200                                                                  43420074
434300                                                                  43430074
434400*----------------------------------------------------------------*43440074
434500*    GET TRECEIV INFO FOR THE TOP OF THE SCREEN                  *43450074
434600*----------------------------------------------------------------*43460074
434700 4355-GET-TRECEIV-INFO.                                           43470074
434800     EXEC SQL                                                     43480074
434900          SELECT ORD_NBR                                          43490074
435000                ,REC_SEQ_NBR                                      43500074
435100                ,STATUS_CDE                                       43510074
435200                ,EXPTED_CART_CNT                                  43520074
435300                ,ACTL_CART_CNT                                    43530074
435400                ,PKGNG_CDE                                        43540074
435500          INTO   :RECEIV-ORD-NBR                                  43550074
435600                ,:RECEIV-REC-SEQ-NBR                              43560074
435700                ,:RECEIV-STATUS-CDE                               43570074
435800                ,:RECEIV-EXPTED-CART-CNT                          43580074
435900                ,:RECEIV-ACTL-CART-CNT                            43590074
436000                ,:RECEIV-PKGNG-CDE                                43600074
436100                                                                  43610074
436200          FROM  TRECEIV                                           43620074
436300          WHERE ORD_NBR        = :DK-ORD-NBR                      43630074
436400            AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                 43640074
436500            AND OPER_UNT_ID    = :DK-OPR-ID                       43650074
436600            AND FCLTY_ID       = :DK-FACT                         43660074
436700            AND VER_STATUS_CDE = 'A'                              43670074
436800     END-EXEC.                                                    43680074
436900                                                                  43690074
437000     EVALUATE TRUE                                                43700074
437100         WHEN SQLCODE = +0                                        43710074
437200         WHEN SQLCODE = +100                                      43720074
437300              CONTINUE                                            43730074
437400         WHEN SQLCODE = -904                                      43740074
437500         WHEN SQLCODE = -911                                      43750074
437600         WHEN SQLCODE = -913                                      43760074
437700              PERFORM 9900-SOFT-ABORT                             43770074
437800                                                                  43780074
437900         WHEN OTHER                                               43790074
438000              MOVE '4355-GET-TRECIEV-INFO'                        43800074
438100                              TO DP013-PARAGRAPH                  43810074
438200              MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'               43820074
438300                              TO DP013-MESSAGE-TEXT (1)           43830074
438400              MOVE SQLCA      TO DP013-SQLCA                      43840074
438500              MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)         43850074
438600              PERFORM 9950-FORMAT-ERROR-MSG                       43860074
438700              SET DP013-DB2-ABEND                                 43870074
438800                  DP013-XCTL-DISPLAY-RESTART                      43880074
438900                              TO TRUE                             43890074
439000              PERFORM DP013-0000-PROCESS-ABEND                    43900074
439100     END-EVALUATE.                                                43910074
439200                                                                  43920074
439300/                                                                 43930074
439400*----------------------------------------------------------------*43940074
439500*    GET TPURCHS INFO FOR THE TOP OF THE SCREEN                  *43950074
439600*----------------------------------------------------------------*43960074
439700 4360-GET-TPURCHS-INFO.                                           43970074
439800                                                                  43980074
439900     IF DK-PACK-ID = 99                                           43990074
440000        EXEC SQL                                                  44000074
440100            SELECT A.PO_NBR                                       44010074
440200                  ,A.DEPT_NBR                                     44020074
440300                  ,A.PKGNG_CDE                                    44030074
440400            INTO   :PURCHS-PO-NBR                                 44040074
440500                  ,:PURCHS-DEPT-NBR                               44050074
440600                  ,:PURCHS-PKGNG-CDE                              44060074
440700            FROM  TPURCHS A                                       44070074
440800            WHERE A.PO_NBR         = :DK-ORD-NBR                  44080074
440900              AND A.VER_STATUS_CDE = 'A'                          44090074
441000        END-EXEC                                                  44100074
441100     ELSE                                                         44110074
441200        EXEC SQL                                                  44120074
441300            SELECT A.PO_NBR                                       44130074
441400                  ,A.DEPT_NBR                                     44140074
441500                  ,A.PKGNG_CDE                                    44150074
441600                  ,B.OTPK_UNT_QTY                                 44160074
441700                  ,B.PREPK_DESC                                   44170074
441800            INTO   :PURCHS-PO-NBR                                 44180074
441900                  ,:PURCHS-DEPT-NBR                               44190074
442000                  ,:PURCHS-PKGNG-CDE                              44200074
442100                  ,:POPRPK-OTPK-UNT-QTY                           44210074
442200                  ,:POPRPK-PREPK-DESC                             44220074
442300            FROM  TPURCHS A                                       44230074
442400                 ,TPOPRPK B                                       44240074
442500            WHERE A.PO_NBR         = :DK-ORD-NBR                  44250074
442600              AND A.VER_STATUS_CDE = 'A'                          44260074
442700              AND B.PO_NBR         = A.PO_NBR                     44270074
442800              AND B.PO_PREPK_ID    = :DK-PACK-ID                  44280074
442900        END-EXEC.                                                 44290074
443000                                                                  44300074
443100     EVALUATE TRUE                                                44310074
443200         WHEN SQLCODE = +0                                        44320074
443300              MOVE POPRPK-OTPK-UNT-QTY                            44330074
443400                          TO ASC-PO-UNITS-PER-CTN                 44340074
443500         WHEN SQLCODE = +100                                      44350074
443600              MOVE +0     TO ASC-PO-UNITS-PER-CTN                 44360074
443700         WHEN SQLCODE = -904                                      44370074
443800         WHEN SQLCODE = -911                                      44380074
443900         WHEN SQLCODE = -913                                      44390074
444000              PERFORM 9900-SOFT-ABORT                             44400074
444100                                                                  44410074
444200         WHEN OTHER                                               44420074
444300              MOVE '4360-GET-TPURCHS-INFO'                        44430074
444400                              TO DP013-PARAGRAPH                  44440074
444500              MOVE 'UNSUCCESSFUL SELECT ON TPURCHS'               44450074
444600                              TO DP013-MESSAGE-TEXT (1)           44460074
444700              MOVE SQLCA      TO DP013-SQLCA                      44470074
444800              PERFORM 9950-FORMAT-ERROR-MSG                       44480074
444900              MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)         44490074
445000              SET DP013-DB2-ABEND                                 44500074
445100                  DP013-XCTL-DISPLAY-RESTART                      44510074
445200                              TO TRUE                             44520074
445300              PERFORM DP013-0000-PROCESS-ABEND                    44530074
445400     END-EVALUATE.                                                44540074
445500                                                                  44550074
445600                                                                  44560074
445700/                                                                 44570074
445800*----------------------------------------------------------------*44580074
445900*    GET TPURCHS INFO FOR THE TOP OF THE SCREEN                  *44590074
446000*----------------------------------------------------------------*44600074
446100 4370-FIND-LINE-TROUBLE.                                          44610074
446200     EXEC SQL                                                     44620074
446300         SELECT B.TRBL_SHT_DESC                                   44630074
446400         INTO :TRBRSN-TRBL-SHT-DESC                               44640074
446500         FROM TTRBNTF A                                           44650074
446600             ,TTRBRSN B                                           44660074
446700         WHERE A.PO_NBR               = :DK-ORD-NBR               44670074
446800               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          44680074
446900               AND A.PO_LNE_NBR       = :DK-LINE-NBR              44690074
447000               AND A.OPER_UNT_ID      = :DK-OPR-ID                44700074
447100               AND A.FCLTY_ID         = :DK-FACT                  44710074
447200               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               44720074
447300               AND A.TRBL_RSN_CDE     = B.TRBL_RSN_CDE            44730074
447400     END-EXEC.                                                    44740074
447500                                                                  44750074
447600     EVALUATE TRUE                                                44760074
447700         WHEN SQLCODE = ZERO                                      44770074
447800         WHEN SQLCODE = -811                                      44780074
447900             CONTINUE                                             44790074
448000         WHEN SQLCODE = +100                                      44800074
448100             MOVE SPACES TO TRBRSN-TRBL-SHT-DESC                  44810074
448200         WHEN SQLCODE = -904                                      44820074
448300         WHEN SQLCODE = -911                                      44830074
448400         WHEN SQLCODE = -913                                      44840074
448500              PERFORM 9900-SOFT-ABORT                             44850074
448600                                                                  44860074
448700         WHEN OTHER                                               44870074
448800             MOVE '4370-FIND-LINE-TROUBLE'                        44880074
448900                             TO DP013-PARAGRAPH                   44890074
449000             MOVE 'SELECT ON TTRBNTF'                             44900074
449100                             TO DP013-MESSAGE-TEXT (1)            44910074
449200             MOVE SQLCA          TO DP013-SQLCA                   44920074
449300             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      44930074
449400             PERFORM 9950-FORMAT-ERROR-MSG                        44940074
449500             SET DP013-XCTL-DISPLAY-RESTART                       44950074
449600                 DP013-DB2-ABEND                                  44960074
449700                             TO TRUE                              44970074
449800             PERFORM DP013-0000-PROCESS-ABEND                     44980074
449900     END-EVALUATE.                                                44990074
450000                                                                  45000074
450100     MOVE ZERO                    TO PV-UNRSLVD-TRBL-COUNT        45010074
450200                                     PV-RSLVD-TRBL-COUNT.         45020074
450300     EXEC SQL                                                     45030074
450400         SELECT COUNT(*)                                          45040074
450500         INTO :PV-UNRSLVD-TRBL-COUNT                              45050074
450600         FROM TTRBNTF A                                           45060074
450700         WHERE A.PO_NBR               = :DK-ORD-NBR               45070074
450800               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          45080074
450900               AND A.PO_LNE_NBR       = :DK-LINE-NBR              45090074
451000               AND A.OPER_UNT_ID      = :DK-OPR-ID                45100074
451100               AND A.FCLTY_ID         = :DK-FACT                  45110074
451200               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               45120074
451300     END-EXEC                                                     45130074
451400     EVALUATE TRUE                                                45140074
451500         WHEN SQLCODE = ZERO                                      45150074
451600         WHEN SQLCODE = +100                                      45160074
451700             CONTINUE                                             45170074
451800         WHEN SQLCODE = -904                                      45180074
451900         WHEN SQLCODE = -911                                      45190074
452000         WHEN SQLCODE = -913                                      45200074
452100              PERFORM 9900-SOFT-ABORT                             45210074
452200                                                                  45220074
452300         WHEN OTHER                                               45230074
452400             MOVE '4370-FIND-LINE-TROUBLE'                        45240074
452500                             TO DP013-PARAGRAPH                   45250074
452600             MOVE 'SELECT ON TTRBNTF'                             45260074
452700                             TO DP013-MESSAGE-TEXT (1)            45270074
452800             MOVE SQLCA          TO DP013-SQLCA                   45280074
452900             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      45290074
453000             PERFORM 9950-FORMAT-ERROR-MSG                        45300074
453100             SET DP013-DB2-ABEND                                  45310074
453200                 DP013-XCTL-DISPLAY-RESTART                       45320074
453300                             TO TRUE                              45330074
453400             PERFORM DP013-0000-PROCESS-ABEND                     45340074
453500     END-EVALUATE.                                                45350074
453600                                                                  45360074
453700     IF PV-UNRSLVD-TRBL-COUNT = ZERO AND SQLCODE = ZERO OR +100   45370074
453800         EXEC SQL                                                 45380074
453900             SELECT COUNT(*)                                      45390074
454000             INTO :PV-RSLVD-TRBL-COUNT                            45400074
454100             FROM TTRBNTF A                                       45410074
454200                , TTRBRSN B                                       45420074
454300             WHERE A.PO_NBR           = :DK-ORD-NBR               45430074
454400                   AND A.REC_SEQ_NBR  = :DK-RCVR-SEQ-NBR          45440074
454500                   AND A.PO_LNE_NBR   = :DK-LINE-NBR              45450074
454600                   AND A.RESOLVED_IND = :PC-R                     45460074
454700                   AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE            45470074
454800                   AND A.OPER_UNT_ID  = :DK-OPR-ID                45480074
454900                   AND A.FCLTY_ID     = :DK-FACT                  45490074
455000                   AND B.NOTIF_IND    = :PC-T                     45500074
455100         END-EXEC                                                 45510074
455200                                                                  45520074
455300         EVALUATE TRUE                                            45530074
455400             WHEN SQLCODE = ZERO                                  45540074
455500             WHEN SQLCODE = +100                                  45550074
455600                 CONTINUE                                         45560074
455700             WHEN SQLCODE = -904                                  45570074
455800             WHEN SQLCODE = -911                                  45580074
455900             WHEN SQLCODE = -913                                  45590074
456000                  PERFORM 9900-SOFT-ABORT                         45600074
456100                                                                  45610074
456200             WHEN OTHER                                           45620074
456300                 MOVE '4370-FIND-LINE-TROUBLE'                    45630074
456400                                 TO DP013-PARAGRAPH               45640074
456500                 MOVE 'SELECT ON TTRBNTF - TTRBRSN'               45650074
456600                                 TO DP013-MESSAGE-TEXT (1)        45660074
456700                 MOVE SQLCA      TO DP013-SQLCA                   45670074
456800                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      45680074
456900                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      45690074
457000                 PERFORM 9950-FORMAT-ERROR-MSG                    45700074
457100                 SET DP013-DB2-ABEND                              45710074
457200                                 TO TRUE                          45720074
457300                 SET DP013-XCTL-DISPLAY-RESTART                   45730074
457400                                 TO TRUE                          45740074
457500                 PERFORM DP013-0000-PROCESS-ABEND                 45750074
457600         END-EVALUATE                                             45760074
457700     END-IF.                                                      45770074
457800                                                                  45780074
457900*----------------------------------------------------------------*45790074
458000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *45800074
458100*----------------------------------------------------------------*45810074
458200 4400-MOVE-COMMAREA-TO-SCREEN.                                    45820074
458300                                                                  45830074
458400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             45840074
458500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          45850074
458600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          45860074
458700             MOVE +1               TO ASC-BLK-SUB                 45870074
458800             PERFORM 5100-WRITE-TEMP-STORAGE                      45880074
458900             ADD +1                TO ASC-BLK-SUB                 45890074
459000             PERFORM 5100-WRITE-TEMP-STORAGE                      45900074
459100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             45910074
459200                 GIVING PV-BLOCK-NUMBER                           45920074
459300                 REMAINDER PV-REMAINDER                           45930074
459400             IF  PV-REMAINDER > ZERO                              45940074
459500                 ADD +1            TO PV-BLOCK-NUMBER             45950074
459600             END-IF                                               45960074
459700             MOVE +1               TO ASC-BLK-SUB                 45970074
459800             PERFORM 4410-READ-TEMP-STORAGE                       45980074
459900             ADD +1                TO ASC-BLK-SUB                 45990074
460000                                      PV-BLOCK-NUMBER             46000074
460100             PERFORM 4410-READ-TEMP-STORAGE                       46010074
460200     END-IF.                                                      46020074
460300                                                                  46030074
460400     MOVE +1                       TO ASC-BLK-SUB.                46040074
460500                                                                  46050074
460600     COMPUTE ASC-ITEM-SUB =                                       46060074
460700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              46070074
460800         + PC-ITEMS-PER-PANEL).                                   46080074
460900                                                                  46090074
461000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        46100074
461100         ADD +1                    TO ASC-BLK-SUB                 46110074
461200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            46120074
461300     END-IF.                                                      46130074
461400                                                                  46140074
461500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           46150074
461600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                46160074
461700                                                                  46170074
461800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        46180074
461900     PERFORM 4420-FORMAT-LIST-LINES                               46190074
462000         VARYING PV-SUB                                           46200074
462100         FROM PC-ITEMS-PER-PANEL BY -1                            46210074
462200         UNTIL PV-SUB < +1.                                       46220074
462300                                                                  46230074
462400     COMPUTE ASC-ITEMS-DISPLAYED =                                46240074
462500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          46250074
462600                                                                  46260074
462700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    46270074
462800                                      ASTRTITO.                   46280074
462900     PERFORM 4403-MOVE-HEADER-TO-SCREEN.                          46290074
463000     PERFORM 4405-MOVE-TOTALS-TO-SCREEN.                          46300074
463100                                                                  46310074
463200     IF  DP020-MSG-NUMBER-X = SPACE                               46320074
463300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  46330074
463400*            --- MORE ITEMS TO DISPLAY ----                       46340074
463500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            46350074
463600             SET DP020-MSG-INFORMATIONAL                          46360074
463700                                   TO TRUE                        46370074
463800         END-IF                                                   46380074
463900     END-IF.                                                      46390074
464000                                                                  46400074
464100*----------------------------------------------------------------*46410074
464200*    MOVES HEADER AND TOTAL DATA TO THE SCREEN                   *46420074
464300*----------------------------------------------------------------*46430074
464400 4403-MOVE-HEADER-TO-SCREEN.                                      46440074
464500                                                                  46450074
464600     MOVE ASC-REC-NBR                  TO ARCNBRO.                46460074
464700     MOVE ASC-REC-SEQ-NBR              TO ARCSEQO.                46470074
464800     MOVE ASC-REC-STAT                 TO ARCSTATO.               46480074
464900     MOVE ASC-PACK-DESC                TO APKDESCO.               46490074
465000                                                                  46500074
465100     PERFORM 4460-GET-VENDOR-NAME                                 46510074
465200     MOVE ENTNME-ENT-NAME-DESC         TO AVENNMEO                46520074
465300                                      ASC-TPURITM-VEND-STYL-NAME. 46530074
465400                                                                  46540074
465500     EVALUATE TRUE                                                46550074
465600         WHEN ASC-PKGNG-CDE = PC-M                                46560074
465700             MOVE PC-MULTIPLE-SKU-PPK  TO APKGTYPO                46570074
465800         WHEN ASC-PKGNG-CDE = PC-I                                46580074
465900             MOVE PC-INNER-PPK         TO APKGTYPO                46590074
466000         WHEN ASC-PKGNG-CDE = PC-X                                46600074
466100             MOVE PC-PKG-NOT-FOUND     TO APKGTYPO                46610074
466200      END-EVALUATE.                                               46620074
466300*----------------------------------------------------------------*46630074
466400*                                             WR # 230ZZ         *46640074
466500* ADDED CODE TO MOVE PV-REC-LINE-STATUS  TO MAP VARIABLE.        *46650074
466600*----------------------------------------------------------------*46660074
466700                                                                  46670074
466800     MOVE ASC-PACK-ID                 TO APKGIDO.                 46680074
466900     MOVE ASC-PO-UNITS-PER-CTN        TO APOUNTO.                 46690074
467000     MOVE ASC-REC-TROUBLE-RSN         TO ATRBLO.                  46700074
467100     MOVE ASC-DEPT                    TO ADPTNOO.                 46710074
467200*----------------------------------------------------------------*46720074
467300     IF ASC-DISPLAY-STATUS = SPACES                               46730074
467400        MOVE SPACES                     TO PV-REC-LINE-STATUS     46740074
467500        IF PV-FOUND-LINE-STATUS-IP = 'Y'                          46750074
467600            MOVE 'IP'                   TO PV-REC-LINE-STATUS     46760074
467700         ELSE                                                     46770074
467800            IF PV-FOUND-LINE-STATUS-CM = 'Y'                      46780074
467900               MOVE      'CM'           TO PV-REC-LINE-STATUS     46790074
468000            ELSE                                                  46800074
468100              IF PV-FOUND-LINE-STATUS-VE = 'Y'                    46810074
468200                 MOVE      'VE'         TO PV-REC-LINE-STATUS     46820074
468300              END-IF                                              46830074
468400            END-IF                                                46840074
468500         END-IF                                                   46850074
468600        MOVE PV-REC-LINE-STATUS       TO ASC-DISPLAY-STATUS       46860074
468700     END-IF.                                                      46870074
468800                                                                  46880074
468900     MOVE ASC-DISPLAY-STATUS          TO ASTTO.                   46890074
469000                                                                  46900074
469100*----------------------------------------------------------------*46910074
469200* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *46920074
469300*----------------------------------------------------------------*46930074
469400     MOVE ASC-ITEM-AT-BOT-OF-PANEL    TO AENDITO.                 46940074
469500     MOVE ASC-NUMBER-OF-ITEMS-READ    TO ATOTITO.                 46950074
469600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            46960074
469700                                      TO ASELITO.                 46970074
469800                                                                  46980074
469900     MOVE ASC-OTR-PACK-QTY            TO APKOTRO.                 46990074
470000     MOVE ASC-EXPD-PACKS-QTY          TO AEXPKO.                  47000074
470100     MOVE ASC-ACT-UNITS-PER-CTN       TO AACTUNO                  47010074
470200     MOVE ASC-OTR-PACK-QTY            TO APKOTRO.                 47020074
470300                                                                  47030074
470400     IF ASC-QUICKCALC-FUNCTION AND                                47040074
470500        PS-NO-ERROR                                               47050074
470600        MOVE DP015-RED                TO AEXPKC                   47060074
470700                                         AACTUNC                  47070074
470800                                         ABCPCKC                  47080074
470900        MOVE DP015-REVERSE            TO AEXPKH                   47090074
471000                                         AACTUNH                  47100074
471100                                         ABCPCKH                  47110074
471200     ELSE                                                         47120074
471300        MOVE DP015-BLUE               TO AEXPKC                   47130074
471400                                         AACTUNC                  47140074
471500                                         ABCPCKC                  47150074
471600        MOVE DP015-HL-OFF             TO AEXPKH                   47160074
471700                                         AACTUNH                  47170074
471800                                         ABCPCKH                  47180074
471900     END-IF.                                                      47190074
472000                                                                  47200074
472100*----------------------------------------------------------------*47210074
472200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *47220074
472300*----------------------------------------------------------------*47230074
472400 4405-MOVE-TOTALS-TO-SCREEN.                                      47240074
472500                                                                  47250074
472600     MOVE ASC-TOTAL-OTR               TO ATOTRO.                  47260074
472700     MOVE ASC-TOTAL-PO-RATIO          TO ATPORTO.                 47270074
472800     MOVE ASC-TOTAL-DTL-RATIO         TO ATDTRTO.                 47280074
472900     MOVE ASC-TOTAL-PKSL-ITM-QTY      TO ATPKSLO.                 47290074
473000     MOVE ASC-TOTAL-BEST-CASE-UNITS   TO ATBESTO.                 47300074
473100     MOVE ASC-TOTAL-DTL-CK-ITM-QTY    TO ATDTLO.                  47310074
473200     MOVE ASC-TOTAL-ODD-UNIT-QTY      TO ATODDO.                  47320074
473300     MOVE ASC-TOTAL-AP-VERIFY-ITM-QTY TO ATVERFO.                 47330074
473400                                                                  47340074
473500     IF ASC-QUICKCALC-FUNCTION                                    47350074
473600        MOVE ASC-BEST-CASE-PACKS      TO ABCPCKO                  47360074
473700     ELSE                                                         47370074
473800        IF ASC-PREV-BEST-CASE-PACKS > ZERO                        47380074
473900           MOVE ASC-PREV-BEST-CASE-PACKS                          47390074
474000                                      TO ABCPCKO                  47400074
474100        ELSE                                                      47410074
474200           MOVE ASC-BEST-CASE-PACKS   TO ABCPCKO.                 47420074
474300                                                                  47430074
474400                                                                  47440074
474500                                                                  47450074
474600*----------------------------------------------------------------*47460074
474700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *47470074
474800*----------------------------------------------------------------*47480074
474900 4410-READ-TEMP-STORAGE.                                          47490074
475000                                                                  47500074
475100     EXEC CICS                                                    47510074
475200         READQ TS                                                 47520074
475300             QUEUE (ASC-LIST-QUEUE-NAME)                          47530074
475400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               47540074
475500             ITEM  (PV-BLOCK-NUMBER)                              47550074
475600             RESP  (PV-CICS-RESP)                                 47560074
475700     END-EXEC.                                                    47570074
475800                                                                  47580074
475900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       47590074
476000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     47600074
476100         CONTINUE                                                 47610074
476200     ELSE                                                         47620074
476300         SET DP013-CICS-ABEND      TO TRUE                        47630074
476400         SET DP013-NO-ROLLBACK     TO TRUE                        47640074
476500         MOVE '4410-READ-TEMP-STORAGE'                            47650074
476600                                   TO DP013-PARAGRAPH             47660074
476700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      47670074
476800                                   TO DP013-MESSAGE-TEXT(1)       47680074
476900         PERFORM DP013-0000-PROCESS-ABEND                         47690074
477000     END-IF.                                                      47700074
477100                                                                  47710074
477200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         47720074
477300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               47730074
477400     END-IF.                                                      47740074
477500                                                                  47750074
477600/                                                                 47760074
477700*----------------------------------------------------------------*47770074
477800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *47780074
477900*----------------------------------------------------------------*47790074
478000 4420-FORMAT-LIST-LINES.                                          47800074
478100                                                                  47810074
478200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      47820074
478300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                47830074
478400         MOVE DP015-HL-OFF         TO MR-SELECTH (PV-SUB)         47840074
478500         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         47850074
478600                                      MR-DTL-PACK-RATIOA  (PV-SUB)47860074
478700                                      MR-DTL-PACK-UNITSA  (PV-SUB)47870074
478800         MOVE SPACES               TO MR-SELECT           (PV-SUB)47880074
478900                                      MR-SKU-SEQ-NBR      (PV-SUB)47890074
479000                                      MR-LINE             (PV-SUB)47900074
479100                                      MR-OTR-PACK-UNITS   (PV-SUB)47910074
479200                                      MR-PKSL-PACK-UNITS  (PV-SUB)47920074
479300                                      MR-DTL-PACK-UNITS   (PV-SUB)47930074
479400                                      MR-VRFD-PACK-UNITS  (PV-SUB)47940074
479500                                      MR-PO-PACK-RATIO    (PV-SUB)47950074
479600                                      MR-DTL-PACK-RATIO   (PV-SUB)47960074
479700                                      MR-ODD-PACK-UNITS   (PV-SUB)47970074
479800                                      MR-BEST-CASE-UNITS  (PV-SUB)47980074
479900                                      MR-PERCENT-VARIANCE (PV-SUB)47990074
480000                                      MR-PER-VAR-SIGN     (PV-SUB)48000074
480100     ELSE                                                         48010074
480200         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      48020074
480300                                                   > SPACE        48030074
480400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 48040074
480500                                   TO MR-SELECT (PV-SUB)          48050074
480600         ELSE                                                     48060074
480700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      48070074
480800                                   TO MR-SELECT (PV-SUB)          48080074
480900         END-IF                                                   48090074
481000                                                                  48100074
481100                                                                  48110074
481200         IF ASC-QTY-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)              48120074
481300              MOVE -1           TO MR-DTL-PACK-UNITSL  (PV-SUB)   48130074
481400              MOVE DP015-RED    TO MR-DTL-PACK-UNITSC  (PV-SUB)   48140074
481500              MOVE DP015-REVERSE                                  48150074
481600                                TO MR-DTL-PACK-UNITSH  (PV-SUB)   48160074
481700         ELSE                                                     48170074
481800         IF ASC-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)             48180074
481900            MOVE -1              TO MR-DTL-PACK-RATIOL  (PV-SUB)  48190074
482000            MOVE DP015-RED       TO MR-DTL-PACK-RATIOC  (PV-SUB)  48200074
482100            MOVE DP015-REVERSE   TO MR-DTL-PACK-RATIOH  (PV-SUB)  48210074
482200         ELSE                                                     48220074
482300         IF ASC-QUICKCALC-FUNCTION     AND                        48230074
482400            ASC-QC-HIGHLIGHT (ASC-BLK-SUB ASC-ITEM-SUB)           48240074
482500            MOVE -1              TO MR-DTL-PACK-RATIOL  (PV-SUB)  48250074
482600            MOVE DP015-RED       TO MR-DTL-PACK-RATIOC  (PV-SUB)  48260074
482700            MOVE DP015-REVERSE   TO MR-DTL-PACK-RATIOH  (PV-SUB)  48270074
482800         ELSE                                                     48280074
482900         IF ((ASC-QUICKCALC-FUNCTION     AND                      48290074
483000            ASC-QC-NO-HIGHLIGHT (ASC-BLK-SUB ASC-ITEM-SUB)) OR    48300074
483100            ASC-QUICKCALC-FUNCTION-SW = SPACES)                   48310074
483200            MOVE DP015-UNP-NUM-NOR-OFF                            48320074
483300                                 TO MR-DTL-PACK-RATIOA  (PV-SUB)  48330074
483400            MOVE DP015-GREEN     TO MR-DTL-PACK-RATIOC  (PV-SUB)  48340074
483500            MOVE DP015-UNDERLINE TO MR-DTL-PACK-RATIOH  (PV-SUB)  48350074
483600                                                                  48360074
483700         END-IF                                                   48370074
483800         END-IF                                                   48380074
483900         END-IF                                                   48390074
484000         END-IF                                                   48400074
484100                                                                  48410074
484200         IF  DP030-SET-CURSOR-TRAILER                             48420074
484300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)48430074
484400                 > SPACE)                                         48440074
484500               OR (PV-SUB = 1))                                   48450074
484600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               48460074
484700                MOVE -1            TO MR-SELECTL (PV-SUB)         48470074
484800             END-IF                                               48480074
484900         END-IF                                                   48490074
485000                                                                  48500074
485100*  QUICKCALC FUNCTION REQUIRES THAT THE SCREEN BE REDISPLAYED     48510074
485200*  IF THERE ARE NO ERRORS.  THIS IS MAINLY FOR ALL OF THE         48520074
485300*  CALCULATED FIELDS.                                             48530074
485400         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL  OR        48540074
485500            (ASC-QUICKCALC-FUNCTION AND                           48550074
485600             PS-NO-ERROR)                                         48560074
485700             MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)      48570074
485800                                 TO MR-LINE-N (PV-SUB)            48580074
485900             MOVE ASC-SKU-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB)      48590074
486000                                 TO MR-SKU-SEQ-NBR (PV-SUB)       48600074
486100             MOVE ASC-PKSL-PACK-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)  48610074
486200                                 TO MR-PKSL-PACK-UNITS-N (PV-SUB) 48620074
486300             MOVE ASC-ODD-PACK-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)   48630074
486400                                 TO MR-ODD-PACK-UNITS-N (PV-SUB)  48640074
486500             MOVE ASC-DTL-PACK-RATIO-N (ASC-BLK-SUB ASC-ITEM-SUB) 48650074
486600                                 TO  MR-DTL-PACK-RATIO-N (PV-SUB) 48660074
486700             MOVE ASC-PO-PACK-RATIO (ASC-BLK-SUB ASC-ITEM-SUB)    48670074
486800                                 TO MR-PO-PACK-RATIO-N (PV-SUB)   48680074
486900             MOVE ASC-BEST-CASE-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)  48690074
487000                                 TO MR-BEST-CASE-UNITS-N (PV-SUB) 48700074
487100             MOVE ASC-PERCENT-VARIANCE (ASC-BLK-SUB ASC-ITEM-SUB) 48710074
487200                                 TO MR-PERCENT-VARIANCE-N (PV-SUB)48720074
487300                                                                  48730074
487400             IF ASC-PERCENT-VARIANCE (ASC-BLK-SUB ASC-ITEM-SUB)   48740074
487500                                     = ZERO                       48750074
487600                     MOVE ' '    TO MR-PER-VAR-SIGN (PV-SUB)      48760074
487700             ELSE                                                 48770074
487800                EVALUATE TRUE                                     48780074
487900                   WHEN ASC-VARIANCE-OVER                         48790074
488000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48800074
488100                     MOVE '+'    TO MR-PER-VAR-SIGN (PV-SUB)      48810074
488200                   WHEN ASC-VARIANCE-UNDER                        48820074
488300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48830074
488400                     MOVE '-'    TO MR-PER-VAR-SIGN (PV-SUB)      48840074
488500                   WHEN OTHER                                     48850074
488600                     MOVE ' '    TO MR-PER-VAR-SIGN (PV-SUB)      48860074
488700                END-EVALUATE                                      48870074
488800             END-IF                                               48880074
488900                                                                  48890074
489000             IF ASC-REC-LINE-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)    48900074
489100                                                      NOT = PC-VE 48910074
489200             EVALUATE TRUE                                        48920074
489300                 WHEN ASC-LINE-IN-TROUBLE                         48930074
489400                               (ASC-BLK-SUB ASC-ITEM-SUB)         48940074
489500                     MOVE DP015-YELLOW                            48950074
489600                                 TO MR-SKU-SEQ-NBRC (PV-SUB)      48960074
489700                 WHEN ASC-LINE-DISTRO-TRBL                        48970074
489800                               (ASC-BLK-SUB ASC-ITEM-SUB)         48980074
489900                    MOVE DP015-PINK                               48990074
490000                                 TO MR-SKU-SEQ-NBRC (PV-SUB)      49000074
490100                 WHEN OTHER                                       49010074
490200                     MOVE DP015-BLUE                              49020074
490300                                 TO MR-SKU-SEQ-NBRC (PV-SUB)      49030074
490400             END-EVALUATE                                         49040074
490500             END-IF                                               49050074
490600                                                                  49060074
490700             MOVE ASC-OTR-PACK-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)   49070074
490800                                 TO MR-OTR-PACK-UNITS   (PV-SUB)  49080074
490900                                                                  49090074
491000             MOVE ASC-PKSL-PACK-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)  49100074
491100                                 TO MR-PKSL-PACK-UNITS-N (PV-SUB) 49110074
491200                                                                  49120074
491300             MOVE +0             TO PV-TEMP-DTL-UNITS             49130074
491400             MOVE ASC-DTL-PACK-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) 49140074
491500                                 TO PV-TEMP-DTL-UNITS             49150074
491600             IF PV-TEMP-DTL-UNITS  > 0                            49160074
491700                MOVE PV-TEMP-DTL-UNITS                            49170074
491800                                 TO MR-DTL-PACK-UNITS-N (PV-SUB)  49180074
491900             ELSE                                                 49190074
492000                MOVE SPACES      TO MR-DTL-PACK-UNITS (PV-SUB)    49200074
492100             END-IF                                               49210074
492200                                                                  49220074
492300             MOVE ASC-VRFD-PACK-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)  49230074
492400                                 TO MR-VRFD-PACK-UNITS-N (PV-SUB) 49240074
492500         END-IF                                                   49250074
492600     END-IF.                                                      49260074
492700                                                                  49270074
492800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               49280074
492900                                                                  49290074
493000     IF  ASC-ITEM-SUB < + 1                                       49300074
493100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                49310074
493200         MOVE +1                   TO ASC-BLK-SUB                 49320074
493300     END-IF.                                                      49330074
493400                                                                  49340074
493500                                                                  49350074
493600*----------------------------------------------------------------*49360074
493700*  CALL THE PACK VALIDATION MODULE TO VALIDATE THE RATIO THAT    *49370074
493800*  WAS ENTERED, DETERMINE BEST CASE, ODD UNITS, AND % VARIANCE.  *49380074
493900*----------------------------------------------------------------*49390074
494000 4421-LOAD-VALIDATION-DATA.                                       49400074
494100                                                                  49410074
494200     MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)              49420074
494300                                    TO RC806-PKSL-LNE-NBR         49430074
494400                                        (PV-VALID-IDX).           49440074
494500                                                                  49450074
494600     IF ASC-OTR-PACK-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0 AND   49460074
494700        ASC-OTR-PACK-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) NOT =       49470074
494800                                                 '*****'          49480074
494900        MOVE ASC-OTR-PACK-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)        49490074
495000                                    TO RC806-UNIT-QTY             49500074
495100                                        (PV-VALID-IDX)            49510074
495200     ELSE                                                         49520074
495300        MOVE +0                     TO RC806-UNIT-QTY             49530074
495400                                        (PV-VALID-IDX).           49540074
495500                                                                  49550074
495600      MOVE ASC-DTL-PACK-RATIO-N (ASC-BLK-SUB ASC-ITEM-SUB)        49560074
495700                                    TO RC806-RC-RATIO             49570074
495800                                        (PV-VALID-IDX).           49580074
495900      MOVE ASC-PO-PACK-RATIO (ASC-BLK-SUB ASC-ITEM-SUB)           49590074
496000                                    TO RC806-PO-RATIO             49600074
496100                                        (PV-VALID-IDX).           49610074
496200                                                                  49620074
496300      MOVE ASC-DTL-PACK-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)        49630074
496400                                    TO RC806-RCVG-QTY             49640074
496500                                        (PV-VALID-IDX)            49650074
496600                                       PV-TEMP-DTL-UNITS          49660074
496700      IF PV-TEMP-DTL-UNITS  > 0                                   49670074
496800         SET PV-DTL-CK-UNIT-QTY (PV-VALID-IDX)                    49680074
496900                                    TO TRUE                       49690074
497000      ELSE                                                        49700074
497100         SET PV-PKSL-UNIT-QTY (PV-VALID-IDX)                      49710074
497200                                    TO TRUE                       49720074
497300         MOVE ASC-PKSL-PACK-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)      49730074
497400                                    TO RC806-RCVG-QTY             49740074
497500                                        (PV-VALID-IDX).           49750074
497600                                                                  49760074
497700      ADD +1                        TO PV-VALID-IDX               49770074
497800                                       RC806-NBR-OF-LINES.        49780074
497900                                                                  49790074
498000                                                                  49800074
498100*----------------------------------------------------------------*49810074
498200*  CALL THE PACK VALIDATION MODULE TO VALIDATE THE RATIO THAT    *49820074
498300*  WAS ENTERED, DETERMINE BEST CASE, ODD UNITS, AND % VARIANCE.  *49830074
498400*----------------------------------------------------------------*49840074
498500 4423-CALL-VALIDATION-MODULE.                                     49850074
498600                                                                  49860074
498700     MOVE  +0                       TO ASC-BEST-CASE-PACKS.       49870074
498800                                                                  49880074
498900     MOVE '3' TO RC806-FUNCTION.                                  49890074
499000     IF ASC-PKGNG-CDE = 'I'                                       49900074
499100        MOVE RECITM-CASE-PACK-QTY   TO RC806-INNER-PACK-QTY       49910099
499200     ELSE                                                         49920099
499300        IF ASC-PKGNG-CDE = "M"                                    49930099
499400          IF RECITM-CASE-PACK-QTY > 1                             49940099
499500             MOVE RECITM-CASE-PACK-QTY   TO RC806-INNER-PACK-QTY. 49950099
499600                                                                  49960099
499700                                                                  49970074
499800     PERFORM 4424-LINK-TO-VALIDATION-MODULE.                      49980074
499900                                                                  49990074
500000     IF RC806-NO-ERRORS                                           50000074
500100        MOVE +0                     TO ASC-ITEM-SUB               50010074
500200                                       ASC-TOTAL-BEST-CASE-UNITS  50020074
500300        MOVE +1                     TO ASC-BLK-SUB                50030074
500400                                                                  50040074
500500        PERFORM                                                   50050074
500600          VARYING PV-VALID-IDX                                    50060074
500700          FROM 1 BY 1                                             50070074
500800          UNTIL PV-VALID-IDX > RC806-NBR-OF-LINES                 50080074
500900            OR PV-VALID-IDX  > 500                                50090074
501000                                                                  50100074
501100                                                                  50110074
501200           IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                  50120074
501300                 ADD +1             TO ASC-ITEM-SUB               50130074
501400           ELSE                                                   50140074
501500              PERFORM 5100-WRITE-TEMP-STORAGE                     50150074
501600              MOVE +1               TO ASC-ITEM-SUB               50160074
501700              IF ASC-BLK-SUB < PC-MAX-BLOCKS-IN-ARRAY             50170074
501800                 ADD +1             TO ASC-BLK-SUB                50180074
501900                                       PV-BLOCK-NUMBER            50190074
502000              ELSE                                                50200074
502100                 ADD +1             TO PV-BLOCK-NUMBER            50210074
502200                 PERFORM 5100-WRITE-TEMP-STORAGE                  50220074
502300                 ADD +1             TO PV-BLOCK-NUMBER            50230074
502400                 MOVE +1            TO ASC-BLK-SUB                50240074
502500                 INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)       50250074
502600                 PERFORM 4410-READ-TEMP-STORAGE                   50260074
502700                 ADD +1             TO ASC-BLK-SUB                50270074
502800                                       PV-BLOCK-NUMBER            50280074
502900                 INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)       50290074
503000                 PERFORM 4410-READ-TEMP-STORAGE                   50300074
503100                 MOVE +1            TO ASC-BLK-SUB                50310074
503200              END-IF                                              50320074
503300           END-IF                                                 50330074
503400                                                                  50340074
503500           SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                   50350074
503600                                    TO TRUE                       50360074
503700           IF RC806-VARIANCE-OVER (PV-VALID-IDX)                  50370074
503800              SET ASC-VARIANCE-OVER (ASC-BLK-SUB ASC-ITEM-SUB)    50380074
503900                                    TO TRUE                       50390074
504000           ELSE IF RC806-VARIANCE-UNDER  (PV-VALID-IDX)           50400074
504100               SET ASC-VARIANCE-UNDER (ASC-BLK-SUB ASC-ITEM-SUB)  50410074
504200                                    TO TRUE                       50420074
504300             ELSE                                                 50430074
504400                MOVE ' '            TO ASC-PERCENT-VAR-SIGN-SW    50440074
504500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 50450074
504600             END-IF                                               50460074
504700           END-IF                                                 50470074
504800                                                                  50480074
504900           IF RC806-BEST-CASE-UNITS (PV-VALID-IDX) > 0            50490074
505000              MOVE +0               TO PV-TEMP-BEST-CASE-UNITS    50500074
505100              MOVE RC806-BEST-CASE-UNITS (PV-VALID-IDX)           50510074
505200                                    TO PV-TEMP-BEST-CASE-UNITS    50520074
505300              MOVE PV-TEMP-BEST-CASE-UNITS                        50530074
505400                                    TO ASC-BEST-CASE-UNITS        50540074
505500                                 (ASC-BLK-SUB ASC-ITEM-SUB)       50550074
505600           ELSE                                                   50560074
505700              MOVE ZEROES           TO ASC-BEST-CASE-UNITS        50570074
505800                                 (ASC-BLK-SUB ASC-ITEM-SUB)       50580074
505900           END-IF                                                 50590074
506000                                                                  50600074
506100           IF RC806-PCNT-VARIANCE (PV-VALID-IDX) NOT = 0          50610074
506200              MOVE RC806-PCNT-VARIANCE (PV-VALID-IDX)             50620074
506300                                    TO ASC-PERCENT-VARIANCE       50630074
506400                                 (ASC-BLK-SUB ASC-ITEM-SUB)       50640074
506500           ELSE                                                   50650074
506600              MOVE ZEROES           TO ASC-PERCENT-VARIANCE       50660074
506700                                 (ASC-BLK-SUB ASC-ITEM-SUB)       50670074
506800           END-IF                                                 50680074
506900                                                                  50690074
507000           IF RC806-RC-RATIO (PV-VALID-IDX)  = 0                  50700074
507100              MOVE +0               TO RECITM-PREPK-ODD-UNT-QTY   50710074
507200                                       ASC-ODD-PACK-UNITS         50720074
507300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     50730074
507400           ELSE                                                   50740074
507500              IF RC806-ODD-UNITS (PV-VALID-IDX) = +99999          50750074
507600                 MOVE +9999         TO RECITM-PREPK-ODD-UNT-QTY   50760074
507700                                       ASC-ODD-PACK-UNITS         50770074
507800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     50780074
507900              ELSE                                                50790074
508000                 MOVE RC806-ODD-UNITS (PV-VALID-IDX)              50800074
508100                                    TO RECITM-PREPK-ODD-UNT-QTY   50810074
508200                                       ASC-ODD-PACK-UNITS         50820074
508300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     50830074
508400              END-IF                                              50840074
508500           END-IF                                                 50850074
508600           MOVE RC806-PCNT-VARIANCE (PV-VALID-IDX)                50860074
508700                                    TO ASC-PERCENT-VARIANCE       50870074
508800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     50880074
508900                                                                  50890074
509000           ADD RC806-BEST-CASE-UNITS (PV-VALID-IDX)               50900074
509100                                    TO ASC-TOTAL-BEST-CASE-UNITS  50910074
509200                                                                  50920074
509300           IF ASC-QUICKCALC-FUNCTION                              50930074
509400              IF PV-DTL-CK-UNIT-QTY (PV-VALID-IDX)                50940074
509500                 COMPUTE PV-TOTAL-QC-DTL-CK-ITM-QTY =             50950074
509600                         PV-TOTAL-QC-DTL-CK-ITM-QTY +             50960074
509700                                    RC806-RCVG-QTY (PV-VALID-IDX) 50970074
509800              END-IF                                              50980074
509900              COMPUTE PV-TOTAL-QC-DTL-RATIO =                     50990074
510000                      PV-TOTAL-QC-DTL-RATIO +                     51000074
510100                                 RC806-RC-RATIO (PV-VALID-IDX)    51010074
510200              COMPUTE PV-TOTAL-QC-ODD-UNIT-QTY =                  51020074
510300                      PV-TOTAL-QC-ODD-UNIT-QTY +                  51030074
510400                                RC806-ODD-UNITS (PV-VALID-IDX)    51040074
510500              IF RC806-DRIVER-LNE-SUB  = PV-VALID-IDX AND         51050074
510600                 RC806-RC-RATIO (PV-VALID-IDX)  > 0               51060074
510700                    COMPUTE ASC-EXPD-PACKS-QTY =                  51070074
510800                                  RC806-RCVG-QTY (PV-VALID-IDX) / 51080074
510900                                  RC806-RC-RATIO (PV-VALID-IDX)   51090074
511000              END-IF                                              51100074
511100           END-IF                                                 51110074
511200                                                                  51120074
511300       END-PERFORM.                                               51130074
511400                                                                  51140074
511500       MOVE RC806-BEST-CASE-PACKS   TO ASC-BEST-CASE-PACKS.       51150074
511600                                                                  51160074
511700       PERFORM 5101-WRITE-TEMP-STORAGE.                           51170074
511800                                                                  51180074
511900                                                                  51190074
512000                                                                  51200074
512100*----------------------------------------------------------------*51210074
512200*  LINK TO THE PACK VALIDATION MODULE AND CHECK THE RETURN CODES *51220074
512300*----------------------------------------------------------------*51230074
512400 4424-LINK-TO-VALIDATION-MODULE.                                  51240074
512500                                                                  51250074
512600     EXEC CICS LINK                                               51260074
512700         PROGRAM  ('RCKCS806')                                    51270074
512800         COMMAREA (RC806-PRODUCT-PACK-VALIDATION)                 51280074
512900         RESP     (PV-CICS-RESP)                                  51290074
513000     END-EXEC.                                                    51300074
513100                                                                  51310074
513200*  CHECK CICS RETURN CODE                                         51320074
513300     IF PV-CICS-RESP = DFHRESP(NORMAL)                            51330074
513400         CONTINUE                                                 51340074
513500     ELSE                                                         51350074
513600         SET DP013-CICS-ABEND                                     51360074
513700             DP013-NO-ROLLBACK   TO TRUE                          51370074
513800         MOVE '4424-LINK-TO-VALIDATION-MODULE'                    51380074
513900                                 TO DP013-PARAGRAPH               51390074
514000         MOVE 'ATTEMPTING TO LINK TO PROGRAM RCKCS806'            51400074
514100                                 TO DP013-MESSAGE-TEXT (1)        51410074
514200         PERFORM DP013-0000-PROCESS-ABEND                         51420074
514300     END-IF.                                                      51430074
514400                                                                  51440074
514500     EVALUATE TRUE                                                51450074
514600     WHEN RC806-NO-ERRORS                                         51460074
514700         CONTINUE                                                 51470074
514800     WHEN OTHER                                                   51480074
514900         EVALUATE TRUE                                            51490074
515000         WHEN RC806-INV-LINE-DATA                                 51500074
515100         WHEN RC806-INV-FUNCTION-CD                               51510074
515200         WHEN RC806-INV-NBR-OF-LINES                              51520074
515300              MOVE 'Y'             TO DP020-MSG-SEVERITY-IND      51530074
515400              MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER            51540074
515500                                                                  51550074
515600              EXEC CICS                                           51560074
515700                   SYNCPOINT ROLLBACK                             51570074
515800              END-EXEC                                            51580074
515900         END-EVALUATE                                             51590074
516000     END-EVALUATE.                                                51600074
516100                                                                  51610074
516200                                                                  51620074
516300                                                                  51630074
516400*----------------------------------------------------------------*51640074
516500*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *51650074
516600*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *51660074
516700*  ISSUE A WARNING.                                              *51670074
516800*----------------------------------------------------------------*51680074
516900 4430-CHECK-FOR-BEGIN-AND-END.                                    51690074
517000                                                                  51700074
517100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       51710074
517200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     51720074
517300*            -- NO END-OF-RANGE SPECFIED ---                      51730074
517400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            51740074
517500             SET DP020-MSG-WARNING TO TRUE                        51750074
517600             PERFORM 4431-POSITION-AT-WARNING                     51760074
517700         END-IF                                                   51770074
517800     ELSE                                                         51780074
517900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     51790074
518000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                51800074
518100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            51810074
518200             SET DP020-MSG-WARNING TO TRUE                        51820074
518300             PERFORM 4431-POSITION-AT-WARNING                     51830074
518400         END-IF                                                   51840074
518500     END-IF.                                                      51850074
518600                                                                  51860074
518700                                                                  51870074
518800*----------------------------------------------------------------*51880074
518900*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *51890074
519000*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *51900074
519100*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *51910074
519200*  POSITION THE CURSOR THERE.                                    *51920074
519300*----------------------------------------------------------------*51930074
519400 4431-POSITION-AT-WARNING.                                        51940074
519500                                                                  51950074
519600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 51960074
519700                    - PV-TOP-ITEM + 1.                            51970074
519800                                                                  51980074
519900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      51990074
520000         CONTINUE                                                 52000074
520100     ELSE                                                         52010074
520200         SET DP030-SET-CURSOR-APPL-1                              52020074
520300                                   TO TRUE                        52030074
520400         IF ASC-UPDATE-PENDING                                    52040074
520500               MOVE -1             TO MR-DTL-PACK-RATIOL (PV-SUB) 52050074
520600               MOVE DP015-REVERSE  TO MR-DTL-PACK-RATIOH (PV-SUB) 52060074
520700               MOVE DP015-YELLOW   TO MR-DTL-PACK-RATIOC (PV-SUB) 52070074
520800         ELSE                                                     52080074
520900            MOVE -1                TO MR-SELECTL (PV-SUB)         52090074
521000            MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)         52100074
521100            MOVE DP015-YELLOW      TO MR-SELECTC (PV-SUB)         52110074
521200     END-IF.                                                      52120074
521300                                                                  52130074
521400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   52140074
521500                    - PV-TOP-ITEM + 1.                            52150074
521600                                                                  52160074
521700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      52170074
521800         CONTINUE                                                 52180074
521900     ELSE                                                         52190074
522000         SET DP030-SET-CURSOR-APPL-1                              52200074
522100                                   TO TRUE                        52210074
522200         MOVE -1                   TO MR-SELECTL (PV-SUB)         52220074
522300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         52230074
522400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         52240074
522500     END-IF.                                                      52250074
522600                                                                  52260074
522700*----------------------------------------------------------------*52270074
522800*   DETERMINE THE TOTALS FOR THE FIELDS                          *52280074
522900*----------------------------------------------------------------*52290074
523000 4440-DETERMINE-TOTALS.                                           52300074
523100                                                                  52310074
523200     EXEC SQL                                                     52320074
523300          SELECT DISTINCT                                         52330074
523400                 SUM(A.PREPK_RATO_QTY)                            52340074
523500                ,SUM(A.PKSL_ITM_QTY)                              52350074
523600                ,SUM(A.DTL_CK_ITM_QTY)                            52360074
523700                ,SUM(A.PREPK_ODD_UNT_QTY)                         52370074
523800                ,SUM(A.CASE_PACK_QTY)                             52380074
523900            INTO                                                  52390074
524000                 :PV-TOTAL-DTL-RATIO      :PV-NULL-IND            52400074
524100                ,:PV-TOTAL-PKSL-ITM-QTY   :PV-NULL-IND            52410074
524200                ,:PV-TOTAL-DTL-CK-ITM-QTY :PV-NULL-IND            52420074
524300                ,:PV-TOTAL-ODD-UNIT-QTY   :PV-NULL-IND            52430074
524400                ,:PV-TOTAL-CASE-PACK-QTY  :PV-NULL-IND            52440074
524500            FROM TRECITM A                                        52450074
524600           WHERE A.ORD_NBR           = :DK-ORD-NBR                52460074
524700             AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR           52470074
524800             AND A.PREPK_ID          = :DK-PACK-ID                52480074
524900             AND A.OPER_UNT_ID       = :DK-OPR-ID                 52490074
525000             AND A.FCLTY_ID          = :DK-FACT                   52500074
525100             AND A.VER_STATUS_CDE    = 'A'                        52510074
525200     END-EXEC                                                     52520074
525300                                                                  52530074
525400     EVALUATE TRUE                                                52540074
525500         WHEN SQLCODE = ZERO                                      52550074
525600              CONTINUE                                            52560074
525700         WHEN SQLCODE = -904                                      52570074
525800         WHEN SQLCODE = -911                                      52580074
525900         WHEN SQLCODE = -913                                      52590074
526000              PERFORM 9900-SOFT-ABORT                             52600074
526100         WHEN SQLCODE = +100                                      52610074
526200         WHEN SQLCODE = -305                                      52620074
526300              MOVE +0  TO PV-TOTAL-DTL-RATIO                      52630074
526400                          PV-TOTAL-PO-RATIO                       52640074
526500                          PV-TOTAL-PKSL-ITM-QTY                   52650074
526600                          PV-TOTAL-DTL-CK-ITM-QTY                 52660074
526700                          PV-TOTAL-ODD-UNIT-QTY                   52670074
526800                          PV-TOTAL-CASE-PACK-QTY                  52680074
526900         WHEN OTHER                                               52690074
527000              MOVE '4440-DETERMINE-TOTALS'                        52700074
527100                               TO DP013-PARAGRAPH                 52710074
527200              MOVE 'SELECT TRECDIS'                               52720074
527300                               TO DP013-MESSAGE-TEXT (1)          52730074
527400              MOVE SQLCA       TO DP013-SQLCA                     52740074
527500              SET DP013-DB2-ABEND                                 52750074
527600                               TO TRUE                            52760074
527700              PERFORM 9950-FORMAT-ERROR-MSG                       52770074
527800              PERFORM DP013-0000-PROCESS-ABEND                    52780074
527900     END-EVALUATE.                                                52790074
528000                                                                  52800074
528100                                                                  52810074
528200     EXEC SQL                                                     52820074
528300          SELECT DISTINCT                                         52830074
528400                 SUM(B.PREPK_RATO_QTY)                            52840074
528500            INTO                                                  52850074
528600                 :PV-TOTAL-PO-RATIO       :PV-NULL-IND            52860074
528700            FROM TRECITM A                                        52870074
528800                ,TPURITM B                                        52880074
528900           WHERE A.ORD_NBR           = :DK-ORD-NBR                52890074
529000             AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR           52900074
529100             AND A.PREPK_ID          = :DK-PACK-ID                52910074
529200             AND A.OPER_UNT_ID       = :DK-OPR-ID                 52920074
529300             AND A.FCLTY_ID          = :DK-FACT                   52930074
529400             AND A.VER_STATUS_CDE    = 'A'                        52940074
529500             AND B.PO_NBR            = A.ORD_NBR                  52950074
529600             AND B.APP_PO_LNE_NBR    = A.ORD_LNE_NBR              52960074
529700             AND B.VER_STATUS_CDE    = 'A'                        52970074
529800     END-EXEC                                                     52980074
529900                                                                  52990074
530000     EVALUATE TRUE                                                53000074
530100         WHEN SQLCODE = ZERO                                      53010074
530200              CONTINUE                                            53020074
530300         WHEN SQLCODE = -904                                      53030074
530400         WHEN SQLCODE = -911                                      53040074
530500         WHEN SQLCODE = -913                                      53050074
530600              PERFORM 9900-SOFT-ABORT                             53060074
530700         WHEN SQLCODE = +100                                      53070074
530800         WHEN SQLCODE = -305                                      53080074
530900              MOVE +0  TO PV-TOTAL-PO-RATIO                       53090074
531000         WHEN OTHER                                               53100074
531100              MOVE '4440-DETERMINE-TOTALS'                        53110074
531200                               TO DP013-PARAGRAPH                 53120074
531300              MOVE 'SELECT TRECITM-TPURITM'                       53130074
531400                               TO DP013-MESSAGE-TEXT (1)          53140074
531500              MOVE SQLCA       TO DP013-SQLCA                     53150074
531600              PERFORM 9950-FORMAT-ERROR-MSG                       53160074
531700              SET DP013-DB2-ABEND                                 53170074
531800                               TO TRUE                            53180074
531900              PERFORM DP013-0000-PROCESS-ABEND                    53190074
532000     END-EVALUATE.                                                53200074
532100                                                                  53210074
532200 4450-DETERMINE-VERIFY-TOTAL.                                     53220074
532300                                                                  53230074
532400       EXEC SQL                                                   53240074
532500            SELECT                                                53250074
532600                   SUM(B.AP_VERIFY_ITM_QTY)                       53260074
532700              INTO                                                53270074
532800                   :PV-TOTAL-AP-VERIFY-ITM-QTY                    53280074
532900              FROM TRECITM A                                      53290074
533000                  ,TRECDIS B                                      53300074
533100             WHERE A.ORD_NBR           = :DK-ORD-NBR              53310074
533200               AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR         53320074
533300               AND A.PREPK_ID          = :DK-PACK-ID              53330074
533400               AND A.OPER_UNT_ID       = :DK-OPR-ID               53340074
533500               AND A.FCLTY_ID          = :DK-FACT                 53350074
533600               AND A.VER_STATUS_CDE    = 'A'                      53360074
533700               AND B.ORD_NBR           = A.ORD_NBR                53370074
533800               AND B.ORD_LNE_NBR       = A.ORD_LNE_NBR            53380074
533900               AND B.REC_SEQ_NBR       = A.REC_SEQ_NBR            53390074
534000               AND B.OPER_UNT_ID       = A.OPER_UNT_ID            53400074
534100               AND B.FCLTY_ID          = A.FCLTY_ID               53410074
534300       END-EXEC                                                   53430074
534400                                                                  53440074
534500       EVALUATE TRUE                                              53450074
534600           WHEN SQLCODE = ZERO                                    53460074
534700                CONTINUE                                          53470074
534800           WHEN SQLCODE = -904                                    53480074
534900           WHEN SQLCODE = -911                                    53490074
535000           WHEN SQLCODE = -913                                    53500074
535100                PERFORM 9900-SOFT-ABORT                           53510074
535200           WHEN SQLCODE = +100                                    53520074
535300           WHEN SQLCODE = -305                                    53530074
535400                MOVE +0  TO PV-TOTAL-AP-VERIFY-ITM-QTY            53540074
535500           WHEN OTHER                                             53550074
535600                MOVE '4450-DETERMINE-VERIFY-TOTAL'                53560074
535700                                 TO DP013-PARAGRAPH               53570074
535800                MOVE 'SELECT TRECDIS'                             53580074
535900                                 TO DP013-MESSAGE-TEXT (1)        53590074
536000                MOVE SQLCA       TO DP013-SQLCA                   53600074
536100                PERFORM 9950-FORMAT-ERROR-MSG                     53610074
536200                SET DP013-DB2-ABEND                               53620074
536300                                 TO TRUE                          53630074
536400                PERFORM DP013-0000-PROCESS-ABEND                  53640074
536500       END-EVALUATE.                                              53650074
536600                                                                  53660074
536700                                                                  53670074
536800*----------------------------------------------------------------*53680074
536900* RETRIEVE VENDOR INFORMATION.                                   *53690074
537000*----------------------------------------------------------------*53700074
537100 4460-GET-VENDOR-NAME.                                            53710074
537200                                                                  53720074
537300      EXEC SQL                                                    53730074
537400         SELECT DISTINCT                                          53740074
537500                 B.ENT_NAME_DESC                                  53750099
537600           INTO :ENTNME-ENT-NAME-DESC                             53760074
537700           FROM  TPURCHS A                                        53770074
537800                ,TENTNME B                                        53780099
537900          WHERE                                                   53790074
538000                   A.PO_NBR         = :DK-ORD-NBR                 53800074
538100             AND   A.VER_STATUS_CDE = 'A'                         53810074
538200             AND   B.ENT_ID         = A.ENT_ID                    53820099
538300             AND   B.TYPE_CDE       = '01'                        53830099
538400     END-EXEC.                                                    53840074
538500                                                                  53850074
538600     EVALUATE TRUE                                                53860074
538700         WHEN SQLCODE = +0                                        53870074
538800         WHEN SQLCODE = +100                                      53880074
538900              CONTINUE                                            53890074
539000         WHEN SQLCODE = -904                                      53900074
539100         WHEN SQLCODE = -911                                      53910074
539200         WHEN SQLCODE = -913                                      53920074
539300              PERFORM 9900-SOFT-ABORT                             53930074
539400         WHEN OTHER                                               53940074
539500              MOVE '4460-GET-VENDOR-NAME'                         53950074
539600                               TO DP013-PARAGRAPH                 53960074
539700              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               53970074
539800                               TO DP013-MESSAGE-TEXT (1)          53980074
539900              MOVE SQLCA       TO DP013-SQLCA                     53990074
540000              MOVE 'TENTNME '  TO DP013-DB2-TABLE-NAME (1)        54000074
540100              PERFORM 9950-FORMAT-ERROR-MSG                       54010074
540200              SET DP013-DB2-ABEND                                 54020074
540300                  DP013-XCTL-DISPLAY-RESTART                      54030074
540400                               TO TRUE                            54040074
540500              PERFORM DP013-0000-PROCESS-ABEND                    54050074
540600     END-EVALUATE.                                                54060074
540700                                                                  54070074
540800                                                                  54080074
540900*----------------------------------------------------------------*54090074
541000*   DETERMINE IF ANY LINES ARE VERIFIED.                         *54100074
541100*----------------------------------------------------------------*54110074
541200 4470-DETERMINE-LINE-VE.                                          54120074
541300                                                                  54130074
541400       EXEC SQL                                                   54140074
541500            SELECT DISTINCT                                       54150074
541600                   COUNT(*)                                       54160074
541700              INTO                                                54170074
541800                   :PV-TOTAL-LINES-VERIFIED :PV-NULL-IND          54180074
541900              FROM TRECITM A                                      54190074
542000             WHERE A.ORD_NBR           = :DK-ORD-NBR              54200074
542100               AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR         54210074
542200               AND A.PREPK_ID          = :DK-PACK-ID              54220074
542300               AND A.OPER_UNT_ID       = :DK-OPR-ID               54230074
542400               AND A.FCLTY_ID          = :DK-FACT                 54240074
542500               AND A.VER_STATUS_CDE    = 'A'                      54250074
542600               AND A.STATUS_CDE        IN ('VE','CM')             54260074
542700       END-EXEC                                                   54270074
542800                                                                  54280074
542900       EVALUATE TRUE                                              54290074
543000           WHEN SQLCODE = ZERO                                    54300074
543100                CONTINUE                                          54310074
543200           WHEN SQLCODE = -904                                    54320074
543300           WHEN SQLCODE = -911                                    54330074
543400           WHEN SQLCODE = -913                                    54340074
543500                PERFORM 9900-SOFT-ABORT                           54350074
543600           WHEN SQLCODE = +100                                    54360074
543700           WHEN SQLCODE = -305                                    54370074
543800                MOVE +0  TO PV-TOTAL-DTL-RATIO                    54380074
543900                            PV-TOTAL-PO-RATIO                     54390074
544000                            PV-TOTAL-PKSL-ITM-QTY                 54400074
544100                            PV-TOTAL-DTL-CK-ITM-QTY               54410074
544200                            PV-TOTAL-ODD-UNIT-QTY                 54420074
544300                            PV-TOTAL-CASE-PACK-QTY                54430074
544400            WHEN OTHER                                            54440074
544500                MOVE '4470-DETERMINE-LINE-VE'                     54450074
544600                                 TO DP013-PARAGRAPH               54460074
544700                MOVE 'SELECT TRECITM'                             54470074
544800                                 TO DP013-MESSAGE-TEXT (1)        54480074
544900                MOVE SQLCA       TO DP013-SQLCA                   54490074
545000                PERFORM 9950-FORMAT-ERROR-MSG                     54500074
545100                SET DP013-DB2-ABEND                               54510074
545200                                 TO TRUE                          54520074
545300                PERFORM DP013-0000-PROCESS-ABEND                  54530074
545400       END-EVALUATE.                                              54540074
545500                                                                  54550074
545600/                                                                 54560074
545700*----------------------------------------------------------------*54570074
545800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *54580074
545900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *54590074
546000* FOR THE SELECTED ITEMS QUEUE.                                  *54600074
546100*                                                                *54610074
546200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *54620074
546300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *54630074
546400* THE ARRAY IS FULL.                                             *54640074
546500*----------------------------------------------------------------*54650074
546600 5000-PREPARE-SEL-QUEUE.                                          54660074
546700                                                                  54670074
546800     MOVE +1                       TO ASC-BLK-SUB.                54680074
546900     PERFORM 5100-WRITE-TEMP-STORAGE.                             54690074
547000     ADD +1                        TO ASC-BLK-SUB.                54700074
547100     PERFORM 5100-WRITE-TEMP-STORAGE.                             54710074
547200                                                                  54720074
547300     MOVE ASC-SEL-QUEUE-NAME-OUT   TO PC000-SEL-QUEUE-NAME.       54730074
547400     PERFORM 6010-DELETE-SEL-QUEUE.                               54740074
547500                                                                  54750074
547600     EVALUATE TRUE                                                54760074
547700                                                                  54770074
547800* IF GOING TO PACK MARKING APRON                                  54780074
547900           WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)            54790074
548000                 INITIALIZE PC016-SELECTED-ITEM-ARRAY             54800074
548100                 MOVE +1            TO                            54810074
548200                                  PC000-NUMBER-OF-SELECTED-ITEMS  54820074
548300                                  PV-ITEM                         54830074
548400                 SET LQW-IDX        TO +1                         54840074
548500                                                                  54850074
548600                 PERFORM 6112-READ-LIST-QUEUE                     54860074
548700                                                                  54870074
548800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              54880074
548900                                    TO PC016-ITEM (PC016-IDX)     54890074
549000                 MOVE SPACE         TO PC016-ACTION-SW(PC016-IDX) 54900074
549100                 MOVE ASC-OPR-ID    TO PC016-OPER-UNT-ID          54910074
549200                                                      (PC016-IDX) 54920074
549300                 MOVE ASC-FACT      TO PC016-FCLTY-ID             54930074
549400                                                      (PC016-IDX) 54940074
549500                 MOVE ASC-REC-NBR   TO PC016-PO-NBR-N (PC016-IDX) 54950074
549600                 MOVE ASC-REC-SEQ-NBR                             54960074
549700                                    TO PC016-REC-SEQ-NBR-N        54970074
549800                                                      (PC016-IDX) 54980074
549900                 MOVE ASC-PACK-ID   TO PC016-PACK-ID  (PC016-IDX) 54990074
550000                 MOVE PC-Y          TO PC016-MRKG-APRON-REQ-IND   55000074
550100                                                       (PC016-IDX)55010074
550200                 SET PC016-IDX UP BY 1                            55020074
550300                 MOVE +1            TO PC000-NUMBER-OF-TS-ITEMS   55030074
550400                 PERFORM 5205-WRITE-SEL-QUEUE                     55040074
550500                                                                  55050074
550600        WHEN OTHER                                                55060074
550700             SET PC016-IDX          TO 1                          55070074
550800             MOVE ZERO              TO PC000-NUMBER-OF-TS-ITEMS   55080074
550900                                  PC000-NUMBER-OF-SELECTED-ITEMS  55090074
551000             INITIALIZE PC016-SELECTED-ITEM-ARRAY                 55100074
551100                                                                  55110074
551200             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   55120074
551300                     VARYING PV-ITEM FROM 1 BY 1                  55130074
551400                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 55140074
551500             IF  PC016-IDX > 1                                    55150074
551600                 PERFORM 5205-WRITE-SEL-QUEUE                     55160074
551700                ADD +1              TO PC000-NUMBER-OF-TS-ITEMS   55170074
551800             END-IF                                               55180074
551900     END-EVALUATE.                                                55190074
552000                                                                  55200074
552100/                                                                 55210074
552200*----------------------------------------------------------------*55220074
552300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *55230074
552400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *55240074
552500* FOR THE SELECTED ITEMS QUEUE.                                  *55250074
552600*                                                                *55260074
552700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *55270074
552800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *55280074
552900* THE ARRAY IS FULL.                                             *55290074
553000*----------------------------------------------------------------*55300074
553100 5050-PREPARE-SEL-QUEUE2.                                         55310074
553200                                                                  55320074
553300     MOVE +1                        TO ASC-BLK-SUB.               55330074
553400     PERFORM 5100-WRITE-TEMP-STORAGE.                             55340074
553500     ADD +1                         TO ASC-BLK-SUB.               55350074
553600     PERFORM 5100-WRITE-TEMP-STORAGE.                             55360074
553700                                                                  55370074
553800     MOVE ASC-SEL-QUEUE-NAME-OUT    TO RC800-SEL-QUEUE-NAME.      55380074
553900     PERFORM 6010-DELETE-SEL-QUEUE.                               55390074
554000                                                                  55400074
554100     IF DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID) OR                 55410074
554200        DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                    55420074
554300        SET ASC-UPDATE-TSQ3         TO TRUE                       55430074
554400     ELSE                                                         55440074
554500        SET ASC-UPDATE-TSQ          TO TRUE.                      55450074
554600     SET RC801-IDX                  TO 1.                         55460074
554700     MOVE ZERO                      TO RC800-NUMBER-OF-TS-ITEMS   55470074
554800                                  RC800-NUMBER-OF-SELECTED-ITEMS. 55480074
554900                                                                  55490074
555000     INITIALIZE RC801-SELECTED-ITEM-ARRAY.                        55500074
555100                                                                  55510074
555200     SET PS-NOT-DISTHD-EXISTS       TO TRUE.                      55520074
555300     PERFORM 5250-FILL-SEL-QUEUE-RECORD2                          55530074
555400             VARYING PV-ITEM                                      55540074
555500             FROM 1 BY 1                                          55550074
555600             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     55560074
555700                                                                  55570074
555800* IF UPDATE OR QUICKCALC                                          55580074
555900     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)  OR                55590074
556000              (DP020-FK-CONFIRM (DP020-SRC-AID)                   55600074
556100          AND  ASC-UPDATE-PENDING)              OR                55610074
556200        DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                    55620074
556300             PERFORM 4100-PREPARE-CURSOR                          55630074
556400             SET ASC-UPDATE-NOT-PENDING                           55640074
556500                                    TO TRUE                       55650074
556600             MOVE +1                TO PV-VALID-IDX               55660074
556700                                                                  55670074
556800             PERFORM 5300-UPDATE-PROCESS                          55680074
556900                                                                  55690074
557000             IF ASC-UPDATE-PENDING                                55700074
557100                MOVE +1             TO ASC-BLK-SUB                55710074
557200                                       PV-BLOCK-NUMBER            55720074
557300                                                                  55730074
557400                INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)        55740074
557500                                                                  55750074
557600                PERFORM 4410-READ-TEMP-STORAGE                    55760074
557700                ADD  +1             TO ASC-BLK-SUB                55770074
557800                                       PV-BLOCK-NUMBER            55780074
557900                                                                  55790074
558000                INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)        55800074
558100                PERFORM 4410-READ-TEMP-STORAGE                    55810074
558200                                                                  55820074
558300                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              55830074
558400                                                                  55840074
558500                SET DP030-OVERRIDE-GO                             55850074
558600                                    TO TRUE                       55860074
558700                MOVE +1             TO ASC-BLK-SUB                55870074
558800                                       PV-BLOCK-NUMBER            55880074
558900              ELSE                                                55890074
559000                 IF ASC-USE-SELECTION-QUEUE AND                   55900074
559100                    PS-NO-ERROR                                   55910074
559200                   PERFORM 5600-UPDATE-SELECTION-QUEUE            55920074
559300                 END-IF                                           55930074
559400                 IF PS-REDISTRO-OK AND                            55940074
559500                    PS-NO-ERROR                                   55950074
559600                    IF ASC-CALL-REDISTRO                          55960074
559700* JAK 06/2007 - ADD WMS SPECIFIC MESSAGES                         55970099
559800                       PERFORM 3600-CHECK-WMS                     55980099
559900                       IF PS-ASNS-TO-WMS-YES                      55990099
560000                           MOVE PC-TSYMSG-03570                   56000099
560100                                         TO DP020-MSG-NUMBER      56010099
560200                       ELSE                                       56020099
560300                           MOVE PC-TSYMSG-02161                   56030099
560400                                    TO DP020-MSG-NUMBER           56040099
560500                       END-IF                                     56050099
560600                       SET DP020-MSG-INFORMATIONAL                56060074
560700                                    TO TRUE                       56070074
560800                    ELSE                                          56080074
560900                       MOVE PC-TSYMSG-00059                       56090074
561000                                    TO DP020-MSG-NUMBER           56100074
561100                       SET DP020-MSG-INFORMATIONAL                56110074
561200                                    TO TRUE                       56120074
561300                    END-IF                                        56130074
561400                 END-IF                                           56140074
561500                                                                  56150074
561600                 INITIALIZE ASC-BLOCK-ENTRIES (1)                 56160074
561700                            ASC-BLOCK-ENTRIES (2)                 56170074
561800                                                                  56180074
561900                 MOVE +1            TO ASC-BLK-SUB                56190074
562000                                       PV-TOP-ITEM                56200074
562100                                       PV-BLOCK-NUMBER            56210074
562200                 PERFORM 4410-READ-TEMP-STORAGE                   56220074
562300                 ADD  +1            TO ASC-BLK-SUB                56230074
562400                                       PV-BLOCK-NUMBER            56240074
562500                                                                  56250074
562600                 INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)       56260074
562700                 PERFORM 4410-READ-TEMP-STORAGE                   56270074
562800                                                                  56280074
562900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             56290074
563000              END-IF                                              56300074
563100            END-IF.                                               56310074
563200                                                                  56320074
563300* IF DELETE                                                       56330074
563400     IF DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)                    56340074
563500           OR (DP020-FK-CONFIRM (DP020-SRC-AID)                   56350074
563600          AND  ASC-DELETE-PENDING)                                56360074
563700             PERFORM 3600-CHECK-WMS                               56370099
563800             IF PS-RECEIVING-BEGUN-NO                             56380099
563900                 PERFORM 4100-PREPARE-CURSOR                      56390074
564000                 SET ASC-UPDATE-NOT-PENDING                       56400074
564100                                    TO TRUE                       56410074
564200                 MOVE +1                TO PV-VALID-IDX           56420074
564300                                                                  56430074
564400                 PERFORM 5400-DELETE-PROCESS                      56440074
564500                                                                  56450074
564600                 IF ASC-DELETE-PENDING OR                         56460074
564700                    PS-ERROR                                      56470074
564800                    MOVE +1             TO ASC-BLK-SUB            56480074
564900                                       PV-BLOCK-NUMBER            56490074
565000                    INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)    56500074
565100                    PERFORM 4410-READ-TEMP-STORAGE                56510074
565200                    ADD  +1             TO ASC-BLK-SUB            56520074
565300                                       PV-BLOCK-NUMBER            56530074
565400                    INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)    56540074
565500                    PERFORM 4410-READ-TEMP-STORAGE                56550074
565600                                                                  56560074
565700                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          56570074
565800                                                                  56580074
565900                    SET DP030-OVERRIDE-GO                         56590074
566000                                    TO TRUE                       56600074
566100                    MOVE +1             TO ASC-BLK-SUB            56610074
566200                                        PV-BLOCK-NUMBER           56620074
566300                ELSE                                              56630074
566400                   IF ASC-USE-SELECTION-QUEUE                     56640074
566500                      PERFORM 5600-UPDATE-SELECTION-QUEUE         56650074
566600                   END-IF                                         56660074
566700* JAK 06/2007 - ADD WMS SPECIFIC MESSAGES                         56670099
566800                   IF PS-ASNS-TO-WMS-YES                          56680099
566900                       PERFORM 3604-CALL-WMS-MODULE               56690099
567000                       IF WS001-SUCCESSFUL                        56700099
567100                           MOVE PC-TSYMSG-03578                   56710099
567200                                         TO DP020-MSG-NUMBER      56720099
567300                       ELSE                                       56730099
567400                           MOVE PC-TSYMSG-03546                   56740099
567500                                         TO DP020-MSG-NUMBER      56750099
567600                       END-IF                                     56760099
567700                   ELSE                                           56770099
567800                       MOVE PC-TSYMSG-00059                       56780099
567900                                    TO DP020-MSG-NUMBER           56790099
568000                   END-IF                                         56800099
568100                   SET DP020-MSG-INFORMATIONAL                    56810074
568200                                    TO TRUE                       56820074
568300                                                                  56830074
568400                   INITIALIZE ASC-BLOCK-ENTRIES (1)               56840074
568500                            ASC-BLOCK-ENTRIES (2)                 56850074
568600                   MOVE +1             TO ASC-BLK-SUB             56860074
568700                                       PV-TOP-ITEM                56870074
568800                   PERFORM 4410-READ-TEMP-STORAGE                 56880074
568900                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           56890074
569000                END-IF                                            56900074
569100             ELSE                                                 56910099
569200                MOVE PC-TSYMSG-03538  TO DP020-MSG-NUMBER         56920099
569300                SET PS-ERROR                                      56930099
569400                    DP030-OVERRIDE-GO                             56940099
569500                    ASC-DELETE-NOT-PENDING                        56950099
569600                    DP020-MSG-FATAL TO TRUE                       56960099
569700                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              56970099
569800             END-IF                                               56980099
569900     ELSE                                                         56990074
570000        IF  RC801-IDX > 1                                         57000074
570100           PERFORM 5204-WRITE-SEL-QUEUE2                          57010074
570200           ADD +1                   TO RC800-NUMBER-OF-TS-ITEMS   57020074
570300        END-IF.                                                   57030074
570400                                                                  57040074
570500                                                                  57050074
570600*----------------------------------------------------------------*57060074
570700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *57070074
570800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *57080074
570900*----------------------------------------------------------------*57090074
571000                                                                  57100074
571100 5100-WRITE-TEMP-STORAGE.                                         57110074
571200                                                                  57120074
571300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     57130074
571400                                   TO PV-LIST-ITEM-NUMBER.        57140074
571500                                                                  57150074
571600     COMPUTE PV-BLOCK-NUMBER =                                    57160074
571700            1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL). 57170074
571800                                                                  57180074
571900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             57190074
572000     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             57200074
572100         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      57210074
572200             PERFORM 5105-REWRITE-ASC-LISTQ                       57220074
572300         END-IF                                                   57230074
572400     ELSE                                                         57240074
572500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       57250074
572600         ASC-HIGHEST-BLOCK-WRITTEN + 1                            57260074
572700         PERFORM 5110-WRITE-ASC-LISTQ                             57270074
572800         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   57280074
572900     END-IF.                                                      57290074
573000                                                                  57300074
573100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      57310074
573200                                   TO TRUE.                       57320074
573300                                                                  57330074
573400 5101-WRITE-TEMP-STORAGE.                                         57340074
573500                                                                  57350074
573600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     57360074
573700                                   TO PV-LIST-ITEM-NUMBER.        57370074
573800                                                                  57380074
573900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             57390074
574000     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             57400074
574100         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      57410074
574200             PERFORM 5105-REWRITE-ASC-LISTQ                       57420074
574300         END-IF                                                   57430074
574400     ELSE                                                         57440074
574500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       57450074
574600         ASC-HIGHEST-BLOCK-WRITTEN + 1                            57460074
574700         PERFORM 5110-WRITE-ASC-LISTQ                             57470074
574800         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   57480074
574900     END-IF.                                                      57490074
575000                                                                  57500074
575100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      57510074
575200                                   TO TRUE.                       57520074
575300                                                                  57530074
575400/                                                                 57540074
575500*----------------------------------------------------------------*57550074
575600*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *57560074
575700*  SPECIFIC COMMAREA.                                            *57570074
575800*----------------------------------------------------------------*57580074
575900 5105-REWRITE-ASC-LISTQ.                                          57590074
576000                                                                  57600074
576100     EXEC CICS                                                    57610074
576200         WRITEQ TS                                                57620074
576300             QUEUE (ASC-LIST-QUEUE-NAME)                          57630074
576400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               57640074
576500             ITEM  (PV-BLOCK-NUMBER)                              57650074
576600             REWRITE                                              57660074
576700             RESP  (PV-CICS-RESP)                                 57670074
576800     END-EXEC.                                                    57680074
576900                                                                  57690074
577000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           57700074
577100         CONTINUE                                                 57710074
577200     ELSE                                                         57720074
577300         SET DP013-CICS-ABEND      TO TRUE                        57730074
577400         SET DP013-NO-ROLLBACK     TO TRUE                        57740074
577500         MOVE '5105-REWRITE-ASC-LISTQ'                            57750074
577600                                   TO DP013-PARAGRAPH             57760074
577700         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     57770074
577800                                   TO DP013-MESSAGE-TEXT(1)       57780074
577900         PERFORM DP013-0000-PROCESS-ABEND                         57790074
578000     END-IF.                                                      57800074
578100                                                                  57810074
578200/                                                                 57820074
578300*----------------------------------------------------------------*57830074
578400*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *57840074
578500*  SPECIFIC COMMAREA.                                            *57850074
578600*----------------------------------------------------------------*57860074
578700 5110-WRITE-ASC-LISTQ.                                            57870074
578800                                                                  57880074
578900     EXEC CICS                                                    57890074
579000         WRITEQ TS                                                57900074
579100             QUEUE (ASC-LIST-QUEUE-NAME)                          57910074
579200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               57920074
579300             ITEM  (PV-BLOCK-NUMBER)                              57930074
579400             RESP  (PV-CICS-RESP)                                 57940074
579500     END-EXEC.                                                    57950074
579600                                                                  57960074
579700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      57970074
579800         SET DP013-CICS-ABEND      TO TRUE                        57980074
579900         SET DP013-NO-ROLLBACK     TO TRUE                        57990074
580000         MOVE '5110-WRITE-ASC-LISTQ'                              58000074
580100                                   TO DP013-PARAGRAPH             58010074
580200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           58020074
580300                                   TO DP013-MESSAGE-TEXT(1)       58030074
580400         PERFORM DP013-0000-PROCESS-ABEND                         58040074
580500     END-IF.                                                      58050074
580600                                                                  58060074
580700/                                                                 58070074
580800*----------------------------------------------------------------*58080074
580900* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *58090074
581000* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *58100074
581100*----------------------------------------------------------------*58110074
581200                                                                  58120074
581300 5200-FILL-SEL-QUEUE-RECORD.                                      58130074
581400                                                                  58140074
581500     PERFORM 6112-READ-LIST-QUEUE.                                58150074
581600                                                                  58160074
581700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       58170074
581800         PERFORM                                                  58180074
581900         VARYING LQW-IDX                                          58190074
582000         FROM 1 BY 1                                              58200074
582100         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            58210074
582200           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          58220074
582300                                                                  58230074
582400             IF  (LQW-SELECT (LQW-IDX))                           58240074
582500                 ADD +1             TO                            58250074
582600                                  PC000-NUMBER-OF-SELECTED-ITEMS  58260074
582700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              58270074
582800                                    TO PC016-ITEM (PC016-IDX)     58280074
582900                 MOVE SPACE         TO PC016-ACTION-SW(PC016-IDX) 58290074
583000                 MOVE ASC-OPR-ID    TO PC016-OPER-UNT-ID          58300074
583100                                                      (PC016-IDX) 58310074
583200                 MOVE ASC-FACT      TO PC016-FCLTY-ID             58320074
583300                                                      (PC016-IDX) 58330074
583400                 MOVE ASC-REC-NBR   TO PC016-PO-NBR-N (PC016-IDX) 58340074
583500                 MOVE ASC-REC-SEQ-NBR                             58350074
583600                                    TO PC016-REC-SEQ-NBR-N        58360074
583700                                                      (PC016-IDX) 58370074
583800                 MOVE LQW-LINE-NUMBER (LQW-IDX)                   58380074
583900                                    TO PC016-LINE-NBR-N           58390074
584000                                                      (PC016-IDX) 58400074
584100                 MOVE LQW-DTL-PACK-UNITS (LQW-IDX)                58410074
584200                                    TO PC016-DTL-CK-ITM-QTY       58420074
584300                                                       (PC016-IDX)58430074
584400                 MOVE LQW-PKSL-PACK-UNITS (LQW-IDX)               58440074
584500                                    TO PC016-PKSL-ITM-QTY         58450074
584600                                                       (PC016-IDX)58460074
584700                 MOVE ASC-TPURITM-VEND-STYL-NAME                  58470074
584800                                    TO PC016-VEND-STYL-NAME       58480074
584900                                                       (PC016-IDX)58490074
585000                 MOVE PC-Y          TO PC016-MRKG-APRON-REQ-IND   58500074
585100                                                       (PC016-IDX)58510074
585200                                                                  58520074
585300* IF REDISTRO                                                     58530074
585400                 SET PC016-IDX UP BY 1                            58540074
585500                 IF  PC016-IDX > PC016-MAX-ITEMS                  58550074
585600                     PERFORM 5205-WRITE-SEL-QUEUE                 58560074
585700                     ADD +1         TO PC000-NUMBER-OF-TS-ITEMS   58570074
585800                     INITIALIZE PC016-SELECTED-ITEM-ARRAY         58580074
585900                     SET PC016-IDX  TO 1                          58590074
586000                 END-IF                                           58600074
586100           END-IF                                                 58610074
586200         END-PERFORM                                              58620074
586300     END-IF.                                                      58630074
586400                                                                  58640074
586500     MOVE PV-ITEM TO PV-SAVE-ITEM.                                58650074
586600     PERFORM 6111-WRITE-LIST-QUEUE.                               58660074
586700                                                                  58670074
586800                                                                  58680074
586900*----------------------------------------------------------------*58690074
587000*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *58700074
587100*----------------------------------------------------------------*58710074
587200                                                                  58720074
587300 5204-WRITE-SEL-QUEUE2.                                           58730074
587400                                                                  58740074
587500     IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                    58750074
587600        CONTINUE                                                  58760074
587700     ELSE                                                         58770074
587800        MOVE ASC-NUMBER-OF-SELECTED-ITEMS                         58780074
587900                                   TO                             58790074
588000                                 RC800-NUMBER-OF-SELECTED-ITEMS.  58800074
588100     EXEC CICS                                                    58810074
588200          WRITEQ TS                                               58820074
588300              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      58830074
588400              FROM  (RC801-PREPACK-SELECT-RECORD)                 58840074
588500              ITEM  (PV-SEL-QUEUE-ITEM)                           58850074
588600              RESP  (PV-CICS-RESP)                                58860074
588700     END-EXEC.                                                    58870074
588800                                                                  58880074
588900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          58890074
589000         CONTINUE                                                 58900074
589100     ELSE                                                         58910074
589200         SET DP013-CICS-ABEND      TO TRUE                        58920074
589300         SET DP013-NO-ROLLBACK     TO TRUE                        58930074
589400         MOVE '5204-WRITE-SEL-QUEUE2'                             58940074
589500                                   TO DP013-PARAGRAPH             58950074
589600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          58960074
589700                                   TO DP013-MESSAGE-TEXT(1)       58970074
589800         PERFORM DP013-0000-PROCESS-ABEND                         58980074
589900     END-IF.                                                      58990074
590000                                                                  59000074
590100                                                                  59010074
590200*----------------------------------------------------------------*59020074
590300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *59030074
590400*----------------------------------------------------------------*59040074
590500                                                                  59050074
590600 5205-WRITE-SEL-QUEUE.                                            59060074
590700                                                                  59070074
590800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            59080074
590900                                   TO PC016-SELECTED-ITEMS.       59090074
591000     EXEC CICS                                                    59100074
591100          WRITEQ TS                                               59110074
591200              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      59120074
591300              FROM  (PC016-TS-SEL-REC)                            59130074
591400              ITEM  (PV-SEL-QUEUE-ITEM)                           59140074
591500              RESP  (PV-CICS-RESP)                                59150074
591600     END-EXEC.                                                    59160074
591700                                                                  59170074
591800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59180074
591900         CONTINUE                                                 59190074
592000     ELSE                                                         59200074
592100         SET DP013-CICS-ABEND      TO TRUE                        59210074
592200         SET DP013-NO-ROLLBACK     TO TRUE                        59220074
592300         MOVE '5205-WRITE-SEL-QUEUE'                              59230074
592400                                   TO DP013-PARAGRAPH             59240074
592500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          59250074
592600                                   TO DP013-MESSAGE-TEXT(1)       59260074
592700         PERFORM DP013-0000-PROCESS-ABEND                         59270074
592800     END-IF.                                                      59280074
592900                                                                  59290074
593000                                                                  59300074
593100                                                                  59310074
593200*----------------------------------------------------------------*59320074
593300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *59330074
593400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD - RC013        *59340074
593500*----------------------------------------------------------------*59350074
593600                                                                  59360074
593700 5210-FILL-SEL-QUEUE-RECORD.                                      59370074
593800                                                                  59380074
593900     PERFORM 6112-READ-LIST-QUEUE.                                59390074
594000                                                                  59400074
594100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       59410074
594200         PERFORM                                                  59420074
594300         VARYING LQW-IDX                                          59430074
594400         FROM 1 BY 1                                              59440074
594500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            59450074
594600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          59460074
594700                                                                  59470074
594800             IF  (LQW-SELECT (LQW-IDX))                           59480074
594900                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         59490074
595000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              59500074
595100                                    TO RC013-ITEM (RC013-IDX)     59510074
595200                 MOVE SPACE         TO RC013-ACTION-SW (RC013-IDX)59520074
595300                 MOVE ASC-OPR-ID    TO RC013-OPER-UNT-ID          59530074
595400                                                       (RC013-IDX)59540074
595500                 MOVE ASC-FACT      TO RC013-FCLTY-ID             59550074
595600                                                       (RC013-IDX)59560074
595700                 MOVE ASC-REC-NBR   TO RC013-PO-NBR    (RC013-IDX)59570074
595800                 MOVE ASC-REC-SEQ-NBR                             59580074
595900                                    TO RC013-REC-SEQ-NBR          59590074
596000                                                       (RC013-IDX)59600074
596100                 MOVE LQW-LINE-NUMBER (LQW-IDX)                   59610074
596200                                    TO RC013-PKSL-LNE-NBR-N       59620074
596300                                                       (RC013-IDX)59630074
596400                 SET RC013-IDX UP BY 1                            59640074
596500                 IF  RC013-IDX > RC013-MAX-ITEMS                  59650074
596600                     PERFORM 5215-WRITE-SEL-QUEUE                 59660074
596700                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    59670074
596800                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         59680074
596900                     SET RC013-IDX TO 1                           59690074
597000                 END-IF                                           59700074
597100             END-IF                                               59710074
597200         END-PERFORM                                              59720074
597300     END-IF.                                                      59730074
597400                                                                  59740074
597500     MOVE PV-ITEM TO PV-SAVE-ITEM.                                59750074
597600     PERFORM 6111-WRITE-LIST-QUEUE.                               59760074
597700                                                                  59770074
597800                                                                  59780074
597900*----------------------------------------------------------------*59790074
598000*    RETRIEVE THE DRIVER LINE INFORMATION                        *59800074
598100*----------------------------------------------------------------*59810074
598200 5214-RETRIEVE-DRIVER-LINE.                                       59820074
598300                                                                  59830074
598400     EXEC SQL                                                     59840074
598500           SELECT DISTINCT                                        59850074
598600                  A.ORD_NBR                                       59860074
598700                , A.ORD_LNE_NBR                                   59870074
598800                , A.STATUS_CDE                                    59880074
598900                , A.MKING_APRON_TMST                              59890074
599000                , A.DTL_CK_ITM_QTY                                59900074
599100                , A.PKSL_ITM_QTY                                  59910074
599200                , A.PREPK_RATO_QTY                                59920074
599300                , B.PREPK_RATO_QTY                                59930074
599400           INTO                                                   59940074
599500                 :RECITM-ORD-NBR                                  59950074
599600                ,:RECITM-ORD-LNE-NBR                              59960074
599700                ,:RECITM-STATUS-CDE                               59970074
599800                ,:PV-TEMP-MKING-APRON-TMST                        59980074
599900                ,:RECITM-DTL-CK-ITM-QTY                           59990074
600000                ,:RECITM-PKSL-ITM-QTY                             60000074
600100                ,:RECITM-PREPK-RATO-QTY                           60010074
600200                ,:PURITM-PREPK-RATO-QTY                           60020074
600300           FROM                                                   60030074
600400                  TRECITM A                                       60040074
600500                 ,TPURITM B                                       60050074
600600           WHERE                                                  60060074
600700                  A.ORD_NBR           = :DK-ORD-NBR               60070074
600800             AND  A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR          60080074
600900             AND  A.VER_STATUS_CDE    = 'A'                       60090074
601000             AND  A.OPER_UNT_ID       = :DK-OPR-ID                60100074
601100             AND  A.FCLTY_ID          = :DK-FACT                  60110074
601200             AND  A.PREPK_ID          = :DK-PACK-ID               60120074
601300             AND  A.PREPK_DRV_LNE_CDE = 'A'                       60130074
601400             AND  B.PO_NBR            = A.ORD_NBR                 60140074
601500             AND  B.APP_PO_LNE_NBR    = A.ORD_LNE_NBR             60150074
601600             AND  B.VER_STATUS_CDE    = 'A'                       60160074
601700     END-EXEC.                                                    60170074
601800                                                                  60180074
601900     EVALUATE TRUE                                                60190074
602000         WHEN SQLCODE = +0                                        60200074
602100              MOVE RECITM-ORD-LNE-NBR  TO PV-DRV-LINE-NBR         60210074
602200         WHEN SQLCODE = +100                                      60220074
602300              MOVE PC-DEFAULT-TMST                                60230074
602400                               TO PV-TEMP-MKING-APRON-TMST        60240074
602500         WHEN SQLCODE = -904                                      60250074
602600         WHEN SQLCODE = -911                                      60260074
602700         WHEN SQLCODE = -913                                      60270074
602800              PERFORM 9900-SOFT-ABORT                             60280074
602900         WHEN OTHER                                               60290074
603000              MOVE '5412-RETRIEVE-DRIVER-LINE'                    60300074
603100                               TO DP013-PARAGRAPH                 60310074
603200              MOVE 'UNSUCCESSFUL SELECT ON REC ITEM'              60320074
603300                               TO DP013-MESSAGE-TEXT (1)          60330074
603400              MOVE SQLCA       TO DP013-SQLCA                     60340074
603500              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        60350074
603600              PERFORM 9950-FORMAT-ERROR-MSG                       60360074
603700              SET DP013-DB2-ABEND                                 60370074
603800                  DP013-XCTL-DISPLAY-RESTART                      60380074
603900                               TO TRUE                            60390074
604000              PERFORM DP013-0000-PROCESS-ABEND                    60400074
604100     END-EVALUATE.                                                60410074
604200                                                                  60420074
604300                                                                  60430074
604400*----------------------------------------------------------------*60440074
604500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE - RC013.        *60450074
604600*----------------------------------------------------------------*60460074
604700                                                                  60470074
604800 5215-WRITE-SEL-QUEUE.                                            60480074
604900                                                                  60490074
605000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            60500074
605100                                   TO RC013-SELECTED-ITEMS.       60510074
605200                                                                  60520074
605300     EXEC CICS                                                    60530074
605400          WRITEQ TS                                               60540074
605500              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      60550074
605600              FROM  (RC013-DC-SELECT-RECORD)                      60560074
605700              ITEM  (PV-SEL-QUEUE-ITEM)                           60570074
605800              RESP  (PV-CICS-RESP)                                60580074
605900     END-EXEC.                                                    60590074
606000                                                                  60600074
606100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          60610074
606200         CONTINUE                                                 60620074
606300     ELSE                                                         60630074
606400         SET DP013-CICS-ABEND      TO TRUE                        60640074
606500         SET DP013-NO-ROLLBACK     TO TRUE                        60650074
606600         MOVE '5215-WRITE-SEL-QUEUE'                              60660074
606700                                   TO DP013-PARAGRAPH             60670074
606800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          60680074
606900                                   TO DP013-MESSAGE-TEXT(1)       60690074
607000         PERFORM DP013-0000-PROCESS-ABEND                         60700074
607100     END-IF.                                                      60710074
607200                                                                  60720074
607300/                                                                 60730074
607400*----------------------------------------------------------------*60740074
607500*    DETERMINE WHAT LINES WHERE SELECTED AND WHAT FIELDS NEED TO *60750074
607600*    BE UPDATED.                                                 *60760074
607700*----------------------------------------------------------------*60770074
607800 5250-FILL-SEL-QUEUE-RECORD2.                                     60780074
607900                                                                  60790074
608000     PERFORM 6112-READ-LIST-QUEUE.                                60800074
608100                                                                  60810074
608200* GOING TO STORE DISTRO BY PACK AND ADD LINE                      60820074
608300* WILL SEND THROUGH ONLY 1 LINE THROUGH TEMP STORAGE AREA         60830074
608400* ALWAYS                                                          60840074
608500*  IF GOING TO THE STORE DISTRO BY PACK SCREEN, SEND THE DRIVER   60850074
608600*  LINE NUMBER.                                                   60860074
608700                                                                  60870074
608800     EVALUATE TRUE                                                60880074
608900        WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               60890074
609000        WHEN DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)               60900074
609100           SET RC801-IDX         TO +1                            60910074
609200           INITIALIZE RC801-SELECTED-ITEM-ARRAY                   60920074
609300           MOVE +1               TO                               60930074
609400                                  RC800-NUMBER-OF-SELECTED-ITEMS  60940074
609500                                  RC800-NUMBER-OF-TS-ITEMS        60950074
609600           PERFORM 4100-PREPARE-CURSOR                            60960074
609700           PERFORM 5214-RETRIEVE-DRIVER-LINE                      60970074
609800           MOVE PV-DRV-LINE-NBR    TO RC801-REC-LNE-NBR           60980074
609900                                                      (RC801-IDX) 60990074
610000           MOVE ASC-PACK-ID        TO RC801-PACK-ID(RC801-IDX)    61000074
610100           MOVE ASC-PACK-DESC      TO RC801-PACK-DESC(RC801-IDX)  61010074
610200           MOVE LQW-LIST-ITEM-NUMBER (1)                          61020074
610300                                   TO RC801-ITEM (RC801-IDX)      61030074
610400           MOVE SPACES             TO RC801-ACTION-SW (RC801-IDX) 61040074
610500           MOVE ASC-NOTIF-NBR      TO RC801-TRBL-NOTIF-NBR        61050074
610600                                                      (RC801-IDX) 61060074
610700           PERFORM 5204-WRITE-SEL-QUEUE2                          61070074
610800                                                                  61080074
610900        WHEN OTHER                                                61090074
611000          IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                   61100074
611100             PERFORM                                              61110074
611200             VARYING LQW-IDX                                      61120074
611300             FROM 1 BY 1                                          61130074
611400             UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL        61140074
611500               OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO      61150074
611600                                                                  61160074
611700               IF (LQW-SELECT (LQW-IDX))                          61170074
611800                  ADD +1                TO                        61180074
611900                                   RC800-NUMBER-OF-SELECTED-ITEMS 61190074
612000                  MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)             61200074
612100                                        TO RC801-ITEM (RC801-IDX) 61210074
612200                  MOVE SPACES           TO RC801-ACTION-SW        61220074
612300                                                   (RC801-IDX)    61230074
612400                  MOVE LQW-LINE-NUMBER (LQW-IDX)                  61240074
612500                                        TO RC801-REC-LNE-NBR      61250074
612600                                                      (RC801-IDX) 61260074
612700                  MOVE ASC-PACK-ID      TO RC801-PACK-ID          61270074
612800                                                      (RC801-IDX) 61280074
612900                  IF LQW-REC-LINE-STATUS (LQW-IDX) = 'VE'         61290074
613000                     SET PS-LINE-VERIFIED                         61300074
613100                                        TO TRUE                   61310074
613200                 END-IF                                           61320074
613300                 IF LQW-CASEPACK-SPLIT-YES (LQW-IDX)              61330074
613400                    SET PS-DISTHD-EXISTS                          61340074
613500                                        TO TRUE                   61350074
613600                 END-IF                                           61360074
613700                                                                  61370074
613800                 SET RC801-IDX UP BY 1                            61380074
613900                 IF  RC801-IDX > RC801-MAX-ITEMS                  61390074
614000                     PERFORM 5204-WRITE-SEL-QUEUE2                61400074
614100                     ADD +1        TO RC800-NUMBER-OF-TS-ITEMS    61410074
614200                     INITIALIZE RC801-SELECTED-ITEM-ARRAY         61420074
614300                     SET RC801-IDX TO 1                           61430074
614400                 END-IF                                           61440074
614500             END-IF                                               61450074
614600         END-PERFORM                                              61460074
614700       END-IF                                                     61470074
614800     END-EVALUATE.                                                61480074
614900                                                                  61490074
615000     MOVE PV-ITEM TO PV-SAVE-ITEM.                                61500074
615100     PERFORM 6111-WRITE-LIST-QUEUE.                               61510074
615200                                                                  61520074
615300                                                                  61530074
615400*----------------------------------------------------------------*61540074
615500*    DETERMINE WHAT LINES WHERE SELECTED AND WHAT FIELDS NEED TO *61550074
615600*    BE UPDATED.                                                 *61560074
615700*----------------------------------------------------------------*61570074
615800 5300-UPDATE-PROCESS.                                             61580074
615900                                                                  61590074
616000     SET PS-PACK-NOT-EMPTY     TO TRUE.                           61600074
616100                                                                  61610074
616200* DETERMINE IF THE USER IS RE-INSTATING A REMOVED PACK.           61620074
616300* THIS WILL BE USEFUL LATER IN DETERMINING IF A REDISTRO SHOULD   61630074
616400* BE DONE OR A REDISTRO                                           61640074
616500     PERFORM 2170-DETERMINE-IF-PACK.                              61650074
616600     IF PV-PACK-LINE-COUNT = 0                                    61660074
616700        SET PS-EMPTY-PACK      TO TRUE.                           61670074
616800                                                                  61680074
616900     SET PV-QTY-IDX             TO +1                             61690074
617000                                                                  61700074
617100                                                                  61710074
617200     PERFORM 5310-PERFORM-NUMERIC-CHECK                           61720074
617300         VARYING PV-ITEM  FROM 1 BY 1                             61730074
617400         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN.               61740074
617500                                                                  61750074
617600     IF PS-NO-ERROR                                               61760074
617700        PERFORM 5500-LOAD-N-CALL-VALIDATION                       61770074
617800                                                                  61780074
617900        PERFORM 5314-EDIT-UPDATE-SELECTION                        61790074
618000            VARYING PV-ITEM  FROM 1 BY 1                          61800074
618100            UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN             61810074
618200     END-IF                                                       61820074
618300                                                                  61830074
618400     IF (ASC-UPDATE-NOT-PENDING OR                                61840074
618500         ASC-QUICKCALC-FUNCTION) AND                              61850074
618600        PS-NO-ERROR                                               61860074
618700                                                                  61870074
618800        IF ASC-UPDATE-FUNCTION                                    61880074
618900           MOVE ASC-BEST-CASE-PACKS                               61890074
619000                                   TO ASC-PREV-BEST-CASE-PACKS    61900074
619100        END-IF                                                    61910074
619200                                                                  61920074
619300        PERFORM 5214-RETRIEVE-DRIVER-LINE                         61930074
619400                                                                  61940074
619500     IF ASC-UPDATE-NOT-PENDING AND                                61950074
619600        PS-NO-ERROR            AND                                61960074
619700        ASC-UPDATE-FUNCTION                                       61970074
619800                                                                  61980074
619900        PERFORM                                                   61990074
620000          VARYING PV-VALID-IDX                                    62000074
620100          FROM 1 BY 1                                             62010074
620200             UNTIL PV-VALID-IDX > RC806-NBR-OF-LINES              62020074
620300                OR PV-VALID-IDX  > 500                            62030074
620400                                                                  62040074
620500            SET PS-UPDATE-NOT-NEEDED                              62050074
620600                                    TO TRUE                       62060074
620700            PERFORM 9010-DETERMINE-UPDATE                         62070074
620800            IF SQLCODE = +0  AND                                  62080074
620900               PS-UPDATE-NEEDED                                   62090074
621000               MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER           62100074
621100               SET DP020-MSG-INFORMATIONAL                        62110074
621200                                    TO TRUE                       62120074
621300            END-IF                                                62130074
621400        END-PERFORM.                                              62140074
621500                                                                  62150074
621600     IF ASC-UPDATE-NOT-PENDING AND                                62160074
621700        PS-NO-ERROR            AND                                62170074
621800        ASC-UPDATE-FUNCTION                                       62180074
621900        IF SQLCODE = +0 AND                                       62190074
622000           ASC-CALL-REDISTRO                                      62200074
622100             PERFORM 6500-PROCESS-REDISTRO                        62210074
622200        ELSE                                                      62220074
622300           INITIALIZE TM500-FIELDS                                62230074
622400                                                                  62240074
622500           SET TM500-PREPACK-EDIT-ONLY                            62250074
622600               TM500-NO-DETAILS                                   62260074
622700               TM500-REDISTRO-YES                                 62270074
622800               TM500-PACK-LEVEL    TO TRUE                        62280074
622900                                                                  62290074
623000               PERFORM 6600-CHECK-FOR-TROUBLE                     62300074
623100        END-IF.                                                   62310074
623200                                                                  62320074
623300                                                                  62330074
623400*----------------------------------------------------------------*62340074
623500* PERFORM NUMERIC CHECK ON ENTERED FIELDS                        *62350074
623600*----------------------------------------------------------------*62360074
623700 5310-PERFORM-NUMERIC-CHECK.                                      62370074
623800                                                                  62380074
623900     PERFORM 6112-READ-LIST-QUEUE.                                62390074
624000                                                                  62400074
624100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           62410074
624200         PERFORM VARYING LQW-IDX  FROM 1 BY 1                     62420074
624300         UNTIL LQW-IDX > PC-ITEMS-PER-PANEL          OR           62430074
624400         LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO                    62440074
624500                                                                  62450074
624600           IF LQW-SELECT (LQW-IDX)                                62460074
624700              SET PV-LINE-SELECTED (PV-QTY-IDX)                   62470074
624800                                      TO TRUE                     62480074
624900              PERFORM 5415-CHECK-FOR-NUMERIC                      62490074
625000           END-IF                                                 62500074
625100                                                                  62510074
625200           MOVE PV-ITEM               TO PV-SAVE-ITEM             62520074
625300           SET PV-QTY-IDX UP BY 1                                 62530074
625400           PERFORM 6111-WRITE-LIST-QUEUE                          62540074
625500       END-PERFORM                                                62550074
625600     END-IF.                                                      62560074
625700                                                                  62570074
625800                                                                  62580074
625900*----------------------------------------------------------------*62590074
626000* DETERMINE WHAT LINES WHERE SELECTED AND WHAT FIELDS NEED TO BE *62600074
626100* UPDATED.                                                       *62610074
626200* FIELD  PV-LINE-SELECTED WILL BE USED LATER IN THE PROCESS TO   *62620074
626300* TO DETERMINE WHICH LINES NEED TO HAVE THE RATIO AND/OR DETAIL  *62630074
626400* UNITS TO BE UPDATED IF THOSE LINES WERE SELECTED BY THE USER.  *62640074
626500* LINES THAT WERE NOT SELECTED WILL NOT HAVE THEIR RATIO OR      *62650074
626600* DETAIL UNITS UPDATED AT THIS TIME.  CHANGES WILL BE IGNORED.   *62660074
626700* OTHER LINES THAT WERE NOT SELECTED, MAY HAVE THEIR ODD UNTITS  *62670074
626800* AND/OR DRIVER LINE INDICATOR UPDATED DUE TO THE CHANGES.       *62680074
626900*----------------------------------------------------------------*62690074
627000 5314-EDIT-UPDATE-SELECTION.                                      62700074
627100                                                                  62710074
627200     PERFORM 6112-READ-LIST-QUEUE.                                62720074
627300                                                                  62730074
627400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           62740074
627500         PERFORM VARYING LQW-IDX  FROM 1 BY 1                     62750074
627600         UNTIL LQW-IDX > PC-ITEMS-PER-PANEL          OR           62760074
627700         LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO                    62770074
627800                                                                  62780074
627900           SET PV-LINE-NOT-SELECTED (PV-QTY-IDX)                  62790074
628000                                   TO TRUE                        62800074
628100           PERFORM 5410-COMMON-LINE-LEVEL-EDITS                   62810074
628200                                                                  62820074
628300           SET LQW-QC-NO-HIGHLIGHT (LQW-IDX)                      62830074
628400                                   TO TRUE                        62840074
628500                                                                  62850074
628600           IF LQW-SELECT (LQW-IDX)                                62860074
628700*    MAKE SURE ON AN UPDATE THAT ALL  RATIO > 0                   62870074
628800              IF LQW-DTL-PACK-RATIO-N (LQW-IDX) = ZERO            62880074
628900                 SET LQW-LINE-ERROR (LQW-IDX)                     62890074
629000                                        TO TRUE                   62900074
629100                 MOVE PC-TSYMSG-02179   TO DP020-MSG-NUMBER       62910074
629200              END-IF                                              62920074
629300                                                                  62930074
629400*    MAKE SURE ON AN UPDATE THAT ALL  QTY   > 0                   62940074
629500              IF LQW-DTL-PACK-UNITS-N (LQW-IDX) = ZERO AND        62950074
629600                 RECITM-DTL-CK-ITM-QTY NOT = ZERO                 62960074
629700                 SET LQW-QTY-ERROR (LQW-IDX)                      62970074
629800                                            TO TRUE               62980074
629900                 MOVE PC-TSYMSG-00854       TO DP020-MSG-NUMBER   62990074
630000              END-IF                                              63000074
630100                                                                  63010074
630200              IF NOT LQW-QTY-ERROR (LQW-IDX)                      63020074
630300                 PERFORM 5315-DETERMINE-REDISTRO-MSG              63030074
630400              END-IF                                              63040074
630500          END-IF                                                  63050074
630600                                                                  63060074
630700                                                                  63070074
630800* IF NO ERRORS AND THE USER CONFIRMED (F2) THE UPDATE             63080074
630900            IF LQW-LINE-NO-ERROR (LQW-IDX)        AND             63090074
631000               (DP020-FK-CONFIRM (DP020-SRC-AID)  AND             63100074
631100                ASC-UPDATE-PENDING)                               63110074
631200                 SET LQW-DESELECT (LQW-IDX)                       63120074
631300                     ASC-UPDATE-NOT-PENDING                       63130074
631400                                  TO TRUE                         63140074
631500                 MOVE LQW-SELECTED-SW (LQW-IDX)                   63150074
631600                                  TO LQW-TEMP-SELECTED-SW         63160074
631700                                                         (LQW-IDX)63170074
631800                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              63180074
631900                    SUBTRACT 1 FROM                               63190074
632000                                ASC-NUMBER-OF-SELECTED-ITEMS      63200074
632100                 END-IF                                           63210074
632200            ELSE                                                  63220074
632300               IF (LQW-LINE-NO-ERROR (LQW-IDX)        AND         63230074
632400                   LQW-QTY-NO-ERROR (LQW-IDX))       AND          63240074
632500                   NOT ASC-UPDATE-PENDING                         63250074
632600                   ADD +1    TO RC800-NUMBER-OF-TS-ITEMS          63260074
632700               ELSE                                               63270074
632800                 IF LQW-LINE-ERROR (LQW-IDX)   OR                 63280074
632900                    LQW-QTY-ERROR (LQW-IDX)                       63290074
633000                    MOVE  'Y'  TO LQW-BLOCK-MODIFIED              63300074
633100                    SET PS-EDIT-BEFORE-MOVE                       63310074
633200                        PS-BLOCK-ERROR                            63320074
633300                        DP020-MSG-WARNING                         63330074
633400                        DP030-SET-CURSOR-APPL-1                   63340074
633500                        PS-ERROR   TO TRUE                        63350074
633600                 END-IF                                           63360074
633700               END-IF                                             63370074
633800            END-IF                                                63380074
633900                                                                  63390074
634000                                                                  63400074
634100           MOVE PV-ITEM               TO PV-SAVE-ITEM             63410074
634200           SET PV-QTY-IDX UP BY 1                                 63420074
634300           PERFORM 6111-WRITE-LIST-QUEUE                          63430074
634400       END-PERFORM                                                63440074
634500     END-IF.                                                      63450074
634600                                                                  63460074
634700*----------------------------------------------------------------*63470074
634800*   THE MESSAGE THAT APPEARS TO THE USER ABOUT WHAT EFFECT THE   *63480074
634900*   REDISTRO WILL TAKE                                           *63490074
635000*----------------------------------------------------------------*63500074
635100 5315-DETERMINE-REDISTRO-MSG.                                     63510074
635200                                                                  63520074
635300     IF RECITM-PREPK-RATO-QTY NOT = LQW-DTL-PACK-RATIO-N (LQW-IDX)63530074
635400        IF RECITM-DTL-CK-ITM-QTY =  LQW-DTL-PACK-UNITS-N(LQW-IDX) 63540074
635500           SET ASC-RATIO-ONLY-CHANGE  TO TRUE                     63550074
635600        ELSE                                                      63560074
635700           SET ASC-RATIO-UNIT-CHANGE  TO TRUE                     63570074
635800        END-IF                                                    63580074
635900     ELSE                                                         63590074
636000        IF RECITM-DTL-CK-ITM-QTY NOT =                            63600074
636100                                    LQW-DTL-PACK-UNITS-N(LQW-IDX) 63610074
636200           SET ASC-UNITS-ONLY-CHANGE  TO TRUE                     63620074
636300        END-IF.                                                   63630074
636400                                                                  63640074
636500*   ISSUE WARNING TO THE USER IF THEY CHANGED THE PACK RATIO AND  63650074
636600*   NOT THE DTL PACK UNITS.  F2 TO CONFIRM THE DECISION.          63660074
636700     IF ASC-UPDATE-FUNCTION AND                                   63670074
636800        NOT DP020-FK-CONFIRM (DP020-SRC-AID)    AND               63680074
636900        LQW-LINE-NO-ERROR (LQW-IDX)                               63690074
637000                                                                  63700074
637100        EVALUATE TRUE                                             63710074
637200          WHEN ASC-RATIO-ONLY-CHANGE                              63720074
637300            IF ASC-PREV-BEST-CASE-PACKS = ASC-BEST-CASE-PACKS     63730074
637400               AND NOT PS-EMPTY-PACK                              63740074
637500                SET ASC-UPDATE-PENDING                            63750074
637600                    ASC-CALL-STORE-ADJ                            63760074
637700                    LQW-LINE-ERROR (LQW-IDX)                      63770074
637800                                  TO TRUE                         63780074
637900* RATIO CHANGED BUT NOT DTL UNITS-F2 TO CONFIRM UPD AND STORE ADJ 63790074
638000                   MOVE PC-TSYMSG-02172                           63800074
638100                                  TO DP020-MSG-NUMBER             63810074
638200            ELSE                                                  63820074
638300* RATIO CHANGED BUT NOT DTL UNITS-F2 TO CONFIRM UPD AND REDISTRO  63830074
638400*  SINCE BEST CASE PACKS CHANGED OR RE-INSTATING A DELETED PACK   63840074
638500                MOVE PC-TSYMSG-02171                              63850074
638600                                TO DP020-MSG-NUMBER               63860074
638700                SET ASC-UPDATE-PENDING                            63870074
638800                    ASC-CALL-REDISTRO                             63880074
638900                    LQW-LINE-ERROR (LQW-IDX)                      63890074
639000                                    TO TRUE                       63900074
639100            END-IF                                                63910074
639200                                                                  63920074
639300          WHEN ASC-RATIO-UNIT-CHANGE                              63930074
639400             IF ASC-PREV-BEST-CASE-PACKS = ASC-BEST-CASE-PACKS    63940074
639500                AND NOT PS-EMPTY-PACK                             63950074
639600* STORE DISTRO WILL BE ADJUSTED TO NEW RATIO - F2 TO CONFIRM      63960074
639700                SET ASC-UPDATE-PENDING                            63970074
639800                    ASC-CALL-STORE-ADJ                            63980074
639900                    LQW-LINE-ERROR (LQW-IDX)                      63990074
640000                                     TO TRUE                      64000074
640100                MOVE PC-TSYMSG-02170 TO DP020-MSG-NUMBER          64010074
640200             ELSE                                                 64020074
640300* REDISTRO WILL BE PERFORMED - F2 TO CONFIRM UPDATE AND REDISTRO  64030074
640400*  BEST CASE HAS CHANGED OR THEY ARE RE-INSTATING A DELETED PACK  64040074
640500               MOVE PC-TSYMSG-02169   TO DP020-MSG-NUMBER         64050074
640600               SET DP020-MSG-INFORMATIONAL                        64060074
640700                   ASC-UPDATE-PENDING                             64070074
640800                   LQW-LINE-ERROR (LQW-IDX)                       64080074
640900                   ASC-CALL-REDISTRO                              64090074
641000                                     TO TRUE                      64100074
641100             END-IF                                               64110074
641200                                                                  64120074
641300          WHEN ASC-UNITS-ONLY-CHANGE                              64130074
641400* REDISTRO WILL BE PERFORMED - F2 TO CONFIRM UPDATE AND REDISTRO  64140074
641500               MOVE PC-TSYMSG-02169   TO DP020-MSG-NUMBER         64150074
641600               SET DP020-MSG-INFORMATIONAL                        64160074
641700                   ASC-UPDATE-PENDING                             64170074
641800                   LQW-LINE-ERROR (LQW-IDX)                       64180074
641900                   ASC-CALL-REDISTRO                              64190074
642000                                    TO TRUE                       64200074
642100     END-EVALUATE.                                                64210074
642200                                                                  64220074
642300     IF ASC-QUICKCALC-FUNCTION AND                                64230074
642400          PS-NO-ERROR                                             64240074
642500             SET LQW-QC-HIGHLIGHT (LQW-IDX)                       64250074
642600                                        TO TRUE                   64260074
642700     END-IF.                                                      64270074
642800                                                                  64280074
642900                                                                  64290074
643000*----------------------------------------------------------------*64300074
643100*    DETERMINE WHAT LINES WHERE SELECTED AND WHAT FIELDS NEED TO *64310074
643200*    BE REMOVED FROM THE PACK                                    *64320074
643300* DETERMINE IF THE DELETED LINE HAS ANY PACKSLIPS, IF THERE ARE   64330074
643400*  PACKSLIPS ON THE LINE, THEN A ROW WILL BE CREATED IN RECDIS    64340074
643500*  TO STORE THE CENTRAL STOCK NUMBER AS THE STORE NUMBER.         64350074
643600*----------------------------------------------------------------*64360074
643700 5400-DELETE-PROCESS.                                             64370074
643800                                                                  64380074
643900     MOVE ' '          TO ASC-CALL-TROUBLE-SW.                    64390074
644000                                                                  64400074
644100     SET PV-QTY-IDX    TO +1                                      64410074
644200                                                                  64420074
644300     PERFORM 5405-EDIT-DELETE-SELECTION                           64430074
644400       VARYING PV-ITEM  FROM 1 BY 1                               64440074
644500         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN.               64450074
644600                                                                  64460074
644700     IF (DP020-FK-CONFIRM (DP020-SRC-AID)  AND                    64470074
644800         ASC-DELETE-PENDING)                                      64480074
644900         SET ASC-DELETE-NOT-PENDING    TO TRUE.                   64490074
645000                                                                  64500074
645100     IF ASC-DELETE-NOT-PENDING AND                                64510074
645200        PS-NO-ERROR                                               64520074
645300                                                                  64530074
645400        IF SQLCODE = +0                                           64540074
645500           PERFORM 5500-LOAD-N-CALL-VALIDATION                    64550074
645600                                                                  64560074
645700           PERFORM 5214-RETRIEVE-DRIVER-LINE                      64570074
645800                                                                  64580074
645900           MOVE ASC-BEST-CASE-PACKS    TO ASC-PREV-BEST-CASE-PACKS64590074
646000                                                                  64600074
646100           PERFORM                                                64610074
646200             VARYING PV-VALID-IDX                                 64620074
646300             FROM 1 BY 1                                          64630074
646400             UNTIL PV-VALID-IDX > RC806-NBR-OF-LINES              64640074
646500                OR PV-VALID-IDX  > 500                            64650074
646600                                                                  64660074
646700               MOVE RC806-PKSL-LNE-NBR (PV-VALID-IDX)             64670074
646800                                         TO DK-LINE-NBR           64680074
646900              PERFORM 2165-DETERMINE-IF-PKSLIP-EXIST              64690074
647000              IF PV-PACKSLIP-COUNT > 0 AND                        64700074
647100                 PV-LINE-SELECTED (PV-VALID-IDX)                  64710074
647200                  MOVE PC-TSYMSG-03244  TO DP020-MSG-NUMBER       64720074
647300                  SET PS-ERROR                                    64730074
647400                      PS-PACKSLIP-EXISTS                          64740074
647500                      DP030-OVERRIDE-GO                           64750074
647600                      ASC-DELETE-NOT-PENDING                      64760074
647700                      DP020-MSG-FATAL   TO TRUE                   64770074
647800               ELSE                                               64780074
647900                 SET PS-UPDATE-NOT-NEEDED                         64790074
648000                                         TO TRUE                  64800074
648100                 IF RC806-RC-RATIO (PV-VALID-IDX) = 0             64810074
648200                     PERFORM 6800-CLEANUP-RECDIS                  64820074
648300                     PERFORM 6820-DELETE-ODD-UNIT                 64830074
648400                     PERFORM 6900-SELECT-PKSL-QTY                 64840074
648500                     IF SQLCODE = +0                              64850074
648600                           PERFORM 6920-DELETE-TWRKORD            64860074
648700                           PERFORM 6930-DELETE-TWKORIN            64870074
648800*                          PERFORM 6940-DELETE-TWOSTAL            64880099
648900                                                                  64890074
649000                           PERFORM 6950-CLEANUP-TRECITM           64900074
649100                           IF NOT ASC-CALL-TROUBLE                64910074
649200                              SET ASC-DONT-CALL-TROUBLE           64920074
649300                                        TO TRUE                   64930074
649400                      END-IF                                      64940074
649500                 ELSE                                             64950074
649600                     SET  ASC-CALL-REDISTRO                       64960074
649700                                       TO TRUE                    64970074
649800                     PERFORM 9010-DETERMINE-UPDATE                64980074
649900                 END-IF                                           64990074
650000                                                                  65000074
650100                 PERFORM 6850-DELETE-TRB-LINE                     65010074
650200                                                                  65020074
650300                 IF SQLCODE = +0                                  65030074
650400                 AND PS-UPDATE-NEEDED                             65040074
650500                     MOVE PC-TSYMSG-00059                         65050074
650600                                       TO DP020-MSG-NUMBER        65060074
650700                     SET DP020-MSG-INFORMATIONAL                  65070074
650800                                       TO TRUE                    65080074
650900                 END-IF                                           65090074
651000                 SET ASC-UPDATE-NOT-PENDING                       65100074
651100                                       TO TRUE                    65110074
651200              END-IF                                              65120074
651300              SET  ASC-CALL-REDISTRO  TO TRUE                     65130074
651400              PERFORM 9010-DETERMINE-UPDATE                       65140074
651500            END-IF                                                65150074
651600           END-PERFORM                                            65160074
651700                                                                  65170074
651800           IF PS-PACKSLIP-EXISTS                                  65180074
651900              CONTINUE                                            65190074
652000           ELSE                                                   65200074
652100              PERFORM 4100-PREPARE-CURSOR                         65210074
652200              PERFORM 2170-DETERMINE-IF-PACK                      65220074
652300              IF PV-PACK-LINE-COUNT = 0                           65230074
652400                 PERFORM 6860-DELETE-TRB-PACK                     65240074
652500              ELSE                                                65250074
652600              IF ASC-CALL-TROUBLE                                 65260074
652700                 INITIALIZE TM500-FIELDS                          65270074
652800                                                                  65280074
652900                 SET TM500-PREPACK-EDIT-ONLY                      65290074
653000                     TM500-NO-DETAILS                             65300074
653100                     TM500-REDISTRO-YES                           65310074
653200                     TM500-PACK-LEVEL TO TRUE                     65320074
653300                                                                  65330074
653400                 PERFORM 6600-CHECK-FOR-TROUBLE                   65340074
653500         END-IF.                                                  65350074
653600*----------------------------------------------------------------*65360074
653700*    DETERMINE WHAT LINES WHERE SELECTED AND WHAT FIELDS NEED TO *65370074
653800*    BE "REMOVED" FROM THE PACK.                                 *65380074
653900*----------------------------------------------------------------*65390074
654000 5405-EDIT-DELETE-SELECTION.                                      65400074
654100                                                                  65410074
654200     PERFORM 6112-READ-LIST-QUEUE.                                65420074
654300                                                                  65430074
654400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           65440074
654500         PERFORM                                                  65450074
654600         VARYING LQW-IDX  FROM 1 BY 1                             65460074
654700         UNTIL LQW-IDX > PC-ITEMS-PER-PANEL          OR           65470074
654800               LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO              65480074
654900                                                                  65490074
655000               PERFORM 5410-COMMON-LINE-LEVEL-EDITS               65500074
655100                                                                  65510074
655200               SET PV-LINE-NOT-SELECTED (PV-QTY-IDX)              65520074
655300                                     TO TRUE                      65530074
655400               IF LQW-SELECT (LQW-IDX)                            65540074
655500                  SET PV-LINE-SELECTED (PV-QTY-IDX)               65550074
655600                                     TO TRUE                      65560074
655700                  IF (DP020-FK-CONFIRM (DP020-SRC-AID)  AND       65570074
655800                      ASC-DELETE-PENDING)                         65580074
655900                       MOVE +0         TO LQW-DTL-PACK-RATIO-N    65590074
656000                                                        (LQW-IDX) 65600074
656100                       MOVE +1         TO LQW-DTL-PACK-UNITS-N    65610074
656200                                                     (LQW-IDX)    65620074
656300                  END-IF                                          65630074
656400                  IF NOT DP020-FK-CONFIRM (DP020-SRC-AID)         65640074
656500* IF ALL LINES WITHIN PACK ARE SELECTED TO BE DELETED, PUT        65650074
656600* OUT A WARNING MESSAGE AS SUCH                                   65660074
656700                     IF ASC-NUMBER-OF-SELECTED-ITEMS =            65670074
656800                                       ASC-NUMBER-OF-ITEMS-READ   65680074
656900                        MOVE PC-TSYMSG-02180                      65690074
657000                                    TO DP020-MSG-NUMBER           65700074
657100                        SET DP020-MSG-INFORMATIONAL               65710074
657200                                   TO TRUE                        65720074
657300                        SET ASC-DELETE-PENDING                    65730074
657400                                    TO TRUE                       65740074
657500                     ELSE                                         65750074
657600*  CHECK IF THE LINE WAS CREATED BY PKSLIP, IF SO, DO NOT ALLOW   65760074
657700*  THE DELETE OF IT.                                              65770074
657800              MOVE LQW-LINE-NUMBER (LQW-IDX)                      65780074
657900                                        TO DK-LINE-NBR            65790074
658000              PERFORM 2165-DETERMINE-IF-PKSLIP-EXIST              65800074
658100              IF PV-PACKSLIP-COUNT > 0 AND                        65810074
658200                 PV-LINE-SELECTED (PV-QTY-IDX)                    65820074
658300                  MOVE PC-TSYMSG-03244  TO DP020-MSG-NUMBER       65830074
658400                  SET PS-ERROR                                    65840074
658500                      DP030-OVERRIDE-GO                           65850074
658600                      ASC-DELETE-NOT-PENDING                      65860074
658700                      DP020-MSG-FATAL   TO TRUE                   65870074
658800              ELSE                                                65880074
658900*  DELETE PENDING - F2 TO CONFIRM                                 65890074
659000                        MOVE PC-TSYMSG-00354                      65900074
659100                                    TO DP020-MSG-NUMBER           65910074
659200                        SET DP020-MSG-INFORMATIONAL               65920074
659300                                   TO TRUE                        65930074
659400                        SET ASC-DELETE-PENDING                    65940074
659500                                    TO TRUE                       65950074
659600                     END-IF                                       65960074
659700                  END-IF                                          65970074
659800                                                                  65980074
659900                  IF LQW-LINE-NO-ERROR (LQW-IDX)        AND       65990074
660000                     (DP020-FK-CONFIRM (DP020-SRC-AID)  AND       66000074
660100                      ASC-DELETE-PENDING)                         66010074
660200                        SET LQW-DESELECT (LQW-IDX)                66020074
660300                                    TO TRUE                       66030074
660400                        MOVE LQW-SELECTED-SW (LQW-IDX)            66040074
660500                                    TO LQW-TEMP-SELECTED-SW       66050074
660600                                                         (LQW-IDX)66060074
660700* FIRST UPDATE THE DELETED ROWS FROM TRECITM                      66070074
660800                        PERFORM 5214-RETRIEVE-DRIVER-LINE         66080074
660900                        PERFORM 4100-PREPARE-CURSOR               66090074
661000                        MOVE LQW-LINE-NUMBER (LQW-IDX)            66100074
661100                                     TO DK-LINE-NBR               66110074
661200                                                                  66120074
661300                        PERFORM 5406-PERFORM-AUDIT                66130074
661400*  IF PREVIOUS DRIVER LINE IS THE LINE THAT IS BEING DELETED,     66140074
661500* CHANGE THE INDICATOR FOR THIS LINE TO AN "I"                    66150074
661600                        IF RECITM-ORD-LNE-NBR = DK-LINE-NBR       66160074
661700                           MOVE 'I'  TO RECITM-PREPK-DRV-LNE-CDE  66170074
661800                        END-IF                                    66180074
661900                                                                  66190074
662000                        MOVE +1      TO RECITM-DTL-CK-ITM-QTY     66200074
662100                        MOVE +0      TO RECITM-PREPK-ODD-UNT-QTY  66210074
662200                                        RECITM-PREPK-RATO-QTY     66220074
662300                        MOVE PC-DEFAULT-TMST                      66230074
662400                               TO RECITM-MKING-APRON-TMST         66240074
662500                        PERFORM 9012-UPDATE-TRECITM               66250074
662600                                                                  66260074
662700                        IF ASC-NUMBER-OF-SELECTED-ITEMS > 0       66270074
662800                            SUBTRACT 1 FROM                       66280074
662900                                ASC-NUMBER-OF-SELECTED-ITEMS      66290074
663000                        END-IF                                    66300074
663100                    ELSE                                          66310074
663200                    IF LQW-LINE-NO-ERROR (LQW-IDX)        AND     66320074
663300                       NOT ASC-DELETE-PENDING                     66330074
663400                         ADD +1    TO RC800-NUMBER-OF-TS-ITEMS    66340074
663500                    ELSE                                          66350074
663600                    IF LQW-LINE-ERROR (LQW-IDX)                   66360074
663700                       MOVE  'Y'   TO LQW-BLOCK-MODIFIED          66370074
663800                       SET PS-ERROR                               66380074
663900                           LQW-LINE-ERROR (LQW-IDX)               66390074
664000                           PS-EDIT-BEFORE-MOVE                    66400074
664100                           PS-BLOCK-ERROR                         66410074
664200                           DP020-MSG-WARNING                      66420074
664300                           DP030-SET-CURSOR-APPL-1                66430074
664400                                   TO TRUE                        66440074
664500                    END-IF                                        66450074
664600                  END-IF                                          66460074
664700               END-IF                                             66470074
664800               END-IF                                             66480074
664900               END-IF                                             66490074
665000                                                                  66500074
665100               MOVE PV-ITEM               TO PV-SAVE-ITEM         66510074
665200               PERFORM 6111-WRITE-LIST-QUEUE                      66520074
665300               SET PV-QTY-IDX UP BY 1                             66530074
665400         END-PERFORM                                              66540074
665500     END-IF.                                                      66550074
665600                                                                  66560074
665700                                                                  66570074
665800                                                                  66580074
665900*-------------------------------------------------------------*   66590074
666000* PERFORM THE AUDIT CALL                                      *   66600074
666100*-------------------------------------------------------------*   66610074
666200 5406-PERFORM-AUDIT.                                              66620074
666300                                                                  66630074
666400* BEFORE IMAGE                                                    66640074
666500     MOVE 'I'                 TO RC031-TABLE-TO-AUDIT.            66650074
666600     MOVE 'B'                 TO RC031-AUD-TYP-CDE.               66660074
666700     MOVE 'U'                 TO RC031-AUD-FUNC-CDE.              66670074
666800                                                                  66680074
666900     PERFORM 9011-CALL-AUDIT-PROGRAM.                             66690074
667000                                                                  66700074
667100                                                                  66710074
667200*-------------------------------------------------------------*   66720074
667300* PERFORM THE LINE LEVEL EDIT CHECKS                          *   66730074
667400*-------------------------------------------------------------*   66740074
667500 5410-COMMON-LINE-LEVEL-EDITS.                                    66750074
667600                                                                  66760074
667700     SET LQW-LINE-NO-ERROR (LQW-IDX)                              66770074
667800         LQW-QTY-NO-ERROR (LQW-IDX)                               66780074
667900                                 TO TRUE.                         66790074
668000     MOVE LQW-LINE-NUMBER (LQW-IDX)                               66800074
668100                                 TO DK-LINE-NBR.                  66810074
668200     PERFORM 4320-GET-TRECITM-INFO.                               66820074
668300                                                                  66830074
668400*                                                                 66840074
668500*    CHECK TO SEE IF ANY LINE HAS BEEN VERIFIED USING THE TOTAL   66850074
668600*    VERIFIED FIELD.  NO LINE CAN BE UPDATED IF ANY LINE HAS BEEN 66860074
668700*    VERIFIED.                                                    66870074
668800                                                                  66880074
668900     IF LQW-REC-LINE-STATUS (LQW-IDX) = 'CM' OR 'VE'              66890074
669000            MOVE PC-TSYMSG-00929 TO DP020-MSG-NUMBER              66900074
669100            SET LQW-LINE-ERROR (LQW-IDX)                          66910074
669200                                 TO TRUE.                         66920074
669300     IF LQW-CASEPACK-SPLIT-YES   (LQW-IDX)                        66930074
669400            MOVE PC-TSYMSG-01795 TO DP020-MSG-NUMBER              66940074
669500            SET LQW-LINE-ERROR (LQW-IDX)                          66950074
669600                                 TO TRUE.                         66960074
669700                                                                  66970074
669800     IF (RECITM-RCPT-DISTR-UPD-CDE = PC-A OR                      66980074
669900         RECITM-RCPT-DISTR-UPD-CDE = PC-U)                        66990074
670000          MOVE PC-TSYMSG-01256 TO DP020-MSG-NUMBER                67000074
670100          SET LQW-LINE-ERROR (LQW-IDX)                            67010074
670200                                 TO TRUE.                         67020074
670300                                                                  67030074
670400                                                                  67040074
670500*-------------------------------------------------------------*   67050074
670600* MAKE SURE THAT THE ENTRY FIELDS ARE NUMERIC                 *   67060074
670700*-------------------------------------------------------------*   67070074
670800 5415-CHECK-FOR-NUMERIC.                                          67080074
670900                                                                  67090074
671000         MOVE LQW-DTL-PACK-RATIO (LQW-IDX)                        67100074
671100                                   TO DP010I-UNEDITED-FIELD       67110074
671200         MOVE +3                   TO DP010I-MAXIMUM-DIGITS       67120074
671300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     67130074
671400         SET DP010I-NEGATIVE-NOT-ALLOWED                          67140074
671500                                   TO TRUE                        67150074
671610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         67161099
671620              USING DP010I-NUMERIC-EDIT-AREA                      67162099
671700                                                                  67170074
671800         IF NOT DP010I-ERROR-DETECTED AND                         67180074
671900            NOT DP010I-INVALID-CHARACTER                          67190074
672000             MOVE DP010I-NUMERIC-FIELD                            67200074
672100                                   TO                             67210074
672200                                  LQW-DTL-PACK-RATIO-N (LQW-IDX)  67220074
672300         ELSE                                                     67230074
672400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            67240074
672500             SET DP020-MSG-FATAL                                  67250074
672600                 LQW-LINE-ERROR (LQW-IDX)                         67260074
672700                 PS-BLOCK-ERROR                                   67270074
672800                 PS-ERROR          TO TRUE                        67280074
672900         END-IF.                                                  67290074
673000                                                                  67300074
673100         MOVE LQW-DTL-PACK-UNITS (LQW-IDX)                        67310074
673200                                   TO DP010I-UNEDITED-FIELD       67320074
673300         MOVE +5                   TO DP010I-MAXIMUM-DIGITS       67330074
673400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     67340074
673500         SET DP010I-NEGATIVE-NOT-ALLOWED                          67350074
673600                                   TO TRUE                        67360074
673710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         67371099
673720              USING DP010I-NUMERIC-EDIT-AREA                      67372099
673800                                                                  67380074
673900         IF NOT DP010I-ERROR-DETECTED    AND                      67390074
674000            NOT DP010I-INVALID-CHARACTER                          67400074
674100             MOVE DP010I-NUMERIC-FIELD                            67410074
674200                                   TO                             67420074
674300                                   LQW-DTL-PACK-UNITS-N (LQW-IDX) 67430074
674400         ELSE                                                     67440074
674500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            67450074
674600             SET DP020-MSG-FATAL                                  67460074
674700                 LQW-QTY-ERROR (LQW-IDX)                          67470074
674800                 PS-BLOCK-ERROR                                   67480074
674900                 PS-ERROR          TO TRUE                        67490074
675000         END-IF.                                                  67500074
675100                                                                  67510074
675200/                                                                 67520074
675300*                                                                 67530074
675400*----------------------------------------------------------------*67540074
675500*    LOADS UP THE DATA AND CALLS THE VALIDATION ROUTINE          *67550074
675600*   (RCKCS806) ON AN UPDATE AND DELETE.                          *67560074
675700*----------------------------------------------------------------*67570074
675800                                                                  67580074
675900 5500-LOAD-N-CALL-VALIDATION.                                     67590074
676000                                                                  67600074
676100        MOVE +1                 TO ASC-BLK-SUB                    67610074
676200                                   PV-BLOCK-NUMBER                67620074
676300                                   ASC-ITEM-SUB.                  67630074
676400                                                                  67640074
676500        PERFORM 4410-READ-TEMP-STORAGE                            67650074
676600        ADD  +1                 TO ASC-BLK-SUB                    67660074
676700                                   PV-BLOCK-NUMBER.               67670074
676800        PERFORM 4410-READ-TEMP-STORAGE.                           67680074
676900                                                                  67690074
677000        INITIALIZE RC806-PRODUCT-PACK-VALIDATION.                 67700074
677100                                                                  67710074
677200                                                                  67720074
677300         MOVE +1                 TO ASC-BLK-SUB                   67730074
677400                                    PV-BLOCK-NUMBER.              67740074
677500         MOVE +0                 TO ASC-SEL-SUB.                  67750074
677600                                                                  67760074
677700         SET  PS-UPDATE-CONFIRM     TO TRUE.                      67770074
677800                                                                  67780074
677900         PERFORM 5510-LOAD-VALID-INFO                             67790074
678000            VARYING ASC-ITEM-SUB                                  67800074
678100               FROM 1 BY 1                                        67810074
678200              UNTIL ASC-ITEM-SUB > ASC-NUMBER-OF-ITEMS-READ       67820074
678300                 OR PV-VALID-IDX > ASC-NUMBER-OF-ITEMS-READ       67830074
678400                 OR PV-VALID-IDX > 500.                           67840074
678500                                                                  67850074
678600         SET  PS-UPDATE-NOT-CONFIRM TO TRUE.                      67860074
678700                                                                  67870074
678800         MOVE +1                    TO ASC-BLK-SUB                67880074
678900                                       PV-BLOCK-NUMBER            67890074
679000                                       ASC-ITEM-SUB.              67900074
679100                                                                  67910074
679200         PERFORM 4410-READ-TEMP-STORAGE.                          67920074
679300         ADD  +1                       TO ASC-BLK-SUB             67930074
679400                                          PV-BLOCK-NUMBER.        67940074
679500         PERFORM 4410-READ-TEMP-STORAGE.                          67950074
679600                                                                  67960074
679700         PERFORM 4423-CALL-VALIDATION-MODULE.                     67970074
679800                                                                  67980074
679900                                                                  67990074
680000*----------------------------------------------------------------*68000074
680100*    LOADS DATA INTO THE VALIDATION ROUTINE                      *68010074
680200*----------------------------------------------------------------*68020074
680300                                                                  68030074
680400 5510-LOAD-VALID-INFO.                                            68040074
680500     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        68050074
680600         CONTINUE                                                 68060074
680700     ELSE                                                         68070074
680800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        68080074
680900         ADD +1            TO ASC-BLK-SUB                         68090074
681000         MOVE +1           TO ASC-ITEM-SUB                        68100074
681100                                                                  68110074
681200         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 68120074
681300             MOVE +1       TO ASC-BLK-SUB                         68130074
681400             SET ASC-BLOCK-MODIFIED (1)                           68140074
681500                           TO TRUE                                68150074
681600             PERFORM 5100-WRITE-TEMP-STORAGE                      68160074
681700             ADD +1            TO ASC-BLK-SUB                     68170074
681800             ADD  +1       TO PV-BLOCK-NUMBER                     68180074
681900             SET ASC-BLOCK-MODIFIED (2)                           68190074
682000                           TO TRUE                                68200074
682100             PERFORM 5100-WRITE-TEMP-STORAGE                      68210074
682200             MOVE ASC-BLOCK-ENTRIES                               68220074
682300                       (PC-MAX-BLOCKS-IN-ARRAY)                   68230074
682400                        TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)         68240074
682500             MOVE +1       TO ASC-BLK-SUB                         68250074
682600             ADD  +1       TO PV-BLOCK-NUMBER                     68260074
682700             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           68270074
682800             SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)              68280074
682900                           TO TRUE                                68290074
683000             PERFORM 4410-READ-TEMP-STORAGE                       68300074
683100             ADD  +1       TO ASC-BLK-SUB                         68310074
683200             ADD  +1       TO PV-BLOCK-NUMBER                     68320074
683300             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           68330074
683400             SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)              68340074
683500                           TO TRUE                                68350074
683600             PERFORM 4410-READ-TEMP-STORAGE                       68360074
683700             SUBTRACT +1  FROM ASC-BLK-SUB                        68370074
683800                               PV-BLOCK-NUMBER                    68380074
683900         END-IF.                                                  68390074
684000                                                                  68400074
684100     PERFORM 4421-LOAD-VALIDATION-DATA.                           68410074
684200                                                                  68420074
684300                                                                  68430074
684400                                                                  68440074
684500*----------------------------------------------------------------*68450074
684600* RECORD IN THE SELECTION TEMP STORAGE QUEUE THAT THIS OBJECT    *68460074
684700* WAS UPDATED.                                                   *68470074
684800*----------------------------------------------------------------*68480074
684900 5600-UPDATE-SELECTION-QUEUE.                                     68490074
685000                                                                  68500074
685100     ADD +1                    TO ASC-SEL-SUB.                    68510074
685200     IF ASC-SEL-SUB > RC801-MAX-ITEMS                             68520074
685300         ADD +1                TO ASC-SEL-ITEM                    68530074
685400         MOVE +1               TO ASC-SEL-SUB.                    68540074
685500                                                                  68550074
685600     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 68560074
685700         PERFORM 9100-READ-SEL-QUEUE                              68570074
685800         IF RC801-PACK-ID  (ASC-SEL-SUB) = ASC-PACK-ID            68580074
685900             SET RC801-UPD (ASC-SEL-SUB)                          68590074
686000                               TO TRUE                            68600074
686100             PERFORM 5214-RETRIEVE-DRIVER-LINE                    68610074
686200             IF RECITM-DTL-CK-ITM-QTY > 0  AND                    68620074
686300                RECITM-PREPK-RATO-QTY > 0                         68630074
686400                 COMPUTE RC801-DTL-PACK-QTY (ASC-SEL-SUB) =       68640074
686500                            RECITM-DTL-CK-ITM-QTY /               68650074
686600                            RECITM-PREPK-RATO-QTY                 68660074
686700             ELSE                                                 68670074
686800                 MOVE +0       TO RC801-DTL-PACK-QTY (ASC-SEL-SUB)68680074
686900             END-IF                                               68690074
687000             IF RECITM-PKSL-ITM-QTY > 0  AND                      68700074
687100                RECITM-PREPK-RATO-QTY > 0                         68710074
687200                 COMPUTE RC801-PKSL-PACK-QTY (ASC-SEL-SUB) =      68720074
687300                            RECITM-PKSL-ITM-QTY /                 68730074
687400                            RECITM-PREPK-RATO-QTY                 68740074
687500             ELSE                                                 68750074
687600                 MOVE +0       TO RC801-PKSL-PACK-QTY(ASC-SEL-SUB)68760074
687700             END-IF                                               68770074
687800                                                                  68780074
687900**** NEED TO ALSO PASS PACK OTR CHANGES (MAY CHANGE DUE TO RATIO  68790074
688000***** CHANGE.                                                     68800074
688100             PERFORM 4440-DETERMINE-TOTALS                        68810074
688200             MOVE PV-TOTAL-ODD-UNIT-QTY                           68820074
688300                               TO RC801-PREPK-ODD-UNIT-QTY        68830074
688400                                         (ASC-SEL-SUB)            68840074
688500                                  RC801-ODD-UNITS-PACK-QTY        68850074
688600                                         (ASC-SEL-SUB)            68860074
688700             PERFORM 9200-REWRITE-LIST-QUEUE                      68870074
688800         END-IF.                                                  68880074
688900                                                                  68890074
689000                                                                  68900074
689100                                                                  68910074
689200*----------------------------------------------------------------*68920074
689300*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *68930074
689400*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *68940074
689500*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *68950074
689600*  THE USER.                                                     *68960074
689700*----------------------------------------------------------------*68970074
689800                                                                  68980074
689900 6000-REFRESH-PANEL-FROM-TEMP.                                    68990074
690000                                                                  69000074
690100     IF (ASC-UPDATE-TSQ                                           69010074
690200     OR  ASC-UPDATE-TSQ2                                          69020074
690300     OR  ASC-UPDATE-TSQ4)                                         69030074
690400         MOVE ZERO                 TO PV-SAVE-ITEM                69040074
690500                                      PV-SEL-QUEUE-ITEM           69050074
690600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        69060074
690700                                   TO PV-HOLD-SELECTED-ITEMS      69070074
690800                                                                  69080074
690900         IF  ASC-UPDATE-TSQ                                       69090074
691000             PERFORM 6100-UPDATE-TSQ                              69100074
691100                 UNTIL PV-ITEMS-PROCESSED >                       69110074
691200                                     ASC-NUMBER-OF-SELECTED-ITEMS 69120074
691300         ELSE                                                     69130074
691400         IF  ASC-UPDATE-TSQ2                                      69140074
691500             PERFORM 6101-UPDATE-TSQ2                             69150074
691600                 UNTIL PV-ITEMS-PROCESSED >                       69160074
691700                                     ASC-NUMBER-OF-SELECTED-ITEMS 69170074
691800         ELSE                                                     69180074
691900             PERFORM 6102-UPDATE-TSQ4                             69190074
692000                 UNTIL PV-ITEMS-PROCESSED >                       69200074
692100                                     ASC-NUMBER-OF-SELECTED-ITEMS 69210074
692200         END-IF                                                   69220074
692300         END-IF                                                   69230074
692400                                                                  69240074
692500         PERFORM 6010-DELETE-SEL-QUEUE                            69250074
692600         SET ASC-NO-TSQ-UPDATE TO TRUE                            69260074
692700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         69270074
692800                    ASC-BLOCK-ENTRIES (2)                         69280074
692900                                                                  69290074
693000         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 69300074
693100                GIVING PV-BLOCK-NUMBER                            69310074
693200                REMAINDER PV-REMAINDER                            69320074
693300         IF  PV-REMAINDER > ZERO                                  69330074
693400             ADD +1     TO PV-BLOCK-NUMBER                        69340074
693500         END-IF                                                   69350074
693600         MOVE +1        TO ASC-BLK-SUB                            69360074
693700         PERFORM 4410-READ-TEMP-STORAGE                           69370074
693800         ADD +1         TO ASC-BLK-SUB                            69380074
693900                           PV-BLOCK-NUMBER                        69390074
694000         PERFORM 4410-READ-TEMP-STORAGE                           69400074
694100     ELSE IF ASC-UPDATE-TSQ3                                      69410074
694200          SET ASC-NO-TSQ-UPDATE TO TRUE                           69420074
694300          PERFORM 2050-DELETE-LIST-QUEUE                          69430074
694400          PERFORM 4000-BUILD-INITIAL-PANEL                        69440074
694500     END-IF.                                                      69450074
694600                                                                  69460074
694700     IF ASC-NUMBER-OF-SELECTED-ITEMS < 0                          69470074
694800        MOVE +0                 TO ASC-NUMBER-OF-SELECTED-ITEMS.  69480074
694900                                                                  69490074
695000                                                                  69500074
695100                                                                  69510074
695200*----------------------------------------------------------------*69520074
695300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *69530074
695400*----------------------------------------------------------------*69540074
695500 6010-DELETE-SEL-QUEUE.                                           69550074
695600                                                                  69560074
695700     EXEC CICS                                                    69570074
695800         DELETEQ TS                                               69580074
695900             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       69590074
696000             RESP  (PV-CICS-RESP)                                 69600074
696100     END-EXEC.                                                    69610074
696200                                                                  69620074
696300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      69630074
696400         (PV-CICS-RESP = DFHRESP(QIDERR)))                        69640074
696500         CONTINUE                                                 69650074
696600     ELSE                                                         69660074
696700         SET DP013-CICS-ABEND      TO TRUE                        69670074
696800         SET DP013-NO-ROLLBACK     TO TRUE                        69680074
696900         MOVE '6010-DELETE-SEL-QUEUE'                             69690074
697000                                   TO DP013-PARAGRAPH             69700074
697100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         69710074
697200                                   TO DP013-MESSAGE-TEXT (1)      69720074
697300         PERFORM DP013-0000-PROCESS-ABEND                         69730074
697400     END-IF.                                                      69740074
697500/                                                                 69750074
697600*----------------------------------------------------------------*69760074
697700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *69770074
697800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *69780074
697900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *69790074
698000*    THE TEMP QUEUE.                                             *69800074
698100*----------------------------------------------------------------*69810074
698200                                                                  69820074
698300 6100-UPDATE-TSQ.                                                 69830074
698400                                                                  69840074
698500     ADD 1                         TO PV-SEL-QUEUE-ITEM.          69850074
698600     PERFORM 6105-READ-SEL-QUEUE.                                 69860074
698700                                                                  69870074
698800     PERFORM                                                      69880074
698900         VARYING RC801-IDX                                        69890074
699000         FROM 1 BY 1                                              69900074
699100         UNTIL ((PV-ITEMS-PROCESSED >                             69910074
699200                              PV-HOLD-SELECTED-ITEMS)             69920074
699300         OR (RC801-IDX GREATER THAN RC801-MAX-ITEMS))             69930074
699400         IF  RC801-ACTION-SW (RC801-IDX) > SPACE                  69940074
699500             PERFORM 6110-PROCESS-ITEMS                           69950074
699600         END-IF                                                   69960074
699700         ADD +1                    TO PV-ITEMS-PROCESSED          69970074
699800     END-PERFORM.                                                 69980074
699900                                                                  69990074
700000     PERFORM 6111-WRITE-LIST-QUEUE.                               70000074
700100                                                                  70010074
700200/                                                                 70020074
700300*----------------------------------------------------------------*70030074
700400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *70040074
700500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *70050074
700600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *70060074
700700*    THE TEMP QUEUE.                                             *70070074
700800*----------------------------------------------------------------*70080074
700900 6101-UPDATE-TSQ2.                                                70090074
701000                                                                  70100074
701100     ADD 1                         TO PV-SEL-QUEUE-ITEM.          70110074
701200     PERFORM 6106-READ-SEL-QUEUE2.                                70120074
701300                                                                  70130074
701400     PERFORM                                                      70140074
701500         VARYING RC013-IDX                                        70150074
701600         FROM 1 BY 1                                              70160074
701700         UNTIL ((PV-ITEMS-PROCESSED >                             70170074
701800                              PV-HOLD-SELECTED-ITEMS)             70180074
701900         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             70190074
702000             IF  RC013-ACTION-SW (RC013-IDX) > SPACE AND          70200074
702100                 RC013-ACTION-SW (RC013-IDX) NOT NUMERIC          70210074
702200                 PERFORM 6109-PROCESS-ITEMS2                      70220074
702300             END-IF                                               70230074
702400         ADD +1                    TO PV-ITEMS-PROCESSED          70240074
702500     END-PERFORM.                                                 70250074
702600                                                                  70260074
702700     PERFORM 6111-WRITE-LIST-QUEUE.                               70270074
702800                                                                  70280074
702900/                                                                 70290074
703000 6102-UPDATE-TSQ4.                                                70300074
703100                                                                  70310074
703200     ADD 1                         TO PV-SEL-QUEUE-ITEM.          70320074
703300     PERFORM 6107-READ-SEL-QUEUE3.                                70330074
703400                                                                  70340074
703500     PERFORM                                                      70350074
703600         VARYING PC016-IDX                                        70360074
703700         FROM 1 BY 1                                              70370074
703800         UNTIL ((PV-ITEMS-PROCESSED >                             70380074
703900                              PV-HOLD-SELECTED-ITEMS)             70390074
704000         OR (PC016-IDX GREATER THAN PC016-MAX-ITEMS))             70400074
704100             IF  PC016-ACTION-SW (PC016-IDX) > SPACE              70410074
704200                 PERFORM 6109-PROCESS-ITEMS3                      70420074
704300             END-IF                                               70430074
704400         ADD +1                    TO PV-ITEMS-PROCESSED          70440074
704500     END-PERFORM.                                                 70450074
704600                                                                  70460074
704700     PERFORM 6111-WRITE-LIST-QUEUE.                               70470074
704800                                                                  70480074
704900/                                                                 70490074
705000*----------------------------------------------------------------*70500074
705100*    READ THE LIST QUEUE RECORD.                                 *70510074
705200*----------------------------------------------------------------*70520074
705300 6105-READ-SEL-QUEUE.                                             70530074
705400                                                                  70540074
705500     EXEC CICS                                                    70550074
705600          READQ TS                                                70560074
705700              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      70570074
705800              INTO  (RC801-PREPACK-SELECT-RECORD)                 70580074
705900              ITEM  (PV-SEL-QUEUE-ITEM)                           70590074
706000              RESP  (PV-CICS-RESP)                                70600074
706100     END-EXEC.                                                    70610074
706200                                                                  70620074
706300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          70630074
706400         CONTINUE                                                 70640074
706500     ELSE                                                         70650074
706600         SET DP013-CICS-ABEND      TO TRUE                        70660074
706700         SET DP013-NO-ROLLBACK     TO TRUE                        70670074
706800         MOVE '6105-READ-SEL-QUEUE'                               70680074
706900                                   TO DP013-PARAGRAPH             70690074
707000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           70700074
707100                                   TO DP013-MESSAGE-TEXT(1)       70710074
707200         PERFORM DP013-0000-PROCESS-ABEND                         70720074
707300     END-IF.                                                      70730074
707400                                                                  70740074
707500/                                                                 70750074
707600*----------------------------------------------------------------*70760074
707700*    READ THE LIST QUEUE RECORD.                                 *70770074
707800*----------------------------------------------------------------*70780074
707900 6106-READ-SEL-QUEUE2.                                            70790074
708000                                                                  70800074
708100     EXEC CICS                                                    70810074
708200          READQ TS                                                70820074
708300              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      70830074
708400              INTO  (RC013-DC-SELECT-RECORD)                      70840074
708500              ITEM  (PV-SEL-QUEUE-ITEM)                           70850074
708600              RESP  (PV-CICS-RESP)                                70860074
708700     END-EXEC.                                                    70870074
708800                                                                  70880074
708900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          70890074
709000         CONTINUE                                                 70900074
709100     ELSE                                                         70910074
709200         SET DP013-CICS-ABEND      TO TRUE                        70920074
709300         SET DP013-NO-ROLLBACK     TO TRUE                        70930074
709400         MOVE '6106-READ-SEL-QUEUE2'                              70940074
709500                                   TO DP013-PARAGRAPH             70950074
709600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           70960074
709700                                   TO DP013-MESSAGE-TEXT(1)       70970074
709800         PERFORM DP013-0000-PROCESS-ABEND                         70980074
709900     END-IF.                                                      70990074
710000                                                                  71000074
710100/                                                                 71010074
710200*----------------------------------------------------------------*71020074
710300*    READ THE LIST QUEUE RECORD.                                 *71030074
710400*----------------------------------------------------------------*71040074
710500 6107-READ-SEL-QUEUE3.                                            71050074
710600                                                                  71060074
710700     EXEC CICS                                                    71070074
710800          READQ TS                                                71080074
710900              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      71090074
711000              INTO  (PC016-TS-SEL-REC)                            71100074
711100              ITEM  (PV-SEL-QUEUE-ITEM)                           71110074
711200              RESP  (PV-CICS-RESP)                                71120074
711300     END-EXEC.                                                    71130074
711400                                                                  71140074
711500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          71150074
711600         CONTINUE                                                 71160074
711700     ELSE                                                         71170074
711800         SET DP013-CICS-ABEND      TO TRUE                        71180074
711900         SET DP013-NO-ROLLBACK     TO TRUE                        71190074
712000         MOVE '6107-READ-SEL-QUEUE3'                              71200074
712100                                   TO DP013-PARAGRAPH             71210074
712200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           71220074
712300                                   TO DP013-MESSAGE-TEXT(1)       71230074
712400         PERFORM DP013-0000-PROCESS-ABEND                         71240074
712500     END-IF.                                                      71250074
712600                                                                  71260074
712700/                                                                 71270074
712800*----------------------------------------------------------------*71280074
712900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*71290074
713000*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*71300074
713100*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *71310074
713200*----------------------------------------------------------------*71320074
713300 6109-PROCESS-ITEMS2.                                             71330074
713400                                                                  71340074
713500     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          71350074
713600                     / PC-ITEMS-PER-PANEL).                       71360074
713700                                                                  71370074
713800     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           71380074
713900         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          71390074
714000             PERFORM 6111-WRITE-LIST-QUEUE                        71400074
714100         END-IF                                                   71410074
714200         MOVE PV-ITEM              TO PV-SAVE-ITEM                71420074
714300                                                                  71430074
714400         PERFORM 6112-READ-LIST-QUEUE                             71440074
714500         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               71450074
714600             CONTINUE                                             71460074
714700         END-IF                                                   71470074
714800     END-IF.                                                      71480074
714900                                                                  71490074
715000     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     71500074
715100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              71510074
715200                                                                  71520074
715300     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       71530074
715400     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        71540074
715500                                     (PV-SUB).                    71550074
715600     EVALUATE TRUE                                                71560074
715700         WHEN RC013-INQ (RC013-IDX)                               71570074
715800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             71580074
715900                                                                  71590074
716000         WHEN RC013-UPD (RC013-IDX)                               71600074
716100              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             71610074
716200                                                                  71620074
716300         WHEN RC013-DEL (RC013-IDX)                               71630074
716400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             71640074
716500                                                                  71650074
716600         WHEN RC013-ERR (RC013-IDX)                               71660074
716700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             71670074
716800     END-EVALUATE.                                                71680074
716900                                                                  71690074
717000* DISPLAY ANY NEW TROUBLE                                         71700074
717100     PERFORM 4100-PREPARE-CURSOR.                                 71710074
717200     PERFORM 4200-TROUBLE-DESC.                                   71720074
717300     MOVE ASC-REC-TROUBLE-RSN         TO ATRBLO.                  71730074
717400                                                                  71740074
717500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                71750074
717600/                                                                 71760074
717700/                                                                 71770074
717800*----------------------------------------------------------------*71780074
717900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*71790074
718000*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*71800074
718100*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *71810074
718200*----------------------------------------------------------------*71820074
718300 6109-PROCESS-ITEMS3.                                             71830074
718400                                                                  71840074
718500     COMPUTE PV-ITEM = 1 + ((PC016-ITEM (PC016-IDX) - 1)          71850074
718600                     / PC-ITEMS-PER-PANEL).                       71860074
718700                                                                  71870074
718800     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           71880074
718900         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          71890074
719000             PERFORM 6111-WRITE-LIST-QUEUE                        71900074
719100         END-IF                                                   71910074
719200         MOVE PV-ITEM              TO PV-SAVE-ITEM                71920074
719300                                                                  71930074
719400         PERFORM 6112-READ-LIST-QUEUE                             71940074
719500         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               71950074
719600             CONTINUE                                             71960074
719700         END-IF                                                   71970074
719800     END-IF.                                                      71980074
719900                                                                  71990074
720000     COMPUTE PV-SUB = (PC016-ITEM (PC016-IDX)                     72000074
720100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              72010074
720200                                                                  72020074
720300     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       72030074
720400     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        72040074
720500                                     (PV-SUB).                    72050074
720600     EVALUATE TRUE                                                72060074
720700         WHEN PC016-INQ (PC016-IDX)                               72070074
720800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             72080074
720900                                                                  72090074
721000         WHEN PC016-UPD (PC016-IDX)                               72100074
721100              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             72110074
721200                                                                  72120074
721300         WHEN PC016-DEL (PC016-IDX)                               72130074
721400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             72140074
721500                                                                  72150074
721600         WHEN PC016-ERR (PC016-IDX)                               72160074
721700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             72170074
721800     END-EVALUATE.                                                72180074
721900                                                                  72190074
722000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                72200074
722100/                                                                 72210074
722200*----------------------------------------------------------------*72220074
722300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*72230074
722400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*72240074
722500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *72250074
722600*----------------------------------------------------------------*72260074
722700 6110-PROCESS-ITEMS.                                              72270074
722800                                                                  72280074
722900     COMPUTE PV-ITEM = 1 + ((RC801-ITEM (RC801-IDX) - 1)          72290074
723000                     / PC-ITEMS-PER-PANEL).                       72300074
723100                                                                  72310074
723200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           72320074
723300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          72330074
723400             PERFORM 6111-WRITE-LIST-QUEUE                        72340074
723500         END-IF                                                   72350074
723600         MOVE PV-ITEM              TO PV-SAVE-ITEM                72360074
723700                                                                  72370074
723800         PERFORM 6112-READ-LIST-QUEUE                             72380074
723900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               72390074
724000             CONTINUE                                             72400074
724100         END-IF                                                   72410074
724200     END-IF.                                                      72420074
724300                                                                  72430074
724400     COMPUTE PV-SUB = (RC801-ITEM (RC801-IDX)                     72440074
724500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              72450074
724600                                                                  72460074
724700     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       72470074
724800     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        72480074
724900                                     (PV-SUB).                    72490074
725000     EVALUATE TRUE                                                72500074
725100         WHEN RC801-INQ (RC801-IDX)                               72510074
725200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             72520074
725300                                                                  72530074
725400         WHEN RC801-UPD (RC801-IDX)                               72540074
725500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             72550074
725600                                                                  72560074
725700         WHEN RC801-DEL (RC801-IDX)                               72570074
725800              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             72580074
725900                                                                  72590074
726000         WHEN RC801-ERR (RC801-IDX)                               72600074
726100              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             72610074
726200     END-EVALUATE.                                                72620074
726300                                                                  72630074
726400* DISPLAY ANY NEW TROUBLE                                         72640074
726500     PERFORM 4100-PREPARE-CURSOR.                                 72650074
726600     PERFORM 4200-TROUBLE-DESC.                                   72660074
726700     MOVE ASC-REC-TROUBLE-RSN         TO ATRBLO.                  72670074
726800                                                                  72680074
726900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                72690074
727000                                                                  72700074
727100/                                                                 72710074
727200*----------------------------------------------------------------*72720074
727300*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *72730074
727400*----------------------------------------------------------------*72740074
727500 6111-WRITE-LIST-QUEUE.                                           72750074
727600                                                                  72760074
727700     EXEC CICS                                                    72770074
727800         WRITEQ TS                                                72780074
727900             QUEUE (ASC-LIST-QUEUE-NAME)                          72790074
728000             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     72800074
728100             ITEM  (PV-SAVE-ITEM)                                 72810074
728200             REWRITE                                              72820074
728300             RESP  (PV-CICS-RESP)                                 72830074
728400     END-EXEC.                                                    72840074
728500                                                                  72850074
728600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          72860074
728700         CONTINUE                                                 72870074
728800     ELSE                                                         72880074
728900         SET DP013-CICS-ABEND      TO TRUE                        72890074
729000         SET DP013-NO-ROLLBACK     TO TRUE                        72900074
729100         MOVE '6111-WRITE-LIST-QUEUE'                             72910074
729200                                   TO DP013-PARAGRAPH             72920074
729300         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  72930074
729400                                   TO DP013-MESSAGE-TEXT(1)       72940074
729500         PERFORM DP013-0000-PROCESS-ABEND                         72950074
729600     END-IF.                                                      72960074
729700                                                                  72970074
729800/                                                                 72980074
729900*----------------------------------------------------------------*72990074
730000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*73000074
730100*----------------------------------------------------------------*73010074
730200 6112-READ-LIST-QUEUE.                                            73020074
730300                                                                  73030074
730400     EXEC CICS                                                    73040074
730500         READQ TS                                                 73050074
730600             QUEUE (ASC-LIST-QUEUE-NAME)                          73060074
730700             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     73070074
730800             ITEM  (PV-ITEM)                                      73080074
730900             RESP  (PV-CICS-RESP)                                 73090074
731000     END-EXEC.                                                    73100074
731100                                                                  73110074
731200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          73120074
731300         CONTINUE                                                 73130074
731400     ELSE                                                         73140074
731500         SET DP013-CICS-ABEND      TO TRUE                        73150074
731600         SET DP013-NO-ROLLBACK     TO TRUE                        73160074
731700         MOVE '6112-READ-LIST-QUEUE'                              73170074
731800                                   TO DP013-PARAGRAPH             73180074
731900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    73190074
732000                                   TO DP013-MESSAGE-TEXT(1)       73200074
732100         PERFORM DP013-0000-PROCESS-ABEND                         73210074
732200     END-IF.                                                      73220074
732300                                                                  73230074
732400/                                                                 73240074
732500******************************************************************73250074
732600* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *73260074
732700******************************************************************73270074
732800 6200-DEL-LIST-QUEUE.                                             73280074
732900                                                                  73290074
733000     EXEC CICS                                                    73300074
733100         DELETEQ TS                                               73310074
733200             QUEUE (ASC-LIST-QUEUE-NAME)                          73320074
733300             RESP  (PV-CICS-RESP)                                 73330074
733400     END-EXEC.                                                    73340074
733500                                                                  73350074
733600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      73360074
733700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         73370074
733800         CONTINUE                                                 73380074
733900     ELSE                                                         73390074
734000        SET DP013-CICS-ABEND       TO TRUE                        73400074
734100        SET DP013-NO-ROLLBACK      TO TRUE                        73410074
734200        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             73420074
734300        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               73430074
734400                                   TO DP013-MESSAGE-TEXT (1)      73440074
734500        PERFORM DP013-0000-PROCESS-ABEND                          73450074
734600     END-IF.                                                      73460074
734700                                                                  73470074
734800                                                                  73480074
734900*----------------------------------------------------------------*73490074
735000* DETERMINE WHAT QUANITITY NEEDS TO BE REDISTROED AND PASS IT    *73500074
735100* FOR PROCESSING THRU THE TROUBLE AND REDISTRO ROUTINES.         *73510074
735200*----------------------------------------------------------------*73520074
735300 6500-PROCESS-REDISTRO.                                           73530074
735400                                                                  73540074
735500     PERFORM 4100-PREPARE-CURSOR                                  73550074
735600     PERFORM 5214-RETRIEVE-DRIVER-LINE.                           73560074
735700                                                                  73570074
735800     SET PS-DELETE-RECDIS              TO TRUE.                   73580074
735900                                                                  73590074
736000* DELETE RECDIS ON ALL OF THE LINES WITHIN THE PACK BEFORE CALLING73600074
736100* REDISTRO                                                        73610074
736200     PERFORM 4010-OPEN-CURSOR.                                    73620074
736300     PERFORM 6510-FETCH-RECITM.                                   73630074
736400     PERFORM 4020-CLOSE-CURSOR.                                   73640074
736500                                                                  73650074
736600     SET PS-DONT-DELETE-RECDIS         TO TRUE.                   73660074
736700                                                                  73670074
736800     INITIALIZE TM500-FIELDS.                                     73680074
736900                                                                  73690074
737000     SET  TM500-CREATE-AUTO                                       73700074
737100          TM500-NO-DETAILS                                        73710074
737200          TM500-REDISTRO-YES                                      73720074
737300          TM500-PACK-LEVEL         TO TRUE.                       73730074
737400                                                                  73740074
737500     PERFORM 6600-CHECK-FOR-TROUBLE.                              73750074
737600                                                                  73760074
737700     IF PS-REDISTRO-OK                                            73770074
737800         PERFORM 4010-OPEN-CURSOR                                 73780074
737900         PERFORM 6510-FETCH-RECITM                                73790074
738000         PERFORM 4020-CLOSE-CURSOR                                73800074
738100         IF TM500-INVALID-PRORATION                               73810074
738200              SET DP020-MSG-WARNING        TO TRUE                73820074
738300              MOVE PC-TSYMSG-02452         TO DP020-MSG-NUMBER    73830074
738400         ELSE                                                     73840074
738500            IF TM500-IN-TROUBLE                                   73850074
738600**             MOVE PC-TSYMSG-00941        TO DP020-MSG-NUMBER    73860099
738700**             SET DP020-MSG-INFORMATIONAL TO TRUE                73870099
738800* JAK 05/2007 ADD ERROR MSGS FOR WMS                              73880099
738900               IF TM500-ASN-SENT-TO-WMS-YES                       73890099
739000*                  * REDISTRO SUCCESSFUL, ASN WILL BE             73900099
739100*                  * DOWNLOADED TO WMS BUT TROUBLE CREATED        73910099
739200                   MOVE PC-TSYMSG-03569  TO DP020-MSG-NUMBER      73920099
739300                   SET DP020-MSG-INFORMATIONAL TO TRUE            73930099
739400               ELSE                                               73940099
739500*                  * REDISTRO SUCCESSFUL BUT TROUBLE CREATED      73950099
739600                   MOVE PC-TSYMSG-00941  TO DP020-MSG-NUMBER      73960099
739700                   SET DP020-MSG-INFORMATIONAL TO TRUE            73970099
739800               END-IF                                             73980099
739900            ELSE                                                  73990074
740000* REDISTRO SUCESSFUL                                              74000074
740100**             MOVE PC-TSYMSG-02165        TO DP020-MSG-NUMBER    74010099
740200**             SET DP020-MSG-INFORMATIONAL TO TRUE                74020099
740300               IF TM500-ASN-SENT-TO-WMS-YES                       74030099
740400*                  * UPD SUCCESSFUL-REDISTRO PERFORMED AND        74040099
740500*                  * WILL BE DOWNLOADED TO WMS                    74050099
740600                   MOVE PC-TSYMSG-03570  TO DP020-MSG-NUMBER      74060099
740700                   SET DP020-MSG-INFORMATIONAL TO TRUE            74070099
740800               ELSE                                               74080099
740900*                  * REDISTRO SUCCESSFUL                          74090099
741000                   MOVE PC-TSYMSG-02165  TO DP020-MSG-NUMBER      74100099
741100                   SET DP020-MSG-INFORMATIONAL TO TRUE            74110099
741200               END-IF                                             74120099
741300* JAK 05/2007 END                                                 74130099
741400            END-IF                                                74140074
741500         END-IF                                                   74150074
741600     ELSE                                                         74160074
741700        IF TM500-PREPACK-ERROR                                    74170074
741800           MOVE PC-TSYMSG-02229         TO DP020-MSG-NUMBER       74180074
741900           SET DP020-MSG-FATAL          TO TRUE                   74190074
742000     END-IF.                                                      74200074
742100                                                                  74210074
742200                                                                  74220074
742300******************************************************************74230074
742400* PERFORM FETCH TO RETRIEVE 6510-FETCH LINE NUMBERS.             *74240074
742500******************************************************************74250074
742600 6510-FETCH-RECITM.                                               74260074
742700                                                                  74270074
742800     PERFORM 4100-PREPARE-CURSOR.                                 74280074
742900     SET ASC-ITEMS-LEFT-ON-DB    TO TRUE.                         74290074
743000                                                                  74300074
743100     PERFORM                                                      74310074
743200         VARYING PV-READ-COUNT                                    74320074
743300         FROM 1 BY 1                                              74330074
743400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    74340074
743500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         74350074
743600                                                                  74360074
743700         PERFORM 4310-FETCH                                       74370074
743800                                                                  74380074
743900         IF ASC-ITEMS-LEFT-ON-DB                                  74390074
744000             IF PS-DELETE-RECDIS                                  74400074
744100                 PERFORM 6800-CLEANUP-RECDIS                      74410074
744200                 PERFORM 6820-DELETE-ODD-UNIT                     74420074
744300             ELSE                                                 74430074
744400                 PERFORM 6550-UPDATE-TRSCP-RECITM                 74440074
744500             END-IF                                               74450074
744600         END-IF                                                   74460074
744700     END-PERFORM.                                                 74470074
744800                                                                  74480074
744900******************************************************************74490074
745000* UPDATE TRECITM WHEN REDISTRO IS SUCCESSFUL.                    *74500074
745100******************************************************************74510074
745200 6550-UPDATE-TRSCP-RECITM.                                        74520074
745300                                                                  74530074
745400     EXEC SQL                                                     74540074
745500           UPDATE TRECITM                                         74550074
745600              SET LAST_TRSCP_TMST   = CURRENT TIMESTAMP           74560074
745700                , LAST_TRSCP_USR_ID = :DP020-USERID               74570074
745800             WHERE ORD_NBR          = :DK-ORD-NBR                 74580074
745900               AND ORD_LNE_NBR      = :DK-LINE-NBR                74590074
746000               AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR            74600074
746100               AND OPER_UNT_ID      = :DK-OPR-ID                  74610074
746200               AND FCLTY_ID         = :DK-FACT                    74620074
746300               AND VER_STATUS_CDE   = 'A'                         74630074
746400               AND PREPK_ID         = :DK-PACK-ID                 74640074
746500     END-EXEC.                                                    74650074
746600                                                                  74660074
746700     EVALUATE TRUE                                                74670074
746800         WHEN SQLCODE = ZERO                                      74680074
746900              CONTINUE                                            74690074
747000         WHEN SQLCODE = -904                                      74700074
747100         WHEN SQLCODE = -911                                      74710074
747200         WHEN SQLCODE = -913                                      74720074
747300              PERFORM 9900-SOFT-ABORT                             74730074
747400                                                                  74740074
747500         WHEN OTHER                                               74750074
747600              MOVE '6550-UPDATE-TRSCP-RECITM'                     74760074
747700                               TO DP013-PARAGRAPH                 74770074
747800              MOVE 'UPDATE TRECITM'                               74780074
747900                               TO DP013-MESSAGE-TEXT (1)          74790074
748000              MOVE SQLCA       TO DP013-SQLCA                     74800074
748100              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        74810074
748200              PERFORM 9950-FORMAT-ERROR-MSG                       74820074
748300              SET DP013-DB2-ABEND                                 74830074
748400                               TO TRUE                            74840074
748500              PERFORM DP013-0000-PROCESS-ABEND                    74850074
748600     END-EVALUATE.                                                74860074
748700                                                                  74870074
748800 6600-CHECK-FOR-TROUBLE.                                          74880074
748900                                                                  74890074
749000     MOVE ASC-OPR-ID               TO TM500-OPER-UNT-ID.          74900074
749100     MOVE ASC-FACT                 TO TM500-FCLTY-ID.             74910074
749200     MOVE ASC-REC-NBR              TO TM500-PO-NBR.               74920074
749300     MOVE ASC-REC-SEQ-NBR          TO TM500-REC-SEQ-NBR           74930074
749400                                                                  74940074
749500     PERFORM 4100-PREPARE-CURSOR                                  74950074
749600     PERFORM 5214-RETRIEVE-DRIVER-LINE.                           74960074
749700     MOVE PV-DRV-LINE-NBR          TO TM500-PO-LNE-NBR.           74970074
749800     MOVE ASC-PACK-ID              TO TM500-PREPK-ID.             74980074
749900     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            74990074
750000     MOVE ASC-PKGNG-CDE            TO TM500-PKGNG-CDE.            75000074
750100                                                                  75010074
750200     PERFORM 6700-GET-PURITM.                                     75020074
750300                                                                  75030074
750400     IF PV-NBR-OF-PIC-AD > 0                                      75040074
750500        MOVE 'Y'                   TO TM500-AD-SW                 75050074
750600     ELSE                                                         75060074
750700        MOVE 'N'                   TO TM500-AD-SW.                75070074
750800                                                                  75080074
750900*  TM500-RTV-SW IS LOADED BY TMKCS505 ONLY                        75090074
751000                                                                  75100074
751100     EXEC CICS                                                    75110074
751200         LINK PROGRAM  (PC-TROUBLE-RTN)                           75120074
751300              COMMAREA (TM500-FIELDS)                             75130074
751400              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    75140074
751500     END-EXEC.                                                    75150074
751600                                                                  75160074
751700     EVALUATE TRUE                                                75170074
751800         WHEN TM500-CALL-SUCCESSFUL                               75180074
751900         WHEN TM500-DUPLICATE-TROUBLE                             75190074
752000         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        75200074
752100         WHEN TM500-INVALID-PRORATION                             75210074
752200              SET PS-REDISTRO-OK    TO TRUE                       75220074
752300                                                                  75230074
752400         WHEN TM500-PREPACK-DB2-TIMEOUT                           75240074
752500              PERFORM 9900-SOFT-ABORT                             75250074
752600                                                                  75260074
752700         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       75270074
752800             IF TM500-PREPACK-EDIT-ONLY                           75280074
752900                SET  PS-REDISTRO-NOT-OK    TO TRUE                75290074
753000             ELSE                                                 75300074
753100                SET DP020-MSG-INFORMATIONAL                       75310074
753200                    PS-REDISTRO-NOT-OK     TO TRUE                75320074
753300                IF ASC-CALL-REDISTRO                              75330074
753400                   MOVE PC-TSYMSG-02239    TO DP020-MSG-NUMBER    75340074
753500                ELSE                                              75350074
753600                   MOVE PC-TSYMSG-00937    TO DP020-MSG-NUMBER    75360074
753700                END-IF                                            75370074
753800             END-IF                                               75380074
753900                                                                  75390074
754000         WHEN OTHER                                               75400074
754100           EXEC CICS                                              75410074
754200               SYNCPOINT ROLLBACK                                 75420074
754300           END-EXEC                                               75430074
754400           STRING TM500-PREPACK-PGM-NBR '-'                       75440074
754500                  TM500-PREPACK-ERROR-NBR                         75450074
754600                  DELIMITED BY SIZE     INTO DP020-MSG-TEXT       75460074
754700           MOVE PC-TSYMSG-02229         TO DP020-MSG-NUMBER       75470074
754800           SET DP020-MSG-FATAL                                    75480074
754900               PS-REDISTRO-NOT-OK       TO TRUE                   75490074
755000                                                                  75500074
755100     END-EVALUATE.                                                75510074
755200                                                                  75520074
755300 6700-GET-PURITM.                                                 75530074
755400                                                                  75540074
755500     EXEC SQL                                                     75550074
755600          SELECT DISTINCT                                         75560074
755700                 COUNT (*)                                        75570074
755800            INTO                                                  75580074
755900                 :PV-NBR-OF-PIC-AD                                75590074
756000            FROM TPURCHS A,                                       75600074
756100                 TPURITM B,                                       75610074
756200                 TRECITM C                                        75620074
756300           WHERE A.PO_NBR         = :DK-ORD-NBR                   75630074
756400             AND A.VER_STATUS_CDE = 'A'                           75640074
756500             AND A.PO_NBR         = B.PO_NBR                      75650074
756600             AND A.PO_NBR         = C.ORD_NBR                     75660074
756700             AND B.PO_PREPK_ID    = :DK-PACK-ID                   75670074
756800             AND B.PIC_ITM_IND    = 'Y'                           75680074
756900             AND C.ORD_LNE_NBR    = B.APP_PO_LNE_NBR              75690074
757000             AND C.PREPK_ID       = B.PO_PREPK_ID                 75700074
757100             AND C.OPER_UNT_ID    = :DK-OPR-ID                    75710074
757200             AND C.FCLTY_ID       = :DK-FACT                      75720074
757300             AND C.VER_STATUS_CDE = 'A'                           75730074
757400     END-EXEC.                                                    75740074
757500                                                                  75750074
757600     EVALUATE TRUE                                                75760074
757700         WHEN SQLCODE = +0                                        75770074
757800         WHEN SQLCODE = +100                                      75780074
757900              CONTINUE                                            75790074
758000         WHEN SQLCODE = -904                                      75800074
758100         WHEN SQLCODE = -911                                      75810074
758200         WHEN SQLCODE = -913                                      75820074
758300              PERFORM 9900-SOFT-ABORT                             75830074
758400                                                                  75840074
758500         WHEN OTHER                                               75850074
758600              MOVE '6700-GET-PURITM'                              75860074
758700                               TO DP013-PARAGRAPH                 75870074
758800              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               75880074
758900                               TO DP013-MESSAGE-TEXT (1)          75890074
759000              MOVE SQLCA       TO DP013-SQLCA                     75900074
759100              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        75910074
759200              PERFORM 9950-FORMAT-ERROR-MSG                       75920074
759300              SET DP013-DB2-ABEND                                 75930074
759400                  DP013-XCTL-DISPLAY-RESTART                      75940074
759500                               TO TRUE                            75950074
759600              PERFORM DP013-0000-PROCESS-ABEND                    75960074
759700     END-EVALUATE.                                                75970074
759800                                                                  75980074
759900                                                                  75990074
760000*----------------------------------------------------------------*76000074
760100*    DELETE LINE LEVEL RECDIS.                                   *76010074
760200*----------------------------------------------------------------*76020074
760300 6800-CLEANUP-RECDIS.                                             76030074
760400                                                                  76040074
760500     EXEC SQL                                                     76050074
760600           DELETE                                                 76060074
760700             FROM TRECDIS                                         76070074
760800            WHERE ORD_NBR          = :DK-ORD-NBR                  76080074
760900              AND ORD_LNE_NBR      = :DK-LINE-NBR                 76090074
761000              AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR             76100074
761100              AND OPER_UNT_ID      = :DK-OPR-ID                   76110074
761200              AND FCLTY_ID         = :DK-FACT                     76120074
761300     END-EXEC                                                     76130074
761400                                                                  76140074
761500     EVALUATE TRUE                                                76150074
761600         WHEN SQLCODE = ZERO                                      76160074
761700         WHEN SQLCODE = +100                                      76170074
761800              CONTINUE                                            76180074
761900         WHEN SQLCODE = -904                                      76190074
762000         WHEN SQLCODE = -911                                      76200074
762100         WHEN SQLCODE = -913                                      76210074
762200              PERFORM 9900-SOFT-ABORT                             76220074
762300                                                                  76230074
762400         WHEN OTHER                                               76240074
762500              MOVE '6800-CLEANUP-RECDIS'                          76250074
762600                             TO DP013-PARAGRAPH                   76260074
762700              MOVE 'UNSUCCESSFUL DELETE OF RECDIS DATA'           76270074
762800                             TO DP013-MESSAGE-TEXT (1)            76280074
762900              MOVE SQLCA         TO DP013-SQLCA                   76290074
763000              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          76300074
763100              PERFORM 9950-FORMAT-ERROR-MSG                       76310074
763200              SET DP013-DB2-ABEND                                 76320074
763300                  DP013-XCTL-DISPLAY-RESTART                      76330074
763400                             TO TRUE                              76340074
763500                                                                  76350074
763600              PERFORM DP013-0000-PROCESS-ABEND                    76360074
763700     END-EVALUATE.                                                76370074
763800                                                                  76380074
763900                                                                  76390074
764000 6820-DELETE-ODD-UNIT.                                            76400074
764100                                                                  76410074
764200     EXEC SQL                                                     76420074
764300          DELETE                                                  76430074
764400            FROM RCT_VRFD_ODD_UNT                                 76440074
764500            WHERE PO_NBR         = :DK-ORD-NBR                    76450074
764600              AND PO_LNE_NBR     = :DK-LINE-NBR                   76460074
764700              AND RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR               76470074
764800     END-EXEC.                                                    76480074
764900                                                                  76490074
765000     EVALUATE TRUE                                                76500074
765100         WHEN SQLCODE = ZERO                                      76510074
765200         WHEN SQLCODE = +100                                      76520074
765300              CONTINUE                                            76530074
765400         WHEN SQLCODE = -904                                      76540074
765500         WHEN SQLCODE = -911                                      76550074
765600         WHEN SQLCODE = -913                                      76560074
765700              PERFORM 9900-SOFT-ABORT                             76570074
765800                                                                  76580074
765900         WHEN SQLWARN0 NOT = SPACES                               76590074
766000         WHEN SQLCODE  NOT = ZERO                                 76600074
766100              MOVE '6820-DELETE-ODD-UNIT'                         76610074
766200                             TO DP013-PARAGRAPH                   76620074
766300              MOVE 'UNSUCCESSFUL DELETE OF RCT_VRFD_ODD_UNT'      76630074
766400                             TO DP013-MESSAGE-TEXT (1)            76640074
766500              MOVE DK-ORD-NBR      TO PV-PO-NBR-PIC9              76650074
766600              MOVE DK-RCVR-SEQ-NBR TO PV-REC-SEQ-NBR-PIC9         76660074
766700              MOVE DK-LINE-NBR     TO PV-PO-LNE-NBR-PIC9          76670074
766800              STRING 'PO '                                        76680074
766900                     PV-PO-NBR-PIC9                               76690074
767000                     ' SEQ '                                      76700074
767100                     PV-REC-SEQ-NBR-PIC9                          76710074
767200                     ' LINE '                                     76720074
767300                     PV-PO-LNE-NBR-PIC9                           76730074
767400                     DELIMITED BY SIZE                            76740074
767500                     INTO DP013-MESSAGE-TEXT (2)                  76750074
767600              MOVE SQLCA     TO DP013-SQLCA                       76760074
767700              MOVE 'RCT00009' TO DP013-DB2-TABLE-NAME (1)         76770074
767800              SET DP013-DB2-ABEND                                 76780074
767900                  DP013-XCTL-DISPLAY-RESTART                      76790074
768000                             TO TRUE                              76800074
768100              PERFORM DP013-0000-PROCESS-ABEND                    76810074
768200     END-EVALUATE.                                                76820074
768300                                                                  76830074
768400                                                                  76840074
768500                                                                  76850074
768600*----------------------------------------------------------------*76860074
768700*    DELETE LINE LEVEL TROUBLE.                                  *76870074
768800*----------------------------------------------------------------*76880074
768900 6850-DELETE-TRB-LINE.                                            76890074
769000                                                                  76900074
769100     EXEC SQL                                                     76910074
769200          DELETE                                                  76920074
769300            FROM TTRBNTF                                          76930074
769400           WHERE PO_NBR         = :DK-ORD-NBR                     76940074
769500             AND PO_LNE_NBR     = :DK-LINE-NBR                    76950074
769600             AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                76960074
769700             AND OPER_UNT_ID    = :DK-OPR-ID                      76970074
769800             AND FCLTY_ID       = :DK-FACT                        76980074
769900     END-EXEC.                                                    76990074
770000                                                                  77000074
770100     EVALUATE TRUE                                                77010074
770200         WHEN SQLCODE = +0                                        77020074
770300         WHEN SQLCODE = +100                                      77030074
770400              CONTINUE                                            77040074
770500                                                                  77050074
770600         WHEN SQLCODE = -904                                      77060074
770700         WHEN SQLCODE = -911                                      77070074
770800         WHEN SQLCODE = -913                                      77080074
770900              PERFORM 9900-SOFT-ABORT                             77090074
771000                                                                  77100074
771100         WHEN OTHER                                               77110074
771200              MOVE '6850-DELETE-TRB-LINE'                         77120074
771300                               TO DP013-PARAGRAPH                 77130074
771400              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               77140074
771500                               TO DP013-MESSAGE-TEXT (1)          77150074
771600              MOVE SQLCA       TO DP013-SQLCA                     77160074
771700              PERFORM 9950-FORMAT-ERROR-MSG                       77170074
771800              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        77180074
771900              SET DP013-DB2-ABEND                                 77190074
772000                  DP013-XCTL-DISPLAY-RESTART                      77200074
772100                               TO TRUE                            77210074
772200              PERFORM DP013-0000-PROCESS-ABEND                    77220074
772300     END-EVALUATE.                                                77230074
772400                                                                  77240074
772500                                                                  77250074
772600                                                                  77260074
772700*----------------------------------------------------------------*77270074
772800*    DELETE ENTIRE ALL PACK LEVEL TROUBLE.                       *77280074
772900*----------------------------------------------------------------*77290074
773000 6860-DELETE-TRB-PACK.                                            77300074
773100                                                                  77310074
773200     EXEC SQL                                                     77320074
773300          DELETE                                                  77330074
773400            FROM TTRBNTF                                          77340074
773500           WHERE PO_NBR         = :DK-ORD-NBR                     77350074
773600             AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                77360074
773700             AND PREPK_ID       = :DK-PACK-ID                     77370074
773800             AND OPER_UNT_ID    = :DK-OPR-ID                      77380074
773900             AND FCLTY_ID       = :DK-FACT                        77390074
774000     END-EXEC.                                                    77400074
774100                                                                  77410074
774200     EVALUATE TRUE                                                77420074
774300         WHEN SQLCODE = +0                                        77430074
774400         WHEN SQLCODE = +100                                      77440074
774500              CONTINUE                                            77450074
774600                                                                  77460074
774700         WHEN SQLCODE = -904                                      77470074
774800         WHEN SQLCODE = -911                                      77480074
774900         WHEN SQLCODE = -913                                      77490074
775000              PERFORM 9900-SOFT-ABORT                             77500074
775100                                                                  77510074
775200         WHEN OTHER                                               77520074
775300              MOVE '6860-DELETE-TRB-PACK'                         77530074
775400                               TO DP013-PARAGRAPH                 77540074
775500              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               77550074
775600                               TO DP013-MESSAGE-TEXT (1)          77560074
775700              MOVE SQLCA       TO DP013-SQLCA                     77570074
775800              PERFORM 9950-FORMAT-ERROR-MSG                       77580074
775900              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        77590074
776000              SET DP013-DB2-ABEND                                 77600074
776100                  DP013-XCTL-DISPLAY-RESTART                      77610074
776200                               TO TRUE                            77620074
776300              PERFORM DP013-0000-PROCESS-ABEND                    77630074
776400     END-EVALUATE.                                                77640074
776500                                                                  77650074
776600                                                                  77660074
776700/                                                                 77670074
776800******************************************************************77680074
776900* SELECT THE PKSL ITEM QTY TO DETERMINE IF AN INSERT SHOULD BE   *77690074
777000* MADE TO TRECDIS (IF PKSL-ITM-QTY > 0, AN INSERT WILL BE MADE). *77700074
777100******************************************************************77710074
777200 6900-SELECT-PKSL-QTY.                                            77720074
777300                                                                  77730074
777400     EXEC SQL                                                     77740074
777500           SELECT DISTINCT                                        77750074
777600                  A.PKSL_ITM_QTY                                  77760074
777700                 ,CURRENT TIMESTAMP                               77770074
777800           INTO                                                   77780074
777900                 :RECITM-PKSL-ITM-QTY                             77790074
778000                ,:PV-CURRENT-TIMESTAMP                            77800074
778100           FROM                                                   77810074
778200                  TRECITM A                                       77820074
778300           WHERE                                                  77830074
778400                  A.ORD_NBR           = :DK-ORD-NBR               77840074
778500             AND  A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR          77850074
778600             AND  A.ORD_LNE_NBR       = :DK-LINE-NBR              77860074
778700             AND  A.VER_STATUS_CDE    = 'A'                       77870074
778800             AND  A.OPER_UNT_ID       = :DK-OPR-ID                77880074
778900             AND  A.FCLTY_ID          = :DK-FACT                  77890074
779000             AND  A.PREPK_ID          = :DK-PACK-ID               77900074
779100     END-EXEC.                                                    77910074
779200                                                                  77920074
779300     EVALUATE TRUE                                                77930074
779400         WHEN SQLCODE = +0                                        77940074
779500              CONTINUE                                            77950074
779600         WHEN SQLCODE = -904                                      77960074
779700         WHEN SQLCODE = -911                                      77970074
779800         WHEN SQLCODE = -913                                      77980074
779900              PERFORM 9900-SOFT-ABORT                             77990074
780000                                                                  78000074
780100         WHEN OTHER                                               78010074
780200              MOVE '6900-SELECT-PKSL-QTY'                         78020074
780300                               TO DP013-PARAGRAPH                 78030074
780400              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               78040074
780500                               TO DP013-MESSAGE-TEXT (1)          78050074
780600              MOVE SQLCA       TO DP013-SQLCA                     78060074
780700              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        78070074
780800              PERFORM 9950-FORMAT-ERROR-MSG                       78080074
780900              SET DP013-DB2-ABEND                                 78090074
781000                  DP013-XCTL-DISPLAY-RESTART                      78100074
781100                               TO TRUE                            78110074
781200              PERFORM DP013-0000-PROCESS-ABEND                    78120074
781300     END-EVALUATE.                                                78130074
781400                                                                  78140074
781500                                                                  78150074
781600                                                                  78160074
781700                                                                  78170074
781800/                                                                 78180074
781900******************************************************************78190074
782000* SINCE PKSL-ITM-QTY > 0 ON A DELETED LINE, AN INSERT WILL BE    *78200074
782100* MADE TO TRECDIS WITH THE OPER ID AS THE STORE #.               *78210074
782200******************************************************************78220074
782300 6910-INSERT-RECDIS.                                              78230074
782400                                                                  78240074
782500     EXEC SQL                                                     78250074
782600         INSERT INTO TRECDIS                                      78260074
782700             (ORD_NBR                                             78270074
782800           ,  ORD_LNE_NBR                                         78280074
782900           ,  REC_SEQ_NBR                                         78290074
783000           ,  OPER_UNT_ID                                         78300074
783100           ,  FCLTY_ID                                            78310074
783200           ,  CRE_TMST                                            78320074
783300           ,  CRE_UID                                             78330074
783400           ,  VER_STATUS_CDE                                      78340074
783500           ,  EXPTED_ITM_QTY                                      78350074
783600           ,  VERIFY_ITM_QTY                                      78360074
783700           ,  AP_VERIFY_ITM_QTY                                   78370074
783800           ,  STR_NBR                                             78380074
783900           ,  STR_FCLTY_ID                                        78390074
784000           ,  PLAN_ITM_QTY                                        78400074
784100           ,  AP_PRC_CDE                                          78410074
784200           ,  AP_PRC_DTE)                                         78420074
784300     VALUES (:RECDIS-ORD-NBR                                      78430074
784400           ,  :RECDIS-ORD-LNE-NBR                                 78440074
784500           ,  :RECDIS-REC-SEQ-NBR                                 78450074
784600           ,  :RECDIS-OPER-UNT-ID                                 78460074
784700           ,  :RECDIS-FCLTY-ID                                    78470074
784800           ,  CURRENT TIMESTAMP                                   78480074
784900           ,  :RECDIS-CRE-UID                                     78490074
785000           ,  :RECDIS-VER-STATUS-CDE                              78500074
785100           ,  :RECDIS-EXPTED-ITM-QTY                              78510074
785200           ,  :RECDIS-VERIFY-ITM-QTY                              78520074
785300           ,  :RECDIS-AP-VERIFY-ITM-QTY                           78530074
785400           ,  :RECDIS-STR-NBR                                     78540074
785500           ,  :RECDIS-STR-FCLTY-ID                                78550074
785600           ,  :RECDIS-PLAN-ITM-QTY                                78560074
785700           ,  :RECDIS-AP-PRC-CDE                                  78570074
785800           ,  :RECDIS-AP-PRC-DTE)                                 78580074
785900     END-EXEC                                                     78590074
786000                                                                  78600074
786100     EVALUATE TRUE                                                78610074
786200         WHEN SQLCODE = ZERO                                      78620074
786300             CONTINUE                                             78630074
786400                                                                  78640074
786500         WHEN SQLCODE = -904                                      78650074
786600         WHEN SQLCODE = -911                                      78660074
786700         WHEN SQLCODE = -913                                      78670074
786800              PERFORM 9900-SOFT-ABORT                             78680074
786900                                                                  78690074
787000         WHEN OTHER                                               78700074
787100               MOVE '8120-INSERT-TRECDIS'                         78710074
787200                                TO DP013-PARAGRAPH                78720074
787300               MOVE 'UNSUCCESSFUL INSERT FOR TRECDIS'             78730074
787400                                TO DP013-MESSAGE-TEXT (1)         78740074
787500               MOVE SQLCA       TO DP013-SQLCA                    78750074
787600               PERFORM 9950-FORMAT-ERROR-MSG                      78760074
787700               MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)       78770074
787800               SET DP013-DB2-ABEND                                78780074
787900                   DP013-XCTL-DISPLAY-RESTART                     78790074
788000                                TO TRUE                           78800074
788100               PERFORM DP013-0000-PROCESS-ABEND                   78810074
788200                                                                  78820074
788300     END-EVALUATE.                                                78830074
788400                                                                  78840074
788500                                                                  78850074
788600/                                                                 78860074
788700******************************************************************78870074
788800* SINCE PKSL-ITM-QTY = 0 ON A DELETED LINE, DELETE TWRKORD       *78880074
788900******************************************************************78890074
789000                                                                  78900074
789100 6920-DELETE-TWRKORD.                                             78910074
789200                                                                  78920074
789300     EXEC SQL                                                     78930074
789400          UPDATE                                                  78940074
789500                TWRKORD                                           78950074
789600          SET   VER_STATUS_CDE     =  :PC-INACTIVE                78960074
789700              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    78970074
789800          WHERE                                                   78980074
789900                ORD_NBR            =  :DK-ORD-NBR                 78990074
790000          AND   ORD_LNE_NBR        =  :DK-LINE-NBR                79000074
790100          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            79010074
790200          AND   OPER_UNT_ID        =  :DK-OPR-ID                  79020074
790300          AND   FCLTY_ID           =  :DK-FACT                    79030074
790400          AND   VER_STATUS_CDE     =  :PC-A                       79040074
790500     END-EXEC.                                                    79050074
790600                                                                  79060074
790700     EVALUATE TRUE                                                79070074
790800         WHEN SQLCODE = ZERO                                      79080074
790900         WHEN SQLCODE = +100                                      79090074
791000              CONTINUE                                            79100074
791100         WHEN SQLCODE = -904                                      79110074
791200         WHEN SQLCODE = -911                                      79120074
791300         WHEN SQLCODE = -913                                      79130074
791400              PERFORM 9900-SOFT-ABORT                             79140074
791500         WHEN OTHER                                               79150074
791600              MOVE '7110-DELETE-TWRKORD'                          79160074
791700                               TO DP013-PARAGRAPH                 79170074
791800              MOVE 'UPDATE TWRKORD STATUS CODE, UID; TO INACTIVE' 79180074
791900                               TO DP013-MESSAGE-TEXT (1)          79190074
792000              MOVE SQLCA       TO DP013-SQLCA                     79200074
792100              PERFORM 9950-FORMAT-ERROR-MSG                       79210074
792200              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        79220074
792300              SET DP013-DB2-ABEND                                 79230074
792400                               TO TRUE                            79240074
792500              PERFORM DP013-0000-PROCESS-ABEND                    79250074
792600     END-EVALUATE.                                                79260074
792700/                                                                 79270074
792800*----------------------------------------------------------------*79280074
792900*    "DELETE" THE CURRENT TWKORIN ROW - MAKE INACTIVE.           *79290074
793000*----------------------------------------------------------------*79300074
793100                                                                  79310074
793200 6930-DELETE-TWKORIN.                                             79320074
793300                                                                  79330074
793400     EXEC SQL                                                     79340074
793500          UPDATE                                                  79350074
793600                TWKORIN                                           79360074
793700          SET   VER_STATUS_CDE     =  :PC-INACTIVE                79370074
793800              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    79380074
793900          WHERE                                                   79390074
794000                ORD_NBR            =  :DK-ORD-NBR                 79400074
794100          AND   ORD_LNE_NBR        =  :DK-LINE-NBR                79410074
794200          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            79420074
794300          AND   OPER_UNT_ID        =  :DK-OPR-ID                  79430074
794400          AND   FCLTY_ID           =  :DK-FACT                    79440074
794500          AND   VER_STATUS_CDE     =  :PC-A                       79450074
794600     END-EXEC.                                                    79460074
794700                                                                  79470074
794800     EVALUATE TRUE                                                79480074
794900         WHEN SQLCODE = ZERO                                      79490074
795000         WHEN SQLCODE = +100                                      79500074
795100              CONTINUE                                            79510074
795200         WHEN SQLCODE = -904                                      79520074
795300         WHEN SQLCODE = -911                                      79530074
795400         WHEN SQLCODE = -913                                      79540074
795500              PERFORM 9900-SOFT-ABORT                             79550074
795600                                                                  79560074
795700         WHEN OTHER                                               79570074
795800              MOVE '6930-DELETE-TWKORIN'                          79580074
795900                               TO DP013-PARAGRAPH                 79590074
796000              MOVE 'UPDATE TWKORIN STATUS CODE, UID; TO INACTIVE' 79600074
796100                               TO DP013-MESSAGE-TEXT (1)          79610074
796200              MOVE SQLCA       TO DP013-SQLCA                     79620074
796300              PERFORM 9950-FORMAT-ERROR-MSG                       79630074
796400              MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)        79640074
796500              SET DP013-DB2-ABEND                                 79650074
796600                               TO TRUE                            79660074
796700              PERFORM DP013-0000-PROCESS-ABEND                    79670074
796800     END-EVALUATE.                                                79680074
796900/                                                                 79690074
797000*----------------------------------------------------------------*79700074
797100*    "DELETE" THE CURRENT TWOSTAL ROW - MAKE INACTIVE.           *79710074
797200*----------------------------------------------------------------*79720074
797300*                                                                 79730099
797400*6940-DELETE-TWOSTAL.                                             79740099
797500*                                                                 79750099
797600*    EXEC SQL                                                     79760099
797700*         UPDATE                                                  79770099
797800*               TWOSTAL                                           79780099
797900*         SET   VER_STATUS_CDE     =  :PC-INACTIVE                79790099
798000*             , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    79800099
798100*         WHERE                                                   79810099
798200*               ORD_NBR            =  :DK-ORD-NBR                 79820099
798300*         AND   ORD_LNE_NBR        =  :DK-LINE-NBR                79830099
798400*         AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            79840099
798500*         AND   OPER_UNT_ID        =  :DK-OPR-ID                  79850099
798600*         AND   FCLTY_ID           =  :DK-FACT                    79860099
798700*         AND   VER_STATUS_CDE     =  :PC-A                       79870099
798800*    END-EXEC.                                                    79880099
798900*                                                                 79890099
799000*    EVALUATE TRUE                                                79900099
799100*        WHEN SQLCODE = ZERO                                      79910099
799200*        WHEN SQLCODE = +100                                      79920099
799300*             CONTINUE                                            79930099
799400*        WHEN SQLCODE = -904                                      79940099
799500*        WHEN SQLCODE = -911                                      79950099
799600*        WHEN SQLCODE = -913                                      79960099
799700*             PERFORM 9900-SOFT-ABORT                             79970099
799800*                                                                 79980099
799900*        WHEN OTHER                                               79990099
800000*             MOVE '6940-DELETE-TWOSTAL'                          80000099
800100*                              TO DP013-PARAGRAPH                 80010099
800200*             MOVE 'UPDATE TWOSTAL STATUS CODE, UID; TO INACTIVE' 80020099
800300*                              TO DP013-MESSAGE-TEXT (1)          80030099
800400*             MOVE SQLCA       TO DP013-SQLCA                     80040099
800500*             PERFORM 9950-FORMAT-ERROR-MSG                       80050099
800600*             MOVE 'TWOSTAL'   TO DP013-DB2-TABLE-NAME (1)        80060099
800700*             SET DP013-DB2-ABEND                                 80070099
800800*                              TO TRUE                            80080099
800900*             PERFORM DP013-0000-PROCESS-ABEND                    80090099
801000*    END-EVALUATE.                                                80100099
801100*                                                                 80110099
801200*                                                                 80120099
801300*                                                                 80130099
801400******************************************************************80140074
801500* CALL AUDIT TABLE AND PHYSICALLY DELETE RECITM FOR THOSE LINES  *80150074
801600* THAT HAVE PKSL-ITEM-QTY = 0.                                   *80160074
801700******************************************************************80170074
801800 6950-CLEANUP-TRECITM.                                            80180074
801900                                                                  80190074
802000* BEFORE IMAGE                                                    80200074
802100     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       80210074
802200     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          80220074
802300     MOVE 'D'                      TO RC031-AUD-FUNC-CDE.         80230074
802400                                                                  80240074
802500     PERFORM 9011-CALL-AUDIT-PROGRAM.                             80250074
802600                                                                  80260074
802700*  AFTER IMAGE                                                    80270074
802800     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       80280074
802900     MOVE 'A'                      TO RC031-AUD-TYP-CDE.          80290074
803000     MOVE 'D'                      TO RC031-AUD-FUNC-CDE.         80300074
803100     MOVE 'DE'                     TO RC031-STATUS-CDE            80310074
803200     MOVE DP020-USERID             TO RC031-UPD-UID               80320074
803300     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST              80330074
803400                                                                  80340074
803500     PERFORM 9011-CALL-AUDIT-PROGRAM.                             80350074
803600                                                                  80360074
803700                                                                  80370074
803800* ACTUAL DELETION                                                 80380074
803900     EXEC SQL                                                     80390074
804000         DELETE                                                   80400074
804100         FROM                                                     80410074
804200             TRECITM                                              80420074
804300          WHERE                                                   80430074
804400                ORD_NBR            =  :DK-ORD-NBR                 80440074
804500            AND ORD_LNE_NBR        =  :DK-LINE-NBR                80450074
804600            AND REC_SEQ_NBR        =  :DK-RCVR-SEQ-NBR            80460074
804700            AND OPER_UNT_ID        =  :DK-OPR-ID                  80470074
804800            AND FCLTY_ID           =  :DK-FACT                    80480074
804900            AND PREPK_ID           =  :DK-PACK-ID                 80490074
805000     END-EXEC.                                                    80500074
805100                                                                  80510074
805200     EVALUATE TRUE                                                80520074
805300         WHEN SQLCODE = ZERO                                      80530074
805400         WHEN SQLCODE = +100                                      80540074
805500              CONTINUE                                            80550074
805600         WHEN SQLCODE = -904                                      80560074
805700         WHEN SQLCODE = -911                                      80570074
805800         WHEN SQLCODE = -913                                      80580074
805900              PERFORM 9900-SOFT-ABORT                             80590074
806000                                                                  80600074
806100         WHEN OTHER                                               80610074
806200              MOVE '6950-CLEANUP-TRECITM'                         80620074
806300                               TO DP013-PARAGRAPH                 80630074
806400              MOVE 'DELETE TRECITM'                               80640074
806500                               TO DP013-MESSAGE-TEXT (1)          80650074
806600              MOVE SQLCA       TO DP013-SQLCA                     80660074
806700              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        80670074
806800              PERFORM 9950-FORMAT-ERROR-MSG                       80680074
806900              SET DP013-DB2-ABEND                                 80690074
807000                               TO TRUE                            80700074
807100              PERFORM DP013-0000-PROCESS-ABEND                    80710074
807200     END-EVALUATE.                                                80720074
807300                                                                  80730074
807400                                                                  80740074
807500/                                                                 80750074
807600******************************************************************80760074
807700* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *80770074
807800******************************************************************80780074
807900 7000-FORMAT-COMMAREA.                                            80790074
808000                                                                  80800074
808100     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            80810074
808200        MOVE 1                   TO PV-BLOCK-NUMBER               80820074
808300     ELSE                                                         80830074
808400        MOVE 2                   TO PV-BLOCK-NUMBER               80840074
808500     END-IF.                                                      80850074
808600                                                                  80860074
808700* IF GOING TO STORE DISTRO BY PACK OR ADD LINE NEED TO FILL       80870074
808800* THE RC800 COMMAREA                                              80880074
808900     IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID) OR                 80890074
809000        DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)                    80900074
809100        MOVE ASC-OPR-ID          TO RC800-OPER-UNIT-ID            80910074
809200        MOVE ASC-FACT            TO RC800-FACILITY-ID             80920074
809300        MOVE ASC-REC-NBR         TO RC800-REC-NBR-N               80930074
809400        MOVE ASC-REC-SEQ-NBR     TO RC800-REC-SEQ-NBR-N           80940074
809500        MOVE ASC-PKGNG-CDE       TO RC800-PACK-TYPE               80950074
809600        MOVE ASC-PACK-DESC       TO RC800-PREPACK-DESC            80960074
809700        MOVE ASC-REC-STAT        TO RC800-REC-STATUS              80970074
809800     ELSE                                                         80980074
809900        MOVE ASC-OPR-ID          TO PC000-OPERATING-UNIT-ID       80990074
810000        MOVE ASC-FACT            TO PC000-FACILITY-ID             81000074
810100        MOVE ASC-REC-NBR         TO PC000-PO-NBR-N                81010074
810200        MOVE ASC-REC-SEQ-NBR     TO PC000-REC-SEQ-NBR-N           81020074
810300        MOVE PC-WORK-ORDER-DIST-SHEET                             81030074
810400                                 TO PC000-REPORT-ID.              81040074
810500                                                                  81050074
810600     PERFORM VARYING PV-SUB FROM 1 BY 1                           81060074
810700             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    81070074
810800         IF ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'       81080074
810900            MOVE ASC-LINE-NUMBER       (PV-BLOCK-NUMBER PV-SUB)   81090074
811000                                 TO PC000-LINE-NBR-N              81100074
811100**-->       ** UPON THE 1ST HIT, END THE LOOP BY BUMPING UP PV-SUB81110074
811200            COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1               81120074
811300         END-IF                                                   81130074
811400     END-PERFORM.                                                 81140074
811500                                                                  81150074
811600/                                                                 81160074
811700*----------------------------------------------------------------*81170074
811800*    INSERT OR UPDATE A RECEIPT ITEM ROW.  ONLY THOSE LINES      *81180074
811900*  THAT HAVE BEEN SELECTED WILL HAVE THEIR RATIO AND/OR DETAIL   *81190074
812000*  UNITS UPDATED, HOWEVER, ANY ROW IN THE PACK MAY HAVE THEIR    *81200074
812100*  ODD UNITS AND/OR DRIVER LINE INDICATOR UPDATED.  THIS IS      *81210074
812200*  DETERMINED BY THE SUBROUTINE RCKCS806.                        *81220074
812300*----------------------------------------------------------------*81230074
812400                                                                  81240074
812500 9010-DETERMINE-UPDATE.                                           81250074
812600     SET PS-UPDATE-NOT-NEEDED     TO TRUE.                        81260074
812700                                                                  81270074
812800     MOVE RC806-PKSL-LNE-NBR (PV-VALID-IDX)                       81280074
812900                                  TO DK-LINE-NBR.                 81290074
813000                                                                  81300074
813100     PERFORM 4320-GET-TRECITM-INFO.                               81310074
813200                                                                  81320074
813300     IF SQLCODE = +100                                            81330074
813400        CONTINUE                                                  81340074
813500     ELSE                                                         81350074
813600       MOVE RECITM-PREPK-RATO-QTY TO PV-PREV-DTL-RATIO            81360074
813700                                                                  81370074
813800       IF RC806-RC-RATIO (PV-VALID-IDX)                           81380074
813900                                       NOT = RECITM-PREPK-RATO-QTY81390074
814000          AND PV-LINE-SELECTED (PV-VALID-IDX)                     81400074
814100            MOVE RC806-RC-RATIO (PV-VALID-IDX)                    81410074
814200                                  TO RECITM-PREPK-RATO-QTY        81420074
814300            SET PS-UPDATE-NEEDED  TO TRUE                         81430074
814400       END-IF                                                     81440074
814500                                                                  81450074
814600       IF RC806-RCVG-QTY (PV-VALID-IDX)                           81460074
814700                                       NOT = RECITM-DTL-CK-ITM-QTY81470074
814800          AND PV-DTL-CK-UNIT-QTY (PV-VALID-IDX)                   81480074
814900          AND PV-LINE-SELECTED (PV-VALID-IDX)                     81490074
815000            MOVE RC806-RCVG-QTY (PV-VALID-IDX)                    81500074
815100                                  TO RECITM-DTL-CK-ITM-QTY        81510074
815200            SET PS-UPDATE-NEEDED  TO TRUE                         81520074
815300       END-IF                                                     81530074
815400                                                                  81540074
815500       IF RC806-ODD-UNITS (PV-VALID-IDX) NOT =                    81550074
815600                                       RECITM-PREPK-ODD-UNT-QTY   81560074
815700          MOVE RC806-ODD-UNITS (PV-VALID-IDX)                     81570074
815800                                  TO RECITM-PREPK-ODD-UNT-QTY     81580074
815900          SET PS-UPDATE-NEEDED    TO TRUE                         81590074
816000       END-IF                                                     81600074
816100                                                                  81610074
816200       IF RC806-DRIVER-LNE-SUB  = PV-VALID-IDX                    81620074
816300          IF RC806-RC-RATIO (PV-VALID-IDX) = +0                   81630074
816400             MOVE 'I'             TO RECITM-PREPK-DRV-LNE-CDE     81640074
816500             SET PS-UPDATE-NEEDED TO TRUE                         81650074
816600          ELSE                                                    81660074
816700            IF RECITM-PREPK-DRV-LNE-CDE = 'I' OR SPACES           81670074
816800               MOVE 'A'           TO RECITM-PREPK-DRV-LNE-CDE     81680074
816900               MOVE PV-TEMP-MKING-APRON-TMST                      81690074
817000                                  TO RECITM-MKING-APRON-TMST      81700074
817100               SET PS-UPDATE-NEEDED                               81710074
817200                                  TO TRUE                         81720074
817300            ELSE                                                  81730074
817400             MOVE PV-TEMP-MKING-APRON-TMST                        81740074
817500                                  TO RECITM-MKING-APRON-TMST      81750074
817600            END-IF                                                81760074
817700          END-IF                                                  81770074
817800       ELSE                                                       81780074
817900          IF RECITM-PREPK-DRV-LNE-CDE = 'A'                       81790074
818000             MOVE 'I'             TO RECITM-PREPK-DRV-LNE-CDE     81800074
818100             MOVE PC-DEFAULT-TMST TO RECITM-MKING-APRON-TMST      81810074
818200             SET PS-UPDATE-NEEDED TO TRUE                         81820074
818300       ELSE                                                       81830074
818400* KEEP THE VALUE THE SAME                                         81840074
818500          MOVE PC-DEFAULT-TMST   TO RECITM-MKING-APRON-TMST       81850074
818600       END-IF.                                                    81860074
818700                                                                  81870074
818800     IF PS-UPDATE-NEEDED                                          81880074
818900* BEFORE IMAGE                                                    81890074
819000          MOVE 'I'                 TO RC031-TABLE-TO-AUDIT        81900074
819100          MOVE 'B'                 TO RC031-AUD-TYP-CDE           81910074
819200          MOVE 'U'                 TO RC031-AUD-FUNC-CDE          81920074
819300          PERFORM 9011-CALL-AUDIT-PROGRAM                         81930074
819400          PERFORM 9012-UPDATE-TRECITM                             81940074
819500          IF SQLCODE = +0  AND                                    81950074
819600              ASC-CALL-STORE-ADJ                                  81960074
819700               PERFORM 9013-CALL-RECDIS-CONVERT                   81970074
819800          END-IF                                                  81980074
819900          MOVE ASC-BEST-CASE-PACKS TO ASC-PREV-BEST-CASE-PACKS    81990074
820000     END-IF.                                                      82000074
820100                                                                  82010074
820200                                                                  82020074
820300/                                                                 82030074
820400*----------------------------------------------------------------*82040074
820500*    LINK TO AUDIT MODULE * RCKCS290                             *82050074
820600*----------------------------------------------------------------*82060074
820700 9011-CALL-AUDIT-PROGRAM.                                         82070074
820800     MOVE DK-ORD-NBR          TO RC031-PO-NBR.                    82080074
820900     MOVE DK-LINE-NBR         TO RC031-PO-LNE-NBR.                82090074
821000     MOVE DK-RCVR-SEQ-NBR     TO RC031-REC-SEQ-NBR.               82100074
821100     MOVE DK-OPR-ID           TO RC031-OPER-UNT-ID.               82110074
821200     MOVE DK-FACT             TO RC031-FCLTY-ID.                  82120074
821300     MOVE PC-CURRENT-PROGRAM-NAME                                 82130074
821400                              TO RC031-UPD-PGM-ID.                82140074
821500                                                                  82150074
821600     EXEC CICS                                                    82160074
821700         LINK PROGRAM  (PC-AUDIT-RTN)                             82170074
821800              COMMAREA (RC031-FIELDS)                             82180074
821900              LENGTH   (PC-AUDIT-RTN-LENGTH)                      82190074
822000     END-EXEC.                                                    82200074
822100                                                                  82210074
822200     EVALUATE TRUE                                                82220074
822300         WHEN RC031-CALL-SUCCESSFUL                               82230074
822400             CONTINUE                                             82240074
822500                                                                  82250074
822600         WHEN OTHER                                               82260074
822700              MOVE '9011-CALL-AUDIT-PROGRAM'                      82270074
822800                                   TO DP013-PARAGRAPH             82280074
822900              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               82290074
823000                                   TO DP013-MESSAGE-TEXT (1)      82300074
823100              MOVE RC031-RETURN-DESC                              82310074
823200                                   TO DP013-MESSAGE-TEXT (2)      82320074
823300              MOVE RC031-SQLCA     TO DP013-SQLCA                 82330074
823400              PERFORM 9950-FORMAT-ERROR-MSG                       82340074
823500              SET DP013-DB2-ABEND                                 82350074
823600                  DP013-XCTL-DISPLAY-RESTART                      82360074
823700                                   TO TRUE                        82370074
823800              PERFORM DP013-0000-PROCESS-ABEND                    82380074
823900     END-EVALUATE.                                                82390074
824000                                                                  82400074
824100                                                                  82410074
824200                                                                  82420074
824300*----------------------------------------------------------------*82430074
824400*    UPDATE A RECEIPT ITEM ROW                                   *82440074
824500*----------------------------------------------------------------*82450074
824600 9012-UPDATE-TRECITM.                                             82460074
824700                                                                  82470074
824800     EXEC SQL                                                     82480074
824900         UPDATE TRECITM                                           82490074
825000         SET                                                      82500074
825100              DTL_CK_ITM_QTY      = :RECITM-DTL-CK-ITM-QTY        82510074
825200            , PREPK_RATO_QTY      = :RECITM-PREPK-RATO-QTY        82520074
825300            , PREPK_ODD_UNT_QTY   = :RECITM-PREPK-ODD-UNT-QTY     82530074
825400            , PREPK_DRV_LNE_CDE   = :RECITM-PREPK-DRV-LNE-CDE     82540074
825500            , MKING_APRON_TMST    = :RECITM-MKING-APRON-TMST      82550074
825600           WHERE ORD_NBR          = :DK-ORD-NBR                   82560074
825700             AND ORD_LNE_NBR      = :DK-LINE-NBR                  82570074
825800             AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR              82580074
825900             AND OPER_UNT_ID      = :DK-OPR-ID                    82590074
826000             AND FCLTY_ID         = :DK-FACT                      82600074
826100             AND VER_STATUS_CDE   = 'A'                           82610074
826200             AND PREPK_ID         = :DK-PACK-ID                   82620074
826300      END-EXEC                                                    82630074
826400                                                                  82640074
826500      EVALUATE TRUE                                               82650074
826600          WHEN SQLCODE = ZERO                                     82660074
826700               CONTINUE                                           82670074
826800                                                                  82680074
826900         WHEN SQLCODE = -904                                      82690074
827000         WHEN SQLCODE = -911                                      82700074
827100         WHEN SQLCODE = -913                                      82710074
827200              PERFORM 9900-SOFT-ABORT                             82720074
827300                                                                  82730074
827400         WHEN OTHER                                               82740074
827500               MOVE '9010-DETERMINE-UPDATE'                       82750074
827600                                TO DP013-PARAGRAPH                82760074
827700               MOVE 'UNSUCCESSFUL UPDATE FOR TRECITM'             82770074
827800                                TO DP013-MESSAGE-TEXT (1)         82780074
827900               MOVE SQLCA       TO DP013-SQLCA                    82790074
828000               MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)       82800074
828100               PERFORM 9950-FORMAT-ERROR-MSG                      82810074
828200               SET DP013-DB2-ABEND                                82820074
828300                   DP013-XCTL-DISPLAY-RESTART                     82830074
828400                                TO TRUE                           82840074
828500               PERFORM DP013-0000-PROCESS-ABEND                   82850074
828600      END-EVALUATE.                                               82860074
828700                                                                  82870074
828800                                                                  82880074
828900                                                                  82890074
829000*----------------------------------------------------------------*82900074
829100*    PERPARE TO CALL CONVERT RECDIS PROGRAM * RCKCS811           *82910074
829200*----------------------------------------------------------------*82920074
829300 9013-CALL-RECDIS-CONVERT.                                        82930074
829400                                                                  82940074
829500     IF PV-PREV-DTL-RATIO = 0                                     82950074
829600        MOVE PV-DRV-LINE-NBR      TO RC811-CLONE-LINE-NBR         82960074
829700        MOVE DK-LINE-NBR          TO RC811-MODIFY-LINE-NBR        82970074
829800        SET RC811-ADD-A-DISTRO-LINE                               82980074
829900                                  TO TRUE                         82990074
830000     ELSE                                                         83000074
830100        MOVE DK-LINE-NBR          TO RC811-MODIFY-LINE-NBR        83010074
830200        SET RC811-CONVERT-DISTRO-RATIO                            83020074
830300                                  TO TRUE                         83030074
830400     END-IF.                                                      83040074
830500                                                                  83050074
830600     MOVE  DK-ORD-NBR             TO RC811-PO-NBR                 83060074
830700     MOVE  DK-RCVR-SEQ-NBR        TO RC811-REC-SEQ-NBR            83070074
830800     MOVE  DK-OPR-ID              TO RC811-OPER-UNIT-ID           83080074
830900     MOVE  DK-FACT                TO RC811-FACILITY-ID            83090074
831000     MOVE  DK-PACK-ID             TO RC811-PREPK-ID               83100074
831100                                                                  83110074
831200     MOVE  PV-PREV-DTL-RATIO      TO RC811-OLD-DISTRO-RATIO       83120074
831300     MOVE  RECITM-PREPK-RATO-QTY  TO RC811-NEW-RC-RATIO.          83130074
831400                                                                  83140074
831500     IF RC811-OLD-DISTRO-RATIO NOT = RC811-NEW-RC-RATIO           83150074
831600        PERFORM 9014-LINK-CONVERT-MODULE.                         83160074
831700                                                                  83170074
831800                                                                  83180074
831900                                                                  83190074
832000*----------------------------------------------------------------*83200074
832100*    LINK TO RCKCS811 - CONVERT DISTRO PROGRAM                   *83210074
832200*----------------------------------------------------------------*83220074
832300                                                                  83230074
832400 9014-LINK-CONVERT-MODULE.                                        83240074
832500                                                                  83250074
832600     EXEC CICS                                                    83260074
832700          LINK PROGRAM  (PC-CONVERT-PGM)                          83270074
832800          COMMAREA (RC811-STORE-RECDIS-PROCESSING)                83280074
832900     END-EXEC.                                                    83290074
833000                                                                  83300074
833100     EVALUATE TRUE                                                83310074
833200         WHEN RC811-NO-ERROR                                      83320074
833300         WHEN RC811-WARNING-ERROR                                 83330074
833400         WHEN RC811-SUCCESSFUL-UPDATE                             83340074
833500         WHEN RC811-RETURN-CODE = +0                              83350074
833600         WHEN RC811-STORE-ALLOC-EXISTS                            83360074
833700             CONTINUE                                             83370074
833800         WHEN RC811-NO-RECDIS-ROW-TO-CONVERT                      83380074
833900         WHEN RC811-PACK-IN-RECDIS-NOT-FOUND                      83390074
834000              MOVE PC-TSYMSG-02173    TO DP020-MSG-NUMBER         83400074
834100              SET DP020-MSG-INFORMATIONAL                         83410074
834200                                       TO TRUE                    83420074
834300         WHEN RC811-CASE-PACK-SPLIT-EXISTS                        83430074
834400              MOVE PC-TSYMSG-01795    TO DP020-MSG-NUMBER         83440074
834500              SET DP020-MSG-INFORMATIONAL                         83450074
834600                                       TO TRUE                    83460074
834700         WHEN OTHER                                               83470074
834800             MOVE '9014-LINK-CONVERT-MODULE'                      83480074
834900                                 TO DP013-PARAGRAPH               83490074
835000             MOVE 'UNSUCCESSFUL CALL TO RECDIS CONVERT RTN'       83500074
835100                                 TO DP013-MESSAGE-TEXT (1)        83510074
835200             MOVE RC811-RETURN-CODE                               83520074
835300                                 TO DP013-MESSAGE-TEXT (2)        83530074
835400             MOVE RC811-SEVERITY-IND                              83540074
835500                                 TO DP013-SQLCA                   83550074
835600             SET DP013-XCTL-DISPLAY-RESTART                       83560074
835700                                 TO TRUE                          83570074
835800             PERFORM 9950-FORMAT-ERROR-MSG                        83580074
835900             PERFORM DP013-0000-PROCESS-ABEND                     83590074
836000     END-EVALUATE.                                                83600074
836100                                                                  83610074
836200                                                                  83620074
836300******************************************************************83630074
836400* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *83640074
836500******************************************************************83650074
836600 9100-READ-SEL-QUEUE.                                             83660074
836700     EXEC CICS                                                    83670074
836800         READQ TS                                                 83680074
836900             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        83690074
837000             INTO  (RC801-PREPACK-SELECT-RECORD)                  83700074
837100             ITEM  (ASC-SEL-ITEM)                                 83710074
837200             RESP  (PV-CICS-RESP)                                 83720074
837300     END-EXEC.                                                    83730074
837400                                                                  83740074
837500     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        83750074
837600         CONTINUE                                                 83760074
837700     ELSE                                                         83770074
837800         SET DP013-LOGIC-ABEND                                    83780074
837900             DP013-NO-ROLLBACK     TO TRUE                        83790074
838000         MOVE '9100-READ-SEL-QUEUE'                               83800074
838100                                   TO DP013-PARAGRAPH             83810074
838200         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    83820074
838300                                   TO DP013-MESSAGE-TEXT (1)      83830074
838400         PERFORM DP013-0000-PROCESS-ABEND                         83840074
838500     END-IF.                                                      83850074
838600                                                                  83860074
838700/                                                                 83870074
838800******************************************************************83880074
838900* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *83890074
839000******************************************************************83900074
839100 9200-REWRITE-LIST-QUEUE.                                         83910074
839200     EXEC CICS                                                    83920074
839300          WRITEQ TS                                               83930074
839400              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     83940074
839500              FROM    (RC801-PREPACK-SELECT-RECORD)               83950074
839600              ITEM    (ASC-SEL-ITEM)                              83960074
839700              RESP    (PV-CICS-RESP)                              83970074
839800              REWRITE                                             83980074
839900     END-EXEC.                                                    83990074
840000                                                                  84000074
840100     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    84010074
840200         SET DP013-CICS-ABEND                                     84020074
840300             DP013-NO-ROLLBACK     TO TRUE                        84030074
840400         MOVE '9200-REWRITE-LIST-QUEUE'                           84040074
840500                                   TO DP013-PARAGRAPH             84050074
840600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   84060074
840700                                   TO DP013-MESSAGE-TEXT (1)      84070074
840800         PERFORM DP013-0000-PROCESS-ABEND                         84080074
840900     END-IF.                                                      84090074
841000                                                                  84100074
841100/                                                                 84110074
841200******************************************************************84120074
841300* READ AN ITEM FROM THE INPUT SELECTED PACK SLIP ITEMS           *84130074
841400* TEMP STORAGE QUEUE.                                            *84140074
841500******************************************************************84150074
841600 9300-READ-PKSL-SEL-QUEUE.                                        84160074
841700                                                                  84170074
841800     EXEC CICS                                                    84180074
841900         READQ TS                                                 84190074
842000             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        84200074
842100             INTO  (RC801-PREPACK-SELECT-RECORD)                  84210074
842200             ITEM  (ASC-SEL-ITEM)                                 84220074
842300             RESP  (PV-CICS-RESP)                                 84230074
842400     END-EXEC.                                                    84240074
842500                                                                  84250074
842600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        84260074
842700         CONTINUE                                                 84270074
842800     ELSE                                                         84280074
842900         SET DP013-LOGIC-ABEND                                    84290074
843000             DP013-NO-ROLLBACK     TO TRUE                        84300074
843100         MOVE '9300-READ-PKSL-SEL-QUEUE'                          84310074
843200                                   TO DP013-PARAGRAPH             84320074
843300         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    84330074
843400                                   TO DP013-MESSAGE-TEXT (1)      84340074
843500         PERFORM DP013-0000-PROCESS-ABEND                         84350074
843600     END-IF.                                                      84360074
843700                                                                  84370074
843800/                                                                 84380074
843900******************************************************************84390074
844000* UPDATE AN ITEM IN THE INPUT SELECTED PACK SLIP ITEMS           *84400074
844100* TEMP STORAGE QUEUE.                                            *84410074
844200******************************************************************84420074
844300 9400-REWRITE-PKSL-LIST-QUEUE.                                    84430074
844400                                                                  84440074
844500     EXEC CICS                                                    84450074
844600          WRITEQ TS                                               84460074
844700              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     84470074
844800              FROM    (RC801-PREPACK-SELECT-RECORD)               84480074
844900              ITEM    (ASC-SEL-ITEM)                              84490074
845000              RESP    (PV-CICS-RESP)                              84500074
845100              REWRITE                                             84510074
845200     END-EXEC.                                                    84520074
845300                                                                  84530074
845400     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    84540074
845500         SET DP013-CICS-ABEND                                     84550074
845600             DP013-NO-ROLLBACK     TO TRUE                        84560074
845700         MOVE '9400-REWRITE-PKSL-LIST-QUEUE'                      84570074
845800                                   TO DP013-PARAGRAPH             84580074
845900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   84590074
846000                                   TO DP013-MESSAGE-TEXT (1)      84600074
846100         PERFORM DP013-0000-PROCESS-ABEND                         84610074
846200     END-IF.                                                      84620074
846300                                                                  84630074
846400/                                                                 84640074
846500*----------------------------------------------------------------*84650074
846600*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *84660074
846700*    AND THE ERROR SWITCHES.                                     *84670074
846800*----------------------------------------------------------------*84680074
846900 9900-SOFT-ABORT.                                                 84690074
847000     SET PS-ERROR         TO TRUE.                                84700074
847100     SET DP020-MSG-FATAL  TO TRUE.                                84710074
847200     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    84720074
847300     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       84730074
847400     PERFORM 0001-CALL-CICS-ARCH-API.                             84740074
847500                                                                  84750074
847600/                                                                 84760074
847700 9903-WRITE-CICS-LOG.                                             84770084
847800                                                                  84780084
847900     EXEC CICS                                                    84790084
848000         WRITEQ TD                                                84800084
848100             QUEUE  ('CSSL')                                      84810084
848200             FROM   (PV-CICS-MSG-AREA)                            84820084
848300             RESP   (PV-CICS-RESP)                                84830084
848400     END-EXEC.                                                    84840084
848500     MOVE SPACES                  TO PV-CICS-MSG-AREA.            84850084
848600/                                                                 84860084
848700*----------------------------------------------------------------*84870074
848800*  FORMAT A MESSAGE OUT TO CICS TO INCLUDE MORE INFO             *84880074
848900*----------------------------------------------------------------*84890074
849000                                                                  84900074
849100 9950-FORMAT-ERROR-MSG.                                           84910074
849200                                                                  84920074
849300     MOVE DK-ORD-NBR             TO PV-DISP-PO-NBR.               84930074
849400     MOVE DK-LINE-NBR            TO PV-DISP-PO-LNE-NBR.           84940074
849500     MOVE DK-RCVR-SEQ-NBR        TO PV-DISP-REC-SEQ-NBR.          84950074
849600     MOVE DK-OPR-ID              TO PV-DISP-OPER-UNT-ID.          84960074
849700     MOVE DK-FACT                TO PV-DISP-FCLTY-ID.             84970074
849800     MOVE DK-PACK-ID             TO PV-DISP-PACK-ID.              84980074
849900                                                                  84990074
850000     MOVE '  PO    REC  LNE OPER FCLTY PACK'                      85000074
850100                                 TO DP013-MESSAGE-TEXT (3).       85010074
850200                                                                  85020074
850300     STRING                                                       85030074
850400         PV-DISP-PO-NBR '-'                                       85040074
850500         PV-DISP-REC-SEQ-NBR '-'                                  85050074
850600         PV-DISP-PO-LNE-NBR '-'                                   85060074
850700         PV-DISP-OPER-UNT-ID '-'                                  85070074
850800         PV-DISP-FCLTY-ID '-'                                     85080074
850900         PV-DISP-PACK-ID                                          85090074
851000         DELIMITED BY SIZE INTO DP013-MESSAGE-TEXT (4).           85100074
851100                                                                  85110074
851200*----------------------------------------------------------------*85120074
851300*    ABEND PROCESSOR MODULE                                      *85130074
851400*----------------------------------------------------------------*85140074
851500                                                                  85150074
851600     COPY DPPD013.                                                85160074
