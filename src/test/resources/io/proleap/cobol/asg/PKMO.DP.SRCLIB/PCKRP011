000100***************************************************************** 00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300***************************************************************** 00030002
000400                                                                  00040002
000500 PROGRAM-ID.             PCKRP011.                                00050002
000600 AUTHOR.                 PATRICK BURKE.                           00060002
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070002
000800 DATE-WRITTEN.           JANUARY 2002.                            00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100***************************************************************** 00110002
001200*  THIS PROGRAM TAKE THE EXTRACT FILE CREATED IN PCKUT019 AND     00120002
001300*  CREATES A DAILY REPORT TO LIST UNITS WORKED BY AREA/SHIFT OR   00130002
001400*  GROUP/SHIFT  WITHIN OPERATIONAL UNIT.                          00140002
001500***************************************************************** 00150002
001600 ENVIRONMENT DIVISION.                                            00160002
001700***************************************************************** 00170002
001800 CONFIGURATION SECTION.                                           00180002
001900 SOURCE-COMPUTER.                        IBM-3090.                00190002
002000 OBJECT-COMPUTER.                        IBM-3090.                00200002
002100 INPUT-OUTPUT SECTION.                                            00210002
002200 FILE-CONTROL.                                                    00220002
002300                                                                  00230002
002400     SELECT EXTRACT-FILE                                          00240002
002500         ASSIGN TO INP01.                                         00250002
002600                                                                  00260002
002700     SELECT REPORT-FILE-1                                         00270002
002800         ASSIGN TO RPT01.                                         00280002
002900                                                                  00290002
003000     SELECT REPORT-FILE-2                                         00300002
003100         ASSIGN TO RPT02.                                         00310002
003200                                                                  00320002
003300***************************************************************** 00330002
003400 DATA DIVISION.                                                   00340002
003500***************************************************************** 00350002
003600 FILE SECTION.                                                    00360002
003700                                                                  00370002
003800 FD  EXTRACT-FILE                                                 00380002
003900     RECORDING MODE IS F                                          00390002
004000     LABEL RECORDS ARE STANDARD                                   00400002
004100     BLOCK CONTAINS 0 RECORDS.                                    00410002
004200 01  EXTRACT-RECORD                   PIC X(170).                 00420002
004300                                                                  00430002
004400 FD  REPORT-FILE-1                                                00440002
004500     RECORDING MODE IS F                                          00450002
004600     BLOCK CONTAINS 0 RECORDS.                                    00460002
004700 01  REPORT-RECORD-1                  PIC X(132).                 00470002
004800                                                                  00480002
004900 FD  REPORT-FILE-2                                                00490002
005000     RECORDING MODE IS F                                          00500002
005100     BLOCK CONTAINS 0 RECORDS.                                    00510002
005200 01  REPORT-RECORD-2                  PIC X(132).                 00520002
005300/                                                                 00530002
005400***************************************************************** 00540002
005500 WORKING-STORAGE SECTION.                                         00550002
005600***************************************************************** 00560002
005700*                                                                 00570002
005800**************************************************************    00580014
005900*  CONTROL CARD LAYOUT.                                           00590014
006000**************************************************************    00600014
006100     COPY PCWS239.                                                00610014
006200/                                                                 00620014
006300**************************************************************    00630002
006400                                                                  00640002
006500 01  PS-SWITCHES.                                                 00650002
006600     05  PS-PRINT-DETAILS-SW          PIC X(01) VALUE 'N'.        00660002
006700         88  PS-PRINT-DETAILS                   VALUE 'Y'.        00670002
006800         88  PS-NOT-PRINT-DETAILS               VALUE 'N'.        00680002
006900     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00690002
007000         88  PS-END-OF-INPUT                    VALUE 'Y'.        00700002
007100         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00710002
007200     05  PS-PAGE-SW                  PIC X(01) VALUE 'N'.         00720002
007300         88  PS-NEW-PAGE                       VALUE 'Y'.         00730002
007400         88  PS-SAME-PAGE                      VALUE 'N'.         00740002
007500     05  PS-PRINT-LINE-SW             PIC X(01) VALUE 'N'.        00750002
007600         88  PS-PRINT-LINE                      VALUE 'Y'.        00760002
007700                                                                  00770002
007800 01  DK-DB2-KEYS.                                                 00780002
007900     05  DK-RUN-DATE                  PIC X(10).                  00790002
008000     05  DK-WEEK-END-DATE             PIC X(10).                  00800002
008100                                                                  00810002
008200                                                                  00820002
008300 01  PV-DATE-RECORD.                                              00830002
008400     05  PV-FROM-DATE                 PIC X(10) VALUE SPACES.     00840002
008500     05  FILLER                       PIC X(01) VALUE SPACES.     00850002
008600     05  PV-TO-DATE                   PIC X(10) VALUE SPACES.     00860002
008700                                                                  00870002
008800 01  SD-SYSTEM-DATE.                                              00880002
008900     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00890002
009000     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00900002
009100     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00910002
009200                                                                  00920002
009300 01  ST-SYSTEM-TIME.                                              00930002
009400     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00940002
009500     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00950002
009600     05  FILLER                     PIC  9(04)   VALUE ZERO.      00960002
009700                                                                  00970002
009800 01  PV-VARIABLES.                                                00980002
009900     05  PV-READ-COUNT                PIC S9(7) COMP-3            00990002
010000                                                VALUE ZERO.       01000002
010100     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            01010002
010200                                                VALUE ZERO.       01020002
010300     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01030002
010400                                                VALUE ZERO.       01040002
010500     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            01050002
010600                                                VALUE ZERO.       01060002
010700     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       01070002
010800                                                 COMP SYNC.       01080002
010900     05  PV-SPACE-COUNT               PIC S9(05) VALUE ZERO       01090002
011000                                                 COMP-3.          01100002
011100     05  PV-CHAR-COUNT                PIC S9(05) VALUE ZERO       01110002
011200                                                 COMP-3.          01120002
011300     05  PV-REMAINDER                 PIC S9(05) VALUE ZERO       01130002
011400                                                 COMP-3.          01140002
011500     05  PV-RESULT                    PIC S9(05)V99 VALUE ZERO    01150002
011600                                                 COMP-3.          01160002
011700     05  PV-DEPT                      PIC 9(03) VALUE ZEROS.      01170002
011800     05  PV-STORE-NBR                 PIC S9(4) COMP.             01180002
011900     05  PV-STORE-NAME                PIC X(25) VALUE SPACES.     01190002
012000     05  PV-LOCATION-NBR              PIC 9(04) VALUE ZEROS.      01200002
012100     05  PV-OPER-ID                   PIC S9(4) COMP.             01210002
012200     05  PV-PREV-OPER-ID              PIC 9(04) VALUE ZEROS.      01220002
012300     05  PV-SHIFT-NBR                 PIC 9(01) VALUE ZEROS.      01230002
012400     05  PV-UNIT-RETAIL               PIC X(14) VALUE SPACES.     01240002
012500     05  PV-OPER-DESC                 PIC X(05) VALUE SPACES.     01250002
012600     05  PV-EXTENDED-RETAIL           PIC S9(12)V99.              01260002
012700     05  PV-EXTENDED-RETAIL-Z         PIC ZZZ,ZZZ,ZZZ.ZZ-         01270002
012800                                                 VALUE ZEROS.     01280002
012900                                                                  01290002
013000     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01300002
013100     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01310002
013200     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              01320002
013300                                                                  01330002
013400     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01340002
013500     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01350002
013600     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    01360002
013700     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    01370002
013800     05  PV-DB2-YEAR                  PIC S9(08) COMP             01380002
013900                                          VALUE ZERO.             01390002
014000     05  PV-DB2-MONTH                 PIC S9(08) COMP             01400002
014100                                          VALUE ZERO.             01410002
014200     05  PV-DB2-DAY                   PIC S9(08) COMP             01420002
014300                                          VALUE ZERO.             01430002
014400     05  PV-DB2-HOUR                  PIC S9(08) COMP             01440002
014500                                          VALUE ZERO.             01450002
014600     05  PV-DB2-MINUTE                PIC S9(08) COMP             01460002
014700                                          VALUE ZERO.             01470002
014800     05  PV-DB2-SECOND                PIC S9(08) COMP             01480002
014900                                          VALUE ZERO.             01490002
015000                                                                  01500002
015100     05  PV-DIVIDEND                  PIC 9(03)V9999.             01510002
015200     05  PV-TIMESTAMP                 PIC X(26).                  01520024
015300                                                                  01530002
015400******************************************************************01540002
015500 01  PV-DETAIL-LINE.                                              01550002
015600     05  PV-PROCESS                   PIC X(06) VALUE SPACES.     01560003
015700                                                                  01570003
015800     05  PV-3RD-UNITS                 PIC S9(09) VALUE +0         01580003
015900                                                 COMP.            01590003
016000     05  PV-3RD-PERCENT               PIC S9(03)V9 VALUE +0       01600002
016100                                                 COMP.            01610002
016200     05  PV-3RD-RETAIL                PIC S9(09) VALUE +0 COMP.   01620002
016300     05  PV-1ST-UNITS                 PIC S9(09) VALUE +0         01630002
016400                                                 COMP.            01640002
016500     05  PV-1ST-PERCENT               PIC S9(03)V9 VALUE +0       01650002
016600                                                 COMP.            01660002
016700     05  PV-1ST-RETAIL                PIC S9(09) VALUE +0 COMP.   01670009
016800     05  PV-2ND-UNITS                 PIC S9(09) VALUE +0         01680002
016900                                                 COMP.            01690002
017000     05  PV-2ND-PERCENT               PIC S9(03)V9 VALUE +0       01700002
017100                                                 COMP.            01710002
017200     05  PV-2ND-RETAIL                PIC S9(09) VALUE +0 COMP.   01720002
017300     05  PV-AREA-TOT-UNITS            PIC S9(09) VALUE +0         01730003
017400                                                 COMP.            01740002
017500     05  PV-AREA-TOT-RETAIL           PIC S9(09) VALUE +0 COMP.   01750003
017600     05  PV-AREA-DC-PERCENT           PIC S9(03)V9 VALUE +0       01760003
017700                                                 COMP.            01770002
017800     05  PV-DC-OPER1-PERCENT          PIC S9(03)V9 VALUE +0       01780003
017900                                                 COMP.            01790002
018000     05  PV-DC-OPER2-PERCENT          PIC S9(03)V9 VALUE +0       01800003
018100                                                 COMP.            01810002
018200     05  PV-DC-OPER3-PERCENT          PIC S9(03)V9 VALUE +0       01820003
018300                                                 COMP.            01830002
018400                                                                  01840002
018500 01  PV-TOTAL-LINE.                                               01850002
018600     05  PV-OPER-3RD-UNITS            PIC S9(09) VALUE +0         01860003
018700                                                 COMP.            01870002
018800     05  PV-OPER-3RD-PERCENT          PIC S9(03)V9 VALUE +0       01880003
018900                                                 COMP.            01890002
019000     05  PV-OPER-3RD-RETAIL           PIC S9(09) VALUE +0 COMP.   01900003
019100     05  PV-OPER-1ST-UNITS            PIC S9(09) VALUE +0         01910003
019200                                                 COMP.            01920002
019300     05  PV-OPER-1ST-PERCENT          PIC S9(03)V9 VALUE +0       01930003
019400                                                 COMP.            01940002
019500     05  PV-OPER-1ST-RETAIL           PIC S9(09) VALUE +0 COMP.   01950003
019600     05  PV-OPER-2ND-UNITS            PIC S9(09) VALUE +0         01960003
019700                                                 COMP.            01970002
019800     05  PV-OPER-2ND-PERCENT          PIC S9(03)V9 VALUE +0       01980003
019900                                                 COMP.            01990002
020000     05  PV-OPER-2ND-RETAIL           PIC S9(09) VALUE +0 COMP.   02000003
020100     05  PV-OPER-TOT-UNITS            PIC S9(09) VALUE +0         02010003
020200                                                 COMP.            02020002
020300     05  PV-OPER-TOT-RETAIL           PIC S9(13)V99 VALUE +0      02030022
020400                                                 COMP.            02040022
020500                                                                  02050002
020600******************************************************************02060002
020700 01  PV-VERIFIED-DATE.                                            02070002
020800     05  PV-VERIFIED-MM             PIC  X(02)   VALUE SPACES.    02080002
020900     05  FILLER                     PIC  X(01)   VALUE '/'.       02090002
021000     05  PV-VERIFIED-DD             PIC  X(02)   VALUE SPACES.    02100002
021100     05  FILLER                     PIC  X(01)   VALUE '/'.       02110002
021200     05  PV-VERIFIED-CC             PIC  X(02)   VALUE '20'.      02120002
021300     05  PV-VERIFIED-YY             PIC  X(02)   VALUE SPACES.    02130002
021400                                                                  02140002
021500 01  PV-FORMAT-DATE.                                              02150002
021600     05  PV-FORMAT-CCYY           PIC  X(04)   VALUE SPACES.      02160002
021700     05  FILLER                   PIC  X(01)   VALUE '/'.         02170002
021800     05  PV-FORMAT-MM             PIC  X(02)   VALUE SPACES.      02180002
021900     05  FILLER                   PIC  X(01)   VALUE '/'.         02190002
022000     05  PV-FORMAT-DD             PIC  X(02)   VALUE SPACES.      02200002
022100                                                                  02210002
022200 01  PV-BUCKETS COMP-3.                                           02220002
022300     05  PV-CLASS-TOTAL-UNITS      PIC S9(7) VALUE ZERO.          02230002
022400     05  PV-CLASS-TOTAL-RETAIL     PIC S9(10)V99 VALUE ZERO.      02240002
022500                                                                  02250002
022600     05  PV-DEPT-TOTAL-UNITS       PIC S9(7) VALUE ZERO.          02260002
022700     05  PV-DEPT-TOTAL-RETAIL      PIC S9(10)V99 VALUE ZERO.      02270002
022800                                                                  02280002
022900     05  PV-LOC-TOTAL-UNITS        PIC S9(7) VALUE ZERO.          02290002
023000     05  PV-LOC-TOTAL-RETAIL       PIC S9(10)V99 VALUE ZERO.      02300002
023100                                                                  02310002
023200 01  PV-ABEND-FIELDS.                                             02320002
023300     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02330002
023400                                                 COMP SYNC.       02340002
023500     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKRP035'.02350002
023600     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02360002
023700     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    02370002
023800     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    02380002
023900     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    02390002
024000     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    02400002
024100     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02410002
024200     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02420002
024300     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02430002
024400/                                                                 02440002
024500 01  PC-CONSTANTS.                                                02450002
024600     05  PC-PCKRP011                  PIC X(08) VALUE 'PCKRP011'. 02460002
024700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRP011'. 02470002
024800     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 02480002
024900     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         02490002
025000                                                COMP-3.           02500002
025100/                                                                 02510002
025200******************************************************************02520002
025300*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02530002
025400******************************************************************02540002
025500     COPY DPWS132O.                                               02550002
025600*                                                                 02560002
025700 01  HL-HEADING-LINE-1.                                           02570002
025800     05  HL1-SPECIAL-RUN             PIC  X(39).                  02580002
025900     05  FILLER                      PIC  X(48)  VALUE            02590002
026000      'DAILY LISTING OF UNITS WORKED BY PROC AREA/SHIFT'.         02600002
026100     05  FILLER                      PIC  X(39)  VALUE            02610002
026200      ' WITHIN OPER UNIT                      '.                  02620002
026300                                                                  02630002
026400 01  HL-HEADING-LINE-1A.                                          02640002
026500     05  HL1A-SPECIAL-RUN            PIC  X(39).                  02650002
026600     05  FILLER                      PIC  X(49)  VALUE            02660021
026700      'DAILY LISTING OF UNITS WORKED BY PROC GROUP/SHIFT'.        02670021
026800     05  FILLER                      PIC  X(38)  VALUE            02680021
026900      ' WITHIN OPER UNIT                     '.                   02690021
027000                                                                  02700002
027100 01  HL-HEADING-LINE-1B.                                          02710002
027200     05  HL1B-REQUEST1               PIC  X(17).                  02720002
027300     05  HL1B-USER-ID                PIC  X(08).                  02730002
027400     05  HL1B-REQUEST2               PIC  X(04).                  02740002
027500     05  FILLER                      PIC  X(16)  VALUE SPACES.    02750009
027600     05  FILLER                      PIC  X(26)  VALUE            02760009
027700      'BUSINESS DATE RANGE FROM: '.                               02770002
027800     05  HL1B-FROM-DATE.                                          02780002
027900         10  HL1B-FROM-MM            PIC 99.                      02790002
028000         10  FILLER                  PIC X VALUE '/'.             02800002
028100         10  HL1B-FROM-DD            PIC 99.                      02810002
028200         10  FILLER                  PIC X VALUE '/'.             02820002
028300         10  HL1B-FROM-CCYY          PIC 9(04).                   02830002
028400     05  FILLER                      PIC X(4)  VALUE              02840002
028500            ' TO '.                                               02850002
028600     05  HL1B-TO-DATE.                                            02860002
028700         10  HL1B-TO-MM              PIC 99.                      02870002
028800         10  FILLER                  PIC X VALUE '/'.             02880002
028900         10  HL1B-TO-DD              PIC 99.                      02890002
029000         10  FILLER                  PIC X VALUE '/'.             02900002
029100         10  HL1B-TO-CCYY            PIC 9(04).                   02910002
029200     05  FILLER                      PIC  X(47)  VALUE SPACES.    02920002
029300                                                                  02930002
029400 01  HL-HEADING-LINE-2.                                           02940015
029500     05  FILLER                      PIC  X(13)  VALUE            02950015
029600            'OPER UNIT  - '.                                      02960015
029700     05  HL2-LOCATION.                                            02970015
029800         10  HL2-OPER-ID             PIC  X(04) VALUE SPACES.     02980015
029900         10  FILLER                  PIC  X(01) VALUE SPACES.     02990015
030000         10  HL2-LOC-DESC            PIC  X(25) VALUE SPACES.     03000015
030100     05  HL2-CORPORATE REDEFINES HL2-LOCATION.                    03010015
030200         10  HL2-CORP-SUM            PIC  X(30).                  03020015
030300     05  FILLER                      PIC  X(57)  VALUE SPACES.    03030015
030400                                                                  03040015
030500 01  HL-HEADING-LINE-3.                                           03050002
030600     05  FILLER                      PIC  X(44)  VALUE            03060002
030700           '                                           '.         03070002
030800     05  FILLER                      PIC  X(44)  VALUE            03080002
030900           '                                           '.         03090002
031000     05  FILLER                      PIC  X(44)  VALUE            03100002
031100           '                                            '.        03110002
031200                                                                  03120002
031300 01  HL-HEADING-LINE-4.                                           03130002
031400     05  FILLER                      PIC  X(44)  VALUE            03140002
031500           'PROCESSING     3RD   3RD    3RD SHIFT      '.         03150002
031600     05  FILLER                      PIC  X(44)  VALUE            03160002
031700           '   1ST   1ST    1ST SHIFT         2ND    2ND'.        03170002
031800     05  FILLER                      PIC  X(44)  VALUE            03180002
031900           '    2ND SHIFT        TOTAL        AREA  % TO'.        03190002
032000                                                                  03200002
032100 01  HL-HEADING-LINE-5.                                           03210002
032200     05  HL5-PROC-DESC               PIC  X(05).                  03220002
032300     05  FILLER                      PIC  X(39)  VALUE            03230002
032400                 '        SHIFT  % TO       RETAIL      '.        03240009
032500     05  FILLER                      PIC  X(44)  VALUE            03250002
032600           ' SHIFT  % TO       RETAIL        SHIFT  % TO'.        03260002
032700     05  FILLER                      PIC  X(44)  VALUE            03270002
032800           '       RETAIL         AREA      RETAIL  OPER'.        03280002
032900                                                                  03290002
033000 01  HL-HEADING-LINE-6.                                           03300002
033100     05  FILLER                      PIC  X(19)  VALUE            03310021
033200           '             UNITS '.                                 03320021
033300     05  HL6-PROC-DESC-3RD           PIC  X(05).                  03330021
033400     05  FILLER                      PIC  X(20)  VALUE            03340021
033500           '      DOLLARS       '.                                03350021
033600     05  FILLER                      PIC  X(07)  VALUE            03360021
033700           ' UNITS '.                                             03370021
033800     05  HL6-PROC-DESC-1ST           PIC  X(05).                  03380021
033900     05  FILLER                      PIC  X(27)  VALUE            03390021
034000           '      DOLLARS        UNITS '.                         03400021
034100     05  HL6-PROC-DESC-2ND           PIC  X(05).                  03410021
034200     05  FILLER                      PIC  X(44)  VALUE            03420002
034300           '      DOLLARS        UNITS     DOLLARS TOTAL'.        03430002
034400                                                                  03440002
034500 01  DL-DETAIL-LINE-1.                                            03450002
034600     05  DL1-PROC-DESC                PIC X(06).                  03460011
034700     05  FILLER                       PIC X(01) VALUE SPACES.     03470013
034800     05  DL1-3RD-UNITS                PIC ZZZ,ZZZ,ZZ9.            03480002
034900     05  FILLER                       PIC X(01) VALUE SPACES.     03490002
035000     05  DL1-3RD-PERCENT              PIC ZZZ.9.                  03500002
035100     05  FILLER                       PIC X(02) VALUE SPACES.     03510002
035200     05  DL1-3RD-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03520018
035300     05  FILLER                       PIC X(02) VALUE SPACES.     03530002
035400     05  DL1-1ST-UNITS                PIC ZZZ,ZZZ,ZZ9.            03540002
035500     05  FILLER                       PIC X(01) VALUE SPACES.     03550002
035600     05  DL1-1ST-PERCENT              PIC ZZZ.9.                  03560002
035700     05  FILLER                       PIC X(02) VALUE SPACES.     03570002
035800     05  DL1-1ST-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03580018
035900     05  FILLER                       PIC X(02) VALUE SPACES.     03590002
036000     05  DL1-2ND-UNITS                PIC ZZZ,ZZZ,ZZ9.            03600002
036100     05  FILLER                       PIC X(01) VALUE SPACES.     03610002
036200     05  DL1-2ND-PERCENT              PIC ZZZ.9.                  03620002
036300     05  FILLER                       PIC X(02) VALUE SPACES.     03630002
036400     05  DL1-2ND-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03640018
036500     05  FILLER                       PIC X(02) VALUE SPACES.     03650002
036600     05  DL1-AREA-TOT-UNITS           PIC ZZZ,ZZZ,ZZ9.            03660002
036700     05  FILLER                       PIC X(01) VALUE SPACES.     03670002
036800     05  DL1-AREA-TOT-RETAIL          PIC ZZZ,ZZZ,ZZ9.            03680018
036900     05  FILLER                       PIC X(01) VALUE SPACES.     03690002
037000     05  DL1-AREA-DC-PERCENT          PIC ZZZ.9.                  03700003
037100                                                                  03710002
037200 01  TL1-COMP-LINE.                                               03720002
037300     05  FILLER                       PIC X(08) VALUE             03730002
037400         'TOTALS  '.                                              03740009
037500     05  FILLER                       PIC X(124) VALUE SPACES.    03750002
037600                                                                  03760002
037700 01  TL2-COMP-LINE.                                               03770002
037800     05  FILLER                       PIC X(07) VALUE             03780009
037900         '       '.                                               03790009
038000     05  TL2-3RD-UNITS                PIC ZZZ,ZZZ,ZZ9.            03800002
038100     05  FILLER                       PIC X(01) VALUE SPACES.     03810002
038200     05  TL2-3RD-PERCENT              PIC ZZZ.9.                  03820002
038300     05  FILLER                       PIC X(02) VALUE SPACES.     03830002
038400     05  TL2-3RD-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03840018
038500     05  FILLER                       PIC X(02) VALUE SPACES.     03850002
038600     05  TL2-1ST-UNITS                PIC ZZZ,ZZZ,ZZ9.            03860002
038700     05  FILLER                       PIC X(01) VALUE SPACES.     03870002
038800     05  TL2-1ST-PERCENT              PIC ZZZ.9.                  03880002
038900     05  FILLER                       PIC X(02) VALUE SPACES.     03890002
039000     05  TL2-1ST-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03900018
039100     05  FILLER                       PIC X(02) VALUE SPACES.     03910002
039200     05  TL2-2ND-UNITS                PIC ZZZ,ZZZ,ZZ9.            03920002
039300     05  FILLER                       PIC X(01) VALUE SPACES.     03930002
039400     05  TL2-2ND-PERCENT              PIC ZZZ.9.                  03940002
039500     05  FILLER                       PIC X(02) VALUE SPACES.     03950002
039600     05  TL2-2ND-RETAIL               PIC ZZZ,ZZZ,ZZ9.            03960018
039700     05  FILLER                       PIC X(02) VALUE SPACES.     03970002
039800     05  TL2-OPER-TOT-UNITS           PIC ZZZ,ZZZ,ZZ9.            03980003
039900     05  FILLER                       PIC X(02) VALUE SPACES.     03990002
040000     05  TL2-OPER-TOT-RETAIL          PIC ZZZ,ZZZ,ZZ9.            04000018
040100     05  FILLER                       PIC X(01) VALUE SPACES.     04010002
040200     05  TL2-OPER-TOT-PERCENT         PIC ZZZ.9.                  04020002
040300                                                                  04030002
040400                                                                  04040002
040500 01  ER-END-OF-REPORT-LINE.                                       04050002
040600     05  FILLER                       PIC X(19)  VALUE            04060002
040700         '** END OF REPORT **'.                                   04070002
040800     05  FILLER                       PIC X(113)  VALUE SPACES.   04080002
040900                                                                  04090002
041000 01  EP-EMPTY-REPORT-LINE.                                        04100002
041100     05  FILLER                       PIC X(34)  VALUE SPACES.    04110002
041200     05  FILLER                       PIC X(52)  VALUE            04120002
041300      '*************** EMPTY INPUT FILE *******************'.     04130002
041400     05  FILLER                       PIC X(49)  VALUE SPACES.    04140002
041500                                                                  04150002
041600 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    04160002
041700                                                                  04170002
041800 01  EL1-ERROR-LINE-1P.                                           04180017
041900     05  FILLER                      PIC  X(02)     VALUE SPACES. 04190017
042000     05  FILLER                      PIC  X(48)     VALUE         04200017
042100         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      04210017
042200     05  FILLER                      PIC  X(49)     VALUE         04220017
042300         'CREATING YOUR REPORT.   THIS REPORT COULD NOT BE '.     04230017
042400     05  FILLER                      PIC  X(33)     VALUE         04240017
042500         'COMPLETED.                       '.                     04250017
042600                                                                  04260017
042700 01  EL2-ERROR-LINE-2F.                                           04270017
042800     05  FILLER                      PIC  X(02)     VALUE SPACES. 04280017
042900     05  FILLER                      PIC  X(36)     VALUE         04290017
043000         'NONE OF YOUR REPORTS WERE CREATED.  '.                  04300017
043100     05  FILLER                      PIC  X(36)     VALUE         04310017
043200         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  04320017
043300     05  FILLER                      PIC  X(58)     VALUE SPACES. 04330017
043400                                                                  04340017
043500 01  EL3-ERROR-LINE-3.                                            04350017
043600     05  FILLER                      PIC  X(02)     VALUE SPACES. 04360017
043700     05  FILLER                      PIC  X(50)     VALUE         04370017
043800         'YOUR REQUEST WAS AS FOLLOWS:                      '.    04380017
043900     05  FILLER                      PIC  X(81)     VALUE SPACES. 04390017
044000                                                                  04400017
044100 01  EL4-ERROR-LINE-4.                                            04410017
044200     05  FILLER                      PIC  X(02)     VALUE SPACES. 04420017
044300     05  FILLER                      PIC  X(18)     VALUE         04430017
044400         'REQUESTOR       : '.                                    04440017
044500     05  EL4-REQUESTOR-ID            PIC  X(10)     VALUE SPACES. 04450017
044600     05  FILLER                      PIC  X(07)     VALUE SPACES. 04460017
044700     05  FILLER                      PIC  X(21)     VALUE         04470017
044800         'PRINTER DESTINATION: '.                                 04480017
044900     05  EL4-PRINTER-ID              PIC  X(10)     VALUE SPACES. 04490017
045000     05  FILLER                      PIC  X(65)     VALUE SPACES. 04500017
045100                                                                  04510017
045200 01  EL5-ERROR-LINE-5B.                                           04520017
045300     05  FILLER                      PIC  X(02)     VALUE SPACES. 04530017
045400     05  FILLER                      PIC  X(18)     VALUE         04540017
045500         'START DATE RANGE: '.                                    04550017
045600     05  EL5-START-DATE-RANGE        PIC  X(10).                  04560017
045700     05  FILLER                      PIC  X(07)     VALUE SPACES. 04570017
045800     05  FILLER                      PIC  X(21)     VALUE         04580017
045900         'END DATE RANGE     : '.                                 04590017
046000     05  EL5-END-DATE-RANGE          PIC  X(10).                  04600017
046100     05  FILLER                      PIC  X(20)     VALUE SPACES. 04610017
046200/                                                                 04620002
046300******************************************************************04630002
046400*  COPYBOOK USED BY MBS SYSTEM                                    04640002
046500******************************************************************04650002
046600     COPY DPWS003.                                                04660002
046700*                                                                 04670002
046800******************************************************************04680002
046900*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 04690002
047000******************************************************************04700002
047100     COPY DPWS024.                                                04710002
047200/                                                                 04720002
047300******************************************************************04730002
047400*  DB2 FORMATTED MESSAGE AREA                                     04740002
047500******************************************************************04750002
047600     COPY DPWS004.                                                04760002
047700/                                                                 04770002
047800******************************************************************04780002
047900* CORPORATE DATE ROUTINES                                         04790002
048000******************************************************************04800002
048100     COPY DPWS500.                                                04810002
048200/                                                                 04820002
048300******************************************************************04830002
048400*  RECORD LAYOUT FOR INPUT FILE                                   04840002
048500******************************************************************04850002
048600     COPY PCRD012.                                                04860002
048700/                                                                 04870023
048800*    LOCATION MODULE                                              04880023
048900     COPY XLWS071.                                                04890023
049000/                                                                 04900002
049100******************************************************************04910002
049200*   DB2 SQL COMMUNICATION AREA                                    04920002
049300******************************************************************04930002
049400     EXEC SQL                                                     04940002
049500         INCLUDE SQLCA                                            04950002
049600     END-EXEC.                                                    04960002
049700*                                                                 04970002
049800     COPY SQLCA2.                                                 04980002
049900*                                                                 04990002
050000*                                                                 05000002
050100******************************************************************05010002
050200 PROCEDURE DIVISION.                                              05020002
050300******************************************************************05030002
050400 0000-MAINLINE.                                                   05040002
050500                                                                  05050002
050600     ACCEPT PC239-CONTROL-CARD FROM SYSIN.                        05060002
050700     DISPLAY 'CONTROL CARD = ' PC239-CONTROL-CARD.                05070002
050800                                                                  05080002
050900     IF CC-RPT-PCKRP011                                           05090002
051000         OPEN INPUT  EXTRACT-FILE                                 05100002
051100         IF CC-ROUTE-TO-RDS                                       05110002
051200            OPEN OUTPUT REPORT-FILE-1                             05120002
051300         ELSE                                                     05130002
051400            OPEN OUTPUT REPORT-FILE-2                             05140002
051500         END-IF                                                   05150002
051600                                                                  05160002
051700         PERFORM 2100-READ-EXTRACT                                05170002
051800         PERFORM 1000-INITIALIZE                                  05180017
051900                                                                  05190002
052000         IF PC012-RCD-TYPE-ERROR                                  05200002
052100             PERFORM 7000-WRITE-ERROR-REPORT                      05210017
052200         ELSE                                                     05220002
052300             PERFORM 8100-WRITE-SUB-HEADINGS                      05230017
052400             PERFORM 2000-PROCESS-EXTRACT                         05240017
052500                 UNTIL PS-END-OF-INPUT                            05250017
052600             PERFORM 3100-COMPANY-TOTALS                          05260017
052700             PERFORM 9000-EOJ                                     05270017
052800         END-IF                                                   05280017
052900      END-IF.                                                     05290017
053000                                                                  05300002
053100     GOBACK.                                                      05310002
053200                                                                  05320002
053300******************************************************************05330002
053400 1000-INITIALIZE.                                                 05340002
053500******************************************************************05350002
053600*                                                                 05360002
053700     EXEC SQL                                                     05370023
053800         SET :PV-TIMESTAMP = CURRENT TIMESTAMP                    05380023
053900     END-EXEC                                                     05390023
054000*                                                                 05400023
054100* LOAD SYSTEM DATE INTO HEADINGS                                  05410002
054200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             05420002
054300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             05430002
054400                                                                  05440002
054500     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              05450002
054600     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             05460002
054700     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               05470002
054800     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              05480002
054900     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            05490002
055000                                                                  05500002
055100     MOVE PC-CURRENT-PROGRAM-NAME                                 05510002
055200                                 TO DP132O-PROGRAM-NAME.          05520002
055300     MOVE 1                      TO DP132O-REPORT-NUMBER          05530002
055400                                    DP132O-PAGE-NUMBER.           05540002
055500                                                                  05550002
055600     IF CC-OPER-ALL                                               05560002
055700        MOVE 'CORPORATE SUMMARY'    TO HL2-CORPORATE              05570015
055800     ELSE                                                         05580002
055900        MOVE CC-OPER-UNIT-ID        TO HL2-OPER-ID                05590003
056000                                       PV-STORE-NBR               05600003
056100        PERFORM 1200-SELECT-OPER-DESC.                            05610002
056200                                                                  05620002
056300     IF CC-BATCH-REQUEST                                          05630002
056400        CONTINUE                                                  05640002
056500     ELSE                                                         05650002
056600        MOVE '** SPECIAL REQUESTED RUN **' TO HL1-SPECIAL-RUN     05660002
056700        MOVE '** REQUESTED BY: '         TO HL1B-REQUEST1         05670002
056800        MOVE CC-USER-ID                  TO HL1B-USER-ID          05680002
056900        MOVE '**  '                      TO HL1B-REQUEST2         05690002
057000     END-IF.                                                      05700002
057100                                                                  05710002
057200     PERFORM 8000-WRITE-MAIN-HEADINGS.                            05720002
057300        INITIALIZE PV-BUCKETS.                                    05730002
057400*                                                                 05740002
057500***************************************************************** 05750002
057600 1200-SELECT-OPER-DESC.                                           05760002
057700***************************************************************** 05770002
057800*                                                                 05780002
057900     INITIALIZE XL071-COMMAREA-REC.                               05790023
058000     MOVE PV-STORE-NBR         TO XL071-LOCATION-NUMBER           05800023
058100                                                                  05810023
058200     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         05820023
058300                                                                  05830023
058400     EVALUATE TRUE                                                05840023
058500     WHEN XL071-NO-ERRORS                                         05850023
058600         MOVE XL071-LOC-NM    TO PV-STORE-NAME                    05860023
058700     WHEN XL071-LOC-NOT-FOUND                                     05870023
058800     WHEN XL071-DC-ASGMT-NOT-FND                                  05880023
058900         MOVE SPACES           TO  PV-STORE-NAME                  05890023
059000     WHEN XL071-BAD-DB2-RETURN                                    05900023
059100         MOVE XL071-SQLCA             TO SQLCA                    05910023
059200         MOVE '1200-SELECT-OPER-DESC'                             05920023
059300                                TO PV-PARAGRAPH                   05930023
059400         MOVE 'SELECT'          TO PV-DB2-FUNCTION                05940023
059500         MOVE ' CALL TO XLKUT071'                                 05950023
059600                                TO PV-DB2-OPERATION-MESSAGE-1     05960023
059700         MOVE ' TABLE = XLT_LOC '                                 05970023
059800                                TO PV-DB2-OPERATION-MESSAGE-2     05980023
059900         PERFORM 9200-SQL-ABEND                                   05990023
060000     END-EVALUATE.                                                06000023
060100/                                                                 06010023
060200******************************************************************06020002
060300*  PRINT A 'NO INPUT' REPORT LINE.                                06030002
060400******************************************************************06040002
060500 1300-NO-DETAIL-LINE.                                             06050002
060600                                                                  06060002
060700         IF CC-ROUTE-TO-RDS                                       06070002
060800             WRITE REPORT-RECORD-1                                06080002
060900               FROM EP-EMPTY-REPORT-LINE                          06090002
061000                 AFTER ADVANCING 3 LINES                          06100002
061100         ELSE                                                     06110002
061200             WRITE REPORT-RECORD-2                                06120002
061300               FROM EP-EMPTY-REPORT-LINE                          06130002
061400                 AFTER ADVANCING 3 LINES.                         06140002
061500*                                                                 06150002
061600***************************************************************** 06160002
061700* CHECK SHIFT NUMBER AND MOVE AREA/GROUP SHIFT TOTALS TO WS.      06170003
061800***************************************************************** 06180002
061900 1400-PROCESS-AREA-SHIFT.                                         06190004
062000*                                                                 06200002
062100     EVALUATE TRUE                                                06210002
062200        WHEN PC012-SHIFT-NBR = 1                                  06220002
062300            MOVE PC012-UNT-WRKD-QTY       TO  PV-1ST-UNITS        06230002
062400            ADD  PC012-UNT-WRKD-QTY       TO  PV-AREA-TOT-UNITS   06240004
062500            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-1ST-RETAIL       06250002
062600            ADD  PC012-EXTD-RTL-WRKD-AMT  TO  PV-AREA-TOT-RETAIL  06260004
062700                                                                  06270002
062800        WHEN PC012-SHIFT-NBR = 2                                  06280002
062900            MOVE PC012-UNT-WRKD-QTY       TO  PV-2ND-UNITS        06290002
063000            ADD  PC012-UNT-WRKD-QTY       TO  PV-AREA-TOT-UNITS   06300004
063100            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-2ND-RETAIL       06310002
063200            ADD  PC012-EXTD-RTL-WRKD-AMT  TO  PV-AREA-TOT-RETAIL  06320004
063300                                                                  06330002
063400                                                                  06340002
063500        WHEN PC012-SHIFT-NBR = 3                                  06350002
063600            MOVE PC012-UNT-WRKD-QTY       TO  PV-3RD-UNITS        06360002
063700            ADD  PC012-UNT-WRKD-QTY       TO  PV-AREA-TOT-UNITS   06370004
063800            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-3RD-RETAIL       06380002
063900            ADD  PC012-EXTD-RTL-WRKD-AMT  TO  PV-AREA-TOT-RETAIL  06390004
064000                                                                  06400002
064100     END-EVALUATE.                                                06410002
064200/                                                                 06420002
064300***************************************************************** 06430004
064400* CHECK SHIFT NUMBER, WRITE AREA TOTALS AND FIGURE PECENTAGES.    06440004
064500***************************************************************** 06450004
064600 1410-AREA-SHIFT-BUILD.                                           06460004
064700*                                                                 06470004
064800        MOVE '1'               TO  PV-SHIFT-NBR                   06480004
064900        IF PV-AREA-TOT-UNITS   > ZERO                             06490004
065000          DIVIDE PV-1ST-UNITS  BY  PV-AREA-TOT-UNITS              06500004
065100            GIVING PV-DIVIDEND ROUNDED                            06510004
065200          MULTIPLY PV-DIVIDEND BY 100                             06520012
065300            GIVING PV-1ST-PERCENT                                 06530012
065400          IF PV-1ST-PERCENT = ZERO AND                            06540020
065500             PV-1ST-UNITS > ZERO                                  06550020
065600              MOVE .1      TO PV-1ST-PERCENT                      06560012
065700          END-IF                                                  06570012
065800        ELSE                                                      06580004
065900              MOVE ZEROES  TO  PV-DIVIDEND                        06590004
066000                               PV-1ST-PERCENT                     06600004
066100        END-IF.                                                   06610004
066200                                                                  06620004
066300        MOVE '2'               TO  PV-SHIFT-NBR                   06630004
066400        IF PV-AREA-TOT-UNITS   > ZERO                             06640004
066500          DIVIDE PV-2ND-UNITS  BY  PV-AREA-TOT-UNITS              06650004
066600            GIVING PV-DIVIDEND ROUNDED                            06660004
066700          MULTIPLY PV-DIVIDEND BY 100                             06670012
066800            GIVING PV-2ND-PERCENT                                 06680012
066900          IF PV-2ND-PERCENT = ZERO AND                            06690020
067000             PV-2ND-UNITS > ZERO                                  06700020
067100              MOVE .1      TO PV-2ND-PERCENT                      06710012
067200          END-IF                                                  06720012
067300        ELSE                                                      06730004
067400              MOVE ZEROES  TO  PV-DIVIDEND                        06740004
067500                               PV-2ND-PERCENT                     06750004
067600        END-IF.                                                   06760004
067700                                                                  06770004
067800        MOVE '3'               TO  PV-SHIFT-NBR                   06780004
067900        IF PV-AREA-TOT-UNITS   > ZERO                             06790004
068000          DIVIDE PV-3RD-UNITS  BY  PV-AREA-TOT-UNITS              06800004
068100            GIVING PV-DIVIDEND ROUNDED                            06810004
068200          MULTIPLY PV-DIVIDEND BY 100                             06820012
068300            GIVING PV-3RD-PERCENT                                 06830012
068400          IF PV-3RD-PERCENT = ZERO AND                            06840020
068500             PV-3RD-UNITS > ZERO                                  06850020
068600              MOVE .1      TO PV-3RD-PERCENT                      06860012
068700          END-IF                                                  06870012
068800        ELSE                                                      06880004
068900              MOVE ZEROES  TO  PV-DIVIDEND                        06890004
069000                               PV-3RD-PERCENT                     06900004
069100        END-IF.                                                   06910004
069200/                                                                 06920004
069300***************************************************************** 06930010
069400* DETERMINE IF AREA OR GROUP REPORT.                              06940010
069500***************************************************************** 06950010
069600 1450-CONTENT-CODE.                                               06960010
069700*                                                                 06970010
069800     IF CC-RPT-BY-PRCS-AREA                                       06980010
069900         MOVE PC012-PROCESS-AREA    TO PV-PROCESS                 06990010
070000     ELSE                                                         07000010
070100         MOVE PC012-PROCESS-GROUP   TO PV-PROCESS.                07010010
070200/                                                                 07020010
070300***************************************************************** 07030010
070400* MOVE DC TOTALS TO REPORT FIELDS.                                07040010
070500***************************************************************** 07050010
070600 1500-PROCESS-DC-TOTAL.                                           07060010
070700*                                                                 07070010
070800     MOVE PC012-UNT-WRKD-QTY       TO PV-OPER-TOT-UNITS.          07080010
070900     MOVE PC012-EXTD-RTL-WRKD-AMT  TO PV-OPER-TOT-RETAIL.         07090010
071000/                                                                 07100004
071100***************************************************************** 07110009
071200* AREA TO OPER PERCENT.                                           07120009
071300***************************************************************** 07130009
071400 1510-PROCESS-AREA-DC-PERCENT.                                    07140009
071500*                                                                 07150009
071600     IF PV-OPER-TOT-UNITS  > ZERO                                 07160009
071700       DIVIDE PV-AREA-TOT-UNITS  BY  PV-OPER-TOT-UNITS            07170009
071800          GIVING PV-DIVIDEND ROUNDED                              07180012
071900       MULTIPLY PV-DIVIDEND BY 100                                07190012
072000          GIVING PV-AREA-DC-PERCENT                               07200012
072100       IF PV-AREA-DC-PERCENT = ZERO AND                           07210020
072200          PV-AREA-TOT-UNITS > ZERO                                07220020
072300            MOVE .1      TO PV-AREA-DC-PERCENT                    07230012
072400       END-IF                                                     07240012
072500     ELSE                                                         07250009
072600           MOVE ZEROES  TO  PV-DIVIDEND                           07260009
072700                            PV-AREA-DC-PERCENT                    07270009
072800     END-IF.                                                      07280009
072900/                                                                 07290009
073000***************************************************************** 07300009
073100* INITIALIZE AREA TOTALS.                                         07310009
073200***************************************************************** 07320009
073300 1550-INITIALIZE-AREA-TOTALS.                                     07330009
073400*                                                                 07340009
073500     INITIALIZE     PV-AREA-TOT-UNITS                             07350009
073600                    PV-AREA-TOT-RETAIL.                           07360009
073700/                                                                 07370009
073800***************************************************************** 07380009
073900* CHECK SHIFT NUMBER AND MOVE OPER SHIFT TOTALS TO WS.            07390009
074000***************************************************************** 07400009
074100 1600-PROCESS-DC-SHIFT.                                           07410009
074200*                                                                 07420009
074300     EVALUATE TRUE                                                07430009
074400        WHEN PC012-SHIFT-NBR = 1                                  07440009
074500            MOVE PC012-UNT-WRKD-QTY       TO  PV-OPER-1ST-UNITS   07450009
074600            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-OPER-1ST-RETAIL  07460009
074700                                                                  07470009
074800            IF PV-OPER-TOT-UNITS  > ZERO                          07480009
074900              DIVIDE PV-OPER-1ST-UNITS  BY  PV-OPER-TOT-UNITS     07490009
075000                GIVING PV-DIVIDEND ROUNDED                        07500009
075100              MULTIPLY PV-DIVIDEND BY 100                         07510012
075200                GIVING PV-OPER-1ST-PERCENT                        07520012
075300              IF PV-OPER-1ST-PERCENT = ZERO AND                   07530018
075400                 PV-OPER-1ST-UNITS > ZERO                         07540018
075500                   MOVE .1      TO PV-OPER-1ST-PERCENT            07550012
075600              END-IF                                              07560012
075700            ELSE                                                  07570009
075800                  MOVE ZEROES  TO  PV-DIVIDEND                    07580009
075900                                   PV-OPER-1ST-PERCENT            07590018
076000            END-IF                                                07600009
076100                                                                  07610009
076200        WHEN PC012-SHIFT-NBR = 2                                  07620009
076300            MOVE PC012-UNT-WRKD-QTY       TO  PV-OPER-2ND-UNITS   07630009
076400            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-OPER-2ND-RETAIL  07640009
076500                                                                  07650009
076600            IF PV-OPER-TOT-UNITS  > ZERO                          07660009
076700              DIVIDE PV-OPER-2ND-UNITS  BY  PV-OPER-TOT-UNITS     07670009
076800                GIVING PV-DIVIDEND ROUNDED                        07680009
076900              MULTIPLY PV-DIVIDEND BY 100                         07690012
077000                GIVING PV-OPER-2ND-PERCENT                        07700012
077100              IF PV-OPER-2ND-PERCENT = ZERO AND                   07710019
077200                 PV-OPER-2ND-UNITS > ZERO                         07720019
077300                   MOVE .1      TO PV-OPER-2ND-PERCENT            07730012
077400              END-IF                                              07740012
077500            ELSE                                                  07750009
077600                  MOVE ZEROES  TO  PV-DIVIDEND                    07760009
077700                                   PV-OPER-2ND-PERCENT            07770018
077800            END-IF                                                07780009
077900                                                                  07790009
078000        WHEN PC012-SHIFT-NBR = 3                                  07800009
078100            MOVE PC012-UNT-WRKD-QTY       TO  PV-OPER-3RD-UNITS   07810009
078200            MOVE PC012-EXTD-RTL-WRKD-AMT  TO  PV-OPER-3RD-RETAIL  07820009
078300                                                                  07830009
078400            IF PV-OPER-TOT-UNITS  > ZERO                          07840009
078500              DIVIDE PV-OPER-3RD-UNITS  BY  PV-OPER-TOT-UNITS     07850009
078600                GIVING PV-DIVIDEND ROUNDED                        07860009
078700              MULTIPLY PV-DIVIDEND BY 100                         07870012
078800                GIVING PV-OPER-3RD-PERCENT                        07880012
078900              IF PV-OPER-3RD-PERCENT = ZERO AND                   07890019
079000                 PV-OPER-3RD-UNITS > ZERO                         07900019
079100                   MOVE .1      TO PV-OPER-3RD-PERCENT            07910012
079200              END-IF                                              07920012
079300            ELSE                                                  07930009
079400                  MOVE ZEROES  TO  PV-DIVIDEND                    07940009
079500                                   PV-OPER-3RD-PERCENT            07950018
079600            END-IF                                                07960009
079700                                                                  07970009
079800     END-EVALUATE.                                                07980009
079900/                                                                 07990009
080000******************************************************************08000002
080100 2000-PROCESS-EXTRACT.                                            08010002
080200******************************************************************08020002
080300*                                                                 08030002
080400     EVALUATE TRUE                                                08040002
080500       WHEN PC012-RECORD-TYPE-CDE = 'D'                           08050002
080600           PERFORM 1500-PROCESS-DC-TOTAL                          08060004
080700                                                                  08070002
080800       WHEN PC012-RECORD-TYPE-CDE = 'E'                           08080002
080900           PERFORM 1600-PROCESS-DC-SHIFT                          08090004
081000                                                                  08100003
081100       WHEN PC012-RECORD-TYPE-CDE = 'F'                           08110003
081200           PERFORM 1400-PROCESS-AREA-SHIFT                        08120004
081300           IF PV-SHIFT-NBR    = 3                                 08130003
081400               PERFORM 1410-AREA-SHIFT-BUILD                      08140004
081500               PERFORM 1450-CONTENT-CODE                          08150010
081600               PERFORM 1510-PROCESS-AREA-DC-PERCENT               08160010
081700               PERFORM 3000-PRINT-DETAILS                         08170010
081800               PERFORM 1550-INITIALIZE-AREA-TOTALS                08180010
081900           END-IF                                                 08190010
082000                                                                  08200010
082100     END-EVALUATE.                                                08210002
082200                                                                  08220002
082300     PERFORM 2100-READ-EXTRACT.                                   08230002
082400*                                                                 08240002
082500******************************************************************08250002
082600*  READ NEXT INPUT FILE RECORD.                                   08260002
082700******************************************************************08270002
082800 2100-READ-EXTRACT.                                               08280002
082900                                                                  08290002
083000     READ EXTRACT-FILE INTO PC012-RECORD-LAYOUT                   08300002
083100        AT END                                                    08310002
083200           SET PS-END-OF-INPUT TO TRUE                            08320002
083300        NOT AT END                                                08330002
083400           ADD +1                  TO PV-READ-COUNT               08340002
083500           MOVE PC012-OPER-UNT-ID  TO PV-OPER-ID                  08350002
083600           MOVE PC012-SHIFT-NBR    TO PV-SHIFT-NBR                08360002
083700     END-READ.                                                    08370002
083800*                                                                 08380002
083900******************************************************************08390002
084000*  FILL AND PRINT DETAIL REPORT LINE.                             08400002
084100******************************************************************08410002
084200 3000-PRINT-DETAILS.                                              08420002
084300*                                                                 08430002
084400     MOVE PV-PROCESS              TO DL1-PROC-DESC.               08440003
084500     MOVE PV-3RD-UNITS            TO DL1-3RD-UNITS.               08450002
084600     MOVE PV-3RD-PERCENT          TO DL1-3RD-PERCENT.             08460002
084700     MOVE PV-3RD-RETAIL           TO DL1-3RD-RETAIL.              08470002
084800                                                                  08480002
084900     MOVE PV-1ST-UNITS            TO DL1-1ST-UNITS.               08490002
085000     MOVE PV-1ST-PERCENT          TO DL1-1ST-PERCENT.             08500002
085100     MOVE PV-1ST-RETAIL           TO DL1-1ST-RETAIL.              08510002
085200                                                                  08520002
085300     MOVE PV-2ND-UNITS            TO DL1-2ND-UNITS.               08530002
085400     MOVE PV-2ND-PERCENT          TO DL1-2ND-PERCENT.             08540002
085500     MOVE PV-2ND-RETAIL           TO DL1-2ND-RETAIL.              08550002
085600                                                                  08560002
085700     MOVE PV-AREA-TOT-UNITS       TO DL1-AREA-TOT-UNITS.          08570003
085800     MOVE PV-AREA-TOT-RETAIL      TO DL1-AREA-TOT-RETAIL.         08580003
085900     MOVE PV-AREA-DC-PERCENT      TO DL1-AREA-DC-PERCENT.         08590003
086000                                                                  08600002
086100*CHECK FOR OVERFLOW.                                              08610002
086200     ADD 1 TO PV-LINE-COUNT.                                      08620002
086300     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         08630002
086400         SET PS-NEW-PAGE TO TRUE                                  08640002
086500         PERFORM 8000-WRITE-MAIN-HEADINGS                         08650002
086600         PERFORM 8100-WRITE-SUB-HEADINGS                          08660002
086700     END-IF.                                                      08670002
086800                                                                  08680002
086900*IF NEW PAGE, DISPLAY WEEK-END DATE.                              08690002
087000     IF PS-NEW-PAGE                                               08700002
087100         SET PS-SAME-PAGE             TO TRUE                     08710002
087200     END-IF.                                                      08720002
087300                                                                  08730002
087400*WRITE DETAIL LINE.                                               08740002
087500         IF CC-ROUTE-TO-RDS                                       08750002
087600             WRITE REPORT-RECORD-1                                08760002
087700               FROM DL-DETAIL-LINE-1                              08770002
087800                 AFTER ADVANCING 1 LINES                          08780002
087900                                                                  08790002
088000             WRITE REPORT-RECORD-1                                08800002
088100               FROM DL-BLANK-LINE                                 08810002
088200                 AFTER ADVANCING 1 LINE                           08820002
088300             ADD 2                   TO PV-LINE-COUNT             08830002
088400         ELSE                                                     08840002
088500             WRITE REPORT-RECORD-2                                08850002
088600               FROM DL-DETAIL-LINE-1                              08860002
088700                 AFTER ADVANCING 1 LINES                          08870002
088800                                                                  08880002
088900             WRITE REPORT-RECORD-2                                08890002
089000               FROM DL-BLANK-LINE                                 08900002
089100                 AFTER ADVANCING 1 LINE                           08910002
089200             ADD 2                   TO PV-LINE-COUNT.            08920002
089300*                                                                 08930002
089400******************************************************************08940002
089500 3100-COMPANY-TOTALS.                                             08950002
089600******************************************************************08960002
089700*                                                                 08970002
089800     MOVE PV-OPER-3RD-UNITS       TO TL2-3RD-UNITS.               08980003
089900     MOVE PV-OPER-3RD-PERCENT     TO TL2-3RD-PERCENT.             08990003
090000     MOVE PV-OPER-3RD-RETAIL      TO TL2-3RD-RETAIL.              09000003
090100                                                                  09010002
090200     MOVE PV-OPER-1ST-UNITS       TO TL2-1ST-UNITS.               09020003
090300     MOVE PV-OPER-1ST-PERCENT     TO TL2-1ST-PERCENT.             09030003
090400     MOVE PV-OPER-1ST-RETAIL      TO TL2-1ST-RETAIL.              09040003
090500                                                                  09050002
090600     MOVE PV-OPER-2ND-UNITS       TO TL2-2ND-UNITS.               09060003
090700     MOVE PV-OPER-2ND-PERCENT     TO TL2-2ND-PERCENT.             09070003
090800     MOVE PV-OPER-2ND-RETAIL      TO TL2-2ND-RETAIL.              09080003
090900                                                                  09090002
091000     MOVE PV-OPER-TOT-UNITS       TO TL2-OPER-TOT-UNITS.          09100003
091100     MOVE PV-OPER-TOT-RETAIL      TO TL2-OPER-TOT-RETAIL.         09110003
091200                                                                  09120002
091300     IF CC-ROUTE-TO-RDS                                           09130002
091400         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 09140002
091500             AFTER ADVANCING 1 LINE                               09150002
091600         ADD 1                   TO PV-LINE-COUNT                 09160002
091700                                                                  09170002
091800         WRITE REPORT-RECORD-1 FROM TL1-COMP-LINE                 09180002
091900             AFTER ADVANCING 1 LINE                               09190002
092000         WRITE REPORT-RECORD-1 FROM TL2-COMP-LINE                 09200002
092100             AFTER ADVANCING 1 LINE                               09210002
092200         ADD 2                    TO PV-LINE-COUNT                09220002
092300                                                                  09230002
092400         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 09240002
092500         AFTER ADVANCING 1 LINE                                   09250002
092600         ADD 1                     TO PV-LINE-COUNT               09260002
092700     ELSE                                                         09270002
092800         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 09280002
092900             AFTER ADVANCING 1 LINE                               09290002
093000         ADD 1                   TO PV-LINE-COUNT                 09300002
093100                                                                  09310002
093200         WRITE REPORT-RECORD-2 FROM TL1-COMP-LINE                 09320002
093300             AFTER ADVANCING 1 LINE                               09330002
093400         WRITE REPORT-RECORD-2 FROM TL2-COMP-LINE                 09340002
093500             AFTER ADVANCING 1 LINE                               09350002
093600         ADD 1                    TO PV-LINE-COUNT                09360002
093700                                                                  09370002
093800         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 09380002
093900         AFTER ADVANCING 1 LINE                                   09390002
094000         ADD 1                     TO PV-LINE-COUNT.              09400002
094100*                                                                 09410002
094200******************************************************************09420017
094300*  PRINT THE ERROR REPORT WHEN THE EXTRACT FILE HAS AN ERROR REC *09430017
094400******************************************************************09440017
094500 7000-WRITE-ERROR-REPORT.                                         09450017
094600*                                                                 09460017
094700     IF CC-ROUTE-TO-RDS                                           09470017
094800         WRITE REPORT-RECORD-1                                    09480017
094900           FROM EL1-ERROR-LINE-1P                                 09490017
095000             AFTER ADVANCING 3 LINES                              09500017
095100*                                                                 09510017
095200         WRITE REPORT-RECORD-1                                    09520017
095300           FROM EL2-ERROR-LINE-2F                                 09530017
095400             AFTER ADVANCING 2 LINES                              09540017
095500*                                                                 09550017
095600         WRITE REPORT-RECORD-1                                    09560017
095700           FROM EL3-ERROR-LINE-3                                  09570017
095800             AFTER ADVANCING 2 LINES                              09580017
095900*                                                                 09590017
096000         MOVE CC-USER-ID         TO EL4-REQUESTOR-ID              09600017
096100         MOVE CC-TO-PRINTER-ID   TO EL4-PRINTER-ID                09610017
096200                                                                  09620017
096300         WRITE REPORT-RECORD-1                                    09630017
096400           FROM EL4-ERROR-LINE-4                                  09640017
096500             AFTER ADVANCING 3 LINES                              09650017
096600                                                                  09660017
096700         MOVE CC-START-RPT-DATE-RANGE  TO EL5-START-DATE-RANGE    09670017
096800         MOVE CC-END-RPT-DATE-RANGE    TO EL5-END-DATE-RANGE      09680017
096900                                                                  09690017
097000         WRITE REPORT-RECORD-1                                    09700017
097100           FROM EL5-ERROR-LINE-5B                                 09710017
097200             AFTER ADVANCING 2 LINES                              09720017
097300*                                                                 09730017
097400         WRITE REPORT-RECORD-1                                    09740017
097500           FROM ER-END-OF-REPORT-LINE                             09750017
097600             AFTER ADVANCING 6 LINES                              09760017
097700     ELSE                                                         09770017
097800         WRITE REPORT-RECORD-2                                    09780017
097900           FROM EL1-ERROR-LINE-1P                                 09790017
098000             AFTER ADVANCING 3 LINES                              09800017
098100*                                                                 09810017
098200         WRITE REPORT-RECORD-2                                    09820017
098300           FROM EL2-ERROR-LINE-2F                                 09830017
098400             AFTER ADVANCING 2 LINES                              09840017
098500*                                                                 09850017
098600         WRITE REPORT-RECORD-2                                    09860017
098700           FROM EL3-ERROR-LINE-3                                  09870017
098800             AFTER ADVANCING 2 LINES                              09880017
098900*                                                                 09890017
099000         MOVE CC-USER-ID         TO EL4-REQUESTOR-ID              09900017
099100         MOVE CC-TO-PRINTER-ID   TO EL4-PRINTER-ID                09910017
099200                                                                  09920017
099300         WRITE REPORT-RECORD-2                                    09930017
099400           FROM EL4-ERROR-LINE-4                                  09940017
099500             AFTER ADVANCING 3 LINES                              09950017
099600*                                                                 09960017
099700         MOVE CC-START-RPT-DATE-RANGE  TO EL5-START-DATE-RANGE    09970017
099800         MOVE CC-END-RPT-DATE-RANGE    TO EL5-END-DATE-RANGE      09980017
099900                                                                  09990017
100000         WRITE REPORT-RECORD-2                                    10000017
100100           FROM EL5-ERROR-LINE-5B                                 10010017
100200             AFTER ADVANCING 2 LINE                               10020017
100300*                                                                 10030017
100400         WRITE REPORT-RECORD-2                                    10040017
100500           FROM ER-END-OF-REPORT-LINE                             10050017
100600             AFTER ADVANCING 6 LINES.                             10060017
100700*                                                                 10070017
100800******************************************************************10080002
100900 8000-WRITE-MAIN-HEADINGS.                                        10090002
101000******************************************************************10100002
101100*                                                                 10110002
101200     MOVE CC-START-RPT-DATE-RANGE     TO HL1B-FROM-DATE.          10120002
101300     MOVE CC-END-RPT-DATE-RANGE       TO HL1B-TO-DATE.            10130002
101400                                                                  10140002
101500     IF CC-OPER-ALL                                               10150015
101600        CONTINUE                                                  10160015
101700     ELSE                                                         10170015
101800        MOVE PV-STORE-NAME            TO HL2-LOC-DESC.            10180015
101900                                                                  10190002
102000     ADD 1                            TO PV-PAGE-COUNT.           10200002
102100     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      10210002
102200     MOVE ZERO                        TO PV-LINE-COUNT.           10220002
102300                                                                  10230002
102400     IF CC-ROUTE-TO-RDS                                           10240002
102500         WRITE REPORT-RECORD-1 FROM                               10250002
102600             DP132O-STANDRD-HEADER-132-COLS                       10260002
102700             AFTER ADVANCING PAGE                                 10270002
102800                                                                  10280002
102900          IF CC-RPT-BY-PRCS-AREA                                  10290005
103000              WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1        10300005
103100                 AFTER ADVANCING 2 LINES                          10310005
103200          ELSE                                                    10320005
103300              WRITE REPORT-RECORD-1  FROM HL-HEADING-LINE-1A      10330006
103400                 AFTER ADVANCING 2 LINES                          10340005
103500          END-IF                                                  10350006
103600                                                                  10360005
103700         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1B            10370002
103800            AFTER ADVANCING 2 LINES                               10380002
103900                                                                  10390002
104000         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2             10400002
104100            AFTER ADVANCING 2 LINES                               10410002
104200         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 10420002
104300             AFTER ADVANCING 3 LINES                              10430002
104400         ADD 7                            TO PV-LINE-COUNT        10440002
104500     ELSE                                                         10450002
104600         WRITE REPORT-RECORD-2 FROM                               10460002
104700             DP132O-STANDRD-HEADER-132-COLS                       10470002
104800             AFTER ADVANCING PAGE                                 10480002
104900                                                                  10490002
105000          IF CC-RPT-BY-PRCS-AREA                                  10500009
105100              WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-1        10510009
105200                 AFTER ADVANCING 2 LINES                          10520009
105300          ELSE                                                    10530009
105400              WRITE REPORT-RECORD-2  FROM HL-HEADING-LINE-1A      10540009
105500                 AFTER ADVANCING 2 LINES                          10550009
105600          END-IF                                                  10560009
105700                                                                  10570009
105800         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-1B            10580002
105900            AFTER ADVANCING 2 LINES                               10590002
106000                                                                  10600002
106100         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-2             10610002
106200            AFTER ADVANCING 2 LINES                               10620002
106300         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 10630002
106400             AFTER ADVANCING 3 LINES                              10640002
106500         ADD 7                            TO PV-LINE-COUNT        10650006
106600     END-IF.                                                      10660006
106700*                                                                 10670002
106800******************************************************************10680002
106900 8100-WRITE-SUB-HEADINGS.                                         10690002
107000******************************************************************10700002
107100*                                                                 10710002
107200     IF CC-RPT-BY-PRCS-AREA                                       10720005
107300         MOVE ' AREA'               TO HL5-PROC-DESC              10730021
107400                                       HL6-PROC-DESC-3RD          10740021
107500                                       HL6-PROC-DESC-1ST          10750021
107600                                       HL6-PROC-DESC-2ND          10760021
107700     ELSE                                                         10770005
107800         MOVE 'GROUP'               TO HL5-PROC-DESC              10780021
107900                                       HL6-PROC-DESC-3RD          10790021
108000                                       HL6-PROC-DESC-1ST          10800021
108100                                       HL6-PROC-DESC-2ND          10810021
108200     END-IF.                                                      10820008
108300                                                                  10830005
108400     IF CC-ROUTE-TO-RDS                                           10840002
108500         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3             10850002
108600            AFTER ADVANCING 1 LINES                               10860002
108700                                                                  10870002
108800         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4             10880002
108900            AFTER ADVANCING 1 LINES                               10890002
109000                                                                  10900002
109100         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-5             10910002
109200            AFTER ADVANCING 1 LINES                               10920002
109300                                                                  10930002
109400         WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-6             10940002
109500            AFTER ADVANCING 1 LINES                               10950002
109600                                                                  10960002
109700         WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                 10970002
109800             AFTER ADVANCING 1 LINE                               10980002
109900         ADD 3                            TO PV-LINE-COUNT        10990002
110000                                                                  11000008
110100     ELSE                                                         11010002
110200         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-3             11020002
110300            AFTER ADVANCING 1 LINES                               11030002
110400                                                                  11040002
110500         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-4             11050002
110600            AFTER ADVANCING 1 LINES                               11060002
110700                                                                  11070002
110800         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-5             11080002
110900            AFTER ADVANCING 1 LINES                               11090002
111000                                                                  11100002
111100         WRITE REPORT-RECORD-2 FROM HL-HEADING-LINE-6             11110002
111200            AFTER ADVANCING 1 LINES                               11120002
111300                                                                  11130002
111400         WRITE REPORT-RECORD-2 FROM DL-BLANK-LINE                 11140002
111500             AFTER ADVANCING 1 LINE                               11150002
111600         ADD 3                            TO PV-LINE-COUNT.       11160002
111700*                                                                 11170002
111800******************************************************************11180002
111900 9000-EOJ.                                                        11190002
112000******************************************************************11200002
112100*                                                                 11210002
112200     IF CC-ROUTE-TO-RDS                                           11220002
112300         WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE         11230002
112400            AFTER ADVANCING 2 LINES                               11240002
112500     ELSE                                                         11250002
112600         WRITE REPORT-RECORD-2 FROM ER-END-OF-REPORT-LINE         11260002
112700            AFTER ADVANCING 2 LINES.                              11270002
112800                                                                  11280002
112900*CLOSE FILES.                                                     11290002
113000     CLOSE EXTRACT-FILE                                           11300002
113100                                                                  11310002
113200     IF CC-ROUTE-TO-RDS                                           11320002
113300        CLOSE REPORT-FILE-1                                       11330002
113400     ELSE                                                         11340002
113500        CLOSE REPORT-FILE-2                                       11350002
113600     END-IF.                                                      11360002
113700/                                                                 11370002
113800******************************************************************11380002
113900 9200-SQL-ABEND.                                                  11390002
114000******************************************************************11400002
114100                                                                  11410002
114200     MOVE SQLCODE                     TO SQLCODE2.                11420002
114300     MOVE SQLERRD(3)                  TO SQLERRD3.                11430002
114400                                                                  11440002
114500     DISPLAY '** ABEND **         ** = SQLERROR'.                 11450002
114600     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        11460002
114700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   11470002
114800     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                11480002
114900     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     11490002
115000     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     11500002
115100     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     11510002
115200                                                                  11520002
115300     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                11530002
115400     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                11540002
115500     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 11550002
115600     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                11560002
115700                                                                  11570002
115800                                                                  11580002
115900     MOVE +4013                       TO PV-ABEND-CODE.           11590002
116000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11600002
116100                                                                  11610002
116200******************************************************************11620002
116300 9300-SQL-WARNING.                                                11630002
116400******************************************************************11640002
116500                                                                  11650002
116600     DISPLAY '9300-SQL-WARNING'.                                  11660002
116700     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        11670002
116800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   11680002
116900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                11690002
117000                                                                  11700002
117100     MOVE SQLCODE                     TO SQLCODE2.                11710002
117200     MOVE SQLERRD(3)                  TO SQLERRD3.                11720002
117300     DISPLAY '** ABEND **       ** = SQLWARNING'.                 11730002
117400     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  11740002
117500     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  11750002
117600     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  11760002
117700     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  11770002
117800     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  11780002
117900     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  11790002
118000     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  11800002
118100     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  11810002
118200     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  11820002
118300     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  11830002
118400                                                                  11840002
118500     MOVE +4013                       TO PV-ABEND-CODE.           11850002
118600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11860002
118700*                                                                 11870002
118800******************************************************************11880002
118900*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       11890002
119000******************************************************************11900002
119100 9400-ABEND.                                                      11910002
119200*                                                                 11920002
119300     DISPLAY '***************************'.                       11930002
119400     DISPLAY '**       ABEND           **'.                       11940002
119500     DISPLAY '**  IN PROGRAM RCKRP035  **'.                       11950002
119600     DISPLAY '***************************'.                       11960002
119700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH.             11970002
119800     DISPLAY '**   ERROR         ** = ' DP003-RETURN-MSG.         11980002
119900     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       11990002
120000     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       12000002
120100                                                                  12010002
120200     MOVE +4014                  TO PV-ABEND-CODE.                12020002
120300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12030002
120400*                                                                 12040002
120500******************************************************************12050002
