000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.      EPKUT024.                                       00030000
000400 AUTHOR.          STEVEN NOWAK.                                   00040000
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050000
000600 DATE-WRITTEN.    07/15/09.                                       00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000*  MODULE TYPE:   COBOL2 BATCH.                                   00100000
001100*                                                                 00110000
001200* THIS PROGRAM PREPARES THE SKU_LOC UPDATE FILE TO BE PROCESSED   00120000
001300* BY EPKUP104 UNDER THE DB2 CHECKPOINT RESTART SYSTEM.            00130000
001400*                                                                 00140000
001500* THE PROGRAM READS THE SKU_LOC UPDATE FILE, REFORMATS THE        00150000
001600* RECORDS AND SETS A CHECKPOINT INDICATOR ON THE RECORD BASED     00160000
001700* ON HOW CHECKPOINTS WILL BE TAKEN BY THE MAINTENANCE PROGRAM.    00170000
001800* AFTER A RECORD HAS BEEN REFORMATTED IT IS PASSED TO THE         00180000
001900* TRANSACTION PREPARATION MODULE (DPKUT900) WHICH DOES SOME MORE  00190000
002000* PROCESSING ON THE RECORDS AND WRITES THE REFORMATTED RECORDS    00200000
002100* OUT TO A SEQUENTIAL FILE.                                       00210000
002200*                                                                 00220000
002300* THE PROGRAM COMMUNICATES WITH THE TRANSACTION PREPARATION       00230000
002400* MODULE USING FUNCTION CODES (OPEN, WRITE, & CLOSE) AND CHECKS   00240000
002500* THE RETURN CODE AFTER EACH REQUEST.  IF AN INVALID RETURN CODE  00250000
002600* IS RECEIVED, ANY INFORMATION THAT MAY BE HELPFUL IN RESOLVING   00260000
002700* THE BAD RETURN CODE IS DISPLAYED ON SYSOUT AND THE PROGRAM      00270000
002800* ABENDS.                                                         00280000
002900*                                                                 00290000
003000*========================== CHANGE LOG ===========================00300000
003100*  AUTH        BY           DATE    DESCRIPTION                   00310001
003200*=================================================================00320000
003300* WR36870     S. NOWAK    07-15-09  CREATE PROGRAM                00330001
003400*                                                                 00340000
003500* IR892750    S. NOWAK    07-30-09  DO NOT ABEND FOR EMPTY FILE   00350001
003600*                                                                 00360000
260107* CHG0260107  JIM HUNTER  08-19-21  ADD COPYBOOK DPWS990 TO MAKE  00361002
260107*                                   THE CALL TO DPKUT900 DYNAMIC. 00362002
003700******************************************************************00370000
003800                                                                  00380000
003900 ENVIRONMENT DIVISION.                                            00390000
004000 CONFIGURATION SECTION.                                           00400000
004100                                                                  00410000
004200 SOURCE-COMPUTER.    IBM-3090.                                    00420000
004300 OBJECT-COMPUTER.    IBM-3090.                                    00430000
004400                                                                  00440000
004500 INPUT-OUTPUT SECTION.                                            00450000
004600 FILE-CONTROL.                                                    00460000
004700                                                                  00470000
004800     SELECT UPDATE-FILE   ASSIGN TO INP01.                        00480000
004900                                                                  00490000
005000 DATA DIVISION.                                                   00500000
005100 FILE SECTION.                                                    00510000
005200                                                                  00520000
005300 FD  UPDATE-FILE                                                  00530000
005400     RECORDING MODE IS F                                          00540000
005500     BLOCK CONTAINS 0 RECORDS                                     00550000
005600     LABEL RECORDS ARE OMITTED.                                   00560000
005700                                                                  00570000
005800 01  UPDATE-REC                       PIC  X(33).                 00580000
005900                                                                  00590000
006000***************************************************************** 00600000
006100*                       WORKING STORAGE                           00610000
006200***************************************************************** 00620000
006300 WORKING-STORAGE SECTION.                                         00630000
006400                                                                  00640000
006500 01  W-START                          PIC  X(40)                  00650000
006600     VALUE 'EPKUT024 - WORKING STORAGE BEGINS HERE'.              00660000
006700                                                                  00670000
006800                                                                  00680000
006900***************************************************************** 00690000
007000*                         SWITCHES                                00700000
007100***************************************************************** 00710000
007200 01  PROGRAM-SWITCHES.                                            00720000
007300     05  PS-INPUT-UPDATE-EOF-SW       PIC  X(01) VALUE 'N'.       00730000
007400         88  PS-INPUT-UPDATE-EOF                 VALUE 'Y'.       00740000
007500     05  PS-FIRST-TRANS-READ-SW       PIC  X(01) VALUE 'Y'.       00750000
007600         88  FIRST-TRANS-READ                    VALUE 'Y'.       00760000
007700                                                                  00770000
007800******************************************************************00780000
007900*                       ACCUMULATORS                              00790000
008000******************************************************************00800000
008100 01  PROGRAM-ACCUMULATORS.                                        00810000
008200     05  PA-READ                      PIC  9(11) VALUE ZEROS.     00820000
008300     05  PA-WRITTEN                   PIC  9(11) VALUE ZEROS.     00830000
008400                                                                  00840000
008500******************************************************************00850000
008600*                           CONSTANTS                             00860000
008700******************************************************************00870000
008800 01  PROGRAM-CONSTANTS.                                           00880000
008900     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'EPKUT022'.00890000
009000                                                                  00900000
009100     05  PC-TRAN-PREP-FUNC-CODES.                                 00910000
009200         10  PC-TRAN-PREP-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00920000
009300         10  PC-TRAN-PREP-FUNC-WRITE  PIC  X(05) VALUE 'WRITE'.   00930000
009400         10  PC-TRAN-PREP-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00940000
009500                                                                  00950000
009600     05  PC-JOB-NAME                  PIC  X(08) VALUE 'EPK332  '.00960000
009700     05  PC-PLAN-NAME                 PIC  X(08) VALUE 'EPKUP104'.00970000
009800     05  PC-TRANS-RECORD-LENGTH       PIC S9(04) VALUE +33 COMP.  00980000
009900                                                                  00990000
010000******************************************************************01000000
010100*                          VARIABLES                              01010000
010200******************************************************************01020000
010300 01  PROGRAM-VARIABLES.                                           01030000
010400     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACES.    01040000
010500     05  PV-OPERATION-MSG             PIC  X(60) VALUE SPACES.    01050000
010600     05  PV-RET-CODE                  PIC  9(04) VALUE ZEROS.     01060000
010700                                                                  01070000
010800     05  PV-CHECKPOINT-TYPE           PIC  X(01) VALUE SPACE.     01080000
010900         88  CONTROL-BREAK                       VALUE 'C'.       01090000
011000         88  LOGICAL-TRANSACTION                 VALUE 'L'.       01100000
011100         88  TIME-INTERVAL                       VALUE 'T'.       01110000
011200         88  REQUESTED-BY-PROGRAM                VALUE 'R'.       01120000
011300                                                                  01130000
011400     05  PV-INTR-UPC-ID               PIC S9(09) COMP.            01140000
011500     05  PV-LOC-NBR                   PIC S9(04) COMP.            01150000
011600                                                                  01160000
011700     05  PV-INTEGER                   PIC S9(11) VALUE +0.        01170000
011800     05  PV-DECIMAL                   PIC S9(11) VALUE +0.        01180000
011900                                                                  01190000
012000******************************************************************01200000
012100*               SYSTEM TIME AND DATE VARIABLES                    01210000
012200******************************************************************01220000
012300 01  SYS-DATE-TIME.                                               01230000
012400     05  SYS-DATE                     PIC  X(08) VALUE SPACES.    01240000
012500     05  SYS-TIME                     PIC  X(08) VALUE SPACES.    01250000
012600                                                                  01260000
012700 01  ST-BEG-TIME.                                                 01270000
012800     05  ST-BEG-HR                    PIC  9(02) VALUE ZEROS.     01280000
012900     05  FILLER                       PIC  X(01) VALUE ':'.       01290000
013000     05  ST-BEG-MN                    PIC  9(02) VALUE ZEROS.     01300000
013100                                                                  01310000
013200 01  ST-END-TIME.                                                 01320000
013300     05  ST-END-HR                    PIC  9(02) VALUE ZEROS.     01330000
013400     05  FILLER                       PIC  X(01) VALUE ':'.       01340000
013500     05  ST-END-MN                    PIC  9(02) VALUE ZEROS.     01350000
013600                                                                  01360000
013700 01  SD-EDIT-DATE.                                                01370000
013800     05  SD-MONTH                     PIC  9(02) VALUE ZEROS.     01380000
013900     05  FILLER                       PIC  X(01) VALUE '-'.       01390000
014000     05  SD-DAY                       PIC  9(02) VALUE ZEROS.     01400000
014100     05  FILLER                       PIC  X(01) VALUE '-'.       01410000
014200     05  SD-CENT                      PIC  9(02) VALUE ZEROS.     01420000
014300     05  SD-YEAR                      PIC  9(02) VALUE ZEROS.     01430000
014400                                                                  01440000
014500******************************************************************01450000
014600*                        ERROR HANDLING                           01460000
014700******************************************************************01470000
014800 01  ABEND-CODE                       PIC S9(04) VALUE ZEROS      01480000
014900                                                 COMP SYNC.       01490000
015000     88  ABEND-4002-READ-ERROR             VALUE +4002.           01500000
015100     88  ABEND-4444-FORCED-ABEND           VALUE +4444.           01510000
015200                                                                  01520000
015300                                                                  01530000
015400******************************************************************01540000
015500* XST_SKU_LOC_ATTR REC LAYOUT                                     01550000
015600******************************************************************01560000
015700     COPY EPRD003.                                                01570000
015800                                                                  01580000
015900******************************************************************01590000
016000*  TRANSACTION PREPARATION MODULE LINKAGE SECTION                 01600000
016100******************************************************************01610000
260107     COPY DPWS990.                                                01620001
016300                                                                  01630000
016200     COPY DPLS000.                                                01631001
016300                                                                  01632001
016400******************************************************************01643001
016500*  SQL COMMUNICATIONS WORK AREA                                   01650000
016600******************************************************************01660000
016700     COPY SQLCA2.                                                 01670000
016800                                                                  01680000
016900                                                                  01690000
017000                                                                  01700000
017100                                                                  01710000
017200 PROCEDURE DIVISION.                                              01720000
017300******************************************************************01730000
017400* MAINLINE-PROCESSING                                             01740000
017500******************************************************************01750000
017600                                                                  01760000
017700     PERFORM A100-INITIALIZE.                                     01770000
017800                                                                  01780000
017900     PERFORM B100-PROCESS-UPDATE-INPUT-FILE                       01790000
018000       UNTIL PS-INPUT-UPDATE-EOF.                                 01800000
018100                                                                  01810000
018200     PERFORM Z990-END-OF-JOB-ROUTINE.                             01820000
018300                                                                  01830000
018400     GOBACK.                                                      01840000
018500                                                                  01850000
018600                                                                  01860000
018700******************************************************************01870000
018800* PREFORMS TASK INITIATION                                        01880000
018900******************************************************************01890000
019000 A100-INITIALIZE.                                                 01900000
019100                                                                  01910000
019200     OPEN INPUT UPDATE-FILE.                                      01920000
019300                                                                  01930000
019400     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 01940000
019500                                                                  01950000
019600     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            01960000
019700     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            01970000
019800                                                                  01980000
019900     MOVE SYS-DATE (1:2) TO SD-CENT.                              01990000
020000     MOVE SYS-DATE (3:2) TO SD-YEAR.                              02000000
020100     MOVE SYS-DATE (5:2) TO SD-MONTH.                             02010000
020200     MOVE SYS-DATE (7:2) TO SD-DAY.                               02020000
020300                                                                  02030000
020400     PERFORM C100-ISSUE-OPEN-REQUEST.                             02040000
020500                                                                  02050000
020600     PERFORM C200-READ-UPDATE-INPUT-FILE.                         02060000
020700                                                                  02070000
020800     IF PS-INPUT-UPDATE-EOF                                       02080000
020900         MOVE 'C200-READ-UPDATE-INPUT-FILE' TO PV-PARAGRAPH-NAME  02090000
021000         MOVE '** EMPTY UPDATE FILE - NO DATA **'                 02100000
021100                                            TO PV-OPERATION-MSG   02110000
021200     END-IF.                                                      02120000
021300                                                                  02130000
021400                                                                  02140000
021500******************************************************************02150000
021600* PROCESS THE UPDATE FILE. IF A RECORD IS READ, GATHER WHATEVER   02160000
021700* OTHER DATA IS NECESSARY TO TAKE CHECKPOINTS BASED ON THE TYPE OF02170000
021800* CHECKPOINTS BEING TAKEN BY EPKUP104 AND ISSUE A WRITE REQUEST   02180000
021900* TO THE TRANSACTION PREPARATION PROGRAM.                         02190000
022000******************************************************************02200000
022100 B100-PROCESS-UPDATE-INPUT-FILE.                                  02210000
022200                                                                  02220000
022300     IF FIRST-TRANS-READ                                          02230000
022400         MOVE EP003-INTR-UPC-ID TO PV-INTR-UPC-ID                 02240000
022500         MOVE EP003-LOC-NBR     TO PV-LOC-NBR                     02250000
022600         MOVE 'N'               TO PS-FIRST-TRANS-READ-SW         02260000
022700     END-IF.                                                      02270000
022800                                                                  02280000
022900     IF CONTROL-BREAK                                             02290000
023000         PERFORM C300-CKPT-BY-CNTL-BREAK                          02300000
023100     ELSE                                                         02310000
023200         IF LOGICAL-TRANSACTION                                   02320000
023300             PERFORM C400-CKPT-BY-LOGICAL-TRANS                   02330000
023400         ELSE                                                     02340000
023500             PERFORM C500-CKPT-BY-TIME-OR-REQUEST                 02350000
023600         END-IF                                                   02360000
023700     END-IF.                                                      02370000
023800                                                                  02380000
023900     PERFORM C200-READ-UPDATE-INPUT-FILE.                         02390000
024000                                                                  02400000
024100                                                                  02410000
024200******************************************************************02420000
024300* ISSUE AN 'OPEN' REQUEST TO THE TRANSACTION PREPARATION MODULE   02430000
024400******************************************************************02440000
024500 C100-ISSUE-OPEN-REQUEST.                                         02450000
024600                                                                  02460000
024700     MOVE PC-TRAN-PREP-FUNC-OPEN TO DP000-FUNC-CODE.              02470000
024800     MOVE PC-JOB-NAME            TO DP000-JOB-NAME.               02480000
024900     MOVE PC-PLAN-NAME           TO DP000-PLAN-NAME.              02490000
025000                                                                  02500000
025100     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         02510000
025200                                                                  02520000
025300     MOVE DP000-CKPT-TYPE-CODE   TO PV-CHECKPOINT-TYPE.           02530000
025400                                                                  02540000
025500                                                                  02550000
025600******************************************************************02560000
025700* READ THE UPDATE INPUT FILE                                      02570000
025800******************************************************************02580000
025900 C200-READ-UPDATE-INPUT-FILE.                                     02590000
026000                                                                  02600000
026100     READ UPDATE-FILE INTO EP003-XST-REC                          02610000
026200       AT END SET PS-INPUT-UPDATE-EOF TO TRUE.                    02620000
026300                                                                  02630000
026400     IF PS-INPUT-UPDATE-EOF                                       02640000
026500         CONTINUE                                                 02650000
026600     ELSE                                                         02660000
026700         ADD +1 TO PA-READ                                        02670000
026800     END-IF.                                                      02680000
026900                                                                  02690000
027000                                                                  02700000
027100******************************************************************02710000
027200* THIS ROUTINE SETS THE CHECKPOINT INDICATOR ON THE TRANSACATION  02720000
027300* RECORD "ON" IF THERE IS A CHANGE IN THE KEY. AFTER              02730000
027400* THE TRANSACTION RECORD HAS BEEN FORMATTED, A WRITE REQUEST IS   02740000
027500* ISSUED TO THE TRANSACTION PREPARATION MODULE.                   02750000
027600******************************************************************02760000
027700 C300-CKPT-BY-CNTL-BREAK.                                         02770000
027800                                                                  02780000
027900     IF  EP003-INTR-UPC-ID = PV-INTR-UPC-ID                       02790000
028000     AND EP003-LOC-NBR     = PV-LOC-NBR                           02800000
028100         MOVE 'N' TO DP000-CHECKPOINT-IND                         02810000
028200     ELSE                                                         02820000
028300         MOVE 'Y' TO DP000-CHECKPOINT-IND                         02830000
028400         MOVE EP003-INTR-UPC-ID TO PV-INTR-UPC-ID                 02840000
028500         MOVE EP003-LOC-NBR     TO PV-LOC-NBR                     02850000
028600     END-IF.                                                      02860000
028700                                                                  02870000
028800     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      02880000
028900     MOVE EP003-XST-REC           TO DP000-TRANS-REC.             02890000
029000     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             02900000
029100     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              02910000
029200     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             02920000
029300                                                                  02930000
029400     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         02940000
029500                                                                  02950000
029600     ADD +1 TO PA-WRITTEN.                                        02960000
029700                                                                  02970000
029800                                                                  02980000
029900******************************************************************02990000
030000* THIS ROUTINE SETS THE CHECKPOINT INDICATOR ON THE TRANSACTION   03000000
030100* RECORD "ON".  THE UPDATE PROGRAM WILL CHECK THE CHECKPOINT      03010000
030200* FREQUENCY TO KNOW WHETHER A CHECKPOINT SHOULD BE TAKEN. AFTER   03020000
030300* THE TRANSACTION RECORD HAS BEEN FORMATTED, A WRITE REQUEST IS   03030000
030400* ISSUED TO THE TRANSACTION PREPARATION MODULE.                   03040000
030500******************************************************************03050000
030600 C400-CKPT-BY-LOGICAL-TRANS.                                      03060000
030700                                                                  03070000
030800     DIVIDE PA-READ BY +100                                       03080000
030900        GIVING PV-INTEGER                                         03090000
031000        REMAINDER PV-DECIMAL.                                     03100000
031100                                                                  03110000
031200     IF  PV-DECIMAL = +0                                          03120000
031300         MOVE 'Y' TO DP000-CHECKPOINT-IND                         03130000
031400     ELSE                                                         03140000
031500         MOVE 'N' TO DP000-CHECKPOINT-IND                         03150000
031600     END-IF.                                                      03160000
031700                                                                  03170000
031800     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      03180000
031900     MOVE EP003-XST-REC           TO DP000-TRANS-REC.             03190000
032000     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             03200000
032100     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03210000
032200     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03220000
032300                                                                  03230000
032400     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03240000
032500                                                                  03250000
032600     ADD +1 TO PA-WRITTEN.                                        03260000
032700                                                                  03270000
032800                                                                  03280000
032900******************************************************************03290000
033000* THIS ROUTINE BUILDS THE TRANSACTION RECORD AND ISSUES A WRITE   03300000
033100* REQUEST TO THE TRANSACTION PREPARATION MODULE IF CHECKPOINTS ARE03310000
033200* TAKEN BY TIME INTERVAL (SECONDS) OR REQUESTED BY THE MAINTENANCE03320000
033300* PROGRAM.                                                        03330000
033400******************************************************************03340000
033500 C500-CKPT-BY-TIME-OR-REQUEST.                                    03350000
033600                                                                  03360000
033700     MOVE 'N'                     TO DP000-CHECKPOINT-IND.        03370000
033800                                                                  03380000
033900     MOVE PC-TRANS-RECORD-LENGTH  TO DP000-TRANS-REC-LENGTH.      03390000
034000     MOVE EP003-XST-REC           TO DP000-TRANS-REC.             03400000
034100     MOVE PC-TRAN-PREP-FUNC-WRITE TO DP000-FUNC-CODE.             03410000
034200     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03420000
034300     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03430000
034400                                                                  03440000
034500     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03450000
034600                                                                  03460000
034700     ADD +1 TO PA-WRITTEN.                                        03470000
034800                                                                  03480000
034900                                                                  03490000
035000******************************************************************03500000
035100* ISSUE A 'CLOSE' REQUEST TO THE TRANSACTION PREPARATION MODULE   03510000
035200******************************************************************03520000
035300 C600-ISSUE-CLOSE-REQUEST.                                        03530000
035400                                                                  03540000
035500     MOVE PC-TRAN-PREP-FUNC-CLOSE TO DP000-FUNC-CODE.             03550000
035600     MOVE PC-JOB-NAME             TO DP000-JOB-NAME.              03560000
035700     MOVE PC-PLAN-NAME            TO DP000-PLAN-NAME.             03570000
035800                                                                  03580000
035900     PERFORM Z100-CALL-TRANS-PREP-MODULE.                         03590000
036000                                                                  03600000
036100                                                                  03610000
036200******************************************************************03620000
036300* VERIFY THE RETURN CODE ON THE CALLED MODULE                     03630000
036400******************************************************************03640000
036500 Z100-CALL-TRANS-PREP-MODULE.                                     03650000
036600                                                                  03660000
036700     PERFORM Z900-CALL-TRANS-PREP-MODULE.                         03670000
036800                                                                  03680000
036900     IF  DP000-GOOD-RET-CODE                                      03690000
037000         CONTINUE                                                 03700000
037100                                                                  03710000
037200     ELSE                                                         03720000
037300         MOVE 'Z100-CALL-TRANS-PREP-MODULE' TO PV-PARAGRAPH-NAME  03730000
037400         MOVE '** BAD CALL TO TRANS PREP MODULE **'               03740000
037500                                            TO PV-OPERATION-MSG   03750000
037600         MOVE DP000-RET-CODE                TO PV-RET-CODE        03760000
037700                                                                  03770000
037800         SET ABEND-4444-FORCED-ABEND TO TRUE                      03780000
037900                                                                  03790000
038000         PERFORM Z200-ABEND                                       03800000
038100     END-IF.                                                      03810000
038200                                                                  03820000
038300                                                                  03830000
038400******************************************************************03840000
038500* NON-DB2 ABEND                                                   03850000
038600******************************************************************03860000
038700 Z200-ABEND.                                                      03870000
038800                                                                  03880000
038900     PERFORM Z999-CONTROLS.                                       03890000
039000                                                                  03900000
039100     DISPLAY '                     '.                             03910000
039200     DISPLAY '** ABEND           **'.                             03920000
039300     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03930000
039400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03940000
039500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         03950000
039600     DISPLAY '** RETURN CODE     ** = ' PV-RET-CODE.              03960000
039700                                                                  03970000
039800     CALL 'ILBOABN0' USING ABEND-CODE.                            03980000
039900                                                                  03990000
040000                                                                  04000000
040100******************************************************************04010000
040200* PREFORMS TASK TERMINATION PROCESSING                            04020000
040300******************************************************************04030000
040400 Z990-END-OF-JOB-ROUTINE.                                         04040000
040500                                                                  04050000
040600     CLOSE UPDATE-FILE.                                           04060000
040700                                                                  04070000
040800     PERFORM C600-ISSUE-CLOSE-REQUEST.                            04080000
040900                                                                  04090000
041000     PERFORM Z999-CONTROLS.                                       04100000
041100                                                                  04110000
041200                                                                  04120000
041300******************************************************************04130000
041400* DISPLAY CONTROLS FROM THE PROGRAM                               04140000
041500******************************************************************04150000
041600 Z999-CONTROLS.                                                   04160000
041700                                                                  04170000
041800     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04180000
041900                                                                  04190000
042000     MOVE SYS-TIME (1:2) TO ST-END-HR.                            04200000
042100     MOVE SYS-TIME (3:2) TO ST-END-MN.                            04210000
042200                                                                  04220000
042300     DISPLAY '                    '.                              04230000
042400     DISPLAY '**********************'.                            04240000
042500     DISPLAY '   EPKUT024 CONTROLS  '.                            04250000
042600     DISPLAY '**********************'.                            04260000
042700     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04270000
042800     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04280000
042900     DISPLAY 'END TIME  = ' ST-END-TIME.                          04290000
043000     DISPLAY '======================'.                            04300000
043100     DISPLAY 'RECORDS READ    = ' PA-READ.                        04310000
043200     DISPLAY '                  '.                                04320000
043300     DISPLAY 'RECORDS WRITTEN = ' PA-WRITTEN.                     04330000
043400     DISPLAY '                  '.                                04340000
043500                                                                  04350000
043600                                                                  04360000
043700******************************************************************04370000
043800* TRANSACTION PREPARATION MODULE CALL AND ERROR ROUTINES          04380000
043900******************************************************************04390000
044000     COPY DPPD000.                                                04400000
044100                                                                  04410000
044200                                                                  04420000
