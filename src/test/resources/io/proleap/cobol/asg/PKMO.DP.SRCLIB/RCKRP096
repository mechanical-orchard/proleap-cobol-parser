000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             RCKRP096.                                00020000
000300 AUTHOR.                 DENISE HAHN.                             00030000
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           MAY, 2022.                               00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800***************************************************************** 00080000
000900*                                                               * 00090000
001000*  THIS REPORT WILL SHOW ANY VERIFIED RECEIVERS THAT HAVE LINES * 00100000
001100*  THAT HAVE NOT BEEN VERIFIED                                  * 00110000
001200*  ERROR REPORT WILL BE GENERATED AND AND EMAIL ALERT           * 00120001
001300*  EMAIL ALERT WILL BE SENT TO INVENTORY CONTROL                * 00130001
001400*                                                               * 00140000
001500***************************************************************** 00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700 CONFIGURATION SECTION.                                           00170000
001800                                                                  00180000
001900 SOURCE-COMPUTER.        IBM-3090.                                00190000
002000 OBJECT-COMPUTER.        IBM-3090.                                00200000
002100                                                                  00210000
002200***************************************************************** 00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400                                                                  00240000
002500 FILE-CONTROL.                                                    00250000
002600                                                                  00260000
002700     SELECT INPUT-FILE                                            00270000
002800         ASSIGN TO INP01.                                         00280000
002900                                                                  00290000
003000     SELECT REPORT-FILE                                           00300000
003100         ASSIGN TO RPT01.                                         00310000
003200                                                                  00320000
003210     SELECT OUTPUT-FILE                                           00321002
003220         ASSIGN TO OUT01.                                         00322002
003230                                                                  00323002
003300***************************************************************** 00330000
003400 DATA DIVISION.                                                   00340000
003500***************************************************************** 00350000
003600 FILE SECTION.                                                    00360000
003700                                                                  00370000
003800 FD  INPUT-FILE                                                   00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     BLOCK CONTAINS 0 RECORDS.                                    00410000
004200 01  INPUT-RECORD                    PIC  X(125).                 00420002
004300                                                                  00430000
004400 FD  REPORT-FILE                                                  00440000
004500     RECORDING MODE IS F                                          00450000
004600     BLOCK CONTAINS 0  RECORDS.                                   00460000
004700 01  REPORT-RECORD                   PIC X(132).                  00470006
004800                                                                  00480000
004810 FD  OUTPUT-FILE                                                  00481002
004820     RECORDING MODE IS F                                          00482002
004830     BLOCK CONTAINS 0  RECORDS.                                   00483002
004840 01  OUTPUT-RECORD                   PIC X(80).                   00484002
004850                                                                  00485002
004900***************************************************************** 00490000
005000 WORKING-STORAGE SECTION.                                         00500000
005100                                                                  00510000
005200 01  PROGRAM-SWITCHES.                                            00520000
005300     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00530000
005400         88  PS-END-OF-INPUT                   VALUE 'Y'.         00540000
005500         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00550000
005520     05  PS-EOF-CSR-SW              PIC X(01)  VALUE 'N'.         00552021
005530         88  PS-EOF-CSR-YES                    VALUE 'Y'.         00553021
005540         88  PS-EOF-CSR-NO                     VALUE 'N'.         00554021
005600                                                                  00560000
005700 01  PC-PROGRAM-CONSTANTS.                                        00570000
005800     05  PC-RCKRP096                 PIC X(08) VALUE              00580000
005900                                               'RCKRP096'.        00590000
006000     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00600000
006100     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00610000
006200                                               COMP-3.            00620000
006300     05  PC-SLASH                    PIC X(01) VALUE '/'.         00630000
006400     05  PC-DASH                     PIC X(01) VALUE '-'.         00640000
006500                                                                  00650000
006600 01  SD-DATE-TIME.                                                00660000
006700     05  SD-SYSTEM-DATE.                                          00670000
006800         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        00680000
006900         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        00690000
007000         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        00700000
007100     05  SD-SYSTEM-TIME.                                          00710000
007200         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        00720000
007300         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        00730000
007400         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        00740000
007500         10  FILLER                  PIC 9(02) VALUE ZERO.        00750000
007600*                                                                 00760000
007700 01  ERROR-REC                       PIC X(80) VALUE SPACES.      00770003
007701*                                                                 00770103
007702 01  DK-DB2-KEYS.                                                 00770221
007703     05  DK-PO-NBR                   PIC  S9(9) COMP.             00770321
007704     05  DK-RCVR                     PIC  S9(9) COMP.             00770421
007705     05  DK-LINE                     PIC  S9(9) COMP.             00770521
007706                                                                  00770621
007710 01  PV-PROGRAM-VARIABLES.                                        00771003
007800     05  PV-PREV-OPER                PIC  9(05).                  00780000
007900     05  PV-PREV-PO                  PIC  9(09).                  00790000
008100     05  PV-SUB                      PIC S9(04) VALUE ZERO        00810000
008110                                                COMP SYNC.        00811000
008120                                                                  00812000
008130     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00813000
008140                                               COMP-3.            00814000
008150     05  PV-READ-COUNT                PIC S9(7) COMP-3            00815000
008160                                                VALUE ZERO.       00816000
008170     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00817000
008180                                                VALUE ZERO.       00818000
008190     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00819000
008200                                               COMP-3.            00820000
008300     05  PV-LINES-ON-PAGE            PIC  9(3) VALUE 60.          00830000
008400                                                                  00840000
008500     05  PV-RPT-DATE.                                             00850000
008600         10  PV-RPT-DATE-MM          PIC 9(02) VALUE ZERO.        00860000
008700         10  FILLER                  PIC X(01) VALUE '-'.         00870000
008800         10  PV-RPT-DATE-DD          PIC 9(02) VALUE ZERO.        00880000
008900         10  FILLER                  PIC X(01) VALUE '-'.         00890000
009000         10  PV-RPT-DATE-YY          PIC 9(02) VALUE ZERO.        00900000
009100                                                                  00910000
009200 01  PV-ABEND-FIELDS.                                             00920000
009300     05  PV-DB2-MESSAGE              PIC X(30) VALUE SPACES.      00930021
009310     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACES.      00931021
009400     05  PV-DB2-TABLE-NAME           PIC X(30) VALUE SPACES.      00940021
009500     05  PV-ABEND-CODE               PIC S9(4) VALUE +0.          00950021
009510     05  PV-SQLCODE                  PIC -999.                    00951024
009700     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'RCKRP096'.  00970000
009800     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      00980000
009900     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      00990000
010000     05  PV-ABEND-TABLE              PIC X(20) VALUE SPACES.      01000022
010100                                                                  01010000
010200     05  PV-DISPLAY-READ-COUNT       PIC ZZZ,ZZZ,ZZ9.             01020000
010300     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             01030000
010400     05  PV-DISP-SQL                 PIC  -999.                   01040000
010500     05  PV-DISP-OPER                PIC  9999.                   01050000
010600                                                                  01060000
010700******************************************************************01070000
010800* RECORD LAYOUT FOR THE INPUT FILE.                               01080000
010900******************************************************************01090000
011000     COPY RCRD124.                                                01100002
011100                                                                  01110000
011110******************************************************************01111002
011120* RECORD LAYOUT FOR THE OUTPUT FILE USED FOR EMAIL.               01112002
011130******************************************************************01113002
011140     COPY RCRD125.                                                01114002
011150                                                                  01115002
011200******************************************************************01120000
011300*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01130006
011400******************************************************************01140000
011500     COPY DPWS132O.                                               01150006
011600                                                                  01160000
011700 01  WS-BATCH-PROC-DATE.                                          01170000
011800     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      01180000
011900     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      01190000
012000     05  FILLER                      PIC X(01) VALUE SPACES.      01200000
012100     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      01210000
012200     05  FILLER                      PIC X(01) VALUE SPACES.      01220000
012300     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      01230000
012400*                                                                 01240000
012500 01  HEADING-LINES.                                               01250000
012600     05  HEADING-LINE1.                                           01260000
012700         10  FILLER                  PIC X(41) VALUE SPACES.      01270006
012800         10  FILLER                  PIC X(51) VALUE              01280002
012900         'VERIFIED RECEIVERS WITH LINES THAT ARE NOT VERIFIED'.   01290002
013200         10  FILLER                  PIC X(40) VALUE SPACES.      01320006
013300                                                                  01330000
013400     05  HEADING-LINE2.                                           01340000
013500         10  FILLER                  PIC X(53) VALUE SPACES.      01350006
013600         10  FILLER                  PIC X(16)  VALUE             01360000
013700         'PROCESS DATE OF '.                                      01370000
013800         10  HD2-PROCESS-DATE        PIC X(10)  VALUE SPACES.     01380000
013900         10  FILLER                  PIC X(53) VALUE SPACES.      01390006
014000                                                                  01400000
014700     05  HEADING-LINE3.                                           01470002
014900         10  FILLER                  PIC  X(04) VALUE '    '.     01490002
015000         10  FILLER                  PIC  X(02) VALUE SPACE.      01500007
015100         10  FILLER                  PIC  X(09) VALUE '    PO   '.01510002
015200         10  FILLER                  PIC  X(03) VALUE SPACES.     01520002
015300         10  FILLER                  PIC  X(04) VALUE 'RCVR'.     01530002
015301         10  FILLER                  PIC  X(03) VALUE SPACES.     01530102
015302         10  FILLER                  PIC  X(02) VALUE '  '.       01530202
015304         10  FILLER                  PIC  X(26) VALUE             01530402
015305                                     '         VERIFIED         '.01530502
015306         10  FILLER                  PIC  X(01) VALUE SPACES.     01530608
015307         10  FILLER                  PIC  X(03) VALUE 'RCV'.      01530709
015308         10  FILLER                  PIC  X(01) VALUE SPACES.     01530809
015309         10  FILLER                  PIC  X(03) VALUE 'PKG'.      01530908
015310         10  FILLER                  PIC  X(01) VALUE SPACES.     01531010
015311         10  FILLER                  PIC  X(03) VALUE 'PBS'.      01531102
015312         10  FILLER                  PIC  X(02) VALUE SPACES.     01531211
015313         10  FILLER                  PIC  X(04) VALUE 'LINE'.     01531311
015314         10  FILLER                  PIC  X(01) VALUE SPACES.     01531412
015315         10  FILLER                  PIC  X(04) VALUE 'LINE'.     01531502
015316         10  FILLER                  PIC  X(02) VALUE SPACES.     01531613
015317         10  FILLER                  PIC  X(05) VALUE 'PREPK'.    01531702
015318         10  FILLER                  PIC  X(02) VALUE SPACES.     01531813
015319         10  FILLER                  PIC  X(04) VALUE 'DRVR'.     01531902
015320         10  FILLER                  PIC  X(02) VALUE SPACES.     01532015
015322         10  FILLER                  PIC  X(04) VALUE 'LINE'.     01532202
015323         10  FILLER                  PIC  X(03) VALUE SPACES.     01532302
015324         10  FILLER                  PIC  X(26) VALUE             01532402
015325                                     '      LINE CREATE         '.01532516
015327         10  FILLER                  PIC  X(02) VALUE 'PO'.       01532715
015328         10  FILLER                  PIC  X(02) VALUE SPACES.     01532816
015329         10  FILLER                  PIC  X(04) VALUE 'DEPT'.     01532902
015330         10  FILLER                  PIC  X(03) VALUE SPACES.     01533002
015331                                                                  01533100
015332     05  HEADING-LINE4.                                           01533202
015334         10  FILLER                  PIC  X(04) VALUE 'OPER'.     01533402
015335         10  FILLER                  PIC  X(02) VALUE SPACE.      01533506
015336         10  FILLER                  PIC  X(09) VALUE '  NUMBER '.01533602
015337         10  FILLER                  PIC  X(02) VALUE SPACES.     01533706
015338         10  FILLER                  PIC  X(04) VALUE ' SEQ'.     01533802
015339         10  FILLER                  PIC  X(02) VALUE SPACES.     01533906
015340         10  FILLER                  PIC  X(02) VALUE 'ST'.       01534002
015341         10  FILLER                  PIC  X(02) VALUE SPACE.      01534106
015342         10  FILLER                  PIC  X(26) VALUE             01534202
015343                                     '        TIMESTAMP         '.01534302
015344         10  FILLER                  PIC  X(01) VALUE SPACES.     01534408
015345         10  FILLER                  PIC  X(03) VALUE 'TYP'.      01534509
015346         10  FILLER                  PIC  X(01) VALUE SPACES.     01534609
015347         10  FILLER                  PIC  X(03) VALUE 'CDE'.      01534708
015348         10  FILLER                  PIC  X(01) VALUE SPACES.     01534810
015349         10  FILLER                  PIC  X(03) VALUE 'IND'.      01534902
015350         10  FILLER                  PIC  X(02) VALUE SPACES.     01535006
015351         10  FILLER                  PIC  X(04) VALUE 'OPER'.     01535102
015352         10  FILLER                  PIC  X(02) VALUE SPACES.     01535206
015353         10  FILLER                  PIC  X(03) VALUE 'NBR'.      01535312
015354         10  FILLER                  PIC  X(02) VALUE SPACES.     01535406
015355         10  FILLER                  PIC  X(05) VALUE ' ID  '.    01535502
015356         10  FILLER                  PIC  X(02) VALUE SPACES.     01535606
015357         10  FILLER                  PIC  X(04) VALUE 'LINE'.     01535702
015358         10  FILLER                  PIC  X(02) VALUE SPACES.     01535806
015359         10  FILLER                  PIC  X(04) VALUE ' ST '.     01535902
015360         10  FILLER                  PIC  X(02) VALUE SPACES.     01536006
015361         10  FILLER                  PIC  X(26) VALUE             01536102
015362                                     '        TIMESTAMP         '.01536202
015364         10  FILLER                  PIC  X(03) VALUE 'TYP'.      01536416
015365         10  FILLER                  PIC  X(02) VALUE SPACES.     01536506
015366         10  FILLER                  PIC  X(04) VALUE 'NBR '.     01536602
015367         10  FILLER                  PIC  X(02) VALUE SPACES.     01536706
015368                                                                  01536802
015407 01  DETAIL-LINES.                                                01540700
015408     05  DETAIL-LINE1.                                            01540800
015410         10  DL1-OPER                PIC  Z(04)    VALUE SPACES.  01541002
015411         10  FILLER                  PIC  X(02)    VALUE SPACES.  01541106
015412         10  DL1-PO                  PIC  Z(09)    VALUE ZEROES.  01541202
015413         10  FILLER                  PIC  X(02)    VALUE SPACES.  01541306
015420         10  DL1-RCVR                PIC  Z(04)    VALUE SPACES.  01542002
015500         10  FILLER                  PIC  X(02)    VALUE SPACES.  01550006
015600         10  DL1-RCVR-STATUS         PIC  X(02)    VALUE SPACES.  01560002
015601         10  FILLER                  PIC  X(02)    VALUE SPACES.  01560106
015602         10  DL1-VE-TMST             PIC  X(26)    VALUE SPACES.  01560202
015603         10  FILLER                  PIC  X(02)    VALUE SPACES.  01560306
015604         10  DL1-RCVR-TYPE           PIC  X(02)    VALUE SPACES.  01560402
015605         10  FILLER                  PIC  X(02)    VALUE SPACE.   01560506
015606         10  DL1-PKGNG-CDE           PIC  X(01)    VALUE ZERO.    01560602
015607         10  FILLER                  PIC  X(03)    VALUE SPACE.   01560710
015608         10  DL1-PBS                 PIC  X(01)    VALUE SPACE.   01560802
015609         10  FILLER                  PIC  X(02)    VALUE SPACE.   01560906
015610         10  DL1-LINE-OPER           PIC  Z(04)    VALUE SPACE.   01561002
015611         10  FILLER                  PIC  X(02)    VALUE SPACE.   01561106
015612         10  DL1-PO-LINE             PIC  Z(04)    VALUE SPACES.  01561202
015613         10  FILLER                  PIC  X(02)    VALUE SPACE.   01561306
015614         10  DL1-PREPK-ID            PIC  Z(04)    VALUE SPACE.   01561402
015615         10  FILLER                  PIC  X(04)    VALUE SPACE.   01561513
015616         10  DL1-PREPK-DRVR          PIC  X(01)    VALUE SPACES.  01561602
015617         10  FILLER                  PIC  X(05)    VALUE SPACE.   01561714
015618         10  DL1-LINE-ST             PIC  X(02)    VALUE SPACES.  01561802
015619         10  FILLER                  PIC  X(02)    VALUE SPACE.   01561906
015620         10  DL1-LINE-CRE-TMST       PIC  X(26)    VALUE SPACES.  01562002
015621         10  FILLER                  PIC  X(02)    VALUE SPACE.   01562106
015622         10  DL1-PO-TYPE             PIC  X(02)    VALUE SPACES.  01562202
015623         10  FILLER                  PIC  X(02)    VALUE SPACE.   01562306
015624         10  DL1-DEPT                PIC  X(03)    VALUE SPACES.  01562402
015625         10  FILLER                  PIC  X(10)    VALUE SPACE.   01562502
015626                                                                  01562621
015627     05  DETAIL-LINE2.                                            01562721
015628         10  FILLER                  PIC  X(96)    VALUE SPACES.  01562821
015629         10  DL1-SML                 PIC  Z(18)    VALUE ZEROES.  01562921
015630         10  FILLER                  PIC  X(18)    VALUE SPACES.  01563021
015637                                                                  01563700
015638                                                                  01563800
015640 01  MISCELLANEOUS-LINES.                                         01564000
015650     05  BLANK-LINE.                                              01565000
015660         10  FILLER                  PIC X(132) VALUE SPACES.     01566006
015670                                                                  01567000
015680     05  END-OF-REPORT-LINE.                                      01568000
015690         10  FILLER                  PIC X(50) VALUE SPACES.      01569017
015700         10  FILLER                  PIC X(45) VALUE              01570000
015800             '*******   E N D   O F   R E P O R T   *******'.     01580000
015900         10  FILLER                  PIC X(49) VALUE SPACES.      01590017
016000                                                                  01600000
016100     05  NO-DATA-TO-REPORT-LINE.                                  01610000
016200         10  FILLER                  PIC X(40) VALUE SPACES.      01620000
016300         10  FILLER                  PIC  X(52)    VALUE          01630000
016400         '*******  N O   D A T A   T O   R E P O R T   *******'.  01640000
016500         10  FILLER                  PIC  X(40)    VALUE SPACES.  01650000
016600         10  FILLER                  PIC X(18) VALUE SPACES.      01660000
016700                                                                  01670000
016710* * * SUT_OTBND_CART                                              01671021
016720     EXEC SQL                                                     01672021
016730         INCLUDE SUT00024                                         01673021
016740     END-EXEC.                                                    01674021
016750                                                                  01675021
016751* * * SUT_OTBND_UPC                                               01675121
016752     EXEC SQL                                                     01675221
016753         INCLUDE SUT00028                                         01675321
016754     END-EXEC.                                                    01675421
016755                                                                  01675521
016760* * * COMMUNICATIONS AREA FOR DB2                                 01676021
016770     EXEC SQL                                                     01677021
016780          INCLUDE SQLCA                                           01678021
016790     END-EXEC.                                                    01679021
016791                                                                  01679121
016792**DECLARE THE SML CURSOR                                          01679221
016793     EXEC SQL                                                     01679321
016794          DECLARE SML-CSR CURSOR FOR                              01679421
016795           SELECT DISTINCT A.SHIPT_UNT_ID                         01679521
016892             FROM SUT_OTBND_CART A                                01689221
016893                , SUT_OTBND_UPC B                                 01689321
016896            WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID               01689621
016897              AND B.TRN_NBR         = :DK-PO-NBR                  01689721
016898              AND B.RCVR_SEQ_NBR    = :DK-RCVR                    01689821
016899              AND B.TRN_LNE_NBR     = :DK-LINE                    01689921
016900             ORDER BY A.SHIPT_UNT_ID                              01690021
016994           WITH UR                                                01699421
016995     END-EXEC.                                                    01699521
016996                                                                  01699621
016997     COPY DPWS004.                                                01699721
016998                                                                  01699821
016999                                                                  01699921
017000                                                                  01700000
020300******************************************************************02030000
020400 PROCEDURE DIVISION.                                              02040000
020500     DISPLAY ' '.                                                 02050002
020510     DISPLAY '**** START OF RCKRP096 ****'.                       02051002
020520     DISPLAY ' '.                                                 02052002
020600                                                                  02060000
020700*OPEN FILES.                                                      02070000
020800     OPEN INPUT  INPUT-FILE                                       02080000
020900          OUTPUT REPORT-FILE                                      02090002
020910                 OUTPUT-FILE.                                     02091002
021000                                                                  02100000
021100     PERFORM 1000-INITIALIZATION.                                 02110000
021200                                                                  02120000
021300     SET  PS-NOT-END-OF-INPUT                                     02130021
021310          PS-EOF-CSR-NO         TO  TRUE.                         02131021
021400                                                                  02140000
021500     PERFORM 7000-READ-EXTRACT-FILE.                              02150000
021600                                                                  02160000
022000     IF PS-END-OF-INPUT                                           02200000
022100        ADD +1                  TO PV-PAGE-COUNT                  02210000
022200        MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER             02220006
022300        WRITE REPORT-RECORD                                       02230000
022400          FROM DP132O-STANDRD-HEADER-132-COLS                     02240006
022500            AFTER ADVANCING PAGE                                  02250000
022600        WRITE REPORT-RECORD                                       02260000
022700          FROM HEADING-LINE1                                      02270000
022800            AFTER ADVANCING 1 LINES                               02280000
022900        WRITE REPORT-RECORD                                       02290000
023000          FROM HEADING-LINE2                                      02300000
023100            AFTER ADVANCING 1 LINE                                02310000
023200        WRITE REPORT-RECORD                                       02320000
023300          FROM NO-DATA-TO-REPORT-LINE                             02330000
023400            AFTER ADVANCING 2 LINES                               02340000
023500     ELSE                                                         02350000
023510         MOVE SPACES  TO ERROR-REC                                02351003
023512         WRITE OUTPUT-RECORD    FROM ERROR-REC                    02351203
023513                                                                  02351303
023514         MOVE SPACES  TO ERROR-REC                                02351403
023520         STRING 'THIS PROCESS HAS FOUND SOME VERIFIED'            02352003
023530                                   DELIMITED BY SIZE              02353003
023540                             INTO ERROR-REC                       02354003
023550                                                                  02355003
023560         WRITE OUTPUT-RECORD    FROM ERROR-REC                    02356003
023570                                                                  02357003
023580         MOVE SPACES  TO ERROR-REC                                02358003
023590         STRING 'RECEIVERS THAT HAVE LINE(S) THAT ARE'            02359018
023591                ' NOT VERIFIED'    DELIMITED BY SIZE              02359103
023592                             INTO ERROR-REC                       02359203
023593                                                                  02359303
023594         WRITE OUTPUT-RECORD    FROM ERROR-REC                    02359403
023595                                                                  02359503
023596         MOVE SPACES  TO ERROR-REC                                02359603
023598         WRITE OUTPUT-RECORD    FROM ERROR-REC                    02359803
023700                                                                  02370003
023800         PERFORM 1500-PRINT-HEADINGS                              02380000
023900         PERFORM 2000-PROCESS-INPUT                               02390000
024000           UNTIL PS-END-OF-INPUT                                  02400000
024100     END-IF.                                                      02410000
024200                                                                  02420000
024300*FINISH REPORT.                                                   02430000
024400                                                                  02440000
024500     WRITE REPORT-RECORD                                          02450000
024600       FROM END-OF-REPORT-LINE                                    02460000
024700         AFTER ADVANCING 3 LINES.                                 02470000
024800                                                                  02480000
025300     MOVE PV-READ-COUNT TO PV-DISPLAY-READ-COUNT.                 02530000
025400     DISPLAY 'TOTAL INPUT READ ' PV-DISPLAY-READ-COUNT.           02540000
025500                                                                  02550000
025600     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               02560000
025700     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        02570000
025800                                                                  02580000
025810     IF  PV-READ-COUNT  > 0                                       02581004
025811         MOVE SPACES  TO ERROR-REC                                02581104
025812         WRITE OUTPUT-RECORD    FROM ERROR-REC                    02581204
025816                                                                  02581604
025820         MOVE SPACES                TO ERROR-REC                  02582004
025821         STRING  'VERIFIED RECEIVERS WITH LINE(S) THAT ARE NOT '  02582118
025822                 'VERIFIED'            DELIMITED BY SIZE          02582204
025823                                  INTO ERROR-REC                  02582304
025824         WRITE OUTPUT-RECORD    FROM ERROR-REC                    02582404
025826                                                                  02582604
025832         MOVE SPACES                TO ERROR-REC                  02583204
025833         STRING  'MORE INFORMATION CAN BE FOUND IN RDS REPORT'    02583304
025834                 ' RCK01205'              DELIMITED BY SIZE       02583404
025835                                  INTO ERROR-REC                  02583504
025836         WRITE OUTPUT-RECORD    FROM ERROR-REC                    02583604
025838                                                                  02583804
025839         MOVE SPACES  TO ERROR-REC                                02583904
025840         WRITE OUTPUT-RECORD    FROM ERROR-REC                    02584004
025841                                                                  02584104
025851      END-IF.                                                     02585104
025852                                                                  02585205
025853*CLOSE FILES.                                                     02585305
025854     CLOSE INPUT-FILE                                             02585405
025855           REPORT-FILE                                            02585505
025856           OUTPUT-FILE.                                           02585605
025857                                                                  02585705
025858                                                                  02585804
025900     GOBACK.                                                      02590000
026000*                                                                 02600000
026100******************************************************************02610000
026200*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *02620000
026300******************************************************************02630000
026400 1000-INITIALIZATION.                                             02640000
026500     ACCEPT SD-SYSTEM-DATE                                        02650000
026600       FROM DATE.                                                 02660000
026700                                                                  02670000
026800     ACCEPT SD-SYSTEM-TIME                                        02680000
026900       FROM TIME.                                                 02690000
027000                                                                  02700000
027100     MOVE SD-SYSTEM-DATE-MM  TO DP132O-RUN-MONTH.                 02710006
027200     MOVE SD-SYSTEM-DATE-DD  TO DP132O-RUN-DAY.                   02720006
027300     MOVE SD-SYSTEM-DATE-YY  TO DP132O-RUN-YEAR.                  02730006
027400     MOVE SD-SYSTEM-TIME-HH  TO DP132O-RUN-HOUR.                  02740006
027500     MOVE SD-SYSTEM-TIME-MM  TO DP132O-RUN-MINUTE.                02750006
027600                                                                  02760000
027700     MOVE SD-SYSTEM-DATE-MM  TO PV-RPT-DATE-MM.                   02770000
027800     MOVE SD-SYSTEM-DATE-DD  TO PV-RPT-DATE-DD.                   02780000
027900     MOVE SD-SYSTEM-DATE-YY  TO PV-RPT-DATE-YY.                   02790000
028000                                                                  02800000
028100     MOVE PC-RCKRP096             TO DP132O-PROGRAM-NAME.         02810006
028200     MOVE PC-REPORT-NBR           TO DP132O-REPORT-NUMBER.        02820006
028300     MOVE +0                      TO PV-PAGE-COUNT.               02830000
028400                                                                  02840000
028500                                                                  02850000
028600******************************************************************02860000
028700**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  02870000
028800**  PAGES (AS NEEDED).                                            02880000
028900******************************************************************02890000
029000 1500-PRINT-HEADINGS.                                             02900000
029100     ADD +1                  TO PV-PAGE-COUNT.                    02910000
029200     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               02920006
029300                                                                  02930000
029400     MOVE PV-RPT-DATE        TO  HD2-PROCESS-DATE.                02940000
029500                                                                  02950000
029600     WRITE REPORT-RECORD                                          02960000
029700       FROM DP132O-STANDRD-HEADER-132-COLS                        02970006
029800         AFTER ADVANCING PAGE.                                    02980000
029900                                                                  02990000
030000     WRITE REPORT-RECORD                                          03000000
030100       FROM HEADING-LINE1                                         03010000
030200         AFTER ADVANCING 1 LINES.                                 03020000
030300                                                                  03030000
030400     WRITE REPORT-RECORD                                          03040000
030500       FROM HEADING-LINE2                                         03050000
030600         AFTER ADVANCING 1 LINE.                                  03060000
030700                                                                  03070000
030710     MOVE SPACES TO REPORT-RECORD.                                03071019
030800     WRITE REPORT-RECORD                                          03080000
031000         AFTER ADVANCING 1 LINE.                                  03100019
031100                                                                  03110000
031101     WRITE REPORT-RECORD                                          03110119
031102       FROM HEADING-LINE3                                         03110219
031103         AFTER ADVANCING 2 LINES.                                 03110319
031104                                                                  03110419
031110     WRITE REPORT-RECORD                                          03111002
031120       FROM HEADING-LINE4                                         03112002
031130         AFTER ADVANCING 1 LINES.                                 03113002
031140                                                                  03114002
031200     PERFORM 6000-PRINT-BLANK-LINE.                               03120000
031300                                                                  03130000
032200     MOVE +05                TO PV-LINE-COUNT.                    03220000
032300                                                                  03230000
032400                                                                  03240000
032500******************************************************************03250000
032600**  READ INPUT-FILE, WHEN DC CHANGES, DO A PAGE BREAK             03260000
032700******************************************************************03270000
032800 2000-PROCESS-INPUT.                                              03280000
032900                                                                  03290002
034900     PERFORM 5000-WRITE-RPT-DTL.                                  03490000
034910     PERFORM 5020-WRITE-OUTPUT.                                   03491002
035010                                                                  03501021
035020     SET  PS-EOF-CSR-NO  TO  TRUE.                                03502021
035030                                                                  03503021
035100     PERFORM 7000-READ-EXTRACT-FILE.                              03510000
035200                                                                  03520000
035300                                                                  03530000
035301****************************************************************  03530121
035302* SELECT SML #'S TO DISPLAY ON REPORT                          *  03530221
035303****************************************************************  03530321
035310 4000-SELECT-SML.                                                 03531021
035311                                                                  03531121
035312     SET  PS-EOF-CSR-NO             TO  TRUE.                     03531221
035320     PERFORM 4010-OPEN-SML-CSR.                                   03532021
035330     PERFORM 4020-FETCH-SML-CSR                                   03533021
035340       UNTIL PS-EOF-CSR-YES.                                      03534021
035350     PERFORM 4030-CLOSE-SML-CSR.                                  03535021
035360                                                                  03536021
035370                                                                  03537021
035371****************************************************************  03537121
035372* OPEN CURSOR                                                  *  03537221
035373****************************************************************  03537321
035380 4010-OPEN-SML-CSR.                                               03538021
035381                                                                  03538121
035382     SET PS-EOF-CSR-NO        TO TRUE.                            03538221
035383                                                                  03538321
035384     EXEC SQL                                                     03538421
035385          OPEN SML-CSR                                            03538521
035386     END-EXEC.                                                    03538621
035387                                                                  03538721
035388     EVALUATE TRUE                                                03538821
035389         WHEN SQLCODE = ZERO                                      03538921
035390         WHEN SQLCODE = -904                                      03539021
035391         WHEN SQLCODE = -913                                      03539121
035392         WHEN SQLCODE = -911                                      03539221
035393              CONTINUE                                            03539321
035394         WHEN SQLWARN0 NOT = SPACES                               03539421
035395         WHEN SQLCODE NOT = ZERO                                  03539521
035396             MOVE SQLCODE               TO PV-SQLCODE             03539621
035397             STRING 'SQL='                                        03539721
035398                  PV-SQLCODE                                      03539822
035399                  DELIMITED BY SIZE                               03539921
035400                            INTO PV-DB2-MESSAGE                   03540021
035401             MOVE '4010-OPEN-SML-CSR  '                           03540121
035402                              TO PV-ABEND-PARAGRAPH               03540221
035403             MOVE 'SUT00024'  TO PV-ABEND-TABLE                   03540321
035404             PERFORM 9100-SQL-ABEND                               03540421
035405     END-EVALUATE.                                                03540521
035406                                                                  03540621
035407                                                                  03540721
035410****************************************************************  03541021
035411* FETCH CURSOR                                                 *  03541121
035412****************************************************************  03541221
035413 4020-FETCH-SML-CSR.                                              03541321
035416                                                                  03541621
035417     EXEC SQL                                                     03541721
035418          FETCH SML-CSR                                           03541821
035419           INTO :SUT00024-SHIPT-UNT-ID                            03541921
035435     END-EXEC.                                                    03543521
035436                                                                  03543621
035437     EVALUATE TRUE                                                03543721
035438         WHEN SQLCODE = ZERO                                      03543821
035439              PERFORM 5015-WRITE-DETAIL2                          03543921
035440                                                                  03544021
035459         WHEN SQLCODE = +100                                      03545921
035460              SET PS-EOF-CSR-YES   TO TRUE                        03546021
035461                                                                  03546121
035462                                                                  03546221
035463         WHEN SQLCODE = -904                                      03546321
035464         WHEN SQLCODE = -913                                      03546421
035465         WHEN SQLCODE = -911                                      03546521
035466              CONTINUE                                            03546621
035467         WHEN SQLWARN0 NOT = SPACES                               03546721
035468         WHEN SQLCODE NOT = ZERO                                  03546821
035469             MOVE SQLCODE               TO PV-SQLCODE             03546921
035470             STRING 'SQL='                                        03547021
035471                  PV-SQLCODE                                      03547122
035472                  DELIMITED BY SIZE                               03547221
035473                            INTO PV-DB2-MESSAGE                   03547321
035474             MOVE '4020-FETCH-SML-CSR'                            03547421
035475                              TO PV-ABEND-PARAGRAPH               03547521
035476             MOVE 'SUT00024'  TO PV-ABEND-TABLE                   03547621
035477             PERFORM 9100-SQL-ABEND                               03547721
035478     END-EVALUATE.                                                03547821
035481                                                                  03548121
035482                                                                  03548221
035483****************************************************************  03548321
035484* CLOSE CURSOR                                                 *  03548421
035485****************************************************************  03548521
035486 4030-CLOSE-SML-CSR.                                              03548621
035487                                                                  03548721
035488     EXEC SQL                                                     03548821
035489          CLOSE SML-CSR                                           03548921
035490     END-EXEC.                                                    03549021
035491                                                                  03549121
035492     EVALUATE TRUE                                                03549221
035493         WHEN SQLCODE = ZERO                                      03549321
035494         WHEN SQLCODE = -904                                      03549421
035495         WHEN SQLCODE = -913                                      03549521
035496         WHEN SQLCODE = -911                                      03549621
035497              CONTINUE                                            03549721
035498         WHEN SQLWARN0 NOT = SPACES                               03549821
035499         WHEN SQLCODE NOT = ZERO                                  03549921
035500             MOVE SQLCODE               TO PV-SQLCODE             03550021
035501             STRING 'SQL='                                        03550121
035502                  PV-SQLCODE                                      03550222
035503                  DELIMITED BY SIZE                               03550321
035504                            INTO PV-DB2-MESSAGE                   03550421
035505             MOVE '4030-CLOSE-SML-CSR  '                          03550521
035506                              TO PV-ABEND-PARAGRAPH               03550621
035507             MOVE 'SUT00024'  TO PV-ABEND-TABLE                   03550721
035508             PERFORM 9100-SQL-ABEND                               03550821
035509     END-EVALUATE.                                                03550921
035510                                                                  03551021
035511                                                                  03551121
035512****************************************************************  03551200
035520* MOVE THE DETAILS TO REPORT LINE.                             *  03552000
035600****************************************************************  03560000
035700 5000-WRITE-RPT-DTL.                                              03570000
035800                                                                  03580000
035900     MOVE RC124-OPER-UNT-ID         TO DL1-OPER.                  03590002
035910     MOVE RC124-ORD-NBR             TO DL1-PO.                    03591002
035920     MOVE RC124-REC-SEQ-NBR         TO DL1-RCVR.                  03592002
035930     MOVE RC124-RCVR-STATUS         TO DL1-RCVR-STATUS.           03593002
035940     MOVE RC124-VERFYD-TMST         TO DL1-VE-TMST.               03594002
035950     MOVE RC124-RCVR-TYP-CDE        TO DL1-RCVR-TYPE.             03595002
035960     MOVE RC124-PKGNG-CDE           TO DL1-PKGNG-CDE.             03596002
036000     MOVE RC124-PBS                 TO DL1-PBS.                   03600002
036100     MOVE RC124-RECITM-OPER         TO DL1-LINE-OPER.             03610002
036200     MOVE RC124-RECITM-LINE         TO DL1-PO-LINE.               03620002
036300     MOVE RC124-RECITM-PREPK-ID     TO DL1-PREPK-ID.              03630002
036400     MOVE RC124-PREPK-DRVR-LNE-CDE  TO DL1-PREPK-DRVR.            03640002
036500     MOVE RC124-LINE-STATUS         TO DL1-LINE-ST.               03650002
036600     MOVE RC124-LINE-CRE-TMST       TO DL1-LINE-CRE-TMST.         03660002
036700     MOVE RC124-PO-TYP-CDE          TO DL1-PO-TYPE.               03670002
036800     MOVE RC124-DEPT-NBR            TO DL1-DEPT.                  03680002
041000                                                                  04100000
041200     PERFORM 5010-WRITE-DETAIL.                                   04120002
041600                                                                  04160000
041601     SET  PS-EOF-CSR-NO             TO  TRUE.                     04160121
041602     MOVE RC124-ORD-NBR             TO DK-PO-NBR.                 04160221
041603     MOVE RC124-REC-SEQ-NBR         TO DK-RCVR.                   04160321
041604     MOVE RC124-RECITM-LINE         TO DK-LINE.                   04160421
041610                                                                  04161021
041611     PERFORM 4000-SELECT-SML.                                     04161121
041700                                                                  04170000
041800 5010-WRITE-DETAIL.                                               04180000
041900                                                                  04190000
042000     PERFORM 6000-PRINT-BLANK-LINE.                               04200000
042100                                                                  04210000
042200     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        04220000
042300         PERFORM 1500-PRINT-HEADINGS                              04230000
042400     END-IF.                                                      04240000
042500                                                                  04250000
043200     WRITE REPORT-RECORD                                          04320000
043300      FROM DETAIL-LINE1                                           04330000
043400     AFTER ADVANCING 1 LINES.                                     04340000
043500                                                                  04350000
043600     ADD  1                  TO PV-LINE-COUNT.                    04360000
043700     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        04370000
043800         PERFORM 1500-PRINT-HEADINGS                              04380000
043900     END-IF.                                                      04390000
044000                                                                  04400000
044100                                                                  04410000
044110 5015-WRITE-DETAIL2.                                              04411021
044111     MOVE SUT00024-SHIPT-UNT-ID     TO DL1-SML.                   04411121
044112                                                                  04411221
044118     WRITE REPORT-RECORD                                          04411821
044119      FROM DETAIL-LINE2                                           04411921
044120     AFTER ADVANCING 1 LINES.                                     04412021
044121                                                                  04412121
044122     ADD  1                  TO PV-LINE-COUNT.                    04412221
044123     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        04412321
044124         PERFORM 1500-PRINT-HEADINGS                              04412421
044125     END-IF.                                                      04412521
044126                                                                  04412621
044130                                                                  04413021
044200****************************************************************  04420002
044300* WRITE OUTPUT FILE FOR EMAIL.                                 *  04430002
044400****************************************************************  04440002
044500 5020-WRITE-OUTPUT.                                               04450002
044600                                                                  04460002
044700     MOVE RC124-OPER-UNT-ID         TO RC125-OPER                 04470002
044900     MOVE RC124-ORD-NBR             TO RC125-PO                   04490002
045100     MOVE RC124-REC-SEQ-NBR         TO RC125-RCVR                 04510002
045400     MOVE RC124-VERFYD-TMST         TO RC125-VE-TMST              04540002
045700     MOVE RC124-RECITM-OPER         TO RC125-ITEM-OPER            04570002
045900     MOVE RC124-RECITM-LINE         TO RC125-ITEM-LINE            04590002
046300                                                                  04630002
046400     WRITE OUTPUT-RECORD                                          04640002
046410      FROM RC125-VE-RCVR-EMAIL-REC.                               04641002
046500                                                                  04650002
046600                                                                  04660002
046800****************************************************************  04680000
046900* PRINTS A BLANK LINE                                          *  04690000
047000****************************************************************  04700000
047100 6000-PRINT-BLANK-LINE.                                           04710000
047200                                                                  04720000
047300        WRITE REPORT-RECORD                                       04730000
047400          FROM BLANK-LINE                                         04740000
047500            AFTER ADVANCING 1 LINE                                04750000
047600                                                                  04760000
047700     ADD +1 TO PV-LINE-COUNT.                                     04770000
047800                                                                  04780000
047900******************************************************************04790000
048000*  READ A FROM THE INPUT FILE                                    *04800000
048100******************************************************************04810000
048200 7000-READ-EXTRACT-FILE.                                          04820000
048300     READ INPUT-FILE                                              04830000
048400          INTO RC124-PREPK-RCVR-VE-REC                            04840002
048500         AT END                                                   04850000
048600             SET PS-END-OF-INPUT TO TRUE                          04860000
048700         NOT AT END                                               04870000
048800             ADD +1 TO PV-READ-COUNT                              04880000
048900     END-READ.                                                    04890000
049000                                                                  04900000
049100******************************************************************04910021
049200*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    04920021
049300*  ERROR OR WARNING CODE OCCURS.                                  04930021
049400******************************************************************04940021
049500 9100-SQL-ABEND.                                                  04950021
049600     DISPLAY '9100-SQL-ABEND'.                                    04960021
049700     DISPLAY '** ABEND     **'.                                   04970021
049800     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               04980021
049900     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             04990021
050000     DISPLAY '** TABLE     ** = ' PV-DB2-TABLE-NAME.              05000021
050100     DISPLAY '** MESSAGE   ** = ' PV-DB2-MESSAGE.                 05010021
050200     COPY DPPD004.                                                05020021
050300                                                                  05030021
050400     MOVE +4013                  TO PV-ABEND-CODE.                05040021
050500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         05050021
050600                                                                  05060021
