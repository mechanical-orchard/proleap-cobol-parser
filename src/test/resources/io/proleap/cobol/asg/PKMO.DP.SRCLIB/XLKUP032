000100 IDENTIFICATION DIVISION.                                                 
000200 TITLE 'APPLY LOGISTICS DOMAIN LOCATION CHANGES'.                         
000300                                                                          
000400 PROGRAM-ID.             XLKUP032.                                        
000500 AUTHOR.                 AL PETERS.                                       
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
000700 DATE-WRITTEN            NOVEMBER 2003.                                   
000800 DATE-COMPILED.                                                           
000900 ENVIRONMENT DIVISION.                                                    
001000 CONFIGURATION SECTION.                                                   
001100 SOURCE-COMPUTER.        IBM-3090.                                        
001200 OBJECT-COMPUTER.        IBM-3090.                                        
001300 INPUT-OUTPUT SECTION.                                                    
001400                                                                          
001500 FILE-CONTROL.                                                            
001600                                                                          
001700     SELECT XL-TRANS-FILE                                                 
001800         ASSIGN TO INP01.                                                 
001900                                                                          
002000 DATA DIVISION.                                                           
002100 FILE SECTION.                                                            
002200                                                                          
002300                                                                          
002400 FD  XL-TRANS-FILE                                                        
002500     RECORDING MODE IS F                                                  
002600     LABEL RECORDS ARE STANDARD                                           
002700     RECORD CONTAINS 900 CHARACTERS                                       
002800     BLOCK CONTAINS 0  RECORDS.                                           
002900 01  XL-TRANS-REC                     PIC X(900).                         
003000                                                                          
003100 WORKING-STORAGE SECTION.                                                 
003200 01  PS-SWITCHES.                                                         
003300     05  PS-EOF-TRANS-SW              PIC X(01) VALUE 'N'.                
003400         88  PS-EOF-TRANS                       VALUE 'Y'.                
                                                                                
003500     05  PS-COMMIT-SW                 PIC X(01) VALUE SPACE.              
003600         88  PS-COMMIT-NOW                      VALUE 'Y'.                
003700         88  PS-AINT-TIME-YET-TO-COMMIT         VALUE 'N'.                
                                                                                
           05  PS-LOC-DEL-SW                PIC X(01) VALUE 'N'.                
               88  PS-LOC-DEL-YES                     VALUE 'Y'.                
               88  PS-LOC-DEL-NO                      VALUE 'N'.                
                                                                                
           05  PS-DIST-DEL-SW               PIC X(01) VALUE 'N'.                
               88  PS-DIST-DEL-YES                    VALUE 'Y'.                
               88  PS-DIST-DEL-NO                     VALUE 'N'.                
                                                                                
           05  PS-REGN-DEL-SW               PIC X(01) VALUE 'N'.                
               88  PS-REGN-DEL-YES                    VALUE 'Y'.                
               88  PS-REGN-DEL-NO                     VALUE 'N'.                
                                                                                
           05  PS-TERR-DEL-SW               PIC X(01) VALUE 'N'.                
               88  PS-TERR-DEL-YES                    VALUE 'Y'.                
               88  PS-TERR-DEL-NO                     VALUE 'N'.                
                                                                                
           05  PS-FMTCDE-DEL-SW             PIC X(01) VALUE 'N'.                
               88  PS-FMTCDE-DEL-YES                  VALUE 'Y'.                
               88  PS-FMTCDE-DEL-NO                   VALUE 'N'.                
                                                                                
           05  PS-TZNCDE-DEL-SW             PIC X(01) VALUE 'N'.                
               88  PS-TZNCDE-DEL-YES                  VALUE 'Y'.                
               88  PS-TZNCDE-DEL-NO                   VALUE 'N'.                
                                                                                
           05  PS-LOCTYP-DEL-SW             PIC X(01) VALUE 'N'.                
               88  PS-LOCTYP-DEL-YES                  VALUE 'Y'.                
               88  PS-LOCTYP-DEL-NO                   VALUE 'N'.                
                                                                                
           05  PS-LOC-CHG-NF-SW             PIC X(01) VALUE 'N'.                
               88  PS-LOC-CHG-NF-YES                  VALUE 'Y'.                
               88  PS-LOC-CHG-NF-NO                   VALUE 'N'.                
003800                                                                          
       01  DN-NULL-INDICATORS.                                                  
           05  DN-DIST-NBR                  PIC S9(04) COMP VALUE +0.           
           05  DN-STR-FMT-CDE               PIC S9(04) COMP VALUE +0.           
           05  DN-PO-STRT-DTE               PIC S9(04) COMP VALUE +0.           
           05  DN-REPLT-STR-NBR             PIC S9(04) COMP VALUE +0.           
           05  DN-LNE-1-ADDR                PIC S9(04) COMP VALUE +0.           
           05  DN-LNE-2-ADDR                PIC S9(04) COMP VALUE +0.           
           05  DN-CTY-NME                   PIC S9(04) COMP VALUE +0.           
           05  DN-ST-CDE                    PIC S9(04) COMP VALUE +0.           
           05  DN-ZIP-10                    PIC S9(04) COMP VALUE +0.           
           05  DN-CLO-DTE                   PIC S9(04) COMP VALUE +0.           
           05  DN-LOC-10-ABBR-NM            PIC S9(04) COMP VALUE +0.           
           05  DN-PHN-NBR                   PIC S9(04) COMP VALUE +0.           
           05  DN-MGR-NM                    PIC S9(04) COMP VALUE +0.           
           05  DN-FINCL-CLO-DTE             PIC S9(04) COMP VALUE +0.           
           05  DN-MN-SLS-INCL-DTE           PIC S9(04) COMP VALUE +0.           
           05  DN-YR-SLS-INCL-DTE           PIC S9(04) COMP VALUE +0.           
           05  DN-OCPNC-DTE                 PIC S9(04) COMP VALUE +0.           
           05  DN-POS-RGST-BNK-QTY          PIC S9(04) COMP VALUE +0.           
           05  DN-SLS-INCL-DTE-CDE          PIC S9(04) COMP VALUE +0.           
           05  DN-TOT-SLG-SQ-FTG-QTY        PIC S9(04) COMP VALUE +0.           
           05  DN-TOT-SQ-FTG-QTY            PIC S9(04) COMP VALUE +0.           
           05  DN-STP-ORD-DAYS-QTY          PIC S9(04) COMP VALUE +0.           
           05  DN-ACQR-DTE                  PIC S9(04) COMP VALUE +0.           
           05  DN-RMDL-DTE                  PIC S9(04) COMP VALUE +0.           
           05  DN-MEDN-AGE-NBR              PIC S9(04) COMP VALUE +0.           
           05  DN-EST-HH-INCM-AMT           PIC S9(04) COMP VALUE +0.           
           05  DN-QTR-SLS-INCL-DTE          PIC S9(04) COMP VALUE +0.           
           05  DN-SEA-SLS-INCL-DTE          PIC S9(04) COMP VALUE +0.           
           05  DN-EXTD-MALL-NM              PIC S9(04) COMP VALUE +0.           
           05  DN-GRND-OPN-DTE              PIC S9(04) COMP VALUE +0.           
           05  DN-DIRNS-TXT                 PIC S9(04) COMP VALUE +0.           
           05  DN-EFF-END-DTE               PIC S9(04) COMP VALUE +0.           
           05  DN-RPT-FLSH-SLS-IND          PIC S9(04) COMP VALUE +0.           
           05  DN-DST-IND                   PIC S9(04) COMP VALUE +0.           
           05  DN-E-BUS-IND                 PIC S9(04) COMP VALUE +0.           
           05  DN-STD-TM-ZN-CDE             PIC S9(04) COMP VALUE +0.           
           05  DN-STRT-ORD-DAYS-QTY         PIC S9(04) COMP VALUE +0.           
           05  DN-PRCHG-CRE-IND             PIC S9(04) COMP VALUE +0.           
           05  DN-IN-STR-PRCHG-IND          PIC S9(04) COMP VALUE +0.           
                                                                                
003900 01  PV-COUNTERS COMP-3.                                                  
004000     05  PV-RETRY-COUNTER             PIC S9(03) VALUE ZERO.              
004100     05  PV-COMMIT-COUNT              PIC S9(07) VALUE ZERO.              
004200     05  PV-TRANS-COUNT               PIC S9(07) VALUE ZERO.              
004300     05  PV-WRITE-COUNT               PIC S9(07) VALUE ZERO.              
004400                                                                          
004500     05  PV-XLT00010-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
004600     05  PV-XLT00010-DUP-COUNT        PIC S9(07) VALUE ZERO.              
004700     05  PV-XLT00011-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
004800     05  PV-XLT00011-DUP-COUNT        PIC S9(07) VALUE ZERO.              
004900     05  PV-XLT00012-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
005000     05  PV-XLT00012-DUP-COUNT        PIC S9(07) VALUE ZERO.              
005100     05  PV-XLT00013-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
005200     05  PV-XLT00013-DUP-COUNT        PIC S9(07) VALUE ZERO.              
005300     05  PV-DCSTMF-INSERT-COUNT       PIC S9(07) VALUE ZERO.              
005400     05  PV-DCSTMF-DUP-COUNT          PIC S9(07) VALUE ZERO.              
005300     05  PV-XLT00014-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
005400     05  PV-XLT00014-DUP-COUNT        PIC S9(07) VALUE ZERO.              
005500     05  PV-XLT00015-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
005600     05  PV-XLT00015-DUP-COUNT        PIC S9(07) VALUE ZERO.              
005700     05  PV-XLT00016-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
005800     05  PV-XLT00016-DUP-COUNT        PIC S9(07) VALUE ZERO.              
005900     05  PV-XLT00017-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
006000     05  PV-XLT00017-DUP-COUNT        PIC S9(07) VALUE ZERO.              
006100     05  PV-XLT00018-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
006200     05  PV-XLT00018-DUP-COUNT        PIC S9(07) VALUE ZERO.              
006300     05  PV-XLT00019-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
006400     05  PV-XLT00019-DUP-COUNT        PIC S9(07) VALUE ZERO.              
006500     05  PV-XLT00020-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
006600     05  PV-XLT00020-DUP-COUNT        PIC S9(07) VALUE ZERO.              
006700     05  PV-XLT00021-INSERT-COUNT     PIC S9(07) VALUE ZERO.              
006800     05  PV-XLT00021-DUP-COUNT        PIC S9(07) VALUE ZERO.              
006700     05  PV-XLT00022-INSRT-WHLOC-CNT  PIC S9(07) VALUE ZERO.              
006800     05  PV-XLT00022-DUP-WHLOC-CNT    PIC S9(07) VALUE ZERO.              
006700     05  PV-XLT00023-INSRT-OUTLOC-CNT PIC S9(07) VALUE ZERO.              
006800     05  PV-XLT00023-DUP-OUTLOC-CNT   PIC S9(07) VALUE ZERO.              
006900                                                                          
007000     05  PV-XLT00010-DEL-COUNT        PIC S9(07) VALUE ZERO.              
007100     05  PV-XLT00010-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
007200     05  PV-XLT00010-532-COUNT        PIC S9(07) VALUE ZERO.              
007300     05  PV-XLT00011-DEL-COUNT        PIC S9(07) VALUE ZERO.              
007400     05  PV-XLT00011-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
007500     05  PV-XLT00011-532-COUNT        PIC S9(07) VALUE ZERO.              
007600     05  PV-XLT00012-DEL-COUNT        PIC S9(07) VALUE ZERO.              
007700     05  PV-XLT00012-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
007800     05  PV-XLT00012-532-COUNT        PIC S9(07) VALUE ZERO.              
007900     05  PV-XLT00013-DEL-COUNT        PIC S9(07) VALUE ZERO.              
008000     05  PV-XLT00013-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
008100     05  PV-XLT00013-532-COUNT        PIC S9(07) VALUE ZERO.              
008200     05  PV-DCSTMF-DEL-COUNT          PIC S9(07) VALUE ZERO.              
008300     05  PV-DCSTMF-DELNF-COUNT        PIC S9(07) VALUE ZERO.              
008200     05  PV-XLT00014-DEL-COUNT        PIC S9(07) VALUE ZERO.              
008300     05  PV-XLT00014-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
008400     05  PV-XLT00014-532-COUNT        PIC S9(07) VALUE ZERO.              
008500     05  PV-XLT00015-DEL-COUNT        PIC S9(07) VALUE ZERO.              
008600     05  PV-XLT00015-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
008700     05  PV-XLT00015-532-COUNT        PIC S9(07) VALUE ZERO.              
008800     05  PV-XLT00016-DEL-COUNT        PIC S9(07) VALUE ZERO.              
008900     05  PV-XLT00016-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
009000     05  PV-XLT00016-532-COUNT        PIC S9(07) VALUE ZERO.              
009100     05  PV-XLT00017-DEL-COUNT        PIC S9(07) VALUE ZERO.              
009200     05  PV-XLT00017-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
009300     05  PV-XLT00017-532-COUNT        PIC S9(07) VALUE ZERO.              
009400     05  PV-XLT00018-DEL-COUNT        PIC S9(07) VALUE ZERO.              
009500     05  PV-XLT00018-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
009600     05  PV-XLT00018-532-COUNT        PIC S9(07) VALUE ZERO.              
009700     05  PV-XLT00019-DEL-COUNT        PIC S9(07) VALUE ZERO.              
009800     05  PV-XLT00019-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
009900     05  PV-XLT00019-532-COUNT        PIC S9(07) VALUE ZERO.              
010000     05  PV-XLT00020-DEL-COUNT        PIC S9(07) VALUE ZERO.              
010100     05  PV-XLT00020-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
010200     05  PV-XLT00020-532-COUNT        PIC S9(07) VALUE ZERO.              
010300     05  PV-XLT00021-DEL-COUNT        PIC S9(07) VALUE ZERO.              
010400     05  PV-XLT00021-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
010500     05  PV-XLT00021-532-COUNT        PIC S9(07) VALUE ZERO.              
006700     05  PV-XLT00022-DEL-COUNT        PIC S9(07) VALUE ZERO.              
006800     05  PV-XLT00022-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
010500     05  PV-XLT00022-532-COUNT        PIC S9(07) VALUE ZERO.              
006700     05  PV-XLT00023-DEL-COUNT        PIC S9(07) VALUE ZERO.              
006800     05  PV-XLT00023-DELNF-COUNT      PIC S9(07) VALUE ZERO.              
010500     05  PV-XLT00023-532-COUNT        PIC S9(07) VALUE ZERO.              
010600                                                                          
010700     05  PV-XLT00010-UPD-COUNT        PIC S9(07) VALUE ZERO.              
010800     05  PV-XLT00010-NF-COUNT         PIC S9(07) VALUE ZERO.              
010900     05  PV-XLT00011-UPD-COUNT        PIC S9(07) VALUE ZERO.              
011000     05  PV-XLT00011-NF-COUNT         PIC S9(07) VALUE ZERO.              
011100     05  PV-XLT00012-UPD-COUNT        PIC S9(07) VALUE ZERO.              
011200     05  PV-XLT00012-NF-COUNT         PIC S9(07) VALUE ZERO.              
011300     05  PV-XLT00013-UPD-COUNT        PIC S9(07) VALUE ZERO.              
011400     05  PV-XLT00013-NF-COUNT         PIC S9(07) VALUE ZERO.              
011500     05  PV-XLT00014-UPD-COUNT        PIC S9(07) VALUE ZERO.              
011600     05  PV-XLT00014-NF-COUNT         PIC S9(07) VALUE ZERO.              
011700     05  PV-XLT00015-UPD-COUNT        PIC S9(07) VALUE ZERO.              
011800     05  PV-XLT00015-NF-COUNT         PIC S9(07) VALUE ZERO.              
011900     05  PV-XLT00016-UPD-COUNT        PIC S9(07) VALUE ZERO.              
012000     05  PV-XLT00016-NF-COUNT         PIC S9(07) VALUE ZERO.              
012100     05  PV-XLT00017-UPD-COUNT        PIC S9(07) VALUE ZERO.              
012200     05  PV-XLT00017-NF-COUNT         PIC S9(07) VALUE ZERO.              
012300     05  PV-XLT00018-UPD-COUNT        PIC S9(07) VALUE ZERO.              
012400     05  PV-XLT00018-NF-COUNT         PIC S9(07) VALUE ZERO.              
012500     05  PV-XLT00019-UPD-COUNT        PIC S9(07) VALUE ZERO.              
012600     05  PV-XLT00019-NF-COUNT         PIC S9(07) VALUE ZERO.              
012700     05  PV-XLT00020-UPD-COUNT        PIC S9(07) VALUE ZERO.              
012800     05  PV-XLT00020-NF-COUNT         PIC S9(07) VALUE ZERO.              
012900     05  PV-XLT00021-UPD-COUNT        PIC S9(07) VALUE ZERO.              
013000     05  PV-XLT00021-NF-COUNT         PIC S9(07) VALUE ZERO.              
012900     05  PV-XLT00022-UPD-WHLOC-CNT    PIC S9(07) VALUE ZERO.              
013000     05  PV-XLT00022-NF-WHLOC-CNT     PIC S9(07) VALUE ZERO.              
012900     05  PV-XLT00023-UPD-OUTLOC-CNT   PIC S9(07) VALUE ZERO.              
013000     05  PV-XLT00023-NF-OUTLOC-CNT    PIC S9(07) VALUE ZERO.              
013100                                                                          
013200 01  PV-OTHER-STUFF.                                                      
013300     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XLKUP032'.         
013400     05  PV-TMST                      PIC X(26) VALUE SPACES.             
013500     05  PV-HOLD-TMST                 PIC X(26) VALUE SPACES.             
013600     05  PC-MAX-RETRIES               PIC S9(04)    VALUE  +3             
013700                                                   COMP.                  
           05  PV-DIRNS-TXT-LEN             PIC S9(04) VALUE +255               
                                                         COMP.                  
           05  PV-DIRNS-TXT                 PIC X(255) VALUE SPACE.             
           05  PV-DISP-NBR                  PIC Z,ZZZ,ZZ9.                      
013900     05  PV-ABEND-CODE                PIC S9(04) COMP SYNC                
014000                                                 VALUE ZERO.              
041500     05  PV-CURRENT-TMST              PIC X(26)  VALUE SPACES.            
           05  PV-REPLT-STR-NBR             PIC S9(04) COMP SYNC                
                                                       VALUE ZERO.              
           05  PV-GRND-OPN-DTE              PIC X(10)  VALUE SPACE.             
           05  PV-PHN-NBR                   PIC X(26)  VALUE SPACE.             
           05  PV-MGR-NM                    PIC X(32)  VALUE SPACE.             
           05  PV-LOC-10-ABBR-NM            PIC X(10)  VALUE SPACE.             
           05  PV-FINCL-CLO-DTE             PIC X(10)  VALUE SPACE.             
           05  PV-MN-SLS-INCL-DTE           PIC X(10)  VALUE SPACE.             
           05  PV-YR-SLS-INCL-DTE           PIC X(10)  VALUE SPACE.             
           05  PV-OCPNC-DTE                 PIC X(10)  VALUE SPACE.             
           05  PV-POS-RGST-BNK-QTY          PIC S9(3)V COMP-3                   
                                                       VALUE ZERO.              
           05  PV-STR-FMT-CDE               PIC S9(4)V COMP-3                   
                                                       VALUE ZERO.              
           05  PV-TOT-SLG-SQ-FTG-QTY        PIC S9(8)V COMP-3                   
                                                       VALUE ZERO.              
           05  PV-SLS-INCL-DTE-CDE          PIC X(01)  VALUE SPACE.             
           05  PV-TOT-SQ-FTG-QTY            PIC S9(8)V COMP-3                   
                                                       VALUE ZERO.              
           05  PV-STP-ORD-DAYS-QTY          PIC S9(3)V COMP-3                   
                                                       VALUE ZERO.              
           05  PV-ACQR-DTE                  PIC X(10)  VALUE SPACE.             
           05  PV-RMDL-DTE                  PIC X(10)  VALUE SPACE.             
           05  PV-MEDN-AGE-NBR              PIC S9(2)V9(2) COMP-3               
                                                       VALUE ZERO.              
           05  PV-EST-HH-INCM-AMT           PIC S9(11)V    COMP-3               
                                                       VALUE ZERO.              
           05  PV-QTR-SLS-INCL-DTE          PIC X(10)  VALUE SPACE.             
           05  PV-SEA-SLS-INCL-DTE          PIC X(10)  VALUE SPACE.             
           05  PV-EXTD-MALL-NM              PIC X(40)  VALUE SPACE.             
           05  PV-DIST-NBR                  PIC S9(4)V     COMP-3               
                                                       VALUE ZERO.              
           05  PV-DST-IND                   PIC X(01)  VALUE SPACE.             
           05  PV-E-BUS-IND                 PIC X(01)  VALUE SPACE.             
           05  PV-STD-TM-ZN-CDE             PIC X(03)  VALUE SPACE.             
           05  PV-STRT-ORD-DAYS-QTY         PIC S9(3)V     COMP-3               
                                                       VALUE ZERO.              
           05  PV-PRCHG-CRE-IND             PIC X(01)  VALUE SPACE.             
           05  PV-IN-STR-PRCHG-IND          PIC X(01)  VALUE SPACE.             
                                                                                
014100 01  PV-ABEND-FIELDS.                                                     
014200     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'XLKUP032'.        
014300     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.            
014400     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.            
014500     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.            
014600     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.            
014700     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.            
014800     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.            
014900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.            
015000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.            
015100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.            
015200     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.            
015300     05  PV-SQLCODE                   PIC 9(9)  VALUE ZERO.               
015400/                                                                         
015500*    TRANSACTION RECORD                                                   
015600     COPY XLRD037.                                                        
015700/                                                                         
015800*  USED FOR DB2 ERROR MESSAGE BUILDING                                    
015900     COPY DPWS004.                                                        
016000                                                                          
016100*   DB2 SQL COMMUNICATION AREA                                            
016200     EXEC SQL                                                             
016300          INCLUDE SQLCA                                                   
016400     END-EXEC.                                                            
016500     COPY SQLCA2.                                                         
016600                                                                          
016700*    LOCATION LOC                                                         
016800     EXEC SQL                                                             
016900          INCLUDE XLT00010                                                
017000     END-EXEC.                                                            
017100                                                                          
016700*    DC MANIFESTING TABLE                                                 
016800     EXEC SQL                                                             
016900          INCLUDE TDCSTMF                                                 
017000     END-EXEC.                                                            
017100                                                                          
017200*    LOCATION TERR                                                        
017300     EXEC SQL                                                             
017400          INCLUDE XLT00011                                                
017500     END-EXEC.                                                            
017600                                                                          
017700*    LOCATION REGN                                                        
017800     EXEC SQL                                                             
017900          INCLUDE XLT00012                                                
018000     END-EXEC.                                                            
018100                                                                          
018200*    LOCATION DIST                                                        
018300     EXEC SQL                                                             
018400          INCLUDE XLT00013                                                
018500     END-EXEC.                                                            
018600                                                                          
018700*    LOCATION ASGMT                                                      
018800     EXEC SQL                                                             
018900          INCLUDE XLT00014                                                
019000     END-EXEC.                                                            
019100                                                                          
019200*    LOCATION TYP CDE                                                    
019300     EXEC SQL                                                             
019400          INCLUDE XLT00015                                                
019500     END-EXEC.                                                            
019600                                                                          
019700*    LOCATION TM ZN                                                      
019800     EXEC SQL                                                             
019900          INCLUDE XLT00016                                                
020000     END-EXEC.                                                            
020100                                                                          
020200*    LOCATION STR FMT                                                    
020300     EXEC SQL                                                             
020400          INCLUDE XLT00017                                                
020500     END-EXEC.                                                            
020600                                                                          
020700*    LOCATION GP MBSHP                                                   
020800     EXEC SQL                                                             
020900          INCLUDE XLT00018                                                
021000     END-EXEC.                                                            
021100                                                                          
021200*    LOCATION STR GP TP                                                  
021300     EXEC SQL                                                             
021400          INCLUDE XLT00019                                                
021500     END-EXEC.                                                            
021600                                                                          
021700*    LOCATION STR GP                                                     
021800     EXEC SQL                                                             
021900          INCLUDE XLT00020                                                
022000     END-EXEC.                                                            
022100                                                                          
022200*    LOCATION STR GP DT                                                  
022300     EXEC SQL                                                             
022400          INCLUDE XLT00021                                                
022500     END-EXEC.                                                            
022600                                                                          
023100/                                                                         
023200 PROCEDURE DIVISION.                                                      
023300     PERFORM 1000-INITIALIZE.                                             
023400     PERFORM 2000-PROCESS UNTIL PS-EOF-TRANS.                             
023500     PERFORM 9000-EOJ.                                                    
023600     GOBACK.                                                              
023700                                                                          
023800 1000-INITIALIZE.                                                         
023900                                                                          
024000     OPEN INPUT XL-TRANS-FILE                                             
024100     PERFORM 8000-READ-TRANS-FILE.                                        
024200     IF PS-EOF-TRANS                                                      
024300         DISPLAY ALL '*'                                                  
024400         DISPLAY '**  INP01 TRANS FILE IS EMPTY **'                       
024500         DISPLAY ALL '*'                                                  
024600     END-IF.                                                              
024700                                                                          
024800 2000-PROCESS.                                                            
024900                                                                          
025000     EVALUATE TRUE                                                        
025100     WHEN XL037-INSERT                                                    
025200         EVALUATE TRUE                                                    
025300             WHEN XL037-LOC-TYP                                           
025400                 PERFORM 7000-INSERT-LOC-TYP-CDE                          
025500             WHEN XL037-STD-TM-ZN                                         
025600                 PERFORM 7005-INSERT-TM-ZN-CDE                            
025700             WHEN XL037-STR-FMT                                           
025800                 PERFORM 7010-INSERT-STR-FMT-CDE                          
025900             WHEN XL037-TERR                                              
026000                 PERFORM 7015-INSERT-TERR                                 
026100             WHEN XL037-REGN                                              
026200                 PERFORM 7020-INSERT-REGN                                 
026300             WHEN XL037-DIST                                              
026400                 PERFORM 7025-INSERT-DIST                                 
026500             WHEN XL037-LOC                                               
026600                 PERFORM 7030-INSERT-LOC                                  
026700             WHEN XL037-DC-LOC-ASGMT                                      
026800                 PERFORM 7035-INSERT-DC-LOC-ASGMT                         
026900             WHEN XL037-STR-GP-TYP                                        
027000                 PERFORM 7040-INSERT-STR-GP-TYP                           
027100             WHEN XL037-STR-GP                                            
027200                 PERFORM 7045-INSERT-STR-GP                               
027300             WHEN XL037-STR-GP-DTE                                        
027400                 PERFORM 7050-INSERT-STR-GP-DTE                           
027500             WHEN XL037-STR-GP-MBSHP                                      
027600                 PERFORM 7055-INSERT-STR-GP-MBSHP                         
026500             WHEN XL037-LOC-WH                                            
026600                 PERFORM 7060-INSERT-LOC-WH                               
026500             WHEN XL037-OUT-LOC                                           
026600                 PERFORM 7065-INSERT-OUT-LOC                              
027700         END-EVALUATE                                                     
027800                                                                          
      **************************************************************            
      **************  D E L E T E    L O C A T I O N  **************            
      **************************************************************            
      **** PROGRAM DOES NOT DELETE THE LOCATION RECORD          ****            
      **** AND ITS FOREIGN KEY CORRESPONDENT RECORD LOCATIONS   ****            
      **** ONLY CHECKS IF INPUT RECORD IS FOR A DELETE LOCATION ****            
      **** WAREHOUSE LOCATION OR OUTSIDE LOCATION               ****            
      **** AND THEN SETS A SWITCH FOR A RETURN CODE OF 4092     ****            
      **** TO TRIGGER SENDING OF E-MAIL NOTIFICATION MESSAGE    ****            
      **************************************************************            
                                                                                
027900     WHEN XL037-DELETE                                                    
028000         EVALUATE TRUE                                                    
028100             WHEN XL037-LOC-TYP                                           
                       SET PS-LOCTYP-DEL-YES TO TRUE                            
                       ADD 1         TO PV-XLT00015-DEL-COUNT                   
028200*                PERFORM 7100-DELETE-LOC-TYP-CDE                          
028300             WHEN XL037-STD-TM-ZN                                         
                       SET PS-TZNCDE-DEL-YES TO TRUE                            
                       ADD 1         TO PV-XLT00016-DEL-COUNT                   
028400*                PERFORM 7105-DELETE-TM-ZN-CDE                            
028500             WHEN XL037-STR-FMT                                           
                       SET PS-FMTCDE-DEL-YES TO TRUE                            
                       ADD 1         TO PV-XLT00017-DEL-COUNT                   
028600*                PERFORM 7110-DELETE-STR-FMT-CDE                          
028700             WHEN XL037-TERR                                              
                       SET PS-TERR-DEL-YES TO TRUE                              
                       ADD 1         TO PV-XLT00011-DEL-COUNT                   
028800*                PERFORM 7115-DELETE-TERR                                 
028900             WHEN XL037-REGN                                              
                       SET PS-REGN-DEL-YES TO TRUE                              
                       ADD 1         TO PV-XLT00012-DEL-COUNT                   
029000*                PERFORM 7120-DELETE-REGN                                 
029100             WHEN XL037-DIST                                              
                       SET PS-DIST-DEL-YES TO TRUE                              
                       ADD 1         TO PV-XLT00013-DEL-COUNT                   
029200*                PERFORM 7125-DELETE-DIST                                 
                   WHEN XL037-LOC                                               
                       SET PS-LOC-DEL-YES TO TRUE                               
                       ADD 1         TO PV-XLT00010-DEL-COUNT                   
      *                PERFORM 7130-DELETE-LOC                        *         
                   WHEN XL037-LOC-WH                                            
                       SET PS-LOC-DEL-YES TO TRUE                               
                       ADD 1         TO PV-XLT00022-DEL-COUNT                   
                   WHEN XL037-OUT-LOC                                           
                       SET PS-LOC-DEL-YES TO TRUE                               
                       ADD 1         TO PV-XLT00023-DEL-COUNT                   
      **************************************************************            
029500             WHEN XL037-DC-LOC-ASGMT                                      
029600                 PERFORM 7135-DELETE-DC-LOC-ASGNT                         
029700             WHEN XL037-STR-GP-TYP                                        
029800                 PERFORM 7140-DELETE-STR-GP-TYP                           
029900             WHEN XL037-STR-GP                                            
030000                 PERFORM 7145-DELETE-STR-GP                               
030100             WHEN XL037-STR-GP-DTE                                        
030200                 PERFORM 7150-DELETE-STR-GP-DTE                           
030300             WHEN XL037-STR-GP-MBSHP                                      
030400                 PERFORM 7155-DELETE-STR-GP-MBSHP                         
030500         END-EVALUATE                                                     
030600                                                                          
030700     WHEN XL037-MODIFY                                                    
030800         EVALUATE TRUE                                                    
030900             WHEN XL037-LOC-TYP                                           
031000                 PERFORM 7200-CHANGE-LOC-TYP-CDE                          
031100             WHEN XL037-STD-TM-ZN                                         
031200                 PERFORM 7205-CHANGE-TM-ZN-CDE                            
031300             WHEN XL037-STR-FMT                                           
031400                 PERFORM 7210-CHANGE-STR-FMT-CDE                          
031500             WHEN XL037-TERR                                              
031600                 PERFORM 7215-CHANGE-TERR                                 
031700             WHEN XL037-REGN                                              
031800                 PERFORM 7220-CHANGE-REGN                                 
031900             WHEN XL037-DIST                                              
032000                 PERFORM 7225-CHANGE-DIST                                 
032100             WHEN XL037-LOC                                               
032200                 PERFORM 7230-CHANGE-LOC                                  
032300             WHEN XL037-DC-LOC-ASGMT                                      
032400                 PERFORM 7235-CHANGE-DC-LOC-ASGNT                         
032500             WHEN XL037-STR-GP-TYP                                        
032600                 PERFORM 7240-CHANGE-STR-GP-TYP                           
032700             WHEN XL037-STR-GP                                            
032800                 PERFORM 7245-CHANGE-STR-GP                               
032900             WHEN XL037-STR-GP-DTE                                        
033000                 PERFORM 7250-CHANGE-STR-GP-DTE                           
033100             WHEN XL037-STR-GP-MBSHP                                      
033200                 PERFORM 7255-CHANGE-STR-GP-MBSHP                         
032100             WHEN XL037-LOC-WH                                            
032200                 PERFORM 7260-CHANGE-LOC-WH                               
032100             WHEN XL037-OUT-LOC                                           
032200                 PERFORM 7265-CHANGE-OUT-LOC                              
033300         END-EVALUATE                                                     
033400                                                                          
033500     END-EVALUATE.                                                        
033600                                                                          
033700                                                                          
033800     PERFORM 8000-READ-TRANS-FILE.                                        
033900                                                                          
116200******************************************************************        
116300* SET THE CURRENT TIMESTAMP.                                              
116400******************************************************************        
116500 2150-SET-CURRENT-TMST.                                                   
116600                                                                          
117200     EXEC SQL                                                             
117300         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                         
117400     END-EXEC                                                             
117500                                                                          
117600     EVALUATE TRUE                                                        
117700        WHEN SQLCODE = ZERO                                               
117800            CONTINUE                                                      
117900                                                                          
118000        WHEN SQLWARN0 NOT = SPACES                                        
118100        WHEN SQLCODE  NOT = ZERO                                          
118200            DISPLAY '**************************************'              
118300            DISPLAY '** ABEND                            **'              
118400            DISPLAY '** PROGRAM = XLKUP032               **'              
118500            DISPLAY '** PARAGRAPH = 2150-SET-CURRENT-TMST**'              
118600            DISPLAY '** SET CURRENT TIMESTAMP            **'              
118700            DISPLAY '** SQLCODE = ' SQLCODE                               
118800            DISPLAY '**************************************'              
118900            PERFORM 9900-SQL-ERROR                                        
119000     END-EVALUATE.                                                        
119100                                                                          
185654******************************************************************18500000
185655* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     18510000
185656******************************************************************18520000
185657 6000-DB2-COMMIT.                                                 18530000
185658                                                                  18540000
185659     EXEC SQL                                                     18550000
185660         COMMIT                                                   18560000
185700     END-EXEC.                                                    18570000
185800                                                                  18580000
185900     EVALUATE TRUE                                                18590000
186000         WHEN SQLCODE = +0                                        18600000
186100              ADD +1  TO PV-COMMIT-COUNT                          18610000
186200         WHEN SQLWARN0 NOT = SPACES                               18620011
186300         WHEN SQLCODE  NOT = ZERO                                 18630011
186400         DISPLAY '****************************'                   18640000
186500         DISPLAY '** ABEND                  **'                   18650000
186600         DISPLAY '** PROGRAM = XLKUP032     **'                   18660000
186700         DISPLAY '** PARAGRAPH = 6000-COMMIT**'                   18670000
186800         DISPLAY '** UNSUCCESSFUL COMMIT    **'                   18680000
186900         DISPLAY '****************************'                   18690000
187000         PERFORM 9900-SQL-ERROR                                   18700000
187100     END-EVALUATE.                                                18710000
187200                                                                  18720000
034000****************************************************************          
034100****** START OF INSERT ROUTINES ******                                    
034200****************************************************************          
034300                                                                          
034400 7000-INSERT-LOC-TYP-CDE.                                                 
034500     MOVE '7000-INSERT-LOC-TYP-CDE'   TO PV-ABEND-PARAGRAPH.              
034600                                                                          
034700     MOVE XL037-LOC-TYP-CDE           TO XLT00015-LOC-TYP-CDE             
034800     MOVE XL037-LOC-TYP-DESC          TO XLT00015-LOC-TYP-DESC            
034900                                                                          
035000                                                                          
035100     PERFORM                                                              
035200         WITH TEST AFTER                                                  
035300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
035400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
035500                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
035600                                                                          
035700     EXEC SQL                                                             
035800         INSERT INTO XLT_LOC_TYP_CDE                                      
035900             (LOC_TYP_CDE                                                 
036000         ,    LOC_TYP_DESC                                                
036100         )                                                                
036200             VALUES                                                       
036300            (:XLT00015-LOC-TYP-CDE                                        
036400         ,   :XLT00015-LOC-TYP-DESC                                       
036500         )                                                                
036600         END-EXEC                                                         
036700                                                                          
036800         EVALUATE TRUE                                                    
036900             WHEN SQLCODE = ZERO                                          
037000                 ADD 1                TO PV-XLT00015-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00015-DUP-COUNT            
037300             WHEN SQLCODE = -904                                          
037400             WHEN SQLCODE = -911                                          
037500             WHEN SQLCODE = -913                                          
037600                 CONTINUE                                                 
037700                                                                          
037800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
037900                 DISPLAY '**************************************'         
038000                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00015   '        
038100                 DISPLAY 'LOC-TYP-CDE =  '  XL037-LOC-TYP-CDE             
111200                 DISPLAY '**********************************'             
038300                 PERFORM 9800-SQL-WARNING                                 
038400                                                                          
038500             WHEN SQLCODE < ZERO                                          
038600                 DISPLAY '**************************************'         
038700                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00015   '          
038800                 DISPLAY 'LOC-TYP-CDE =  '  XL037-LOC-TYP-CDE             
                       DISPLAY 'SQLCODE =' SQLCODE                              
039000                 PERFORM 9900-SQL-ERROR                                   
039100                                                                          
039200         END-EVALUATE                                                     
039300     END-PERFORM                                                          
039400                                                                          
039500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
039600         SQLCODE NOT = ZERO                                               
039700         DISPLAY '**************************************'                 
039800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
039900         DISPLAY 'INSERT TO XLT00015                    '                 
040000         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00015  '                   
040100         DISPLAY 'LOC-TYP-CDE =  '  XL037-LOC-TYP-CDE                     
040200         DISPLAY '**************************************'                 
040300         PERFORM 9900-SQL-ERROR                                           
040400     END-IF.                                                              
040500                                                                          
040600 7005-INSERT-TM-ZN-CDE.                                                   
040700     MOVE '7005-INSERT-TM-ZN'       TO PV-ABEND-PARAGRAPH.                
040800                                                                          
040900     MOVE XL037-STD-TM-ZN-CDE       TO XLT00016-STD-TM-ZN-CDE.            
041000     MOVE XL037-STD-TM-ZN-DESC      TO XLT00016-STD-TM-ZN-DESC.           
041100                                                                          
041200                                                                          
041300     PERFORM                                                              
041400         WITH TEST AFTER                                                  
041500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
041600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
041700                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
041800                                                                          
041900     EXEC SQL                                                             
042000         INSERT INTO XLT_STD_TM_ZN_CDE                                    
042100             (STD_TM_ZN_CDE                                               
042200         ,    STD_TM_ZN_DESC                                              
042300         )                                                                
042400             VALUES                                                       
042500             (:XLT00016-STD-TM-ZN-CDE                                     
042600         ,    :XLT00016-STD-TM-ZN-DESC                                    
042700         )                                                                
042800         END-EXEC                                                         
042900                                                                          
043000         EVALUATE TRUE                                                    
043100             WHEN SQLCODE = ZERO                                          
043200                 ADD 1                TO PV-XLT00016-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
043300             WHEN SQLCODE = -803                                          
043400                 ADD 1                TO PV-XLT00016-DUP-COUNT            
043500             WHEN SQLCODE = -904                                          
043600             WHEN SQLCODE = -911                                          
043700             WHEN SQLCODE = -913                                          
043800                 CONTINUE                                                 
043900                                                                          
044000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
044100                 DISPLAY '**************************************'         
044200                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00016   '        
044300                 DISPLAY 'STD-TM-ZN  =  '  XL037-STD-TM-ZN-CDE            
044400                 DISPLAY '**********************************'             
044500                 PERFORM 9800-SQL-WARNING                                 
044600                                                                          
044700             WHEN SQLCODE < ZERO                                          
044800                 DISPLAY '**************************************'         
044900                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00016     '        
045000                 DISPLAY 'STD-TM-ZN  =  '  XL037-STD-TM-ZN-CDE            
045100                 DISPLAY '**************************************'         
045200                 PERFORM 9900-SQL-ERROR                                   
045300                                                                          
045400         END-EVALUATE                                                     
045500     END-PERFORM                                                          
045600                                                                          
045700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
045800         SQLCODE NOT = ZERO                                               
045900         DISPLAY '**************************************'                 
046000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
046100         DISPLAY 'INSERT TO XLT00016                    '                 
046200         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00016  '                   
046300         DISPLAY 'STD-TM-ZN  =  '  XL037-STD-TM-ZN-CDE                    
046400         DISPLAY '**************************************'                 
046500         DISPLAY '**************************************'                 
046600         PERFORM 9900-SQL-ERROR                                           
046700     END-IF.                                                              
046800                                                                          
046900 7010-INSERT-STR-FMT-CDE.                                                 
047000     MOVE '7010-INSERT-STR-FMT-CDE'   TO PV-ABEND-PARAGRAPH.              
047100                                                                          
047200     MOVE XL037-STR-FMT-CDE           TO XLT00017-STR-FMT-CDE             
047300     MOVE XL037-STR-FMT-DESC          TO XLT00017-STR-FMT-DESC            
047400                                                                          
047500                                                                          
047600     PERFORM                                                              
047700         WITH TEST AFTER                                                  
047800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
047900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
048000                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
048100                                                                          
048200     EXEC SQL                                                             
048300         INSERT INTO XLT_STR_FMT_CDE                                      
048400             (STR_FMT_CDE                                                 
048500         ,    STR_FMT_DESC                                                
048600         )                                                                
048700             VALUES                                                       
048800             (:XLT00017-STR-FMT-CDE                                       
048900         ,    :XLT00017-STR-FMT-DESC                                      
049000         )                                                                
049100         END-EXEC                                                         
049200                                                                          
049300         EVALUATE TRUE                                                    
049400             WHEN SQLCODE = ZERO                                          
049500                 ADD 1                TO PV-XLT00017-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
049600             WHEN SQLCODE = -803                                          
049700                 ADD 1                TO PV-XLT00017-DUP-COUNT            
049800             WHEN SQLCODE = -904                                          
049900             WHEN SQLCODE = -911                                          
050000             WHEN SQLCODE = -913                                          
050100                 CONTINUE                                                 
050200                                                                          
050300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
050400                 DISPLAY '**************************************'         
050500                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00017  '         
050600                 DISPLAY 'STR-FMT-CDE = '  XL037-STR-FMT-CDE              
050700                 DISPLAY '**********************************'             
050800                 PERFORM 9800-SQL-WARNING                                 
050900                                                                          
051000             WHEN SQLCODE < ZERO                                          
051100                 DISPLAY '**************************************'         
051200                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00017 '            
051300                 DISPLAY 'STR-FMT-CDE = '  XL037-STR-FMT-CDE              
051400                 DISPLAY '**************************************'         
051500                 PERFORM 9900-SQL-ERROR                                   
051600                                                                          
051700         END-EVALUATE                                                     
051800     END-PERFORM                                                          
051900                                                                          
052000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
052100         SQLCODE NOT = ZERO                                               
052200         DISPLAY '**************************************'                 
052300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
052400         DISPLAY 'INSERT TO XLT00017                    '                 
052500         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00017  '                   
052600         DISPLAY 'STR-FMT-CDE = '  XL037-STR-FMT-CDE                      
052700         DISPLAY '**************************************'                 
052800         DISPLAY '**************************************'                 
052900         PERFORM 9900-SQL-ERROR                                           
053000     END-IF.                                                              
053100                                                                          
053200 7015-INSERT-TERR.                                                        
053300     MOVE '7015-INSERT-TERR'          TO PV-ABEND-PARAGRAPH.              
053400     MOVE XL037-TERR-NBR              TO XLT00011-TERR-NBR                
053500     MOVE XL037-TERR-NM               TO XLT00011-TERR-NM                 
053600     MOVE XL037-TERR-MGR-NM           TO XLT00011-TERR-MGR-NM             
053700                                                                          
053800                                                                          
053900     PERFORM                                                              
054000         WITH TEST AFTER                                                  
054100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
054200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
054300                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
054400                                                                          
054500     EXEC SQL                                                             
054600         INSERT INTO XLT_TERR                                             
054700             (TERR_NBR                                                    
054800         ,    TERR_NM                                                     
054900         ,    TERR_MGR_NM                                                 
055000         )                                                                
055100             VALUES                                                       
055200             (:XLT00011-TERR-NBR                                          
055300         ,    :XLT00011-TERR-NM                                           
055400         ,    :XLT00011-TERR-MGR-NM                                       
055500         )                                                                
055600         END-EXEC                                                         
055700                                                                          
055800         EVALUATE TRUE                                                    
055900             WHEN SQLCODE = ZERO                                          
056000                 ADD 1                TO PV-XLT00011-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
056100             WHEN SQLCODE = -803                                          
056200                 ADD 1                TO PV-XLT00011-DUP-COUNT            
056300             WHEN SQLCODE = -904                                          
056400             WHEN SQLCODE = -911                                          
056500             WHEN SQLCODE = -913                                          
056600                 CONTINUE                                                 
056700                                                                          
056800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
056900                 DISPLAY '**************************************'         
057000                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT_TERR  '         
057100                 DISPLAY 'TERR-NBR    = '  XL037-TERR-NBR                 
                       DISPLAY 'TERR-NM     = '  XL037-TERR-NM                  
                       DISPLAY 'TERR-MGR-NM = '  XL037-TERR-MGR-NM              
057200                 DISPLAY '**********************************'             
057300                 PERFORM 9800-SQL-WARNING                                 
057400                                                                          
057500             WHEN SQLCODE < ZERO                                          
057600                 DISPLAY '**************************************'         
057700                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT_TERR '            
057800                 DISPLAY 'TERR-NBR    = '  XL037-TERR-NBR                 
                       DISPLAY 'TERR-NM     = '  XL037-TERR-NM                  
                       DISPLAY 'TERR-MGR-NM = '  XL037-TERR-MGR-NM              
057900                 DISPLAY '**************************************'         
058000                 PERFORM 9900-SQL-ERROR                                   
058100                                                                          
058200         END-EVALUATE                                                     
058300     END-PERFORM                                                          
058400                                                                          
058500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
058600         SQLCODE NOT = ZERO                                               
058700         DISPLAY '**************************************'                 
058800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
058900         DISPLAY 'INSERT TO XLT_TERR                    '                 
059000         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00011  '                   
057800         DISPLAY 'TERR-NBR    = '  XL037-TERR-NBR                         
               DISPLAY 'TERR-NM     = '  XL037-TERR-NM                          
               DISPLAY 'TERR-MGR-NM = '  XL037-TERR-MGR-NM                      
059200         DISPLAY '**************************************'                 
059300         DISPLAY '**************************************'                 
059400         PERFORM 9900-SQL-ERROR                                           
059500     END-IF.                                                              
059600                                                                          
059700 7020-INSERT-REGN.                                                        
059800     MOVE '7020-INSERT-REGN'          TO PV-ABEND-PARAGRAPH.              
059900     MOVE XL037-REGN-NBR              TO XLT00012-REGN-NBR                
060000     MOVE XL037-REGN-NM               TO XLT00012-REGN-NM                 
060100     MOVE XL037-REGN-MGR-NM           TO XLT00012-REGN-MGR-NM             
060200     MOVE XL037-REGN-TERR-NBR         TO XLT00012-TERR-NBR                
060300                                                                          
060400                                                                          
060500     PERFORM                                                              
060600         WITH TEST AFTER                                                  
060700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
060800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
060900                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
061000                                                                          
061100     EXEC SQL                                                             
061200         INSERT INTO XLT_REGN                                             
061300             (REGN_NBR                                                    
061400         ,    REGN_NM                                                     
061500         ,    REGN_MGR_NM                                                 
061600         ,    TERR_NBR                                                    
061700         )                                                                
061800             VALUES                                                       
061900             (:XLT00012-REGN-NBR                                          
062000         ,    :XLT00012-REGN-NM                                           
062100         ,    :XLT00012-REGN-MGR-NM                                       
062200         ,    :XLT00012-TERR-NBR                                          
062300         )                                                                
062400         END-EXEC                                                         
062500                                                                          
062600         EVALUATE TRUE                                                    
062700             WHEN SQLCODE = ZERO                                          
062800                 ADD 1                TO PV-XLT00012-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
062900             WHEN SQLCODE = -803                                          
063000                 ADD 1                TO PV-XLT00012-DUP-COUNT            
063100             WHEN SQLCODE = -904                                          
063200             WHEN SQLCODE = -911                                          
063300             WHEN SQLCODE = -913                                          
063400                 CONTINUE                                                 
063500                                                                          
063600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
063700                 DISPLAY '**************************************'         
063800                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT_REGN  '         
063900                 DISPLAY 'REGN-NBR    = '  XL037-REGN-NBR                 
                       DISPLAY 'REGN-MGR-NM = '  XL037-REGN-MGR-NM              
                       DISPLAY 'REGN-TERR-NBR = ' XL037-REGN-TERR-NBR           
064000                 DISPLAY '**********************************'             
064100                 PERFORM 9800-SQL-WARNING                                 
064200                                                                          
064300             WHEN SQLCODE < ZERO                                          
064400                 DISPLAY '**************************************'         
064500                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT_REGN '            
064600                 DISPLAY 'REGN-NBR    = '  XL037-REGN-NBR                 
                       DISPLAY 'REGN-MGR-NM = '  XL037-REGN-MGR-NM              
                       DISPLAY 'REGN-TERR-NBR = ' XL037-REGN-TERR-NBR           
064700                 DISPLAY '**************************************'         
064800                 PERFORM 9900-SQL-ERROR                                   
064900                                                                          
065000         END-EVALUATE                                                     
065100     END-PERFORM                                                          
065200                                                                          
065300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
065400         SQLCODE NOT = ZERO                                               
065500         DISPLAY '**************************************'                 
065600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
065700         DISPLAY 'INSERT TO XLT_REGN                    '                 
065800         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00012  '                   
065900         DISPLAY 'REGN-NBR    = '  XL037-REGN-NBR                         
               DISPLAY 'REGN-MGR-NM = '  XL037-REGN-MGR-NM                      
               DISPLAY 'REGN-TERR-NBR = ' XL037-REGN-TERR-NBR                   
066100         DISPLAY '**************************************'                 
066200         PERFORM 9900-SQL-ERROR                                           
066300     END-IF.                                                              
066400                                                                          
066500 7025-INSERT-DIST.                                                        
066600     MOVE '7025-INSERT-DIST'          TO PV-ABEND-PARAGRAPH.              
066700     MOVE XL037-DIST-NBR              TO XLT00013-DIST-NBR                
066800     MOVE XL037-DIST-NM               TO XLT00013-DIST-NM                 
066900     MOVE XL037-DIST-MGR-NM           TO XLT00013-DIST-MGR-NM             
067000     MOVE XL037-DIST-REGN-NBR         TO XLT00013-REGN-NBR                
067100                                                                          
067200                                                                          
067300     PERFORM                                                              
067400         WITH TEST AFTER                                                  
067500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
067600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
067700                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
067800                                                                          
067900     EXEC SQL                                                             
068000         INSERT INTO XLT_DIST                                             
068100             (DIST_NBR                                                    
068200         ,    DIST_NM                                                     
068300         ,    DIST_MGR_NM                                                 
068400         ,    REGN_NBR                                                    
068500         )                                                                
068600             VALUES                                                       
068700             (:XLT00013-DIST-NBR                                          
068800         ,    :XLT00013-DIST-NM                                           
068900         ,    :XLT00013-DIST-MGR-NM                                       
069000         ,    :XLT00013-REGN-NBR                                          
069100         )                                                                
069200         END-EXEC                                                         
069300                                                                          
069400         EVALUATE TRUE                                                    
069500             WHEN SQLCODE = ZERO                                          
069600                 ADD 1                TO PV-XLT00013-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
069700             WHEN SQLCODE = -803                                          
069800                 ADD 1                TO PV-XLT00013-DUP-COUNT            
069900             WHEN SQLCODE = -904                                          
070000             WHEN SQLCODE = -911                                          
070100             WHEN SQLCODE = -913                                          
070200                 CONTINUE                                                 
070300                                                                          
070400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
070500                 DISPLAY '**************************************'         
070600                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT_DIST  '         
070700                 DISPLAY 'DIST-NBR    = '  XL037-DIST-NBR                 
                       DISPLAY 'DIST-MGR-NM = '  XL037-DIST-MGR-NM              
                       DISPLAY 'DIST-REGN-NBR = ' XL037-DIST-REGN-NBR           
070800                 DISPLAY '**********************************'             
070900                 PERFORM 9800-SQL-WARNING                                 
071000                                                                          
071100             WHEN SQLCODE < ZERO                                          
071200                 DISPLAY '**************************************'         
071300                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT_DIST '            
071400                 DISPLAY 'DIST-NBR    = '  XL037-DIST-NBR                 
                       DISPLAY 'DIST-MGR-NM = '  XL037-DIST-MGR-NM              
                       DISPLAY 'DIST-REGN-NBR = ' XL037-DIST-REGN-NBR           
071500                 DISPLAY '**************************************'         
071600                 PERFORM 9900-SQL-ERROR                                   
071700                                                                          
071800         END-EVALUATE                                                     
071900     END-PERFORM                                                          
072000                                                                          
072100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
072200         SQLCODE NOT = ZERO                                               
072300         DISPLAY '**************************************'                 
072400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
072500         DISPLAY 'INSERT TO XLT_DIST                    '                 
072600         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00013  '                   
072700         DISPLAY 'DIST-NBR    = '  XL037-DIST-NBR                         
               DISPLAY 'DIST-MGR-NM = '  XL037-DIST-MGR-NM                      
               DISPLAY 'DIST-REGN-NBR = ' XL037-DIST-REGN-NBR                   
072800         DISPLAY '**************************************'                 
073000         PERFORM 9900-SQL-ERROR                                           
073100     END-IF.                                                              
073200                                                                          
073300 7030-INSERT-LOC.                                                         
073400     MOVE '7030-INSERT-LOC'       TO PV-ABEND-PARAGRAPH.                  
073500     MOVE XL037-LOC-NBR           TO XLT00010-LOC-NBR                     
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-REPLT-STR-NBR = ZERO                                    
               MOVE -1 TO DN-REPLT-STR-NBR                                      
           ELSE                                                                 
               MOVE 0 TO DN-REPLT-STR-NBR                                       
           END-IF                                                               
073600     MOVE XL037-LOC-REPLT-STR-NBR                                         
073700                              TO XLT00010-REPLT-STR-NBR                   
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-DIST-NBR = ZERO                                         
               MOVE -1 TO DN-DIST-NBR                                           
           ELSE                                                                 
               MOVE 0 TO DN-DIST-NBR                                            
           END-IF                                                               
073800     MOVE XL037-LOC-DIST-NBR      TO XLT00010-DIST-NBR                    
                                                                                
073900     MOVE XL037-LOC-LOC-TYP-CDE   TO XLT00010-LOC-TYP-CDE                 
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-STR-FMT-CDE = ZERO                                      
               MOVE -1 TO DN-STR-FMT-CDE                                        
           ELSE                                                                 
               MOVE 0 TO DN-STR-FMT-CDE                                         
           END-IF                                                               
           MOVE XL037-LOC-STR-FMT-CDE   TO XLT00010-STR-FMT-CDE                 
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-STD-TM-ZN-CDE = SPACE                                   
               MOVE -1 TO DN-STD-TM-ZN-CDE                                      
           ELSE                                                                 
               MOVE 0 TO DN-STD-TM-ZN-CDE                                       
           END-IF                                                               
074100     MOVE XL037-LOC-STD-TM-ZN-CDE                                         
074200                              TO XLT00010-STD-TM-ZN-CDE                   
                                                                                
074300     MOVE XL037-LOC-NM            TO XLT00010-LOC-NM                      
074400     MOVE XL037-LOC-5-ABBR-NM     TO XLT00010-LOC-5-ABBR-NM               
           MOVE XL037-LOC-LNE-1-ADDR    TO XLT00010-LNE-1-ADDR                  
           MOVE XL037-LOC-LNE-2-ADDR    TO XLT00010-LNE-2-ADDR                  
           MOVE XL037-LOC-CTY-NME       TO XLT00010-CTY-NM                      
           MOVE XL037-LOC-ST-CDE        TO XLT00010-ST-CDE                      
           MOVE XL037-LOC-ZIP-10-CDE    TO XLT00010-ZIP-10-CDE                  
           MOVE XL037-LOC-OPN-DTE       TO XLT00010-OPN-DTE                     
075100     MOVE XL037-LOC-CLO-DTE       TO XLT00010-CLO-DTE                     
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-LOC-10-ABBR-NM = SPACE                                  
               MOVE -1 TO DN-LOC-10-ABBR-NM                                     
           ELSE                                                                 
               MOVE 0 TO DN-LOC-10-ABBR-NM                                      
           END-IF                                                               
075200     MOVE XL037-LOC-LOC-10-ABBR-NM                                        
075300                                  TO XLT00010-LOC-10-ABBR-NM              
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-PHN-NBR = SPACE                                         
               MOVE -1 TO DN-PHN-NBR                                            
           ELSE                                                                 
               MOVE 0 TO DN-PHN-NBR                                             
           END-IF                                                               
075400     MOVE XL037-LOC-PHN-NBR       TO XLT00010-PHN-NBR                     
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-MGR-NM = SPACE                                          
               MOVE -1 TO DN-MGR-NM                                             
           ELSE                                                                 
               MOVE 0 TO DN-MGR-NM                                              
           END-IF                                                               
075500     MOVE XL037-LOC-MGR-NM        TO XLT00010-MGR-NM                      
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-FINCL-CLO-DTE = SPACE                                   
              OR XL037-LOC-FINCL-CLO-DTE = '9999-09-09'                         
               MOVE -1 TO DN-FINCL-CLO-DTE                                      
           ELSE                                                                 
               MOVE 0 TO DN-FINCL-CLO-DTE                                       
           END-IF                                                               
075600     MOVE XL037-LOC-FINCL-CLO-DTE TO XLT00010-FINCL-CLO-DTE               
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-MN-SLS-INCL-DTE = SPACE                                 
              OR XL037-LOC-MN-SLS-INCL-DTE = '9999-09-09'                       
               MOVE -1 TO DN-MN-SLS-INCL-DTE                                    
           ELSE                                                                 
               MOVE 0 TO DN-MN-SLS-INCL-DTE                                     
           END-IF                                                               
075700     MOVE XL037-LOC-MN-SLS-INCL-DTE                                       
075800                                  TO XLT00010-MN-SLS-INCL-DTE             
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-YR-SLS-INCL-DTE = SPACE                                 
              OR XL037-LOC-YR-SLS-INCL-DTE = '9999-09-09'                       
               MOVE -1 TO DN-YR-SLS-INCL-DTE                                    
           ELSE                                                                 
               MOVE 0 TO DN-YR-SLS-INCL-DTE                                     
           END-IF                                                               
075900     MOVE XL037-LOC-YR-SLS-INCL-DTE                                       
076000                                  TO XLT00010-YR-SLS-INCL-DTE             
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-OCPNC-DTE = SPACE                                       
              OR XL037-LOC-OCPNC-DTE = '9999-09-09'                             
               MOVE -1 TO DN-OCPNC-DTE                                          
           ELSE                                                                 
               MOVE 0 TO DN-OCPNC-DTE                                           
           END-IF                                                               
076100     MOVE XL037-LOC-OCPNC-DTE     TO XLT00010-OCPNC-DTE                   
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-POS-RGST-BNK-QTY = ZERO                                 
               MOVE -1 TO DN-POS-RGST-BNK-QTY                                   
           ELSE                                                                 
               MOVE 0 TO DN-POS-RGST-BNK-QTY                                    
           END-IF                                                               
076200     MOVE XL037-LOC-POS-RGST-BNK-QTY                                      
076300                                  TO XLT00010-POS-RGST-BNK-QTY            
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-DST-IND = SPACE                                         
               MOVE -1 TO DN-DST-IND                                            
           ELSE                                                                 
               MOVE 0 TO DN-DST-IND                                             
           END-IF                                                               
076400     MOVE XL037-LOC-DST-IND       TO XLT00010-DST-IND                     
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-E-BUS-IND = SPACE                                       
               MOVE -1 TO DN-E-BUS-IND                                          
           ELSE                                                                 
               MOVE 0 TO DN-E-BUS-IND                                           
           END-IF                                                               
076500     MOVE XL037-LOC-E-BUS-IND     TO XLT00010-E-BUS-IND                   
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-SLS-INCL-DTE-CDE = SPACE                                
               MOVE -1 TO DN-SLS-INCL-DTE-CDE                                   
           ELSE                                                                 
               MOVE 0 TO DN-SLS-INCL-DTE-CDE                                    
           END-IF                                                               
076600     MOVE XL037-LOC-SLS-INCL-DTE-CDE                                      
076700                                  TO XLT00010-SLS-INCL-DTE-CDE            
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-TOT-SLG-SQ-FTG-QTY = ZERO                               
               MOVE -1 TO DN-TOT-SLG-SQ-FTG-QTY                                 
           ELSE                                                                 
               MOVE 0 TO DN-TOT-SLG-SQ-FTG-QTY                                  
           END-IF                                                               
076800     MOVE XL037-LOC-TOT-SLG-SQ-FTG-QTY                                    
076900                                  TO XLT00010-TOT-SLG-SQ-FTG-QTY          
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-TOT-SQ-FTG-QTY = ZERO                                   
               MOVE -1 TO DN-TOT-SQ-FTG-QTY                                     
           ELSE                                                                 
               MOVE 0 TO DN-TOT-SQ-FTG-QTY                                      
           END-IF                                                               
077000     MOVE XL037-LOC-TOT-SQ-FTG-QTY                                        
077100                                  TO XLT00010-TOT-SQ-FTG-QTY              
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-STP-ORD-DAYS-QTY = ZERO                                 
               MOVE -1 TO DN-STP-ORD-DAYS-QTY                                   
           ELSE                                                                 
               MOVE 0 TO DN-STP-ORD-DAYS-QTY                                    
           END-IF                                                               
077200     MOVE XL037-LOC-STP-ORD-DAYS-QTY                                      
077300                                  TO XLT00010-STP-ORD-DAYS-QTY            
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-STRT-ORD-DAYS-QTY = ZERO                                
               MOVE -1 TO DN-STRT-ORD-DAYS-QTY                                  
           ELSE                                                                 
               MOVE 0 TO DN-STRT-ORD-DAYS-QTY                                   
           END-IF                                                               
077400     MOVE XL037-LOC-STRT-ORD-DAYS-QTY                                     
077500                                  TO XLT00010-STRT-ORD-DAYS-QTY           
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-ACQR-DTE = SPACE                                        
              OR XL037-LOC-ACQR-DTE = '9999-09-09'                              
               MOVE -1 TO DN-ACQR-DTE                                           
           ELSE                                                                 
               MOVE 0 TO DN-ACQR-DTE                                            
           END-IF                                                               
077600     MOVE XL037-LOC-ACQR-DTE      TO XLT00010-ACQR-DTE                    
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-RMDL-DTE = SPACE                                        
              OR XL037-LOC-RMDL-DTE = '9999-09-09'                              
               MOVE -1 TO DN-RMDL-DTE                                           
           ELSE                                                                 
               MOVE 0 TO DN-RMDL-DTE                                            
           END-IF                                                               
077700     MOVE XL037-LOC-RMDL-DTE      TO XLT00010-RMDL-DTE                    
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-MEDN-AGE-NBR = '00.00'                                  
               MOVE -1 TO DN-MEDN-AGE-NBR                                       
           ELSE                                                                 
               MOVE 0 TO DN-MEDN-AGE-NBR                                        
           END-IF                                                               
077800     MOVE XL037-LOC-MEDN-AGE-NBR-RDF  TO XLT00010-MEDN-AGE-NBR            
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-EST-HH-INCM-AMT = ZERO                                  
               MOVE -1 TO DN-EST-HH-INCM-AMT                                    
           ELSE                                                                 
               MOVE 0 TO DN-EST-HH-INCM-AMT                                     
           END-IF                                                               
077900     MOVE XL037-LOC-EST-HH-INCM-AMT                                       
078000                                  TO XLT00010-EST-HH-INCM-AMT             
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-QTR-SLS-INCL-DTE = SPACE                                
              OR XL037-LOC-QTR-SLS-INCL-DTE = '9999-09-09'                      
               MOVE -1 TO DN-QTR-SLS-INCL-DTE                                   
           ELSE                                                                 
               MOVE 0 TO DN-QTR-SLS-INCL-DTE                                    
           END-IF                                                               
078100     MOVE XL037-LOC-QTR-SLS-INCL-DTE                                      
078200                                  TO XLT00010-QTR-SLS-INCL-DTE            
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-SEA-SLS-INCL-DTE = SPACE                                
              OR XL037-LOC-SEA-SLS-INCL-DTE = '9999-09-09'                      
               MOVE -1 TO DN-SEA-SLS-INCL-DTE                                   
           ELSE                                                                 
               MOVE 0 TO DN-SEA-SLS-INCL-DTE                                    
           END-IF                                                               
078300     MOVE XL037-LOC-SEA-SLS-INCL-DTE                                      
078400                                  TO XLT00010-SEA-SLS-INCL-DTE            
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-EXTD-MALL-NM = SPACE                                    
               MOVE -1 TO DN-EXTD-MALL-NM                                       
           ELSE                                                                 
               MOVE 0 TO DN-EXTD-MALL-NM                                        
           END-IF                                                               
078500     MOVE XL037-LOC-EXTD-MALL-NM  TO XLT00010-EXTD-MALL-NM                
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-GRND-OPN-DTE = SPACE                                    
              OR XL037-LOC-GRND-OPN-DTE = '9999-09-09'                          
               MOVE -1 TO DN-GRND-OPN-DTE                                       
           ELSE                                                                 
               MOVE 0 TO DN-GRND-OPN-DTE                                        
           END-IF                                                               
078600     MOVE XL037-LOC-GRND-OPN-DTE  TO XLT00010-GRND-OPN-DTE                
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-PRCHG-CRE-IND = SPACE                                   
               MOVE -1 TO DN-PRCHG-CRE-IND                                      
           ELSE                                                                 
               MOVE 0 TO DN-PRCHG-CRE-IND                                       
           END-IF                                                               
078700     MOVE XL037-LOC-PRCHG-CRE-IND TO XLT00010-PRCHG-CRE-IND               
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-IN-STR-PRCHG-IND = SPACE                                
               MOVE -1 TO DN-IN-STR-PRCHG-IND                                   
           ELSE                                                                 
               MOVE 0 TO DN-IN-STR-PRCHG-IND                                    
           END-IF                                                               
078800     MOVE XL037-LOC-IN-STR-PRCHG-IND                                      
078900                                  TO XLT00010-IN-STR-PRCHG-IND            
                                                                                
      *****   CHECK FOR NULLS ****                                              
      *****    ALWAYS MOVE +255 TO TXT-LEN VAR CHAR FIELD  *****                
      *****    WHEN TEXT IS GREATER THAN SPACE             *****                
                                                                                
           IF XL037-LOC-DIRNS-TXT = SPACE                                       
               MOVE -1 TO DN-DIRNS-TXT                                          
           ELSE                                                                 
               MOVE 0 TO DN-DIRNS-TXT                                           
               MOVE PV-DIRNS-TXT-LEN    TO XLT00010-DIRNS-TXT-LEN               
           END-IF                                                               
079000     MOVE XL037-LOC-DIRNS-TXT     TO XLT00010-DIRNS-TXT-TEXT              
                                                                                
           PERFORM 2150-SET-CURRENT-TMST                                        
           MOVE PV-CURRENT-TMST         TO XLT00010-LAST-UPD-TMST               
079100                                                                          
079200     PERFORM                                                              
079300         WITH TEST AFTER                                                  
079400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
079500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
079600                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
079700                                                                          
079800     EXEC SQL                                                             
079900         INSERT INTO XLT_LOC                                              
080000             (LOC_NBR                                                     
080100         ,    REPLT_STR_NBR                                               
080200         ,    DIST_NBR                                                    
080300         ,    LOC_TYP_CDE                                                 
080400         ,    STR_FMT_CDE                                                 
080500         ,    STD_TM_ZN_CDE                                               
080600         ,    LOC_NM                                                      
080700         ,    LOC_5_ABBR_NM                                               
080800         ,    LNE_1_ADDR                                                  
080900         ,    LNE_2_ADDR                                                  
081000         ,    CTY_NM                                                      
081100         ,    ST_CDE                                                      
081200         ,    ZIP_10_CDE                                                  
081300         ,    OPN_DTE                                                     
081400         ,    CLO_DTE                                                     
081500         ,    LOC_10_ABBR_NM                                              
081600         ,    PHN_NBR                                                     
081700         ,    MGR_NM                                                      
081800         ,    FINCL_CLO_DTE                                               
081900         ,    MN_SLS_INCL_DTE                                             
082000         ,    YR_SLS_INCL_DTE                                             
082100         ,    OCPNC_DTE                                                   
082200         ,    POS_RGST_BNK_QTY                                            
082300         ,    DST_IND                                                     
082400         ,    E_BUS_IND                                                   
082500         ,    SLS_INCL_DTE_CDE                                            
082600         ,    TOT_SLG_SQ_FTG_QTY                                          
082700         ,    TOT_SQ_FTG_QTY                                              
082800         ,    STP_ORD_DAYS_QTY                                            
082900         ,    STRT_ORD_DAYS_QTY                                           
083000         ,    ACQR_DTE                                                    
083100         ,    RMDL_DTE                                                    
083200         ,    MEDN_AGE_NBR                                                
083300         ,    EST_HH_INCM_AMT                                             
083400         ,    QTR_SLS_INCL_DTE                                            
083500         ,    SEA_SLS_INCL_DTE                                            
083600         ,    EXTD_MALL_NM                                                
083700         ,    GRND_OPN_DTE                                                
083800         ,    DIRNS_TXT                                                   
083900         ,    PRCHG_CRE_IND                                               
084000         ,    IN_STR_PRCHG_IND                                            
084100         ,    LAST_UPD_TMST                                               
084200         )                                                                
084300             VALUES                                                       
084400             (:XLT00010-LOC-NBR                                           
084500         ,    :XLT00010-REPLT-STR-NBR                                     
                      :DN-REPLT-STR-NBR                                         
084600         ,    :XLT00010-DIST-NBR                                          
                      :DN-DIST-NBR                                              
084700         ,    :XLT00010-LOC-TYP-CDE                                       
084800         ,    :XLT00010-STR-FMT-CDE                                       
                      :DN-STR-FMT-CDE                                           
084900         ,    :XLT00010-STD-TM-ZN-CDE                                     
                      :DN-STD-TM-ZN-CDE                                         
085000         ,    :XLT00010-LOC-NM                                            
085100         ,    :XLT00010-LOC-5-ABBR-NM                                     
085200         ,    :XLT00010-LNE-1-ADDR                                        
085300         ,    :XLT00010-LNE-2-ADDR                                        
085400         ,    :XLT00010-CTY-NM                                            
085500         ,    :XLT00010-ST-CDE                                            
085600         ,    :XLT00010-ZIP-10-CDE                                        
085700         ,    :XLT00010-OPN-DTE                                           
085800         ,    :XLT00010-CLO-DTE                                           
085900         ,    :XLT00010-LOC-10-ABBR-NM                                    
                      :DN-LOC-10-ABBR-NM                                        
086000         ,    :XLT00010-PHN-NBR                                           
                      :DN-PHN-NBR                                               
086100         ,    :XLT00010-MGR-NM                                            
                      :DN-MGR-NM                                                
086200         ,    :XLT00010-FINCL-CLO-DTE                                     
                      :DN-FINCL-CLO-DTE                                         
086300         ,    :XLT00010-MN-SLS-INCL-DTE                                   
                      :DN-MN-SLS-INCL-DTE                                       
086400         ,    :XLT00010-YR-SLS-INCL-DTE                                   
                      :DN-YR-SLS-INCL-DTE                                       
086500         ,    :XLT00010-OCPNC-DTE                                         
                      :DN-OCPNC-DTE                                             
086600         ,    :XLT00010-POS-RGST-BNK-QTY                                  
                      :DN-POS-RGST-BNK-QTY                                      
086700         ,    :XLT00010-DST-IND                                           
                      :DN-DST-IND                                               
086800         ,    :XLT00010-E-BUS-IND                                         
                      :DN-E-BUS-IND                                             
086900         ,    :XLT00010-SLS-INCL-DTE-CDE                                  
                      :DN-SLS-INCL-DTE-CDE                                      
087000         ,    :XLT00010-TOT-SLG-SQ-FTG-QTY                                
                      :DN-TOT-SLG-SQ-FTG-QTY                                    
087100         ,    :XLT00010-TOT-SQ-FTG-QTY                                    
                      :DN-TOT-SQ-FTG-QTY                                        
087200         ,    :XLT00010-STP-ORD-DAYS-QTY                                  
                      :DN-STP-ORD-DAYS-QTY                                      
087300         ,    :XLT00010-STRT-ORD-DAYS-QTY                                 
                      :DN-STRT-ORD-DAYS-QTY                                     
087400         ,    :XLT00010-ACQR-DTE                                          
                      :DN-ACQR-DTE                                              
087500         ,    :XLT00010-RMDL-DTE                                          
                      :DN-RMDL-DTE                                              
087600         ,    :XLT00010-MEDN-AGE-NBR                                      
                      :DN-MEDN-AGE-NBR                                          
087700         ,    :XLT00010-EST-HH-INCM-AMT                                   
                      :DN-EST-HH-INCM-AMT                                       
087800         ,    :XLT00010-QTR-SLS-INCL-DTE                                  
                      :DN-QTR-SLS-INCL-DTE                                      
087900         ,    :XLT00010-SEA-SLS-INCL-DTE                                  
                      :DN-SEA-SLS-INCL-DTE                                      
088000         ,    :XLT00010-EXTD-MALL-NM                                      
                      :DN-EXTD-MALL-NM                                          
088100         ,    :XLT00010-GRND-OPN-DTE                                      
                      :DN-GRND-OPN-DTE                                          
088200         ,    :XLT00010-DIRNS-TXT                                         
                      :DN-DIRNS-TXT                                             
088300         ,    :XLT00010-PRCHG-CRE-IND                                     
                      :DN-PRCHG-CRE-IND                                         
088400         ,    :XLT00010-IN-STR-PRCHG-IND                                  
                      :DN-IN-STR-PRCHG-IND                                      
088500         ,    :XLT00010-LAST-UPD-TMST                                     
088600         )                                                                
088700         END-EXEC                                                         
088800                                                                          
088900         EVALUATE TRUE                                                    
089000             WHEN SQLCODE = ZERO                                          
089100                 ADD 1                TO PV-XLT00010-INSERT-COUNT         
089100                 PERFORM 7031-INSERT-TDCSTMF                              
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
089200             WHEN SQLCODE = -803                                          
089300                 ADD 1                TO PV-XLT00010-DUP-COUNT            
089400             WHEN SQLCODE = -904                                          
089500             WHEN SQLCODE = -911                                          
089600             WHEN SQLCODE = -913                                          
089700                 CONTINUE                                                 
089800                                                                          
089900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
090000                 DISPLAY '**************************************'         
090100                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT_LOC   '         
090200                 DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                  
090300                 DISPLAY '**********************************'             
090400                 PERFORM 9800-SQL-WARNING                                 
090500                                                                          
090600             WHEN SQLCODE < ZERO                                          
090700                 DISPLAY '**************************************'         
090800                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT_LOC  '            
090900                 DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                  
091000                 DISPLAY '**************************************'         
091100                 PERFORM 9900-SQL-ERROR                                   
091200                                                                          
091300         END-EVALUATE                                                     
091400     END-PERFORM                                                          
091500                                                                          
091600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
091700         SQLCODE NOT = ZERO                                               
091800         DISPLAY '**************************************'                 
091900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
092000         DISPLAY 'INSERT TO XLT_LOC                     '                 
092100         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00010  '                   
092200         DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                          
092300         DISPLAY '**************************************'                 
092400         DISPLAY '**************************************'                 
092500         PERFORM 9900-SQL-ERROR                                           
092600     END-IF.                                                              
092700                                                                          
092800 7031-INSERT-TDCSTMF.                                                     
092900     MOVE '7031-INSERT-TDCSTMF'       TO PV-ABEND-PARAGRAPH.              
093500                                                                          
093600     PERFORM                                                              
093700         WITH TEST AFTER                                                  
093800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
093900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
094000                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
094100                                                                          
094200     EXEC SQL                                                             
094300         INSERT INTO TDCSTMF                                              
094400             (STR_NBR,                                                    
094500              MFST_NBR)                                                   
094900             VALUES                                                       
095000             (:XLT00010-LOC-NBR,                                          
095100               1)                                                         
095500         END-EXEC                                                         
095600                                                                          
095700         EVALUATE TRUE                                                    
095800             WHEN SQLCODE = ZERO                                          
089100                 ADD 1                TO PV-DCSTMF-INSERT-COUNT           
096000             WHEN SQLCODE = -803                                          
096100                 ADD 1                TO PV-DCSTMF-DUP-COUNT              
096200             WHEN SQLCODE = -904                                          
096300             WHEN SQLCODE = -911                                          
096400             WHEN SQLCODE = -913                                          
096500                 CONTINUE                                                 
096600                                                                          
096700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
096800                 DISPLAY '**************************************'         
096900                 DISPLAY 'WARNING ISSUED ON INSERT OF TDCSTMF   '         
097000                 DISPLAY 'LOC-NBR     = '  XL037-DCLOC-LOC-NBR            
                       DISPLAY 'EFF-BEG-DTE = '                                 
                       DISPLAY  XL037-DCLOC-EFF-BEG-DTE                         
097100                 DISPLAY '**********************************'             
097200                 PERFORM 9800-SQL-WARNING                                 
097300                                                                          
097400             WHEN SQLCODE < ZERO                                          
097500                 DISPLAY '**************************************'         
097600                 DISPLAY 'ERROR ISSUED ON INSERT OF TDCSTMF  '            
097700                 DISPLAY 'LOC-NBR     = '  XL037-DCLOC-LOC-NBR            
                       DISPLAY 'EFF-BEG-DTE = '                                 
                       DISPLAY  XL037-DCLOC-EFF-BEG-DTE                         
097800                 DISPLAY '**************************************'         
097900                 PERFORM 9900-SQL-ERROR                                   
098000                                                                          
098100         END-EVALUATE                                                     
098200     END-PERFORM                                                          
098300                                                                          
098400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
098500         SQLCODE NOT = ZERO                                               
098600         DISPLAY '**************************************'                 
098700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
098800         DISPLAY 'INSERT TO TDCSTMF                     '                 
098900         DISPLAY 'ERROR ISSUED ON INSERT OF DCSTMF    '                   
099000         DISPLAY 'LOC-NBR     = '  XL037-DCLOC-LOC-NBR                    
               DISPLAY 'EFF-BEG-DTE = '                                         
               DISPLAY  XL037-DCLOC-EFF-BEG-DTE                                 
099100         DISPLAY '**************************************'                 
099300         PERFORM 9900-SQL-ERROR                                           
099400     END-IF.                                                              
099500                                                                          
092800 7035-INSERT-DC-LOC-ASGMT.                                                
092900     MOVE '7035-INSERT-DC-LOC-ASGNT'  TO PV-ABEND-PARAGRAPH.              
093000     MOVE XL037-DCLOC-LOC-NBR         TO XLT00014-LOC-NBR                 
093100     MOVE XL037-DCLOC-EFF-BEG-DTE     TO XLT00014-EFF-BEG-DTE             
093200     MOVE XL037-DCLOC-PO-STRT-DTE     TO XLT00014-PO-STRT-DTE             
093300     MOVE XL037-DCLOC-DC-NBR          TO XLT00014-DC-NBR                  
093400                                                                          
093500                                                                          
093600     PERFORM                                                              
093700         WITH TEST AFTER                                                  
093800         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
093900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
094000                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
094100                                                                          
094200     EXEC SQL                                                             
094300         INSERT INTO XLT_DC_LOC_ASGMT                                     
094400             (LOC_NBR                                                     
094500         ,    EFF_BEG_DTE                                                 
094600         ,    PO_STRT_DTE                                                 
094700         ,    DC_NBR                                                      
094800         )                                                                
094900             VALUES                                                       
095000             (:XLT00014-LOC-NBR                                           
095100         ,    :XLT00014-EFF-BEG-DTE                                       
095200         ,    :XLT00014-PO-STRT-DTE                                       
095300         ,    :XLT00014-DC-NBR                                            
095400         )                                                                
095500         END-EXEC                                                         
095600                                                                          
095700         EVALUATE TRUE                                                    
095800             WHEN SQLCODE = ZERO                                          
095900                 ADD 1                TO PV-XLT00014-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
096000             WHEN SQLCODE = -803                                          
096100                 ADD 1                TO PV-XLT00014-DUP-COUNT            
096200             WHEN SQLCODE = -904                                          
096300             WHEN SQLCODE = -911                                          
096400             WHEN SQLCODE = -913                                          
096500                 CONTINUE                                                 
096600                                                                          
096700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
096800                 DISPLAY '**************************************'         
096900                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00014  '         
097000                 DISPLAY 'LOC-NBR     = '  XL037-DCLOC-LOC-NBR            
                       DISPLAY 'EFF-BEG-DTE = '                                 
                       DISPLAY  XL037-DCLOC-EFF-BEG-DTE                         
097100                 DISPLAY '**********************************'             
097200                 PERFORM 9800-SQL-WARNING                                 
097300                                                                          
097400             WHEN SQLCODE < ZERO                                          
097500                 DISPLAY '**************************************'         
097600                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00014 '            
097700                 DISPLAY 'LOC-NBR     = '  XL037-DCLOC-LOC-NBR            
                       DISPLAY 'EFF-BEG-DTE = '                                 
                       DISPLAY  XL037-DCLOC-EFF-BEG-DTE                         
097800                 DISPLAY '**************************************'         
097900                 PERFORM 9900-SQL-ERROR                                   
098000                                                                          
098100         END-EVALUATE                                                     
098200     END-PERFORM                                                          
098300                                                                          
098400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
098500         SQLCODE NOT = ZERO                                               
098600         DISPLAY '**************************************'                 
098700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
098800         DISPLAY 'INSERT TO XLT_DC_LOC_ASGMT            '                 
098900         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00014  '                   
099000         DISPLAY 'LOC-NBR     = '  XL037-DCLOC-LOC-NBR                    
               DISPLAY 'EFF-BEG-DTE = '                                         
               DISPLAY  XL037-DCLOC-EFF-BEG-DTE                                 
099100         DISPLAY '**************************************'                 
099300         PERFORM 9900-SQL-ERROR                                           
099400     END-IF.                                                              
099500                                                                          
099600 7040-INSERT-STR-GP-TYP.                                                  
099700     MOVE '7040-INSERT-STR-GP-TYP'  TO PV-ABEND-PARAGRAPH.                
099800     MOVE XL037-STR-GP-TYP-CDE      TO XLT00019-STR-GP-TYP-CDE            
099900     MOVE XL037-STR-GP-TYP-NM       TO XLT00019-STR-GP-TYP-NM             
100000                                                                          
100100                                                                          
100200     PERFORM                                                              
100300         WITH TEST AFTER                                                  
100400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
100500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
100600                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
100700                                                                          
100800     EXEC SQL                                                             
100900         INSERT INTO XLT_STR_GP_TYP                                       
101000             (STR_GP_TYP_CDE                                              
101100         ,    STR_GP_TYP_NM                                               
101200         )                                                                
101300             VALUES                                                       
101400             (:XLT00019-STR-GP-TYP-CDE                                    
101500         ,    :XLT00019-STR-GP-TYP-NM                                     
101600         )                                                                
101700         END-EXEC                                                         
101800                                                                          
101900         EVALUATE TRUE                                                    
102000             WHEN SQLCODE = ZERO                                          
102100                 ADD 1                TO PV-XLT00019-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
102200             WHEN SQLCODE = -803                                          
102300                 ADD 1                TO PV-XLT00019-DUP-COUNT            
102400             WHEN SQLCODE = -904                                          
102500             WHEN SQLCODE = -911                                          
102600             WHEN SQLCODE = -913                                          
102700                 CONTINUE                                                 
102800                                                                          
102900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
103000                 DISPLAY '**************************************'         
103100               DISPLAY 'WARNING ISSUED ON INSERT OF XLT00019  '           
103200               DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE             
103300               DISPLAY '**********************************'               
103400               PERFORM 9800-SQL-WARNING                                   
103500                                                                          
103600             WHEN SQLCODE < ZERO                                          
103700               DISPLAY '**************************************'           
103800               DISPLAY 'ERROR ISSUED ON INSERT OF XLT00019 '              
103900               DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE             
104000               DISPLAY '**************************************'           
104100               PERFORM 9900-SQL-ERROR                                     
104200                                                                          
104300         END-EVALUATE                                                     
104400     END-PERFORM                                                          
104500                                                                          
104600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
104700         SQLCODE NOT = ZERO                                               
104800         DISPLAY '**************************************'                 
104900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
105000         DISPLAY 'INSERT TO XLT_STR_GP_TYP              '                 
105100         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00019  '                   
105200         DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE                   
105300         DISPLAY '**************************************'                 
105400         DISPLAY '**************************************'                 
105500         PERFORM 9900-SQL-ERROR                                           
105600     END-IF.                                                              
105700                                                                          
105800 7045-INSERT-STR-GP.                                                      
105900     MOVE '7045-INSERT-STR-GP'      TO PV-ABEND-PARAGRAPH.                
106000     MOVE XL037-SG-STR-GP-TYP-CDE   TO XLT00020-STR-GP-TYP-CDE            
106100     MOVE XL037-SG-STR-GP-ID        TO XLT00020-STR-GP-ID                 
106200     MOVE XL037-SG-STR-GP-NM        TO XLT00020-STR-GP-NM                 
106300     MOVE XL037-SG-ST-CDE           TO XLT00020-ST-CDE                    
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-SG-RPT-FLSH-SLS-IND = SPACE                                 
               MOVE -1 TO DN-RPT-FLSH-SLS-IND                                   
           ELSE                                                                 
               MOVE 0 TO DN-RPT-FLSH-SLS-IND                                    
           END-IF                                                               
106400     MOVE XL037-SG-RPT-FLSH-SLS-IND TO XLT00020-RPT-FLSH-SLS-IND          
106500                                                                          
106600                                                                          
106700     PERFORM                                                              
106800         WITH TEST AFTER                                                  
106900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
107000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
107100                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
107200                                                                          
107300     EXEC SQL                                                             
107400         INSERT INTO XLT_STR_GP                                           
107500             (STR_GP_TYP_CDE                                              
107600         ,    STR_GP_ID                                                   
107700         ,    STR_GP_NM                                                   
107800         ,    ST_CDE                                                      
107900         ,    RPT_FLSH_SLS_IND                                            
108000         )                                                                
108100             VALUES                                                       
108200             (:XLT00020-STR-GP-TYP-CDE                                    
108300         ,    :XLT00020-STR-GP-ID                                         
108400         ,    :XLT00020-STR-GP-NM                                         
108500         ,    :XLT00020-ST-CDE                                            
108600         ,    :XLT00020-RPT-FLSH-SLS-IND                                  
                      :DN-RPT-FLSH-SLS-IND                                      
108700         )                                                                
108800         END-EXEC                                                         
108900                                                                          
109000         EVALUATE TRUE                                                    
109100             WHEN SQLCODE = ZERO                                          
109200                 ADD 1                TO PV-XLT00020-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
109300             WHEN SQLCODE = -803                                          
109400                 ADD 1                TO PV-XLT00020-DUP-COUNT            
109500             WHEN SQLCODE = -904                                          
109600             WHEN SQLCODE = -911                                          
109700             WHEN SQLCODE = -913                                          
109800                 CONTINUE                                                 
109900                                                                          
110000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
110100               DISPLAY '**************************************'           
110200               DISPLAY 'WARNING ISSUED ON INSERT OF XLT00020  '           
110300               DISPLAY 'STR-GP-TYP =' XL037-SG-STR-GP-TYP-CDE             
                     DISPLAY 'STR-GP-ID  =' XL037-SG-STR-GP-ID                  
110400                DISPLAY '**********************************'              
110500               PERFORM 9800-SQL-WARNING                                   
110600                                                                          
110700             WHEN SQLCODE < ZERO                                          
110800               DISPLAY '**************************************'           
110900               DISPLAY 'ERROR ISSUED ON INSERT OF XLT00020 '              
110300               DISPLAY 'STR-GP-TYP =' XL037-SG-STR-GP-TYP-CDE             
                     DISPLAY 'STR-GP-ID  =' XL037-SG-STR-GP-ID                  
111100               DISPLAY '**************************************'           
111200               PERFORM 9900-SQL-ERROR                                     
111300                                                                          
111400         END-EVALUATE                                                     
111500     END-PERFORM                                                          
111600                                                                          
111700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
111800         SQLCODE NOT = ZERO                                               
111900         DISPLAY '**************************************'                 
112000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
112100         DISPLAY 'INSERT TO XLT_STR_GP                  '                 
112200         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00020  '                   
110300         DISPLAY 'STR-GP-TYP =' XL037-SG-STR-GP-TYP-CDE                   
               DISPLAY 'STR-GP-ID  =' XL037-SG-STR-GP-ID                        
112400         DISPLAY '**************************************'                 
112500         DISPLAY '**************************************'                 
112600         PERFORM 9900-SQL-ERROR                                           
112700     END-IF.                                                              
112800                                                                          
112900 7050-INSERT-STR-GP-DTE.                                                  
113000     MOVE '7050-INSERT-STR-GP-DTE'  TO PV-ABEND-PARAGRAPH.                
113100     MOVE XL037-SGD-STR-GP-TYP-CDE  TO XLT00021-STR-GP-TYP-CDE            
113200     MOVE XL037-SGD-STR-GP-ID       TO XLT00021-STR-GP-ID                 
113300     MOVE XL037-SGD-EFF-BEG-DTE     TO XLT00021-EFF-BEG-DTE               
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-SGD-EFF-END-DTE = SPACE                                     
              OR XL037-SGD-EFF-END-DTE = '9999-09-09'                           
               MOVE -1 TO DN-EFF-END-DTE                                        
           ELSE                                                                 
               MOVE 0 TO DN-EFF-END-DTE                                         
           END-IF                                                               
113400     MOVE XL037-SGD-EFF-END-DTE     TO XLT00021-EFF-END-DTE               
113500     MOVE XL037-SGD-EFF-STR-GP-ID   TO XLT00021-EFF-STR-GP-ID             
113600                                                                          
113700                                                                          
113800     PERFORM                                                              
113900         WITH TEST AFTER                                                  
114000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
114100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
114200                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
114300                                                                          
114400     EXEC SQL                                                             
114500         INSERT INTO XLT_STR_GP_DTE                                       
114600             (STR_GP_TYP_CDE                                              
114700         ,    STR_GP_ID                                                   
114800         ,    EFF_BEG_DTE                                                 
114900         ,    EFF_END_DTE                                                 
115000         ,    EFF_STR_GP_ID                                               
115100         )                                                                
115200             VALUES                                                       
115300             (:XLT00021-STR-GP-TYP-CDE                                    
115400         ,    :XLT00021-STR-GP-ID                                         
115500         ,    :XLT00021-EFF-BEG-DTE                                       
115600         ,    :XLT00021-EFF-END-DTE                                       
                      :DN-EFF-END-DTE                                           
115700         ,    :XLT00021-EFF-STR-GP-ID                                     
115800         )                                                                
115900         END-EXEC                                                         
116000                                                                          
116100         EVALUATE TRUE                                                    
116200             WHEN SQLCODE = ZERO                                          
116300                 ADD 1                TO PV-XLT00021-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
116400             WHEN SQLCODE = -803                                          
116500                 ADD 1                TO PV-XLT00021-DUP-COUNT            
116600             WHEN SQLCODE = -904                                          
116700             WHEN SQLCODE = -911                                          
116800             WHEN SQLCODE = -913                                          
116900                 CONTINUE                                                 
117000                                                                          
117100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
117200                 DISPLAY '**************************************'         
117300               DISPLAY 'WARNING ISSUED ON INSERT OF XLT00021  '           
117400               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY  XL037-SGD-STR-GP-TYP-CDE                          
                     DISPLAY 'STR-GP-ID      =' XL037-SGD-STR-GP-ID             
                     DISPLAY 'EFF-BEG-DTE    =' XL037-SGD-EFF-BEG-DTE           
117500               DISPLAY '**********************************'               
117600               PERFORM 9800-SQL-WARNING                                   
117700                                                                          
117800             WHEN SQLCODE < ZERO                                          
117900               DISPLAY '**************************************'           
118000               DISPLAY 'ERROR ISSUED ON INSERT OF XLT00021 '              
117400               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY  XL037-SGD-STR-GP-TYP-CDE                          
                     DISPLAY 'STR-GP-ID      =' XL037-SGD-STR-GP-ID             
                     DISPLAY 'EFF-BEG-DTE    =' XL037-SGD-EFF-BEG-DTE           
118200               DISPLAY '**************************************'           
118300               PERFORM 9900-SQL-ERROR                                     
118400                                                                          
118500         END-EVALUATE                                                     
118600     END-PERFORM                                                          
118700                                                                          
118800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
118900         SQLCODE NOT = ZERO                                               
119000         DISPLAY '**************************************'                 
119100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
119200         DISPLAY 'INSERT TO XLT_STR_GP_DTE              '                 
119300         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00021  '                   
117400         DISPLAY 'STR-GP-TYP-CDE ='                                       
               DISPLAY  XL037-SGD-STR-GP-TYP-CDE                                
               DISPLAY 'STR-GP-ID      =' XL037-SGD-STR-GP-ID                   
               DISPLAY 'EFF-BEG-DTE    =' XL037-SGD-EFF-BEG-DTE                 
119500         DISPLAY '**************************************'                 
119600         DISPLAY '**************************************'                 
119700         PERFORM 9900-SQL-ERROR                                           
119800     END-IF.                                                              
119900                                                                          
120000 7055-INSERT-STR-GP-MBSHP.                                                
120100     MOVE '7055-INSERT-STR-GP-MBSHP'   TO PV-ABEND-PARAGRAPH.             
120200     MOVE XL037-SGM-STR-GP-TYP-CDE  TO XLT00018-STR-GP-TYP-CDE            
120300     MOVE XL037-SGM-STR-GP-ID       TO XLT00018-STR-GP-ID                 
120400     MOVE XL037-SGM-LOC-NBR         TO XLT00018-LOC-NBR                   
120500     MOVE XL037-SGM-EFF-BEG-DTE     TO XLT00018-EFF-BEG-DTE               
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-SGM-EFF-END-DTE = SPACE                                     
              OR XL037-SGM-EFF-END-DTE = '9999-09-09'                           
               MOVE -1 TO DN-EFF-END-DTE                                        
           ELSE                                                                 
               MOVE 0 TO DN-EFF-END-DTE                                         
           END-IF                                                               
120600     MOVE XL037-SGM-EFF-END-DTE     TO XLT00018-EFF-END-DTE               
120700                                                                          
120800                                                                          
120900     PERFORM                                                              
121000         WITH TEST AFTER                                                  
121100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
121200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
121300                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
121400                                                                          
121500     EXEC SQL                                                             
121600         INSERT INTO XLT_STR_GP_MBSHP                                     
121700             (STR_GP_TYP_CDE                                              
121800         ,    STR_GP_ID                                                   
121900         ,    LOC_NBR                                                     
122000         ,    EFF_BEG_DTE                                                 
122100         ,    EFF_END_DTE                                                 
122200         )                                                                
122300             VALUES                                                       
122400             (:XLT00018-STR-GP-TYP-CDE                                    
122500         ,    :XLT00018-STR-GP-ID                                         
122600         ,    :XLT00018-LOC-NBR                                           
122700         ,    :XLT00018-EFF-BEG-DTE                                       
122800         ,    :XLT00018-EFF-END-DTE                                       
                       :DN-EFF-END-DTE                                          
122900         )                                                                
123000         END-EXEC                                                         
123100                                                                          
123200         EVALUATE TRUE                                                    
123300             WHEN SQLCODE = ZERO                                          
123400                 ADD 1                TO PV-XLT00018-INSERT-COUNT         
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
123500             WHEN SQLCODE = -803                                          
123600                 ADD 1                TO PV-XLT00018-DUP-COUNT            
123700             WHEN SQLCODE = -904                                          
123800             WHEN SQLCODE = -911                                          
123900             WHEN SQLCODE = -913                                          
124000                 CONTINUE                                                 
124100                                                                          
124200             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
124300               DISPLAY '**************************************'           
124400               DISPLAY 'WARNING ISSUED ON INSERT OF XLT00018  '           
124500               DISPLAY 'STR-GP-TYP-CDE=' XL037-SGM-STR-GP-TYP-CDE         
                     DISPLAY 'STR-GP-ID     =' XL037-SGM-STR-GP-ID              
                     DISPLAY 'LOC-NBR       =' XL037-SGM-LOC-NBR                
                     DISPLAY 'EFF-BEG-DTE   =' XL037-SGM-EFF-BEG-DTE            
124600               DISPLAY '**********************************'               
124700               PERFORM 9800-SQL-WARNING                                   
124800                                                                          
124900             WHEN SQLCODE < ZERO                                          
125000               DISPLAY '**************************************'           
125100               DISPLAY 'ERROR ISSUED ON INSERT OF XLT00018 '              
124500               DISPLAY 'STR-GP-TYP-CDE=' XL037-SGM-STR-GP-TYP-CDE         
                     DISPLAY 'STR-GP-ID     =' XL037-SGM-STR-GP-ID              
                     DISPLAY 'LOC-NBR       =' XL037-SGM-LOC-NBR                
                     DISPLAY 'EFF-BEG-DTE   =' XL037-SGM-EFF-BEG-DTE            
125300               DISPLAY '**************************************'           
125400               PERFORM 9900-SQL-ERROR                                     
125500                                                                          
125600         END-EVALUATE                                                     
125700     END-PERFORM                                                          
125800                                                                          
125900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
126000         SQLCODE NOT = ZERO                                               
126100         DISPLAY '**************************************'                 
126200         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
126300         DISPLAY 'INSERT TO XLT00018                    '                 
126400         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00018  '                   
124500         DISPLAY 'STR-GP-TYP-CDE=' XL037-SGM-STR-GP-TYP-CDE               
               DISPLAY 'STR-GP-ID     =' XL037-SGM-STR-GP-ID                    
               DISPLAY 'LOC-NBR       =' XL037-SGM-LOC-NBR                      
               DISPLAY 'EFF-BEG-DTE   =' XL037-SGM-EFF-BEG-DTE                  
126700         DISPLAY '**************************************'                 
126800         PERFORM 9900-SQL-ERROR                                           
126900     END-IF.                                                              
127000                                                                          
073300 7060-INSERT-LOC-WH.                                                      
073400     MOVE '7060-INSERT-LOC-WH'    TO PV-ABEND-PARAGRAPH.                  
073900     MOVE XL037-LOC-NBR           TO XLT00010-LOC-NBR                     
                                                                                
      *****   ALWAYS MOVE NULLS TO DIST-NBR FIELD****                           
           MOVE PV-DIST-NBR             TO XLT00010-DIST-NBR                    
           MOVE -1 TO DN-DIST-NBR                                               
                                                                                
      *****   ALWAYS MOVE NULLS TO REPLT-STR-NBR FIELD****                      
           MOVE PV-REPLT-STR-NBR        TO XLT00010-REPLT-STR-NBR               
           MOVE -1 TO DN-REPLT-STR-NBR                                          
                                                                                
073900     MOVE XL037-LOC-LOC-TYP-CDE   TO XLT00010-LOC-TYP-CDE                 
074300     MOVE XL037-LOC-NM            TO XLT00010-LOC-NM                      
074400     MOVE XL037-LOC-5-ABBR-NM     TO XLT00010-LOC-5-ABBR-NM               
074500     MOVE XL037-LOC-LNE-1-ADDR    TO XLT00010-LNE-1-ADDR                  
074600     MOVE XL037-LOC-LNE-2-ADDR    TO XLT00010-LNE-2-ADDR                  
074700     MOVE XL037-LOC-CTY-NME       TO XLT00010-CTY-NM                      
074800     MOVE XL037-LOC-ST-CDE        TO XLT00010-ST-CDE                      
074900     MOVE XL037-LOC-ZIP-10-CDE    TO XLT00010-ZIP-10-CDE                  
075000     MOVE XL037-LOC-OPN-DTE       TO XLT00010-OPN-DTE                     
075100     MOVE XL037-LOC-CLO-DTE       TO XLT00010-CLO-DTE                     
                                                                                
      *****   ALWAYS MOVE NULLS TO STD-TM-ZN-CDE    ****                        
           MOVE -1 TO DN-STD-TM-ZN-CDE                                          
           MOVE PV-STD-TM-ZN-CDE        TO XLT00010-STD-TM-ZN-CDE               
                                                                                
      *****   ALWAYS MOVE NULLS TO PHN-NBR FIELD    ****                        
           MOVE -1 TO DN-PHN-NBR                                                
           MOVE PV-PHN-NBR              TO XLT00010-PHN-NBR                     
                                                                                
      *****   ALWAYS MOVE NULLS TO MGR-NM  FIELD    ****                        
           MOVE -1 TO DN-MGR-NM                                                 
           MOVE PV-MGR-NM               TO XLT00010-MGR-NM                      
                                                                                
      *****   ALWAYS MOVE NULLS TO FINCL-CLO-DTE    ****                        
           MOVE -1 TO DN-FINCL-CLO-DTE                                          
           MOVE PV-FINCL-CLO-DTE        TO XLT00010-FINCL-CLO-DTE               
                                                                                
      *****   ALWAYS MOVE NULLS TO MN-SLS-INCL-DTE  ****                        
           MOVE -1 TO DN-MN-SLS-INCL-DTE                                        
           MOVE PV-MN-SLS-INCL-DTE      TO XLT00010-MN-SLS-INCL-DTE             
                                                                                
      *****   ALWAYS MOVE NULLS TO YR-SLS-INCL-DTE  ****                        
           MOVE -1 TO DN-YR-SLS-INCL-DTE                                        
           MOVE PV-YR-SLS-INCL-DTE      TO XLT00010-YR-SLS-INCL-DTE             
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-OCPNC-DTE = SPACE                                       
              OR XL037-LOC-OCPNC-DTE = '9999-09-09'                             
               MOVE -1 TO DN-OCPNC-DTE                                          
           ELSE                                                                 
               MOVE 0 TO DN-OCPNC-DTE                                           
           END-IF                                                               
           MOVE XL037-LOC-OCPNC-DTE     TO XLT00010-OCPNC-DTE                   
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-DST-IND = SPACE                                         
               MOVE -1 TO DN-DST-IND                                            
           ELSE                                                                 
               MOVE 0 TO DN-DST-IND                                             
           END-IF                                                               
076400     MOVE XL037-LOC-DST-IND       TO XLT00010-DST-IND                     
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-E-BUS-IND = SPACE                                       
               MOVE -1 TO DN-E-BUS-IND                                          
           ELSE                                                                 
               MOVE 0 TO DN-E-BUS-IND                                           
           END-IF                                                               
076500     MOVE XL037-LOC-E-BUS-IND     TO XLT00010-E-BUS-IND                   
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-IN-STR-PRCHG-IND = SPACE                                
               MOVE -1 TO DN-IN-STR-PRCHG-IND                                   
           ELSE                                                                 
               MOVE 0 TO DN-IN-STR-PRCHG-IND                                    
           END-IF                                                               
078800     MOVE XL037-LOC-IN-STR-PRCHG-IND                                      
078900                                  TO XLT00010-IN-STR-PRCHG-IND            
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-PRCHG-CRE-IND = SPACE                                   
               MOVE -1 TO DN-PRCHG-CRE-IND                                      
           ELSE                                                                 
               MOVE 0 TO DN-PRCHG-CRE-IND                                       
           END-IF                                                               
079000     MOVE XL037-LOC-PRCHG-CRE-IND TO XLT00010-PRCHG-CRE-IND               
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-LOC-10-ABBR-NM = SPACE                                  
               MOVE -1 TO DN-LOC-10-ABBR-NM                                     
           ELSE                                                                 
               MOVE 0 TO DN-LOC-10-ABBR-NM                                      
           END-IF                                                               
075200     MOVE XL037-LOC-LOC-10-ABBR-NM                                        
075300                                  TO XLT00010-LOC-10-ABBR-NM              
                                                                                
      *****   ALWAYS MOVE NULLS TO POS-RGST-BNK-QTY  ****                       
           MOVE -1 TO DN-POS-RGST-BNK-QTY                                       
           MOVE PV-POS-RGST-BNK-QTY     TO XLT00010-POS-RGST-BNK-QTY            
                                                                                
      *****   ALWAYS MOVE NULLS TO STR-FMT-CDE   ****                           
           MOVE -1 TO DN-STR-FMT-CDE                                            
           MOVE PV-STR-FMT-CDE          TO XLT00010-STR-FMT-CDE                 
                                                                                
      *****   ALWAYS MOVE NULLS TO TOT-SLG-SQ-FTG-QTY  ****                     
           MOVE -1 TO DN-TOT-SLG-SQ-FTG-QTY                                     
           MOVE PV-TOT-SLG-SQ-FTG-QTY   TO XLT00010-TOT-SLG-SQ-FTG-QTY          
                                                                                
      *****   ALWAYS MOVE NULLS TO SLS-INCL-DTE-CDE  ****                       
           MOVE -1 TO DN-SLS-INCL-DTE-CDE                                       
           MOVE PV-SLS-INCL-DTE-CDE     TO XLT00010-SLS-INCL-DTE-CDE            
                                                                                
      *****   ALWAYS MOVE NULLS TO TOT-SQ-FTG-QTY  ****                         
           MOVE -1 TO DN-TOT-SQ-FTG-QTY                                         
           MOVE PV-TOT-SQ-FTG-QTY       TO XLT00010-TOT-SQ-FTG-QTY              
                                                                                
      *****   ALWAYS MOVE NULLS TO STP-ORD-DAYS-QTY  ****                       
           MOVE -1 TO DN-STP-ORD-DAYS-QTY                                       
           MOVE PV-STP-ORD-DAYS-QTY     TO XLT00010-STP-ORD-DAYS-QTY            
                                                                                
      *****   ALWAYS MOVE NULLS TO STRT-ORD-DAYS-QTY  ****                      
           MOVE -1 TO DN-STRT-ORD-DAYS-QTY                                      
           MOVE PV-STRT-ORD-DAYS-QTY     TO XLT00010-STRT-ORD-DAYS-QTY          
                                                                                
      *****   ALWAYS MOVE NULLS TO ACQR-DTE  ****                               
           MOVE -1 TO DN-ACQR-DTE                                               
           MOVE PV-ACQR-DTE             TO XLT00010-ACQR-DTE                    
                                                                                
      *****   ALWAYS MOVE NULLS TO RMDL-DTE  ****                               
           MOVE -1 TO DN-RMDL-DTE                                               
           MOVE PV-RMDL-DTE             TO XLT00010-RMDL-DTE                    
                                                                                
      *****   ALWAYS MOVE NULLS TO MEDN-AGE-NBR  ****                           
           MOVE -1 TO DN-MEDN-AGE-NBR                                           
           MOVE PV-MEDN-AGE-NBR         TO XLT00010-MEDN-AGE-NBR                
                                                                                
      *****   ALWAYS MOVE NULLS TO EST-HH-INCM-AMT  ****                        
           MOVE -1 TO DN-EST-HH-INCM-AMT                                        
           MOVE PV-EST-HH-INCM-AMT      TO XLT00010-EST-HH-INCM-AMT             
                                                                                
      *****   ALWAYS MOVE NULLS TO QTR-SLS-INCL-DTE   ****                      
           MOVE -1 TO DN-QTR-SLS-INCL-DTE                                       
           MOVE PV-QTR-SLS-INCL-DTE     TO XLT00010-QTR-SLS-INCL-DTE            
                                                                                
      *****   ALWAYS MOVE NULLS TO SEA-SLS-INCL-DTE   ****                      
           MOVE -1 TO DN-SEA-SLS-INCL-DTE                                       
           MOVE PV-SEA-SLS-INCL-DTE     TO XLT00010-SEA-SLS-INCL-DTE            
                                                                                
      *****   ALWAYS MOVE NULLS TO EXTD-MALL-NM    ****                         
           MOVE -1 TO DN-EXTD-MALL-NM                                           
           MOVE PV-EXTD-MALL-NM         TO XLT00010-EXTD-MALL-NM                
                                                                                
      *****   ALWAYS MOVE NULLS TO GRND-OPN-DTE FIELD  ****                     
           MOVE -1 TO DN-GRND-OPN-DTE                                           
           MOVE PV-GRND-OPN-DTE         TO XLT00010-GRND-OPN-DTE                
                                                                                
      *****   ALWAYS MOVE NULLS TO DIRNS-TXT FIELD  ****                        
           MOVE -1 TO DN-DIRNS-TXT                                              
           MOVE PV-DIRNS-TXT-LEN        TO XLT00010-DIRNS-TXT-LEN               
           MOVE PV-DIRNS-TXT            TO XLT00010-DIRNS-TXT-TEXT              
                                                                                
           PERFORM 2150-SET-CURRENT-TMST                                        
           MOVE PV-CURRENT-TMST         TO XLT00010-LAST-UPD-TMST               
                                                                                
079100                                                                          
079200     PERFORM                                                              
079300         WITH TEST AFTER                                                  
079400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
079500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
079600                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
079700                                                                          
079800     EXEC SQL                                                             
079900         INSERT INTO XLT_LOC                                              
080300             (LOC_NBR                                                     
               ,    REPLT_STR_NBR                                               
               ,    DIST_NBR                                                    
080300         ,    LOC_TYP_CDE                                                 
               ,    STR_FMT_CDE                                                 
               ,    STD_TM_ZN_CDE                                               
080600         ,    LOC_NM                                                      
080700         ,    LOC_5_ABBR_NM                                               
080800         ,    LNE_1_ADDR                                                  
080900         ,    LNE_2_ADDR                                                  
081000         ,    CTY_NM                                                      
081100         ,    ST_CDE                                                      
081200         ,    ZIP_10_CDE                                                  
081300         ,    OPN_DTE                                                     
081400         ,    CLO_DTE                                                     
               ,    PHN_NBR                                                     
               ,    MGR_NM                                                      
               ,    FINCL_CLO_DTE                                               
               ,    MN_SLS_INCL_DTE                                             
               ,    YR_SLS_INCL_DTE                                             
081500         ,    LOC_10_ABBR_NM                                              
082100         ,    OCPNC_DTE                                                   
               ,    POS_RGST_BNK_QTY                                            
082300         ,    DST_IND                                                     
082400         ,    E_BUS_IND                                                   
               ,    SLS_INCL_DTE_CDE                                            
               ,    TOT_SLG_SQ_FTG_QTY                                          
               ,    TOT_SQ_FTG_QTY                                              
               ,    STP_ORD_DAYS_QTY                                            
               ,    STRT_ORD_DAYS_QTY                                           
               ,    ACQR_DTE                                                    
               ,    RMDL_DTE                                                    
               ,    MEDN_AGE_NBR                                                
               ,    EST_HH_INCM_AMT                                             
               ,    QTR_SLS_INCL_DTE                                            
               ,    SEA_SLS_INCL_DTE                                            
               ,    EXTD_MALL_NM                                                
               ,    GRND_OPN_DTE                                                
               ,    DIRNS_TXT                                                   
083900         ,    PRCHG_CRE_IND                                               
084000         ,    IN_STR_PRCHG_IND                                            
               ,    LAST_UPD_TMST                                               
084200         )                                                                
084300             VALUES                                                       
084700             (:XLT00010-LOC-NBR                                           
               ,    :XLT00010-REPLT-STR-NBR                                     
                       :DN-REPLT-STR-NBR                                        
               ,    :XLT00010-DIST-NBR                                          
                       :DN-DIST-NBR                                             
084700         ,    :XLT00010-LOC-TYP-CDE                                       
               ,    :XLT00010-STR-FMT-CDE                                       
                       :DN-STR-FMT-CDE                                          
               ,    :XLT00010-STD-TM-ZN-CDE                                     
                       :DN-STD-TM-ZN-CDE                                        
085000         ,    :XLT00010-LOC-NM                                            
085100         ,    :XLT00010-LOC-5-ABBR-NM                                     
085200         ,    :XLT00010-LNE-1-ADDR                                        
085300         ,    :XLT00010-LNE-2-ADDR                                        
085400         ,    :XLT00010-CTY-NM                                            
085500         ,    :XLT00010-ST-CDE                                            
085600         ,    :XLT00010-ZIP-10-CDE                                        
085700         ,    :XLT00010-OPN-DTE                                           
085800         ,    :XLT00010-CLO-DTE                                           
               ,    :XLT00010-PHN-NBR                                           
                       :DN-PHN-NBR                                              
               ,    :XLT00010-MGR-NM                                            
                       :DN-MGR-NM                                               
               ,    :XLT00010-FINCL-CLO-DTE                                     
                       :DN-FINCL-CLO-DTE                                        
               ,    :XLT00010-MN-SLS-INCL-DTE                                   
                       :DN-MN-SLS-INCL-DTE                                      
               ,    :XLT00010-YR-SLS-INCL-DTE                                   
                       :DN-YR-SLS-INCL-DTE                                      
085900         ,    :XLT00010-LOC-10-ABBR-NM                                    
                       :DN-LOC-10-ABBR-NM                                       
086500         ,    :XLT00010-OCPNC-DTE                                         
                       :DN-OCPNC-DTE                                            
086500         ,    :XLT00010-POS-RGST-BNK-QTY                                  
                       :DN-POS-RGST-BNK-QTY                                     
086700         ,    :XLT00010-DST-IND                                           
                       :DN-DST-IND                                              
086800         ,    :XLT00010-E-BUS-IND                                         
                       :DN-E-BUS-IND                                            
               ,    :XLT00010-SLS-INCL-DTE-CDE                                  
                       :DN-SLS-INCL-DTE-CDE                                     
               ,    :XLT00010-TOT-SLG-SQ-FTG-QTY                                
                       :DN-TOT-SLG-SQ-FTG-QTY                                   
               ,    :XLT00010-TOT-SQ-FTG-QTY                                    
                       :DN-TOT-SQ-FTG-QTY                                       
               ,    :XLT00010-STP-ORD-DAYS-QTY                                  
                       :DN-STP-ORD-DAYS-QTY                                     
               ,    :XLT00010-STRT-ORD-DAYS-QTY                                 
                       :DN-STRT-ORD-DAYS-QTY                                    
               ,    :XLT00010-ACQR-DTE                                          
                       :DN-ACQR-DTE                                             
               ,    :XLT00010-RMDL-DTE                                          
                       :DN-RMDL-DTE                                             
               ,    :XLT00010-MEDN-AGE-NBR                                      
                       :DN-MEDN-AGE-NBR                                         
               ,    :XLT00010-EST-HH-INCM-AMT                                   
                       :DN-EST-HH-INCM-AMT                                      
               ,    :XLT00010-QTR-SLS-INCL-DTE                                  
                       :DN-QTR-SLS-INCL-DTE                                     
               ,    :XLT00010-SEA-SLS-INCL-DTE                                  
                       :DN-SEA-SLS-INCL-DTE                                     
               ,    :XLT00010-EXTD-MALL-NM                                      
                       :DN-EXTD-MALL-NM                                         
               ,    :XLT00010-GRND-OPN-DTE                                      
                       :DN-GRND-OPN-DTE                                         
               ,    :XLT00010-DIRNS-TXT                                         
                       :DN-DIRNS-TXT                                            
088300         ,    :XLT00010-PRCHG-CRE-IND                                     
                       :DN-PRCHG-CRE-IND                                        
088400         ,    :XLT00010-IN-STR-PRCHG-IND                                  
                       :DN-IN-STR-PRCHG-IND                                     
088300         ,    :XLT00010-LAST-UPD-TMST                                     
088600         )                                                                
088700         END-EXEC                                                         
088800                                                                          
088900         EVALUATE TRUE                                                    
089000             WHEN SQLCODE = ZERO                                          
089100                 ADD 1           TO PV-XLT00022-INSRT-WHLOC-CNT           
089100                 PERFORM 7031-INSERT-TDCSTMF                              
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
089200             WHEN SQLCODE = -803                                          
089300                 ADD 1           TO PV-XLT00022-DUP-WHLOC-CNT             
089400             WHEN SQLCODE = -904                                          
089500             WHEN SQLCODE = -911                                          
089600             WHEN SQLCODE = -913                                          
089700                 CONTINUE                                                 
089800                                                                          
089900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
090000                 DISPLAY '**************************************'         
090100                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00010  '         
090200                 DISPLAY 'WH-NBR      = '  XL037-LOC-NBR                  
090300                 DISPLAY '**********************************'             
090400                 PERFORM 9800-SQL-WARNING                                 
090500                                                                          
090600             WHEN SQLCODE < ZERO                                          
090700                 DISPLAY '**************************************'         
090800                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00010 '            
090900                 DISPLAY 'WH-NBR      = '  XL037-LOC-NBR                  
091000                 DISPLAY '**************************************'         
091100                 PERFORM 9900-SQL-ERROR                                   
091200                                                                          
091300         END-EVALUATE                                                     
091400     END-PERFORM                                                          
091500                                                                          
091600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
091700         SQLCODE NOT = ZERO                                               
091800         DISPLAY '**************************************'                 
091900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
092000         DISPLAY 'INSERT TO XLT_LOC                     '                 
092100         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00010  '                   
092200         DISPLAY 'WH-NBR      = '  XL037-LOC-NBR                          
092300         DISPLAY '**************************************'                 
092400         DISPLAY '**************************************'                 
092500         PERFORM 9900-SQL-ERROR                                           
092600     END-IF.                                                              
092700                                                                          
073300 7065-INSERT-OUT-LOC.                                                     
073400     MOVE '7065-INSERT-OUT-LOC'   TO PV-ABEND-PARAGRAPH.                  
073900     MOVE XL037-LOC-NBR           TO XLT00010-LOC-NBR                     
                                                                                
      *****   ALWAYS MOVE NULLS TO REPLT-STR-NBR FIELD****                      
           MOVE PV-REPLT-STR-NBR        TO XLT00010-REPLT-STR-NBR               
           MOVE -1 TO DN-REPLT-STR-NBR                                          
                                                                                
      *****   ALWAYS MOVE NULLS TO DIST-NBR FIELD****                           
           MOVE PV-DIST-NBR             TO XLT00010-DIST-NBR                    
           MOVE -1 TO DN-DIST-NBR                                               
                                                                                
073900     MOVE XL037-LOC-LOC-TYP-CDE   TO XLT00010-LOC-TYP-CDE                 
074300     MOVE XL037-LOC-NM            TO XLT00010-LOC-NM                      
074400     MOVE XL037-LOC-5-ABBR-NM     TO XLT00010-LOC-5-ABBR-NM               
074500     MOVE XL037-LOC-LNE-1-ADDR    TO XLT00010-LNE-1-ADDR                  
074600     MOVE XL037-LOC-LNE-2-ADDR    TO XLT00010-LNE-2-ADDR                  
074700     MOVE XL037-LOC-CTY-NME       TO XLT00010-CTY-NM                      
074800     MOVE XL037-LOC-ST-CDE        TO XLT00010-ST-CDE                      
074900     MOVE XL037-LOC-ZIP-10-CDE    TO XLT00010-ZIP-10-CDE                  
075000     MOVE XL037-LOC-OPN-DTE       TO XLT00010-OPN-DTE                     
075100     MOVE XL037-LOC-CLO-DTE       TO XLT00010-CLO-DTE                     
                                                                                
      *****   ALWAYS MOVE NULLS TO STD-TM-ZN-CDE    ****                        
           MOVE -1 TO DN-STD-TM-ZN-CDE                                          
           MOVE PV-STD-TM-ZN-CDE        TO XLT00010-STD-TM-ZN-CDE               
                                                                                
      *****   ALWAYS MOVE NULLS TO LOC-10-ABBR-NM   ****                        
           MOVE -1 TO DN-LOC-10-ABBR-NM                                         
           MOVE PV-LOC-10-ABBR-NM       TO XLT00010-LOC-10-ABBR-NM              
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-PHN-NBR = SPACE                                         
               MOVE -1 TO DN-PHN-NBR                                            
           ELSE                                                                 
               MOVE 0 TO DN-PHN-NBR                                             
           END-IF                                                               
           MOVE XL037-LOC-PHN-NBR       TO XLT00010-PHN-NBR                     
                                                                                
      *****   ALWAYS MOVE NULLS TO MGR-NM  FIELD    ****                        
           MOVE -1 TO DN-MGR-NM                                                 
           MOVE PV-MGR-NM               TO XLT00010-MGR-NM                      
                                                                                
      *****   ALWAYS MOVE NULLS TO FINCL-CLO-DTE    ****                        
           MOVE -1 TO DN-FINCL-CLO-DTE                                          
           MOVE PV-FINCL-CLO-DTE        TO XLT00010-FINCL-CLO-DTE               
                                                                                
      *****   ALWAYS MOVE NULLS TO DST-IND  ****                                
           MOVE -1 TO DN-DST-IND                                                
           MOVE PV-DST-IND              TO XLT00010-DST-IND                     
                                                                                
      *****   ALWAYS MOVE NULLS TO E-BUS-IND   ****                             
           MOVE -1 TO DN-E-BUS-IND                                              
           MOVE PV-E-BUS-IND            TO XLT00010-E-BUS-IND                   
                                                                                
      *****   ALWAYS MOVE NULLS TO MN-SLS-INCL-DTE  ****                        
           MOVE -1 TO DN-MN-SLS-INCL-DTE                                        
           MOVE PV-MN-SLS-INCL-DTE      TO XLT00010-MN-SLS-INCL-DTE             
                                                                                
      *****   ALWAYS MOVE NULLS TO YR-SLS-INCL-DTE  ****                        
           MOVE -1 TO DN-YR-SLS-INCL-DTE                                        
           MOVE PV-YR-SLS-INCL-DTE      TO XLT00010-YR-SLS-INCL-DTE             
                                                                                
      *****   ALWAYS MOVE NULLS TO OCPNC-DTE   ****                             
           MOVE -1 TO DN-OCPNC-DTE                                              
           MOVE PV-OCPNC-DTE            TO XLT00010-OCPNC-DTE                   
                                                                                
      *****   ALWAYS MOVE NULLS TO POS-RGST-BNK-QTY  ****                       
           MOVE -1 TO DN-POS-RGST-BNK-QTY                                       
           MOVE PV-POS-RGST-BNK-QTY     TO XLT00010-POS-RGST-BNK-QTY            
                                                                                
      *****   ALWAYS MOVE NULLS TO STR-FMT-CDE   ****                           
           MOVE -1 TO DN-STR-FMT-CDE                                            
           MOVE PV-STR-FMT-CDE          TO XLT00010-STR-FMT-CDE                 
                                                                                
      *****   ALWAYS MOVE NULLS TO SLS-INCL-DTE-CDE  ****                       
           MOVE -1 TO DN-SLS-INCL-DTE-CDE                                       
           MOVE PV-SLS-INCL-DTE-CDE     TO XLT00010-SLS-INCL-DTE-CDE            
                                                                                
      *****   ALWAYS MOVE NULLS TO TOT-SLG-SQ-FTG-QTY  ****                     
           MOVE -1 TO DN-TOT-SLG-SQ-FTG-QTY                                     
           MOVE PV-TOT-SLG-SQ-FTG-QTY   TO XLT00010-TOT-SLG-SQ-FTG-QTY          
                                                                                
      *****   ALWAYS MOVE NULLS TO TOT-SQ-FTG-QTY  ****                         
           MOVE -1 TO DN-TOT-SQ-FTG-QTY                                         
           MOVE PV-TOT-SQ-FTG-QTY       TO XLT00010-TOT-SQ-FTG-QTY              
                                                                                
      *****   ALWAYS MOVE NULLS TO STP-ORD-DAYS-QTY  ****                       
           MOVE -1 TO DN-STP-ORD-DAYS-QTY                                       
           MOVE PV-STP-ORD-DAYS-QTY     TO XLT00010-STP-ORD-DAYS-QTY            
                                                                                
      *****   ALWAYS MOVE NULLS TO STRT-ORD-DAYS-QTY  ****                      
           MOVE -1 TO DN-STRT-ORD-DAYS-QTY                                      
           MOVE PV-STRT-ORD-DAYS-QTY     TO XLT00010-STRT-ORD-DAYS-QTY          
                                                                                
      *****   ALWAYS MOVE NULLS TO ACQR-DTE  ****                               
           MOVE -1 TO DN-ACQR-DTE                                               
           MOVE PV-ACQR-DTE             TO XLT00010-ACQR-DTE                    
                                                                                
      *****   ALWAYS MOVE NULLS TO RMDL-DTE  ****                               
           MOVE -1 TO DN-RMDL-DTE                                               
           MOVE PV-RMDL-DTE             TO XLT00010-RMDL-DTE                    
                                                                                
      *****   ALWAYS MOVE NULLS TO MEDN-AGE-NBR  ****                           
           MOVE -1 TO DN-MEDN-AGE-NBR                                           
           MOVE PV-MEDN-AGE-NBR         TO XLT00010-MEDN-AGE-NBR                
                                                                                
      *****   ALWAYS MOVE NULLS TO EST-HH-INCM-AMT  ****                        
           MOVE -1 TO DN-EST-HH-INCM-AMT                                        
           MOVE PV-EST-HH-INCM-AMT      TO XLT00010-EST-HH-INCM-AMT             
                                                                                
      *****   ALWAYS MOVE NULLS TO QTR-SLS-INCL-DTE   ****                      
           MOVE -1 TO DN-QTR-SLS-INCL-DTE                                       
           MOVE PV-QTR-SLS-INCL-DTE     TO XLT00010-QTR-SLS-INCL-DTE            
                                                                                
      *****   ALWAYS MOVE NULLS TO SEA-SLS-INCL-DTE   ****                      
           MOVE -1 TO DN-SEA-SLS-INCL-DTE                                       
           MOVE PV-SEA-SLS-INCL-DTE     TO XLT00010-SEA-SLS-INCL-DTE            
                                                                                
      *****   ALWAYS MOVE NULLS TO EXTD-MALL-NM    ****                         
           MOVE -1 TO DN-EXTD-MALL-NM                                           
           MOVE PV-EXTD-MALL-NM         TO XLT00010-EXTD-MALL-NM                
                                                                                
      *****   ALWAYS MOVE NULLS TO GRND-OPN-DTE FIELD****                       
           MOVE -1 TO DN-GRND-OPN-DTE                                           
           MOVE PV-GRND-OPN-DTE         TO XLT00010-GRND-OPN-DTE                
                                                                                
      *****   ALWAYS MOVE NULLS TO PRCHG-CRE-IND  ****                          
           MOVE -1 TO DN-PRCHG-CRE-IND                                          
           MOVE PV-PRCHG-CRE-IND        TO XLT00010-PRCHG-CRE-IND               
                                                                                
      *****   ALWAYS MOVE NULLS TO IN-STR-PRCHG-IND  ****                       
           MOVE -1 TO DN-IN-STR-PRCHG-IND                                       
           MOVE PV-IN-STR-PRCHG-IND     TO XLT00010-IN-STR-PRCHG-IND            
                                                                                
      *****   ALWAYS MOVE NULLS TO DIRNS-TXT FIELD  ****                        
           MOVE -1 TO DN-DIRNS-TXT                                              
           MOVE PV-DIRNS-TXT-LEN        TO XLT00010-DIRNS-TXT-LEN               
           MOVE PV-DIRNS-TXT            TO XLT00010-DIRNS-TXT-TEXT              
                                                                                
           PERFORM 2150-SET-CURRENT-TMST                                        
           MOVE PV-CURRENT-TMST         TO XLT00010-LAST-UPD-TMST               
079100                                                                          
079200     PERFORM                                                              
079300         WITH TEST AFTER                                                  
079400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
079500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
079600                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
079700                                                                          
079800     EXEC SQL                                                             
079900         INSERT INTO XLT_LOC                                              
080300             (LOC_NBR                                                     
               ,    REPLT_STR_NBR                                               
               ,    DIST_NBR                                                    
080300         ,    LOC_TYP_CDE                                                 
               ,    STR_FMT_CDE                                                 
               ,    STD_TM_ZN_CDE                                               
080600         ,    LOC_NM                                                      
080700         ,    LOC_5_ABBR_NM                                               
080800         ,    LNE_1_ADDR                                                  
080900         ,    LNE_2_ADDR                                                  
081000         ,    CTY_NM                                                      
081100         ,    ST_CDE                                                      
081200         ,    ZIP_10_CDE                                                  
081300         ,    OPN_DTE                                                     
081400         ,    CLO_DTE                                                     
081400         ,    LOC_10_ABBR_NM                                              
081600         ,    PHN_NBR                                                     
081600         ,    MGR_NM                                                      
               ,    FINCL_CLO_DTE                                               
               ,    MN_SLS_INCL_DTE                                             
               ,    YR_SLS_INCL_DTE                                             
               ,    OCPNC_DTE                                                   
               ,    POS_RGST_BNK_QTY                                            
               ,    DST_IND                                                     
               ,    E_BUS_IND                                                   
               ,    SLS_INCL_DTE_CDE                                            
               ,    TOT_SLG_SQ_FTG_QTY                                          
               ,    TOT_SQ_FTG_QTY                                              
               ,    STP_ORD_DAYS_QTY                                            
               ,    STRT_ORD_DAYS_QTY                                           
               ,    ACQR_DTE                                                    
               ,    RMDL_DTE                                                    
               ,    MEDN_AGE_NBR                                                
               ,    EST_HH_INCM_AMT                                             
               ,    QTR_SLS_INCL_DTE                                            
               ,    SEA_SLS_INCL_DTE                                            
               ,    EXTD_MALL_NM                                                
               ,    GRND_OPN_DTE                                                
               ,    PRCHG_CRE_IND                                               
               ,    IN_STR_PRCHG_IND                                            
               ,    DIRNS_TXT                                                   
               ,    LAST_UPD_TMST                                               
084200         )                                                                
084300             VALUES                                                       
084700             (:XLT00010-LOC-NBR                                           
               ,    :XLT00010-REPLT-STR-NBR                                     
                       :DN-REPLT-STR-NBR                                        
               ,    :XLT00010-DIST-NBR                                          
                       :DN-DIST-NBR                                             
084700         ,    :XLT00010-LOC-TYP-CDE                                       
               ,    :XLT00010-STR-FMT-CDE                                       
                       :DN-STR-FMT-CDE                                          
               ,    :XLT00010-STD-TM-ZN-CDE                                     
                       :DN-STD-TM-ZN-CDE                                        
085000         ,    :XLT00010-LOC-NM                                            
085100         ,    :XLT00010-LOC-5-ABBR-NM                                     
085200         ,    :XLT00010-LNE-1-ADDR                                        
085300         ,    :XLT00010-LNE-2-ADDR                                        
085400         ,    :XLT00010-CTY-NM                                            
085500         ,    :XLT00010-ST-CDE                                            
085600         ,    :XLT00010-ZIP-10-CDE                                        
085700         ,    :XLT00010-OPN-DTE                                           
085800         ,    :XLT00010-CLO-DTE                                           
086000         ,    :XLT00010-LOC-10-ABBR-NM                                    
                       :DN-LOC-10-ABBR-NM                                       
086000         ,    :XLT00010-PHN-NBR                                           
                       :DN-PHN-NBR                                              
086000         ,    :XLT00010-MGR-NM                                            
                       :DN-MGR-NM                                               
               ,    :XLT00010-FINCL-CLO-DTE                                     
                       :DN-FINCL-CLO-DTE                                        
               ,    :XLT00010-MN-SLS-INCL-DTE                                   
                       :DN-MN-SLS-INCL-DTE                                      
               ,    :XLT00010-YR-SLS-INCL-DTE                                   
                       :DN-YR-SLS-INCL-DTE                                      
               ,    :XLT00010-OCPNC-DTE                                         
                       :DN-OCPNC-DTE                                            
               ,    :XLT00010-POS-RGST-BNK-QTY                                  
                       :DN-POS-RGST-BNK-QTY                                     
               ,    :XLT00010-DST-IND                                           
                       :DN-DST-IND                                              
               ,    :XLT00010-E-BUS-IND                                         
                       :DN-E-BUS-IND                                            
               ,    :XLT00010-SLS-INCL-DTE-CDE                                  
                       :DN-SLS-INCL-DTE-CDE                                     
               ,    :XLT00010-TOT-SLG-SQ-FTG-QTY                                
                       :DN-TOT-SLG-SQ-FTG-QTY                                   
               ,    :XLT00010-TOT-SQ-FTG-QTY                                    
                       :DN-TOT-SQ-FTG-QTY                                       
               ,    :XLT00010-STP-ORD-DAYS-QTY                                  
                       :DN-STP-ORD-DAYS-QTY                                     
               ,    :XLT00010-STRT-ORD-DAYS-QTY                                 
                       :DN-STRT-ORD-DAYS-QTY                                    
               ,    :XLT00010-ACQR-DTE                                          
                       :DN-ACQR-DTE                                             
               ,    :XLT00010-RMDL-DTE                                          
                       :DN-RMDL-DTE                                             
               ,    :XLT00010-MEDN-AGE-NBR                                      
                       :DN-MEDN-AGE-NBR                                         
               ,    :XLT00010-EST-HH-INCM-AMT                                   
                       :DN-EST-HH-INCM-AMT                                      
               ,    :XLT00010-QTR-SLS-INCL-DTE                                  
                       :DN-QTR-SLS-INCL-DTE                                     
               ,    :XLT00010-SEA-SLS-INCL-DTE                                  
                       :DN-SEA-SLS-INCL-DTE                                     
               ,    :XLT00010-EXTD-MALL-NM                                      
                       :DN-EXTD-MALL-NM                                         
               ,    :XLT00010-GRND-OPN-DTE                                      
                       :DN-GRND-OPN-DTE                                         
               ,    :XLT00010-PRCHG-CRE-IND                                     
                       :DN-PRCHG-CRE-IND                                        
               ,    :XLT00010-IN-STR-PRCHG-IND                                  
                       :DN-IN-STR-PRCHG-IND                                     
               ,    :XLT00010-DIRNS-TXT                                         
                       :DN-DIRNS-TXT                                            
086000         ,    :XLT00010-LAST-UPD-TMST                                     
088600         )                                                                
088700         END-EXEC                                                         
088800                                                                          
088900         EVALUATE TRUE                                                    
089000             WHEN SQLCODE = ZERO                                          
089100                 ADD 1           TO PV-XLT00023-INSRT-OUTLOC-CNT          
089100                 PERFORM 7031-INSERT-TDCSTMF                              
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
089200             WHEN SQLCODE = -803                                          
089300                 ADD 1           TO PV-XLT00023-DUP-OUTLOC-CNT            
089400             WHEN SQLCODE = -904                                          
089500             WHEN SQLCODE = -911                                          
089600             WHEN SQLCODE = -913                                          
089700                 CONTINUE                                                 
089800                                                                          
089900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
090000                 DISPLAY '**************************************'         
090100                 DISPLAY 'WARNING ISSUED ON INSERT OF XLT00010  '         
090200                 DISPLAY 'OUT-LOC     = '  XL037-LOC-NBR                  
090300                 DISPLAY '**********************************'             
090400                 PERFORM 9800-SQL-WARNING                                 
090500                                                                          
090600             WHEN SQLCODE < ZERO                                          
090700                 DISPLAY '**************************************'         
090800                 DISPLAY 'ERROR ISSUED ON INSERT OF XLT00010 '            
090900                 DISPLAY 'OUT-LOC     = '  XL037-LOC-NBR                  
091000                 DISPLAY '**************************************'         
091100                 PERFORM 9900-SQL-ERROR                                   
091200                                                                          
091300         END-EVALUATE                                                     
091400     END-PERFORM                                                          
091500                                                                          
091600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
091700         SQLCODE NOT = ZERO                                               
091800         DISPLAY '**************************************'                 
091900         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
092000         DISPLAY 'INSERT TO XLT_LOC                     '                 
092100         DISPLAY 'ERROR ISSUED ON INSERT OF XLT00010  '                   
092200         DISPLAY 'OUT-LOC     = '  XL037-LOC-NBR                          
092300         DISPLAY '**************************************'                 
092400         DISPLAY '**************************************'                 
092500         PERFORM 9900-SQL-ERROR                                           
092600     END-IF.                                                              
092700                                                                          
127100****************************************************************          
127200****** START OF DELETE ROUTINES ******                                    
127300****************************************************************          
127400                                                                          
127500 7100-DELETE-LOC-TYP-CDE.                                                 
127600     MOVE '7100-DELETE-LOC-TYPE-CDE'  TO PV-ABEND-PARAGRAPH.              
127700                                                                          
127800     MOVE XL037-LOC-TYP-CDE           TO XLT00015-LOC-TYP-CDE             
127900                                                                          
128000                                                                          
128100     PERFORM                                                              
128200         WITH TEST AFTER                                                  
128300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
128400         UNTIL  (PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
128500                (SQLCODE = ZERO OR +100 OR -532)                          
128600                                                                          
128700     EXEC SQL                                                             
128800         DELETE FROM XLT_LOC_TYP_CDE                                      
128900         WHERE                                                            
129000              LOC_TYP_CDE   = :XLT00015-LOC-TYP-CDE                       
129100         END-EXEC                                                         
129200                                                                          
129300         EVALUATE TRUE                                                    
129400             WHEN SQLCODE = ZERO                                          
129500                 ADD 1                TO PV-XLT00015-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
129600             WHEN SQLCODE = +100                                          
129700                 ADD 1                TO PV-XLT00015-DELNF-COUNT          
129800             WHEN SQLCODE = -532                                          
129900                 ADD 1                TO PV-XLT00015-532-COUNT            
130000             WHEN SQLCODE = -904                                          
130100             WHEN SQLCODE = -911                                          
130200             WHEN SQLCODE = -913                                          
130300                 CONTINUE                                                 
130400                                                                          
130500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
130600                 DISPLAY '**************************************'         
130700                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00015   '        
130800                 DISPLAY 'LOC-TYP-CDE =  '  XL037-LOC-TYP-CDE             
130900                 DISPLAY '**********************************'             
131000                 PERFORM 9800-SQL-WARNING                                 
131100                                                                          
131200             WHEN SQLCODE < ZERO                                          
131300                 DISPLAY '**************************************'         
131400                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00015   '          
131500                 DISPLAY 'LOC-TYP-CDE =  '  XL037-LOC-TYP-CDE             
131600                 DISPLAY '**************************************'         
131700                 PERFORM 9900-SQL-ERROR                                   
131800                                                                          
131900         END-EVALUATE                                                     
132000     END-PERFORM                                                          
132100                                                                          
132200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
132300         SQLCODE NOT = ZERO                                               
132400         DISPLAY '**************************************'                 
132500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
132600         DISPLAY 'DELETE TO XLT_LOC                     '                 
132700         DISPLAY 'ERROR ISSUED ON DELETE OF XLT0015   '                   
132800         DISPLAY 'LOC-TYP-CDE =  '  XL037-LOC-TYP-CDE                     
132900         DISPLAY '**************************************'                 
133000         PERFORM 9900-SQL-ERROR                                           
133100     END-IF.                                                              
133200                                                                          
133300 7105-DELETE-TM-ZN-CDE.                                                   
133400     MOVE '7105-DELETE-TM-ZN-CDE'     TO PV-ABEND-PARAGRAPH.              
133500                                                                          
133600     MOVE XL037-STD-TM-ZN-CDE         TO XLT00016-STD-TM-ZN-CDE           
133700                                                                          
133800                                                                          
133900     PERFORM                                                              
134000         WITH TEST AFTER                                                  
134100         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
134200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
134300                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
134400                                                                          
134500     EXEC SQL                                                             
134600         DELETE FROM XLT_STD_TM_ZN_CDE                                    
134700         WHERE                                                            
134800              STD_TM_ZN_CDE = :XLT00016-STD-TM-ZN-CDE                     
134900         END-EXEC                                                         
135000                                                                          
135100         EVALUATE TRUE                                                    
135200             WHEN SQLCODE = ZERO                                          
135300                 ADD 1                TO PV-XLT00016-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
135400             WHEN SQLCODE = +100                                          
135500                 ADD 1                TO PV-XLT00016-DELNF-COUNT          
135600             WHEN SQLCODE = -904                                          
135700             WHEN SQLCODE = -911                                          
135800             WHEN SQLCODE = -913                                          
135900                 CONTINUE                                                 
136000                                                                          
136100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
136200                 DISPLAY '**************************************'         
136300                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00016   '        
136400                 DISPLAY 'STD-TM-ZN-CDE =' XL037-STD-TM-ZN-CDE            
136500                 DISPLAY '**********************************'             
136600                 PERFORM 9800-SQL-WARNING                                 
136700                                                                          
136800             WHEN SQLCODE < ZERO                                          
136900                 DISPLAY '**************************************'         
137000                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00016 '            
137100                 DISPLAY 'STD-TM-ZN-CDE =' XL037-STD-TM-ZN-CDE            
137200                 DISPLAY '**************************************'         
137300                 PERFORM 9900-SQL-ERROR                                   
137400                                                                          
137500         END-EVALUATE                                                     
137600     END-PERFORM                                                          
137700                                                                          
137800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
137900         SQLCODE NOT = ZERO                                               
138000         DISPLAY '**************************************'                 
138100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
138200         DISPLAY 'DELETE FROM XLT00016                  '                 
138300         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00016  '                   
138400         DISPLAY 'STD-TM-ZN-CDE =' XL037-STD-TM-ZN-CDE                    
138500         DISPLAY '**************************************'                 
138600         DISPLAY '**************************************'                 
138700         PERFORM 9900-SQL-ERROR                                           
138800     END-IF.                                                              
138900                                                                          
139000 7110-DELETE-STR-FMT-CDE.                                                 
139100     MOVE '7110-DELETE-STR-FMT-CDE'   TO PV-ABEND-PARAGRAPH.              
139200                                                                          
139300     MOVE XL037-STR-FMT-CDE           TO XLT00017-STR-FMT-CDE             
139400                                                                          
139500     PERFORM                                                              
139600         WITH TEST AFTER                                                  
139700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
139800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
139900                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
140000                                                                          
140100     EXEC SQL                                                             
140200         DELETE FROM XLT_STR_FMT_CDE                                      
140300         WHERE                                                            
140400             STR_FMT_CDE  =  :XLT00017-STR-FMT-CDE                        
140500         END-EXEC                                                         
140600                                                                          
140700         EVALUATE TRUE                                                    
140800             WHEN SQLCODE = ZERO                                          
140900                 ADD 1                TO PV-XLT00017-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
141000             WHEN SQLCODE = +100                                          
141100                 ADD 1                TO PV-XLT00017-DELNF-COUNT          
141200             WHEN SQLCODE = -904                                          
141300             WHEN SQLCODE = -911                                          
141400             WHEN SQLCODE = -913                                          
141500                 CONTINUE                                                 
141600                                                                          
141700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
141800                 DISPLAY '**************************************'         
141900                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00017  '         
142000                 DISPLAY 'STR-FMT-CDE = '  XLT00017-STR-FMT-CDE           
142100                 DISPLAY '**********************************'             
142200                 PERFORM 9800-SQL-WARNING                                 
142300                                                                          
142400             WHEN SQLCODE < ZERO                                          
142500                 DISPLAY '**************************************'         
142600                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00017 '            
142700                 DISPLAY 'STR-FMT-CDE = '  XL037-STR-FMT-CDE              
142800                 DISPLAY '**************************************'         
142900                 PERFORM 9900-SQL-ERROR                                   
143000                                                                          
143100         END-EVALUATE                                                     
143200     END-PERFORM                                                          
143300                                                                          
143400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
143500         SQLCODE NOT = ZERO                                               
143600         DISPLAY '**************************************'                 
143700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
143800         DISPLAY 'DELETE FROM XLT00017                  '                 
143900         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00017  '                   
144000         DISPLAY 'STR-FMT-CDE = '  XL037-STR-FMT-CDE                      
144100         DISPLAY '**************************************'                 
144200         DISPLAY '**************************************'                 
144300         PERFORM 9900-SQL-ERROR                                           
144400     END-IF.                                                              
144500                                                                          
144600 7115-DELETE-TERR.                                                        
144700     MOVE '7115-DELETE-TERR'          TO PV-ABEND-PARAGRAPH.              
144800                                                                          
144900     MOVE XL037-TERR-NBR              TO XLT00011-TERR-NBR                
145000                                                                          
145100     PERFORM                                                              
145200         WITH TEST AFTER                                                  
145300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
145400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
145500                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
145600                                                                          
145700     EXEC SQL                                                             
145800         DELETE FROM XLT_TERR                                             
145900         WHERE                                                            
146000             TERR_NBR     =  :XLT00011-TERR-NBR                           
146100         END-EXEC                                                         
146200                                                                          
146300         EVALUATE TRUE                                                    
146400             WHEN SQLCODE = ZERO                                          
146500                 ADD 1                TO PV-XLT00011-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
146600             WHEN SQLCODE = +100                                          
146700                 ADD 1                TO PV-XLT00011-DELNF-COUNT          
146800             WHEN SQLCODE = -904                                          
146900             WHEN SQLCODE = -911                                          
147000             WHEN SQLCODE = -913                                          
147100                 CONTINUE                                                 
147200                                                                          
147300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
147400                 DISPLAY '**************************************'         
147500                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00011  '         
147600                 DISPLAY 'TERR-NBR    = '  XLT00011-TERR-NBR              
147700                 DISPLAY '**********************************'             
147800                 PERFORM 9800-SQL-WARNING                                 
147900                                                                          
148000             WHEN SQLCODE < ZERO                                          
148100                 DISPLAY '**************************************'         
148200                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00011 '            
148300                 DISPLAY 'TERR-NBR    = '  XL037-TERR-NBR                 
148400                 DISPLAY '**************************************'         
148500                 PERFORM 9900-SQL-ERROR                                   
148600                                                                          
148700         END-EVALUATE                                                     
148800     END-PERFORM                                                          
148900                                                                          
149000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
149100         SQLCODE NOT = ZERO                                               
149200         DISPLAY '**************************************'                 
149300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
149400         DISPLAY 'DELETE FROM XLT_TERR                  '                 
149500         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00011  '                   
149600         DISPLAY 'TERR-NBR    = '  XL037-TERR-NBR                         
149700         DISPLAY '**************************************'                 
149800         DISPLAY '**************************************'                 
149900         PERFORM 9900-SQL-ERROR                                           
150000     END-IF.                                                              
150100                                                                          
150200                                                                          
150300 7120-DELETE-REGN.                                                        
150400     MOVE '7120-DELETE-REGN'          TO PV-ABEND-PARAGRAPH.              
150500                                                                          
150600     MOVE XL037-REGN-NBR              TO XLT00012-REGN-NBR                
150700                                                                          
150800     PERFORM                                                              
150900         WITH TEST AFTER                                                  
151000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
151100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
151200                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
151300                                                                          
151400     EXEC SQL                                                             
151500         DELETE FROM XLT_REGN                                             
151600         WHERE                                                            
151700             REGN_NBR     =  :XLT00012-REGN-NBR                           
151800         END-EXEC                                                         
151900                                                                          
152000         EVALUATE TRUE                                                    
152100             WHEN SQLCODE = ZERO                                          
152200                 ADD 1                TO PV-XLT00012-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
152300             WHEN SQLCODE = +100                                          
152400                 ADD 1                TO PV-XLT00012-DELNF-COUNT          
152500             WHEN SQLCODE = -904                                          
152600             WHEN SQLCODE = -911                                          
152700             WHEN SQLCODE = -913                                          
152800                 CONTINUE                                                 
152900                                                                          
153000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
153100                 DISPLAY '**************************************'         
153200                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00012  '         
153300                 DISPLAY 'REGN-NBR    = '  XL037-REGN-NBR                 
153400                 DISPLAY '**********************************'             
153500                 PERFORM 9800-SQL-WARNING                                 
153600                                                                          
153700             WHEN SQLCODE < ZERO                                          
153800                 DISPLAY '**************************************'         
153900                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00012 '            
154000                 DISPLAY 'REGN-NBR    = '  XL037-REGN-NBR                 
154100                 DISPLAY '**************************************'         
154200                 PERFORM 9900-SQL-ERROR                                   
154300                                                                          
154400         END-EVALUATE                                                     
154500     END-PERFORM                                                          
154600                                                                          
154700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
154800         SQLCODE NOT = ZERO                                               
154900         DISPLAY '**************************************'                 
155000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
155100         DISPLAY 'DELETE FROM XLT00012                  '                 
155200         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00012  '                   
155300         DISPLAY 'REGN-NBR    = '  XL037-REGN-NBR                         
155400         DISPLAY '**************************************'                 
155500         DISPLAY '**************************************'                 
155600         PERFORM 9900-SQL-ERROR                                           
155700     END-IF.                                                              
155800                                                                          
155900                                                                          
156000 7125-DELETE-DIST.                                                        
156100     MOVE '7125-DELETE-DIST'          TO PV-ABEND-PARAGRAPH.              
156200                                                                          
156300     MOVE XL037-DIST-NBR              TO XLT00013-DIST-NBR                
156400                                                                          
156500     PERFORM                                                              
156600         WITH TEST AFTER                                                  
156700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
156800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
156900                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
157000                                                                          
157100     EXEC SQL                                                             
157200         DELETE FROM XLT_DIST                                             
157300         WHERE                                                            
157400             DIST_NBR     =  :XLT00013-DIST-NBR                           
157500         END-EXEC                                                         
157600                                                                          
157700         EVALUATE TRUE                                                    
157800             WHEN SQLCODE = ZERO                                          
157900                 ADD 1                TO PV-XLT00013-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
158000             WHEN SQLCODE = +100                                          
158100                 ADD 1                TO PV-XLT00013-DELNF-COUNT          
158200             WHEN SQLCODE = -904                                          
158300             WHEN SQLCODE = -911                                          
158400             WHEN SQLCODE = -913                                          
158500                 CONTINUE                                                 
158600                                                                          
158700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
158800                 DISPLAY '**************************************'         
158900                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00013  '         
159000                 DISPLAY 'DIST-NBR    = '  XL037-DIST-NBR                 
159100                 DISPLAY '**********************************'             
159200                 PERFORM 9800-SQL-WARNING                                 
159300                                                                          
159400             WHEN SQLCODE < ZERO                                          
159500                 DISPLAY '**************************************'         
159600                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00013 '            
159700                 DISPLAY 'DIST-NBR    = '  XL037-DIST-NBR                 
159800                 DISPLAY '**************************************'         
159900                 PERFORM 9900-SQL-ERROR                                   
160000                                                                          
160100         END-EVALUATE                                                     
160200     END-PERFORM                                                          
160300                                                                          
160400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
160500         SQLCODE NOT = ZERO                                               
160600         DISPLAY '**************************************'                 
160700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
160800         DISPLAY 'DELETE FROM XLT00013                  '                 
160900         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00013  '                   
161000         DISPLAY 'DIST-NBR    = '  XL037-DIST-NBR                         
161100         DISPLAY '**************************************'                 
161200         DISPLAY '**************************************'                 
161300         PERFORM 9900-SQL-ERROR                                           
161400     END-IF.                                                              
161500                                                                          
161600 7130-DELETE-LOC.                                                         
161700     MOVE '7130-DELETE-LOC'           TO PV-ABEND-PARAGRAPH.              
161800                                                                          
161900     MOVE XL037-LOC-NBR               TO XLT00010-LOC-NBR                 
162000                                                                          
162100     PERFORM                                                              
162200         WITH TEST AFTER                                                  
162300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
162400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
162500                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
162600                                                                          
162700     EXEC SQL                                                             
162800         DELETE FROM XLT_LOC                                              
162900         WHERE                                                            
163000             LOC_NBR      =  :XLT00010-LOC-NBR                            
163100         END-EXEC                                                         
163200                                                                          
163300         EVALUATE TRUE                                                    
163400             WHEN SQLCODE = ZERO                                          
163500                 ADD 1                TO PV-XLT00010-DEL-COUNT            
                       PERFORM 7131-DELETE-TDCSTMF                              
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
163600             WHEN SQLCODE = +100                                          
163700                 ADD 1                TO PV-XLT00010-DELNF-COUNT          
163800             WHEN SQLCODE = -904                                          
163900             WHEN SQLCODE = -911                                          
164000             WHEN SQLCODE = -913                                          
164100                 CONTINUE                                                 
164200                                                                          
164300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
164400                 DISPLAY '**************************************'         
164500                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00010  '         
164600                 DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                  
164700                 DISPLAY '**********************************'             
164800                 PERFORM 9800-SQL-WARNING                                 
164900                                                                          
165000             WHEN SQLCODE < ZERO                                          
165100                 DISPLAY '**************************************'         
165200                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00010 '            
165300                 DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                  
165400                 DISPLAY '**************************************'         
165500                 PERFORM 9900-SQL-ERROR                                   
165600                                                                          
165700         END-EVALUATE                                                     
165800     END-PERFORM                                                          
165900                                                                          
166000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
166100         SQLCODE NOT = ZERO                                               
166200         DISPLAY '**************************************'                 
166300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
166400         DISPLAY 'DELETE FROM XLT00010                  '                 
166500         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00010  '                   
166600         DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                          
166700         DISPLAY '**************************************'                 
166800         DISPLAY '**************************************'                 
166900         PERFORM 9900-SQL-ERROR                                           
167000     END-IF.                                                              
167100                                                                          
161600 7131-DELETE-TDCSTMF.                                                     
161700     MOVE '7131-DELETE-TDCSTMF'       TO PV-ABEND-PARAGRAPH.              
161800                                                                          
161900     MOVE XL037-LOC-NBR               TO XLT00010-LOC-NBR                 
162000                                                                          
162100     PERFORM                                                              
162200         WITH TEST AFTER                                                  
162300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
162400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
162500                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
162600                                                                          
162700     EXEC SQL                                                             
162800         DELETE FROM TDCSTMF                                              
162900         WHERE                                                            
163000             STR_NBR      =  :XLT00010-LOC-NBR                            
163100         END-EXEC                                                         
163200                                                                          
163300         EVALUATE TRUE                                                    
163400             WHEN SQLCODE = ZERO                                          
163500                 ADD 1                TO PV-DCSTMF-DEL-COUNT              
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
163600             WHEN SQLCODE = +100                                          
163700                 ADD 1                TO PV-DCSTMF-DELNF-COUNT            
163800             WHEN SQLCODE = -904                                          
163900             WHEN SQLCODE = -911                                          
164000             WHEN SQLCODE = -913                                          
164100                 CONTINUE                                                 
164200                                                                          
164300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
164400                 DISPLAY '**************************************'         
164500                 DISPLAY 'WARNING ISSUED ON DELETE OF TDCSTMF   '         
164600                 DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                  
164700                 DISPLAY '**********************************'             
164800                 PERFORM 9800-SQL-WARNING                                 
164900                                                                          
165000             WHEN SQLCODE < ZERO                                          
165100                 DISPLAY '**************************************'         
165200                 DISPLAY 'ERROR ISSUED ON DELETE OF TDCSTMF  '            
165300                 DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                  
165400                 DISPLAY '**************************************'         
165500                 PERFORM 9900-SQL-ERROR                                   
165600                                                                          
165700         END-EVALUATE                                                     
165800     END-PERFORM                                                          
165900                                                                          
166000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
166100         SQLCODE NOT = ZERO                                               
166200         DISPLAY '**************************************'                 
166300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
166400         DISPLAY 'DELETE FROM TDCSTMF                   '                 
166500         DISPLAY 'ERROR ISSUED ON DELETE OF TDCSTMF   '                   
166600         DISPLAY 'LOC-NBR     = '  XL037-LOC-NBR                          
166700         DISPLAY '**************************************'                 
166800         DISPLAY '**************************************'                 
166900         PERFORM 9900-SQL-ERROR                                           
167000     END-IF.                                                              
167100                                                                          
167200 7135-DELETE-DC-LOC-ASGNT.                                                
167300     MOVE '7135-DELETE-DC-LOC-ASGNT'  TO PV-ABEND-PARAGRAPH.              
167400                                                                          
167500     MOVE XL037-DCLOC-LOC-NBR         TO XLT00014-LOC-NBR                 
167600     MOVE XL037-DCLOC-EFF-BEG-DTE     TO XLT00014-EFF-BEG-DTE             
167700                                                                          
167800     PERFORM                                                              
167900         WITH TEST AFTER                                                  
168000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
168100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
168200                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
168300                                                                          
168400     EXEC SQL                                                             
168500         DELETE FROM XLT_DC_LOC_ASGMT                                     
168600         WHERE                                                            
168700             LOC_NBR      =  :XLT00014-LOC-NBR                            
168800         AND EFF_BEG_DTE  =  :XLT00014-EFF-BEG-DTE                        
168900         END-EXEC                                                         
169000                                                                          
169100         EVALUATE TRUE                                                    
169200             WHEN SQLCODE = ZERO                                          
169300                 ADD 1                TO PV-XLT00014-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
169400             WHEN SQLCODE = +100                                          
169500                 ADD 1                TO PV-XLT00014-DELNF-COUNT          
169600             WHEN SQLCODE = -904                                          
169700             WHEN SQLCODE = -911                                          
169800             WHEN SQLCODE = -913                                          
169900                 CONTINUE                                                 
170000                                                                          
170100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
170200                 DISPLAY '**************************************'         
170300                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00014  '         
170400                 DISPLAY 'LOC-NBR     =' XL037-DCLOC-LOC-NBR              
                       DISPLAY 'EFF-BEG-DTE =' XL037-DCLOC-EFF-BEG-DTE          
170500                 DISPLAY '**********************************'             
170600                 PERFORM 9800-SQL-WARNING                                 
170700                                                                          
170800             WHEN SQLCODE < ZERO                                          
170900                 DISPLAY '**************************************'         
171000                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00014 '            
170400                 DISPLAY 'LOC-NBR     =' XL037-DCLOC-LOC-NBR              
                       DISPLAY 'EFF-BEG-DTE =' XL037-DCLOC-EFF-BEG-DTE          
171200                 DISPLAY '**************************************'         
171300                 PERFORM 9900-SQL-ERROR                                   
171400                                                                          
171500         END-EVALUATE                                                     
171600     END-PERFORM                                                          
171700                                                                          
171800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
171900         SQLCODE NOT = ZERO                                               
172000         DISPLAY '**************************************'                 
172100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
172200         DISPLAY 'DELETE FROM XLT00010                  '                 
172300         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00014  '                   
170400         DISPLAY 'LOC-NBR     = ' XL037-DCLOC-LOC-NBR                     
               DISPLAY 'EFF-BEG-DTE = ' XL037-DCLOC-EFF-BEG-DTE                 
172500         DISPLAY '**************************************'                 
172600         DISPLAY '**************************************'                 
172700         PERFORM 9900-SQL-ERROR                                           
172800     END-IF.                                                              
172900                                                                          
173000 7140-DELETE-STR-GP-TYP.                                                  
173100     MOVE '7140-DELETE-STR-GP-TYP'    TO PV-ABEND-PARAGRAPH.              
173200                                                                          
173300     MOVE XL037-STR-GP-TYP-CDE        TO XLT00019-STR-GP-TYP-CDE          
173400                                                                          
173500     PERFORM                                                              
173600         WITH TEST AFTER                                                  
173700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
173800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
173900                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
174000                                                                          
174100     EXEC SQL                                                             
174200         DELETE FROM XLT_STR_GP_TYP                                       
174300         WHERE                                                            
174400             STR_GP_TYP_CDE = :XLT00019-STR-GP-TYP-CDE                    
174500         END-EXEC                                                         
174600                                                                          
174700         EVALUATE TRUE                                                    
174800             WHEN SQLCODE = ZERO                                          
174900                 ADD 1                TO PV-XLT00019-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
175000             WHEN SQLCODE = +100                                          
175100                 ADD 1                TO PV-XLT00019-DELNF-COUNT          
175200             WHEN SQLCODE = -904                                          
175300             WHEN SQLCODE = -911                                          
175400             WHEN SQLCODE = -913                                          
175500                 CONTINUE                                                 
175600                                                                          
175700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
175800                 DISPLAY '**************************************'         
175900                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00019  '         
176000                 DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE           
176100                 DISPLAY '**********************************'             
176200                 PERFORM 9800-SQL-WARNING                                 
176300                                                                          
176400             WHEN SQLCODE < ZERO                                          
176500                 DISPLAY '**************************************'         
176600                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00019 '            
176610                 DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE           
176800                 DISPLAY '**************************************'         
176900                 PERFORM 9900-SQL-ERROR                                   
177000                                                                          
177100         END-EVALUATE                                                     
177200     END-PERFORM                                                          
177300                                                                          
177400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
177500         SQLCODE NOT = ZERO                                               
177600         DISPLAY '**************************************'                 
177700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
177800         DISPLAY 'DELETE FROM XLT_STR_GP_TYP            '                 
177900         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00019  '                   
178000         DISPLAY 'STR-GP-TYP-CDE =' XL037-STR-GP-TYP-CDE                  
178100         DISPLAY '**************************************'                 
178200         DISPLAY '**************************************'                 
178300         PERFORM 9900-SQL-ERROR                                           
178400     END-IF.                                                              
178500                                                                          
178600 7145-DELETE-STR-GP.                                                      
178700     MOVE '7145-DELETE-STR-GP'        TO PV-ABEND-PARAGRAPH.              
178800                                                                          
178900     MOVE XL037-SG-STR-GP-TYP-CDE     TO XLT00020-STR-GP-TYP-CDE          
179000     MOVE XL037-SG-STR-GP-ID          TO XLT00020-STR-GP-ID               
179100                                                                          
179200     PERFORM                                                              
179300         WITH TEST AFTER                                                  
179400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
179500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
179600                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
179700                                                                          
179800     EXEC SQL                                                             
179900         DELETE FROM XLT_STR_GP                                           
180000         WHERE                                                            
180100             STR_GP_TYP_CDE = :XLT00020-STR-GP-TYP-CDE                    
180200         AND STR_GP_ID      = :XLT00020-STR-GP-ID                         
180300         END-EXEC                                                         
180400                                                                          
180500         EVALUATE TRUE                                                    
180600             WHEN SQLCODE = ZERO                                          
180700                 ADD 1                TO PV-XLT00020-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
180800             WHEN SQLCODE = +100                                          
180900                 ADD 1                TO PV-XLT00020-DELNF-COUNT          
181000             WHEN SQLCODE = -904                                          
181100             WHEN SQLCODE = -911                                          
181200             WHEN SQLCODE = -913                                          
181300                 CONTINUE                                                 
181400                                                                          
181500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
181600                 DISPLAY '**************************************'         
181700                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00020  '         
181800                 DISPLAY 'STR-GP-TYP-CDE=' XLT00020-STR-GP-TYP-CDE        
 81800                 DISPLAY 'STR-GP-ID     =' XL037-SG-STR-GP-ID             
181900                 DISPLAY '**********************************'             
182000                 PERFORM 9800-SQL-WARNING                                 
182100                                                                          
182200             WHEN SQLCODE < ZERO                                          
182300                 DISPLAY '**************************************'         
182400                 DISPLAY 'ERROR ISSUED ON DELETE OF XLT00020 '            
182410                 DISPLAY 'STR-GP-TYP-CDE=' XL037-SG-STR-GP-TYP-CDE        
 81800                 DISPLAY 'STR-GP-ID     =' XL037-SG-STR-GP-ID             
182600                 DISPLAY '**************************************'         
182700                 PERFORM 9900-SQL-ERROR                                   
182800                                                                          
182900         END-EVALUATE                                                     
183000     END-PERFORM                                                          
183100                                                                          
183200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
183300         SQLCODE NOT = ZERO                                               
183400         DISPLAY '**************************************'                 
183500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
183600         DISPLAY 'DELETE FROM XLT_STR_GP                '                 
183700         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00020  '                   
183800         DISPLAY 'STR-GP-TYP-CDE =' XL037-SG-STR-GP-TYP-CDE               
 81800         DISPLAY 'STR-GP-ID     =' XL037-SG-STR-GP-ID                     
183900         DISPLAY '**************************************'                 
184000         DISPLAY '**************************************'                 
184100         PERFORM 9900-SQL-ERROR                                           
184200     END-IF.                                                              
184300                                                                          
184400 7150-DELETE-STR-GP-DTE.                                                  
184500     MOVE '7150-DELETE-STR-GP-DTE'    TO PV-ABEND-PARAGRAPH.              
184600                                                                          
184700     MOVE XL037-SGD-STR-GP-TYP-CDE    TO XLT00021-STR-GP-TYP-CDE          
184800     MOVE XL037-SGD-STR-GP-ID         TO XLT00021-STR-GP-ID               
184900     MOVE XL037-SGD-EFF-BEG-DTE       TO XLT00021-EFF-BEG-DTE             
185000                                                                          
185100     PERFORM                                                              
185200         WITH TEST AFTER                                                  
185300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
185400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
185500                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
185600                                                                          
185700     EXEC SQL                                                             
185800         DELETE FROM XLT_STR_GP_DTE                                       
185900         WHERE                                                            
186000             STR_GP_TYP_CDE = :XLT00021-STR-GP-TYP-CDE                    
186100         AND STR_GP_ID      = :XLT00021-STR-GP-ID                         
186200         AND EFF_BEG_DTE    = :XLT00021-EFF-BEG-DTE                       
186300         END-EXEC                                                         
186400                                                                          
186500         EVALUATE TRUE                                                    
186600             WHEN SQLCODE = ZERO                                          
186700                 ADD 1                TO PV-XLT00021-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
186800             WHEN SQLCODE = +100                                          
186900                 ADD 1                TO PV-XLT00021-DELNF-COUNT          
187000             WHEN SQLCODE = -904                                          
187100             WHEN SQLCODE = -911                                          
187200             WHEN SQLCODE = -913                                          
187300                 CONTINUE                                                 
187400                                                                          
187500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
187600                 DISPLAY '**************************************'         
187700                 DISPLAY 'WARNING ISSUED ON DELETE OF XLT00021  '         
187800                 DISPLAY 'STR-GP-TYP-CDE='                                
                       DISPLAY XL037-SGD-STR-GP-TYP-CDE                         
                       DISPLAY 'STR-GP-ID     =' XL037-SGD-STR-GP-ID            
                       DISPLAY 'EFF-BEG-DTE   =' XL037-SGD-EFF-BEG-DTE          
187900                 DISPLAY '**********************************'             
188000                 PERFORM 9800-SQL-WARNING                                 
188100                                                                          
188200             WHEN SQLCODE < ZERO                                          
188300               DISPLAY '**************************************'           
188400               DISPLAY 'ERROR ISSUED ON DELETE OF XLT00021 '              
187800               DISPLAY 'STR-GP-TYP-CDE='                                  
                     DISPLAY XL037-SGD-STR-GP-TYP-CDE                           
                     DISPLAY 'STR-GP-ID     =' XL037-SGD-STR-GP-ID              
                     DISPLAY 'EFF-BEG-DTE   =' XL037-SGD-EFF-BEG-DTE            
188600               DISPLAY '**************************************'           
188700               PERFORM 9900-SQL-ERROR                                     
188800                                                                          
188900         END-EVALUATE                                                     
189000     END-PERFORM                                                          
189100                                                                          
189200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
189300         SQLCODE NOT = ZERO                                               
189400         DISPLAY '**************************************'                 
189500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
189600         DISPLAY 'DELETE FROM XLT_STR_GP_DTE            '                 
189700         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00021  '                   
187800         DISPLAY 'STR-GP-TYP-CDE='                                        
               DISPLAY XL037-SGD-STR-GP-TYP-CDE                                 
               DISPLAY 'STR-GP-ID     =' XL037-SGD-STR-GP-ID                    
               DISPLAY 'EFF-BEG-DTE   =' XL037-SGD-EFF-BEG-DTE                  
189900         DISPLAY '**************************************'                 
190000         DISPLAY '**************************************'                 
190100         PERFORM 9900-SQL-ERROR                                           
190200     END-IF.                                                              
190300                                                                          
190400 7155-DELETE-STR-GP-MBSHP.                                                
190500     MOVE '7155-DELETE-STR-GP-MBSHP'  TO PV-ABEND-PARAGRAPH.              
190600                                                                          
190700     MOVE XL037-SGM-STR-GP-TYP-CDE    TO XLT00018-STR-GP-TYP-CDE          
190800     MOVE XL037-SGM-STR-GP-ID         TO XLT00018-STR-GP-ID               
190900     MOVE XL037-SGM-LOC-NBR           TO XLT00018-LOC-NBR                 
191000     MOVE XL037-SGM-EFF-BEG-DTE       TO XLT00018-EFF-BEG-DTE             
191100                                                                          
191200     PERFORM                                                              
191300         WITH TEST AFTER                                                  
191400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
191500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
191600                (SQLCODE = ZERO) OR (SQLCODE = +100))                     
191700                                                                          
191800     EXEC SQL                                                             
191900         DELETE FROM XLT_STR_GP_MBSHP                                     
192000         WHERE                                                            
192100               STR_GP_TYP_CDE = :XLT00018-STR-GP-TYP-CDE                  
192200           AND STR_GP_ID      = :XLT00018-STR-GP-ID                       
192300           AND LOC_NBR        = :XLT00018-LOC-NBR                         
192400           AND EFF_BEG_DTE    = :XLT00018-EFF-BEG-DTE                     
192500         END-EXEC                                                         
192600                                                                          
192700         EVALUATE TRUE                                                    
192800             WHEN SQLCODE = ZERO                                          
192900                 ADD 1                TO PV-XLT00018-DEL-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
193000             WHEN SQLCODE = +100                                          
193100                ADD 1                TO PV-XLT00018-DELNF-COUNT           
193200             WHEN SQLCODE = -904                                          
193300             WHEN SQLCODE = -911                                          
193400             WHEN SQLCODE = -913                                          
193500                 CONTINUE                                                 
193600                                                                          
                   WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
193800              DISPLAY '**************************************'            
193900              DISPLAY 'WARNING ISSUED ON DELETE OF XLT00018  '            
194000              DISPLAY 'STR-GP-TYP-CDE =' XL037-SGM-STR-GP-TYP-CDE         
                    DISPLAY 'STR-GP-ID      =' XL037-SGM-STR-GP-ID              
                    DISPLAY 'LOC-NBR        =' XL037-SGM-LOC-NBR                
                    DISPLAY 'EFF-BEG-DTE    =' XL037-SGM-EFF-BEG-DTE            
194100              DISPLAY '**********************************'                
194200              PERFORM 9800-SQL-WARNING                                    
194300                                                                          
194400             WHEN SQLCODE < ZERO                                          
194500              DISPLAY '**************************************'            
194600              DISPLAY 'ERROR ISSUED ON DELETE OF XLT00018 '               
194000              DISPLAY 'STR-GP-TYP-CDE =' XL037-SGM-STR-GP-TYP-CDE         
                    DISPLAY 'STR-GP-ID      =' XL037-SGM-STR-GP-ID              
                    DISPLAY 'LOC-NBR        =' XL037-SGM-LOC-NBR                
                    DISPLAY 'EFF-BEG-DTE    =' XL037-SGM-EFF-BEG-DTE            
194800              DISPLAY '**************************************'            
194900              PERFORM 9900-SQL-ERROR                                      
195000                                                                          
195100         END-EVALUATE                                                     
195200     END-PERFORM                                                          
195300                                                                          
195400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
195500         SQLCODE NOT = ZERO                                               
195600         DISPLAY '**************************************'                 
195700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
195800         DISPLAY 'DELETE FROM XLT_STR_GP_MBSHP          '                 
195900         DISPLAY 'ERROR ISSUED ON DELETE OF XLT00018  '                   
194000         DISPLAY 'STR-GP-TYP-CDE =' XL037-SGM-STR-GP-TYP-CDE              
               DISPLAY 'STR-GP-ID      =' XL037-SGM-STR-GP-ID                   
               DISPLAY 'LOC-NBR        =' XL037-SGM-LOC-NBR                     
               DISPLAY 'EFF-BEG-DTE    =' XL037-SGM-EFF-BEG-DTE                 
196100         DISPLAY '**************************************'                 
196200         DISPLAY '**************************************'                 
196300         PERFORM 9900-SQL-ERROR                                           
196400     END-IF.                                                              
196500                                                                          
196600****************************************************************          
196700****** START OF CHANGE ROUTINES ******                                    
196800****************************************************************          
      ******   IF ANY CHANGE GETS A SQLCODE OF +100 (NOT FOUND)                 
      ******   A RETURN CODE OF 4093 IS SET AND INFORMATION IS                  
      ******   DISPLAYED TO SYSOUT AND PROGRAM CONTINUES PROCESSING.            
      ****************************************************************          
196900                                                                          
197000 7200-CHANGE-LOC-TYP-CDE.                                                 
197100     MOVE '7200-CHANGE-LOC-TYP-CDE'   TO PV-ABEND-PARAGRAPH.              
197200                                                                          
197300     MOVE XL037-LOC-TYP-CDE           TO XLT00015-LOC-TYP-CDE             
197400     MOVE XL037-LOC-TYP-DESC          TO XLT00015-LOC-TYP-DESC            
197500                                                                          
197600                                                                          
197700     PERFORM                                                              
197800         WITH TEST AFTER                                                  
197900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
198000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
198100                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
198200                                                                          
198300     EXEC SQL                                                             
198400         UPDATE XLT_LOC_TYP_CDE                                           
198500         SET                                                              
198600              LOC_TYP_DESC = :XLT00015-LOC-TYP-DESC                       
198700         WHERE                                                            
198800              LOC_TYP_CDE  = :XLT00015-LOC-TYP-CDE                        
198900         END-EXEC                                                         
199000                                                                          
199100         EVALUATE TRUE                                                    
199200             WHEN SQLCODE = ZERO                                          
199300                 ADD 1                TO PV-XLT00015-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
199400             WHEN SQLCODE = +100                                          
199500                 ADD 1                TO PV-XLT00015-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
200200                 DISPLAY '**************************************'         
200300                 DISPLAY 'UPDATE OF LOC-TYP-CDE NOT FOUND  '              
200400                 DISPLAY 'LOC-TYP-CDE = '  XL037-LOC-TYP-CDE              
200500                 DISPLAY '**************************************'         
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00015-DUP-COUNT            
199600             WHEN SQLCODE = -904                                          
199700             WHEN SQLCODE = -911                                          
199800             WHEN SQLCODE = -913                                          
199900                 CONTINUE                                                 
200000                                                                          
200100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
200200                 DISPLAY '**************************************'         
200300                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00015   '        
200400                 DISPLAY 'LOC-TYP-CDE = ' XL037-LOC-TYP-CDE               
200500                 DISPLAY '**********************************'             
200600                 PERFORM 9800-SQL-WARNING                                 
200700                                                                          
200800             WHEN SQLCODE < ZERO                                          
200900                 DISPLAY '**************************************'         
201000                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00015 '            
201100                 DISPLAY 'LOC-TYP-CDE = ' XL037-LOC-TYP-CDE               
201200                 DISPLAY '**************************************'         
201300                 PERFORM 9900-SQL-ERROR                                   
201400                                                                          
201500         END-EVALUATE                                                     
201600     END-PERFORM                                                          
201700                                                                          
201800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
201900         SQLCODE NOT = ZERO                                               
202000         DISPLAY '**************************************'                 
202100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
202200         DISPLAY 'UPDATE TO XLT_LOC_TYP_CDE             '                 
202300         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00015  '                   
202400         DISPLAY 'LOC-TYP-CDE = ' XL037-LOC-TYP-CDE                       
202500         DISPLAY '**************************************'                 
202600         DISPLAY '**************************************'                 
202700         PERFORM 9900-SQL-ERROR                                           
202800     END-IF.                                                              
202900                                                                          
203000 7205-CHANGE-TM-ZN-CDE.                                                   
203100     MOVE '7205-CHANGE-TM-ZN-CDE'     TO PV-ABEND-PARAGRAPH.              
203200                                                                          
203300     MOVE XL037-STD-TM-ZN-CDE         TO XLT00016-STD-TM-ZN-CDE           
203400     MOVE XL037-STD-TM-ZN-DESC        TO XLT00016-STD-TM-ZN-DESC          
203500                                                                          
203600                                                                          
203700     PERFORM                                                              
203800         WITH TEST AFTER                                                  
203900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
204000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
204100                (SQLCODE = ZERO) OR (SQLCODE = -803))                     
204200                                                                          
204300     EXEC SQL                                                             
204400         UPDATE XLT_STD_TM_ZN_CDE                                         
204500         SET                                                              
204600              STD_TM_ZN_DESC = :XLT00016-STD-TM-ZN-DESC                   
204700         WHERE                                                            
204800              STD_TM_ZN_CDE  = :XLT00016-STD-TM-ZN-CDE                    
204900         END-EXEC                                                         
205000                                                                          
205100         EVALUATE TRUE                                                    
205200             WHEN SQLCODE = ZERO                                          
205300                 ADD 1                TO PV-XLT00016-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
205400             WHEN SQLCODE = +100                                          
205500                 ADD 1                TO PV-XLT00016-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
206200                 DISPLAY '**************************************'         
206300                 DISPLAY 'UPDATE OF STD-TM-ZN-CDE NOT FOUND     '         
206400                 DISPLAY 'STD-TM-ZN-CDE =' XL037-STD-TM-ZN-CDE            
206500                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00016-DUP-COUNT            
205600             WHEN SQLCODE = -904                                          
205700             WHEN SQLCODE = -911                                          
205800             WHEN SQLCODE = -913                                          
205900                 CONTINUE                                                 
206000                                                                          
206100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
206200                 DISPLAY '**************************************'         
206300                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00016   '        
206400                 DISPLAY 'STD-TM-ZN-CDE =' XL037-STD-TM-ZN-CDE            
206500                 DISPLAY '**********************************'             
206600                 PERFORM 9800-SQL-WARNING                                 
206700                                                                          
206800             WHEN SQLCODE < ZERO                                          
206900                 DISPLAY '**************************************'         
207000                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00016 '            
207100                 DISPLAY 'STD-TM-ZN-CDE =' XL037-STD-TM-ZN-CDE            
207200                 DISPLAY '**************************************'         
207300                 PERFORM 9900-SQL-ERROR                                   
207400                                                                          
207500         END-EVALUATE                                                     
207600     END-PERFORM                                                          
207700                                                                          
207800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
207900         SQLCODE NOT = ZERO                                               
208000         DISPLAY '**************************************'                 
208100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
208200         DISPLAY 'UPDATE TO XLTSTD_TM_ZN_CDE            '                 
208300         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00016  '                   
208400         DISPLAY 'STD-TM-ZN-CDE =' XL037-STD-TM-ZN-CDE                    
208500         DISPLAY '**************************************'                 
208600         DISPLAY '**************************************'                 
208700         PERFORM 9900-SQL-ERROR                                           
208800     END-IF.                                                              
208900                                                                          
209000 7210-CHANGE-STR-FMT-CDE.                                                 
209100     MOVE '7210-CHANGE-STR-FMT-CDE'   TO PV-ABEND-PARAGRAPH.              
209200                                                                          
209300     MOVE XL037-STR-FMT-CDE           TO XLT00017-STR-FMT-CDE             
209400     MOVE XL037-STR-FMT-DESC          TO XLT00017-STR-FMT-DESC            
209500                                                                          
209600                                                                          
209700     PERFORM                                                              
209800         WITH TEST AFTER                                                  
209900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
210000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
210100                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
210200                                                                          
210300     EXEC SQL                                                             
210400         UPDATE XLT_STR_FMT_CDE                                           
210500         SET                                                              
210600              STR_FMT_DESC   = :XLT00017-STR-FMT-DESC                     
210700         WHERE                                                            
210800              STR_FMT_CDE    = :XLT00017-STR-FMT-CDE                      
210900         END-EXEC                                                         
211000                                                                          
211100         EVALUATE TRUE                                                    
211200             WHEN SQLCODE = ZERO                                          
211300                 ADD 1                TO PV-XLT00017-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
211400             WHEN SQLCODE = +100                                          
211500                 ADD 1                TO PV-XLT00017-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
212200                 DISPLAY '**************************************'         
212300                 DISPLAY 'UPDATE OF STR-FMT-CDE NOT FOUND        '        
212400                 DISPLAY 'STR-FMT-CDE   =' XL037-STR-FMT-CDE              
212500                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00017-DUP-COUNT            
211600             WHEN SQLCODE = -904                                          
211700             WHEN SQLCODE = -911                                          
211800             WHEN SQLCODE = -913                                          
211900                 CONTINUE                                                 
212000                                                                          
212100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
212200                 DISPLAY '**************************************'         
212300                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00017   '        
212400                 DISPLAY 'STR-FMT-CDE   =' XL037-STR-FMT-CDE              
212500                 DISPLAY '**********************************'             
212600                 PERFORM 9800-SQL-WARNING                                 
212700                                                                          
212800             WHEN SQLCODE < ZERO                                          
212900                 DISPLAY '**************************************'         
213000                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00017 '            
213100                 DISPLAY 'STR-FMT-CDE   =' XLT00017-STR-FMT-CDE           
213200                 DISPLAY '**************************************'         
213300                 PERFORM 9900-SQL-ERROR                                   
213400                                                                          
213500         END-EVALUATE                                                     
213600     END-PERFORM                                                          
213700                                                                          
213800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
213900         SQLCODE NOT = ZERO                                               
214000         DISPLAY '**************************************'                 
214100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
214200         DISPLAY 'UPDATE TO XLT_STR_FMT_CDE             '                 
214300         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00017  '                   
214400         DISPLAY 'STR-FMT-CDE   =' XL037-STR-FMT-CDE                      
214500         DISPLAY '**************************************'                 
214600         DISPLAY '**************************************'                 
214700         PERFORM 9900-SQL-ERROR                                           
214800     END-IF.                                                              
214900                                                                          
215000 7215-CHANGE-TERR.                                                        
215100     MOVE '7215-CHANGE-TERR'          TO PV-ABEND-PARAGRAPH.              
215200                                                                          
215300     MOVE XL037-TERR-NBR              TO XLT00011-TERR-NBR                
215400     MOVE XL037-TERR-NM               TO XLT00011-TERR-NM                 
215500     MOVE XL037-TERR-MGR-NM           TO XLT00011-TERR-MGR-NM             
215600                                                                          
215700                                                                          
215800     PERFORM                                                              
215900         WITH TEST AFTER                                                  
216000         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
216100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
216200                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
216300                (SQLCODE = -803))                                         
                                                                                
216400     EXEC SQL                                                             
216500         UPDATE XLT_TERR                                                  
216600         SET                                                              
216700              TERR_NM        = :XLT00011-TERR-NM                          
216800         ,    TERR_MGR_NM    = :XLT00011-TERR-MGR-NM                      
216900         WHERE                                                            
217000              TERR_NBR       = :XLT00011-TERR-NBR                         
217100         END-EXEC                                                         
217200                                                                          
217300         EVALUATE TRUE                                                    
217400             WHEN SQLCODE = ZERO                                          
217500                 ADD 1                TO PV-XLT00011-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
217600             WHEN SQLCODE = +100                                          
217700                 ADD 1                TO PV-XLT00011-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
218400                 DISPLAY '**************************************'         
218500                 DISPLAY 'UPDATE OF TERR-NBR NOT FOUND   '                
218600                 DISPLAY 'TERR-NBR      =' XL037-TERR-NBR                 
                       DISPLAY 'TERR-NM       =' XL037-TERR-NM                  
                       DISPLAY 'TERR-MGR-NM   =' XL037-TERR-MGR-NM              
218700                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00011-DUP-COUNT            
217800             WHEN SQLCODE = -904                                          
217900             WHEN SQLCODE = -911                                          
218000             WHEN SQLCODE = -913                                          
218100                 CONTINUE                                                 
218200                                                                          
218300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
218400                 DISPLAY '**************************************'         
218500                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00011   '        
218600                 DISPLAY 'TERR-NBR      =' XL037-TERR-NBR                 
                       DISPLAY 'TERR-NM       =' XL037-TERR-NM                  
                       DISPLAY 'TERR-MGR-NM   =' XL037-TERR-MGR-NM              
218700                 DISPLAY '**********************************'             
218800                 PERFORM 9800-SQL-WARNING                                 
218900                                                                          
219000             WHEN SQLCODE < ZERO                                          
219100                 DISPLAY '**************************************'         
219200                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00011 '            
218600                 DISPLAY 'TERR-NBR      =' XL037-TERR-NBR                 
                       DISPLAY 'TERR-NM       =' XL037-TERR-NM                  
                       DISPLAY 'TERR-MGR-NM   =' XL037-TERR-MGR-NM              
219400                 DISPLAY '**************************************'         
219500                 PERFORM 9900-SQL-ERROR                                   
219600                                                                          
219700         END-EVALUATE                                                     
219800     END-PERFORM                                                          
219900                                                                          
220000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
220100         SQLCODE NOT = ZERO                                               
220200         DISPLAY '**************************************'                 
220300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
220400         DISPLAY 'UPDATE TO XLT_TERR                    '                 
220500         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00011  '                   
218600         DISPLAY 'TERR-NBR      =' XL037-TERR-NBR                         
               DISPLAY 'TERR-NM       =' XL037-TERR-NM                          
               DISPLAY 'TERR-MGR-NM   =' XL037-TERR-MGR-NM                      
220700         DISPLAY '**************************************'                 
220800         DISPLAY '**************************************'                 
220900         PERFORM 9900-SQL-ERROR                                           
221000     END-IF.                                                              
221100                                                                          
221200 7220-CHANGE-REGN.                                                        
221300     MOVE '7220-CHANGE-REGN'          TO PV-ABEND-PARAGRAPH.              
221400                                                                          
221500     MOVE XL037-REGN-NBR              TO XLT00012-REGN-NBR                
221600     MOVE XL037-REGN-NM               TO XLT00012-REGN-NM                 
221700     MOVE XL037-REGN-MGR-NM           TO XLT00012-REGN-MGR-NM             
221800     MOVE XL037-REGN-TERR-NBR         TO XLT00012-TERR-NBR                
221900                                                                          
222000                                                                          
222100     PERFORM                                                              
222200         WITH TEST AFTER                                                  
222300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
222400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
222500                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
222600                                                                          
222700     EXEC SQL                                                             
222800         UPDATE XLT_REGN                                                  
222900         SET                                                              
223000              REGN_NM        = :XLT00012-REGN-NM                          
223100         ,    REGN_MGR_NM    = :XLT00012-REGN-MGR-NM                      
223200         ,    TERR_NBR       = :XLT00012-TERR-NBR                         
223300         WHERE                                                            
223400              REGN_NBR       = :XLT00012-REGN-NBR                         
223500         END-EXEC                                                         
223600                                                                          
223700         EVALUATE TRUE                                                    
223800             WHEN SQLCODE = ZERO                                          
223900                 ADD 1                TO PV-XLT00012-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
224000             WHEN SQLCODE = +100                                          
224100                 ADD 1                TO PV-XLT00012-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
224800                 DISPLAY '**************************************'         
224900                 DISPLAY 'UPDATE OF REGN-NBR NOT FOUND  '                 
225000                 DISPLAY 'REGN-NBR      =' XL037-REGN-NBR                 
                       DISPLAY 'REGN-NM       =' XL037-REGN-NM                  
                       DISPLAY 'REGN-MGR-NM   =' XL037-REGN-MGR-NM              
                       DISPLAY 'TERR-NBR      =' XL037-REGN-TERR-NBR            
225100                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00012-DUP-COUNT            
224200             WHEN SQLCODE = -904                                          
224300             WHEN SQLCODE = -911                                          
224400             WHEN SQLCODE = -913                                          
224500                 CONTINUE                                                 
224600                                                                          
224700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
224800                 DISPLAY '**************************************'         
224900                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00012   '        
225000                 DISPLAY 'REGN-NBR      =' XL037-REGN-NBR                 
                       DISPLAY 'REGN-NM       =' XL037-REGN-NM                  
                       DISPLAY 'REGN-MGR-NM   =' XL037-REGN-MGR-NM              
                       DISPLAY 'TERR-NBR      =' XL037-REGN-TERR-NBR            
225100                 DISPLAY '**********************************'             
225200                 PERFORM 9800-SQL-WARNING                                 
225300                                                                          
225400             WHEN SQLCODE < ZERO                                          
225500                 DISPLAY '**************************************'         
225600                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00012 '            
225000                 DISPLAY 'REGN-NBR      =' XL037-REGN-NBR                 
                       DISPLAY 'REGN-NM       =' XL037-REGN-NM                  
                       DISPLAY 'REGN-MGR-NM   =' XL037-REGN-MGR-NM              
                       DISPLAY 'TERR-NBR      =' XL037-REGN-TERR-NBR            
225800                 DISPLAY '**************************************'         
225900                 PERFORM 9900-SQL-ERROR                                   
226000                                                                          
226100         END-EVALUATE                                                     
226200     END-PERFORM                                                          
226300                                                                          
226400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
226500         SQLCODE NOT = ZERO                                               
226600         DISPLAY '**************************************'                 
226700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
226800         DISPLAY 'UPDATE TO XLT_REGN                    '                 
226900         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00012  '                   
225000         DISPLAY 'REGN-NBR      =' XL037-REGN-NBR                         
               DISPLAY 'REGN-NM       =' XL037-REGN-NM                          
               DISPLAY 'REGN-MGR-NM   =' XL037-REGN-MGR-NM                      
               DISPLAY 'TERR-NBR      =' XL037-REGN-TERR-NBR                    
227100         DISPLAY '**************************************'                 
227200         DISPLAY '**************************************'                 
227300         PERFORM 9900-SQL-ERROR                                           
227400     END-IF.                                                              
227500                                                                          
227600 7225-CHANGE-DIST.                                                        
227700     MOVE '7225-CHANGE-DIST'          TO PV-ABEND-PARAGRAPH.              
227800                                                                          
227900     MOVE XL037-DIST-NBR              TO XLT00013-DIST-NBR                
228000     MOVE XL037-DIST-NM               TO XLT00013-DIST-NM                 
228100     MOVE XL037-DIST-MGR-NM           TO XLT00013-DIST-MGR-NM             
228200     MOVE XL037-DIST-REGN-NBR         TO XLT00013-REGN-NBR                
228300                                                                          
228400                                                                          
228500     PERFORM                                                              
228600         WITH TEST AFTER                                                  
228700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
228800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
228900                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
229000                                                                          
229100     EXEC SQL                                                             
229200         UPDATE XLT_DIST                                                  
229300         SET                                                              
229400              DIST_NM        = :XLT00013-DIST-NM                          
229500         ,    DIST_MGR_NM    = :XLT00013-DIST-MGR-NM                      
229600         ,    REGN_NBR       = :XLT00013-REGN-NBR                         
229700         WHERE                                                            
229800              DIST_NBR       = :XLT00013-DIST-NBR                         
229900         END-EXEC                                                         
230000                                                                          
230100         EVALUATE TRUE                                                    
230200             WHEN SQLCODE = ZERO                                          
230300                 ADD 1                TO PV-XLT00013-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
230400             WHEN SQLCODE = +100                                          
230500                 ADD 1                TO PV-XLT00013-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
231200                 DISPLAY '**************************************'         
231300                 DISPLAY 'UPDATE OF DIST-NBR NOT FOUND  '                 
231400                 DISPLAY 'DIST-NBR      =' XL037-DIST-NBR                 
                       DISPLAY 'DIST-NM       =' XL037-DIST-NM                  
                       DISPLAY 'DIST-MGR-NM   =' XL037-DIST-MGR-NM              
                       DISPLAY 'REGN-NBR      =' XL037-DIST-REGN-NBR            
231500                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00013-DUP-COUNT            
230600             WHEN SQLCODE = -904                                          
230700             WHEN SQLCODE = -911                                          
230800             WHEN SQLCODE = -913                                          
230900                 CONTINUE                                                 
231000                                                                          
231100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
231200                 DISPLAY '**************************************'         
231300                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00013   '        
231400                 DISPLAY 'DIST-NBR      =' XL037-DIST-NBR                 
                       DISPLAY 'DIST-NM       =' XL037-DIST-NM                  
                       DISPLAY 'DIST-MGR-NM   =' XL037-DIST-MGR-NM              
                       DISPLAY 'DIST-REGN-NBR =' XL037-DIST-REGN-NBR            
231500                 DISPLAY '**********************************'             
231600                 PERFORM 9800-SQL-WARNING                                 
231700                                                                          
231800             WHEN SQLCODE < ZERO                                          
231900                 DISPLAY '**************************************'         
232000                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00013 '            
231400                 DISPLAY 'DIST-NBR      =' XL037-DIST-NBR                 
                       DISPLAY 'DIST-NM       =' XL037-DIST-NM                  
                       DISPLAY 'DIST-MGR-NM   =' XL037-DIST-MGR-NM              
                       DISPLAY 'REGN-NBR      =' XL037-DIST-REGN-NBR            
232200                 DISPLAY '**************************************'         
232300                 PERFORM 9900-SQL-ERROR                                   
232400                                                                          
232500         END-EVALUATE                                                     
232600     END-PERFORM                                                          
232700                                                                          
232800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
232900         SQLCODE NOT = ZERO                                               
233000         DISPLAY '**************************************'                 
233100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
233200         DISPLAY 'UPDATE TO XLT_DIST                    '                 
233300         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00013  '                   
231400         DISPLAY 'DIST-NBR      =' XL037-DIST-NBR                         
               DISPLAY 'DIST-NM       =' XL037-DIST-NM                          
               DISPLAY 'DIST-MGR-NM   =' XL037-DIST-MGR-NM                      
               DISPLAY 'REGN-NBR      =' XL037-DIST-REGN-NBR                    
233500         DISPLAY '**************************************'                 
233600         DISPLAY '**************************************'                 
233700         PERFORM 9900-SQL-ERROR                                           
233800     END-IF.                                                              
233900                                                                          
234000 7230-CHANGE-LOC.                                                         
234100     MOVE '7225-CHANGE-LOC'           TO PV-ABEND-PARAGRAPH.              
234200                                                                          
234300     MOVE XL037-LOC-NBR               TO XLT00010-LOC-NBR                 
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-REPLT-STR-NBR = ZERO                                    
               MOVE -1 TO DN-REPLT-STR-NBR                                      
           ELSE                                                                 
               MOVE 0 TO DN-REPLT-STR-NBR                                       
           END-IF                                                               
234400     MOVE XL037-LOC-REPLT-STR-NBR     TO XLT00010-REPLT-STR-NBR           
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-DIST-NBR = ZERO                                         
               MOVE -1 TO DN-DIST-NBR                                           
           ELSE                                                                 
               MOVE 0 TO DN-DIST-NBR                                            
           END-IF                                                               
234500     MOVE XL037-LOC-DIST-NBR          TO XLT00010-DIST-NBR                
234600     MOVE XL037-LOC-LOC-TYP-CDE       TO XLT00010-LOC-TYP-CDE             
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-STR-FMT-CDE = ZERO                                      
               MOVE -1 TO DN-STR-FMT-CDE                                        
           ELSE                                                                 
               MOVE 0 TO DN-STR-FMT-CDE                                         
           END-IF                                                               
           MOVE XL037-LOC-STR-FMT-CDE       TO XLT00010-STR-FMT-CDE             
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-STD-TM-ZN-CDE = SPACE                                   
               MOVE -1 TO DN-STD-TM-ZN-CDE                                      
           ELSE                                                                 
               MOVE 0 TO DN-STD-TM-ZN-CDE                                       
           END-IF                                                               
234800     MOVE XL037-LOC-STD-TM-ZN-CDE     TO XLT00010-STD-TM-ZN-CDE           
                                                                                
234900     MOVE XL037-LOC-NM                TO XLT00010-LOC-NM                  
235000     MOVE XL037-LOC-5-ABBR-NM         TO XLT00010-LOC-5-ABBR-NM           
           MOVE XL037-LOC-LNE-1-ADDR        TO XLT00010-LNE-1-ADDR              
           MOVE XL037-LOC-LNE-2-ADDR        TO XLT00010-LNE-2-ADDR              
           MOVE XL037-LOC-CTY-NME           TO XLT00010-CTY-NM                  
           MOVE XL037-LOC-ST-CDE            TO XLT00010-ST-CDE                  
           MOVE XL037-LOC-ZIP-10-CDE        TO XLT00010-ZIP-10-CDE              
           MOVE XL037-LOC-OPN-DTE           TO XLT00010-OPN-DTE                 
           MOVE XL037-LOC-CLO-DTE           TO XLT00010-CLO-DTE                 
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-LOC-10-ABBR-NM = SPACE                                  
               MOVE -1 TO DN-LOC-10-ABBR-NM                                     
           ELSE                                                                 
               MOVE 0 TO DN-LOC-10-ABBR-NM                                      
           END-IF                                                               
           MOVE XL037-LOC-LOC-10-ABBR-NM    TO XLT00010-LOC-10-ABBR-NM          
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-PHN-NBR = SPACE                                         
               MOVE -1 TO DN-PHN-NBR                                            
           ELSE                                                                 
               MOVE 0 TO DN-PHN-NBR                                             
           END-IF                                                               
235900     MOVE XL037-LOC-PHN-NBR           TO XLT00010-PHN-NBR                 
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-MGR-NM = SPACE                                          
               MOVE -1 TO DN-MGR-NM                                             
           ELSE                                                                 
               MOVE 0 TO DN-MGR-NM                                              
           END-IF                                                               
236000     MOVE XL037-LOC-MGR-NM            TO XLT00010-MGR-NM                  
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-FINCL-CLO-DTE = SPACE                                   
              OR XL037-LOC-FINCL-CLO-DTE = '9999-09-09'                         
               MOVE -1 TO DN-FINCL-CLO-DTE                                      
           ELSE                                                                 
               MOVE 0 TO DN-FINCL-CLO-DTE                                       
           END-IF                                                               
236100     MOVE XL037-LOC-FINCL-CLO-DTE     TO XLT00010-FINCL-CLO-DTE           
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-MN-SLS-INCL-DTE = SPACE                                 
              OR XL037-LOC-MN-SLS-INCL-DTE = '9999-09-09'                       
               MOVE -1 TO DN-MN-SLS-INCL-DTE                                    
           ELSE                                                                 
               MOVE 0 TO DN-MN-SLS-INCL-DTE                                     
           END-IF                                                               
236200     MOVE XL037-LOC-MN-SLS-INCL-DTE   TO XLT00010-MN-SLS-INCL-DTE         
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-YR-SLS-INCL-DTE = SPACE                                 
              OR XL037-LOC-YR-SLS-INCL-DTE = '9999-09-09'                       
               MOVE -1 TO DN-YR-SLS-INCL-DTE                                    
           ELSE                                                                 
               MOVE 0 TO DN-YR-SLS-INCL-DTE                                     
           END-IF                                                               
236300     MOVE XL037-LOC-YR-SLS-INCL-DTE   TO XLT00010-YR-SLS-INCL-DTE         
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-OCPNC-DTE = SPACE                                       
              OR XL037-LOC-OCPNC-DTE = '9999-09-09'                             
               MOVE -1 TO DN-OCPNC-DTE                                          
           ELSE                                                                 
               MOVE 0 TO DN-OCPNC-DTE                                           
           END-IF                                                               
236400     MOVE XL037-LOC-OCPNC-DTE         TO XLT00010-OCPNC-DTE               
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-POS-RGST-BNK-QTY = ZERO                                 
               MOVE -1 TO DN-POS-RGST-BNK-QTY                                   
           ELSE                                                                 
               MOVE 0 TO DN-POS-RGST-BNK-QTY                                    
           END-IF                                                               
236500     MOVE XL037-LOC-POS-RGST-BNK-QTY                                      
236600                                    TO XLT00010-POS-RGST-BNK-QTY          
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-DST-IND = SPACE                                         
               MOVE -1 TO DN-DST-IND                                            
           ELSE                                                                 
               MOVE 0 TO DN-DST-IND                                             
           END-IF                                                               
236700     MOVE XL037-LOC-DST-IND         TO XLT00010-DST-IND                   
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-E-BUS-IND = SPACE                                       
               MOVE -1 TO DN-E-BUS-IND                                          
           ELSE                                                                 
               MOVE 0 TO DN-E-BUS-IND                                           
           END-IF                                                               
236800     MOVE XL037-LOC-E-BUS-IND       TO XLT00010-E-BUS-IND                 
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-SLS-INCL-DTE-CDE = SPACE                                
               MOVE -1 TO DN-SLS-INCL-DTE-CDE                                   
           ELSE                                                                 
               MOVE 0 TO DN-SLS-INCL-DTE-CDE                                    
           END-IF                                                               
236900     MOVE XL037-LOC-SLS-INCL-DTE-CDE                                      
237000                                    TO XLT00010-SLS-INCL-DTE-CDE          
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-TOT-SLG-SQ-FTG-QTY = ZERO                               
               MOVE -1 TO DN-TOT-SLG-SQ-FTG-QTY                                 
           ELSE                                                                 
               MOVE 0 TO DN-TOT-SLG-SQ-FTG-QTY                                  
           END-IF                                                               
237100     MOVE XL037-LOC-TOT-SLG-SQ-FTG-QTY                                    
237200                                TO XLT00010-TOT-SLG-SQ-FTG-QTY            
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-TOT-SQ-FTG-QTY = ZERO                                   
               MOVE -1 TO DN-TOT-SQ-FTG-QTY                                     
           ELSE                                                                 
               MOVE 0 TO DN-TOT-SQ-FTG-QTY                                      
           END-IF                                                               
237300     MOVE XL037-LOC-TOT-SQ-FTG-QTY  TO XLT00010-TOT-SQ-FTG-QTY            
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-STP-ORD-DAYS-QTY = ZERO                                 
               MOVE -1 TO DN-STP-ORD-DAYS-QTY                                   
           ELSE                                                                 
               MOVE 0 TO DN-STP-ORD-DAYS-QTY                                    
           END-IF                                                               
237400     MOVE XL037-LOC-STP-ORD-DAYS-QTY                                      
237500                                    TO XLT00010-STP-ORD-DAYS-QTY          
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-STRT-ORD-DAYS-QTY = ZERO                                
               MOVE -1 TO DN-STRT-ORD-DAYS-QTY                                  
           ELSE                                                                 
               MOVE 0 TO DN-STRT-ORD-DAYS-QTY                                   
           END-IF                                                               
237600     MOVE XL037-LOC-STRT-ORD-DAYS-QTY                                     
237700                                    TO XLT00010-STRT-ORD-DAYS-QTY         
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-ACQR-DTE = SPACE                                        
              OR XL037-LOC-ACQR-DTE = '9999-09-09'                              
               MOVE -1 TO DN-ACQR-DTE                                           
           ELSE                                                                 
               MOVE 0 TO DN-ACQR-DTE                                            
           END-IF                                                               
237800     MOVE XL037-LOC-ACQR-DTE        TO XLT00010-ACQR-DTE                  
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-RMDL-DTE = SPACE                                        
              OR XL037-LOC-RMDL-DTE = '9999-09-09'                              
               MOVE -1 TO DN-RMDL-DTE                                           
           ELSE                                                                 
               MOVE 0 TO DN-RMDL-DTE                                            
           END-IF                                                               
237900     MOVE XL037-LOC-RMDL-DTE        TO XLT00010-RMDL-DTE                  
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-MEDN-AGE-NBR = '00.00'                                  
               MOVE -1 TO DN-MEDN-AGE-NBR                                       
           ELSE                                                                 
               MOVE 0 TO DN-MEDN-AGE-NBR                                        
           END-IF                                                               
238000     MOVE XL037-LOC-MEDN-AGE-NBR-RDF   TO XLT00010-MEDN-AGE-NBR           
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-EST-HH-INCM-AMT = ZERO                                  
               MOVE -1 TO DN-EST-HH-INCM-AMT                                    
           ELSE                                                                 
               MOVE 0 TO DN-EST-HH-INCM-AMT                                     
           END-IF                                                               
238100     MOVE XL037-LOC-EST-HH-INCM-AMT TO XLT00010-EST-HH-INCM-AMT           
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-QTR-SLS-INCL-DTE = SPACE                                
              OR XL037-LOC-QTR-SLS-INCL-DTE = '9999-09-09'                      
               MOVE -1 TO DN-QTR-SLS-INCL-DTE                                   
           ELSE                                                                 
               MOVE 0 TO DN-QTR-SLS-INCL-DTE                                    
           END-IF                                                               
238200     MOVE XL037-LOC-QTR-SLS-INCL-DTE                                      
238300                                    TO XLT00010-QTR-SLS-INCL-DTE          
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-SEA-SLS-INCL-DTE = SPACE                                
              OR XL037-LOC-SEA-SLS-INCL-DTE = '9999-09-09'                      
               MOVE -1 TO DN-SEA-SLS-INCL-DTE                                   
           ELSE                                                                 
               MOVE 0 TO DN-SEA-SLS-INCL-DTE                                    
           END-IF                                                               
238400     MOVE XL037-LOC-SEA-SLS-INCL-DTE                                      
238500                                    TO XLT00010-SEA-SLS-INCL-DTE          
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-EXTD-MALL-NM = SPACE                                    
               MOVE -1 TO DN-EXTD-MALL-NM                                       
           ELSE                                                                 
               MOVE 0 TO DN-EXTD-MALL-NM                                        
           END-IF                                                               
238600     MOVE XL037-LOC-EXTD-MALL-NM    TO XLT00010-EXTD-MALL-NM              
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-GRND-OPN-DTE = SPACE                                    
              OR XL037-LOC-GRND-OPN-DTE = '9999-09-09'                          
               MOVE -1 TO DN-GRND-OPN-DTE                                       
           ELSE                                                                 
               MOVE 0 TO DN-GRND-OPN-DTE                                        
           END-IF                                                               
238700     MOVE XL037-LOC-GRND-OPN-DTE    TO XLT00010-GRND-OPN-DTE              
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-PRCHG-CRE-IND = SPACE                                   
               MOVE -1 TO DN-PRCHG-CRE-IND                                      
           ELSE                                                                 
               MOVE 0 TO DN-PRCHG-CRE-IND                                       
           END-IF                                                               
238800     MOVE XL037-LOC-PRCHG-CRE-IND   TO XLT00010-PRCHG-CRE-IND             
                                                                                
      ****   CHECK FOR NULLS ****                                               
           IF XL037-LOC-IN-STR-PRCHG-IND = SPACE                                
               MOVE -1 TO DN-IN-STR-PRCHG-IND                                   
           ELSE                                                                 
               MOVE 0 TO DN-IN-STR-PRCHG-IND                                    
           END-IF                                                               
238900     MOVE XL037-LOC-IN-STR-PRCHG-IND                                      
239000                                    TO XLT00010-IN-STR-PRCHG-IND          
                                                                                
      ****   CHECK FOR NULLS ****                                               
      *****    ALWAYS MOVE +255 TO TXT-LEN VAR CHAR FIELD  *****                
      *****    WHEN TEXT IS GREATER THAN SPACE             *****                
           IF XL037-LOC-DIRNS-TXT = SPACE                                       
               MOVE -1 TO DN-DIRNS-TXT                                          
           ELSE                                                                 
               MOVE 0 TO DN-DIRNS-TXT                                           
               MOVE PV-DIRNS-TXT-LEN      TO XLT00010-DIRNS-TXT-LEN             
           END-IF                                                               
239100     MOVE XL037-LOC-DIRNS-TXT       TO XLT00010-DIRNS-TXT-TEXT            
                                                                                
           PERFORM 2150-SET-CURRENT-TMST                                        
           MOVE PV-CURRENT-TMST           TO XLT00010-LAST-UPD-TMST             
239200                                                                          
239300     PERFORM                                                              
239400         WITH TEST AFTER                                                  
239500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
239600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
239700                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
 39800                (SQLCODE = -803))                                         
239900     EXEC SQL                                                             
240000         UPDATE XLT_LOC                                                   
240100         SET                                                              
240200              REPLT_STR_NBR  = :XLT00010-REPLT-STR-NBR                    
                                         :DN-REPLT-STR-NBR                      
240300         ,    DIST_NBR       = :XLT00010-DIST-NBR                         
                                         :DN-DIST-NBR                           
240400         ,    LOC_TYP_CDE    = :XLT00010-LOC-TYP-CDE                      
240500         ,    STR_FMT_CDE    = :XLT00010-STR-FMT-CDE                      
                                         :DN-STR-FMT-CDE                        
240600         ,    STD_TM_ZN_CDE  = :XLT00010-STD-TM-ZN-CDE                    
                                         :DN-STD-TM-ZN-CDE                      
240700         ,    LOC_NM         = :XLT00010-LOC-NM                           
240800         ,    LOC_5_ABBR_NM  = :XLT00010-LOC-5-ABBR-NM                    
240900         ,    LNE_1_ADDR     = :XLT00010-LNE-1-ADDR                       
241000         ,    LNE_2_ADDR     = :XLT00010-LNE-2-ADDR                       
241100         ,    CTY_NM         = :XLT00010-CTY-NM                           
241200         ,    ST_CDE         = :XLT00010-ST-CDE                           
241300         ,    ZIP_10_CDE     = :XLT00010-ZIP-10-CDE                       
241400         ,    OPN_DTE        = :XLT00010-OPN-DTE                          
241500         ,    CLO_DTE        = :XLT00010-CLO-DTE                          
241600         ,    LOC_10_ABBR_NM = :XLT00010-LOC-10-ABBR-NM                   
                                         :DN-LOC-10-ABBR-NM                     
241700         ,    PHN_NBR        = :XLT00010-PHN-NBR                          
                                         :DN-PHN-NBR                            
241800         ,    MGR_NM         = :XLT00010-MGR-NM                           
                                         :DN-MGR-NM                             
241900         ,    FINCL_CLO_DTE  = :XLT00010-FINCL-CLO-DTE                    
                                         :DN-FINCL-CLO-DTE                      
242000         ,    MN_SLS_INCL_DTE  = :XLT00010-MN-SLS-INCL-DTE                
                                         :DN-MN-SLS-INCL-DTE                    
242100         ,    YR_SLS_INCL_DTE  = :XLT00010-YR-SLS-INCL-DTE                
                                         :DN-YR-SLS-INCL-DTE                    
242200         ,    OCPNC_DTE        = :XLT00010-OCPNC-DTE                      
                                         :DN-OCPNC-DTE                          
242300         ,    POS_RGST_BNK_QTY = :XLT00010-POS-RGST-BNK-QTY               
                                         :DN-POS-RGST-BNK-QTY                   
242400         ,    DST_IND          = :XLT00010-DST-IND                        
                                         :DN-DST-IND                            
242500         ,    E_BUS_IND        = :XLT00010-E-BUS-IND                      
                                         :DN-E-BUS-IND                          
242600         ,    SLS_INCL_DTE_CDE = :XLT00010-SLS-INCL-DTE-CDE               
                                         :DN-SLS-INCL-DTE-CDE                   
242700         ,    TOT_SLG_SQ_FTG_QTY = :XLT00010-TOT-SLG-SQ-FTG-QTY           
                                         :DN-TOT-SLG-SQ-FTG-QTY                 
242800         ,    TOT_SQ_FTG_QTY     = :XLT00010-TOT-SQ-FTG-QTY               
                                         :DN-TOT-SQ-FTG-QTY                     
242900         ,    STP_ORD_DAYS_QTY   = :XLT00010-STP-ORD-DAYS-QTY             
                                         :DN-STP-ORD-DAYS-QTY                   
243000         ,    STRT_ORD_DAYS_QTY  = :XLT00010-STRT-ORD-DAYS-QTY            
                                         :DN-STRT-ORD-DAYS-QTY                  
243100         ,    ACQR_DTE           = :XLT00010-ACQR-DTE                     
                                         :DN-ACQR-DTE                           
243200         ,    RMDL_DTE           = :XLT00010-RMDL-DTE                     
                                         :DN-RMDL-DTE                           
243300         ,    MEDN_AGE_NBR       = :XLT00010-MEDN-AGE-NBR                 
                                         :DN-MEDN-AGE-NBR                       
243400         ,    EST_HH_INCM_AMT    = :XLT00010-EST-HH-INCM-AMT              
                                         :DN-EST-HH-INCM-AMT                    
243500         ,    QTR_SLS_INCL_DTE   = :XLT00010-QTR-SLS-INCL-DTE             
                                         :DN-QTR-SLS-INCL-DTE                   
243600         ,    SEA_SLS_INCL_DTE   = :XLT00010-SEA-SLS-INCL-DTE             
                                         :DN-SEA-SLS-INCL-DTE                   
243700         ,    EXTD_MALL_NM       = :XLT00010-EXTD-MALL-NM                 
                                         :DN-EXTD-MALL-NM                       
243800         ,    GRND_OPN_DTE       = :XLT00010-GRND-OPN-DTE                 
                                         :DN-GRND-OPN-DTE                       
243900         ,    DIRNS_TXT          = :XLT00010-DIRNS-TXT                    
                                         :DN-DIRNS-TXT                          
244000         ,    PRCHG_CRE_IND      = :XLT00010-PRCHG-CRE-IND                
                                         :DN-PRCHG-CRE-IND                      
244100         ,    IN_STR_PRCHG_IND   = :XLT00010-IN-STR-PRCHG-IND             
                                         :DN-IN-STR-PRCHG-IND                   
244200         ,    LAST_UPD_TMST      = :XLT00010-LAST-UPD-TMST                
244300         WHERE                                                            
244400              LOC_NBR        = :XLT00010-LOC-NBR                          
244500         END-EXEC                                                         
244600                                                                          
244700         EVALUATE TRUE                                                    
244800             WHEN SQLCODE = ZERO                                          
244900                 ADD 1                TO PV-XLT00010-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
245000             WHEN SQLCODE = +100                                          
245100                 ADD 1                TO PV-XLT00010-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
245800                 DISPLAY '**************************************'         
245900                 DISPLAY 'UPDATE OF LOC-NBR NOT FOUND  '                  
246000                 DISPLAY 'LOC-NBR       =' XL037-LOC-NBR                  
246100                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00010-DUP-COUNT            
245200             WHEN SQLCODE = -904                                          
245300             WHEN SQLCODE = -911                                          
245400             WHEN SQLCODE = -913                                          
245500                 CONTINUE                                                 
245600                                                                          
245700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
245800                 DISPLAY '**************************************'         
245900                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00010'           
246000                 DISPLAY 'LOC-NBR       =' XL037-LOC-NBR                  
246100                 DISPLAY '**********************************'             
246200                 PERFORM 9800-SQL-WARNING                                 
246300                                                                          
246400             WHEN SQLCODE < ZERO                                          
246500                 DISPLAY '**************************************'         
246600                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00010 '            
246700                 DISPLAY 'LOC-NBR       =' XL037-LOC-NBR                  
246800                 DISPLAY '**************************************'         
246900                 PERFORM 9900-SQL-ERROR                                   
247000                                                                          
247100         END-EVALUATE                                                     
247200     END-PERFORM                                                          
247300                                                                          
247400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
247500         SQLCODE NOT = ZERO                                               
247600         DISPLAY '**************************************'                 
247700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
247800         DISPLAY 'UPDATE TO XLT_LOC                     '                 
247900         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00010  '                   
248000         DISPLAY 'LOC-NBR       =' XL037-LOC-NBR                          
248100         DISPLAY '**************************************'                 
248200         DISPLAY '**************************************'                 
248300         PERFORM 9900-SQL-ERROR                                           
248400     END-IF.                                                              
248500                                                                          
248600 7235-CHANGE-DC-LOC-ASGNT.                                                
248700     MOVE '7235-CHANGE-DC-LOC-ASGNT'  TO PV-ABEND-PARAGRAPH.              
248800                                                                          
248900     MOVE XL037-DCLOC-LOC-NBR         TO XLT00014-LOC-NBR                 
249000     MOVE XL037-DCLOC-EFF-BEG-DTE     TO XLT00014-EFF-BEG-DTE             
249100     MOVE XL037-DCLOC-PO-STRT-DTE     TO XLT00014-PO-STRT-DTE             
249200     MOVE XL037-DCLOC-DC-NBR          TO XLT00014-DC-NBR                  
249300                                                                          
249400                                                                          
249500     PERFORM                                                              
249600         WITH TEST AFTER                                                  
249700         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
249800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
249900                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
250000                                                                          
250100     EXEC SQL                                                             
250200         UPDATE XLT_DC_LOC_ASGMT                                          
250300         SET                                                              
250400              PO_STRT_DTE    = :XLT00014-PO-STRT-DTE                      
250500         ,    DC_NBR         = :XLT00014-DC-NBR                           
250600         WHERE                                                            
250700              LOC_NBR        = :XLT00014-LOC-NBR                          
250800          AND EFF_BEG_DTE    = :XLT00014-EFF-BEG-DTE                      
250900         END-EXEC                                                         
251000                                                                          
251100         EVALUATE TRUE                                                    
251200             WHEN SQLCODE = ZERO                                          
251300                 ADD 1                TO PV-XLT00014-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
251400             WHEN SQLCODE = +100                                          
251500                 ADD 1                TO PV-XLT00014-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
252200                 DISPLAY '**************************************'         
252300                 DISPLAY 'UPDATE OF DC-LOC-ASGNT NOT FOUND  '             
252400                 DISPLAY 'LOC-NBR       =' XL037-DCLOC-LOC-NBR            
                       DISPLAY 'EFF-BEG-DTE=' XL037-DCLOC-EFF-BEG-DTE           
252500                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00014-DUP-COUNT            
251600             WHEN SQLCODE = -904                                          
251700             WHEN SQLCODE = -911                                          
251800             WHEN SQLCODE = -913                                          
251900                 CONTINUE                                                 
252000                                                                          
252100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
252200                 DISPLAY '**************************************'         
252300                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00014   '        
252400                 DISPLAY 'LOC-NBR     =' XL037-DCLOC-LOC-NBR              
                       DISPLAY 'EFF-BEG-DTE=' XL037-DCLOC-EFF-BEG-DTE           
252500                 DISPLAY '**********************************'             
252600                 PERFORM 9800-SQL-WARNING                                 
252700                                                                          
252800             WHEN SQLCODE < ZERO                                          
252900                 DISPLAY '**************************************'         
253000                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00014 '            
252400                 DISPLAY 'LOC-NBR     =' XL037-DCLOC-LOC-NBR              
                       DISPLAY 'EFF-BEG-DTE=' XL037-DCLOC-EFF-BEG-DTE           
253200                 DISPLAY '**************************************'         
253300                 PERFORM 9900-SQL-ERROR                                   
253400                                                                          
253500         END-EVALUATE                                                     
253600     END-PERFORM                                                          
253700                                                                          
253800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
253900         SQLCODE NOT = ZERO                                               
254000         DISPLAY '**************************************'                 
254100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
254200         DISPLAY 'UPDATE TO XLT_DC_LOC_ASGMT            '                 
254300         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00014  '                   
252400         DISPLAY 'LOC-NBR     =' XL037-DCLOC-LOC-NBR                      
               DISPLAY 'EFF-BEG-DTE=' XL037-DCLOC-EFF-BEG-DTE                   
254500         DISPLAY '**************************************'                 
254600         DISPLAY '**************************************'                 
254700         PERFORM 9900-SQL-ERROR                                           
254800     END-IF.                                                              
254900                                                                          
255000 7240-CHANGE-STR-GP-TYP.                                                  
255100     MOVE '7240-CHANGE-STR-GP-TYP'    TO PV-ABEND-PARAGRAPH.              
255200                                                                          
255300     MOVE XL037-STR-GP-TYP-CDE        TO XLT00019-STR-GP-TYP-CDE          
255400     MOVE XL037-STR-GP-TYP-NM         TO XLT00019-STR-GP-TYP-NM           
255500                                                                          
255600                                                                          
255700     PERFORM                                                              
255800         WITH TEST AFTER                                                  
255900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
256000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
256100                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
256200                                                                          
256300     EXEC SQL                                                             
256400         UPDATE XLT_STR_GP_TYP                                            
256500         SET                                                              
256600              STR_GP_TYP_NM   = :XLT00019-STR-GP-TYP-NM                   
256700         WHERE                                                            
256800              STR_GP_TYP_CDE = :XLT00019-STR-GP-TYP-CDE                   
256900         END-EXEC                                                         
257000                                                                          
257100         EVALUATE TRUE                                                    
257200             WHEN SQLCODE = ZERO                                          
257300                 ADD 1                TO PV-XLT00019-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
257400             WHEN SQLCODE = +100                                          
257500                 ADD 1                TO PV-XLT00019-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
258200               DISPLAY '**************************************'           
258300               DISPLAY 'UPDATE OF STR-GP-TYP-CDE NOT FOUND  '             
258400               DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE             
                     DISPLAY 'STR-GP-TYP-NM =' XL037-STR-GP-TYP-NM              
258500               DISPLAY '**********************************'               
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00019-DUP-COUNT            
257600             WHEN SQLCODE = -904                                          
257700             WHEN SQLCODE = -911                                          
257800             WHEN SQLCODE = -913                                          
257900                 CONTINUE                                                 
258000                                                                          
258100             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
258200               DISPLAY '**************************************'           
258300               DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00019   '          
258400               DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE             
                     DISPLAY 'STR-GP-TYP-NM =' XL037-STR-GP-TYP-NM              
258500               DISPLAY '**********************************'               
258600               PERFORM 9800-SQL-WARNING                                   
258700                                                                          
258800             WHEN SQLCODE < ZERO                                          
258900               DISPLAY '**************************************'           
259000               DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00019 '              
258400               DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE             
                     DISPLAY 'STR-GP-TYP-NM =' XL037-STR-GP-TYP-NM              
259200               DISPLAY '**************************************'           
259300               PERFORM 9900-SQL-ERROR                                     
259400                                                                          
259500         END-EVALUATE                                                     
259600     END-PERFORM                                                          
259700                                                                          
259800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
259900         SQLCODE NOT = ZERO                                               
260000         DISPLAY '**************************************'                 
260100         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
260200         DISPLAY 'UPDATE TO XLT_STR_GP_TYP'                               
258400         DISPLAY 'STR-GP-TYP-CDE=' XL037-STR-GP-TYP-CDE                   
               DISPLAY 'STR-GP-TYP-NM =' XL037-STR-GP-TYP-NM                    
260500         DISPLAY '**************************************'                 
260600         DISPLAY '**************************************'                 
260700         PERFORM 9900-SQL-ERROR                                           
260800     END-IF.                                                              
260900                                                                          
261000 7245-CHANGE-STR-GP.                                                      
261100     MOVE '7245-CHANGE-STR-GP'        TO PV-ABEND-PARAGRAPH.              
261200                                                                          
261300     MOVE XL037-SG-STR-GP-TYP-CDE     TO XLT00020-STR-GP-TYP-CDE          
261400     MOVE XL037-SG-STR-GP-ID          TO XLT00020-STR-GP-ID               
261500     MOVE XL037-SG-STR-GP-NM          TO XLT00020-STR-GP-NM               
261600     MOVE XL037-SG-ST-CDE             TO XLT00020-ST-CDE                  
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-SG-RPT-FLSH-SLS-IND = SPACE                                 
               MOVE -1 TO DN-RPT-FLSH-SLS-IND                                   
           ELSE                                                                 
               MOVE 0 TO DN-RPT-FLSH-SLS-IND                                    
           END-IF                                                               
261700     MOVE XL037-SG-RPT-FLSH-SLS-IND                                       
261800                                  TO XLT00020-RPT-FLSH-SLS-IND            
261900                                                                          
262000                                                                          
262100     PERFORM                                                              
262200         WITH TEST AFTER                                                  
262300         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
262400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
262500                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
262600                                                                          
262700     EXEC SQL                                                             
262800         UPDATE XLT_STR_GP                                                
262900         SET                                                              
263000              STR_GP_NM        = :XLT00020-STR-GP-NM                      
263100         ,    ST_CDE           = :XLT00020-ST-CDE                         
263200         ,    RPT_FLSH_SLS_IND = :XLT00020-RPT-FLSH-SLS-IND               
                                          :DN-RPT-FLSH-SLS-IND                  
263300         WHERE                                                            
263400              STR_GP_TYP_CDE = :XLT00020-STR-GP-TYP-CDE                   
263500          AND STR_GP_ID      = :XLT00020-STR-GP-ID                        
263600         END-EXEC                                                         
263700                                                                          
263800         EVALUATE TRUE                                                    
263900             WHEN SQLCODE = ZERO                                          
264000                 ADD 1                TO PV-XLT00020-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
264100             WHEN SQLCODE = +100                                          
264200                 ADD 1                TO PV-XLT00020-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
264900               DISPLAY '**************************************'           
265000               DISPLAY 'UPDATE OF STR-GP NOT FOUND  '                     
265100               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY XL037-SG-STR-GP-TYP-CDE                            
                     DISPLAY 'STR-GP-ID =' XL037-SG-STR-GP-ID                   
265200               DISPLAY '**********************************'               
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00020-DUP-COUNT            
264300             WHEN SQLCODE = -904                                          
264400             WHEN SQLCODE = -911                                          
264500             WHEN SQLCODE = -913                                          
264600                 CONTINUE                                                 
264700                                                                          
264800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
264900               DISPLAY '**************************************'           
265000               DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00020   '          
265100               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY XL037-SG-STR-GP-TYP-CDE                            
                     DISPLAY 'STR-GP-ID =' XL037-SG-STR-GP-ID                   
265200               DISPLAY '**********************************'               
265300               PERFORM 9800-SQL-WARNING                                   
265400                                                                          
265500             WHEN SQLCODE < ZERO                                          
265600               DISPLAY '**************************************'           
265700               DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00020 '              
265100               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY XL037-SG-STR-GP-TYP-CDE                            
                     DISPLAY 'STR-GP-ID =' XL037-SG-STR-GP-ID                   
265900               DISPLAY '**************************************'           
266000               PERFORM 9900-SQL-ERROR                                     
266100                                                                          
266200         END-EVALUATE                                                     
266300     END-PERFORM                                                          
266400                                                                          
266500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
266600         SQLCODE NOT = ZERO                                               
266700         DISPLAY '**************************************'                 
266800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
266900         DISPLAY 'UPDATE TO XLT_STR_GP                  '                 
267000         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00020  '                   
265100         DISPLAY 'STR-GP-TYP-CDE ='                                       
               DISPLAY XL037-SG-STR-GP-TYP-CDE                                  
               DISPLAY 'STR-GP-ID =' XL037-SG-STR-GP-ID                         
267200         DISPLAY '**************************************'                 
267300         DISPLAY '**************************************'                 
267400         PERFORM 9900-SQL-ERROR                                           
267500     END-IF.                                                              
267600                                                                          
267700 7250-CHANGE-STR-GP-DTE.                                                  
267800     MOVE '7250-CHANGE-STR-GP-DTE'    TO PV-ABEND-PARAGRAPH.              
267900                                                                          
268000     MOVE XL037-SGD-STR-GP-TYP-CDE    TO XLT00021-STR-GP-TYP-CDE          
268100     MOVE XL037-SGD-STR-GP-ID         TO XLT00021-STR-GP-ID               
268200     MOVE XL037-SGD-EFF-BEG-DTE       TO XLT00021-EFF-BEG-DTE             
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-SGD-EFF-END-DTE = SPACE                                     
              OR XL037-SGD-EFF-END-DTE = '9999-09-09'                           
               MOVE -1 TO DN-EFF-END-DTE                                        
           ELSE                                                                 
               MOVE 0 TO DN-EFF-END-DTE                                         
           END-IF                                                               
268300     MOVE XL037-SGD-EFF-END-DTE       TO XLT00021-EFF-END-DTE             
268400     MOVE XL037-SGD-EFF-STR-GP-ID     TO XLT00021-EFF-STR-GP-ID           
268500                                                                          
268600                                                                          
268700     PERFORM                                                              
268800         WITH TEST AFTER                                                  
268900         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
269000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
269100                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
269200                                                                          
269300     EXEC SQL                                                             
269400         UPDATE XLT_STR_GP_DTE                                            
269500         SET                                                              
269600              EFF_END_DTE      = :XLT00021-EFF-END-DTE                    
                                          :DN-EFF-END-DTE                       
269700         ,    EFF_STR_GP_ID    = :XLT00021-EFF-STR-GP-ID                  
269800         WHERE                                                            
269900              STR_GP_TYP_CDE = :XLT00021-STR-GP-TYP-CDE                   
270000          AND STR_GP_ID      = :XLT00021-STR-GP-ID                        
270100          AND EFF_BEG_DTE    = :XLT00021-EFF-BEG-DTE                      
270200         END-EXEC                                                         
270300                                                                          
270400         EVALUATE TRUE                                                    
270500             WHEN SQLCODE = ZERO                                          
270600                 ADD 1                TO PV-XLT00021-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
270700             WHEN SQLCODE = +100                                          
270800                 ADD 1                TO PV-XLT00021-NF-COUNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
271500               DISPLAY '**************************************'           
271600               DISPLAY 'UPDATE OF STR-GP-DTE NOT FOUND  '                 
271700               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY XL037-SGD-STR-GP-TYP-CDE                           
                     DISPLAY 'STR-GP-ID   ='  XL037-SGD-STR-GP-ID               
                     DISPLAY 'EFF-BEG-DTE ='  XL037-SGD-EFF-BEG-DTE             
271800               DISPLAY '**********************************'               
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00021-DUP-COUNT            
270900             WHEN SQLCODE = -904                                          
271000             WHEN SQLCODE = -911                                          
271100             WHEN SQLCODE = -913                                          
271200                 CONTINUE                                                 
271300                                                                          
271400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
271500               DISPLAY '**************************************'           
271600               DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00021   '          
271700               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY  XL037-SGD-STR-GP-TYP-CDE                          
                     DISPLAY 'STR-GP-ID   ='  XL037-SGD-STR-GP-ID               
                     DISPLAY 'EFF-BEG-DTE ='  XL037-SGD-EFF-BEG-DTE             
271800               DISPLAY '**********************************'               
271900               PERFORM 9800-SQL-WARNING                                   
272000                                                                          
272100             WHEN SQLCODE < ZERO                                          
272200               DISPLAY '**************************************'           
272300               DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00021 '              
271700               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY  XL037-SGD-STR-GP-TYP-CDE                          
                     DISPLAY 'STR-GP-ID   ='  XL037-SGD-STR-GP-ID               
                     DISPLAY 'EFF-BEG-DTE ='  XL037-SGD-EFF-BEG-DTE             
272500               DISPLAY '**************************************'           
272600               PERFORM 9900-SQL-ERROR                                     
272700                                                                          
272800         END-EVALUATE                                                     
272900     END-PERFORM                                                          
273000                                                                          
273100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
273200         SQLCODE NOT = ZERO                                               
273300         DISPLAY '**************************************'                 
273400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
273500         DISPLAY 'UPDATE TO XLT_STR_GP_DTE              '                 
273600         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00021  '                   
271700         DISPLAY 'STR-GP-TYP-CDE ='                                       
               DISPLAY  XL037-SGD-STR-GP-TYP-CDE                                
               DISPLAY 'STR-GP-ID   ='  XL037-SGD-STR-GP-ID                     
               DISPLAY 'EFF-BEG-DTE ='  XL037-SGD-EFF-BEG-DTE                   
273800         DISPLAY '**************************************'                 
273900         DISPLAY '**************************************'                 
274000         PERFORM 9900-SQL-ERROR                                           
274100     END-IF.                                                              
274200                                                                          
274300 7255-CHANGE-STR-GP-MBSHP.                                                
274400     MOVE '7255-CHANGE-STR-GP-MBSHP'  TO PV-ABEND-PARAGRAPH.              
274500                                                                          
274600     MOVE XL037-SGM-STR-GP-TYP-CDE    TO XLT00018-STR-GP-TYP-CDE          
274700     MOVE XL037-SGM-STR-GP-ID         TO XLT00018-STR-GP-ID               
274800     MOVE XL037-SGM-LOC-NBR           TO XLT00018-LOC-NBR                 
274900     MOVE XL037-SGM-EFF-BEG-DTE       TO XLT00018-EFF-BEG-DTE             
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-SGM-EFF-END-DTE = SPACE                                     
              OR XL037-SGM-EFF-END-DTE = '9999-09-09'                           
               MOVE -1 TO DN-EFF-END-DTE                                        
           ELSE                                                                 
               MOVE 0 TO DN-EFF-END-DTE                                         
           END-IF                                                               
275000     MOVE XL037-SGM-EFF-END-DTE       TO XLT00018-EFF-END-DTE             
275100                                                                          
275200                                                                          
275300     PERFORM                                                              
275400         WITH TEST AFTER                                                  
275500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
275600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
275700                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
275800                                                                          
275900     EXEC SQL                                                             
276000         UPDATE XLT_STR_GP_MBSHP                                          
276100         SET                                                              
276200              EFF_END_DTE      = :XLT00018-EFF-END-DTE                    
                                           :DN-EFF-END-DTE                      
276300         WHERE                                                            
276400              STR_GP_TYP_CDE = :XLT00018-STR-GP-TYP-CDE                   
276500          AND STR_GP_ID      = :XLT00018-STR-GP-ID                        
276600          AND LOC_NBR        = :XLT00018-LOC-NBR                          
276700          AND EFF_BEG_DTE    = :XLT00018-EFF-BEG-DTE                      
276800         END-EXEC                                                         
276900                                                                          
277000         EVALUATE TRUE                                                    
277100             WHEN SQLCODE = ZERO                                          
277200                 ADD 1                TO PV-XLT00018-UPD-COUNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
277300             WHEN SQLCODE = +100                                          
277400               ADD 1                TO PV-XLT00018-NF-COUNT               
                     SET PS-LOC-CHG-NF-YES TO TRUE                              
278100               DISPLAY '**************************************'           
278200               DISPLAY 'UPDATE OF STR-GP-MBSHP NOT FOUND  '               
                     DISPLAY 'SQLCODE =' SQLCODE                                
278300               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY XL037-SGM-STR-GP-TYP-CDE                           
                     DISPLAY 'STR-GP-ID =' XL037-SGM-STR-GP-ID                  
                     DISPLAY '  LOC-NBR =' XL037-SGM-LOC-NBR                    
                     DISPLAY 'EFF-BEG-DTE =' XL037-SGM-EFF-BEG-DTE              
278400               DISPLAY '**********************************'               
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1                TO PV-XLT00018-DUP-COUNT            
277500             WHEN SQLCODE = -904                                          
277600             WHEN SQLCODE = -911                                          
277700             WHEN SQLCODE = -913                                          
277800                 CONTINUE                                                 
277900                                                                          
278000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
278100               DISPLAY '**************************************'           
278200               DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00018   '          
278300               DISPLAY 'STR-GP-MBSHP '                                    
                     DISPLAY 'SQLCODE =' SQLCODE                                
278300               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY XL037-SGM-STR-GP-TYP-CDE                           
                     DISPLAY 'STR-GP-ID =' XL037-SGM-STR-GP-ID                  
                     DISPLAY '  LOC-NBR =' XL037-SGM-LOC-NBR                    
                     DISPLAY 'EFF-BEG-DTE =' XL037-SGM-EFF-BEG-DTE              
278400               DISPLAY '**********************************'               
278500               PERFORM 9800-SQL-WARNING                                   
278600                                                                          
278700             WHEN SQLCODE < ZERO                                          
278800               DISPLAY '**************************************'           
278900               DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00018 '              
279000               DISPLAY 'STR-GP-MBSHP '                                    
                     DISPLAY 'SQLCODE =' SQLCODE                                
278300               DISPLAY 'STR-GP-TYP-CDE ='                                 
                     DISPLAY XL037-SGM-STR-GP-TYP-CDE                           
                     DISPLAY 'STR-GP-ID =' XL037-SGM-STR-GP-ID                  
                     DISPLAY '  LOC-NBR =' XL037-SGM-LOC-NBR                    
                     DISPLAY 'EFF-BEG-DTE =' XL037-SGM-EFF-BEG-DTE              
279100               DISPLAY '**************************************'           
279200               PERFORM 9900-SQL-ERROR                                     
279300                                                                          
279400         END-EVALUATE                                                     
279500     END-PERFORM                                                          
279600                                                                          
279700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
279800         SQLCODE NOT = ZERO                                               
279900         DISPLAY '**************************************'                 
280000         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
280100         DISPLAY 'UPDATE TO XLT00018                    '                 
280200         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00018  '                   
280300         DISPLAY 'STR-GP-MBSHP '                                          
               DISPLAY 'SQLCODE =' SQLCODE                                      
278300         DISPLAY 'STR-GP-TYP-CDE ='                                       
               DISPLAY XL037-SGM-STR-GP-TYP-CDE                                 
               DISPLAY 'STR-GP-ID =' XL037-SGM-STR-GP-ID                        
               DISPLAY '  LOC-NBR =' XL037-SGM-LOC-NBR                          
               DISPLAY 'EFF-BEG-DTE =' XL037-SGM-EFF-BEG-DTE                    
280400         DISPLAY '**************************************'                 
280500         DISPLAY '**************************************'                 
280600         PERFORM 9900-SQL-ERROR                                           
280700     END-IF.                                                              
280800                                                                          
234000 7260-CHANGE-LOC-WH.                                                      
234100     MOVE '7260-CHANGE-LOC-WH'        TO PV-ABEND-PARAGRAPH.              
                                                                                
      *****   ALWAYS MOVE NULLS TO REPLT-STR-NBR FIELD****                      
           MOVE PV-REPLT-STR-NBR            TO XLT00010-REPLT-STR-NBR           
           MOVE -1 TO DN-REPLT-STR-NBR                                          
                                                                                
      *****   ALWAYS MOVE NULLS TO DIST-NBR FIELD****                           
           MOVE PV-DIST-NBR             TO XLT00010-DIST-NBR                    
           MOVE -1 TO DN-DIST-NBR                                               
                                                                                
234300     MOVE XL037-LOC-NBR               TO XLT00010-LOC-NBR                 
234600     MOVE XL037-LOC-LOC-TYP-CDE       TO XLT00010-LOC-TYP-CDE             
234900     MOVE XL037-LOC-NM                TO XLT00010-LOC-NM                  
235000     MOVE XL037-LOC-5-ABBR-NM         TO XLT00010-LOC-5-ABBR-NM           
235100     MOVE XL037-LOC-LNE-1-ADDR        TO XLT00010-LNE-1-ADDR              
235200     MOVE XL037-LOC-LNE-2-ADDR        TO XLT00010-LNE-2-ADDR              
235300     MOVE XL037-LOC-CTY-NME           TO XLT00010-CTY-NM                  
235400     MOVE XL037-LOC-ST-CDE            TO XLT00010-ST-CDE                  
235500     MOVE XL037-LOC-ZIP-10-CDE        TO XLT00010-ZIP-10-CDE              
235600     MOVE XL037-LOC-OPN-DTE           TO XLT00010-OPN-DTE                 
235700     MOVE XL037-LOC-CLO-DTE           TO XLT00010-CLO-DTE                 
                                                                                
      *****   ALWAYS MOVE NULLS TO STD-TM-ZN-CDE    ****                        
           MOVE -1 TO DN-STD-TM-ZN-CDE                                          
           MOVE PV-STD-TM-ZN-CDE        TO XLT00010-STD-TM-ZN-CDE               
                                                                                
      *****   ALWAYS MOVE NULLS TO PHN-NBR FIELD    ****                        
           MOVE -1 TO DN-PHN-NBR                                                
           MOVE PV-PHN-NBR              TO XLT00010-PHN-NBR                     
                                                                                
      *****   ALWAYS MOVE NULLS TO MGR-NM  FIELD    ****                        
           MOVE -1 TO DN-MGR-NM                                                 
           MOVE PV-MGR-NM               TO XLT00010-MGR-NM                      
                                                                                
      *****   ALWAYS MOVE NULLS TO FINCL-CLO-DTE    ****                        
           MOVE -1 TO DN-FINCL-CLO-DTE                                          
           MOVE PV-FINCL-CLO-DTE        TO XLT00010-FINCL-CLO-DTE               
                                                                                
      *****   ALWAYS MOVE NULLS TO MN-SLS-INCL-DTE  ****                        
           MOVE -1 TO DN-MN-SLS-INCL-DTE                                        
           MOVE PV-MN-SLS-INCL-DTE      TO XLT00010-MN-SLS-INCL-DTE             
                                                                                
      *****   ALWAYS MOVE NULLS TO YR-SLS-INCL-DTE  ****                        
           MOVE -1 TO DN-YR-SLS-INCL-DTE                                        
           MOVE PV-YR-SLS-INCL-DTE      TO XLT00010-YR-SLS-INCL-DTE             
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-OCPNC-DTE = SPACE                                       
              OR XL037-LOC-OCPNC-DTE = '9999-09-09'                             
               MOVE -1 TO DN-OCPNC-DTE                                          
           ELSE                                                                 
               MOVE 0 TO DN-OCPNC-DTE                                           
           END-IF                                                               
           MOVE XL037-LOC-OCPNC-DTE         TO XLT00010-OCPNC-DTE               
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-DST-IND = SPACE                                         
               MOVE -1 TO DN-DST-IND                                            
           ELSE                                                                 
               MOVE 0 TO DN-DST-IND                                             
           END-IF                                                               
076400     MOVE XL037-LOC-DST-IND       TO XLT00010-DST-IND                     
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-E-BUS-IND = SPACE                                       
               MOVE -1 TO DN-E-BUS-IND                                          
           ELSE                                                                 
               MOVE 0 TO DN-E-BUS-IND                                           
           END-IF                                                               
076500     MOVE XL037-LOC-E-BUS-IND     TO XLT00010-E-BUS-IND                   
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-IN-STR-PRCHG-IND = SPACE                                
               MOVE -1 TO DN-IN-STR-PRCHG-IND                                   
           ELSE                                                                 
               MOVE 0 TO DN-IN-STR-PRCHG-IND                                    
           END-IF                                                               
078800     MOVE XL037-LOC-IN-STR-PRCHG-IND                                      
078900                                  TO XLT00010-IN-STR-PRCHG-IND            
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-PRCHG-CRE-IND = SPACE                                   
               MOVE -1 TO DN-PRCHG-CRE-IND                                      
           ELSE                                                                 
               MOVE 0 TO DN-PRCHG-CRE-IND                                       
           END-IF                                                               
079000     MOVE XL037-LOC-PRCHG-CRE-IND TO XLT00010-PRCHG-CRE-IND               
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-LOC-10-ABBR-NM = SPACE                                  
               MOVE -1 TO DN-LOC-10-ABBR-NM                                     
           ELSE                                                                 
               MOVE 0 TO DN-LOC-10-ABBR-NM                                      
           END-IF                                                               
           MOVE XL037-LOC-LOC-10-ABBR-NM  TO XLT00010-LOC-10-ABBR-NM            
                                                                                
      *****   ALWAYS MOVE NULLS TO POS-RGST-BNK-QTY  ****                       
           MOVE -1 TO DN-POS-RGST-BNK-QTY                                       
           MOVE PV-POS-RGST-BNK-QTY     TO XLT00010-POS-RGST-BNK-QTY            
                                                                                
      *****   ALWAYS MOVE NULLS TO STR-FMT-CDE   ****                           
           MOVE -1 TO DN-STR-FMT-CDE                                            
           MOVE PV-STR-FMT-CDE          TO XLT00010-STR-FMT-CDE                 
                                                                                
      *****   ALWAYS MOVE NULLS TO TOT-SLG-SQ-FTG-QTY  ****                     
           MOVE -1 TO DN-TOT-SLG-SQ-FTG-QTY                                     
           MOVE PV-TOT-SLG-SQ-FTG-QTY   TO XLT00010-TOT-SLG-SQ-FTG-QTY          
                                                                                
      *****   ALWAYS MOVE NULLS TO TOT-SQ-FTG-QTY  ****                         
           MOVE -1 TO DN-TOT-SQ-FTG-QTY                                         
           MOVE PV-TOT-SQ-FTG-QTY       TO XLT00010-TOT-SQ-FTG-QTY              
                                                                                
      *****   ALWAYS MOVE NULLS TO STP-ORD-DAYS-QTY  ****                       
           MOVE -1 TO DN-STP-ORD-DAYS-QTY                                       
           MOVE PV-STP-ORD-DAYS-QTY     TO XLT00010-STP-ORD-DAYS-QTY            
                                                                                
      *****   ALWAYS MOVE NULLS TO STRT-ORD-DAYS-QTY  ****                      
           MOVE -1 TO DN-STRT-ORD-DAYS-QTY                                      
           MOVE PV-STRT-ORD-DAYS-QTY     TO XLT00010-STRT-ORD-DAYS-QTY          
                                                                                
      *****   ALWAYS MOVE NULLS TO ACQR-DTE  ****                               
           MOVE -1 TO DN-ACQR-DTE                                               
           MOVE PV-ACQR-DTE             TO XLT00010-ACQR-DTE                    
                                                                                
      *****   ALWAYS MOVE NULLS TO RMDL-DTE  ****                               
           MOVE -1 TO DN-RMDL-DTE                                               
           MOVE PV-RMDL-DTE             TO XLT00010-RMDL-DTE                    
                                                                                
      *****   ALWAYS MOVE NULLS TO MEDN-AGE-NBR  ****                           
           MOVE -1 TO DN-MEDN-AGE-NBR                                           
           MOVE PV-MEDN-AGE-NBR         TO XLT00010-MEDN-AGE-NBR                
                                                                                
      *****   ALWAYS MOVE NULLS TO EST-HH-INCM-AMT  ****                        
           MOVE -1 TO DN-EST-HH-INCM-AMT                                        
           MOVE PV-EST-HH-INCM-AMT      TO XLT00010-EST-HH-INCM-AMT             
                                                                                
      *****   ALWAYS MOVE NULLS TO QTR-SLS-INCL-DTE   ****                      
           MOVE -1 TO DN-QTR-SLS-INCL-DTE                                       
           MOVE PV-QTR-SLS-INCL-DTE     TO XLT00010-QTR-SLS-INCL-DTE            
                                                                                
      *****   ALWAYS MOVE NULLS TO SEA-SLS-INCL-DTE   ****                      
           MOVE -1 TO DN-SEA-SLS-INCL-DTE                                       
           MOVE PV-SEA-SLS-INCL-DTE     TO XLT00010-SEA-SLS-INCL-DTE            
                                                                                
      *****   ALWAYS MOVE NULLS TO EXTD-MALL-NM    ****                         
           MOVE -1 TO DN-EXTD-MALL-NM                                           
           MOVE PV-EXTD-MALL-NM         TO XLT00010-EXTD-MALL-NM                
                                                                                
      *****   ALWAYS MOVE NULLS TO SLS-INCL-DTE-CDE  ****                       
           MOVE -1 TO DN-SLS-INCL-DTE-CDE                                       
           MOVE PV-SLS-INCL-DTE-CDE     TO XLT00010-SLS-INCL-DTE-CDE            
                                                                                
      *****   ALWAYS MOVE NULLS TO GRND-OPN-DTE FIELD****                       
           MOVE -1 TO DN-GRND-OPN-DTE                                           
           MOVE PV-GRND-OPN-DTE         TO XLT00010-GRND-OPN-DTE                
                                                                                
      *****   ALWAYS MOVE NULLS TO DIRNS-TXT FIELD  ****                        
           MOVE -1 TO DN-DIRNS-TXT                                              
           MOVE PV-DIRNS-TXT-LEN        TO XLT00010-DIRNS-TXT-LEN               
           MOVE PV-DIRNS-TXT            TO XLT00010-DIRNS-TXT-TEXT              
                                                                                
           PERFORM 2150-SET-CURRENT-TMST                                        
           MOVE PV-CURRENT-TMST           TO XLT00010-LAST-UPD-TMST             
                                                                                
236700     MOVE XL037-LOC-DST-IND         TO XLT00010-DST-IND                   
236800     MOVE XL037-LOC-E-BUS-IND       TO XLT00010-E-BUS-IND                 
238800     MOVE XL037-LOC-PRCHG-CRE-IND   TO XLT00010-PRCHG-CRE-IND             
238900     MOVE XL037-LOC-IN-STR-PRCHG-IND                                      
239000                                    TO XLT00010-IN-STR-PRCHG-IND          
                                                                                
239300     PERFORM                                                              
239400         WITH TEST AFTER                                                  
239500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
239600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
239700                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
239800                                                                          
239900     EXEC SQL                                                             
240000         UPDATE XLT_LOC                                                   
240100         SET                                                              
                    REPLT_STR_NBR  = :XLT00010-REPLT-STR-NBR                    
                                        :DN-REPLT-STR-NBR                       
               ,    DIST_NBR       = :XLT00010-DIST-NBR                         
                                        :DN-DIST-NBR                            
               ,    LOC_TYP_CDE    = :XLT00010-LOC-TYP-CDE                      
               ,    STR_FMT_CDE    = :XLT00010-STR-FMT-CDE                      
                                        :DN-STR-FMT-CDE                         
               ,    STD_TM_ZN_CDE  = :XLT00010-STD-TM-ZN-CDE                    
                                        :DN-STD-TM-ZN-CDE                       
240700         ,    LOC_NM         = :XLT00010-LOC-NM                           
240800         ,    LOC_5_ABBR_NM  = :XLT00010-LOC-5-ABBR-NM                    
240900         ,    LNE_1_ADDR     = :XLT00010-LNE-1-ADDR                       
241000         ,    LNE_2_ADDR     = :XLT00010-LNE-2-ADDR                       
241100         ,    CTY_NM         = :XLT00010-CTY-NM                           
241200         ,    ST_CDE         = :XLT00010-ST-CDE                           
241300         ,    ZIP_10_CDE     = :XLT00010-ZIP-10-CDE                       
241400         ,    OPN_DTE        = :XLT00010-OPN-DTE                          
241500         ,    CLO_DTE        = :XLT00010-CLO-DTE                          
               ,    PHN_NBR        = :XLT00010-PHN-NBR                          
                                        :DN-PHN-NBR                             
               ,    MGR_NM         = :XLT00010-MGR-NM                           
                                        :DN-MGR-NM                              
               ,    FINCL_CLO_DTE  = :XLT00010-FINCL-CLO-DTE                    
                                        :DN-FINCL-CLO-DTE                       
               ,    MN_SLS_INCL_DTE    = :XLT00010-MN-SLS-INCL-DTE              
                                            :DN-MN-SLS-INCL-DTE                 
               ,    YR_SLS_INCL_DTE    = :XLT00010-YR-SLS-INCL-DTE              
                                            :DN-YR-SLS-INCL-DTE                 
               ,    LOC_10_ABBR_NM = :XLT00010-LOC-10-ABBR-NM                   
                                          :DN-LOC-10-ABBR-NM                    
242200         ,    OCPNC_DTE        = :XLT00010-OCPNC-DTE                      
                                          :DN-OCPNC-DTE                         
               ,    POS_RGST_BNK_QTY = :XLT00010-POS-RGST-BNK-QTY               
                                          :DN-POS-RGST-BNK-QTY                  
242400         ,    DST_IND          = :XLT00010-DST-IND                        
                                          :DN-DST-IND                           
242500         ,    E_BUS_IND        = :XLT00010-E-BUS-IND                      
                                          :DN-E-BUS-IND                         
               ,    SLS_INCL_DTE_CDE = :XLT00010-SLS-INCL-DTE-CDE               
                                          :DN-SLS-INCL-DTE-CDE                  
               ,    TOT_SLG_SQ_FTG_QTY = :XLT00010-TOT-SLG-SQ-FTG-QTY           
                                            :DN-TOT-SLG-SQ-FTG-QTY              
               ,    TOT_SQ_FTG_QTY   = :XLT00010-TOT-SQ-FTG-QTY                 
                                          :DN-TOT-SQ-FTG-QTY                    
               ,    STP_ORD_DAYS_QTY = :XLT00010-STP-ORD-DAYS-QTY               
                                          :DN-STP-ORD-DAYS-QTY                  
               ,    STRT_ORD_DAYS_QTY = :XLT00010-STRT-ORD-DAYS-QTY             
                                          :DN-STRT-ORD-DAYS-QTY                 
               ,    ACQR_DTE         = :XLT00010-ACQR-DTE                       
                                          :DN-ACQR-DTE                          
               ,    RMDL_DTE         = :XLT00010-RMDL-DTE                       
                                          :DN-RMDL-DTE                          
               ,    MEDN_AGE_NBR     = :XLT00010-MEDN-AGE-NBR                   
                                          :DN-MEDN-AGE-NBR                      
               ,    EST_HH_INCM_AMT  = :XLT00010-EST-HH-INCM-AMT                
                                          :DN-EST-HH-INCM-AMT                   
               ,    QTR_SLS_INCL_DTE = :XLT00010-QTR-SLS-INCL-DTE               
                                          :DN-QTR-SLS-INCL-DTE                  
               ,    SEA_SLS_INCL_DTE = :XLT00010-SEA-SLS-INCL-DTE               
                                          :DN-SEA-SLS-INCL-DTE                  
               ,    EXTD_MALL_NM     = :XLT00010-EXTD-MALL-NM                   
                                          :DN-EXTD-MALL-NM                      
244000         ,    PRCHG_CRE_IND      = :XLT00010-PRCHG-CRE-IND                
                                          :DN-PRCHG-CRE-IND                     
244100         ,    IN_STR_PRCHG_IND   = :XLT00010-IN-STR-PRCHG-IND             
                                          :DN-IN-STR-PRCHG-IND                  
               ,    GRND_OPN_DTE       = :XLT00010-GRND-OPN-DTE                 
                                           :DN-GRND-OPN-DTE                     
               ,    DIRNS_TXT          = :XLT00010-DIRNS-TXT                    
                                           :DN-DIRNS-TXT                        
244000         ,    LAST_UPD_TMST      = :XLT00010-LAST-UPD-TMST                
244300         WHERE                                                            
244400              LOC_NBR        = :XLT00010-LOC-NBR                          
244500         END-EXEC                                                         
244600                                                                          
244700         EVALUATE TRUE                                                    
244800             WHEN SQLCODE = ZERO                                          
244900                 ADD 1           TO PV-XLT00022-UPD-WHLOC-CNT             
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
245000             WHEN SQLCODE = +100                                          
245100                 ADD 1           TO PV-XLT00022-NF-WHLOC-CNT              
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
245800                 DISPLAY '**************************************'         
245900                 DISPLAY 'UPDATE OF LOC-WH NOT FOUND  '                   
246000                 DISPLAY 'LOC-WH        =' XL037-LOC-NBR                  
                       DISPLAY 'SQLCODE ='  SQLCODE                             
246100                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1           TO PV-XLT00022-DUP-WHLOC-CNT             
245200             WHEN SQLCODE = -904                                          
245300             WHEN SQLCODE = -911                                          
245400             WHEN SQLCODE = -913                                          
245500                 CONTINUE                                                 
245600                                                                          
245700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
245800                 DISPLAY '**************************************'         
245900                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00010'           
246000                 DISPLAY 'LOC-WH        =' XL037-LOC-NBR                  
                       DISPLAY 'SQLCODE ='  SQLCODE                             
246100                 DISPLAY '**********************************'             
246200                 PERFORM 9800-SQL-WARNING                                 
246300                                                                          
246400             WHEN SQLCODE < ZERO                                          
246500                 DISPLAY '**************************************'         
246600                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00010 '            
246700                 DISPLAY 'LOC-WH        =' XL037-LOC-NBR                  
                       DISPLAY 'SQLCODE ='  SQLCODE                             
246800                 DISPLAY '**************************************'         
246900                 PERFORM 9900-SQL-ERROR                                   
247000                                                                          
247100         END-EVALUATE                                                     
247200     END-PERFORM                                                          
247300                                                                          
247400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
247500         SQLCODE NOT = ZERO                                               
247600         DISPLAY '**************************************'                 
247700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
247800         DISPLAY 'UPDATE TO XLT_LOC                     '                 
247900         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00010  '                   
248000         DISPLAY 'LOC-WH        =' XL037-LOC-NBR                          
               DISPLAY 'SQLCODE ='  SQLCODE                                     
248100         DISPLAY '**************************************'                 
248200         DISPLAY '**************************************'                 
248300         PERFORM 9900-SQL-ERROR                                           
248400     END-IF.                                                              
248500                                                                          
234000 7265-CHANGE-OUT-LOC.                                                     
234100     MOVE '7265-CHANGE-OUT-LOC'       TO PV-ABEND-PARAGRAPH.              
234200                                                                          
234300     MOVE XL037-LOC-NBR               TO XLT00010-LOC-NBR                 
234200                                                                          
      *****   ALWAYS MOVE NULLS TO REPLT-STR-NBR FIELD****                      
           MOVE PV-REPLT-STR-NBR            TO XLT00010-REPLT-STR-NBR           
           MOVE -1 TO DN-REPLT-STR-NBR                                          
                                                                                
      *****   ALWAYS MOVE NULLS TO DIST-NBR FIELD****                           
           MOVE PV-DIST-NBR             TO XLT00010-DIST-NBR                    
           MOVE -1 TO DN-DIST-NBR                                               
                                                                                
234600     MOVE XL037-LOC-LOC-TYP-CDE       TO XLT00010-LOC-TYP-CDE             
234900     MOVE XL037-LOC-NM                TO XLT00010-LOC-NM                  
235000     MOVE XL037-LOC-5-ABBR-NM         TO XLT00010-LOC-5-ABBR-NM           
235100     MOVE XL037-LOC-LNE-1-ADDR        TO XLT00010-LNE-1-ADDR              
235200     MOVE XL037-LOC-LNE-2-ADDR        TO XLT00010-LNE-2-ADDR              
235300     MOVE XL037-LOC-CTY-NME           TO XLT00010-CTY-NM                  
235400     MOVE XL037-LOC-ST-CDE            TO XLT00010-ST-CDE                  
235500     MOVE XL037-LOC-ZIP-10-CDE        TO XLT00010-ZIP-10-CDE              
235600     MOVE XL037-LOC-OPN-DTE           TO XLT00010-OPN-DTE                 
235700     MOVE XL037-LOC-CLO-DTE           TO XLT00010-CLO-DTE                 
                                                                                
      *****   ALWAYS MOVE NULLS TO STD-TM-ZN-CDE    ****                        
           MOVE -1 TO DN-STD-TM-ZN-CDE                                          
           MOVE PV-STD-TM-ZN-CDE        TO XLT00010-STD-TM-ZN-CDE               
                                                                                
      *****   ALWAYS MOVE NULLS TO LOC-10-ABBR-NM   ****                        
           MOVE -1 TO DN-LOC-10-ABBR-NM                                         
           MOVE PV-LOC-10-ABBR-NM       TO XLT00010-LOC-10-ABBR-NM              
                                                                                
      *****   CHECK FOR NULLS ****                                              
           IF XL037-LOC-PHN-NBR = SPACE                                         
               MOVE -1 TO DN-PHN-NBR                                            
           ELSE                                                                 
               MOVE 0 TO DN-PHN-NBR                                             
           END-IF                                                               
           MOVE XL037-LOC-PHN-NBR           TO XLT00010-PHN-NBR                 
                                                                                
      *****   ALWAYS MOVE NULLS TO MGR-NM  FIELD    ****                        
           MOVE -1 TO DN-MGR-NM                                                 
           MOVE PV-MGR-NM               TO XLT00010-MGR-NM                      
                                                                                
      *****   ALWAYS MOVE NULLS TO FINCL-CLO-DTE    ****                        
           MOVE -1 TO DN-FINCL-CLO-DTE                                          
           MOVE PV-FINCL-CLO-DTE        TO XLT00010-FINCL-CLO-DTE               
                                                                                
      *****   ALWAYS MOVE NULLS TO MN-SLS-INCL-DTE  ****                        
           MOVE -1 TO DN-MN-SLS-INCL-DTE                                        
           MOVE PV-MN-SLS-INCL-DTE      TO XLT00010-MN-SLS-INCL-DTE             
                                                                                
      *****   ALWAYS MOVE NULLS TO YR-SLS-INCL-DTE  ****                        
           MOVE -1 TO DN-YR-SLS-INCL-DTE                                        
           MOVE PV-YR-SLS-INCL-DTE      TO XLT00010-YR-SLS-INCL-DTE             
                                                                                
      *****   ALWAYS MOVE NULLS TO OCPNC-DTE   ****                             
           MOVE -1 TO DN-OCPNC-DTE                                              
           MOVE PV-OCPNC-DTE                TO XLT00010-OCPNC-DTE               
                                                                                
      *****   ALWAYS MOVE NULLS TO POS-RGST-BNK-QTY  ****                       
           MOVE -1 TO DN-POS-RGST-BNK-QTY                                       
           MOVE PV-POS-RGST-BNK-QTY     TO XLT00010-POS-RGST-BNK-QTY            
                                                                                
      *****   ALWAYS MOVE NULLS TO DST-IND  ****                                
           MOVE -1 TO DN-DST-IND                                                
           MOVE PV-DST-IND              TO XLT00010-DST-IND                     
                                                                                
      *****   ALWAYS MOVE NULLS TO E-BUS-IND   ****                             
           MOVE -1 TO DN-E-BUS-IND                                              
           MOVE PV-E-BUS-IND            TO XLT00010-E-BUS-IND                   
                                                                                
      *****   ALWAYS MOVE NULLS TO STR-FMT-CDE   ****                           
           MOVE -1 TO DN-STR-FMT-CDE                                            
           MOVE PV-STR-FMT-CDE          TO XLT00010-STR-FMT-CDE                 
                                                                                
      *****   ALWAYS MOVE NULLS TO TOT-SLG-SQ-FTG-QTY  ****                     
           MOVE -1 TO DN-TOT-SLG-SQ-FTG-QTY                                     
           MOVE PV-TOT-SLG-SQ-FTG-QTY   TO XLT00010-TOT-SLG-SQ-FTG-QTY          
                                                                                
      *****   ALWAYS MOVE NULLS TO SLS-INCL-DTE-CDE  ****                       
           MOVE -1 TO DN-SLS-INCL-DTE-CDE                                       
           MOVE PV-SLS-INCL-DTE-CDE     TO XLT00010-SLS-INCL-DTE-CDE            
                                                                                
      *****   ALWAYS MOVE NULLS TO TOT-SQ-FTG-QTY  ****                         
           MOVE -1 TO DN-TOT-SQ-FTG-QTY                                         
           MOVE PV-TOT-SQ-FTG-QTY       TO XLT00010-TOT-SQ-FTG-QTY              
                                                                                
      *****   ALWAYS MOVE NULLS TO STP-ORD-DAYS-QTY  ****                       
           MOVE -1 TO DN-STP-ORD-DAYS-QTY                                       
           MOVE PV-STP-ORD-DAYS-QTY     TO XLT00010-STP-ORD-DAYS-QTY            
                                                                                
      *****   ALWAYS MOVE NULLS TO STRT-ORD-DAYS-QTY  ****                      
           MOVE -1 TO DN-STRT-ORD-DAYS-QTY                                      
           MOVE PV-STRT-ORD-DAYS-QTY     TO XLT00010-STRT-ORD-DAYS-QTY          
                                                                                
      *****   ALWAYS MOVE NULLS TO ACQR-DTE  ****                               
           MOVE -1 TO DN-ACQR-DTE                                               
           MOVE PV-ACQR-DTE             TO XLT00010-ACQR-DTE                    
                                                                                
      *****   ALWAYS MOVE NULLS TO RMDL-DTE  ****                               
           MOVE -1 TO DN-RMDL-DTE                                               
           MOVE PV-RMDL-DTE             TO XLT00010-RMDL-DTE                    
                                                                                
      *****   ALWAYS MOVE NULLS TO MEDN-AGE-NBR  ****                           
           MOVE -1 TO DN-MEDN-AGE-NBR                                           
           MOVE PV-MEDN-AGE-NBR         TO XLT00010-MEDN-AGE-NBR                
                                                                                
      *****   ALWAYS MOVE NULLS TO EST-HH-INCM-AMT  ****                        
           MOVE -1 TO DN-EST-HH-INCM-AMT                                        
           MOVE PV-EST-HH-INCM-AMT      TO XLT00010-EST-HH-INCM-AMT             
                                                                                
      *****   ALWAYS MOVE NULLS TO QTR-SLS-INCL-DTE   ****                      
           MOVE -1 TO DN-QTR-SLS-INCL-DTE                                       
           MOVE PV-QTR-SLS-INCL-DTE     TO XLT00010-QTR-SLS-INCL-DTE            
                                                                                
      *****   ALWAYS MOVE NULLS TO SEA-SLS-INCL-DTE   ****                      
           MOVE -1 TO DN-SEA-SLS-INCL-DTE                                       
           MOVE PV-SEA-SLS-INCL-DTE     TO XLT00010-SEA-SLS-INCL-DTE            
                                                                                
      *****   ALWAYS MOVE NULLS TO EXTD-MALL-NM    ****                         
           MOVE -1 TO DN-EXTD-MALL-NM                                           
           MOVE PV-EXTD-MALL-NM         TO XLT00010-EXTD-MALL-NM                
                                                                                
      *****   ALWAYS MOVE NULLS TO GRND-OPN-DTE FIELD****                       
           MOVE -1 TO DN-GRND-OPN-DTE                                           
           MOVE PV-GRND-OPN-DTE         TO XLT00010-GRND-OPN-DTE                
                                                                                
      *****   ALWAYS MOVE NULLS TO PRCHG-CRE-IND  ****                          
           MOVE -1 TO DN-PRCHG-CRE-IND                                          
           MOVE PV-PRCHG-CRE-IND        TO XLT00010-PRCHG-CRE-IND               
                                                                                
      *****   ALWAYS MOVE NULLS TO IN-STR-PRCHG-IND  ****                       
           MOVE -1 TO DN-IN-STR-PRCHG-IND                                       
           MOVE PV-IN-STR-PRCHG-IND     TO XLT00010-IN-STR-PRCHG-IND            
                                                                                
      *****   ALWAYS MOVE NULLS TO DIRNS-TXT FIELD  ****                        
           MOVE -1 TO DN-DIRNS-TXT                                              
           MOVE PV-DIRNS-TXT-LEN        TO XLT00010-DIRNS-TXT-LEN               
           MOVE PV-DIRNS-TXT            TO XLT00010-DIRNS-TXT-TEXT              
                                                                                
           PERFORM 2150-SET-CURRENT-TMST                                        
           MOVE PV-CURRENT-TMST             TO XLT00010-LAST-UPD-TMST           
                                                                                
239200                                                                          
239300     PERFORM                                                              
239400         WITH TEST AFTER                                                  
239500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                             
239600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR                    
239700                (SQLCODE = ZERO) OR (SQLCODE = +100) OR                   
                      (SQLCODE = -803))                                         
239800                                                                          
239900     EXEC SQL                                                             
240000         UPDATE XLT_LOC                                                   
240100         SET                                                              
240400              REPLT_STR_NBR  = :XLT00010-REPLT-STR-NBR                    
                                       :DN-REPLT-STR-NBR                        
240400         ,    DIST_NBR       = :XLT00010-DIST-NBR                         
                                       :DN-DIST-NBR                             
240400         ,    LOC_TYP_CDE    = :XLT00010-LOC-TYP-CDE                      
               ,    STR_FMT_CDE    = :XLT00010-STR-FMT-CDE                      
                                       :DN-STR-FMT-CDE                          
               ,    STD_TM_ZN_CDE  = :XLT00010-STD-TM-ZN-CDE                    
                                       :DN-STD-TM-ZN-CDE                        
240700         ,    LOC_NM         = :XLT00010-LOC-NM                           
240800         ,    LOC_5_ABBR_NM  = :XLT00010-LOC-5-ABBR-NM                    
240900         ,    LNE_1_ADDR     = :XLT00010-LNE-1-ADDR                       
241000         ,    LNE_2_ADDR     = :XLT00010-LNE-2-ADDR                       
241100         ,    CTY_NM         = :XLT00010-CTY-NM                           
241200         ,    ST_CDE         = :XLT00010-ST-CDE                           
241300         ,    ZIP_10_CDE     = :XLT00010-ZIP-10-CDE                       
241400         ,    OPN_DTE        = :XLT00010-OPN-DTE                          
241500         ,    CLO_DTE        = :XLT00010-CLO-DTE                          
241700         ,    LOC_10_ABBR_NM = :XLT00010-LOC-10-ABBR-NM                   
                                        :DN-LOC-10-ABBR-NM                      
241700         ,    PHN_NBR        = :XLT00010-PHN-NBR                          
                                        :DN-PHN-NBR                             
241700         ,    MGR_NM         = :XLT00010-MGR-NM                           
                                        :DN-MGR-NM                              
               ,    FINCL_CLO_DTE  = :XLT00010-FINCL-CLO-DTE                    
                                        :DN-FINCL-CLO-DTE                       
               ,    MN_SLS_INCL_DTE = :XLT00010-MN-SLS-INCL-DTE                 
                                         :DN-MN-SLS-INCL-DTE                    
               ,    YR_SLS_INCL_DTE = :XLT00010-YR-SLS-INCL-DTE                 
                                         :DN-YR-SLS-INCL-DTE                    
               ,    OCPNC_DTE       = :XLT00010-OCPNC-DTE                       
                                         :DN-OCPNC-DTE                          
               ,    POS_RGST_BNK_QTY = :XLT00010-POS-RGST-BNK-QTY               
                                          :DN-POS-RGST-BNK-QTY                  
               ,    DST_IND          = :XLT00010-DST-IND                        
                                          :DN-DST-IND                           
               ,    E_BUS_IND        = :XLT00010-E-BUS-IND                      
                                          :DN-E-BUS-IND                         
               ,    SLS_INCL_DTE_CDE = :XLT00010-SLS-INCL-DTE-CDE               
                                          :DN-SLS-INCL-DTE-CDE                  
               ,    TOT_SLG_SQ_FTG_QTY = :XLT00010-TOT-SLG-SQ-FTG-QTY           
                                            :DN-TOT-SLG-SQ-FTG-QTY              
               ,    TOT_SQ_FTG_QTY     = :XLT00010-TOT-SQ-FTG-QTY               
                                            :DN-TOT-SQ-FTG-QTY                  
               ,    STP_ORD_DAYS_QTY   = :XLT00010-STP-ORD-DAYS-QTY             
                                            :DN-STP-ORD-DAYS-QTY                
               ,    STRT_ORD_DAYS_QTY   = :XLT00010-STRT-ORD-DAYS-QTY           
                                            :DN-STRT-ORD-DAYS-QTY               
               ,    ACQR_DTE           = :XLT00010-ACQR-DTE                     
                                            :DN-ACQR-DTE                        
               ,    RMDL_DTE           = :XLT00010-RMDL-DTE                     
                                            :DN-RMDL-DTE                        
               ,    MEDN_AGE_NBR       = :XLT00010-MEDN-AGE-NBR                 
                                            :DN-MEDN-AGE-NBR                    
               ,    EST_HH_INCM_AMT    = :XLT00010-EST-HH-INCM-AMT              
                                            :DN-EST-HH-INCM-AMT                 
               ,    QTR_SLS_INCL_DTE   = :XLT00010-QTR-SLS-INCL-DTE             
                                            :DN-QTR-SLS-INCL-DTE                
               ,    SEA_SLS_INCL_DTE   = :XLT00010-SEA-SLS-INCL-DTE             
                                            :DN-SEA-SLS-INCL-DTE                
               ,    EXTD_MALL_NM       = :XLT00010-EXTD-MALL-NM                 
                                            :DN-EXTD-MALL-NM                    
               ,    GRND_OPN_DTE   = :XLT00010-GRND-OPN-DTE                     
                                        :DN-GRND-OPN-DTE                        
               ,    PRCHG_CRE_IND  = :XLT00010-PRCHG-CRE-IND                    
                                        :DN-PRCHG-CRE-IND                       
               ,    IN_STR_PRCHG_IND   = :XLT00010-IN-STR-PRCHG-IND             
                                        :DN-IN-STR-PRCHG-IND                    
               ,    DIRNS_TXT      = :XLT00010-DIRNS-TXT                        
                                        :DN-DIRNS-TXT                           
241700         ,    LAST_UPD_TMST  = :XLT00010-LAST-UPD-TMST                    
244300         WHERE                                                            
244400              LOC_NBR        = :XLT00010-LOC-NBR                          
244500         END-EXEC                                                         
244600                                                                          
244700         EVALUATE TRUE                                                    
244800             WHEN SQLCODE = ZERO                                          
244900                 ADD 1           TO PV-XLT00023-UPD-OUTLOC-CNT            
      *COMMIT DB2 DATA TO TABLES.                                               
                       PERFORM 6000-DB2-COMMIT                                  
245000             WHEN SQLCODE = +100                                          
245100                 ADD 1           TO PV-XLT00023-NF-OUTLOC-CNT             
                       SET PS-LOC-CHG-NF-YES TO TRUE                            
245800                 DISPLAY '**************************************'         
245900                 DISPLAY 'UPDATE OF OUT-LOC NOT FOUND  '                  
246000                 DISPLAY 'OUT-LOC       =' XL037-LOC-NBR                  
                       DISPLAY 'SQLCODE =' SQLCODE                              
246100                 DISPLAY '**********************************'             
037100             WHEN SQLCODE = -803                                          
037200                 ADD 1        TO PV-XLT00023-DUP-OUTLOC-CNT               
245200             WHEN SQLCODE = -904                                          
245300             WHEN SQLCODE = -911                                          
245400             WHEN SQLCODE = -913                                          
245500                 CONTINUE                                                 
245600                                                                          
245700             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                      
245800                 DISPLAY '**************************************'         
245900                 DISPLAY 'WARNING ISSUED ON UPDATE OF XLT00010'           
246000                 DISPLAY 'OUT-LOC       =' XL037-LOC-NBR                  
                       DISPLAY 'SQLCODE =' SQLCODE                              
246100                 DISPLAY '**********************************'             
246200                 PERFORM 9800-SQL-WARNING                                 
246300                                                                          
246400             WHEN SQLCODE < ZERO                                          
246500                 DISPLAY '**************************************'         
246600                 DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00010 '            
246700                 DISPLAY 'OUT-LOC       =' XL037-LOC-NBR                  
                       DISPLAY 'SQLCODE =' SQLCODE                              
246800                 DISPLAY '**************************************'         
246900                 PERFORM 9900-SQL-ERROR                                   
247000                                                                          
247100         END-EVALUATE                                                     
247200     END-PERFORM                                                          
247300                                                                          
247400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                            
247500         SQLCODE NOT = ZERO                                               
247600         DISPLAY '**************************************'                 
247700         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '                 
247800         DISPLAY 'UPDATE TO XLT_LOC                     '                 
247900         DISPLAY 'ERROR ISSUED ON UPDATE OF XLT00010  '                   
248000         DISPLAY 'OUT-LOC       =' XL037-LOC-NBR                          
248100         DISPLAY '**************************************'                 
248200         DISPLAY '**************************************'                 
248300         PERFORM 9900-SQL-ERROR                                           
248400     END-IF.                                                              
248500                                                                          
280900/                                                                         
281000                                                                          
281100 8000-READ-TRANS-FILE.                                                    
281200     READ XL-TRANS-FILE                                                   
               INTO XL037-TRANS-REC                                             
281400     AT END                                                               
281500         SET PS-EOF-TRANS             TO TRUE                             
               IF PS-LOC-DEL-YES                                                
                  OR PS-DIST-DEL-YES                                            
                  OR PS-REGN-DEL-YES                                            
                  OR PS-TERR-DEL-YES                                            
                  OR PS-FMTCDE-DEL-YES                                          
                  OR PS-TZNCDE-DEL-YES                                          
                  OR PS-LOCTYP-DEL-YES                                          
                     MOVE 4092 TO RETURN-CODE                                   
               END-IF                                                           
               IF PS-LOC-CHG-NF-YES                                             
                   MOVE 4093 TO RETURN-CODE                                     
               END-IF                                                           
281600     NOT AT END                                                           
281700         ADD 1                        TO PV-TRANS-COUNT                   
281800     END-READ.                                                            
281900/                                                                         
282000 9000-EOJ.                                                                
282100                                                                          
282200     CLOSE XL-TRANS-FILE                                                  
282300     MOVE PV-TRANS-COUNT              TO PV-DISP-NBR                      
282400     DISPLAY 'TRANSACTIONS READ                 = ' PV-DISP-NBR           
282500                                                                          
282600     DISPLAY SPACES.                                                      
282700*  INSERT COUNTERS                                                        
282800     MOVE PV-XLT00010-INSERT-COUNT     TO PV-DISP-NBR                     
282900     DISPLAY 'LOC ROWS INSERTED                 = ' PV-DISP-NBR.          
283000     MOVE PV-XLT00010-DUP-COUNT        TO PV-DISP-NBR                     
283100     DISPLAY 'DUPLICATE LOC ROWS IGNORED        = ' PV-DISP-NBR.          
283200                                                                          
283300     MOVE PV-XLT00011-INSERT-COUNT     TO PV-DISP-NBR                     
283400     DISPLAY 'TERR ROWS INSERTED                = ' PV-DISP-NBR.          
283500     MOVE PV-XLT00011-DUP-COUNT        TO PV-DISP-NBR                     
283600     DISPLAY 'DUPLICATE TERR ROWS IGNORED       = ' PV-DISP-NBR.          
283700                                                                          
283800     MOVE PV-XLT00012-INSERT-COUNT     TO PV-DISP-NBR                     
283900     DISPLAY 'REGN ROWS INSERTED                = ' PV-DISP-NBR.          
284000     MOVE PV-XLT00012-DUP-COUNT        TO PV-DISP-NBR                     
284100     DISPLAY 'DUPLICATE REGN ROWS IGNORED       = ' PV-DISP-NBR.          
284200                                                                          
284300     MOVE PV-XLT00013-INSERT-COUNT     TO PV-DISP-NBR                     
284400     DISPLAY 'DIST ROWS INSERTED                = ' PV-DISP-NBR.          
284500     MOVE PV-XLT00013-DUP-COUNT        TO PV-DISP-NBR                     
284600     DISPLAY 'DUPLICATE DIST ROWS IGNORED       = ' PV-DISP-NBR.          
284700                                                                          
284800     MOVE PV-DCSTMF-INSERT-COUNT     TO PV-DISP-NBR                       
284900     DISPLAY 'DC MNFSTNG ROWS INSERTED          = ' PV-DISP-NBR.          
285000     MOVE PV-DCSTMF-DUP-COUNT          TO PV-DISP-NBR                     
285100     DISPLAY 'DUPLICATE DC MNFSTNG ROWS IGNORED = ' PV-DISP-NBR.          
                                                                                
284800     MOVE PV-XLT00014-INSERT-COUNT     TO PV-DISP-NBR                     
284900     DISPLAY 'DC LOC ASGNT ROWS INSERTED        = ' PV-DISP-NBR.          
285000     MOVE PV-XLT00014-DUP-COUNT        TO PV-DISP-NBR                     
285100     DISPLAY 'DUPLICATE LOC ASGNT ROWS IGNORED  = ' PV-DISP-NBR.          
                                                                                
285300     MOVE PV-XLT00015-INSERT-COUNT     TO PV-DISP-NBR                     
285400     DISPLAY 'LOC TYP CDE  ROWS INSERTED        = ' PV-DISP-NBR.          
285500     MOVE PV-XLT00015-DUP-COUNT        TO PV-DISP-NBR                     
285600     DISPLAY 'DUPLICATE LOC TYP CDE ROWS IGNORED= ' PV-DISP-NBR.          
285700                                                                          
285800     MOVE PV-XLT00016-INSERT-COUNT     TO PV-DISP-NBR                     
285900     DISPLAY 'TM ZN CDE    ROWS INSERTED        = ' PV-DISP-NBR.          
286000     MOVE PV-XLT00016-DUP-COUNT        TO PV-DISP-NBR                     
286100     DISPLAY 'DUPLICATE TM ZN CDE ROWS IGNORED  = ' PV-DISP-NBR.          
286200                                                                          
286300     MOVE PV-XLT00017-INSERT-COUNT     TO PV-DISP-NBR                     
286400     DISPLAY 'STD FMT CDE  ROWS INSERTED        = ' PV-DISP-NBR.          
286500     MOVE PV-XLT00017-DUP-COUNT        TO PV-DISP-NBR                     
286600     DISPLAY 'DUPLICATE STD FMT CDE ROWS IGNORED= ' PV-DISP-NBR.          
286700                                                                          
286800     MOVE PV-XLT00018-INSERT-COUNT     TO PV-DISP-NBR                     
286900     DISPLAY 'STD GP MBSHP ROWS INSERTED        = ' PV-DISP-NBR.          
287000     MOVE PV-XLT00018-DUP-COUNT        TO PV-DISP-NBR                     
287100     DISPLAY 'DUPLICATE GP MBSHP  ROWS IGNORED  = ' PV-DISP-NBR.          
287200                                                                          
287300     MOVE PV-XLT00019-INSERT-COUNT     TO PV-DISP-NBR                     
287400     DISPLAY 'STD GP TYP   ROWS INSERTED        = ' PV-DISP-NBR.          
287500     MOVE PV-XLT00019-DUP-COUNT        TO PV-DISP-NBR                     
287600     DISPLAY 'DUPLICATE STD GP TYP ROWS IGNORED = ' PV-DISP-NBR.          
287700                                                                          
287800     MOVE PV-XLT00020-INSERT-COUNT     TO PV-DISP-NBR                     
287900     DISPLAY 'STD GP       ROWS INSERTED        = ' PV-DISP-NBR.          
288000     MOVE PV-XLT00020-DUP-COUNT        TO PV-DISP-NBR                     
288100     DISPLAY 'DUPLICATE STD GP ROWS IGNORED     = ' PV-DISP-NBR.          
288200                                                                          
288300     MOVE PV-XLT00021-INSERT-COUNT     TO PV-DISP-NBR                     
288400     DISPLAY 'STD GP DTE   ROWS INSERTED        = ' PV-DISP-NBR.          
288500     MOVE PV-XLT00021-DUP-COUNT        TO PV-DISP-NBR                     
288600     DISPLAY 'DUPLICATE STD GP DTE ROWS IGNORED = ' PV-DISP-NBR.          
288700                                                                          
288300     MOVE PV-XLT00022-INSRT-WHLOC-CNT  TO PV-DISP-NBR                     
288400     DISPLAY 'LOC WH       ROWS INSERTED        = ' PV-DISP-NBR.          
288500     MOVE PV-XLT00022-DUP-WHLOC-CNT    TO PV-DISP-NBR                     
288600     DISPLAY 'DUPLICATE LOC WH ROWS INGNORED    = ' PV-DISP-NBR.          
288700                                                                          
288300     MOVE PV-XLT00023-INSRT-OUTLOC-CNT TO PV-DISP-NBR                     
288400     DISPLAY 'OUT LOC      ROWS INSERTED        = ' PV-DISP-NBR.          
288500     MOVE PV-XLT00023-DUP-OUTLOC-CNT   TO PV-DISP-NBR                     
288600     DISPLAY 'DUPLICATE OUT LOC ROWS INGNORED   = ' PV-DISP-NBR.          
288700                                                                          
288800                                                                          
288900     DISPLAY SPACES.                                                      
289000*  DELETE COUNTERS                                                        
289100     MOVE PV-XLT00010-DEL-COUNT     TO PV-DISP-NBR                        
289200*    DISPLAY 'LOC ROWS DELETED                  = ' PV-DISP-NBR.          
289200     DISPLAY 'LOC ROWS FOUND TO DELETE          = ' PV-DISP-NBR.          
289300     MOVE PV-XLT00010-DELNF-COUNT        TO PV-DISP-NBR                   
289400     DISPLAY 'LOC ROWS NOT FOUND TO DELETE      = ' PV-DISP-NBR.          
289500     MOVE PV-XLT00010-532-COUNT          TO PV-DISP-NBR                   
289600     DISPLAY 'LOC ROWS DELETE RESTRICTED        = ' PV-DISP-NBR.          
289700                                                                          
289800     MOVE PV-XLT00011-DEL-COUNT     TO PV-DISP-NBR                        
289900*    DISPLAY 'TERR ROWS DELETED                 = ' PV-DISP-NBR.          
           DISPLAY 'TERR ROWS FOUND TO DELETE         = ' PV-DISP-NBR.          
290000     MOVE PV-XLT00011-DELNF-COUNT        TO PV-DISP-NBR                   
290100     DISPLAY 'TERR ROWS NOT FOUND TO DELETE     = ' PV-DISP-NBR.          
290200     MOVE PV-XLT00011-532-COUNT          TO PV-DISP-NBR                   
290300     DISPLAY 'TERR ROWS DELETE RESTRICTED       = ' PV-DISP-NBR.          
290400                                                                          
290500     MOVE PV-XLT00012-DEL-COUNT     TO PV-DISP-NBR                        
290600*    DISPLAY 'REGN ROWS DELETED                 = ' PV-DISP-NBR.          
289900     DISPLAY 'REGN ROWS FOUND TO DELETE         = ' PV-DISP-NBR.          
290700     MOVE PV-XLT00012-DELNF-COUNT        TO PV-DISP-NBR                   
290800     DISPLAY 'REGN ROWS NOT FOUND TO DELETE     = ' PV-DISP-NBR.          
290900     MOVE PV-XLT00012-532-COUNT          TO PV-DISP-NBR                   
291000     DISPLAY 'REGN ROWS DELETE RESTRICTED       = ' PV-DISP-NBR.          
291100                                                                          
291200     MOVE PV-XLT00013-DEL-COUNT     TO PV-DISP-NBR                        
291300*    DISPLAY 'DIST ROWS DELETED                 = ' PV-DISP-NBR.          
289900     DISPLAY 'DIST ROWS FOUND TO DELETE         = ' PV-DISP-NBR.          
291400     MOVE PV-XLT00013-DELNF-COUNT        TO PV-DISP-NBR                   
291500     DISPLAY 'DIST ROWS NOT FOUND TO DELETE     = ' PV-DISP-NBR.          
291600     MOVE PV-XLT00013-532-COUNT          TO PV-DISP-NBR                   
291700     DISPLAY 'DIST ROWS DELETE RESTRICTED       = ' PV-DISP-NBR.          
291800                                                                          
291900     MOVE PV-DCSTMF-DEL-COUNT       TO PV-DISP-NBR                        
292000     DISPLAY 'DC MNFSTNG ROWS DELETED           = ' PV-DISP-NBR.          
292100     MOVE PV-DCSTMF-DELNF-COUNT          TO PV-DISP-NBR                   
292200     DISPLAY 'DC MNFSTNG ROWS NOT FND TO DELETE = ' PV-DISP-NBR.          
291800                                                                          
291900     MOVE PV-XLT00014-DEL-COUNT     TO PV-DISP-NBR                        
292000     DISPLAY 'LOC ASGMT ROWS DELETED            = ' PV-DISP-NBR.          
292100     MOVE PV-XLT00014-DELNF-COUNT        TO PV-DISP-NBR                   
292200     DISPLAY 'LOC ASGMT ROWS NOT FND TO DELETE  = ' PV-DISP-NBR.          
292300     MOVE PV-XLT00014-532-COUNT          TO PV-DISP-NBR                   
292400     DISPLAY 'LOC ASGMT ROWS DELETE RESTRICTED  = ' PV-DISP-NBR.          
292500                                                                          
292600     MOVE PV-XLT00015-DEL-COUNT     TO PV-DISP-NBR                        
292700*    DISPLAY 'LOC TYP CDE ROWS DELETED          = ' PV-DISP-NBR.          
292700     DISPLAY 'LOC TYP CDE ROWS FOUND TO DELETE  = ' PV-DISP-NBR.          
292800     MOVE PV-XLT00015-DELNF-COUNT        TO PV-DISP-NBR                   
292900     DISPLAY 'LOC TYP CDE ROWS NOT FND TO DELETE= ' PV-DISP-NBR.          
293000     MOVE PV-XLT00015-532-COUNT          TO PV-DISP-NBR                   
293100     DISPLAY 'LOC TYP CDE ROWS DELT RESTRICTED  = ' PV-DISP-NBR.          
293200                                                                          
293300     MOVE PV-XLT00016-DEL-COUNT     TO PV-DISP-NBR                        
293400*    DISPLAY 'TM ZN CDE ROWS DELETED            = ' PV-DISP-NBR.          
293400     DISPLAY 'TM ZN CDE ROWS FOUND TO DELETE    = ' PV-DISP-NBR.          
293500     MOVE PV-XLT00016-DELNF-COUNT        TO PV-DISP-NBR                   
293600     DISPLAY 'TM ZN CDE ROWS NOT FND TO DELETE  = ' PV-DISP-NBR.          
293700     MOVE PV-XLT00016-532-COUNT          TO PV-DISP-NBR                   
293800     DISPLAY 'TM ZN CDE ROWS DELETE RESTRICTED  = ' PV-DISP-NBR.          
293900                                                                          
294000     MOVE PV-XLT00017-DEL-COUNT     TO PV-DISP-NBR                        
294100*    DISPLAY 'STR FMT CDE ROWS DELETED          = ' PV-DISP-NBR.          
294100     DISPLAY 'STR FMT CDE ROWS FOUND TO DELETE  = ' PV-DISP-NBR.          
294200     MOVE PV-XLT00017-DELNF-COUNT        TO PV-DISP-NBR                   
294300     DISPLAY 'STR FMT CDE ROWS NOT FND TO DELETE= ' PV-DISP-NBR.          
294400     MOVE PV-XLT00017-532-COUNT          TO PV-DISP-NBR                   
294500     DISPLAY 'STR FMT CDE ROWS DELT RESTRICTED  = ' PV-DISP-NBR.          
294600                                                                          
294700     MOVE PV-XLT00018-DEL-COUNT     TO PV-DISP-NBR                        
294800     DISPLAY 'STD GP MBSHP ROWS DELETED         = ' PV-DISP-NBR.          
294900     MOVE PV-XLT00018-DELNF-COUNT        TO PV-DISP-NBR                   
295000     DISPLAY 'STD GP MBSHP ROWS NOT FND TO DELT = ' PV-DISP-NBR.          
295100     MOVE PV-XLT00018-532-COUNT          TO PV-DISP-NBR                   
295200     DISPLAY 'STD GP MBSHP ROWS DELT RESTRICTED = ' PV-DISP-NBR.          
295300                                                                          
295400     MOVE PV-XLT00019-DEL-COUNT     TO PV-DISP-NBR                        
295500     DISPLAY 'STD GP TYP  ROWS DELETED          = ' PV-DISP-NBR.          
295600     MOVE PV-XLT00019-DELNF-COUNT        TO PV-DISP-NBR                   
295700     DISPLAY 'STD GP TYP ROWS NOT FND TO DELETE = ' PV-DISP-NBR.          
295800     MOVE PV-XLT00019-532-COUNT          TO PV-DISP-NBR                   
295900     DISPLAY 'STD GP TYP  ROWS DELT RESTRICTED  = ' PV-DISP-NBR.          
296000                                                                          
296100     MOVE PV-XLT00020-DEL-COUNT     TO PV-DISP-NBR                        
296200     DISPLAY 'STD GP ROWS DELETED               = ' PV-DISP-NBR.          
296300     MOVE PV-XLT00020-DELNF-COUNT        TO PV-DISP-NBR                   
296400     DISPLAY 'STD GP ROWS NOT FOUND TO DELETE   = ' PV-DISP-NBR.          
296500     MOVE PV-XLT00020-532-COUNT          TO PV-DISP-NBR                   
296600     DISPLAY 'STD GP ROWS DELETE RESTRICTED     = ' PV-DISP-NBR.          
296700                                                                          
296800     MOVE PV-XLT00021-DEL-COUNT     TO PV-DISP-NBR                        
296900     DISPLAY 'STD GP DTE ROWS DELETED           = ' PV-DISP-NBR.          
297000     MOVE PV-XLT00021-DELNF-COUNT        TO PV-DISP-NBR                   
297100     DISPLAY 'STD GP DTE ROWS NOT FND TO DELETE = ' PV-DISP-NBR.          
297200     MOVE PV-XLT00021-532-COUNT          TO PV-DISP-NBR                   
297300     DISPLAY 'STD GP DTE ROWS DELETE RESTRICTED = ' PV-DISP-NBR.          
297400                                                                          
296800     MOVE PV-XLT00022-DEL-COUNT     TO PV-DISP-NBR                        
296900     DISPLAY 'LOC WH ROWS FOUND TO DELETE       = ' PV-DISP-NBR.          
297000     MOVE PV-XLT00022-DELNF-COUNT        TO PV-DISP-NBR                   
297100     DISPLAY 'LOC WH ROWS NOT FND TO DELETE     = ' PV-DISP-NBR.          
297200     MOVE PV-XLT00022-532-COUNT          TO PV-DISP-NBR                   
297300     DISPLAY 'LOC WH ROWS DELETE RESTRICTED     = ' PV-DISP-NBR.          
297500                                                                          
296800     MOVE PV-XLT00023-DEL-COUNT     TO PV-DISP-NBR                        
296900     DISPLAY 'OUT LOC ROWS FOUND TO DELETE      = ' PV-DISP-NBR.          
297000     MOVE PV-XLT00023-DELNF-COUNT        TO PV-DISP-NBR                   
297100     DISPLAY 'OUT LOC ROWS NOT FND TO DELETE    = ' PV-DISP-NBR.          
297200     MOVE PV-XLT00023-532-COUNT          TO PV-DISP-NBR                   
297300     DISPLAY 'OUT LOC ROWS DELETE RESTRICTED    = ' PV-DISP-NBR.          
  7600     DISPLAY SPACES.                                                      
297700*  UPDATE COUNTERS                                                        
297800     MOVE PV-XLT00010-UPD-COUNT     TO PV-DISP-NBR                        
297900     DISPLAY 'LOC ROWS UPDATED                  = ' PV-DISP-NBR.          
298000     MOVE PV-XLT00010-NF-COUNT        TO PV-DISP-NBR                      
298100     DISPLAY 'LOC ROWS NOT FOUND TO UPDATE      = ' PV-DISP-NBR.          
298200                                                                          
298300     MOVE PV-XLT00011-UPD-COUNT     TO PV-DISP-NBR                        
298400     DISPLAY 'TERR ROWS UPDATED                 = ' PV-DISP-NBR.          
298500     MOVE PV-XLT00011-NF-COUNT        TO PV-DISP-NBR                      
298600     DISPLAY 'TERR ROWS NOT FOUND TO UPDATE     = ' PV-DISP-NBR.          
298700                                                                          
298800     MOVE PV-XLT00012-UPD-COUNT     TO PV-DISP-NBR                        
298900     DISPLAY 'REGN ROWS UPDATED                 = ' PV-DISP-NBR.          
299000     MOVE PV-XLT00012-NF-COUNT        TO PV-DISP-NBR                      
299100     DISPLAY 'REGN ROWS NOT FOUND TO UPDATE     = ' PV-DISP-NBR.          
299200                                                                          
299300     MOVE PV-XLT00013-UPD-COUNT     TO PV-DISP-NBR                        
299400     DISPLAY 'DIST ROWS UPDATED                 = ' PV-DISP-NBR.          
299500     MOVE PV-XLT00013-NF-COUNT        TO PV-DISP-NBR                      
299600     DISPLAY 'DIST ROWS NOT FOUND TO UPDATE     = ' PV-DISP-NBR.          
299700                                                                          
299800     MOVE PV-XLT00014-UPD-COUNT     TO PV-DISP-NBR                        
299900     DISPLAY 'DC LOC ASGMT ROWS UPDATED         = ' PV-DISP-NBR.          
300000     MOVE PV-XLT00014-NF-COUNT        TO PV-DISP-NBR                      
300100     DISPLAY 'DC LOC ASGMT ROWS NOT FND TO UPD  = ' PV-DISP-NBR.          
300200                                                                          
300300     MOVE PV-XLT00015-UPD-COUNT     TO PV-DISP-NBR                        
300400     DISPLAY 'LOC TYP CDE UPDATED               = ' PV-DISP-NBR.          
300500     MOVE PV-XLT00015-NF-COUNT        TO PV-DISP-NBR                      
300600     DISPLAY 'LOC TYP CDE NOT FOUND TO UPDATE   = ' PV-DISP-NBR.          
300700                                                                          
300800     MOVE PV-XLT00016-UPD-COUNT     TO PV-DISP-NBR                        
300900     DISPLAY 'TM ZN CDE UPDATED                 = ' PV-DISP-NBR.          
301000     MOVE PV-XLT00016-NF-COUNT        TO PV-DISP-NBR                      
301100     DISPLAY 'TM ZN CDE   NOT FOUND TO UPDATE   = ' PV-DISP-NBR.          
301200                                                                          
301300     MOVE PV-XLT00017-UPD-COUNT     TO PV-DISP-NBR                        
301400     DISPLAY 'STD FMT CDE UPDATED               = ' PV-DISP-NBR.          
301500     MOVE PV-XLT00017-NF-COUNT        TO PV-DISP-NBR                      
301600     DISPLAY 'STD FMT CDE NOT FOUND TO UPDATE   = ' PV-DISP-NBR.          
301700                                                                          
301800     MOVE PV-XLT00018-UPD-COUNT     TO PV-DISP-NBR                        
301900     DISPLAY 'STD GP MBSHP UPDATED              = ' PV-DISP-NBR.          
302000     MOVE PV-XLT00018-NF-COUNT        TO PV-DISP-NBR                      
302100     DISPLAY 'STD GP MBSHP NOT FOUND TO UPDATE  = ' PV-DISP-NBR.          
302200                                                                          
302300     MOVE PV-XLT00019-UPD-COUNT     TO PV-DISP-NBR                        
302400     DISPLAY 'STD GP TYP   UPDATED              = ' PV-DISP-NBR.          
302500     MOVE PV-XLT00019-NF-COUNT        TO PV-DISP-NBR                      
302600     DISPLAY 'STD GP TYP   NOT FOUND TO UPDATE  = ' PV-DISP-NBR.          
302700                                                                          
302800     MOVE PV-XLT00020-UPD-COUNT     TO PV-DISP-NBR                        
302900     DISPLAY 'STR GP UPDATED                    = ' PV-DISP-NBR.          
303000     MOVE PV-XLT00020-NF-COUNT        TO PV-DISP-NBR                      
303100     DISPLAY 'STR GP       NOT FOUND TO UPDATE  = ' PV-DISP-NBR.          
303200                                                                          
303300     MOVE PV-XLT00021-UPD-COUNT     TO PV-DISP-NBR                        
303400     DISPLAY 'STR GP DTE UPDATED                = ' PV-DISP-NBR.          
303500     MOVE PV-XLT00021-NF-COUNT        TO PV-DISP-NBR                      
303600     DISPLAY 'STR GP DTE   NOT FOUND TO UPDATE  = ' PV-DISP-NBR.          
303200                                                                          
303300     MOVE PV-XLT00022-UPD-WHLOC-CNT TO PV-DISP-NBR                        
303400     DISPLAY 'LOC WH UPDATED                    = ' PV-DISP-NBR.          
303500     MOVE PV-XLT00022-NF-WHLOC-CNT    TO PV-DISP-NBR                      
303600     DISPLAY 'LOC WH NOT FOUND TO UPDATE        = ' PV-DISP-NBR.          
303200                                                                          
303300     MOVE PV-XLT00023-UPD-OUTLOC-CNT  TO PV-DISP-NBR                      
303400     DISPLAY 'OUT LOC UPDATED                   = ' PV-DISP-NBR.          
303500     MOVE PV-XLT00023-NF-OUTLOC-CNT   TO PV-DISP-NBR                      
303600     DISPLAY 'OUT LOC NOT FOUND TO UPDATE       = ' PV-DISP-NBR.          
303700                                                                          
303800     DISPLAY SPACES                                                       
297700*  COMMIT COUNTER                                                         
303900     MOVE PV-COMMIT-COUNT             TO PV-DISP-NBR                      
304000     DISPLAY 'COMMITS TAKEN                     = ' PV-DISP-NBR.          
304100                                                                          
304200 9800-SQL-WARNING.                                                        
304300                                                                          
            MOVE PV-TRANS-COUNT        TO PV-DISP-NBR.                          
304400      MOVE SQLCODE               TO SQLCODE2.                             
304500      MOVE SQLERRD(3)            TO SQLERRD3.                             
304600      DISPLAY '** ABEND **       ** = SQLWARNING'.                        
304700      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.                  
304800      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.               
304900      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                         
305000      DISPLAY '** RECORDS READ   ** = ' PV-DISP-NBR.                      
305100      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                         
305200      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                         
305300      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                         
305400      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                         
305500      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                         
305600      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                         
305700      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                         
305800      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                         
305900                                                                          
306000      MOVE 4013                  TO PV-ABEND-CODE                         
306100      CALL 'ILBOABN0' USING PV-ABEND-CODE.                                
306200                                                                          
306300 9900-SQL-ERROR.                                                          
306400                                                                          
            MOVE PV-TRANS-COUNT        TO PV-DISP-NBR.                          
306500      MOVE SQLCODE               TO SQLCODE2.                             
306600      MOVE SQLERRD(3)            TO SQLERRD3.                             
306700      DISPLAY '** ABEND **       ** = SQLERROR'.                          
306800      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.                  
306900      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.               
307000      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                         
307100      DISPLAY '** RECORDS READ   ** = ' PV-DISP-NBR.                      
307200      DISPLAY '** SQLERRM        ** = ' SQLERRM.                          
307300      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                         
307400                                                                          
307500      MOVE 4013                  TO PV-ABEND-CODE                         
307600      CALL 'ILBOABN0' USING PV-ABEND-CODE.                                
