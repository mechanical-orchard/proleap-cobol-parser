000100 IDENTIFICATION DIVISION.                                         00010012
000200 PROGRAM-ID.         SVKUP013.                                    00020012
000300 AUTHOR.             GREGORY SHEFF.                               00030012
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040012
000500 DATE-WRITTEN.       MAY 2001.                                    00050012
000600 DATE-COMPILED.                                                   00060012
000700                                                                  00150012
000800***************************************************************** 00160012
000900* THIS PROGRAM ARCHIVES DATA TO THE HISTORY TABLES.  DATA IS    * 00170012
001000* DELETED FROM SVT_KOHLS_CRD_ACCT,                              * 00180012
001100* SVT_KOHLS_CRD_TXN, SVT_CRD_ACCT_CMMT AND SVT_3RD_PTY_TRN      * 00190012
001200* AND MOVED TO THE HISTORY TABLES SVT_CRD_ACCT_HIST,            * 00200012
001300* SVT_CRD_TXN_HIST, SVT_CRD_CMMT_HIST AND SVT_3RDPTYTRNHIST.    * 00210012
001400***************************************************************** 00220012
100884******************************************************************00231015
100884*CHANGE HISTORY:                                                  00232015
100884******************************************************************00233015
100884* WR/PBI     DATE         DESCRIPTION OF CHANGES                  00234015
100884*---------- ---------- -------------------------------------------00235015
100884*CHG0100884 01-02-2015 COGNIZANT - MODIFIED THE PROGRAM TO RUN    00236015
100884*                      UNTIL 6.45 AM CST.                         00237015
100884******************************************************************00237116
100884* WR/PBI     DATE         DESCRIPTION OF CHANGES                  00237216
100884*---------- ---------- -------------------------------------------00237316
100884*CHG0141575 05-17-2016 ACCENTURE - RECOMPILE FOR SVWS004 & SVRD02200237417
100884******************************************************************00237520
100884* WR/PBI     DATE         DESCRIPTION OF CHANGES                  00237620
100884*---------- ---------- -------------------------------------------00237720
P12431*CHG0209573 10-03-2018 COGNIZANT - MODIFIED THE PROGRAM TO HANDLE 00237822
P12431*                      NEWLY ADDED ORD_NBR FIELD IN THE SVT TABLES00237920
100884******************************************************************00238015
260107*CHG0260107 08-19-2021 JIM HUNTER     ADD COPYBOOK DPWS991 TO     00238123
260107*                                     MAKE DPKUT901 CALL DYNAMIC. 00238223
100884******************************************************************00238323
100884                                                                  00239015
001600 ENVIRONMENT DIVISION.                                            00240012
001700 CONFIGURATION SECTION.                                           00250012
001800                                                                  00260012
001900 SOURCE-COMPUTER.    IBM-3090.                                    00270012
002000 OBJECT-COMPUTER.    IBM-3090.                                    00280012
002100                                                                  00290012
002200 INPUT-OUTPUT SECTION.                                            00300012
002300 FILE-CONTROL.                                                    00310012
100884                                                                  00320015
100884     SELECT SVT-TIME ASSIGN TO INP02.                             00330015
002400                                                                  00340012
002500 DATA DIVISION.                                                   00350012
002600 FILE SECTION.                                                    00360012
100884                                                                  00370015
100884 FD  SVT-TIME                                                     00380015
100884     RECORDING MODE IS F                                          00390015
100884     BLOCK CONTAINS 0 RECORDS                                     00400015
100884     LABEL RECORDS ARE OMITTED.                                   00410015
100884 01  TIME-RECORD               PIC X(80).                         00420015
100884                                                                  00430015
002800 WORKING-STORAGE SECTION.                                         00440012
002900 01  ABEND-CODE                       PIC S9(04)    VALUE +0 COMP.00450012
003000                                                                  00460012
003100******************************************************************00470012
003200*    PC-PROGRAM CONSTANTS                                        *00480012
003300******************************************************************00490012
003400 01  PC-PROGRAM-CONSTANTS.                                        00500012
003500     05  PC-PROGRAM-NAME              PIC  X(08)     VALUE        00510012
003600                                           'SVKUP013'.            00520012
003700     05  PC-CKPT-JOB-NAME        PIC  X(08)     VALUE 'SVK045  '. 00530012
003800     05  PC-CKPT-PLAN-NAME       PIC  X(08)     VALUE 'SVKUP013'. 00540012
003900     05  PC-CURRENT-PROGRAM-NAME PIC  X(08)     VALUE 'SVKUP013'. 00550012
004000                                                                  00560012
004100     05  PC-TRAN-PRES-FUNC-CODES.                                 00570012
004200         10  PC-TRAN-PRES-FUNC-OPEN   PIC  X(05)  VALUE 'OPEN '.  00580012
004300         10  PC-TRAN-PRES-FUNC-TRANS  PIC  X(05)  VALUE 'TRANS'.  00590012
004400         10  PC-TRAN-PRES-FUNC-RSTRT  PIC  X(05)  VALUE 'RSTRT'.  00600012
004500         10  PC-TRAN-PRES-FUNC-CLOSE  PIC  X(05)  VALUE 'CLOSE'.  00610012
004600******************************************************************00620012
004700* COBOL DECLARATION FOR TABLE SVT_CRD_ACCT_HIST                   00630012
004800******************************************************************00640012
004900 01  SVT00005-RCD.                                                00650012
005000     05  PV-CRD-HTB         PIC  S9(12)V    COMP-3 VALUE ZEROES.  00660012
005100     05  PV-CRD-CLO-DTE     PIC   X(10).                          00670012
005200     05  PV-CRD-CLO-TM      PIC   X(08).                          00680012
005300     05  PV-CRD-CLO-FLG     PIC   X(01).                          00690012
100884******************************************************************00700015
100884* INPUT FILE RECORD LAYOUT                                        00710015
100884******************************************************************00720015
100884 01  TIME-CONTROL-CARD.                                           00730015
100884     05 SV-CONTROL-HRS                PIC 9(02).                  00740015
100884     05 SV-CONTROL-MINS               PIC 9(02).                  00750015
100884     05 SV-CONTROL-SECS               PIC 9(02).                  00760015
100884     05 FILLER                        PIC X(74).                  00770015
100884 01  TIME-CONTROL-CARD-DISPLAY.                                   00780015
100884     05 SV-CONTROL-HRS-DISP           PIC 9(02).                  00790015
100884     05 FILLER                        PIC X(01) VALUE ':'.        00800015
100884     05 SV-CONTROL-MINS-DISP          PIC 9(02).                  00810015
100884     05 FILLER                        PIC X(01) VALUE ':'.        00820015
100884     05 SV-CONTROL-SECS-DISP          PIC 9(02).                  00830015
005500******************************************************************00840012
005600*    PROGRAM VARIABLES                                           *00850012
005700******************************************************************00860012
005800 01  PV-PROGRAM-VARIABLES.                                        00870012
005900     05  PV-PARAGRAPH-NAME            PIC  X(30)    VALUE SPACES. 00880012
006000     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)    VALUE SPACES. 00890012
006100     05  PV-CURRENT-DATE.                                         00900012
006200        10  PV-CURRENT-YEAR          PIC  9(04).                  00910012
006300        10  PV-CURRENT-MONTH         PIC  9(02).                  00920012
006400        10  PV-CURRENT-DAY           PIC  9(02).                  00930012
006500        10  PV-CURRENT-TIME.                                      00940012
006600            15  PV-CURRENT-HRS       PIC  9(02).                  00950012
006700            15  PV-CURRENT-MINS      PIC  9(02).                  00960012
006800            15  PV-CURRENT-SECS      PIC  9(02).                  00970012
006900        10                           PIC  X(07).                  00980012
007000     05  PV-CRD-HTB9                 PIC  9(12)V.                 00990012
100884     05  PV-CURRENT-CNTL-TIME.                                    01000015
100884        10  PV-CURRENT-CNTL-HRS      PIC  9(02) VALUE ZEROES.     01010015
100884        10  PV-CURRENT-CNTL-MINS     PIC  9(02) VALUE ZEROES.     01020015
100884        10  PV-CURRENT-CNTL-SECS     PIC  9(02) VALUE ZEROES.     01030015
007100                                                                  01040012
007200******************************************************************01050012
007300*    PS-PROGRAM SWITCHES                                         *01060012
007400******************************************************************01070012
007500 01  PS-PROGRAM-SWITCHES.                                         01080012
007600     05  PS-COMMENT-SW                PIC  X(01)     VALUE 'N'.   01090012
007700         88  COMMENT-MISSING                         VALUE 'N'.   01100012
007800         88  COMMENT-NOT-MISSING                     VALUE 'Y'.   01110012
007900     05  PS-ACTIVITY-SW               PIC  X(01)     VALUE 'N'.   01120012
008000         88  ACTIVITY-MISSING                        VALUE 'N'.   01130012
008100         88  ACTIVITY-NOT-MISSING                    VALUE 'Y'.   01140012
008200     05  PS-3RD-PRTY-SW               PIC  X(01)     VALUE 'N'.   01150012
008300         88  3RD-PRTY-MISSING                        VALUE 'N'.   01160012
008400         88  3RD-PRTY-NOT-MISSING                    VALUE 'Y'.   01170012
008500     05  PS-RESTART-REQUIRED-SW       PIC X(01)      VALUE 'N'.   01180012
008600         88  PS-RESTART-REQUIRED                     VALUE 'Y'.   01190012
008700         88  PS-RESTART-NOT-REQUIRED                 VALUE 'N'.   01200012
100884     05  PS-END-OF-TIME-FILE-SW       PIC X(01)      VALUE 'N'.   01210015
100884         88  PS-END-OF-TIME-FILE                     VALUE 'Y'.   01220015
100884     05  PS-END-OF-CUTOFF-TIME-SW     PIC X(01)      VALUE 'N'.   01230015
100884         88  PS-END-OF-CUTOFF-TIME                   VALUE 'Y'.   01240015
008800                                                                  01250012
008900******************************************************************01260012
009000*    VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004     *01270012
009100******************************************************************01280012
009200     COPY DPWS004.                                                01290012
009300                                                                  01300012
009400******************************************************************01310012
009500*    SV-KOHL'S STORED VALUE CARD ACTIVITY TABLE                  *01320012
009600******************************************************************01330012
009700     EXEC SQL                                                     01340012
009800         INCLUDE SVT00002                                         01350012
009900     END-EXEC.                                                    01360012
010000                                                                  01370012
010100******************************************************************01380012
010200*    SV-KOHL'S STORED VALUE CARD ACTIVITY HISTORY TABLE          *01390012
010300******************************************************************01400012
010400     EXEC SQL                                                     01410012
010500         INCLUDE SVT00006                                         01420012
010600     END-EXEC.                                                    01430012
010700                                                                  01440012
010800******************************************************************01450012
010900*    SV-KOHL'S STORED VALUE CARD TABLE                           *01460012
011000******************************************************************01470012
011100     EXEC SQL                                                     01480012
011200         INCLUDE SVT00001                                         01490012
011300     END-EXEC.                                                    01500012
011400                                                                  01510012
011500******************************************************************01520012
011600*    SV-KOHL'S STORED VALUE CARD HISTORY TABLE                   *01530012
011700******************************************************************01540012
011800     EXEC SQL                                                     01550012
011900         INCLUDE SVT00005                                         01560012
012000     END-EXEC.                                                    01570012
012100                                                                  01580012
012200******************************************************************01590012
012300*    SV-KOHL'S STORED VALUE COMMENT TABLT                        *01600012
012400******************************************************************01610012
012500     EXEC SQL                                                     01620012
012600         INCLUDE SVT00003                                         01630012
012700     END-EXEC.                                                    01640012
012800                                                                  01650012
012900******************************************************************01660012
013000*    SV-KOHL'S STORED VALUE COMMENT HISTORY TABLE                *01670012
013100******************************************************************01680012
013200     EXEC SQL                                                     01690012
013300         INCLUDE SVT00007                                         01700012
013400     END-EXEC.                                                    01710012
013500                                                                  01720012
013600******************************************************************01730012
013700*    SV-KOHL'S STORED VALUE THIRD PARTY TRANSACTION TABLE        *01740012
013800******************************************************************01750012
013900     EXEC SQL                                                     01760012
014000         INCLUDE SVT00015                                         01770012
014100     END-EXEC.                                                    01780012
014200                                                                  01790012
014300******************************************************************01800012
014400*    SV-KOHL'S STORED VALUE THIRD PARTY TRANSACTION HISTORY TABLE*01810012
014500******************************************************************01820012
014600     EXEC SQL                                                     01830012
014700         INCLUDE SVT00016                                         01840012
014800     END-EXEC.                                                    01850012
014900                                                                  01860012
015000******************************************************************01870012
015100*    STANDARD LAYOUT FOR THE SQL COMMUNCATIONS AREA              *01880012
015200******************************************************************01890012
015300     EXEC SQL                                                     01900012
015400         INCLUDE SQLCA                                            01910012
015500     END-EXEC.                                                    01920012
015600                                                                  01930012
015700     COPY SQLCA2.                                                 01940012
015800                                                                  01950012
015900******************************************************************01960012
016000*  TRANSACTION PREPARATION MODULE COMMUNICATIONS AREA            *01970012
016100******************************************************************01980012
260107     COPY DPWS991.                                                01990023
016200                                                                  01991023
016200     COPY DPLS001.                                                01992023
016300     05  WORK-STORAGE-PASSED.                                     02000012
016400******************************************************************02010012
016500*PA - PROGRAM ACCUMULATORS                                        02020012
016600******************************************************************02030012
016700         10  PROGRAM-ACCUMULATORS.                                02040012
016800             15  PA-INSERT-HAC        PIC  9(09)    VALUE ZEROES. 02050012
016900             15  PA-INSERT-HTB        PIC  9(09)    VALUE ZEROES. 02060012
017000             15  PA-INSERT-HCM        PIC  9(09)    VALUE ZEROES. 02070012
017100             15  PA-INSERT-TPT        PIC  9(09)    VALUE ZEROES. 02080012
017200             15  PA-DELETE-ACT        PIC  9(09)    VALUE ZEROES. 02090012
017300             15  PA-DELETE-TBL        PIC  9(09)    VALUE ZEROES. 02100012
017400             15  PA-DELETE-COM        PIC  9(09)    VALUE ZEROES. 02110012
017500             15  PA-DELETE-TPT        PIC  9(09)    VALUE ZEROES. 02120012
017600                                                                  02150012
017700 01  FILLER                          PIC X(4096)  VALUE SPACE.    02160012
017800******************************************************************02170012
017900 PROCEDURE DIVISION.                                              02180012
018000                                                                  02190012
018100 A100-MAINLINE.                                                   02200012
018200                                                                  02210012
018300     PERFORM A100-INITIALIZE.                                     02220012
018400     PERFORM A200-PROCESS-SVT-CRD-ACCT-HIST                       02230012
100884         UNTIL DP001-PREP-TRANS-EOF OR PS-END-OF-CUTOFF-TIME.     02240015
018600     PERFORM A300-WRAPUP.                                         02250012
018700     GOBACK.                                                      02260012
018800                                                                  02270012
018900******************************************************************02280012
019000*     A100-INITIALIZE                                            *02290012
019100* ==> PROCESSES:                                                 *02300012
019200* ==> PERFORMED FROM: A100-MAINLINE                              *02310012
019300******************************************************************02320012
019400 A100-INITIALIZE.                                                 02330012
019500                                                                  02340012
019600     MOVE PC-TRAN-PRES-FUNC-OPEN TO DP001-FUNC-CODE.              02350012
019700     PERFORM Z100-BUILD-COMM-AREA-TRAN-PRES.                      02360012
100884     DISPLAY ' **********************************'                02370015
100884     DISPLAY ' **START OF SVKUP013** '                            02380015
100884     DISPLAY '                       '                            02390015
019800                                                                  02400012
019900     MOVE FUNCTION CURRENT-DATE    TO PV-CURRENT-DATE.            02410012
100884     DISPLAY 'START TIME:' PV-CURRENT-TIME                        02420015
100884                                                                  02430015
100884     OPEN INPUT  SVT-TIME.                                        02440015
100884                                                                  02450015
100884     READ SVT-TIME INTO TIME-CONTROL-CARD                         02460015
100884        AT END                                                    02470015
100884           SET PS-END-OF-TIME-FILE TO TRUE.                       02480015
100884                                                                  02492015
100884     CLOSE SVT-TIME.                                              02493015
100884                                                                  02494015
100884     IF PS-END-OF-TIME-FILE                                       02500015
100884        DISPLAY ' '                                               02510015
100884        DISPLAY '** ABEND     **'                                 02520015
100884        DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME             02530015
100884        DISPLAY '** PARAGRAPH **  = A100-INITIALIZE      '        02540015
100884        DISPLAY '** CONTROL TIME FILE IS EMPTY  '                 02550015
100884        DISPLAY ' '                                               02560015
100884        MOVE +4003 TO ABEND-CODE                                  02570015
100884        CALL 'ILBOABN0' USING ABEND-CODE                          02580018
100884     ELSE                                                         02590015
100884        MOVE SV-CONTROL-HRS  TO SV-CONTROL-HRS-DISP               02600015
100884        MOVE SV-CONTROL-MINS TO SV-CONTROL-MINS-DISP              02610015
100884        MOVE SV-CONTROL-SECS TO SV-CONTROL-SECS-DISP              02620015
100884        DISPLAY PC-PROGRAM-NAME 'CONTROL CARD TIME:  '            02630015
100884                                 TIME-CONTROL-CARD-DISPLAY        02640015
100884     END-IF.                                                      02650015
100884                                                                  02662015
100884     INITIALIZE PV-CURRENT-TIME.                                  02670015
100884     ACCEPT PV-CURRENT-TIME        FROM TIME.                     02680015
100884                                                                  02690015
100884     MOVE SV-CONTROL-HRS  TO PV-CURRENT-CNTL-HRS.                 02700015
100884     MOVE SV-CONTROL-MINS TO PV-CURRENT-CNTL-MINS.                02710015
100884     MOVE SV-CONTROL-SECS TO PV-CURRENT-CNTL-SECS.                02720015
100884                                                                  02730015
100884     IF PV-CURRENT-TIME >= PV-CURRENT-CNTL-TIME                   02740015
100884        SET PS-END-OF-CUTOFF-TIME TO TRUE                         02750015
100884     END-IF.                                                      02760015
100884                                                                  02761015
100884     IF PS-END-OF-CUTOFF-TIME                                     02770015
100884        DISPLAY 'RUNTIME HAS EXCEEDED THE CUTOFF TIME '           02780015
100884        DISPLAY 'NO RECORDS HAVE BEEN PROCESSED'                  02790015
100884     END-IF.                                                      02800015
020200*************************************************                 02810012
020300 A200-PROCESS-SVT-CRD-ACCT-HIST.                                  02820012
020400                                                                  02830012
020500     SET PS-RESTART-NOT-REQUIRED TO TRUE.                         02840012
020600     SET ACTIVITY-NOT-MISSING TO TRUE.                            02850012
020700     SET 3RD-PRTY-NOT-MISSING TO TRUE.                            02860012
020800     SET COMMENT-NOT-MISSING TO TRUE.                             02870012
020900                                                                  02880012
021000     IF PV-CRD-CLO-FLG = 'Y'                                      02890012
021100        PERFORM C310-INSERT-CLO-TABLE-RECORD                      02900012
021200     ELSE                                                         02910012
021300        PERFORM C300-INSERT-TABLE-RECORD                          02920012
021400     END-IF.                                                      02930012
021500     PERFORM B300-INSERT-ACTIVITY-RECORD.                         02940012
021600     PERFORM D300-INSERT-COMMENT-RECORD.                          02950012
021700     PERFORM E300-INSERT-THIRD-PTY-RECORD.                        02960012
021800                                                                  02970012
021900     IF ACTIVITY-NOT-MISSING                                      02980012
022000        PERFORM B400-SVT-KOHLS-CRD-TXN-DELETE                     02990012
022100     END-IF.                                                      03000012
022200                                                                  03010012
022300     IF COMMENT-NOT-MISSING                                       03020012
022400        PERFORM D400-SVT-CRD-ACCT-CMMT-DELETE                     03030012
022500     END-IF.                                                      03040012
022600                                                                  03050012
022700     IF 3RD-PRTY-NOT-MISSING                                      03060012
022800        PERFORM E400-SVT-THIRD-PTY-TRN-DELETE                     03070012
022900     END-IF.                                                      03080012
023000                                                                  03090012
023100     PERFORM C400-SVT-KOHLS-CRD-ACCT-DELETE.                      03100012
023200                                                                  03110012
023300*----------------------------------------------------------------*03120012
023400*  IF A RESTART IS REQUIRED, ISSUE A RESTART CALL RATHER THAN A  *03130012
023500*  TRANS CALL.  THIS WILL ALLOW PROCESSING TO RESUME WITH THE    *03140012
023600*  FIRST TRANSACTION AFTER THE LAST COMMIT.                      *03150012
023700*----------------------------------------------------------------*03160012
023800     IF PS-RESTART-REQUIRED                                       03170012
023900         MOVE PC-TRAN-PRES-FUNC-RSTRT TO DP001-FUNC-CODE          03180012
024000     ELSE                                                         03190012
024100         MOVE PC-TRAN-PRES-FUNC-TRANS TO DP001-FUNC-CODE          03200012
024200     END-IF.                                                      03210012
024300                                                                  03220012
024400     PERFORM Z100-BUILD-COMM-AREA-TRAN-PRES.                      03230012
100884                                                                  03240015
100884     INITIALIZE PV-CURRENT-TIME.                                  03280015
100884     ACCEPT PV-CURRENT-TIME FROM TIME.                            03290015
100884     MOVE PV-CURRENT-HRS  TO SV-CONTROL-HRS-DISP.                 03300015
100884     MOVE PV-CURRENT-MINS TO SV-CONTROL-MINS-DISP.                03310015
100884     MOVE PV-CURRENT-SECS TO SV-CONTROL-SECS-DISP.                03320015
100884     IF  PV-CURRENT-TIME >= PV-CURRENT-CNTL-TIME                  03330015
100884         SET PS-END-OF-CUTOFF-TIME TO TRUE                        03340015
100884         DISPLAY 'RUNTIME HAS REACHED THE CUTOFF TIME,'           03360015
100884         DISPLAY 'CERTAIN RECORDS HAVE BEEN PROCESSED.'           03370015
100884         DISPLAY 'TIME WHEN PROGRAM ENDS : '                      03380015
100884                                    TIME-CONTROL-CARD-DISPLAY     03390015
100884     END-IF.                                                      03420015
024500                                                                  03440012
024600****************************************************************  03450012
024700 A300-WRAPUP.                                                     03460012
024800                                                                  03470012
024900     MOVE PC-TRAN-PRES-FUNC-CLOSE TO DP001-FUNC-CODE.             03490012
025000     PERFORM Z100-BUILD-COMM-AREA-TRAN-PRES.                      03500012
100884     DISPLAY '*******************************'                    03510015
100884     DISPLAY '*****SVKUP013 SUMMARY*******'                       03520015
100884     DISPLAY '                            '                       03530015
025100     DISPLAY 'SVT-CRD-ACCT-HIST RCDS INSERTED  = ' PA-INSERT-HTB. 03540012
025200     DISPLAY 'SVT-KOHLS-CRD-ACCT RCDS DELETED  = ' PA-DELETE-TBL. 03550012
025300     DISPLAY 'SVT-CRD-TXN-HIST ACCTS INSERTED  = ' PA-INSERT-HAC. 03560012
025400     DISPLAY 'SVT-KOHLS-CRD-TXN ACCTS DELETED  = ' PA-DELETE-ACT. 03570012
025500     DISPLAY 'SVT-CRD-CMMT-HIST ACCTS INSERTED = ' PA-INSERT-HCM. 03580012
025600     DISPLAY 'SVT-CRD-ACCT-CMMT ACCTS DELETED  = ' PA-DELETE-COM. 03590012
025700     DISPLAY 'SVT-3RDPTYTRNHIST ACCTS INSERTED = ' PA-INSERT-TPT. 03600012
025800     DISPLAY 'SVT-3RD-PTY-TRN ACCTS DELETED    = ' PA-DELETE-TPT. 03610012
025900     DISPLAY '**************** EOJ *************'.                03660012
026000                                                                  03670012
026100******************************************************************03680012
026200 B300-INSERT-ACTIVITY-RECORD.                                     03690012
026300                                                                  03700012
026400     EXEC SQL                                                     03710012
026500          INSERT                                                  03720012
026600             INTO SVT_CRD_TXN_HIST                                03730012
026700               SELECT                                             03740012
026800                 CRD_NBR                                          03750012
026900               , TRN_AUTH_TMST                                    03760012
027000               , DRV_LIC_NBR                                      03770012
027100               , TRN_RVRSL_CDE                                    03780012
027200               , TRN_VOID_IND                                     03790012
027300               , ACTVY_TYP_CDE                                    03800012
027400               , POS_DTE                                          03810012
027500               , STR_NBR                                          03820012
027600               , POS_TRMNL_NBR                                    03830012
027700               , POS_TRN_NBR                                      03840012
027800               , TRN_PSTD_TMST                                    03850012
027900               , APP_AUTH_AMT                                     03860012
028000               , POS_OPRT_ID                                      03870012
028100               , APVL_USR_ID                                      03880012
028200               , ACTVY_STAT_CDE                                   03890012
028300               , ORIG_AUTH_AMT                                    03900012
028400               , ST_CDE                                           03910012
P12431               , ORD_NBR                                          03911019
028500             FROM SVT_KOHLS_CRD_TXN                               03920012
028600        WHERE CRD_NBR = :PV-CRD-HTB                               03930012
028700     END-EXEC.                                                    03940012
028800                                                                  03950012
028900     EVALUATE TRUE                                                03960012
029000         WHEN SQLCODE = +0                                        03970012
029100              ADD +1 TO PA-INSERT-HAC                             03980012
029200         WHEN SQLCODE = +100                                      03990012
029300             SET ACTIVITY-MISSING TO TRUE                         04000012
029400         WHEN OTHER                                               04010012
029500             DISPLAY 'INSERT ERROR **** ' PV-CRD-HTB ' '          04020012
029600                 SVT00002-TRN-AUTH-TMST                           04030012
029700             MOVE 'B300-INSERT-ACTIVITY-RECORD'                   04040012
029800                               TO PV-PARAGRAPH-NAME               04050012
029900             MOVE 'INSERT                        '                04060012
030000                               TO PV-DB2-OPERATION-ATTEMPTED      04070012
030100             PERFORM Z900-SQL-ABEND                               04080012
030200     END-EVALUATE.                                                04090012
030300                                                                  04100012
030400******************************************************************04110012
030500 B400-SVT-KOHLS-CRD-TXN-DELETE.                                   04120012
030600                                                                  04130012
030700     EXEC SQL                                                     04140012
030800         DELETE FROM SVT_KOHLS_CRD_TXN                            04150012
030900             WHERE CRD_NBR = :PV-CRD-HTB                          04160012
031000     END-EXEC.                                                    04170012
031100                                                                  04180012
031200     EVALUATE TRUE                                                04190012
031300         WHEN SQLCODE = +0                                        04200012
031400             ADD 1 TO PA-DELETE-ACT                               04210012
031500         WHEN SQLCODE = +100                                      04220012
031600             CONTINUE                                             04230012
031700         WHEN OTHER                                               04240012
031800             MOVE 'B400-SVT-KOHLS-CRD-TXN-UPDATE '                04250012
031900                           TO PV-PARAGRAPH-NAME                   04260012
032000             MOVE 'DELETE SVT-KOHLS-CRD-TXN                '      04270012
032100                               TO PV-DB2-OPERATION-ATTEMPTED      04280012
032200             DISPLAY 'DELETE ERROR **** ' PV-CRD-HTB              04290012
032300             PERFORM Z900-SQL-ABEND                               04300012
032400     END-EVALUATE.                                                04310012
032500                                                                  04320012
032600******************************************************************04330012
032700 C300-INSERT-TABLE-RECORD.                                        04340012
032800                                                                  04350012
032900     EXEC SQL                                                     04360012
033000          INSERT INTO SVT_CRD_ACCT_HIST                           04370012
033100             SELECT                                               04380012
033200                 CRD_NBR                                          04390012
033300                ,CRD_PROD_YR                                      04400012
033400                ,SHIPT_REQ_NBR                                    04410012
033500                ,CNTL_NBR                                         04420012
033600                ,PDNNTD_IND                                       04430012
033700                ,CRD_SPCTY_TYP_CDE                                04440012
033800                ,CRD_TYP_CDE                                      04450012
033900                ,CRD_STAT_CDE                                     04460012
034000                ,CRD_STAT_CHG_DTE                                 04470012
034100                ,CRD_STAT_CHG_TM                                  04480012
034200                ,STAT_CHG_BY_USR_ID                               04490012
034300                ,CRD_DISTRB_DTE                                   04500012
034400                ,CRD_DISTRB_TM                                    04510012
034500                ,DISTRB_USR_ID                                    04520012
034600                ,STR_NBR                                          04530012
034700                ,CRD_CLO_DTE                                      04540012
034800                ,CRD_CLO_TM                                       04550012
034900                ,CLO_USR_ID                                       04560012
035000                ,CRD_PIN_NBR                                      04570012
035100                ,CURRENT_DATE                                     04580012
035200             FROM SVT_KOHLS_CRD_ACCT                              04590012
035300        WHERE CRD_NBR = :PV-CRD-HTB                               04600012
035400     END-EXEC.                                                    04610012
035500                                                                  04620012
035600     EVALUATE TRUE                                                04630012
035700         WHEN SQLCODE = +0                                        04640012
035800              ADD +1 TO PA-INSERT-HTB                             04650012
035900         WHEN OTHER                                               04660012
036000             DISPLAY 'INSERT ERROR **** ' PV-CRD-HTB              04670012
036100             MOVE 'C300-INSERT-TABLE-RECORD'                      04680012
036200                               TO PV-PARAGRAPH-NAME               04690012
036300             MOVE 'INSERT                      '                  04700012
036400                               TO PV-DB2-OPERATION-ATTEMPTED      04710012
036500             PERFORM Z900-SQL-ABEND                               04720012
036600     END-EVALUATE.                                                04730012
036700                                                                  04740012
036800******************************************************************04750012
036900 C310-INSERT-CLO-TABLE-RECORD.                                    04760012
037000                                                                  04770012
037100     EXEC SQL                                                     04780012
037200             SELECT                                               04790012
037300                 CRD_NBR                                          04800012
037400                ,CRD_PROD_YR                                      04810012
037500                ,SHIPT_REQ_NBR                                    04820012
037600                ,CNTL_NBR                                         04830012
037700                ,PDNNTD_IND                                       04840012
037800                ,CRD_SPCTY_TYP_CDE                                04850012
037900                ,CRD_TYP_CDE                                      04860012
038000                ,CRD_STAT_CDE                                     04870012
038100                ,CRD_STAT_CHG_DTE                                 04880012
038200                ,CRD_STAT_CHG_TM                                  04890012
038300                ,STAT_CHG_BY_USR_ID                               04900012
038400                ,CRD_DISTRB_DTE                                   04910012
038500                ,CRD_DISTRB_TM                                    04920012
038600                ,DISTRB_USR_ID                                    04930012
038700                ,STR_NBR                                          04940012
038800                ,CRD_CLO_DTE                                      04950012
038900                ,CRD_CLO_TM                                       04960012
039000                ,CLO_USR_ID                                       04970012
039100                ,CRD_PIN_NBR                                      04980012
039200            INTO                                                  04990012
039300                 :SVT00001-CRD-NBR                                05000012
039400                ,:SVT00001-CRD-PROD-YR                            05010012
039500                ,:SVT00001-SHIPT-REQ-NBR                          05020012
039600                ,:SVT00001-CNTL-NBR                               05030012
039700                ,:SVT00001-PDNNTD-IND                             05040012
039800                ,:SVT00001-CRD-SPCTY-TYP-CDE                      05050012
039900                ,:SVT00001-CRD-TYP-CDE                            05060012
040000                ,:SVT00001-CRD-STAT-CDE                           05070012
040100                ,:SVT00001-CRD-STAT-CHG-DTE                       05080012
040200                ,:SVT00001-CRD-STAT-CHG-TM                        05090012
040300                ,:SVT00001-STAT-CHG-BY-USR-ID                     05100012
040400                ,:SVT00001-CRD-DISTRB-DTE                         05110012
040500                ,:SVT00001-CRD-DISTRB-TM                          05120012
040600                ,:SVT00001-DISTRB-USR-ID                          05130012
040700                ,:SVT00001-STR-NBR                                05140012
040800                ,:SVT00001-CRD-CLO-DTE                            05150012
040900                ,:SVT00001-CRD-CLO-TM                             05160012
041000                ,:SVT00001-CLO-USR-ID                             05170012
041100                ,:SVT00001-CRD-PIN-NBR                            05180012
041200             FROM SVT_KOHLS_CRD_ACCT                              05190012
041300        WHERE CRD_NBR = :PV-CRD-HTB                               05200012
041400     END-EXEC.                                                    05210012
041500                                                                  05220012
041600     EVALUATE TRUE                                                05230012
041700         WHEN SQLCODE = +0                                        05240012
041800              CONTINUE                                            05250012
041900         WHEN OTHER                                               05260012
042000             DISPLAY 'SELECT ERROR **** ' PV-CRD-HTB              05270012
100884             DISPLAY 'SQLCODE :' SQLCODE                          05280015
042100             MOVE 'C310-INSERT-CLO-TABLE-RECORD'                  05290012
042200                               TO PV-PARAGRAPH-NAME               05300012
042300             MOVE 'SELECT                        '                05310012
042400                               TO PV-DB2-OPERATION-ATTEMPTED      05320012
042500             PERFORM Z900-SQL-ABEND                               05330012
042600     END-EVALUATE.                                                05340012
042700                                                                  05350012
042800     MOVE 'HQ'           TO SVT00001-CRD-STAT-CDE.                05360012
042900     MOVE PV-CRD-CLO-DTE TO SVT00001-CRD-CLO-DTE.                 05370012
043000     MOVE PV-CRD-CLO-TM  TO SVT00001-CRD-CLO-TM.                  05380012
043010     MOVE 'SVKUP013'     TO SVT00001-CLO-USR-ID.                  05390012
043100*    MOVE PV-CRD-CLO-DTE TO SVT00001-CRD-STAT-CHG-DTE.            05400012
043200*    MOVE PV-CRD-CLO-TM  TO SVT00001-CRD-STAT-CHG-TM.             05410012
043300     MOVE 'SVKUP013'     TO SVT00001-STAT-CHG-BY-USR-ID.          05420012
043400                                                                  05430012
043500     EXEC SQL                                                     05440012
043600          INSERT INTO SVT_CRD_ACCT_HIST                           05450012
043700                (CRD_NBR                                          05460012
043800                ,CRD_PROD_YR                                      05470012
043900                ,SHIPT_REQ_NBR                                    05480012
044000                ,CNTL_NBR                                         05490012
044100                ,PDNNTD_IND                                       05500012
044200                ,CRD_SPCTY_TYP_CDE                                05510012
044300                ,CRD_TYP_CDE                                      05520012
044400                ,CRD_STAT_CDE                                     05530012
044500                ,CRD_STAT_CHG_DTE                                 05540012
044600                ,CRD_STAT_CHG_TM                                  05550012
044700                ,STAT_CHG_BY_USR_ID                               05560012
044800                ,CRD_DISTRB_DTE                                   05570012
044900                ,CRD_DISTRB_TM                                    05580012
045000                ,DISTRB_USR_ID                                    05590012
045100                ,STR_NBR                                          05600012
045200                ,CRD_CLO_DTE                                      05610012
045300                ,CRD_CLO_TM                                       05620012
045400                ,CLO_USR_ID                                       05630012
045500                ,CRD_PIN_NBR                                      05640012
045600                ,HIST_DTE)                                        05650012
045700          VALUES                                                  05660012
045800                (:SVT00001-CRD-NBR                                05670012
045900                ,:SVT00001-CRD-PROD-YR                            05680012
046000                ,:SVT00001-SHIPT-REQ-NBR                          05690012
046100                ,:SVT00001-CNTL-NBR                               05700012
046200                ,:SVT00001-PDNNTD-IND                             05710012
046300                ,:SVT00001-CRD-SPCTY-TYP-CDE                      05720012
046400                ,:SVT00001-CRD-TYP-CDE                            05730012
046500                ,:SVT00001-CRD-STAT-CDE                           05740012
                      , CURRENT DATE                                    05750012
                      , CURRENT TIME                                    05760012
046600*               ,:SVT00001-CRD-STAT-CHG-DTE                       05770012
046700*               ,:SVT00001-CRD-STAT-CHG-TM                        05780012
046800                ,:SVT00001-STAT-CHG-BY-USR-ID                     05790012
046900                ,:SVT00001-CRD-DISTRB-DTE                         05800012
047000                ,:SVT00001-CRD-DISTRB-TM                          05810012
047100                ,:SVT00001-DISTRB-USR-ID                          05820012
047200                ,:SVT00001-STR-NBR                                05830012
047300                ,:SVT00001-CRD-CLO-DTE                            05840012
047400                ,:SVT00001-CRD-CLO-TM                             05850012
047500                ,:SVT00001-CLO-USR-ID                             05860012
047600                ,:SVT00001-CRD-PIN-NBR                            05870012
047700                ,CURRENT_DATE)                                    05880012
048000     END-EXEC.                                                    05890012
048100                                                                  05900012
048200     EVALUATE TRUE                                                05910012
048300         WHEN SQLCODE = +0                                        05920012
048310              ADD +1 TO PA-INSERT-HTB                             05930012
048500         WHEN OTHER                                               05940012
048600             DISPLAY 'INSERT ERROR **** ' PV-CRD-HTB              05950012
048700             MOVE 'C310-INSERT-CLO-TABLE-RECORD'                  05960012
048800                               TO PV-PARAGRAPH-NAME               05970012
048900             MOVE 'INSERT                        '                05980012
049000                               TO PV-DB2-OPERATION-ATTEMPTED      05990012
049100             PERFORM Z900-SQL-ABEND                               06000012
049200     END-EVALUATE.                                                06010012
049300                                                                  06020012
049400******************************************************************06030012
049500 C400-SVT-KOHLS-CRD-ACCT-DELETE.                                  06040012
049600                                                                  06050012
049700     EXEC SQL                                                     06060012
049800         DELETE FROM SVT_KOHLS_CRD_ACCT                           06070012
049900             WHERE CRD_NBR = :PV-CRD-HTB                          06080012
050000     END-EXEC.                                                    06090012
050100                                                                  06100012
050200     EVALUATE TRUE                                                06110012
050300         WHEN SQLCODE = +0                                        06120012
050400             ADD 1 TO PA-DELETE-TBL                               06130012
050500         WHEN SQLCODE = +100                                      06140012
050600             CONTINUE                                             06150012
050700         WHEN OTHER                                               06160012
050800             MOVE 'C400-SVT-KOHLS-CRD-ACCT-UPDATE '               06170012
050900                               TO PV-PARAGRAPH-NAME               06180012
051000             MOVE 'DELETE SVT-KOHLS-CRD-ACCT                '     06190012
051100                               TO PV-DB2-OPERATION-ATTEMPTED      06200012
051200             DISPLAY 'DELETE ERROR **** ' PV-CRD-HTB              06210012
051300             PERFORM Z900-SQL-ABEND                               06220012
051400     END-EVALUATE.                                                06230012
051500                                                                  06240012
051600******************************************************************06250012
051700 D300-INSERT-COMMENT-RECORD.                                      06260012
051800                                                                  06270012
051900     EXEC SQL                                                     06280012
052000          INSERT                                                  06290012
052100             INTO SVT_CRD_CMMT_HIST                               06300012
052200               SELECT                                             06310012
052300                CRD_NBR                                           06320012
052400               ,CRE_TMST                                          06330012
052500               ,CMNT_SEQ_NBR                                      06340012
052600               ,CMNT_TXT                                          06350012
052700               ,CRE_BY_USR_ID                                     06360012
052800             FROM SVT_CRD_ACCT_CMMT                               06370012
052900         WHERE CRD_NBR = :PV-CRD-HTB                              06380012
053000     END-EXEC.                                                    06390012
053100                                                                  06400012
053200     EVALUATE TRUE                                                06410012
053300         WHEN SQLCODE = +0                                        06420012
053400              ADD +1 TO PA-INSERT-HCM                             06430012
053500         WHEN SQLCODE = +100                                      06440012
053600             SET COMMENT-MISSING TO TRUE                          06450012
053700         WHEN OTHER                                               06460012
053800             DISPLAY 'INSERT ERROR **** ' PV-CRD-HTB ' '          06470012
053900                   SVT00003-CRE-TMST ' '                          06480012
054000                   SVT00003-CMNT-SEQ-NBR                          06490012
054100             MOVE 'D300-INSERT-COMMENT-RECORD'                    06500012
054200                           TO PV-PARAGRAPH-NAME                   06510012
054300             MOVE 'INSERT SVT-CRD-CMMT-HIST                '      06520012
054400                           TO PV-DB2-OPERATION-ATTEMPTED          06530012
054500             PERFORM Z900-SQL-ABEND                               06540012
054600     END-EVALUATE.                                                06550012
054700                                                                  06560012
054800******************************************************************06570012
054900 D400-SVT-CRD-ACCT-CMMT-DELETE.                                   06580012
055000                                                                  06590012
055100     EXEC SQL                                                     06600012
055200         DELETE FROM SVT_CRD_ACCT_CMMT                            06610012
055300            WHERE CRD_NBR = :PV-CRD-HTB                           06620012
055400     END-EXEC.                                                    06630012
055500                                                                  06640012
055600     EVALUATE TRUE                                                06650012
055700         WHEN SQLCODE = +0                                        06660012
055800             ADD 1 TO PA-DELETE-COM                               06670012
055900         WHEN SQLCODE = +100                                      06680012
056000             CONTINUE                                             06690012
056100         WHEN OTHER                                               06700012
056200             MOVE 'B400-SVT-CRD-ACCT-CMMT-DELETE '                06710012
056300                               TO PV-PARAGRAPH-NAME               06720012
056400             MOVE 'DELETE SVT-CRD-ACCT-CMMT                '      06730012
056500                               TO PV-DB2-OPERATION-ATTEMPTED      06740012
056600             DISPLAY 'DELETE ERROR **** ' PV-CRD-HTB              06750012
056700             PERFORM Z900-SQL-ABEND                               06760012
056800     END-EVALUATE.                                                06770012
056900                                                                  06780012
057000******************************************************************06790012
057100 E300-INSERT-THIRD-PTY-RECORD.                                    06800012
057200                                                                  06810012
057300     SET 3RD-PRTY-NOT-MISSING TO TRUE.                            06820012
057400                                                                  06830012
057500     EXEC SQL                                                     06840012
057600          INSERT                                                  06850012
057700            INTO SVT_3RDPTYTRNHIST                                06860012
057800          SELECT                                                  06870012
057900                 CRD_NBR                                          06880012
058000               , TRN_AUTH_TMST                                    06890012
058100               , TRSM_DTE_TM_TXT                                  06900012
058200               , AUD_NBR                                          06910012
058300               , SELR_TRN_TM_TXT                                  06920012
058400               , SELR_TRN_DTE_TXT                                 06930012
058500               , POS_ENTR_CDE                                     06940012
058600               , POS_CND_CDE                                      06950012
058700               , POS_REF_NBR                                      06960012
058800               , SELR_STR_NBR                                     06970012
058900               , SELR_TRMNL_ID                                    06980012
059000               , DIV_ID                                           06990012
059100               , CMNT_TXT                                         07000012
059200               , SELR_NM                                          07010012
059300               , SELR_CTY_NM                                      07020012
059400               , SELR_PSTL_CDE                                    07030012
059500               , SELR_CNTRY_CDE                                   07040012
059600               , TRMNL_DIV_ID                                     07050012
059700               , KOHLS_AUTH_CDE                                   07060012
059800               , PRCG_CDE                                         07070012
059900               , SELR_TRN_ID                                      07080012
060000             FROM SVT_3RD_PTY_TRN                                 07090012
060100        WHERE CRD_NBR = :PV-CRD-HTB                               07100012
060200     END-EXEC.                                                    07110012
060300                                                                  07120012
060400     EVALUATE TRUE                                                07130012
060500         WHEN SQLCODE = +0                                        07140012
060600              ADD +1 TO PA-INSERT-TPT                             07150012
060700         WHEN SQLCODE = +100                                      07160012
060800             SET 3RD-PRTY-MISSING TO TRUE                         07170012
060900         WHEN OTHER                                               07180012
061000             DISPLAY 'INSERT ERROR **** ' PV-CRD-HTB ' '          07190012
061100                 SVT00015-TRN-AUTH-TMST                           07200012
061200             MOVE 'E300-INSERT-THIRD-PTY-RECORD'                  07210012
061300                               TO PV-PARAGRAPH-NAME               07220012
061400             MOVE 'INSERT                        '                07230012
061500                               TO PV-DB2-OPERATION-ATTEMPTED      07240012
061600             PERFORM Z900-SQL-ABEND                               07250012
061700     END-EVALUATE.                                                07260012
061800                                                                  07270012
061900******************************************************************07280012
062000 E400-SVT-THIRD-PTY-TRN-DELETE.                                   07290012
062100                                                                  07300012
062200     EXEC SQL                                                     07310012
062300         DELETE FROM SVT_3RD_PTY_TRN                              07320012
062400             WHERE CRD_NBR = :PV-CRD-HTB                          07330012
062500     END-EXEC.                                                    07340012
062600                                                                  07350012
062700     EVALUATE TRUE                                                07360012
062800         WHEN SQLCODE = +0                                        07370012
062900             ADD 1 TO PA-DELETE-TPT                               07380012
063000         WHEN SQLCODE = +100                                      07390012
063100             CONTINUE                                             07400012
063200         WHEN OTHER                                               07410012
063300             MOVE 'E400-SVT-THIRD-PTY-TRN-DELETE '                07420012
063400                           TO PV-PARAGRAPH-NAME                   07430012
063500             MOVE 'DELETE SVT_3RDPTYTRNHIST                '      07440012
063600                               TO PV-DB2-OPERATION-ATTEMPTED      07450012
063700             DISPLAY 'DELETE ERROR **** ' PV-CRD-HTB              07460012
063800             PERFORM Z900-SQL-ABEND                               07470012
063900     END-EVALUATE.                                                07480012
064000                                                                  07490012
064100******************************************************************07500012
064200*     Z100-BUILD-COMM-AREA-TRAN-PRES                             *07510012
064300* ==> PROCESSES:                                                 *07520012
064400*     - BUILD THE COMMUNICATION AREA FOR A CALL TO THE           *07530012
064500*       TRANSACTION PRESENTATION MODULE.                         *07540012
064600* ==> PERFORMED FROM:                                            *07550012
064700******************************************************************07560012
064800 Z100-BUILD-COMM-AREA-TRAN-PRES.                                  07570012
064900                                                                  07580012
065000     MOVE LENGTH OF WORK-STORAGE-PASSED                           07590012
065100                                       TO DP001-WORK-STRG-LENGTH. 07600012
065200     MOVE PC-CKPT-JOB-NAME             TO DP001-JOB-NAME.         07610012
065300     MOVE PC-CKPT-PLAN-NAME            TO DP001-PLAN-NAME.        07620012
065400     PERFORM Z900-CALL-TRANS-PRES-MODULE.                         07630012
065500     MOVE DP001-TRANS-RECORD           TO SVT00005-RCD.           07640012
065600                                                                  07650012
065700******************************************************************07660012
065800*     Z900-SQL-ABEND                                             *07670012
065900******************************************************************07680012
066000 Z900-SQL-ABEND.                                                  07690012
066100                                                                  07700012
066200     DISPLAY ' '.                                                 07710012
066300     DISPLAY 'Z900-SQL-ABEND'.                                    07720012
066400     DISPLAY '**  ABEND     **'.                                  07730012
066500     DISPLAY '**  PROGRAM   ** = ' PC-PROGRAM-NAME.               07740012
066600     DISPLAY '**  PARAGRAPH ** = ' PV-PARAGRAPH-NAME.             07750012
066700     DISPLAY '**  OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.    07760012
066800                                                                  07770012
066900******************************************************************07780012
067000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *07790012
067100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *07800012
067200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *07810012
067300* FORMAT.                                                        *07820012
067400******************************************************************07830012
067500     COPY DPPD004.                                                07840012
067600                                                                  07850012
067700     MOVE +4013 TO ABEND-CODE.                                    07860012
067800     CALL 'ILBOABN0' USING ABEND-CODE.                            07870012
067900******************************************************************07880012
068000*  THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-  *07890012
068100*  MENTS THAT ARE REQUIRED TO INVOKE THE TRANSACTION PRESENTATION*07900012
068200*  MODULE (DPKUT901) OF THE DB2 CHECKPOINT RESTART SYSTEM.       *07910012
068300******************************************************************07920012
068400     COPY DPPD001.                                                07930012
