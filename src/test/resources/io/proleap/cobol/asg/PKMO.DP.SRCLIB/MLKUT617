000100 IDENTIFICATION DIVISION.                                         00010008
000200 PROGRAM-ID.    MLKUT617.                                         00020008
000300 AUTHOR.        PATRICK BURKE.                                    00030008
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040008
000500 DATE-WRITTEN.  08-09-04.                                         00050008
000600 DATE-COMPILED.                                                   00060008
000700******************************************************************00070008
000800*                                                                 00080008
B28582* MLKUT617 - CREATE THE DATA INTEGRITY EXTRACT FILE               00090008
B28582*            USING  THE MLT00004 RECORD LAYOUT AS INPUT AND THE   00100008
001010*            COPYBOOK MLRD211 AS OUTPUT.                          00101008
001070*                                                                 00101108
001080*CHANGE HISTORY:                                                  00101208
001090* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00101308
001100* ------- ---------- ----------- -------------------------------- 00101408
B28582* B28582  04-03-07-- B GRAHAM    CHANGE TO USE NEW MLRD211  ----- 00101508
B28582*                                ALSO CHANGED TO USE MLT00004     00101608
B28582*                                INSTEAD OF MLT00005              00101708
001300******************************************************************00101808
001400                                                                  00101908
001500 ENVIRONMENT DIVISION.                                            00102008
001600 CONFIGURATION SECTION.                                           00103008
001700 SOURCE-COMPUTER.        IBM-3090.                                00104008
001800 OBJECT-COMPUTER.        IBM-3090.                                00105008
001900 INPUT-OUTPUT SECTION.                                            00106008
002000 FILE-CONTROL.                                                    00107008
002100                                                                  00108008
002200     SELECT DATA-INTEGRITY-CTL-FILE                               00109008
002300         ASSIGN TO INP01.                                         00110008
002400                                                                  00120008
002500     SELECT DATA-INTEGRITY-EXTR-FILE                              00130008
002600         ASSIGN TO OUT01.                                         00140008
002700                                                                  00150008
002800 DATA DIVISION.                                                   00160008
002900 FILE SECTION.                                                    00170008
003000                                                                  00180008
003100 FD  DATA-INTEGRITY-CTL-FILE                                      00190008
003200     LABEL RECORDS ARE STANDARD                                   00200008
003300     RECORDING MODE IS F                                          00210008
003400     BLOCK CONTAINS 0 RECORDS.                                    00220008
003500 01  DATA-INTEGRITY-CTL-REC      PIC X(356).                      00230008
003600                                                                  00240008
003700 FD  DATA-INTEGRITY-EXTR-FILE                                     00250008
003800     RECORDING MODE IS F                                          00260008
003900     LABEL RECORDS ARE STANDARD                                   00270008
004000     BLOCK CONTAINS 0 RECORDS.                                    00280008
004100                                                                  00290008
004200 01  DATA-INTEGRITY-EXTR-REC     PIC X(200).                      00300008
004300                                                                  00310008
004400******************************************************************00320008
004500 WORKING-STORAGE SECTION.                                         00330008
004600******************************************************************00340008
004700                                                                  00350008
004800 01  PS-PROGRAM-SWITCHES.                                         00360008
004810     05  PS-END-OF-INPUT-SW      PIC X       VALUE 'N'.           00370008
004820         88  PS-END-OF-INPUT                 VALUE 'Y'.           00380008
004830         88  PS-END-OF-INPUT-NO              VALUE 'N'.           00390008
004900     05  PS-MLT00004-DONE        PIC X       VALUE 'N'.           00400008
005000         88  PS-MLT00004-IS-DONE             VALUE 'Y'.           00410008
005100         88  PS-MLT00004-IS-NOT-DONE         VALUE 'N'.           00420008
005200                                                                  00430008
005300 01  PV-PROGRAM-VARIABLES.                                        00440008
005400     05  PV-OPN-MONTH-FIRST-WEEK PIC X(10).                       00450008
005500     05  PV-DEPT-NBR             PIC 9(03)  VALUE ZEROS.          00460008
005600     05  PV-MAJ-CL-NBR           PIC 9(02)  VALUE ZEROS.          00470008
005700     05  PV-SUB-CL-NBR           PIC 9(02)  VALUE ZEROS.          00480008
005800     05  PV-LOC-NBR              PIC 9(04)  VALUE ZEROS.          00490008
005900     05  PV-FSCL-DTE             PIC X(10).                       00500008
005910     05  PV-FSCL-MN-END-DTE      PIC X(10).                       00510008
006000     05  PV-FSCL-MN-NBR          PIC X(02).                       00520008
006100     05  PV-PARTN-NBR            PIC S9(4)V COMP.                 00530008
006200                                                                  00540008
006260                                                                  00550008
006300 01  PA-PROGRAM-ACCUMULATORS.                                     00560008
006301     05  PA-INPUT-FILES           PIC S9(13) VALUE ZEROS.         00570008
006310     05  PA-MLT00004-ROWS-FETCHED PIC S9(13) VALUE ZEROS.         00580008
006320     05  PA-TDTATTR-ROWS-SELECTED PIC S9(13) VALUE ZEROS.         00590008
006330     05  PA-OUTPUT-RECS-WRITTEN   PIC S9(13) VALUE ZEROS.         00600008
006340                                                                  00610008
006350 01  PC-PROGRAM-CONSTANTS.                                        00620008
006360     05  PC-MAX-TBL-ROWS         PIC S9(03)  VALUE +120.          00630008
006370                                                                  00631008
006380 01  TABLE-FOR-MONTH-DATA.                                        00632008
006390     05  TABLE-WEEKEND-ENTRIES   OCCURS 450 TIMES                 00633008
006400                                 INDEXED BY MTH-IDX.              00634008
006410         10  TBL-FSCL-DTE        PIC X(10).                       00635008
006420         10  TBL-MONTHEND-DTE    PIC X(10).                       00636008
006430         10  TBL-MONTHEND-NBR    PIC X(02).                       00637008
006440                                                                  00638008
006450 01  CD-COUNTER-DISPLAY.                                          00639008
006460     05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           00640008
006470                                                                  00641008
006480 01 ABEND-AREAS.                                                  00642008
006490     05 ABEND-CODE               PIC S9(04)  VALUE ZEROS          00643008
006500                                             COMP SYNC.           00644008
006600         88  AC-BAD-DATA                     VALUE +4003.         00645008
006700         88  AC-DB2-ERROR                    VALUE +4013.         00646008
006800     05  AA-ABEND-LIT            PIC X(40)   VALUE                00647008
006900             '*****       ABEND'.                                 00648008
007000     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                00649008
007100             '*****   PROGRAM: MLKUT617'.                         00650008
007200     05  AA-PARAGRAPH-LIT.                                        00660008
007300         10  FILLER              PIC X(17)   VALUE                00670008
007400             '***** PARAGRAPH: '.                                 00680008
007500         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        00690008
007600     05  AA-MESSAGE-LINE.                                         00700008
007700         10  FILLER              PIC X(06)   VALUE '*****'.       00710008
007800         10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        00720008
007900     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                00730008
008000             '*****    DB2 ERROR'.                                00740008
008100     05  AA-DB2-OPERATION-LIT.                                    00750008
008200         10  FILLER              PIC X(17)   VALUE                00760008
008300             '***** OPERATION: '.                                 00770008
008400         10  AA-DB2-OPERATION.                                    00780008
008500             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        00790008
008600             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        00800008
008700     05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        00810008
008800     05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        00820008
008900     05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        00830008
009000     05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        00840008
009100                                                                  00850008
009200 EJECT                                                            00860008
009300                                                                  00870008
009400*** DATA INTEGRITY CONTROL CARD                                   00880008
009500     COPY MLRD110.                                                00890008
009600                                                                  00900008
009800*** DATA INTEGRITY MLT_MNLY_SUM EXTRACT FILE                      00910008
009900     COPY MLRD211.                                                00920008
010000                                                                  00930008
010100 EJECT                                                            00940008
010200                                                                  00950008
010300******************************************************************00960008
010400*  DB2 ERROR MESSAGES FORMAT AREA.                                00970008
010500******************************************************************00980008
010600     COPY DPWS004.                                                00990008
010700                                                                  01000008
010800******************************************************************01010008
010900*  DB2 ERRORS                                                     01020008
011000******************************************************************01030008
011100     COPY SQLCA2.                                                 01040008
011200                                                                  01050008
011300******************************************************************01060008
011400*  DB2 COMMUNICATION AREA                                         01070008
011500******************************************************************01080008
011600     EXEC SQL                                                     01090008
011700          INCLUDE SQLCA                                           01100008
011800     END-EXEC.                                                    01110008
011900                                                                  01120008
012000******************************************************************01130008
012100*  M/L DETAIL TABLE - PARTITION BALANCING TABLE                   01140008
012200******************************************************************01150008
012300     EXEC SQL                                                     01160008
012400         INCLUDE MLT00002                                         01170008
012410     END-EXEC.                                                    01180008
012420*                                                                 01190008
012430******************************************************************01200008
012440*  M/L DETAIL TABLE - PARTITION CONTROL TABLE                     01210008
012450******************************************************************01220008
012460     EXEC SQL                                                     01230008
012470         INCLUDE MLT00003                                         01240008
012480     END-EXEC.                                                    01241008
012490*                                                                 01242008
012500******************************************************************01243008
012600*  DB2 MLT_WKLY_SUM TABLE LAYOUT                                  01244008
012700******************************************************************01245008
012800     EXEC SQL                                                     01246008
012900          INCLUDE MLT00004                                        01247008
013000     END-EXEC.                                                    01248008
013100*                                                                 01249008
013200******************************************************************01250008
013210*  DB2 TDTATTR TABLE LAYOUT                                       01260008
013220******************************************************************01270008
013230     EXEC SQL                                                     01280008
013231          INCLUDE TDTATTR                                         01290008
013232     END-EXEC.                                                    01300008
013233                                                                  01310008
015710 EJECT                                                            01320008
015730******************************************************************01321008
015740 PROCEDURE DIVISION.                                              01322008
015750******************************************************************01323008
015760                                                                  01324008
015770******************************************************************01325008
015780 0000-MAINLINE-MLKUT617.                                          01326008
015790******************************************************************01327008
015800*                                                                 01328008
015900     PERFORM 1000-INITIALIZATION.                                 01329008
016000                                                                  01330008
016100     PERFORM 2000-MAIN-PROCESS.                                   01340008
016200                                                                  01350008
016300     PERFORM 8000-EOJ.                                            01360008
016400                                                                  01370008
016500     STOP RUN.                                                    01380008
016600                                                                  01390008
016700 EJECT                                                            01400008
016800                                                                  01410008
016900******************************************************************01420008
017000 1000-INITIALIZATION.                                             01430008
017100******************************************************************01440008
017200*                                                                 01450008
017300     OPEN INPUT  DATA-INTEGRITY-CTL-FILE.                         01460008
017400     OPEN OUTPUT DATA-INTEGRITY-EXTR-FILE.                        01470008
017500                                                                  01480008
017600     PERFORM 4000-READ-INPUT-FILE.                                01490008
017700                                                                  01500008
018200*    MOVE ZEROS TO MLT00004-PARTN-NBR.                            01510008
018300*    MOVE ZEROS TO MLT00004-DEPT-NBR.                             01520008
018400*    MOVE ZEROS TO MLT00004-MAJ-CL-NBR.                           01530008
018500*    MOVE ZEROS TO MLT00004-SUB-CL-NBR.                           01540008
018600*    MOVE ZEROS TO MLT00004-LOC-NBR.                              01550008
018700                                                                  01560008
018800     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          01570008
018900     INITIALIZE PV-PROGRAM-VARIABLES.                             01580008
019000     INITIALIZE TABLE-FOR-MONTH-DATA.                             01590008
019100                                                                  01600008
019210*                                                                 01610008
019220 EJECT                                                            01620008
019230                                                                  01630008
019240******************************************************************01640008
019250 2000-MAIN-PROCESS.                                               01650008
019260******************************************************************01660008
019270*                                                                 01670008
019500     PERFORM                                                      01680008
019600       UNTIL PS-END-OF-INPUT                                      01690008
019700         PERFORM 2100-GET-MONTH-DATA                              01700008
019800         PERFORM 5000-WRITE-EXTRACT                               01710008
019900         PERFORM 4000-READ-INPUT-FILE                             01720008
020000         ADD  1           TO PA-INPUT-FILES                       01730008
020100     END-PERFORM.                                                 01740008
020300                                                                  01750008
020400 EJECT                                                            01760008
020500                                                                  01770008
020600******************************************************************01780008
020700 2100-GET-MONTH-DATA.                                             01790008
020800******************************************************************01800008
020900                                                                  01810008
021000     SET MTH-IDX                 TO 1.                            01820008
021100     SEARCH TABLE-WEEKEND-ENTRIES                                 01830008
021200         AT END                                                   01840008
021210             PERFORM 7400-SELECT-TDTATTR                          01850008
021220             ADD 1               TO PA-TDTATTR-ROWS-SELECTED      01860008
021230             MOVE MLT00004-FSCL-MN-END-DTE                        01870008
021240                                 TO PV-FSCL-DTE                   01880008
021241             MOVE DTATTR-FSCL-MN-END-DTE                          01890008
021242                                 TO PV-FSCL-MN-END-DTE            01900008
021250             MOVE DTATTR-FSCL-MN-NBR                              01910008
021260                                 TO PV-FSCL-MN-NBR                01920008
021270             IF PA-TDTATTR-ROWS-SELECTED > PC-MAX-TBL-ROWS        01930008
021280                 CONTINUE                                         01940008
021290             ELSE                                                 01950008
021300                 SET MTH-IDX     TO PA-TDTATTR-ROWS-SELECTED      01960008
021303                 MOVE MLT00004-FSCL-MN-END-DTE                    01970008
021304                                 TO TBL-FSCL-DTE     (MTH-IDX)    01980008
021305                 MOVE DTATTR-FSCL-MN-END-DTE                      01990008
021306                                 TO TBL-MONTHEND-DTE (MTH-IDX)    02000008
021307                 MOVE DTATTR-FSCL-MN-NBR                          02010008
021308                                 TO TBL-MONTHEND-NBR (MTH-IDX)    02020008
021309             END-IF                                               02030008
021311         WHEN TBL-FSCL-DTE  (MTH-IDX) = MLT00004-FSCL-MN-END-DTE  02040008
021312             MOVE TBL-MONTHEND-DTE (MTH-IDX)                      02050008
021313                                 TO PV-FSCL-MN-END-DTE            02060008
021314             MOVE TBL-MONTHEND-NBR (MTH-IDX)                      02070008
021315                                 TO PV-FSCL-MN-NBR                02080008
021316     END-SEARCH.                                                  02090008
021317                                                                  02100008
021318 EJECT                                                            02110008
021319                                                                  02120008
021320******************************************************************02130008
021321 4000-READ-INPUT-FILE.                                            02131008
021322******************************************************************02131108
021323*                                                                 02131208
021330     READ DATA-INTEGRITY-CTL-FILE                                 02131308
021340       INTO DCLMLT00004                                           02131408
021350         AT END                                                   02131508
021360             SET PS-END-OF-INPUT    TO TRUE.                      02131608
021700                                                                  02131708
021800 EJECT                                                            02131808
021900                                                                  02131908
022000******************************************************************02132008
022100 5000-WRITE-EXTRACT.                                              02133008
022200******************************************************************02134008
022300*                                                                 02135008
B28582     MOVE PV-FSCL-MN-END-DTE       TO ML211-FSCL-MN-END-DTE.      02136008
B28582     MOVE PV-FSCL-MN-NBR           TO ML211-FSCL-MN-NBR.          02137008
022600     MOVE MLT00004-DEPT-NBR        TO PV-DEPT-NBR.                02138008
B28582     MOVE PV-DEPT-NBR              TO ML211-DEPT-NBR.             02139008
022800     MOVE MLT00004-MAJ-CL-NBR      TO PV-MAJ-CL-NBR.              02140008
B28582     MOVE PV-MAJ-CL-NBR            TO ML211-MAJ-CL-NBR.           02150008
023000     MOVE MLT00004-SUB-CL-NBR      TO PV-SUB-CL-NBR.              02160008
B28582     MOVE PV-SUB-CL-NBR            TO ML211-SUB-CL-NBR.           02170008
023200     MOVE MLT00004-LOC-NBR         TO PV-LOC-NBR.                 02180008
B28582     MOVE PV-LOC-NBR               TO ML211-STR-NBR.              02190008
023400                                                                  02200008
B28582     COMPUTE ML211-SLS-RTL-AMT  = MLT00004-SLS-REG-RTL-AMT        02210008
023600                                + MLT00004-SLS-PROMO-RTL-AMT      02220008
023700                                + MLT00004-SLS-PROCLR-RTL-AMT     02230008
023800                                + MLT00004-SLS-CLR-RTL-AMT        02240008
023900                                + MLT00004-SLS-OTH-RTL-AMT.       02250008
B28582     COMPUTE ML211-MKDN-RTL-AMT = MLT00004-MKDN-PLU-RTL-AMT       02260008
024010                                + MLT00004-MKDN-RGST-RTL-AMT      02270008
024020                                + MLT00004-MKDN-UMTCH-RTL-AMT     02280008
024030                                + MLT00004-MKDN-BYR-RTL-AMT       02290008
024040                                + MLT00004-MKDN-STR-RTL-AMT.      02300008
B28582     MOVE MLT00004-MKUP-RTL-AMT     TO ML211-MKUP-RTL-AMT.        02310008
B28582     MOVE MLT00004-XFER-IN-RTL-AMT  TO ML211-XFER-IN-RTL-AMT.     02320008
B28582     MOVE MLT00004-XFER-OUT-RTL-AMT TO ML211-XFER-OUT-RTL-AMT.    02330008
B28582     MOVE MLT00004-RCPT-RTL-AMT     TO ML211-RCPT-RTL-AMT.        02340008
024090     MOVE MLT00004-RCPT-NET-COST-AMT                              02350008
B28582                                    TO ML211-RCPT-NET-COST-AMT.   02360008
B28582     MOVE MLT00004-PADJ-RTL-AMT     TO ML211-PADJ-RTL-AMT.        02370008
024300     MOVE MLT00004-PADJ-NET-COST-AMT                              02380008
B28582                                    TO ML211-PADJ-NET-COST-AMT.   02390008
B28582     MOVE MLT00004-INV-ADJ-RTL-AMT  TO ML211-INV-ADJ-RTL-AMT.     02400008
B28582     MOVE MLT00004-SHNK-RTL-AMT     TO ML211-SHNK-RTL-AMT.        02410008
B28582     MOVE MLT00004-END-INV-RTL-AMT  TO ML211-END-INV-RTL-AMT.     02420008
024701                                                                  02430008
B28582     MOVE MLT00004-ML-LO-MDSE-LVL-ID TO ML211-DKEY-NBR.           02440008
024800                                                                  02450008
B28582     MOVE MLT00004-END-INV-COST1-AMT TO ML211-END-INV-COST1-AMT.  02460008
B28582     MOVE MLT00004-END-INV-COST2-AMT TO ML211-END-INV-COST2-AMT.  02470008
B28582     MOVE MLT00004-ADJ-GRO-MRGN-AMT  TO ML211-ADJ-GRO-MRGN-AMT.   02471008
B28582                                                                  02472008
024900     WRITE DATA-INTEGRITY-EXTR-REC                                02473008
B28582         FROM ML211-DATA-INTEGRITY-EXTR-REC.                      02474008
025100     ADD 1                         TO PA-OUTPUT-RECS-WRITTEN.     02475008
025200                                                                  02476008
025300 EJECT                                                            02477008
025400                                                                  02478008
031200******************************************************************02479008
031300 7400-SELECT-TDTATTR.                                             02480008
031400******************************************************************02490008
031500*                                                                 02500008
031610     MOVE MLT00004-FSCL-MN-END-DTE TO PV-FSCL-DTE.                02510008
031700                                                                  02520008
031800     EXEC SQL                                                     02530008
031900         SELECT DISTINCT                                          02540008
031910                FSCL_MN_NBR                                       02550008
032000               ,FSCL_MN_END_DTE                                   02560008
032100               ,FSCL_WK_NBR                                       02570008
032200               ,FSCL_WK_END_DTE                                   02580008
032300         INTO  :DTATTR-FSCL-MN-NBR                                02590008
032400              ,:DTATTR-FSCL-MN-END-DTE                            02600008
032410              ,:DTATTR-FSCL-WK-NBR                                02610008
032420              ,:DTATTR-FSCL-WK-END-DTE                            02620008
032430         FROM  MLT_PARTN_CNTL A                                   02630008
032440               ,TDTATTR B                                         02640008
032450         WHERE A.FSCL_DTE = :PV-FSCL-DTE                          02650008
032451           AND A.FSCL_DTE = B.KY_DTE                              02660008
032470           AND A.TBL_TM_LVL_CDE = 'M'                             02670008
032500         WITH UR                                                  02680008
032501     END-EXEC.                                                    02690008
032502                                                                  02700008
032503     EVALUATE TRUE                                                02710008
032504         WHEN SQLCODE = 0                                         02720008
032505             CONTINUE                                             02730008
032506         WHEN OTHER                                               02740008
032507             MOVE '7400-SELECT-TDTATTR'                           02750008
032508                                 TO AA-PARAGRAPH-NAME             02760008
032509             MOVE 'TDTATTR ROW NOT FOUND'                         02770008
032510                                 TO AA-MESSAGE                    02780008
032511             MOVE 'SELECT'       TO AA-DB2-OPERATION              02790008
032512             PERFORM Z998-SQL-ERROR                               02800008
032513     END-EVALUATE.                                                02810008
032514                                                                  02820008
032515 EJECT                                                            02830008
032516                                                                  02840008
032517******************************************************************02850008
032518 8000-EOJ.                                                        02860008
032519******************************************************************02870008
032520*                                                                 02880008
032530     DISPLAY ' '.                                                 02890008
032540     DISPLAY '  PROGRAM MLKUT617 PROCESSING SUMMARY'.             02900008
032550     DISPLAY '  -----------------------------------'.             02910008
032560     DISPLAY ' '.                                                 02920008
032570*                                                                 02930008
032700     MOVE PA-OUTPUT-RECS-WRITTEN TO CD-COUNT-HOLD1.               02940008
032800     DISPLAY 'EXTRACT RECORDS WRITTEN =   ' CD-COUNT-HOLD1.       02950008
032900*                                                                 02960008
033000     DISPLAY ' '.                                                 02970008
033100                                                                  02980008
033200     CLOSE DATA-INTEGRITY-CTL-FILE.                               02990008
033300     CLOSE DATA-INTEGRITY-EXTR-FILE.                              03000008
033400                                                                  03010008
033500 EJECT                                                            03020008
033600                                                                  03030008
033700******************************************************************03040008
033800 Z990-COMMON-ABEND-ROUTINE.                                       03050008
033900******************************************************************03060008
034000*                                                                 03070008
034100     DISPLAY AA-ABEND-LIT.                                        03080008
034200     DISPLAY AA-PROGRAM-LIT.                                      03090008
034300     DISPLAY AA-PARAGRAPH-LIT.                                    03100008
034400     DISPLAY AA-MESSAGE-LINE.                                     03110008
034500     DISPLAY ABEND-CODE.                                          03120008
034600                                                                  03130008
034700     CALL 'ILBOABN0' USING ABEND-CODE.                            03140008
034800                                                                  03150008
034900 EJECT                                                            03160008
035000                                                                  03170008
035100******************************************************************03180008
035200 Z998-SQL-ERROR.                                                  03190008
035300******************************************************************03200008
035400*                                                                 03210008
035500     CLOSE DATA-INTEGRITY-CTL-FILE                                03220008
035600           DATA-INTEGRITY-EXTR-FILE.                              03230008
035700                                                                  03240008
035800     DISPLAY AA-ABEND-LIT.                                        03250008
035900     DISPLAY AA-DB2-ERROR-LIT.                                    03260008
036000     DISPLAY AA-PROGRAM-LIT.                                      03270008
036100     DISPLAY AA-PARAGRAPH-LIT.                                    03280008
036200     DISPLAY AA-MESSAGE-LINE.                                     03290008
036300     DISPLAY AA-DB2-OPERATION-LIT.                                03300008
036400     SET AC-DB2-ERROR TO TRUE.                                    03310008
036500     MOVE +4013                  TO ABEND-CODE.                   03320008
036600                                                                  03330008
036700     COPY DPPD004.                                                03340008
036800     CALL 'ILBOABN0' USING ABEND-CODE.                            03350008
036900                                                                  03360008
