000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000400 PROGRAM-ID.             SUKRP042.                                00030001
000500 AUTHOR.                 DEANNA BRANTNER.                         00040001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000700 DATE-WRITTEN.           JULY, 2005.                              00060001
000800 DATE-COMPILED.                                                   00070000
000900***************************************************************** 00080000
001000*                                                               * 00090000
001100********  MANIFESTED CARTONS NOT LOADED SUMMARY REPORT *********  00100001
001200*                                                               * 00110000
001300*  DISPLAYS BY DC THE UNITS, NUMBER OF CARTONS, AND RETAIL OF   * 00120001
001300*  CARTONS MANIFESTED BY NEVER LOADED ONTO A TRAILER.           * 00130001
001400*                                                               * 00140000
001500*  THE INPUT FILE IS FROM JOB SUK029, STEP S010 AND JOBS SUK065,* 00150001
001600*  SUK066, AND SUK067, STEP S070.                               * 00160001
001700*                                                               * 00170000
001900***************************************************************** 00180000
002200 ENVIRONMENT DIVISION.                                            00190000
002400 CONFIGURATION SECTION.                                           00200000
002500                                                                  00210000
002600 SOURCE-COMPUTER.        IBM-3090.                                00220000
002700 OBJECT-COMPUTER.        IBM-3090.                                00230000
002800                                                                  00240000
002900***************************************************************** 00250000
003000 INPUT-OUTPUT SECTION.                                            00260000
003100                                                                  00270000
003200 FILE-CONTROL.                                                    00280000
003300                                                                  00290000
003400     SELECT INPUT-FILE1                                           00300001
003500         ASSIGN TO INP01.                                         00310000
003600                                                                  00320000
003400     SELECT INPUT-FILE2                                           00330001
003500         ASSIGN TO INP02.                                         00340001
003600                                                                  00350001
003700     SELECT REPORT-FILE                                           00360000
003800         ASSIGN TO RPT01.                                         00370000
003900                                                                  00380000
004000***************************************************************** 00390000
004100 DATA DIVISION.                                                   00400000
004200***************************************************************** 00410000
004300 FILE SECTION.                                                    00420000
004400                                                                  00430000
004500 FD  INPUT-FILE1                                                  00440001
004600     RECORDING MODE IS F                                          00450000
004700     LABEL RECORDS ARE STANDARD                                   00460000
004800     BLOCK CONTAINS 0 RECORDS.                                    00470000
004900 01  INPUT-RECORD1                   PIC  X(200).                 00480001
005000                                                                  00490000
004500 FD  INPUT-FILE2                                                  00500001
004600     RECORDING MODE IS F                                          00510001
004700     LABEL RECORDS ARE STANDARD                                   00520001
004800     BLOCK CONTAINS 0 RECORDS.                                    00530001
004900 01  INPUT-RECORD2                   PIC  X(016).                 00540009
005000                                                                  00550001
005100 FD  REPORT-FILE                                                  00560000
005200     RECORDING MODE IS F                                          00570000
005300     BLOCK CONTAINS 0  RECORDS.                                   00580000
005400 01  REPORT-RECORD                   PIC X(132).                  00590000
005500                                                                  00600000
005600***************************************************************** 00610000
005700 WORKING-STORAGE SECTION.                                         00620000
005800                                                                  00630000
005900 01  PROGRAM-SWITCHES.                                            00640000
006000     05  PS-END-OF-INPUT-FILE1-SW     PIC X(01) VALUE 'N'.        00650001
006100         88  PS-END-OF-INPUT1                   VALUE 'Y'.        00660001
006200         88  PS-NOT-END-OF-INPUT1               VALUE 'N'.        00670001
006000     05  PS-END-OF-INPUT-FILE2-SW     PIC X(01) VALUE 'N'.        00680001
006100         88  PS-END-OF-INPUT2                   VALUE 'Y'.        00690001
006200         88  PS-NOT-END-OF-INPUT2               VALUE 'N'.        00700001
006000     05  PS-MATCH-FOUND-SW            PIC X(01) VALUE 'N'.        00710046
006100         88  PS-MATCH-FOUND                     VALUE 'Y'.        00720046
006200         88  PS-MATCH-NOT-FOUND                 VALUE 'N'.        00730046
006300                                                                  00740000
006400 01  PC-PROGRAM-CONSTANTS.                                        00750000
006500     05  PC-SUKRP042                 PIC X(08) VALUE              00760001
006600                                               'SUKRP042'.        00770001
006700     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00780000
006800     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00790000
006900                                               COMP-3.            00800000
007000     05  PC-DEFAULT-TMST             PIC X(26)  VALUE             00810000
007100                                    '9999-09-09-09.09.09.999999'. 00820000
007200     05  PC-SLASH                    PIC X(01) VALUE '/'.         00830000
007300     05  PC-DASH                     PIC X(01) VALUE '-'.         00840000
007800                                                                  00850000
007900 01  SD-DATE-TIME.                                                00860000
008000     05  SD-SYSTEM-DATE.                                          00870000
008100         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        00880000
008200         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        00890000
008300         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        00900000
008400     05  SD-SYSTEM-TIME.                                          00910000
008500         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        00920000
008600         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        00930000
008700         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        00940000
008800         10  FILLER                  PIC 9(02) VALUE ZERO.        00950000
008900                                                                  00960000
009000 01  PV-PROGRAM-VARIABLES.                                        00970000
009100     05  PV-READ-COUNT1               PIC S9(7) COMP-3            00980001
009200                                                VALUE ZERO.       00990000
009100     05  PV-READ-COUNT2               PIC S9(7) COMP-3            01000001
009200                                                VALUE ZERO.       01010001
009300     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01020000
009400                                                VALUE ZERO.       01030000
009700     05  PV-NULL-IND                 PIC S9(04) VALUE +0          01040000
009800                                               COMP SYNC.         01050000
011200     05  PV-FORMAT-DATE.                                          01060000
011300         10 PV-FORMAT-DATE-MM         PIC  9(02).                 01070000
011400         10 FILLER                    PIC  X(01) VALUE '/'.       01080000
011500         10 PV-FORMAT-DATE-DD         PIC  9(02).                 01090000
011600         10 FILLER                    PIC  X(01) VALUE '/'.       01100000
011700         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 01110000
011800                                                                  01120000
011900     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        01130000
012000     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01140000
012100                                               COMP-3.            01150000
012200     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01160000
012300                                               COMP-3.            01170000
013000     05  PV-TODAYS-DATE.                                          01180000
013100         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01190000
013200         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01200000
013300         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01210000
013400     05  PV-TODAYS-DATE-YYYY.                                     01220000
013500         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          01230000
013600         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        01240000
013700                                                                  01250000
013800     05  PV-TODAYS-TIME.                                          01260000
013900         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01270000
014000         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01280000
014100         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01290000
014200         10  FILLER                  PIC 9(02) VALUE ZERO.        01300000
014300                                                                  01310000
014400 01  PV-ABEND-FIELDS.                                             01320000
014500     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           01330000
014600                                               COMP SYNC.         01340000
014700     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SUKRP042'.  01350001
014800     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01360000
014900     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01370000
015000     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01380000
015100     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      01390000
015200     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      01400000
015300     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      01410000
015400     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      01420000
015500     05  PV-DB2-TABLE-NAME-1         PIC X(08) VALUE SPACES.      01430000
015600     05  PV-DB2-TABLE-NAME-2         PIC X(08) VALUE SPACES.      01440000
015700                                                                  01450000
016000     05  PV-DISPLAY-OPER             PIC  9(04) VALUE ZEROES.     01460001
016010     05  PV-DISPLAY-SQLCODE          PIC  9(03)- VALUE ZEROES.    01470001
016020     05  PV-DB2-TABLE-NAME1          PIC  X(15) VALUE SPACES.     01480001
016100                                                                  01490000
016200     05  PV-DISPLAY-READ-COUNT1      PIC ZZZ,ZZZ,ZZ9.             01500001
016200     05  PV-DISPLAY-READ-COUNT2      PIC ZZZ,ZZZ,ZZ9.             01510001
016300     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             01520000
016300     05  PV-DISPLAY-PERCENT1         PIC ZZZ.99.                  01530086
016300     05  PV-DISPLAY-PERCENT2         PIC ZZZ.                     01531099
016400                                                                  01540000
016400*** THESE FIELDS ARE FOR THE DETAIL LINE PER DC **                01550057
017210     05  PV-UNIT-COUNT               PIC S9(09) VALUE ZEROES.     01560005
017210     05  PV-CARTON-COUNT             PIC S9(09) VALUE ZEROES.     01570057
017210     05  PV-CRSDCK                   PIC S9(09) VALUE ZEROES.     01580005
017210     05  PV-FLAT                     PIC S9(09) VALUE ZEROES.     01590005
017210     05  PV-P2L                      PIC S9(09) VALUE ZEROES.     01600005
017210     05  PV-JWL                      PIC S9(09) VALUE ZEROES.     01610005
017210     05  PV-RETAIL-AMT               PIC S9(09)V99 VALUE ZEROES.  01620096
017210     05  PV-PERCENT-CRSDCK           PIC S9(03)    VALUE ZEROES.  01630085
017210     05  PV-PERCENT-FLAT             PIC S9(03)V99 VALUE ZEROES.  01640099
017210     05  PV-PERCENT-P2L              PIC S9(03)V99 VALUE ZEROES.  01650099
017210     05  PV-PERCENT-JWL              PIC S9(03)V99 VALUE ZEROES.  01660099
017210     05  PV-PERCENT-FPJ              PIC S9(03)    VALUE ZEROES.  01661098
017210     05  PV-PERCENT-MFSTD            PIC S9(03)V99 VALUE ZEROES.  01670064
017210     05  PV-PERCENT-RETAIL           PIC S9(03)V99 VALUE ZEROES.  01680064
                                                                        01690064
016400*** THESE FIELDS ARE FOR THE TOTAL LINE FOR THE REPORT ***        01700064
017210     05  PV-GRND-TTL-UNIT-CNT        PIC S9(11) VALUE ZEROES.     01710064
017210     05  PV-GRND-TTL-CARTON-CNT      PIC S9(11) VALUE ZEROES.     01720064
017210     05  PV-GRND-TTL-CRDK-CNT        PIC S9(09) VALUE ZEROES.     01730064
017210     05  PV-GRND-TTL-FLAT-CNT        PIC S9(09) VALUE ZEROES.     01740064
017210     05  PV-GRND-TTL-P2L-CNT         PIC S9(09) VALUE ZEROES.     01750064
017210     05  PV-GRND-TTL-JWL-CNT         PIC S9(09) VALUE ZEROES.     01760064
017210     05  PV-GRND-TTL-CRDK-PRC        PIC S9(03) VALUE ZEROES.     01770099
017210     05  PV-GRND-TTL-FLAT-PRC        PIC S9(03) VALUE ZEROES.     01780099
017210     05  PV-GRND-TTL-P2L-PRC         PIC S9(03) VALUE ZEROES.     01790099
017210     05  PV-GRND-TTL-JWL-PRC         PIC S9(03)V99 VALUE ZEROES.  01800099
017210     05  PV-GRND-TTL-RETAIL-AMT      PIC S9(11)V99 VALUE ZEROES.  01810079
017210     05  PV-GRND-TTL-PRC-MNFD        PIC S9(03)V99 VALUE ZEROES.  01820079
017210     05  PV-GRND-TTL-PRC-RTL         PIC S9(03)V99 VALUE ZEROES.  01830079
                                                                        01840079
016400*** THESE FIELDS ARE THE DC TOTALS FROM BOTH INPUT FILES ***      01850079
017210     05  PV-DC-TTL-CARTON-CNT        PIC S9(09) VALUE ZEROES.     01860079
017210     05  PV-DC-TTL-RETAIL-AMT        PIC S9(09)V99 VALUE ZEROES.  01870079
                                                                        01880079
016400*** THESE FIELDS ARE THE TOTALS FROM BOTH INPUT FILES ***         01890079
017210     05  PV-ALL-CARTON-CNT           PIC S9(15) VALUE ZEROES.     01900079
017210     05  PV-ALL-RETAIL-AMT           PIC S9(15)V99 VALUE ZEROES.  01910079
317300                                                                  01920079
017400     05  PV-DIVIDEND                 PIC  9(03)V9999 VALUE 0.     01930046
017400     05  PV-DIVIDEND1                PIC  9(03)V9999 VALUE 0.     01931091
017400     05  PV-DIVIDEND2                PIC  9(03)V9999 VALUE 0.     01940046
017500                                                                  01950000
018100 01  PV-SAVE-FIELDS.                                              01960000
018200     05  PV-SAVE-OPER-UNT-ID          PIC S9(04) COMP             01970000
018300                                                 VALUE +0.        01980000
018400 01  DK-DB-KEYS.                                                  01990000
018500     05  DK-OPER-UNT-ID              PIC S9(4) COMP.              02000000
018800                                                                  02010000
012700 01  PT-DC-TABLE.                                                 02020045
012800     05  PT-DC-ELEMENT OCCURS 50 TIMES                            02030099
034300                        INDEXED BY PT-IDX.                        02040046
012900         10  PT-ORGN-LOC-NBR         PIC  9(04) VALUE ZEROES.     02050046
012900         10  PT-RETAIL-AMT           PIC S9(13)V99 COMP VALUE 0.  02060046
012900         10  PT-CARTON-CNT           PIC  9(09) VALUE ZEROES.     02070046
019300                                                                  02080045
018900******************************************************************02090000
019000* RECORD LAYOUT FOR THE FIRST INPUT FILE.                         02100001
019100******************************************************************02110000
019200     COPY SURD045.                                                02120002
019300                                                                  02130000
018900******************************************************************02140001
019000* RECORD LAYOUT FOR THE SECOND INPUT FILE.                        02150001
019100******************************************************************02160001
019200     COPY SURD063.                                                02170001
019300                                                                  02180001
019400******************************************************************02190000
019500*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02200000
019600******************************************************************02210000
019700     COPY DPWS132O.                                               02220000
019800                                                                  02230000
019900 01  WS-BATCH-PROC-DATE.                                          02240000
020000     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      02250000
020100     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      02260000
020200     05  FILLER                      PIC X(01) VALUE SPACES.      02270000
020300     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      02280000
020400     05  FILLER                      PIC X(01) VALUE SPACES.      02290000
020500     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      02300000
020600*                                                                 02310000
020700 01  HEADING-LINES.                                               02320000
020800     05  HEADING-LINE1.                                           02330000
020900         10  FILLER                  PIC X(49) VALUE SPACES.      02340035
021000         10  FILLER                  PIC X(34) VALUE              02350034
021100         'MANIFESTED CARTON EXCEPTION REPORT'.                    02360034
021200         10  FILLER                  PIC X(38) VALUE SPACES.      02370001
021300                                                                  02380000
020800     05  HEADING-LINE2.                                           02390034
020900         10  FILLER                  PIC X(40) VALUE SPACES.      02400035
021000         10  FILLER                  PIC X(55) VALUE              02410034
021100         'SUMMARY OF CARTONS BUILT BUT NEVER LOADED TO A TRAILER'.02420034
021200         10  FILLER                  PIC X(38) VALUE SPACES.      02430034
021300                                                                  02440034
021400     05  HEADING-LINE3.                                           02450034
024900         10  FILLER            PIC X(19) VALUE SPACES.            02460076
025000         10  FILLER            PIC X(090) VALUE                   02470077
025000     '|- - - - - - - - - - - - - - - - - - - NOT LOADED - - - - - 02480077
025000-    '- - - - - - - - - - - - - - -|'.                            02490078
024900         10  FILLER            PIC X(03) VALUE SPACES.            02500061
025000         10  FILLER            PIC X(08) VALUE '% MNFSTD'.        02510042
025200         10  FILLER            PIC X(03) VALUE SPACES.            02520079
025000         10  FILLER            PIC X(08) VALUE '% RETAIL'.        02530039
025200         10  FILLER            PIC X(02) VALUE SPACES.            02540039
021300                                                                  02550001
021400     05  HEADING-LINE4.                                           02560034
024900         10  FILLER            PIC X(39) VALUE SPACES.            02570076
025000         10  FILLER            PIC X(56) VALUE                    02580077
025000         '|--------------------PROCESS AREA--------------------|'.02590077
025200         10  FILLER            PIC X(17) VALUE SPACES.            02600077
025000         10  FILLER            PIC X(09) VALUE 'LOADED TO'.       02610015
025200         10  FILLER            PIC X(02) VALUE SPACES.            02620079
025300         10  FILLER            PIC X(09) VALUE 'LOADED TO'.       02630039
025500         10  FILLER            PIC X(01) VALUE SPACES.            02640021
021300                                                                  02650001
021400     05  HEADING-LINE5.                                           02660034
024900         10  FILLER            PIC X(01) VALUE SPACES.            02670001
025000         10  FILLER            PIC X(12) VALUE                    02680067
                     'DSTRBTN CNTR'.                                    02690067
025200         10  FILLER            PIC X(07) VALUE SPACES.            02700072
025300         10  FILLER            PIC X(05) VALUE 'UNITS'.           02710001
025500         10  FILLER            PIC X(03) VALUE SPACES.            02720070
025600         10  FILLER            PIC X(07) VALUE 'CARTONS'.         02730001
025800         10  FILLER            PIC X(06) VALUE SPACES.            02740084
025810         10  FILLER            PIC X(06) VALUE 'CRSDCK'.          02750001
025800         10  FILLER            PIC X(02) VALUE SPACES.            02751084
025810         10  FILLER            PIC X(01) VALUE '%'.               02752083
025820         10  FILLER            PIC X(06) VALUE SPACES.            02760084
025900         10  FILLER            PIC X(06) VALUE ' FLAT '.          02770001
025800         10  FILLER            PIC X(01) VALUE SPACES.            02771083
025810         10  FILLER            PIC X(01) VALUE '%'.               02772083
026100         10  FILLER            PIC X(06) VALUE SPACES.            02780084
026200         10  FILLER            PIC X(06) VALUE ' P2L  '.          02790001
025800         10  FILLER            PIC X(01) VALUE SPACES.            02791084
025810         10  FILLER            PIC X(01) VALUE '%'.               02792083
026400         10  FILLER            PIC X(06) VALUE SPACES.            02800085
026800         10  FILLER            PIC X(06) VALUE 'JEWLRY'.          02810001
025800         10  FILLER            PIC X(01) VALUE SPACES.            02811083
025810         10  FILLER            PIC X(01) VALUE '%'.               02812083
027000         10  FILLER            PIC X(04) VALUE SPACES.            02820084
027310         10  FILLER            PIC X(12) VALUE 'RETAIL VALUE'.    02830001
027000         10  FILLER            PIC X(04) VALUE SPACES.            02840074
027310         10  FILLER            PIC X(08) VALUE 'TRAILERS'.        02850001
027000         10  FILLER            PIC X(03) VALUE SPACES.            02860074
027310         10  FILLER            PIC X(08) VALUE 'TRAILERS'.        02870039
027400                                                                  02880000
031400 01  DETAIL-LINES.                                                02890000
031500     05  DETAIL-LINE1.                                            02900000
031600         10  FILLER                  PIC X(01) VALUE SPACES.      02910000
031720         10  DL1-DC-NAME             PIC X(15) VALUE SPACES.      02920064
033000         10  FILLER                  PIC X(02) VALUE SPACES.      02930064
031700         10  DL1-UNITS               PIC ZZZ,ZZZ VALUE ZEROES.    02940072
031710         10  FILLER                  PIC X(01) VALUE SPACES.      02950070
031900         10  DL1-CARTONS             PIC Z,ZZZ,ZZZ VALUE ZEROES.  02960016
032000         10  FILLER                  PIC X(03) VALUE SPACES.      02970071
032100         10  DL1-CRSDCK              PIC ZZZ,ZZZ VALUE ZEROES.    02980001
031800         10  FILLER                  PIC X(02) VALUE SPACES.      02990093
032900         10  DL1-PERCENT-CRSDCK      PIC X(03) VALUE SPACES.      03000085
032000         10  FILLER                  PIC X(04) VALUE SPACES.      03010085
032100         10  DL1-FLAT                PIC ZZ,ZZZ VALUE ZEROES.     03020016
031800         10  FILLER                  PIC X(01) VALUE SPACES.      03030064
032900         10  DL1-PERCENT-FLAT        PIC X(03) VALUE SPACES.      03040085
032200         10  FILLER                  PIC X(04) VALUE SPACES.      03050085
032300         10  DL1-P2L                 PIC ZZ,ZZZ VALUE ZEROES.     03060016
031800         10  FILLER                  PIC X(01) VALUE SPACES.      03070064
032900         10  DL1-PERCENT-P2L         PIC X(03) VALUE SPACES.      03080085
032400         10  FILLER                  PIC X(04) VALUE SPACES.      03090085
032500         10  DL1-JEWLRY              PIC ZZ,ZZZ VALUE ZEROES.     03100016
031800         10  FILLER                  PIC X(01) VALUE SPACES.      03110064
032900         10  DL1-PERCENT-JWL         PIC X(03) VALUE SPACES.      03120085
032600         10  FILLER                  PIC X(04) VALUE SPACES.      03130093
032700         10  DL1-RETAIL            PIC $$,$$$,$$$.99 VALUE ZEROES.03140036
032800         10  FILLER                  PIC X(04) VALUE SPACES.      03150074
032900         10  DL1-PERCENT-MFSTD       PIC X(06) VALUE SPACES.      03160001
033000         10  FILLER                  PIC X(05) VALUE SPACES.      03170074
033100         10  DL1-PERCENT-RETAIL      PIC X(06) VALUE SPACES.      03180001
033200         10  FILLER                  PIC X(02) VALUE SPACES.      03190000
                                                                        03200001
031400 01  TOTAL-LINE.                                                  03210030
031500     05  TOTAL-LINE1.                                             03220030
031600         10  FILLER                  PIC X(10) VALUE SPACES.      03230068
031720         10  FILLER                  PIC X(06) VALUE 'TOTALS'.    03240030
031800         10  FILLER                  PIC X(02) VALUE SPACES.      03250068
031700         10  GL1-UNITS               PIC ZZZ,ZZZ VALUE ZEROES.    03260072
031710         10  FILLER                  PIC X(01) VALUE SPACES.      03270071
031900         10  GL1-CARTONS             PIC Z,ZZZ,ZZZ VALUE ZEROES.  03280030
032000         10  FILLER                  PIC X(03) VALUE SPACES.      03290071
032100         10  GL1-CRSDCK              PIC ZZZ,ZZZ VALUE ZEROES.    03300030
032800         10  FILLER                  PIC X(02) VALUE SPACES.      03310093
032900         10  GL1-PERCENT-CRSDCK      PIC X(03) VALUE SPACES.      03320093
032000         10  FILLER                  PIC X(04) VALUE SPACES.      03330093
032100         10  GL1-FLAT                PIC ZZ,ZZZ VALUE ZEROES.     03340030
032800         10  FILLER                  PIC X(01) VALUE SPACES.      03350079
032900         10  GL1-PERCENT-FLAT        PIC X(03) VALUE SPACES.      03360093
032200         10  FILLER                  PIC X(04) VALUE SPACES.      03370093
032300         10  GL1-P2L                 PIC ZZ,ZZZ VALUE ZEROES.     03380030
032800         10  FILLER                  PIC X(01) VALUE SPACES.      03390079
032900         10  GL1-PERCENT-P2L         PIC X(03) VALUE SPACES.      03400093
032400         10  FILLER                  PIC X(04) VALUE SPACES.      03410093
032500         10  GL1-JEWLRY              PIC ZZ,ZZZ VALUE ZEROES.     03420030
032800         10  FILLER                  PIC X(01) VALUE SPACES.      03430079
032900         10  GL1-PERCENT-JWL         PIC X(03) VALUE SPACES.      03440093
032600         10  FILLER                  PIC X(03) VALUE SPACES.      03450093
032700         10  GL1-RETAIL           PIC $$$,$$$,$$$.99 VALUE ZEROES.03460036
032800         10  FILLER                  PIC X(04) VALUE SPACES.      03470082
032900         10  GL1-PERCENT-MFSTD       PIC X(06) VALUE SPACES.      03480030
033000         10  FILLER                  PIC X(05) VALUE SPACES.      03490082
033100         10  GL1-PERCENT-RETAIL      PIC X(06) VALUE SPACES.      03500030
033200         10  FILLER                  PIC X(02) VALUE SPACES.      03510030
                                                                        03520030
034500 01  MISCELLANEOUS-LINES.                                         03530030
034600     05  BLANK-LINE.                                              03540000
034700         10  FILLER                  PIC X(132) VALUE SPACES.     03550000
034800                                                                  03560000
034900     05  END-OF-REPORT-LINE.                                      03570000
035000         10  FILLER                  PIC X(44) VALUE SPACES.      03580000
035100         10  FILLER                  PIC X(45) VALUE              03590000
035200             '*******   E N D   O F   R E P O R T   *******'.     03600000
035300         10  FILLER                  PIC X(43) VALUE SPACES.      03610000
035400                                                                  03620000
035500     05  NO-DATA-TO-REPORT-LINE.                                  03630000
035600         10  FILLER                  PIC X(40) VALUE SPACES.      03640000
035700         10  FILLER                  PIC  X(52)    VALUE          03650000
035800         '*******  N O   D A T A   T O   R E P O R T   *******'.  03660000
035900         10  FILLER                  PIC  X(40)    VALUE SPACES.  03670000
036000                                                                  03680000
036100                                                                  03690000
036700******************************************************************03700000
036800*  USED FOR DB2 ERROR MESSAGE BUILDING                            03710000
036900******************************************************************03720000
037000     COPY DPWS004.                                                03730000
037100                                                                  03740000
037200******************************************************************03750000
037300*   DB2 SQL COMMUNICATION AREA                                    03760000
037400******************************************************************03770000
037500     EXEC SQL                                                     03780000
037600          INCLUDE SQLCA                                           03790000
037700     END-EXEC.                                                    03800000
037800                                                                  03810000
037900*---------------------------------------------------------------* 03820000
038000*  DCLGEN FOR THE LOGISTICS LOCATION TABLE                        03830000
038100*  XLT_LOC                                                        03840000
038200*---------------------------------------------------------------* 03850000
038300     EXEC SQL                                                     03860000
038400          INCLUDE XLT00010                                        03870000
038500     END-EXEC.                                                    03880000
038600                                                                  03890000
038800******************************************************************03900000
038900 PROCEDURE DIVISION.                                              03910000
039000     DISPLAY '**** START OF SUKRP042 ****'.                       03920001
039100                                                                  03930000
039200*OPEN FILES.                                                      03940000
039300     OPEN INPUT  INPUT-FILE1                                      03950001
039300          INPUT  INPUT-FILE2                                      03960001
039400          OUTPUT REPORT-FILE.                                     03970000
039500                                                                  03980000
039600     PERFORM 1000-INITIALIZATION.                                 03990000
039700                                                                  04000000
039800*BUILD INTERNAL TABLE                                             04010045
039900     INITIALIZE PT-DC-TABLE.                                      04020046
039900     PERFORM 7100-READ-EXTRACT-FILE                               04030046
062100         UNTIL PS-END-OF-INPUT2                                   04040046
040100                                                                  04050000
039800*READ FIRST RECORD.                                               04060045
039900     PERFORM 7000-READ-EXTRACT-FILE                               04070045
040000         MOVE SU045-ORGN-LOC-NBR        TO PV-SAVE-OPER-UNT-ID    04080045
040100                                                                  04090045
040200*PROCESS INPUT FILE.                                              04100000
040300     IF PS-END-OF-INPUT1                                          04110002
040400        ADD +1                  TO PV-PAGE-COUNT                  04120000
040500        MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER             04130000
040600        WRITE REPORT-RECORD                                       04140000
040700          FROM DP132O-STANDRD-HEADER-132-COLS                     04150000
040800            AFTER ADVANCING PAGE                                  04160000
040900        WRITE REPORT-RECORD                                       04170000
041000          FROM HEADING-LINE1                                      04180000
041100            AFTER ADVANCING 1 LINES                               04190000
041200        WRITE REPORT-RECORD                                       04200000
041300          FROM HEADING-LINE2                                      04210000
041400            AFTER ADVANCING 1 LINE                                04220000
041800        WRITE REPORT-RECORD                                       04230000
041900          FROM NO-DATA-TO-REPORT-LINE                             04240000
042000            AFTER ADVANCING 2 LINES                               04250000
042100     ELSE                                                         04260000
042200        MOVE SU045-ORGN-LOC-NBR TO PV-SAVE-OPER-UNT-ID            04270001
042300        PERFORM 8500-GET-LOCATION-NAME                            04280000
042400        PERFORM 1500-PRINT-HEADINGS                               04290000
042500        PERFORM 2000-PROCESS-INPUT UNTIL PS-END-OF-INPUT1         04300002
043100     END-IF.                                                      04310000
043200                                                                  04320000
043300*FINISH REPORT.                                                   04330000
054100     PERFORM 4000-CALC-PERCENTS.                                  04340037
054100     PERFORM 5000-MOVE-TO-DETAIL-LINE.                            04350037
059900     WRITE REPORT-RECORD FROM DETAIL-LINE1                        04360037
060100          AFTER ADVANCING 2 LINES                                 04370037
060200     ADD +1 TO PV-WRITE-COUNT.                                    04380037
060300                                                                  04390037
054100     PERFORM 5500-MOVE-TO-TOTAL-LINE.                             04400035
043200                                                                  04410035
043400     WRITE REPORT-RECORD                                          04420035
043500       FROM END-OF-REPORT-LINE                                    04430030
043600         AFTER ADVANCING 3 LINES.                                 04440051
043700                                                                  04450030
043800*CLOSE FILES.                                                     04460000
043900     CLOSE INPUT-FILE1                                            04470001
043900           INPUT-FILE2                                            04480001
044000           REPORT-FILE.                                           04490000
044100                                                                  04500000
044200     MOVE PV-READ-COUNT1 TO PV-DISPLAY-READ-COUNT1.               04510001
044300     DISPLAY 'TOTAL MNFSTD RECS READ ' PV-DISPLAY-READ-COUNT1.    04520001
044400                                                                  04530000
044200     MOVE PV-READ-COUNT2 TO PV-DISPLAY-READ-COUNT2.               04540001
044300     DISPLAY 'TOTAL BMC RECS READ ' PV-DISPLAY-READ-COUNT2.       04550001
044400                                                                  04560001
044500     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               04570000
044600     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        04580000
044700                                                                  04590000
044800     GOBACK.                                                      04600000
044900                                                                  04610000
045000******************************************************************04620000
045100*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *04630000
045200******************************************************************04640000
045300 1000-INITIALIZATION.                                             04650000
045400     ACCEPT SD-SYSTEM-DATE                                        04660000
045500       FROM DATE.                                                 04670000
045600                                                                  04680000
045700     ACCEPT SD-SYSTEM-TIME                                        04690000
045800       FROM TIME.                                                 04700000
045900                                                                  04710000
046000     MOVE SD-SYSTEM-DATE-MM  TO DP132O-RUN-MONTH.                 04720000
046100     MOVE SD-SYSTEM-DATE-DD  TO DP132O-RUN-DAY.                   04730000
046200     MOVE SD-SYSTEM-DATE-YY  TO DP132O-RUN-YEAR.                  04740000
046300     MOVE SD-SYSTEM-TIME-HH  TO DP132O-RUN-HOUR.                  04750000
046400     MOVE SD-SYSTEM-TIME-MM  TO DP132O-RUN-MINUTE.                04760000
046500                                                                  04770000
046600     MOVE PC-SUKRP042             TO DP132O-PROGRAM-NAME.         04780001
046700     MOVE PC-REPORT-NBR           TO DP132O-REPORT-NUMBER.        04790000
046800     MOVE +0                      TO PV-PAGE-COUNT.               04800000
046900                                                                  04810000
052700     INITIALIZE PV-UNIT-COUNT                                     04820001
052700                PV-CARTON-COUNT                                   04830001
052700                PV-RETAIL-AMT                                     04840001
052700                PV-JWL                                            04850001
052700                PV-FLAT                                           04860001
052700                PV-P2L                                            04870001
052700                PV-CRSDCK.                                        04880001
052900                                                                  04890001
047000******************************************************************04900000
047100**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  04910000
047200**  PAGES (AS NEEDED).                                            04920000
047300******************************************************************04930000
047400 1500-PRINT-HEADINGS.                                             04940000
047500     ADD +1                  TO PV-PAGE-COUNT.                    04950000
047600     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               04960000
047700                                                                  04970000
047800     WRITE REPORT-RECORD                                          04980000
047900       FROM DP132O-STANDRD-HEADER-132-COLS                        04990000
048000         AFTER ADVANCING PAGE.                                    05000000
048100                                                                  05010000
048200     WRITE REPORT-RECORD                                          05020000
048300       FROM HEADING-LINE1                                         05030000
048400         AFTER ADVANCING 1 LINES.                                 05040000
048500                                                                  05050000
048600     WRITE REPORT-RECORD                                          05060000
048700       FROM HEADING-LINE2                                         05070000
048800         AFTER ADVANCING 1 LINE.                                  05080034
048900                                                                  05090000
049400     WRITE REPORT-RECORD                                          05100000
049500       FROM HEADING-LINE3                                         05110001
049600         AFTER ADVANCING 2 LINES.                                 05120034
049700                                                                  05130000
050200     WRITE REPORT-RECORD                                          05140000
050300       FROM HEADING-LINE4                                         05150001
050400         AFTER ADVANCING 1 LINES.                                 05160000
050500                                                                  05170000
050200     WRITE REPORT-RECORD                                          05180034
050300       FROM HEADING-LINE5                                         05190034
050400         AFTER ADVANCING 1 LINES.                                 05200034
050500                                                                  05210034
051400     WRITE REPORT-RECORD                                          05220000
051500       FROM BLANK-LINE                                            05230000
051600         AFTER ADVANCING 1 LINE.                                  05240000
051700                                                                  05250000
051800     MOVE +08                TO PV-LINE-COUNT.                    05260034
051900                                                                  05270000
052000******************************************************************05280000
052100**  READ INPUT-FILE, WHEN DC CHANGES, DO A PAGE BREAK             05290000
052200******************************************************************05300000
052300 2000-PROCESS-INPUT.                                              05310000
052400     IF SU045-ORGN-LOC-NBR         = PV-SAVE-OPER-UNT-ID          05320001
052500        PERFORM 3000-ADD-UP-THE-DETAIL                            05330001
052600     ELSE                                                         05340000
054100         PERFORM 4000-CALC-PERCENTS                               05350016
054100         PERFORM 5000-MOVE-TO-DETAIL-LINE                         05360001
059900         WRITE REPORT-RECORD FROM DETAIL-LINE1                    05370001
060100              AFTER ADVANCING 2 LINES                             05380003
060200         ADD +1 TO PV-WRITE-COUNT                                 05390001
060300                                                                  05400001
052700         MOVE SU045-ORGN-LOC-NBR   TO PV-SAVE-OPER-UNT-ID         05410001
053100         PERFORM 8500-GET-LOCATION-NAME                           05420001
052500         PERFORM 3000-ADD-UP-THE-DETAIL                           05430001
053400     END-IF.                                                      05440001
053500                                                                  05450000
053600     PERFORM 7000-READ-EXTRACT-FILE.                              05460000
053700                                                                  05470000
053800******************************************************************05480000
053900* ADD UP THE DETAIL CARTON INFORMATION.                         * 05490056
054000******************************************************************05500000
054100 3000-ADD-UP-THE-DETAIL.                                          05510001
054200                                                                  05520000
054300     ADD SU045-UNIT-COUNT             TO PV-UNIT-COUNT            05530035
                                               PV-GRND-TTL-UNIT-CNT.    05540035
054700     ADD +1                           TO PV-CARTON-COUNT          05550035
                                               PV-GRND-TTL-CARTON-CNT.  05560050
054600     ADD SU045-RETAIL-AMT             TO PV-RETAIL-AMT            05570035
                                               PV-GRND-TTL-RETAIL-AMT.  05580051
057300                                                                  05590000
054600     EVALUATE TRUE                                                05600001
003000         WHEN  SU045-TYP-CDE-JWL                                  05610001
003000             ADD +1  TO PV-JWL                                    05620001
                              PV-GRND-TTL-JWL-CNT                       05630035
003100         WHEN SU045-TYP-CDE-P2L                                   05640001
003000             ADD +1  TO PV-P2L                                    05650001
                              PV-GRND-TTL-P2L-CNT                       05660035
003100         WHEN SU045-TYP-CDE-FLAT                                  05670001
003000             ADD +1  TO PV-FLAT                                   05680001
                              PV-GRND-TTL-FLAT-CNT                      05690035
003100         WHEN SU045-TYP-CDE-OTHER                                 05700001
003000             ADD +1  TO PV-CRSDCK                                 05710001
                              PV-GRND-TTL-CRDK-CNT                      05720035
054600     END-EVALUATE.                                                05730001
057300                                                                  05740001
053800******************************************************************05750001
053900*  CALCULATE THE PERCENT COLUMNS USING THE DATA FROM THE SECOND  *05760099
053900*  INPUT FILE COMBINED WITH CURRENT SUMMARY DATA.                *05770099
054000******************************************************************05780001
054100 4000-CALC-PERCENTS.                                              05790001
            INITIALIZE PV-DIVIDEND                                      05800046
                       PV-PERCENT-FPJ                                   05810098
                       PV-DIVIDEND1                                     05811090
                       PV-DIVIDEND2.                                    05812089
                                                                        05820046
057400*FIND DC DATA FROM INTERNAL TABLE                                 05830046
057400     PERFORM 4100-FIND-DC-DATA.                                   05840046
                                                                        05850064
057400*PERCENT OF CARTONS THAT ARE JEWELERY                             05860098
057500     IF PV-CARTON-COUNT   > ZERO AND                              05870098
057600        PV-JWL            > ZERO                                  05880098
057900                                                                  05890064
058000        DIVIDE PV-JWL                                             05900098
058100            BY PV-CARTON-COUNT                                    05910064
058200            GIVING PV-DIVIDEND1 ROUNDED                           05920089
057940                                                                  05930064
058300        MULTIPLY PV-DIVIDEND1 BY 100                              05940089
058400           GIVING PV-PERCENT-JWL                                  05950098
057940                                                                  05960064
057500         IF PV-PERCENT-JWL     > ZERO                             05970098
057500             IF PV-PERCENT-JWL     < 1                            05971099
058500                 MOVE 1                   TO PV-PERCENT-JWL       05972099
058500                 ADD  PV-PERCENT-JWL      TO PV-PERCENT-FPJ       05980099
058500                 MOVE PV-PERCENT-JWL      TO PV-DISPLAY-PERCENT2  05981099
058500                 MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-JWL      05990099
058510             ELSE                                                 06000099
058500                 ADD  PV-PERCENT-JWL      TO PV-PERCENT-FPJ       06002099
058500                 MOVE PV-PERCENT-JWL      TO PV-DISPLAY-PERCENT2  06003099
058500                 MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-JWL      06004099
058600             END-IF                                               06004199
058510         ELSE                                                     06005099
058520             MOVE ZEROES              TO PV-DIVIDEND1             06010089
058500             MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2      06020089
058500             MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-JWL          06030098
058600         END-IF                                                   06040064
058610     ELSE                                                         06050064
058700         MOVE ZEROES              TO PV-DIVIDEND1                 06060089
058500         MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2          06070089
058500         MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-JWL              06080098
058900     END-IF.                                                      06090064
                                                                        06100046
            INITIALIZE PV-DIVIDEND1.                                    06110089
                                                                        06120064
057400*PERCENT OF CARTONS THAT ARE FLAT                                 06130064
057500     IF PV-CARTON-COUNT      > ZERO AND                           06140064
057600        PV-FLAT              > ZERO                               06150064
057900                                                                  06160064
058000        DIVIDE PV-FLAT                                            06170064
058100            BY PV-CARTON-COUNT                                    06180064
058200            GIVING PV-DIVIDEND1 ROUNDED                           06190089
057940                                                                  06200064
058300        MULTIPLY PV-DIVIDEND1 BY 100                              06210089
058400           GIVING PV-PERCENT-FLAT                                 06220095
057940                                                                  06230064
057500         IF PV-PERCENT-FLAT    > ZERO                             06240064
057500             IF PV-PERCENT-FLAT    < 1                            06240199
058500                 MOVE 1                   TO PV-PERCENT-FLAT      06241099
058500                 ADD  PV-PERCENT-FLAT     TO PV-PERCENT-FPJ       06242099
058500                 MOVE PV-PERCENT-FLAT     TO PV-DISPLAY-PERCENT2  06250099
058500                 MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-FLAT     06260099
058510             ELSE                                                 06270099
058500                 ADD  PV-PERCENT-FLAT     TO PV-PERCENT-FPJ       06272099
058500                 MOVE PV-PERCENT-FLAT     TO PV-DISPLAY-PERCENT2  06273099
058500                 MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-FLAT     06274099
058600             END-IF                                               06274199
058510         ELSE                                                     06275099
058520             MOVE ZEROES              TO PV-DIVIDEND1             06280089
058500             MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2      06290089
058500             MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-FLAT         06300086
058600         END-IF                                                   06310064
058610     ELSE                                                         06320064
058700         MOVE ZEROES              TO PV-DIVIDEND1                 06330089
058500         MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2          06340089
058500         MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-FLAT             06350086
058900     END-IF.                                                      06360064
                                                                        06370064
            INITIALIZE PV-DIVIDEND1.                                    06380089
                                                                        06390064
057400*PERCENT OF CARTONS THAT ARE P2L                                  06400064
057500     IF PV-CARTON-COUNT      > ZERO AND                           06410064
057600        PV-P2L               > ZERO                               06420064
057900                                                                  06430064
058000        DIVIDE PV-P2L                                             06440064
058100            BY PV-CARTON-COUNT                                    06450064
058200            GIVING PV-DIVIDEND1 ROUNDED                           06460089
057940                                                                  06470064
058300        MULTIPLY PV-DIVIDEND1 BY 100                              06480089
058400           GIVING PV-PERCENT-P2L                                  06490095
057940                                                                  06500064
057500         IF PV-PERCENT-P2L     > ZERO                             06510064
057500             IF PV-PERCENT-P2L     < 1                            06510199
058500                 MOVE 1                   TO PV-PERCENT-P2L       06511099
058500                 ADD  PV-PERCENT-P2L      TO PV-PERCENT-FPJ       06512099
058500                 MOVE PV-PERCENT-P2L      TO PV-DISPLAY-PERCENT2  06520099
058500                 MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-P2L      06530099
058510             ELSE                                                 06540099
058500                 ADD  PV-PERCENT-P2L      TO PV-PERCENT-FPJ       06542099
058500                 MOVE PV-PERCENT-P2L      TO PV-DISPLAY-PERCENT2  06543099
058500                 MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-P2L      06544099
058510             END-IF                                               06545099
058510         ELSE                                                     06546099
058520             MOVE ZEROES              TO PV-DIVIDEND1             06550089
058500             MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2      06560089
058500             MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-P2L          06570086
058600         END-IF                                                   06580064
058610     ELSE                                                         06590064
058700         MOVE ZEROES              TO PV-DIVIDEND1                 06600089
058500         MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2          06610089
058500         MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-P2L              06620086
058900     END-IF.                                                      06630064
                                                                        06640064
            INITIALIZE PV-DIVIDEND1.                                    06650089
                                                                        06660064
057400*PERCENT OF CARTONS THAT ARE CRSDCK                               06670098
058500     COMPUTE PV-PERCENT-CRSDCK =                                  06811098
058500         100 - PV-PERCENT-FPJ                                     06811198
057500     IF PV-PERCENT-CRSDCK  > ZERO                                 06811298
058500         MOVE PV-PERCENT-CRSDCK    TO PV-DISPLAY-PERCENT2         06811398
058500         MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-CRSDCK           06811498
058510     ELSE                                                         06811594
058520         MOVE ZEROES              TO PV-DIVIDEND1                 06820094
058500         MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2          06830094
058500         MOVE PV-DISPLAY-PERCENT2 TO DL1-PERCENT-CRSDCK           06840098
058600     END-IF.                                                      06850094
                                                                        06910064
057400*PERCENT OF CARTONS MANIFESTED TO A TRAILER                       06940064
057500     IF PV-CARTON-COUNT      > ZERO AND                           06950064
057600        SU063-CARTON-CNT     > ZERO                               06960053
057900                                                                  06970000
057910        COMPUTE PV-DC-TTL-CARTON-CNT =                            06980057
057920            PV-CARTON-COUNT + SU063-CARTON-CNT                    06990053
057940                                                                  07000000
057910        ADD PV-DC-TTL-CARTON-CNT TO PV-ALL-CARTON-CNT             07010057
057900                                                                  07020057
058000        DIVIDE PV-CARTON-COUNT                                    07030050
058100            BY PV-DC-TTL-CARTON-CNT                               07040057
058200            GIVING PV-DIVIDEND2 ROUNDED                           07050046
057940                                                                  07060046
058300        COMPUTE PV-DIVIDEND =                                     07070048
058400           1 -  PV-DIVIDEND2                                      07080048
057940                                                                  07090046
058300        MULTIPLY PV-DIVIDEND BY 100                               07100046
058400           GIVING PV-PERCENT-MFSTD                                07110046
057940                                                                  07120046
057500         IF PV-PERCENT-MFSTD   > ZERO                             07130046
058500             MOVE PV-PERCENT-MFSTD     TO PV-DISPLAY-PERCENT1     07140086
058500             MOVE PV-DISPLAY-PERCENT1  TO DL1-PERCENT-MFSTD       07150086
058510         ELSE                                                     07160000
058520             MOVE ZEROES              TO PV-DIVIDEND              07170065
058520                                         PV-DIVIDEND2             07180065
058500             MOVE PV-DIVIDEND         TO PV-DISPLAY-PERCENT1      07190086
058500             MOVE PV-DISPLAY-PERCENT1 TO DL1-PERCENT-MFSTD        07200086
058600         END-IF                                                   07210000
058610     ELSE                                                         07220000
058700         MOVE ZEROES              TO PV-DIVIDEND                  07230065
058520                                     PV-DIVIDEND2                 07240065
058500         MOVE PV-DIVIDEND         TO PV-DISPLAY-PERCENT1          07250086
058500         MOVE PV-DISPLAY-PERCENT1 TO DL1-PERCENT-MFSTD            07260086
058900     END-IF.                                                      07270003
059000                                                                  07280000
            INITIALIZE PV-DIVIDEND                                      07290046
                       PV-DIVIDEND2.                                    07300046
059000                                                                  07310046
057400*PERCENT OF RETAIL VALUE LOADED                                   07320001
057500     IF PV-RETAIL-AMT         > ZERO AND                          07330053
057600        SU063-RETAIL-AMT      > ZERO                              07340053
057900                                                                  07350001
057910         COMPUTE PV-DC-TTL-RETAIL-AMT =                           07360057
057920             PV-RETAIL-AMT  + SU063-RETAIL-AMT                    07370053
057940                                                                  07380057
057910         ADD PV-DC-TTL-RETAIL-AMT TO PV-ALL-RETAIL-AMT            07390057
057940                                                                  07400001
058000         DIVIDE PV-RETAIL-AMT                                     07410046
058000             BY PV-DC-TTL-RETAIL-AMT                              07420057
058200            GIVING PV-DIVIDEND2 ROUNDED                           07430046
057940                                                                  07440046
058300         COMPUTE PV-DIVIDEND =                                    07450048
058400            1 -  PV-DIVIDEND2                                     07460048
057940                                                                  07470048
058300         MULTIPLY PV-DIVIDEND BY 100                              07480046
058400            GIVING PV-PERCENT-RETAIL                              07490046
057940                                                                  07500046
057500         IF PV-PERCENT-RETAIL  > ZERO                             07510046
058500             MOVE PV-PERCENT-RETAIL   TO PV-DISPLAY-PERCENT1      07520086
058500             MOVE PV-DISPLAY-PERCENT1 TO DL1-PERCENT-RETAIL       07530086
058510         ELSE                                                     07540001
058520             MOVE ZEROES              TO PV-DIVIDEND              07550065
                                               PV-DIVIDEND2             07560065
058500             MOVE PV-DIVIDEND         TO PV-DISPLAY-PERCENT1      07570086
058500             MOVE PV-DISPLAY-PERCENT1 TO DL1-PERCENT-RETAIL       07580086
058600         END-IF                                                   07590001
058610     ELSE                                                         07600001
058520         MOVE ZEROES              TO PV-DIVIDEND                  07610065
                                           PV-DIVIDEND2                 07620065
058500         MOVE PV-DIVIDEND         TO PV-DISPLAY-PERCENT1          07630086
058500         MOVE PV-DISPLAY-PERCENT1 TO DL1-PERCENT-RETAIL           07640086
058900     END-IF.                                                      07650002
059000                                                                  07660001
060400****************************************************************  07670046
060500* FIND THE MATCHING DC'S DATA FROM THE INTERNAL TABLE.         *  07680046
060600****************************************************************  07690046
057400 4100-FIND-DC-DATA.                                               07700046
062100     SET PT-IDX             TO 1.                                 07710053
061900     SEARCH PT-DC-ELEMENT                                         07720054
061900         WHEN  PV-SAVE-OPER-UNT-ID  = PT-ORGN-LOC-NBR (PT-IDX)    07730053
020300             MOVE PT-ORGN-LOC-NBR (PT-IDX) TO SU063-ORGN-LOC-NBR  07740053
020300             MOVE PT-RETAIL-AMT   (PT-IDX) TO SU063-RETAIL-AMT    07750053
020300             MOVE PT-CARTON-CNT   (PT-IDX) TO SU063-CARTON-CNT    07760053
061900     END-SEARCH.                                                  07770053
059000                                                                  07780046
060400****************************************************************  07790046
060500* MOVE THE DETAILS TO REPORT LINE.                             *  07800046
060600****************************************************************  07810046
054100 5000-MOVE-TO-DETAIL-LINE.                                        07820046
059000                                                                  07830046
061900     MOVE PV-JWL           TO DL1-JEWLRY.                         07840046
061900     MOVE PV-P2L           TO DL1-P2L.                            07850046
061900     MOVE PV-FLAT          TO DL1-FLAT.                           07860046
061900     MOVE PV-CRSDCK        TO DL1-CRSDCK.                         07870046
061900     MOVE PV-UNIT-COUNT    TO DL1-UNITS.                          07880046
061900     MOVE PV-CARTON-COUNT  TO DL1-CARTONS.                        07890046
061900     MOVE PV-RETAIL-AMT    TO DL1-RETAIL.                         07900046
059000                                                                  07910046
052700     INITIALIZE PV-UNIT-COUNT                                     07920046
052700                PV-CARTON-COUNT                                   07930046
052700                PV-RETAIL-AMT                                     07940046
052700                PV-JWL                                            07950046
052700                PV-FLAT                                           07960046
052700                PV-P2L                                            07970046
052700                PV-CRSDCK.                                        07980046
052900                                                                  07990046
060400****************************************************************  08000046
060500* MOVE THE TOTALS TO REPORT LINE.                             *   08010046
060600****************************************************************  08020046
054100 5500-MOVE-TO-TOTAL-LINE.                                         08030046
059000                                                                  08040046
061900     MOVE PV-GRND-TTL-JWL-CNT     TO  GL1-JEWLRY.                 08050057
061900     MOVE PV-GRND-TTL-P2L-CNT     TO  GL1-P2L.                    08060057
061900     MOVE PV-GRND-TTL-FLAT-CNT    TO  GL1-FLAT.                   08070057
061900     MOVE PV-GRND-TTL-CRDK-CNT    TO  GL1-CRSDCK.                 08080057
061900     MOVE PV-GRND-TTL-UNIT-CNT    TO  GL1-UNITS.                  08090057
061900     MOVE PV-GRND-TTL-CARTON-CNT  TO  GL1-CARTONS.                08100051
061900     MOVE PV-GRND-TTL-RETAIL-AMT  TO  GL1-RETAIL.                 08110051
059000                                                                  08120046
058520     MOVE ZEROES       TO PV-DIVIDEND1                            08130097
                                PV-PERCENT-FPJ.                         08131098
057400*GRAND TOTAL PERCENT OF CARTONS THAT ARE JEWELRY                  08140098
057500     IF PV-GRND-TTL-CARTON-CNT  > ZERO AND                        08150079
057600        PV-GRND-TTL-JWL-CNT     > ZERO                            08160098
057900                                                                  08170057
058000        DIVIDE PV-GRND-TTL-JWL-CNT                                08180098
058100            BY PV-GRND-TTL-CARTON-CNT                             08190079
058200            GIVING PV-DIVIDEND1 ROUNDED                           08200089
057940                                                                  08210057
058300        MULTIPLY PV-DIVIDEND1 BY 100                              08220089
058400           GIVING PV-GRND-TTL-JWL-PRC                             08230098
057940                                                                  08240057
057500         IF PV-GRND-TTL-JWL-PRC > ZERO                            08250098
057500             IF PV-GRND-TTL-JWL-PRC < 1                           08250199
058500                 MOVE 1                   TO PV-GRND-TTL-JWL-PRC  08251099
058500                 ADD  PV-GRND-TTL-JWL-PRC TO PV-PERCENT-FPJ       08252099
058500                 MOVE PV-GRND-TTL-JWL-PRC TO PV-DISPLAY-PERCENT2  08260099
058500                 MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-JWL      08270099
058510             ELSE                                                 08280099
058500                 ADD  PV-GRND-TTL-JWL-PRC TO PV-PERCENT-FPJ       08281099
058500                 MOVE PV-GRND-TTL-JWL-PRC TO PV-DISPLAY-PERCENT2  08282099
058500                 MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-JWL      08283099
058600             END-IF                                               08283199
058510         ELSE                                                     08284099
058520             MOVE ZEROES              TO PV-DIVIDEND1             08290099
058500             MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2      08310099
058500             MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-JWL          08320099
058600         END-IF                                                   08331099
058610     ELSE                                                         08340057
058700         MOVE ZEROES              TO PV-DIVIDEND1                 08350089
058500         MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2          08370089
058500         MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-JWL              08380099
058900     END-IF.                                                      08390057
059000                                                                  08400057
058520     MOVE ZEROES       TO PV-DIVIDEND1.                           08410089
057400*GRAND TOTAL PERCENT OF CARTONS THAT ARE FLAT                     08420079
057500     IF PV-GRND-TTL-CARTON-CNT  > ZERO AND                        08430079
057600        PV-GRND-TTL-FLAT-CNT    > ZERO                            08440079
057900                                                                  08450079
058000        DIVIDE PV-GRND-TTL-FLAT-CNT                               08460079
058100            BY PV-GRND-TTL-CARTON-CNT                             08470079
058200            GIVING PV-DIVIDEND1 ROUNDED                           08480089
057940                                                                  08490079
058300        MULTIPLY PV-DIVIDEND1 BY 100                              08500089
058400           GIVING PV-GRND-TTL-FLAT-PRC                            08510095
057940                                                                  08520079
057500         IF PV-GRND-TTL-FLAT-PRC > ZERO                           08530079
057500             IF PV-GRND-TTL-FLAT-PRC < 1                          08530199
058500                 MOVE 1                    TO PV-GRND-TTL-FLAT-PRC08531099
058500                 ADD  PV-GRND-TTL-FLAT-PRC TO PV-PERCENT-FPJ      08532099
058500                 MOVE PV-GRND-TTL-FLAT-PRC TO PV-DISPLAY-PERCENT2 08540099
058500                 MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-FLAT     08550099
058510             ELSE                                                 08560099
058500                 ADD  PV-GRND-TTL-FLAT-PRC TO PV-PERCENT-FPJ      08562099
058500                 MOVE PV-GRND-TTL-FLAT-PRC TO PV-DISPLAY-PERCENT2 08563099
058500                 MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-FLAT     08564099
058510             END-IF                                               08565099
058510         ELSE                                                     08566099
058520             MOVE ZEROES              TO PV-DIVIDEND1             08570089
058500             MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2      08590089
058500             MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-FLAT         08600086
058600         END-IF                                                   08610079
058610     ELSE                                                         08620079
058700         MOVE ZEROES              TO PV-DIVIDEND1                 08630089
058500         MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2          08650089
058500         MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-FLAT             08660086
058900     END-IF.                                                      08670079
059000                                                                  08680079
058520     MOVE ZEROES       TO PV-DIVIDEND1.                           08690089
057400*GRAND TOTAL PERCENT OF CARTONS THAT ARE P2L                      08700079
057500     IF PV-GRND-TTL-CARTON-CNT  > ZERO AND                        08710079
057600        PV-GRND-TTL-P2L-CNT     > ZERO                            08720079
057900                                                                  08730079
058000        DIVIDE PV-GRND-TTL-P2L-CNT                                08740079
058100            BY PV-GRND-TTL-CARTON-CNT                             08750079
058200            GIVING PV-DIVIDEND1 ROUNDED                           08760089
057940                                                                  08770079
058300        MULTIPLY PV-DIVIDEND1 BY 100                              08780089
058400           GIVING PV-GRND-TTL-P2L-PRC                             08790095
057940                                                                  08800079
057500         IF PV-GRND-TTL-P2L-PRC > ZERO                            08810079
057500             IF PV-GRND-TTL-P2L-PRC < 1                           08810199
058500                 MOVE 1                   TO PV-GRND-TTL-P2L-PRC  08811099
058500                 ADD  PV-GRND-TTL-P2L-PRC TO PV-PERCENT-FPJ       08812099
058500                 MOVE PV-GRND-TTL-P2L-PRC TO PV-DISPLAY-PERCENT2  08820099
058500                 MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-P2L      08830099
058510             ELSE                                                 08840099
058500                 ADD  PV-GRND-TTL-P2L-PRC TO PV-PERCENT-FPJ       08842099
058500                 MOVE PV-GRND-TTL-P2L-PRC TO PV-DISPLAY-PERCENT2  08843099
058500                 MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-P2L      08844099
058510             END-IF                                               08845099
058510         ELSE                                                     08846099
058520             MOVE ZEROES              TO PV-DIVIDEND1             08850089
058500             MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2      08870089
058500             MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-P2L          08880086
058600         END-IF                                                   08890079
058610     ELSE                                                         08900079
058700         MOVE ZEROES              TO PV-DIVIDEND1                 08910089
058500         MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2          08930089
058500         MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-P2L              08940086
058900     END-IF.                                                      08950079
059000                                                                  08960079
058520     MOVE ZEROES       TO PV-DIVIDEND1.                           08970089
057400*GRAND TOTAL PERCENT OF CARTONS THAT ARE CRDK                     08980098
058500     COMPUTE PV-GRND-TTL-CRDK-PRC =                               09081098
058500         100 - PV-PERCENT-FPJ                                     09082098
057500     IF PV-GRND-TTL-CRDK-PRC > ZERO                               09090098
058500         MOVE PV-GRND-TTL-CRDK-PRC TO PV-DISPLAY-PERCENT2         09100098
058500         MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-CRSDCK           09110099
058510     ELSE                                                         09120097
058520         MOVE ZEROES              TO PV-DIVIDEND1                 09130097
058500         MOVE PV-DIVIDEND1        TO PV-DISPLAY-PERCENT2          09150097
058500         MOVE PV-DISPLAY-PERCENT2 TO GL1-PERCENT-CRSDCK           09160099
058600     END-IF.                                                      09170097
059000                                                                  09240079
058520     MOVE ZEROES       TO PV-DIVIDEND                             09250089
058520                          PV-DIVIDEND2.                           09260079
057400*GRAND TOTAL PERCENT OF CARTONS MANIFESTED TO A TRAILER           09270079
057500     IF PV-ALL-CARTON-CNT       > ZERO AND                        09280079
057600        PV-GRND-TTL-CARTON-CNT  > ZERO                            09290079
057900                                                                  09300079
058000        DIVIDE PV-GRND-TTL-CARTON-CNT                             09310079
058100            BY PV-ALL-CARTON-CNT                                  09320079
058200            GIVING PV-DIVIDEND2 ROUNDED                           09330079
057940                                                                  09340079
058300        COMPUTE PV-DIVIDEND =                                     09350079
058400           1 -  PV-DIVIDEND2                                      09360079
057940                                                                  09370079
058300        MULTIPLY PV-DIVIDEND BY 100                               09380079
058400           GIVING PV-GRND-TTL-PRC-MNFD                            09390079
057940                                                                  09400079
057500         IF PV-GRND-TTL-PRC-MNFD  > ZERO                          09410079
058500             MOVE PV-GRND-TTL-PRC-MNFD TO PV-DISPLAY-PERCENT1     09420086
058500             MOVE PV-DISPLAY-PERCENT1  TO GL1-PERCENT-MFSTD       09430086
058510         ELSE                                                     09440079
058520             MOVE ZEROES              TO PV-DIVIDEND              09450079
058520                                         PV-DIVIDEND2             09460079
058500             MOVE PV-DIVIDEND         TO PV-DISPLAY-PERCENT1      09470086
058500             MOVE PV-DISPLAY-PERCENT1 TO GL1-PERCENT-MFSTD        09480086
058600         END-IF                                                   09490079
058610     ELSE                                                         09500079
058700         MOVE ZEROES              TO PV-DIVIDEND                  09510079
058520                                     PV-DIVIDEND2                 09520079
058500         MOVE PV-DIVIDEND         TO PV-DISPLAY-PERCENT1          09530086
058500         MOVE PV-DISPLAY-PERCENT1 TO GL1-PERCENT-MFSTD            09540086
058900     END-IF.                                                      09550079
059000                                                                  09560079
            INITIALIZE PV-DIVIDEND                                      09570079
                       PV-DIVIDEND2.                                    09580079
059000                                                                  09590079
057400*PERCENT OF RETAIL VALUE LOADED                                   09600079
057500     IF PV-ALL-RETAIL-AMT       > ZERO AND                        09610079
057600        PV-GRND-TTL-RETAIL-AMT  > ZERO                            09620079
057900                                                                  09630079
058000        DIVIDE PV-GRND-TTL-RETAIL-AMT                             09640079
058100            BY PV-ALL-RETAIL-AMT                                  09650079
058200            GIVING PV-DIVIDEND2 ROUNDED                           09660079
057900                                                                  09670079
058300         COMPUTE PV-DIVIDEND =                                    09680079
058400            1 -  PV-DIVIDEND2                                     09690079
057940                                                                  09700079
058300         MULTIPLY PV-DIVIDEND BY 100                              09710079
058400            GIVING PV-GRND-TTL-PRC-RTL                            09720079
057940                                                                  09730079
057500         IF PV-GRND-TTL-PRC-RTL  > ZERO                           09740079
058500             MOVE PV-GRND-TTL-PRC-RTL TO PV-DISPLAY-PERCENT1      09750086
058500             MOVE PV-DISPLAY-PERCENT1 TO GL1-PERCENT-RETAIL       09760086
058510         ELSE                                                     09770079
058520             MOVE ZEROES             TO PV-DIVIDEND               09780079
                                              PV-DIVIDEND2              09790079
058500             MOVE PV-DIVIDEND        TO PV-DISPLAY-PERCENT1       09800086
058500             MOVE PV-DISPLAY-PERCENT1 TO GL1-PERCENT-RETAIL       09810086
058600         END-IF                                                   09820079
058610     ELSE                                                         09830079
058520         MOVE ZEROES             TO PV-DIVIDEND                   09840079
                                          PV-DIVIDEND2                  09850079
058500         MOVE PV-DIVIDEND        TO PV-DISPLAY-PERCENT1           09860086
058500         MOVE PV-DISPLAY-PERCENT1 TO GL1-PERCENT-RETAIL           09870086
058900     END-IF.                                                      09880079
059000                                                                  09890079
043400     WRITE REPORT-RECORD                                          09900079
043500       FROM TOTAL-LINE                                            09910079
043600         AFTER ADVANCING 3 LINES.                                 09920079
043700                                                                  09930079
060400****************************************************************  09940079
060500* PRINTS A BLANK LINE                                          *  09950079
060600****************************************************************  09960079
060700 6000-PRINT-BLANK-LINE.                                           09970001
060800                                                                  09980000
060900        WRITE REPORT-RECORD                                       09990000
061000          FROM BLANK-LINE                                         10000000
061100            AFTER ADVANCING 1 LINE                                10010000
061200                                                                  10020000
061300     ADD +1 TO PV-LINE-COUNT.                                     10030000
061400                                                                  10040000
061500******************************************************************10050000
061600*  READ A RECORD FROM THE MANIFESTED NOT LOADED FILE             *10060001
061700******************************************************************10070000
061800 7000-READ-EXTRACT-FILE.                                          10080000
061900     READ INPUT-FILE1 INTO SU045-EXTRACT-RECORD                   10090001
062000         AT END                                                   10100000
062100             SET PS-END-OF-INPUT1 TO TRUE                         10110001
062200         NOT AT END                                               10120000
062300             ADD +1 TO PV-READ-COUNT1                             10130001
062400     END-READ.                                                    10140000
062500                                                                  10150000
061500******************************************************************10160001
061600*  READ A RECORD FROM THE BMC UNLOAD OF SUT_TRIP_SUM             *10170001
061700******************************************************************10180001
061800 7100-READ-EXTRACT-FILE.                                          10190001
061900     PERFORM VARYING PT-IDX FROM 1 BY 1                           10200046
061900         UNTIL PT-IDX > 50 OR PS-END-OF-INPUT2                    10210099
061900             READ INPUT-FILE2 INTO SU063-EXTRACT-RECORD           10220046
062000                 AT END                                           10230046
062100                     SET PS-END-OF-INPUT2 TO TRUE                 10240046
062200                 NOT AT END                                       10250046
062300                     ADD +1 TO PV-READ-COUNT2                     10260046
062300                     PERFORM 8000-FILL-DC-TABLE                   10270046
062400             END-READ                                             10280046
061900     END-PERFORM.                                                 10290046
062500                                                                  10300046
062600******************************************************************10310046
062700*USING DATA FROM THE SECOND FILE - BUILD A WORKING STORAGE TABLE  10320048
062800******************************************************************10330046
062700 8000-FILL-DC-TABLE.                                              10340046
062801                                                                  10350046
020300     MOVE SU063-ORGN-LOC-NBR  TO PT-ORGN-LOC-NBR (PT-IDX).        10360046
020300     MOVE SU063-RETAIL-AMT    TO PT-RETAIL-AMT   (PT-IDX).        10370046
020300     MOVE SU063-CARTON-CNT    TO PT-CARTON-CNT   (PT-IDX).        10380046
062801                                                                  10390046
062600******************************************************************10400000
062700 8500-GET-LOCATION-NAME.                                          10410000
062800******************************************************************10420000
062801                                                                  10430000
095100     MOVE SPACES               TO  DL1-DC-NAME.                   10440070
062802     MOVE PV-SAVE-OPER-UNT-ID  TO  XLT00010-LOC-NBR               10450065
062802                                   PV-DISPLAY-OPER.               10460065
062803                                                                  10470065
062810     EXEC SQL                                                     10480000
062820         SELECT   LOC_10_ABBR_NM                                  10490064
062830           INTO  :XLT00010-LOC-10-ABBR-NM                         10500066
062840           FROM   XLT_LOC                                         10510000
062860          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   10520000
062892     END-EXEC.                                                    10530000
062893                                                                  10540000
062894     EVALUATE TRUE                                                10550000
062895         WHEN SQLCODE = +0                                        10560000
094900             STRING XLT00010-LOC-10-ABBR-NM DELIMITED BY SPACES   10570065
095000               '-'              DELIMITED BY SIZE                 10580064
095000               PV-DISPLAY-OPER  DELIMITED BY SPACES               10590065
095100                        INTO DL1-DC-NAME                          10600064
062911         WHEN OTHER                                               10610000
062912              CONTINUE                                            10620064
062941     END-EVALUATE.                                                10630000
066400                                                                  10640000
066500******************************************************************10650000
066600*  ABEND ROUTINE                                                 *10660000
066700******************************************************************10670000
066800 9900-DB2-ABEND.                                                  10680000
066900                                                                  10690000
067000     MOVE SQLCODE TO PV-SQLCODE.                                  10700000
067100     DISPLAY '*** DB2 ERROR '.                                    10710000
067200     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       10720000
067300     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 10730000
067400     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               10740000
067500     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               10750000
067600     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       10760000
067700     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       10770000
067800     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME-1.              10780000
067900     DISPLAY '*** TABLE 2   = ' PV-DB2-TABLE-NAME-2.              10790000
068000                                                                  10800000
068400     COPY DPPD004.                                                10810000
068500                                                                  10820000
068600     MOVE +4013 TO PV-ABEND-CODE.                                 10830000
068700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10840000
068800                                                                  10850000
068900 9999-ABEND.                                                      10860000
069000                                                                  10870000
069100     DISPLAY '***************'.                                   10880000
069200     DISPLAY '** ABEND     **'.                                   10890000
069300     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               10900000
069400     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             10910000
069500     DISPLAY '***************'.                                   10920000
069600                                                                  10930000
069700     MOVE +4008                  TO PV-ABEND-CODE.                10940000
069800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10950000
069900                                                                  10960000
070000******************************************************************10970000
070100*                 E N D   O F   P R O G R A M                    *10980000
070200******************************************************************10990000
