000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.     APKRP182.                                        00020001
000300 AUTHOR.         NANCY EILBES                                     00030001
000400 DATE-WRITTEN.   JULY 2003.                                       00040001
000500 DATE-COMPILED.                                                   00050001
000600******************************************************************00060001
000700* COBOL 2 BATCH                                                  *00070001
000800*     JOURNALIZED IMPORT PO COST AND QTY EXCEPTION REPORT        *00080011
000900*                                                                *00090001
001000*    THIS PROGRAM CREATES AN EXCEPTION REPORT FOR THE IMPORT     *00100011
001100*    PURCHASE ORDERS JOURNALIZED DURING THE TIME PERIOD BEING    *00110011
001200*    REPORTED.  FOR EACH PO THE FOLLOWING DETAILS ARE INCLUDED:  *00120011
001300*    VENDOR NAME, PO NUMBER, DEPARTMENT NUMBER, 1ST INVOICE      *00130011
001310*    DATE, RECEIPT QUANTITY, INVOICE QUANTITY, RECEIPT TOTAL     *00131011
001400*    COST, INVOICE TOTAL COST, DIFFERENCE BETWEEN INVOICE AND    *00140011
001500*    RECEIPT COST, RECEIPT QUANTITY, INVOICE QUANTITY, AND THE   *00150011
001600*    DIFFERENCE BETWEEN INVOICE AND RECEIPT QUANTITY.            *00160011
001700*                                                                *00170001
001800*    THE USERS OF THIS REPORT WILL BE INVENTORY CONTROL.         *00180001
001900*    IT WILL HELP THEM TO IDENTIFY POSSIBLE OVER AND SHORT       *00190001
002000*    ISSUES FOR IMPORT PURCHASE ORDERS.  TO MAKE THE REPORT      *00200011
002100*    THE MOST USABLE FOR THIS PURPOSE, THE DATA WILL BE SORTED   *00210011
002101*    IN DESCENDING SEQUENCE ON THE QUANTITY DIFFERENCE FIELD.    *00210111
002110*                                                                *00211011
002200* INPUT:                                                         *00220001
002300*  1. JOURNALIZED IMPORT EXCEPTION REPORT FILE  (APRD080)        *00230011
002400*                                                                *00240001
002500* OUTPUT:                                                        *00250001
002600*  1. JOURNALIZED IMPORT PO EXCEPTION REPORT                     *00260011
002700*                                                                *00270001
002800*----------------------------------------------------------------*00280001
002900* CHANGE LOG:                                                    *00290001
003000* DATE  07/16/2003                                               *00300011
003100*     CHANGE MADE: INITIAL VERSION                               *00310001
003200*     MADE BY: NANCY EILBES            WR/IR #: WR24863          *00320001
003300*                                                                *00330001
003400* DATE  __/__/____                                               *00340001
003500*     CHANGE MADE: _____________________________________________ *00350001
003600*     __________________________________________________________ *00360001
003700*     MADE BY: _______________________ WR/IR #: _________        *00370001
003800*                                                                *00380001
003900******************************************************************00390001
004000                                                                  00400001
004100                                                                  00410001
004200 ENVIRONMENT DIVISION.                                            00420001
004300 CONFIGURATION SECTION.                                           00430001
004400 SOURCE-COMPUTER.    IBM-3090.                                    00440001
004500 OBJECT-COMPUTER.    IBM-3090.                                    00450001
004600                                                                  00460001
004700 INPUT-OUTPUT SECTION.                                            00470001
004800 FILE-CONTROL.                                                    00480001
004900     SELECT IMPORT-PO-FILE ASSIGN TO UT-S-INP01.                  00490001
005000     SELECT SUMMARY-RPT-FILE ASSIGN TO UT-S-RPT01.                00500003
005100                                                                  00510001
005200 DATA DIVISION.                                                   00520001
005300 FILE SECTION.                                                    00530001
005400                                                                  00540001
005500 FD  IMPORT-PO-FILE                                               00550001
005600     RECORDING MODE IS F                                          00560001
005700     LABEL RECORDS ARE STANDARD                                   00570001
005800     BLOCK CONTAINS 0 RECORDS                                     00580001
005900     DATA RECORD IS IMPORT-PO-REC.                                00590001
006000 01  IMPORT-PO-REC                    PIC  X(125).                00600011
006100                                                                  00610001
006200 FD  SUMMARY-RPT-FILE                                             00620001
006300     RECORDING MODE IS F                                          00630001
006400     LABEL RECORDS ARE STANDARD                                   00640001
006500     BLOCK CONTAINS 0 RECORDS                                     00650001
006600     DATA RECORD IS SUMMARY-RPT-REC.                              00660001
006700 01  SUMMARY-RPT-REC                  PIC X(132).                 00670001
006800 EJECT                                                            00680001
006900                                                                  00690001
007000 WORKING-STORAGE SECTION.                                         00700001
007100                                                                  00710001
007200 01  PV-PROGRAM-VARIABLES.                                        00720001
007300     05  FILLER                      PIC X(30) VALUE              00730001
007400         '** BEGINING OF APKRP182 W/S **'.                        00740001
007500     05  PV-CURRENT-PARAGRAPH        PIC X(35).                   00750001
007600     05  PV-PROGRAM-NAME             PIC X(08) VALUE 'APKRP182'.  00760001
007700                                                                  00770001
007800     05  PV-DATE-TIME-FIELDS.                                     00780001
007900         10  PV-CURRENT-DATE.                                     00790001
008000             15  PV-CURRENT-YEAR     PIC 9(02) VALUE ZEROS.       00800001
008100             15  PV-CURRENT-MONTH    PIC 9(02) VALUE ZEROS.       00810001
008200             15  PV-CURRENT-DAY      PIC 9(02) VALUE ZEROS.       00820001
008300         10  PV-CURRENT-TIME.                                     00830001
008400             15  PV-CURRENT-HOURS    PIC 9(02) VALUE ZEROS.       00840001
008500             15  PV-CURRENT-MIN      PIC 9(02) VALUE ZEROS.       00850001
008600             15  PV-CURRENT-SEC      PIC 9(02) VALUE ZEROS.       00860001
008700             15  PV-CURRENT-HUN      PIC 9(02) VALUE ZEROS.       00870001
008900     05  SAVE-VENDOR-NAME            PIC X(25) VALUE SPACES.      00890001
009400     05  PV-COUNTERS.                                             00940001
009500         10  PV-LINE-COUNT           PIC S9(03) VALUE +61         00950001
009600                                                 COMP-3.          00960001
009700         10  PV-PAGE-COUNT           PIC S9(05) VALUE ZEROS       00970001
009800                                                 COMP-3.          00980001
009900                                                                  00990001
010000 01  PC-PROGRAM-CONSTANTS.                                        01000001
010100     05  PC-MAX-LINES            PIC S9(03)  VALUE +60            01010001
010200                                             COMP-3.              01020001
010300                                                                  01030001
010400 01  PS-PROGRAM-SWITCHES.                                         01040001
010500     05  PS-END-OF-IMPORT-FILE-SW PIC X(01)  VALUE 'N'.           01050001
010600         88  END-OF-IMPORT-FILE              VALUE 'Y'.           01060001
010700                                                                  01070001
010800 EJECT                                                            01080001
010900*----------------------------------------------------------------*01090001
011000*  STANDARD HEADER LAYOUT                                        *01100001
011100*----------------------------------------------------------------*01110001
011200     COPY DPWS132O.                                               01120001
011300                                                                  01130001
011400                                                                  01140001
011500 01  H2-HEADER2.                                                  01150001
011600     05  FILLER                  PIC  X(39) VALUE SPACES.         01160001
011700     05  FILLER                  PIC  X(54) VALUE                 01170001
011800        'JOURNALIZED IMPORT PO COST AND QUANTITY SUMMARY REPORT'. 01180001
011900     05  FILLER                  PIC  X(39) VALUE SPACES.         01190001
012000                                                                  01200001
012100 01  DH-DETAIL-HEADER1.                                           01210001
012200     05  FILLER                  PIC  X(42)  VALUE SPACE.         01220001
012300     05  FILLER                  PIC  X(11)  VALUE '1ST INVOICE'. 01230001
012400     05  FILLER                  PIC  X(11)  VALUE '   VERIFIED'. 01240001
012500     05  FILLER                  PIC  X(11)  VALUE '   INVOICED'. 01250001
012600     05  FILLER                  PIC  X(06)  VALUE SPACES.        01260001
012700     05  FILLER                  PIC  X(08)  VALUE 'VERIFIED'.    01270001
012800     05  FILLER                  PIC  X(19)  VALUE SPACES.        01280001
012900     05  FILLER                  PIC  X(08)  VALUE 'QUANTITY'.    01290001
013000     05  FILLER                  PIC  X(09)  VALUE SPACES.        01300001
013100     05  FILLER                  PIC  X(07)  VALUE 'COST   '.     01310001
013200                                                                  01320001
013300 01  DH-DETAIL-HEADER2.                                           01330001
013400     05  FILLER                  PIC X(11) VALUE 'VENDOR NAME'.   01340001
013500     05  FILLER                  PIC X(15) VALUE SPACE.           01350005
013600     05  FILLER                  PIC X(09) VALUE 'PO NUMBER'.     01360001
013700     05  FILLER                  PIC X(06) VALUE '  DEPT'.        01370001
013800     05  FILLER                  PIC X(09) VALUE '     DATE'.     01380005
013900     05  FILLER                  PIC X(06) VALUE SPACE.           01390001
014000     05  FILLER                  PIC X(11) VALUE 'QUANTITY   '.   01400001
014100     05  FILLER                  PIC X(08) VALUE 'QUANTITY'.      01410005
014200     05  FILLER                  PIC X(04) VALUE SPACES.          01420001
014300     05  FILLER                  PIC X(12) VALUE 'RECEIPT COST'.  01430001
014400     05  FILLER                  PIC X(02) VALUE SPACES.          01440001
014500     05  FILLER                  PIC X(13) VALUE 'INVOICED COST'. 01450001
014600     05  FILLER                  PIC X(11) VALUE ' DIFFERENCE'.   01460001
014700     05  FILLER                  PIC X(05) VALUE SPACES.          01470001
014800     05  FILLER                  PIC X(10) VALUE 'DIFFERENCE'.    01480001
014900                                                                  01490001
015000 01  DETAIL-LINE.                                                 01500001
015100     05  DL-VENDOR-NAME          PIC X(25) VALUE SPACES.          01510001
015200     05  FILLER                  PIC X     VALUE SPACES.          01520001
015300     05  DL-PO-NBR               PIC ZZZZZZZZ9.                   01530001
015400     05  FILLER                  PIC XX    VALUE SPACES.          01540001
015500     05  DL-DEPT-NBR             PIC Z999.                        01550010
015600     05  FILLER                  PIC XX    VALUE SPACES.          01560006
015700     05  DL-INVC-DTE             PIC X(10) VALUE SPACES.          01570001
015800     05  FILLER                  PIC XX    VALUE SPACES.          01580006
015900     05  DL-RCV-QTY              PIC ZZZZZZZZ9.                   01590001
016000     05  FILLER                  PIC XX    VALUE SPACES.          01600001
016100     05  DL-INV-QTY              PIC ZZZZZZZZ9.                   01610001
016200     05  FILLER                  PIC XX    VALUE SPACES.          01620001
016300     05  DL-RCV-COST             PIC ZZZZZZZZZZ9.99.              01630001
016400     05  FILLER                  PIC X     VALUE SPACES.          01640001
016500     05  DL-INVC-COST            PIC ZZZZZZZZZZ9.99.              01650001
016600     05  FILLER                  PIC X     VALUE SPACES.          01660001
016700     05  DL-DIFF-QTY             PIC --------9.                   01670001
016800     05  FILLER                  PIC X     VALUE SPACES.          01680001
016900     05  DL-DIFF-COST            PIC ----------9.99.              01690001
017110                                                                  01711008
017120 01  DL-END-OF-REPORT.                                            01712008
017200     05  FILLER                  PIC  X(43) VALUE ALL '*'.        01720007
017300     05  FILLER                  PIC  X(45) VALUE                 01730001
017400        ' END OF JOURNALIZED IMPORT PO SUMMARY REPORT '.          01740001
017500     05  FILLER                  PIC  X(44) VALUE ALL '*'.        01750007
017600                                                                  01760001
017700 01  DL-NO-DATA.                                                  01770001
017800     05  FILLER                  PIC  X(43) VALUE SPACES.         01780002
017900     05  FILLER                  PIC  X(45) VALUE                 01790002
018000       'THERE ARE NO JOURNALIZED IMPORT POS TO REPORT'.           01800001
018100     05  FILLER                  PIC  X(44) VALUE SPACES.         01810002
018200                                                                  01820001
018300 EJECT                                                            01830001
018400*----------------------------------------------------------------*01840001
018500*  ABEND DATA AREAS                                              *01850001
018600*----------------------------------------------------------------*01860001
018700 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          01870001
018800                                             COMP SYNC.           01880001
018900     88  AC-NO-INPUT-ERR                     VALUE +2750.         01890001
019000                                                                  01900001
019100                                                                  01910001
019200 01  ABEND-AREAS.                                                 01920001
019300     05  AA-ABEND-LIT            PIC  X(40)  VALUE                01930001
019400             '*****       ABEND'.                                 01940001
019500     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                01950001
019600             '*****   PROGRAM: APKRP182'.                         01960001
019700     05  AA-PARAGRAPH-LIT.                                        01970001
019800         10  FILLER              PIC  X(17)  VALUE                01980001
019900             '***** PARAGRAPH: '.                                 01990001
020000         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        02000001
020100     05  AA-MESSAGE-LINE.                                         02010001
020200         10  FILLER              PIC  X(06)  VALUE '*****'.       02020001
020300         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        02030001
020400 EJECT                                                            02040001
020500*----------------------------------------------------------------*02050001
020600*  INPUT COPYBOOK                                                *02060001
020700*----------------------------------------------------------------*02070001
020800     COPY APRD080.                                                02080012
020900 EJECT                                                            02090001
021000 PROCEDURE DIVISION.                                              02100001
021100 A100-MAIN.                                                       02110001
021200                                                                  02120001
021300     MOVE 'A100-MAIN' TO PV-CURRENT-PARAGRAPH.                    02130001
021400                                                                  02140001
021500     PERFORM B100-INITIALIZE.                                     02150001
021600                                                                  02160001
021700     PERFORM B200-CREATE-SUMMARY-REPORT                           02170001
021800         UNTIL END-OF-IMPORT-FILE.                                02180001
021900                                                                  02190001
022000     PERFORM B300-END-OF-PROGRAM.                                 02200001
022100     GOBACK.                                                      02210001
022200 EJECT                                                            02220001
022300*----------------------------------------------------------------*02230001
022400*    INITIALIZATION PROCESSING                                   *02240001
022500*    CALLED FROM A100-MAIN                                       *02250001
022600*----------------------------------------------------------------*02260001
022700 B100-INITIALIZE.                                                 02270001
022800                                                                  02280001
022900     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              02290001
023000                                                                  02300001
023100     OPEN INPUT  IMPORT-PO-FILE.                                  02310001
023200     OPEN OUTPUT SUMMARY-RPT-FILE.                                02320001
023300                                                                  02330001
023400     MOVE PV-PROGRAM-NAME   TO DP132O-PROGRAM-NAME.               02340001
023500                                                                  02350001
023600     ACCEPT PV-CURRENT-TIME FROM TIME.                            02360001
023700     MOVE PV-CURRENT-HOURS  TO DP132O-RUN-HOUR.                   02370001
023800     MOVE PV-CURRENT-MIN    TO DP132O-RUN-MINUTE.                 02380001
023900                                                                  02390001
024000     ACCEPT PV-CURRENT-DATE FROM DATE.                            02400001
024100     MOVE PV-CURRENT-YEAR   TO DP132O-RUN-YEAR.                   02410001
024200     MOVE PV-CURRENT-MONTH  TO DP132O-RUN-MONTH.                  02420001
024300     MOVE PV-CURRENT-DAY    TO DP132O-RUN-DAY.                    02430001
024400                                                                  02440001
024500     PERFORM W200-PRINT-HEADERS.                                  02450001
024600                                                                  02460001
024700     PERFORM R100-READ-IMPORT-PO-FILE.                            02470001
024800     IF END-OF-IMPORT-FILE                                        02480001
024900        WRITE SUMMARY-RPT-REC FROM DL-NO-DATA AFTER 2             02490001
025000     END-IF.                                                      02500001
025100                                                                  02510001
025200 EJECT                                                            02520001
025300*----------------------------------------------------------------*02530001
025400* THE INPUT FILE WILL CONTAIN 2 RECORDS FOR EACH PO. THE NEEDED  *02540001
025500* FIELDS WILL BE MOVED FROM THE HEADER AND THE NEXT RECORD WILL  *02550001
025600* BE READ.  WHEN A DETAIL RECORD IS FOUND THAT IS TYPE 'M1' AND  *02560001
025700* THE PO MATCHES THE ONE FROM THE HEADER THAT WAS JUST PROCESSED,*02570001
025800* A DETAIL LINE WILL BE WRITTEN TO THE REPORT.  OTHERWISE, A     *02580001
025900* MESSAGE WILL DISPLAY AND THE PO WILL BE BYPASSED.              *02590001
026000*----------------------------------------------------------------*02600001
026100 B200-CREATE-SUMMARY-REPORT.                                      02610001
026200                                                                  02620001
026300     MOVE 'B200-CREATE-SUMMARY-REPORT' TO PV-CURRENT-PARAGRAPH.   02630001
026400                                                                  02640001
026600     MOVE AP080-VENDOR-NAME         TO DL-VENDOR-NAME.            02660011
026700     MOVE AP080-PO-NBR              TO DL-PO-NBR.                 02670011
026900     MOVE AP080-DEPT-NBR            TO DL-DEPT-NBR.               02690011
027000     MOVE AP080-1ST-INVC-DTE        TO DL-INVC-DTE.               02700011
027100     MOVE AP080-RCV-UNT-QTY         TO DL-RCV-QTY.                02710011
027200     MOVE AP080-INV-UNT-QTY         TO DL-INV-QTY.                02720011
027500     MOVE AP080-QTY-DIFFERENCE      TO DL-DIFF-QTY.               02750011
028000     MOVE AP080-RCV-COST-AMT        TO DL-RCV-COST.               02800011
028100     MOVE AP080-INV-COST-AMT        TO DL-INVC-COST.              02810011
028400     MOVE AP080-COST-DIFFERENCE     TO DL-DIFF-COST.              02840011
028410                                                                  02841011
028500     PERFORM W100-PRINT-DETAIL-LINE.                              02850011
029200                                                                  02920001
029300     PERFORM R100-READ-IMPORT-PO-FILE.                            02930001
029400 EJECT                                                            02940001
029500                                                                  02950001
029600                                                                  02960001
029700*----------------------------------------------------------------*02970001
029800* PERFORMS END OF PROGRAM PROCESSES.                             *02980001
029900*----------------------------------------------------------------*02990001
030000 B300-END-OF-PROGRAM.                                             03000001
030100                                                                  03010001
030500     IF PV-LINE-COUNT > PC-MAX-LINES                              03050001
030600         PERFORM W200-PRINT-HEADERS                               03060001
030700     END-IF.                                                      03070001
030800                                                                  03080001
030900     WRITE SUMMARY-RPT-REC FROM DL-END-OF-REPORT AFTER 3.         03090007
031000                                                                  03100001
031100     DISPLAY 'PROGRAM APKRP182 COMPLETE'.                         03110001
031200                                                                  03120001
031210     CLOSE IMPORT-PO-FILE                                         03121004
031220           SUMMARY-RPT-FILE.                                      03122004
031230                                                                  03123004
031300 EJECT                                                            03130001
031400*----------------------------------------------------------------*03140001
031500*    READS THE SORTED CLASS DISTRIBUTION ERROR LINES FILE.       *03150001
031600*----------------------------------------------------------------*03160001
031700 R100-READ-IMPORT-PO-FILE.                                        03170001
031800                                                                  03180001
031900     MOVE 'R100-READ-IMPORT-PO-FILE' TO PV-CURRENT-PARAGRAPH.     03190001
032000                                                                  03200001
032100     READ IMPORT-PO-FILE INTO AP080-IMPORT-EXCEPT-RPT-RECORD      03210011
032200        AT END SET END-OF-IMPORT-FILE TO TRUE.                    03220001
032300 EJECT                                                            03230001
032400 W100-PRINT-DETAIL-LINE.                                          03240001
032500                                                                  03250001
032600     MOVE 'W100-PRINT-DETAIL-LINE'    TO PV-CURRENT-PARAGRAPH.    03260001
032700                                                                  03270001
032800     IF PV-LINE-COUNT > PC-MAX-LINES                              03280001
032900         PERFORM W200-PRINT-HEADERS                               03290001
033000     ELSE                                                         03300001
033100         IF DL-VENDOR-NAME = SAVE-VENDOR-NAME                     03310001
033200            MOVE SPACES TO DL-VENDOR-NAME                         03320001
033300         ELSE                                                     03330001
033400            MOVE DL-VENDOR-NAME TO SAVE-VENDOR-NAME               03340001
033500         END-IF                                                   03350001
033600     END-IF.                                                      03360001
033700                                                                  03370001
033800     WRITE SUMMARY-RPT-REC FROM DETAIL-LINE AFTER 1.              03380001
033900     ADD +1 TO PV-LINE-COUNT.                                     03390001
034000                                                                  03400001
034100 EJECT                                                            03410001
034200*----------------------------------------------------------------*03420001
034300*    PRINTS HEADERS FOR THE EXCEPTION REPORT.                    *03430001
034400*    CALLED FROM B100-INITIALIZE                                 *03440001
034500*                W100-PRINT-EXCEPTION                            *03450001
034600*----------------------------------------------------------------*03460001
034700 W200-PRINT-HEADERS.                                              03470001
034800                                                                  03480001
034900     MOVE 'W200-PRINT-HEADERS' TO PV-CURRENT-PARAGRAPH.           03490001
035000                                                                  03500001
035100     ADD 1              TO PV-PAGE-COUNT.                         03510001
035200     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    03520001
035300     MOVE 1             TO DP132O-REPORT-NUMBER.                  03530001
035400                                                                  03540001
035500     WRITE SUMMARY-RPT-REC                                        03550001
035600           FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE.        03560001
035700                                                                  03570001
035800     WRITE SUMMARY-RPT-REC FROM H2-HEADER2 AFTER 1.               03580001
035900                                                                  03590001
036000     WRITE SUMMARY-RPT-REC FROM DH-DETAIL-HEADER1 AFTER 2.        03600001
036100     WRITE SUMMARY-RPT-REC FROM DH-DETAIL-HEADER2 AFTER 1.        03610001
036200     INITIALIZE SUMMARY-RPT-REC.                                  03620001
036300     WRITE SUMMARY-RPT-REC AFTER 1.                               03630001
036400                                                                  03640001
036500     MOVE 6                           TO PV-LINE-COUNT.           03650001
