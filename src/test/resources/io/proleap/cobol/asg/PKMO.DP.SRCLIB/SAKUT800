000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SAKUT800.                                00050000
000600 AUTHOR.                 KOHLS DEPARTMENT STORES.                 00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            MAY 2002.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
ZX    ******************************************************************00101500
ZX    ****** THIS PROGRAM IS A MODIFIED COPY OF SAKUT023 FOR THE *******00101600
ZX    ****** PURPOSE OF GENERATING SPECIAL 'SAK' MARKUP/MARKDOWN *******00101700
ZX    ****** REPORTS IN QA.                                      *******00101800
ZX    ******                                                     *******00101900
ZX    ****** IN PRODUCTION SAKUT023 RUNS AT THE COMPANY LEVEL AND ******00102000
ZX    ****** GENERATES ONE KOHL'S WIDE MARKUP/MARKDOWN REPORT.   *******00102100
ZX    ****** THIS VERSION OF THE PROGRAM ALLOWS THIS REPORT TO   *******00102200
ZX    ****** BE GENERATED AT A MORE GRANULAR LEVEL WHILE ALSO    *******00102300
ZX    ****** PRODUCING SOME ADDITIONAL FILES THAT CAN ASSIST     *******00102400
ZX    ****** WITH VALIDATIONS. THIS PROGRAM WILL ALSO GENERATE   *******00102500
ZX    ****** THE ML AND DOWNSTREAM MARK FILES AT THE LEVEL       *******00102600
ZX    ****** REQUESTED IN THE INPUT FILE.                        *******00102700
ZX    ******                                                     *******00102800
ZX    ****** THIS PROGRAM WORKS IN CONJUNCTION WITH SAKUT801     *******00102900
ZX    ****** IN ORDER TO GENERATE ONE SKU LEVEL REPORT           *******00103000
ZX    ****** FOR EACH TRANSACTION THAT GETS PICKED UP BY THIS    *******00103100
ZX    ****** PROGRAM.  WHICH TRANACTIONS ARE PICKED UP IS        *******00103200
ZX    ****** CONTROLLED VIA THE INPUT CONTROL CARD WHICH IS USED *******00103300
ZX    ****** TO SPECIFY A STORE/REGISTER/TRANSACTION NUMBER RANGE*******00103400
ZX    ****** TO BE PROCESSED.  LEAVE ANY OF THE ABOVE AS 0000 IN *******00103500
ZX    ****** THE CONTROL CARD IN ORDER TO PROCESS ALL FOR THAT   *******00103600
ZX    ****** ATTRIBUTE. SEE EXAMPLE EXPLANATION BELOW.           *******00103700
ZX    ****** A SINGLE DATE MUST BE SPECIFIED.                    *******00103800
ZX    ****** THIS PROGRAM ADDS TWO NEW SPECIALIZED OUTPUTS.      *******00103900
ZX    ******                                                     *******00104000
ZX    ****** 1) CRITERIA FILE - CONTAINS THE PARTITION, STORE,   *******00104100
ZX    ****** REGISTER, TRANSACTION NBR, AND SKU FOR EVERY        *******00104200
ZX    ****** TRANSACTION THAT GOT PROCESSED BY THIS PROGRAM.     *******00104300
ZX    ****** THE CRITERIA FILE ONLY EXISTS TO BE FED INTO THE    *******00104400
ZX    ****** BULK SAK REPORT GENERATION PROGRAM (SAKUT801) AS    *******00104500
ZX    ****** INPUT. THAT PROGRAM WILL PROCESS ONE REPORT FOR EACH*******00104600
ZX    ****** ENTRY IN THE FILE. A SORT UNIQUE SHOULD BE APPLIED  *******00104700
ZX    ****** BEFORE BEING FED INTO SAKUT801 OTHERWISE IT WILL    *******00104800
ZX    ****** GENERATE TWO IDENTICAL REPORTS IF A TRANSACTION HAS *******00104900
ZX    ****** THE SAME SKU ON IT TWICE AND BOTH REPORT WILL       *******00105000
ZX    ****** INCLUDE THE TOTALS FOR BOTH SKUS.                   *******00105100
ZX    ******                                                     *******00105200
ZX    ****** EXAMPLE:9911 0003 0000 WILL PROCESS ALL TRANSACTIONS*******00105300
ZX    ****** FOR STORE 9911 REGISTER 3.                          *******00105400
ZX    ****** TRANSACTIONS FOR STORE 9911 REGISTER 3.             *******00105500
ZX    ****** EXAMPLE:9911 0000 0000 WILL PROCESS ALL TRANSACTIONS*******00105600
ZX    ****** FOR STORE 9911 FOR ALL REGISTERS.                   *******00105700
ZX    ******                                                     *******00105800
ZX    ****** 2) TRANSACTION CSV FILE - THIS IS A CSV FILE THAT   *******00105900
ZX    ****** CONTAINS ALL OF THE RELEVANT ATTRIBUTES FOR EACH    *******00106000
ZX    ****** AND EVERY MARK THAT THE PROGRAM RECORDED. THIS      *******00106100
ZX    ****** FILE CAN BE FTP'D TO A PC AND OPENED IN EXCEL AND   *******00106200
ZX    ****** USED TO DETERMINE ALL OF THE MARKS THAT WENT INTO   *******00106300
ZX    ****** A GIVEN CATEGORY'S TOTALS.                          *******00106400
ZX    ******                                                     *******00106500
ZX    ****** EXAMPLE: THE MARKUP/MARKDOWN REPORT GENERATED FOR   *******00106600
ZX    ****** STORE 9911 REGISTER 3 SHOWS A TOTAL OF $150 OF      *******00106700
ZX    ****** PROMOTIONAL MARKDOWNS. THE SPREADSHEET WILL SHOW    *******00106800
ZX    ****** THE STORE/REG/TRANS/SKU/MARKDOWN TO PROMOTIONAL     *******00106900
ZX    ****** BROKEN DOWN INTO 3 DIFFERENT ROWS FOR $20, $90, AND *******00107000
ZX    ****** $40.                                                *******00107100
ZX    ******                                                     *******00107200
ZX    ****** 3) THIS VERSION OF SAKUT023 WILL GENERATE A         *******00107300
ZX    ****** MARKUP/MARKDOWN REPORT AT THE LEVEL REQUESTED IN    *******00107400
ZX    ****** THE INPUT CONTROL CARD. THIS MEANS THAT IF THE      *******00107500
ZX    ****** INPUT CONTROL CARD REQUESTS ALL TRANSACTIONS FOR    *******00107600
ZX    ****** STORE 9911 REGISTER 3, THEN THE REPORT GENERATED    *******00107700
ZX    ****** WOULD BE THE TOTALS FOR STORE 9911 REGISTER 3.      *******00107800
ZX    ******                                                     *******00107900
ZX    ****** IN PRODUCTION SAKUT023 RUNS AT THE COMPANY LEVEL AND ******00108000
ZX    ****** GENERATES ONE KOHL'S WIDE MARKUP/MARKDOWN REPORT.   *******00108100
ZX    ****** THIS VERSION OF THE PROGRAM ALLOWS THIS REPORT TO   *******00108200
ZX    ****** BE GENERATED AT A MORE GRANULAR LEVEL WHILE ALSO    *******00108300
ZX    ****** PRODUCING SOME ADDITIONAL FILES THAT CAN ASSIST     *******00108400
ZX    ****** WITH VALIDATIONS. THIS PROGRAM WILL ALSO GENERATE   *******00108500
ZX    ****** THE ML AND DOWNSTREAM MARK FILES AT THE LEVEL       *******00108600
ZX    ****** REQUESTED IN THE INPUT FILE.                        *******00108700
ZX    ******************************************************************00108800
ZX    ****** PT-710-NORCPT-MDC-QTY   ***********************************00108900
ZX    ****** PT-710-NORCPT-MKDN-QTY  ***********************************00109000
ZX    ****** PT-PROMOTIONAL-MDC-QTY  ***********************************00109100
ZX    ****** PT-TIERED-MDC-QTY       ***********************************00109200
ZX    ****** PT-GOLDSTAR-MDC-QTY     ***********************************00109300
ZX    ****** PT-MANUAL-LID-MDC-QTY   ***********************************00109400
ZX    ****** PT-OWNERSHIP-ADJ-MDC-QTY **********************************00109500
ZX    ****** PT-OWN-RETRN-ADJ-MDC-QTY **********************************00109600
ZX    ****** PT-SENIOR-CITIZEN-MDC-QTY *********************************00109700
ZX    ****** PT-KOHLS-COUPON-MDC-QTY ***********************************00109800
ZX    ****** PT-760-OFFER-MDC-QTY    ***********************************00109900
ZX    ****** PT-761-TLDTIER-MDC-QTY  ***********************************00110000
ZX    ****** PT-762-LIDTIER-MDC-QTY  ***********************************00110100
ZX    ****** PT-763-GWPPWP-MDC-QTY   ***********************************00110200
ZX    ****** PT-BOGO-MDC-QTY         ***********************************00110300
ZX    ****** PT-UNEARNED-RWDS-MDC-QTY **********************************00110400
ZX    ****** PT-EMPLY-DISC-MDC-QTY   ***********************************00110500
ZX    ****** PT-765-GIFT-MKDN-AMT    ***********************************00110600
001100******************************************************************00111000
001200*  THIS PROGRAM CREATES NINE MARKDOWN/MARKUP FILES AND ONE        00120000
001300*  MERCHANDISE LEDGER MARKDOWN/MARKUP TRANSACTION REPORT. THIS    00130000
001400*  PROGRAM SOURCE FROM THE COSA DATABASE.                         00140000
001500******************************************************************00150000
001600*  CHANGES MADE:                                                  00160000
001700*     BY JIM HUNTER      03/25/2008          WR: 33714            00170000
001800*     EXCLUDE THIRD PARTY CARD SALES (DEPARTMENTS 833 AND 834)    00180000
001900******************************************************************00190000
002000*  CHANGES MADE:                                                  00200000
002100*     BY STEVEN NOWAK    04/15/2008          WR: 33714            00210000
002200*     DUE TO QUANTITY EXTEND CHANGES IN THE NEWEST RELEASE, NEED  00220000
002300*     TO RING EACH ITEM SEPERATLY, COMMENT OUT PARA 7900- WHICH   00230000
002400*     IS CAUSING NO MATCHES DUE TO 'PENNY' DIFFERENCES            00240000
002500******************************************************************00250000
002600*  CHANGES MADE:                                                  00260000
002700*     BY STEVEN NOWAK    06/02/2008          IR: 381721           00270000
002800*     SALES CORRECTIONS ARE NOT TAKING MARK DOWNS WHEN PROCESSED  00280000
002900******************************************************************00290000
003000*  CHANGES MADE:                                                  00300000
003100*     BY STEVEN NOWAK    06/25/2008          IR: 416561           00310000
003200*     SEND SALES CORRECTIONS TO MERCHANDISE LEDGER                00320000
003300******************************************************************00330000
003400* DATE: 10/14/2008                           WR 34938             00340000
003500*   BY:JOANNE PIETROSKE (REFER TO 'SP0906' FOR ALL CHANGES)       00350000
003600*   ADD REPORT LINES FOR EACH OF THE 4 NEW LID REASON CODES       00360000
003700******************************************************************00370000
003800*  CHANGES MADE:                                                  00380000
003900*     BY CHERI PARMLEY  02/18/2011           WR: 39586            00390000
004000*     ADD NEW FILE FOR DATA WAREHOUSE WHEN MW MARKDOWNS/MARKDOWN  00400000
004100*     CUTOFF/MARKUPS/MARKUP CUTOFF ARE WRITTEN TO. DD'S FOR       00410000
004200*     OUT03,04,07,08. ITS A COPY OF THE MLRD017 FILE WITH 3       00420000
004300*     ADDITIONAL FIELDS AND THE UNPACKING OF ALL COMP FIELDS.     00430000
004400******************************************************************00440000
004500*  CHANGES MADE:                                                  00450000
004600*     BY CHERI PARMLEY  03/15/2011           WR: 39586            00460000
004700*     ADD YEAR TO END OF FILE FOR PART OF THE ML044-PC-DTE        00470000
004800******************************************************************00480000
004900* CHANGED: 01/26/2012                                            *00490000
005000* BY:      ROB SWAGER                                            *00500000
005100* FOR:     WR24719                                               *00510000
005200* WHY:     EXPANDED SIZE OF PV-PC-OLD-PR-AMT FIELD AND           *00520000
005300*          PV-PC-NEW-PR-AMT FIELD AND                            *00530000
005400*          PV-PC-DIFFER-AMT FIELD FOR LARGE                      *00540000
005500*         RETAIL ITEMS PART OF KOHLS CASH PROJECT.               *00550000
005600******************************************************************00560000
005700*  CHANGES MADE:                                                  00570000
005800*     BY DAN PAYNTER    05/24/2012           WR: 35157            00580000
005900*     ADD ABILITY TO CALCULATE MARKDOWN CANCEL ON ECOMMERCE       00590000
006000*     TRANSACTIONS WHERE THE PRICE MOVED BETWEEN THE TIME OF      00600000
006100*     THE ORDER BEING PLACED TO THE TIME OF THE ORDER BEING       00610000
006200*     SHIPPED.  ELIMINATED CHECKS FOR POS-CAP-LVL < 11 BECAUSE    00620000
006300*     THE POS-CAP-LVL WILL ALWAYS BE GREATER THAN 11.             00630000
006400******************************************************************00640000
006500*  CHANGES MADE:                                                  00650000
006600*     BY COGNIZANT      07/20/2012           PKE000000011018      00660000
006700*     ADD COMMIT STATEMENTS TO 2200- AND 6100- PARA TO            00670000
006800*     HANDLE DBKR0127 FAILURE DUE TO CONTENTION WITH JOB SAK007   00680000
006900******************************************************************00690000
007000*  CHANGES MADE:                                                  00700000
007100*     BY JIM ARENDT     08/06/2012           WR39372              00710000
007200*     MOVED DISCOUNT CODE 765.                                    00720000
007300******************************************************************00730000
P8612 *  CHANGES MADE:                                                  00731000
P8612 *     BY COGNIZANT      09/02/2014           CHG0092405           00732000
P8612 *     EXCULDE NEW MARKET PLACE DEPARTMENT '070'                   00733000
P8612 ******************************************************************00735000
011618*  CHANGES MADE:                                                  00735100
011618*     BY DAN PAYNTER    01/16/2018           CHG0187382           00735200
011618*     FIX BUGS FOR RETURNS: MDC FOR PROMOTIONS, MD FOR MAN LID    00735300
011618*     FROM A PRICE CORRECTION, AND MDC FOR ADDTL PROMO (TIERED)   00735400
011618******************************************************************00735500
062118*  CHANGES MADE:                                                  00735600
062118*     BY DAN PAYNTER    06/21/2018           CHG0201651           00735700
062118*     BY DAN PAYNTER    06/29/2018           CHG0201651           00735800
062118*     PROCESS POC PRICE ADJ/PSA ITEMS THROUGH THE SAME NEW CODE   00735900
062118*     THAT WAS ADDED FOR POC RETURNS ITEMS EARLIER IN THE YEAR.   00736000
062118*     RESOLVE INCIDENT IN WHICH RETURN OWN ADJ WAS INCORRECTLY    00736100
062118*     BEING RECORDED AS A MARKUP CANCEL. THIS IS A SHORT TERM FIX 00736200
062118*     THAT WILL RESULT IN THE PROMOTIONAL MDC BEING ROLLED INTO   00736300
062118*     THE RETURN OWNERSHIP ADJUSTMENT.                            00736400
062118*     FIX MINOR ISSUE WITH TIERED PROMO ON PSA/PA ITEMS FROM POC. 00736500
062918*     RESOLVED ISSUE WITH PRICE MOVEMENT ON POC RETURNS           00736600
062918*     ON WHICH THE PRICE WAS LOWER AT THE TIME OF SALE THAN AT    00736700
062918*     THE TIME OF THE RETURN                                      00736800
072618******************************************************************00736900
072618*  CHANGES MADE:                                                  00737000
072618*     BY DAN PAYNTER    07/26/2018           CHG0203936           00737100
072618*     PROPERLY REPORT OLD AND NEW PRICES ON OWNERSHIP RETURN ADJ  00737200
072618*     FOR POC RETURNS, PA, AND PSA TRANSACTIONS ON ML OUTPUT FILE.00737300
072618******************************************************************00737400
205464*  CHANGES MADE:                                                  00737500
205464*     BY JIM ARENDT     08/16/2018           CHG0205464           00737600
205464*     ADDED DISCOUNT CODE 710.                                    00737700
007300******************************************************************00737800
214615*  CHANGES MADE:                                                  00737900
214615*     BY JIM ARENDT     01/15/2019           CHG0214615           00738000
214615*     CHANGED PROGRAM TO READ TWO NEW FIELDS FROM TEPITM          00738100
214615*     (ORIG_SAL_TYP_CDE AND ORIG_REG_RTL_AMT) AND PROCESS THEM.   00738200
007300******************************************************************00738300
221940*  CHANGES MADE:                                                  00738400
221940*     BY DAN PAYNTER    04/16/2019           CHG0221940           00738500
221940*     BACKOUT THE PRICE CHANGE MOVEMENT CHANGE FOR POC BY         00738600
221940*     RESTORING THE PREVIOUS PRODUCTION VERSION OF THE CODE       00738700
007300******************************************************************00738800
226892*  CHANGES MADE:                                                  00738900
226892*     BY JIM ARENDT     06/13/2019           CHG0226892           00739000
226892*     ADDING CHG0214615 BACK IN ALONG WITH A FIX SO THE ML SYSTEM 00739100
226892*     WILL PROCESS MARKDOWN CANCELS CORRECTLY.                    00739200
040220******************************************************************00739300
040220*  CHANGES MADE:                                                  00739400
040220*     BY DAN PAYNTER    04/02/2020           CHG0242320           00739500
040220*     FIX IMBALANCES BETWEEN PEK AND SAK REPORT BY ENSURING THAT  00739600
040220*     MD WILL BE COUNTED AS MD'S AND MDC WILL BE COUNTED AS MDC'S 00739700
040220*     IN ML                                                       00739800
007300******************************************************************00739900
ZX    *  CHANGES MADE:                                                  00740500
ZX    *     BY DAN PAYNTER    01/24/2018           WR: XXXXX            00740600
ZX    *     CREATE CSV AUDIT FILE OF WHICH DAY 2 TRANSACTIONS HIT       00740700
ZX    *     WHICH BUCKET AND FOR WHAT AMOUNT.                           00740800
ZX    ******************************************************************00740900
ZXC   *  CHANGES MADE:                                                  00741000
ZXC   *     BY DAN PAYNTER    04/01/2019           WR: XXXXX            00741100
ZXC   *     CHANGES TO ADD CRITERIA FILE WHICH CAN BE READ IN BY        00741200
ZXC   *     THE BULK SAK REPORT PROGRAM SO THAT INDIVUDAL SKU LEVEL     00741300
ZXC   *     SAK REPORTS CAN BE GENERATED FOR THE ML TEAM TO VALIDATE    00741400
ZXC   *     THE SEVA TEST CASES AGAINST. (SAKUT801 = BULK SAK REPORT)   00741500
ZXC   *     ANY CHANGES MADE TO PRODUCTION VERSION OF THIS PROGRAM      00741600
ZXC   *     ALSO NEED TO BE MADE TO THIS VERSION TKMA.FSH(SAKUT800)     00741700
ZXC   *     AND THE BULK SAK VERSION TKMA.FSH(SAKUT801) WHILE KEEPING   00741800
ZXC   *     INTACT THE SPECIALLY ADDED CODE FOR THE CRITERIA FILE, CSV  00741900
ZXC   *     FILE, AND THE BULK SAK REPORTING. CONTACT DAN PAYNTER       00742000
ZXC   *     OR JIM HUNTER REGARDING ANY POTENTIAL CHANGES TO THESE      00742100
ZXC   *     PROGRAMS PRIOR TO MAKING CHANGES.                           00742200
ZXC   ******************************************************************00742300
MKTPLC*  CHANGES MADE:                                                  00742409
MKTPLC*     BY JIM HUNTER     06/02/2020           CHG0246098           00742509
MKTPLC*     REPLACE WAYFAIR DEPT 070 CHECK WITH MARKETPLACE DEPT 985    00742609
MKTPLC*     CHECK TO PREVENT MARKETPLACE ITEMS FROM GOING TO ML.        00742709
MKTPLC******************************************************************00742809
BOSSCL*   09/21/2020 - JIM HUNTER  BOSS CLEARANCE   CHG0249017          00743712
BOSSCL* THIS CHANGE WILL CONTAIN A FIX FOR EXISTING PRODUCTION ORDERS,  00743810
BOSSCL* AS WELL AS BOSS CLEARANCE ORDERS WHEN THEY ARE ENABLED:         00743910
BOSSCL*   IF THE STORE PRICE CHANGED AFTER THE ECOM ORDER DATE          00744010
BOSSCL*     GET THE STORE'S ACTIVE PRICE ON THE ECOM ORDER DATE         00744110
BOSSCL*     AND THE STORE SALE DATE.   IF THERE IS A DIFFERENCE,        00744210
BOSSCL*     CALCULATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE.       00744310
BOSSCL*     NEED TSKXREF AND TPPCPRC TABLES.                            00744410
BOSSCL*   IF THE STORE PRICE DIDN'T CHANGE,                             00744510
BOSSCL*     DO NOT CREATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE    00744610
BOSSCL*     BETWEEN THE ECOM AND STORE PRICES.  THE TRANSFER PRICE      00744710
BOSSCL*     FROM ECOM TO THE STORE WILL BE OFFSET BY THE PRICE THE      00744810
BOSSCL*     CUSTOMER PAYS TO THE STORE.                                 00744910
BOSSCL******************************************************************00745010
BOSSC2*   10/30/2020 - JIM HUNTER  BOSS CLEARANCE   CHG0246551          00745114
BOSSC2* THIS CHANGE IS FIX 2 OF 3 FOR CALCULATING OWNERSHIP ADJUSTMENTS 00745214
BOSSC2* FOR BOSS, SFS AND BOPUS ORDERS.  THIS SHOULD BE THE FINAL CHANGE00745314
BOSSC2* FOR SFS AND BOPUS ORDERS.  IT ALSO CONTAINS CHANGES FOR BOSS    00745414
BOSSC2* ORDERS WHICH WILL REQUIRE A FUTURE CHANGE TO GET TRANSFER       00745514
BOSSC2* INFORMATION.                                                    00745614
BOSSC2******************************************************************00745816
BOSSC3*   11/04/2020 - JIM HUNTER  BOSS CLEARANCE      CHG0252661       00745926
BOSSC3* THIS CHANGE IS FIX 3 OF 3 FOR CALCULATING OWNERSHIP ADJUSTMENTS 00746016
BOSSC3* FOR BOSS ORDERS.  IT WILL READ THE NEW SAT_BOSS_TRANSFERS TABLE 00746116
BOSSC3* TO GET THE TRANSFER DATE AND PRICE, WHICH IS REQUIRED WHEN      00746216
BOSSC3* CALCULATING BOSS OWNERSHIP ADJUSTMENTS.                         00746316
BOSSC3* ALSO, USE THE POS DATE TO LOOK UP THE PARTITION NUMBER IN       00746420
BOSSC3* PARA 1150- SO THAT THE PERSON SUBMITTING THIS JOB DOESN'T       00746520
BOSSC3* HAVE TO LOOK IT UP AND ENTER IT.                                00746620
BOSSC3******************************************************************00746720
MUCFIX*   12/18/2020 - JIM HUNTER  MARKUP CANCEL FIX   CHG0252661       00746926
MUCFIX* THIS IS A FIX TO MAKE SURE THAT MARKDOWN CANCEL AMOUNTS ARE     00747025
MUCFIX* POSITIVE.                                                       00747125
MUCFIX******************************************************************00747225
262807*   10/19/2021 - JIM HUNTER  SEPHORA DISCOUNTS   CHG0262807       00747331
262807* THIS CHANGE ADDS SEPHORA DISCOUNTS TO THE MU / MD REPORT.       00747431
262807* ALSO, THE 4 OBSOLETE MW FILES HAVE BEEN REMOVED:                00747631
262807* DATAWHSE-MARKDOWN-FILE                                          00747731
262807* DATAWHSE-MARKUP-FILE                                            00747831
262807* HOLD-DATAWHSE-MARKDOWN-FILE                                     00747931
262807* HOLD-DATAWHSE-MARKUP-FILE                                       00748031
262807******************************************************************00748131
SEPHOR*   03/16/2022 - JIM HUNTER  SEPHORA GIFT CARDS  CHG0??????       00748233
SEPHOR* THIS CHANGE PREVENTS SEPHORA GIFT CARDS FROM GOING TO THE       00748332
SEPHOR* MU / MD REPORT OR ML OUTPUT FILES.                              00748432
SEPHOR******************************************************************00748932
007400                                                                  00749000
007500 ENVIRONMENT DIVISION.                                            00750000
007600 CONFIGURATION SECTION.                                           00760000
007700                                                                  00770000
007800 SOURCE-COMPUTER.        IBM-3090.                                00780000
007900 OBJECT-COMPUTER.        IBM-3090.                                00790000
008000                                                                  00800000
008100 INPUT-OUTPUT SECTION.                                            00810000
008200 FILE-CONTROL.                                                    00820000
008300                                                                  00830000
008400     SELECT POS-DATE-FILE                                         00840000
008500         ASSIGN TO INP01.                                         00850000
008600                                                                  00860000
008700     SELECT LEDGER-MARKDOWN-FILE                                  00870000
008800         ASSIGN TO OUT01.                                         00880000
008900                                                                  00890000
009000     SELECT LEDGER-MARKUP-FILE                                    00900000
009100         ASSIGN TO OUT02.                                         00910000
009200                                                                  00920000
009900     SELECT HOLD-LEDGER-MARKDOWN-FILE                             00990000
010000         ASSIGN TO OUT05.                                         01000000
010100                                                                  01010000
010200     SELECT HOLD-LEDGER-MARKUP-FILE                               01020000
010300         ASSIGN TO OUT06.                                         01030000
010400                                                                  01040000
011100     SELECT DATAWHSE-FILE                                         01110000
011200         ASSIGN TO OUT09.                                         01120000
011300                                                                  01130000
011400     SELECT MERCH-LEDGER-REPORT                                   01140000
011500         ASSIGN TO RPT01.                                         01150000
011600                                                                  01160000
ZX         SELECT DAY02-TRANS-REPORT                                    01161000
ZX             ASSIGN TO OUT10.                                         01162000
ZX                                                                      01163000
ZXC        SELECT CRITE-TRANS-REPORT                                    01164000
ZXC            ASSIGN TO OUT11.                                         01165000
ZXC                                                                     01166000
011700 DATA DIVISION.                                                   01170000
011800 FILE SECTION.                                                    01180000
011900                                                                  01190000
012000 FD POS-DATE-FILE                                                 01200000
012100     RECORDING MODE IS F                                          01210000
012200     LABEL RECORDS ARE STANDARD                                   01220000
012300     RECORD CONTAINS 80 CHARACTERS                                01230000
012400     BLOCK CONTAINS 0 RECORDS                                     01240000
012500     DATA RECORD IS POS-DATE-RECORD.                              01250000
012600                                                                  01260000
012700 01 POS-DATE-RECORD              PIC  X(80).                      01270000
012800                                                                  01280000
012900 FD  LEDGER-MARKDOWN-FILE                                         01290000
013000     RECORDING MODE IS F                                          01300000
013100     LABEL RECORDS ARE STANDARD                                   01310000
013200     BLOCK CONTAINS 0 RECORDS                                     01320000
013300     RECORD CONTAINS 200 CHARACTERS                               01330000
013400     DATA RECORD IS LM-LEDGER-MARKDOWN-RECORD.                    01340000
013500                                                                  01350000
013600 01  LM-LEDGER-MARKDOWN-RECORD   PIC  X(200).                     01360000
013700                                                                  01370000
013800 FD  LEDGER-MARKUP-FILE                                           01380000
013900     RECORDING MODE IS F                                          01390000
014000     LABEL RECORDS ARE STANDARD                                   01400000
014100     BLOCK CONTAINS 0 RECORDS                                     01410000
014200     RECORD CONTAINS 200 CHARACTERS                               01420000
014300     DATA RECORD IS LM-LEDGER-MARKUP-RECORD.                      01430000
014400                                                                  01440000
014500 01  LM-LEDGER-MARKUP-RECORD     PIC  X(200).                     01450000
014600                                                                  01460000
016500 FD  HOLD-LEDGER-MARKDOWN-FILE                                    01650000
016600     RECORDING MODE IS F                                          01660000
016700     LABEL RECORDS ARE STANDARD                                   01670000
016800     BLOCK CONTAINS 0 RECORDS                                     01680000
016900     RECORD CONTAINS 200 CHARACTERS                               01690000
017000     DATA RECORD IS HOLD-LEDGER-MARKDOWN-RECORD.                  01700000
017100                                                                  01710000
017200 01  HOLD-LEDGER-MARKDOWN-RECORD PIC  X(200).                     01720000
017300                                                                  01730000
017400 FD  HOLD-LEDGER-MARKUP-FILE                                      01740000
017500     RECORDING MODE IS F                                          01750000
017600     LABEL RECORDS ARE STANDARD                                   01760000
017700     BLOCK CONTAINS 0 RECORDS                                     01770000
017800     RECORD CONTAINS 200 CHARACTERS                               01780000
017900     DATA RECORD IS HOLD-LEDGER-MARKUP-RECORD.                    01790000
018000                                                                  01800000
018100 01  HOLD-LEDGER-MARKUP-RECORD     PIC  X(200).                   01810000
018200                                                                  01820000
020100 FD  DATAWHSE-FILE                                                02010000
020200     RECORDING MODE IS F                                          02020000
020300     LABEL RECORDS ARE STANDARD                                   02030000
020400     BLOCK CONTAINS 0 RECORDS                                     02040000
020500     RECORD CONTAINS 200 CHARACTERS                               02050000
020600     DATA RECORD IS DATAWHSE-RECORD.                              02060000
020700                                                                  02070000
020800 01  DATAWHSE-RECORD             PIC  X(200).                     02080000
020900                                                                  02090000
ZX     FD  DAY02-TRANS-REPORT                                           02091000
ZX         RECORDING MODE IS F                                          02092000
ZX         LABEL RECORDS ARE STANDARD                                   02093000
ZX         BLOCK CONTAINS 0 RECORDS                                     02094000
ZX         RECORD CONTAINS 300 CHARACTERS                               02095000
ZX         DATA RECORD IS DAY02-TRANS-RECORD.                           02096000
ZX                                                                      02097000
ZX     01  DAY02-TRANS-RECORD          PIC  X(300).                     02097100
                                                                        02097200
ZXC    FD  CRITE-TRANS-REPORT                                           02097300
ZXC        RECORDING MODE IS F                                          02097400
ZXC        LABEL RECORDS ARE STANDARD                                   02097500
ZXC        BLOCK CONTAINS 0 RECORDS                                     02097600
ZXC        RECORD CONTAINS 80 CHARACTERS                                02097700
ZXC        DATA RECORD IS CRITE-TRANS-RECORD.                           02097800
ZXC                                                                     02097900
ZXC    01  CRITE-TRANS-RECORD          PIC  X(80).                      02098000
                                                                        02099000
021000 FD  MERCH-LEDGER-REPORT                                          02100000
021100     RECORDING MODE IS F                                          02110000
021200     LABEL RECORDS ARE STANDARD                                   02120000
021300     BLOCK CONTAINS 0 RECORDS                                     02130000
021400     RECORD CONTAINS 132 CHARACTERS.                              02140000
021500                                                                  02150000
021600 01  REPORT-LINE-OUT             PIC  X(132).                     02160000
021700                                                                  02170000
021800 WORKING-STORAGE SECTION.                                         02180000
021900                                                                  02190000
022000*  PARAMETER LIST FOR THE CALENDAR ROUTINE                        02200000
022100                                                                  02210000
022200     COPY DPWS500.                                                02220000
022300                                                                  02230000
022400*  REPORT HEADER FOR A 132 COLUMN REPORT                          02240000
022500                                                                  02250000
022600     COPY DPWS132O.                                               02260000
022700                                                                  02270000
022800*  MERCHANDISE LEDGER PRICE CHANGE RECORD LAYOUT                  02280000
022900                                                                  02290000
023000     COPY MLRD017.                                                02300000
023100                                                                  02310000
023200* MERCHANDISE LEDGER PRICE CHANGE RECORD LAYOUT FOR DATA WAREHOUSE02320000
023300                                                                  02330000
023400     COPY MLRD044.                                                02340000
023500                                                                  02350000
023600 01  AC-ABEND-CODE               PIC S9(04) VALUE ZEROS.          02360000
023700     88  AC-CONTROL-CARD-ERROR              VALUE +4009.          02370000
023800     88  AC-CALENDAR-ERROR                  VALUE +4010.          02380000
023900     88  AC-DB2-ERROR                       VALUE +4013.          02390000
024000                                                                  02400000
024100 01  PV-SUBSCRIPTS.                                               02410000
024200     05  PV-TOT-SUB              PIC S9(04) VALUE ZERO.           02420000
024300                                                                  02430000
024400 01  PV-NULL-INDICATORS.                                          02440000
024500     05 PV-ORIG-OWND-UNT-AMT-NULL-IND PIC S9(4) COMP VALUE +0.    02450000
BOSSCL     05 PV-OMNI-CHNL-TYP-CDE-NULL-IND PIC S9(4) COMP VALUE +0.    02451001
024600                                                                  02460000
024700 01  PS-PROGRAM-SWITCHES.                                         02470000
024800     05  PS-END-OF-TRAN-IND      PIC  X(01) VALUE 'N'.            02480000
024900         88  PS-END-OF-TRAN-YES             VALUE 'Y'.            02490000
025000     05  PS-END-OF-DKEY-IND      PIC  X(01) VALUE 'N'.            02500000
025100         88  PS-END-OF-DKEY-YES             VALUE 'Y'.            02510000
025200     05  PS-END-OF-ITEM-IND      PIC  X(01) VALUE 'N'.            02520000
025300         88  PS-END-OF-ITEM-YES             VALUE 'Y'.            02530000
025400         88  PS-END-OF-ITEM-NO              VALUE 'N'.            02540000
025500     05  PS-END-OF-LID-IND       PIC  X(01) VALUE 'N'.            02550000
025600         88  PS-END-OF-LID-YES              VALUE 'Y'.            02560000
025700         88  PS-END-OF-LID-NO               VALUE 'N'.            02570000
025800     05  PS-TIERED-ITEM-IND      PIC  X(01) VALUE 'N'.            02580000
025900         88  PS-TIERED-ITEM-YES             VALUE 'Y'.            02590000
026000         88  PS-TIERED-ITEM-NO              VALUE 'N'.            02600000
ZX         05  PS-SKU-SPECIFIC-RUN-IND PIC  X(01) VALUE 'N'.            02601000
ZX             88  PS-SKU-SPECIFIC-RUN-Y          VALUE 'Y'.            02602000
ZX             88  PS-SKU-SPECIFIC-RUN-N          VALUE 'N'.            02603000
ZX         05  PS-ORDER-NUMBER-IND     PIC  X(01) VALUE 'N'.            02603100
ZX             88  PS-ORDER-NUMBER-FOUND-Y        VALUE 'Y'.            02603200
ZX             88  PS-ORDER-NUMBER-FOUND-N        VALUE 'N'.            02603300
ZX         05  PV-DISC-TYPE            PIC  X(01) VALUE 'L'.            02604000
ZX             88  PV-DISC-TYPE-GROUP             VALUE 'G'.            02605000
ZX             88  PV-DISC-TYPE-ASSOC             VALUE 'A'.            02606000
ZX             88  PV-DISC-TYPE-LID               VALUE 'L'.            02607000
026100     05  PS-END-OF-CARD-FILE-SW  PIC  X(01) VALUE 'N'.            02610000
026200         88  PS-END-OF-CARD-FILE            VALUE 'Y'.            02620000
026300                                                                  02630000
026400     05  PS-FIRST-READ-SW        PIC  X(01) VALUE 'N'.            02640000
026500         88  PS-FIRST-READ-YES              VALUE 'Y'.            02650000
026600         88  PS-FIRST-READ-NO               VALUE 'N'.            02660000
026700     05  PS-UNMTCHD-AMT-SW       PIC  X(01) VALUE 'N'.            02670000
026800         88  PS-UNMTCHD-AMT-YES             VALUE 'Y'.            02680000
026900         88  PS-UNMTCHD-AMT-NO              VALUE 'N'.            02690000
BOSSC2     05  PS-ECOM-PRICE-CHG-SW    PIC  X(01) VALUE 'N'.            02691013
BOSSC2         88  PS-ECOM-PRICE-CHANGE-YES       VALUE 'Y'.            02692013
BOSSC2         88  PS-ECOM-PRICE-CHANGE-NO        VALUE 'N'.            02693013
BOSSC2     05  PS-ECOM-PRICE-FOUND-SW PIC   X(01) VALUE 'N'.            02694013
BOSSC2         88  PS-ECOM-PRICE-FOUND            VALUE 'Y'.            02695013
BOSSC2         88  PS-ECOM-PRICE-NOT-FOUND        VALUE 'N'.            02696013
027000                                                                  02700000
027100                                                                  02710000
027200 01  PC-PROGRAM-CONSTANTS.                                        02720000
027300     05  PC-CURRENT-PROGRAM-NAME PIC  X(08) VALUE 'SAKUT800'.     02730000
027400     05  PC-YES                  PIC  X(01) VALUE 'Y'.            02740000
027500     05  PC-11                   PIC  9(02) VALUE 11.             02750000
027600     05  PC-ONE                  PIC  9(01) VALUE 1.              02760000
027700     05  PC-LINE-LIMIT           PIC  9(02) VALUE 60.             02770000
027800     05  PC-ROW-NOT-FOUND        PIC S9(03) VALUE +100.           02780000
ZX         05  PC-POC                  PIC S9(04) VALUE +200.           02780100
ZX         05  PC-MPOC                 PIC S9(04) VALUE +300.           02780300
027900     05  PC-NON-OWNED            PIC  X(01) VALUE 'N'.            02790000
028000     05  PC-NON-OWNED-TRACKED    PIC  X(01) VALUE 'T'.            02800000
028100     05  PC-GOLDSTAR-G           PIC  X(01) VALUE 'G'.            02810000
214615     05  PC-REGULAR-R            PIC  X(01) VALUE 'R'.            02810100
214615     05  PC-PROMO-P              PIC  X(01) VALUE 'P'.            02810200
214615     05  PC-CLEARANCE-C          PIC  X(01) VALUE 'C'.            02810300
214615     05  PC-UNKNOWN-N            PIC  X(01) VALUE 'N'.            02810400
028200     05  PC-RSLV-ORIGINAL        PIC  X(01) VALUE 'R'.            02820000
028300     05  PC-REVERSAL             PIC  X(01) VALUE 'R'.            02830000
028400     05  PC-RSLV-VOID            PIC  X(01) VALUE 'V'.            02840000
028500     05  PC-LATE                 PIC  X(01) VALUE 'L'.            02850000
028600     05  PC-CORRECTION           PIC  X(01) VALUE 'V'.            02860000
262807     05  PC-SEPHORA-720          PIC  X(03) VALUE '720'.          02861031
028700     05  PC-SENIOR-CIT-728       PIC  X(03) VALUE '728'.          02870000
028800     05  PC-KOHLS-CPON-733       PIC  X(03) VALUE '733'.          02880000
028900     05  PC-TRAN-LEVEL-734       PIC  X(03) VALUE '734'.          02890000
029000     05  PC-GOLDSTAR-753         PIC  X(03) VALUE '753'.          02900000
029100     05  PC-760-OFFER-COUPON     PIC  X(03) VALUE '760'.          02910000
029200     05  PC-761-OFFER-TLD-TIERED PIC  X(03) VALUE '761'.          02920000
029300     05  PC-762-OFFER-LID-TIERED PIC  X(03) VALUE '762'.          02930000
029400     05  PC-763-OFFER-GWP-PWP-PRORATED PIC  X(03) VALUE '763'.    02940000
029500     05  PC-ADDTL-PROMO-OFF-774  PIC  X(03) VALUE '774'.          02950000
029600     05  PC-BOGO-775             PIC  X(03) VALUE '775'.          02960000
029700     05  PC-BOGO-777             PIC  X(03) VALUE '777'.          02970000
029800     05  PC-UNEARNED-REWARDS-780 PIC  X(03) VALUE '780'.          02980000
029900     05  PC-OWN-RTN-ADJ-792      PIC  X(03) VALUE '792'.          02990000
030000     05  PC-OWN-ADJ-796          PIC  X(03) VALUE '796'.          03000000
030100     05  PC-GIFT-CARD            PIC  X(03) VALUE '983'.          03010000
SEPHOR     05  PC-SEPHORA-GIFT-CARD-712 PIC X(03) VALUE '712'.          03011032
030200     05  PC-THIRD-PARTY-CARD-833 PIC  X(03) VALUE '833'.          03020000
030300     05  PC-THIRD-PARTY-CARD-834 PIC  X(03) VALUE '834'.          03030000
MKTPLC     05  PC-MKTPLACE-DEPT-985    PIC  X(03) VALUE '985'.          03030109
P8612      05  PC-WAYFAIR-DEPT-070     PIC  X(03) VALUE '070'.          03031000
030400     05  PC-701-SIGNING-ERROR    PIC  X(03) VALUE '701'.          03040000
030500     05  PC-702-PLU-ERROR        PIC  X(03) VALUE '702'.          03050000
030600     05  PC-703-DAMAGED-MDSE     PIC  X(03) VALUE '703'.          03060000
030700     05  PC-704-KEYED-GWP        PIC  X(03) VALUE '704'.          03070000
030800     05  PC-705-INVALID-UPC-MKDN PIC  X(03) VALUE '705'.          03080000
030900     05  PC-706-RAINCHECK        PIC  X(03) VALUE '706'.          03090000
031000     05  PC-707-MEET-COMPETITION PIC  X(03) VALUE '707'.          03100000
031100     05  PC-708-SPECIAL-PRMTN    PIC  X(03) VALUE '708'.          03110000
031200     05  PC-709-YES-WE-CAN       PIC  X(03) VALUE '709'.          03120000
205464     05  PC-710-NON-RCPT-RTRN    PIC  X(03) VALUE '710'.          03120100
031300     05  PC-746-PLU-TIER         PIC  X(03) VALUE '746'.          03130000
031400     05  PC-790-EMPLY-DISCOUNT   PIC  X(03) VALUE '790'.          03140000
031500     05  PC-765-GFT-RCPT-RTRN    PIC  X(03) VALUE '765'.          03150000
031600     05  PC-NULL                 PIC S9(4) COMP VALUE -1.         03160000
031700                                                                  03170000
031800**>> DETAIL LINE CONSTANTS FOR REPORT                             03180000
031900     05  PC-PROMOTIONAL          PIC X(14) VALUE 'PROMOTIONAL   '.03190000
032000     05  PC-TIERED               PIC X(14) VALUE 'ADDTL PROMOTNS'.03200000
032100     05  PC-GOLDSTAR             PIC X(14) VALUE 'GOLDSTAR      '.03210000
032200     05  PC-MANUAL-LID           PIC X(14) VALUE 'MANUAL LID    '.03220000
032300     05  PC-OWNERSHIP-ADJ        PIC X(14) VALUE 'OWNERSHIP ADJ '.03230000
032400     05  PC-OWN-RETRN-ADJ        PIC X(14) VALUE 'OWN RETURN ADJ'.03240000
032500     05  PC-SENIOR-CITIZEN       PIC X(14) VALUE 'SENIOR CITIZEN'.03250000
032600     05  PC-KOHLS-COUPON         PIC X(14) VALUE 'KOHLS COUPON  '.03260000
032700     05  PC-OFFER-COUPON         PIC X(14) VALUE 'OFFER COUPON  '.03270000
032800     05  PC-OFFER-TLD-TIERED     PIC X(14) VALUE 'OFFER TLD TIER'.03280000
032900     05  PC-OFFER-LID-TIERED     PIC X(14) VALUE 'OFFER LID TIER'.03290000
033000     05  PC-OFFER-GWP-PWP        PIC X(14) VALUE 'OFFER GWP/PWP '.03300000
205464     05  PC-NON-REC-RETURN       PIC X(14) VALUE 'NON RCPT RTRN '.03300100
033100     05  PC-GIFT-RCPT-RETURN     PIC X(14) VALUE 'GIFT RCPT RTRN'.03310000
033200     05  PC-BOGO                 PIC X(14) VALUE 'EBOGO         '.03320000
033300     05  PC-UNEARNED-REWARDS     PIC X(14) VALUE 'UNEARNED RWDS'. 03330000
033400     05  PC-EMPLY-DISCOUNT       PIC X(14) VALUE 'EMPLY DISCOUNT'.03340000
262807     05  PC-SEPHORA-DISCOUNT     PIC X(14) VALUE 'SEPHORA DISCNT'.03341031
033500     05  PC-TOTAL                PIC X(14) VALUE 'TOTAL         '.03350000
033600                                                                  03360000
033700 01  PV-RUN-DATE-CCYY-MM-DD      PIC  X(10).                      03370000
033800                                                                  03380000
033900 01  PV-CUT-OFF-CCYY-MM-DD       PIC  X(10).                      03390000
032600                                                                  03391013
BOSSC2 01  PV-TRANSFER-DATE            PIC  X(10)   VALUE SPACES.       03392013
034000                                                                  03400000
ZX     01  WS-DAY02-HEADR-RECORD.                                       03401000
ZX         05  WS-HEADER-TEXT1             PIC X(52)                    03401100
ZX         VALUE 'TRN TYP,SLS DTE,DB2 PARTN,STORE,REG,TRAN#,ST TIME,SC'.03401200
ZX         05  WS-HEADER-TEXT2             PIC X(52)                    03401300
ZX         VALUE ' SEQNO,LI SEQNO,DEPT,SKU,LID RSN CDE,DISC AMT,MU/MD,'.03401400
ZX         05  WS-HEADER-TEXT3             PIC X(52)                    03401500
ZX         VALUE 'DISC TYPE,ORRA,RRA,STA,STC,OSTC,CCA,NCA,OOURA,LID AM'.03401600
ZX         05  WS-HEADER-TEXT4             PIC X(52)                    03401700
ZX         VALUE 'T,TRN DTE,ORD NBR,PRB IND,OLD PRC,NEW PRC, DIFF     '.03401800
ZX                                                                      03402200
ZXC    01  WS-CRITE-TRANS-RECORD.                                       03402300
ZXC            05  FILLER                  PIC  X(05)                   03402400
ZXC                                             VALUE 'PRT: '.          03402500
ZXC            05  WS-CRITE-PARTN-NBR      PIC  9(04)  VALUE ZEROS.     03402600
ZXC            05  FILLER                  PIC  X(02)  VALUE SPACES.    03402700
ZXC            05  FILLER                  PIC  X(05)                   03402800
ZXC                                             VALUE 'STR: '.          03402900
ZXC            05  WS-CRITE-STR-NBR        PIC  9(04)  VALUE ZEROS.     03403000
ZXC            05  FILLER                  PIC  X(02)  VALUE SPACES.    03403100
ZXC            05  FILLER                  PIC  X(05)                   03403200
ZXC                                             VALUE 'REG: '.          03403300
ZXC            05  WS-CRITE-RGST-ID        PIC  9(04)  VALUE ZEROS.     03403400
ZXC            05  FILLER                  PIC  X(02)  VALUE SPACES.    03403500
ZXC            05  FILLER                  PIC  X(05)                   03403600
ZXC                                             VALUE 'TRN: '.          03403700
ZXC            05  WS-CRITE-TRN-NBR        PIC  9(04)  VALUE ZEROS.     03403800
ZXC            05  FILLER                  PIC  X(02)  VALUE SPACES.    03403900
ZXC            05  FILLER                  PIC  X(05)                   03404000
ZXC                                             VALUE 'SKU: '.          03404100
ZXC            05  WS-CRITE-SKU-NBR        PIC  9(08)  VALUE ZEROS.     03404200
ZXC            05  FILLER                  PIC  X(32)  VALUE SPACES.    03404300
ZXC                                                                     03404400
ZX     01  WS-DAY02-TRANS-RECORD.                                       03404500
ZX         05  WS-TRAN-TYPE                PIC X(15).                   03404600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03404700
ZX         05  WS-EPTRN-SLS-DTE            PIC X(10).                   03404800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03404900
ZX         05  WS-EPITM-PARTN-NBR          PIC 9(4).                    03405000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03405100
ZX         05  WS-EPITM-STR-NBR            PIC 9(4).                    03405200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03405300
ZX         05  WS-EPITM-RGST-ID            PIC 9(2).                    03406000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03407000
ZX         05  WS-EPITM-TRN-NBR            PIC 9(4).                    03408000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03409000
ZX         05  WS-EPITM-STRT-TM            PIC X(8).                    03409100
ZX         05  FILLER                      PIC X(1) VALUE ','.          03409200
ZX         05  WS-EPITM-SLS-CORR-SEQ-NBR   PIC -9(4).                   03409300
ZX         05  FILLER                      PIC X(1) VALUE ','.          03409400
ZX         05  WS-EPITM-LNE-ITM-SEQ-NBR    PIC 9(4).                    03409700
ZX         05  FILLER                      PIC X(1) VALUE ','.          03409800
ZX         05  WS-DEPT-NBR                 PIC X(3).                    03409900
ZX         05  FILLER                      PIC X(1) VALUE ','.          03410000
ZX         05  WS-EPITM-SKU-NBR            PIC 9(8).                    03410100
ZX         05  FILLER                      PIC X(1) VALUE ','.          03410200
ZX         05  WS-EPLID-LID-RSN-CDE        PIC X(3).                    03410300
ZX         05  FILLER                      PIC X(1) VALUE ','.          03410400
ZX         05  WS-DISC-AMT-FILE            PIC -(6)9.99.                03410500
ZX         05  FILLER                      PIC X(1) VALUE ','.          03410600
ZX         05  WS-MDWN-TYPE-FILE           PIC X(3).                    03410700
ZX         05  FILLER                      PIC X(1) VALUE ','.          03410800
ZX         05  WS-DISC-TYPE-FILE           PIC X(30).                   03410900
ZX         05  FILLER                      PIC X(1) VALUE ','.          03411000
ZX         05  WS-ORIG-REG-RTL-AMT         PIC -(6)9.99.                03411200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03411300
ZX         05  WS-REG-RTL-AMT              PIC -(6)9.99.                03411400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03411500
ZX         05  WS-ITM-STAT-CDE             PIC X(2).                    03411600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03411700
ZX         05  WS-SAL-TYP-CDE              PIC X(1).                    03411800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03411900
ZX         05  WS-ORIG-SAL-TYP-CDE         PIC X(1).                    03412000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03412100
ZX         05  WS-CUST-CHRGD-AMT           PIC -(6)9.99.                03412200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03412300
ZX         05  WS-NET-CHRGD-AMT            PIC -(6)9.99.                03412400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03412500
ZX         05  WS-ORIG-OURA-AMT            PIC -(6)9.99.                03412600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03412700
ZX         05  WS-EPLID-LID-AMT            PIC -(6)9.99.                03412800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03412900
ZX         05  WS-EPTRN-TRN-DTE            PIC X(10).                   03413000
ZX         05  FILLER                      PIC X(1) VALUE ','.          03413100
ZX         05  WS-EPORD-ORD-NBR            PIC X(23).                   03413200
ZX         05  FILLER                      PIC X(1) VALUE ','.          03413300
ZX         05  WS-PROBLEM-IND              PIC X(1).                    03413400
ZX         05  FILLER                      PIC X(1) VALUE ','.          03413500
ZX         05  WS-OLD-PRICE-AMT            PIC -(6)9.99.                03413600
ZX         05  FILLER                      PIC X(1) VALUE ','.          03413700
ZX         05  WS-NEW-PRICE-AMT            PIC -(6)9.99.                03413800
ZX         05  FILLER                      PIC X(1) VALUE ','.          03413900
ZX         05  WS-DIFF-PRICE-AMT           PIC -(6)9.99.                03414000
ZX         05  FILLER                      PIC X(30).                   03414100
ZX                                                                      03414200
034100 01  PV-PROGRAM-VARIABLES.                                        03414300
ZX         05  WS-DISP-SUB             PIC 9(5).                        03414400
ZX         05  WS-DISC-TYPE            PIC X(30).                       03414500
ZX         05  WS-MDWN-TYPE            PIC X(3).                        03414600
ZX         05  WS-ISSUE-IND            PIC X(1).                        03414700
ZX         05  WS-DISC-AMT             PIC -(6)9.99.                    03414800
ZX         05  WS-EPIGP-GP-AMT         PIC S9(7)V99 VALUE ZERO.         03415000
034200     05  PV-LID-SEQ-NBR          PIC S9(04) COMP VALUE ZERO.      03420000
034300     05  PV-TOTAL-MKDN-AMT       PIC  9(9)V9(2) VALUE ZEROS.      03430000
034400     05  PV-TOTAL-MKDNCAN-AMT    PIC  9(9)V9(2) VALUE ZEROS.      03440000
034500     05  PV-SPACE-CONTROL        PIC  9(02) VALUE 1.              03450000
226892     05  PV-DIFF                 PIC S9(5)V99 VALUE ZEROES.       03451000
034600     05  PV-PARAGRAPH-NAME       PIC  X(30) VALUE SPACES.         03460000
034700     05  PV-OPERATION-MSG-1      PIC  X(40) VALUE SPACES.         03470000
034800     05  PV-OPERATION-MSG-2      PIC  X(40) VALUE SPACES.         03480000
034900     05  PV-FISC-PERIOD-NBR-HOLD PIC  9(02) VALUE 0.              03490000
035000     05  PV-PAGE-COUNT           PIC  9(02) VALUE 1.              03500000
035100     05  PV-LINE-COUNT           PIC  9(02) VALUE ZERO.           03510000
035200     05  PV-POS-DATE-CYMD        PIC  9(08) VALUE ZEROS.          03520000
035300     05  PV-PRICE-CHANGE-AMOUNT  PIC S9(7)V99 VALUE ZERO.         03530000
035400     05  PV-CUST-CHRGD-AMT       PIC  9(07)V9(02) VALUE ZERO.     03540000
035500     05  PV-EXTENDED-AMT         PIC S9(07)V9(02) VALUE ZERO.     03550000
035600     05  PV-NET-CHRGD-AMT        PIC  9(07)V9(02) VALUE ZERO.     03560000
035700     05  PV-EXCLUDE-LID-AMT      PIC  9(07)V9(02) VALUE ZERO.     03570000
040220     05  PV-NEW-PR-AMT           PIC S9(07)V9(02) VALUE ZERO.     03570100
035800     05  PV-LID-AMT              PIC  9(07)V9(02) VALUE ZERO.     03580000
035900     05  PV-NET-CHRGD-AMT-TMP    PIC  9(07)V9(02) VALUE ZERO.     03590000
BOSSCL     05  PV-OMNI-CHNL-FFLMT-TYP-CDE  PIC X(3)     VALUE SPACES.   03591001
036000                                                                  03600000
BOSSCL     05  PV-PRICE-CHG-STRT-DATE  PIC  X(10)       VALUE SPACES.   03601010
BOSSCL     05  PV-PRICE-CHG-END-DATE   PIC  X(10)       VALUE SPACES.   03602010
BOSSCL     05  PV-NEW-OMNI-PRICE       PIC S9(7)V9(2)   VALUE ZERO.     03603010
BOSSCL     05  PV-OLD-OMNI-PRICE       PIC S9(7)V9(2)   VALUE ZERO.     03604010
036100                                                                  03610000
BOSSCL     05  PV-OWND-UNT-RTL-ORIG-AMT PIC S9(7)V9(2)      VALUE ZERO. 03611005
036200     05  PV-PC-OLD-PR-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03620005
036300     05  PV-PC-NEW-PR-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03630005
036400     05  PV-PC-DIFFER-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03640005
BOSSC2     05  PV-DISPLAY-AMT           PIC ---,--9.99      VALUE ZERO. 03641013
036500                                                                  03650000
036600     05  PV-ITM-CUST-CHRGD-AMT  PIC  9(7)V9(2)        VALUE ZERO. 03660000
036700     05  PV-ITM-REG-RTL-AMT     PIC  9(5)V9(2)        VALUE ZERO. 03670000
036800                                                                  03680000
036900     05  PV-ISO-DB2-DATE.                                         03690000
037000         10  PV-ISO-DB2-CC       PIC  X(02).                      03700000
037100         10  PV-ISO-DB2-YY       PIC  X(02).                      03710000
037200         10  FILLER              PIC  X(01).                      03720000
037300         10  PV-ISO-DB2-MM       PIC  X(02).                      03730000
037400         10  FILLER              PIC  X(01).                      03740000
037500         10  PV-ISO-DB2-DD       PIC  X(02).                      03750000
037600                                                                  03760000
037700     05  PV-CURRENT-TIME.                                         03770000
037800         10  PV-CURRENT-HOUR     PIC  9(02) VALUE ZERO.           03780000
037900         10  PV-CURRENT-MINUTE   PIC  9(02) VALUE ZERO.           03790000
038000         10  FILLER              PIC  9(04) VALUE ZERO.           03800000
038100                                                                  03810000
038200     05  PV-CURRENT-DATE.                                         03820000
038300         10  PV-CURRENT-YEAR     PIC  9(02) VALUE ZERO.           03830000
038400         10  PV-CURRENT-MONTH    PIC  9(02) VALUE ZERO.           03840000
038500         10  PV-CURRENT-DAY      PIC  9(02) VALUE ZERO.           03850000
038600                                                                  03860000
BOSSCL     05  PV-TIMESTAMP                     PIC X(26) VALUE SPACES. 03861010
BOSSCL     05  PV-TIMESTAMP-DB2.                                        03862010
BOSSCL         10  PV-TS-DATE.                                          03863010
BOSSCL             15  PV-TS-CENTURY            PIC  X(02) VALUE ZERO.  03864010
BOSSCL             15  PV-TS-YEAR               PIC  9(02) VALUE ZERO.  03865010
BOSSCL             15  FILLER                   PIC  X(01) VALUE '-'.   03866010
BOSSCL             15  PV-TS-MONTH              PIC  9(02) VALUE ZERO.  03867010
BOSSCL             15  FILLER                   PIC  X(01) VALUE '-'.   03868010
BOSSCL             15  PV-TS-DAY                PIC  9(02) VALUE ZERO.  03869010
BOSSCL         10  FILLER                       PIC  X(01) VALUE '-'.   03869110
BOSSCL         10  PV-TS-HOUR                   PIC  9(02) VALUE 02.    03869210
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   03869310
BOSSCL         10  PV-TS-MINUTE                 PIC  9(02) VALUE ZERO.  03869410
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   03869510
BOSSCL         10  PV-TS-SECONDS                PIC  9(02) VALUE ZERO.  03869610
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   03869710
BOSSCL         10  PV-TS-MILLISEC               PIC  9(06) VALUE ZERO.  03869810
039000                                                                  03869910
BOSSCL     05  PV-STR-NBR-DB2          PIC  S9(4) COMP  VALUE ZERO.     03870010
                                                                        03870110
038700     05  PV-RFMT-STR-NBR.                                         03871000
038800         10  FILLER              PIC  9 VALUE ZERO.               03880000
038900         10  PV-STR-NBR-4        PIC  9(04).                      03890000
039100                                                                  03927800
039200     05  PV-SKU-NBR              PIC  9(08) VALUE ZERO.           03928000
039300                                                                  03930000
039400     05  PV-SKU-NBR-RDFN         REDEFINES PV-SKU-NBR.            03940000
039500         10  FILLER              PIC  9(05).                      03950000
039600         10  PV-SKU-LST-3-DGT    PIC  9(03).                      03960000
039700                                                                  03970000
ZX         05  PV-ORIG-REG-RTL-AMT     PIC S9(7)V9(2) USAGE COMP-3      03971000
ZX                                         VALUE ZERO.                  03971100
ZX         05  PV-ORIG-SAL-TYP-CDE     PIC  X(01) VALUE SPACES.         03971200
ZX         05  PV-SAL-TYP-CDE          PIC  X(01) VALUE SPACES.         03971300
ZX         05  PV-REG-RTL-AMT          PIC S9(7)V9(2) USAGE COMP-3      03971400
ZX                                         VALUE ZERO.                  03971500
ZX         05  PV-CUST-CHRGD-AMTS      PIC S9(7)V9(2) USAGE COMP-3      03972000
ZX                                         VALUE ZERO.                  03972100
ZX         05  PV-ORIG-OURA-AMTS       PIC S9(7)V9(2) USAGE COMP-3      03972200
ZX                                         VALUE ZERO.                  03972300
ZX         05  PV-NET-CHRGD-AMTS       PIC S9(7)V9(2) USAGE COMP-3      03973000
ZX                                         VALUE ZERO.                  03973100
ZX         05  PV-ITM-STAT-CDE         PIC  X(02) VALUE SPACES.         03974000
ZX         05  PV-DEPT-NBR             PIC  X(03) VALUE SPACES.         03974100
ZX                                                                      03975000
                                                                        03976000
039800     05  PV-DB2-KEY-FIELDS.                                       03980000
039900         10  PV-PARTN-NBR        PIC S9(04) COMP SYNC             03990000
040000                                            VALUE ZERO.           04000000
040100         10  PV-STR-NBR          PIC S9(04) COMP SYNC             04010000
040200                                            VALUE ZERO.           04020000
040300         10  PV-RGST-ID          PIC S9(04) COMP SYNC             04030000
040400                                            VALUE ZERO.           04040000
040500         10  PV-TRN-NBR          PIC S9(04) COMP SYNC             04050000
040600                                            VALUE ZERO.           04060000
040700         10  PV-STRT-TM          PIC  X(08) VALUE SPACE.          04070000
040800         10  PV-SLS-CORR-SEQ-NBR PIC S9(04) COMP SYNC             04080000
040900                                            VALUE ZERO.           04090000
041000         10  PV-LNE-ITM-SEQ-NBR  PIC S9(04) COMP SYNC             04100000
041100                                            VALUE ZERO.           04110000
ZX         05  CNTL-CARD.                                               04111000
ZX             10  FILLER                  PIC  X(05)                   04111100
ZX                                              VALUE 'PRT: '.          04111200
ZX             10  WS-CNTL-PRT             PIC  9(04)  VALUE ZEROS.     04111300
ZX             10  FILLER                  PIC  X(02)  VALUE SPACES.    04111400
ZX             10  FILLER                  PIC  X(05)                   04112000
ZX                                              VALUE 'STR: '.          04113000
ZX             10  WS-CNTL-STR             PIC  9(04)  VALUE ZEROS.     04114000
ZX             10  FILLER                  PIC  X(02)  VALUE SPACES.    04115000
ZX             10  FILLER                  PIC  X(05)                   04116000
ZX                                              VALUE 'REG: '.          04117000
ZX             10  WS-CNTL-REG             PIC  9(04)  VALUE ZEROS.     04118000
ZX             10  FILLER                  PIC  X(02)  VALUE SPACES.    04119000
ZX             10  FILLER                  PIC  X(05)                   04119100
ZX                                              VALUE 'TRN: '.          04119200
ZX             10  WS-CNTL-TRN             PIC  9(04)  VALUE ZEROS.     04119300
ZX             10  FILLER                  PIC  X(02)  VALUE SPACES.    04119400
ZX             10  FILLER                  PIC  X(05)                   04119500
ZX                                              VALUE 'SKU: '.          04119600
ZX             10  WS-CNTL-SKU             PIC  9(08)  VALUE ZEROS.     04119700
ZX             10  FILLER                  PIC  X(45)  VALUE SPACES.    04119800
ZX                                                                      04119900
ZX         05  WS-PRT                      PIC S9(4) COMP.              04120000
ZX         05  WS-STR                      PIC S9(4) COMP.              04120100
ZX         05  WS-REG                      PIC S9(4) COMP.              04120200
ZX         05  WS-TRN                      PIC S9(4) COMP.              04120300
ZX         05  WS-SKU                      PIC S9(8)V COMP-3.           04120400
ZX         05  WS-PRT-LOW                  PIC S9(4) COMP.              04120500
ZX         05  WS-STR-LOW                  PIC S9(4) COMP.              04120600
ZX         05  WS-REG-LOW                  PIC S9(4) COMP.              04120700
ZX         05  WS-TRN-LOW                  PIC S9(4) COMP.              04120800
ZX         05  WS-SKU-LOW                  PIC S9(8)V COMP-3.           04120900
ZX         05  WS-PRT-HIGH                 PIC S9(4) COMP.              04121000
ZX         05  WS-STR-HIGH                 PIC S9(4) COMP.              04121100
ZX         05  WS-REG-HIGH                 PIC S9(4) COMP.              04121200
ZX         05  WS-TRN-HIGH                 PIC S9(4) COMP.              04121300
ZX         05  WS-SKU-HIGH                 PIC S9(8)V COMP-3.           04121400
ZX                                                                      04121500
ZX         05  WS-TRN-CNT                  PIC  9(04)  VALUE ZEROS.     04121600
041200                                                                  04122000
ZX     01  WS-DISPLAY-VARS.                                             04123000
ZX         05  WS-DISPLAY-NUM              PIC -(7)9.99.                04124000
041300 01  DH-DISPLAY-HEADER.                                           04130000
041400     05  FILLER                  PIC  X(18) VALUE                 04140000
041500         'PRICE CHG TYPE'.                                        04150000
041600     05  FILLER                  PIC  X(15) VALUE                 04160000
041700         'MKDN QTY'.                                              04170000
041800     05  FILLER                  PIC  X(14) VALUE                 04180000
041900         'MKDN AMT'.                                              04190000
042000     05  FILLER                  PIC  X(15) VALUE                 04200000
042100         'MDC QTY'.                                               04210000
042200     05  FILLER                  PIC  X(10) VALUE                 04220000
042300         'MDC AMT'.                                               04230000
042400     05  FILLER                  PIC  X(13) VALUE                 04240000
042500         'MKUP QTY'.                                              04250000
042600     05  FILLER                  PIC  X(12) VALUE                 04260000
042700         'MKUP AMT'.                                              04270000
042800     05  FILLER                  PIC  X(13) VALUE                 04280000
042900         'MUC QTY'.                                               04290000
043000     05  FILLER                  PIC  X(08) VALUE                 04300000
043100         'MUC AMT'.                                               04310000
043200                                                                  04320000
043300 01  HL-HEADER-LINE1.                                             04330000
043400     05  FILLER                  PIC  X(39) VALUE SPACES.         04340000
043500     05                          PIC  X(55) VALUE                 04350000
043600        'MERCHANDISE LEDGER MARKDOWN/MARKUP TRANSACTION CREATION'.04360000
043700     05  FILLER                  PIC  X(38) VALUE SPACES.         04370000
043800                                                                  04380000
ZX     01  H2-HEADER-LINE1-1.                                           04381000
ZX         05  FILLER                  PIC  X(49) VALUE SPACES.         04382000
ZX         05                          PIC  X(04) VALUE                 04383000
ZX             'FOR '.                                                  04384000
ZX         05  H2-REPORT-MONTH         PIC  X(02) VALUE SPACES.         04385000
ZX         05  FILLER                  PIC  X(01) VALUE '/'.            04386000
ZX         05  H2-REPORT-DAY           PIC  X(02) VALUE SPACES.         04387000
ZX         05  FILLER                  PIC  X(01) VALUE '/'.            04388000
ZX         05  H2-REPORT-YEAR          PIC  X(02) VALUE SPACES.         04389000
ZX         05  FILLER                  PIC  X(01) VALUE ' '.            04389100
ZX         05                          PIC  X(05) VALUE                 04389200
ZX             'STR: '.                                                 04389300
ZX         05  H2-REPORT-STR           PIC  9(04) VALUE ZEROES.         04389400
ZX         05  FILLER                  PIC  X(01) VALUE ' '.            04389500
ZX         05                          PIC  X(05) VALUE                 04389600
ZX             'REG: '.                                                 04389700
ZX         05  H2-REPORT-REG           PIC  9(04) VALUE ZEROES.         04389800
ZX         05  FILLER                  PIC  X(01) VALUE ' '.            04389900
ZX         05                          PIC  X(05) VALUE                 04390000
ZX             'TRN: '.                                                 04390100
ZX         05  H2-REPORT-TRN           PIC  9(04) VALUE ZEROES.         04390200
ZX         05  FILLER                  PIC  X(01) VALUE ' '.            04390300
ZX         05                          PIC  X(05) VALUE                 04390400
ZX             'SKU: '.                                                 04390500
ZX         05  H2-REPORT-SKU           PIC  9(08) VALUE ZEROES.         04390600
ZX                                                                      04390700
043900 01  HL-HEADER-LINE1-1.                                           04391000
044000     05  FILLER                  PIC  X(59) VALUE SPACES.         04400000
044100     05                          PIC  X(04) VALUE                 04410000
044200         'FOR '.                                                  04420000
044300     05  HL-REPORT-MONTH         PIC  X(02) VALUE SPACES.         04430000
044400     05  FILLER                  PIC  X(01) VALUE '/'.            04440000
044500     05  HL-REPORT-DAY           PIC  X(02) VALUE SPACES.         04450000
044600     05  FILLER                  PIC  X(01) VALUE '/'.            04460000
044700     05  HL-REPORT-YEAR          PIC  X(02) VALUE SPACES.         04470000
044800     05  FILLER                  PIC  X(59) VALUE SPACES.         04480000
044900                                                                  04490000
045000 01  HL-HEADER-LINE2.                                             04500000
045100     05  FILLER                  PIC  X(04) VALUE SPACES.         04510000
045200     05  FILLER                  PIC  X(14) VALUE                 04520000
045300         'PRICE CHG TYPE'.                                        04530000
045400     05  FILLER                  PIC  X(02) VALUE SPACES.         04540000
045500     05  FILLER                  PIC  X(11) VALUE                 04550000
045600         'MKDN QTY'.                                              04560000
045700     05  FILLER                  PIC  X(02) VALUE SPACES.         04570000
045800     05  FILLER                  PIC  X(15) VALUE                 04580000
045900         'MKDN AMT'.                                              04590000
046000     05  FILLER                  PIC  X(02) VALUE SPACES.         04600000
046100     05  FILLER                  PIC  X(11) VALUE                 04610000
046200         'MDC QTY'.                                               04620000
046300     05  FILLER                  PIC  X(02) VALUE SPACES.         04630000
046400     05  FILLER                  PIC  X(15) VALUE                 04640000
046500         'MDC AMT'.                                               04650000
046600     05  FILLER                  PIC  X(02) VALUE SPACES.         04660000
046700     05  FILLER                  PIC  X(09) VALUE                 04670000
046800         'MKUP QTY'.                                              04680000
046900     05  FILLER                  PIC  X(02) VALUE SPACES.         04690000
047000     05  FILLER                  PIC  X(13) VALUE                 04700000
047100         'MKUP AMT'.                                              04710000
047200     05  FILLER                  PIC  X(02) VALUE SPACES.         04720000
047300     05  FILLER                  PIC  X(09) VALUE                 04730000
047400         'MUC QTY'.                                               04740000
047500     05  FILLER                  PIC  X(02) VALUE SPACES.         04750000
047600     05  FILLER                  PIC  X(13) VALUE                 04760000
047700         'MUC AMT'.                                               04770000
047800     05  FILLER                  PIC  X(04) VALUE SPACES.         04780000
047900                                                                  04790000
048000 01  HL-HEADER-LINE3.                                             04800000
048100     05  FILLER                  PIC  X(04) VALUE SPACES.         04810000
048200     05  FILLER                  PIC  X(14) VALUE ALL '-'.        04820000
048300     05  FILLER                  PIC  X(02) VALUE SPACES.         04830000
048400     05  FILLER                  PIC  X(11) VALUE ALL '-'.        04840000
048500     05  FILLER                  PIC  X(02) VALUE SPACES.         04850000
048600     05  FILLER                  PIC  X(15) VALUE ALL '-'.        04860000
048700     05  FILLER                  PIC  X(02) VALUE SPACES.         04870000
048800     05  FILLER                  PIC  X(11) VALUE ALL '-'.        04880000
048900     05  FILLER                  PIC  X(02) VALUE SPACES.         04890000
049000     05  FILLER                  PIC  X(15) VALUE ALL '-'.        04900000
049100     05  FILLER                  PIC  X(02) VALUE SPACES.         04910000
049200     05  FILLER                  PIC  X(09) VALUE ALL '-'.        04920000
049300     05  FILLER                  PIC  X(02) VALUE SPACES.         04930000
049400     05  FILLER                  PIC  X(13) VALUE ALL '-'.        04940000
049500     05  FILLER                  PIC  X(02) VALUE SPACES.         04950000
049600     05  FILLER                  PIC  X(09) VALUE ALL '-'.        04960000
049700     05  FILLER                  PIC  X(02) VALUE SPACES.         04970000
049800     05  FILLER                  PIC  X(13) VALUE ALL '-'.        04980000
049900     05  FILLER                  PIC  X(04) VALUE SPACES.         04990000
050000                                                                  05000000
050100 01  HL-HEADER-LINE4.                                             05010000
050200     05  FILLER                  PIC  X(53) VALUE SPACES.         05020000
050300     05  FILLER                  PIC  X(26) VALUE SPACES.         05030000
050400         88  HD-ORIGINAL-SALES              VALUE                 05040000
050500             '    ORIGINAL POS SALES    '.                        05050000
050600         88  HD-SALES-CORR                  VALUE                 05060000
050700             '    SALES CORRECTIONS     '.                        05070000
050800         88  HD-LATE-TRANSACTIONS           VALUE                 05080000
050900             '    LATE TRANSACTIONS     '.                        05090000
051000         88  HD-CUTOFF-SALES-CORR           VALUE                 05100000
051100             ' CUTOFF SALES CORRECTIONS '.                        05110000
051200         88  HD-CUTOFF-LATE-TRANSACTIONS    VALUE                 05120000
051300             ' CUTOFF LATE TRANSACTIONS '.                        05130000
051400     05  FILLER                  PIC  X(53) VALUE SPACES.         05140000
051500                                                                  05150000
051600 01  DD-DISPLAY-DETAIL.                                           05160000
051700     05  DD-PRICE-CHANGE-TYPE    PIC  X(14) VALUE SPACES.         05170000
051800         88  DD-PC-PROMOTIONAL              VALUE                 05180000
051900             'PROMOTIONAL   '.                                    05190000
052000         88  DD-PC-TIERED                   VALUE                 05200000
052100             'ADDTL PROMOTNS'.                                    05210000
052200         88  DD-PC-GOLDSTAR                 VALUE                 05220000
052300             'GOLDSTAR      '.                                    05230000
052400         88  DD-PC-MANUAL-LID               VALUE                 05240000
052500             'MANUAL LID    '.                                    05250000
052600         88  DD-PC-OWNERSHIP-ADJUSTMENT     VALUE                 05260000
052700             'OWNERSHIP ADJ '.                                    05270000
052800         88  DD-PC-OWN-RETRN-ADJUSTMENT     VALUE                 05280000
052900             'OWN.RETURN ADJ'.                                    05290000
053000         88  DD-PC-SENIOR-CITIZEN           VALUE                 05300000
053100             'SENIOR CITIZEN'.                                    05310000
053200         88  DD-PC-KOHLS-COUPON             VALUE                 05320000
053300             'KOHLS COUPON  '.                                    05330000
053400         88  DD-PC-OFFER-COUPON             VALUE                 05340000
053500             'OFFER COUPON  '.                                    05350000
053600         88  DD-PC-OFFER-TLD-TIERED         VALUE                 05360000
053700             'OFFER TLD TIER'.                                    05370000
053800         88  DD-PC-OFFER-LID-TIERED         VALUE                 05380000
053900             'OFFER LID TIER'.                                    05390000
054000         88  DD-PC-OFFER-GWP-PWP            VALUE                 05400000
054100             'OFFER GWP/PWP '.                                    05410000
054200         88  DD-PC-GFT-RCPT-RTRN            VALUE                 05420000
054300             'GIFT RCPT RTRN'.                                    05430000
205464         88  DD-NON-RCPT-RTRN               VALUE                 05430100
205464             'NON RCPT RTRN '.                                    05430200
054400         88  DD-PC-BOGO                     VALUE                 05440000
054500             'EBOGO         '.                                    05450000
054600         88  DD-PC-UNEARNED-REWARDS         VALUE                 05460000
054700             'UNEARNED RWDS '.                                    05470000
054800         88  DD-PC-EMPLY-DISCOUNT           VALUE                 05480000
054900             'EMPLY DISCOUNT'.                                    05490000
262807         88  DD-PC-SEPHORA-DISCOUNT         VALUE                 05491031
262807             'SEPHORA DISCNT'.                                    05492031
055000         88  DD-PC-TOTAL                    VALUE                 05500000
055100             'TOTAL         '.                                    05510000
055200                                                                  05520000
055300     05  FILLER                  PIC  X(01) VALUE SPACES.         05530000
055400     05  DD-MARKDOWN-QTY         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05540000
055500     05  FILLER                  PIC  X(01) VALUE SPACES.         05550000
055600     05  DD-MARKDOWN-AMT         PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05560000
055700     05  FILLER                  PIC  X(01) VALUE SPACES.         05570000
055800     05  DD-MARKDOWN-CANCEL-QTY  PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05580000
055900     05  FILLER                  PIC  X(01) VALUE SPACES.         05590000
056000     05  DD-MARKDOWN-CANCEL-AMT  PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05600000
056100     05  FILLER                  PIC  X(01) VALUE SPACES.         05610000
056200     05  DD-MARKUP-QTY           PIC Z,ZZZ,ZZ9 VALUE ZERO.        05620000
056300     05  FILLER                  PIC  X(01) VALUE SPACES.         05630000
056400     05  DD-MARKUP-AMT           PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05640000
056500     05  FILLER                  PIC  X(01) VALUE SPACES.         05650000
056600     05  DD-MARKUP-CANCEL-QTY    PIC Z,ZZZ,ZZ9 VALUE ZERO.        05660000
056700     05  FILLER                  PIC  X(01) VALUE SPACES.         05670000
056800     05  DD-MARKUP-CANCEL-AMT    PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05680000
056900                                                                  05690000
057000 01  DL-DETAIL-LINE.                                              05700000
057100     05  FILLER                  PIC  X(04) VALUE SPACES.         05710000
057200     05  DL-PRICE-CHANGE-TYPE    PIC  X(14) VALUE SPACES.         05720000
057300     05  FILLER                  PIC  X(02) VALUE SPACES.         05730000
057400     05  DL-MARKDOWN-QTY         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05740000
057500     05  FILLER                  PIC  X(02) VALUE SPACES.         05750000
057600     05  DL-MARKDOWN-AMT         PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05760000
057700     05  FILLER                  PIC  X(02) VALUE SPACES.         05770000
057800     05  DL-MARKDOWN-CANCEL-QTY  PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05780000
057900     05  FILLER                  PIC  X(02) VALUE SPACES.         05790000
058000     05  DL-MARKDOWN-CANCEL-AMT  PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05800000
058100     05  FILLER                  PIC  X(02) VALUE SPACES.         05810000
058200     05  DL-MARKUP-QTY           PIC Z,ZZZ,ZZ9 VALUE ZERO.        05820000
058300     05  FILLER                  PIC  X(02) VALUE SPACES.         05830000
058400     05  DL-MARKUP-AMT           PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05840000
058500     05  FILLER                  PIC  X(02) VALUE SPACES.         05850000
058600     05  DL-MARKUP-CANCEL-QTY    PIC Z,ZZZ,ZZ9 VALUE ZERO.        05860000
058700     05  FILLER                  PIC  X(02) VALUE SPACES.         05870000
058800     05  DL-MARKUP-CANCEL-AMT    PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05880000
058900     05  FILLER                  PIC  X(04) VALUE SPACES.         05890000
059000                                                                  05900000
059100 01  PT-PROGRAM-TOTALS.                                           05910000
059200     05  PT-PROGRAM-TOTAL-ELEMENT    OCCURS 5 TIMES.              05920000
059300         10  PT-PROMOTIONAL-MKDN-QTY PIC S9(09) VALUE ZERO        05930000
059400                                                COMP-3.           05940000
059500         10  PT-PROMOTIONAL-MKDN-AMT PIC S9(9)V99 VALUE ZERO      05950000
059600                                                COMP-3.           05960000
059700         10  PT-PROMOTIONAL-MDC-QTY  PIC S9(09) VALUE ZERO        05970000
059800                                                COMP-3.           05980000
059900         10  PT-PROMOTIONAL-MDC-AMT  PIC S9(9)V99 VALUE ZERO      05990000
060000                                                COMP-3.           06000000
060100         10  PT-TIERED-MKDN-QTY      PIC S9(07) VALUE ZERO        06010000
060200                                                COMP-3.           06020000
060300         10  PT-TIERED-MKDN-AMT      PIC S9(9)V99 VALUE ZERO      06030000
060400                                                COMP-3.           06040000
060500         10  PT-TIERED-MDC-QTY       PIC S9(09) VALUE ZERO        06050000
060600                                                COMP-3.           06060000
060700         10  PT-TIERED-MDC-AMT       PIC S9(9)V99 VALUE ZERO      06070000
060800                                                COMP-3.           06080000
060900         10  PT-GOLDSTAR-MKDN-QTY    PIC S9(09) VALUE ZERO        06090000
061000                                                COMP-3.           06100000
061100         10  PT-GOLDSTAR-MKDN-AMT    PIC S9(9)V99 VALUE ZERO      06110000
061200                                                COMP-3.           06120000
061300         10  PT-GOLDSTAR-MDC-QTY     PIC S9(09) VALUE ZERO        06130000
061400                                                COMP-3.           06140000
061500         10  PT-GOLDSTAR-MDC-AMT     PIC S9(9)V99 VALUE ZERO      06150000
061600                                                COMP-3.           06160000
061700         10  PT-MANUAL-LID-MKDN-QTY  PIC S9(09) VALUE ZERO        06170000
061800                                                COMP-3.           06180000
061900         10  PT-MANUAL-LID-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      06190000
062000                                                COMP-3.           06200000
062100         10  PT-MANUAL-LID-MDC-QTY   PIC S9(09) VALUE ZERO        06210000
062200                                                COMP-3.           06220000
062300         10  PT-MANUAL-LID-MDC-AMT   PIC S9(9)V99 VALUE ZERO      06230000
062400                                                COMP-3.           06240000
062500         10  PT-OWNERSHIP-ADJ-MKDN-QTY                            06250000
062600                                     PIC S9(09) VALUE ZERO        06260000
062700                                                COMP-3.           06270000
062800         10  PT-OWNERSHIP-ADJ-MKDN-AMT                            06280000
062900                                     PIC S9(9)V99 VALUE ZERO      06290000
063000                                                COMP-3.           06300000
063100         10  PT-OWNERSHIP-ADJ-MDC-QTY                             06310000
063200                                     PIC S9(09) VALUE ZERO        06320000
063300                                                COMP-3.           06330000
063400         10  PT-OWNERSHIP-ADJ-MDC-AMT                             06340000
063500                                     PIC S9(9)V99 VALUE ZERO      06350000
063600                                                COMP-3.           06360000
063700         10  PT-OWNERSHIP-ADJ-MKUP-QTY                            06370000
063800                                     PIC S9(07) VALUE ZERO        06380000
063900                                                COMP-3.           06390000
064000         10  PT-OWNERSHIP-ADJ-MKUP-AMT                            06400000
064100                                     PIC S9(7)V99 VALUE ZERO      06410000
064200                                                COMP-3.           06420000
064300         10  PT-OWNERSHIP-ADJ-MUC-QTY                             06430000
064400                                     PIC S9(07) VALUE ZERO        06440000
064500                                                COMP-3.           06450000
064600         10  PT-OWNERSHIP-ADJ-MUC-AMT                             06460000
064700                                     PIC S9(7)V99 VALUE ZERO      06470000
064800                                                COMP-3.           06480000
064900         10  PT-OWN-RETRN-ADJ-MKDN-QTY                            06490000
065000                                     PIC S9(09) VALUE ZERO        06500000
065100                                                COMP-3.           06510000
065200         10  PT-OWN-RETRN-ADJ-MKDN-AMT                            06520000
065300                                     PIC S9(9)V99 VALUE ZERO      06530000
065400                                                COMP-3.           06540000
065500         10  PT-OWN-RETRN-ADJ-MDC-QTY                             06550000
065600                                     PIC S9(09) VALUE ZERO        06560000
065700                                                COMP-3.           06570000
065800         10  PT-OWN-RETRN-ADJ-MDC-AMT                             06580000
065900                                     PIC S9(09)V99 VALUE ZERO     06590000
066000                                                COMP-3.           06600000
066100         10  PT-OWN-RETRN-ADJ-MKUP-QTY                            06610000
066200                                     PIC S9(07) VALUE ZERO        06620000
066300                                                COMP-3.           06630000
066400         10  PT-OWN-RETRN-ADJ-MKUP-AMT                            06640000
066500                                     PIC S9(7)V99 VALUE ZERO      06650000
066600                                                COMP-3.           06660000
066700         10  PT-OWN-RETRN-ADJ-MUC-QTY                             06670000
066800                                     PIC S9(07) VALUE ZERO        06680000
066900                                                COMP-3.           06690000
067000         10  PT-OWN-RETRN-ADJ-MUC-AMT                             06700000
067100                                     PIC S9(7)V99 VALUE ZERO      06710000
067200                                                COMP-3.           06720000
067300         10  PT-SENIOR-CITIZEN-MKDN-QTY                           06730000
067400                                     PIC S9(09) VALUE ZERO        06740000
067500                                                COMP-3.           06750000
067600         10  PT-SENIOR-CITIZEN-MKDN-AMT                           06760000
067700                                     PIC S9(9)V99 VALUE ZERO      06770000
067800                                                  COMP-3.         06780000
067900         10  PT-SENIOR-CITIZEN-MDC-QTY                            06790000
068000                                     PIC S9(9)    VALUE ZERO      06800000
068100                                                  COMP-3.         06810000
068200         10  PT-SENIOR-CITIZEN-MDC-AMT                            06820000
068300                                     PIC S9(9)V99 VALUE ZERO      06830000
068400                                                  COMP-3.         06840000
068500         10  PT-KOHLS-COUPON-MKDN-QTY                             06850000
068600                                     PIC S9(9)    VALUE ZERO      06860000
068700                                                  COMP-3.         06870000
068800         10  PT-KOHLS-COUPON-MKDN-AMT                             06880000
068900                                     PIC S9(9)V99 VALUE ZERO      06890000
069000                                                  COMP-3.         06900000
069100         10  PT-KOHLS-COUPON-MDC-QTY PIC S9(9)    VALUE ZERO      06910000
069200                                                  COMP-3.         06920000
069300         10  PT-KOHLS-COUPON-MDC-AMT PIC S9(9)V99 VALUE ZERO      06930000
069400                                                  COMP-3.         06940000
205464         10  PT-710-NORCPT-MKDN-QTY  PIC S9(9)    VALUE ZERO      06940100
205464                                                  COMP-3.         06940200
205464         10  PT-710-NORCPT-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      06940300
205464                                                  COMP-3.         06940400
205464         10  PT-710-NORCPT-MDC-QTY   PIC S9(9)    VALUE ZERO      06940500
205464                                                  COMP-3.         06940600
205464         10  PT-710-NORCPT-MDC-AMT   PIC S9(9)V99 VALUE ZERO      06940700
205464                                                  COMP-3.         06940800
262807         10  PT-720-SEPHORA-MKDN-QTY                              06940931
262807                                     PIC S9(9)    VALUE ZERO      06941031
262807                                                  COMP-3.         06942031
262807         10  PT-720-SEPHORA-MKDN-AMT                              06943031
262807                                     PIC S9(9)V99 VALUE ZERO      06944031
262807                                                  COMP-3.         06945031
262807         10  PT-720-SEPHORA-MDC-QTY    PIC S9(9)    VALUE ZERO    06946031
262807                                                  COMP-3.         06947031
262807         10  PT-720-SEPHORA-MDC-AMT    PIC S9(9)V99 VALUE ZERO    06948031
262807                                                  COMP-3.         06949031
069500         10  PT-760-OFFER-MKDN-QTY                                06950000
069600                                     PIC S9(9)    VALUE ZERO      06960000
069700                                                  COMP-3.         06970000
069800         10  PT-760-OFFER-MKDN-AMT                                06980000
069900                                     PIC S9(9)V99 VALUE ZERO      06990000
070000                                                  COMP-3.         07000000
070100         10  PT-760-OFFER-MDC-QTY    PIC S9(9)    VALUE ZERO      07010000
070200                                                  COMP-3.         07020000
070300         10  PT-760-OFFER-MDC-AMT    PIC S9(9)V99 VALUE ZERO      07030000
070400                                                  COMP-3.         07040000
070500         10  PT-761-TLDTIER-MKDN-QTY                              07050000
070600                                     PIC S9(9)    VALUE ZERO      07060000
070700                                                  COMP-3.         07070000
070800         10  PT-761-TLDTIER-MKDN-AMT                              07080000
070900                                     PIC S9(9)V99 VALUE ZERO      07090000
071000                                                  COMP-3.         07100000
071100         10  PT-761-TLDTIER-MDC-QTY  PIC S9(9)    VALUE ZERO      07110000
071200                                                  COMP-3.         07120000
071300         10  PT-761-TLDTIER-MDC-AMT  PIC S9(9)V99 VALUE ZERO      07130000
071400                                                  COMP-3.         07140000
071500         10  PT-762-LIDTIER-MKDN-QTY                              07150000
071600                                     PIC S9(9)    VALUE ZERO      07160000
071700                                                  COMP-3.         07170000
071800         10  PT-762-LIDTIER-MKDN-AMT                              07180000
071900                                     PIC S9(9)V99 VALUE ZERO      07190000
072000                                                  COMP-3.         07200000
072100         10  PT-762-LIDTIER-MDC-QTY  PIC S9(9)    VALUE ZERO      07210000
072200                                                  COMP-3.         07220000
072300         10  PT-762-LIDTIER-MDC-AMT  PIC S9(9)V99 VALUE ZERO      07230000
072400                                                  COMP-3.         07240000
072500         10  PT-763-GWPPWP-MKDN-QTY                               07250000
072600                                     PIC S9(9)    VALUE ZERO      07260000
072700                                                  COMP-3.         07270000
072800         10  PT-763-GWPPWP-MKDN-AMT                               07280000
072900                                     PIC S9(9)V99 VALUE ZERO      07290000
073000                                                  COMP-3.         07300000
073100         10  PT-763-GWPPWP-MDC-QTY   PIC S9(9)    VALUE ZERO      07310000
073200                                                  COMP-3.         07320000
073300         10  PT-763-GWPPWP-MDC-AMT   PIC S9(9)V99 VALUE ZERO      07330000
073400                                                  COMP-3.         07340000
073500         10  PT-765-GIFT-MKDN-QTY    PIC S9(9)    VALUE ZERO      07350000
073600                                                  COMP-3.         07360000
073700         10  PT-765-GIFT-MKDN-AMT    PIC S9(9)V99 VALUE ZERO      07370000
073800                                                  COMP-3.         07380000
073900         10  PT-765-GIFT-MDC-QTY     PIC S9(9)    VALUE ZERO      07390000
074000                                                  COMP-3.         07400000
074100         10  PT-765-GIFT-MDC-AMT     PIC S9(9)V99 VALUE ZERO      07410000
074200                                                  COMP-3.         07420000
074300         10  PT-BOGO-MKDN-QTY        PIC S9(9)    VALUE ZERO      07430000
074400                                                  COMP-3.         07440000
074500         10  PT-BOGO-MKDN-AMT        PIC S9(9)V99 VALUE ZERO      07450000
074600                                                  COMP-3.         07460000
074700         10  PT-BOGO-MDC-QTY         PIC S9(9)    VALUE ZERO      07470000
074800                                                  COMP-3.         07480000
074900         10  PT-BOGO-MDC-AMT         PIC S9(9)V99 VALUE ZERO      07490000
075000                                                  COMP-3.         07500000
075100                                                                  07510000
075200         10  PT-UNEARNED-RWDS-MKDN-QTY                            07520000
075300                                     PIC S9(9)    VALUE ZERO      07530000
075400                                                  COMP-3.         07540000
075500         10  PT-UNEARNED-RWDS-MKDN-AMT                            07550000
075600                                     PIC S9(9)V99 VALUE ZERO      07560000
075700                                                  COMP-3.         07570000
075800         10  PT-UNEARNED-RWDS-MDC-QTY                             07580000
075900                                     PIC S9(9)    VALUE ZERO      07590000
076000                                                  COMP-3.         07600000
076100         10  PT-UNEARNED-RWDS-MDC-AMT                             07610000
076200                                     PIC S9(9)V99 VALUE ZERO      07620000
076300                                                  COMP-3.         07630000
076400                                                                  07640000
076500         10  PT-EMPLY-DISC-MKDN-QTY  PIC S9(9)    VALUE ZERO      07650000
076600                                                  COMP-3.         07660000
076700         10  PT-EMPLY-DISC-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      07670000
076800                                                  COMP-3.         07680000
076900         10  PT-EMPLY-DISC-MDC-QTY   PIC S9(9)    VALUE ZERO      07690000
077000                                                  COMP-3.         07700000
077100         10  PT-EMPLY-DISC-MDC-AMT   PIC S9(9)V99 VALUE ZERO      07710000
077200                                                  COMP-3.         07720000
077300                                                                  07730000
077400         10  PT-TOTAL-MARKDOWN-QTY   PIC S9(9)    VALUE ZERO      07740000
077500                                                  COMP-3.         07750000
077600         10  PT-TOTAL-MARKDOWN-AMT   PIC S9(9)V99 VALUE ZERO      07760000
077700                                                  COMP-3.         07770000
077800         10  PT-TOTAL-MARKDOWN-CANCEL-QTY                         07780000
077900                                     PIC S9(9)    VALUE ZERO      07790000
078000                                                  COMP-3.         07800000
078100         10  PT-TOTAL-MARKDOWN-CANCEL-AMT                         07810000
078200                                     PIC S9(9)V99 VALUE ZERO      07820000
078300                                                  COMP-3.         07830000
078400         10  PT-TOTAL-MARKUP-QTY     PIC S9(7)    VALUE ZERO      07840000
078500                                                  COMP-3.         07850000
078600         10  PT-TOTAL-MARKUP-AMT     PIC S9(7)V99 VALUE ZERO      07860000
078700                                                  COMP-3.         07870000
078800         10  PT-TOTAL-MARKUP-CANCEL-QTY                           07880000
078900                                     PIC S9(7)    VALUE ZERO      07890000
079000                                                  COMP-3.         07900000
079100         10  PT-TOTAL-MARKUP-CANCEL-AMT                           07910000
079200                                     PIC S9(7)V99 VALUE ZERO      07920000
079300                                                  COMP-3.         07930000
079400         10  PT-NON-OWNED-DROPPED    PIC S9(11)   VALUE ZEROS     07940000
079500                                                  COMP-3.         07950000
079600                                                                  07960000
079700******************************************************************07970000
079800* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                    07980000
079900******************************************************************07990000
080000 01  CC-CONTROL-CARD.                                             08000000
080100     05  CC-CONTROL-CARD-DISPLAY.                                 08010000
080200         10  CC-CONTROL-NAME     PIC  X(14) VALUE SPACE.          08020000
080300         10  CC-POS-DATE-MMDDYY  PIC  9(06) VALUE ZERO.           08030000
080400         10  FILLER REDEFINES CC-POS-DATE-MMDDYY.                 08040000
080500             15  CC-POS-DATE-MM  PIC  99.                         08050000
080600             15  CC-POS-DATE-DD  PIC  99.                         08060000
080700             15  CC-POS-DATE-YY  PIC  99.                         08070000
080800     05 FILLER                   PIC  X(60) VALUE SPACE.          08080000
080900                                                                  08090000
081000 01  TD-TOTAL-DISPLAY-MESSAGE.                                    08100000
081100     05  FILLER                  PIC  X(04) VALUE SPACE.          08110000
081200     05  TD-TOTAL-ID             PIC  X(51) VALUE SPACE.          08120000
081300         88  TD-NON-OWNED-DROPPED-ID        VALUE                 08130000
081400             'NON OWNED MDSE MARKDOWNS DROPPED . . . . . . . . '. 08140000
081500     05  TD-TOTAL-AMOUNT         PIC ZZ,ZZZ,ZZZ,ZZ9 VALUE ZEROS.  08150000
081600     05  FILLER                  PIC  X(67) VALUE SPACES.         08160000
081700                                                                  08170000
081800 77  WS-CMT-CNT                  PIC 9(4)   VALUE ZEROS.          08180000
081900                                                                  08190000
082000******************************************************************08200000
082100*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            08210000
082200******************************************************************08220000
082300                                                                  08230000
082400     COPY DPWS004.                                                08240000
082500                                                                  08250000
082600******************************************************************08260000
082700*  DB2 COMMUNICATION AREA.                                        08270000
082800******************************************************************08280000
082900                                                                  08290000
083000     EXEC SQL                                                     08300000
083100          INCLUDE SQLCA                                           08310000
083200     END-EXEC.                                                    08320000
083300                                                                  08330000
083400******************************************************************08340000
083500*  DB2 TABLE DB2PDBA.TEPPART - PARTITION CONTROL TABLE            08350000
083600******************************************************************08360000
083700                                                                  08370000
083800     EXEC SQL                                                     08380000
083900          INCLUDE TEPPART                                         08390000
084000     END-EXEC.                                                    08400000
084100                                                                  08410000
084200******************************************************************08420000
084300*  DB2 TABLE DB2PDBA.TEPDKEY - CURRENT PROCESSING DAY KEY TABLE   08430000
084400******************************************************************08440000
084500                                                                  08450000
084600     EXEC SQL                                                     08460000
084700          INCLUDE TEPDKEY                                         08470000
084800     END-EXEC.                                                    08480000
084900                                                                  08490000
085000******************************************************************08500000
085100*  DB2 TABLE DB2PDBA.TEPTRN - TRANSACTION TABLE                   08510000
085200******************************************************************08520000
085300                                                                  08530000
085400     EXEC SQL                                                     08540000
085500          INCLUDE TEPTRN                                          08550000
085600     END-EXEC.                                                    08560000
085700                                                                  08570000
085800******************************************************************08580000
085900*  DB2 TABLE DB2PDBA.TEPITM - ITEM TABLE                          08590000
086000******************************************************************08600000
086100                                                                  08610000
086200     EXEC SQL                                                     08620000
086300          INCLUDE TEPITM                                          08630000
086400     END-EXEC.                                                    08640000
086500                                                                  08650000
ZX    ******************************************************************08651000
ZX    *  DB2 TABLE DB2PDBA.TEPORD - ORDER NUMBER TABLE                  08652000
ZX    ******************************************************************08653000
ZX                                                                      08654000
ZX         EXEC SQL                                                     08655000
ZX              INCLUDE TEPORD                                          08656000
ZX         END-EXEC.                                                    08657000
ZX                                                                      08658000
086600******************************************************************08660000
086700*  DB2 TABLE DB2PDBA.TEPIGP - ITEM GROUP PRICING TABLE            08670000
086800******************************************************************08680000
086900                                                                  08690000
087000     EXEC SQL                                                     08700000
087100          INCLUDE TEPIGP                                          08710000
087200     END-EXEC.                                                    08720000
087300                                                                  08730000
087400******************************************************************08740000
087500*  DB2 TABLE DB2PDBA.TEPLID - LINE ITEM DISCOUNT TABLE            08750000
087600******************************************************************08760000
087700                                                                  08770000
087800     EXEC SQL                                                     08780000
087900          INCLUDE TEPLID                                          08790000
088000     END-EXEC.                                                    08800000
088100                                                                  08810000
088200******************************************************************08820000
088300*  DB2 TABLE DB2PDBA.TEPEID - EMPLOYEE ITEM DISCOUNT TABLE.       08830000
088400******************************************************************08840000
088500                                                                  08850000
088600     EXEC SQL                                                     08860000
088700          INCLUDE TEPEID                                          08870000
088800     END-EXEC.                                                    08880000
088900                                                                  08890000
088900                                                                  08890110
BOSSCL******************************************************************08891010
BOSSCL*  DB2 TABLE TSKXREF - SKU XREF                                   08892010
BOSSCL******************************************************************08893010
BOSSCL                                                                  08894010
BOSSCL     EXEC SQL                                                     08895010
BOSSCL          INCLUDE TSKXREF                                         08896010
BOSSCL     END-EXEC.                                                    08897010
BOSSCL                                                                  08898010
BOSSCL                                                                  08899010
BOSSCL******************************************************************08899110
BOSSCL*  DB2 TABLE TPPCPRC - PERM PRICING HISTORY                       08899210
BOSSCL******************************************************************08899310
BOSSCL                                                                  08899410
BOSSCL     EXEC SQL                                                     08899510
BOSSCL          INCLUDE TPPCPRC                                         08899610
BOSSCL     END-EXEC.                                                    08899710
BOSSCL                                                                  08899810
BOSSCL                                                                  08899910
BOSSC3******************************************************************08900016
BOSSC3*  DB2 TABLE SAT_BOSS_TRANSFERS TABLE                             08900116
BOSSC3******************************************************************08900216
BOSSC3                                                                  08900316
BOSSC3     EXEC SQL                                                     08900416
BOSSC3          INCLUDE SAT00016                                        08900516
BOSSC3     END-EXEC.                                                    08900616
BOSSC3                                                                  08900716
BOSSC3                                                                  08900816
089000******************************************************************08901000
089100*  TEPTRN-CURSOR --> VALID CURRENT DAY TRANSACTIONS.              08910000
089200******************************************************************08920000
089300                                                                  08930000
089400     EXEC SQL                                                     08940000
089500        DECLARE TEPTRN-CURSOR CURSOR WITH HOLD FOR                08950000
089600         SELECT A.PARTN_NBR                                       08960000
089700               ,A.STR_NBR                                         08970000
089800               ,A.RGST_ID                                         08980000
089900               ,A.TRN_NBR                                         08990000
090000               ,A.STRT_TM                                         09000000
090100               ,A.SLS_CORR_SEQ_NBR                                09010000
090200               ,A.TRN_STAT_CDE                                    09020000
090300               ,A.SLS_DTE                                         09030000
ZX                   ,A.TRN_DTE                                         09030100
011618               ,A.POS_CPBL_LVL_NBR                                09030200
090400               ,A.CRE_TMST                                        09040000
BOSSCL               ,A.OMNI_CHNL_FFLMT_TYP_CDE                         09041001
BOSSC2               ,A.SLS_DTE - 2 DAYS                                09042015
090500           FROM TEPTRN A                                          09050000
090600               ,TEPPART B                                         09060000
090700          WHERE A.PARTN_NBR        = B.PARTN_NBR                  09070000
090800            AND B.SLS_DTE          = :PV-RUN-DATE-CCYY-MM-DD      09080000
ZX                                                                      09081000
ZX    * NOTE: FOR TESTING                                               09082000
ZX                AND A.STR_NBR BETWEEN :WS-STR-LOW AND :WS-STR-HIGH    09083000
ZXTEMP*           AND A.STR_NBR IN (9923,9947,9951)                     09083100
ZX                AND A.RGST_ID BETWEEN :WS-REG-LOW AND :WS-REG-HIGH    09084000
ZX                AND A.TRN_NBR BETWEEN :WS-TRN-LOW AND :WS-TRN-HIGH    09085000
ZX                                                                      09086000
090900            AND A.VOID_ABRT_CDE    = 'N'                          09090000
ZXTEMP*           AND A.TRN_STAT_CDE     = 'Z'                          09100000
ZX                AND A.TRN_STAT_CDE    IN ('L','Z','R','V')            09101000
091100            AND B.STR_GP_CDE       = 'A'                          09110000
091200            AND B.DB_STRUC_CDE     = 'O'                          09120000
091300            AND A.TRN_TYP_CDE     IN                              09130000
091400                ('01', '02', '11', '12', '22', '23', '24', '25')  09140000
091500***         AND A.SLS_CORR_SEQ_NBR = 0                            09150006
091600       ORDER BY A.STR_NBR                                         09160000
091700               ,A.RGST_ID                                         09170000
091800               ,A.TRN_NBR                                         09180000
091900               ,A.STRT_TM                                         09190000
092000               ,A.SLS_CORR_SEQ_NBR                                09200000
092100                WITH UR                                           09210000
092200     END-EXEC.                                                    09220000
092300                                                                  09230000
092400******************************************************************09240000
092500*  TEPDKEY CURSOR --> VALID LATE, CORRECTION TRANSACTIONS.        09250000
092600******************************************************************09260000
092700     EXEC SQL                                                     09270000
092800        DECLARE TEPDKEY-CURSOR CURSOR WITH HOLD FOR               09280000
092900         SELECT B.PARTN_NBR                                       09290000
093000               ,B.STR_NBR                                         09300000
093100               ,B.RGST_ID                                         09310000
093200               ,B.TRN_NBR                                         09320000
093300               ,B.STRT_TM                                         09330000
093400               ,B.SLS_CORR_SEQ_NBR                                09340000
093500               ,B.TRN_STAT_CDE                                    09350000
093600               ,B.SLS_DTE                                         09360000
BOSSCL               ,B.TRN_DTE                                         09360110
011618               ,B.POS_CPBL_LVL_NBR                                09360200
093700               ,B.CRE_TMST                                        09370000
BOSSCL               ,B.OMNI_CHNL_FFLMT_TYP_CDE                         09371001
BOSSC2               ,B.SLS_DTE - 2 DAYS                                09372015
093800           FROM TEPDKEY A                                         09380000
093900               ,TEPTRN B                                          09390000
094000               ,TEPPART C                                         09400000
094100          WHERE A.PRCG_DTE         = :PV-RUN-DATE-CCYY-MM-DD      09410000
094200            AND A.SLS_DTE          = C.SLS_DTE                    09420000
094300            AND B.PARTN_NBR        = C.PARTN_NBR                  09430000
094400            AND A.STR_NBR          = B.STR_NBR                    09440000
094500            AND A.RGST_ID          = B.RGST_ID                    09450000
094600            AND A.TRN_NBR          = B.TRN_NBR                    09460000
094700            AND A.STRT_TM          = B.STRT_TM                    09470000
094800            AND A.SLS_CORR_SEQ_NBR = B.SLS_CORR_SEQ_NBR           09480000
ZX                                                                      09481000
ZX    * NOTE: FOR TESTING                                               09482000
ZX                AND A.STR_NBR BETWEEN :WS-STR-LOW AND :WS-STR-HIGH    09483000
ZXTEMP*           AND A.STR_NBR IN (9923,9947,9951)                     09483100
ZX                AND A.RGST_ID BETWEEN :WS-REG-LOW AND :WS-REG-HIGH    09484000
ZX                AND A.TRN_NBR BETWEEN :WS-TRN-LOW AND :WS-TRN-HIGH    09485000
ZX                                                                      09486000
094900            AND B.VOID_ABRT_CDE    = 'N'                          09490000
095000            AND B.TRN_STAT_CDE    IN ('V','R','L')                09500000
095100            AND C.STR_GP_CDE       = 'A'                          09510000
095200            AND C.DB_STRUC_CDE     = 'O'                          09520000
095300            AND B.TRN_TYP_CDE     IN                              09530000
095400                ('01', '02', '11', '12', '22', '23', '24', '25')  09540000
095500       ORDER BY B.PARTN_NBR                                       09550000
095600               ,B.STR_NBR                                         09560000
095700               ,B.RGST_ID                                         09570000
095800               ,B.TRN_NBR                                         09580000
095900               ,B.STRT_TM                                         09590000
096000               ,B.SLS_CORR_SEQ_NBR                                09600000
096100                WITH UR                                           09610000
096200     END-EXEC.                                                    09620000
096300                                                                  09630000
096400******************************************************************09640000
096500* ITEM CURSOR                                                     09650000
096600******************************************************************09660000
096700     EXEC SQL                                                     09670000
096800        DECLARE TEPITM-CURSOR CURSOR FOR                          09680000
096900         SELECT LNE_ITM_SEQ_NBR                                   09690000
097000               ,LIV_RSLU_CDE                                      09700000
097100               ,DEPT_NBR                                          09710000
097200               ,SUB_CL_NBR                                        09720000
097300               ,SLD_QTY                                           09730000
097400               ,NET_CHRGD_AMT                                     09740000
097500               ,SAL_TYP_CDE                                       09750000
097600               ,SAL_RET_CDE                                       09760000
097700               ,DEPT_CL_ERR_CDE                                   09770000
097800               ,SKU_ERR_CDE                                       09780000
097900               ,PRIC_SRC_CDE                                      09790000
098000               ,CUST_CHRGD_AMT                                    09800000
098100               ,REG_RTL_AMT                                       09810000
098200               ,ADITEM_NBR                                        09820000
098300               ,UNT_COST_AMT                                      09830000
098400               ,OWND_UNT_RTL_AMT                                  09840000
098500               ,OWNSHP_CDE                                        09850000
098600               ,REG_RTL_ORGN_CDE                                  09860000
098700               ,SKU_NBR                                           09870000
098800               ,MAJ_CL_NBR                                        09880000
098900               ,PROMO_INTFC_ID                                    09890000
214615               ,PROMO_SCHM_CDE                                    09890100
099000               ,OWND_UNT_RTL_ORIG_AMT                             09900000
099100               ,ITM_STAT_CDE                                      09910000
214615               ,ORIG_SAL_TYP_CDE                                  09910100
214615               ,ORIG_REG_RTL_AMT                                  09910200
099200           FROM TEPITM                                            09920000
099300          WHERE PARTN_NBR        = :PV-PARTN-NBR                  09930000
099400            AND STR_NBR          = :PV-STR-NBR                    09940000
099500            AND RGST_ID          = :PV-RGST-ID                    09950000
099600            AND TRN_NBR          = :PV-TRN-NBR                    09960000
099700            AND STRT_TM          = :PV-STRT-TM                    09970000
099800            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           09980000
099900            AND LIV_RSLU_CDE    IN ('+', '-')                     09990000
ZX                                                                      09990100
ZX    * TESTING PURPOSES                                                09991000
ZX                AND SKU_NBR BETWEEN :WS-SKU-LOW AND :WS-SKU-HIGH      09992000
ZX                                                                      09993000
100000                                                                  10000000
100100       ORDER BY LNE_ITM_SEQ_NBR                                   10010000
100200                WITH UR                                           10020000
100300                OPTIMIZE FOR 5 ROWS                               10030000
100400     END-EXEC.                                                    10040000
100500                                                                  10050000
100600******************************************************************10060000
100700* LINE ITEM DISCOUNT CURSOR                                       10070000
100800******************************************************************10080000
100900     EXEC SQL                                                     10090000
101000        DECLARE TEPLID-CURSOR CURSOR FOR                          10100000
ZX             SELECT LID_SEQ_NBR                                       10101000
ZX                   ,LID_AMT                                           10102000
ZX                   ,LID_RSN_CDE                                       10103000
101300           FROM TEPLID                                            10130000
101400          WHERE PARTN_NBR        = :PV-PARTN-NBR                  10140000
101500            AND STR_NBR          = :PV-STR-NBR                    10150000
101600            AND RGST_ID          = :PV-RGST-ID                    10160000
101700            AND TRN_NBR          = :PV-TRN-NBR                    10170000
101800            AND STRT_TM          = :PV-STRT-TM                    10180000
101900            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           10190000
102000            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            10200000
102100            AND LID_TYP_CDE     NOT IN ('E', 'G')                 10210000
ZX           ORDER BY LID_SEQ_NBR DESC                                  10211000
102400                WITH UR                                           10240000
102500                OPTIMIZE FOR 2 ROWS                               10250000
102600     END-EXEC.                                                    10260000
102700                                                                  10270000
102800******************************************************************10280000
102900 PROCEDURE DIVISION.                                              10290000
103000******************************************************************10300000
103100                                                                  10310000
103200******************************************************************10320000
103300 0000-MAINLINE-PARAGRAPH.                                         10330000
103400******************************************************************10340000
103500                                                                  10350000
BOSSC2*    DISPLAY 'PROCESSING SAKUT800 FIX 4 VERSION'.                 10351034
SEPHOR     DISPLAY 'PROCESSING SAKUT800 SEPHORA VERSION'.               10351135
119200                                                                  10352013
103600     PERFORM 1000-HOUSEKEEPING.                                   10360000
103700                                                                  10370000
104200     PERFORM 1200-FORMAT-HEADINGS.                                10420000
104300                                                                  10430000
104400     PERFORM 2000-OPEN-TRAN-CURSOR.                               10440000
104500                                                                  10450000
104600     PERFORM 2200-FETCH-TRAN-CURSOR                               10460000
104700        UNTIL PS-END-OF-TRAN-YES.                                 10470000
104800                                                                  10480000
104900     PERFORM 2400-CLOSE-TRAN-CURSOR.                              10490000
105000                                                                  10500000
105100     PERFORM 6000-OPEN-DKEY-CURSOR.                               10510000
105200                                                                  10520000
105300     MOVE ZEROS TO  WS-CMT-CNT.                                   10530000
105400     PERFORM 6100-FETCH-DKEY-CURSOR                               10540000
105500        UNTIL PS-END-OF-DKEY-YES.                                 10550000
105600                                                                  10560000
105700     PERFORM 6200-CLOSE-DKEY-CURSOR.                              10570000
105800                                                                  10580000
105900     PERFORM 1500-PROCESS-PROGRAM-TOTALS                          10590000
106000         VARYING PV-TOT-SUB FROM 1 BY 1                           10600000
106100             UNTIL PV-TOT-SUB GREATER THAN 5.                     10610000
106200                                                                  10620000
106300     DISPLAY '**************************************'.            10630000
106400     DISPLAY 'FILE MARKDOWN / MARKDOWN CANCEL TOTALS'.            10640000
106500     DISPLAY 'FOR CURENT DAY PROCEC(NOT INCLUDING LATES/CORRCTS)'.10650000
106600     DISPLAY 'PV-TOTAL-MKDN-AMT= ' PV-TOTAL-MKDN-AMT.             10660000
106700     DISPLAY 'PV-TOTAL-MKDNCAN-AMT= ' PV-TOTAL-MKDNCAN-AMT.       10670000
106800     DISPLAY '**************************************'.            10680000
106900                                                                  10690000
107000     PERFORM 9000-EOJ-ROUTINE.                                    10700000
107100                                                                  10710000
107200     STOP RUN.                                                    10720000
107300                                                                  10730000
107400******************************************************************10740000
107500 1000-HOUSEKEEPING.                                               10750000
107600*     OPEN FILES, READ INPUT FILE, CALL ROUTINES TO VALIDATE,    *10760000
107700*     CALCULATE, AND POPULATE FIELDS.                            *10770000
107800******************************************************************10780000
107900                                                                  10790000
108000     OPEN INPUT POS-DATE-FILE                                     10800000
108100         OUTPUT LEDGER-MARKDOWN-FILE                              10810000
108200                LEDGER-MARKUP-FILE                                10820000
108500                HOLD-LEDGER-MARKDOWN-FILE                         10850000
108600                HOLD-LEDGER-MARKUP-FILE                           10860000
108900                DATAWHSE-FILE                                     10890000
ZX                    DAY02-TRANS-REPORT                                10891000
ZXC                   CRITE-TRANS-REPORT                                10892000
109000                MERCH-LEDGER-REPORT.                              10900000
109100                                                                  10910000
109200     READ POS-DATE-FILE            INTO CC-CONTROL-CARD           10910120
109300        AT END                                                    10910220
109400           SET PS-END-OF-CARD-FILE   TO TRUE.                     10910320
109500                                                                  10910420
109600     CLOSE POS-DATE-FILE.                                         10910520
109700                                                                  10910620
109800     IF PS-END-OF-CARD-FILE                                       10910720
109900         MOVE '1000-HOUSEKEEPING'    TO PV-PARAGRAPH-NAME         10910820
110000         MOVE 'NO INPUT TO PROCESS'  TO PV-OPERATION-MSG-1        10910920
110100         SET AC-CONTROL-CARD-ERROR   TO TRUE                      10911020
110200         PERFORM 9999-ABEND                                       10911120
110300     END-IF.                                                      10911220
110400                                                                  10911320
110500     DISPLAY PC-CURRENT-PROGRAM-NAME                              10911420
110600             ' - CONTROL CARD = (' CC-CONTROL-CARD-DISPLAY ')'.   10911520
110700                                                                  10911620
103800     PERFORM 1115-CONVERT-INPUT-DATE.                             10911720
103900                                                                  10911820
104000     PERFORM 1116-CALCULATE-CUTOFF-DATE.                          10911920
BOSSC3                                                                  10912020
BOSSC3     PERFORM 1150-GET-PARTN-NBR.                                  10912120
BOSSC3                                                                  10912220
ZX         ACCEPT CNTL-CARD FROM SYSIN.                                 10912300
BOSSC3*    MOVE WS-CNTL-PRT TO WS-PRT.                                  10912420
ZX         MOVE WS-CNTL-STR TO WS-STR.                                  10912500
ZX         MOVE WS-CNTL-REG TO WS-REG.                                  10913000
ZX         MOVE WS-CNTL-TRN TO WS-TRN.                                  10914000
ZX         MOVE WS-CNTL-SKU TO WS-SKU.                                  10915000
ZX         DISPLAY 'PROCESSING PRT: ' WS-PRT '  '                       10915100
ZX                            'STR: ' WS-STR '  '                       10915200
ZX                            'REG: ' WS-REG '  '                       10915400
ZX                            'TRN: ' WS-TRN '  '                       10915500
ZX                            'SKU: ' WS-SKU.                           10915600
ZX         IF WS-CNTL-SKU NOT = ZEROES                                  10915700
ZX             SET PS-SKU-SPECIFIC-RUN-Y TO TRUE                        10915800
ZX             DISPLAY 'SKU SPECIFIC RUN'                               10915900
ZX             MOVE  WS-PRT           TO WS-PRT-LOW                     10916000
ZX             MOVE  WS-STR           TO WS-STR-LOW                     10916100
ZX             MOVE  WS-REG           TO WS-REG-LOW                     10916200
ZX             MOVE  WS-TRN           TO WS-TRN-LOW                     10916300
ZX             MOVE  WS-SKU           TO WS-SKU-LOW                     10916400
ZX             MOVE  WS-STR           TO WS-STR-HIGH                    10916500
ZX             MOVE  WS-REG           TO WS-REG-HIGH                    10916600
ZX             MOVE  WS-TRN           TO WS-TRN-HIGH                    10916700
ZX             MOVE  WS-SKU           TO WS-SKU-HIGH                    10916800
ZX                                                                      10916900
ZX         ELSE                                                         10917000
ZX             SET PS-SKU-SPECIFIC-RUN-N TO TRUE                        10917100
ZX             MOVE  0                TO WS-PRT-LOW                     10917200
ZX             MOVE  0                TO WS-STR-LOW                     10917300
ZX             MOVE  0                TO WS-REG-LOW                     10917400
ZX             MOVE  0                TO WS-TRN-LOW                     10917500
ZX             MOVE  0                TO WS-SKU-LOW                     10917600
ZX             MOVE  9999             TO WS-STR-HIGH                    10917700
ZX             MOVE  9999             TO WS-REG-HIGH                    10917800
ZX             MOVE  9999             TO WS-TRN-HIGH                    10917900
ZX             MOVE  99999999         TO WS-SKU-HIGH                    10918000
ZX         END-IF.                                                      10918100
ZX         IF WS-PRT NOT = ZEROES                                       10918200
ZX             MOVE  WS-PRT           TO WS-PRT-LOW                     10918300
ZX                                       WS-PRT-HIGH                    10918400
ZX         ELSE                                                         10918500
ZX             MOVE  5                TO WS-PRT-LOW                     10918600
ZX             MOVE  500              TO WS-PRT-HIGH                    10918700
ZX         END-IF.                                                      10918800
ZX         IF WS-STR NOT = ZEROES                                       10918900
ZX             MOVE  WS-STR           TO WS-STR-LOW                     10919000
ZX                                       WS-STR-HIGH                    10919100
ZX         ELSE                                                         10919200
ZX             MOVE  0                TO WS-STR-LOW                     10919300
ZX             MOVE  9999             TO WS-STR-HIGH                    10919400
ZX         END-IF.                                                      10919500
ZX         IF WS-REG NOT = ZEROES                                       10919600
ZX             MOVE  WS-REG           TO WS-REG-LOW                     10919700
ZX                                       WS-REG-HIGH                    10919800
ZX         ELSE                                                         10919900
ZX             MOVE  0                TO WS-REG-LOW                     10920000
ZX             MOVE  9999             TO WS-REG-HIGH                    10920100
ZX         END-IF.                                                      10920200
ZX         IF WS-TRN NOT = ZEROES                                       10920300
ZX             MOVE  WS-TRN           TO WS-TRN-LOW                     10920400
ZX                                       WS-TRN-HIGH                    10920500
ZX         ELSE                                                         10920600
ZX             MOVE  0                TO WS-TRN-LOW                     10920700
ZX             MOVE  9999             TO WS-TRN-HIGH                    10920800
ZX         END-IF.                                                      10920900
ZX                                                                      10921000
ZX         DISPLAY '                '.                                  10921100
ZX         DISPLAY 'PRT LOW: ', WS-PRT-LOW,                             10921200
ZX                 ' PRT HIGH: ', WS-PRT-HIGH,                          10921300
ZX                 ' STR LOW: ', WS-STR-LOW,                            10921400
ZX                 ' STR HIGH: ', WS-STR-HIGH,                          10921600
ZX                 ' REG LOW: ', WS-REG-LOW,                            10921700
ZX                 ' REG HIGH: ', WS-REG-HIGH,                          10921800
ZX                 ' TRN LOW: ', WS-TRN-LOW,                            10921900
ZX                 ' TRN HIGH: ', WS-TRN-HIGH,                          10922000
ZX                 ' SKU LOW: ', WS-SKU-LOW,                            10922100
ZX                 ' SKU HIGH: ', WS-SKU-HIGH.                          10922200
ZX         DISPLAY '                '.                                  10922300
104100                                                                  11074020
110800******************************************************************11080000
110900 1115-CONVERT-INPUT-DATE.                                         11090000
111000*     KOHLS CALENDAR ROUTINE. VALIDATES INPUT DATE.               11100000
111100******************************************************************11110000
111200                                                                  11120000
111300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11130000
111400                                                                  11140000
111500     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     11150000
111600     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     11160000
111700     SET DPG52-LK-DTE-GREG           TO TRUE.                     11170000
111800                                                                  11180000
111900     MOVE CC-POS-DATE-MMDDYY         TO DPG52-LK-DATE-INPUT.      11190000
112000                                                                  11200000
112100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11210000
112200                                             DPG54 DPG55 DPG56.   11220000
112300                                                                  11230000
112400     EVALUATE TRUE                                                11240000
112500        WHEN DPG54-SEVERE-ERROR                                   11250000
112600        WHEN DPG54-DATE-INVALID                                   11260000
112700           MOVE '1115-CONVERT-INPUT-DATE'                         11270000
112800                                     TO PV-PARAGRAPH-NAME         11280000
112900           MOVE 'INPUT DATE ERROR'   TO PV-OPERATION-MSG-1        11290000
113000           SET AC-CALENDAR-ERROR     TO TRUE                      11300000
113100           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        11310000
113200           PERFORM 9999-ABEND                                     11320000
113300     END-EVALUATE.                                                11330000
113400                                                                  11340000
113500     MOVE DPG55-DB2-ISO-DATE-FMT     TO PV-RUN-DATE-CCYY-MM-DD.   11350000
113600                                                                  11360000
113700******************************************************************11370000
113800 1116-CALCULATE-CUTOFF-DATE.                                      11380000
113900*     KOHLS CALENDAR ROUTINE. CALCULATE THE CUTOFF DATE.          11390000
114000******************************************************************11400000
114100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11410000
114200                                                                  11420000
114300     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     11430000
114400     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     11440000
114500     SET DPG52-LK-DTE-GREG           TO TRUE.                     11450000
114600                                                                  11460000
114700     MOVE CC-POS-DATE-MMDDYY         TO DPG52-LK-DATE-INPUT.      11470000
114800                                                                  11480000
114900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11490000
115000                                             DPG54 DPG55 DPG56.   11500000
115100                                                                  11510000
115200     EVALUATE TRUE                                                11520000
115300        WHEN DPG54-SEVERE-ERROR                                   11530000
115400        WHEN DPG54-DATE-INVALID                                   11540000
115500           MOVE '1116-CALCULATE-CUTOFF-DATE'                      11550000
115600                                     TO PV-PARAGRAPH-NAME         11560000
115700           MOVE 'INPUT DATE ERROR'   TO PV-OPERATION-MSG-1        11570000
115800           SET AC-CALENDAR-ERROR     TO TRUE                      11580000
115900           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        11590000
116000           PERFORM 9999-ABEND                                     11600000
116100     END-EVALUATE.                                                11610000
116200                                                                  11620000
116300     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-CUT-OFF-CCYY-MM-DD.    11630000
116400                                                                  11640000
116500     DISPLAY 'PV-CUT-OFF-CCYY-MM-DD - ' PV-CUT-OFF-CCYY-MM-DD     11650000
116600                                                                  11660000
116700     DISPLAY 'DPG56-FISCAL-PERIOD-NBR ------- '                   11670000
116800              DPG56-FISCAL-PERIOD-NBR                             11680000
116900     DISPLAY 'DPG56-FIRST-FISCAL-PERIOD-DAY - '                   11690000
117000              DPG56-FIRST-FP-DB2-ISO-FMT.                         11700000
117100     DISPLAY 'DPG56-LAST-FISCAL-PERIOD-DAY -- '                   11710000
117200              DPG56-LAST-FP-DB2-ISO-FMT.                          11720000
117300                                                                  11730000
117400******************************************************************11740000
117500 1117-CALCU-KOHLS-MONTH.                                          11750000
117600*     KOHLS CALENDAR ROUTINE. CALCULATE KOHLS MONTH.              11760000
117700******************************************************************11770000
117800                                                                  11780000
117900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11790000
118000                                                                  11800000
118100     SET  DPG51-FISCAL-454-CALENDAR  TO TRUE.                     11810000
118200     SET  DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                    11820000
118300     SET  DPG52-LK-DTE-ISO-FMT       TO TRUE.                     11830000
118400     MOVE EPTRN-SLS-DTE              TO DPG52-LK-DATE-INPUT.      11840000
118500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11850000
118600                                             DPG54 DPG55 DPG56.   11860000
118700     EVALUATE TRUE                                                11870000
118800        WHEN DPG54-SEVERE-ERROR                                   11880000
118900        WHEN DPG54-DATE-INVALID                                   11890000
119000           MOVE '1117-CALCU-KOHLS-MONTH'                          11900000
119100                                     TO PV-PARAGRAPH-NAME         11910000
119200           MOVE 'CALENDAR ROUTINE ERROR'                          11920000
119300                                     TO PV-OPERATION-MSG-1        11930000
119400           SET AC-CALENDAR-ERROR     TO TRUE                      11940000
119500           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        11950000
119600           PERFORM 9999-ABEND                                     11960000
119700     END-EVALUATE.                                                11970000
119800                                                                  11980000
119900     MOVE DPG56-FISCAL-PERIOD-NBR TO  PV-FISC-PERIOD-NBR-HOLD.    11990000
120000                                                                  12000000
BOSSC3******************************************************************12000120
BOSSC3 1150-GET-PARTN-NBR.                                              12001020
BOSSC3*     GET PARTITION NUMBER FOR POS DATE SPECIFIED.                12002020
BOSSC3******************************************************************12003020
BOSSC3                                                                  12010020
BOSSC3     EXEC SQL                                                     12010320
BOSSC3        SELECT  PARTN_NBR                                         12010420
BOSSC3          INTO :EPPART-PARTN-NBR                                  12010520
BOSSC3          FROM  TEPPART                                           12010620
BOSSC3         WHERE  SLS_DTE          = :PV-RUN-DATE-CCYY-MM-DD        12010720
BOSSC3           AND  STR_GP_CDE       = 'A'                            12010820
BOSSC3                WITH UR                                           12011320
BOSSC3     END-EXEC.                                                    12011420
BOSSC3                                                                  12011520
BOSSC3     EVALUATE TRUE                                                12011620
BOSSC3        WHEN SQLCODE = ZERO                                       12011720
BOSSC3           MOVE EPPART-PARTN-NBR       TO WS-PRT                  12011920
BOSSC3           DISPLAY 'PARTN NBR = '         WS-PRT                  12012020
BOSSC3        WHEN SQLCODE = PC-ROW-NOT-FOUND                           12012120
BOSSC3           MOVE '1150-GET-PARTN-NBR '  TO PV-PARAGRAPH-NAME       12012220
BOSSC3           DISPLAY 'PARTN NBR NOT FOUND'                          12012320
BOSSC3           SET AC-DB2-ERROR           TO TRUE                     12012420
BOSSC3           PERFORM 9999-ABEND                                     12012520
BOSSC3        WHEN OTHER                                                12012620
BOSSC3           MOVE '1150-GET-PARTN-NBR '  TO PV-PARAGRAPH-NAME       12012720
BOSSC3           SET AC-DB2-ERROR           TO TRUE                     12012820
BOSSC3           PERFORM 9999-ABEND                                     12012920
BOSSC3     END-EVALUATE.                                                12013020
BOSSC3                                                                  12013120
120100                                                                  12014020
120200******************************************************************12020000
120300 1200-FORMAT-HEADINGS.                                            12030000
120400*     GET CURRENT DATE AND TIME FROM SYSTEM.                      12040000
120500*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          12050000
120600*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              12060000
120700******************************************************************12070000
120800                                                                  12080000
120900     ACCEPT PV-CURRENT-DATE        FROM DATE.                     12090000
121000     ACCEPT PV-CURRENT-TIME        FROM TIME.                     12100000
121100                                                                  12110000
121200     MOVE PV-CURRENT-YEAR            TO DP132O-RUN-YEAR.          12120000
121300     MOVE PV-CURRENT-MONTH           TO DP132O-RUN-MONTH.         12130000
121400     MOVE PV-CURRENT-DAY             TO DP132O-RUN-DAY.           12140000
121500                                                                  12150000
121600     MOVE PV-CURRENT-HOUR            TO DP132O-RUN-HOUR.          12160000
121700     MOVE PV-CURRENT-MINUTE          TO DP132O-RUN-MINUTE.        12170000
121800                                                                  12180000
121900     MOVE PC-CURRENT-PROGRAM-NAME    TO DP132O-PROGRAM-NAME.      12190000
122000                                                                  12200000
122100     MOVE '1'                        TO DP132O-REPORT-NUMBER.     12210000
122200                                                                  12220000
122300     INITIALIZE DL-DETAIL-LINE.                                   12230000
122400                                                                  12240000
122500     INITIALIZE ML017-PRICE-CHANGE-RECORD.                        12250000
122600                                                                  12260000
122700     MOVE CC-POS-DATE-MM             TO HL-REPORT-MONTH           12270000
ZX                                            H2-REPORT-MONTH           12271000
122800     MOVE CC-POS-DATE-DD             TO HL-REPORT-DAY             12280000
ZX                                            H2-REPORT-DAY             12281000
122900     MOVE CC-POS-DATE-YY             TO HL-REPORT-YEAR            12290000
ZX                                            H2-REPORT-YEAR            12290100
ZX                                                                      12291000
ZX         MOVE WS-STR-LOW                 TO H2-REPORT-STR             12292000
ZX         MOVE WS-REG-LOW                 TO H2-REPORT-REG             12293000
ZX         MOVE WS-TRN-LOW                 TO H2-REPORT-TRN             12294000
ZX         MOVE WS-SKU-LOW                 TO H2-REPORT-SKU             12295000
ZX                                                                      12296000
123000                                                                  12300000
123100     PERFORM 8400-WRITE-HEADERS.                                  12310000
ZX         PERFORM 8196-WRITE-DAY02-HEADR-RECORD.                       12312000
123200                                                                  12320000
123300******************************************************************12330000
123400 1500-PROCESS-PROGRAM-TOTALS.                                     12340000
123500*  DISPLAY PROGRAM TOTALS BY MARKDOWN/MARKUP TYPE AND CATEGORY.  *12350000
123600******************************************************************12360000
123700                                                                  12370000
123800     EVALUATE PV-TOT-SUB                                          12380000
123900         WHEN 1                                                   12390000
124000             SET HD-ORIGINAL-SALES   TO TRUE                      12400000
124100         WHEN 2                                                   12410000
124200             SET HD-SALES-CORR       TO TRUE                      12420000
124300         WHEN 3                                                   12430000
124400             SET HD-LATE-TRANSACTIONS                             12440000
124500                                     TO TRUE                      12450000
124600         WHEN 4                                                   12460000
124700             SET HD-CUTOFF-SALES-CORR                             12470000
124800                                     TO TRUE                      12480000
124900         WHEN 5                                                   12490000
125000             SET HD-CUTOFF-LATE-TRANSACTIONS                      12500000
125100                                     TO TRUE                      12510000
125200     END-EVALUATE.                                                12520000
125300                                                                  12530000
125400     MOVE 2 TO PV-SPACE-CONTROL.                                  12540000
125500                                                                  12550000
125600     WRITE REPORT-LINE-OUT                                        12560000
125700         FROM HL-HEADER-LINE4                                     12570000
125800            AFTER ADVANCING PV-SPACE-CONTROL.                     12580000
125900                                                                  12590000
126000     ADD 2 TO PV-LINE-COUNT.                                      12600000
126100                                                                  12610000
126200     DISPLAY ' '.                                                 12620000
126300     DISPLAY '  '  HL-HEADER-LINE4                                12630000
126400     DISPLAY ' '.                                                 12640000
126500                                                                  12650000
126600     DISPLAY ' '.                                                 12660000
126700     DISPLAY '  '  DH-DISPLAY-HEADER.                             12670000
126800     DISPLAY ' '.                                                 12680000
126900                                                                  12690000
127000     MOVE SPACES TO DD-DISPLAY-DETAIL.                            12700000
127100     SET DD-PC-PROMOTIONAL           TO TRUE.                     12710000
127200     MOVE PT-PROMOTIONAL-MKDN-QTY (PV-TOT-SUB)                    12720000
127300                                     TO DD-MARKDOWN-QTY           12730000
127400                                        DL-MARKDOWN-QTY.          12740000
127500     ADD PT-PROMOTIONAL-MKDN-QTY (PV-TOT-SUB)                     12750000
127600                                     TO PT-TOTAL-MARKDOWN-QTY     12760000
127700                                        (PV-TOT-SUB).             12770000
127800     MOVE PT-PROMOTIONAL-MKDN-AMT (PV-TOT-SUB)                    12780000
127900                                     TO DD-MARKDOWN-AMT           12790000
128000                                        DL-MARKDOWN-AMT.          12800000
128100     ADD PT-PROMOTIONAL-MKDN-AMT (PV-TOT-SUB)                     12810000
128200                                     TO PT-TOTAL-MARKDOWN-AMT     12820000
128300                                        (PV-TOT-SUB).             12830000
128400     MOVE PT-PROMOTIONAL-MDC-QTY (PV-TOT-SUB)                     12840000
128500                                     TO DD-MARKDOWN-CANCEL-QTY    12850000
128600                                        DL-MARKDOWN-CANCEL-QTY.   12860000
128700     ADD PT-PROMOTIONAL-MDC-QTY (PV-TOT-SUB)                      12870000
128800                                     TO                           12880000
128900         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               12890000
129000     MOVE PT-PROMOTIONAL-MDC-AMT (PV-TOT-SUB)                     12900000
129100                                     TO DD-MARKDOWN-CANCEL-AMT    12910000
129200                                        DL-MARKDOWN-CANCEL-AMT.   12920000
129300     ADD PT-PROMOTIONAL-MDC-AMT (PV-TOT-SUB)                      12930000
129400                                     TO                           12940000
129500         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               12950000
129600                                                                  12960000
129700     DISPLAY '  '  DD-DISPLAY-DETAIL.                             12970000
129800     MOVE PC-PROMOTIONAL             TO DL-PRICE-CHANGE-TYPE.     12980000
129900     PERFORM 8200-WRITE-DETAIL-LINE.                              12990000
130000                                                                  13000000
130100     MOVE SPACES                     TO DD-DISPLAY-DETAIL.        13010000
130200     SET DD-PC-TIERED                TO TRUE.                     13020000
130300     MOVE PT-TIERED-MKDN-QTY (PV-TOT-SUB)                         13030000
130400                                     TO DD-MARKDOWN-QTY           13040000
130500                                        DL-MARKDOWN-QTY.          13050000
130600     ADD PT-TIERED-MKDN-QTY (PV-TOT-SUB)                          13060000
130700                                     TO PT-TOTAL-MARKDOWN-QTY     13070000
130800                                        (PV-TOT-SUB).             13080000
130900     MOVE PT-TIERED-MKDN-AMT (PV-TOT-SUB)                         13090000
131000                                     TO DD-MARKDOWN-AMT           13100000
131100                                        DL-MARKDOWN-AMT.          13110000
131200     ADD PT-TIERED-MKDN-AMT (PV-TOT-SUB)                          13120000
131300                                     TO PT-TOTAL-MARKDOWN-AMT     13130000
131400                                        (PV-TOT-SUB).             13140000
131500     MOVE PT-TIERED-MDC-QTY (PV-TOT-SUB)                          13150000
131600                                     TO DD-MARKDOWN-CANCEL-QTY    13160000
131700                                        DL-MARKDOWN-CANCEL-QTY.   13170000
131800     ADD PT-TIERED-MDC-QTY (PV-TOT-SUB)                           13180000
131900                                     TO                           13190000
132000         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               13200000
132100     MOVE PT-TIERED-MDC-AMT (PV-TOT-SUB)                          13210000
132200                                     TO DD-MARKDOWN-CANCEL-AMT    13220000
132300                                        DL-MARKDOWN-CANCEL-AMT.   13230000
132400     ADD PT-TIERED-MDC-AMT (PV-TOT-SUB)                           13240000
132500                                     TO                           13250000
132600         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               13260000
132700                                                                  13270000
132800     DISPLAY '  '  DD-DISPLAY-DETAIL.                             13280000
132900     MOVE PC-TIERED                  TO DL-PRICE-CHANGE-TYPE.     13290000
133000     PERFORM 8200-WRITE-DETAIL-LINE.                              13300000
133100                                                                  13310000
133200     MOVE SPACES                     TO DD-DISPLAY-DETAIL.        13320000
133300     SET DD-PC-GOLDSTAR              TO TRUE.                     13330000
133400     MOVE PT-GOLDSTAR-MKDN-QTY (PV-TOT-SUB)                       13340000
133500                                     TO DD-MARKDOWN-QTY           13350000
133600                                        DL-MARKDOWN-QTY.          13360000
133700     ADD PT-GOLDSTAR-MKDN-QTY (PV-TOT-SUB)                        13370000
133800                                     TO PT-TOTAL-MARKDOWN-QTY     13380000
133900                                        (PV-TOT-SUB).             13390000
134000     MOVE PT-GOLDSTAR-MKDN-AMT (PV-TOT-SUB)                       13400000
134100                                     TO DD-MARKDOWN-AMT           13410000
134200                                        DL-MARKDOWN-AMT.          13420000
134300     ADD PT-GOLDSTAR-MKDN-AMT (PV-TOT-SUB)                        13430000
134400                                     TO PT-TOTAL-MARKDOWN-AMT     13440000
134500                                        (PV-TOT-SUB).             13450000
134600     MOVE PT-GOLDSTAR-MDC-QTY (PV-TOT-SUB)                        13460000
134700                                     TO DD-MARKDOWN-CANCEL-QTY    13470000
134800                                        DL-MARKDOWN-CANCEL-QTY.   13480000
134900     ADD PT-GOLDSTAR-MDC-QTY (PV-TOT-SUB)                         13490000
135000                                     TO                           13500000
135100         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               13510000
135200     MOVE PT-GOLDSTAR-MDC-AMT (PV-TOT-SUB)                        13520000
135300                                     TO DD-MARKDOWN-CANCEL-AMT    13530000
135400                                        DL-MARKDOWN-CANCEL-AMT.   13540000
135500     ADD PT-GOLDSTAR-MDC-AMT (PV-TOT-SUB)                         13550000
135600                                     TO                           13560000
135700         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               13570000
135800                                                                  13580000
135900     DISPLAY '  '  DD-DISPLAY-DETAIL.                             13590000
136000     MOVE PC-GOLDSTAR                TO DL-PRICE-CHANGE-TYPE.     13600000
136100     PERFORM 8200-WRITE-DETAIL-LINE.                              13610000
136200                                                                  13620000
136300     MOVE SPACES TO DD-DISPLAY-DETAIL.                            13630000
136400     SET DD-PC-MANUAL-LID            TO TRUE.                     13640000
136500     MOVE PT-MANUAL-LID-MKDN-QTY (PV-TOT-SUB)                     13650000
136600                                     TO DD-MARKDOWN-QTY           13660000
136700                                        DL-MARKDOWN-QTY.          13670000
136800     ADD PT-MANUAL-LID-MKDN-QTY (PV-TOT-SUB)                      13680000
136900                                     TO PT-TOTAL-MARKDOWN-QTY     13690000
137000                                        (PV-TOT-SUB).             13700000
137100     MOVE PT-MANUAL-LID-MKDN-AMT (PV-TOT-SUB)                     13710000
137200                                     TO DD-MARKDOWN-AMT           13720000
137300                                        DL-MARKDOWN-AMT.          13730000
137400     ADD PT-MANUAL-LID-MKDN-AMT (PV-TOT-SUB)                      13740000
137500                                     TO PT-TOTAL-MARKDOWN-AMT     13750000
137600                                        (PV-TOT-SUB).             13760000
137700     MOVE PT-MANUAL-LID-MDC-QTY (PV-TOT-SUB)                      13770000
137800                                     TO DD-MARKDOWN-CANCEL-QTY    13780000
137900                                        DL-MARKDOWN-CANCEL-QTY.   13790000
138000     ADD PT-MANUAL-LID-MDC-QTY (PV-TOT-SUB)                       13800000
138100                                     TO                           13810000
138200         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               13820000
138300     MOVE PT-MANUAL-LID-MDC-AMT (PV-TOT-SUB)                      13830000
138400                                     TO DD-MARKDOWN-CANCEL-AMT    13840000
138500                                        DL-MARKDOWN-CANCEL-AMT.   13850000
138600     ADD PT-MANUAL-LID-MDC-AMT (PV-TOT-SUB)                       13860000
138700                                     TO                           13870000
138800         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               13880000
138900                                                                  13890000
139000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             13900000
139100     MOVE PC-MANUAL-LID              TO DL-PRICE-CHANGE-TYPE.     13910000
139200     PERFORM 8200-WRITE-DETAIL-LINE.                              13920000
139300                                                                  13930000
139400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            13940000
139500     SET DD-PC-OWNERSHIP-ADJUSTMENT  TO TRUE.                     13950000
139600     MOVE PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)                  13960000
139700                                     TO DD-MARKDOWN-QTY           13970000
139800                                        DL-MARKDOWN-QTY.          13980000
139900     ADD PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)                   13990000
140000                                     TO PT-TOTAL-MARKDOWN-QTY     14000000
140100                                        (PV-TOT-SUB).             14010000
140200     MOVE PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)                  14020000
140300                                     TO DD-MARKDOWN-AMT           14030000
140400                                        DL-MARKDOWN-AMT.          14040000
140500     ADD PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)                   14050000
140600                                     TO PT-TOTAL-MARKDOWN-AMT     14060000
140700                                        (PV-TOT-SUB).             14070000
140800     MOVE PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)                   14080000
140900                                 TO DD-MARKDOWN-CANCEL-QTY        14090000
141000                                    DL-MARKDOWN-CANCEL-QTY.       14100000
141100     ADD PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)                    14110000
141200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  14120000
141300                                                    (PV-TOT-SUB). 14130000
141400     MOVE PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                   14140000
141500                                 TO DD-MARKDOWN-CANCEL-AMT        14150000
141600                                    DL-MARKDOWN-CANCEL-AMT.       14160000
141700     ADD PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                    14170000
141800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  14180000
141900                                                    (PV-TOT-SUB). 14190000
142000     MOVE PT-OWNERSHIP-ADJ-MKUP-QTY (PV-TOT-SUB)                  14200000
142100                                 TO DD-MARKUP-QTY                 14210000
142200                                    DL-MARKUP-QTY.                14220000
142300     ADD PT-OWNERSHIP-ADJ-MKUP-QTY (PV-TOT-SUB)                   14230000
142400                                 TO PT-TOTAL-MARKUP-QTY           14240000
142500                                                    (PV-TOT-SUB). 14250000
142600     MOVE PT-OWNERSHIP-ADJ-MKUP-AMT (PV-TOT-SUB)                  14260000
142700                                 TO DD-MARKUP-AMT                 14270000
142800                                    DL-MARKUP-AMT.                14280000
142900     ADD PT-OWNERSHIP-ADJ-MKUP-AMT (PV-TOT-SUB)                   14290000
143000                                 TO PT-TOTAL-MARKUP-AMT           14300000
143100                                                    (PV-TOT-SUB). 14310000
143200     MOVE PT-OWNERSHIP-ADJ-MUC-QTY (PV-TOT-SUB)                   14320000
143300                                 TO DD-MARKUP-CANCEL-QTY          14330000
143400                                    DL-MARKUP-CANCEL-QTY.         14340000
143500     ADD PT-OWNERSHIP-ADJ-MUC-QTY (PV-TOT-SUB)                    14350000
143600                                 TO PT-TOTAL-MARKUP-CANCEL-QTY    14360000
143700                                                    (PV-TOT-SUB). 14370000
143800     MOVE PT-OWNERSHIP-ADJ-MUC-AMT (PV-TOT-SUB)                   14380000
143900                                 TO DD-MARKUP-CANCEL-AMT          14390000
144000                                    DL-MARKUP-CANCEL-AMT.         14400000
144100     ADD PT-OWNERSHIP-ADJ-MUC-AMT (PV-TOT-SUB)                    14410000
144200                                 TO PT-TOTAL-MARKUP-CANCEL-AMT    14420000
144300                                                    (PV-TOT-SUB). 14430000
144400                                                                  14440000
144500     DISPLAY '  '  DD-DISPLAY-DETAIL.                             14450000
144600     MOVE PC-OWNERSHIP-ADJ TO DL-PRICE-CHANGE-TYPE.               14460000
144700     PERFORM 8200-WRITE-DETAIL-LINE.                              14470000
144800                                                                  14480000
144900     MOVE SPACES TO DD-DISPLAY-DETAIL.                            14490000
145000     SET DD-PC-OWN-RETRN-ADJUSTMENT TO TRUE.                      14500000
145100     MOVE PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)                  14510000
145200                                 TO DD-MARKDOWN-QTY               14520000
145300                                    DL-MARKDOWN-QTY.              14530000
145400     ADD PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)                   14540000
145500                                 TO PT-TOTAL-MARKDOWN-QTY         14550000
145600                                                    (PV-TOT-SUB). 14560000
145700     MOVE PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)                  14570000
145800                                 TO DD-MARKDOWN-AMT               14580000
145900                                    DL-MARKDOWN-AMT.              14590000
146000     ADD PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)                   14600000
146100                                 TO PT-TOTAL-MARKDOWN-AMT         14610000
146200                                                    (PV-TOT-SUB). 14620000
146300     MOVE PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB)                   14630000
146400                                 TO DD-MARKDOWN-CANCEL-QTY        14640000
146500                                    DL-MARKDOWN-CANCEL-QTY.       14650000
146600     ADD PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB)                    14660000
146700                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  14670000
146800                                                    (PV-TOT-SUB). 14680000
146900     MOVE PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB)                   14690000
147000                                 TO DD-MARKDOWN-CANCEL-AMT        14700000
147100                                    DL-MARKDOWN-CANCEL-AMT.       14710000
147200     ADD PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB)                    14720000
147300                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  14730000
147400                                                    (PV-TOT-SUB). 14740000
147500     MOVE PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB)                  14750000
147600                                 TO DD-MARKUP-QTY                 14760000
147700                                    DL-MARKUP-QTY.                14770000
147800     ADD PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB)                   14780000
147900                                 TO PT-TOTAL-MARKUP-QTY           14790000
148000                                                    (PV-TOT-SUB). 14800000
148100     MOVE PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB)                  14810000
148200                                 TO DD-MARKUP-AMT                 14820000
148300                                    DL-MARKUP-AMT.                14830000
148400     ADD PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB)                   14840000
148500                                 TO PT-TOTAL-MARKUP-AMT           14850000
148600                                                    (PV-TOT-SUB). 14860000
148700     MOVE PT-OWN-RETRN-ADJ-MUC-QTY (PV-TOT-SUB)                   14870000
148800                                 TO DD-MARKUP-CANCEL-QTY          14880000
148900                                    DL-MARKUP-CANCEL-QTY.         14890000
149000     ADD PT-OWN-RETRN-ADJ-MUC-QTY (PV-TOT-SUB)                    14900000
149100                                 TO PT-TOTAL-MARKUP-CANCEL-QTY    14910000
149200                                                    (PV-TOT-SUB). 14920000
149300     MOVE PT-OWN-RETRN-ADJ-MUC-AMT (PV-TOT-SUB)                   14930000
149400                                 TO DD-MARKUP-CANCEL-AMT          14940000
149500                                    DL-MARKUP-CANCEL-AMT.         14950000
149600     ADD PT-OWN-RETRN-ADJ-MUC-AMT (PV-TOT-SUB)                    14960000
149700                                 TO PT-TOTAL-MARKUP-CANCEL-AMT    14970000
149800                                                    (PV-TOT-SUB). 14980000
149900                                                                  14990000
150000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15000000
150100     MOVE PC-OWN-RETRN-ADJ TO DL-PRICE-CHANGE-TYPE.               15010000
150200     PERFORM 8200-WRITE-DETAIL-LINE.                              15020000
150300                                                                  15030000
150400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15040000
150500     SET DD-PC-SENIOR-CITIZEN TO TRUE.                            15050000
150600     MOVE PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)                 15060000
150700                                 TO DD-MARKDOWN-QTY               15070000
150800                                    DL-MARKDOWN-QTY.              15080000
150900     ADD PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)                  15090000
151000                                 TO PT-TOTAL-MARKDOWN-QTY         15100000
151100                                                    (PV-TOT-SUB). 15110000
151200     MOVE PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)                 15120000
151300                                 TO DD-MARKDOWN-AMT               15130000
151400                                    DL-MARKDOWN-AMT.              15140000
151500     ADD PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)                  15150000
151600                                 TO PT-TOTAL-MARKDOWN-AMT         15160000
151700                                                    (PV-TOT-SUB). 15170000
151800     MOVE PT-SENIOR-CITIZEN-MDC-QTY (PV-TOT-SUB)                  15180000
151900                                 TO DD-MARKDOWN-CANCEL-QTY        15190000
152000                                    DL-MARKDOWN-CANCEL-QTY.       15200000
152100     ADD PT-SENIOR-CITIZEN-MDC-QTY (PV-TOT-SUB)                   15210000
152200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  15220000
152300                                                    (PV-TOT-SUB). 15230000
152400     MOVE PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)                  15240000
152500                                 TO DD-MARKDOWN-CANCEL-AMT        15250000
152600                                    DL-MARKDOWN-CANCEL-AMT.       15260000
152700     ADD PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)                   15270000
152800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  15280000
152900                                                    (PV-TOT-SUB). 15290000
153000                                                                  15300000
153100     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15310000
153200     MOVE PC-SENIOR-CITIZEN TO DL-PRICE-CHANGE-TYPE.              15320000
153300     PERFORM 8200-WRITE-DETAIL-LINE.                              15330000
153400                                                                  15340000
153500     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15350000
153600     SET DD-PC-KOHLS-COUPON TO TRUE.                              15360000
153700     MOVE PT-KOHLS-COUPON-MKDN-QTY (PV-TOT-SUB)                   15370000
153800                                 TO DD-MARKDOWN-QTY               15380000
153900                                    DL-MARKDOWN-QTY.              15390000
154000     ADD PT-KOHLS-COUPON-MKDN-QTY (PV-TOT-SUB)                    15400000
154100                                 TO PT-TOTAL-MARKDOWN-QTY         15410000
154200                                                    (PV-TOT-SUB). 15420000
154300     MOVE PT-KOHLS-COUPON-MKDN-AMT (PV-TOT-SUB)                   15430000
154400                                 TO DD-MARKDOWN-AMT               15440000
154500                                    DL-MARKDOWN-AMT.              15450000
154600     ADD PT-KOHLS-COUPON-MKDN-AMT (PV-TOT-SUB)                    15460000
154700                                 TO PT-TOTAL-MARKDOWN-AMT         15470000
154800                                                    (PV-TOT-SUB). 15480000
154900     MOVE PT-KOHLS-COUPON-MDC-QTY (PV-TOT-SUB)                    15490000
155000                                 TO DD-MARKDOWN-CANCEL-QTY        15500000
155100                                    DL-MARKDOWN-CANCEL-QTY.       15510000
155200     ADD PT-KOHLS-COUPON-MDC-QTY (PV-TOT-SUB)                     15520000
155300                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  15530000
155400                                                    (PV-TOT-SUB). 15540000
155500     MOVE PT-KOHLS-COUPON-MDC-AMT (PV-TOT-SUB)                    15550000
155600                                 TO DD-MARKDOWN-CANCEL-AMT        15560000
155700                                    DL-MARKDOWN-CANCEL-AMT.       15570000
155800     ADD PT-KOHLS-COUPON-MDC-AMT (PV-TOT-SUB)                     15580000
155900                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  15590000
156000                                                    (PV-TOT-SUB). 15600000
156100     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15610000
156200     MOVE PC-KOHLS-COUPON TO DL-PRICE-CHANGE-TYPE.                15620000
156300     PERFORM 8200-WRITE-DETAIL-LINE.                              15630000
156400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15640000
156500     SET DD-PC-OFFER-COUPON TO TRUE.                              15650000
156600     MOVE PT-760-OFFER-MKDN-QTY (PV-TOT-SUB)                      15660000
156700                                 TO DD-MARKDOWN-QTY               15670000
156800                                    DL-MARKDOWN-QTY.              15680000
156900     ADD PT-760-OFFER-MKDN-QTY (PV-TOT-SUB)                       15690000
157000                                 TO PT-TOTAL-MARKDOWN-QTY         15700000
157100                                                    (PV-TOT-SUB). 15710000
157200     MOVE PT-760-OFFER-MKDN-AMT (PV-TOT-SUB)                      15720000
157300                                 TO DD-MARKDOWN-AMT               15730000
157400                                    DL-MARKDOWN-AMT.              15740000
157500     ADD PT-760-OFFER-MKDN-AMT (PV-TOT-SUB)                       15750000
157600                                 TO PT-TOTAL-MARKDOWN-AMT         15760000
157700                                                    (PV-TOT-SUB). 15770000
157800     MOVE PT-760-OFFER-MDC-QTY (PV-TOT-SUB)                       15780000
157900                                 TO DD-MARKDOWN-CANCEL-QTY        15790000
158000                                    DL-MARKDOWN-CANCEL-QTY.       15800000
158100     ADD PT-760-OFFER-MDC-QTY (PV-TOT-SUB)                        15810000
158200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  15820000
158300                                                    (PV-TOT-SUB). 15830000
158400     MOVE PT-760-OFFER-MDC-AMT (PV-TOT-SUB)                       15840000
158500                                 TO DD-MARKDOWN-CANCEL-AMT        15850000
158600                                    DL-MARKDOWN-CANCEL-AMT.       15860000
158700     ADD PT-760-OFFER-MDC-AMT (PV-TOT-SUB)                        15870000
158800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  15880000
158900                                                    (PV-TOT-SUB). 15890000
159000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15900000
159100     MOVE PC-OFFER-COUPON TO DL-PRICE-CHANGE-TYPE.                15910000
159200     PERFORM 8200-WRITE-DETAIL-LINE.                              15920000
159300                                                                  15930000
159400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15940000
159500     SET DD-PC-OFFER-TLD-TIERED TO TRUE.                          15950000
159600     MOVE PT-761-TLDTIER-MKDN-QTY (PV-TOT-SUB)                    15960000
159700                                 TO DD-MARKDOWN-QTY               15970000
159800                                    DL-MARKDOWN-QTY.              15980000
159900     ADD PT-761-TLDTIER-MKDN-QTY (PV-TOT-SUB)                     15990000
160000                                 TO PT-TOTAL-MARKDOWN-QTY         16000000
160100                                                    (PV-TOT-SUB). 16010000
160200     MOVE PT-761-TLDTIER-MKDN-AMT (PV-TOT-SUB)                    16020000
160300                                 TO DD-MARKDOWN-AMT               16030000
160400                                    DL-MARKDOWN-AMT.              16040000
160500     ADD PT-761-TLDTIER-MKDN-AMT (PV-TOT-SUB)                     16050000
160600                                 TO PT-TOTAL-MARKDOWN-AMT         16060000
160700                                                    (PV-TOT-SUB). 16070000
160800     MOVE PT-761-TLDTIER-MDC-QTY (PV-TOT-SUB)                     16080000
160900                                 TO DD-MARKDOWN-CANCEL-QTY        16090000
161000                                    DL-MARKDOWN-CANCEL-QTY.       16100000
161100     ADD PT-761-TLDTIER-MDC-QTY (PV-TOT-SUB)                      16110000
161200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16120000
161300                                                    (PV-TOT-SUB). 16130000
161400     MOVE PT-761-TLDTIER-MDC-AMT (PV-TOT-SUB)                     16140000
161500                                 TO DD-MARKDOWN-CANCEL-AMT        16150000
161600                                    DL-MARKDOWN-CANCEL-AMT.       16160000
161700     ADD PT-761-TLDTIER-MDC-AMT (PV-TOT-SUB)                      16170000
161800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16180000
161900                                                    (PV-TOT-SUB). 16190000
162000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16200000
162100     MOVE PC-OFFER-TLD-TIERED  TO DL-PRICE-CHANGE-TYPE.           16210000
162200     PERFORM 8200-WRITE-DETAIL-LINE.                              16220000
162300                                                                  16230000
162400                                                                  16240000
162500     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16250000
162600     SET DD-PC-OFFER-LID-TIERED TO TRUE.                          16260000
162700     MOVE PT-762-LIDTIER-MKDN-QTY (PV-TOT-SUB)                    16270000
162800                                 TO DD-MARKDOWN-QTY               16280000
162900                                    DL-MARKDOWN-QTY.              16290000
163000     ADD PT-762-LIDTIER-MKDN-QTY (PV-TOT-SUB)                     16300000
163100                                 TO PT-TOTAL-MARKDOWN-QTY         16310000
163200                                                    (PV-TOT-SUB). 16320000
163300     MOVE PT-762-LIDTIER-MKDN-AMT (PV-TOT-SUB)                    16330000
163400                                 TO DD-MARKDOWN-AMT               16340000
163500                                    DL-MARKDOWN-AMT.              16350000
163600     ADD PT-762-LIDTIER-MKDN-AMT (PV-TOT-SUB)                     16360000
163700                                 TO PT-TOTAL-MARKDOWN-AMT         16370000
163800                                                    (PV-TOT-SUB). 16380000
163900     MOVE PT-762-LIDTIER-MDC-QTY (PV-TOT-SUB)                     16390000
164000                                 TO DD-MARKDOWN-CANCEL-QTY        16400000
164100                                    DL-MARKDOWN-CANCEL-QTY.       16410000
164200     ADD PT-762-LIDTIER-MDC-QTY (PV-TOT-SUB)                      16420000
164300                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16430000
164400                                                    (PV-TOT-SUB). 16440000
164500     MOVE PT-762-LIDTIER-MDC-AMT (PV-TOT-SUB)                     16450000
164600                                 TO DD-MARKDOWN-CANCEL-AMT        16460000
164700                                    DL-MARKDOWN-CANCEL-AMT.       16470000
164800     ADD PT-762-LIDTIER-MDC-AMT (PV-TOT-SUB)                      16480000
164900                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16490000
165000                                                    (PV-TOT-SUB). 16500000
165100     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16510000
165200     MOVE PC-OFFER-LID-TIERED  TO DL-PRICE-CHANGE-TYPE.           16520000
165300     PERFORM 8200-WRITE-DETAIL-LINE.                              16530000
165400                                                                  16540000
165500                                                                  16550000
165600     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16560000
165700     SET DD-PC-OFFER-GWP-PWP    TO TRUE.                          16570000
165800     MOVE PT-763-GWPPWP-MKDN-QTY (PV-TOT-SUB)                     16580000
165900                                 TO DD-MARKDOWN-QTY               16590000
166000                                    DL-MARKDOWN-QTY.              16600000
166100     ADD PT-763-GWPPWP-MKDN-QTY (PV-TOT-SUB)                      16610000
166200                                 TO PT-TOTAL-MARKDOWN-QTY         16620000
166300                                                    (PV-TOT-SUB). 16630000
166400     MOVE PT-763-GWPPWP-MKDN-AMT (PV-TOT-SUB)                     16640000
166500                                 TO DD-MARKDOWN-AMT               16650000
166600                                    DL-MARKDOWN-AMT.              16660000
166700     ADD PT-763-GWPPWP-MKDN-AMT (PV-TOT-SUB)                      16670000
166800                                 TO PT-TOTAL-MARKDOWN-AMT         16680000
166900                                                    (PV-TOT-SUB). 16690000
167000     MOVE PT-763-GWPPWP-MDC-QTY (PV-TOT-SUB)                      16700000
167100                                 TO DD-MARKDOWN-CANCEL-QTY        16710000
167200                                    DL-MARKDOWN-CANCEL-QTY.       16720000
167300     ADD PT-763-GWPPWP-MDC-QTY (PV-TOT-SUB)                       16730000
167400                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16740000
167500                                                    (PV-TOT-SUB). 16750000
167600     MOVE PT-763-GWPPWP-MDC-AMT (PV-TOT-SUB)                      16760000
167700                                 TO DD-MARKDOWN-CANCEL-AMT        16770000
167800                                    DL-MARKDOWN-CANCEL-AMT.       16780000
167900     ADD PT-763-GWPPWP-MDC-AMT (PV-TOT-SUB)                       16790000
168000                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16800000
168100                                                    (PV-TOT-SUB). 16810000
168200                                                                  16820000
168300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16830000
168400     MOVE PC-OFFER-GWP-PWP     TO DL-PRICE-CHANGE-TYPE.           16840000
168500     PERFORM 8200-WRITE-DETAIL-LINE.                              16850000
205464                                                                  16860000
205464     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16861000
205464     SET DD-NON-RCPT-RTRN        TO TRUE.                         16862000
205464     MOVE PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)                     16863000
205464                                 TO DD-MARKDOWN-QTY               16864000
205464                                    DL-MARKDOWN-QTY.              16865000
205464     ADD PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)                      16866000
205464                                 TO PT-TOTAL-MARKDOWN-QTY         16867000
205464                                                    (PV-TOT-SUB). 16868000
205464     MOVE PT-710-NORCPT-MKDN-AMT (PV-TOT-SUB)                     16869000
205464                                 TO DD-MARKDOWN-AMT               16869100
205464                                    DL-MARKDOWN-AMT.              16869200
205464     ADD PT-710-NORCPT-MKDN-AMT (PV-TOT-SUB)                      16869300
205464                                 TO PT-TOTAL-MARKDOWN-AMT         16869400
205464                                                    (PV-TOT-SUB). 16869500
205464     MOVE PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)                      16869600
205464                                 TO DD-MARKDOWN-CANCEL-QTY        16869700
205464                                    DL-MARKDOWN-CANCEL-QTY.       16869800
205464     ADD PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)                       16869900
205464                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16870000
205464                                                    (PV-TOT-SUB). 16870100
205464     MOVE PT-710-NORCPT-MDC-AMT (PV-TOT-SUB)                      16870200
205464                                 TO DD-MARKDOWN-CANCEL-AMT        16870300
205464                                    DL-MARKDOWN-CANCEL-AMT.       16870400
205464     ADD PT-710-NORCPT-MDC-AMT (PV-TOT-SUB)                       16870500
205464                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16870600
205464                                                    (PV-TOT-SUB). 16870700
205464     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16870800
205464     MOVE PC-NON-REC-RETURN    TO DL-PRICE-CHANGE-TYPE.           16870900
205464     PERFORM 8200-WRITE-DETAIL-LINE.                              16871000
168600                                                                  16871100
168700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16872000
168800     SET DD-PC-GFT-RCPT-RTRN     TO TRUE.                         16880000
168900     MOVE PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)                       16890000
169000                                 TO DD-MARKDOWN-QTY               16900000
169100                                    DL-MARKDOWN-QTY.              16910000
169200     ADD PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)                        16920000
169300                                 TO PT-TOTAL-MARKDOWN-QTY         16930000
169400                                                    (PV-TOT-SUB). 16940000
169500     MOVE PT-765-GIFT-MKDN-AMT (PV-TOT-SUB)                       16950000
169600                                 TO DD-MARKDOWN-AMT               16960000
169700                                    DL-MARKDOWN-AMT.              16970000
169800     ADD PT-765-GIFT-MKDN-AMT (PV-TOT-SUB)                        16980000
169900                                 TO PT-TOTAL-MARKDOWN-AMT         16990000
170000                                                    (PV-TOT-SUB). 17000000
170100     MOVE PT-765-GIFT-MDC-QTY (PV-TOT-SUB)                        17010000
170200                                 TO DD-MARKDOWN-CANCEL-QTY        17020000
170300                                    DL-MARKDOWN-CANCEL-QTY.       17030000
170400     ADD PT-765-GIFT-MDC-QTY (PV-TOT-SUB)                         17040000
170500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17050000
170600                                                    (PV-TOT-SUB). 17060000
170700     MOVE PT-765-GIFT-MDC-AMT (PV-TOT-SUB)                        17070000
170800                                 TO DD-MARKDOWN-CANCEL-AMT        17080000
170900                                    DL-MARKDOWN-CANCEL-AMT.       17090000
171000     ADD PT-765-GIFT-MDC-AMT (PV-TOT-SUB)                         17100000
171100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17110000
171200                                                    (PV-TOT-SUB). 17120000
171300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17130000
171400     MOVE PC-GIFT-RCPT-RETURN    TO DL-PRICE-CHANGE-TYPE.         17140000
171500     PERFORM 8200-WRITE-DETAIL-LINE.                              17150000
171600                                                                  17160000
171700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17170000
171800     SET DD-PC-BOGO              TO TRUE.                         17180000
171900     MOVE PT-BOGO-MKDN-QTY (PV-TOT-SUB)                           17190000
172000                                 TO DD-MARKDOWN-QTY               17200000
172100                                    DL-MARKDOWN-QTY.              17210000
172200     ADD PT-BOGO-MKDN-QTY (PV-TOT-SUB)                            17220000
172300                                 TO PT-TOTAL-MARKDOWN-QTY         17230000
172400                                                    (PV-TOT-SUB). 17240000
172500     MOVE PT-BOGO-MKDN-AMT (PV-TOT-SUB)                           17250000
172600                                 TO DD-MARKDOWN-AMT               17260000
172700                                    DL-MARKDOWN-AMT.              17270000
172800     ADD PT-BOGO-MKDN-AMT (PV-TOT-SUB)                            17280000
172900                                 TO PT-TOTAL-MARKDOWN-AMT         17290000
173000                                                    (PV-TOT-SUB). 17300000
173100     MOVE PT-BOGO-MDC-QTY (PV-TOT-SUB)                            17310000
173200                                 TO DD-MARKDOWN-CANCEL-QTY        17320000
173300                                    DL-MARKDOWN-CANCEL-QTY.       17330000
173400     ADD PT-BOGO-MDC-QTY (PV-TOT-SUB)                             17340000
173500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17350000
173600                                                    (PV-TOT-SUB). 17360000
173700     MOVE PT-BOGO-MDC-AMT (PV-TOT-SUB)                            17370000
173800                                 TO DD-MARKDOWN-CANCEL-AMT        17380000
173900                                    DL-MARKDOWN-CANCEL-AMT.       17390000
174000     ADD PT-BOGO-MDC-AMT (PV-TOT-SUB)                             17400000
174100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17410000
174200                                                    (PV-TOT-SUB). 17420000
174300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17430000
174400     MOVE PC-BOGO                TO DL-PRICE-CHANGE-TYPE.         17440000
174500     PERFORM 8200-WRITE-DETAIL-LINE.                              17450000
174600                                                                  17460000
174700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17470000
174800     SET DD-PC-UNEARNED-REWARDS  TO TRUE.                         17480000
174900     MOVE PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)                  17490000
175000                                 TO DD-MARKDOWN-QTY               17500000
175100                                    DL-MARKDOWN-QTY.              17510000
175200     ADD PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)                   17520000
175300                                 TO PT-TOTAL-MARKDOWN-QTY         17530000
175400                                                    (PV-TOT-SUB). 17540000
175500     MOVE PT-UNEARNED-RWDS-MKDN-AMT (PV-TOT-SUB)                  17550000
175600                                 TO DD-MARKDOWN-AMT               17560000
175700                                    DL-MARKDOWN-AMT.              17570000
175800     ADD PT-UNEARNED-RWDS-MKDN-AMT (PV-TOT-SUB)                   17580000
175900                                 TO PT-TOTAL-MARKDOWN-AMT         17590000
176000                                                    (PV-TOT-SUB). 17600000
176100     MOVE PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)                   17610000
176200                                 TO DD-MARKDOWN-CANCEL-QTY        17620000
176300                                    DL-MARKDOWN-CANCEL-QTY.       17630000
176400     ADD PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)                    17640000
176500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17650000
176600                                                    (PV-TOT-SUB). 17660000
176700     MOVE PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)                   17670000
176800                                 TO DD-MARKDOWN-CANCEL-AMT        17680000
176900                                    DL-MARKDOWN-CANCEL-AMT.       17690000
177000     ADD PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)                    17700000
177100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17710000
177200                                                    (PV-TOT-SUB). 17720000
177300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17730000
177400     MOVE PC-UNEARNED-REWARDS    TO DL-PRICE-CHANGE-TYPE.         17740000
177500     PERFORM 8200-WRITE-DETAIL-LINE.                              17750000
177600                                                                  17760000
177700                                                                  17770000
177800     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17780000
177900     SET DD-PC-EMPLY-DISCOUNT    TO TRUE.                         17790000
178000     MOVE PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)                     17800000
178100                                 TO DD-MARKDOWN-QTY               17810000
178200                                    DL-MARKDOWN-QTY.              17820000
178300     ADD PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)                      17830000
178400                                 TO PT-TOTAL-MARKDOWN-QTY         17840000
178500                                                    (PV-TOT-SUB). 17850000
178600     MOVE PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)                     17860000
178700                                 TO DD-MARKDOWN-AMT               17870000
178800                                    DL-MARKDOWN-AMT.              17880000
178900     ADD PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)                      17890000
179000                                 TO PT-TOTAL-MARKDOWN-AMT         17900000
179100                                                    (PV-TOT-SUB). 17910000
179200     MOVE PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)                      17920000
179300                                 TO DD-MARKDOWN-CANCEL-QTY        17930000
179400                                    DL-MARKDOWN-CANCEL-QTY.       17940000
179500     ADD PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)                       17950000
179600                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17960000
179700                                                    (PV-TOT-SUB). 17970000
179800     MOVE PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)                      17980000
179900                                 TO DD-MARKDOWN-CANCEL-AMT        17990000
180000                                    DL-MARKDOWN-CANCEL-AMT.       18000000
180100     ADD PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)                       18010000
180200                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18020000
180300                                                    (PV-TOT-SUB). 18030000
180400     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18040000
180500     MOVE PC-EMPLY-DISCOUNT      TO DL-PRICE-CHANGE-TYPE.         18050000
180600     PERFORM 8200-WRITE-DETAIL-LINE.                              18060000
180700                                                                  18070000
262807     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18071031
262807     SET DD-PC-SEPHORA-DISCOUNT TO TRUE.                          18072031
262807     MOVE PT-720-SEPHORA-MKDN-QTY (PV-TOT-SUB)                    18073031
262807                                 TO DD-MARKDOWN-QTY               18074031
262807                                    DL-MARKDOWN-QTY.              18075031
262807     ADD PT-720-SEPHORA-MKDN-QTY (PV-TOT-SUB)                     18076031
262807                                 TO PT-TOTAL-MARKDOWN-QTY         18077031
262807                                                    (PV-TOT-SUB). 18078031
262807     MOVE PT-720-SEPHORA-MKDN-AMT (PV-TOT-SUB)                    18079031
262807                                 TO DD-MARKDOWN-AMT               18079131
262807                                    DL-MARKDOWN-AMT.              18079231
262807     ADD PT-720-SEPHORA-MKDN-AMT (PV-TOT-SUB)                     18079331
262807                                 TO PT-TOTAL-MARKDOWN-AMT         18079431
262807                                                    (PV-TOT-SUB). 18079531
262807     MOVE PT-720-SEPHORA-MDC-QTY (PV-TOT-SUB)                     18079631
262807                                 TO DD-MARKDOWN-CANCEL-QTY        18079731
262807                                    DL-MARKDOWN-CANCEL-QTY.       18079831
262807     ADD PT-720-SEPHORA-MDC-QTY (PV-TOT-SUB)                      18079931
262807                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18080031
262807                                                    (PV-TOT-SUB). 18080131
262807     MOVE PT-720-SEPHORA-MDC-AMT (PV-TOT-SUB)                     18080231
262807                                 TO DD-MARKDOWN-CANCEL-AMT        18080331
262807                                    DL-MARKDOWN-CANCEL-AMT.       18080431
262807     ADD PT-720-SEPHORA-MDC-AMT (PV-TOT-SUB)                      18080531
262807                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18080631
262807                                                    (PV-TOT-SUB). 18080731
262807     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18080831
262807     MOVE PC-SEPHORA-DISCOUNT TO DL-PRICE-CHANGE-TYPE.            18080931
262807     PERFORM 8200-WRITE-DETAIL-LINE.                              18081031
262807                                                                  18081131
180800                                                                  18082000
180900     DISPLAY ' '.                                                 18090000
181000     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18100000
181100     SET DD-PC-TOTAL TO TRUE.                                     18110000
181200     MOVE PT-TOTAL-MARKDOWN-QTY (PV-TOT-SUB)                      18120000
181300                                 TO DD-MARKDOWN-QTY               18130000
181400                                    DL-MARKDOWN-QTY.              18140000
181500     MOVE PT-TOTAL-MARKDOWN-AMT (PV-TOT-SUB)                      18150000
181600                                 TO DD-MARKDOWN-AMT               18160000
181700                                    DL-MARKDOWN-AMT.              18170000
181800     MOVE PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB)               18180000
181900                                 TO DD-MARKDOWN-CANCEL-QTY        18190000
182000                                    DL-MARKDOWN-CANCEL-QTY.       18200000
182100     MOVE PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB)               18210000
182200                                 TO DD-MARKDOWN-CANCEL-AMT        18220000
182300                                    DL-MARKDOWN-CANCEL-AMT.       18230000
182400     MOVE PT-TOTAL-MARKUP-QTY (PV-TOT-SUB)                        18240000
182500                                 TO DD-MARKUP-QTY                 18250000
182600                                    DL-MARKUP-QTY.                18260000
182700     MOVE PT-TOTAL-MARKUP-AMT (PV-TOT-SUB)                        18270000
182800                                 TO DD-MARKUP-AMT                 18280000
182900                                    DL-MARKUP-AMT.                18290000
183000     MOVE PT-TOTAL-MARKUP-CANCEL-QTY (PV-TOT-SUB)                 18300000
183100                                 TO DD-MARKUP-CANCEL-QTY          18310000
183200                                    DL-MARKUP-CANCEL-QTY.         18320000
183300     MOVE PT-TOTAL-MARKUP-CANCEL-AMT (PV-TOT-SUB)                 18330000
183400                                 TO DD-MARKUP-CANCEL-AMT          18340000
183500                                    DL-MARKUP-CANCEL-AMT.         18350000
183600                                                                  18360000
183700     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18370000
183800     MOVE PC-TOTAL TO DL-PRICE-CHANGE-TYPE.                       18380000
183900     PERFORM 8200-WRITE-DETAIL-LINE.                              18390000
184000                                                                  18400000
184100     DISPLAY '  '.                                                18410000
184200     SET TD-NON-OWNED-DROPPED-ID TO TRUE.                         18420000
184300     MOVE PT-NON-OWNED-DROPPED (PV-TOT-SUB) TO TD-TOTAL-AMOUNT.   18430000
184400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       18440000
184500               TD-TOTAL-DISPLAY-MESSAGE.                          18450000
184600     PERFORM 8300-WRITE-NON-OWNED.                                18460000
184700                                                                  18470000
184800******************************************************************18480000
184900 2000-OPEN-TRAN-CURSOR.                                           18490000
185000*     OPEN TRANSACTION CURSOR.                                    18500000
185100******************************************************************18510000
185200                                                                  18520000
185300     EXEC SQL                                                     18530000
185400          OPEN TEPTRN-CURSOR                                      18540000
185500     END-EXEC.                                                    18550000
185600                                                                  18560000
185700     EVALUATE TRUE                                                18570000
185800        WHEN SQLCODE = ZERO                                       18580000
185900           CONTINUE                                               18590000
186000        WHEN OTHER                                                18600000
186100           MOVE '2000-OPEN-TRAN-CURSOR'                           18610000
186200                                      TO PV-PARAGRAPH-NAME        18620000
186300           SET AC-DB2-ERROR           TO TRUE                     18630000
186400           PERFORM 9999-ABEND                                     18640000
186500     END-EVALUATE.                                                18650000
186600                                                                  18660000
186700******************************************************************18670000
186800 2200-FETCH-TRAN-CURSOR.                                          18680000
186900*     FETCH TRANSACTION CURSOR.                                   18690000
187000******************************************************************18700000
187100     EXEC SQL                                                     18710000
187200         FETCH TEPTRN-CURSOR                                      18720000
187300          INTO :EPTRN-PARTN-NBR                                   18730000
187400              ,:EPTRN-STR-NBR                                     18740000
187500              ,:EPTRN-RGST-ID                                     18750000
187600              ,:EPTRN-TRN-NBR                                     18760000
187700              ,:EPTRN-STRT-TM                                     18770000
187800              ,:EPTRN-SLS-CORR-SEQ-NBR                            18780000
187900              ,:EPTRN-TRN-STAT-CDE                                18790000
188000              ,:EPTRN-SLS-DTE                                     18800000
ZX                  ,:EPTRN-TRN-DTE                                     18800100
011618              ,:EPTRN-POS-CPBL-LVL-NBR                            18800200
188100              ,:EPTRN-CRE-TMST                                    18810000
BOSSCL              ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                     18811001
BOSSCL               :PV-OMNI-CHNL-TYP-CDE-NULL-IND                     18812001
BOSSC2              ,:PV-TRANSFER-DATE                                  18813013
188200     END-EXEC.                                                    18820000
188300                                                                  18830000
188400     EVALUATE TRUE                                                18840000
188500        WHEN SQLCODE = ZERO                                       18850000
210800           ADD 1 TO WS-TRN-CNT                                    18850110
BOSSCL           IF PV-OMNI-CHNL-TYP-CDE-NULL-IND = -1                  18851008
BOSSCL              MOVE SPACES TO EPTRN-OMNI-CHNL-FFLMT-TYP-CDE        18852008
BOSSCL           END-IF                                                 18853008
188600           MOVE EPTRN-PARTN-NBR       TO  PV-PARTN-NBR            18860000
188700           MOVE EPTRN-STR-NBR         TO  PV-STR-NBR              18870000
188800           MOVE EPTRN-RGST-ID         TO  PV-RGST-ID              18880000
188900           MOVE EPTRN-TRN-NBR         TO  PV-TRN-NBR              18890000
189000           MOVE EPTRN-STRT-TM         TO  PV-STRT-TM              18900000
189100           MOVE EPTRN-SLS-CORR-SEQ-NBR                            18910000
189200                                      TO  PV-SLS-CORR-SEQ-NBR     18920000
189300           MOVE ZERO                  TO PV-FISC-PERIOD-NBR-HOLD  18930000
189400           PERFORM 1117-CALCU-KOHLS-MONTH                         18940000
189500                                                                  18950000
ZX               PERFORM 2450-SELECT-ORDER-NUMBER                       18951000
189600           PERFORM 2500-OPEN-ITEM-CURSOR                          18960000
189700           PERFORM 2600-FETCH-ITEM-CURSOR                         18970000
189800              UNTIL PS-END-OF-ITEM-YES                            18980000
189900           PERFORM 2700-CLOSE-ITEM-CURSOR                         18990000
190000           ADD 1                      TO WS-CMT-CNT               19000000
190100                                                                  19010000
190200        WHEN SQLCODE = PC-ROW-NOT-FOUND                           19020000
190300           SET PS-END-OF-TRAN-YES     TO TRUE                     19030000
ZX               DISPLAY '                      '                       19030100
ZX               DISPLAY '2200-FETCH-TRAN-CURSOR'                       19030200
ZX               DISPLAY '** NOT FOUND **'                              19030300
ZX               DISPLAY '   TRAN COUNT = ' WS-TRN-CNT                  19030400
ZX               DISPLAY '         DATE = ' PV-RUN-DATE-CCYY-MM-DD      19030500
ZX               DISPLAY '          PRT = ' WS-PRT                      19030600
ZX               DISPLAY '          STR = ' WS-STR                      19030700
ZX               DISPLAY '         RGST = ' WS-REG                      19030800
ZX               DISPLAY '          TRN = ' WS-TRN                      19030900
ZX               DISPLAY '    TEP PARTN = ' EPTRN-PARTN-NBR             19031000
ZX               DISPLAY '    PRT PARTN = ' EPPART-PARTN-NBR            19031100
ZX               DISPLAY '    SLS CORR  = ' EPTRN-SLS-CORR-SEQ-NBR      19031200
ZX               DISPLAY '                      '                       19031300
190400        WHEN OTHER                                                19040000
190500           MOVE '2200-FETCH-TRAN-CURSOR'                          19050000
190600                                      TO PV-PARAGRAPH-NAME        19060000
190700           SET AC-DB2-ERROR           TO TRUE                     19070000
190800           PERFORM 9999-ABEND                                     19080000
190900     END-EVALUATE.                                                19090000
191000                                                                  19100000
191100     IF WS-CMT-CNT > 2000                                         19110000
191200       PERFORM 8999-COMMIT-PARA                                   19120000
191300       MOVE ZEROS                         TO WS-CMT-CNT           19130000
191400     END-IF.                                                      19140000
191500                                                                  19150000
191600******************************************************************19160000
191700 2400-CLOSE-TRAN-CURSOR.                                          19170000
191800*     CLOSE TRANSACTION CURSOR.                                   19180000
191900******************************************************************19190000
192000                                                                  19200000
192100     EXEC SQL                                                     19210000
192200          CLOSE TEPTRN-CURSOR                                     19220000
192300     END-EXEC.                                                    19230000
192400                                                                  19240000
192500     EVALUATE TRUE                                                19250000
192600        WHEN SQLCODE = ZERO                                       19260000
192700           CONTINUE                                               19270000
192800        WHEN OTHER                                                19280000
192900           MOVE '2400-CLOSE-TRAN-CURSOR'                          19290000
193000                                      TO PV-PARAGRAPH-NAME        19300000
193100           SET AC-DB2-ERROR           TO TRUE                     19310000
193200           PERFORM 9999-ABEND                                     19320000
193300     END-EVALUATE.                                                19330000
193400                                                                  19340000
ZX    ******************************************************************19341000
ZX     2450-SELECT-ORDER-NUMBER.                                        19342000
ZX    *     CHECK IF ORDER NUMBER FOUND                                 19343000
ZX    ******************************************************************19344000
ZX                                                                      19345000
ZX         SET PS-ORDER-NUMBER-FOUND-N TO TRUE.                         19346000
ZX                                                                      19347000
ZX         EXEC SQL                                                     19348000
ZX            SELECT  ORD_NBR                                           19349000
ZX              INTO :EPORD-ORD-NBR                                     19349100
ZX              FROM  TEPORD                                            19349200
ZX             WHERE  PARTN_NBR        = :PV-PARTN-NBR                  19349300
ZX               AND  STR_NBR          = :PV-STR-NBR                    19349400
ZX               AND  RGST_ID          = :PV-RGST-ID                    19349500
ZX               AND  TRN_NBR          = :PV-TRN-NBR                    19349600
ZX               AND  STRT_TM          = :PV-STRT-TM                    19349700
ZX               AND  SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           19349800
ZX                    WITH UR                                           19349900
ZX         END-EXEC.                                                    19350000
ZX                                                                      19350100
ZX         EVALUATE TRUE                                                19350200
ZX            WHEN SQLCODE = ZERO                                       19350300
ZX               SET PS-ORDER-NUMBER-FOUND-Y TO TRUE                    19350400
BOSSC3           MOVE EPORD-ORD-NBR-TEXT     TO WS-EPORD-ORD-NBR        19350518
BOSSC3           DISPLAY 'ORDER NBR = '         WS-EPORD-ORD-NBR        19350618
ZX            WHEN SQLCODE = PC-ROW-NOT-FOUND                           19350700
ZX               SET PS-ORDER-NUMBER-FOUND-N TO TRUE                    19350800
BOSSC3           DISPLAY 'ORDER NBR NOT FOUND'                          19350918
ZX            WHEN OTHER                                                19351000
ZX               MOVE '2450-SELECT-ORDER-NUMBER '                       19351100
ZX                                            TO PV-PARAGRAPH-NAME      19351200
ZX               SET AC-DB2-ERROR           TO TRUE                     19351300
ZX               PERFORM 9999-ABEND                                     19351400
ZX         END-EVALUATE.                                                19351500
ZX                                                                      19351600
193500******************************************************************19352000
193600 2500-OPEN-ITEM-CURSOR.                                           19360000
193700*     OPEN ITEM CURSOR.                                           19370000
193800******************************************************************19380000
193900                                                                  19390000
194000     EXEC SQL                                                     19400000
194100          OPEN TEPITM-CURSOR                                      19410000
194200     END-EXEC.                                                    19420000
194300                                                                  19430000
194400     EVALUATE TRUE                                                19440000
194500        WHEN SQLCODE = ZERO                                       19450000
194600           SET PS-END-OF-ITEM-NO      TO TRUE                     19460000
194700        WHEN OTHER                                                19470000
194800           MOVE '2500-OPEN-ITEM-CURSOR' TO PV-PARAGRAPH-NAME      19480000
194900           SET AC-DB2-ERROR           TO TRUE                     19490000
195000           PERFORM 9999-ABEND                                     19500000
195100     END-EVALUATE.                                                19510000
195200                                                                  19520000
195300******************************************************************19530000
195400 2600-FETCH-ITEM-CURSOR.                                          19540000
195500*     FETCH ITEMS FROM TEPITM TABLE.                              19550000
195600******************************************************************19560000
195700                                                                  19570000
195800     EXEC SQL                                                     19580000
195900          FETCH TEPITM-CURSOR                                     19590000
196000           INTO :EPITM-LNE-ITM-SEQ-NBR                            19600000
196100               ,:EPITM-LIV-RSLU-CDE                               19610000
196200               ,:EPITM-DEPT-NBR                                   19620000
196300               ,:EPITM-SUB-CL-NBR                                 19630000
196400               ,:EPITM-SLD-QTY                                    19640000
196500               ,:EPITM-NET-CHRGD-AMT                              19650000
196600               ,:EPITM-SAL-TYP-CDE                                19660000
196700               ,:EPITM-SAL-RET-CDE                                19670000
196800               ,:EPITM-DEPT-CL-ERR-CDE                            19680000
196900               ,:EPITM-SKU-ERR-CDE                                19690000
197000               ,:EPITM-PRIC-SRC-CDE                               19700000
197100               ,:EPITM-CUST-CHRGD-AMT                             19710000
197200               ,:EPITM-REG-RTL-AMT                                19720000
197300               ,:EPITM-ADITEM-NBR                                 19730000
197400               ,:EPITM-UNT-COST-AMT                               19740000
197500               ,:EPITM-OWND-UNT-RTL-AMT                           19750000
197600               ,:EPITM-OWNSHP-CDE                                 19760000
197700               ,:EPITM-REG-RTL-ORGN-CDE                           19770000
197800               ,:EPITM-SKU-NBR                                    19780000
197900               ,:EPITM-MAJ-CL-NBR                                 19790000
198000               ,:EPITM-PROMO-INTFC-ID                             19800000
214615               ,:EPITM-PROMO-SCHM-CDE                             19800100
198100               ,:EPITM-OWND-UNT-RTL-ORIG-AMT                      19810000
198200                :PV-ORIG-OWND-UNT-AMT-NULL-IND                    19820000
198300               ,:EPITM-ITM-STAT-CDE                               19830000
214615               ,:EPITM-ORIG-SAL-TYP-CDE                           19830100
214615               ,:EPITM-ORIG-REG-RTL-AMT                           19830200
198400     END-EXEC.                                                    19840000
198500                                                                  19850000
198600     EVALUATE TRUE                                                19860000
198700        WHEN SQLCODE = ZERO                                       19870000
198800           PERFORM 2800-SCREEN-ITEM                               19880000
198900        WHEN SQLCODE = PC-ROW-NOT-FOUND                           19890000
199000           SET PS-END-OF-ITEM-YES     TO TRUE                     19900000
199100        WHEN OTHER                                                19910000
199200           MOVE '2600-FETCH-ITEM-CURSOR'                          19920000
199300                                      TO PV-PARAGRAPH-NAME        19930000
199400           SET AC-DB2-ERROR           TO TRUE                     19940000
199500           PERFORM 9999-ABEND                                     19950000
199600     END-EVALUATE.                                                19960000
199700                                                                  19970000
199800******************************************************************19980000
199900 2700-CLOSE-ITEM-CURSOR.                                          19990000
200000*     CLOSE ITEM CURSOR.                                          20000000
200100******************************************************************20010000
200200                                                                  20020000
200300     EXEC SQL                                                     20030000
200400          CLOSE TEPITM-CURSOR                                     20040000
200500     END-EXEC.                                                    20050000
200600                                                                  20060000
200700     EVALUATE TRUE                                                20070000
200800        WHEN SQLCODE = ZERO                                       20080000
200900           CONTINUE                                               20090000
201000        WHEN OTHER                                                20100000
201100           MOVE '2700-CLOSE-ITEM-CURSOR'                          20110000
201200                                            TO PV-PARAGRAPH-NAME  20120000
201300           SET AC-DB2-ERROR           TO TRUE                     20130000
201400           PERFORM 9999-ABEND                                     20140000
201500     END-EVALUATE.                                                20150000
201600                                                                  20160000
201700******************************************************************20170000
201800 2800-SCREEN-ITEM.                                                20180000
201900*     FILTER ITEMS. EXCLUDE SALES CORRECTIONS, EVEN EXCHANGES,    20190000
202000*     RESOLVED LINE ITEM VOIDS, AND GOLDSTAR ITEMS.               20200000
202100******************************************************************20210000
202200                                                                  20220000
202300     INITIALIZE ML017-PRICE-CHANGE-RECORD.                        20230000
202400                                                                  20240000
202500     MOVE EPITM-LNE-ITM-SEQ-NBR TO   PV-LNE-ITM-SEQ-NBR.          20250000
202600                                                                  20260000
202700     EVALUATE TRUE                                                20270000
202800        WHEN EPITM-LIV-RSLU-CDE = PC-RSLV-ORIGINAL                20280000
202900        WHEN EPITM-LIV-RSLU-CDE = PC-RSLV-VOID                    20290000
203000        WHEN EPITM-DEPT-NBR = PC-GIFT-CARD                        20300000
SEPHOR        WHEN EPITM-DEPT-NBR = PC-SEPHORA-GIFT-CARD-712            20301032
203100        WHEN EPITM-DEPT-NBR = PC-THIRD-PARTY-CARD-833             20310000
203200        WHEN EPITM-DEPT-NBR = PC-THIRD-PARTY-CARD-834             20320000
MKTPLC        WHEN EPITM-DEPT-NBR = PC-MKTPLACE-DEPT-985                20320109
203300           CONTINUE                                               20330000
203400                                                                  20340000
203500        WHEN EPITM-OWNSHP-CDE = PC-NON-OWNED                      20350000
203600        WHEN EPITM-OWNSHP-CDE = PC-NON-OWNED-TRACKED              20360000
203700           IF EPTRN-TRN-STAT-CDE = PC-CORRECTION                  20370000
203800              IF DPG55-DB2-ISO-DATE-FMT LESS THAN                 20380000
203900                 PV-CUT-OFF-CCYY-MM-DD                            20390000
204000                 MOVE 4  TO PV-TOT-SUB                            20400000
204100              ELSE                                                20410000
204200                 MOVE 2  TO PV-TOT-SUB                            20420000
204300              END-IF                                              20430000
204400           END-IF                                                 20440000
204500                                                                  20450000
204600           IF EPTRN-TRN-STAT-CDE = PC-LATE                        20460000
204700              IF DPG55-DB2-ISO-DATE-FMT LESS THAN                 20470000
204800                 PV-CUT-OFF-CCYY-MM-DD                            20480000
204900                 MOVE 5  TO PV-TOT-SUB                            20490000
205000              ELSE                                                20500000
205100                 MOVE 3  TO PV-TOT-SUB                            20510000
205200              END-IF                                              20520000
205300           END-IF                                                 20530000
205400                                                                  20540000
205500           IF DPG55-DB2-ISO-DATE-FMT NOT LESS THAN                20550000
205600              PV-CUT-OFF-CCYY-MM-DD                               20560000
205700              MOVE 1  TO PV-TOT-SUB                               20570000
205800           END-IF                                                 20580000
205900                                                                  20590000
206000           ADD +1 TO PT-NON-OWNED-DROPPED (PV-TOT-SUB)            20600000
206100                                                                  20610000
206200        WHEN OTHER                                                20620000
206300           IF (EPITM-NET-CHRGD-AMT > ZERO AND                     20630000
206400               EPITM-CUST-CHRGD-AMT < ZERO) OR                    20640000
206500              (EPITM-NET-CHRGD-AMT < ZERO AND                     20650000
206600               EPITM-CUST-CHRGD-AMT > ZERO)                       20660000
206700               DISPLAY 'TRANSACTION WITH OPPOSING SIGNS DETECTED' 20670000
206800               DISPLAY ' PARTN   ' EPTRN-PARTN-NBR                20680000
206900                       ' STORE   ' EPTRN-STR-NBR                  20690000
207000                       ' RGST    ' EPTRN-RGST-ID                  20700000
207100                       ' TRAN    ' EPTRN-TRN-NBR                  20710000
207200                       ' ITEM #  ' EPITM-LNE-ITM-SEQ-NBR          20720000
ZX                           ' SKU  #  ' EPITM-SKU-NBR                  20721000
207300           ELSE                                                   20730000
207400              PERFORM 2900-PROCESS-ITEM                           20740000
207500           END-IF                                                 20750000
207600     END-EVALUATE.                                                20760000
207700                                                                  20770000
207800******************************************************************20780000
207900 2900-PROCESS-ITEM.                                               20790000
208000*    DIRECT THE FLOW OF AN ITEM.                                  20800010
BOSSC2*                                                                 20801013
BOSSC2*    IF THE ITEM IS FOR A BOSS ORDER AND THERE WAS A PRICE CHANGE 20801113
BOSSC2*    - GET ECOM'S ACTIVE PRICE ON THE ECOM ORDER DATE AND         20802113
BOSSC2*    THE TRANSFER DATE.   IF THERE IS A DIFFERENCE, CALCULATE     20802213
BOSSC2*    AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE.                  20802313
BOSSC2*                                                                 20802413
BOSSC2*    IF THE ITEM IS FOR AN SFS OR BOPUS ORDER THAT WAS NOT ON     20802513
BOSSC2*    CLEARANCE AND THERE WAS A PRICE CHANGE -                     20802613
BOSSC2*    CALCULATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE         20805213
BOSSC2*    BETWEEN ECOM'S ACTIVE PRICE ON THE ECOM ORDER DATE AND       20805313
BOSSC2*    THE STORE PRICE ON THE SALES DATE.                           20805413
BOSSCL*                                                                 20805513
BOSSCL*    THEN RESET THE STORE'S OWNED UNIT RTL WITH THE ECOM ORIGINAL 20806010
BOSSCL*    OWNED UNIT RTL AMT SO THAT THE ITEM CAN PROCEED THROUGH THE  20807010
BOSSCL*    REST OF THE LOGIC THAT CALCULATES PROMO MARKDOWNS.           20808010
208100******************************************************************20810000
208200                                                                  20820000
208300     PERFORM 3000-POPULATE-MISC-FIELDS.                           20830000
ZXC        PERFORM 8194-BUILD-CRITE-TRANS-RECORD.                       20831000
ZXC        PERFORM 8194-WRITE-CRITE-TRANS-RECORD.                       20832000
BOSSCL                                                                  20839001
BOSSC3     IF  (PV-ORIG-OWND-UNT-AMT-NULL-IND IS NOT = PC-NULL)         20839122
BOSSC3     AND (EPITM-SAL-RET-CDE = 'S'  OR  EPITM-SAL-RET-CDE = 'A')   20839222
BOSSC2         IF (EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BOS')               20841013
BOSSC2         OR ((EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BPS' OR 'SFS') AND 20842013
BOSSC2              EPITM-ITM-STAT-CDE IS NOT = '30')                   20843013
BOSSC2             PERFORM 2910-OMNI-OWNERSHIP-ADJ                      20844013
BOSSCL                                                                  20845601
BOSSCL* AFTER OWNERSHIP ADJ IS GENERATED, FLIP THE RETAIL AMOUNT AND    20845701
BOSSCL* ORIGINAL RETAIL AMOUNTS FOR THE REST OF THE PROCESSING.         20845801
BOSSCL* ALSO NEED TO SET ML017-PC-DIFFER-AMT TO ZEROES OR IT WILL       20845901
BOSSCL* BE PICKED UP BY PARA 4000- BELOW.                               20846001
BOSSCL             MOVE EPITM-OWND-UNT-RTL-ORIG-AMT  TO                 20846113
BOSSCL                  PV-OWND-UNT-RTL-ORIG-AMT                        20846213
BOSSCL             MOVE EPITM-OWND-UNT-RTL-AMT       TO                 20846313
BOSSCL                  EPITM-OWND-UNT-RTL-ORIG-AMT                     20846413
BOSSCL             MOVE PV-OWND-UNT-RTL-ORIG-AMT     TO                 20846513
BOSSCL                  EPITM-OWND-UNT-RTL-AMT                          20846613
BOSSCL             MOVE ZEROES  TO  ML017-PC-DIFFER-AMT                 20847113
BOSSCL                                                                  20847201
BOSSC2         END-IF                                                   20847313
BOSSCL     END-IF.                                                      20847401
208400                                                                  20848000
208500     PERFORM 3001-CHECK-DISCOUNT.                                 20850000
208600                                                                  20860000
208700     MOVE ZERO                        TO PV-CUST-CHRGD-AMT        20870000
208800                                         PV-EXTENDED-AMT          20880000
208900                                         PV-EXCLUDE-LID-AMT       20890000
209000                                         PV-PRICE-CHANGE-AMOUNT.  20900000
209100     MOVE EPITM-CUST-CHRGD-AMT        TO PV-CUST-CHRGD-AMT.       20910000
209200                                                                  20920000
209300     IF EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G OR                      20930000
209400        EPTRN-TRN-STAT-CDE = PC-CORRECTION OR                     20940000
209500        EPTRN-TRN-STAT-CDE = PC-REVERSAL                          20950000
209600        PERFORM 4100-OPEN-LID-CURSOR                              20960000
209700        PERFORM 4200-FETCH-LID-CURSOR                             20970000
209800           UNTIL PS-END-OF-LID-YES                                20980000
209900        PERFORM 4300-CLOSE-LID-CURSOR                             20990000
210000                                                                  21000000
210100* PROCESS MARKDOWNS FOR SALE CORRECTIONS BYPASS DUMMY SKUS        21010000
210200        MOVE EPITM-CUST-CHRGD-AMT TO PV-ITM-CUST-CHRGD-AMT        21020000
210300        MOVE EPITM-REG-RTL-AMT    TO PV-ITM-REG-RTL-AMT           21030000
210400                                                                  21040000
210500        IF EPTRN-TRN-STAT-CDE = PC-CORRECTION OR                  21050000
210510           EPTRN-TRN-STAT-CDE = PC-REVERSAL                       21051000
210600           IF PV-SKU-LST-3-DGT NOT = '000'                        21060000
210700              IF PV-ITM-CUST-CHRGD-AMT NOT = PV-ITM-REG-RTL-AMT   21070000
210800                 IF (EPITM-SAL-RET-CDE = 'S'                      21080000
210900                 OR  EPITM-SAL-RET-CDE = 'A')                     21090000
211000                     PERFORM 3950-SALE-CORRECTION-MARKDOWN        21100000
211100                 ELSE                                             21110000
211200                     PERFORM 3650-MARKDOWN-CORR-CANCEL            21120000
211300                 END-IF                                           21130000
211400              END-IF                                              21140000
211500           END-IF                                                 21150000
211600        END-IF                                                    21160000
211700                                                                  21170000
211800     ELSE                                                         21180000
211900        IF EPITM-SAL-RET-CDE = 'R' OR                             21190000
212000           EPITM-SAL-RET-CDE = 'B'                                21200000
212100              PERFORM 3100-RETURN-ITEM-MARKDOWN                   21210000
212200              PERFORM 4000-PROCESS-MARKDOWN-MARKUP                21220000
212300              PERFORM 4100-OPEN-LID-CURSOR                        21230000
212400              PERFORM 4200-FETCH-LID-CURSOR                       21240000
212500                 UNTIL PS-END-OF-LID-YES                          21250000
212600              PERFORM 4300-CLOSE-LID-CURSOR                       21260000
212700        END-IF                                                    21270000
212800                                                                  21280000
212900        IF (EPITM-SAL-RET-CDE = 'S' OR                            21281000
213000            EPITM-SAL-RET-CDE = 'A') AND                          21282000
213100            EPITM-LIV-RSLU-CDE = '-'                              21310000
213200            PERFORM 3300-CALC-EXTENDED-AMT                        21320000
213300            IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                21330000
213400******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     21340000
213500******* BEING PROCESSED AS MARKUPS.                               21350000
213600               IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND            21360000
213700                  EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO           21370000
213800                  PERFORM 3400-MARKUP-CANCEL                      21380000
213900               END-IF                                             21390000
214000            ELSE                                                  21400000
214100               IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT             21410000
214200                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              21420000
226892                  OR EPITM-PROMO-SCHM-CDE NOT = ZERO              21420100
214300                     PERFORM 3500-PROMO-MARKDOWN-CANCEL           21430000
214400                  ELSE                                            21440000
214500                     PERFORM 3600-MARKDOWN-CANCEL                 21450000
214600                  END-IF                                          21460000
214700               END-IF                                             21470000
214800            END-IF                                                21480000
214900                                                                  21490000
215000            PERFORM 4000-PROCESS-MARKDOWN-MARKUP                  21500000
215100                                                                  21510000
215200            PERFORM 4100-OPEN-LID-CURSOR                          21520000
215300            PERFORM 4200-FETCH-LID-CURSOR                         21530000
215400               UNTIL PS-END-OF-LID-YES                            21540000
215500            PERFORM 4300-CLOSE-LID-CURSOR                         21550000
215600        END-IF                                                    21560000
215700                                                                  21570000
215800        IF (EPITM-SAL-RET-CDE = 'S' OR                            21580000
215900            EPITM-SAL-RET-CDE = 'A') AND                          21590000
216000            EPITM-LIV-RSLU-CDE = '+'                              21600000
216100            PERFORM 3300-CALC-EXTENDED-AMT                        21610000
216200            IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                21620000
216300******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     21630000
216400******* BEING PROCESSED AS MARKUPS.                               21640000
216500               IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND            21650000
216600                  EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO           21660000
216700                  IF PV-ORIG-OWND-UNT-AMT-NULL-IND = PC-NULL      21670000
ZX    * I DON'T KNOW WHY THIS WOULD INDICATE A MARKUP                   21671000
ZX    * CERTAINLY NOT AT POC                                            21672000
216800                      PERFORM 3700-SALE-MARKUP                    21680000
216900                  ELSE                                            21690000
217000                      PERFORM 3600-MARKDOWN-CANCEL                21700000
217100                  END-IF                                          21710000
217200               END-IF                                             21720000
217300            ELSE                                                  21730000
217400               IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT             21740000
217500                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              21750000
226892                  OR EPITM-PROMO-SCHM-CDE NOT = ZERO              21750100
217600                     PERFORM 3800-PROMO-MARKDOWN                  21760000
217700                  ELSE                                            21770000
217800                     IF PV-ORIG-OWND-UNT-AMT-NULL-IND = PC-NULL OR21780000
217900                        EPITM-ITM-STAT-CDE = '30'                 21790000
218000                        PERFORM 3900-SALE-MARKDOWN                21800000
218100                     ELSE                                         21810000
ZX    *  NEED TO LOOK INTO IF THIS IS POSSIBLE TO HIT                   21811000
ZX    *  WE'RE WITHIN A SALE, HOW DO WE GET MARKUP CANCEL HERE?         21812000
218200                        PERFORM 3400-MARKUP-CANCEL                21820000
218300                     END-IF                                       21830000
218400                  END-IF                                          21840000
218500               END-IF                                             21850000
218600            END-IF                                                21860000
218700                                                                  21870000
218800            PERFORM 4000-PROCESS-MARKDOWN-MARKUP                  21880000
218900                                                                  21890000
219000            PERFORM 4100-OPEN-LID-CURSOR                          21900000
219100            PERFORM 4200-FETCH-LID-CURSOR                         21910000
219200               UNTIL PS-END-OF-LID-YES                            21920000
219300            PERFORM 4300-CLOSE-LID-CURSOR                         21930000
219400        END-IF                                                    21940000
219500     END-IF.                                                      21950000
219600                                                                  21960000
BOSSC2******************************************************************21960113
BOSSC2 2910-OMNI-OWNERSHIP-ADJ.                                         21960213
BOSSC2*    REQUIRED WHEN AN OMNI ORDER IS BEING PROCESSED.              21960313
BOSSC2*                                                                 21960413
BOSSC2*    BOSS ORDERS ARE TREATED DIFFERENTLY BECAUSE THEY INVOLVE     21960513
BOSSC2*    INVENTORY TRANSFERS FROM ECOM TO THE STORE.  SINCE THE       21960613
BOSSC2*    CUSTOMER WILL PAY THE STORE THE ECOM PRICE THEY DO NOT       21960713
BOSSC2*    NEED TO ACCOUNT FOR PRICE DIFFERENCES BETWEEN ECOM AND THE   21960813
BOSSC2*    STORE.  THEY ARE CONCERNED ABOUT PRICE CHANGES AT ECOM       21960913
BOSSC2*    BETWEEN THE ORDER DATE AND TRANSFER DATE BECAUSE THE STORE   21961013
BOSSC2*    WILL RECEIVE THE INVENTORY AT THE ECOM PRICE ON THE TRANSFER 21961113
BOSSC2*    DATE.  THESE PRICE CHANGES WILL NEED AN OWNERSHIP ADJUSTMENT 21961213
BOSSC2*    TO BE GENERATED FOR THE STORE.                               21961313
BOSSC2*                                                                 21961413
BOSSC2*    SFS AND BOPUS ORDERS DO NOT INVOLVE INVENTORY TRANSFERS TO   21961513
BOSSC2*    THE STORE.  THEY ARE NOT CONCERNED WITH PRICE CHANGES AT THE 21961613
BOSSC2*    STORE, BUT DO NEED AN OWNERSHIP ADJUSTMENT TO ACCOUNT FOR    21961713
BOSSC2*    PRICE DIFFERENCES BETWEEN ECOM AND THE STORE SINCE THE       21961813
BOSSC2*    CUSTOMER WILL PAY THE STORE THE ECOM PRICE.                  21961913
BOSSC2*                                                                 21962013
BOSSC2*    FOLLOWING TO CHANGE WHEN SAT_BOSS_TRANSFERS TABLE AVAILABLE. 21962113
BOSSC2*    CHECK FOR ECOM PRICE FIRST                                   21962213
BOSSC2*    IF ECOM PRICE NOT FOUND, CHECK FOR CORP PRICE (LOC ZERO)     21962313
BOSSC2******************************************************************21962413
BOSSC2     DISPLAY 'OMNI PRICE CHG LOGIC HIT FOR : ' PV-PARTN-NBR       21962513
BOSSC2             ' ' PV-STR-NBR ' ' PV-RGST-ID ' ' PV-TRN-NBR         21962613
BOSSC2             ' ' EPTRN-OMNI-CHNL-FFLMT-TYP-CDE.                   21962713
BOSSC2                                                                  21962813
BOSSC2     IF EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BOS'                     21962913
BOSSC2         SET PS-ECOM-PRICE-CHANGE-NO TO TRUE                      21963013
BOSSC3**       PERFORM 2940-CHECK-FOR-ECOM-PRICE-CHG                    21963216
BOSSC3**       PARA'S  2940-, 2942- AND 2944- WILL BE OBSOLETE          21963316
BOSSC3**       PARA 2450- PERFORMED IN THIS PROGRAM FOR ALL ORDERS, NOT 21963417
BOSSC3**       NEEDED HERE, BUT THIS IS WHERE SAKUT023 WILL PERFORM IT. 21963517
BOSSC3**       PERFORM 2450-SELECT-ORDER-NUMBER                         21963617
BOSSC3         PERFORM 2930-READ-BOSS-TRANSFER                          21963716
BOSSC2         IF  PS-ECOM-PRICE-CHANGE-YES                             21963813
BOSSC2             PERFORM 2950-CREATE-BOSS-OWNERSHIP-ADJ               21963923
BOSSC2             MOVE ML017-PC-DIFFER-AMT  TO PV-DISPLAY-AMT          21964013
BOSSC2             DISPLAY 'BOSS STORE PRICE CHG - CREATING OWNERSHIP'  21964124
BOSSC2                 ' ADJ FOR '  PV-DISPLAY-AMT                      21964213
BOSSC2         END-IF                                                   21964313
BOSSC2     ELSE                                                         21964413
BOSSC2*        SFS AND BOPUS - COMPARE STORE AND ECOM PRICES            21964523
BOSSC2         IF EPITM-OWND-UNT-RTL-AMT = EPITM-OWND-UNT-RTL-ORIG-AMT  21964613
BOSSC2             CONTINUE                                             21964713
BOSSC2         ELSE                                                     21964813
BOSSC2             PERFORM 2920-SFS-BPS-OWN-ADJ                         21964913
BOSSC2         END-IF                                                   21965013
BOSSC2     END-IF.                                                      21965113
BOSSC2                                                                  21965213
BOSSC2******************************************************************21965313
BOSSC2 2920-SFS-BPS-OWN-ADJ.                                            21965413
BOSSC2*    OWNERSHIP ADJUSTMENT PROCESSING FOR SFS AND BOPUS ORDERS.    21965513
BOSSC2*    THESE ORDERS DO NOT INVOLVE INVENTORY TRANSFERS FROM ECOM    21965613
BOSSC2*    AND ARE HANDLED DIFFERENTLY THAN BOSS ORDERS.                21965713
BOSSC2*    OWNERSHIP ADJUSTMENT MUST REFLECT THE DIFFERENCE BETWEEN     21965813
BOSSC2*    THE ECOM ORDER PRICE AND THE STORE OWNED PRICE AT TIME OF    21965913
BOSSC2*    SALE.                                                        21966013
BOSSC2******************************************************************21966113
BOSSC2                                                                  21966213
BOSSC2     SET ML017-MKDOWN                                             21966313
BOSSC2         ML017-BN-OWN-ADJ                                         21966413
BOSSC2         ML017-RC-MISCELLANEOUS                                   21966513
BOSSC2         ML017-REGISTER-MKDN-MKON     TO TRUE.                    21966613
BOSSC2     MOVE PC-OWN-ADJ-796    TO ML017-PC-MKDN-MKUP-RSN-CDE.        21966713
BOSSC2     COMPUTE ML017-PC-OLD-PR-AMT      =                           21966813
BOSSC2             EPITM-OWND-UNT-RTL-AMT       * EPITM-SLD-QTY.        21966913
BOSSC2     COMPUTE ML017-PC-NEW-PR-AMT      =                           21967013
BOSSC2             EPITM-OWND-UNT-RTL-ORIG-AMT  * EPITM-SLD-QTY.        21967113
BOSSC2     MOVE EPITM-SLD-QTY               TO ML017-PC-QTY.            21967213
BOSSC2                                                                  21967313
BOSSC2     COMPUTE ML017-PC-DIFFER-AMT =                                21967413
BOSSC2             ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT.           21967513
BOSSC2                                                                  21967613
BOSSC2     IF ML017-PC-DIFFER-AMT < 0                                   21967713
BOSSC2*        PRICE DECREASE - GENERATE MARKDOWN CANCEL                21967813
BOSSC2*        LOGIC BELOW COPIED FROM 3600-MARKDOWN-CANCEL             21967913
BOSSC2         SET ML017-MARKDOWN-CANCEL TO TRUE                        21968013
BOSSC2         ADD +1     TO PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)      21968113
BOSSC2         ADD ML017-PC-DIFFER-AMT  TO                              21968213
BOSSC2             PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                21968313
BOSSC2     ELSE                                                         21968413
BOSSC2*        PRICE INCREASE - GENERATE MARKDOWN                       21968513
BOSSC2*        BELOW LOGIC COPIED FROM 3120-CONTINUE-PROCESS            21968613
BOSSC2         SET ML017-MARKDOWN          TO TRUE                      21968713
BOSSC2         ADD +1    TO PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)      21968813
BOSSC2         ADD ML017-PC-DIFFER-AMT     TO                           21968913
BOSSC2             PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)               21969013
BOSSC2     END-IF.                                                      21969113
BOSSC2                                                                  21969213
BOSSC2     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        21969313
BOSSC2                                                                  21969413
BOSSC2     MOVE ML017-PC-DIFFER-AMT  TO PV-DISPLAY-AMT.                 21969513
BOSSC2     DISPLAY 'OMNI STORE PRICE CHG - CREATING OWNERSHIP'          21969613
BOSSC2             ' ADJ FOR '  PV-DISPLAY-AMT.                         21969713
BOSSC2                                                                  21969813
BOSSC3******************************************************************21969916
BOSSC3 2930-READ-BOSS-TRANSFER.                                         21970016
BOSSC3*    REQUIRED WHEN A BOSS ORDER IS BEING PROCESSED                21970116
BOSSC3*    IF THE TRANSFER IS FOUND AND THE TRANSFER PRICE DOES NOT     21970216
BOSSC3*    MATCH THE ORIGINAL ECOM ORDER PRICE                          21970316
BOSSC3*    (EPITM-OWND-UNT-RTL-ORIG-AMT) SET THE                        21970416
BOSSC3*    PS-ECOM-PRICE-CHANGE-YES SWITCH TO TRUE SO THAT AN           21970516
BOSSC3*    OWNERSHIP ADJUSTMENT WILL BE CREATED.                        21970616
BOSSC3******************************************************************21970716
BOSSC3**   ADD WS-EPORD-ORD-NBR TO WHERE CLAUSE AFTER OMS STARTS        21970818
BOSSC3**   SENDING IT AND IT IS ADDED TO TRANSFER TABLE.                21970918
BOSSC3                                                                  21971016
BOSSC3      EXEC SQL                                                    21971116
BOSSC3         SELECT XFER_SKU_NBR                                      21971216
BOSSC3              , XFER_SHIPPING_STORE                               21971316
BOSSC3              , XFER_RECEIVING_STORE                              21971416
BOSSC3              , XFER_QUANTITY                                     21971516
BOSSC3              , XFER_BATCH_DATE                                   21971616
BOSSC3              , XFER_RETAIL_VALUE                                 21971716
BOSSC3          INTO :SAT00016-XFER-SKU-NBR                             21971816
BOSSC3              ,:SAT00016-XFER-SHIPPING-STORE                      21971916
BOSSC3              ,:SAT00016-XFER-RECEIVING-STORE                     21972016
BOSSC3              ,:SAT00016-XFER-QUANTITY                            21972116
BOSSC3              ,:SAT00016-XFER-BATCH-DATE                          21972216
BOSSC3              ,:SAT00016-XFER-RETAIL-VALUE                        21972316
BOSSC3          FROM  SAT_BOSS_TRANSFERS                                21972416
BOSSC3         WHERE XFER_SKU_NBR          = :EPITM-SKU-NBR             21972516
BOSSC3           AND XFER_RECEIVING_STORE  = :EPTRN-STR-NBR             21972616
BOSSC3           AND XFER_BATCH_DATE      >= :EPTRN-TRN-DTE             21972716
BOSSC3           AND XFER_BATCH_DATE      <= :EPTRN-SLS-DTE             21972816
BOSSC3      ORDER BY XFER_BATCH_DATE                                    21972916
BOSSC3         FETCH FIRST ROW ONLY                                     21973016
BOSSC3          WITH UR                                                 21973116
BOSSC3      END-EXEC.                                                   21973216
BOSSC3                                                                  21973316
BOSSC3     EVALUATE TRUE                                                21973416
BOSSC3        WHEN SQLCODE = ZERO                                       21973516
BOSSC3           COMPUTE PV-OLD-OMNI-PRICE =                            21973616
BOSSC3                   SAT00016-XFER-RETAIL-VALUE /                   21973716
BOSSC3                   SAT00016-XFER-QUANTITY                         21973816
BOSSC3* EPITM-OWND-UNT-RTL-ORIG-AMT DOESN'T INCLUDE SOLD QTY.           21973916
BOSSC3* EPITM-OWND-UNT-RTL-ORIG-AMT ON SFS AND BOPUS CLEARANCE ITEMS    21974016
BOSSC3* REFLECTS LAST ACTIVE PRICE?  IF THAT HAPPENS ON BOSS CLEARANCE  21974116
BOSSC3* ITEMS, WE MAY BE ABLE TO USE CUST-CHRGD-AMT, ASSUMING THAT      21974216
BOSSC3* THERE WOULD BE NO PROMOS ON CLEARANCE ITEMS?                    21974316
BOSSC3* PARA 2950- WILL MULTIPLY OLD AND NEW OMNI PRICES BY SOLD QTY.   21974416
BOSSC3* PARA 2950- WILL SUBTRACT OLD FROM NEW                           21974516
BOSSC3           IF EPITM-OWND-UNT-RTL-ORIG-AMT = PV-OLD-OMNI-PRICE     21974616
BOSSC3               SET PS-ECOM-PRICE-CHANGE-NO   TO  TRUE             21974716
BOSSC3           ELSE                                                   21974816
BOSSC3               SET PS-ECOM-PRICE-CHANGE-YES  TO  TRUE             21974916
BOSSC3               MOVE EPITM-OWND-UNT-RTL-ORIG-AMT                   21975016
BOSSC3                 TO PV-NEW-OMNI-PRICE                             21975116
BOSSC3           END-IF                                                 21975216
BOSSC3        WHEN SQLCODE = PC-ROW-NOT-FOUND                           21975316
BOSSC3**          THIS CONDITION SHOULD NOT BE HIT?                     21975416
BOSSC3            DISPLAY 'TRANSFER NOT FOUND'                          21975516
BOSSC3            SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE                21975616
BOSSC3        WHEN OTHER                                                21975716
BOSSC3            DISPLAY 'TRANSFER CALL FAILED '                       21975816
BOSSC3            SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE                21975916
BOSSC3     END-EVALUATE.                                                21976016
BOSSC3                                                                  21976116
BOSSCL******************************************************************21976210
BOSSC2 2940-CHECK-FOR-ECOM-PRICE-CHG.                                   21976313
BOSSC2*    REQUIRED WHEN A BOSS ORDER IS BEING PROCESSED                21976413
BOSSC2*    CHECK FOR ECOM PRICE FIRST                                   21976513
BOSSC2*    IF ECOM PRICE NOT FOUND, CHECK FOR CORP PRICE (LOC ZERO)     21976613
BOSSCL******************************************************************21976710
BOSSCL**    GET PRICE WHEN CUSTOMER PLACED ORDER                        21976810
BOSSC2      SET PS-ECOM-PRICE-NOT-FOUND   TO TRUE.                      21976913
BOSSC2***   MOVE EPTRN-STR-NBR            TO PV-STR-NBR-DB2.            21977013
BOSSC2      MOVE 873                      TO PV-STR-NBR-DB2.            21977113
BOSSCL      PERFORM 2942-GET-ORDER-DATE-PRICE.                          21977210
BOSSC2      IF PS-ECOM-PRICE-NOT-FOUND                                  21977313
BOSSCL          MOVE ZEROES               TO PV-STR-NBR-DB2             21977410
BOSSCL          PERFORM 2942-GET-ORDER-DATE-PRICE                       21977510
BOSSCL      END-IF.                                                     21977610
BOSSCL                                                                  21977710
BOSSC2      IF PS-ECOM-PRICE-FOUND                                      21977813
BOSSC2**    CHECK IF TRANSFER DATE FELL WITHIN SAME PRICE CHANGE AS     21977913
BOSSC2**    ORDER DATE                                                  21978013
BOSSC2*         IF  EPTRN-SLS-DTE IS >= PV-PRICE-CHG-STRT-DATE          21978113
BOSSC2*         AND EPTRN-SLS-DTE IS <= PV-PRICE-CHG-END-DATE           21978213
BOSSC2          IF  PV-TRANSFER-DATE IS >= PV-PRICE-CHG-STRT-DATE       21978313
BOSSC2          AND PV-TRANSFER-DATE IS <= PV-PRICE-CHG-END-DATE        21978413
BOSSC2              SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE              21978513
BOSSCL          ELSE                                                    21978610
BOSSC2**            GET PRICE WHEN TRANSFER COMPLETED                   21978713
BOSSC2              SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE              21978813
BOSSC2***           MOVE EPTRN-STR-NBR             TO PV-STR-NBR-DB2    21978913
BOSSC2              MOVE 873                       TO PV-STR-NBR-DB2    21979013
BOSSCL              PERFORM 2944-GET-SALE-DATE-PRICE                    21979110
BOSSC2              IF PS-ECOM-PRICE-NOT-FOUND                          21979213
BOSSCL                  MOVE ZEROES                TO PV-STR-NBR-DB2    21979310
BOSSCL                  PERFORM 2944-GET-SALE-DATE-PRICE                21979410
BOSSCL              END-IF                                              21979510
BOSSCL              IF PS-ECOM-PRICE-FOUND                              21979613
BOSSCL                  IF PV-OLD-OMNI-PRICE = PV-NEW-OMNI-PRICE        21979710
BOSSC2                      SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE      21979813
BOSSCL                  ELSE                                            21979910
BOSSC2                      SET PS-ECOM-PRICE-CHANGE-YES   TO TRUE      21980013
BOSSCL                  END-IF                                          21980110
BOSSCL              ELSE                                                21980210
BOSSCL***           PRICING NOT FOUND - DO NOT ATTEMPT OWNERSHIP ADJ    21980310
BOSSC2              DISPLAY 'PRICING NOT FOUND FOR TRANSFER DATE'       21980413
BOSSC2                  SET PS-ECOM-PRICE-CHANGE-NO        TO TRUE      21980513
BOSSCL              END-IF                                              21980610
BOSSCL          END-IF                                                  21980710
BOSSCL      ELSE                                                        21980810
BOSSCL***   PRICING NOT FOUND - DO NOT ATTEMPT OWNERSHIP ADJ            21980910
BOSSCL          DISPLAY 'PRICING NOT FOUND FOR ORDER DATE '             21981013
BOSSC2          SET PS-ECOM-PRICE-CHANGE-NO                TO TRUE      21981113
BOSSCL      END-IF.                                                     21981210
BOSSCL                                                                  21981310
BOSSCL******************************************************************21981410
BOSSCL 2942-GET-ORDER-DATE-PRICE.                                       21981510
BOSSCL*    GET THE ACTIVE PRICE FOR THE ORDER DATE.                     21981610
BOSSCL*    IF THE STORE PRICE IS NOT FOUND, THIS PARAGRAPH WILL BE      21981710
BOSSCL*    CALLED AGAIN TO FIND THE CORPORATE LOC ZERO PRICE.           21981810
BOSSCL******************************************************************21981910
BOSSCL*    SET TIMESTAMP TO TRAN DATE AT 2:00 AM.                       21982010
BOSSCL     MOVE EPTRN-TRN-DTE    TO PV-TS-DATE.                         21982110
BOSSCL     MOVE PV-TIMESTAMP-DB2 TO PV-TIMESTAMP.                       21982210
BOSSCL                                                                  21982310
BOSSCL      EXEC SQL                                                    21982410
BOSSCL         SELECT A.SKU                                             21982510
BOSSCL              , B.STR_NBR                                         21982610
BOSSCL              , DATE(B.STRT_TMST)                                 21982710
BOSSCL              , DATE(B.END_TMST)                                  21982810
BOSSCL              , B.STATUS_CDE                                      21982910
BOSSCL              , B.RTL_AMT                                         21983010
BOSSCL              , A.ITM_NBR                                         21983110
BOSSCL          INTO :SKXREF-SKU                                        21983210
BOSSCL              ,:PPCPRC-STR-NBR                                    21983310
BOSSCL              ,:PV-PRICE-CHG-STRT-DATE                            21983410
BOSSCL              ,:PV-PRICE-CHG-END-DATE                             21983510
BOSSCL              ,:PPCPRC-STATUS-CDE                                 21983610
BOSSCL              ,:PPCPRC-RTL-AMT                                    21983710
BOSSCL              ,:SKXREF-ITM-NBR                                    21983810
BOSSCL          FROM TSKXREF A                                          21983910
BOSSCL             , TPPCPRC B                                          21984010
BOSSCL         WHERE B.STR_NBR        = :PV-STR-NBR-DB2                 21984110
BOSSCL           AND A.SKU            = :EPITM-SKU-NBR                  21984210
BOSSCL           AND A.ITM_NBR        = B.TSK_ITM_NBR                   21984310
BOSSCL           AND (:PV-TIMESTAMP BETWEEN B.STRT_TMST AND B.END_TMST) 21984410
BOSSCL          WITH UR                                                 21984510
BOSSCL      END-EXEC.                                                   21984610
BOSSCL                                                                  21984710
BOSSCL     EVALUATE TRUE                                                21984810
BOSSCL        WHEN SQLCODE = ZERO                                       21984910
BOSSC2           SET PS-ECOM-PRICE-FOUND         TO TRUE                21985013
BOSSCL           MOVE PPCPRC-RTL-AMT             TO  PV-NEW-OMNI-PRICE  21985110
BOSSCL        WHEN SQLCODE = PC-ROW-NOT-FOUND                           21985210
BOSSCL**          STORE SEARCH COULD HIT HERE, BUT NOT CORP SEARCH      21985310
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                21985413
BOSSCL        WHEN OTHER                                                21985510
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                21985613
BOSSCL     END-EVALUATE.                                                21985710
BOSSCL                                                                  21985810
BOSSCL                                                                  21985910
BOSSCL******************************************************************21986010
BOSSCL 2944-GET-SALE-DATE-PRICE.                                        21986110
BOSSCL*    GET THE ACTIVE PRICE FOR THE SALE DATE.                      21986210
BOSSC2*    TRANSFER DATE IS 2 DAYS EARLIER THEN SALES DATE TO MIMIC     21986315
BOSSC2*    ACTUAL TRANSFER DATE.  ECOM PRICE CHANGES AFTER THE TRANSFER 21986413
BOSSC2*    DATE SHOULDN'T RESULT IN AN OWNERSHIP ADJUSTMENT.            21986513
BOSSCL*    IF THE STORE PRICE IS NOT FOUND, THIS PARAGRAPH WILL BE      21986610
BOSSCL*    CALLED AGAIN TO FIND THE CORPORATE LOC ZERO PRICE.           21986710
BOSSCL******************************************************************21986810
BOSSCL                                                                  21986910
BOSSCL*    SET TIMESTAMP TO SALES DATE AT 2:00 AM.                      21987010
BOSSC2*    MOVE EPTRN-SLS-DTE    TO PV-TS-DATE.                         21987113
BOSSC2     MOVE PV-TRANSFER-DATE TO PV-TS-DATE.                         21987213
BOSSCL     MOVE PV-TIMESTAMP-DB2 TO PV-TIMESTAMP.                       21987310
BOSSCL                                                                  21987410
BOSSCL      EXEC SQL                                                    21987510
BOSSCL         SELECT A.SKU                                             21987610
BOSSCL              , B.STR_NBR                                         21987710
BOSSCL              , DATE(B.STRT_TMST)                                 21987810
BOSSCL              , DATE(B.END_TMST)                                  21987910
BOSSCL              , B.STATUS_CDE                                      21988010
BOSSCL              , B.RTL_AMT                                         21988110
BOSSCL              , A.ITM_NBR                                         21988210
BOSSCL          INTO :SKXREF-SKU                                        21988310
BOSSCL              ,:PPCPRC-STR-NBR                                    21988410
BOSSCL              ,:PV-PRICE-CHG-STRT-DATE                            21988510
BOSSCL              ,:PV-PRICE-CHG-END-DATE                             21988610
BOSSCL              ,:PPCPRC-STATUS-CDE                                 21988710
BOSSCL              ,:PPCPRC-RTL-AMT                                    21988810
BOSSCL              ,:SKXREF-ITM-NBR                                    21988910
BOSSCL          FROM TSKXREF A                                          21989010
BOSSCL             , TPPCPRC B                                          21989110
BOSSCL         WHERE B.STR_NBR        = :PV-STR-NBR-DB2                 21989210
BOSSCL           AND A.SKU            = :EPITM-SKU-NBR                  21989310
BOSSCL           AND A.ITM_NBR        = B.TSK_ITM_NBR                   21989410
BOSSCL           AND (:PV-TIMESTAMP BETWEEN B.STRT_TMST AND B.END_TMST) 21989510
BOSSCL          WITH UR                                                 21989610
BOSSCL      END-EXEC.                                                   21989710
BOSSCL                                                                  21989810
BOSSCL     EVALUATE TRUE                                                21989910
BOSSCL        WHEN SQLCODE = ZERO                                       21990010
BOSSC2            SET PS-ECOM-PRICE-FOUND        TO TRUE                21990113
BOSSCL            MOVE PPCPRC-RTL-AMT            TO PV-OLD-OMNI-PRICE   21990210
BOSSCL        WHEN SQLCODE = PC-ROW-NOT-FOUND                           21990310
BOSSCL**          STORE SEARCH COULD HIT HERE, BUT NOT CORP SEARCH      21990410
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                21990513
BOSSCL        WHEN OTHER                                                21990610
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                21990713
BOSSCL     END-EVALUATE.                                                21990810
BOSSCL                                                                  21990910
BOSSCL                                                                  21991010
BOSSCL******************************************************************21991110
BOSSCL 2950-CREATE-BOSS-OWNERSHIP-ADJ.                                  21991223
BOSSCL*    REQUIRED WHEN A BOSS ORDER IS BEING PROCESSED AND THE        21991323
BOSSCL*    ECOM PRICE CHANGED AFTER THE ECOM ORDER WAS PLACED AND       21991423
BOSSCL*    BEFORE THE TRANSFER TO THE STORE HAPPENED.                   21991523
BOSSC3*    PV-OLD-OMNI-PRICE SET TO TRANSFER DATE PRICE FOR PRICE LOOKUP21991716
BOSSC3*    OR TRANSFER PRICE FOR TRANSFER LOOKUP.                       21991816
BOSSC3*    PV-NEW-OMNI-PRICE SET TO ORDER DATE PRICE FOR PRICE LOOKUP   21991916
BOSSC3*    OR EPITM-OWND-UNT-RTL-ORIG-AMT FOR TRANSFER LOOKUP.          21992016
BOSSCL******************************************************************21992110
BOSSCL                                                                  21992210
BOSSCL     SET ML017-MKDOWN                                             21992310
BOSSCL         ML017-BN-OWN-ADJ                                         21992410
BOSSCL         ML017-RC-MISCELLANEOUS                                   21992510
BOSSCL         ML017-REGISTER-MKDN-MKON     TO TRUE.                    21992610
BOSSCL     MOVE PC-OWN-ADJ-796    TO ML017-PC-MKDN-MKUP-RSN-CDE.        21992710
BOSSCL     COMPUTE ML017-PC-OLD-PR-AMT      =                           21992810
BOSSCL             PV-OLD-OMNI-PRICE            * EPITM-SLD-QTY.        21992910
BOSSCL     COMPUTE ML017-PC-NEW-PR-AMT      =                           21993010
BOSSCL             PV-NEW-OMNI-PRICE            * EPITM-SLD-QTY.        21993110
BOSSCL     MOVE EPITM-SLD-QTY               TO ML017-PC-QTY.            21993210
BOSSCL                                                                  21993310
BOSSCL     COMPUTE ML017-PC-DIFFER-AMT =                                21993410
BOSSCL             ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT.           21993510
BOSSCL                                                                  21993610
BOSSCL     IF ML017-PC-DIFFER-AMT < 0                                   21993710
BOSSCL*        PRICE DECREASE - GENERATE MARKDOWN CANCEL                21993810
BOSSCL*        LOGIC BELOW COPIED FROM 3600-MARKDOWN-CANCEL             21993910
BOSSCL         SET ML017-MARKDOWN-CANCEL TO TRUE                        21994010
BOSSCL         ADD +1     TO PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)      21994110
BOSSCL         ADD ML017-PC-DIFFER-AMT  TO                              21994210
BOSSCL             PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                21994310
BOSSCL         MOVE 'MDC'               TO WS-MDWN-TYPE                 21994410
BOSSCL     ELSE                                                         21994510
BOSSCL*        PRICE INCREASE - GENERATE MARKDOWN                       21994610
BOSSCL*        BELOW LOGIC COPIED FROM 3120-CONTINUE-PROCESS            21994710
BOSSCL         SET ML017-MARKDOWN          TO TRUE                      21994810
BOSSCL         ADD +1    TO PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)      21994910
BOSSCL         ADD ML017-PC-DIFFER-AMT     TO                           21995010
BOSSCL             PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)               21995110
BOSSCL         MOVE 'MD'                   TO WS-MDWN-TYPE              21995210
BOSSCL     END-IF.                                                      21995310
BOSSCL                                                                  21995410
BOSSCL     MOVE ML017-PC-DIFFER-AMT    TO WS-DISC-AMT.                  21995510
BOSSCL     MOVE PC-OWNERSHIP-ADJ       TO WS-DISC-TYPE.                 21995610
BOSSCL     PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       21995710
BOSSCL     PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       21995810
BOSSCL                                                                  21995910
BOSSCL     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        21996010
BOSSCL                                                                  21996110
219700******************************************************************21996200
219800 3000-POPULATE-MISC-FIELDS.                                       21996300
219900*     POPULATE MISC FIELDS.                                       21997000
220000******************************************************************22000000
220100                                                                  22010000
220200     INITIALIZE ML017-PC-CATEGORY-IND.                            22020000
220300                                                                  22030000
220400     IF EPITM-DEPT-CL-ERR-CDE NOT EQUAL '0' AND                   22040000
220500        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '1' AND                   22050000
220600        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '2' AND                   22060000
220700        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '3' OR                    22070000
220800        EPITM-SKU-ERR-CDE = '2'                                   22080000
220900        MOVE EPITM-SKU-NBR            TO ML017-PC-SKU             22090000
221000        MOVE '099'                    TO ML017-PC-DEPT-NBR        22100000
221100                                         EPITM-DEPT-NBR           22110000
221200                                         ML017-PC-SKU(1:3)        22120000
221300        MOVE '10'                     TO ML017-PC-CLASS-NBR       22130000
221400                                         EPITM-SUB-CL-NBR         22140000
221500                                         ML017-PC-SKU(4:2)        22150000
221600     ELSE                                                         22160000
221700        MOVE EPITM-DEPT-NBR           TO ML017-PC-DEPT-NBR        22170000
221800        MOVE EPITM-SUB-CL-NBR         TO ML017-PC-CLASS-NBR       22180000
221900        MOVE EPITM-SKU-NBR            TO ML017-PC-SKU             22190000
222000     END-IF.                                                      22200000
222100                                                                  22210000
222200     MOVE EPITM-DEPT-NBR              TO ML017-PC-DOC-DEPT.       22220000
222300     MOVE EPTRN-SLS-DTE               TO PV-ISO-DB2-DATE.         22230000
222400     MOVE PV-ISO-DB2-DD               TO ML017-PC-DOC-DAY.        22240000
222500     MOVE ML017-PC-DOC-NBR            TO ML017-PC-DOC-5-NBR.      22250000
222600     MOVE PV-ISO-DB2-MM               TO ML017-PC-DTE-MM.         22260000
222700     MOVE PV-ISO-DB2-DD               TO ML017-PC-DTE-DD.         22270000
222800     MOVE PV-FISC-PERIOD-NBR-HOLD     TO ML017-PC-KOHLS-MM.       22280000
222900     MOVE EPITM-MAJ-CL-NBR            TO ML017-PC-MAJ-CLASS.      22290000
223000     MOVE +1                          TO ML017-PC-QTY             22300000
223100                                         ML017-PC-TOT-DOC-QTY.    22310000
223200     MOVE EPTRN-STR-NBR               TO PV-STR-NBR-4.            22320000
223300     MOVE PV-RFMT-STR-NBR             TO ML017-PC-STORE-NBR.      22330000
223400     MOVE EPITM-SKU-NBR               TO PV-SKU-NBR.              22340000
223500     MOVE PV-RGST-ID                  TO ML017-RGST-ID.           22350000
223600     MOVE PV-TRN-NBR                  TO ML017-TRN-NBR.           22360000
223700     MOVE PV-LNE-ITM-SEQ-NBR          TO ML017-LNE-ITM-SEQ-NBR.   22370000
ZX         MOVE EPITM-ORIG-SAL-TYP-CDE      TO PV-ORIG-SAL-TYP-CDE.     22370100
ZX         MOVE EPITM-SAL-TYP-CDE           TO PV-SAL-TYP-CDE.          22370200
ZX         MOVE EPITM-ORIG-REG-RTL-AMT      TO PV-ORIG-REG-RTL-AMT.     22370300
ZX         MOVE EPITM-REG-RTL-AMT           TO PV-REG-RTL-AMT.          22371000
ZX         MOVE EPITM-CUST-CHRGD-AMT        TO PV-CUST-CHRGD-AMTS.      22372000
ZX         MOVE EPITM-NET-CHRGD-AMT         TO PV-NET-CHRGD-AMTS.       22373000
ZX         IF PV-ORIG-OWND-UNT-AMT-NULL-IND = PC-NULL                   22373100
ZX             MOVE ZEROES                  TO PV-ORIG-OURA-AMTS        22373200
ZX         ELSE                                                         22373300
ZX             MOVE EPITM-OWND-UNT-RTL-ORIG-AMT                         22373400
ZX                                          TO PV-ORIG-OURA-AMTS        22373500
ZX         END-IF.                                                      22373600
ZX         MOVE EPITM-ITM-STAT-CDE          TO PV-ITM-STAT-CDE.         22374000
ZX         MOVE EPITM-DEPT-NBR              TO PV-DEPT-NBR.             22375000
223800                                                                  22380000
223900     IF EPTRN-TRN-STAT-CDE = 'V' OR                               22390000
224000        EPTRN-TRN-STAT-CDE = 'R'                                  22400000
224100        SET ML017-SALES-AUDIT-CORR    TO TRUE                     22410000
224200        IF DPG55-DB2-ISO-DATE-FMT LESS THAN PV-CUT-OFF-CCYY-MM-DD 22420000
224300           MOVE 4              TO PV-TOT-SUB                      22430000
224400        ELSE                                                      22440000
224500           MOVE 2              TO PV-TOT-SUB                      22450000
224600        END-IF                                                    22460000
224700     ELSE                                                         22470000
224800        IF EPTRN-TRN-STAT-CDE = 'L'                               22480000
224900           SET ML017-SYSTEM-LATE-CORR TO TRUE                     22490000
225000           IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    22500000
225100              PV-CUT-OFF-CCYY-MM-DD                               22510000
225200              MOVE 5          TO PV-TOT-SUB                       22520000
225300           ELSE                                                   22530000
225400              MOVE 3          TO PV-TOT-SUB                       22540000
225500           END-IF                                                 22550000
225600        ELSE                                                      22560000
225700           MOVE 1              TO PV-TOT-SUB                      22570000
225800        END-IF                                                    22580000
225900     END-IF.                                                      22590000
226000                                                                  22600000
226100******************************************************************22610000
226200* CHECK FOR EMPLOYEE DISCOUNT                                     22620000
226300******************************************************************22630000
226400 3001-CHECK-DISCOUNT.                                             22640000
226500                                                                  22650000
226600      EXEC SQL                                                    22660000
226700         SELECT  EMP_DISC_AMT                                     22670000
226800           INTO :EPEID-EMP-DISC-AMT                               22680000
226900                                                                  22690000
227000           FROM TEPEID                                            22700000
227100                                                                  22710000
227200          WHERE PARTN_NBR        = :PV-PARTN-NBR                  22720000
227300            AND STR_NBR          = :PV-STR-NBR                    22730000
227400            AND RGST_ID          = :PV-RGST-ID                    22740000
227500            AND TRN_NBR          = :PV-TRN-NBR                    22750000
227600            AND STRT_TM          = :PV-STRT-TM                    22760000
227700            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           22770000
227800            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            22780000
227900                                                                  22790000
228000          WITH UR                                                 22800000
228100      END-EXEC.                                                   22810000
228200                                                                  22820000
228300     EVALUATE TRUE                                                22830000
228400        WHEN SQLCODE = ZERO                                       22840000
228500           PERFORM 3002-EMPLY-DISCOUNT                            22850000
228600           PERFORM 4000-PROCESS-MARKDOWN-MARKUP                   22860000
228700*** NEED TO CLEAR OUT WORKING STORAGE TO WHERE IT WOULD HAVE BEEN 22870000
228800*** WITHOUT THE DISCOUNT.  AS A RESULT, INITIALIZE THE RECORD AS  22880000
228900*** IT WAS PRIOR TO WORKING WITH THE EMPLOYEE DISCOUNT.           22890000
229000           INITIALIZE ML017-PRICE-CHANGE-RECORD                   22900000
229100           PERFORM 3000-POPULATE-MISC-FIELDS                      22910000
229200        WHEN SQLCODE = PC-ROW-NOT-FOUND                           22920000
229300           CONTINUE                                               22930000
229400        WHEN OTHER                                                22940000
229500           MOVE '3001-CHECK-DISCOUNT'                             22950000
229600                                      TO PV-PARAGRAPH-NAME        22960000
229700           SET AC-DB2-ERROR           TO TRUE                     22970000
229800           PERFORM 9999-ABEND                                     22980000
229900                                                                  22990000
230000     END-EVALUATE.                                                23000000
230100                                                                  23010000
230200                                                                  23020000
230300******************************************************************23030000
230400* PROCESS EMPLOYEE DISCOUNTS                                      23040000
230500******************************************************************23050000
230600 3002-EMPLY-DISCOUNT.                                             23060000
230700                                                                  23070000
230800     MOVE EPITM-NET-CHRGD-AMT TO PV-NET-CHRGD-AMT-TMP.            23080000
230900                                                                  23090000
231000     COMPUTE EPITM-NET-CHRGD-AMT = EPITM-NET-CHRGD-AMT            23100000
231100                                 - EPEID-EMP-DISC-AMT.            23110000
231200                                                                  23120000
231300     SET ML017-MKDOWN                                             23130000
231400         ML017-RC-MISCELLANEOUS                                   23140000
231500         ML017-BN-EMPLY-DISCOUNT                                  23150000
231600         ML017-REGISTER-MKDN-MKON TO TRUE.                        23160000
231700                                                                  23170000
231800     MOVE PC-790-EMPLY-DISCOUNT TO                                23180000
231900                ML017-PC-MKDN-MKUP-RSN-CDE.                       23190000
232000                                                                  23200000
232100     MOVE EPITM-NET-CHRGD-AMT  TO ML017-PC-OLD-PR-AMT.            23210000
232200     MOVE PV-NET-CHRGD-AMT-TMP TO ML017-PC-NEW-PR-AMT.            23220000
ZX         SET PV-DISC-TYPE-ASSOC TO TRUE.                              23221000
232300                                                                  23230000
232400     IF  EPEID-EMP-DISC-AMT < ZERO                                23240000
232500         SET ML017-MARKDOWN TO TRUE                               23250000
232600                                                                  23260000
232700         COMPUTE EPEID-EMP-DISC-AMT =                             23270000
232800                 EPEID-EMP-DISC-AMT * (-1)                        23280000
232900                                                                  23290000
233000         ADD +1           TO PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)  23300000
233100         ADD EPEID-EMP-DISC-AMT                                   23310000
233200                          TO PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)  23320000
ZX             MOVE EPEID-EMP-DISC-AMT TO WS-DISC-AMT                   23321000
ZX             MOVE PC-EMPLY-DISCOUNT TO WS-DISC-TYPE                   23322000
ZX             MOVE 'MD'              TO WS-MDWN-TYPE                   23323000
ZX             PERFORM 8195-BUILD-DAY02-TRANS-RECORD                    23324000
ZX             PERFORM 8195-WRITE-DAY02-TRANS-RECORD                    23325000
233300     ELSE                                                         23330000
233400         SET ML017-MARKDOWN-CANCEL TO TRUE                        23340000
233500                                                                  23350000
233600         MOVE ZEROS              TO ML017-PC-OLD-PR-AMT           23360000
233700         MOVE EPEID-EMP-DISC-AMT TO ML017-PC-NEW-PR-AMT           23370000
233800         COMPUTE EPEID-EMP-DISC-AMT =                             23380000
233900                 EPEID-EMP-DISC-AMT * (-1)                        23390000
234000                                                                  23400000
234100         ADD +1           TO PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)   23410000
234200         ADD EPEID-EMP-DISC-AMT                                   23420000
234300                          TO PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)   23430000
ZX             MOVE EPEID-EMP-DISC-AMT TO WS-DISC-AMT                   23431000
ZX             MOVE PC-EMPLY-DISCOUNT  TO WS-DISC-TYPE                  23432000
ZX             MOVE 'MDC'              TO WS-MDWN-TYPE                  23433000
ZX             PERFORM 8195-BUILD-DAY02-TRANS-RECORD                    23434000
ZX             PERFORM 8195-WRITE-DAY02-TRANS-RECORD                    23435000
234400     END-IF.                                                      23440000
234500                                                                  23450000
234600     MOVE EPEID-EMP-DISC-AMT   TO ML017-PC-DIFFER-AMT.            23460000
234700                                                                  23470000
234800******************************************************************23480000
234900 3100-RETURN-ITEM-MARKDOWN.                                       23490000
235000*     PROCESS BACK OFFICE MARKDOWN FOR QUALIFY RETURN ITEMS.      23500000
235100*     FOR RETURN ITEMS, EPITM-CUST-CHRGD-AMT IS NEGATIVE, TO      23510000
235200*     SUBTRACT THAT AMOUNT, HAS TO "ADD" IT TO THE GROUPED PRICE. 23520000
235300******************************************************************23530000
235400                                                                  23540000
235500     PERFORM 3200-SELECT-GROUP-PRICING.                           23550000
235600     IF SQLCODE = ZERO                                            23560000
ZX            SET PV-DISC-TYPE-GROUP TO TRUE                            23561000
235700        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPIGP-GP-AMT             23570000
235800                                       / EPIGP-GP-QTY             23580000
235900                                       * EPITM-SLD-QTY            23590000
236000                                       + EPITM-CUST-CHRGD-AMT     23600000
ZX            MOVE PV-PRICE-CHANGE-AMOUNT TO WS-EPIGP-GP-AMT            23601000
236100     ELSE                                                         23610000
236200        IF PV-SKU-LST-3-DGT        EQUAL ZERO                     23620000
236300           COMPUTE PV-PRICE-CHANGE-AMOUNT = EPITM-REG-RTL-AMT     23630000
236400                                          * EPITM-SLD-QTY         23640000
236500        ELSE                                                      23650000
236600***** CORRECT NET-CHRGD-AMT < 0 AND CUST-CHRGD-AMT > 0            23660000
236700           IF EPITM-NET-CHRGD-AMT < 0 AND                         23670000
236800              EPITM-CUST-CHRGD-AMT > 0 AND                        23680000
236900              EPITM-REG-RTL-AMT    = 0                            23690000
237000              MOVE ZERO           TO PV-PRICE-CHANGE-AMOUNT       23700000
237100           ELSE                                                   23710000
237200              COMPUTE PV-PRICE-CHANGE-AMOUNT                      23720000
237300                    = EPITM-CUST-CHRGD-AMT                        23730000
237400                    + EPITM-REG-RTL-AMT                           23740000
237500                    * EPITM-SLD-QTY                               23750000
237600           END-IF                                                 23760000
237700        END-IF                                                    23770000
237800     END-IF.                                                      23780000
237900                                                                  23790000
238000     COMPUTE PV-PRICE-CHANGE-AMOUNT = PV-PRICE-CHANGE-AMOUNT      23800000
238100                                    * (-1).                       23810000
238200                                                                  23820000
214615     IF (EPITM-ORIG-REG-RTL-AMT > 0                               23820100
214615     AND EPITM-ORIG-REG-RTL-AMT NOT = EPITM-REG-RTL-AMT)          23820200
214615        PERFORM 3140-NEW-PROCESS                                  23820300
214615     ELSE                                                         23820400
214615        PERFORM 3120-CONTINUE-PROCESS                             23820500
214615     END-IF.                                                      23820600
214615                                                                  23820700
242000******************************************************************23828000
214615 3120-CONTINUE-PROCESS.                                           23828100
214615                                                                  23828200
238300     SET ML017-MKDOWN                                             23830000
238400         ML017-RC-MISCELLANEOUS                                   23840000
238500         ML017-BN-OWN-ADJ                                         23850000
238600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    23860000
238700                                                                  23870000
011618     IF EPTRN-POS-CPBL-LVL-NBR = PC-POC AND                       23870100
062118        (EPITM-SAL-RET-CDE = 'R' OR                               23870200
062118         EPITM-SAL-RET-CDE = 'B')                                 23870300
011618         PERFORM 3300-CALC-EXTENDED-AMT                           23870400
011618         IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                   23873000
ZX    *** IN HERE FOR PRICE MOVEMENT DOWNWARD ON RETURNS ITEMS          23873100
ZX    *** WOULD NEED TO CHECK THE ORIGINAL SALE HERE TO DETERMINE       23873200
ZX    *** WHETHER OR NOT TO DO PROMO PRICING AS WELL                    23873300
ZX    *** WOULD NEED TO ADD THE PROMO DIFFERENCE INTO THE               23873400
ZX    *** RET OWN ADJ AMOUNT ALSO IN ORDER FOR THAT TO BE CORRECT       23873500
ZX    *** WOULD NEED SEPARATE SCENARIOS FOR PRICE MOVEMENT UPWARD       23873600
ZX    ******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     23874000
ZX    ******* BEING PROCESSED AS MARKUPS.                               23875000
ZX    * I THINK THIS IS IMPOSSIBLE TO HIT FOR POC                       23875100
011618             IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND              23877700
011618                EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO             23877800
ZX?   * THIS WAS COMMENTED OUT AND ON 4/24 I UNCOMMENTED IT             23877900
ZX?   * IN PRODUCTION IT WASN'T COMMENTED                               23878000
ZX?   *                PERFORM 3400-MARKUP-CANCEL                       23878100
062918                 IF PV-PRICE-CHANGE-AMOUNT < ZERO                 23878400
062918                     MOVE PC-OWN-ADJ-796        TO                23878500
062918                                       ML017-PC-MKDN-MKUP-RSN-CDE 23878600
062918                     SET ML017-MARKDOWN-CANCEL  TO TRUE           23878700
062918                     MOVE ZERO            TO ML017-PC-OLD-PR-AMT  23878800
062918                     MOVE PV-PRICE-CHANGE-AMOUNT                  23878900
062918                                          TO ML017-PC-NEW-PR-AMT  23879000
062918                                             ML017-PC-DIFFER-AMT  23879100
062918                     ADD +1                     TO                23879200
062918                            PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB) 23879300
062918                     ADD ML017-PC-DIFFER-AMT    TO                23879400
062918                            PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB) 23879500
ZX                         MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT    23879600
ZX                         MOVE PC-OWNERSHIP-ADJ      TO WS-DISC-TYPE   23879700
ZX                         MOVE 'MDC'                 TO WS-MDWN-TYPE   23879800
ZX                         PERFORM 8195-BUILD-DAY02-TRANS-RECORD        23880000
ZX                         PERFORM 8195-WRITE-DAY02-TRANS-RECORD        23880100
062918                 END-IF                                           23880200
062918                 IF PV-PRICE-CHANGE-AMOUNT > ZERO                 23880300
062118                     MOVE PC-OWN-RTN-ADJ-792    TO                23880400
062118                                       ML017-PC-MKDN-MKUP-RSN-CDE 23880500
062118                     SET ML017-MARKDOWN         TO TRUE           23880600
072618                     MOVE EPITM-OWND-UNT-RTL-AMT                  23881000
072618                                           TO ML017-PC-NEW-PR-AMT 23881100
072618                     MOVE EPITM-CUST-CHRGD-AMT                    23881200
072618                                           TO ML017-PC-OLD-PR-AMT 23881300
072618                     COMPUTE ML017-PC-DIFFER-AMT =                23881600
072618                       ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT  23881700
062118                     SET ML017-BN-OWN-RTN-ADJ   TO TRUE           23882100
062118                     ADD +1                     TO                23882200
062118                            PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)23882300
062118                     ADD ML017-PC-DIFFER-AMT TO                   23882400
062118                            PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)23882500
ZX                         MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT    23882600
ZX                         MOVE PC-OWN-RETRN-ADJ      TO WS-DISC-TYPE   23882700
ZX                         MOVE 'MD'                  TO WS-MDWN-TYPE   23882800
ZX                         PERFORM 8195-BUILD-DAY02-TRANS-RECORD        23883000
ZX                         PERFORM 8195-WRITE-DAY02-TRANS-RECORD        23883100
062918                 END-IF                                           23883200
011618             END-IF                                               23887400
011618         ELSE                                                     23887500
011618              IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT              23887900
011618                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              23888000
214615                  OR EPITM-PROMO-SCHM-CDE NOT = ZERO              23888100
011618                     PERFORM 3500-PROMO-MARKDOWN-CANCEL           23888200
011618                  ELSE                                            23888300
011618                     PERFORM 3600-MARKDOWN-CANCEL                 23888400
011618                  END-IF                                          23888500
011618              END-IF                                              23888600
011618         END-IF                                                   23888700
011618     ELSE                                                         23888800
238800     EVALUATE TRUE                                                23889000
238900        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        23890000
239000           MOVE PC-OWN-ADJ-796        TO                          23900000
239100                ML017-PC-MKDN-MKUP-RSN-CDE                        23910000
239200           SET ML017-MARKDOWN-CANCEL  TO TRUE                     23920000
239300           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      23930000
239400           MOVE PV-PRICE-CHANGE-AMOUNT                            23940000
239500                                      TO ML017-PC-NEW-PR-AMT      23950000
239600                                         ML017-PC-DIFFER-AMT      23960000
239700           ADD +1                     TO                          23970000
239800               PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)              23980000
239900           ADD ML017-PC-DIFFER-AMT    TO PT-OWNERSHIP-ADJ-MDC-AMT 23990000
240000                                         (PV-TOT-SUB)             24000000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              24001000
ZX               MOVE PC-OWNERSHIP-ADJ      TO WS-DISC-TYPE             24002000
ZX               MOVE 'MDC'                 TO WS-MDWN-TYPE             24003000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  24004000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  24005000
240100        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        24010000
240200           SET ML017-MARKDOWN         TO TRUE                     24020000
240300           MOVE EPITM-OWND-UNT-RTL-AMT                            24030000
240400                                      TO ML017-PC-NEW-PR-AMT      24040000
240500           MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-OLD-PR-AMT       24050000
240600                                                                  24060000
240700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      24070000
240800                                       - ML017-PC-NEW-PR-AMT      24080000
240900           MOVE PC-OWN-RTN-ADJ-792    TO                          24090000
241000                ML017-PC-MKDN-MKUP-RSN-CDE                        24100000
241100           SET ML017-BN-OWN-RTN-ADJ TO TRUE                       24110000
241200           ADD +1                  TO                             24120000
241300               PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)             24130000
241400           ADD ML017-PC-DIFFER-AMT TO                             24140000
241500                  PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)          24150000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                24151000
ZX               MOVE PC-OWN-RETRN-ADJ   TO WS-DISC-TYPE                24152000
ZX               MOVE 'MD'               TO WS-MDWN-TYPE                24153000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  24154000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  24155000
241600        WHEN OTHER                                                24160000
241700           MOVE ZERO TO ML017-PC-DIFFER-AMT                       24170000
011618     END-EVALUATE                                                 24180000
011618     END-IF.                                                      24181000
011618                                                                  24182000
214615******************************************************************24183000
214615 3140-NEW-PROCESS.                                                24184000
214615                                                                  24187100
214615     MOVE ZERO TO ML017-PC-DIFFER-AMT.                            24187200
214615                                                                  24187300
214615     IF (EPITM-SAL-TYP-CDE  = PC-REGULAR-R                        24188000
214615     OR  EPITM-SAL-TYP-CDE  = PC-PROMO-P                          24189000
214615     OR  EPITM-SAL-TYP-CDE  = PC-UNKNOWN-N)                       24189100
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-REGULAR-R                   24189200
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                     24189300
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-UNKNOWN-N)                  24189400
214615        IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT             24189500
214615***      WT SALE, WT RETURN PM UP                                 24189600
214615           PERFORM 3142-MARKUP-RTN                                24189700
214615        ELSE                                                      24189800
214615***      WT SALE, WT RETURN PM DOWN                               24189900
214615           PERFORM 3146-MARKDOWN-RTN                              24190000
214615        END-IF                                                    24190100
214615     END-IF.                                                      24190200
214615                                                                  24190300
214615     IF (EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G                        24190400
214615     OR  EPITM-SAL-TYP-CDE = PC-CLEARANCE-C)                      24190500
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G                  24190600
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-CLEARANCE-C)                24190700
214615        IF EPITM-REG-RTL-AMT < EPITM-ORIG-REG-RTL-AMT             24190800
214615***      CL SALE, CL RETURN PM DOWN                               24190900
214615           PERFORM 3146-MARKDOWN-RTN                              24191000
214615        ELSE                                                      24191100
214615***      CL SALE, CL RETURN PM UP                                 24191200
214615           PERFORM 3144-MARKDOWN-CANCEL-RTN                       24191300
214615        END-IF                                                    24191400
214615     END-IF.                                                      24191500
214615                                                                  24191600
214615     IF (EPITM-SAL-TYP-CDE = PC-REGULAR-R                         24191700
214615     OR  EPITM-SAL-TYP-CDE = PC-PROMO-P                           24191800
214615     OR  EPITM-SAL-TYP-CDE = PC-UNKNOWN-N)                        24191900
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G                  24192000
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-CLEARANCE-C)                24192100
214615       IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT              24192200
214615***     CL SALE, WT RETURN PM UP                                  24192300
214615          PERFORM 3144-MARKDOWN-CANCEL-RTN                        24192400
214615      ELSE                                                        24192500
214615***     CL SALE, WT RETURN PM DOWN                                24192600
214615          PERFORM 3146-MARKDOWN-RTN                               24192700
214615       END-IF                                                     24192800
214615     END-IF.                                                      24193000
214615                                                                  24193100
214615     IF (EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G                        24193200
214615     OR  EPITM-SAL-TYP-CDE = PC-CLEARANCE-C)                      24193300
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-REGULAR-R                   24193400
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                     24193500
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-UNKNOWN-N)                  24193600
214615       IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT              24193800
214615***     WT SALE, CL RETURN PM UP                                  24193900
214615          PERFORM 3142-MARKUP-RTN                                 24194000
214615       ELSE                                                       24194100
214615***     WT SALE, CL RETURN PM DOWN                                24194200
214615          PERFORM 3146-MARKDOWN-RTN                               24194300
214615       END-IF                                                     24194400
214615     END-IF.                                                      24194600
214615                                                                  24194700
214615******************************************************************24194800
214615 3142-MARKUP-RTN.                                                 24194900
214615                                                                  24195200
214615     SET ML017-MKUP                                               24195600
214615         ML017-MARKUP                                             24195700
214615         ML017-RC-MISCELLANEOUS                                   24195800
214615         ML017-BN-OWN-RTN-ADJ                                     24195900
214615         ML017-REGISTER-MKDN-MKON     TO TRUE.                    24196000
214615                                                                  24196100
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   24197000
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          24197100
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          24197200
214615     COMPUTE ML017-PC-DIFFER-AMT  = ML017-PC-OLD-PR-AMT           24197300
214615                                  - ML017-PC-NEW-PR-AMT.          24197400
214615                                                                  24197500
214615     ADD +1                      TO                               24197700
214615                           PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB).24197800
214615     ADD ML017-PC-DIFFER-AMT     TO                               24197900
214615                           PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB).24198000
214615                                                                  24198100
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             24198300
ZX         MOVE PC-OWN-RETRN-ADJ            TO WS-DISC-TYPE.            24198400
ZX         MOVE 'MU'                        TO WS-MDWN-TYPE.            24198500
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       24198600
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       24198700
ZX                                                                      24199900
226892     COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                    24200200
226892                     +  EPITM-CUST-CHRGD-AMT) * -1.               24200300
226892     IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                      24200400
226892     OR  EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G)                  24200500
226892     AND PV-DIFF NOT = 0                                          24200600
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      24200900
214615        PERFORM 3850-PROMO-MARKDOWN2                              24201000
214615     END-IF.                                                      24201100
214615                                                                  24201200
214615******************************************************************24201300
214615 3144-MARKDOWN-CANCEL-RTN.                                        24201400
214615                                                                  24201600
214615     SET ML017-MKDOWN                                             24201700
214615         ML017-MARKDOWN-CANCEL                                    24201800
214615         ML017-RC-MISCELLANEOUS                                   24201900
214615         ML017-BN-OWN-RTN-ADJ                                     24202000
214615         ML017-REGISTER-MKDN-MKON TO TRUE.                        24202100
214615                                                                  24202200
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   24202300
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          24202500
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          24202600
214615     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            24202700
214615                                 - ML017-PC-NEW-PR-AMT.           24202800
214615                                                                  24202900
214615     ADD +1                     TO                                24203000
214615                           PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB). 24203100
214615     ADD ML017-PC-DIFFER-AMT    TO                                24203200
214615                           PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB). 24203300
226892* ADDED THE FOLLOWING TO FIX ML PRODUCTION ISSUE WITH MDC         24203600
226892* RELATED TO MLKUP021'S MDC TO MD FLIP LOGIC                      24203700
226892     MOVE ZERO                  TO ML017-PC-OLD-PR-AMT.           24203800
226892     MOVE ML017-PC-DIFFER-AMT   TO ML017-PC-NEW-PR-AMT.           24203900
214615                                                                  24204000
ZX                                                                      24204200
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             24204300
ZX         MOVE PC-OWN-RETRN-ADJ            TO WS-DISC-TYPE.            24204400
ZX         MOVE 'MDC'                       TO WS-MDWN-TYPE.            24204700
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       24204800
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       24204900
                                                                        24205100
226892     COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                    24205300
226892                     +  EPITM-CUST-CHRGD-AMT) * -1.               24205400
226892     IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                      24205500
226892     OR  EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G)                  24205600
226892     AND PV-DIFF NOT = 0                                          24205700
ZX    *       DISPLAY ' CDE = P OR G'                                   24205800
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      24205900
214615        PERFORM 3850-PROMO-MARKDOWN2                              24206000
214615     END-IF.                                                      24206100
214615                                                                  24206200
214615******************************************************************24206300
214615 3146-MARKDOWN-RTN.                                               24206400
214615                                                                  24206500
214615     SET ML017-MKDOWN                                             24206800
214615         ML017-RC-MISCELLANEOUS                                   24206900
214615         ML017-BN-OWN-RTN-ADJ                                     24207000
226892         ML017-MARKDOWN                                           24207100
214615         ML017-REGISTER-MKDN-MKON TO TRUE.                        24207200
214615                                                                  24207300
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   24207400
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          24207500
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          24207600
214615     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            24207700
214615                                 - ML017-PC-NEW-PR-AMT.           24207800
214615                                                                  24207900
214615     ADD +1                      TO                               24208000
214615                           PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB).24208100
214615     ADD ML017-PC-DIFFER-AMT     TO                               24208200
214615                           PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB).24208300
214615                                                                  24208400
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             24208500
ZX         MOVE PC-OWN-RETRN-ADJ            TO WS-DISC-TYPE.            24208600
ZX         MOVE 'MD'                        TO WS-MDWN-TYPE.            24208700
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       24208800
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       24208900
ZX    *    DISPLAY 'BEFORE ORIG-SAL-TYP-CDE CHECK'                      24209100
226892     COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                    24209200
226892                     +  EPITM-CUST-CHRGD-AMT) * -1.               24209300
226892     IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                      24209400
226892     OR  EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G)                  24209500
226892     AND PV-DIFF NOT = 0                                          24209600
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      24209700
214615        PERFORM 3850-PROMO-MARKDOWN2                              24209800
214615     END-IF.                                                      24209900
214615                                                                  24210000
241900                                                                  24210100
242000******************************************************************24210200
242100 3200-SELECT-GROUP-PRICING.                                       24211000
242200*     CHECK IF ITEM IS GROUP PRICED.                              24220000
242300******************************************************************24230000
242400                                                                  24240000
242500     EXEC SQL                                                     24250000
242600        SELECT  GP_QTY                                            24260000
242700               ,GP_AMT                                            24270000
242800          INTO :EPIGP-GP-QTY                                      24280000
242900              ,:EPIGP-GP-AMT                                      24290000
243000          FROM  TEPIGP                                            24300000
243100         WHERE  PARTN_NBR        = :PV-PARTN-NBR                  24310000
243200           AND  STR_NBR          = :PV-STR-NBR                    24320000
243300           AND  RGST_ID          = :PV-RGST-ID                    24330000
243400           AND  TRN_NBR          = :PV-TRN-NBR                    24340000
243500           AND  STRT_TM          = :PV-STRT-TM                    24350000
243600           AND  SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           24360000
243700           AND  LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            24370000
243800                WITH UR                                           24380000
243900     END-EXEC.                                                    24390000
244000                                                                  24400000
244100     EVALUATE TRUE                                                24410000
244200        WHEN SQLCODE = ZERO                                       24420000
244300        WHEN SQLCODE = PC-ROW-NOT-FOUND                           24430000
244400           CONTINUE                                               24440000
244500        WHEN OTHER                                                24450000
244600           MOVE '3200-SELECT-GROUP-PRICING'                       24460000
244700                                        TO PV-PARAGRAPH-NAME      24470000
244800           SET AC-DB2-ERROR           TO TRUE                     24480000
244900           PERFORM 9999-ABEND                                     24490000
245000     END-EVALUATE.                                                24500000
245100                                                                  24510000
245200******************************************************************24520000
245300 3300-CALC-EXTENDED-AMT.                                          24530000
245400*     CALCULATE THE EXTENDED AMOUNT.                              24540000
245500******************************************************************24550000
245600                                                                  24560000
245700     EVALUATE TRUE                                                24570000
245800        WHEN EPITM-PRIC-SRC-CDE        = 'I'                      24580000
245900           COMPUTE PV-EXTENDED-AMT     = EPITM-OWND-UNT-RTL-AMT   24590000
246000                                       * EPITM-SLD-QTY            24600000
246100                                                                  24610000
246200        WHEN EPITM-REG-RTL-AMT         < ZERO                     24620000
246300*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    24630000
246400*****   NET RING OFFLINE SALE ITEMS, THIS IF STATEMENT IS REMOVED.24640000
246500*          IF EPITM-REG-RTL-ORGN-CDE = 'C'                        24650000
246600*             COMPUTE PV-EXTENDED-AMT                             24660000
246700*                   = EPITM-CUST-CHRGD-AMT * (-1)                 24670000
246800*          ELSE                                                   24680000
246900              COMPUTE PV-EXTENDED-AMT = EPITM-REG-RTL-AMT * (-1)  24690000
247000*          END-IF                                                 24700000
247100                                                                  24710000
247200        WHEN EPITM-REG-RTL-AMT         > ZERO                     24720000
247300*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    24730000
247400*****   DUMMY SKU, NEED TO REMOVE THIS IF STATEMENT.              24740000
247500*          IF PV-SKU-LST-3-DGT     EQUAL ZERO                     24750000
247600*             MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT        24760000
247700*          ELSE                                                   24770000
247800*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    24780000
247900*****   NET RING OFFLINE SALE ITEMS, THIS IF STATEMENT IS REMOVED.24790000
248000*             IF EPITM-REG-RTL-ORGN-CDE = 'C'                     24800000
248100*                MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT     24810000
248200*             ELSE                                                24820000
248300*****   RED-TICKET ITEMS; NO MARKDOWN. GOLDSTAR SHOULD NOT GO     24830000
248400*****   THROUGH THIS LOGIC BUT CODED FOR JUST IN CASE.            24840000
248500                 IF EPITM-REG-RTL-ORGN-CDE = 'P' AND              24850000
248600                    EPITM-PRIC-SRC-CDE = 'K' AND                  24860000
248700                    EPITM-SAL-TYP-CDE EQUAL ('C' OR 'G')          24861000
ZX    *                   EPITM-SAL-TYP-CDE EQUAL ('C' OR 'G') AND      24870000
ZX    *                   EPTRN-POS-CPBL-LVL-NBR NOT = PC-POC           24871000
248800                    MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT  24880000
248900                 ELSE                                             24890000
249000                    MOVE EPITM-REG-RTL-AMT TO PV-EXTENDED-AMT     24900000
249100                 END-IF                                           24910000
249200*             END-IF                                              24920000
249300*          END-IF                                                 24930000
249400        WHEN OTHER                                                24940000
249500           IF EPITM-CUST-CHRGD-AMT     < ZERO                     24950000
249600              COMPUTE PV-EXTENDED-AMT  = EPITM-CUST-CHRGD-AMT     24960000
249700                                       * (-1)                     24970000
249800           ELSE                                                   24980000
249900              MOVE EPITM-CUST-CHRGD-AMT                           24990000
250000                                      TO PV-EXTENDED-AMT          25000000
250100           END-IF                                                 25010000
250200     END-EVALUATE.                                                25020000
250300                                                                  25030000
250400******************************************************************25040000
250500 3400-MARKUP-CANCEL.                                              25050000
250600*     PROCESS BACK OFFICE MARKUP CANCEL FOR QUALIFY SALE ITEMS.   25060000
250700*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '-'.              25070000
011618*     SAL_RET_CDE = 'R' AND POC RETURN                            25070100
250800******************************************************************25080000
250900                                                                  25090000
251000     SET ML017-MKUP                                               25100000
251100         ML017-MARKUP-CANCEL                                      25110000
251200         ML017-RC-MISCELLANEOUS                                   25120000
251300         ML017-BN-OWN-ADJ                                         25130000
251400         ML017-REGISTER-MKDN-MKON     TO TRUE.                    25140000
251500                                                                  25150000
251600     MOVE PC-OWN-ADJ-796           TO ML017-PC-MKDN-MKUP-RSN-CDE. 25160000
251700                                                                  25170000
251800     PERFORM 6300-SELECT-TIERED.                                  25180000
251900                                                                  25190000
252000     IF PS-TIERED-ITEM-NO                                         25200000
MUCFIX*       COMPUTE ML017-PC-OLD-PR-AMT = PV-CUST-CHRGD-AMT           25210025
MUCFIX*                                   + PV-CUST-CHRGD-AMT           25220025
MUCFIX*                                   - PV-EXTENDED-AMT             25230025
MUCFIX        MOVE PV-EXTENDED-AMT       TO ML017-PC-OLD-PR-AMT         25231025
252400     ELSE                                                         25240000
252500        COMPUTE ML017-PC-OLD-PR-AMT = EPITM-CUST-CHRGD-AMT        25250000
252600                                    + EPLID-LID-AMT               25260000
252700     END-IF.                                                      25270000
252800                                                                  25280000
252900     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     25290000
253000                                                                  25300000
253100     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            25310000
253200                                 - ML017-PC-NEW-PR-AMT.           25320000
253300                                                                  25330000
253400     ADD +1                           TO PT-OWNERSHIP-ADJ-MUC-QTY 25340000
253500                                         (PV-TOT-SUB).            25350000
253600     ADD ML017-PC-DIFFER-AMT          TO PT-OWNERSHIP-ADJ-MUC-AMT 25360000
253700                                         (PV-TOT-SUB).            25370000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             25371000
ZX         MOVE PC-OWNERSHIP-ADJ            TO WS-DISC-TYPE.            25372000
ZX         MOVE 'MUC'                       TO WS-MDWN-TYPE.            25373000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       25373100
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       25373200
ZXC   *    PERFORM 8194-BUILD-CRITE-TRANS-RECORD.                       25373300
ZXC   *    PERFORM 8194-WRITE-CRITE-TRANS-RECORD.                       25373400
253800                                                                  25380000
253900******************************************************************25390000
254000 3500-PROMO-MARKDOWN-CANCEL.                                      25400000
254100*     PROCESS BACK OFFICE PROMO MARKDOWN CANCEL FOR QUALIFY RETURN25401000
062118*     ITEMS. SAL_RET_CDE = 'R' OR 'A' AND POC RETURN              25402000
254100*     PROCESS BACK OFFICE PROMO MARKDOWN CANCEL FOR QUALIFY SALE  25410000
254200*     ITEMS. SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '-'.       25420000
254300******************************************************************25430000
254400                                                                  25440000
254500     SET ML017-MKDOWN                                             25450000
254600         ML017-MARKDOWN-CANCEL                                    25460000
254700         ML017-RC-PROMOTIONAL                                     25470000
254800         ML017-BN-PROMOTIONAL                                     25480000
254900         ML017-PLU-MKDN-MKON          TO TRUE.                    25490000
255000                                                                  25500000
255100     MOVE PC-746-PLU-TIER             TO                          25510000
255200          ML017-PC-MKDN-MKUP-RSN-CDE.                             25520000
255300     MOVE ZERO                        TO ML017-PC-OLD-PR-AMT.     25530000
255400     COMPUTE ML017-PC-NEW-PR-AMT = PV-EXTENDED-AMT                25540000
255500                                 + EPITM-CUST-CHRGD-AMT           25550000
255600                                                                  25560000
255700     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            25570000
255800                                 - ML017-PC-NEW-PR-AMT.           25580000
255900                                                                  25590000
256000     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   25600000
256100                                         (PV-TOT-SUB).            25610000
256200     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   25620000
256300                                         (PV-TOT-SUB).            25630000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             25631000
ZX         MOVE PC-PROMOTIONAL              TO WS-DISC-TYPE.            25632000
ZX         MOVE 'MDC'                       TO WS-MDWN-TYPE.            25633000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       25634000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       25635000
256400                                                                  25640000
256500******************************************************************25650000
256600 3600-MARKDOWN-CANCEL.                                            25660000
256700*     PROCESS BACK OFFICE MARKDOWN CANCEL FOR QUALIFY SALE ITEMS. 25670000
256800*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '-'.              25680000
011618*     SAL_RET_CDE = 'R' AND POC RETURN                            25680100
256900******************************************************************25690000
257000                                                                  25700000
257100     SET ML017-MKDOWN                                             25710000
257200         ML017-MARKDOWN-CANCEL                                    25720000
257300         ML017-RC-MISCELLANEOUS                                   25730000
257400         ML017-BN-OWN-ADJ                                         25740000
257500         ML017-REGISTER-MKDN-MKON  TO TRUE.                       25750000
257600                                                                  25760000
257700     MOVE PC-OWN-ADJ-796           TO ML017-PC-MKDN-MKUP-RSN-CDE. 25770000
257800     MOVE ZERO                     TO ML017-PC-OLD-PR-AMT.        25780000
257900                                                                  25790000
258000     COMPUTE ML017-PC-NEW-PR-AMT = PV-EXTENDED-AMT                25800000
258100                                 - PV-CUST-CHRGD-AMT.             25810000
258200                                                                  25820000
258300     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            25830000
258400                                 - ML017-PC-NEW-PR-AMT.           25840000
258500                                                                  25850000
258600     ADD +1                        TO PT-OWNERSHIP-ADJ-MDC-QTY    25860000
258700                                      (PV-TOT-SUB).               25870000
258800     ADD ML017-PC-DIFFER-AMT       TO PT-OWNERSHIP-ADJ-MDC-AMT    25880000
258900                                      (PV-TOT-SUB).               25890000
ZX         MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT.                25891000
ZX         MOVE PC-OWNERSHIP-ADJ         TO WS-DISC-TYPE.               25892000
ZX         MOVE 'MDC'                    TO WS-MDWN-TYPE.               25893000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       25894000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       25895000
259000                                                                  25900000
259100******************************************************************25910000
259200 3650-MARKDOWN-CORR-CANCEL.                                       25920000
259300*     PROCESS BACK OFFICE MARKDOWN CANCEL FOR QUALIFY SALE ITEMS. 25930000
259400******************************************************************25940000
259500                                                                  25950000
259600     SET ML017-MKDOWN                                             25960000
259700         ML017-RC-MISCELLANEOUS                                   25970000
259800         ML017-BN-OWN-ADJ                                         25980000
259900         ML017-REGISTER-MKDN-MKON  TO TRUE.                       25990000
260000                                                                  26000000
260100     COMPUTE PV-PRICE-CHANGE-AMOUNT = (EPITM-CUST-CHRGD-AMT       26010000
260200                                    +  EPITM-REG-RTL-AMT          26020000
260300                                    *  EPITM-SLD-QTY)             26030000
260400                                    *  -1.                        26040000
260500                                                                  26050000
260600     EVALUATE TRUE                                                26060000
260700        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        26070000
260800           MOVE PC-OWN-ADJ-796        TO                          26080000
260900                ML017-PC-MKDN-MKUP-RSN-CDE                        26090000
261000           SET ML017-MARKDOWN-CANCEL  TO TRUE                     26100000
261100           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      26110000
261200           MOVE PV-PRICE-CHANGE-AMOUNT                            26120000
261300                                      TO ML017-PC-NEW-PR-AMT      26130000
261400                                         ML017-PC-DIFFER-AMT      26140000
261500           ADD +1                     TO                          26150000
261600               PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)              26160000
261700           ADD ML017-PC-DIFFER-AMT    TO PT-OWNERSHIP-ADJ-MDC-AMT 26170000
261800                                         (PV-TOT-SUB)             26180000
ZX               MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT           26181000
ZX               MOVE PC-OWNERSHIP-ADJ         TO WS-DISC-TYPE          26182000
ZX               MOVE 'MDC'                    TO WS-MDWN-TYPE          26183000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  26184000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  26185000
261900        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        26190000
262000           SET ML017-MARKDOWN         TO TRUE                     26200000
262100           MOVE EPITM-OWND-UNT-RTL-AMT                            26210000
262200                                      TO ML017-PC-NEW-PR-AMT      26220000
262300           MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-OLD-PR-AMT       26230000
262400                                                                  26240000
262500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      26250000
262600                                       - ML017-PC-NEW-PR-AMT      26260000
262700           MOVE PC-OWN-RTN-ADJ-792    TO                          26270000
262800                ML017-PC-MKDN-MKUP-RSN-CDE                        26280000
262900           SET ML017-BN-OWN-RTN-ADJ TO TRUE                       26290000
263000           ADD +1                  TO                             26300000
263100               PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)             26310000
263200           ADD ML017-PC-DIFFER-AMT TO                             26320000
263300                  PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)          26330000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                26331000
ZX               MOVE PC-OWN-RETRN-ADJ   TO WS-DISC-TYPE                26332000
ZX               MOVE 'MD'               TO WS-MDWN-TYPE                26333000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  26334000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  26335000
263400        WHEN OTHER                                                26340000
263500           MOVE ZERO TO ML017-PC-DIFFER-AMT                       26350000
263600     END-EVALUATE.                                                26360000
263700                                                                  26370000
263800     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        26380000
263900                                                                  26390000
264000******************************************************************26400000
264100 3700-SALE-MARKUP.                                                26410000
264200*     PROCESS BACK OFFICE MARKUP FOR QUALIFY SALE ITEMS.          26420000
264300*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '+'.              26430000
011618*     SAL_RET_CDE = 'R' AND POC RETURN.                           26431000
264400******************************************************************26440000
264500                                                                  26450000
264600     SET ML017-MKUP                                               26460000
264700         ML017-MARKUP                                             26470000
264800         ML017-RC-MISCELLANEOUS                                   26480000
264900         ML017-BN-OWN-ADJ                                         26490000
265000         ML017-REGISTER-MKDN-MKON     TO TRUE.                    26500000
265100                                                                  26510000
265200     MOVE PC-OWN-ADJ-796              TO                          26520000
265300          ML017-PC-MKDN-MKUP-RSN-CDE.                             26530000
265400     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-OLD-PR-AMT.     26540000
265500                                                                  26550000
265600     COMPUTE ML017-PC-NEW-PR-AMT = EPITM-CUST-CHRGD-AMT           26560000
265700                                 + EPITM-CUST-CHRGD-AMT           26570000
265800                                 - PV-EXTENDED-AMT.               26580000
265900                                                                  26590000
266000     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            26600000
266100                                 - ML017-PC-NEW-PR-AMT.           26610000
266200                                                                  26620000
266300     ADD +1                          TO PT-OWNERSHIP-ADJ-MKUP-QTY 26630000
266400                                        (PV-TOT-SUB).             26640000
266500     ADD ML017-PC-DIFFER-AMT         TO                           26650000
266600                                        PT-OWNERSHIP-ADJ-MKUP-AMT 26660000
266700                                        (PV-TOT-SUB).             26670000
ZX         MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT.                26671000
ZX         MOVE PC-OWNERSHIP-ADJ         TO WS-DISC-TYPE.               26672000
ZX         MOVE 'MU'                     TO WS-MDWN-TYPE.               26673000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       26674000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       26675000
266800                                                                  26680000
266900******************************************************************26690000
267000 3800-PROMO-MARKDOWN.                                             26700000
267100*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         26710000
267200******************************************************************26720000
267300                                                                  26730000
267400     SET ML017-MKDOWN                                             26740000
267500         ML017-MARKDOWN                                           26750000
267600         ML017-RC-PROMOTIONAL                                     26760000
267700         ML017-BN-PROMOTIONAL                                     26770000
267800         ML017-PLU-MKDN-MKON          TO TRUE.                    26780000
267900                                                                  26790000
268000     MOVE PC-746-PLU-TIER             TO                          26800000
268100          ML017-PC-MKDN-MKUP-RSN-CDE.                             26810000
268200     MOVE PV-EXTENDED-AMT             TO ML017-PC-OLD-PR-AMT.     26820000
268300     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     26830000
268400                                                                  26840000
268500     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            26850000
268600                                 - ML017-PC-NEW-PR-AMT.           26860000
268700                                                                  26870000
268800     ADD +1                           TO PT-PROMOTIONAL-MKDN-QTY  26880000
268900                                         (PV-TOT-SUB).            26890000
269000     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MKDN-AMT  26900000
269100                                         (PV-TOT-SUB).            26910000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             26911000
ZX         MOVE PC-PROMOTIONAL              TO WS-DISC-TYPE.            26912000
ZX         MOVE 'MD'                        TO WS-MDWN-TYPE.            26913000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       26914000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       26915000
269200                                                                  26920000
214615******************************************************************26921000
214615 3850-PROMO-MARKDOWN2.                                            26922000
214615*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         26923000
ZX?   * SAYS MARKDOWN HERE, BUT APPEARS TO BE ASSIGNING MDC BELOW       26923100
214615******************************************************************26924000
214615                                                                  26926000
214615     SET ML017-MKDOWN                                             26927000
214615         ML017-MARKDOWN-CANCEL                                    26929000
214615         ML017-RC-PROMOTIONAL                                     26929100
214615         ML017-BN-PROMOTIONAL                                     26929200
214615         ML017-PLU-MKDN-MKON          TO TRUE.                    26929300
214615                                                                  26929400
214615     MOVE PC-746-PLU-TIER             TO                          26929500
214615                                      ML017-PC-MKDN-MKUP-RSN-CDE. 26929600
214615     MOVE EPITM-ORIG-REG-RTL-AMT      TO ML017-PC-OLD-PR-AMT.     26929700
214615     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     26929800
214615                                                                  26929900
214615     COMPUTE ML017-PC-DIFFER-AMT = (ML017-PC-OLD-PR-AMT           26930200
214615                                 -  ML017-PC-NEW-PR-AMT) * -1.    26930300
214615                                                                  26930400
226892* ADDED THE FOLLOWING TO FIX ML PRODUCTION ISSUE WITH MDC         26930500
226892* RELATED TO MLKUP021'S MDC TO MD FLIP LOGIC                      26930600
226892     MOVE ZERO                   TO ML017-PC-OLD-PR-AMT.          26930700
226892     MOVE ML017-PC-DIFFER-AMT    TO ML017-PC-NEW-PR-AMT.          26930800
226892                                                                  26930900
214615     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   26931000
214615                                         (PV-TOT-SUB).            26931100
214615     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   26931200
214615                                         (PV-TOT-SUB).            26931300
214615                                                                  26931400
ZX    *    MOVE 'Y'                         TO WS-ISSUE-IND.            26931500
ZX                                                                      26931600
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             26931700
ZX         MOVE PC-PROMOTIONAL              TO WS-DISC-TYPE.            26931800
ZX         MOVE 'MDC'                       TO WS-MDWN-TYPE.            26931900
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       26932000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       26932100
214615                                                                  26932200
214615******************************************************************26932300
214615 3860-PROMO-MARKUP2.                                              26932400
214615*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         26932500
214615******************************************************************26932600
214615                                                                  26932800
214615     SET ML017-MKUP                                               26933000
214615         ML017-RC-PROMOTIONAL                                     26933100
214615         ML017-BN-PROMOTIONAL                                     26933200
214615         ML017-PLU-MKDN-MKON          TO TRUE.                    26933300
214615                                                                  26933400
214615     MOVE PC-746-PLU-TIER             TO                          26933500
214615                                      ML017-PC-MKDN-MKUP-RSN-CDE. 26933600
214615     MOVE EPITM-ORIG-REG-RTL-AMT      TO ML017-PC-OLD-PR-AMT.     26933700
214615     MOVE EPITM-REG-RTL-AMT           TO ML017-PC-NEW-PR-AMT.     26933800
214615                                                                  26933900
214615     COMPUTE ML017-PC-DIFFER-AMT = (ML017-PC-OLD-PR-AMT           26934200
214615                                 -  ML017-PC-NEW-PR-AMT) * -1.    26934300
214615                                                                  26934600
214615     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   26934700
214615                                         (PV-TOT-SUB).            26934800
214615     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   26934900
214615                                         (PV-TOT-SUB).            26935000
214615                                                                  26935100
ZX    * DOESN'T SEEM RIGHT TO ME, MUC INSTEAD OF MU?                    26935200
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             26935300
ZX         MOVE PC-PROMOTIONAL              TO WS-DISC-TYPE.            26935400
ZX         MOVE 'MU'                        TO WS-MDWN-TYPE.            26935500
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       26935600
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       26935700
214615                                                                  26935800
269300******************************************************************26936000
269400 3900-SALE-MARKDOWN.                                              26940000
269500*     PROCESS SALE MARKDOWN ITEMS.                                26950000
269600******************************************************************26960000
269700                                                                  26970000
269800     SET ML017-MKDOWN                                             26980000
269900         ML017-MARKDOWN                                           26990000
270000         ML017-RC-MISCELLANEOUS                                   27000000
270100         ML017-BN-OWN-ADJ                                         27010000
270200         ML017-REGISTER-MKDN-MKON     TO TRUE.                    27020000
270300                                                                  27030000
270400     COMPUTE ML017-PC-OLD-PR-AMT = EPITM-CUST-CHRGD-AMT           27040000
270500                                 + (PV-EXTENDED-AMT               27050000
270600                                 -  EPITM-CUST-CHRGD-AMT).        27060000
270700                                                                  27070000
270800     IF EPITM-CUST-CHRGD-AMT     = ZERO                           27080000
270900        MOVE PC-704-KEYED-GWP      TO                             27090000
271000                                   ML017-PC-MKDN-MKUP-RSN-CDE     27100000
271100     ELSE                                                         27110000
271200        MOVE PC-OWN-ADJ-796        TO                             27120000
271300                                   ML017-PC-MKDN-MKUP-RSN-CDE     27130000
271400     END-IF.                                                      27140000
271500                                                                  27150000
271600     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     27160000
271700                                                                  27170000
271800     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            27180000
271900                                 - ML017-PC-NEW-PR-AMT.           27190000
272000                                                                  27200000
272100     ADD +1                           TO                          27210000
272200         PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB).                  27220000
272300                                                                  27230000
272400     ADD ML017-PC-DIFFER-AMT          TO                          27240000
272500         PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB).                  27250000
ZX         MOVE ML017-PC-DIFFER-AMT         TO WS-DISC-AMT.             27251000
ZX         MOVE PC-OWNERSHIP-ADJ            TO WS-DISC-TYPE.            27252000
ZX         MOVE 'MD'                        TO WS-MDWN-TYPE.            27253000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       27254000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       27255000
272600                                                                  27260000
272700******************************************************************27270000
272800 3950-SALE-CORRECTION-MARKDOWN.                                   27280000
272900*     PROCESS SALE CORRECTION MARKDOWN ITEMS.                     27290000
273000******************************************************************27300000
273100                                                                  27310000
273200     SET ML017-MKDOWN                                             27320000
273300         ML017-MARKDOWN                                           27330000
273400         ML017-RC-MISCELLANEOUS                                   27340000
273500         ML017-BN-OWN-ADJ                                         27350000
273600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    27360000
273700                                                                  27370000
273800     IF EPITM-CUST-CHRGD-AMT = ZERO                               27380000
273900        MOVE PC-704-KEYED-GWP TO ML017-PC-MKDN-MKUP-RSN-CDE       27390000
274000     ELSE                                                         27400000
274100        MOVE PC-OWN-ADJ-796   TO ML017-PC-MKDN-MKUP-RSN-CDE       27410000
274200     END-IF.                                                      27420000
274300                                                                  27430000
274400     MOVE EPITM-REG-RTL-AMT    TO ML017-PC-OLD-PR-AMT.            27440000
274500     MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-NEW-PR-AMT.            27450000
274600                                                                  27460000
274700     IF  ML017-PC-NEW-PR-AMT < ZERO                               27470000
274800         COMPUTE ML017-PC-NEW-PR-AMT =                            27480000
274900                 ML017-PC-NEW-PR-AMT * (-1)                       27490000
275000     END-IF.                                                      27500000
275100                                                                  27510000
275200     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            27520000
275300                                 - ML017-PC-NEW-PR-AMT.           27530000
275400                                                                  27540000
275500     ADD +1                    TO                                 27550000
275600         PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB).                  27560000
275700                                                                  27570000
275800     ADD ML017-PC-DIFFER-AMT   TO                                 27580000
275900         PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB).                  27590000
ZX         MOVE ML017-PC-DIFFER-AMT  TO WS-DISC-AMT.                    27591000
ZX         MOVE PC-OWNERSHIP-ADJ     TO WS-DISC-TYPE.                   27592000
ZX         MOVE 'MD'                 TO WS-MDWN-TYPE.                   27593000
ZX         PERFORM 8195-BUILD-DAY02-TRANS-RECORD.                       27594000
ZX         PERFORM 8195-WRITE-DAY02-TRANS-RECORD.                       27595000
276000                                                                  27600000
276100                                                                  27610000
276200     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        27620000
276300                                                                  27630000
276400                                                                  27640000
276500******************************************************************27650000
276600 4000-PROCESS-MARKDOWN-MARKUP.                                    27660000
276700*     DETERMINE IF A RECORD SHOULD BE WRITTEN.                    27670000
276800******************************************************************27680000
276900                                                                  27690000
277000     MOVE +1 TO ML017-PC-QTY.                                     27700000
277100                                                                  27710000
277200     EVALUATE TRUE                                                27720000
277300        WHEN ML017-PC-DIFFER-AMT       = ZERO                     27730000
277400           CONTINUE                                               27740000
277500                                                                  27750000
277600        WHEN ML017-MKDOWN                                         27760000
277700           IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    27770000
277800                                         PV-CUT-OFF-CCYY-MM-DD    27780000
277900              PERFORM 8025-WRITE-HOLD-LEDGR-MKDN-REC              27790000
278000              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  27800000
278200              PERFORM 8180-FORMAT-MW-RECORD                       27820000
278300              PERFORM 8190-WRITE-DATAWHSE-RECORD                  27830000
278400           ELSE                                                   27840000
278500              PERFORM 8000-WRITE-LEDGER-MKDN-RECORD               27850000
278600              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  27860000
278800              PERFORM 8180-FORMAT-MW-RECORD                       27880000
278900              PERFORM 8190-WRITE-DATAWHSE-RECORD                  27890000
279000           END-IF                                                 27900000
279100                                                                  27910000
279200        WHEN OTHER                                                27920000
279300           IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    27930000
279400                                           PV-CUT-OFF-CCYY-MM-DD  27940000
279500              PERFORM 8125-WRITE-HOLD-LEDGR-MKUP-REC              27950000
279600              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  27960000
279800              PERFORM 8180-FORMAT-MW-RECORD                       27980000
279900              PERFORM 8190-WRITE-DATAWHSE-RECORD                  27990000
280000           ELSE                                                   28000000
280100              PERFORM 8100-WRITE-LEDGER-MKUP-RECORD               28010000
280200              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  28020000
280400              PERFORM 8180-FORMAT-MW-RECORD                       28040000
280500              PERFORM 8190-WRITE-DATAWHSE-RECORD                  28050000
280600           END-IF                                                 28060000
280700                                                                  28070000
280800     END-EVALUATE.                                                28080000
280900                                                                  28090000
281000                                                                  28100000
281100******************************************************************28110000
281200 4100-OPEN-LID-CURSOR.                                            28120000
281300*     OPEN TEPLID CURSOR TO PROCESS LINE ITEM DISCOUNTS.          28130000
281400******************************************************************28140000
281500                                                                  28150000
281600     MOVE ZERO TO PV-LID-SEQ-NBR.                                 28160000
281700                                                                  28170000
281800     EXEC SQL                                                     28180000
281900          OPEN TEPLID-CURSOR                                      28190000
282000     END-EXEC.                                                    28200000
282100                                                                  28210000
282200     EVALUATE TRUE                                                28220000
282300        WHEN SQLCODE = ZERO                                       28230000
282400           MOVE EPITM-CUST-CHRGD-AMT TO PV-EXCLUDE-LID-AMT        28240000
282500           SET PS-END-OF-LID-NO       TO TRUE                     28250000
282600        WHEN OTHER                                                28260000
282700           MOVE '4100-OPEN-LID-CURSOR'                            28270000
282800                                      TO PV-PARAGRAPH-NAME        28280000
282900           SET AC-DB2-ERROR           TO TRUE                     28290000
283000           PERFORM 9999-ABEND                                     28300000
283100     END-EVALUATE.                                                28310000
283200                                                                  28320000
283300******************************************************************28330000
283400 4200-FETCH-LID-CURSOR.                                           28340000
283500*     FETCH AND PROCESS LINE ITEM DISCOUNT INFORMATION.           28350000
283600******************************************************************28360000
283700                                                                  28370000
ZX                   DISPLAY ' PARTN   ' EPTRN-PARTN-NBR                28375000
ZX                           ' STORE   ' EPTRN-STR-NBR                  28376000
ZX                           ' RGST    ' EPTRN-RGST-ID                  28377000
ZX                           ' TRAN    ' EPTRN-TRN-NBR                  28378000
ZX                           ' ITEM #  ' EPITM-LNE-ITM-SEQ-NBR          28379000
ZX                           ' SKU  #  ' EPITM-SKU-NBR.                 28379100
283800     EXEC SQL                                                     28380000
283900          FETCH TEPLID-CURSOR                                     28390000
ZX              INTO  :EPLID-LID-SEQ-NBR                                28391000
ZX                   ,:EPLID-LID-AMT                                    28392000
ZX                   ,:EPLID-LID-RSN-CDE                                28393000
284200     END-EXEC.                                                    28420000
284300                                                                  28430000
284400     EVALUATE TRUE                                                28440000
284500         WHEN SQLCODE = ZERO                                      28450000
284600            ADD +1 TO PV-LID-SEQ-NBR                              28461000
284700                                                                  28470000
284800             PERFORM 4400-PROCESS-LID                             28480000
284900             PERFORM 4000-PROCESS-MARKDOWN-MARKUP                 28490000
285000         WHEN SQLCODE = PC-ROW-NOT-FOUND                          28500000
285100             SET PS-END-OF-LID-YES    TO TRUE                     28510000
285200         WHEN OTHER                                               28520000
285300             MOVE '4200-FETCH-LID-CURSOR'                         28530000
285400                                      TO PV-PARAGRAPH-NAME        28540000
285500             SET AC-DB2-ERROR           TO TRUE                   28550000
285600             PERFORM 9999-ABEND                                   28560000
285700     END-EVALUATE.                                                28570000
285800                                                                  28580000
285900******************************************************************28590000
286000 4300-CLOSE-LID-CURSOR.                                           28600000
286100******************************************************************28610000
286200                                                                  28620000
286300     EXEC SQL                                                     28630000
286400          CLOSE TEPLID-CURSOR                                     28640000
286500     END-EXEC.                                                    28650000
286600                                                                  28660000
286700     EVALUATE TRUE                                                28670000
286800        WHEN SQLCODE = ZERO                                       28680000
286900           CONTINUE                                               28690000
287000        WHEN OTHER                                                28700000
287100           MOVE '4300-CLOSE-LID-CURSOR'                           28710000
287200                                            TO PV-PARAGRAPH-NAME  28720000
287300           SET AC-DB2-ERROR           TO TRUE                     28730000
287400           PERFORM 9999-ABEND                                     28740000
287500     END-EVALUATE.                                                28750000
287600                                                                  28760000
287700******************************************************************28770000
287800 4400-PROCESS-LID.                                                28780000
287900*     PROCESS LINE ITEM DISCOUNTS. PV-EXCLUDE-LID-AMT HOLDS       28790000
288000*     AMOUNT OF EPITM-CUST-CHRGD-AMT - SUM OF PREVIOUS            28800000
288100*     EPLID-LID-AMT FOR THE ITEM.                                 28810000
288200******************************************************************28820000
288300                                                                  28830000
288400     MOVE EPLID-LID-RSN-CDE        TO ML017-PC-MKDN-MKUP-RSN-CDE. 28840000
288500     MOVE PV-EXCLUDE-LID-AMT       TO PV-CUST-CHRGD-AMT.          28850000
288600     MOVE EPITM-NET-CHRGD-AMT      TO PV-NET-CHRGD-AMT.           28860000
288700     COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1).       28870000
ZX         SET PV-DISC-TYPE-LID   TO TRUE.                              28871000
288800                                                                  28880000
288900     PERFORM 4450-DETERMINE-LID-TYPE                              28890000
289000                                                                  28900000
289100     IF EPITM-LIV-RSLU-CDE      = '-'                             28910000
289200        COMPUTE PV-EXCLUDE-LID-AMT = PV-EXCLUDE-LID-AMT           28920000
289300                                   - EPLID-LID-AMT                28930000
289400     ELSE                                                         28940000
289500        COMPUTE PV-EXCLUDE-LID-AMT = PV-EXCLUDE-LID-AMT           28950000
289600                                   + EPLID-LID-AMT                28960000
289700     END-IF.                                                      28970000
289800                                                                  28980000
289900******************************************************************28990000
290000 4450-DETERMINE-LID-TYPE.                                         29000000
290100*    DETERMINE WHAT TYPE IS BEING WORKED WITH TO DETERMINED MARKDO29010000
290200******************************************************************29020000
290300                                                                  29030000
290400     EVALUATE EPLID-LID-RSN-CDE                                   29040000
205464        WHEN PC-710-NON-RCPT-RTRN                                 29041000
205464           MOVE PC-710-NON-RCPT-RTRN  TO                          29042000
205464                ML017-PC-MKDN-MKUP-RSN-CDE                        29043000
205464           PERFORM 4841-PROCESS-NON-RCPT-RTRN                     29044000
290500        WHEN PC-746-PLU-TIER                                      29050000
290600        WHEN PC-ADDTL-PROMO-OFF-774                               29060000
290700           PERFORM 4500-PROCESS-TIERED-LID                        29070000
290800        WHEN PC-GOLDSTAR-753                                      29080000
290900           PERFORM 4600-PROCESS-GOLDSTAR-LID                      29090000
262807        WHEN PC-SEPHORA-720                                       29091031
262807           PERFORM 4650-PROCESS-SEPHORA-LID                       29092031
291000        WHEN PC-SENIOR-CIT-728                                    29100000
291100           PERFORM 4700-SENIOR-CITIZEN-LID                        29110000
291200        WHEN PC-KOHLS-CPON-733                                    29120000
291300           PERFORM 4800-PROCESS-TLCD-LID                          29130000
291400        WHEN PC-760-OFFER-COUPON                                  29140000
291500           PERFORM 4810-PROCESS-OFFER-COUPON                      29150000
291600        WHEN PC-761-OFFER-TLD-TIERED                              29160000
291700           PERFORM 4820-PROCESS-OFFER-TLD-TIERED                  29170000
291800        WHEN PC-762-OFFER-LID-TIERED                              29180000
291900           PERFORM 4830-PROCESS-OFFER-LID-TIERED                  29190000
292000        WHEN PC-763-OFFER-GWP-PWP-PRORATED                        29200000
292100           PERFORM 4840-PROCESS-OFFER-GWP-PWP                     29210000
292200        WHEN PC-765-GFT-RCPT-RTRN                                 29220000
292300           MOVE PC-765-GFT-RCPT-RTRN  TO                          29230000
292400                ML017-PC-MKDN-MKUP-RSN-CDE                        29240000
292500           PERFORM 4842-PROCESS-GFT-RCPT-RTRN                     29250000
292600        WHEN PC-BOGO-775                                          29260000
292700*****  REMOVE THIS CODE 3 MONTHS AFTER BOGO III GOES IN. *BEGIN*  29270000
292800        WHEN PC-BOGO-777                                          29280000
292900           MOVE PC-BOGO-775           TO                          29290000
293000                ML017-PC-MKDN-MKUP-RSN-CDE                        29300000
293100*****  REMOVE THIS CODE 3 MONTHS AFTER BOGO III GOES IN. *END*    29310000
293200           PERFORM 4850-PROCESS-BOGO-LID                          29320000
293300        WHEN PC-UNEARNED-REWARDS-780                              29330000
293400           MOVE PC-UNEARNED-REWARDS-780    TO                     29340000
293500                ML017-PC-MKDN-MKUP-RSN-CDE                        29350000
293600           PERFORM 4860-PROCESS-UNEARNED-RWDS-LID                 29360000
293700        WHEN OTHER                                                29370000
293800           PERFORM 4900-PROCESS-NORMAL-LID                        29380000
293900     END-EVALUATE.                                                29390000
294000                                                                  29400000
294100******************************************************************29410000
294200 4500-PROCESS-TIERED-LID.                                         29420000
294300*     PROCESS TIERRED ITEMS.                                      29430000
294400******************************************************************29440000
294500                                                                  29450000
294600     SET ML017-MKDOWN                                             29460000
294700         ML017-RC-PROMOTIONAL                                     29470000
294800         ML017-BN-PROMOTIONAL                                     29480000
294900         ML017-PLU-MKDN-MKON          TO TRUE.                    29490000
295000                                                                  29500000
295100     IF EPITM-LIV-RSLU-CDE          = '+' AND                     29510000
062118        EPLID-LID-AMT               > 0 AND                       29511000
062118        (EPITM-SAL-RET-CDE           = 'R' OR                     29520000
062118         EPITM-SAL-RET-CDE           = 'B')                       29530000
040220        MOVE 0                     TO ML017-PC-OLD-PR-AMT         29530100
040220        MOVE EPLID-LID-AMT         TO ML017-PC-NEW-PR-AMT         29530200
040220* MAKE THIS NEGATIVE FOR THE SPREADSHEET AND REPORT DUE TO        29530300
040220* MLKUP021 FLIPPING FROM MDC TO MD WHENVER OLD > NEW              29530400
040220        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1)     29530500
295700     ELSE                                                         29570000
295800        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1)     29580000
295900        COMPUTE ML017-PC-OLD-PR-AMT = PV-EXCLUDE-LID-AMT          29590000
296000                                    - EPLID-LID-AMT               29600000
296100                                                                  29610000
296200        MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-NEW-PR-AMT         29620000
296300     END-IF.                                                      29630000
296400                                                                  29640000
296500     IF PV-PRICE-CHANGE-AMOUNT   < ZERO                           29650000
296600        SET ML017-MARKDOWN-CANCEL      TO TRUE                    29660000
296700     ELSE                                                         29670000
296800        SET ML017-MARKDOWN       TO TRUE                          29680000
296900     END-IF.                                                      29690000
297000                                                                  29700000
297100     MOVE PV-PRICE-CHANGE-AMOUNT      TO ML017-PC-DIFFER-AMT.     29710000
297200                                                                  29720000
297300     IF ML017-MARKDOWN                                            29730000
297400        ADD +1                        TO PT-TIERED-MKDN-QTY       29740000
297500                                         (PV-TOT-SUB)             29750000
297600        ADD ML017-PC-DIFFER-AMT       TO PT-TIERED-MKDN-AMT       29760000
297700                                         (PV-TOT-SUB)             29770000
ZX            MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT              29771000
ZX            MOVE PC-TIERED                TO WS-DISC-TYPE             29772000
ZX            MOVE 'MD'                     TO WS-MDWN-TYPE             29773000
ZX            PERFORM 8195-BUILD-DAY02-TRANS-RECORD                     29774000
ZX            PERFORM 8195-WRITE-DAY02-TRANS-RECORD                     29775000
297800     ELSE                                                         29780000
297900        ADD +1                        TO PT-TIERED-MDC-QTY        29790000
298000                                         (PV-TOT-SUB)             29800000
298100        ADD ML017-PC-DIFFER-AMT       TO PT-TIERED-MDC-AMT        29810000
298200                                         (PV-TOT-SUB)             29820000
ZX            MOVE ML017-PC-DIFFER-AMT      TO WS-DISC-AMT              29821000
ZX            MOVE PC-TIERED                TO WS-DISC-TYPE             29822000
ZX            MOVE 'MDC'                    TO WS-MDWN-TYPE             29823000
ZX            PERFORM 8195-BUILD-DAY02-TRANS-RECORD                     29824000
ZX            PERFORM 8195-WRITE-DAY02-TRANS-RECORD                     29825000
298300     END-IF.                                                      29830000
298400                                                                  29840000
298500******************************************************************29850000
298600 4600-PROCESS-GOLDSTAR-LID.                                       29860000
298700*     PROCESS GOLDSTAR ITEMS.                                     29870000
298800******************************************************************29880000
298900                                                                  29890000
299000     SET ML017-MKDOWN                                             29900000
299100         ML017-RC-MISCELLANEOUS                                   29910000
299200         ML017-BN-GOLDSTAR            TO TRUE.                    29920000
299300                                                                  29930000
299400     SET ML017-REGISTER-MKDN-MKON     TO TRUE.                    29940000
299500                                                                  29950000
299600     EVALUATE TRUE                                                29960000
299700        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        29970000
299800           SET ML017-MARKDOWN         TO TRUE                     29980000
299900           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      29990000
300000                                                                  30000000
300100           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       30010000
300200                                       + EPLID-LID-AMT            30020000
300300                                                                  30030000
300400           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      30040000
300500                                       - ML017-PC-NEW-PR-AMT      30050000
300600                                                                  30060000
300700           ADD +1                     TO PT-GOLDSTAR-MKDN-QTY     30070000
300800                                         (PV-TOT-SUB)             30080000
300900           ADD ML017-PC-DIFFER-AMT                                30090000
301000                                      TO PT-GOLDSTAR-MKDN-AMT     30100000
301100                                         (PV-TOT-SUB)             30110000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              30111000
ZX               MOVE PC-GOLDSTAR           TO WS-DISC-TYPE             30112000
ZX               MOVE 'MD'                  TO WS-MDWN-TYPE             30113000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  30114000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  30115000
301200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        30120000
301300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     30130000
301400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      30140000
301500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   30150000
301600                                       * (-1)                     30160000
301700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      30170000
301800                                       - ML017-PC-NEW-PR-AMT      30180000
301900           ADD +1                     TO PT-GOLDSTAR-MDC-QTY      30190000
302000                                         (PV-TOT-SUB)             30200000
302100           ADD ML017-PC-DIFFER-AMT    TO PT-GOLDSTAR-MDC-AMT      30210000
302200                                         (PV-TOT-SUB)             30220000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              30221000
ZX               MOVE PC-GOLDSTAR           TO WS-DISC-TYPE             30222000
ZX               MOVE 'MDC'                 TO WS-MDWN-TYPE             30223000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  30224000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  30225000
302300        WHEN OTHER                                                30230000
302400           MOVE ZERO                  TO ML017-PC-DIFFER-AMT      30240000
302500     END-EVALUATE.                                                30250000
302600                                                                  30260000
262807******************************************************************30261031
262807 4650-PROCESS-SEPHORA-LID.                                        30262031
262807*     PROCESS SEPHORA DISCOUNTS                                   30263031
262807*     (COPIED PARA 4810-PROCESS-OFFER-COUPON FOR 760 LIDS)        30264031
262807******************************************************************30265031
262807                                                                  30266031
262807     SET ML017-MKDOWN                                             30267031
262807         ML017-RC-MISCELLANEOUS                                   30268031
262807         ML017-BN-SEPHORA-DISCOUNT                                30269031
262807         ML017-REGISTER-MKDN-MKON     TO TRUE.                    30269131
262807                                                                  30269231
262807     EVALUATE TRUE                                                30269331
262807        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     30269431
262807           SET ML017-MARKDOWN         TO TRUE                     30269531
262807           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      30269631
262807           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       30269731
262807                                       + EPLID-LID-AMT            30269831
262807                                                                  30269931
262807           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      30270031
262807                                       - ML017-PC-NEW-PR-AMT      30270131
262807                                                                  30270231
262807           ADD +1 TO PT-720-SEPHORA-MKDN-QTY                      30270331
262807                                                (PV-TOT-SUB)      30270431
262807           ADD ML017-PC-DIFFER-AMT TO                             30270531
262807                               PT-720-SEPHORA-MKDN-AMT            30270631
262807                                                 (PV-TOT-SUB)     30270731
262807        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        30270831
262807           SET ML017-MARKDOWN-CANCEL  TO TRUE                     30270931
262807           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      30271031
262807           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   30271131
262807                                       * (-1)                     30271231
262807           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      30271331
262807                                       - ML017-PC-NEW-PR-AMT      30271431
262807           ADD +1 TO PT-720-SEPHORA-MDC-QTY                       30271531
262807                                                 (PV-TOT-SUB)     30271631
262807           ADD ML017-PC-DIFFER-AMT TO                             30271731
262807                             PT-720-SEPHORA-MDC-AMT               30271831
262807                                                 (PV-TOT-SUB)     30271931
262807        WHEN OTHER                                                30272031
262807           MOVE ZERO TO ML017-PC-DIFFER-AMT                       30272131
262807     END-EVALUATE.                                                30272231
262807                                                                  30272331
262807                                                                  30272431
302700******************************************************************30273000
302800 4700-SENIOR-CITIZEN-LID.                                         30280000
302900*     PROCESS SENIOR CITIZEN DISCOUNT.                            30290000
303000******************************************************************30300000
303100                                                                  30310000
303200     SET ML017-MKDOWN                                             30320000
303300         ML017-RC-MISCELLANEOUS                                   30330000
303400         ML017-BN-SENIOR-CITZ-DISC                                30340000
303500         ML017-REGISTER-MKDN-MKON     TO TRUE.                    30350000
303600                                                                  30360000
303700     EVALUATE TRUE                                                30370000
303800        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     30380000
303900           SET ML017-MARKDOWN         TO TRUE                     30390000
304000           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      30400000
304100                                                                  30410000
304200           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       30420000
304300                                       + EPLID-LID-AMT            30430000
304400                                                                  30440000
304500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      30450000
304600                                       - ML017-PC-NEW-PR-AMT      30460000
304700                                                                  30470000
304800           ADD +1                     TO                          30480000
304900               PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)            30490000
305000           ADD ML017-PC-DIFFER-AMT    TO                          30500000
305100               PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)            30510000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              30511000
ZX               MOVE PC-SENIOR-CITIZEN     TO WS-DISC-TYPE             30512000
ZX               MOVE 'MD'                  TO WS-MDWN-TYPE             30513000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  30514000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  30515000
305200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        30520000
305300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     30530000
305400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      30540000
305500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   30550000
305600                                       * (-1)                     30560000
305700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      30570000
305800                                       - ML017-PC-NEW-PR-AMT      30580000
305900           ADD +1 TO PT-SENIOR-CITIZEN-MDC-QTY                    30590000
306000                                                 (PV-TOT-SUB)     30600000
306100           ADD ML017-PC-DIFFER-AMT TO                             30610000
306200               PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)             30620000
ZX               MOVE ML017-PC-DIFFER-AMT   TO WS-DISC-AMT              30621000
ZX               MOVE PC-SENIOR-CITIZEN     TO WS-DISC-TYPE             30622000
ZX               MOVE 'MDC'                 TO WS-MDWN-TYPE             30623000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  30624000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  30625000
306300        WHEN OTHER                                                30630000
306400           MOVE ZERO TO ML017-PC-DIFFER-AMT                       30640000
306500     END-EVALUATE.                                                30650000
306600                                                                  30660000
306700******************************************************************30670000
306800 4800-PROCESS-TLCD-LID.                                           30680000
306900*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        30690000
307000******************************************************************30700000
307100                                                                  30710000
307200     SET ML017-MKDOWN                                             30720000
307300         ML017-RC-MISCELLANEOUS                                   30730000
307400         ML017-BN-KOHLS-COUPON                                    30740000
307500         ML017-REGISTER-MKDN-MKON     TO TRUE.                    30750000
307600                                                                  30760000
307700     EVALUATE TRUE                                                30771000
307800        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     30780000
307900           SET ML017-MARKDOWN         TO TRUE                     30790000
308000           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      30800000
308100           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       30810000
308200                                       + EPLID-LID-AMT            30820000
308300                                                                  30830000
308400           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      30840000
308500                                       - ML017-PC-NEW-PR-AMT      30850000
040220* ADDED THE BELOW CODE TO FIX INCORRECT MARKDOWN AMOUNT FROM      30850100
040220* BEING TAKEN ON SALES ON WHICH THE ITEM PRICE WAS INFLATED VIA   30850200
040220* A MANUAL LID (INCREASING THE PRICE)                             30850300
040220           COMPUTE PV-NEW-PR-AMT  = PV-EXCLUDE-LID-AMT            30850400
040220                                  + EPLID-LID-AMT                 30850500
040220           IF PV-NEW-PR-AMT < 0                                   30850600
040220               COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT  30850700
040220                                           - PV-NEW-PR-AMT        30850800
040220               MOVE ML017-PC-DIFFER-AMT TO ML017-PC-OLD-PR-AMT    30850900
040220               MOVE 0                   TO ML017-PC-NEW-PR-AMT    30851000
040220           END-IF                                                 30851100
308600                                                                  30860000
308700           ADD +1 TO PT-KOHLS-COUPON-MKDN-QTY                     30870000
308800                                                (PV-TOT-SUB)      30880000
308900           ADD ML017-PC-DIFFER-AMT TO                             30890000
309000                               PT-KOHLS-COUPON-MKDN-AMT           30900000
309100                                                 (PV-TOT-SUB)     30910000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                30911000
ZX               MOVE PC-KOHLS-COUPON     TO WS-DISC-TYPE               30912000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               30913000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  30914000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  30915000
309200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        30920000
309300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     30930000
309400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      30940000
309500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   30950000
309600                                       * (-1)                     30960000
309700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      30970000
309800                                       - ML017-PC-NEW-PR-AMT      30980000
309900           ADD +1 TO PT-KOHLS-COUPON-MDC-QTY                      30990000
310000                                                 (PV-TOT-SUB)     31000000
310100           ADD ML017-PC-DIFFER-AMT TO                             31010000
310200                             PT-KOHLS-COUPON-MDC-AMT              31020000
310300                                                 (PV-TOT-SUB)     31030000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                31031000
ZX               MOVE PC-KOHLS-COUPON     TO WS-DISC-TYPE               31032000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               31033000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  31034000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  31035000
310400        WHEN OTHER                                                31040000
310500           MOVE ZERO TO ML017-PC-DIFFER-AMT                       31050000
310600     END-EVALUATE.                                                31060000
310700                                                                  31070000
310800******************************************************************31080000
310900 4810-PROCESS-OFFER-COUPON.                                       31090000
311000*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        31100000
311100******************************************************************31110000
311200                                                                  31120000
311300     SET ML017-MKDOWN                                             31130000
311400         ML017-RC-MISCELLANEOUS                                   31140000
311500         ML017-BN-OFFER-COUPON                                    31150000
311600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    31160000
311700                                                                  31170000
311800     EVALUATE TRUE                                                31180000
311900        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     31190000
312000           SET ML017-MARKDOWN         TO TRUE                     31200000
312100           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      31210000
312200           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       31220000
312300                                       + EPLID-LID-AMT            31230000
312400                                                                  31240000
312500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31250000
312600                                       - ML017-PC-NEW-PR-AMT      31260000
312700                                                                  31270000
312800           ADD +1 TO PT-760-OFFER-MKDN-QTY                        31280000
312900                                                (PV-TOT-SUB)      31290000
313000           ADD ML017-PC-DIFFER-AMT TO                             31300000
313100                               PT-760-OFFER-MKDN-AMT              31310000
313200                                                 (PV-TOT-SUB)     31320000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                31321000
ZX               MOVE PC-OFFER-COUPON     TO WS-DISC-TYPE               31322000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               31323000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  31324000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  31325000
313300        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        31330000
313400           SET ML017-MARKDOWN-CANCEL  TO TRUE                     31340000
313500           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      31350000
313600           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   31360000
313700                                       * (-1)                     31370000
313800           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31380000
313900                                       - ML017-PC-NEW-PR-AMT      31390000
314000           ADD +1 TO PT-760-OFFER-MDC-QTY                         31400000
314100                                                 (PV-TOT-SUB)     31410000
314200           ADD ML017-PC-DIFFER-AMT TO                             31420000
314300                             PT-760-OFFER-MDC-AMT                 31430000
314400                                                 (PV-TOT-SUB)     31440000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                31441000
ZX               MOVE PC-OFFER-COUPON    TO WS-DISC-TYPE                31442000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               31443000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  31444000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  31445000
314500        WHEN OTHER                                                31450000
314600           MOVE ZERO TO ML017-PC-DIFFER-AMT                       31460000
314700     END-EVALUATE.                                                31470000
314800                                                                  31480000
314900******************************************************************31490000
315000 4820-PROCESS-OFFER-TLD-TIERED.                                   31500000
315100*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        31510000
315200******************************************************************31520000
315300                                                                  31530000
315400     SET ML017-MKDOWN                                             31540000
315500         ML017-RC-MISCELLANEOUS                                   31550000
315600         ML017-BN-OFFER-TLD-TIERED                                31560000
315700         ML017-REGISTER-MKDN-MKON     TO TRUE.                    31570000
315800                                                                  31580000
315900     EVALUATE TRUE                                                31590000
316000        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     31600000
316100           SET ML017-MARKDOWN         TO TRUE                     31610000
316200           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      31620000
316300           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       31630000
316400                                       + EPLID-LID-AMT            31640000
316500                                                                  31650000
316600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31660000
316700                                       - ML017-PC-NEW-PR-AMT      31670000
316800                                                                  31680000
316900           ADD +1 TO PT-761-TLDTIER-MKDN-QTY                      31690000
317000                                                (PV-TOT-SUB)      31700000
317100           ADD ML017-PC-DIFFER-AMT TO                             31710000
317200                               PT-761-TLDTIER-MKDN-AMT            31720000
317300                                                 (PV-TOT-SUB)     31730000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                31730100
ZX               MOVE PC-OFFER-TLD-TIERED TO WS-DISC-TYPE               31730200
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               31730300
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  31730400
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  31730500
317400        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        31740000
317500           SET ML017-MARKDOWN-CANCEL  TO TRUE                     31750000
317600           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      31760000
317700           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   31770000
317800                                       * (-1)                     31780000
317900           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31790000
318000                                       - ML017-PC-NEW-PR-AMT      31800000
318100           ADD +1 TO PT-761-TLDTIER-MDC-QTY                       31810000
318200                                                 (PV-TOT-SUB)     31820000
318300           ADD ML017-PC-DIFFER-AMT TO                             31830000
318400                             PT-761-TLDTIER-MDC-AMT               31840000
318500                                                 (PV-TOT-SUB)     31850000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                31851000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                31851100
ZX               MOVE PC-OFFER-TLD-TIERED TO WS-DISC-TYPE               31851200
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               31851300
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  31851400
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  31851500
318600        WHEN OTHER                                                31860000
318700           MOVE ZERO TO ML017-PC-DIFFER-AMT                       31870000
318800     END-EVALUATE.                                                31880000
318900                                                                  31890000
319000******************************************************************31900000
319100 4830-PROCESS-OFFER-LID-TIERED.                                   31910000
319200*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        31920000
319300******************************************************************31930000
319400                                                                  31940000
319500     SET ML017-MKDOWN                                             31950000
319600         ML017-RC-MISCELLANEOUS                                   31960000
319700         ML017-BN-OFFER-LID-TIERED                                31970000
319800         ML017-REGISTER-MKDN-MKON     TO TRUE.                    31980000
319900                                                                  31990000
320000     EVALUATE TRUE                                                32000000
320100        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     32010000
320200           SET ML017-MARKDOWN         TO TRUE                     32020000
320300           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      32030000
320400           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       32040000
320500                                       + EPLID-LID-AMT            32050000
320600                                                                  32060000
320700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32070000
320800                                       - ML017-PC-NEW-PR-AMT      32080000
320900                                                                  32090000
321000           ADD +1 TO PT-762-LIDTIER-MKDN-QTY                      32100000
321100                                                (PV-TOT-SUB)      32110000
321200           ADD ML017-PC-DIFFER-AMT TO                             32120000
321300                               PT-762-LIDTIER-MKDN-AMT            32130000
321400                                                 (PV-TOT-SUB)     32140000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                32141000
ZX               MOVE PC-OFFER-LID-TIERED TO WS-DISC-TYPE               32142000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               32143000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  32144000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  32145000
321500        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        32150000
321600           SET ML017-MARKDOWN-CANCEL  TO TRUE                     32160000
321700           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      32170000
321800           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   32180000
321900                                       * (-1)                     32190000
322000           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32200000
322100                                       - ML017-PC-NEW-PR-AMT      32210000
322200           ADD +1 TO PT-762-LIDTIER-MDC-QTY                       32220000
322300                                                 (PV-TOT-SUB)     32230000
322400           ADD ML017-PC-DIFFER-AMT TO                             32240000
322500                             PT-762-LIDTIER-MDC-AMT               32250000
322600                                                 (PV-TOT-SUB)     32260000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                32261000
ZX               MOVE PC-OFFER-LID-TIERED TO WS-DISC-TYPE               32262000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               32263000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  32264000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  32265000
322700        WHEN OTHER                                                32270000
322800           MOVE ZERO TO ML017-PC-DIFFER-AMT                       32280000
322900     END-EVALUATE.                                                32290000
323000                                                                  32300000
323100******************************************************************32310000
323200 4840-PROCESS-OFFER-GWP-PWP.                                      32320000
323300*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        32330000
323400******************************************************************32340000
323500                                                                  32350000
323600     SET ML017-MKDOWN                                             32360000
323700         ML017-RC-MISCELLANEOUS                                   32370000
323800         ML017-BN-OFFER-GWP-PWP                                   32380000
323900         ML017-REGISTER-MKDN-MKON     TO TRUE.                    32390000
324000                                                                  32400000
324100     EVALUATE TRUE                                                32410000
324200        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     32420000
324300           SET ML017-MARKDOWN         TO TRUE                     32430000
324400           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      32440000
324500           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       32450000
324600                                       + EPLID-LID-AMT            32460000
324700                                                                  32470000
324800           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32480000
324900                                       - ML017-PC-NEW-PR-AMT      32490000
325000                                                                  32500000
325100           ADD +1 TO PT-763-GWPPWP-MKDN-QTY                       32510000
325200                                                (PV-TOT-SUB)      32520000
325300           ADD ML017-PC-DIFFER-AMT TO                             32530000
325400                               PT-763-GWPPWP-MKDN-AMT             32540000
325500                                                 (PV-TOT-SUB)     32550000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                32551000
ZX               MOVE PC-OFFER-GWP-PWP    TO WS-DISC-TYPE               32552000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               32553000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  32554000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  32555000
325600        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        32560000
325700           SET ML017-MARKDOWN-CANCEL  TO TRUE                     32570000
325800           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      32580000
325900           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   32590000
326000                                       * (-1)                     32600000
326100           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32610000
326200                                       - ML017-PC-NEW-PR-AMT      32620000
326300           ADD +1 TO PT-763-GWPPWP-MDC-QTY                        32630000
326400                                                 (PV-TOT-SUB)     32640000
326500           ADD ML017-PC-DIFFER-AMT TO                             32650000
326600                             PT-763-GWPPWP-MDC-AMT                32660000
326700                                                 (PV-TOT-SUB)     32670000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                32671000
ZX               MOVE PC-OFFER-GWP-PWP    TO WS-DISC-TYPE               32672000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               32673000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  32674000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  32675000
326800        WHEN OTHER                                                32680000
326900           MOVE ZERO TO ML017-PC-DIFFER-AMT                       32690000
327000     END-EVALUATE.                                                32700000
327100                                                                  32710000
205464******************************************************************32710100
205464 4841-PROCESS-NON-RCPT-RTRN.                                      32710200
205464*     PROCESS NON RECEIPT RETURNS                                 32710300
205464******************************************************************32710400
205464                                                                  32710500
205464     SET ML017-MKDOWN                                             32710600
205464         ML017-RC-MISCELLANEOUS                                   32710700
205464         ML017-BN-NON-RCPT-RETURN                                 32710800
205464         ML017-REGISTER-MKDN-MKON     TO TRUE.                    32710900
205464                                                                  32711000
205464     EVALUATE TRUE                                                32711100
205464        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     32711200
205464           SET ML017-MARKDOWN         TO TRUE                     32711300
205464           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      32711400
205464           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       32711500
205464                                       + EPLID-LID-AMT            32711600
205464                                                                  32711700
205464           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32711800
205464                                       - ML017-PC-NEW-PR-AMT      32711900
205464                                                                  32712000
205464           ADD +1 TO PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)          32712100
205464           ADD ML017-PC-DIFFER-AMT    TO                          32712200
205464                               PT-710-NORCPT-MKDN-AMT(PV-TOT-SUB) 32712300
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                32712400
ZX               MOVE PC-NON-REC-RETURN   TO WS-DISC-TYPE               32712500
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               32712600
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  32712700
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  32712800
205464        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        32712900
205464           SET ML017-MARKDOWN-CANCEL  TO TRUE                     32713000
205464           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      32713100
205464           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   32713200
205464                                       * (-1)                     32713300
205464           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32713400
205464                                       - ML017-PC-NEW-PR-AMT      32713500
205464           ADD +1 TO PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)           32713600
205464           ADD ML017-PC-DIFFER-AMT    TO                          32713700
205464                               PT-710-NORCPT-MDC-AMT  (PV-TOT-SUB)32713800
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                32713900
ZX               MOVE PC-NON-REC-RETURN   TO WS-DISC-TYPE               32714000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               32714100
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  32714200
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  32714300
205464        WHEN OTHER                                                32714400
205464           MOVE ZERO TO ML017-PC-DIFFER-AMT                       32714500
205464     END-EVALUATE.                                                32714600
205464                                                                  32714700
327200******************************************************************32723000
327300 4842-PROCESS-GFT-RCPT-RTRN.                                      32730000
327400*     PROCESS GIFT RECEIPT RETURNS                                32740000
327500******************************************************************32750000
327600                                                                  32760000
327700     SET ML017-MKDOWN                                             32770000
327800         ML017-RC-MISCELLANEOUS                                   32780000
327900         ML017-BN-UU-GFT-RCPT-RTRN                                32790000
328000         ML017-REGISTER-MKDN-MKON     TO TRUE.                    32800000
328100                                                                  32810000
328200     EVALUATE TRUE                                                32820000
328300        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     32830000
328400           SET ML017-MARKDOWN         TO TRUE                     32840000
328500           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      32850000
328600           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       32860000
328700                                       + EPLID-LID-AMT            32870000
328800                                                                  32880000
328900           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32890000
329000                                       - ML017-PC-NEW-PR-AMT      32900000
329100                                                                  32910000
329200           ADD +1 TO PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)            32920000
329300           ADD ML017-PC-DIFFER-AMT TO                             32930000
329400                                  PT-765-GIFT-MKDN-AMT(PV-TOT-SUB)32940000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                32941000
ZX               MOVE PC-GIFT-RCPT-RETURN TO WS-DISC-TYPE               32942000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               32943000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  32944000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  32945000
329500        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        32950000
329600           SET ML017-MARKDOWN-CANCEL  TO TRUE                     32960000
329700           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      32970000
329800           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   32980000
329900                                       * (-1)                     32990000
330000           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33000000
330100                                       - ML017-PC-NEW-PR-AMT      33010000
330200           ADD +1 TO PT-765-GIFT-MDC-QTY (PV-TOT-SUB)             33020000
330300           ADD ML017-PC-DIFFER-AMT TO                             33030000
330400                                  PT-765-GIFT-MDC-AMT (PV-TOT-SUB)33040000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                33041000
ZX               MOVE PC-GIFT-RCPT-RETURN TO WS-DISC-TYPE               33042000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               33043000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  33044000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  33045000
330500        WHEN OTHER                                                33050000
330600           MOVE ZERO TO ML017-PC-DIFFER-AMT                       33060000
330700     END-EVALUATE.                                                33070000
330800                                                                  33080000
330900******************************************************************33090000
331000 4850-PROCESS-BOGO-LID.                                           33100000
331100*     PROCESS PRORATED BUY ONE GET ONE FREE PROMOTION.            33110000
331200******************************************************************33120000
331300                                                                  33130000
331400     SET ML017-MKDOWN                                             33140000
331500         ML017-RC-MISCELLANEOUS                                   33150000
331600         ML017-BN-BOGO                                            33160000
331700         ML017-PLU-MKDN-MKON          TO TRUE.                    33170000
331800                                                                  33180000
331900     EVALUATE TRUE                                                33190000
332000        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     33200000
332100           SET ML017-MARKDOWN         TO TRUE                     33210000
332200           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      33220000
332300           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       33230000
332400                                       + EPLID-LID-AMT            33240000
332500                                                                  33250000
332600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33260000
332700                                       - ML017-PC-NEW-PR-AMT      33270000
332800                                                                  33280000
332900           ADD +1 TO PT-BOGO-MKDN-QTY (PV-TOT-SUB)                33290000
333000           ADD ML017-PC-DIFFER-AMT TO PT-BOGO-MKDN-AMT(PV-TOT-SUB)33300000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                33301000
ZX               MOVE PC-BOGO             TO WS-DISC-TYPE               33302000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               33303000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  33304000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  33305000
333100        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        33310000
333200           SET ML017-MARKDOWN-CANCEL  TO TRUE                     33320000
333300           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      33330000
333400           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   33340000
333500                                       * (-1)                     33350000
333600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33360000
333700                                       - ML017-PC-NEW-PR-AMT      33370000
333800           ADD +1 TO PT-BOGO-MDC-QTY (PV-TOT-SUB)                 33380000
333900           ADD ML017-PC-DIFFER-AMT TO PT-BOGO-MDC-AMT (PV-TOT-SUB)33390000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                33391000
ZX               MOVE PC-BOGO             TO WS-DISC-TYPE               33392000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               33393000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  33394000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  33395000
334000        WHEN OTHER                                                33400000
334100           MOVE ZERO TO ML017-PC-DIFFER-AMT                       33410000
334200     END-EVALUATE.                                                33420000
334300                                                                  33430000
334400******************************************************************33440000
334500 4860-PROCESS-UNEARNED-RWDS-LID.                                  33450000
334600*     PROCESS THE MARKDOWN CANCELS FOR UNEARNED REWARDS.          33460000
334700******************************************************************33470000
334800                                                                  33480000
334900     SET ML017-MKDOWN                                             33490000
335000         ML017-RC-MISCELLANEOUS                                   33500000
335100         ML017-BN-UNEARNED-RWDS                                   33510000
335200         ML017-REGISTER-MKDN-MKON     TO TRUE.                    33520000
335300                                                                  33530000
335400     EVALUATE TRUE                                                33540000
335500        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     33550000
335600           SET ML017-MARKDOWN         TO TRUE                     33560000
335700           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      33570000
335800           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       33580000
335900                                       + EPLID-LID-AMT            33590000
336000                                                                  33600000
336100           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33610000
336200                                       - ML017-PC-NEW-PR-AMT      33620000
336300                                                                  33630000
336400           ADD +1 TO PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)       33640000
336500           ADD ML017-PC-DIFFER-AMT TO                             33650000
336600                       PT-UNEARNED-RWDS-MKDN-AMT(PV-TOT-SUB)      33660000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                33661000
ZX               MOVE PC-UNEARNED-REWARDS TO WS-DISC-TYPE               33662000
ZX               MOVE 'MD'                TO WS-MDWN-TYPE               33663000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  33664000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  33665000
336700        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        33670000
336800           SET ML017-MARKDOWN-CANCEL  TO TRUE                     33680000
336900           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      33690000
337000           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   33700000
337100                                       * (-1)                     33710000
337200           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33720000
337300                                       - ML017-PC-NEW-PR-AMT      33730000
337400           ADD +1 TO PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)        33740000
337500           ADD ML017-PC-DIFFER-AMT TO                             33750000
337600                       PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)      33760000
ZX               MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT                33761000
ZX               MOVE PC-UNEARNED-REWARDS TO WS-DISC-TYPE               33762000
ZX               MOVE 'MDC'               TO WS-MDWN-TYPE               33763000
ZX               PERFORM 8195-BUILD-DAY02-TRANS-RECORD                  33764000
ZX               PERFORM 8195-WRITE-DAY02-TRANS-RECORD                  33765000
337700        WHEN OTHER                                                33770000
337800           MOVE ZERO TO ML017-PC-DIFFER-AMT                       33780000
337900     END-EVALUATE.                                                33790000
338000                                                                  33800000
338100******************************************************************33810000
338200 4900-PROCESS-NORMAL-LID.                                         33820000
338300*     PROCESS NORMAL DISCOUNTS.                                   33830000
338400******************************************************************33840000
338500                                                                  33850000
338600     SET ML017-MKDOWN                                             33860000
338700         ML017-RC-MISCELLANEOUS                                   33870000
338800         ML017-BN-MANUAL-LID                                      33880000
338900         ML017-REGISTER-MKDN-MKON     TO TRUE.                    33890000
339000                                                                  33900000
339100     IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753              33910000
339200        SET ML017-BN-GOLDSTAR TO TRUE                             33920000
339300     END-IF.                                                      33930000
339400                                                                  33940000
339500     EVALUATE TRUE                                                33950000
339600        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    33960000
339700             PV-EXCLUDE-LID-AMT   >= ZERO AND                     33970000
339800             (                                                    33980000
339900               (                                                  33990000
340000                (EPITM-NET-CHRGD-AMT > ZERO  OR                   34000000
340100                (EPITM-NET-CHRGD-AMT = 0                          34010000
340200                    AND (EPITM-SAL-RET-CDE = 'S' OR 'A') ))       34020000
340300                )                                                 34030000
340400             )                            AND                     34040000
340500                                                                  34050000
340600             PV-EXCLUDE-LID-AMT   >= EPITM-NET-CHRGD-AMT          34060000
340700                                                                  34070000
340800           SET ML017-MARKDOWN TO TRUE                             34080000
340900                                                                  34090000
341000** FIX DUE TO SIGN BEING DROPPED CAUSING CALCULATION TO BE WRONG  34100000
341100           MOVE PV-EXCLUDE-LID-AMT TO PV-PC-OLD-PR-AMT            34110000
341200           COMPUTE PV-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT          34120000
341300                                       + EPLID-LID-AMT            34130000
341400           COMPUTE PV-PC-DIFFER-AMT = PV-PC-OLD-PR-AMT            34140000
341500                                       - PV-PC-NEW-PR-AMT         34150000
341600                                                                  34160000
341700           MOVE PV-PC-OLD-PR-AMT TO ML017-PC-OLD-PR-AMT           34170000
341800           MOVE PV-PC-NEW-PR-AMT TO ML017-PC-NEW-PR-AMT           34180000
341900           MOVE PV-PC-DIFFER-AMT TO ML017-PC-DIFFER-AMT           34190000
342000                                                                  34200000
342100                                                                  34210000
342200** FIX TO WHERE A GOLDSTAR LID IS RETRIEVED FROM THE ORIGIN SALE  34220000
342300** AND WAS PREVOIUSLY REPORTING AS MANUAL LID                     34230000
342400           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        34240000
342500               ADD +1                  TO PT-GOLDSTAR-MKDN-QTY    34250000
342600                                            (PV-TOT-SUB)          34260000
342700               ADD ML017-PC-DIFFER-AMT                            34270000
342800                                       TO PT-GOLDSTAR-MKDN-AMT    34280000
342900                                            (PV-TOT-SUB)          34290000
                                                                        34290100
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            34291000
ZX                   MOVE PC-GOLDSTAR         TO WS-DISC-TYPE           34292000
ZX                   MOVE 'MD'                TO WS-MDWN-TYPE           34293000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              34294000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              34295000
343000           ELSE                                                   34300000
343100               ADD +1                    TO PT-MANUAL-LID-MKDN-QTY34310000
343200                                           (PV-TOT-SUB)           34320000
343300               ADD ML017-PC-DIFFER-AMT   TO PT-MANUAL-LID-MKDN-AMT34330000
343400                                           (PV-TOT-SUB)           34340000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            34341000
ZX                   MOVE PC-MANUAL-LID       TO WS-DISC-TYPE           34342000
ZX                   MOVE 'MD'                TO WS-MDWN-TYPE           34343000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              34344000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              34345000
343500           END-IF                                                 34350000
343600                                                                  34360000
343700        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        34370000
343800           SET ML017-MARKDOWN-CANCEL  TO TRUE                     34380000
343900           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      34390000
344000           MOVE EPLID-LID-AMT         TO ML017-PC-NEW-PR-AMT      34400000
344100           MOVE ML017-PC-NEW-PR-AMT   TO PV-NET-CHRGD-AMT         34410000
344200           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      34420000
344300                                       - ML017-PC-NEW-PR-AMT      34430000
344400                                                                  34440000
344500** FIX TO WHERE A GOLDSTAR LID IS RETRIEVED FROM THE ORIGIN SALE  34450000
344600** AND WAS PREVOIUSLY REPORTING AS MANUAL LID                     34460000
344700           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        34470000
344800               ADD +1                  TO PT-GOLDSTAR-MDC-QTY     34480000
344900                                            (PV-TOT-SUB)          34490000
345000               ADD ML017-PC-DIFFER-AMT                            34500000
345100                                       TO PT-GOLDSTAR-MDC-AMT     34510000
345200                                            (PV-TOT-SUB)          34520000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            34521000
ZX                   MOVE PC-GOLDSTAR       TO WS-DISC-TYPE             34522000
ZX                   MOVE 'MDC'             TO WS-MDWN-TYPE             34523000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              34524000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              34525000
345300           ELSE                                                   34530000
345400               ADD +1                  TO PT-MANUAL-LID-MDC-QTY   34540000
345500                                            (PV-TOT-SUB)          34550000
345600               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MDC-AMT   34560000
345700                                            (PV-TOT-SUB)          34570000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            34571000
ZX                   MOVE PC-MANUAL-LID     TO WS-DISC-TYPE             34572000
ZX                   MOVE 'MDC'             TO WS-MDWN-TYPE             34573000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              34574000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              34575000
345800           END-IF                                                 34580000
345900                                                                  34590000
346000        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    34600000
346100             EPITM-CUST-CHRGD-AMT <= ZERO AND                     34610000
346200             EPITM-NET-CHRGD-AMT   <= ZERO AND                    34610100
011618             EPTRN-POS-CPBL-LVL-NBR = PC-POC AND                  34610200
062118             (EPITM-SAL-RET-CDE = 'R' OR                          34610300
062118              EPITM-SAL-RET-CDE = 'B')                            34610400
011618* WHEN IT'S A RETURN ITEM AND THE DISCOUNT WAS NEGATIVE           34610700
011618* WHICH MEANS THAT ON THE SALE, THIS DISCOUNT HAD RAISED THE      34610800
011618* COST OF THE ITEM (PRICE CORRECTION - MAN LID MARKUP) AND        34610900
011618* IT'S A POC TRANSACTION, THEN EXECUTE THE BELOW CODE.            34611000
011618           SET ML017-MARKDOWN TO TRUE                             34611400
040220           COMPUTE ML017-PC-OLD-PR-AMT =                          34611500
011618                              (PV-PRICE-CHANGE-AMOUNT * (-1))     34612000
040220           MOVE ZERO TO ML017-PC-NEW-PR-AMT                       34612100
011618           COMPUTE ML017-PC-DIFFER-AMT =                          34612300
011618                               (ML017-PC-OLD-PR-AMT -             34612400
011618                               ML017-PC-NEW-PR-AMT)               34612500
011618                                                                  34612700
011618           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        34612800
011618               ADD +1                  TO PT-GOLDSTAR-MKDN-QTY    34612900
011618                                            (PV-TOT-SUB)          34613000
011618               ADD ML017-PC-DIFFER-AMT                            34613100
011618                                       TO PT-GOLDSTAR-MKDN-AMT    34613200
011618                                            (PV-TOT-SUB)          34613300
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            34613400
ZX                   MOVE PC-GOLDSTAR       TO WS-DISC-TYPE             34613500
ZX                   MOVE 'MD '             TO WS-MDWN-TYPE             34613600
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              34613700
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              34613800
011618           ELSE                                                   34613900
011618               ADD +1                  TO PT-MANUAL-LID-MKDN-QTY  34614000
011618                                            (PV-TOT-SUB)          34614100
011618               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MKDN-AMT  34614200
011618                                            (PV-TOT-SUB)          34614300
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            34614400
ZX                   MOVE PC-MANUAL-LID     TO WS-DISC-TYPE             34614500
ZX                   MOVE 'MD '             TO WS-MDWN-TYPE             34614600
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              34614700
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              34614800
011618           END-IF                                                 34615000
ZX                                                                      34622100
346300                                                                  34630000
346000        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    34631000
346100             EPITM-CUST-CHRGD-AMT <= ZERO AND                     34632000
346200             EPITM-NET-CHRGD-AMT   <= ZERO                        34633000
346400        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    34640000
346500             EPITM-CUST-CHRGD-AMT >= ZERO AND                     34650000
346600             EPITM-NET-CHRGD-AMT >= ZERO AND                      34660000
346700             EPITM-CUST-CHRGD-AMT <= EPITM-NET-CHRGD-AMT          34670000
346800                                                                  34680000
346900           SET ML017-MARKDOWN-CANCEL TO TRUE                      34690000
347000           MOVE ZERO TO ML017-PC-OLD-PR-AMT                       34700000
347100           COMPUTE ML017-PC-NEW-PR-AMT =                          34710000
347200                              (PV-PRICE-CHANGE-AMOUNT * (-1))     34720000
347300           COMPUTE ML017-PC-DIFFER-AMT =                          34730000
347400                               (ML017-PC-OLD-PR-AMT -             34740000
347500                               ML017-PC-NEW-PR-AMT)               34750000
347600                                                                  34760000
347700           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        34770000
347800               ADD +1                  TO PT-GOLDSTAR-MDC-QTY     34780000
347900                                            (PV-TOT-SUB)          34790000
348000               ADD ML017-PC-DIFFER-AMT                            34800000
348100                                       TO PT-GOLDSTAR-MDC-AMT     34810000
348200                                            (PV-TOT-SUB)          34820000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            34821000
ZX                   MOVE PC-GOLDSTAR       TO WS-DISC-TYPE             34822000
ZX                   MOVE 'MDC'             TO WS-MDWN-TYPE             34823000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              34824000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              34825000
348300           ELSE                                                   34830000
348400               ADD +1                  TO PT-MANUAL-LID-MDC-QTY   34840000
348500                                            (PV-TOT-SUB)          34850000
348600               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MDC-AMT   34860000
348700                                            (PV-TOT-SUB)          34870000
ZX                   MOVE ML017-PC-DIFFER-AMT TO WS-DISC-AMT            34871000
ZX                   MOVE PC-MANUAL-LID     TO WS-DISC-TYPE             34872000
ZX                   MOVE 'MDC'             TO WS-MDWN-TYPE             34873000
ZX                   PERFORM 8195-BUILD-DAY02-TRANS-RECORD              34874000
ZX                   PERFORM 8195-WRITE-DAY02-TRANS-RECORD              34875000
348800           END-IF                                                 34880000
348900                                                                  34890000
349000        WHEN OTHER                                                34900000
349100           MOVE ZERO TO ML017-PC-DIFFER-AMT                       34910000
349200                                                                  34920000
349300     END-EVALUATE.                                                34930000
349400                                                                  34940000
349500                                                                  34950000
349600******************************************************************34960000
349700 6000-OPEN-DKEY-CURSOR.                                           34970000
349800******************************************************************34980000
349900                                                                  34990000
350000     EXEC SQL                                                     35000000
350100          OPEN TEPDKEY-CURSOR                                     35010000
350200     END-EXEC.                                                    35020000
350300                                                                  35030000
350400     EVALUATE TRUE                                                35040000
350500        WHEN SQLCODE = ZERO                                       35050000
350600           CONTINUE                                               35060000
350700        WHEN OTHER                                                35070000
350800           MOVE '6000-OPEN-DKEY-CURSOR'                           35080000
350900                                      TO PV-PARAGRAPH-NAME        35090000
351000           SET AC-DB2-ERROR           TO TRUE                     35100000
351100           PERFORM 9999-ABEND                                     35110000
351200     END-EVALUATE.                                                35120000
351300                                                                  35130000
351400******************************************************************35140000
351500 6100-FETCH-DKEY-CURSOR.                                          35150000
351600*     FETCH LATE AND SALES CORRECTION TRANSACTIONS.               35160000
351700******************************************************************35170000
351800                                                                  35180000
351900     EXEC SQL                                                     35190000
352000          FETCH TEPDKEY-CURSOR                                    35200000
352100           INTO :EPTRN-PARTN-NBR                                  35210000
352200               ,:EPTRN-STR-NBR                                    35220000
352300               ,:EPTRN-RGST-ID                                    35230000
352400               ,:EPTRN-TRN-NBR                                    35240000
352500               ,:EPTRN-STRT-TM                                    35250000
352600               ,:EPTRN-SLS-CORR-SEQ-NBR                           35260000
352700               ,:EPTRN-TRN-STAT-CDE                               35270000
352800               ,:EPTRN-SLS-DTE                                    35280000
BOSSCL               ,:EPTRN-TRN-DTE                                    35280111
011618               ,:EPTRN-POS-CPBL-LVL-NBR                           35280211
352900               ,:EPTRN-CRE-TMST                                   35290000
BOSSCL               ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                    35291001
BOSSCL                :PV-OMNI-CHNL-TYP-CDE-NULL-IND                    35292001
BOSSC2               ,:PV-TRANSFER-DATE                                 35293013
353000     END-EXEC.                                                    35300000
353100                                                                  35310000
353200     EVALUATE TRUE                                                35320000
353300        WHEN SQLCODE = ZERO                                       35330000
BOSSCL           IF PV-OMNI-CHNL-TYP-CDE-NULL-IND = -1                  35331008
BOSSCL              MOVE SPACES TO EPTRN-OMNI-CHNL-FFLMT-TYP-CDE        35332008
BOSSCL           END-IF                                                 35333008
353400           MOVE EPTRN-PARTN-NBR       TO  PV-PARTN-NBR            35340000
353500           MOVE EPTRN-STR-NBR         TO  PV-STR-NBR              35350000
353600           MOVE EPTRN-RGST-ID         TO  PV-RGST-ID              35360000
353700           MOVE EPTRN-TRN-NBR         TO  PV-TRN-NBR              35370000
353800           MOVE EPTRN-STRT-TM         TO  PV-STRT-TM              35380000
353900           MOVE EPTRN-SLS-CORR-SEQ-NBR  TO  PV-SLS-CORR-SEQ-NBR   35390000
354000                                                                  35400000
354100           PERFORM 1117-CALCU-KOHLS-MONTH                         35410000
354200           PERFORM 2500-OPEN-ITEM-CURSOR                          35420000
354300           PERFORM 2600-FETCH-ITEM-CURSOR                         35430000
354400              UNTIL PS-END-OF-ITEM-YES                            35440000
354500           PERFORM 2700-CLOSE-ITEM-CURSOR                         35450000
354600           ADD 1                      TO WS-CMT-CNT               35460000
354700                                                                  35470000
354800        WHEN SQLCODE = PC-ROW-NOT-FOUND                           35480000
354900           SET PS-END-OF-DKEY-YES     TO TRUE                     35490000
355000        WHEN SQLWARN0 NOT EQUAL SPACE                             35500000
355100        WHEN SQLCODE NOT EQUAL ZERO                               35510000
355200           MOVE '6100-FETCH-DKEY-CURSOR'                          35520000
355300                                      TO PV-PARAGRAPH-NAME        35530000
355400           SET AC-DB2-ERROR           TO TRUE                     35540000
355500           PERFORM 9999-ABEND                                     35550000
355600     END-EVALUATE.                                                35560000
355700                                                                  35570000
355800     IF WS-CMT-CNT > 2000                                         35580000
355900       PERFORM 8999-COMMIT-PARA                                   35590000
356000       MOVE ZEROS                         TO WS-CMT-CNT           35600000
356100     END-IF.                                                      35610000
356200                                                                  35620000
356300******************************************************************35630000
356400 6200-CLOSE-DKEY-CURSOR.                                          35640000
356500******************************************************************35650000
356600                                                                  35660000
356700     EXEC SQL                                                     35670000
356800          CLOSE TEPDKEY-CURSOR                                    35680000
356900     END-EXEC.                                                    35690000
357000                                                                  35700000
357100     EVALUATE TRUE                                                35710000
357200        WHEN SQLCODE = ZERO                                       35720000
357300           CONTINUE                                               35730000
357400        WHEN OTHER                                                35740000
357500           MOVE '6200-CLOSE-DKEY-CURSOR'    TO PV-PARAGRAPH-NAME  35750000
357600           SET AC-DB2-ERROR           TO TRUE                     35760000
357700           PERFORM 9999-ABEND                                     35770000
357800     END-EVALUATE.                                                35780000
357900                                                                  35790000
358000******************************************************************35800000
358100 6300-SELECT-TIERED.                                              35810000
358200******************************************************************35820000
358300                                                                  35830000
358400      EXEC SQL                                                    35840000
358500         SELECT  LID_AMT                                          35850000
ZX                    ,LID_RSN_CDE                                      35851000
358600           INTO :EPLID-LID-AMT                                    35860000
ZX                   ,:EPLID-LID-RSN-CDE                                35861000
358700           FROM TEPLID                                            35870000
358800          WHERE PARTN_NBR = :PV-PARTN-NBR                         35880000
358900            AND STR_NBR   = :PV-STR-NBR                           35890000
359000            AND RGST_ID   = :PV-RGST-ID                           35900000
359100            AND TRN_NBR   = :PV-TRN-NBR                           35910000
359200            AND STRT_TM   = :PV-STRT-TM                           35920000
359300            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           35930000
359400            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            35940000
359500            AND LID_TYP_CDE      = 'T'                            35950000
359600                WITH UR                                           35960000
359700      END-EXEC.                                                   35970000
359800                                                                  35980000
359900     EVALUATE TRUE                                                35990000
360000        WHEN SQLCODE = ZERO                                       36000000
360100           SET PS-TIERED-ITEM-YES     TO TRUE                     36010000
360200        WHEN SQLCODE = PC-ROW-NOT-FOUND                           36020000
360300           SET PS-TIERED-ITEM-NO      TO TRUE                     36030000
360400        WHEN SQLWARN0 NOT EQUAL SPACE                             36040000
360500        WHEN SQLCODE NOT EQUAL ZERO                               36050000
360600           MOVE '6100-FETCH-DKEY-CURSOR'                          36060000
360700                                      TO PV-PARAGRAPH-NAME        36070000
360800           SET AC-DB2-ERROR           TO TRUE                     36080000
360900           PERFORM 9999-ABEND                                     36090000
361000     END-EVALUATE.                                                36100000
361100                                                                  36110000
361200******************************************************************36120000
361300 8000-WRITE-LEDGER-MKDN-RECORD.                                   36130000
361400*     WRITE A LEDGER MARKDOWN TRANSACTION RECORD.                 36140000
361500******************************************************************36150000
361600** ACCUMULATES MARKDOWNS/MARKDOWN CANCELS WRITTEN TO FILE.        36160000
361700     IF ML017-MARKDOWN-CANCEL                                     36170000
361800          COMPUTE PV-TOTAL-MKDNCAN-AMT =                          36180000
361900             (ML017-PC-DIFFER-AMT * -1) + PV-TOTAL-MKDNCAN-AMT    36190000
362000     ELSE                                                         36200000
362100          ADD ML017-PC-DIFFER-AMT TO PV-TOTAL-MKDN-AMT            36210000
362200     END-IF                                                       36220000
362300                                                                  36230000
362400     WRITE LM-LEDGER-MARKDOWN-RECORD                              36240000
362500         FROM ML017-PRICE-CHANGE-RECORD.                          36250000
362600                                                                  36260000
362700******************************************************************36270000
362800 8025-WRITE-HOLD-LEDGR-MKDN-REC.                                  36280000
362900*     WRITE A HOLD LEDGER MARKDOWN TRANSACTION RECORD.            36290000
363000******************************************************************36300000
BOSSCL     IF ML017-MARKDOWN-CANCEL                                     36301001
BOSSCL          COMPUTE PV-TOTAL-MKDNCAN-AMT =                          36302001
BOSSCL             (ML017-PC-DIFFER-AMT * -1) + PV-TOTAL-MKDNCAN-AMT    36303001
BOSSCL     ELSE                                                         36304001
BOSSCL          ADD ML017-PC-DIFFER-AMT TO PV-TOTAL-MKDN-AMT            36305001
BOSSCL     END-IF.                                                      36306001
363100                                                                  36310001
363100     WRITE HOLD-LEDGER-MARKDOWN-RECORD                            36311001
363200         FROM ML017-PRICE-CHANGE-RECORD.                          36320000
363300                                                                  36330000
365000******************************************************************36500000
365100 8100-WRITE-LEDGER-MKUP-RECORD.                                   36510000
365200*     WRITE A LEDGER MARKUP TRANSACTION RECORD.                   36520000
365300******************************************************************36530000
365400                                                                  36540000
365500     WRITE LM-LEDGER-MARKUP-RECORD                                36550000
365600         FROM ML017-PRICE-CHANGE-RECORD.                          36560000
365700                                                                  36570000
365800******************************************************************36580000
365900 8125-WRITE-HOLD-LEDGR-MKUP-REC.                                  36590000
366000*     WRITE A HOLD LEDGER MARKUP TRANSACTION RECORD.              36600000
366100******************************************************************36610000
366200                                                                  36620000
366300     WRITE HOLD-LEDGER-MARKUP-RECORD                              36630000
366400         FROM ML017-PRICE-CHANGE-RECORD.                          36640000
366500                                                                  36650000
368200******************************************************************36820000
368300 8180-FORMAT-MW-RECORD.                                           36830000
368400*     COPY THE MLRD017 TO MLRD044 FOR DATA WAREHOUSE              36840000
368500******************************************************************36850000
368600      INITIALIZE ML044-PRICE-CHANGE-RECORD.                       36860000
368700      MOVE ML017-PC-CDE              TO ML044-PC-CDE.             36870000
368800      MOVE ML017-PC-TYP-CDE          TO ML044-PC-TYP-CDE.         36880000
368900      MOVE ML017-SLS-CORR-CDE        TO ML044-SLS-CORR-CDE.       36890000
369000      MOVE ML017-PC-DOC-5-NBR        TO ML044-PC-DOC-5-NBR.       36900000
369100      MOVE ML017-PC-DTE              TO ML044-PC-DTE.             36910000
369200      MOVE ML017-PC-KOHLS-MM         TO ML044-PC-KOHLS-MM.        36920000
369300      MOVE ML017-PC-SKU              TO ML044-PC-SKU.             36930000
369400      MOVE ML017-PC-RSN-CDE          TO ML044-PC-RSN-CDE.         36940000
369500      MOVE ML017-PC-OLD-PR-AMT       TO ML044-PC-OLD-PR-AMT.      36950000
369600      MOVE ML017-PC-NEW-PR-AMT       TO ML044-PC-NEW-PR-AMT.      36960000
369700      MOVE ML017-PC-QTY              TO ML044-PC-QTY.             36970000
369800      MOVE ML017-PC-BATCH-NBR        TO ML044-PC-BATCH-NBR.       36980000
369900      MOVE ML017-PC-MKDN-MKUP-RSN-CDE TO                          36990000
370000           ML044-PC-MKDN-MKUP-RSN-CDE.                            37000000
370100      MOVE ML017-PC-DIFFER-AMT       TO ML044-PC-DIFFER-AMT       37010000
370200      MOVE ML017-PC-TOT-DOC-QTY      TO ML044-PC-TOT-DOC-QTY.     37020000
370300      MOVE ML017-PC-STORE-NBR        TO ML044-PC-STORE-NBR.       37030000
370400      MOVE ML017-PC-CATEG-CDE        TO ML044-PC-CATEG-CDE.       37040000
370500      MOVE ML017-PC-DOC-7-NBR        TO ML044-PC-DOC-7-NBR.       37050000
370600      MOVE ML017-PC-VENDOR-INHSE-NMBR TO                          37060000
370700           ML044-PC-VENDOR-INHSE-NMBR.                            37070000
370800      MOVE ML017-PC-LINE-NBR         TO ML044-PC-LINE-NBR.        37080000
370900      MOVE ML017-PC-SKU-DTA-ATTRIB   TO ML044-PC-SKU-DTA-ATTRIB.  37090000
371000      MOVE ML017-PC-DEPT-CLASS       TO ML044-PC-DEPT-CLASS.      37100000
371100      MOVE ML017-PC-MAJ-CLASS        TO ML044-PC-MAJ-CLASS.       37110000
371200      MOVE ML017-RGST-ID             TO ML044-RGST-ID.            37120000
371300      MOVE ML017-TRN-NBR             TO ML044-TRN-NBR.            37130000
371400      MOVE PV-STRT-TM                TO ML044-STRT-TM.            37140000
371500      MOVE PV-SLS-CORR-SEQ-NBR       TO ML044-SLS-CORR-SEQ-NBR.   37150000
371600      MOVE ML017-LNE-ITM-SEQ-NBR     TO ML044-LNE-ITM-SEQ-NBR.    37160000
371700      MOVE PV-LID-SEQ-NBR            TO ML044-LID-SEQ-NBR.        37170000
371800      MOVE ML017-GMM                 TO ML044-GMM.                37180000
371900      MOVE ML017-DMM                 TO ML044-DMM.                37190000
372000      MOVE ML017-BUYER               TO ML044-BUYER.              37200000
372100      MOVE ML017-PC-ENT-ID           TO ML044-PC-ENT-ID.          37210000
372200      MOVE ML017-ORIG-CLR-DTE        TO ML044-ORIG-CLR-DTE.       37220000
372300      MOVE ML017-MKDN-CDE            TO ML044-MKDN-CDE.           37230000
372400      MOVE ML017-ORIG-CLR-NONGRP-RTL TO ML044-ORIG-CLR-NONGRP-RTL.37240000
372500      MOVE ML017-PC-DA               TO ML044-PC-DA.              37250000
372600      MOVE PV-ISO-DB2-CC             TO ML044-PC-DTE-YEAR(1:2).   37260000
372700      MOVE PV-ISO-DB2-YY             TO ML044-PC-DTE-YEAR(3:2).   37270000
372800                                                                  37280000
372900******************************************************************37290000
373000 8190-WRITE-DATAWHSE-RECORD.                                      37300000
373100*     WRITE A DATAWHSE TRANSACTION RECORD.                        37310000
373200******************************************************************37320000
373300                                                                  37330000
373400     WRITE DATAWHSE-RECORD                                        37340000
373500         FROM ML044-PRICE-CHANGE-RECORD.                          37350000
ZX         INITIALIZE EPLID-LID-SEQ-NBR.                                37351000
373600                                                                  37360000
ZXC   ******************************************************************37360100
ZXC    8194-BUILD-CRITE-TRANS-RECORD.                                   37360200
ZXC   *     BUILD A CRITERIA RECORD FOR MUC                             37360300
ZXC   ******************************************************************37360400
ZXC        INITIALIZE WS-CRITE-TRANS-RECORD.                            37360500
ZXC        MOVE PV-PARTN-NBR         TO WS-CRITE-PARTN-NBR.             37360600
ZXC        MOVE PV-STR-NBR           TO WS-CRITE-STR-NBR.               37360700
ZXC        MOVE PV-RGST-ID           TO WS-CRITE-RGST-ID.               37360800
ZXC        MOVE PV-TRN-NBR           TO WS-CRITE-TRN-NBR.               37360900
ZXC        MOVE PV-SKU-NBR           TO WS-CRITE-SKU-NBR.               37361000
ZXC                                                                     37361100
ZXC   ******************************************************************37361200
ZXC    8194-WRITE-CRITE-TRANS-RECORD.                                   37361300
ZXC   *     WRITE A CRITERIA RECORD OUT FOR MUC                         37361400
ZXC   ******************************************************************37361500
ZXC                                                                     37361600
ZXTEMP*    DISPLAY WS-CRITE-TRANS-RECORD.                               37361700
ZXTEMP*    IF WS-TRAN-TYPE NOT = 'SALE'                                 37361800
ZXC        WRITE CRITE-TRANS-RECORD                                     37361900
ZXC            FROM WS-CRITE-TRANS-RECORD.                              37362021
ZXC                                                                     37362100
ZX    ******************************************************************37362200
ZX     8195-BUILD-DAY02-TRANS-RECORD.                                   37362300
ZX    *     BUILD A DAY 2 TRANSACTION RECORD.                           37365000
ZX    ******************************************************************37366000
ZX         INITIALIZE WS-DAY02-TRANS-RECORD.                            37367000
ZX         IF EPITM-SAL-RET-CDE = 'S'                                   37368000
ZX             MOVE 'SALE'           TO WS-TRAN-TYPE.                   37368100
ZX         IF EPITM-SAL-RET-CDE = 'R'                                   37368200
ZX             MOVE 'RETURN'         TO WS-TRAN-TYPE.                   37368300
ZX         IF EPITM-SAL-RET-CDE = 'A'                                   37368400
ZX             MOVE 'PRICE ADJ SALE' TO WS-TRAN-TYPE.                   37368500
ZX         IF EPITM-SAL-RET-CDE = 'B'                                   37368600
ZX             MOVE 'PRICE ADJ RET ' TO WS-TRAN-TYPE.                   37368700
ZX         MOVE EPTRN-SLS-DTE        TO WS-EPTRN-SLS-DTE.               37369000
ZX         MOVE EPTRN-TRN-DTE        TO WS-EPTRN-TRN-DTE.               37369100
ZX         IF PS-ORDER-NUMBER-FOUND-N                                   37369200
ZX             MOVE SPACES           TO WS-EPORD-ORD-NBR                37369300
ZX         ELSE                                                         37369400
ZX             MOVE EPORD-ORD-NBR-TEXT                                  37369517
ZX                                   TO WS-EPORD-ORD-NBR                37369600
ZX         END-IF.                                                      37369700
ZX         MOVE PV-PARTN-NBR         TO WS-EPITM-PARTN-NBR.             37369800
ZX         MOVE PV-STR-NBR           TO WS-EPITM-STR-NBR.               37369900
ZX         MOVE PV-RGST-ID           TO WS-EPITM-RGST-ID.               37370000
ZX         MOVE PV-TRN-NBR           TO WS-EPITM-TRN-NBR.               37370100
ZX         MOVE PV-STRT-TM           TO WS-EPITM-STRT-TM.               37370200
ZX         MOVE PV-SLS-CORR-SEQ-NBR  TO WS-EPITM-SLS-CORR-SEQ-NBR.      37370300
ZX         MOVE PV-LNE-ITM-SEQ-NBR   TO WS-EPITM-LNE-ITM-SEQ-NBR.       37370400
ZX         MOVE PV-REG-RTL-AMT       TO WS-REG-RTL-AMT.                 37370500
ZX         MOVE PV-ORIG-REG-RTL-AMT  TO WS-ORIG-REG-RTL-AMT.            37370600
ZX         MOVE PV-ORIG-SAL-TYP-CDE  TO WS-ORIG-SAL-TYP-CDE.            37370700
ZX         MOVE PV-SAL-TYP-CDE       TO WS-SAL-TYP-CDE.                 37370800
ZX         MOVE PV-CUST-CHRGD-AMTS   TO WS-CUST-CHRGD-AMT.              37371000
ZX         MOVE PV-NET-CHRGD-AMTS    TO WS-NET-CHRGD-AMT.               37371100
ZX         MOVE PV-ORIG-OURA-AMTS    TO WS-ORIG-OURA-AMT.               37371200
ZX         MOVE PV-ITM-STAT-CDE      TO WS-ITM-STAT-CDE.                37371300
ZX         MOVE PV-DEPT-NBR          TO WS-DEPT-NBR.                    37371400
ZX         MOVE PV-SKU-NBR           TO WS-EPITM-SKU-NBR.               37371500
ZX         IF EPLID-LID-AMT NOT NUMERIC                                 37371600
ZX             MOVE ZERO TO EPLID-LID-AMT                               37371700
ZX         END-IF.                                                      37371800
ZX         IF PV-DISC-TYPE-GROUP                                        37371900
ZX             MOVE WS-EPIGP-GP-AMT  TO WS-EPLID-LID-AMT                37372000
ZX             MOVE 'GRP'            TO WS-EPLID-LID-RSN-CDE            37372100
ZX         ELSE                                                         37372300
ZX             IF PV-DISC-TYPE-ASSOC                                    37372400
ZX                 MOVE EPEID-EMP-DISC-AMT                              37372500
ZX                                   TO WS-EPLID-LID-AMT                37372600
ZX                 MOVE '790'        TO WS-EPLID-LID-RSN-CDE            37372700
ZX             ELSE                                                     37372800
ZX                 MOVE EPLID-LID-AMT                                   37372900
ZX                                   TO WS-EPLID-LID-AMT                37373000
ZX                 MOVE EPLID-LID-RSN-CDE                               37373100
ZX                                   TO WS-EPLID-LID-RSN-CDE            37373200
ZX                 IF EPLID-LID-RSN-CDE = SPACES                        37373300
ZX                     MOVE 'MAN'    TO WS-EPLID-LID-RSN-CDE            37373400
ZX                 END-IF                                               37373500
ZX             END-IF                                                   37373600
ZX         END-IF.                                                      37373700
ZX         IF WS-DISC-TYPE = PC-OWNERSHIP-ADJ OR                        37373800
ZX            WS-DISC-TYPE = PC-OWN-RETRN-ADJ OR                        37373900
ZX            WS-DISC-TYPE = PC-PROMOTIONAL                             37374000
ZX             MOVE SPACES           TO WS-EPLID-LID-RSN-CDE            37374100
ZX             MOVE ZEROES           TO WS-EPLID-LID-AMT                37374200
ZX         END-IF.                                                      37374300
ZX         MOVE WS-DISC-TYPE         TO WS-DISC-TYPE-FILE.              37374400
ZX         MOVE WS-DISC-AMT          TO WS-DISC-AMT-FILE.               37374500
ZX         MOVE WS-MDWN-TYPE         TO WS-MDWN-TYPE-FILE.              37374600
ZX         MOVE WS-ISSUE-IND         TO WS-PROBLEM-IND.                 37374700
ZX         MOVE ML017-PC-OLD-PR-AMT  TO WS-OLD-PRICE-AMT.               37374800
ZX         MOVE ML017-PC-NEW-PR-AMT  TO WS-NEW-PRICE-AMT.               37375000
ZX         MOVE ML017-PC-DIFFER-AMT  TO WS-DIFF-PRICE-AMT.              37375100
                                                                        37375400
ZX    ******************************************************************37375500
ZX     8195-WRITE-DAY02-TRANS-RECORD.                                   37375600
ZX    *     WRITE A DAY 2 TRANSACTION RECORD.                           37375700
ZX    ******************************************************************37375800
ZX                                                                      37375900
ZXC   *    IF WS-MDWN-TYPE = 'MUC'                                      37376100
ZX         WRITE DAY02-TRANS-RECORD                                     37376200
ZX             FROM WS-DAY02-TRANS-RECORD.                              37376300
ZX         MOVE SPACE TO WS-ISSUE-IND.                                  37376400
ZX                                                                      37376500
ZX    ******************************************************************37376600
ZX     8196-WRITE-DAY02-HEADR-RECORD.                                   37376700
ZX    *     WRITE A DAY 2 HEADER      RECORD.                           37376800
ZX    ******************************************************************37376900
ZX                                                                      37377000
ZX         WRITE DAY02-TRANS-RECORD                                     37377100
ZX             FROM WS-DAY02-HEADR-RECORD.                              37377200
ZX                                                                      37377300
373700******************************************************************37378000
373800 8200-WRITE-DETAIL-LINE.                                          37380000
373900*     WRITE THE DETAIL LINES FOR THE REPORT.                      37390000
374000******************************************************************37400000
374100                                                                  37410000
374200     IF PV-LINE-COUNT GREATER THAN PC-LINE-LIMIT                  37420000
374300         MOVE ZERO TO PV-LINE-COUNT                               37430000
374400         ADD 3     TO PV-LINE-COUNT                               37440000
374500         PERFORM 8400-WRITE-HEADERS                               37450000
374600     END-IF.                                                      37460000
374700                                                                  37470000
374800     MOVE 2 TO PV-SPACE-CONTROL.                                  37480000
374900                                                                  37490000
375000     WRITE REPORT-LINE-OUT                                        37500000
375100         FROM DL-DETAIL-LINE AFTER ADVANCING PV-SPACE-CONTROL.    37510000
375200                                                                  37520000
375300     INITIALIZE DL-DETAIL-LINE.                                   37530000
375400                                                                  37540000
375500     ADD 2 TO PV-LINE-COUNT.                                      37550000
375600                                                                  37560000
375700******************************************************************37570000
375800 8300-WRITE-NON-OWNED.                                            37580000
375900*     WRITE THE NON OWNED MDSE MARKDOWNS DROPPED.                 37590000
376000******************************************************************37600000
376100                                                                  37610000
376200     MOVE 2 TO PV-SPACE-CONTROL.                                  37620000
376300                                                                  37630000
376400     WRITE REPORT-LINE-OUT                                        37640000
376500         FROM TD-TOTAL-DISPLAY-MESSAGE                            37650000
376600            AFTER ADVANCING PV-SPACE-CONTROL.                     37660000
376700                                                                  37670000
262807**   TRY FORCING PAGE BREAKS AT END OF SECTIONS                   37671031
262807**   DON'T WRITE HEADINGS AFTER FINAL SECTION (5)                 37672031
262807     MOVE 65 TO PV-LINE-COUNT.                                    37673031
262807**   ADD 2 TO PV-LINE-COUNT.                                      37674031
376700                                                                  37675029
376900     IF PV-LINE-COUNT GREATER THAN PC-LINE-LIMIT                  37690000
262807     AND PV-TOT-SUB < 5                                           37691031
377000         PERFORM 8400-WRITE-HEADERS                               37700000
377100         MOVE ZERO TO PV-LINE-COUNT                               37710000
377200                                                                  37720000
377300         ADD 3     TO PV-LINE-COUNT                               37730000
377400     END-IF.                                                      37740000
377500                                                                  37750000
377600******************************************************************37760000
377700 8400-WRITE-HEADERS.                                              37770000
377800*     WRITE THE REPORT HEADERS.                                   37780000
377900******************************************************************37790000
378000                                                                  37800000
378100     MOVE 1 TO PV-SPACE-CONTROL.                                  37810000
378200     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    37820000
378300                                                                  37830000
378400     WRITE REPORT-LINE-OUT                                        37840000
378500          FROM DP132O-STANDRD-HEADER-132-COLS                     37850000
378600             AFTER ADVANCING PAGE.                                37860000
378700     ADD 1 TO PV-PAGE-COUNT.                                      37870000
378800                                                                  37880000
378900     WRITE REPORT-LINE-OUT                                        37890000
379000         FROM HL-HEADER-LINE1                                     37900000
379100            AFTER ADVANCING PV-SPACE-CONTROL.                     37910000
379200                                                                  37920000
ZXTEMP*    IF PS-SKU-SPECIFIC-RUN-Y                                     37921000
ZX         WRITE REPORT-LINE-OUT                                        37930000
ZX             FROM H2-HEADER-LINE1-1                                   37940000
ZX                AFTER ADVANCING PV-SPACE-CONTROL.                     37950100
ZXTEMP*           AFTER ADVANCING PV-SPACE-CONTROL                      37950200
ZXTEMP*    ELSE                                                         37950300
ZXTEMP*    WRITE REPORT-LINE-OUT                                        37951000
ZXTEMP*        FROM HL-HEADER-LINE1-1                                   37952000
ZXTEMP*           AFTER ADVANCING PV-SPACE-CONTROL.                     37953000
379600                                                                  37960000
379700     MOVE 2 TO PV-SPACE-CONTROL.                                  37970000
379800                                                                  37980000
379900     WRITE REPORT-LINE-OUT                                        37990000
380000         FROM HL-HEADER-LINE2                                     38000000
380100            AFTER ADVANCING PV-SPACE-CONTROL.                     38010000
380200                                                                  38020000
380300     MOVE 1 TO PV-SPACE-CONTROL.                                  38030000
380400                                                                  38040000
380500     WRITE REPORT-LINE-OUT                                        38050000
380600         FROM HL-HEADER-LINE3                                     38060000
380700            AFTER ADVANCING PV-SPACE-CONTROL.                     38070000
380800                                                                  38080000
380900     ADD 7 TO PV-LINE-COUNT.                                      38090000
381000                                                                  38100000
381100******************************************************************38110000
381200* COMMIT DATABASE CHNAGES                                         38120000
381300******************************************************************38130000
381400 8999-COMMIT-PARA.                                                38140000
381500                                                                  38150000
381600     EXEC SQL                                                     38160000
381700         COMMIT                                                   38170000
381800     END-EXEC.                                                    38180000
381900                                                                  38190000
382000     EVALUATE TRUE                                                38200000
382100       WHEN SQLCODE = ZERO                                        38210000
382200         CONTINUE                                                 38220000
382300       WHEN SQLWARN0 NOT EQUAL SPACE                              38230000
382400       WHEN SQLCODE NOT EQUAL ZERO                                38240000
382500         MOVE '8999-COMMIT-PARA'  TO PV-PARAGRAPH-NAME            38250000
382600         SET AC-DB2-ERROR           TO TRUE                       38260000
382700         PERFORM 9999-ABEND                                       38270000
382800     END-EVALUATE.                                                38280000
382900                                                                  38290000
383000******************************************************************38300000
383100 9000-EOJ-ROUTINE.                                                38310000
383200*     CLOSE FILES.                                                38320000
383300******************************************************************38330000
383400                                                                  38340000
383500     CLOSE LEDGER-MARKDOWN-FILE                                   38350000
383600           LEDGER-MARKUP-FILE                                     38360000
383900           HOLD-LEDGER-MARKDOWN-FILE                              38390000
384000           HOLD-LEDGER-MARKUP-FILE                                38400000
384300           DATAWHSE-FILE                                          38430000
ZX               DAY02-TRANS-REPORT                                     38431000
ZXC              CRITE-TRANS-REPORT                                     38432000
384400           MERCH-LEDGER-REPORT.                                   38440000
384500                                                                  38450000
384600******************************************************************38460000
384700 9999-ABEND.                                                      38470000
384800*     DISPLAY ABEND INFO.                                         38480000
384900******************************************************************38490000
385000                                                                  38500000
385100     DISPLAY '************ SAKUT800 ABEND ************'.          38510000
385200     DISPLAY '**  PROGRAM   ** ' PC-CURRENT-PROGRAM-NAME.         38520000
385300     DISPLAY '**  PARAGRAPH ** ' PV-PARAGRAPH-NAME.               38530000
385400     DISPLAY '**  SQLCODE   ** ' SQLCODE.                         38540000
062118     DISPLAY '**  SQLSTATE  ** ' SQLSTATE.                        38540100
385500     DISPLAY '**  SLS DATE  ** ' EPTRN-SLS-DTE.                   38550000
385600     DISPLAY '**  STORE NBR ** ' EPTRN-STR-NBR.                   38560000
385700     DISPLAY '**  REGISTER  ** ' EPTRN-RGST-ID.                   38570000
385800     DISPLAY '**  TRAN      ** ' EPTRN-TRN-NBR.                   38580000
385900     DISPLAY '************ SAKUT800 ******************'.          38590000
386000                                                                  38600000
386100     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         38610000
386200                                                                  38620000
