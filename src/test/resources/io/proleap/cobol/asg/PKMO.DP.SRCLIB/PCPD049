000100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00010006
000200*   PCPD049                                                       00020006
000300*                                                                 00030006
000400*  THIS IS THE WORKING-STORAGE AREA FOR THE PROCEDURE DIVISION    00040006
000500*  MODULE TO USED TO GET CARTON COUNTS FOR A TRAILER OR ACTUAL    00050006
000600*  CARTONS ON A TRAILER                                           00060006
000700*  PROGRAM MUST ALSO INCLUDE THE FOLLOWING:                       00070006
000800*        PCWS049 (WORK FIELDS) (WORKING STORAGE)                  00080007
000900*        PCWS050 (CURSORS) (WORKING STORAGE)                      00090006
001000*                                                                 00100006
001100*  THE FOLLOWING DCLGENS MUST ALSO BE INCLUDED IN THE PROGRAM:    00110006
001200*       SUT_OTBND_LOC (SHIPPING UNIT LOCATION TABLE)              00120083
001300*       SUT_OTBND_CART (OUTBOUND CARTON TABLE)                    00130090
001400*       TSUCDOT (CARTON DIVERT/OUTBOUND TRIP ASSOCIATION TABLE)   00140006
001500*       TSUOBTR (OUTBOUND TRAILER TRIP TABLE)                     00150006
001600*       TSUOBTS (OUTBOUND TRAILER TRIP STATUS TABLE)              00160006
001700*       TSUOBSC (OUTBOUND TRAILER TRIP STATUS CODE DEFINITION)    00170006
001800*       TSUCRDV (CARTON DIVERT FROM CONVEYOR SYSTEM TABLE)        00180006
001900*       TCNDRST (DC DOOR TO STORE ASSOCIATION TABLE)              00190021
002000*       TCNDCDR (DC DOOR TABLE)                                   00200021
002100*                                                                 00210006
002200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00220006
002300                                                                  00230006
002400******************************************************************00240004
002500*                                                                *00250004
002600*  PROCESSES THE DOOR-STR-CSR PULLING BACK THE STORE NUMBERS     *00260004
002700*  ASSIGNED TO THE DOOR THAT ARE NOT THE SAME AS THE TRAILER     *00270004
002800*  DESTINATION.  THESE STORE NUMBERS WILL BE USED TO ELIMINATE   *00280004
002900*  SELECTING CARTONS MATCHING THOSE DESTINATIONS.  THIS WILL     *00290004
003000*  ALSO ALLOW YOU TO SELECT CARTONS THAT DO NOT HAVE A STORE     *00300004
003100*  ASSIGNMENT FOR THIS DOOR. (INCORRECTLY DIVERTED)              *00310004
003200*                                                                *00320004
003300******************************************************************00330004
003400 P3000-DOOR-STR-CSR.                                              00340004
003500                                                                  00350004
003600     PERFORM P7060-OPEN-DOOR-STR-CSR.                             00360004
003700                                                                  00370004
003800     IF  PC049-NOT-EOF-DOOR-STR                                   00380004
003900         PERFORM P7070-FETCH-DOOR-STR-CSR                         00390004
004000     END-IF.                                                      00400004
004100                                                                  00410004
004200     IF  PC049-NOT-EOF-DOOR-STR                                   00420004
004300         PERFORM P3010-PROCESS-DOOR-STR                           00430004
004400           UNTIL PC049-EOF-DOOR-STR                               00440004
004500              OR PC049-ERROR                                      00450004
004600     ELSE                                                         00460042
004700         MOVE  ZEROS              TO  PC049-PV-STORE-01           00470042
004800                                      PC049-PV-STORE-02           00480042
004900                                      PC049-PV-STORE-03           00490042
005000                                      PC049-PV-STORE-04           00500042
005100     END-IF.                                                      00510004
005200                                                                  00520004
005300     IF  PC049-NO-ERROR                                           00530026
005400         PERFORM P7080-CLOSE-DOOR-STR-CSR                         00540004
005500     END-IF.                                                      00550004
005600                                                                  00560004
005700                                                                  00570004
005800******************************************************************00580004
005900*                                                                *00590004
006000******************************************************************00600004
006100 P3010-PROCESS-DOOR-STR.                                          00610004
006200                                                                  00620004
006300     IF  PC049-DOOR-STR-CNT  =  1                                 00630004
006400         MOVE  CNDRST-STR-NBR     TO  PC049-PV-STORE-01           00640004
006500                                      PC049-PV-STORE-02           00650027
006600                                      PC049-PV-STORE-03           00660027
006700                                      PC049-PV-STORE-04           00670027
006800     ELSE                                                         00680004
006900     IF  PC049-DOOR-STR-CNT  =  2                                 00690004
007000         MOVE  CNDRST-STR-NBR     TO  PC049-PV-STORE-02           00700004
007100                                      PC049-PV-STORE-03           00710027
007200                                      PC049-PV-STORE-04           00720027
007300     ELSE                                                         00730004
007400     IF  PC049-DOOR-STR-CNT  =  3                                 00740004
007500         MOVE  CNDRST-STR-NBR     TO  PC049-PV-STORE-03           00750004
007600                                      PC049-PV-STORE-04           00760027
007700     ELSE                                                         00770004
007800         MOVE  CNDRST-STR-NBR     TO  PC049-PV-STORE-04           00780004
007900     END-IF                                                       00790004
008000     END-IF                                                       00800004
008100     END-IF.                                                      00810004
008200                                                                  00820004
008300     PERFORM P7070-FETCH-DOOR-STR-CSR.                            00830004
008400                                                                  00840004
008500     IF  PC049-DOOR-STR-CNT  >  4                                 00850004
008600         SET  PC049-EOF-DOOR-STR  TO TRUE                         00860004
008700     END-IF.                                                      00870004
008800                                                                  00880004
008900                                                                  00890004
009000******************************************************************00900004
009100*                                                                *00910004
009200*  PROCESSES THE ALL-DOOR-STR-CSR PULLING BACK THE STORE NUMBERS *00920004
009300*  ASSIGNED TO THE DOOR THAT ARE NOT THE SAME AS THE TRAILER     *00930004
009400*  DESTINATION.  THESE STORE NUMBERS WILL BE USED TO ELIMINATE   *00940004
009500*  SELECTING CARTONS MATCHING THOSE DESTINATIONS.  THIS WILL     *00950004
009600*  ALLOW YOU TO SELECT ONLY INCORRECTLY DIVERTED CARTONS.        *00960004
009700*                                                                *00970004
009800******************************************************************00980004
009900 P3020-ALL-DOOR-STR-CSR.                                          00990004
010000                                                                  01000004
010100     PERFORM P7090-OPEN-ALL-DOOR-STR-CSR.                         01010004
010200                                                                  01020004
010300     IF  PC049-NOT-EOF-ALL-DOOR-STR                               01030068
010400         PERFORM P7100-FETCH-ALL-DOOR-STR-CSR                     01040004
010500     END-IF.                                                      01050004
010600                                                                  01060004
010700     IF  PC049-NOT-EOF-DOOR-STR                                   01070004
010800         PERFORM P3030-PROCESS-ALL-DOOR-STR                       01080004
010900           UNTIL PC049-EOF-ALL-DOOR-STR                           01090070
011000              OR PC049-ERROR                                      01100004
011100     END-IF.                                                      01110004
011200                                                                  01120004
011300     IF  PC049-NO-ERROR                                           01130026
011400         PERFORM P7110-CLOSE-ALL-DOOR-STR-CSR                     01140004
011500     END-IF.                                                      01150004
011600                                                                  01160004
011700                                                                  01170004
011800******************************************************************01180004
011900*                                                                *01190004
012000******************************************************************01200004
012100 P3030-PROCESS-ALL-DOOR-STR.                                      01210004
012200                                                                  01220004
012300     IF  PC049-DOOR-STR-CNT  =  1                                 01230004
012400         MOVE  CNDRST-STR-NBR     TO  PC049-PV-STORE-01           01240004
012500                                      PC049-PV-STORE-02           01250028
012600                                      PC049-PV-STORE-03           01260028
012700                                      PC049-PV-STORE-04           01270028
012800     ELSE                                                         01280004
012900     IF  PC049-DOOR-STR-CNT  =  2                                 01290004
013000         MOVE  CNDRST-STR-NBR     TO  PC049-PV-STORE-02           01300004
013100                                      PC049-PV-STORE-03           01310028
013200                                      PC049-PV-STORE-04           01320028
013300     ELSE                                                         01330004
013400     IF  PC049-DOOR-STR-CNT  =  3                                 01340004
013500         MOVE  CNDRST-STR-NBR     TO  PC049-PV-STORE-03           01350004
013600                                      PC049-PV-STORE-04           01360028
013700     ELSE                                                         01370004
013800         MOVE  CNDRST-STR-NBR     TO  PC049-PV-STORE-04           01380004
013900     END-IF                                                       01390004
014000     END-IF                                                       01400004
014100     END-IF.                                                      01410004
014200                                                                  01420004
014300     PERFORM P7100-FETCH-ALL-DOOR-STR-CSR.                        01430004
014400                                                                  01440004
014500     IF  PC049-DOOR-STR-CNT  >  4                                 01450004
014600         SET  PC049-EOF-ALL-DOOR-STR  TO TRUE                     01460070
014700     END-IF.                                                      01470004
014800                                                                  01480004
014900                                                                  01490004
015000******************************************************************01500004
015100*                                                                *01510004
015200*  GET MAXIMUM AND MINIMUM DIVERT ON TIMESTAMP FOR A TRAILER     *01520004
015300*  INCLUDING CARTONS ASSUMED ONTO TRAILER                        *01530004
015400*  END TIMESTAMP = 9'S                                           *01540004
015500*                                                                *01550004
015600******************************************************************01560004
015700 P4000-STRT-END-DVRT.                                             01570004
015800                                                                  01580004
015900     EXEC SQL                                                     01590004
016000          SELECT  MIN(STRT_DIVERT_TMST)                           01600009
016100                 ,MAX(END_DIVERT_TMST)                            01610011
016200            INTO  :PC049-DK-START-TMST                            01620012
016300                 ,:PC049-DK-END-TMST                              01630012
016400            FROM  TSUCDOT                                         01640004
016500           WHERE  OTBND_TRIP_ID    = :PC049-DK-OTBND-TRIP-ID      01650004
016600     END-EXEC.                                                    01660004
016700                                                                  01670004
016800     EVALUATE TRUE                                                01680004
016900         WHEN SQLCODE = ZEROS                                     01690004
017000              SET PC049-DIVERT-CUTOFFS-YES TO TRUE                01700034
017100         WHEN SQLCODE = -305                                      01710034
017200              SET PC049-DIVERT-CUTOFFS-NO  TO TRUE                01720034
017300                                                                  01730004
017400         WHEN SQLCODE = -904                                      01740004
017500         WHEN SQLCODE = -911                                      01750004
017600         WHEN SQLCODE = -913                                      01760004
017700              MOVE 'P4000-STRT-END-DVRT         '                 01770004
017800                                 TO PC049-ABEND-PARAGRAPH         01780004
017900              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         01790004
018000                                    PC049-SQL-RETURN-CD           01800004
018100              SET  PC049-ERROR   TO TRUE                          01810004
018200         WHEN OTHER                                               01820004
018300              MOVE 'P4000-STRT-END-DVRT         '                 01830004
018400                                 TO PC049-ABEND-PARAGRAPH         01840004
018500              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         01850004
018600                                  PC049-SQL-RETURN-CD             01860004
018700              SET  PC049-ERROR   TO TRUE                          01870004
018800     END-EVALUATE.                                                01880004
018900                                                                  01890004
019000                                                                  01900004
019100*LMM ADD                                                          01910099
019200******************************************************************01920098
019300*                                                                *01930098
019400*  GET MAXIMUM AND MINIMUM DIVERT ON TIMESTAMP FOR A TRAILER     *01940098
019500*  INCLUDING CARTONS ASSUMED ONTO TRAILER BASED ON WHEN THE      *01950098
019600*  AUDIT WAS STARTED.                                            *01960098
019700*  END TIMESTAMP = 9'S                                           *01970098
019800*                                                                *01980098
019900******************************************************************01990098
020000 P4000-AUD-STRT-END-DVRT.                                         02000098
020100                                                                  02010098
020200     EXEC SQL                                                     02020098
020300          SELECT  MIN(STRT_DIVERT_TMST)                           02030098
020400                 ,MAX(END_DIVERT_TMST)                            02040098
020500            INTO  :PC049-DK-START-TMST                            02050098
020600                 ,:PC049-DK-END-TMST                              02060098
020700            FROM  TSUCDOT                                         02070098
020800           WHERE  OTBND_TRIP_ID    = :PC049-DK-OTBND-TRIP-ID      02080098
020900             AND  END_SCN_TMST    <= :PC049-DK-AUD-STRT-TMST      02090099
021000     END-EXEC.                                                    02100098
021100                                                                  02110098
021200     EVALUATE TRUE                                                02120098
021300         WHEN SQLCODE = ZEROS                                     02130098
021400              SET PC049-DIVERT-CUTOFFS-YES TO TRUE                02140098
021500         WHEN SQLCODE = -305                                      02150098
021600              SET PC049-DIVERT-CUTOFFS-NO  TO TRUE                02160098
021700                                                                  02170098
021800         WHEN SQLCODE = -904                                      02180098
021900         WHEN SQLCODE = -911                                      02190098
022000         WHEN SQLCODE = -913                                      02200098
022100              MOVE 'P4000-STRT-END-DVRT         '                 02210098
022200                                 TO PC049-ABEND-PARAGRAPH         02220098
022300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         02230098
022400                                    PC049-SQL-RETURN-CD           02240098
022500              SET  PC049-ERROR   TO TRUE                          02250098
022600         WHEN OTHER                                               02260098
022700              MOVE 'P4000-STRT-END-DVRT         '                 02270098
022800                                 TO PC049-ABEND-PARAGRAPH         02280098
022900              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         02290098
023000                                  PC049-SQL-RETURN-CD             02300098
023100              SET  PC049-ERROR   TO TRUE                          02310098
023200     END-EVALUATE.                                                02320098
023300                                                                  02330098
023400                                                                  02340098
023500******************************************************************02350098
023600*                                                                *02360098
023700*  GET MAXIMUM AND MINIMUM DIVERT ON TIMESTAMP FOR A TRAILER     *02370098
023800*  EXCLUDING CARTONS ASSUMED ONTO TRAILER                        *02380098
023900*  END TIMESTAMP = 9'S                                           *02390098
024000*                                                                *02400098
024100******************************************************************02410098
024200 P4010-ACTL-STRT-END-DVRT.                                        02420098
024300                                                                  02430098
024400     EXEC SQL                                                     02440098
024500          SELECT  MIN(STRT_DIVERT_TMST)                           02450098
024600                 ,MAX(END_DIVERT_TMST)                            02460098
024700            INTO  :PC049-DK-START-TMST                            02470098
024800                 ,:PC049-DK-END-TMST                              02480098
024900            FROM  TSUCDOT                                         02490098
025000           WHERE  OTBND_TRIP_ID    = :PC049-DK-OTBND-TRIP-ID      02500098
025100             AND  DOOR_ID          = :PC049-DK-DOOR-ID            02510098
025200             AND NOT END_SCN_TMST  = :PC049-PC-DEFAULT-TMST       02520098
025300     END-EXEC.                                                    02530098
025400                                                                  02540098
025500     EVALUATE TRUE                                                02550098
025600         WHEN SQLCODE = ZEROS                                     02560098
025700              CONTINUE                                            02570098
025800                                                                  02580098
025900         WHEN SQLCODE = -904                                      02590098
026000         WHEN SQLCODE = -911                                      02600098
026100         WHEN SQLCODE = -913                                      02610098
026200              MOVE 'P4010-ACTL-STRT-END-DVRT    '                 02620098
026300                                 TO PC049-ABEND-PARAGRAPH         02630098
026400              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         02640098
026500                                    PC049-SQL-RETURN-CD           02650098
026600              SET  PC049-ERROR   TO TRUE                          02660098
026700         WHEN OTHER                                               02670098
026800              MOVE 'P4010-ACTL-STRT-END-DVRT    '                 02680098
026900                                 TO PC049-ABEND-PARAGRAPH         02690098
027000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         02700098
027100                                  PC049-SQL-RETURN-CD             02710098
027200              SET  PC049-ERROR   TO TRUE                          02720098
027300     END-EVALUATE.                                                02730098
027400                                                                  02740098
027500                                                                  02750098
027600******************************************************************02760098
027700*                                                                *02770098
027800*  GET COUNT OF CARTONS MANUALLY SCANNED ONTO A GIVEN TRAILER    *02780098
027900*                                                                *02790098
028000******************************************************************02800098
028100 P4000-CNT-SCAN-CRTN.                                             02810098
028200                                                                  02820098
028300     EXEC SQL                                                     02830098
028400          SELECT  COUNT(*)                                        02840098
028500            INTO  :PC049-PV-SCAN-COUNT                            02850098
028600            FROM  SUT_OTBND_LOC                                   02860098
028700           WHERE  OTBND_TRIP_ID  = :PC049-DK-OTBND-TRIP-ID        02870098
028800             AND  SCN_CDE    = 'SHON'                             02880098
028900             AND  ACTV_CDE   = 'A'                                02890098
029000     END-EXEC.                                                    02900098
029100                                                                  02910098
029200     EVALUATE TRUE                                                02920098
029300         WHEN SQLCODE = ZEROS                                     02930098
029400              CONTINUE                                            02940098
029500                                                                  02950098
029600         WHEN SQLCODE = -904                                      02960098
029700         WHEN SQLCODE = -911                                      02970098
029800         WHEN SQLCODE = -913                                      02980098
029900              MOVE 'P4000-CNT-SCAN-CRTN         '                 02990098
030000                                 TO PC049-ABEND-PARAGRAPH         03000098
030100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         03010098
030200                                    PC049-SQL-RETURN-CD           03020098
030300              SET  PC049-ERROR   TO TRUE                          03030098
030400         WHEN OTHER                                               03040098
030500              MOVE 'P4000-CNT-SCAN-CRTN         '                 03050098
030600                                 TO PC049-ABEND-PARAGRAPH         03060098
030700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         03070098
030800                                  PC049-SQL-RETURN-CD             03080098
030900              SET  PC049-ERROR   TO TRUE                          03090098
031000     END-EVALUATE.                                                03100098
031100                                                                  03110098
031200                                                                  03120098
031300******************************************************************03130098
031400*                                                                *03140098
031500*  GET COUNT OF CARTONS DIVERTED AND LOADED ONTO A SHUTTLE OR    *03150098
031600*  STORAGE TRAILER                                               *03160098
031700*                                                                *03170098
031800******************************************************************03180098
031900 P4100-CNT-DVRT-CRTN-SHTL.                                        03190098
032000                                                                  03200098
032100     EXEC SQL                                                     03210098
032200          SELECT  COUNT(*)                                        03220098
032300            INTO  :PC049-PV-DVRT-COUNT                            03230098
032400            FROM  TSUCRDV A                                       03240098
032500                , TSUCDOT B                                       03250098
032600           WHERE  A.DIVERT_TMST   >=  :PC049-DK-START-TMST        03260098
032700             AND  A.DIVERT_TMST   <=  :PC049-DK-END-TMST          03270098
032800             AND  A.OPER_UNT_ID    =  :PC049-DK-OPER-UNT-ID       03280098
032900             AND  ACTV_CDE         =  'A'                         03290098
033000             AND  A.OPER_UNT_ID    =   B.OPER_UNT_ID              03300098
033100             AND  B.OTBND_TRIP_ID  =  :PC049-DK-OTBND-TRIP-ID     03310098
033200             AND  A.DIVERT_TMST   >=   B.STRT_DIVERT_TMST         03320098
033300             AND  A.DIVERT_TMST   <=   B.END_DIVERT_TMST          03330098
033400             AND  A.DOOR_ID        =   B.DOOR_ID                  03340098
033410             AND  A.DIVERT_TMST    =                              03341099
033420                    (SELECT MAX(C.DIVERT_TMST)                    03342099
033430                FROM  TSUCRDV C                                   03343099
033440                WHERE A.SHIPT_UNT_ID = C.SHIPT_UNT_ID)            03344099
033500     END-EXEC.                                                    03350098
033600                                                                  03360098
033700     EVALUATE TRUE                                                03370098
033800         WHEN SQLCODE = ZEROS                                     03380098
033900              CONTINUE                                            03390098
034000                                                                  03400098
034100         WHEN SQLCODE = -904                                      03410098
034200         WHEN SQLCODE = -911                                      03420098
034300         WHEN SQLCODE = -913                                      03430098
034400              MOVE 'P4100-CNT-DVRT-CRTN-SHTL    '                 03440098
034500                                 TO PC049-ABEND-PARAGRAPH         03450098
034600              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         03460098
034700                                    PC049-SQL-RETURN-CD           03470098
034800              SET  PC049-ERROR   TO TRUE                          03480098
034900         WHEN OTHER                                               03490098
035000              MOVE 'P4100-CNT-DVRT-CRTN-SHTL    '                 03500098
035100                                 TO PC049-ABEND-PARAGRAPH         03510098
035200              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         03520098
035300                                  PC049-SQL-RETURN-CD             03530098
035400              SET  PC049-ERROR   TO TRUE                          03540098
035500     END-EVALUATE.                                                03550098
035600                                                                  03560098
035700******************************************************************03570098
035800*                                                                *03580098
035900*  GET COUNT OF CARTONS DIVERTED AND LOADED ONTO A SHIPPING      *03590098
036000*  TRAILER                                                       *03600098
036100*                                                                *03610098
036200******************************************************************03620098
036300 P4110-CNT-DVRT-CRTN-SHIP.                                        03630098
036400                                                                  03640098
036500     EXEC SQL                                                     03650098
036600          SELECT  COUNT(*)                                        03660098
036700            INTO  :PC049-PV-DVRT-COUNT                            03670098
036800            FROM  TSUCRDV A                                       03680098
036900                , TSUCDOT B                                       03690098
037000           WHERE  A.DIVERT_TMST   >=  :PC049-DK-START-TMST        03700098
037100             AND  A.DIVERT_TMST   <=  :PC049-DK-END-TMST          03710098
037200             AND  A.OPER_UNT_ID    =  :PC049-DK-OPER-UNT-ID       03720098
037300             AND  ACTV_CDE         =  'A'                         03730098
037400             AND  A.OPER_UNT_ID    =   B.OPER_UNT_ID              03740098
037500             AND  B.OTBND_TRIP_ID  =  :PC049-DK-OTBND-TRIP-ID     03750098
037600             AND  A.DIVERT_TMST   >=   B.STRT_DIVERT_TMST         03760098
037700             AND  A.DIVERT_TMST   <=   B.END_DIVERT_TMST          03770098
037800             AND  A.DOOR_ID        =   B.DOOR_ID                  03780098
037900             AND  NOT A.DEST_OPER_UNT_ID                          03790098
038000                                  IN (:PC049-PV-STORE-01          03800098
038100                                     ,:PC049-PV-STORE-02          03810098
038200                                     ,:PC049-PV-STORE-03          03820098
038300                                     ,:PC049-PV-STORE-04)         03830098
038310             AND  A.DIVERT_TMST    =                              03831099
038320                    (SELECT MAX(C.DIVERT_TMST)                    03832099
038330                FROM  TSUCRDV C                                   03833099
038340                WHERE A.SHIPT_UNT_ID = C.SHIPT_UNT_ID)            03834099
038400     END-EXEC.                                                    03840098
038500                                                                  03850098
038600     EVALUATE TRUE                                                03860098
038700         WHEN SQLCODE = ZEROS                                     03870098
038800              CONTINUE                                            03880098
038900                                                                  03890098
039000         WHEN SQLCODE = -904                                      03900098
039100         WHEN SQLCODE = -911                                      03910098
039200         WHEN SQLCODE = -913                                      03920098
039300              MOVE 'P4110-CNT-DVRT-CRTN-SHIP    '                 03930098
039400                                 TO PC049-ABEND-PARAGRAPH         03940098
039500              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         03950098
039600                                    PC049-SQL-RETURN-CD           03960098
039700              SET  PC049-ERROR   TO TRUE                          03970098
039800         WHEN OTHER                                               03980098
039900              MOVE 'P4110-CNT-DVRT-CRTN-SHIP    '                 03990098
040000                                 TO PC049-ABEND-PARAGRAPH         04000098
040100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         04010098
040200                                    PC049-SQL-RETURN-CD           04020098
040300              SET  PC049-ERROR   TO TRUE                          04030098
040400     END-EVALUATE.                                                04040098
040500                                                                  04050098
040600                                                                  04060098
040700                                                                  04070098
040800******************************************************************04080098
040900*                                                                *04090098
041000*  GET COUNT OF CARTONS DIVERTED AND LOADED ONTO A SHIPPING      *04100098
041100*  TRAILER THAT DO NOT HAVE ANY CARTON DATA BEHIND THEM          *04110098
041200*   (NO SHUUPC)                                                  *04120098
041300*                                                                *04130098
041400******************************************************************04140098
041500 P4120-CNT-DVRT-NO-DATA-SHIP.                                     04150098
041600                                                                  04160098
041700     EXEC SQL                                                     04170098
041800          SELECT  COUNT(*)                                        04180098
041900            INTO  :PC049-PV-NO-DATA-CNT                           04190098
042000            FROM  TSUCRDV A                                       04200098
042100                , TSUCDOT B                                       04210098
042200           WHERE  A.DIVERT_TMST   >=  :PC049-DK-START-TMST        04220098
042300             AND  A.DIVERT_TMST   <=  :PC049-DK-END-TMST          04230098
042400             AND  A.OPER_UNT_ID    =  :PC049-DK-OPER-UNT-ID       04240098
042500             AND  A.ACTV_CDE        =  'A'                        04250098
042600             AND  A.OPER_UNT_ID    =   B.OPER_UNT_ID              04260098
042700             AND  B.OTBND_TRIP_ID  =  :PC049-DK-OTBND-TRIP-ID     04270098
042800             AND  A.DIVERT_TMST   >=   B.STRT_DIVERT_TMST         04280098
042900             AND  A.DIVERT_TMST   <=   B.END_DIVERT_TMST          04290098
043000             AND  A.DOOR_ID        =   B.DOOR_ID                  04300098
043100             AND  NOT A.DEST_OPER_UNT_ID                          04310098
043200                                  IN (:PC049-PV-STORE-01          04320098
043300                                     ,:PC049-PV-STORE-02          04330098
043400                                     ,:PC049-PV-STORE-03          04340098
043500                                     ,:PC049-PV-STORE-04)         04350098
043600             AND  A.SHIPT_UNT_ID  NOT IN                          04360098
043700                 (SELECT D.SHIPT_UNT_ID                           04370098
043800                    FROM  SUT_OTBND_UPC D                         04380098
043900                   WHERE  A.SHIPT_UNT_ID   =  D.SHIPT_UNT_ID)     04390098
044000     END-EXEC.                                                    04400098
044100                                                                  04410098
044200     EVALUATE TRUE                                                04420098
044300         WHEN SQLCODE = ZEROS                                     04430098
044400              CONTINUE                                            04440098
044500                                                                  04450098
044600         WHEN SQLCODE = -904                                      04460098
044700         WHEN SQLCODE = -911                                      04470098
044800         WHEN SQLCODE = -913                                      04480098
044900              MOVE 'P4120-CNT-DVRT-NO-DATA-SHIP '                 04490098
045000                                 TO PC049-ABEND-PARAGRAPH         04500098
045100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         04510098
045200                                    PC049-SQL-RETURN-CD           04520098
045300              SET  PC049-ERROR   TO TRUE                          04530098
045400         WHEN OTHER                                               04540098
045500              MOVE 'P4120-CNT-DVRT-NO-DATA-SHIP '                 04550098
045600                                 TO PC049-ABEND-PARAGRAPH         04560098
045700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         04570098
045800                                    PC049-SQL-RETURN-CD           04580098
045900              SET  PC049-ERROR   TO TRUE                          04590098
046000     END-EVALUATE.                                                04600098
046100                                                                  04610098
046200                                                                  04620098
046300******************************************************************04630098
046400*                                                                *04640098
046500*  GET COUNT OF CARTONS DIVERTED AND LOADED ONTO A SHUTTLE OR    *04650098
046600*  STORAGE TRAILER THAT DO NOT HAVE ANY CARTON DATA BEHIND THEM  *04660098
046700*   (NO SHUUPC)                                                  *04670098
046800*                                                                *04680098
046900******************************************************************04690098
047000 P4130-CNT-DVRT-NO-DATA-SHTL.                                     04700098
047100                                                                  04710098
047200     EXEC SQL                                                     04720098
047300          SELECT  COUNT(*)                                        04730098
047400            INTO  :PC049-PV-NO-DATA-CNT                           04740098
047500            FROM  TSUCRDV A                                       04750098
047600                , TSUCDOT B                                       04760098
047700           WHERE  A.DIVERT_TMST   >=  :PC049-DK-START-TMST        04770098
047800             AND  A.DIVERT_TMST   <=  :PC049-DK-END-TMST          04780098
047900             AND  A.OPER_UNT_ID    =  :PC049-DK-OPER-UNT-ID       04790098
048000             AND  ACTV_CDE         =  'A'                         04800098
048100             AND  A.OPER_UNT_ID    =   B.OPER_UNT_ID              04810098
048200             AND  B.OTBND_TRIP_ID  =  :PC049-DK-OTBND-TRIP-ID     04820098
048300             AND  A.DIVERT_TMST   >=   B.STRT_DIVERT_TMST         04830098
048400             AND  A.DIVERT_TMST   <=   B.END_DIVERT_TMST          04840098
048500             AND  A.DOOR_ID        =   B.DOOR_ID                  04850098
048600             AND  A.SHIPT_UNT_ID  NOT IN                          04860098
048700                 (SELECT D.SHIPT_UNT_ID                           04870098
048800                    FROM  SUT_OTBND_UPC D                         04880098
048900                   WHERE  A.SHIPT_UNT_ID   =  D.SHIPT_UNT_ID)     04890098
049000     END-EXEC.                                                    04900098
049100                                                                  04910098
049200     EVALUATE TRUE                                                04920098
049300         WHEN SQLCODE = ZEROS                                     04930098
049400              CONTINUE                                            04940098
049500                                                                  04950098
049600         WHEN SQLCODE = -904                                      04960098
049700         WHEN SQLCODE = -911                                      04970098
049800         WHEN SQLCODE = -913                                      04980098
049900              MOVE 'P4130-CNT-DVRT-NO-DATA-SHTL '                 04990098
050000                                 TO PC049-ABEND-PARAGRAPH         05000098
050100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         05010098
050200                                    PC049-SQL-RETURN-CD           05020098
050300              SET  PC049-ERROR   TO TRUE                          05030098
050400         WHEN OTHER                                               05040098
050500              MOVE 'P4130-CNT-DVRT-NO-DATA-SHTL '                 05050098
050600                                 TO PC049-ABEND-PARAGRAPH         05060098
050700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         05070098
050800                                  PC049-SQL-RETURN-CD             05080098
050900              SET  PC049-ERROR   TO TRUE                          05090098
051000     END-EVALUATE.                                                05100098
051100                                                                  05110098
051200                                                                  05120098
051300******************************************************************05130098
051400*                                                                *05140098
051500*  GET COUNT OF MISDIRECTED CARTONS LOADED ONTO A SHIPPING       *05150098
051600*  TRAILER                                                       *05160098
051700*                                                                *05170098
051800******************************************************************05180098
051900 P4140-CNT-MISD-CRTN-SHIP.                                        05190098
052000                                                                  05200098
052100     EXEC SQL                                                     05210098
052200          SELECT  COUNT(*)                                        05220098
052300            INTO  :PC049-PV-DVRT-COUNT                            05230098
052400            FROM  TSUCRDV A                                       05240098
052500                , TSUCDOT B                                       05250098
052600           WHERE  A.DIVERT_TMST   >=  :PC049-DK-START-TMST        05260098
052700             AND  A.DIVERT_TMST   <=  :PC049-DK-END-TMST          05270098
052800             AND  A.OPER_UNT_ID    =  :PC049-DK-OPER-UNT-ID       05280098
052900             AND  ACTV_CDE         =  'A'                         05290098
053000             AND  A.OPER_UNT_ID    =   B.OPER_UNT_ID              05300098
053100             AND  B.OTBND_TRIP_ID  =  :PC049-DK-OTBND-TRIP-ID     05310098
053200             AND  A.DIVERT_TMST   >=   B.STRT_DIVERT_TMST         05320098
053300             AND  A.DIVERT_TMST   <=   B.END_DIVERT_TMST          05330098
053400             AND  A.DOOR_ID        =   B.DOOR_ID                  05340098
053500             AND  NOT A.DEST_OPER_UNT_ID                          05350098
053600                                  IN (:PC049-DK-TRLR-DEST         05360098
053700                                     ,:PC049-PV-STORE-01          05370098
053800                                     ,:PC049-PV-STORE-02          05380098
053900                                     ,:PC049-PV-STORE-03          05390098
054000                                     ,:PC049-PV-STORE-04)         05400098
054010             AND  A.DIVERT_TMST    =                              05401099
054020                    (SELECT MAX(C.DIVERT_TMST)                    05402099
054030                FROM  TSUCRDV C                                   05403099
054040                WHERE A.SHIPT_UNT_ID = C.SHIPT_UNT_ID)            05404099
054100     END-EXEC.                                                    05410098
054200                                                                  05420098
054300     EVALUATE TRUE                                                05430098
054400         WHEN SQLCODE = ZEROS                                     05440098
054500              CONTINUE                                            05450098
054600                                                                  05460098
054700         WHEN SQLCODE = -904                                      05470098
054800         WHEN SQLCODE = -911                                      05480098
054900         WHEN SQLCODE = -913                                      05490098
055000              MOVE 'P4140-CNT-MISD-CRTN-SHIP    '                 05500098
055100                                 TO PC049-ABEND-PARAGRAPH         05510098
055200              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         05520098
055300                                    PC049-SQL-RETURN-CD           05530098
055400              SET  PC049-ERROR   TO TRUE                          05540098
055500         WHEN OTHER                                               05550098
055600              MOVE 'P4140-CNT-MISD-CRTN-SHIP    '                 05560098
055700                                 TO PC049-ABEND-PARAGRAPH         05570098
055800              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         05580098
055900                                    PC049-SQL-RETURN-CD           05590098
056000              SET  PC049-ERROR   TO TRUE                          05600098
056100     END-EVALUATE.                                                05610098
056200                                                                  05620098
056300                                                                  05630098
056400                                                                  05640098
056500                                                                  05650098
056600******************************************************************05660098
056700*                                                                *05670098
056800* OPEN CURSOR TO SELECT ALL CARTONS SCANNED ONTO A GIVEN TRAILER *05680098
056900*                                                                *05690098
057000******************************************************************05700098
057100 P7000-OPEN-SCAN-CRTN-CSR.                                        05710098
057200                                                                  05720098
057300     EXEC SQL                                                     05730098
057400         OPEN SCAN-ON-CRTN-CSR                                    05740098
057500     END-EXEC.                                                    05750098
057600                                                                  05760098
057700     EVALUATE TRUE                                                05770098
057800         WHEN SQLCODE = ZEROS                                     05780098
057900              SET PC049-NOT-EOF-SCAN-CRTN TO TRUE                 05790098
058000                                                                  05800098
058100         WHEN SQLCODE = -904                                      05810098
058200         WHEN SQLCODE = -911                                      05820098
058300         WHEN SQLCODE = -913                                      05830098
058400              MOVE 'P7000-OPEN-SCAN-CRTN-CSR   '                  05840098
058500                                 TO PC049-ABEND-PARAGRAPH         05850098
058600              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         05860098
058700                                    PC049-SQL-RETURN-CD           05870098
058800              SET  PC049-ERROR   TO TRUE                          05880098
058900                                                                  05890098
059000         WHEN OTHER                                               05900098
059100              MOVE 'P7000-OPEN-SCAN-CRTN-CSR   '                  05910098
059200                                 TO PC049-ABEND-PARAGRAPH         05920098
059300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         05930098
059400                                    PC049-SQL-RETURN-CD           05940098
059500              SET  PC049-ERROR   TO TRUE                          05950098
059600     END-EVALUATE.                                                05960098
059700                                                                  05970098
059800                                                                  05980098
059900******************************************************************05990098
060000*                                                                *06000098
060100* FETCH CURSOR TO SELECT ALL CARTONS SCANNED ONTO A TRAILER      *06010098
060200*                                                                *06020098
060300******************************************************************06030098
060400 P7010-FETCH-SCAN-CRTN-CSR.                                       06040098
060500                                                                  06050098
060600     EXEC SQL                                                     06060098
060700          FETCH SCAN-ON-CRTN-CSR                                  06070098
060800          INTO  :SUT00027-SHIPT-UNT-ID                            06080098
060900               ,:SUT00027-LOC-NBR                                 06090098
061000**             ,:SUT00027-FCLTY-ID                                06100098
061100               ,:SUT00027-SCN-CDE                                 06110098
061200               ,:SUT00027-CRE-USR-ID                              06120098
061300               ,:SUT00027-CRE-TMST                                06130098
061400               ,:SUT00027-OTBND-TRIP-ID                           06140098
061500**             ,:SUT00027-PRTR-TYP-CDE                            06150098
061600**             ,:SUT00027-LBL-PRT-BTCH-ID                         06160098
061700               ,:SUT00027-ACTV-CDE                                06170098
061800     END-EXEC.                                                    06180098
061900                                                                  06190098
062000     EVALUATE TRUE                                                06200098
062100       WHEN SQLCODE = ZEROS                                       06210098
062200            ADD  1  TO  PC049-SCAN-CRTN-CNT                       06220098
062300                                                                  06230098
062400       WHEN SQLCODE = +100                                        06240098
062500            SET PC049-EOF-SCAN-CRTN TO TRUE                       06250098
062600                                                                  06260098
062700       WHEN SQLCODE = -904                                        06270098
062800       WHEN SQLCODE = -911                                        06280098
062900       WHEN SQLCODE = -913                                        06290098
063000            MOVE 'P7010-FETCH-SCAN-CRTN-CSR  '                    06300098
063100                               TO PC049-ABEND-PARAGRAPH           06310098
063200            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           06320098
063300                                  PC049-SQL-RETURN-CD             06330098
063400            SET  PC049-ERROR   TO TRUE                            06340098
063500                                                                  06350098
063600       WHEN OTHER                                                 06360098
063700            MOVE 'P7010-FETCH-SCAN-CRTN-CSR  '                    06370098
063800                               TO PC049-ABEND-PARAGRAPH           06380098
063900            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           06390098
064000                                  PC049-SQL-RETURN-CD             06400098
064100            SET  PC049-ERROR   TO TRUE                            06410098
064200     END-EVALUATE.                                                06420098
064300                                                                  06430098
064400                                                                  06440098
064500******************************************************************06450098
064600*                                                                *06460098
064700* CLOSE CURSOR USED TO SELECT ALL CARTONS SCANNED ONTO A TRAILER *06470098
064800*                                                                *06480098
064900******************************************************************06490098
065000 P7020-CLOSE-SCAN-CRTN-CSR.                                       06500098
065100                                                                  06510098
065200     EXEC SQL                                                     06520098
065300         CLOSE SCAN-ON-CRTN-CSR                                   06530098
065400     END-EXEC.                                                    06540098
065500                                                                  06550098
065600     EVALUATE TRUE                                                06560098
065700         WHEN SQLCODE = ZEROS                                     06570098
065800              CONTINUE                                            06580098
065900                                                                  06590098
066000         WHEN SQLCODE = -904                                      06600098
066100         WHEN SQLCODE = -911                                      06610098
066200         WHEN SQLCODE = -913                                      06620098
066300              MOVE 'P7020-CLOSE-SCAN-CRTN-CSR  '                  06630098
066400                                 TO PC049-ABEND-PARAGRAPH         06640098
066500              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         06650098
066600                                    PC049-SQL-RETURN-CD           06660098
066700              SET  PC049-ERROR   TO TRUE                          06670098
066800         WHEN OTHER                                               06680098
066900              MOVE 'P7020-CLOSE-SCAN-CRTN-CSR  '                  06690098
067000                                 TO PC049-ABEND-PARAGRAPH         06700098
067100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         06710098
067200                                  PC049-SQL-RETURN-CD             06720098
067300              SET  PC049-ERROR   TO TRUE                          06730098
067400     END-EVALUATE.                                                06740098
067500                                                                  06750098
067600                                                                  06760098
067700******************************************************************06770098
067800*                                                                *06780098
067900* OPEN CURSOR - THAT IS USED TO SELECT ALL CARTONS DIVERTED TO   *06790098
068000* A GIVEN TRAILER.  WHICH CURSOR IS USED DEPENDS ON THE DOOR-TYPE*06800098
068100* THE TRAILER WAS ORIGINALLY OPENED AT (TSUOBTR-DOOR-TYP-CDE)    *06810098
068200*                                                                *06820098
068300* IF THIS IS 'SH' SET PC049-SHIPPING-TRLR    (SHIPPING)          *06830098
068400* IF THIS IS 'ST' SET PC049-SHUTL-STRG-TRLR  (STORAGE)           *06840098
068500* IF THIS IS 'DS' SET PC049-SHUTL-STRG-TRLR  (DC SHUTTLE)        *06850098
068600*  PRIOR TO EXECUTING THIS PARAGRAPH                             *06860098
068700*                                                                *06870098
068800******************************************************************06880098
068900 P7030-OPEN-DVRT-CRTN-CSR.                                        06890098
069000                                                                  06900098
069100     IF   PC049-SHIPPING-TRLR                                     06910098
069200          EXEC SQL                                                06920098
069300               OPEN SHIP-DVRT-CRTN-CSR                            06930098
069400          END-EXEC                                                06940098
069500     ELSE                                                         06950098
069600          EXEC SQL                                                06960098
069700               OPEN SHTL-DVRT-CRTN-CSR                            06970098
069800          END-EXEC                                                06980098
069900     END-IF.                                                      06990098
070000                                                                  07000098
070100     EVALUATE TRUE                                                07010098
070200         WHEN SQLCODE = ZEROS                                     07020098
070300              SET PC049-NOT-EOF-DVRT-CRTN TO TRUE                 07030098
070400              CONTINUE                                            07040098
070500                                                                  07050098
070600         WHEN SQLCODE = -904                                      07060098
070700         WHEN SQLCODE = -911                                      07070098
070800         WHEN SQLCODE = -913                                      07080098
070900              MOVE 'P7030-OPEN-DVRT-CRTN-CSR   '                  07090098
071000                                 TO PC049-ABEND-PARAGRAPH         07100098
071100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         07110098
071200                                    PC049-SQL-RETURN-CD           07120098
071300              SET  PC049-ERROR   TO TRUE                          07130098
071400                                                                  07140098
071500         WHEN OTHER                                               07150098
071600              MOVE 'P7030-OPEN-DVRT-CRTN-CSR   '                  07160098
071700                                 TO PC049-ABEND-PARAGRAPH         07170098
071800              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         07180098
071900                                    PC049-SQL-RETURN-CD           07190098
072000              SET  PC049-ERROR   TO TRUE                          07200098
072100     END-EVALUATE.                                                07210098
072200                                                                  07220098
072300                                                                  07230098
072400******************************************************************07240098
072500*                                                                *07250098
072600* FETCH CURSOR - THAT IS USED TO SELECT ALL CARTONS DIVERTED TO  *07260098
072700* A GIVEN TRAILER.  WHICH CURSOR IS USED DEPENDS ON THE DOOR-TYPE*07270098
072800* THE TRAILER WAS ORIGINALLY OPENED AT (TSUOBTR-DOOR-TYP-CDE)    *07280098
072900*                                                                *07290098
073000******************************************************************07300098
073100 P7040-FETCH-DVRT-CRTN-CSR.                                       07310098
073200                                                                  07320098
073300     IF   PC049-SHIPPING-TRLR                                     07330098
073400          EXEC SQL                                                07340098
073500               FETCH SHIP-DVRT-CRTN-CSR                           07350098
073600                INTO :PC049-PV-REC-TYPE                           07360098
073700                    ,:SUCRDV-OPER-UNT-ID                          07370098
073800                    ,:SUCRDV-DIVERT-NBR                           07380098
073900                    ,:SUCRDV-DIVERT-LOC-ID                        07390098
074000                    ,:SUCRDV-DIVERT-TMST                          07400098
074100                    ,:SUCRDV-BRCDE-NBR                            07410098
074200                    ,:SUCRDV-PRC-RSN-CDE                          07420098
074300                    ,:SUCRDV-SHIPT-UNT-ID                         07430098
074400                    ,:SUCRDV-ACTV-CDE                             07440098
074500                    ,:SUCRDV-NACTV-USR-ID                         07450098
074600                    ,:SUCRDV-DOOR-ID                              07460098
074700                    ,:SUCDOT-OTBND-TRIP-ID                        07470098
074800                    ,:SUCDOT-STRT-SCN-TMST                        07480098
074900                    ,:SUCDOT-STRT-DIVERT-TMST                     07490098
075000                    ,:SUCDOT-STRT-SCN-USR-ID                      07500098
075100                    ,:SUCDOT-END-SCN-TMST                         07510098
075200                    ,:SUCDOT-END-DIVERT-TMST                      07520098
075300                    ,:SUCDOT-END-SCN-USR-ID                       07530098
075400                    ,:SUCDOT-DOOR-ID                              07540098
075500                    ,:SUCRDV-DEST-OPER-UNT-ID                     07550098
075600                    ,:PC049-PV-REC-TYPE-2                         07560098
075700          END-EXEC                                                07570098
075800     ELSE                                                         07580098
075900          EXEC SQL                                                07590098
076000               FETCH SHTL-DVRT-CRTN-CSR                           07600098
076100                INTO :PC049-PV-REC-TYPE                           07610098
076200                    ,:SUCRDV-OPER-UNT-ID                          07620098
076300                    ,:SUCRDV-DIVERT-NBR                           07630098
076400                    ,:SUCRDV-DIVERT-LOC-ID                        07640098
076500                    ,:SUCRDV-DIVERT-TMST                          07650098
076600                    ,:SUCRDV-BRCDE-NBR                            07660098
076700                    ,:SUCRDV-PRC-RSN-CDE                          07670098
076800                    ,:SUCRDV-SHIPT-UNT-ID                         07680098
076900                    ,:SUCRDV-ACTV-CDE                             07690098
077000                    ,:SUCRDV-NACTV-USR-ID                         07700098
077100                    ,:SUCRDV-DOOR-ID                              07710098
077200                    ,:SUCDOT-OTBND-TRIP-ID                        07720098
077300                    ,:SUCDOT-STRT-SCN-TMST                        07730098
077400                    ,:SUCDOT-STRT-DIVERT-TMST                     07740098
077500                    ,:SUCDOT-STRT-SCN-USR-ID                      07750098
077600                    ,:SUCDOT-END-SCN-TMST                         07760098
077700                    ,:SUCDOT-END-DIVERT-TMST                      07770098
077800                    ,:SUCDOT-END-SCN-USR-ID                       07780098
077900                    ,:SUCDOT-DOOR-ID                              07790098
078000                    ,:SUCRDV-DEST-OPER-UNT-ID                     07800098
078100                    ,:PC049-PV-REC-TYPE-2                         07810098
078200          END-EXEC                                                07820098
078300     END-IF.                                                      07830098
078400                                                                  07840098
078500     EVALUATE TRUE                                                07850098
078600       WHEN SQLCODE = ZEROS                                       07860098
078700            ADD  1  TO  PC049-DVRT-CRTN-CNT                       07870098
078800                                                                  07880098
078900       WHEN SQLCODE = +100                                        07890098
079000            SET PC049-EOF-DVRT-CRTN TO TRUE                       07900098
079100                                                                  07910098
079200       WHEN SQLCODE = -904                                        07920098
079300       WHEN SQLCODE = -911                                        07930098
079400       WHEN SQLCODE = -913                                        07940098
079500            MOVE 'P7040-FETCH-DVRT-CRTN-CSR  '                    07950098
079600                               TO PC049-ABEND-PARAGRAPH           07960098
079700            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           07970098
079800                                  PC049-SQL-RETURN-CD             07980098
079900            SET  PC049-ERROR   TO TRUE                            07990098
080000                                                                  08000098
080100       WHEN OTHER                                                 08010098
080200            MOVE 'P7040-FETCH-DVRT-CRTN-CSR  '                    08020098
080300                               TO PC049-ABEND-PARAGRAPH           08030098
080400            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           08040098
080500                                  PC049-SQL-RETURN-CD             08050098
080600            SET  PC049-ERROR   TO TRUE                            08060098
080700     END-EVALUATE.                                                08070098
080800                                                                  08080098
080900                                                                  08090098
081000******************************************************************08100098
081100*                                                                *08110098
081200* CLOSE CURSOR - THAT IS USED TO SELECT ALL CARTONS DIVERTED TO  *08120098
081300* A GIVEN TRAILER.  WHICH CURSOR IS USED DEPENDS ON THE DOOR-TYPE*08130098
081400* THE TRAILER WAS ORIGINALLY OPENED AT (TSUOBTR-DOOR-TYP-CDE)    *08140098
081500*                                                                *08150098
081600******************************************************************08160098
081700 P7050-CLOSE-DVRT-CRTN-CSR.                                       08170098
081800                                                                  08180098
081900     IF   PC049-SHIPPING-TRLR                                     08190098
082000          EXEC SQL                                                08200098
082100               CLOSE SHIP-DVRT-CRTN-CSR                           08210098
082200          END-EXEC                                                08220098
082300     ELSE                                                         08230098
082400          EXEC SQL                                                08240098
082500               CLOSE SHTL-DVRT-CRTN-CSR                           08250098
082600          END-EXEC                                                08260098
082700     END-IF.                                                      08270098
082800                                                                  08280098
082900                                                                  08290098
083000     EVALUATE TRUE                                                08300098
083100         WHEN SQLCODE = ZEROS                                     08310098
083200              CONTINUE                                            08320098
083300                                                                  08330098
083400         WHEN SQLCODE = -904                                      08340098
083500         WHEN SQLCODE = -911                                      08350098
083600         WHEN SQLCODE = -913                                      08360098
083700              MOVE 'P7050-CLOSE-DVRT-CRTN-CSR  '                  08370098
083800                                 TO PC049-ABEND-PARAGRAPH         08380098
083900              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         08390098
084000                                    PC049-SQL-RETURN-CD           08400098
084100              SET  PC049-ERROR   TO TRUE                          08410098
084200         WHEN OTHER                                               08420098
084300              MOVE 'P7050-CLOSE-DVRT-CRTN-CSR  '                  08430098
084400                                 TO PC049-ABEND-PARAGRAPH         08440098
084500              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         08450098
084600                                  PC049-SQL-RETURN-CD             08460098
084700              SET  PC049-ERROR   TO TRUE                          08470098
084800     END-EVALUATE.                                                08480098
084900                                                                  08490098
085000                                                                  08500098
085100******************************************************************08510098
085200*                                                                *08520098
085300* OPEN CURSOR - THAT IS USED TO SELECT ALL STORES THAT ARE       *08530098
085400* CURRENTLY ASSIGNED TO THE DOOR (EXCLUDING THE TRAILER DEST)    *08540098
085500*                                                                *08550098
085600******************************************************************08560098
085700 P7060-OPEN-DOOR-STR-CSR.                                         08570098
085800                                                                  08580098
085900     EXEC SQL                                                     08590098
086000         OPEN DOOR-STR-CSR                                        08600098
086100     END-EXEC.                                                    08610098
086200                                                                  08620098
086300     EVALUATE TRUE                                                08630098
086400         WHEN SQLCODE = ZEROS                                     08640098
086500              SET PC049-NOT-EOF-DOOR-STR  TO TRUE                 08650098
086600              CONTINUE                                            08660098
086700                                                                  08670098
086800         WHEN SQLCODE = -904                                      08680098
086900         WHEN SQLCODE = -911                                      08690098
087000         WHEN SQLCODE = -913                                      08700098
087100              MOVE 'P7060-OPEN-DOOR-STR-CSR    '                  08710098
087200                                 TO PC049-ABEND-PARAGRAPH         08720098
087300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         08730098
087400                                    PC049-SQL-RETURN-CD           08740098
087500              SET  PC049-ERROR   TO TRUE                          08750098
087600                                                                  08760098
087700         WHEN OTHER                                               08770098
087800              MOVE 'P7060-OPEN-DOOR-STR-CSR    '                  08780098
087900                                 TO PC049-ABEND-PARAGRAPH         08790098
088000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         08800098
088100                                    PC049-SQL-RETURN-CD           08810098
088200              SET  PC049-ERROR   TO TRUE                          08820098
088300     END-EVALUATE.                                                08830098
088400                                                                  08840098
088500                                                                  08850098
088600******************************************************************08860098
088700*                                                                *08870098
088800* FETCH CURSOR - THAT IS USED TO SELECT ALL STORES THAT ARE      *08880098
088900* CURRENTLY ASSIGNED TO THE DOOR (EXCLUDING THE TRAILER DEST)    *08890098
089000*                                                                *08900098
089100******************************************************************08910098
089200 P7070-FETCH-DOOR-STR-CSR.                                        08920098
089300                                                                  08930098
089400     EXEC SQL                                                     08940098
089500          FETCH DOOR-STR-CSR                                      08950098
089600          INTO  :CNDRST-OPER-UNT-ID                               08960098
089700              , :CNDRST-DOOR-ID                                   08970098
089800              , :CNDRST-STR-NBR                                   08980098
089900              , :CNDRST-STRT-TMST                                 08990098
090000              , :CNDRST-END-TMST                                  09000098
090100              , :CNDRST-CRE-USR-ID                                09010098
090200     END-EXEC.                                                    09020098
090300                                                                  09030098
090400     EVALUATE TRUE                                                09040098
090500       WHEN SQLCODE = ZEROS                                       09050098
090600            ADD  1  TO  PC049-DOOR-STR-CNT                        09060098
090700                                                                  09070098
090800       WHEN SQLCODE = +100                                        09080098
090900            SET PC049-EOF-DOOR-STR TO TRUE                        09090098
091000                                                                  09100098
091100       WHEN SQLCODE = -904                                        09110098
091200       WHEN SQLCODE = -911                                        09120098
091300       WHEN SQLCODE = -913                                        09130098
091400            MOVE 'P7070-FETCH-DOOR-STR-CSR   '                    09140098
091500                               TO PC049-ABEND-PARAGRAPH           09150098
091600            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           09160098
091700                                  PC049-SQL-RETURN-CD             09170098
091800            SET  PC049-ERROR   TO TRUE                            09180098
091900                                                                  09190098
092000       WHEN OTHER                                                 09200098
092100            MOVE 'P7070-FETCH-DOOR-STR-CSR   '                    09210098
092200                               TO PC049-ABEND-PARAGRAPH           09220098
092300            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           09230098
092400                                  PC049-SQL-RETURN-CD             09240098
092500            SET  PC049-ERROR   TO TRUE                            09250098
092600     END-EVALUATE.                                                09260098
092700                                                                  09270098
092800                                                                  09280098
092900******************************************************************09290098
093000*                                                                *09300098
093100* CLOSE CURSOR - THAT IS USED TO SELECT ALL STORES THAT ARE      *09310098
093200* CURRENTLY ASSIGNED TO THE DOOR (EXCLUDING THE TRAILER DEST)    *09320098
093300*                                                                *09330098
093400******************************************************************09340098
093500 P7080-CLOSE-DOOR-STR-CSR.                                        09350098
093600                                                                  09360098
093700     EXEC SQL                                                     09370098
093800         CLOSE DOOR-STR-CSR                                       09380098
093900     END-EXEC.                                                    09390098
094000                                                                  09400098
094100     EVALUATE TRUE                                                09410098
094200         WHEN SQLCODE = ZEROS                                     09420098
094300              CONTINUE                                            09430098
094400                                                                  09440098
094500         WHEN SQLCODE = -904                                      09450098
094600         WHEN SQLCODE = -911                                      09460098
094700         WHEN SQLCODE = -913                                      09470098
094800              MOVE 'P7080-CLOSE-DOOR-STR-CSR   '                  09480098
094900                                 TO PC049-ABEND-PARAGRAPH         09490098
095000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         09500098
095100                                    PC049-SQL-RETURN-CD           09510098
095200              SET  PC049-ERROR   TO TRUE                          09520098
095300         WHEN OTHER                                               09530098
095400              MOVE 'P7080-CLOSE-DOOR-STR-CSR   '                  09540098
095500                                 TO PC049-ABEND-PARAGRAPH         09550098
095600              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         09560098
095700                                  PC049-SQL-RETURN-CD             09570098
095800              SET  PC049-ERROR   TO TRUE                          09580098
095900     END-EVALUATE.                                                09590098
096000                                                                  09600098
096100                                                                  09610098
096200******************************************************************09620098
096300*                                                                *09630098
096400* OPEN CURSOR - THAT IS USED TO SELECT ALL STORES THAT ARE       *09640098
096500* CURRENTLY ASSIGNED TO THE DOOR (INCLUDING THE TRAILER DEST)    *09650098
096600*                                                                *09660098
096700******************************************************************09670098
096800 P7090-OPEN-ALL-DOOR-STR-CSR.                                     09680098
096900                                                                  09690098
097000     EXEC SQL                                                     09700098
097100         OPEN ALL-DOOR-STR-CSR                                    09710098
097200     END-EXEC.                                                    09720098
097300                                                                  09730098
097400     EVALUATE TRUE                                                09740098
097500         WHEN SQLCODE = ZEROS                                     09750098
097600              SET PC049-NOT-EOF-ALL-DOOR-STR TO TRUE              09760098
097700              CONTINUE                                            09770098
097800                                                                  09780098
097900         WHEN SQLCODE = -904                                      09790098
098000         WHEN SQLCODE = -911                                      09800098
098100         WHEN SQLCODE = -913                                      09810098
098200              MOVE 'P7090-OPEN-ALL-DOOR-STR-CSR'                  09820098
098300                                 TO PC049-ABEND-PARAGRAPH         09830098
098400              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         09840098
098500                                    PC049-SQL-RETURN-CD           09850098
098600              SET  PC049-ERROR   TO TRUE                          09860098
098700                                                                  09870098
098800         WHEN OTHER                                               09880098
098900              MOVE 'P7090-OPEN-ALL-DOOR-STR-CSR'                  09890098
099000                                 TO PC049-ABEND-PARAGRAPH         09900098
099100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         09910098
099200                                    PC049-SQL-RETURN-CD           09920098
099300              SET  PC049-ERROR   TO TRUE                          09930098
099400     END-EVALUATE.                                                09940098
099500                                                                  09950098
099600                                                                  09960098
099700******************************************************************09970098
099800*                                                                *09980098
099900* FETCH CURSOR - THAT IS USED TO SELECT ALL STORES THAT ARE      *09990098
100000* CURRENTLY ASSIGNED TO THE DOOR (INCLUDING THE TRAILER DEST)    *10000098
100100*                                                                *10010098
100200******************************************************************10020098
100300 P7100-FETCH-ALL-DOOR-STR-CSR.                                    10030098
100400                                                                  10040098
100500     EXEC SQL                                                     10050098
100600          FETCH ALL-DOOR-STR-CSR                                  10060098
100700          INTO  :CNDRST-OPER-UNT-ID                               10070098
100800              , :CNDRST-DOOR-ID                                   10080098
100900              , :CNDRST-STR-NBR                                   10090098
101000              , :CNDRST-STRT-TMST                                 10100098
101100              , :CNDRST-END-TMST                                  10110098
101200              , :CNDRST-CRE-USR-ID                                10120098
101300     END-EXEC.                                                    10130098
101400                                                                  10140098
101500     EVALUATE TRUE                                                10150098
101600       WHEN SQLCODE = ZEROS                                       10160098
101700            ADD  1  TO  PC049-DOOR-STR-CNT                        10170098
101800                                                                  10180098
101900       WHEN SQLCODE = +100                                        10190098
102000            SET PC049-EOF-ALL-DOOR-STR TO TRUE                    10200098
102100                                                                  10210098
102200       WHEN SQLCODE = -904                                        10220098
102300       WHEN SQLCODE = -911                                        10230098
102400       WHEN SQLCODE = -913                                        10240098
102500            MOVE 'P7100-FETCH-ALL-DOOR-STR-CSR'                   10250098
102600                               TO PC049-ABEND-PARAGRAPH           10260098
102700            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           10270098
102800                                  PC049-SQL-RETURN-CD             10280098
102900            SET  PC049-ERROR   TO TRUE                            10290098
103000                                                                  10300098
103100       WHEN OTHER                                                 10310098
103200            MOVE 'P7100-FETCH-ALL-DOOR-STR-CSR'                   10320098
103300                               TO PC049-ABEND-PARAGRAPH           10330098
103400            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           10340098
103500                                  PC049-SQL-RETURN-CD             10350098
103600            SET  PC049-ERROR   TO TRUE                            10360098
103700     END-EVALUATE.                                                10370098
103800                                                                  10380098
103900                                                                  10390098
104000******************************************************************10400098
104100*                                                                *10410098
104200* CLOSE CURSOR - THAT IS USED TO SELECT ALL STORES THAT ARE      *10420098
104300* CURRENTLY ASSIGNED TO THE DOOR (INCLUDING THE TRAILER DEST)    *10430098
104400*                                                                *10440098
104500******************************************************************10450098
104600 P7110-CLOSE-ALL-DOOR-STR-CSR.                                    10460098
104700                                                                  10470098
104800     EXEC SQL                                                     10480098
104900         CLOSE DOOR-STR-CSR                                       10490098
105000     END-EXEC.                                                    10500098
105100                                                                  10510098
105200     EVALUATE TRUE                                                10520098
105300         WHEN SQLCODE = ZEROS                                     10530098
105400              CONTINUE                                            10540098
105500                                                                  10550098
105600         WHEN SQLCODE = -904                                      10560098
105700         WHEN SQLCODE = -911                                      10570098
105800         WHEN SQLCODE = -913                                      10580098
105900              MOVE 'P7110-CLOSE-ALL-DOOR-STR-CSR'                 10590098
106000                                 TO PC049-ABEND-PARAGRAPH         10600098
106100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         10610098
106200                                    PC049-SQL-RETURN-CD           10620098
106300              SET  PC049-ERROR   TO TRUE                          10630098
106400         WHEN OTHER                                               10640098
106500              MOVE 'P7110-CLOSE-ALL-DOOR-STR-CSR'                 10650098
106600                                 TO PC049-ABEND-PARAGRAPH         10660098
106700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         10670098
106800                                  PC049-SQL-RETURN-CD             10680098
106900              SET  PC049-ERROR   TO TRUE                          10690098
107000     END-EVALUATE.                                                10700098
107100                                                                  10710098
107200                                                                  10720098
107300******************************************************************10730098
107400*                                                                *10740098
107500* OPEN CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *10750098
107600* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *10760098
107700* USE WHEN HAVE A STARTING AND ENDING TMST                       *10770098
107800* *** SHIPPING TRAILER ***                                       *10780098
107900*                                                                *10790098
108000******************************************************************10800098
108100 P7120-OPEN-SHP-ACTV-CRTN-CSR.                                    10810098
108200                                                                  10820098
108300     EXEC SQL                                                     10830098
108400         OPEN SHP-ACTV-CRTN-CSR                                   10840098
108500     END-EXEC.                                                    10850098
108600                                                                  10860098
108700     EVALUATE TRUE                                                10870098
108800         WHEN SQLCODE = ZEROS                                     10880098
108900              SET PC049-NOT-EOF-SHP-ACTV-CRTN TO TRUE             10890098
109000                                                                  10900098
109100         WHEN SQLCODE = -904                                      10910098
109200         WHEN SQLCODE = -911                                      10920098
109300         WHEN SQLCODE = -913                                      10930098
109400              MOVE 'P7120-OPEN-SHP-ACTV-CRTN-CSR'                 10940098
109500                                 TO PC049-ABEND-PARAGRAPH         10950098
109600              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         10960098
109700                                    PC049-SQL-RETURN-CD           10970098
109800              SET  PC049-ERROR   TO TRUE                          10980098
109900                                                                  10990098
110000         WHEN OTHER                                               11000098
110100              MOVE 'P7120-OPEN-SHP-ACTV-CRTN-CSR'                 11010098
110200                                 TO PC049-ABEND-PARAGRAPH         11020098
110300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         11030098
110400                                    PC049-SQL-RETURN-CD           11040098
110500              SET  PC049-ERROR   TO TRUE                          11050098
110600     END-EVALUATE.                                                11060098
110700                                                                  11070098
110800                                                                  11080098
110900******************************************************************11090098
111000*                                                                *11100098
111100* FETCH CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE        *11110098
111200* CARTONS CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.             *11120098
111300* USE WHEN HAVE A STARTING AND ENDING TMST                       *11130098
111400* *** SHIPPING TRAILER ***                                       *11140098
111500*                                                                *11150098
111600******************************************************************11160098
111700 P7125-FETCH-SHP-ACTV-CRTN-CSR.                                   11170098
111800                                                                  11180098
111900     EXEC SQL                                                     11190098
112000          FETCH SHP-ACTV-CRTN-CSR                                 11200098
112100          INTO  :PC049-PV-REC-TYPE                                11210098
112200               ,:SUCRDV-SHIPT-UNT-ID                              11220098
112300               ,:SUCRDV-OPER-UNT-ID                               11230098
112400               ,:SUCRDV-DOOR-ID                                   11240098
112500               ,:SUCRDV-DIVERT-TMST                               11250098
112600               ,:SUCDOT-STRT-SCN-USR-ID                           11260098
112700               ,:SUCDOT-OTBND-TRIP-ID                             11270098
112800               ,:SUCRDV-ACTV-CDE                                  11280098
112900               ,:SUCRDV-PRC-RSN-CDE                               11290098
113000               ,:SUCRDV-NACTV-USR-ID                              11300098
113100               ,:SUCDOT-END-SCN-USR-ID                            11310098
113200               ,:SUCDOT-STRT-SCN-TMST                             11320098
113300               ,:SUCDOT-END-SCN-TMST                              11330098
113400               ,:PC049-PV-REC-TYPE-2                              11340098
113500     END-EXEC.                                                    11350098
113600                                                                  11360098
113700     EVALUATE TRUE                                                11370098
113800       WHEN SQLCODE = ZEROS                                       11380098
113900            ADD  1  TO  PC049-SCAN-CRTN-CNT                       11390098
114000       WHEN SQLCODE = +100                                        11400098
114100            SET PC049-EOF-SHP-ACTV-CRTN TO TRUE                   11410098
114200                                                                  11420098
114300       WHEN SQLCODE = -904                                        11430098
114400       WHEN SQLCODE = -911                                        11440098
114500       WHEN SQLCODE = -913                                        11450098
114600            MOVE 'P7125-FETCH-SHP-ACTV-CRTN-CSR '                 11460098
114700                               TO PC049-ABEND-PARAGRAPH           11470098
114800            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           11480098
114900                                  PC049-SQL-RETURN-CD             11490098
115000            SET  PC049-ERROR   TO TRUE                            11500098
115100                                                                  11510098
115200       WHEN OTHER                                                 11520098
115300            MOVE 'P7125-FETCH-SHP-ACTV-CRTN-CSR '                 11530098
115400                               TO PC049-ABEND-PARAGRAPH           11540098
115500            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           11550098
115600                                  PC049-SQL-RETURN-CD             11560098
115700            SET  PC049-ERROR   TO TRUE                            11570098
115800     END-EVALUATE.                                                11580098
115900                                                                  11590098
116000                                                                  11600098
116100******************************************************************11610098
116200*                                                                *11620098
116300*CLOSE CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *11630098
116400* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *11640098
116500* USE WHEN HAVE A STARTING AND ENDING TMST                       *11650098
116600* *** SHIPPING TRAILER ***                                       *11660098
116700*                                                                *11670098
116800******************************************************************11680098
116900 P7130-CLOSE-SHP-ACTV-CRTN-CSR.                                   11690098
117000                                                                  11700098
117100     EXEC SQL                                                     11710098
117200         CLOSE SHP-ACTV-CRTN-CSR                                  11720098
117300     END-EXEC.                                                    11730098
117400                                                                  11740098
117500     EVALUATE TRUE                                                11750098
117600         WHEN SQLCODE = ZEROS                                     11760098
117700              CONTINUE                                            11770098
117800                                                                  11780098
117900         WHEN SQLCODE = -904                                      11790098
118000         WHEN SQLCODE = -911                                      11800098
118100         WHEN SQLCODE = -913                                      11810098
118200              MOVE 'P7130-CLOSE-SHP-ACTV-CRTN-CSR'                11820098
118300                                 TO PC049-ABEND-PARAGRAPH         11830098
118400              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         11840098
118500                                    PC049-SQL-RETURN-CD           11850098
118600              SET  PC049-ERROR   TO TRUE                          11860098
118700                                                                  11870098
118800         WHEN OTHER                                               11880098
118900              MOVE 'P7130-CLOSE-SHP-TRLR-ACTV-CRTN-CSR'           11890098
119000                                 TO PC049-ABEND-PARAGRAPH         11900098
119100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         11910098
119200                                    PC049-SQL-RETURN-CD           11920098
119300              SET  PC049-ERROR   TO TRUE                          11930098
119400     END-EVALUATE.                                                11940098
119500                                                                  11950098
119600                                                                  11960098
119700******************************************************************11970098
119800*                                                                *11980098
119900* OPEN CURSOR - THAT IS USED TO SELECT CARTONS FOR AN OUTBOUND   *11990098
120000* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *12000098
120100* USE WHEN HAVE A STARTING AND ENDING POINT                      *12010098
120200* *** SHIPPING TRAILER ***                                       *12020098
120300*                                                                *12030098
120400******************************************************************12040098
120500 P7140-OPEN-SHP-ALL-CRTN-CSR.                                     12050098
120600                                                                  12060098
120700     EXEC SQL                                                     12070098
120800         OPEN SHP-ALL-CRTN-CSR                                    12080098
120900     END-EXEC.                                                    12090098
121000                                                                  12100098
121100     EVALUATE TRUE                                                12110098
121200         WHEN SQLCODE = ZEROS                                     12120098
121300              SET PC049-EOF-SHIP-ALL-CNT-NO TO TRUE               12130098
121400                                                                  12140098
121500         WHEN SQLCODE = -904                                      12150098
121600         WHEN SQLCODE = -911                                      12160098
121700         WHEN SQLCODE = -913                                      12170098
121800              MOVE 'P7140-OPEN-SHP-ALL-CRTN-CSR'                  12180098
121900                                 TO PC049-ABEND-PARAGRAPH         12190098
122000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         12200098
122100                                    PC049-SQL-RETURN-CD           12210098
122200              SET  PC049-ERROR   TO TRUE                          12220098
122300                                                                  12230098
122400         WHEN OTHER                                               12240098
122500              MOVE 'P7140-OPEN-SHP-ALL-CRTN-CSR'                  12250098
122600                                 TO PC049-ABEND-PARAGRAPH         12260098
122700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         12270098
122800                                    PC049-SQL-RETURN-CD           12280098
122900              SET  PC049-ERROR   TO TRUE                          12290098
123000     END-EVALUATE.                                                12300098
123100                                                                  12310098
123200                                                                  12320098
123300******************************************************************12330098
123400*                                                                *12340098
123500*FETCH CURSOR - THAT IS USED TO SELECT CARTONS FOR AN OUTBOUND   *12350098
123600* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *12360098
123700* USE WHEN HAVE A STARTING AND ENDING POINT                      *12370098
123800* *** SHIPPING TRAILER ***                                       *12380098
123900*                                                                *12390098
124000******************************************************************12400098
124100 P7145-FETCH-SHP-ALL-CRTN-CSR.                                    12410098
124200                                                                  12420098
124300     EXEC SQL                                                     12430098
124400          FETCH SHP-ALL-CRTN-CSR                                  12440098
124500          INTO  :PC049-PV-REC-TYPE                                12450098
124600               ,:SUCRDV-SHIPT-UNT-ID                              12460098
124700               ,:SUCRDV-OPER-UNT-ID                               12470098
124800               ,:SUCRDV-DOOR-ID                                   12480098
124900               ,:SUCRDV-DIVERT-TMST                               12490098
125000               ,:SUCDOT-STRT-SCN-USR-ID                           12500098
125100               ,:SUCDOT-OTBND-TRIP-ID                             12510098
125200               ,:SUCRDV-ACTV-CDE                                  12520098
125300               ,:SUCRDV-PRC-RSN-CDE                               12530098
125400               ,:SUCRDV-NACTV-USR-ID                              12540098
125500               ,:SUCDOT-END-SCN-USR-ID                            12550098
125600               ,:SUCRDV-DEST-OPER-UNT-ID                          12560098
125700               ,:SUCDOT-STRT-SCN-TMST                             12570098
125800               ,:SUCDOT-END-SCN-TMST                              12580098
125900               ,:PC049-PV-REC-TYPE-2                              12590098
126000     END-EXEC.                                                    12600098
126100                                                                  12610098
126200     EVALUATE TRUE                                                12620098
126300       WHEN SQLCODE = ZEROS                                       12630098
126400            ADD  1  TO  PC049-SCAN-DVRT-CNT                       12640098
126500       WHEN SQLCODE = +100                                        12650098
126600            SET PC049-EOF-SHIP-ALL-CTN   TO TRUE                  12660098
126700                                                                  12670098
126800       WHEN SQLCODE = -904                                        12680098
126900       WHEN SQLCODE = -911                                        12690098
127000       WHEN SQLCODE = -913                                        12700098
127100            MOVE 'P7145-FETCH-SHP-ALL-CRTN-CSR   '                12710098
127200                               TO PC049-ABEND-PARAGRAPH           12720098
127300            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           12730098
127400                                  PC049-SQL-RETURN-CD             12740098
127500            SET  PC049-ERROR   TO TRUE                            12750098
127600                                                                  12760098
127700       WHEN OTHER                                                 12770098
127800            MOVE 'P7145-FETCH-SHP-ALL-CRTN-CSR   '                12780098
127900                               TO PC049-ABEND-PARAGRAPH           12790098
128000            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           12800098
128100                                  PC049-SQL-RETURN-CD             12810098
128200            SET  PC049-ERROR   TO TRUE                            12820098
128300     END-EVALUATE.                                                12830098
128400                                                                  12840098
128500                                                                  12850098
128600******************************************************************12860098
128700*                                                                *12870098
128800*CLOSE CURSOR - THAT IS USED TO SELECT CARTONS FOR AN OUTBOUND   *12880098
128900* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *12890098
129000* USE WHEN HAVE A STARTING AND ENDING POINT                      *12900098
129100* *** SHIPPING TRAILER ***                                       *12910098
129200*                                                                *12920098
129300******************************************************************12930098
129400 P7150-CLOSE-SHP-ALL-CRTN-CSR.                                    12940098
129500                                                                  12950098
129600     EXEC SQL                                                     12960098
129700         CLOSE SHP-ALL-CRTN-CSR                                   12970098
129800     END-EXEC.                                                    12980098
129900                                                                  12990098
130000     EVALUATE TRUE                                                13000098
130100         WHEN SQLCODE = ZEROS                                     13010098
130200              CONTINUE                                            13020098
130300                                                                  13030098
130400         WHEN SQLCODE = -904                                      13040098
130500         WHEN SQLCODE = -911                                      13050098
130600         WHEN SQLCODE = -913                                      13060098
130700              MOVE 'P7150-CLOSE-SHP-ALL-CRTN-CSR'                 13070098
130800                                 TO PC049-ABEND-PARAGRAPH         13080098
130900              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         13090098
131000                                    PC049-SQL-RETURN-CD           13100098
131100              SET  PC049-ERROR   TO TRUE                          13110098
131200                                                                  13120098
131300         WHEN OTHER                                               13130098
131400              MOVE 'P7150-CLOSE-SHP-ALL-CRTN-CSR'                 13140098
131500                                 TO PC049-ABEND-PARAGRAPH         13150098
131600              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         13160098
131700                                    PC049-SQL-RETURN-CD           13170098
131800              SET  PC049-ERROR   TO TRUE                          13180098
131900     END-EVALUATE.                                                13190098
132000                                                                  13200098
132100                                                                  13210098
132200******************************************************************13220098
132300*                                                                *13230098
132400* OPEN CURSOR - THAT IS USED TO SELECT THE CRTNS FOR AN OUTBOUND *13240098
132500* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *13250098
132600* TRAILER.  WILL ALSO BRING BACK ASSUMED CARTONS (C)            *13260098
132700* USE WHEN HAVE A STARTING WITH A ENDING TMST = 9'S              *13270098
132800* *** SHIPPING TRAILER ***                                       *13280098
132900*                                                                *13290098
133000******************************************************************13300098
133100 P7160-OPEN-SHP-TR-ALL-CTN-CSR.                                   13310098
133200                                                                  13320098
133300     EXEC SQL                                                     13330098
133400         OPEN SHP-TR-ALL-CTN-CSR                                  13340098
133500     END-EXEC.                                                    13350098
133600                                                                  13360098
133700     EVALUATE TRUE                                                13370098
133800         WHEN SQLCODE = ZEROS                                     13380098
133900              SET PC049-NOT-EOF-SHP-TR-ALL-CTN TO TRUE            13390098
134000                                                                  13400098
134100         WHEN SQLCODE = -904                                      13410098
134200         WHEN SQLCODE = -911                                      13420098
134300         WHEN SQLCODE = -913                                      13430098
134400              MOVE 'P7160-OPEN-SHP-TR-ALL-CTN-CSR'                13440098
134500                                 TO PC049-ABEND-PARAGRAPH         13450098
134600              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         13460098
134700                                    PC049-SQL-RETURN-CD           13470098
134800              SET  PC049-ERROR   TO TRUE                          13480098
134900                                                                  13490098
135000         WHEN OTHER                                               13500098
135100              MOVE 'P7160-OPEN-SHP-TR-ALL-CTN-CSR'                13510098
135200                                 TO PC049-ABEND-PARAGRAPH         13520098
135300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         13530098
135400                                    PC049-SQL-RETURN-CD           13540098
135500              SET  PC049-ERROR   TO TRUE                          13550098
135600     END-EVALUATE.                                                13560098
135700                                                                  13570098
135800                                                                  13580098
135900******************************************************************13590098
136000*                                                                *13600098
136100*FETCH CURSOR - THAT IS USED TO SELECT CARTONS FOR AN OUTBOUND   *13610098
136200* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *13620098
136300* USE WHEN HAVE A STARTING AND ENDING POINT                      *13630098
136400* *** SHIPPING TRAILER ***                                       *13640098
136500*                                                                *13650098
136600******************************************************************13660098
136700 P7165-FETCH-SHP-TR-ALL-CTN-CSR.                                  13670098
136800                                                                  13680098
136900     EXEC SQL                                                     13690098
137000          FETCH SHP-TR-ALL-CTN-CSR                                13700098
137100          INTO  :PC049-PV-REC-TYPE                                13710098
137200               ,:SUCRDV-SHIPT-UNT-ID                              13720098
137300               ,:SUCRDV-OPER-UNT-ID                               13730098
137400               ,:SUCRDV-DOOR-ID                                   13740098
137500               ,:SUCRDV-DIVERT-TMST                               13750098
137600               ,:SUCDOT-STRT-SCN-USR-ID                           13760098
137700               ,:SUCDOT-OTBND-TRIP-ID                             13770098
137800               ,:SUCRDV-ACTV-CDE                                  13780098
137900               ,:SUCRDV-PRC-RSN-CDE                               13790098
138000               ,:SUCRDV-NACTV-USR-ID                              13800098
138100               ,:SUCDOT-END-SCN-USR-ID                            13810098
138200               ,:SUCRDV-DEST-OPER-UNT-ID                          13820098
138300               ,:SUCDOT-STRT-SCN-TMST                             13830098
138400               ,:SUCDOT-END-SCN-TMST                              13840098
138500               ,:PC049-PV-REC-TYPE-2                              13850098
138600     END-EXEC.                                                    13860098
138700                                                                  13870098
138800     EVALUATE TRUE                                                13880098
138900       WHEN SQLCODE = ZEROS                                       13890098
139000            ADD  1  TO  PC049-SCAN-DVRT-CNT                       13900098
139100       WHEN SQLCODE = +100                                        13910098
139200            SET PC049-EOF-SHP-TR-ALL-CTN TO TRUE                  13920098
139300                                                                  13930098
139400       WHEN SQLCODE = -904                                        13940098
139500       WHEN SQLCODE = -911                                        13950098
139600       WHEN SQLCODE = -913                                        13960098
139700            MOVE 'P7165-FETCH-SHP-TR-ALL-CTN-CSR '                13970098
139800                               TO PC049-ABEND-PARAGRAPH           13980098
139900            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           13990098
140000                                  PC049-SQL-RETURN-CD             14000098
140100            SET  PC049-ERROR   TO TRUE                            14010098
140200                                                                  14020098
140300       WHEN OTHER                                                 14030098
140400            MOVE 'P7165-FETCH-SHP-TR-ALL-CTN-CSR '                14040098
140500                               TO PC049-ABEND-PARAGRAPH           14050098
140600            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           14060098
140700                                  PC049-SQL-RETURN-CD             14070098
140800            SET  PC049-ERROR   TO TRUE                            14080098
140900     END-EVALUATE.                                                14090098
141000                                                                  14100098
141100                                                                  14110098
141200******************************************************************14120098
141300*                                                                *14130098
141400*CLOSE CURSOR - THAT IS USED TO SELECT THE CRTNS FOR AN OUTBOUND *14140098
141500* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *14150098
141600* TRAILER.  WILL ALSO BRING BACK ASSUMED CARTONS (C)            *14160098
141700* USE WHEN HAVE A STARTING WITH A ENDING TMST = 9'S              *14170098
141800* *** SHIPPING TRAILER ***                                       *14180098
141900*                                                                *14190098
142000******************************************************************14200098
142100 P7170-CLOSE-SHP-TR-ALL-CTN-CSR.                                  14210098
142200                                                                  14220098
142300     EXEC SQL                                                     14230098
142400         CLOSE SHP-TR-ALL-CTN-CSR                                 14240098
142500     END-EXEC.                                                    14250098
142600                                                                  14260098
142700     EVALUATE TRUE                                                14270098
142800         WHEN SQLCODE = ZEROS                                     14280098
142900              CONTINUE                                            14290098
143000                                                                  14300098
143100         WHEN SQLCODE = -904                                      14310098
143200         WHEN SQLCODE = -911                                      14320098
143300         WHEN SQLCODE = -913                                      14330098
143400              MOVE 'P7170-CLOSE-SHP-TR-ALL-CTN-CSR'               14340098
143500                                 TO PC049-ABEND-PARAGRAPH         14350098
143600              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         14360098
143700                                    PC049-SQL-RETURN-CD           14370098
143800              SET  PC049-ERROR   TO TRUE                          14380098
143900                                                                  14390098
144000         WHEN OTHER                                               14400098
144100              MOVE 'P7170-CLOSE-SHP-TR-ALL-CTN-CSR'               14410098
144200                                 TO PC049-ABEND-PARAGRAPH         14420098
144300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         14430098
144400                                    PC049-SQL-RETURN-CD           14440098
144500              SET  PC049-ERROR   TO TRUE                          14450098
144600     END-EVALUATE.                                                14460098
144700                                                                  14470098
144800                                                                  14480098
144900******************************************************************14490098
145100* OPEN CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *14510098
145200* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *14520098
145300* USE WHEN HAVE A STARTING AND ENDING TMST                       *14530098
145400* *** SHUTTLE AND STORAGE TRAILERS ***                           *14540098
145600******************************************************************14560098
145700 P7180-OPEN-SHTL-ACTV-CRTN-CSR.                                   14570098
145800                                                                  14580098
145900     EXEC SQL                                                     14590098
146000         OPEN SHTL-ACTV-CRTN-CSR                                  14600098
146100     END-EXEC.                                                    14610098
146200                                                                  14620098
146300     EVALUATE TRUE                                                14630098
146400         WHEN SQLCODE = ZEROS                                     14640098
146500              SET PC049-NOT-EOF-STL-ACTV-CRTN TO TRUE             14650098
146600                                                                  14660098
146700         WHEN SQLCODE = -904                                      14670098
146800         WHEN SQLCODE = -911                                      14680098
146900         WHEN SQLCODE = -913                                      14690098
147000              MOVE 'P7180-OPEN-SHTL-ACTV-CRTN-CSR'                14700098
147100                                 TO PC049-ABEND-PARAGRAPH         14710098
147200              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         14720098
147300                                    PC049-SQL-RETURN-CD           14730098
147400              SET  PC049-ERROR   TO TRUE                          14740098
147500                                                                  14750098
147600         WHEN OTHER                                               14760098
147700              MOVE 'P7180-OPEN-SHTL-TRLR-ACTV-CRTN-CSR'           14770098
147800                                 TO PC049-ABEND-PARAGRAPH         14780098
147900              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         14790098
148000                                    PC049-SQL-RETURN-CD           14800098
148100              SET  PC049-ERROR   TO TRUE                          14810098
148200     END-EVALUATE.                                                14820098
148300                                                                  14830098
148400                                                                  14840098
148500******************************************************************14850098
148600*                                                                *14860098
148700* FETCH CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE        *14870098
148800* CARTONS CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.             *14880098
148900* USE WHEN HAVE A STARTING AND ENDING TMST                       *14890098
149000* *** SHUTTLE AND STORAGE TRAILERS ***                           *14900098
149100*                                                                *14910098
149200******************************************************************14920098
149300 P7185-FETCH-SHTL-ACTV-CRTN-CSR.                                  14930098
149400                                                                  14940098
149500     EXEC SQL                                                     14950098
149600          FETCH SHTL-ACTV-CRTN-CSR                                14960098
149700          INTO  :PC049-PV-REC-TYPE                                14970098
149800               ,:SUCRDV-SHIPT-UNT-ID                              14980098
149900               ,:SUCRDV-OPER-UNT-ID                               14990098
150000               ,:SUCRDV-DOOR-ID                                   15000098
150100               ,:SUCRDV-DIVERT-TMST                               15010098
150200               ,:SUCDOT-STRT-SCN-USR-ID                           15020098
150300               ,:SUCDOT-OTBND-TRIP-ID                             15030098
150400               ,:SUCRDV-ACTV-CDE                                  15040098
150500               ,:SUCRDV-PRC-RSN-CDE                               15050098
150600               ,:SUCRDV-NACTV-USR-ID                              15060098
150700               ,:SUCDOT-END-SCN-USR-ID                            15070098
150800               ,:SUCDOT-STRT-SCN-TMST                             15080098
150900               ,:SUCDOT-END-SCN-TMST                              15090098
151000               ,:PC049-PV-REC-TYPE-2                              15100098
151100     END-EXEC.                                                    15110098
151200                                                                  15120098
151300     EVALUATE TRUE                                                15130098
151400       WHEN SQLCODE = ZEROS                                       15140098
151500            ADD  1  TO  PC049-SCAN-CRTN-CNT                       15150098
151600       WHEN SQLCODE = +100                                        15160098
151700            SET PC049-EOF-STL-ACTV-CRTN TO TRUE                   15170098
151800                                                                  15180098
151900       WHEN SQLCODE = -904                                        15190098
152000       WHEN SQLCODE = -911                                        15200098
152100       WHEN SQLCODE = -913                                        15210098
152200            MOVE 'P7185-FETCH-SHTL-ACTV-CRTN-CSR '                15220098
152300                               TO PC049-ABEND-PARAGRAPH           15230098
152400            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           15240098
152500                                  PC049-SQL-RETURN-CD             15250098
152600            SET  PC049-ERROR   TO TRUE                            15260098
152700                                                                  15270098
152800       WHEN OTHER                                                 15280098
152900            MOVE 'P7185-FETCH-SHTL-ACTV-CRTN-CSR '                15290098
153000                               TO PC049-ABEND-PARAGRAPH           15300098
153100            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           15310098
153200                                  PC049-SQL-RETURN-CD             15320098
153300            SET  PC049-ERROR   TO TRUE                            15330098
153400     END-EVALUATE.                                                15340098
153500                                                                  15350098
153600                                                                  15360098
153700******************************************************************15370098
153800*                                                                *15380098
153900*CLOSE CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *15390098
154000* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *15400098
154100* USE WHEN HAVE A STARTING AND ENDING TMST                       *15410098
154200* *** SHUTTLE AND STORAGE TRAILER ***                            *15420098
154300*                                                                *15430098
154400******************************************************************15440098
154500 P7190-CLOSE-SHTL-ACTV-CRTN-CSR.                                  15450098
154600                                                                  15460098
154700     EXEC SQL                                                     15470098
154800         CLOSE SHTL-ACTV-CRTN-CSR                                 15480098
154900     END-EXEC.                                                    15490098
155000                                                                  15500098
155100     EVALUATE TRUE                                                15510098
155200         WHEN SQLCODE = ZEROS                                     15520098
155300              CONTINUE                                            15530098
155400                                                                  15540098
155500         WHEN SQLCODE = -904                                      15550098
155600         WHEN SQLCODE = -911                                      15560098
155700         WHEN SQLCODE = -913                                      15570098
155800              MOVE 'P7190-CLOSE-SHTL-ACTV-CRTN-CSR'               15580098
155900                                 TO PC049-ABEND-PARAGRAPH         15590098
156000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         15600098
156100                                    PC049-SQL-RETURN-CD           15610098
156200              SET  PC049-ERROR   TO TRUE                          15620098
156300                                                                  15630098
156400         WHEN OTHER                                               15640098
156500              MOVE 'P7190-CLOSE-SHTL-ACTV-CRTN-CSR'               15650098
156600                                 TO PC049-ABEND-PARAGRAPH         15660098
156700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         15670098
156800                                    PC049-SQL-RETURN-CD           15680098
156900              SET  PC049-ERROR   TO TRUE                          15690098
157000     END-EVALUATE.                                                15700098
157100                                                                  15710098
157200                                                                  15720098
157300******************************************************************15730098
157400*                                                                *15740098
157500* OPEN CURSOR - THAT IS USED TO SELECT CARTONS FOR AN OUTBOUND   *15750098
157600* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *15760098
157700* USE WHEN HAVE A STARTING AND ENDING POINT                      *15770098
157800* *** SHUTTLE AND STORAGE TRAILER ***                            *15780098
157900*                                                                *15790098
158000******************************************************************15800098
158100 P7200-OPEN-SHTL-ALL-CTN-CSR.                                     15810098
158200                                                                  15820098
158300     EXEC SQL                                                     15830098
158400         OPEN SHTL-ALL-CTN-CSR                                    15840098
158500     END-EXEC.                                                    15850098
158600                                                                  15860098
158700     EVALUATE TRUE                                                15870098
158800         WHEN SQLCODE = ZEROS                                     15880098
158900              SET PC049-EOF-SHTL-ALL-CNT-NO TO TRUE               15890098
159000                                                                  15900098
159100         WHEN SQLCODE = -904                                      15910098
159200         WHEN SQLCODE = -911                                      15920098
159300         WHEN SQLCODE = -913                                      15930098
159400              MOVE 'P7200-OPEN-SHTL-ALL-CTN-CSR'                  15940098
159500                                 TO PC049-ABEND-PARAGRAPH         15950098
159600              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         15960098
159700                                    PC049-SQL-RETURN-CD           15970098
159800              SET  PC049-ERROR   TO TRUE                          15980098
159900                                                                  15990098
160000         WHEN OTHER                                               16000098
160100              MOVE 'P7200-OPEN-SHTL-ALL-CTN-CSR'                  16010098
160200                                 TO PC049-ABEND-PARAGRAPH         16020098
160300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         16030098
160400                                    PC049-SQL-RETURN-CD           16040098
160500              SET  PC049-ERROR   TO TRUE                          16050098
160600     END-EVALUATE.                                                16060098
160700                                                                  16070098
160800                                                                  16080098
160900******************************************************************16090098
161000*                                                                *16100098
161100*FETCH CURSOR - THAT IS USED TO SELECT CARTONS FOR AN OUTBOUND   *16110098
161200* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *16120098
161300* USE WHEN HAVE A STARTING AND ENDING POINT                      *16130098
161400* *** SHUTTLE AND STORAGE TRAILER ***                            *16140098
161500*                                                                *16150098
161600******************************************************************16160098
161700 P7205-FETCH-SHTL-ALL-CTN-CSR.                                    16170098
161800                                                                  16180098
161900     EXEC SQL                                                     16190098
162000          FETCH SHTL-ALL-CTN-CSR                                  16200098
162100          INTO  :PC049-PV-REC-TYPE                                16210098
162200               ,:SUCRDV-SHIPT-UNT-ID                              16220098
162300               ,:SUCRDV-OPER-UNT-ID                               16230098
162400               ,:SUCRDV-DOOR-ID                                   16240098
162500               ,:SUCRDV-DIVERT-TMST                               16250098
162600               ,:SUCDOT-STRT-SCN-USR-ID                           16260098
162700               ,:SUCDOT-OTBND-TRIP-ID                             16270098
162800               ,:SUCRDV-ACTV-CDE                                  16280098
162900               ,:SUCRDV-PRC-RSN-CDE                               16290098
163000               ,:SUCRDV-NACTV-USR-ID                              16300098
163100               ,:SUCDOT-END-SCN-USR-ID                            16310098
163200               ,:SUCRDV-DEST-OPER-UNT-ID                          16320098
163300               ,:SUCDOT-STRT-SCN-TMST                             16330098
163400               ,:SUCDOT-END-SCN-TMST                              16340098
163500               ,:PC049-PV-REC-TYPE-2                              16350098
163600     END-EXEC.                                                    16360098
163700                                                                  16370098
163800     EVALUATE TRUE                                                16380098
163900       WHEN SQLCODE = ZEROS                                       16390098
164000            ADD  1  TO  PC049-SCAN-DVRT-CNT                       16400098
164100       WHEN SQLCODE = +100                                        16410098
164200            SET PC049-EOF-SHTL-ALL-CTN   TO TRUE                  16420098
164300                                                                  16430098
164400       WHEN SQLCODE = -904                                        16440098
164500       WHEN SQLCODE = -911                                        16450098
164600       WHEN SQLCODE = -913                                        16460098
164700            MOVE 'P7205-FETCH-SHTL-ALL-CTN-CSR   '                16470098
164800                               TO PC049-ABEND-PARAGRAPH           16480098
164900            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           16490098
165000                                  PC049-SQL-RETURN-CD             16500098
165100            SET  PC049-ERROR   TO TRUE                            16510098
165200                                                                  16520098
165300       WHEN OTHER                                                 16530098
165400            MOVE 'P7205-FETCH-SHTL-ALL-CTN-CSR   '                16540098
165500                               TO PC049-ABEND-PARAGRAPH           16550098
165600            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           16560098
165700                                  PC049-SQL-RETURN-CD             16570098
165800            SET  PC049-ERROR   TO TRUE                            16580098
165900     END-EVALUATE.                                                16590098
166000                                                                  16600098
166100                                                                  16610098
166200******************************************************************16620098
166300*                                                                *16630098
166400*CLOSE CURSOR - THAT IS USED TO SELECT CARTONS FOR AN OUTBOUND   *16640098
166500* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *16650098
166600* USE WHEN HAVE A STARTING AND ENDING POINT                      *16660098
166700* *** SHUTTLE AND STORAGE TRAILER ***                            *16670098
166800*                                                                *16680098
166900******************************************************************16690098
167000 P7210-CLOSE-SHTL-ALL-CTN-CSR.                                    16700098
167100                                                                  16710098
167200     EXEC SQL                                                     16720098
167300         CLOSE SHTL-ALL-CTN-CSR                                   16730098
167400     END-EXEC.                                                    16740098
167500                                                                  16750098
167600     EVALUATE TRUE                                                16760098
167700         WHEN SQLCODE = ZEROS                                     16770098
167800              CONTINUE                                            16780098
167900                                                                  16790098
168000         WHEN SQLCODE = -904                                      16800098
168100         WHEN SQLCODE = -911                                      16810098
168200         WHEN SQLCODE = -913                                      16820098
168300              MOVE 'P7210-CLOSE-SHTL-ALL-CTN-CSR'                 16830098
168400                                 TO PC049-ABEND-PARAGRAPH         16840098
168500              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         16850098
168600                                    PC049-SQL-RETURN-CD           16860098
168700              SET  PC049-ERROR   TO TRUE                          16870098
168800                                                                  16880098
168900         WHEN OTHER                                               16890098
169000              MOVE 'P7210-CLOSE-SHTL-ALL-CTN-CSR'                 16900098
169100                                 TO PC049-ABEND-PARAGRAPH         16910098
169200              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         16920098
169300                                    PC049-SQL-RETURN-CD           16930098
169400              SET  PC049-ERROR   TO TRUE                          16940098
169500     END-EVALUATE.                                                16950098
169600                                                                  16960098
169700                                                                  16970098
169800******************************************************************16980098
169900*                                                                *16990098
170000* OPEN CURSOR - THAT IS USED TO SELECT THE CRTNS FOR AN OUTBOUND *17000098
170100* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *17010098
170200* TRAILER.  WILL ALSO BRING BACK ASSUMED CARTONS (C)            *17020098
170300* USE WHEN HAVE A STARTING WITH A ENDING TMST = 9'S              *17030098
170400* *** SHUTTLE AND STORAGE TRAILER ***                            *17040098
170500*                                                                *17050098
170600******************************************************************17060098
170700 P7220-OPEN-SHTL-TR-AL-CTN-CSR.                                   17070098
170800                                                                  17080098
170900     EXEC SQL                                                     17090098
171000         OPEN SHTL-TR-AL-CTN-CSR                                  17100098
171100     END-EXEC.                                                    17110098
171200                                                                  17120098
171300     EVALUATE TRUE                                                17130098
171400         WHEN SQLCODE = ZEROS                                     17140098
171500              SET PC049-EOF-SHTL-TR-AL-CTN-NO TO TRUE             17150098
171600                                                                  17160098
171700         WHEN SQLCODE = -904                                      17170098
171800         WHEN SQLCODE = -911                                      17180098
171900         WHEN SQLCODE = -913                                      17190098
172000              MOVE 'P7220-OPEN-SHTL-TR-AL-CTN-CSR'                17200098
172100                                 TO PC049-ABEND-PARAGRAPH         17210098
172200              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         17220098
172300                                    PC049-SQL-RETURN-CD           17230098
172400              SET  PC049-ERROR   TO TRUE                          17240098
172500                                                                  17250098
172600         WHEN OTHER                                               17260098
172700              MOVE 'P7220-OPEN-SHTL-TR-AL-CTN-CSR'                17270098
172800                                 TO PC049-ABEND-PARAGRAPH         17280098
172900              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         17290098
173000                                    PC049-SQL-RETURN-CD           17300098
173100              SET  PC049-ERROR   TO TRUE                          17310098
173200     END-EVALUATE.                                                17320098
173300                                                                  17330098
173400                                                                  17340098
173500******************************************************************17350098
173600*                                                                *17360098
173700*FETCH CURSOR - THAT IS USED TO SELECT THE CRTNS FOR AN OUTBOUND *17370098
173800* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *17380098
173900* TRAILER.  WILL ALSO BRING BACK ASSUMED CARTONS (C)            *17390098
174000* USE WHEN HAVE A STARTING WITH A ENDING TMST = 9'S              *17400098
174100* *** SHUTTLE AND STORAGE TRAILER ***                            *17410098
174200*                                                                *17420098
174300******************************************************************17430098
174400 P7225-FETCH-SHTL-TR-AL-CTN-CSR.                                  17440098
174500                                                                  17450098
174600     EXEC SQL                                                     17460098
174700          FETCH SHTL-TR-AL-CTN-CSR                                17470098
174800          INTO  :PC049-PV-REC-TYPE                                17480098
174900               ,:SUCRDV-SHIPT-UNT-ID                              17490098
175000               ,:SUCRDV-OPER-UNT-ID                               17500098
175100               ,:SUCRDV-DOOR-ID                                   17510098
175200               ,:SUCRDV-DIVERT-TMST                               17520098
175300               ,:SUCDOT-STRT-SCN-USR-ID                           17530098
175400               ,:SUCDOT-OTBND-TRIP-ID                             17540098
175500               ,:SUCRDV-ACTV-CDE                                  17550098
175600               ,:SUCRDV-PRC-RSN-CDE                               17560098
175700               ,:SUCRDV-NACTV-USR-ID                              17570098
175800               ,:SUCDOT-END-SCN-USR-ID                            17580098
175900               ,:SUCRDV-DEST-OPER-UNT-ID                          17590098
176000               ,:SUCDOT-STRT-SCN-TMST                             17600098
176100               ,:SUCDOT-END-SCN-TMST                              17610098
176200               ,:PC049-PV-REC-TYPE-2                              17620098
176300     END-EXEC.                                                    17630098
176400                                                                  17640098
176500     EVALUATE TRUE                                                17650098
176600       WHEN SQLCODE = ZEROS                                       17660098
176700            ADD  1  TO  PC049-SCAN-DVRT-CNT                       17670098
176800       WHEN SQLCODE = +100                                        17680098
176900            SET PC049-EOF-SHTL-TR-AL-CTN TO TRUE                  17690098
177000                                                                  17700098
177100       WHEN SQLCODE = -904                                        17710098
177200       WHEN SQLCODE = -911                                        17720098
177300       WHEN SQLCODE = -913                                        17730098
177400            MOVE 'P7225-FETCH-SHTL-TR-AL-CTN-CSR '                17740098
177500                               TO PC049-ABEND-PARAGRAPH           17750098
177600            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           17760098
177700                                  PC049-SQL-RETURN-CD             17770098
177800            SET  PC049-ERROR   TO TRUE                            17780098
177900                                                                  17790098
178000       WHEN OTHER                                                 17800098
178100            MOVE 'P7225-FETCH-SHTL-TR-AL-CTN-CSR '                17810098
178200                               TO PC049-ABEND-PARAGRAPH           17820098
178300            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           17830098
178400                                  PC049-SQL-RETURN-CD             17840098
178500            SET  PC049-ERROR   TO TRUE                            17850098
178600     END-EVALUATE.                                                17860098
178700                                                                  17870098
178800                                                                  17880098
178900******************************************************************17890098
179000*                                                                *17900098
179100*CLOSE CURSOR - THAT IS USED TO SELECT THE CRTNS FOR AN OUTBOUND *17910098
179200* TRAILER - THIS INCLUDES INACTIVE AND SCANNED OFF CARTONS       *17920098
179300* TRAILER.  WILL ALSO BRING BACK ASSUMED CARTONS (C)            *17930098
179400* USE WHEN HAVE A STARTING WITH A ENDING TMST = 9'S              *17940098
179500* *** SHUTTLE AND STORAGE TRAILER ***                            *17950098
179600*                                                                *17960098
179700******************************************************************17970098
179800 P7230-CLOSE-SHTL-TR-AL-CTN-CSR.                                  17980098
179900                                                                  17990098
180000     EXEC SQL                                                     18000098
180100         CLOSE SHTL-TR-AL-CTN-CSR                                 18010098
180200     END-EXEC.                                                    18020098
180300                                                                  18030098
180400     EVALUATE TRUE                                                18040098
180500         WHEN SQLCODE = ZEROS                                     18050098
180600              CONTINUE                                            18060098
180700                                                                  18070098
180800         WHEN SQLCODE = -904                                      18080098
180900         WHEN SQLCODE = -911                                      18090098
181000         WHEN SQLCODE = -913                                      18100098
181100              MOVE 'P7230-CLOSE-SHTL-TR-AL-CTN-CSR'               18110098
181200                                 TO PC049-ABEND-PARAGRAPH         18120098
181300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         18130098
181400                                    PC049-SQL-RETURN-CD           18140098
181500              SET  PC049-ERROR   TO TRUE                          18150098
181600                                                                  18160098
181700         WHEN OTHER                                               18170098
181800              MOVE 'P7230-CLOSE-SHTL-TR-AL-CTN-CSR'               18180098
181900                                 TO PC049-ABEND-PARAGRAPH         18190098
182000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         18200098
182100                                    PC049-SQL-RETURN-CD           18210098
182200              SET  PC049-ERROR   TO TRUE                          18220098
182300     END-EVALUATE.                                                18230098
182400                                                                  18240098
182500                                                                  18250098
182600******************************************************************18260098
182700* OPEN CURSOR TO SELECT ALL CARTONS DIVERTED TO DC DOOR          *18270098
182800******************************************************************18280098
182900 P7235-OPEN-DOOR-DVRT-CSR.                                        18290098
183000                                                                  18300098
183100     EXEC SQL                                                     18310098
183200         OPEN DOOR-DVRT-CRTN-CSR                                  18320098
183300     END-EXEC.                                                    18330098
183400                                                                  18340098
183500     EVALUATE TRUE                                                18350098
183600         WHEN SQLCODE = ZEROS                                     18360098
183700              SET PC049-NOT-EOF-DOOR-CRTN TO TRUE                 18370098
183800                                                                  18380098
183900         WHEN SQLCODE = -904                                      18390098
184000         WHEN SQLCODE = -911                                      18400098
184100         WHEN SQLCODE = -913                                      18410098
184200              MOVE 'P7000-OPEN-DOOR-DVRT-CSR'                     18420098
184300                                 TO PC049-ABEND-PARAGRAPH         18430098
184400              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         18440098
184500                                    PC049-SQL-RETURN-CD           18450098
184600              SET  PC049-ERROR   TO TRUE                          18460098
184700                                                                  18470098
184800         WHEN OTHER                                               18480098
184900              MOVE 'P7000-OPEN-DOOR-DVRT-CSR'                     18490098
185000                                 TO PC049-ABEND-PARAGRAPH         18500098
185100              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         18510098
185200                                    PC049-SQL-RETURN-CD           18520098
185300              SET  PC049-ERROR   TO TRUE                          18530098
185400     END-EVALUATE.                                                18540098
185500                                                                  18550098
185600                                                                  18560098
185700******************************************************************18570098
185800*FETCH CURSOR TO SELECT ALL CARTONS DIVERTED TO DC DOOR          *18580098
185900******************************************************************18590098
186000 P7240-FETCH-DOOR-DVRT-CSR.                                       18600098
186100                                                                  18610098
186200     EXEC SQL                                                     18620098
186300          FETCH DOOR-DVRT-CRTN-CSR                                18630098
186400          INTO  :SUCRDV-SHIPT-UNT-ID                              18640098
186500               ,:SUCRDV-DEST-OPER-UNT-ID                          18650098
186600               ,:SUCRDV-DIVERT-TMST                               18660098
186700               ,:SUCRDV-ACTV-CDE                                  18670098
186800     END-EXEC.                                                    18680098
186900                                                                  18690098
187000     EVALUATE TRUE                                                18700098
187100       WHEN SQLCODE = ZEROS                                       18710098
187200            ADD  1  TO  PC049-DOOR-DVRT-CNT                       18720098
187300                                                                  18730098
187400       WHEN SQLCODE = +100                                        18740098
187500            SET PC049-EOF-DOOR-CRTN TO TRUE                       18750098
187600                                                                  18760098
187700       WHEN SQLCODE = -904                                        18770098
187800       WHEN SQLCODE = -911                                        18780098
187900       WHEN SQLCODE = -913                                        18790098
188000            MOVE 'P7240-FETCH-DOOR-DVRT-CSR  '                    18800098
188100                               TO PC049-ABEND-PARAGRAPH           18810098
188200            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           18820098
188300                                  PC049-SQL-RETURN-CD             18830098
188400            SET  PC049-ERROR   TO TRUE                            18840098
188500                                                                  18850098
188600       WHEN OTHER                                                 18860098
188700            MOVE 'P7240-FETCH-DOOR-DVRT-CSR  '                    18870098
188800                               TO PC049-ABEND-PARAGRAPH           18880098
188900            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           18890098
189000                                  PC049-SQL-RETURN-CD             18900098
189100            SET  PC049-ERROR   TO TRUE                            18910098
189200     END-EVALUATE.                                                18920098
189300                                                                  18930098
189400                                                                  18940098
189500******************************************************************18950098
189600*CLOSE CURSOR TO SELECT ALL CARTONS DIVERTED TO DC DOOR          *18960098
189700******************************************************************18970098
189800 P7245-CLOSE-DOOR-DVRT-CSR.                                       18980098
189900                                                                  18990098
190000     EXEC SQL                                                     19000098
190100         CLOSE DOOR-DVRT-CRTN-CSR                                 19010098
190200     END-EXEC.                                                    19020098
190300                                                                  19030098
190400     EVALUATE TRUE                                                19040098
190500         WHEN SQLCODE = ZEROS                                     19050098
190600              CONTINUE                                            19060098
190700                                                                  19070098
190800         WHEN SQLCODE = -904                                      19080098
190900         WHEN SQLCODE = -911                                      19090098
191000         WHEN SQLCODE = -913                                      19100098
191100              MOVE 'P7245-CLOSE-DOOR-DVRT-CSR  '                  19110098
191200                                 TO PC049-ABEND-PARAGRAPH         19120098
191300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         19130098
191400                                    PC049-SQL-RETURN-CD           19140098
191500              SET  PC049-ERROR   TO TRUE                          19150098
191600         WHEN OTHER                                               19160098
191700              MOVE 'P7245-CLOSE-DOOR-DVRT-CSR  '                  19170098
191800                                 TO PC049-ABEND-PARAGRAPH         19180098
191900              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         19190098
192000                                  PC049-SQL-RETURN-CD             19200098
192100              SET  PC049-ERROR   TO TRUE                          19210098
192200     END-EVALUATE.                                                19220098
192300                                                                  19230098
192400******************************************************************19240098
192500* OPEN CURSOR TO SELECT CARTONS THAT HAVE BEEN SCANNED OFF       *19250098
192600* OF A TRAILER BECAUSE AN AUDIT HAS OCCURRED.                    *19260098
192700******************************************************************19270098
192800 P7250-OPEN-SCAN-OFF-CSR.                                         19280098
192900                                                                  19290098
193000     EXEC SQL                                                     19300098
193100         OPEN SCAN-OFF-CSR                                        19310098
193200     END-EXEC.                                                    19320098
193300                                                                  19330098
193400     EVALUATE TRUE                                                19340098
193500         WHEN SQLCODE = ZEROS                                     19350098
193600              SET PC049-NOT-EOF-SCAN-OFF TO TRUE                  19360098
193700                                                                  19370098
193800         WHEN SQLCODE = -904                                      19380098
193900         WHEN SQLCODE = -911                                      19390098
194000         WHEN SQLCODE = -913                                      19400098
194100              MOVE 'P7250-OPEN-SCAN-OFF-CSR'                      19410098
194200                                 TO PC049-ABEND-PARAGRAPH         19420098
194300              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         19430098
194400                                    PC049-SQL-RETURN-CD           19440098
194500              SET  PC049-ERROR   TO TRUE                          19450098
194600                                                                  19460098
194700         WHEN OTHER                                               19470098
194800              MOVE 'P7250-OPEN-SCAN-OFF-CSR'                      19480098
194900                                 TO PC049-ABEND-PARAGRAPH         19490098
195000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         19500098
195100                                    PC049-SQL-RETURN-CD           19510098
195200              SET PC049-ERROR    TO TRUE                          19520098
195300     END-EVALUATE.                                                19530098
195400*                                                                 19540098
195500*                                                                 19550098
195600******************************************************************19560098
195700*                                                                *19570098
195800* FETCH CURSOR TO SELECT CARTONS THAT HAVE BEEN SCANNED OFF      *19580098
195900* OF A TRAILER BECAUSE AN AUDIT HAS OCCURRED.                    *19590098
196000*                                                                *19600098
196100******************************************************************19610098
196200 P7255-FETCH-SCAN-OFF-CSR.                                        19620098
196300                                                                  19630098
196400         EXEC SQL                                                 19640098
196500          FETCH SCAN-OFF-CSR                                      19650098
196600             INTO  :SUT00027-SHIPT-UNT-ID                         19660098
196700                  ,:SUT00027-SCN-CDE                              19670098
196800         END-EXEC                                                 19680098
196900                                                                  19690098
197000         EVALUATE TRUE                                            19700098
197100             WHEN SQLCODE = ZEROS                                 19710098
197200                  ADD  1  TO  PC049-SCAN-OFF-CNT                  19720098
197300                                                                  19730098
197400             WHEN SQLCODE = +100                                  19740098
197500                 SET PC049-EOF-SCAN-OFF TO TRUE                   19750098
197600                                                                  19760098
197700             WHEN SQLCODE = -904                                  19770098
197800             WHEN SQLCODE = -911                                  19780098
197900             WHEN SQLCODE = -913                                  19790098
198000                 MOVE 'P7255-FETCH-SCAN-OFF-CSR'                  19800098
198100                                    TO PC049-ABEND-PARAGRAPH      19810098
198200                 MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE      19820098
198300                                       PC049-SQL-RETURN-CD        19830098
198400                 SET PC049-ERROR    TO TRUE                       19840098
198500                                                                  19850098
198600             WHEN OTHER                                           19860098
198700                 MOVE 'P7255-FETCH-SCAN-OFF-CSR'                  19870098
198800                                    TO PC049-ABEND-PARAGRAPH      19880098
198900                 MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE      19890098
199000                                       PC049-SQL-RETURN-CD        19900098
199100                 SET PC049-ERROR    TO TRUE                       19910098
199200         END-EVALUATE.                                            19920098
199300*                                                                 19930098
199400*                                                                 19940098
199500******************************************************************19950098
199600*                                                                *19960098
199700* CLOSE CURSOR TO SELECT CARTONS THAT HAVE BEEN SCANNED OFF      *19970098
199800* OF A TRAILER BECAUSE AN AUDIT HAS OCCURRED.                    *19980098
199900*                                                                *19990098
200000******************************************************************20000098
200100 P7260-CLOSE-SCAN-OFF-CSR.                                        20010098
200200     EXEC SQL                                                     20020098
200300         CLOSE SCAN-OFF-CSR                                       20030098
200400     END-EXEC.                                                    20040098
200500                                                                  20050098
200600     EVALUATE TRUE                                                20060098
200700         WHEN SQLCODE = ZEROS                                     20070098
200800              CONTINUE                                            20080098
200900                                                                  20090098
201000         WHEN SQLCODE = -904                                      20100098
201100         WHEN SQLCODE = -911                                      20110098
201200         WHEN SQLCODE = -913                                      20120098
201300              MOVE 'P7260-CLOSE-SCAN-OFF-CSR   '                  20130098
201400                                 TO PC049-ABEND-PARAGRAPH         20140098
201500              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         20150098
201600                                    PC049-SQL-RETURN-CD           20160098
201700              SET PC049-ERROR    TO TRUE                          20170098
201800                                                                  20180098
201900         WHEN OTHER                                               20190098
202000              MOVE 'P7260-CLOSE-SCAN-OFF-CSR   '                  20200098
202100                                 TO PC049-ABEND-PARAGRAPH         20210098
202200              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         20220098
202300                                    PC049-SQL-RETURN-CD           20230098
202400              SET PC049-ERROR    TO TRUE                          20240098
202500     END-EVALUATE.                                                20250098
202600*                                                                 20260098
202700******************************************************************20270098
202800* OPEN CURSOR TO SELECT CARTONS DIVERTED TO DC DOOR BY DATE       20280098
202900******************************************************************20290098
203000 P7265-OPEN-DATE-DVRT-CSR.                                        20300098
203100                                                                  20310098
203200     EXEC SQL                                                     20320098
203300         OPEN DATE-DVRT-CRTN-CSR                                  20330098
203400     END-EXEC.                                                    20340098
203500                                                                  20350098
203600     EVALUATE TRUE                                                20360098
203700         WHEN SQLCODE = ZEROS                                     20370098
203800              SET PC049-NOT-EOF-DATE-DVRT-CRTN TO TRUE            20380098
203900                                                                  20390098
204000         WHEN SQLCODE = -904                                      20400098
204100         WHEN SQLCODE = -911                                      20410098
204200         WHEN SQLCODE = -913                                      20420098
204300              MOVE 'P7265-OPEN-DATE-DVRT-CSR'                     20430098
204400                                 TO PC049-ABEND-PARAGRAPH         20440098
204500              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         20450098
204600                                    PC049-SQL-RETURN-CD           20460098
204700              SET  PC049-ERROR   TO TRUE                          20470098
204800                                                                  20480098
204900         WHEN OTHER                                               20490098
205000              MOVE 'P7265-OPEN-DATE-DVRT-CSR'                     20500098
205100                                 TO PC049-ABEND-PARAGRAPH         20510098
205200              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         20520098
205300                                    PC049-SQL-RETURN-CD           20530098
205400              SET  PC049-ERROR   TO TRUE                          20540098
205500     END-EVALUATE.                                                20550098
205600                                                                  20560098
205700                                                                  20570098
205800******************************************************************20580098
205900*FETCH CURSOR TO SELECT CARTONS DIVERTED TO DC DOOR BY DATE       20590098
206000******************************************************************20600098
206100 P7270-FETCH-DATE-DVRT-CSR.                                       20610098
206200                                                                  20620098
206300     EXEC SQL                                                     20630098
206400          FETCH DATE-DVRT-CRTN-CSR                                20640098
206500          INTO  :SUCRDV-SHIPT-UNT-ID                              20650098
206600               ,:SUCRDV-DEST-OPER-UNT-ID                          20660098
206700               ,:SUCRDV-DIVERT-TMST                               20670098
206800               ,:SUCRDV-ACTV-CDE                                  20680098
206900     END-EXEC.                                                    20690098
207000                                                                  20700098
207100     EVALUATE TRUE                                                20710098
207200       WHEN SQLCODE = ZEROS                                       20720098
207300            ADD  1  TO  PC049-DOOR-DVRT-CNT                       20730098
207400                                                                  20740098
207500       WHEN SQLCODE = +100                                        20750098
207600            SET PC049-EOF-DATE-DVRT-CRTN TO TRUE                  20760098
207700                                                                  20770098
207800       WHEN SQLCODE = -904                                        20780098
207900       WHEN SQLCODE = -911                                        20790098
208000       WHEN SQLCODE = -913                                        20800098
208100            MOVE 'P7270-FETCH-DATE-DVRT-CSR  '                    20810098
208200                               TO PC049-ABEND-PARAGRAPH           20820098
208300            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           20830098
208400                                  PC049-SQL-RETURN-CD             20840098
208500            SET  PC049-ERROR   TO TRUE                            20850098
208600                                                                  20860098
208700       WHEN OTHER                                                 20870098
208800            MOVE 'P7270-FETCH-DATE-DVRT-CSR  '                    20880098
208900                               TO PC049-ABEND-PARAGRAPH           20890098
209000            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           20900098
209100                                  PC049-SQL-RETURN-CD             20910098
209200            SET  PC049-ERROR   TO TRUE                            20920098
209300     END-EVALUATE.                                                20930098
209400                                                                  20940098
209500                                                                  20950098
209600******************************************************************20960098
209700*CLOSE CURSOR TO SELECT CARTONS DIVERTED TO DC DOOR BY DATE       20970098
209800******************************************************************20980098
209900 P7275-CLOSE-DATE-DVRT-CSR.                                       20990098
210000                                                                  21000098
210100     EXEC SQL                                                     21010098
210200         CLOSE DATE-DVRT-CRTN-CSR                                 21020098
210300     END-EXEC.                                                    21030098
210400                                                                  21040098
210500     EVALUATE TRUE                                                21050098
210600         WHEN SQLCODE = ZEROS                                     21060098
210700              CONTINUE                                            21070098
210800                                                                  21080098
210900         WHEN SQLCODE = -904                                      21090098
211000         WHEN SQLCODE = -911                                      21100098
211100         WHEN SQLCODE = -913                                      21110098
211200              MOVE 'P7275-CLOSE-DATE-DVRT-CSR  '                  21120098
211300                                 TO PC049-ABEND-PARAGRAPH         21130098
211400              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         21140098
211500                                    PC049-SQL-RETURN-CD           21150098
211600              SET  PC049-ERROR   TO TRUE                          21160098
211700         WHEN OTHER                                               21170098
211800              MOVE 'P7275-CLOSE-DATE-DVRT-CSR  '                  21180098
211900                                 TO PC049-ABEND-PARAGRAPH         21190098
212000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         21200098
212100                                  PC049-SQL-RETURN-CD             21210098
212200              SET  PC049-ERROR   TO TRUE                          21220098
212300     END-EVALUATE.                                                21230098
212400                                                                  21240098
212500*LMM ADD                                                          21250098
212600******************************************************************21260098
212700*                                                                *21270098
212800* OPEN CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *21280098
212900* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER AT THE TIME THE      *21290098
213000* AUDIT IS STARTED.                                              *21300098
213100* USE WHEN HAVE A STARTING AND ENDING TMST                       *21310098
213200* *** SHUTTLE AND STORAGE TRAILERS ***                           *21320098
213300*                                                                *21330098
213400******************************************************************21340098
213500 P7280-OPEN-AUD-SHTL-ACTV-CSR.                                    21350098
213600                                                                  21360098
213700     EXEC SQL                                                     21370098
213800         OPEN AUD-SHTL-ACTV-CSR                                   21380098
213900     END-EXEC.                                                    21390098
214000                                                                  21400098
214100     EVALUATE TRUE                                                21410098
214200         WHEN SQLCODE = ZEROS                                     21420098
214300              SET PC049-NOT-EOF-AUD-STL-ACTV-CSR TO TRUE          21430098
214400                                                                  21440098
214500         WHEN SQLCODE = -904                                      21450098
214600         WHEN SQLCODE = -911                                      21460098
214700         WHEN SQLCODE = -913                                      21470098
214800              MOVE 'P7280-OPEN-AUD-SHTL-ACTV-CSR'                 21480098
214900                                 TO PC049-ABEND-PARAGRAPH         21490098
215000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         21500098
215100                                    PC049-SQL-RETURN-CD           21510098
215200              SET  PC049-ERROR   TO TRUE                          21520098
215300                                                                  21530098
215400         WHEN OTHER                                               21540098
215500              MOVE 'P7280-OPEN-AUD-SHTL-ACTV-CSR'                 21550098
215600                                 TO PC049-ABEND-PARAGRAPH         21560098
215700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         21570098
215800                                    PC049-SQL-RETURN-CD           21580098
215900              SET  PC049-ERROR   TO TRUE                          21590098
216000     END-EVALUATE.                                                21600098
216100                                                                  21610098
216200                                                                  21620098
216300******************************************************************21630098
216400*                                                                *21640098
216500* FETCH CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE        *21650098
216600* CARTONS CURRENTLY ATTACHED TO AN OUTBOUND TRAILER AT THE TIME  *21660098
216700* THE AUDIT WAS STARTED.                                         *21670098
216800* USE WHEN HAVE A STARTING AND ENDING TMST                       *21680098
216900* *** SHUTTLE AND STORAGE TRAILERS ***                           *21690098
217000*                                                                *21700098
217100******************************************************************21710098
217200 P7285-FETCH-AUD-SHTL-ACTV-CSR.                                   21720098
217300                                                                  21730098
217400     EXEC SQL                                                     21740098
217500          FETCH AUD-SHTL-ACTV-CSR                                 21750098
217600          INTO  :PC049-PV-REC-TYPE                                21760098
217700               ,:SUCRDV-SHIPT-UNT-ID                              21770098
217800               ,:SUCRDV-OPER-UNT-ID                               21780098
217900               ,:SUCRDV-DOOR-ID                                   21790098
218000               ,:SUCRDV-DIVERT-TMST                               21800098
218100               ,:SUCDOT-STRT-SCN-USR-ID                           21810098
218200               ,:SUCDOT-OTBND-TRIP-ID                             21820098
218300               ,:SUCRDV-ACTV-CDE                                  21830098
218400               ,:SUCRDV-PRC-RSN-CDE                               21840098
218500               ,:SUCRDV-NACTV-USR-ID                              21850098
218600               ,:SUCDOT-END-SCN-USR-ID                            21860098
218700               ,:SUCDOT-STRT-SCN-TMST                             21870098
218800               ,:SUCDOT-END-SCN-TMST                              21880098
218900               ,:PC049-PV-REC-TYPE-2                              21890098
219000     END-EXEC.                                                    21900098
219100                                                                  21910098
219200     EVALUATE TRUE                                                21920098
219300       WHEN SQLCODE = ZEROS                                       21930098
219400            ADD  1  TO  PC049-SCAN-CRTN-CNT                       21940098
219500       WHEN SQLCODE = +100                                        21950098
219600            SET PC049-EOF-AUD-STL-ACTV-CSR TO TRUE                21960098
219700                                                                  21970098
219800       WHEN SQLCODE = -904                                        21980098
219900       WHEN SQLCODE = -911                                        21990098
220000       WHEN SQLCODE = -913                                        22000098
220100            MOVE 'P7285-FETCH-AUD-SHTL-ACTV-CSR '                 22010098
220200                               TO PC049-ABEND-PARAGRAPH           22020098
220300            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           22030098
220400                                  PC049-SQL-RETURN-CD             22040098
220500            SET  PC049-ERROR   TO TRUE                            22050098
220600                                                                  22060098
220700       WHEN OTHER                                                 22070098
220800            MOVE 'P7285-FETCH-AUD-SHTL-ACTV-CSR '                 22080098
220900                               TO PC049-ABEND-PARAGRAPH           22090098
221000            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           22100098
221100                                  PC049-SQL-RETURN-CD             22110098
221200            SET  PC049-ERROR   TO TRUE                            22120098
221300     END-EVALUATE.                                                22130098
221400                                                                  22140098
221500                                                                  22150098
221600******************************************************************22160098
221700*                                                                *22170098
221800*CLOSE CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *22180098
221900* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER AT THE TIME THE      *22190098
222000* AUDIT WAS STARTED.                                             *22200098
222100* USE WHEN HAVE A STARTING AND ENDING TMST                       *22210098
222200* *** SHUTTLE AND STORAGE TRAILER ***                            *22220098
222300*                                                                *22230098
222400******************************************************************22240098
222500 P7290-CLOSE-AUD-SHTL-ACTV-CSR.                                   22250098
222600                                                                  22260098
222700     EXEC SQL                                                     22270098
222800         CLOSE AUD-SHTL-ACTV-CSR                                  22280098
222900     END-EXEC.                                                    22290098
223000                                                                  22300098
223100     EVALUATE TRUE                                                22310098
223200         WHEN SQLCODE = ZEROS                                     22320098
223300              CONTINUE                                            22330098
223400                                                                  22340098
223500         WHEN SQLCODE = -904                                      22350098
223600         WHEN SQLCODE = -911                                      22360098
223700         WHEN SQLCODE = -913                                      22370098
223800              MOVE 'P7290-CLOSE-AUD-SHTL-ACTV-CSR'                22380098
223900                                 TO PC049-ABEND-PARAGRAPH         22390098
224000              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         22400098
224100                                    PC049-SQL-RETURN-CD           22410098
224200              SET  PC049-ERROR   TO TRUE                          22420098
224300                                                                  22430098
224400         WHEN OTHER                                               22440098
224500              MOVE 'P7290-CLOSE-AUD-SHTL-ACTV-CSR'                22450098
224600                                 TO PC049-ABEND-PARAGRAPH         22460098
224700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         22470098
224800                                    PC049-SQL-RETURN-CD           22480098
224900              SET  PC049-ERROR   TO TRUE                          22490098
225000     END-EVALUATE.                                                22500098
225100                                                                  22510098
225200                                                                  22520098
225300******************************************************************22530098
225400*                                                                *22540098
225500* OPEN CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *22550098
225600* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER AT THE TIME THE      *22560098
225700* AUDIT WAS STARTED.                                             *22570098
225800* USE WHEN HAVE A STARTING AND ENDING TMST                       *22580098
225900* *** SHIPPING TRAILER ***                                       *22590098
226000*                                                                *22600098
226100******************************************************************22610098
226200 P7320-OPEN-AUD-SHP-ACTV-CSR.                                     22620098
226300                                                                  22630098
226400     EXEC SQL                                                     22640098
226500         OPEN AUD-SHP-ACTV-CSR                                    22650098
226600     END-EXEC.                                                    22660098
226700                                                                  22670098
226800     EVALUATE TRUE                                                22680098
226900         WHEN SQLCODE = ZEROS                                     22690098
227000              SET PC049-NOT-EOF-AUD-SHP-ACTV-CSR TO TRUE          22700098
227100                                                                  22710098
227200         WHEN SQLCODE = -904                                      22720098
227300         WHEN SQLCODE = -911                                      22730098
227400         WHEN SQLCODE = -913                                      22740098
227500              MOVE 'P7320-OPEN-AUD-SHP-ACTV-CSR'                  22750098
227600                                 TO PC049-ABEND-PARAGRAPH         22760098
227700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         22770098
227800                                    PC049-SQL-RETURN-CD           22780098
227900              SET  PC049-ERROR   TO TRUE                          22790098
228000                                                                  22800098
228100         WHEN OTHER                                               22810098
228200              MOVE 'P7320-OPEN-AUD-SHP-ACTV-CSR'                  22820098
228300                                 TO PC049-ABEND-PARAGRAPH         22830098
228400              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         22840098
228500                                    PC049-SQL-RETURN-CD           22850098
228600              SET  PC049-ERROR   TO TRUE                          22860098
228700     END-EVALUATE.                                                22870098
228800                                                                  22880098
228900                                                                  22890098
229000******************************************************************22900098
229100*                                                                *22910098
229200* FETCH CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE        *22920098
229300* CARTONS CURRENTLY ATTACHED TO AN OUTBOUND TRAILER AT THE TIME  *22930098
229400* THE AUDIT WAS STARTED.                                         *22940098
229500* USE WHEN HAVE A STARTING AND ENDING TMST                       *22950098
229600* *** SHIPPING TRAILER ***                                       *22960098
229700*                                                                *22970098
229800******************************************************************22980098
229900 P7325-FETCH-AUD-SHP-ACTV-CSR.                                    22990098
230000                                                                  23000098
230100     EXEC SQL                                                     23010098
230200          FETCH AUD-SHP-ACTV-CSR                                  23020098
230300          INTO  :PC049-PV-REC-TYPE                                23030098
230400               ,:SUCRDV-SHIPT-UNT-ID                              23040098
230500               ,:SUCRDV-OPER-UNT-ID                               23050098
230600               ,:SUCRDV-DOOR-ID                                   23060098
230700               ,:SUCRDV-DIVERT-TMST                               23070098
230800               ,:SUCDOT-STRT-SCN-USR-ID                           23080098
230900               ,:SUCDOT-OTBND-TRIP-ID                             23090098
231000               ,:SUCRDV-ACTV-CDE                                  23100098
231100               ,:SUCRDV-PRC-RSN-CDE                               23110098
231200               ,:SUCRDV-NACTV-USR-ID                              23120098
231300               ,:SUCDOT-END-SCN-USR-ID                            23130098
231400               ,:SUCDOT-STRT-SCN-TMST                             23140098
231500               ,:SUCDOT-END-SCN-TMST                              23150098
231600               ,:PC049-PV-REC-TYPE-2                              23160098
231700     END-EXEC.                                                    23170098
231800                                                                  23180098
231900     EVALUATE TRUE                                                23190098
232000       WHEN SQLCODE = ZEROS                                       23200098
232100            ADD  1  TO  PC049-SCAN-CRTN-CNT                       23210098
232200       WHEN SQLCODE = +100                                        23220098
232300            SET PC049-EOF-AUD-SHP-ACTV-CSR TO TRUE                23230098
232400                                                                  23240098
232500       WHEN SQLCODE = -904                                        23250098
232600       WHEN SQLCODE = -911                                        23260098
232700       WHEN SQLCODE = -913                                        23270098
232800            MOVE 'P7325-FETCH-AUD-SHP-ACTV-CSR '                  23280098
232900                               TO PC049-ABEND-PARAGRAPH           23290098
233000            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           23300098
233100                                  PC049-SQL-RETURN-CD             23310098
233200            SET  PC049-ERROR   TO TRUE                            23320098
233300                                                                  23330098
233400       WHEN OTHER                                                 23340098
233500            MOVE 'P7325-FETCH-AUD-SHP-ACTV-CSR '                  23350098
233600                               TO PC049-ABEND-PARAGRAPH           23360098
233700            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           23370098
233800                                  PC049-SQL-RETURN-CD             23380098
233900            SET  PC049-ERROR   TO TRUE                            23390098
234000     END-EVALUATE.                                                23400098
234100                                                                  23410098
234200                                                                  23420098
234300******************************************************************23430098
234400*                                                                *23440098
234500*CLOSE CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *23450098
234600* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER AT THE TIME THE      *23460098
234700* AUDIT WAS STARTED.                                             *23470098
234800* USE WHEN HAVE A STARTING AND ENDING TMST                       *23480098
234900* *** SHIPPING TRAILER ***                                       *23490098
235000*                                                                *23500098
235100******************************************************************23510098
235200 P7330-CLOSE-AUD-SHP-ACTV-CSR.                                    23520098
235300                                                                  23530098
235400     EXEC SQL                                                     23540098
235500         CLOSE AUD-SHP-ACTV-CSR                                   23550098
235600     END-EXEC.                                                    23560098
235700                                                                  23570098
235800     EVALUATE TRUE                                                23580098
235900         WHEN SQLCODE = ZEROS                                     23590098
236000              CONTINUE                                            23600098
236100                                                                  23610098
236200         WHEN SQLCODE = -904                                      23620098
236300         WHEN SQLCODE = -911                                      23630098
236400         WHEN SQLCODE = -913                                      23640098
236500              MOVE 'P7330-CLOSE-AUD-SHP-ACTV-CSR'                 23650098
236600                                 TO PC049-ABEND-PARAGRAPH         23660098
236700              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23670098
236800                                    PC049-SQL-RETURN-CD           23680098
236900              SET  PC049-ERROR   TO TRUE                          23690098
237000                                                                  23700098
237100         WHEN OTHER                                               23710098
237200              MOVE 'P7330-CLOSE-AUD-SHP-TRLR-ACTV-CSR'            23720098
237300                                 TO PC049-ABEND-PARAGRAPH         23730098
237400              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23740098
237500                                    PC049-SQL-RETURN-CD           23750098
237600              SET  PC049-ERROR   TO TRUE                          23760098
237700     END-EVALUATE.                                                23770098
237800                                                                  23780098
237900******************************************************************23790099
238020* OPEN CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *23802099
238030* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER RETRIEVED IN SHIPT-  *23803099
238031* UNT-ID ORDER. USE WHEN HAVE A STARTING AND ENDING TMST         *23803199
238050* *** SHUTTLE AND STORAGE TRAILERS ***                           *23805099
238060******************************************************************23806099
238070 P7340-OPEN-SHTLACTV-CRTN-CSR.                                    23807099
238080                                                                  23808099
238090     EXEC SQL                                                     23809099
238091         OPEN SHTLACTV-CRTN-CSR                                   23809199
238092     END-EXEC.                                                    23809299
238093                                                                  23809399
238094     EVALUATE TRUE                                                23809499
238095         WHEN SQLCODE = ZEROS                                     23809599
238096              SET PC049-NOT-EOF-STLACTV-CRTN TO TRUE              23809699
238097                                                                  23809799
238098         WHEN SQLCODE = -904                                      23809899
238099         WHEN SQLCODE = -911                                      23809999
238100         WHEN SQLCODE = -913                                      23810099
238101              MOVE 'P7340-OPEN-SHTLACTV-CRTN-CSR'                 23810199
238102                                 TO PC049-ABEND-PARAGRAPH         23810299
238103              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23810399
238104                                    PC049-SQL-RETURN-CD           23810499
238105              SET  PC049-ERROR   TO TRUE                          23810599
238106                                                                  23810699
238107         WHEN OTHER                                               23810799
238108              MOVE 'P7340-OPEN-SHTLACTV-CRTN-CSR'                 23810899
238109                                 TO PC049-ABEND-PARAGRAPH         23810999
238110              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23811099
238111                                    PC049-SQL-RETURN-CD           23811199
238112              SET  PC049-ERROR   TO TRUE                          23811299
238113     END-EVALUATE.                                                23811399
238114                                                                  23811499
238116******************************************************************23811699
238118* FETCH CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE        *23811899
238119* CARTONS CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.             *23811999
238120* USE WHEN HAVE A STARTING AND ENDING TMST                       *23812099
238121* *** SHUTTLE AND STORAGE TRAILERS ***                           *23812199
238123******************************************************************23812399
238124 P7345-FETCH-SHTLACTV-CRTN-CSR.                                   23812499
238125                                                                  23812599
238126     EXEC SQL                                                     23812699
238127          FETCH SHTLACTV-CRTN-CSR                                 23812799
238128          INTO  :PC049-PV-REC-TYPE                                23812899
238129               ,:SUCRDV-SHIPT-UNT-ID                              23812999
238130               ,:SUCRDV-OPER-UNT-ID                               23813099
238131               ,:SUCRDV-DOOR-ID                                   23813199
238132               ,:SUCRDV-DIVERT-TMST                               23813299
238133               ,:SUCDOT-STRT-SCN-USR-ID                           23813399
238134               ,:SUCDOT-OTBND-TRIP-ID                             23813499
238135               ,:SUCRDV-ACTV-CDE                                  23813599
238136               ,:SUCRDV-PRC-RSN-CDE                               23813699
238137               ,:SUCRDV-NACTV-USR-ID                              23813799
238138               ,:SUCDOT-END-SCN-USR-ID                            23813899
238139               ,:SUCDOT-STRT-SCN-TMST                             23813999
238140               ,:SUCDOT-END-SCN-TMST                              23814099
238141               ,:PC049-PV-REC-TYPE-2                              23814199
238142     END-EXEC.                                                    23814299
238143                                                                  23814399
238144     EVALUATE TRUE                                                23814499
238145       WHEN SQLCODE = ZEROS                                       23814599
238146            ADD  1  TO  PC049-SCAN-CRTN-CNT                       23814699
238147       WHEN SQLCODE = +100                                        23814799
238148            SET PC049-EOF-STLACTV-CRTN TO TRUE                    23814899
238149                                                                  23814999
238150       WHEN SQLCODE = -904                                        23815099
238151       WHEN SQLCODE = -911                                        23815199
238152       WHEN SQLCODE = -913                                        23815299
238153            MOVE 'P7345-FETCH-SHTLACTV-CRTN-CSR '                 23815399
238154                               TO PC049-ABEND-PARAGRAPH           23815499
238155            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           23815599
238156                                  PC049-SQL-RETURN-CD             23815699
238157            SET  PC049-ERROR   TO TRUE                            23815799
238158                                                                  23815899
238159       WHEN OTHER                                                 23815999
238160            MOVE 'P7345-FETCH-SHTLACTV-CRTN-CSR '                 23816099
238161                               TO PC049-ABEND-PARAGRAPH           23816199
238162            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           23816299
238163                                  PC049-SQL-RETURN-CD             23816399
238164            SET  PC049-ERROR   TO TRUE                            23816499
238165     END-EVALUATE.                                                23816599
238166                                                                  23816699
238167                                                                  23816799
238168******************************************************************23816899
238170*CLOSE CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *23817099
238171* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *23817199
238172* USE WHEN HAVE A STARTING AND ENDING TMST                       *23817299
238173* *** SHUTTLE AND STORAGE TRAILER ***                            *23817399
238175******************************************************************23817599
238176 P7350-CLOSE-SHTLACTV-CRTN-CSR.                                   23817699
238177                                                                  23817799
238178     EXEC SQL                                                     23817899
238179         CLOSE SHTLACTV-CRTN-CSR                                  23817999
238180     END-EXEC.                                                    23818099
238181                                                                  23818199
238182     EVALUATE TRUE                                                23818299
238183         WHEN SQLCODE = ZEROS                                     23818399
238184              CONTINUE                                            23818499
238185                                                                  23818599
238186         WHEN SQLCODE = -904                                      23818699
238187         WHEN SQLCODE = -911                                      23818799
238188         WHEN SQLCODE = -913                                      23818899
238189              MOVE 'P7350-CLOSE-SHTLACTV-CRTN-CSR'                23818999
238190                                 TO PC049-ABEND-PARAGRAPH         23819099
238191              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23819199
238192                                    PC049-SQL-RETURN-CD           23819299
238193              SET  PC049-ERROR   TO TRUE                          23819399
238194                                                                  23819499
238195         WHEN OTHER                                               23819599
238196              MOVE 'P7350-CLOSE-SHTLACTV-CRTN-CSR'                23819699
238197                                 TO PC049-ABEND-PARAGRAPH         23819799
238198              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23819899
238199                                    PC049-SQL-RETURN-CD           23819999
238200              SET  PC049-ERROR   TO TRUE                          23820099
238201     END-EVALUATE.                                                23820199
238202                                                                  23820299
238203******************************************************************23820399
238204*                                                                *23820499
238205* OPEN CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *23820599
238206* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *23820699
238207* USE WHEN HAVE A STARTING AND ENDING TMST                       *23820799
238208* ALSO BRINGS BACK THE UPC, TRN AND TRN LINE NBR FROM THE         23820899
238209* SUT_OTBND_UPC TABLE                                             23820999
238210* *** SHIPPING TRAILER ***                                       *23821099
238211*                                                                *23821199
238212******************************************************************23821299
238213 P7360-OPEN-SHP-ACV-CR-UPC-CSR.                                   23821399
238214                                                                  23821499
238215     EXEC SQL                                                     23821599
238216         OPEN SHP-ACV-CR-UPC-CSR                                  23821699
238217     END-EXEC.                                                    23821799
238218                                                                  23821899
238219     EVALUATE TRUE                                                23821999
238220         WHEN SQLCODE = ZEROS                                     23822099
238221              SET PC049-NOT-EOF-SHP-ACTV-CRT-UPC  TO TRUE         23822199
238222                                                                  23822299
238223         WHEN SQLCODE = -904                                      23822399
238224         WHEN SQLCODE = -911                                      23822499
238225         WHEN SQLCODE = -913                                      23822599
238226              MOVE 'P7360-OPEN-SHP-ACV-CR-UPC-CSR'                23822699
238227                                 TO PC049-ABEND-PARAGRAPH         23822799
238228              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23822899
238229                                    PC049-SQL-RETURN-CD           23822999
238230              SET  PC049-ERROR   TO TRUE                          23823099
238231                                                                  23823199
238232         WHEN OTHER                                               23823299
238233              MOVE 'P7360-OPEN-SHP-ACV-CR-UPC-CSR'                23823399
238234                                 TO PC049-ABEND-PARAGRAPH         23823499
238235              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23823599
238236                                    PC049-SQL-RETURN-CD           23823699
238237              SET  PC049-ERROR   TO TRUE                          23823799
238238     END-EVALUATE.                                                23823899
238239                                                                  23823999
238240                                                                  23824099
238241******************************************************************23824199
238242*                                                                *23824299
238243* FETCH CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE        *23824399
238244* CARTONS CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.             *23824499
238245* USE WHEN HAVE A STARTING AND ENDING TMST                       *23824599
238246* *** SHIPPING TRAILER ***                                       *23824699
238247*                                                                *23824799
238248******************************************************************23824899
238249 P7370-FETCH-SHP-ACV-CR-UPC-CSR.                                  23824999
238250                                                                  23825099
238251     EXEC SQL                                                     23825199
238252          FETCH SHP-ACV-CR-UPC-CSR                                23825299
238253          INTO  :PC049-PV-REC-TYPE                                23825399
238254               ,:SUCRDV-SHIPT-UNT-ID                              23825499
238255               ,:SUCRDV-OPER-UNT-ID                               23825599
238256               ,:SUCRDV-DOOR-ID                                   23825699
238257               ,:SUCRDV-DIVERT-TMST                               23825799
238258               ,:SUCDOT-STRT-SCN-USR-ID                           23825899
238259               ,:SUCDOT-OTBND-TRIP-ID                             23825999
238260               ,:SUCRDV-ACTV-CDE                                  23826099
238261               ,:SUCRDV-PRC-RSN-CDE                               23826199
238262               ,:SUCRDV-NACTV-USR-ID                              23826299
238263               ,:SUCDOT-END-SCN-USR-ID                            23826399
238264               ,:SUCDOT-STRT-SCN-TMST                             23826499
238265               ,:SUCDOT-END-SCN-TMST                              23826599
238266               ,:PC049-PV-REC-TYPE-2                              23826699
238267               ,:SUT00028-SHPD-UNT-QTY                            23826799
238268               ,:SUT00028-UPC-NBR                                 23826899
238269               ,:SUT00028-TRN-NBR                                 23826999
238270               ,:SUT00028-TRN-LNE-NBR                             23827099
238271     END-EXEC.                                                    23827199
238272                                                                  23827299
238273     EVALUATE TRUE                                                23827399
238274       WHEN SQLCODE = ZEROS                                       23827499
238275            ADD  1  TO  PC049-SCAN-CRTN-CNT                       23827599
238276       WHEN SQLCODE = +100                                        23827699
238277            SET PC049-EOF-SHP-ACTV-CRTN-UPC  TO TRUE              23827799
238278                                                                  23827899
238279       WHEN SQLCODE = -904                                        23827999
238280       WHEN SQLCODE = -911                                        23828099
238281       WHEN SQLCODE = -913                                        23828199
238282            MOVE 'P7370-FETCH-SHP-ACV-CR-UPC-CSR'                 23828299
238283                               TO PC049-ABEND-PARAGRAPH           23828399
238284            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           23828499
238285                                  PC049-SQL-RETURN-CD             23828599
238286            SET  PC049-ERROR   TO TRUE                            23828699
238287                                                                  23828799
238288       WHEN OTHER                                                 23828899
238289            MOVE 'P7370-FETCH-SHP-ACV-CR-UPC-CSR'                 23828999
238290                               TO PC049-ABEND-PARAGRAPH           23829099
238291            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           23829199
238292                                  PC049-SQL-RETURN-CD             23829299
238293            SET  PC049-ERROR   TO TRUE                            23829399
238294     END-EVALUATE.                                                23829499
238295                                                                  23829599
238296                                                                  23829699
238297******************************************************************23829799
238298*                                                                *23829899
238299*CLOSE CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *23829999
238300* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *23830099
238301* USE WHEN HAVE A STARTING AND ENDING TMST                       *23830199
238302* *** SHIPPING TRAILER ***                                       *23830299
238303*                                                                *23830399
238304******************************************************************23830499
238305 P7380-CLOSE-SHP-ACV-CR-UPC-CSR.                                  23830599
238306                                                                  23830699
238307     EXEC SQL                                                     23830799
238308         CLOSE SHP-ACV-CR-UPC-CSR                                 23830899
238309     END-EXEC.                                                    23830999
238310                                                                  23831099
238311     EVALUATE TRUE                                                23831199
238312         WHEN SQLCODE = ZEROS                                     23831299
238313              CONTINUE                                            23831399
238314                                                                  23831499
238315         WHEN SQLCODE = -904                                      23831599
238316         WHEN SQLCODE = -911                                      23831699
238317         WHEN SQLCODE = -913                                      23831799
238318              MOVE 'P7380-CLOSE-SHP-ACV-CR-UPC-CSR'               23831899
238319                                 TO PC049-ABEND-PARAGRAPH         23831999
238320              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23832099
238321                                    PC049-SQL-RETURN-CD           23832199
238322              SET  PC049-ERROR   TO TRUE                          23832299
238323                                                                  23832399
238324         WHEN OTHER                                               23832499
238325              MOVE 'P7380-CLOSE-SHP-ACV-CR-UPC-CSR'               23832599
238326                                 TO PC049-ABEND-PARAGRAPH         23832699
238327              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23832799
238328                                    PC049-SQL-RETURN-CD           23832899
238329              SET  PC049-ERROR   TO TRUE                          23832999
238330     END-EVALUATE.                                                23833099
238331                                                                  23833199
238332                                                                  23833299
238333******************************************************************23833399
238334*                                                                *23833499
238335* OPEN CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *23833599
238336* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *23833699
238337* USE WHEN HAVE A STARTING AND ENDING TMST                       *23833799
238338* ALSO BRINGS BACK THE UPC, TRN AND TRN LINE NBR FROM THE         23833899
238339* SUT_OTBND_UPC TABLE                                             23833999
238340* *** SHUTTLE TRAILER ***                                        *23834099
238341*                                                                *23834199
238342******************************************************************23834299
238343 P7390-OPEN-SHL-ACV-CR-UPC-CSR.                                   23834399
238344                                                                  23834499
238345     EXEC SQL                                                     23834599
238346         OPEN SHTL-ACV-CR-UPC-CSR                                 23834699
238347     END-EXEC.                                                    23834799
238348                                                                  23834899
238349     EVALUATE TRUE                                                23834999
238350         WHEN SQLCODE = ZEROS                                     23835099
238351              SET PC049-NOT-EOF-SHL-ACTV-CRT-UPC  TO TRUE         23835199
238352                                                                  23835299
238353         WHEN SQLCODE = -904                                      23835399
238354         WHEN SQLCODE = -911                                      23835499
238355         WHEN SQLCODE = -913                                      23835599
238356              MOVE 'P7390-OPEN-SHL-ACV-CR-UPC-CSR'                23835699
238357                                 TO PC049-ABEND-PARAGRAPH         23835799
238358              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23835899
238359                                    PC049-SQL-RETURN-CD           23835999
238360              SET  PC049-ERROR   TO TRUE                          23836099
238361                                                                  23836199
238362         WHEN OTHER                                               23836299
238363              MOVE 'P7390-OPEN-SHL-ACV-CR-UPC-CSR'                23836399
238364                                 TO PC049-ABEND-PARAGRAPH         23836499
238365              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23836599
238366                                    PC049-SQL-RETURN-CD           23836699
238367              SET  PC049-ERROR   TO TRUE                          23836799
238368     END-EVALUATE.                                                23836899
238369                                                                  23836999
238370                                                                  23837099
238371******************************************************************23837199
238372*                                                                *23837299
238373* FETCH CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE        *23837399
238374* CARTONS CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.             *23837499
238375* USE WHEN HAVE A STARTING AND ENDING TMST                       *23837599
238376* *** SHUTTLE TRAILER ***                                        *23837699
238377*                                                                *23837799
238378******************************************************************23837899
238379 P7400-FETCH-SHL-ACV-CR-UPC-CSR.                                  23837999
238380                                                                  23838099
238381     EXEC SQL                                                     23838199
238382          FETCH SHTL-ACV-CR-UPC-CSR                               23838299
238383          INTO  :PC049-PV-REC-TYPE                                23838399
238384               ,:SUCRDV-SHIPT-UNT-ID                              23838499
238385               ,:SUCRDV-OPER-UNT-ID                               23838599
238386               ,:SUCRDV-DOOR-ID                                   23838699
238387               ,:SUCRDV-DIVERT-TMST                               23838799
238388               ,:SUCDOT-STRT-SCN-USR-ID                           23838899
238389               ,:SUCDOT-OTBND-TRIP-ID                             23838999
238390               ,:SUCRDV-ACTV-CDE                                  23839099
238391               ,:SUCRDV-PRC-RSN-CDE                               23839199
238392               ,:SUCRDV-NACTV-USR-ID                              23839299
238393               ,:SUCDOT-END-SCN-USR-ID                            23839399
238394               ,:SUCDOT-STRT-SCN-TMST                             23839499
238395               ,:SUCDOT-END-SCN-TMST                              23839599
238396               ,:PC049-PV-REC-TYPE-2                              23839699
238397               ,:SUT00028-SHPD-UNT-QTY                            23839799
238398               ,:SUT00028-UPC-NBR                                 23839899
238399               ,:SUT00028-TRN-NBR                                 23839999
238400               ,:SUT00028-TRN-LNE-NBR                             23840099
238401     END-EXEC.                                                    23840199
238402                                                                  23840299
238403     EVALUATE TRUE                                                23840399
238404       WHEN SQLCODE = ZEROS                                       23840499
238405            ADD  1  TO  PC049-SCAN-CRTN-CNT                       23840599
238406       WHEN SQLCODE = +100                                        23840699
238407            SET PC049-EOF-SHL-ACTV-CRTN-UPC  TO TRUE              23840799
238408                                                                  23840899
238409       WHEN SQLCODE = -904                                        23840999
238410       WHEN SQLCODE = -911                                        23841099
238411       WHEN SQLCODE = -913                                        23841199
238412            MOVE 'P7400-FETCH-SHL-ACV-CR-UPC-CSR'                 23841299
238413                               TO PC049-ABEND-PARAGRAPH           23841399
238414            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           23841499
238415                                  PC049-SQL-RETURN-CD             23841599
238416            SET  PC049-ERROR   TO TRUE                            23841699
238417                                                                  23841799
238418       WHEN OTHER                                                 23841899
238419            MOVE 'P7400-FETCH-SHL-ACV-CR-UPC-CSR'                 23841999
238420                               TO PC049-ABEND-PARAGRAPH           23842099
238421            MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE           23842199
238422                                  PC049-SQL-RETURN-CD             23842299
238423            SET  PC049-ERROR   TO TRUE                            23842399
238424     END-EVALUATE.                                                23842499
238425                                                                  23842599
238426                                                                  23842699
238427******************************************************************23842799
238428*                                                                *23842899
238429*CLOSE CURSOR - THAT IS USED TO SELECT ALL OF THE ACTIVE CARTONS *23842999
238430* CURRENTLY ATTACHED TO AN OUTBOUND TRAILER.                     *23843099
238431* USE WHEN HAVE A STARTING AND ENDING TMST                       *23843199
238432* *** SHUTTLE TRAILER ***                                        *23843299
238433*                                                                *23843399
238434******************************************************************23843499
238435 P7410-CLOSE-SHL-ACV-CR-UPC-CSR.                                  23843599
238436                                                                  23843699
238437     EXEC SQL                                                     23843799
238438         CLOSE SHTL-ACV-CR-UPC-CSR                                23843899
238439     END-EXEC.                                                    23843999
238440                                                                  23844099
238441     EVALUATE TRUE                                                23844199
238442         WHEN SQLCODE = ZEROS                                     23844299
238443              CONTINUE                                            23844399
238444                                                                  23844499
238445         WHEN SQLCODE = -904                                      23844599
238446         WHEN SQLCODE = -911                                      23844699
238447         WHEN SQLCODE = -913                                      23844799
238448              MOVE 'P7410-CLOSE-SHL-ACV-CR-UPC-CSR'               23844899
238449                                 TO PC049-ABEND-PARAGRAPH         23844999
238450              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23845099
238451                                    PC049-SQL-RETURN-CD           23845199
238452              SET  PC049-ERROR   TO TRUE                          23845299
238453                                                                  23845399
238454         WHEN OTHER                                               23845499
238455              MOVE 'P7410-CLOSE-SHL-ACV-CR-UPC-CSR'               23845599
238456                                 TO PC049-ABEND-PARAGRAPH         23845699
238457              MOVE SQLCODE       TO PC049-DISPLAY-SQLCODE         23845799
238458                                    PC049-SQL-RETURN-CD           23845899
238459              SET  PC049-ERROR   TO TRUE                          23845999
238460     END-EVALUATE.                                                23846099
238461                                                                  23846199
238462                                                                  23846299
238463******************************************************************23846398
238470*  END OF MEMBER                                                 *23847098
238500******************************************************************23850098
