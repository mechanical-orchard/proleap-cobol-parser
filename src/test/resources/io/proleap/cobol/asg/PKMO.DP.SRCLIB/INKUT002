       IDENTIFICATION DIVISION.                                         00060005
       PROGRAM-ID.    INKUT002.                                         00070005
       AUTHOR.        PAUL KEBER - STRATAGEM.                           00080005
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00090005
       DATE-WRITTEN.  01-25-99.                                         00100005
       DATE-COMPILED.                                                   00110005
                                                                        00120015
      ******************************************************************00130005
      *      INKUT002 - CREATE MONTHLY DEPT/SUBCLASS TABLE UNLOAD       00140005
      *                 CONTROL CARD                                    00150005
      ******************************************************************00160005
      *                                                                 00170005
      *  THIS PROGRAM WILL CREATE A PLATINUM UNLOAD WHERE CLAUSE DATE   00180005
W20445*  CONTROL CARD TO BE USED IN UNLOADING MLT_MNLY_SUM RECS FOR THE 00190010
      *  SALES BASE FOR INVENTORY REPORT PROGRAM.                       00200005
      *                                                                 00210005
      *CHANGE HISTORY:                                                  00220010
      * WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00230010
      * ------- ---------- ----------- -------------------------------- 00240010
      ******************************************************************00250010
      *    MODIFIED  02/18/1999  BY: TESS BESTE      PROJECT: WR20839   00260005
      *                                                                 00270005
      *  - CHANGES FOR CREATION OF COMMON SALES BASE PROCESS.           00280005
      *    PROGRAM WAS USING THE MONTH-END DATE OF THE MONTH PRIOR TO   00290005
      *    THE OPEN MONTH IN THE WHERE CLAUSE. CHANGED IT TO USE THE    00300005
      *    MONTH-END DATE OF THE OPEN MONTH.                            00310005
      *                                                                 00320005
      ******************************************************************00330010
RB0600*    MODIFIED  06/02/2000  BY: RONNA BUTZ      PROJECT: WR21015   00340005
RB0600*                                                                 00350005
RB0600*  - CREATE ANOTHER OUTPUT FILE THAT CONTAINS A WHERE CLAUSE      00360005
RB0600*    WITH FISCAL WEEK END DATE BETWEEN THE FIRST DAY OF THE OPEN  00370005
RB0600*    MONTH AND THE LAST DAY OF THE OPEN MONTH.                    00380005
RB0600*                                                                 00390005
      ******************************************************************00400005
RB0901*    MODIFIED  09/27/2001  BY: RONNA BUTZ      PROJECT: WR        00410007
RB0901*                                                                 00420007
RB0901*  - NEEDED TO MAKE MODIFICATIONS TO THE WHERE CLAUSE FOR THE     00430007
RB0901*    SHRINK TABLE UNLOAD BECAUSE IT HAD THE WORD 'BETWEEN' IN IT. 00440007
RB0901*    "BETWEEN" IS NOT SUPPORTED IN THE VERSION OF BMC THAT IS     00450007
RB0901*    GETTING INSTALLED.  MODIFIED THE BETWEEN TO USE >= AND <=.   00460007
RB0901*                                                                 00470007
W20445* W20445  09-01-2004 ROD JANSSEN DETAILED INVNENTORY ADJUSTMENT   00480010
W27710* W27710  02-20-2005 S JACKSON PARTN-NBR-CSR SELECT CURR MN PARTS 00490021
W27710*                    PGM WILL ONLY SELECT CURRENT MONTH DATA.     00500021
W35378* W35378  04-15-2009 T KONTAROVICH BMC TO DSNTIAUL CONVERSION     00501025
W35378*                    CHANGE 'PART' TO 'WHERE PARTN_NBR IN' CLAUSE.00502027
      ******************************************************************00510007
      *                                                                 00520005
       ENVIRONMENT DIVISION.                                            00530005
       CONFIGURATION SECTION.                                           00540005
       SOURCE-COMPUTER.        IBM-3090.                                00550005
       OBJECT-COMPUTER.        IBM-3090.                                00560005
       INPUT-OUTPUT SECTION.                                            00570005
       FILE-CONTROL.                                                    00580005
                                                                        00590005
W02445     SELECT MLTMNLYSUM-DATE-CNTL-FILE                             00600010
               ASSIGN TO OUT01.                                         00610005
                                                                        00620005
RB0600     SELECT TWKSHNK-DATE-CNTL-FILE                                00630005
RB0600         ASSIGN TO OUT02.                                         00640005
RB0600                                                                  00650005
       DATA DIVISION.                                                   00660005
       FILE SECTION.                                                    00670005
                                                                        00680005
W20445 FD  MLTMNLYSUM-DATE-CNTL-FILE                                    00690010
           RECORDING MODE IS F                                          00700005
           LABEL RECORDS ARE STANDARD                                   00710005
           BLOCK CONTAINS 0 RECORDS.                                    00720005
                                                                        00730005
W20445 01  MLTMNLYSUM-DATE-CNTL-RECORD PIC X(80).                       00740010
      *                                                                 00750005
RB0600 FD  TWKSHNK-DATE-CNTL-FILE                                       00760005
RB0600     RECORDING MODE IS F                                          00770005
RB0600     LABEL RECORDS ARE STANDARD                                   00780005
RB0600     BLOCK CONTAINS 0 RECORDS.                                    00790005
RB0600                                                                  00800005
RB0600 01  TWKSHNK-DATE-CNTL-RECORD    PIC X(80).                       00810005
RB0600*                                                                 00820005
      ******************************************************************00830005
       WORKING-STORAGE SECTION.                                         00840005
      ******************************************************************00850005
                                                                        00860005
W20445 01  MLTMNLYSUM-SELECT-VERBIAGE-1.                                00870010
W35378     05  FILLER                  PIC X(23)   VALUE                00880028
W35378         '  WHERE PARTN_NBR IN ( '.                               00881024
W35378*        '  PART                '.                                00890028
W35378     05  FILLER                  PIC X(57)  VALUE SPACES.         00900024
W20445                                                                  00910010
W20445*01  MLTMNLYSUM-SELECT-VERBIAGE-2.                                00920018
W20445*    05  FILLER                  PIC X(04)  VALUE '  );'.         00930018
W20445*    05  FILLER                  PIC X(76)  VALUE SPACES.         00940018
W20445*                                                                 00950018
W20445 01  MLTMNLYSUM-SELECT-VERBIAGE-3.                                00960011
W20445     05  FILLER                  PIC X(04)  VALUE SPACES.         00970013
W20445     05  MLTMNLYSUMM-COMMA       PIC X(01)  VALUE SPACES.         00980011
W20445     05  MLTMNLYSUM-PARTN-NBR    PIC Z99.                         00990011
W20445     05  FILLER                  PIC X(72)  VALUE SPACES.         01000013
W20445                                                                  01010011
W20445*    05  FILLER                  PIC X(28)   VALUE                01020010
W20445*        '  WHERE FSCL_MN_END_DTE <= '''.                         01030010
W20445*    05  PV-TMNSCLS-END-DATE     PIC X(10)   VALUE SPACES.        01040010
W20445*    05  FILLER                  PIC X(42)   VALUE ''';'.         01050010
W20445*                                                                 01060010
RB0600 01  PV-TWKSHNK-DATE-CNTL-RECORD1.                                01070007
RB0600     05  FILLER                  PIC X(28)   VALUE                01080008
RB0901         '  WHERE FSCL_WK_END_DTE >= '''.                         01090007
RB0600     05  PV-TWKSHNK-BEG-DATE     PIC X(10)   VALUE SPACES.        01100005
RB0600     05  FILLER                  PIC X(06)   VALUE ''' AND '.     01110008
RB0901     05  FILLER                  PIC X(10)   VALUE SPACES.        01120007
RB0600     05  FILLER                  PIC X(26)   VALUE SPACES.        01130008
RB0600                                                                  01140005
RB0901 01  PV-TWKSHNK-DATE-CNTL-RECORD2.                                01150007
RB0901     05  FILLER                  PIC X(28)   VALUE                01160008
RB0901         '        FSCL_WK_END_DTE <= '''.                         01170008
RB0901     05  PV-TWKSHNK-END-DATE     PIC X(10)   VALUE SPACES.        01180007
RB0901     05  FILLER                  PIC X(26)   VALUE ''';'.         01190009
RB0901     05  FILLER                  PIC X(06)   VALUE SPACES.        01200008
RB0901     05  FILLER                  PIC X(10)   VALUE SPACES.        01210007
RB0901                                                                  01220007
W20445 01  PV-PARTN-NBR-COUNT          PIC S9(15) COMP-3 VALUE ZEROS.   01230010
W20445                                                                  01240010
W20445 01  PS-PROGRAM-SWITCHES.                                         01250010
W20445     05  PS-PARTN-NBR-DONE-SW      PIC X(01)   VALUE 'N'.         01260010
W20445         88  PS-PARTN-NBR-COMPLETE             VALUE 'Y'.         01270010
W20445     05  PS-FIRST-TIME-SW          PIC X(01)   VALUE 'N'.         01280010
W20445         88  PS-FIRST-TIME-THRU                VALUE 'N'.         01290010
W20445         88  PS-CONTINUED-PROCESSING           VALUE 'Y'.         01300010
W20445                                                                  01310010
       01 ABEND-AREAS.                                                  01320005
           05 ABEND-CODE               PIC S9(04)  VALUE ZERO           01330005
                                                   COMP SYNC.           01340005
               88  AC-BAD-DATA                     VALUE +4003.         01350005
               88  AC-DB2-ERROR                    VALUE +4013.         01360005
           05  AA-ABEND-LIT            PIC X(40)   VALUE                01370005
                 '*****       ABEND'.                                   01380005
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                01390005
                   '*****   PROGRAM: INKUT002'.                         01400005
           05  AA-PARAGRAPH-LIT.                                        01410005
               10  FILLER              PIC X(17)   VALUE                01420005
                   '***** PARAGRAPH: '.                                 01430005
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        01440005
           05  AA-MESSAGE-LINE.                                         01450005
               10  FILLER              PIC X(06)   VALUE '*****'.       01460005
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        01470005
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                01480005
                   '*****    DB2 ERROR'.                                01490005
           05  AA-DB2-OPERATION-LIT.                                    01500005
               10  FILLER              PIC X(17)   VALUE                01510005
                   '***** OPERATION: '.                                 01520005
               10  AA-DB2-OPERATION.                                    01530005
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        01540005
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        01550005
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        01560005
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        01570005
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        01580005
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        01590005
                                                                        01600005
      ******************************************************************01610005
      *  DB2 ERROR MESSAGES FORMAT AREA.                                01620005
      ******************************************************************01630005
           COPY DPWS004.                                                01640005
                                                                        01650005
      ******************************************************************01660005
      *  DB2 ERRORS                                                     01670005
      ******************************************************************01680005
           COPY SQLCA2.                                                 01690005
                                                                        01700005
      ******************************************************************01710005
      *  DB2 MLCNTL TABLE LAYOUT                                        01720005
      ******************************************************************01730005
           EXEC SQL                                                     01740005
                INCLUDE TMLCNTL                                         01750005
           END-EXEC.                                                    01760005
                                                                        01770005
      ******************************************************************01780005
      *  DB2 DTATTR TABLE LAYOUT                                        01790005
      ******************************************************************01800005
           EXEC SQL                                                     01810005
                INCLUDE TDTATTR                                         01820005
           END-EXEC.                                                    01830005
                                                                        01840005
W20445******************************************************************01850010
W20445*  DB2 - M/L DETAIL LEDGER PARTITION BALANCE TBL (MLT_PARTN_BAL)  01860010
W20445******************************************************************01870010
W20445     EXEC SQL                                                     01880010
W20445         INCLUDE MLT00002                                         01890010
W20445     END-EXEC.                                                    01900010
W20445                                                                  01910010
W20445******************************************************************01920010
W20445*  DB2 - M/L DETAIL LEDGER PARTITION CONTROL TBL (MLT_PARTN_CNTL) 01930010
W20445******************************************************************01940010
W20445     EXEC SQL                                                     01950010
W20445         INCLUDE MLT00003                                         01960010
W20445     END-EXEC.                                                    01970010
W20445                                                                  01980010
      ******************************************************************01990005
      *  DB2 COMMUNICATION AREA                                         02000010
      ******************************************************************02010005
           EXEC SQL                                                     02020005
                INCLUDE SQLCA                                           02030005
           END-EXEC.                                                    02040005
                                                                        02050005
W20445******************************************************************02060010
W20445*  DB2 - M/L DETAIL LEDGER PARTITION CURSOR.                      02070010
W20445******************************************************************02080010
W20445     EXEC SQL                                                     02090010
W20445       DECLARE PARTN-NBR-CSR CURSOR FOR                           02100010
W20445         SELECT DISTINCT PARTN_NBR                                02110010
W20445         FROM MLT_PARTN_CNTL A,                                   02120010
W20445              MLT_PARTN_BAL B                                     02130010
W20445         WHERE A.TBL_TM_LVL_CDE = B.TBL_TM_LVL_CDE                02140010
W20445           AND :MLCNTL-OPN-FSCL-MN-DTE >= B.EFF_BEG_DTE           02150017
W20445           AND :MLCNTL-OPN-FSCL-MN-DTE <=  B.EFF_END_DTE          02160017
W20445           AND A.DEPT_GP_CDE = B.DEPT_GP_CDE                      02170010
W20445           AND A.TBL_TM_LVL_CDE = 'M'                             02180010
W20445******     AND A.FSCL_DTE <= :MLCNTL-OPN-FSCL-MN-DTE              02190020
W27710           AND A.FSCL_DTE  = :MLCNTL-OPN-FSCL-MN-DTE              02200021
W20445     END-EXEC.                                                    02210010
W20445                                                                  02220010
      /*****************************************************************02230010
       PROCEDURE DIVISION.                                              02240005
      ******************************************************************02250005
       0100-MAINLINE.                                                   02260005
      *                                                                 02270005
W20445*** DETERMINE THE FISCAL PERIOS TO BE PROCESSED....               02280010
           PERFORM 7000-SELECT-TMLCNTL.                                 02290005
                                                                        02300005
           DISPLAY ' '.                                                 02310005
           DISPLAY '*** OPEN FISCAL DATE USED IS:  '                    02320005
           DISPLAY '    MLCNTL-OPN-FSCL-MN-DTE = '                      02330005
             MLCNTL-OPN-FSCL-MN-DTE.                                    02340005
                                                                        02350005
RB0600     MOVE MLCNTL-OPN-FSCL-MN-DTE      TO DTATTR-KY-DTE.           02360005
RB0600     PERFORM 7100-SELECT-TDTATTR.                                 02370005
RB0600                                                                  02380005
RB0600     DISPLAY ' '.                                                 02390005
RB0600     DISPLAY '*** BEG OF OPEN FISCAL MONTH USED IS: '             02400005
RB0600     DISPLAY '    DTATTR-FSCL-MN-BEG-DTE = '                      02410005
RB0600       DTATTR-FSCL-MN-BEG-DTE.                                    02420005
RB0600     DISPLAY ' '.                                                 02430005
RB0600     DISPLAY '*** END OF OPEN FISCAL MONTH USED IS: '             02440005
RB0600     DISPLAY '    DTATTR-FSCL-MN-END-DTE = '                      02450005
RB0600       DTATTR-FSCL-MN-END-DTE.                                    02460005
RB0600                                                                  02470005
W20445*** OPEN FILES....                                                02480010
W20445     OPEN OUTPUT MLTMNLYSUM-DATE-CNTL-FILE                        02490010
RB0600                 TWKSHNK-DATE-CNTL-FILE.                          02500005
                                                                        02510005
W20445*** DETERMINE THE FISCAL PERIOD'S PARTITION NUMBERS FOR THE TABLE 02520016
W20445*** MLT_MNLY_SUM....                                              02530010
W20445     MOVE ZEROS          TO PV-PARTN-NBR-COUNT.                   02540012
W20445     MOVE 'N'            TO PS-PARTN-NBR-DONE-SW.                 02550012
W20445                                                                  02560012
W20445     PERFORM 7200-OPEN-PARTN-NBR-CSR.                             02570012
W20445                                                                  02580012
W20445     PERFORM 2000-BUILD-PARTN-NBR                                 02590010
W20445         UNTIL PS-PARTN-NBR-COMPLETE.                             02600010
W20445                                                                  02610010
W20445     PERFORM 7300-CLOSE-PARTN-NBR-CSR.                            02620012
W20445                                                                  02630012
W20445*    IF PV-PARTN-NBR-COUNT IS GREATER THAN ZEROS                  02640018
W20445*        WRITE MLTMNLYSUM-DATE-CNTL-RECORD                        02650018
W20445*                           FROM MLTMNLYSUM-SELECT-VERBIAGE-2     02660018
W20445*    END-IF.                                                      02670018
W20445*                                                                 02680018
W20445*    MOVE MLCNTL-OPN-FSCL-MN-DTE TO MLTMNLYSUM-END-DATE.          02690010
W20445*                                                                 02700010
W20445*    WRITE MLTMNLYSUM-DATE-CNTL-RECORD                            02710010
W20445*        FROM  MLTMNLYSUM-DATE-CNTL-RECORD.                       02720010
W20445                                                                  02730010
W20445*** TWKSHNK FISCAL PERIOD SETUP...                                02740010
RB0600     MOVE DTATTR-FSCL-MN-BEG-DTE TO PV-TWKSHNK-BEG-DATE.          02750005
RB0600     MOVE DTATTR-FSCL-MN-END-DTE TO PV-TWKSHNK-END-DATE.          02760005
RB0600                                                                  02770005
RB0600     WRITE TWKSHNK-DATE-CNTL-RECORD                               02780005
RB0901         FROM  PV-TWKSHNK-DATE-CNTL-RECORD1.                      02790007
RB0600                                                                  02800005
RB0901     WRITE TWKSHNK-DATE-CNTL-RECORD                               02810007
RB0901         FROM  PV-TWKSHNK-DATE-CNTL-RECORD2.                      02820007
RB0901                                                                  02830007
W20445*** CLOSE FILES....                                               02840010
W20445     CLOSE MLTMNLYSUM-DATE-CNTL-FILE                              02850010
RB0600           TWKSHNK-DATE-CNTL-FILE.                                02860005
                                                                        02870005
           STOP RUN.                                                    02880005
                                                                        02890005
W20445/*****************************************************************02900010
W20445* 2000-BUILD-PARTN-NBR.                                           02910010
W20445******************************************************************02920010
W20445 2000-BUILD-PARTN-NBR.                                            02930010
W20445                                                                  02940010
W20445     EXEC SQL                                                     02950010
W20445         FETCH PARTN-NBR-CSR                                      02960010
W20445         INTO :MLT00003-PARTN-NBR                                 02970010
W20445     END-EXEC.                                                    02980010
W20445                                                                  02990010
W20445     EVALUATE TRUE                                                03000010
W20445         WHEN SQLCODE = ZERO                                      03010010
W20445             PERFORM 3000-FORMAT-SELECT-STATEMENT                 03020010
W20445         WHEN SQLCODE = +100                                      03030010
W20445             MOVE 'Y'         TO PS-PARTN-NBR-DONE-SW             03040010
W20445         WHEN SQLWARN0 NOT = SPACE                                03050010
W20445         WHEN SQLCODE  NOT = ZERO                                 03060010
W20445             MOVE '2000-BUILD-PARTN-NBR' TO AA-PARAGRAPH-NAME     03070010
W20445             MOVE 'FETCH'                TO AA-DB2-OPERATION      03080010
W20445             MOVE 'PARTN-NBR CSR'        TO AA-MESSAGE            03090010
W20445             PERFORM 9901-SQL-ERROR                               03100010
W20445     END-EVALUATE.                                                03110010
W20445                                                                  03120010
W20445/*****************************************************************03130010
W20445* 3000-FORMAT-SELECT-STATEMENT.                                   03140010
W20445*     THE ROUTINE BUILDS THE SELECT STATMENT FOR MLT_MNLY_SUM. THE03150010
W20445* TABLE IS SETUP TO USE PARTITION NUMBER. THE ROUTINE BUILDS THE  03160010
W20445* PARTITION NUMBER SELECT STATMENTS FOR THE OPEN FISCAL MONTH...  03170010
W20445******************************************************************03180010
W20445 3000-FORMAT-SELECT-STATEMENT.                                    03190010
W20445                                                                  03200010
W20445     IF PS-FIRST-TIME-THRU                                        03210010
W20445         WRITE MLTMNLYSUM-DATE-CNTL-RECORD                        03220010
W20445                              FROM MLTMNLYSUM-SELECT-VERBIAGE-1   03230011
W20445         MOVE 'Y'             TO PS-FIRST-TIME-SW                 03240011
W20445     END-IF.                                                      03250010
W20445                                                                  03260010
W20445     IF PV-PARTN-NBR-COUNT IS GREATER THAN ZERO                   03270014
W20445         MOVE ','             TO MLTMNLYSUMM-COMMA                03280010
W20445     ELSE                                                         03290010
W20445         MOVE SPACE           TO MLTMNLYSUMM-COMMA                03300010
W20445     END-IF.                                                      03310010
W20445                                                                  03320010
W20445     MOVE MLT00003-PARTN-NBR  TO MLTMNLYSUM-PARTN-NBR             03330011
W20445                                                                  03340010
W20445     WRITE MLTMNLYSUM-DATE-CNTL-RECORD                            03350010
W20445                              FROM MLTMNLYSUM-SELECT-VERBIAGE-3.  03360011
W20445                                                                  03370010
W20445     ADD 1                    TO PV-PARTN-NBR-COUNT.              03380010
W20445                                                                  03390010
      /*****************************************************************03400010
       7000-SELECT-TMLCNTL.                                             03410005
      ******************************************************************03420005
                                                                        03430005
           EXEC SQL                                                     03440005
               SELECT OPN_FSCL_MN_DTE                                   03450005
               INTO  :MLCNTL-OPN-FSCL-MN-DTE                            03460005
               FROM TMLCNTL                                             03470005
           END-EXEC.                                                    03480005
                                                                        03490005
           EVALUATE TRUE                                                03500005
               WHEN SQLCODE = ZERO                                      03510005
                   CONTINUE                                             03520005
               WHEN OTHER                                               03530005
                   MOVE '7000-SELECT-TMLCNTL'                           03540005
                                       TO AA-PARAGRAPH-NAME             03550005
                   MOVE 'TMLCNTL ROW NOT FOUND'                         03560005
                                       TO AA-MESSAGE                    03570005
                   MOVE 'SELECT'       TO AA-DB2-OPERATION              03580005
                   PERFORM 9901-SQL-ERROR                               03590005
           END-EVALUATE.                                                03600005
                                                                        03610005
RB0600******************************************************************03620005
RB0600 7100-SELECT-TDTATTR.                                             03630005
RB0600******************************************************************03640005
RB0600                                                                  03650005
RB0600     EXEC SQL                                                     03660005
RB0600         SELECT FSCL_MN_BEG_DTE                                   03670005
RB0600               ,FSCL_MN_END_DTE                                   03680005
RB0600         INTO  :DTATTR-FSCL-MN-BEG-DTE                            03690005
RB0600              ,:DTATTR-FSCL-MN-END-DTE                            03700005
RB0600         FROM TDTATTR                                             03710005
RB0600         WHERE  KY_DTE = :DTATTR-KY-DTE                           03720005
RB0600     END-EXEC.                                                    03730005
RB0600                                                                  03740005
RB0600     EVALUATE TRUE                                                03750005
RB0600         WHEN SQLCODE = ZERO                                      03760005
RB0600             CONTINUE                                             03770005
RB0600         WHEN OTHER                                               03780005
RB0600             MOVE '7100-SELECT-TMLCNTL'                           03790005
RB0600                                 TO AA-PARAGRAPH-NAME             03800005
RB0600             MOVE 'TDTATTR ROW NOT FOUND'                         03810005
RB0600                                 TO AA-MESSAGE                    03820005
RB0600             MOVE 'SELECT'       TO AA-DB2-OPERATION              03830005
RB0600             PERFORM 9901-SQL-ERROR                               03840005
RB0600     END-EVALUATE.                                                03850005
                                                                        03860005
W20445***************************************************************** 03870012
W20445* 7200-OPEN-PARTN-NBR-CSR.                                        03880012
W20445***************************************************************** 03890012
W20445 7200-OPEN-PARTN-NBR-CSR.                                         03900012
W20445                                                                  03910012
W20445     EXEC SQL                                                     03920012
W20445         OPEN PARTN-NBR-CSR                                       03930012
W20445     END-EXEC.                                                    03940012
W20445                                                                  03950012
W20445     EVALUATE TRUE                                                03960012
W20445       WHEN SQLCODE = ZERO                                        03970012
W20445           CONTINUE                                               03980012
W20445       WHEN SQLWARN0 NOT = SPACE                                  03990012
W20445       WHEN SQLCODE  NOT = ZERO                                   04000012
W20445           MOVE '7200-OPEN-PARTN-NBR ' TO AA-PARAGRAPH-NAME       04010012
W20445           MOVE 'OPEN'                 TO AA-DB2-OPERATION        04020012
W20445           MOVE 'PARTN-NBR CSR'        TO AA-MESSAGE              04030012
W20445           MOVE 'Y'                    TO PS-PARTN-NBR-DONE-SW    04040012
W20445           PERFORM 9901-SQL-ERROR                                 04050012
W20445     END-EVALUATE.                                                04060012
W20445                                                                  04070012
W20445***************************************************************** 04080012
W20445* 7300-CLOSE-PARTN-NBR-CSR.                                       04090012
W20445***************************************************************** 04100012
W20445  7300-CLOSE-PARTN-NBR-CSR.                                       04110012
W20445                                                                  04120012
W20445     EXEC SQL                                                     04130012
W20445         CLOSE PARTN-NBR-CSR                                      04140012
W20445     END-EXEC.                                                    04150012
W20445                                                                  04160012
W20445     EVALUATE TRUE                                                04170012
W20445       WHEN SQLCODE = ZERO                                        04180012
W20445           CONTINUE                                               04190012
W20445       WHEN SQLWARN0 NOT = SPACE                                  04200012
W20445       WHEN SQLCODE  NOT = ZERO                                   04210012
W20445           MOVE '7300-OPEN-PARTN-NBR ' TO AA-PARAGRAPH-NAME       04220012
W20445           MOVE 'CLOSE'                TO AA-DB2-OPERATION        04230012
W20445           MOVE 'PARTN-NBR CSR'        TO AA-MESSAGE              04240012
W20445           PERFORM 9901-SQL-ERROR                                 04250012
W20445     END-EVALUATE.                                                04260012
W20445                                                                  04270012
      ******************************************************************04280005
       9901-SQL-ERROR.                                                  04290005
      ******************************************************************04300005
                                                                        04310005
                                                                        04320005
           DISPLAY AA-ABEND-LIT.                                        04330005
           DISPLAY AA-DB2-ERROR-LIT.                                    04340005
           DISPLAY AA-PROGRAM-LIT.                                      04350005
           DISPLAY AA-PARAGRAPH-LIT.                                    04360005
           DISPLAY AA-MESSAGE-LINE.                                     04370005
           DISPLAY AA-DB2-OPERATION-LIT.                                04380005
           SET AC-DB2-ERROR TO TRUE.                                    04390005
           MOVE +4013                  TO ABEND-CODE.                   04400005
                                                                        04410005
           COPY DPPD004.                                                04420005
           CALL 'ILBOABN0' USING ABEND-CODE.                            04430005
