000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             SUKRP068.                                00020000
000300 AUTHOR.                 DENISE HAHN.                             00030000
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           MAY, 2016.                               00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800****************************************************************  00080000
000900* THIS WILL EXTRACT "I" RECORDS FROM TUPLDER TABLE TO CREATE AN   00090000
001000* INFORMATIONAL REPORT FOR INVENTORY CONTROL.                     00100000
001100* "I" RECORDS ARE CREATED IN WSKCS309 - CASE RECEIPTS FROM EFC'S  00110000
001200* ERROR CODE:  001 - WRONG PO WAS ON THE PIX                      00120000
001300*                    SKU, QTY MATCH THE INBOUND CASE NUMBER       00130000
001400*                    UPDATED THE PIX TO SHOW CORRECT PO NUMBER    00140000
001500*              002 - CASE NUMBER WAS REUSED                       00150000
001600*                    THE RECEIVER THE CASE NUMBER IS ATTACHED     00160000
001700*                    TO HAS BEEN VERIFIED.  CANNOT ADD TO THE     00170000
001710*                    RECEIVER.  NEW RECEIVER WAS CREATED FOR      00171000
001720*                    THE CASE RECEIPT ON THE TRAILER.             00172000
001730*                    OUTBOUND IS NO ASSOCIATED WITH THE CASE      00173000
001740*                    NUMBER SINCE THE CASE WAS PREVIOUSLY         00174000
001750*                    RECEIVED.  PIX WAS PROCESSED AS A SKU        00175000
001760*                    RECEIPT.                                     00176000
001770*              003 - WMU CASE WAS PREVIOUSLY RECEIVED             00177038
001800****************************************************************  00180000
001900                                                                  00190000
002000 ENVIRONMENT DIVISION.                                            00200000
002100 CONFIGURATION SECTION.                                           00210000
002200 SOURCE-COMPUTER.                        IBM-3090.                00220000
002300 OBJECT-COMPUTER.                        IBM-3090.                00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500 FILE-CONTROL.                                                    00250000
002600                                                                  00260000
002810     SELECT INPUT-FILE                                            00281000
002820         ASSIGN TO INP01.                                         00282004
002900                                                                  00290000
002910     SELECT CONTROL-FILE                                          00291009
002920         ASSIGN TO INP02.                                         00292009
002930                                                                  00293009
003000     SELECT  REPORT-FILE                                          00300001
003100         ASSIGN TO RPT01.                                         00310000
003200                                                                  00320000
003500                                                                  00350000
003600 DATA DIVISION.                                                   00360000
003700 FILE SECTION.                                                    00370000
003800                                                                  00380000
004410 FD  INPUT-FILE                                                   00441000
004420     RECORDING MODE IS F                                          00442000
004430     LABEL RECORDS ARE STANDARD                                   00443000
004440     BLOCK CONTAINS 0 RECORDS.                                    00444000
004450 01  INPUT-RECORD                     PIC X(110).                 00445000
004460                                                                  00446000
004470 FD  CONTROL-FILE                                                 00447009
004480     RECORDING MODE IS F                                          00448009
004490     LABEL RECORDS ARE STANDARD                                   00449009
004491     BLOCK CONTAINS 0 RECORDS.                                    00449109
004492 01  CONTROL-RECORD                   PIC X(80).                  00449209
004493                                                                  00449309
004500 FD  REPORT-FILE                                                  00450001
004600     RECORDING MODE IS F                                          00460000
004700     LABEL RECORDS ARE STANDARD                                   00470000
004800     BLOCK CONTAINS 0 RECORDS.                                    00480000
004900 01  REPORT-RECORD                    PIC X(200).                 00490021
005000                                                                  00500000
005800                                                                  00580000
005900 WORKING-STORAGE SECTION.                                         00590000
005941                                                                  00594100
005942*-----------------------------------------------------------------00594209
005943*  CONTROL CART INPUT                                             00594309
005944*-----------------------------------------------------------------00594409
005945 01  PV-CONTROL-CARD.                                             00594509
005946     05  PV-RUN-TYPE                  PIC X(01).                  00594609
005947         88  PV-CURRENT-DAY                     VALUE 'C'.        00594709
005948         88  PV-BATCH-PROCESS-DAY               VALUE 'B'.        00594809
005949     05  FILLER                       PIC X(79).                  00594909
005950                                                                  00595023
005951 01  PV-PROGRAM-VARIABLES.                                        00595123
005952     05  PV-DISP-SSCC                 PIC  9(18).                 00595223
005953     05  PV-DISP-SQL                  PIC  -999.                  00595323
005954     05  PV-DISP-TRIP                 PIC  9(09).                 00595423
005955     05  PV-DISP-PO                   PIC  Z(09).                 00595523
005956     05  PV-DISP-RCVR                 PIC  9(04).                 00595623
005957     05  PV-ORIG-RCVD                 PIC  X(10).                 00595723
005958     05  PV-ORIG-RCVD-R REDEFINES PV-ORIG-RCVD.                   00595834
005959         10  FILLER                   PIC X(02).                  00595933
005960         10  PV-ORIG-RCVD-YY          PIC X(02).                  00596035
005961         10  PV-ORIG-DASH-1           PIC X(01).                  00596135
005962         10  PV-ORIG-RCVD-MM          PIC X(02).                  00596235
005963         10  PV-ORIG-DASH-2           PIC X(01).                  00596335
005964         10  PV-ORIG-RCVD-DD          PIC X(02).                  00596435
005965     05  PV-RCVD-DATE.                                            00596536
005966         10  PV-RCVD-RCVD-MM          PIC X(02).                  00596636
005967         10  PV-RCVD-DASH-1           PIC X(01).                  00596736
005968         10  PV-RCVD-RCVD-DD          PIC X(02).                  00596836
005969         10  PV-RCVD-DASH-2           PIC X(01).                  00596936
005970         10  PV-RCVD-RCVD-YY          PIC X(02).                  00597036
005971     05  PV-ORIG-TRIP                 PIC  S9(9) COMP.            00597135
005972     05  PV-ORIG-OPER                 PIC  S9(4) COMP.            00597235
005973                                                                  00597335
005974 01  PV-ABEND-FIELDS.                                             00597435
005975     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     00597535
005976     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     00597635
005977     05  PV-ABEND-CODE                PIC S9(4) VALUE +0          00597735
005978                                                COMP SYNC.        00597835
005979     05  PV-ABEND-PROGRAM             PIC X(08) VALUE 'SUKRP068'. 00597935
005980     05  PV-ABEND-PARAGRAPH           PIC X(50) VALUE SPACES.     00598035
005981     05  PV-ABEND-OPERATION           PIC X(50) VALUE SPACES.     00598135
005982     05  PV-ABEND-STRUCTURE           PIC X(08) VALUE SPACES.     00598235
005983                                                                  00598335
005984 01  DK-DB2-KEYS.                                                 00598435
005985     05  DK-OPER-UNT-ID               PIC S9(04)  VALUE +0        00598535
005986                                                  COMP SYNC.      00598635
005987     05  DK-INTR-TRIP-ID              PIC  S9(9) COMP.            00598737
005990                                                                  00599035
006301 01  INPUT-RECORD-DETAIL.                                         00630100
006302     05  IN-OPER                      PIC 9(04)   VALUE ZEROES.   00630200
006303     05  IN-ERR-TYPE                  PIC X(01)   VALUE ZEROES.   00630300
006304     05  IN-ERR-CDE                   PIC X(03)   VALUE ZEROES.   00630400
006305     05  IN-PKT-TXT                   PIC X(98)   VALUE SPACES.   00630500
006306     05  FILLER                       PIC X(04)   VALUE SPACES.   00630603
006307                                                                  00630700
006310*-----------------------------------------------------------------00631000
006320*  PKT_TXT LAYOUT IN "I" RECORDS FROM TUPLDER                     00632000
006330*-----------------------------------------------------------------00633000
006340     COPY WSWS024.                                                00634000
006350                                                                  00635000
008000 01  PS-SWITCHES.                                                 00800000
008100     05  PS-EOF-INPUT-SW            PIC  X(01)   VALUE 'N'.       00810001
008200         88  PS-EOF-INPUT                        VALUE 'Y'.       00820001
008300         88  PS-EOF-INPUT-NO                     VALUE 'N'.       00830001
008800                                                                  00880000
008900 01  SD-SYSTEM-DATE.                                              00890000
009000     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00900000
009100     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00910000
009200     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00920000
009300                                                                  00930000
009400 01  ST-SYSTEM-TIME.                                              00940000
009500     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00950000
009600     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00960000
009700     05  FILLER                     PIC  9(04)   VALUE ZERO.      00970000
009800                                                                  00980000
009900 01  PV-VARIABLES.                                                00990000
010000     05  PV-30                      PIC  99      VALUE 30.        01000000
010100     05  PV-DISP-SQLCODE            PIC  -999    VALUE ZEROES.    01010000
010200     05  PV-USERID                  PIC  X(08)   VALUE SPACES.    01020000
010300     05  PV-USER-ID                 PIC  X(08)   VALUE SPACES.    01030000
010400     05  PV-TMST                    PIC  X(28)   VALUE SPACES.    01040000
010500     05  PV-PAGE-COUNT-RPT          PIC S9(07)   COMP-3           01050002
010600                                                 VALUE ZERO.      01060000
010900     05  PV-LINES-USED-RPT          PIC S9(04)   COMP-3           01090002
011000                                                 VALUE ZERO.      01100000
011300     05  PV-NULL-IND-1              PIC S9(04)   VALUE ZEROS      01130000
011400                                                 COMP SYNC.       01140000
011500     05  PV-NULL-IND-2              PIC S9(04)   VALUE ZEROS      01150000
011600                                                 COMP SYNC.       01160000
011700                                                                  01170000
011800     05  PV-PREV-USER-ID            PIC X(08)    VALUE SPACES.    01180000
011900     05  PV-PREV-OPER-UNIT          PIC 9(04)    VALUE ZEROES.    01190000
011901                                                                  01190109
011910     05  PV-WORK-DATE                PIC  X(10)    VALUE SPACES.  01191009
011911     05  PV-WORK-DATE-R REDEFINES PV-WORK-DATE.                   01191109
011912         10  PV-WORK-CC              PIC  99.                     01191215
011913         10  PV-WORK-YY              PIC  99.                     01191315
011914         10  PV-WORK-SLASH1          PIC   X.                     01191415
011915         10  PV-WORK-MM              PIC  99.                     01191509
011916         10  PV-WORK-SLASH2          PIC   X.                     01191615
011917         10  PV-WORK-DD              PIC  99.                     01191709
011920     05  PV-RPT-CURRENT-DATE         PIC  X(10)    VALUE SPACES.  01192009
011921                                                                  01192109
011930     05  PV-TRANSACTION-DATE         PIC  X(08)    VALUE SPACES.  01193014
011940     05  PV-TRANSACTION-DATE-R REDEFINES PV-TRANSACTION-DATE.     01194009
011950         10  PV-TRAN-MM              PIC  99.                     01195009
011960         10  PV-TRAN-SLASH1          PIC   X.                     01196009
011970         10  PV-TRAN-DD              PIC  99.                     01197009
011980         10  PV-TRAN-SLASH2          PIC   X.                     01198009
011991         10  PV-TRAN-YY              PIC  99.                     01199109
012000                                                                  01200000
012100 01  PC-CONSTANTS.                                                01210000
012200     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'SUKRP068'. 01220000
012300     05  PC-MAX-LINES-ON-PAGE         PIC S9(3) COMP-3 VALUE +60. 01230000
012400     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3  COMP.  01240000
012500                                                                  01250000
012510* DMH 02/2017 INCREASE REPORT SIZE                                01251021
012600***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 01260000
012700*    COPY DPWS132O.                                               01270021
012800***  STANDARD REPORT HEADER FOR 200 COLUMN REPORT                 01280021
012900     COPY DPWS200O.                                               01290021
013200                                                                  01320000
013300 01  HL-HEADING-LINE-1.                                           01330000
013400     05  FILLER                      PIC  X(86)  VALUE SPACES.    01340021
013500     05  FILLER                      PIC  X(28)  VALUE            01350000
013600      'EFC CASE RECEIPT CORRECTIONS'.                             01360000
013700     05  FILLER                      PIC  X(86)  VALUE SPACES.    01370021
013800                                                                  01380000
014650 01  HL-HEADING-LINE-2.                                           01465000
014660     05  FILLER              PIC  X(04) VALUE 'OPER'.             01466000
014670     05  FILLER              PIC  X(01) VALUE  SPACES.            01467000
014680     05  FILLER              PIC  X(04) VALUE 'DEST'.             01468000
014690     05  FILLER              PIC  X(02) VALUE  SPACES.            01469000
014700     05  FILLER              PIC  X(12) VALUE 'INBOUND CASE'.     01470000
014800     05  FILLER              PIC  X(12) VALUE  SPACES.            01480000
014900     05  FILLER              PIC  X(02) VALUE 'PO'.               01490000
015000     05  FILLER              PIC  X(04) VALUE  SPACES.            01500000
015100     05  FILLER              PIC  X(09) VALUE 'RCVR LINE'.        01510000
015110     05  FILLER              PIC  X(01) VALUE  SPACES.            01511008
015120     05  FILLER              PIC  X(04) VALUE 'ORIG'.             01512008
015200     05  FILLER              PIC  X(03) VALUE  SPACES.            01520000
015300     05  FILLER              PIC  X(03) VALUE 'SKU'.              01530000
015400     05  FILLER              PIC  X(07) VALUE  SPACES.            01540000
015500     05  FILLER              PIC  X(03) VALUE 'QTY'.              01550000
015600     05  FILLER              PIC  X(02) VALUE  SPACES.            01560000
015700     05  FILLER              PIC  X(07) VALUE 'USER ID'.          01570000
015800     05  FILLER              PIC  X(03) VALUE  SPACES.            01580000
015810     05  FILLER              PIC  X(07) VALUE ' NEW PO'.          01581023
015821     05  FILLER              PIC  X(05) VALUE '-LINE'.            01582121
015822     05  FILLER              PIC  X(01) VALUE  SPACE.             01582221
015830     05  FILLER              PIC  X(10) VALUE 'WMOS SHPMT'.       01583008
015840     05  FILLER              PIC  X(02) VALUE  SPACES.            01584008
015850     05  FILLER              PIC  X(04) VALUE 'TRIP'.             01585000
015860     05  FILLER              PIC  X(05) VALUE  SPACES.            01586008
015870     05  FILLER              PIC  X(06) VALUE 'REASON'.           01587000
015880     05  FILLER              PIC  X(07) VALUE  SPACES.            01588008
015890     05  FILLER              PIC  X(04) VALUE 'DATE'.             01589008
015891     05  FILLER              PIC  X(02) VALUE  SPACES.            01589108
015892* DMH - 02/20/2017  BEGIN                                         01589221
015893     05  FILLER              PIC  X(01) VALUE  SPACE.             01589321
015894     05  FILLER              PIC  X(09) VALUE 'ORIG TRIP'.        01589421
015895     05  FILLER              PIC  X(01) VALUE SPACE.              01589521
015896     05  FILLER              PIC  X(10) VALUE 'ORIG SHPMT'.       01589621
015897     05  FILLER              PIC  X(02) VALUE SPACE.              01589735
015898     05  FILLER              PIC  X(04) VALUE 'OPER'.             01589830
015899     05  FILLER              PIC  X(02) VALUE SPACE.              01589930
015900     05  FILLER              PIC  X(09) VALUE ' ORIG PO '.        01590035
015901     05  FILLER              PIC  X(04) VALUE 'RCVR'.             01590130
015902     05  FILLER              PIC  X(01) VALUE SPACE.              01590230
015903     05  FILLER              PIC  X(02) VALUE 'ST'.               01590335
015904     05  FILLER              PIC  X(01) VALUE SPACE.              01590430
015905     05  FILLER              PIC  X(08) VALUE 'ORIG DTE'.         01590530
015906     05  FILLER              PIC  X(14) VALUE  SPACE.             01590630
015910* DMH - 02/20/2017  END                                           01591021
016000                                                                  01600000
023400 01  DL-DETAIL-LINE-1.                                            02340000
023500     05  DL-OPER                     PIC  Z(04).                  02350000
023600     05  FILLER                      PIC  X(01) VALUE  SPACES.    02360000
023700     05  DL-DEST                     PIC  Z(04).                  02370000
023800     05  FILLER                      PIC  X(01) VALUE  SPACES.    02380000
023900     05  DL-CASE                     PIC  9(20).                  02390000
024000     05  FILLER                      PIC  X(01) VALUE  SPACES.    02400000
024100     05  DL-PO                       PIC  Z(09).                  02410000
024200     05  FILLER                      PIC  X(01) VALUE  '-'.       02420000
024300     05  DL-RCVR                     PIC  9(04).                  02430000
024400     05  FILLER                      PIC  X(01) VALUE  '-'.       02440000
024500     05  DL-LINE                     PIC  9(04).                  02450000
024600     05  FILLER                      PIC  X(01) VALUE  SPACES.    02460000
024610     05  DL-ORIG                     PIC  Z(04).                  02461008
024620     05  FILLER                      PIC  X(01) VALUE  SPACES.    02462008
024700     05  DL-SKU                      PIC  9(08).                  02470000
024800     05  FILLER                      PIC  X(01) VALUE  SPACES.    02480000
024900     05  DL-QTY                      PIC  ZZ,ZZ9.                 02490000
025000     05  FILLER                      PIC  X(01) VALUE  SPACES.    02500000
025100     05  DL-USERID                   PIC  X(08).                  02510000
025200     05  FILLER                      PIC  X(01) VALUE  SPACES.    02520000
025300     05  DL-NEW-PO                   PIC  Z(09).                  02530000
025400     05  FILLER                      PIC  X(01) VALUE  SPACES.    02540000
025401* DMH - 02/20/2017  BEGIN                                         02540120
025410     05  DL-NEW-LINE                 PIC  Z(04).                  02541020
025420     05  FILLER                      PIC  X(01) VALUE  SPACES.    02542020
025430* DMH - 02/20/2017  END                                           02543020
025500     05  DL-WMOS-SHIPMENT            PIC  X(10).                  02550008
025600     05  FILLER                      PIC  X(01) VALUE  SPACES.    02560000
025700     05  DL-INBD-TRIP                PIC  Z(09).                  02570000
025710     05  FILLER                      PIC  X(01) VALUE  SPACES.    02571000
025720     05  DL-REASON                   PIC  X(10).                  02572008
025730     05  FILLER                      PIC  X(01) VALUE  SPACES.    02573000
025740     05  DL-DATE                     PIC  X(08).                  02574008
025741     05  FILLER                      PIC  X(01) VALUE  SPACES.    02574121
025750* DMH - 02/20/2017  BEGIN                                         02575021
025751     05  FILLER                      PIC  X(01) VALUE  SPACES.    02575121
025760     05  DL-ORIG-TRIP                PIC  Z(09) VALUE  ZEROES.    02576021
025770     05  FILLER                      PIC  X(01) VALUE  SPACE.     02577021
025780     05  DL-ORIG-SHPMT               PIC  X(10) VALUE  SPACES.    02578021
025790     05  FILLER                      PIC  X(01) VALUE  SPACE.     02579021
025791     05  DL-ORIG-OPER                PIC  Z(04) VALUE  ZEROES.    02579130
025792     05  FILLER                      PIC  X(01) VALUE  SPACE.     02579230
025793     05  DL-ORIG-PO                  PIC  Z(09) VALUE  ZEROES.    02579330
025794     05  FILLER                      PIC  X(01) VALUE  SPACE.     02579421
025795     05  DL-ORIG-RCVR                PIC  Z(04) VALUE  ZEROES.    02579521
025796     05  FILLER                      PIC  X(01) VALUE  SPACE.     02579621
025797     05  DL-ORIG-STATUS              PIC  X(02) VALUE  SPACES.    02579721
025798     05  FILLER                      PIC  X(01) VALUE  SPACE.     02579821
025799     05  DL-ORIG-DATE                PIC  X(08) VALUE  SPACES.    02579921
025800     05  FILLER                      PIC  X(14) VALUE  SPACE.     02580021
025810* DMH - 02/20/2017  END                                           02581021
025900                                                                  02590000
026120 01  END-OF-REPORT-LINE.                                          02612000
026130     05  FILLER                  PIC  X(44)    VALUE SPACES.      02613000
026140     05  FILLER                  PIC  X(45)    VALUE              02614000
026150          '*******   E N D   O F   R E P O R T   *******'.        02615000
026160     05  FILLER                  PIC  X(43)    VALUE SPACES.      02616000
026170/                                                                 02617000
026171******************************************************************02617126
026172*  USED FOR DB2 ERROR MESSAGE BUILDING                            02617226
026173******************************************************************02617326
026174     COPY DPWS004.                                                02617426
026175                                                                  02617526
026180******************************************************************02618000
026190     COPY SQLCA2.                                                 02619000
026200                                                                  02620000
026300     EXEC SQL                                                     02630000
026400         INCLUDE SQLCA                                            02640000
026500     END-EXEC.                                                    02650000
026600                                                                  02660000
026700*----------------------------------------------------------------*02670000
026800*    WST_SHPMT_XREF_HDR                                           02680000
026900*----------------------------------------------------------------*02690000
027000     EXEC SQL                                                     02700000
027100          INCLUDE WST00001                                        02710000
027200     END-EXEC.                                                    02720000
027300                                                                  02730000
037400                                                                  03740000
037410*----------------------------------------------------------------*03741010
037420*    TCOCNTL -  COMPNAY CONTROL                                   03742010
037430*----------------------------------------------------------------*03743010
037440     EXEC SQL                                                     03744010
037450          INCLUDE TCOCNTL                                         03745010
037460     END-EXEC.                                                    03746010
037470                                                                  03747010
037480                                                                  03748010
037490*----------------------------------------------------------------*03749010
037491*    TINPKSU                                                      03749116
037492*----------------------------------------------------------------*03749210
037493     EXEC SQL                                                     03749310
037494          INCLUDE TINPKSU                                         03749416
037495     END-EXEC.                                                    03749510
037496                                                                  03749610
037497                                                                  03749710
037498*----------------------------------------------------------------*03749810
037499*    TPKSLIP                                                      03749916
037500*----------------------------------------------------------------*03750010
037501     EXEC SQL                                                     03750110
037502          INCLUDE TPKSLIP                                         03750216
037503     END-EXEC.                                                    03750310
037504                                                                  03750410
037505                                                                  03750510
037506*----------------------------------------------------------------*03750623
037507*    TSHUNLO                                                      03750723
037508*----------------------------------------------------------------*03750823
037509     EXEC SQL                                                     03750923
037510          INCLUDE TSHUNLO                                         03751023
037511     END-EXEC.                                                    03751123
037512                                                                  03751223
037513                                                                  03751323
037514*----------------------------------------------------------------*03751423
037523*    SUT_OTBND_CART                                               03752323
037524*----------------------------------------------------------------*03752423
037525     EXEC SQL                                                     03752523
037526          INCLUDE SUT00024                                        03752623
037527     END-EXEC.                                                    03752723
037528                                                                  03752823
037529                                                                  03752923
037530*----------------------------------------------------------------*03753023
037531*    SUT_OTBND_LOC                                                03753129
037532*----------------------------------------------------------------*03753223
037533     EXEC SQL                                                     03753323
037534          INCLUDE SUT00027                                        03753429
037535     END-EXEC.                                                    03753523
037536                                                                  03753623
037537                                                                  03753723
037538*----------------------------------------------------------------*03753829
037539*    SUT_OTBND_UPC                                                03753929
037540*----------------------------------------------------------------*03754029
037541     EXEC SQL                                                     03754129
037542          INCLUDE SUT00028                                        03754229
037543     END-EXEC.                                                    03754329
037544                                                                  03754429
037545                                                                  03754529
037546*----------------------------------------------------------------*03754623
037547*    TRECEIV                                                      03754723
037548*----------------------------------------------------------------*03754823
037549     EXEC SQL                                                     03754923
037550          INCLUDE TRECEIV                                         03755023
037551     END-EXEC.                                                    03755123
037552                                                                  03755223
037553                                                                  03755323
037560****************************************************************  03756000
037600 PROCEDURE DIVISION.                                              03760000
037700****************************************************************  03770000
037800 0000-MAINLINE.                                                   03780000
037900                                                                  03790000
038000     PERFORM 1000-INITIALIZE                                      03800000
038100                                                                  03810000
038200     PERFORM 2000-PROCESS                                         03820000
038300       UNTIL PS-EOF-INPUT.                                        03830001
038400                                                                  03840000
038700     PERFORM 9000-EOJ.                                            03870000
038800                                                                  03880000
038900     GOBACK.                                                      03890000
039000                                                                  03900000
039100****************************************************************  03910000
039200 1000-INITIALIZE.                                                 03920000
039300                                                                  03930000
039400     DISPLAY ' SUKRP068 STARTED'                                  03940000
039500     EXEC SQL                                                     03950000
039600          SET :PV-TMST = CURRENT TIMESTAMP                        03960000
039700     END-EXEC.                                                    03970000
039800                                                                  03980000
039910     OPEN INPUT  INPUT-FILE                                       03991004
039920          INPUT  CONTROL-FILE                                     03992009
040000          OUTPUT REPORT-FILE.                                     04000000
040200                                                                  04020000
040570* LOAD SYSTEM DATE INTO HEADINGS                                  04057000
040580     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04058000
040590     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04059000
040600                                                                  04060000
040700     MOVE SD-SYSTEM-DATE-YY      TO DP200O-RUN-YEAR.              04070021
040800     MOVE SD-SYSTEM-DATE-MM      TO DP200O-RUN-MONTH.             04080021
040900     MOVE SD-SYSTEM-DATE-DD      TO DP200O-RUN-DAY.               04090021
041000     MOVE ST-SYSTEM-HOUR         TO DP200O-RUN-HOUR.              04100021
041100     MOVE ST-SYSTEM-MINUTE       TO DP200O-RUN-MINUTE.            04110021
041200                                                                  04120000
041300     MOVE PC-CURRENT-PROGRAM-NAME                                 04130000
041400                                 TO DP200O-PROGRAM-NAME.          04140021
041500                                                                  04150000
041620     PERFORM 8005-READ-INPUT-FILE.                                04162000
041700                                                                  04170000
042104     MOVE 1                      TO DP200O-REPORT-NUMBER          04210421
042105                                    DP200O-PAGE-NUMBER            04210521
042106                                                                  04210600
042107     PERFORM 8100-WRITE-MAIN-HEADINGS-RPT.                        04210700
042108                                                                  04210809
042109     READ CONTROL-FILE  INTO                                      04210909
042110           PV-CONTROL-CARD.                                       04211009
042150     DISPLAY 'SUKRP068:  '                                        04215009
042151             'CONTROL CARD:'                                      04215109
042160             PV-CONTROL-CARD                                      04216009
042170     DISPLAY SPACES                                               04217009
042190                                                                  04219009
042200     PERFORM 1100-GET-PROCESS-DATE.                               04220009
042210                                                                  04221009
042220*-----------------------------------------------------------------04222009
042230*                                                                 04223009
042240*-----------------------------------------------------------------04224009
042250 1100-GET-PROCESS-DATE.                                           04225009
042260                                                                  04226009
042270     EXEC SQL                                                     04227009
042280          SELECT DISTINCT(DATE(BTCH_PRC_DTE))                     04228009
042290                ,CURRENT DATE                                     04229009
042291            INTO                                                  04229109
042292                 :COCNTL-BTCH-PRC-DTE                             04229209
042293                ,:PV-RPT-CURRENT-DATE                             04229309
042294            FROM                                                  04229409
042295                 TCOCNTL                                          04229509
042296     END-EXEC                                                     04229609
042297                                                                  04229709
042298     EVALUATE TRUE                                                04229809
042299         WHEN SQLCODE = ZERO                                      04229909
042300              CONTINUE                                            04230009
042310         WHEN SQLCODE = -904                                      04231009
042320         WHEN SQLCODE = -911                                      04232009
042330              CONTINUE                                            04233009
042340         WHEN SQLWARN0 NOT = SPACES                               04234009
042350         WHEN SQLCODE < ZERO                                      04235009
042360         WHEN SQLCODE > ZERO                                      04236009
042370              CONTINUE                                            04237011
042393     END-EVALUATE.                                                04239309
042394                                                                  04239409
042395     IF   PV-CURRENT-DAY                                          04239509
042396          MOVE PV-RPT-CURRENT-DATE  TO  PV-WORK-DATE              04239609
042397     ELSE                                                         04239709
042398          MOVE COCNTL-BTCH-PRC-DTE  TO  PV-WORK-DATE              04239809
042399     END-IF.                                                      04239909
042400                                                                  04240009
042402     MOVE  PV-WORK-MM               TO  PV-TRAN-MM                04240209
042403     MOVE  PV-WORK-SLASH1           TO  PV-TRAN-SLASH1            04240309
042404     MOVE  PV-WORK-DD               TO  PV-TRAN-DD                04240409
042405     MOVE  PV-WORK-SLASH2           TO  PV-TRAN-SLASH2            04240509
042407     MOVE  PV-WORK-YY               TO  PV-TRAN-YY                04240709
042409                                                                  04240909
042418     DISPLAY 'SUKRP068 TRANSACTION DATE:' PV-TRANSACTION-DATE.    04241809
042419                                                                  04241909
042420                                                                  04242009
042430                                                                  04243000
042500                                                                  04250000
042600******************************************************************04260000
042700 2000-PROCESS.                                                    04270000
042800******************************************************************04280000
042900                                                                  04290000
042901     MOVE  IN-PKT-TXT  TO  WS024-UPLOAD-ERROR-RECORD.             04290101
042902                                                                  04290201
042910     PERFORM 2010-GET-TRIP.                                       04291000
042920                                                                  04292000
042930* DMH - 2/2017 BEGIN                                              04293021
042940     IF  IN-ERR-TYPE  = 'I'    AND                                04294022
042941        (IN-ERR-CDE   =  '002'  OR                                04294140
042942         IN-ERR-CDE   =  '003')                                   04294240
042943         SET  WS024-PREV-RECV  TO  TRUE                           04294340
042950     END-IF.                                                      04295022
042951                                                                  04295122
042952     MOVE  ZEROES  TO  PV-ORIG-TRIP                               04295229
042953                       PV-ORIG-OPER                               04295330
042954                       SUT00028-TRN-NBR                           04295430
042955                       SUT00028-RCVR-SEQ-NBR.                     04295530
042956                                                                  04295630
042957     MOVE  SPACES  TO  WST00001-EXT-SHP-ID                        04295730
042958                       PV-ORIG-RCVD                               04295830
042959                       RECEIV-STATUS-CDE                          04295935
042960                       PV-RCVD-DATE.                              04296036
042961                                                                  04296135
042962     IF  WS024-PREV-RECV                                          04296235
042963         PERFORM 4000-GET-ORIG-TRIP                               04296335
042964         PERFORM 4020-GET-ORIG-PO-RCVR                            04296435
042965     END-IF.                                                      04296535
042966* DMH - 2/2017 END                                                04296635
042970                                                                  04297021
043000     PERFORM 3000-RPT-DETAIL.                                     04300000
043100                                                                  04310000
043200     PERFORM 8005-READ-INPUT-FILE.                                04320000
044840                                                                  04484000
044850                                                                  04485000
044860******************************************************************04486000
044861 2010-GET-TRIP.                                                   04486100
044880******************************************************************04488000
044890                                                                  04489000
044900     EXEC SQL                                                     04490000
045000        SELECT  INTR_TRIP_ID                                      04500000
045001          INTO :WST00001-INTR-TRIP-ID                             04500100
045010          FROM  WST_SHPMT_XREF_HDR                                04501002
045020         WHERE  EXT_SHP_ID  =  :WS024-RCVD-SHPMT-NBR              04502000
045030          WITH UR                                                 04503000
045800     END-EXEC.                                                    04580000
045900                                                                  04590000
046000     EVALUATE TRUE                                                04600000
046100         WHEN SQLCODE = ZEROS                                     04610000
046110         WHEN SQLCODE = -811                                      04611000
046200              CONTINUE                                            04620000
046220                                                                  04622000
046230         WHEN SQLCODE = +100                                      04623000
046240              MOVE ZEROES  TO  WST00001-INTR-TRIP-ID              04624000
046250                                                                  04625000
046260         WHEN OTHER                                               04626000
046261              MOVE ZEROES  TO  WST00001-INTR-TRIP-ID              04626100
046280     END-EVALUATE.                                                04628000
046300                                                                  04630000
046400                                                                  04640000
046500*----------------------------------------------------------------*04650000
046600* UPLOAD ERROR REPORT DETAIL LINE                                 04660000
046700*----------------------------------------------------------------*04670000
046800 3000-RPT-DETAIL.                                                 04680000
046900                                                                  04690000
047000     INITIALIZE DL-DETAIL-LINE-1.                                 04700000
047001                                                                  04700100
047010     MOVE IN-OPER                  TO  DL-OPER.                   04701000
047030     MOVE WS024-STORE-NUMBER       TO  DL-DEST.                   04703000
047050     MOVE WS024-CASE-NUMBER        TO  DL-CASE.                   04705000
047070     MOVE WS024-PO-NUMBER          TO  DL-PO.                     04707000
047090     MOVE WS024-REC-SEQ-NUMBER     TO  DL-RCVR.                   04709000
047092     MOVE WS024-PO-LINE-NUMBER     TO  DL-LINE.                   04709200
047094     MOVE WS024-SKU-NUMBER         TO  DL-SKU.                    04709400
047096     MOVE WS024-SKU-QTY            TO  DL-QTY.                    04709600
047098     MOVE WS024-CRE-USER-ID        TO  DL-USERID.                 04709800
047100     MOVE WS024-NEW-PO-NUMBER      TO  DL-NEW-PO.                 04710000
047101     MOVE WS024-NEW-LINE           TO  DL-NEW-LINE.               04710120
047102     MOVE WS024-RCVD-SHPMT-NBR     TO  DL-WMOS-SHIPMENT.          04710200
047104     MOVE WST00001-INTR-TRIP-ID    TO  DL-INBD-TRIP.              04710400
047105                                                                  04710500
047106     IF  IN-ERR-TYPE  =  'I'  AND                                 04710600
047107         IN-ERR-CDE   =  '001'                                    04710700
047108         MOVE 'WRONG PO  '         TO  DL-REASON                  04710809
047109         MOVE ZEROES               TO  DL-ORIG                    04710909
047110     ELSE                                                         04711009
047111     IF  IN-ERR-TYPE  =  'I'  AND                                 04711109
047112         IN-ERR-CDE   =  '002'                                    04711209
047113         MOVE 'CASE REUSE'         TO  DL-REASON                  04711317
047114         PERFORM 3010-GET-ORIG-RCVR                               04711410
047115         MOVE PKSLIP-REC-SEQ-NBR   TO  DL-ORIG                    04711517
047116* DMH - 2/2017 BEGIN                                              04711623
047122         MOVE PV-ORIG-TRIP          TO  DL-ORIG-TRIP              04712229
047123         MOVE WST00001-EXT-SHP-ID   TO  DL-ORIG-SHPMT             04712323
047124         MOVE SUT00028-TRN-NBR      TO  DL-ORIG-PO                04712423
047125         MOVE SUT00028-RCVR-SEQ-NBR TO  DL-ORIG-RCVR              04712523
047126         MOVE RECEIV-STATUS-CDE     TO  DL-ORIG-STATUS            04712623
047127         MOVE PV-ORIG-OPER          TO  DL-ORIG-OPER              04712730
047128         MOVE PV-ORIG-RCVD-YY       TO  PV-RCVD-RCVD-YY           04712836
047129         MOVE PV-ORIG-DASH-1        TO  PV-RCVD-DASH-1            04712936
047130         MOVE PV-ORIG-RCVD-MM       TO  PV-RCVD-RCVD-MM           04713036
047131         MOVE PV-ORIG-DASH-2        TO  PV-RCVD-DASH-2            04713136
047132         MOVE PV-ORIG-RCVD-DD       TO  PV-RCVD-RCVD-DD           04713236
047133         MOVE PV-RCVD-DATE          TO  DL-ORIG-DATE              04713336
047134* DMH - 2/2017 END                                                04713423
047135     ELSE                                                         04713538
047136* DMH - 09/2017                                                   04713638
047137     IF  IN-ERR-TYPE  =  'I'  AND                                 04713738
047138         IN-ERR-CDE   =  '003'                                    04713838
047139         MOVE 'WMU REUSE '         TO  DL-REASON                  04713938
047140         PERFORM 3010-GET-ORIG-RCVR                               04714040
047141         MOVE PKSLIP-REC-SEQ-NBR    TO  DL-ORIG                   04714138
047143         MOVE PV-ORIG-TRIP          TO  DL-ORIG-TRIP              04714338
047144         MOVE WST00001-EXT-SHP-ID   TO  DL-ORIG-SHPMT             04714438
047145         MOVE SUT00028-TRN-NBR      TO  DL-ORIG-PO                04714538
047146         MOVE SUT00028-RCVR-SEQ-NBR TO  DL-ORIG-RCVR              04714638
047147         MOVE RECEIV-STATUS-CDE     TO  DL-ORIG-STATUS            04714738
047148         MOVE PV-ORIG-OPER          TO  DL-ORIG-OPER              04714838
047149         MOVE PV-ORIG-RCVD-YY       TO  PV-RCVD-RCVD-YY           04714938
047150         MOVE PV-ORIG-DASH-1        TO  PV-RCVD-DASH-1            04715038
047151         MOVE PV-ORIG-RCVD-MM       TO  PV-RCVD-RCVD-MM           04715138
047152         MOVE PV-ORIG-DASH-2        TO  PV-RCVD-DASH-2            04715238
047153         MOVE PV-ORIG-RCVD-DD       TO  PV-RCVD-RCVD-DD           04715338
047154         MOVE PV-RCVD-DATE          TO  DL-ORIG-DATE              04715438
047155* DMH - 9/2017 END                                                04715538
047156     ELSE                                                         04715609
047157         MOVE SPACES               TO  DL-REASON                  04715717
047158                                       DL-ORIG-SHPMT              04715830
047159                                       DL-ORIG-STATUS             04715930
047160         MOVE ZEROES               TO  DL-ORIG                    04716017
047161                                       DL-ORIG-TRIP               04716130
047162                                       DL-ORIG-PO                 04716230
047163                                       DL-ORIG-RCVR               04716330
047164                                       DL-ORIG-OPER               04716430
047165                                       DL-ORIG-DATE               04716530
047166     END-IF                                                       04716609
047167     END-IF.                                                      04716709
047168                                                                  04716809
047170     MOVE PV-TRANSACTION-DATE      TO  DL-DATE.                   04717009
047500                                                                  04750000
047600     PERFORM 8110-WRITE-DETAIL-RPT.                               04760002
047700                                                                  04770000
047701                                                                  04770110
047710 3010-GET-ORIG-RCVR.                                              04771010
047720                                                                  04772010
047721     MOVE WS024-CASE-NUMBER-N  TO  INPKSU-SHIPT-UNT-ID            04772117
047722     MOVE WS024-PO-NUMBER      TO  INPKSU-PO-NBR                  04772216
047723     MOVE ZEROES               TO  PKSLIP-REC-SEQ-NBR             04772316
047724                                                                  04772410
047730     EXEC SQL                                                     04773010
047740        SELECT  DISTINCT B.REC_SEQ_NBR                            04774016
047750          INTO :PKSLIP-REC-SEQ-NBR                                04775016
047760          FROM  TINPKSU  A                                        04776016
047761             ,  TPKSLIP  B                                        04776116
047770         WHERE A.SHIPT_UNT_ID   =  :INPKSU-SHIPT-UNT-ID           04777019
047771           AND A.PO_NBR         =  :INPKSU-PO-NBR                 04777116
047772           AND A.PO_NBR         =  B.PO_NBR                       04777216
047773           AND A.SEQ_NBR        =  B.SEQ_NBR                      04777316
047774           AND B.VER_STAT_CDE   =  'A'                            04777416
047775           AND B.PKSL_STAT_CDE  = 'AC'                            04777516
047780          WITH UR                                                 04778010
047790     END-EXEC.                                                    04779010
047791                                                                  04779110
047792     EVALUATE TRUE                                                04779210
047793         WHEN SQLCODE = ZEROS                                     04779310
047794         WHEN SQLCODE = -811                                      04779410
047795              CONTINUE                                            04779510
047796                                                                  04779610
047797         WHEN SQLCODE = +100                                      04779710
047798              MOVE ZEROES  TO  PKSLIP-REC-SEQ-NBR                 04779818
047799                                                                  04779910
047800         WHEN OTHER                                               04780010
047801              MOVE ZEROES  TO  PKSLIP-REC-SEQ-NBR                 04780118
047802     END-EVALUATE.                                                04780210
047810                                                                  04781000
047811                                                                  04781122
047846*---------------------------------------------------------------  04784639
047847* GET THE ORIGINAL TRIP THAT THE CARTON WAS ORIGINALY RCVD.       04784739
047848*---------------------------------------------------------------  04784839
047849 4000-GET-ORIG-TRIP.                                              04784939
047850                                                                  04785039
047851     MOVE  WS024-CASE-NUMBER-N  TO  SHUNLO-SHIPT-UNT-ID.          04785139
047852                                                                  04785239
047853     EXEC SQL                                                     04785339
047854        SELECT  TRIP_ID                                           04785439
047855               ,DATE(CRE_TMST)                                    04785539
047856               ,OPER_UNT_ID                                       04785639
047857          INTO :PV-ORIG-TRIP                                      04785739
047858             , :PV-ORIG-RCVD                                      04785839
047859             , :PV-ORIG-OPER                                      04785939
047860          FROM  TSHUNLO                                           04786039
047861         WHERE  SHIPT_UNT_ID  =  :SHUNLO-SHIPT-UNT-ID             04786139
047862           AND  SCN_LOC_ID   IN  ('RECV','WRCV')                  04786239
047863          WITH UR                                                 04786339
047864     END-EXEC.                                                    04786439
047865                                                                  04786539
047866     EVALUATE TRUE                                                04786639
047867         WHEN SQLCODE = ZEROS                                     04786739
047868         WHEN SQLCODE = -811                                      04786839
047869              PERFORM 4010-GET-ORIG-SHPMT                         04786939
047870                                                                  04787039
047871         WHEN SQLCODE = +100                                      04787139
047872              PERFORM 4005-GET-RECV-LOC                           04787239
047873                                                                  04787339
047874         WHEN OTHER                                               04787439
047875             MOVE SHUNLO-SHIPT-UNT-ID     TO  PV-DISP-SSCC        04787539
047876             MOVE SQLCODE                 TO  PV-DISP-SQL         04787639
047877             DISPLAY 'SUKRP068: 4000-'                            04787739
047878                     ' SQL:'  PV-DISP-SQL                         04787839
047879                     ' SML:'  PV-DISP-SSCC                        04787939
047880                                                                  04788039
047881             MOVE '4000-GET-ORIG-TRIP    '                        04788139
047882                           TO PV-ABEND-PARAGRAPH                  04788239
047883             MOVE 'TSHUUPC'           TO PV-DB2-TABLE-NAME        04788339
047884             PERFORM 9900-DB2-ABEND                               04788439
047885     END-EVALUATE.                                                04788539
047886                                                                  04788639
047887                                                                  04788739
047888*---------------------------------------------------------------  04788839
047889* GET THE ORIGINAL TRIP THAT THE CARTON WAS ORIGINALY RCVD.       04788939
047890* FROM OUTBOUND LOC                                               04789039
047891*---------------------------------------------------------------  04789139
047892 4005-GET-RECV-LOC.                                               04789239
047893                                                                  04789339
047894     MOVE  WS024-CASE-NUMBER-N  TO  SUT00024-ORIG-CART-ID         04789439
047895                                                                  04789539
047896     EXEC SQL                                                     04789639
047897        SELECT  B.INBD_TRIP_ID                                    04789739
047898               ,DATE(B.CRE_TMST)                                  04789839
047899               ,B.LOC_NBR                                         04789939
047900          INTO :PV-ORIG-TRIP                                      04790039
047901             , :PV-ORIG-RCVD                                      04790139
047902             , :PV-ORIG-OPER                                      04790239
047903          FROM  SUT_OTBND_CART A                                  04790339
047904             ,  SUT_OTBND_LOC  B                                  04790439
047905         WHERE  A.ORIG_CART_ID  =  :SUT00024-ORIG-CART-ID         04790539
047906           AND  A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID                 04790639
047907           AND  SCN_CDE      IN  ('RECV')                         04790739
047908          WITH UR                                                 04790839
047909     END-EXEC.                                                    04790939
047910                                                                  04791039
047911     EVALUATE TRUE                                                04791139
047912         WHEN SQLCODE = ZEROS                                     04791239
047913         WHEN SQLCODE = -811                                      04791339
047914              PERFORM 4010-GET-ORIG-SHPMT                         04791439
047915                                                                  04791539
047916         WHEN SQLCODE = +100                                      04791639
047917              MOVE ZEROES  TO  SHUNLO-TRIP-ID                     04791739
047918                                                                  04791839
047919         WHEN OTHER                                               04791939
047920             MOVE SHUNLO-SHIPT-UNT-ID     TO  PV-DISP-SSCC        04792039
047921             MOVE SQLCODE                 TO  PV-DISP-SQL         04792139
047922             DISPLAY 'SUKRP068: 4000-'                            04792239
047923                     ' SQL:'  PV-DISP-SQL                         04792339
047924                     ' SML:'  PV-DISP-SSCC                        04792439
047925                                                                  04792539
047926             MOVE '4000-GET-ORIG-TRIP    '                        04792639
047927                           TO PV-ABEND-PARAGRAPH                  04792739
047928             MOVE 'TSHUUPC'           TO PV-DB2-TABLE-NAME        04792839
047929             PERFORM 9900-DB2-ABEND                               04792939
047930     END-EVALUATE.                                                04793039
047931                                                                  04793139
047932                                                                  04793239
047933*---------------------------------------------------------------  04793339
047934* GET THE ORIGINAL WMOS SHIPMENT THE CARTON WAS ORIGINALLY RCVD   04793439
047935*---------------------------------------------------------------  04793539
047936 4010-GET-ORIG-SHPMT.                                             04793639
047937                                                                  04793739
047938     MOVE  PV-ORIG-TRIP         TO  DK-INTR-TRIP-ID.              04793839
047939                                                                  04793939
047940     EXEC SQL                                                     04794039
047941        SELECT  EXT_SHP_ID                                        04794139
047942          INTO :WST00001-EXT-SHP-ID                               04794239
047943          FROM  WST_SHPMT_XREF_HDR                                04794339
047944         WHERE  INTR_TRIP_ID  =  :DK-INTR-TRIP-ID                 04794439
047945         FETCH FIRST 1 ROW ONLY                                   04794539
047946          WITH UR                                                 04794639
047947     END-EXEC.                                                    04794739
047948                                                                  04794839
047949     EVALUATE TRUE                                                04794939
047950         WHEN SQLCODE = ZEROS                                     04795039
047951         WHEN SQLCODE = -811                                      04795139
047952              CONTINUE                                            04795239
047953                                                                  04795339
047954         WHEN SQLCODE = +100                                      04795439
047955              MOVE SPACES  TO  WST00001-EXT-SHP-ID                04795539
047956                                                                  04795639
047957         WHEN OTHER                                               04795739
047958             MOVE SHUNLO-SHIPT-UNT-ID     TO  PV-DISP-SSCC        04795839
047959             MOVE DK-INTR-TRIP-ID         TO  PV-DISP-TRIP        04795939
047960             MOVE SQLCODE                 TO  PV-DISP-SQL         04796039
047961             DISPLAY 'SUKRP068: 4010-'                            04796139
047962                     ' SQL:'  PV-DISP-SQL                         04796239
047963                     ' SML:'  PV-DISP-SSCC                        04796339
047964                     ' TRIP:' PV-DISP-TRIP                        04796439
047965                                                                  04796539
047966             MOVE '4010-GET-ORIG-SHPMT   '                        04796639
047967                           TO PV-ABEND-PARAGRAPH                  04796739
047968             MOVE 'WST00001'          TO PV-DB2-TABLE-NAME        04796839
047969             PERFORM 9900-DB2-ABEND                               04796939
047970     END-EVALUATE.                                                04797039
047971                                                                  04797139
047972                                                                  04797239
047973*---------------------------------------------------------------  04797339
047974* GET THE ORIGINAL PO-RCVR THE CARTON WAS ATTACHED TO             04797439
047975*---------------------------------------------------------------  04797539
047976 4020-GET-ORIG-PO-RCVR.                                           04797639
047977                                                                  04797739
047978     MOVE  WS024-CASE-NUMBER-N  TO  SUT00024-ORIG-CART-ID         04797839
047979                                                                  04797939
047980     EXEC SQL                                                     04798039
047981        SELECT  DISTINCT                                          04798139
047982                B.TRN_NBR                                         04798239
047983              , B.RCVR_SEQ_NBR                                    04798339
047984          INTO :SUT00028-TRN-NBR                                  04798439
047985              ,:SUT00028-RCVR-SEQ-NBR                             04798539
047986          FROM  SUT_OTBND_CART A                                  04798639
047987              , SUT_OTBND_UPC  B                                  04798739
047988         WHERE  A.ORIG_CART_ID  =  :SUT00024-ORIG-CART-ID         04798839
047989           AND  A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID                 04798939
047990         FETCH FIRST 1 ROW ONLY                                   04799039
047991          WITH UR                                                 04799139
047992     END-EXEC.                                                    04799239
047993                                                                  04799339
047994     EVALUATE TRUE                                                04799439
047995         WHEN SQLCODE = ZEROS                                     04799539
047996         WHEN SQLCODE = -811                                      04799639
047997              PERFORM 4030-GET-ORIG-RCVR-STATUS                   04799739
047998                                                                  04799839
047999         WHEN SQLCODE = +100                                      04799939
048000              MOVE ZEROES  TO  SUT00028-TRN-NBR                   04800039
048001                               SUT00028-RCVR-SEQ-NBR              04800139
048002                                                                  04800239
048003         WHEN OTHER                                               04800339
048004             MOVE SHUNLO-SHIPT-UNT-ID     TO  PV-DISP-SSCC        04800439
048005             MOVE SQLCODE                 TO  PV-DISP-SQL         04800539
048006             DISPLAY 'SUKRP068: 4020-'                            04800639
048007                     ' SQL:'  PV-DISP-SQL                         04800739
048008                     ' SML:'  PV-DISP-SSCC                        04800839
048009                                                                  04800939
048010             MOVE '4020-GET-ORIG-PO-RCVR '                        04801039
048011                           TO PV-ABEND-PARAGRAPH                  04801139
048012             MOVE 'SUT_OTBND_CART'    TO PV-DB2-TABLE-NAME        04801239
048013             PERFORM 9900-DB2-ABEND                               04801339
048014     END-EVALUATE.                                                04801439
048015                                                                  04801539
048016                                                                  04801639
048017*---------------------------------------------------------------  04801739
048018* GET THE STATUS OF THE RCVR THE CARTON WAS ORIGINALLY ATTACHED   04801839
048019*---------------------------------------------------------------  04801939
048020 4030-GET-ORIG-RCVR-STATUS.                                       04802039
048021                                                                  04802139
048022     MOVE  SUT00028-TRN-NBR      TO RECEIV-ORD-NBR.               04802239
048023     MOVE  SUT00028-RCVR-SEQ-NBR TO RECEIV-REC-SEQ-NBR.           04802339
048024                                                                  04802439
048025     EXEC SQL                                                     04802539
048026        SELECT  STATUS_CDE                                        04802639
048027          INTO :RECEIV-STATUS-CDE                                 04802739
048028          FROM  TRECEIV                                           04802839
048029         WHERE  ORD_NBR       =  :RECEIV-ORD-NBR                  04802939
048030           AND  REC_SEQ_NBR   =  :RECEIV-REC-SEQ-NBR              04803039
048031          WITH UR                                                 04803139
048032     END-EXEC.                                                    04803239
048033                                                                  04803339
048034     EVALUATE TRUE                                                04803439
048035         WHEN SQLCODE = ZEROS                                     04803539
048036              CONTINUE                                            04803639
048037                                                                  04803739
048038         WHEN SQLCODE = +100                                      04803839
048039              MOVE SPACES  TO  RECEIV-STATUS-CDE                  04803939
048040                                                                  04804039
048041         WHEN OTHER                                               04804139
048042             MOVE SHUNLO-SHIPT-UNT-ID     TO  PV-DISP-SSCC        04804239
048043             MOVE RECEIV-ORD-NBR          TO  PV-DISP-PO          04804339
048044             MOVE RECEIV-REC-SEQ-NBR      TO  PV-DISP-RCVR        04804439
048045             MOVE SQLCODE                 TO  PV-DISP-SQL         04804539
048046             DISPLAY 'SUKRP068: 4030-'                            04804639
048047                     ' SQL:'  PV-DISP-SQL                         04804739
048048                     ' SML:'  PV-DISP-SSCC                        04804839
048049                     ' RCVR:' PV-DISP-PO                          04804939
048050                     '-'      PV-DISP-RCVR                        04805039
048051                                                                  04805139
048052             MOVE '4030-GET-ORIG-RCVR-STATUS'                     04805239
048053                           TO PV-ABEND-PARAGRAPH                  04805339
048054             MOVE 'TRECEIV '          TO PV-DB2-TABLE-NAME        04805439
048055             PERFORM 9900-DB2-ABEND                               04805539
048056     END-EVALUATE.                                                04805639
048057                                                                  04805739
048060                                                                  04806023
048100*---------------------------------------------------------------  04810023
048200*                                                                 04820023
048300*---------------------------------------------------------------  04830023
067051 8005-READ-INPUT-FILE.                                            06705123
067052     READ INPUT-FILE                                              06705223
067053          INTO INPUT-RECORD-DETAIL                                06705323
067054       AT END                                                     06705423
067055          SET  PS-EOF-INPUT  TO  TRUE                             06705523
067056     END-READ.                                                    06705623
067057                                                                  06705723
067058                                                                  06705823
067060 8100-WRITE-MAIN-HEADINGS-RPT.                                    06706023
067070                                                                  06707023
067080     ADD 1                            TO PV-PAGE-COUNT-RPT.       06708023
067090     MOVE PV-PAGE-COUNT-RPT           TO DP200O-PAGE-NUMBER.      06709023
067100     MOVE ZERO                        TO PV-LINES-USED-RPT.       06710023
067200                                                                  06720023
067300     WRITE REPORT-RECORD                                          06730023
067400      FROM DP200O-STANDRD-HEADER-200-COLS                         06740023
067500           AFTER ADVANCING PAGE                                   06750023
067600                                                                  06760023
067700     WRITE REPORT-RECORD                                          06770023
067800      FROM HL-HEADING-LINE-1                                      06780023
067900           AFTER ADVANCING 2 LINES.                               06790023
068000                                                                  06800023
068100     WRITE REPORT-RECORD                                          06810023
068200      FROM HL-HEADING-LINE-2                                      06820023
068300           AFTER ADVANCING 3 LINES.                               06830023
068400                                                                  06840023
068500     ADD 6                            TO PV-LINES-USED-RPT.       06850023
068600                                                                  06860023
068700     MOVE  SPACES TO REPORT-RECORD                                06870023
068800     WRITE REPORT-RECORD                                          06880023
068900           AFTER ADVANCING 1 LINES.                               06890023
069000                                                                  06900023
069100     INITIALIZE DP200O-LASER-NEW-PAGE-INDICATR.                   06910023
069200     ADD  3                           TO PV-LINES-USED-RPT.       06920023
069300                                                                  06930023
069400                                                                  06940023
073800 8110-WRITE-DETAIL-RPT.                                           07380023
073900                                                                  07390023
074000     WRITE REPORT-RECORD                                          07400023
074100      FROM DL-DETAIL-LINE-1                                       07410023
074200           AFTER 2 LINE                                           07420023
074300                                                                  07430023
074400     ADD 2                            TO PV-LINES-USED-RPT.       07440023
074500                                                                  07450023
074600     IF  PV-LINES-USED-RPT  >=  PC-MAX-LINES-ON-PAGE              07460023
074700         PERFORM 8100-WRITE-MAIN-HEADINGS-RPT                     07470023
074800     END-IF.                                                      07480023
074900                                                                  07490023
075000                                                                  07500023
076650 9000-EOJ.                                                        07665023
076660                                                                  07666023
076670     WRITE REPORT-RECORD                                          07667023
076680       FROM END-OF-REPORT-LINE                                    07668023
076690         AFTER ADVANCING 2 LINES.                                 07669023
076700                                                                  07670023
077200     CLOSE REPORT-FILE                                            07720023
077210           CONTROL-FILE                                           07721023
077300           INPUT-FILE.                                            07730023
077500                                                                  07750023
077600                                                                  07760023
077700******************************************************************07770023
077800*  ABEND ROUTINE                                                 *07780023
077900******************************************************************07790023
078000 9900-DB2-ABEND.                                                  07800023
078100                                                                  07810023
078200     MOVE SQLCODE TO PV-DISP-SQL.                                 07820026
078300     DISPLAY '*** DB2 ERROR '.                                    07830023
078400     DISPLAY '*** SQLCODE   = ' PV-DISP-SQL.                      07840026
078500     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 07850023
078600     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               07860023
078700     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               07870023
078900     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME.                07890023
079000                                                                  07900023
079100     COPY DPPD004.                                                07910023
079200                                                                  07920023
079300     MOVE +4013 TO PV-ABEND-CODE.                                 07930023
079400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07940023
079500                                                                  07950023
079600 9998-ABEND.                                                      07960023
079700                                                                  07970023
079800     DISPLAY '***************'.                                   07980023
079900     DISPLAY '** ABEND     **'.                                   07990023
080000     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               08000023
080100     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             08010023
080200     DISPLAY '***************'.                                   08020023
080300                                                                  08030023
080400     MOVE +4008                  TO PV-ABEND-CODE.                08040023
080500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08050023
080600                                                                  08060023
