000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    SUKUT033.                                         00040001
000500 AUTHOR.        PATRICK BURKE.                                    00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   JUNE 2000.                                        00070001
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000* THIS PROGRAM CREATES A RECORD COUNT FOR EACH UNIQUE SCAC READ.* 00100001
001100* THE RECORD COUNT IS RECORDED IN SU008-TOT-CHECKIN-SCAC.       * 00110001
001200***************************************************************** 00120000
001300                                                                  00130000
001400***************************************************************** 00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600***************************************************************** 00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800                                                                  00180000
001900 FILE-CONTROL.                                                    00190000
002000     SELECT CARTON-CHECKIN-FILE                                   00200001
002100         ASSIGN TO INP01.                                         00210000
002200     SELECT SUMMARY-CHECKIN-FILE                                  00220001
002300         ASSIGN TO OUT01.                                         00230000
002400                                                                  00240000
002500***************************************************************** 00250000
002600 DATA DIVISION.                                                   00260000
002700***************************************************************** 00270000
002800 FILE SECTION.                                                    00280000
002900*                                                                 00290000
003000 FD  CARTON-CHECKIN-FILE                                          00300001
003100     RECORDING MODE IS F                                          00310000
003200     LABEL RECORDS ARE STANDARD                                   00320000
003300     BLOCK CONTAINS 0 RECORDS.                                    00330000
003400 01  CARTON-CHECKIN-RECORD             PIC X(200).                00340002
003500*                                                                 00350000
003600 FD  SUMMARY-CHECKIN-FILE                                         00360001
003700     RECORDING MODE IS F                                          00370000
003800     LABEL RECORDS ARE STANDARD                                   00380000
003900     BLOCK CONTAINS 0 RECORDS.                                    00390000
004000 01  SUMMARY-CHECKIN-RECORD            PIC X(200).                00400002
004100*                                                                 00410000
004200***************************************************************** 00420000
004300 WORKING-STORAGE SECTION.                                         00430000
004400                                                                  00440000
004500 01  PS-PROGRAM-SWITCHES.                                         00450000
004510     05  PS-EOF-EXTRACT-SW            PIC X(01)  VALUE 'N'.       00451002
004520         88  PS-EOF-EXTRACT                      VALUE 'Y'.       00452002
004530         88  PS-NOT-EOF-CHECKIN                  VALUE 'N'.       00453002
004900     05  PS-VALID-RECORD-SW           PIC X(01)  VALUE 'N'.       00490000
005000         88  PS-VALID-RECORD                     VALUE 'Y'.       00500000
005100         88  PS-NOT-VALID-RECORD                 VALUE 'N'.       00510000
005200*                                                                 00520000
005300 01  PV-PROGRAM-VARIABLES.                                        00530000
005500                                                                  00550000
005600     05  PV-REC-SEQ-NBR               PIC S9(09).                 00560000
005700     05  PV-PO-NBR                    PIC S9(09).                 00570000
005702     05  PV-SCAC-CDE                  PIC X(04).                  00570206
005703     05  PV-PREV-SCAC-CDE             PIC X(04).                  00570306
005704     05  PV-PREV-PO-NBR               PIC S9(09).                 00570407
005710     05  PV-TOT-CHECKIN-SCAC          PIC S9(09) VALUE ZERO.      00571005
005800                                                                  00580000
005900     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      00590000
006000                                                                  00600000
006500     05  PV-TOTAL-INPUT-READ          PIC S9(09) VALUE ZERO       00650000
006501                                                  COMP SYNC.      00650100
006510     05  PV-RECS-WRITTEN              PIC S9(09) VALUE ZERO       00651002
006520                                                  COMP SYNC.      00652000
006600                                                                  00660000
007000 01 PC-PROGRAM-CONSTANTS.                                         00700000
007100     05 PC-PROGRAM-NAME              PIC X(08)  VALUE 'SUKUT033'. 00710001
007200     05  PC-DEFAULT-CC-DATE          PIC X(10) VALUE '9999-09-09'.00720000
007300                                                                  00730000
007400 01  PV-ABEND-FIELDS.                                             00740000
007500     05  ABEND-CODE                   PIC S9(04) VALUE +0         00750000
007600                                                 COMP SYNC.       00760000
007700     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'SUKUT033'.00770001
007800     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00780000
007900     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    00790000
008000******************************************************************00800000
008100*  USED FOR DB2 ERROR MESSAGE BUILDING                            00810000
008200******************************************************************00820000
008300     COPY DPWS004.                                                00830018
008400                                                                  00840000
010600***********************************************************       01060000
010700*  COPYBOOK USED IN CREATING EXTRACT FILE.                *       01070000
010800***********************************************************       01080000
010900     COPY SURD008.                                                01090018
011000                                                                  01100000
011100 EJECT                                                            01110000
011200***********************************************************       01120000
011300 PROCEDURE DIVISION.                                              01130000
011400***********************************************************       01140000
011500 0000-PROGRAM-MAINLINE.                                           01150000
011600*                                                                 01160000
011700     PERFORM 1000-INITIALIZATION.                                 01170000
011800*                                                                 01180000
011900     PERFORM 2000-PROCESS-CHECKIN-FILE                            01190001
012000         UNTIL PS-EOF-EXTRACT.                                    01200002
012100*                                                                 01210000
012200     PERFORM 9000-EOJ-ROUTINE.                                    01220000
012300*                                                                 01230000
012400     GOBACK.                                                      01240000
012500*                                                                 01250000
012600******************************************************************01260000
012700*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    01270000
012800******************************************************************01280000
012900 1000-INITIALIZATION.                                             01290000
013000                                                                  01300000
013100     OPEN INPUT  CARTON-CHECKIN-FILE.                             01310001
013200     OPEN OUTPUT SUMMARY-CHECKIN-FILE.                            01320001
013300                                                                  01330000
013400     PERFORM 8000-READ-CHECKIN-FILE.                              01340008
013501                                                                  01350106
013510       IF  PS-EOF-EXTRACT                                         01351006
013600          DISPLAY 'CHECKIN FILE INP01 IS EMPTY'                   01360006
013610       ELSE                                                       01361006
013611          MOVE SU008-SCAC-CDE          TO PV-PREV-SCAC-CDE        01361106
013612          MOVE SU008-PO-NBR            TO PV-PREV-PO-NBR          01361206
013700     END-IF.                                                      01370000
013800*                                                                 01380000
013900***************************************************************** 01390000
014000 2000-PROCESS-CHECKIN-FILE.                                       01400001
014100***************************************************************** 01410000
014200*                                                                 01420000
014700     IF SU008-SCAC-CDE =  PV-PREV-SCAC-CDE                        01470001
014800         ADD 1 TO PV-TOT-CHECKIN-SCAC                             01480001
014900     ELSE                                                         01490001
014910         PERFORM 2100-BUILD-RECORD-COUNT                          01491016
015002         PERFORM 8100-WRITE-UPDATE-RECORD                         01500212
015003         MOVE PV-SCAC-CDE          TO PV-PREV-SCAC-CDE            01500314
015020         MOVE PV-PO-NBR            TO PV-PREV-PO-NBR              01502014
015030         MOVE ZERO                 TO PV-TOT-CHECKIN-SCAC         01503011
015040         ADD 1                     TO PV-TOT-CHECKIN-SCAC         01504013
015100     END-IF.                                                      01510001
015700                                                                  01570000
015800     PERFORM 8000-READ-CHECKIN-FILE.                              01580002
015900*                                                                 01590000
016000***************************************************************** 01600016
016100 2100-BUILD-RECORD-COUNT.                                         01610016
016200***************************************************************** 01620016
016300*                                                                 01630016
016700         INITIALIZE SU008-EXTRACT-RECORD.                         01670016
016710*                                                                 01671016
016800         MOVE PV-TOT-CHECKIN-SCAC  TO SU008-TOT-CHECKIN-SCAC.     01680016
016900         MOVE PV-PREV-SCAC-CDE     TO SU008-SCAC-CDE.             01690016
017000*                                                                 01700016
025500***************************************************************** 02550000
025600 8000-READ-CHECKIN-FILE.                                          02560001
025700***************************************************************** 02570000
025800*                                                                 02580000
025900     READ CARTON-CHECKIN-FILE                                     02590001
026000          INTO SU008-EXTRACT-RECORD                               02600000
026100     AT END                                                       02610000
026200         SET PS-EOF-EXTRACT           TO TRUE                     02620006
026210         PERFORM 2100-BUILD-RECORD-COUNT                          02621016
026220         PERFORM 8100-WRITE-UPDATE-RECORD                         02622017
026300     NOT AT END                                                   02630006
026400         MOVE SU008-SCAC-CDE          TO PV-SCAC-CDE              02640006
026500         MOVE SU008-PO-NBR            TO PV-PO-NBR                02650000
026810         ADD 1                        TO PV-TOTAL-INPUT-READ      02681001
026900     END-READ.                                                    02690000
027000*                                                                 02700000
027010***************************************************************** 02701000
027100 8100-WRITE-UPDATE-RECORD.                                        02710000
027110***************************************************************** 02711000
027120*                                                                 02712000
027200     WRITE SUMMARY-CHECKIN-RECORD                                 02720001
027300         FROM SU008-EXTRACT-RECORD                                02730000
027400     ADD 1                            TO PV-RECS-WRITTEN.         02740001
027500*                                                                 02750000
027710***************************************************************** 02771000
027800 9000-EOJ-ROUTINE.                                                02780000
027810***************************************************************** 02781000
027900*                                                                 02790000
028000     CLOSE CARTON-CHECKIN-FILE                                    02800001
028100           SUMMARY-CHECKIN-FILE.                                  02810001
028200                                                                  02820000
028300     DISPLAY '**********************************'.                02830000
028400     DISPLAY '** SUKUT033 SUMMARY **'.                            02840001
028500     DISPLAY 'TOTAL INPUT RECS       = ' PV-TOTAL-INPUT-READ.     02850000
028600     DISPLAY 'TOTAL RECS WRITTEN     = ' PV-RECS-WRITTEN.         02860001
028800     DISPLAY '**********************************'.                02880000
028900                                                                  02890000
029000*                                                                 02900000
