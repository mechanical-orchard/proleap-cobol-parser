000100******************************************************************00010054
000200 IDENTIFICATION DIVISION.                                         00020054
000300******************************************************************00030054
000400                                                                  00040054
000500 PROGRAM-ID.             SEKRP010.                                00050054
000600 AUTHOR.                 RICK TULLOCH.                            00060054
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070054
000800 DATE-WRITTEN.           01-18-07.                                00080054
000900 DATE-COMPILED.                                                   00090054
001000                                                                  00100054
001100******************************************************************00110054
001200*       THIS PROGRAM WILL CREATE THE RACF RESOURCE AUDIT REPORT  *00120066
001210*  AND ALLOW A DETAIL FILE TO BE CREATED THAT CAN BE USED FOR    *00121066
001211*  AUTOMATED COMMUNICATIONS TO RESOURCE OWNERS, OR PARED DOWN TO *00121166
001220*  A REPORT FILE.                                                *00122066
001300******************************************************************00130054
001400                                                                  00140055
001500******************************************************************00150055
001600 ENVIRONMENT DIVISION.                                            00160055
001700******************************************************************00170055
001800                                                                  00180055
001900 CONFIGURATION SECTION.                                           00190055
002000                                                                  00200055
002100 SOURCE-COMPUTER.        IBM-3090.                                00210055
002200 OBJECT-COMPUTER.        IBM-3090.                                00220055
002300                                                                  00230055
002400 INPUT-OUTPUT SECTION.                                            00240055
002500                                                                  00250055
002600 FILE-CONTROL.                                                    00260055
002700                                                                  00270055
002800     SELECT RACF-AUDIT-EXTRACT-FILE                               00280055
002900         ASSIGN TO INP01.                                         00290055
003000                                                                  00300055
003100     SELECT RESOURCE-OWNER-FILE                                   00310055
003200         ASSIGN TO INP02.                                         00320055
003300                                                                  00330055
003400     SELECT GROUP-SUPPRESSION-FILE                                00340055
003500         ASSIGN TO INP03.                                         00350055
003600                                                                  00360055
003700     SELECT AUDIT-DETAIL-FILE                                     00370055
003800         ASSIGN TO OUT01.                                         00380055
003900                                                                  00390055
004000     SELECT CERTIFICATION-FILE                                    00400055
004100         ASSIGN TO OUT02.                                         00410055
004200                                                                  00420055
004300     SELECT AUDIT-REPORT-FILE                                     00430055
004400         ASSIGN TO RPT01.                                         00440055
004500                                                                  00450055
004600******************************************************************00460055
004700 DATA DIVISION.                                                   00470055
004800******************************************************************00480055
004900                                                                  00490055
005000 FILE SECTION.                                                    00500055
005100                                                                  00510055
005200 FD  RACF-AUDIT-EXTRACT-FILE                                      00520055
005300     RECORDING MODE IS F                                          00530055
005400     LABEL RECORDS ARE STANDARD                                   00540055
005500     BLOCK CONTAINS 0 RECORDS                                     00550055
005600     RECORD CONTAINS 600 CHARACTERS                               00560055
005700     DATA RECORD IS RA-RACF-AUDIT-EXTRACT-RECORD.                 00570055
005800                                                                  00580055
005900 01  RA-RACF-AUDIT-EXTRACT-RECORD                                 00590055
006000                                 PIC X(600).                      00600055
006100                                                                  00610055
006200 FD  RESOURCE-OWNER-FILE                                          00620055
006300     RECORDING MODE IS F                                          00630055
006400     LABEL RECORDS ARE STANDARD                                   00640055
006500     BLOCK CONTAINS 0 RECORDS                                     00650055
006600     RECORD CONTAINS 200 CHARACTERS                               00660055
006700     DATA RECORD IS RO-RESOURCE-OWNER-RECORD.                     00670055
006800                                                                  00680055
006900 01  RO-RESOURCE-OWNER-RECORD    PIC X(200).                      00690055
007000                                                                  00700055
007100 FD  GROUP-SUPPRESSION-FILE                                       00710055
007200     RECORDING MODE IS F                                          00720055
007300     LABEL RECORDS ARE STANDARD                                   00730055
007400     BLOCK CONTAINS 0 RECORDS                                     00740055
007500     RECORD CONTAINS 80 CHARACTERS                                00750055
007600     DATA RECORD IS GS-GROUP-SUPPRESSION-RECORD.                  00760055
007700                                                                  00770055
007800 01  GS-GROUP-SUPPRESSION-RECORD PIC X(80).                       00780055
007900                                                                  00790055
008000 FD  AUDIT-DETAIL-FILE                                            00800055
008100     RECORDING MODE IS F                                          00810055
008200     LABEL RECORDS ARE STANDARD                                   00820055
008300     BLOCK CONTAINS 0 RECORDS                                     00830055
008400     RECORD CONTAINS 185 CHARACTERS                               00840055
008500     DATA RECORD IS AD-AUDIT-DETAIL-RECORD.                       00850055
008600                                                                  00860055
008700 01  AD-AUDIT-DETAIL-RECORD      PIC X(185).                      00870055
008800                                                                  00880055
008900 FD  CERTIFICATION-FILE                                           00890055
009000     RECORDING MODE IS F                                          00900055
009100     LABEL RECORDS ARE STANDARD                                   00910055
009200     BLOCK CONTAINS 0 RECORDS                                     00920055
009300     RECORD CONTAINS 91 CHARACTERS                                00930055
009400     DATA RECORD IS CF-CERTIFICATION-RECORD.                      00940055
009500                                                                  00950055
009600 01  CF-CERTIFICATION-RECORD     PIC X(91).                       00960055
009700                                                                  00970055
009800 FD  AUDIT-REPORT-FILE                                            00980055
009900     RECORDING MODE IS F                                          00990055
010000     LABEL RECORDS ARE STANDARD                                   01000055
010100     BLOCK CONTAINS 0 RECORDS                                     01010055
010200     RECORD CONTAINS 132 CHARACTERS                               01020055
010300     DATA RECORD IS AR-AUDIT-REPORT-LINE.                         01030055
010400                                                                  01040055
010500 01  AR-AUDIT-REPORT-LINE        PIC X(132).                      01050055
010600                                                                  01060055
010700 WORKING-STORAGE SECTION.                                         01070055
010800                                                                  01080055
010900*                                                                 01090055
011000*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT                 01100055
011100*                                                                 01110055
011200                                                                  01120055
011300     COPY DPWS132.                                                01130055
011400                                                                  01140055
011500 01  ABEND-CODE                  PIC S9(04)   VALUE ZERO          01150055
011600                                              COMP SYNC.          01160055
011700     88  AC-CONTROL-CARD-ERROR                VALUE +4003.        01170055
011800     88  AC-TABLE-OVERFLOW-ERROR              VALUE +4004.        01180055
011900     88  AC-FILE-SEQUENCE-ERROR               VALUE +4007.        01190055
012000     88  AC-INVLD-DATA-ON-DATASET-ERROR       VALUE +4008.        01200055
012100                                                                  01210055
012200 01  PS-PROGRAM-SWITCHES.                                         01220055
012300     05  PS-END-OF-EXTRACT-FILE-SW                                01230055
012400                                 PIC X(1)     VALUE 'N'.          01240055
012500         88  PS-END-OF-EXTRACT-FILE           VALUE 'Y'.          01250055
012600     05  PS-END-OF-OWNER-FILE-SW                                  01260055
012700                                 PIC X(1)     VALUE 'N'.          01270055
012800         88  PS-END-OF-OWNER-FILE             VALUE 'Y'.          01280055
012900     05  PS-END-OF-GRP-SUP-FILE-SW                                01290055
013000                                 PIC X(1)     VALUE 'N'.          01300055
013100         88  PS-END-OF-GRP-SUP-FILE           VALUE 'Y'.          01310055
013200     05  PS-GROUP-EXPAND-SUPPRESS-IND                             01320055
013300                                 PIC X(1)     VALUE 'E'.          01330055
013400         88  PS-GS-EXPAND-GROUP               VALUE 'E'.          01340055
013500         88  PS-GS-SUPPRESS-GROUP             VALUE 'S'.          01350055
013600     05  PS-HYPHENATE-CONTINUATION-SW                             01360055
013700                                 PIC X(1)     VALUE 'N'.          01370055
013800         88  PS-HYPHENATE-CONTINUATION        VALUE 'Y'.          01380055
013900         88  PS-NO-CONTINUATION               VALUE 'N'.          01390055
014000     05  PS-AUDIT-RESOURCE-FOUND-SW                               01400055
014100                                 PIC X(1)     VALUE 'Y'.          01410055
014200         88  PS-AUDIT-RESOURCE-FOUND          VALUE 'Y'.          01420055
014300         88  PS-AUDIT-RESOURCE-NOT-FOUND      VALUE 'N'.          01430055
014400                                                                  01440055
014500 01  PC-PROGRAM-CONSTANTS.                                        01450055
014600     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'SEKRP010'.   01460055
014700     05  PC-PAGE-SIZE            PIC S9(4)    VALUE +63           01470055
014800                                              COMP SYNC.          01480055
014900     05  PC-MAXIMUM-RESOURCE-OWNER-CNT                            01490055
015000                                 PIC S9(4)    VALUE +1000         01500055
015100                                              COMP SYNC.          01510055
015200     05  PC-MAXIMUM-GRP-SUPPRESS-COUNT                            01520055
015300                                 PIC S9(4)    VALUE +1000         01530055
015400                                              COMP SYNC.          01540055
015500     05  PC-RESOURCE-NOT-FOUND-RET-CODE                           01550055
015600                                 PIC S9(4)    VALUE +4050         01560055
015700                                              COMP SYNC.          01570055
015800     05  PC-KOHLS-DOMAIN         PIC X(10)    VALUE '@KOHLS.COM'. 01580055
015900     05  PC-PERIOD               PIC X(1)     VALUE '.'.          01590055
016000     05  PC-DASH                 PIC X(1)     VALUE '.'.          01600055
016100     05  PC-OPEN-PARENTHESIS     PIC X(1)     VALUE '('.          01610055
016200     05  PC-CLOSE-PARENTHESIS    PIC X(1)     VALUE ')'.          01620055
016300     05  PC-NEW-FRONT-REQUEST.                                    01630055
016400         10  FILLER              PIC S9(4)    VALUE -1            01640055
016500                                              COMP SYNC.          01650055
016600     05  PC-COMMA                PIC X(1)     VALUE ','.          01660055
016700     05  PC-DOUBLE-QUOTE         PIC X(1)     VALUE '"'.          01670055
016800     05  PC-NO-USER-GROUP        PIC X(11)    VALUE 'NoUserGroup'.01680055
016810     05  PC-GROUP-WITHOUT-USERS  PIC X(6)     VALUE 'NoUser'.     01681063
016820     05  PC-CATEGORY-UNKNOWN     PIC X(7)     VALUE 'UNKNOWN'.    01682063
016900                                                                  01690055
017000 01  PV-PROGRAM-VARIABLES.                                        01700055
017100     05  PV-CURRENT-RESOURCE-CLASS                                01710055
017200                                 PIC X(8)     VALUE SPACES.       01720055
017300     05  PV-CURRENT-RESOURCE-GROUP                                01730055
017400                                 PIC X(44)    VALUE SPACES.       01740055
017500     05  PV-CURRENT-GRANTED-TO-ID                                 01750055
017600                                 PIC X(8)     VALUE SPACES.       01760055
017700     05  PV-RESOURCE-HEADING-LINE-COUNT                           01770055
017800                                 PIC S9(4)    VALUE ZEROS         01780055
017900                                              COMP SYNC.          01790054
018000     05  PV-TALLY                PIC S9(4)    VALUE ZEROS         01800054
018100                                              COMP SYNC.          01810054
018200     05  PV-START-POSITION       PIC S9(4)    VALUE ZEROS         01820054
018300                                              COMP SYNC.          01830054
018400     05  PV-SEGMENT-LENGTH       PIC S9(4)    VALUE ZEROS         01840054
018500                                              COMP SYNC.          01850054
018600     05  PV-SPACE-CHECK          PIC S9(4)    VALUE ZEROS         01860054
018700                                              COMP SYNC.          01870054
018800     05  PV-PAGE-COUNT           PIC S9(4)    VALUE ZEROS         01880054
018900                                              COMP SYNC.          01890054
019000     05  PV-LINE-COUNT           PIC S9(4)    VALUE ZEROS         01900054
019100                                              COMP SYNC.          01910054
019200     05  PV-ADVANCE-COUNT        PIC S9(4)    VALUE ZEROS         01920054
019300                                              COMP SYNC.          01930055
019400         88  PV-AC-SINGLE-SPACE               VALUE +1.           01940055
019500         88  PV-AC-DOUBLE-SPACE               VALUE +2.           01950055
019600         88  PV-AC-TRIPLE-SPACE               VALUE +3.           01960055
019700     05  PV-RESOURCE-OWNER-COUNT PIC S9(4)    VALUE ZEROS         01970055
019800                                              COMP SYNC.          01980055
019900     05  PV-GRP-SUPPRESS-COUNT   PIC S9(4)    VALUE ZEROS         01990055
020000                                              COMP SYNC.          02000055
020100     05  PV-EMAIL-TO-CONVERT     PIC X(50)    VALUE SPACES.       02010055
020200     05  PV-CONVERTED-NAME       PIC X(40)    VALUE SPACES.       02020055
020300     05  PV-REMAINDER-OF-NAME    PIC X(50)    VALUE SPACES.       02030055
020400     05  PV-RESOURCE-DESC-AREA   PIC X(255)   VALUE SPACES.       02040055
020500     05  PV-LENGTH-OF-DESC-DETAIL                                 02050055
020600                                 PIC S9(4)    VALUE ZEROS         02060055
020700                                              COMP SYNC.          02070055
020800     05  PV-LENGTH-OF-DESC-AREA  PIC S9(4)    VALUE ZEROS         02080055
020900                                              COMP SYNC.          02090055
021000     05  PV-ACCESS-GRANT-COUNT   PIC S9(4)    VALUE ZEROS         02100055
021100                                              COMP SYNC.          02110055
021200     05  PV-AUD-RESOURCE-NOT-FOUND-CNT                            02120055
021300                                 PIC S9(4)    VALUE ZEROS         02130055
021400                                              COMP SYNC.          02140055
021500     05  PV-CERTIFICATION-RECORD PIC X(91)    VALUE SPACES.       02150055
021600                                                                  02160055
021700 01  CC-CONTROL-CARD.                                             02170055
021800     05  CC-CONTROL-CARD-DISPLAY.                                 02180055
021900         10  CC-SUPPRESS-USER-GROUPS-IND                          02190055
022000                                 PIC X(1)     VALUE SPACES.       02200055
022100             88  CC-SUPPRESS-ALL-GROUPS       VALUE 'S'.          02210055
022200             88  CC-EXPAND-ELIGIBLE-GROUPS    VALUE 'E'.          02220055
022300         10  FILLER              PIC X(1)     VALUE SPACES.       02230055
022400         10  CC-HR-INFORMATION-REQ-IND                            02240055
022500                                 PIC X(1)     VALUE SPACES.       02250055
022600             88  CC-SUPPRESS-HR-INFORMATION   VALUE 'S'.          02260055
022700             88  CC-INCLUDE-HR-INFORMATION    VALUE 'I'.          02270055
022800         10  FILLER              PIC X(1)     VALUE SPACES.       02280055
022900         10  CC-DISPLAY-RES-OWNER-IND                             02290055
023000                                 PIC X(1)     VALUE SPACES.       02300055
023100             88  CC-DISPLAY-RESOURCE-OWNER-INFO                   02310055
023200                                              VALUE 'Y'.          02320055
023300             88  CC-MUTE-RESOURCE-OWNER-INFO  VALUE 'N'.          02330055
023400         10  FILLER              PIC X(1)     VALUE SPACES.       02340055
023500         10  CC-APPROVAL-REQ-IND PIC X(1)     VALUE SPACES.       02350055
023600             88  CC-SEND-FOR-APPROVAL         VALUE 'S'.          02360055
023700             88  CC-AUDIT-REPORT-ONLY         VALUE 'A'.          02370055
023800     05  FILLER                  PIC X(73)    VALUE SPACES.       02380055
023900                                                                  02390055
024000 01  AE-AUDIT-EXTRACT-FILE-RECORD.                                02400055
024100     05  AE-RECORD-TYPE          PIC X(1)     VALUE SPACES.       02410055
024200         88  AE-RT-RESOURCE-RECORD            VALUE '1'.          02420055
024300         88  AE-RT-ACCESS-RECORD              VALUE '2'.          02430055
024400     05  AE-RESOURCE-NAME        PIC X(52)    VALUE SPACES.       02440055
024500     05  FILLER                  REDEFINES AE-RESOURCE-NAME.      02450055
024600         10  AE-RESOURCE-CLASS   PIC X(8).                        02460055
024700         10  AE-RESOURCE-GROUP   PIC X(44).                       02470055
024800     05  AE-EXTRACT-DETAIL       PIC X(547)   VALUE SPACES.       02480055
024900     05  AE-RESOURCE-DETAIL      REDEFINES AE-EXTRACT-DETAIL.     02490055
025000         10  AE-RD-UNIVERSAL-ACCESS                               02500055
025100                                 PIC X(8).                        02510055
025200         10  AE-RD-INSTALLATION-DATA                              02520055
025300                                 PIC X(255).                      02530055
025400         10  AE-RD-APPLICATION-DATA                               02540055
025500                                 PIC X(255).                      02550055
025600         10  FILLER              PIC X(29).                       02560055
025700     05  AE-ACCESS-DETAIL        REDEFINES AE-EXTRACT-DETAIL.     02570055
025800         10  AE-AD-GRANTED-TO-ID PIC X(8).                        02580055
025900         10  AE-AD-ACCESS-LEVEL  PIC X(8).                        02590055
026000         10  AE-AD-USER-GROUP-DESCRIPTION                         02600055
026100                                 PIC X(92).                       02610055
026200             88  AE-AD-NOT-A-USER-GROUP       VALUE HIGH-VALUES.  02620055
026300         10  AE-AD-USER-ID       PIC X(8).                        02630055
026400             88  AE-AD-GROUP-WITHOUT-USERS    VALUE HIGH-VALUES.  02640054
026500         10  AE-REDUNDANT-SECURITY-IND                            02650055
026600                                 PIC X(1).                        02660055
026700             88  AE-AD-UNIQUE-USER-PRIVILEGE  VALUE HIGH-VALUES.  02670055
026800             88  AE-AD-DUP-USER-PRIVILEGE     VALUE SPACES.       02680055
026900         10  AE-AD-USER-NAME     PIC X(40).                       02690055
027000             88  AE-AD-ACCOUNT-NOT-DEFINED    VALUE HIGH-VALUES.  02700055
027100         10  AE-AD-ACCOUNT-CATEGORY                               02710055
027200                                 PIC X(8).                        02720055
027300             88  AE-AD-CATEGORY-NOT-DEFINED   VALUE SPACES.       02730055
027400             88  AE-AD-CATEGORY-UNKNOWN       VALUE 'UNKNOWN'.    02740055
027500         10  AE-AD-EMPLOYEE-ID-X.                                 02750055
027600             15  AE-AD-EMPLOYEE-ID                                02760055
027700                                 PIC 9(7).                        02770055
027800         10  FILLER              PIC X(375).                      02780055
027900                                                                  02790055
028300 01  RO-RESOURCE-OWNER-RCD.                                       02830055
028400     05  RO-RESOURCE-NAME        PIC X(52)    VALUE SPACES.       02840055
028500     05  FILLER                  REDEFINES RO-RESOURCE-NAME.      02850055
028600         10  RO-RESOURCE-CLASS   PIC X(8).                        02860055
028700         10  RO-RESOURCE-GROUP   PIC X(44).                       02870055
028800     05  RO-OWNER-EMAIL          PIC X(50)    VALUE SPACES.       02880055
028900     05  RO-MGMT-BOARD-REP-EMAIL PIC X(50)    VALUE SPACES.       02890055
029000     05  FILLER                  PIC X(48)    VALUE SPACES.       02900055
029100                                                                  02910055
029200 01  GS-GROUP-SUPPRESSION-RCD.                                    02920055
029300     05  GS-USER-GROUP-NAME      PIC X(8)     VALUE SPACES.       02930055
029400     05  FILLER                  PIC X(72)    VALUE SPACES.       02940055
029500                                                                  02950055
029600 01  OT-OWNER-TABLE.                                              02960055
029700     05  OT-OWNER-ENTRY          OCCURS 1000 TIMES                02970055
029800                                 ASCENDING KEY OT-RESOURCE-NAME   02980055
029900                                 INDEXED BY OT-INDEX.             02990055
030000         10  OT-RESOURCE-NAME    PIC X(52).                       03000055
030100         10  FILLER              REDEFINES OT-RESOURCE-NAME.      03010055
030200             15  OT-RESOURCE-CLASS                                03020055
030300                                 PIC X(8).                        03030055
030400             15  OT-RESOURCE-GROUP                                03040055
030500                                 PIC X(44).                       03050055
030600         10  OT-OWNER-EMAIL      PIC X(50).                       03060055
030700         10  OT-OWNER-NAME-DISPLAY                                03070055
030800                                 PIC X(40).                       03080055
030900         10  OT-MGMT-BOARD-REP-EMAIL                              03090055
031000                                 PIC X(50).                       03100055
031100         10  OT-MGMT-BOARD-REP-NAME-DISPLAY                       03110055
031200                                 PIC X(40).                       03120055
031300                                                                  03130055
031400 01  GE-GRP-EXPANSION-SUPPRESS-TBL.                               03140055
031500     05  GE-USER-GROUP-ENTRY     OCCURS 1000 TIMES                03150055
031600                                 ASCENDING KEY GE-USER-GROUP-NAME 03160055
031700                                 INDEXED BY GE-INDEX.             03170055
031800         10  GE-USER-GROUP-NAME  PIC X(8).                        03180055
031900                                                                  03190055
032000 01  HL2-HEADING-LINE-2.                                          03200055
032100     05  FILLER                  PIC X(53)    VALUE SPACES.       03210055
032200     05  FILLER                  PIC X(26)    VALUE               03220055
032300         'RACF RESOURCE ACCESS AUDIT'.                            03230055
032400     05  FILLER                  PIC X(53)    VALUE SPACES.       03240055
032500                                                                  03250055
032600 01  RI-RESOURCE-ID-LINE.                                         03260055
032700     05  FILLER                  PIC X(16)    VALUE               03270055
032800         'RESOURCE CLASS: '.                                      03280055
032900     05  RI-RESOURCE-CLASS       PIC X(8)     VALUE SPACES.       03290055
033000     05  FILLER                  PIC X(18)    VALUE               03300055
033100         '  RESOURCE GROUP: '.                                    03310055
033200     05  RI-RESOURCE-GROUP       PIC X(44)    VALUE SPACES.       03320055
033300     05  RI-CONTINUATION-IND     PIC X(13)    VALUE SPACES.       03330055
033400         88  RI-RESOURCE-CONTINUATION         VALUE               03340055
033500             '  (CONTINUED)'.                                     03350055
033600     05  FILLER                  PIC X(33)    VALUE SPACES.       03360055
033700                                                                  03370055
033800 01  RD-RESOURCE-DESCRIPTION-LINE.                                03380055
033900     05  RD-DESCRIPTION-ID-IND   PIC X(13)    VALUE SPACES.       03390055
034000         88  RD-DESCRIPTION-ID                VALUE               03400055
034100             'DESCRIPTION: '.                                     03410055
034200         88  RD-DESCRIPTION-CONTINUATION      VALUE SPACES.       03420055
034300     05  RD-RESOURCE-DESCRIPTION PIC X(119)   VALUE SPACES.       03430055
034400         88  RD-NO-DESCRIPTION-AVAILABLE      VALUE               03440055
034500             '** NO RESOURCE DESCRIPTION AVAILABLE **'.           03450055
034600                                                                  03460055
034700 01  RH-RESOURCE-HEADING-LINE-TABLE.                              03470055
034800     05  RH-RESOURCE-HEADING-LINE                                 03480055
034900                                 OCCURS 7 TIMES                   03490055
035000                                 INDEXED BY RH-INDEX              03500055
035100                                 PIC X(132).                      03510055
035200                                                                  03520055
035300 01  RR-RESOURCE-RESPONSIBILTY-LINE.                              03530055
035400     05  FILLER                  PIC X(16)    VALUE               03540055
035500         'RESOURCE OWNER: '.                                      03550055
035600     05  RR-RESOURCE-OWNER-NAME  PIC X(40)    VALUE SPACES.       03560055
035700         88  RR-RO-NOT-IDENTIFIED             VALUE               03570055
035800             '  ** NOT IDENTIFIED **'.                            03580055
035900     05  FILLER                  PIC X(35)    VALUE               03590054
036000         '  MANAGEMENT BOARD REPRESENTATIVE: '.                   03600054
036100     05  RR-MGMT-BOARD-REP-NAME  PIC X(40)    VALUE SPACES.       03610054
036200         88  RR-MB-NOT-IDENTIFIED             VALUE               03620054
036300             '  ** NOT IDENTIFIED **'.                            03630054
036400     05  FILLER                  PIC X(1)     VALUE SPACES.       03640054
036500                                                                  03650054
036600 01  UA-UNIVERSAL-ACCESS-LINE.                                    03660054
036700     05  FILLER                  PIC X(18)    VALUE               03670054
036800         'UNIVERSAL ACCESS: '.                                    03680054
036900     05  UA-UNIVERSAL-ACCESS     PIC X(8)     VALUE SPACES.       03690054
037000     05  FILLER                  PIC X(106)   VALUE SPACES.       03700055
037100                                                                  03710055
037200 01  RR-REQ-RESOURCE-ERROR-LINE.                                  03720055
037300     05  FILLER                  PIC X(19)    VALUE               03730055
037400         '***** ERROR *****  '.                                   03740055
037500     05  FILLER                  PIC X(113)   VALUE               03750055
037600         'REQUESTED RESOURCE NOT FOUND IN RACF'.                  03760055
037700                                                                  03770055
037800 01  NA-NO-INDIV-ACCESS-GRANT-LINE.                               03780055
037900     05  FILLER                  PIC X(33)    VALUE               03790055
038000         '** NO INDIVIDUAL ACCESS GRANTS - '.                     03800055
038100     05  FILLER                  PIC X(99)    VALUE               03810055
038200         'SEE UNIVERSAL ACCESS DEFINITION **'.                    03820055
038300                                                                  03830055
038400 01  RA-RESOURCE-ACCESS-LINE.                                     03840055
038500     05  FILLER                  PIC X(2)     VALUE SPACES.       03850055
038600     05  RA-REDUNDANT-SECURITY-IND                                03860055
038700                                 PIC X(1)     VALUE SPACES.       03870055
038800         88  RA-RS-REDUNDANT-SECURITY         VALUE '?'.          03880055
038900         88  RA-RS-UNIQUE-SECURITY            VALUE SPACES.       03890055
039000     05  FILLER                  PIC X(1)     VALUE SPACES.       03900055
039100     05  RA-GRANTED-TO-ID        PIC X(8)     VALUE SPACES.       03910055
039200     05  FILLER                  PIC X(1)     VALUE SPACES.       03920055
039300     05  RA-ID-LEVEL             PIC X(7)     VALUE SPACES.       03930055
039400         88  RA-IL-USER-GROUP                 VALUE '(GROUP)'.    03940055
039500         88  RA-IL-INDIVIDUAL-USER            VALUE '(USER)'.     03950055
039600     05  FILLER                  PIC X(1)     VALUE SPACES.       03960055
039700     05  RA-ACCESS-LEVEL         PIC X(8)     VALUE SPACES.       03970055
039800     05  FILLER                  PIC X(1)     VALUE SPACES.       03980055
039900     05  RA-DETAIL               PIC X(102)   VALUE SPACES.       03990055
040000     05  FILLER                  REDEFINES RA-DETAIL.             04000055
040100         10  RA-USER-GROUP-DESCRIPTION                            04010055
040200                                 PIC X(63).                       04020055
040300             88  RA-UG-NO-DESCRIPTION         VALUE               04030055
040400                 '  ** NO USER GROUP DESCRIPTION **'.             04040055
040500         10  FILLER              PIC X(1).                        04050055
040600         10  RA-USER-GROUP-NOTATION                               04060055
040700                                 PIC X(37).                       04070055
040800             88  RA-UG-GROUP-SUPPRESSED       VALUE               04080055
040900                 '** USER GROUP EXPANSION SUPPRESSED **'.         04090055
041000             88  RA-UG-NO-USERS               VALUE               04100055
041100                 '** NO USERS IN USER GROUP **'.                  04110055
041200             88  RA-UG-EXPANSION-CONTINUED    VALUE               04120055
041300                 ' (GROUP EXPANSION CONTINUED)         '.         04130055
041400         10  FILLER              PIC X(1).                        04140055
041500                                                                  04150055
041600 01  IU-INDIVIDUAL-USER-DETAILS.                                  04160055
041700     05  IU-ACCOUNT-CATEGORY     PIC X(10)    VALUE SPACES.       04170055
041800     05  FILLER                  PIC X(1)     VALUE SPACES.       04180055
041900     05  IU-USER-NAME            PIC X(40)    VALUE SPACES.       04190055
042000         88  IU-UN-NO-DESCRIPTION             VALUE               04200055
042100             '  ** NO USER/PROCESS NAME **'.                      04210055
042200     05  FILLER                  PIC X(1)     VALUE SPACES.       04220055
042300     05  FILLER                  PIC X(7)     VALUE SPACES.       04230055
042400         88  IU-EMPLOYEE-ID-TAG               VALUE 'EMPLID '.    04240055
042500     05  IU-EMPLOYEE-ID          PIC X(7)     VALUE SPACES.       04250055
042600         88  IU-EMPLOYEE-ID-NOT-AVAILABLE     VALUE ' N/A '.      04260055
042700                                                                  04270055
042800 01  GE-GROUP-EXPANSION-LINE.                                     04280055
042900     05  FILLER                  PIC X(20)    VALUE SPACES.       04290055
043000     05  GE-USER-ID              PIC X(8)     VALUE SPACES.       04300055
043100     05  FILLER                  PIC X(2)     VALUE SPACES.       04310055
043200     05  GE-INDIVIDUAL-USER-DETAILS                               04320055
043300                                 PIC X(102)   VALUE SPACES.       04330055
043400                                                                  04340055
043500 01  AD-AUDIT-DETAIL-RCD.                                         04350055
043600     05  AD-KEY.                                                  04360055
043700         10  AD-RESOURCE-CLASS   PIC X(8).                        04370055
043800         10  AD-RESOURCE-GROUP   PIC X(44).                       04380055
043900         10  AD-RECORD-TYPE      PIC X(1).                        04390055
044000             88  AD-RT-ROUTING-RECORD         VALUE '1'.          04400055
044100             88  AD-RT-DETAIL-RECORD          VALUE '2'.          04410055
044200     05  AD-DETAIL-LINE          PIC X(132).                      04420055
044300     05  AD-ROUTING-INFORMATION  REDEFINES AD-DETAIL-LINE.        04430055
044400         10  AD-OWNER-EMAIL      PIC X(50).                       04440055
044500         10  AD-MGMT-BOARD-REP-EMAIL                              04450055
044600                                 PIC X(50).                       04460055
044700         10  FILLER              PIC X(32).                       04470055
044800                                                                  04480055
044900******************************************************************04490055
045000 PROCEDURE DIVISION.                                              04500055
045100******************************************************************04510055
045200                                                                  04520055
045300 0000-MAINLINE.                                                   04530055
045400                                                                  04540055
045500     PERFORM 1000-INITIALIZE.                                     04550055
045600                                                                  04560055
045700     PERFORM 2000-PROCESS-AUDIT-RESOURCE                          04570055
045800         UNTIL PS-END-OF-EXTRACT-FILE.                            04580055
045900                                                                  04590055
046000     PERFORM 9000-EOJ-ROUTINE.                                    04600055
046100                                                                  04610055
046200     IF (PV-AUD-RESOURCE-NOT-FOUND-CNT > ZERO)                    04620055
046300         MOVE PC-RESOURCE-NOT-FOUND-RET-CODE TO RETURN-CODE       04630055
046400     END-IF.                                                      04640055
046500                                                                  04650055
046600     GOBACK.                                                      04660054
046700                                                                  04670054
046800******************************************************************04680054
046900*                                                                *04690055
047000******************************************************************04700055
047100                                                                  04710055
047200 1000-INITIALIZE.                                                 04720055
047300     ACCEPT CC-CONTROL-CARD.                                      04730055
047400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CONTROL CARD = ('       04740055
047500               CC-CONTROL-CARD-DISPLAY  ')'.                      04750055
047600                                                                  04760055
047700     PERFORM 1100-VALIDATE-CONTROL-CARD.                          04770055
047800                                                                  04780055
047900     OPEN INPUT  RACF-AUDIT-EXTRACT-FILE                          04790055
048000                 RESOURCE-OWNER-FILE                              04800055
048100                 GROUP-SUPPRESSION-FILE                           04810055
048200          OUTPUT AUDIT-DETAIL-FILE                                04820055
048300                 CERTIFICATION-FILE                               04830055
048400                 AUDIT-REPORT-FILE.                               04840055
048500                                                                  04850055
048600     MOVE FUNCTION CURRENT-DATE (1:4) TO DP132-RUN-YEAR.          04860055
048700     MOVE FUNCTION CURRENT-DATE (5:2) TO DP132-RUN-MONTH.         04870055
048800     MOVE FUNCTION CURRENT-DATE (7:2) TO DP132-RUN-DAY.           04880055
048900     MOVE FUNCTION CURRENT-DATE (9:2) TO DP132-RUN-HOUR.          04890055
049000     MOVE FUNCTION CURRENT-DATE (11:2) TO DP132-RUN-MINUTE.       04900055
049100     MOVE PC-CURRENT-PROGRAM-NAME TO DP132-PROGRAM-NAME.          04910055
049200     MOVE 1 TO DP132-REPORT-NUMBER.                               04920055
049300                                                                  04930055
049400     PERFORM 1200-LOAD-RESOURCE-RESP.                             04940055
049500                                                                  04950055
049600     PERFORM 1300-LOAD-GROUP-SUPPRESSION.                         04960055
049700                                                                  04970055
049800     PERFORM 7000-READ-EXTRACT-FILE.                              04980055
049900*1000-EXIT.                                                       04990055
050000                                                                  05000055
050100******************************************************************05010055
050200*                                                                *05020055
050300******************************************************************05030055
050400                                                                  05040055
050500 1100-VALIDATE-CONTROL-CARD.                                      05050055
050600     IF ((NOT CC-SUPPRESS-ALL-GROUPS)                             05060055
050700             AND (NOT CC-EXPAND-ELIGIBLE-GROUPS))                 05070055
050800         DISPLAY '** ABEND **'                                    05080055
050900         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID GLOBAL '    05090055
051000                   'RACF USER GROUP EXPANSION INDICATOR OF "'     05100055
051100                   CC-SUPPRESS-USER-GROUPS-IND                    05110055
051200                   '" FOUND ON CONTROL CARD'                      05120055
051300         SET AC-CONTROL-CARD-ERROR TO TRUE                        05130055
051400         CALL 'ILBOABN0' USING ABEND-CODE                         05140055
051500     END-IF.                                                      05150055
051600                                                                  05160055
051700     IF ((NOT CC-SUPPRESS-HR-INFORMATION)                         05170055
051800             AND (NOT CC-INCLUDE-HR-INFORMATION))                 05180055
051900         DISPLAY '** ABEND **'                                    05190055
052000         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID HR '        05200055
052100                   'INFORMATION REQUESTED INDICATOR OF "'         05210055
052200                   CC-HR-INFORMATION-REQ-IND                      05220055
052300                   '" FOUND ON CONTROL CARD'                      05230055
052400         SET AC-CONTROL-CARD-ERROR TO TRUE                        05240055
052500         CALL 'ILBOABN0' USING ABEND-CODE                         05250055
052600     END-IF.                                                      05260055
052700                                                                  05270055
052800     IF ((NOT CC-DISPLAY-RESOURCE-OWNER-INFO)                     05280055
052900             AND (NOT CC-MUTE-RESOURCE-OWNER-INFO))               05290055
053000         DISPLAY '** ABEND **'                                    05300055
053100         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID '           05310055
053200                   'DISPLAY RESOURCE OWNER INDICATOR OF "'        05320055
053300                   CC-DISPLAY-RES-OWNER-IND                       05330054
053400                   '" FOUND ON CONTROL CARD'                      05340054
053500         SET AC-CONTROL-CARD-ERROR TO TRUE                        05350054
053600         CALL 'ILBOABN0' USING ABEND-CODE                         05360054
053700     END-IF.                                                      05370054
053800                                                                  05380055
053900     IF ((NOT CC-SEND-FOR-APPROVAL)                               05390055
054000             AND (NOT CC-AUDIT-REPORT-ONLY))                      05400055
054100         DISPLAY '** ABEND **'                                    05410055
054200         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID '           05420055
054300                   'APPROVAL REQUESTED INDICATOR OF "'            05430055
054400                   CC-APPROVAL-REQ-IND                            05440055
054500                   '" FOUND ON CONTROL CARD'                      05450055
054600         SET AC-CONTROL-CARD-ERROR TO TRUE                        05460055
054700         CALL 'ILBOABN0' USING ABEND-CODE                         05470055
054800     END-IF.                                                      05480055
054900                                                                  05490055
055000     IF ((CC-SEND-FOR-APPROVAL)                                   05500055
055100             AND (CC-MUTE-RESOURCE-OWNER-INFO))                   05510055
055200         DISPLAY '** ABEND **'                                    05520055
055300         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CANNOT '            05530055
055400                   'MUTE THE RESOURCE OWNER INFORMATION '         05540055
055500                   'WHEN REQUESTING A SEND FOR APPROVAL'          05550055
055600         SET AC-CONTROL-CARD-ERROR TO TRUE                        05560055
055700         CALL 'ILBOABN0' USING ABEND-CODE                         05570055
055800     END-IF.                                                      05580055
055900*1100-EXIT.                                                       05590055
056000                                                                  05600055
056100******************************************************************05610055
056200*                                                                *05620055
056300******************************************************************05630055
056400                                                                  05640055
056500 1200-LOAD-RESOURCE-RESP.                                         05650055
056600     INITIALIZE OT-OWNER-TABLE                                    05660055
056700         REPLACING ALPHANUMERIC DATA BY HIGH-VALUES.              05670055
056800     INITIALIZE PV-RESOURCE-OWNER-COUNT.                          05680055
056900                                                                  05690055
057000     PERFORM 7100-READ-RESOURCE-OWNER-FILE.                       05700055
057100                                                                  05710055
057200     PERFORM                                                      05720055
057300             VARYING OT-INDEX                                     05730055
057400             FROM 1 BY 1                                          05740055
057500             UNTIL ((OT-INDEX > PC-MAXIMUM-RESOURCE-OWNER-CNT)    05750055
057600                     OR (PS-END-OF-OWNER-FILE))                   05760055
057700         IF ((OT-INDEX > 1)                                       05770055
057800                 AND (RO-RESOURCE-NAME <=                         05780055
057900                              OT-RESOURCE-NAME (OT-INDEX - 1)))   05790055
058000             DISPLAY '** ABEND **'                                05800055
058100             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RESOURCE TO '   05810055
058200                       'RESOURCE OWNER FILE NOT IN ASCENDING '    05820055
058300                       'RESOURCE SEQUENCE'                        05830055
058400             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  05840055
058500                       'AT RESOURCE CLASS = '  RO-RESOURCE-CLASS  05850055
058600                       '; RESOURCE GROUP = '  RO-RESOURCE-GROUP   05860055
058700             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   05870055
058800             CALL 'ILBOABN0' USING ABEND-CODE                     05880055
058900         END-IF                                                   05890055
059000         MOVE RO-RESOURCE-CLASS TO                                05900055
059100                   OT-RESOURCE-CLASS (OT-INDEX)                   05910055
059200         MOVE RO-RESOURCE-GROUP TO                                05920055
059300                   OT-RESOURCE-GROUP (OT-INDEX)                   05930055
059400         MOVE RO-OWNER-EMAIL TO                                   05940055
059500                   OT-OWNER-EMAIL (OT-INDEX)                      05950055
059600                   PV-EMAIL-TO-CONVERT                            05960055
059700         IF (PV-EMAIL-TO-CONVERT NOT = SPACES)                    05970055
059800             PERFORM 1210-TRANSLATE-EMAIL-TO-NAME                 05980055
059900             MOVE PV-CONVERTED-NAME TO                            05990055
060000                       OT-OWNER-NAME-DISPLAY (OT-INDEX)           06000055
060100         END-IF                                                   06010055
060200         MOVE RO-MGMT-BOARD-REP-EMAIL TO                          06020055
060300                   OT-MGMT-BOARD-REP-EMAIL (OT-INDEX)             06030055
060400                   PV-EMAIL-TO-CONVERT                            06040055
060500         IF (PV-EMAIL-TO-CONVERT NOT = SPACES)                    06050055
060600            PERFORM 1210-TRANSLATE-EMAIL-TO-NAME                  06060055
060700            MOVE PV-CONVERTED-NAME TO                             06070055
060800                       OT-MGMT-BOARD-REP-NAME-DISPLAY (OT-INDEX)  06080055
060900         END-IF                                                   06090055
061000         ADD +1 TO PV-RESOURCE-OWNER-COUNT                        06100055
061100         PERFORM 7100-READ-RESOURCE-OWNER-FILE                    06110055
061200     END-PERFORM.                                                 06120055
061300                                                                  06130055
061400     IF ((OT-INDEX > PC-MAXIMUM-RESOURCE-OWNER-CNT)               06140055
061500             AND (NOT PS-END-OF-OWNER-FILE))                      06150055
061600         DISPLAY '** ABEND **'                                    06160055
061700         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 06170055
061800                   'DEFINED RESOURCE TO RESOURCE OWNER '          06180055
061900                   'ASSOCIATIONS EXCEEDED'                        06190055
062000         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  06200055
062100                   'AND RERUN'                                    06210055
062200         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      06220055
062300         CALL 'ILBOABN0' USING ABEND-CODE                         06230055
062400     END-IF.                                                      06240055
062500*1200-EXIT.                                                       06250055
062600                                                                  06260055
062700******************************************************************06270055
062800*                                                                *06280055
062900******************************************************************06290055
063000                                                                  06300055
063100 1210-TRANSLATE-EMAIL-TO-NAME.                                    06310055
063200     INITIALIZE PV-CONVERTED-NAME                                 06320055
063300                PV-REMAINDER-OF-NAME                              06330055
063400                PV-TALLY.                                         06340055
063500                                                                  06350055
063600     INSPECT PV-EMAIL-TO-CONVERT                                  06360055
063700         TALLYING PV-TALLY                                        06370055
063800         FOR ALL PC-KOHLS-DOMAIN.                                 06380055
063900                                                                  06390055
064000     IF (PV-TALLY NOT = 1)                                        06400055
064100         DISPLAY '** ABEND **'                                    06410055
064200         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESS '    06420055
064300                   'ERROR IN RESOURCE OWNER FILE'                 06430055
064400         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESS '    06440055
064500                   'DOES NOT HAVE A SINGLE KOHLS.COM DOMAIN '     06450055
064600                   'REFERENCE'                                    06460055
064700         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - REVIEW '            06470055
064800                   'RESOURCE CLASS = '  RO-RESOURCE-CLASS         06480055
064900                   '; RESOURCE GROUP = '  RO-RESOURCE-GROUP       06490055
065000         SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE               06500055
065100         CALL 'ILBOABN0' USING ABEND-CODE                         06510055
065200     END-IF.                                                      06520055
065300                                                                  06530055
065400     UNSTRING PV-EMAIL-TO-CONVERT                                 06540055
065500         DELIMITED BY PC-KOHLS-DOMAIN                             06550055
065600         INTO PV-CONVERTED-NAME                                   06560055
065700              PV-REMAINDER-OF-NAME                                06570055
065800         ON OVERFLOW                                              06580055
065900              CONTINUE                                            06590055
066000     END-UNSTRING.                                                06600055
066100                                                                  06610055
066200     IF (PV-REMAINDER-OF-NAME NOT = SPACES)                       06620055
066300         DISPLAY '** ABEND **'                                    06630055
066400         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESS '    06640055
066500                   'ERROR IN RESOURCE OWNER FILE'                 06650055
066600         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESS '    06660055
066700                   'HAS CHARACTERS BEYOND THE KOHLS.COM DOMAIN '  06670055
066800                   'REFERENCE'                                    06680055
066900         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - REVIEW '            06690055
067000                   'RESOURCE CLASS = '  RO-RESOURCE-CLASS         06700055
067100                   '; RESOURCE GROUP = '  RO-RESOURCE-GROUP       06710055
067200         SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE               06720055
067300         CALL 'ILBOABN0' USING ABEND-CODE                         06730055
067400     END-IF.                                                      06740055
067500                                                                  06750055
067600     INSPECT PV-CONVERTED-NAME                                    06760055
067700         REPLACING ALL PC-PERIOD BY SPACES.                       06770055
067800*1210-EXIT.                                                       06780055
067900                                                                  06790055
068000******************************************************************06800055
068100*                                                                *06810055
068200******************************************************************06820055
068300                                                                  06830055
068400 1300-LOAD-GROUP-SUPPRESSION.                                     06840055
068500     INITIALIZE GE-GRP-EXPANSION-SUPPRESS-TBL                     06850055
068600         REPLACING ALPHANUMERIC DATA BY HIGH-VALUES.              06860055
068700     INITIALIZE PV-GRP-SUPPRESS-COUNT.                            06870055
068800                                                                  06880055
068900     PERFORM 7200-READ-GRP-SUP-FILE.                              06890055
069000                                                                  06900055
069100     PERFORM                                                      06910055
069200             VARYING GE-INDEX                                     06920055
069300             FROM 1 BY 1                                          06930055
069400             UNTIL ((GE-INDEX > PC-MAXIMUM-GRP-SUPPRESS-COUNT)    06940055
069500                     OR (PS-END-OF-GRP-SUP-FILE))                 06950055
069600         IF ((GE-INDEX > 1)                                       06960055
069700                 AND (GS-USER-GROUP-NAME <=                       06970055
069800                              GE-USER-GROUP-NAME (GE-INDEX - 1))) 06980055
069900             DISPLAY '** ABEND **'                                06990055
070000             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RACF USER '     07000055
070100                       'GROUP EXPANSION SUPPRESSION FILE NOT IN ' 07010055
070200                       'ASCENDING RACF USER GROUP SEQUENCE'       07020055
070300             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ERROR OCCURS '  07030055
070400                       'AT RACF USER GROUP = '  GS-USER-GROUP-NAME07040055
070500             SET AC-FILE-SEQUENCE-ERROR TO TRUE                   07050055
070600             CALL 'ILBOABN0' USING ABEND-CODE                     07060055
070700         END-IF                                                   07070055
070800         MOVE GS-USER-GROUP-NAME TO                               07080055
070900                   GE-USER-GROUP-NAME (GE-INDEX)                  07090055
071000         ADD +1 TO PV-GRP-SUPPRESS-COUNT                          07100055
071100         PERFORM 7200-READ-GRP-SUP-FILE                           07110055
071200     END-PERFORM.                                                 07120055
071300                                                                  07130055
071400     IF ((GE-INDEX > PC-MAXIMUM-GRP-SUPPRESS-COUNT)               07140055
071500             AND (NOT PS-END-OF-GRP-SUP-FILE))                    07150055
071600         DISPLAY '** ABEND **'                                    07160055
071700         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - MAXIMUM NUMBER OF ' 07170055
071800                   'RACF USER GROUPS REQUESTING EXPANSION TO BE ' 07180055
071900                   'SUPPRESSED EXCEEDED'                          07190055
072000         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXPAND THE TABLE '  07200055
072100                   'AND RERUN'                                    07210055
072200         SET AC-TABLE-OVERFLOW-ERROR TO TRUE                      07220055
072300         CALL 'ILBOABN0' USING ABEND-CODE                         07230055
072400     END-IF.                                                      07240055
072500*1300-EXIT.                                                       07250055
072600                                                                  07260055
072700******************************************************************07270055
072800*                                                                *07280055
072900******************************************************************07290055
073000                                                                  07300055
073100 2000-PROCESS-AUDIT-RESOURCE.                                     07310055
073200     IF (NOT AE-RT-RESOURCE-RECORD)                               07320055
073300         DISPLAY '** ABEND **'                                    07330055
073400         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - EXTRACT FOR THIS '  07340055
073500                   'RESOURCE DID NOT BEGIN WITH A RESOURCE RECORD'07350055
073600         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RESOURCE CLASS = '  07360055
073700                   AE-RESOURCE-CLASS  '; RESOURCE GROUP = '       07370055
073800                   AE-RESOURCE-GROUP                              07380055
073900         SET AC-FILE-SEQUENCE-ERROR TO TRUE                       07390055
074000         CALL 'ILBOABN0' USING ABEND-CODE                         07400055
074100     END-IF.                                                      07410055
074200                                                                  07420055
074300     INITIALIZE RH-RESOURCE-HEADING-LINE-TABLE                    07430055
074400                PV-RESOURCE-HEADING-LINE-COUNT                    07440055
074500                RI-CONTINUATION-IND                               07450055
074600                AD-AUDIT-DETAIL-RCD.                              07460055
074700     SET RH-INDEX TO 1.                                           07470055
074800     MOVE AE-RESOURCE-CLASS TO PV-CURRENT-RESOURCE-CLASS          07480055
074900                               AD-RESOURCE-CLASS                  07490055
075000                               RI-RESOURCE-CLASS.                 07500055
075100     MOVE AE-RESOURCE-GROUP TO PV-CURRENT-RESOURCE-GROUP          07510055
075200                               AD-RESOURCE-GROUP                  07520055
075300                               RI-RESOURCE-GROUP.                 07530055
075400                                                                  07540055
075500     IF AE-RD-UNIVERSAL-ACCESS = HIGH-VALUES                      07550055
075600         SET PS-AUDIT-RESOURCE-NOT-FOUND TO TRUE                  07560055
075700         ADD +1 TO PV-AUD-RESOURCE-NOT-FOUND-CNT                  07570055
075800     ELSE                                                         07580055
075900         SET PS-AUDIT-RESOURCE-FOUND TO TRUE                      07590055
076000     END-IF.                                                      07600055
076100                                                                  07610055
076200     IF ((CC-SEND-FOR-APPROVAL)                                   07620055
076300             AND (PS-AUDIT-RESOURCE-NOT-FOUND))                   07630055
076400         DISPLAY '** ABEND **'                                    07640055
076500         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID RESOURCE '  07650055
076600                   'REQUESTED - RESOURCE NOT FOUND'               07660055
076700         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ALL REQUESTED '     07670055
076800                   'RESOURCES MUST BE VALID WHEN REQUESTING A '   07680055
076900                   'SEND FOR APPROVAL'                            07690055
077000         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RESOURCE CLASS = '  07700055
077100                   AD-RESOURCE-CLASS  '; RESOURCE GROUP = '       07710055
077200                   AD-RESOURCE-GROUP                              07720055
077300         SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE               07730055
077400         CALL 'ILBOABN0' USING ABEND-CODE                         07740055
077500     END-IF.                                                      07750055
077600                                                                  07760055
077700     SEARCH ALL OT-OWNER-ENTRY                                    07770055
077800         AT END                                                   07780055
077900             SET RR-RO-NOT-IDENTIFIED                             07790055
078000                 RR-MB-NOT-IDENTIFIED TO TRUE                     07800055
078100         WHEN OT-RESOURCE-NAME (OT-INDEX) = AE-RESOURCE-NAME      07810055
078200             MOVE OT-OWNER-NAME-DISPLAY (OT-INDEX) TO             07820055
078300                       RR-RESOURCE-OWNER-NAME                     07830055
078400             IF ((RR-RESOURCE-OWNER-NAME = HIGH-VALUES)           07840055
078500                     OR (RR-RESOURCE-OWNER-NAME = SPACES))        07850055
078600                 SET RR-RO-NOT-IDENTIFIED TO TRUE                 07860055
078700             END-IF                                               07870055
078800             MOVE OT-MGMT-BOARD-REP-NAME-DISPLAY (OT-INDEX) TO    07880055
078900                       RR-MGMT-BOARD-REP-NAME                     07890055
079000             IF ((RR-MGMT-BOARD-REP-NAME = HIGH-VALUES)           07900055
079100                     OR (RR-MGMT-BOARD-REP-NAME = SPACES))        07910055
079200                 SET RR-MB-NOT-IDENTIFIED TO TRUE                 07920055
079300             END-IF                                               07930055
079400     END-SEARCH.                                                  07940055
079500                                                                  07950055
079600     IF ((CC-SEND-FOR-APPROVAL)                                   07960055
079700             AND ((RR-RO-NOT-IDENTIFIED)                          07970055
079800             OR (RR-MB-NOT-IDENTIFIED)))                          07980055
079900         DISPLAY '** ABEND **'                                    07990055
080000         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - VALID RESOURCE '    08000055
080100                   'OWNER AND/OR MANGAGEMENT BOARD REP E-MAIL '   08010055
080200                   'ADDRESSES MISSING'                            08020055
080300         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - E-MAIL ADDRESSES '  08030055
080400                   'REQUIRED WHEN REQUESTING A SEND FOR APPROVAL' 08040055
080500         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RESOURCE CLASS = '  08050055
080600                   AD-RESOURCE-CLASS  '; RESOURCE GROUP = '       08060055
080700                   AD-RESOURCE-GROUP                              08070055
080800         SET AC-INVLD-DATA-ON-DATASET-ERROR TO TRUE               08080055
080900         CALL 'ILBOABN0' USING ABEND-CODE                         08090055
081000     END-IF.                                                      08100055
081100                                                                  08110055
081200     IF (CC-SEND-FOR-APPROVAL)                                    08120055
081300         SET AD-RT-ROUTING-RECORD TO TRUE                         08130055
081400         MOVE OT-OWNER-EMAIL (OT-INDEX) TO AD-OWNER-EMAIL         08140055
081500         MOVE OT-MGMT-BOARD-REP-EMAIL (OT-INDEX) TO               08150055
081600                   AD-MGMT-BOARD-REP-EMAIL                        08160055
081700         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   08170055
081800     END-IF.                                                      08180055
081900     SET AD-RT-DETAIL-RECORD TO TRUE.                             08190055
082000     INITIALIZE AD-DETAIL-LINE.                                   08200055
082100                                                                  08210055
082200     MOVE RI-RESOURCE-ID-LINE TO                                  08220055
082300               RH-RESOURCE-HEADING-LINE (RH-INDEX).               08230055
082400     ADD +1 TO PV-RESOURCE-HEADING-LINE-COUNT.                    08240055
082500     SET RH-INDEX UP BY 1.                                        08250055
082600                                                                  08260055
082700     SET RD-DESCRIPTION-ID TO TRUE.                               08270055
082800                                                                  08280055
082900     INSPECT AE-RD-INSTALLATION-DATA                              08290055
083000         REPLACING ALL HIGH-VALUES BY SPACES.                     08300055
083100     IF (AE-RD-INSTALLATION-DATA NOT = SPACES)                    08310055
083200         MOVE LENGTH OF RD-RESOURCE-DESCRIPTION TO                08320055
083300                   PV-LENGTH-OF-DESC-DETAIL                       08330055
083400         MOVE AE-RD-INSTALLATION-DATA TO PV-RESOURCE-DESC-AREA    08340055
083500         MOVE LENGTH OF PV-RESOURCE-DESC-AREA TO                  08350054
083600                   PV-LENGTH-OF-DESC-AREA                         08360054
083700         MOVE +1 TO PV-START-POSITION                             08370054
083800                                                                  08380054
083900         PERFORM 2100-PREPARE-RESOURCE-DESC                       08390054
084000             UNTIL (PV-START-POSITION > PV-LENGTH-OF-DESC-AREA)   08400054
084100     END-IF.                                                      08410054
084200                                                                  08420054
084300     INSPECT AE-RD-APPLICATION-DATA                               08430054
084400         REPLACING ALL HIGH-VALUES BY SPACES.                     08440054
084500     IF (AE-RD-APPLICATION-DATA NOT = SPACES)                     08450054
084600         MOVE LENGTH OF RD-RESOURCE-DESCRIPTION TO                08460054
084700                   PV-LENGTH-OF-DESC-DETAIL                       08470054
084800         MOVE AE-RD-APPLICATION-DATA TO PV-RESOURCE-DESC-AREA     08480054
084900         MOVE LENGTH OF PV-RESOURCE-DESC-AREA TO                  08490054
085000                   PV-LENGTH-OF-DESC-AREA                         08500054
085100         MOVE +1 TO PV-START-POSITION                             08510054
085200                                                                  08520054
085300         PERFORM 2100-PREPARE-RESOURCE-DESC                       08530054
085400             UNTIL (PV-START-POSITION > PV-LENGTH-OF-DESC-AREA)   08540054
085500     END-IF.                                                      08550054
085600                                                                  08560054
085700     IF RD-DESCRIPTION-ID                                         08570054
085800         SET RD-NO-DESCRIPTION-AVAILABLE TO TRUE                  08580055
085900         MOVE RD-RESOURCE-DESCRIPTION-LINE TO                     08590055
086000                   RH-RESOURCE-HEADING-LINE (RH-INDEX)            08600055
086100         ADD +1 TO PV-RESOURCE-HEADING-LINE-COUNT                 08610055
086200         SET RH-INDEX UP BY 1                                     08620055
086300     END-IF.                                                      08630055
086400                                                                  08640055
086500     MOVE PC-NEW-FRONT-REQUEST TO                                 08650055
086600               DP132-LASER-NEW-PAGE-INDICATR.                     08660055
086700     PERFORM 8000-PRINT-TITLE-LINES.                              08670055
086800     MOVE HL2-HEADING-LINE-2 TO AD-DETAIL-LINE.                   08680055
086900     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      08690055
087000     INITIALIZE AD-DETAIL-LINE.                                   08700055
087100     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      08710055
087200     PERFORM                                                      08720055
087300             VARYING RH-INDEX                                     08730055
087400             FROM 1 BY 1                                          08740055
087500             UNTIL (RH-INDEX > PV-RESOURCE-HEADING-LINE-COUNT)    08750055
087600         MOVE RH-RESOURCE-HEADING-LINE (RH-INDEX) TO              08760055
087700                   AD-DETAIL-LINE                                 08770055
087800         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   08780055
087900     END-PERFORM.                                                 08790055
088000     SET RI-RESOURCE-CONTINUATION TO TRUE                         08800055
088100     MOVE RI-RESOURCE-ID-LINE TO                                  08810055
088200               RH-RESOURCE-HEADING-LINE (1).                      08820055
088300                                                                  08830055
088400     IF (CC-DISPLAY-RESOURCE-OWNER-INFO)                          08840055
088500         WRITE AR-AUDIT-REPORT-LINE                               08850055
088600             FROM RR-RESOURCE-RESPONSIBILTY-LINE                  08860055
088700             AFTER ADVANCING 2 LINES                              08870055
088800         ADD +2 TO PV-LINE-COUNT                                  08880055
088900         INITIALIZE AD-DETAIL-LINE                                08890055
089000         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   08900055
089100         MOVE RR-RESOURCE-RESPONSIBILTY-LINE TO AD-DETAIL-LINE    08910055
089200         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   08920055
089300     END-IF.                                                      08930055
089400                                                                  08940055
089500     IF (AE-RD-UNIVERSAL-ACCESS = HIGH-VALUES)                    08950055
089600         INITIALIZE UA-UNIVERSAL-ACCESS                           08960055
089700     ELSE                                                         08970055
089800         MOVE AE-RD-UNIVERSAL-ACCESS TO UA-UNIVERSAL-ACCESS       08980055
089900     END-IF.                                                      08990055
090000     WRITE AR-AUDIT-REPORT-LINE                                   09000055
090100         FROM UA-UNIVERSAL-ACCESS-LINE                            09010055
090200         AFTER ADVANCING 2 LINES.                                 09020055
090300     ADD +2 TO PV-LINE-COUNT.                                     09030055
090400     INITIALIZE AD-DETAIL-LINE.                                   09040055
090500     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      09050055
090600     MOVE UA-UNIVERSAL-ACCESS-LINE TO AD-DETAIL-LINE.             09060055
090700     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      09070055
090800     INITIALIZE AD-DETAIL-LINE.                                   09080055
090900     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      09090055
091000                                                                  09100055
091100     INITIALIZE PV-ACCESS-GRANT-COUNT.                            09110055
091200     SET PV-AC-DOUBLE-SPACE TO TRUE.                              09120055
091300     PERFORM 7000-READ-EXTRACT-FILE.                              09130055
091400     PERFORM 3000-PROCESS-ACCESS-GRANT                            09140055
091500         UNTIL ((PS-END-OF-EXTRACT-FILE)                          09150055
091600                 OR (AE-RESOURCE-CLASS NOT =                      09160055
091700                                  PV-CURRENT-RESOURCE-CLASS)      09170055
091800                 OR (AE-RESOURCE-GROUP NOT =                      09180055
091900                                  PV-CURRENT-RESOURCE-GROUP)).    09190055
092000                                                                  09200055
092100     IF (PS-AUDIT-RESOURCE-NOT-FOUND)                             09210055
092200         WRITE AR-AUDIT-REPORT-LINE                               09220055
092300             FROM RR-REQ-RESOURCE-ERROR-LINE                      09230055
092400             AFTER ADVANCING PV-ADVANCE-COUNT LINES               09240055
092500         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    09250055
092600         MOVE RR-REQ-RESOURCE-ERROR-LINE TO AD-DETAIL-LINE        09260055
092700         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   09270055
092800     ELSE                                                         09280055
092900         IF (PV-ACCESS-GRANT-COUNT = ZERO)                        09290055
093000             WRITE AR-AUDIT-REPORT-LINE                           09300055
093100                 FROM NA-NO-INDIV-ACCESS-GRANT-LINE               09310055
093200                 AFTER ADVANCING PV-ADVANCE-COUNT LINES           09320055
093300             ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                09330055
093400             MOVE NA-NO-INDIV-ACCESS-GRANT-LINE TO AD-DETAIL-LINE 09340055
093500             PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD               09350055
093600         END-IF                                                   09360055
093700     END-IF.                                                      09370055
093800                                                                  09380055
093900     INITIALIZE AD-DETAIL-LINE.                                   09390055
094000     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      09400055
094100     INITIALIZE AD-DETAIL-LINE.                                   09410055
094200     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      09420055
094300*2000-EXIT.                                                       09430055
094400                                                                  09440055
094500******************************************************************09450055
094600*                                                                *09460055
094700******************************************************************09470055
094800                                                                  09480055
094900 2100-PREPARE-RESOURCE-DESC.                                      09490055
095000                                                                  09500055
095100*                                                                 09510055
095200*  FIND MAXIMUM LENGTH OF THIS SEGMENT OF THE DESCRIPTION         09520055
095300*                                                                 09530055
095400                                                                  09540055
095500     COMPUTE PV-SEGMENT-LENGTH =                                  09550055
095600               (PV-LENGTH-OF-DESC-AREA - PV-START-POSITION + 1).  09560055
095700                                                                  09570055
095800     IF (PV-SEGMENT-LENGTH > PV-LENGTH-OF-DESC-DETAIL)            09580055
095900         MOVE PV-LENGTH-OF-DESC-DETAIL TO PV-SEGMENT-LENGTH       09590055
096000     END-IF.                                                      09600055
096100                                                                  09610055
096200*                                                                 09620055
096300*  FIND THE FIRST POSITION BEFORE THE LAST COMPLETE WORD IN THE   09630055
096400*  SEGMENT RANGE                                                  09640055
096500*                                                                 09650055
096600                                                                  09660055
096700     SET PS-NO-CONTINUATION TO TRUE.                              09670055
096800     COMPUTE PV-SPACE-CHECK =                                     09680055
096900              (PV-START-POSITION + PV-SEGMENT-LENGTH - 1).        09690055
097000     IF ((PV-RESOURCE-DESC-AREA (PV-SPACE-CHECK:1) NOT = SPACES)  09700055
097100             AND ((PV-SPACE-CHECK + 1) < PV-LENGTH-OF-DESC-AREA)  09710055
097200             AND (PV-RESOURCE-DESC-AREA ((PV-SPACE-CHECK + 1):1)  09720055
097300                                                   NOT = SPACES)) 09730055
097400         PERFORM                                                  09740055
097500                 UNTIL ((PV-SPACE-CHECK <= PV-START-POSITION)     09750055
097600                      OR (PV-RESOURCE-DESC-AREA (PV-SPACE-CHECK:1)09760055
097700                                                   = SPACES))     09770055
097800             SUBTRACT +1 FROM PV-SPACE-CHECK                      09780055
097900         END-PERFORM                                              09790055
098000         IF (PV-SPACE-CHECK <= PV-START-POSITION)                 09800055
098100             SET PS-HYPHENATE-CONTINUATION TO TRUE                09810055
098200             COMPUTE PV-SPACE-CHECK =                             09820055
098300                 ((PV-START-POSITION + PV-SEGMENT-LENGTH - 1) - 1)09830055
098400         END-IF                                                   09840055
098500     END-IF.                                                      09850055
098600                                                                  09860055
098700*                                                                 09870055
098800*  MOVE SEGMENT TO OUTPUT ARRAY.  THE EXACT END CHARACTER IS NOT  09880055
098900*  NECESSARY IN THE MOVE, SINCE IT IS FIXED LENGTH AND SPACE      09890055
099000*  FILLED.                                                        09900055
099100*                                                                 09910055
099200                                                                  09920055
099300     COMPUTE PV-SEGMENT-LENGTH =                                  09930055
099400              (PV-SPACE-CHECK - PV-START-POSITION + 1).           09940055
099500     IF PS-HYPHENATE-CONTINUATION                                 09950055
099600         INITIALIZE RD-RESOURCE-DESCRIPTION                       09960055
099700         STRING                                                   09970055
099800                PV-RESOURCE-DESC-AREA                             09980055
099900                      (PV-START-POSITION:PV-SEGMENT-LENGTH)       09990055
100000                                                 DELIMITED BY SIZE10000055
100100                PC-DASH                          DELIMITED BY SIZE10010055
100200             INTO RD-RESOURCE-DESCRIPTION                         10020055
100300     ELSE                                                         10030055
100400         MOVE PV-RESOURCE-DESC-AREA                               10040055
100500                      (PV-START-POSITION:PV-SEGMENT-LENGTH) TO    10050055
100600                   RD-RESOURCE-DESCRIPTION                        10060055
100700     END-IF.                                                      10070055
100800                                                                  10080055
100900     MOVE RD-RESOURCE-DESCRIPTION-LINE TO                         10090055
101000               RH-RESOURCE-HEADING-LINE (RH-INDEX).               10100055
101100     ADD +1 TO PV-RESOURCE-HEADING-LINE-COUNT.                    10110055
101200     SET RH-INDEX UP BY 1.                                        10120055
101300     SET RD-DESCRIPTION-CONTINUATION TO TRUE.                     10130055
101400                                                                  10140055
101500*                                                                 10150055
101600*  SEED THE START OF PROCESSING THE NEXT SEGMENT.  FIND THE NEXT  10160055
101700*  NON-BLANK CHARACTER AFTER THE END OF THE LAST SEGMENT.         10170055
101800*                                                                 10180055
101900                                                                  10190055
102000     ADD PV-SEGMENT-LENGTH TO PV-START-POSITION.                  10200055
102100     PERFORM                                                      10210055
102200             UNTIL ((PV-START-POSITION > PV-LENGTH-OF-DESC-AREA)  10220055
102300                   OR (PV-RESOURCE-DESC-AREA (PV-START-POSITION:1)10230054
102400                                                   NOT = SPACES)) 10240054
102500         ADD +1 TO PV-START-POSITION                              10250054
102600     END-PERFORM.                                                 10260054
102700*2100-EXIT.                                                       10270054
102800                                                                  10280054
102900******************************************************************10290054
103000*                                                                *10300054
103100******************************************************************10310054
103200                                                                  10320054
103300 3000-PROCESS-ACCESS-GRANT.                                       10330054
103400     IF (NOT AE-RT-ACCESS-RECORD)                                 10340054
103500         DISPLAY '** ABEND **'                                    10350055
103600         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ACCESS GRANT '      10360055
103700                   'FOR THIS RESOURCE HAD DETAIL OTHER THAN '     10370055
103800                   'ACCESS RECORD'                                10380055
103900         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - RESOURCE CLASS = '  10390055
104000                   AE-RESOURCE-CLASS  '; RESOURCE GROUP = '       10400055
104100                   AE-RESOURCE-GROUP                              10410055
104200         SET AC-FILE-SEQUENCE-ERROR TO TRUE                       10420055
104300         CALL 'ILBOABN0' USING ABEND-CODE                         10430055
104400     END-IF.                                                      10440055
104500                                                                  10450055
104600     ADD +1 TO PV-ACCESS-GRANT-COUNT.                             10460055
104700                                                                  10470055
104800     MOVE AE-AD-GRANTED-TO-ID TO PV-CURRENT-GRANTED-TO-ID         10480055
104900                                 RA-GRANTED-TO-ID.                10490055
105000                                                                  10500055
105100     MOVE AE-AD-ACCESS-LEVEL TO RA-ACCESS-LEVEL.                  10510055
105200     IF (AE-AD-ACCESS-LEVEL = UA-UNIVERSAL-ACCESS)                10520055
105300         SET RA-RS-REDUNDANT-SECURITY TO TRUE                     10530055
105400     ELSE                                                         10540055
105500         SET RA-RS-UNIQUE-SECURITY TO TRUE                        10550055
105600     END-IF.                                                      10560055
105700     INITIALIZE RA-DETAIL.                                        10570055
105800                                                                  10580055
105900     IF AE-AD-NOT-A-USER-GROUP                                    10590055
106000         IF (AE-AD-DUP-USER-PRIVILEGE)                            10600055
106100             SET RA-RS-REDUNDANT-SECURITY TO TRUE                 10610055
106200         END-IF                                                   10620055
106300         SET RA-IL-INDIVIDUAL-USER TO TRUE                        10630055
106400         PERFORM 5000-PREPARE-USER-DETAILS                        10640055
106500         MOVE IU-INDIVIDUAL-USER-DETAILS TO RA-DETAIL             10650055
106600         IF ((PV-LINE-COUNT + 1) > PC-PAGE-SIZE)                  10660055
106700             PERFORM 8000-PRINT-TITLE-LINES                       10670055
106800         END-IF                                                   10680055
106900         WRITE AR-AUDIT-REPORT-LINE                               10690055
107000             FROM RA-RESOURCE-ACCESS-LINE                         10700055
107100             AFTER ADVANCING PV-ADVANCE-COUNT LINES               10710055
107200         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    10720055
107300         SET PV-AC-SINGLE-SPACE TO TRUE                           10730055
107400         MOVE RA-RESOURCE-ACCESS-LINE TO AD-DETAIL-LINE           10740055
107500         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   10750055
107600         INITIALIZE PV-CERTIFICATION-RECORD                       10760055
107700         STRING PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10770055
107800                AE-AD-USER-ID                   DELIMITED BY SPACE10780055
107900                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10790055
108000                PC-COMMA                        DELIMITED BY SIZE 10800055
108100                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10810055
108200                AE-RESOURCE-GROUP               DELIMITED BY SPACE10820055
108300                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10830055
108400                PC-COMMA                        DELIMITED BY SIZE 10840055
108500                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10850055
108600                PC-NO-USER-GROUP                DELIMITED BY SIZE 10860055
108700                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10870055
108800                PC-COMMA                        DELIMITED BY SIZE 10880055
108900                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10890055
109000                AE-RESOURCE-CLASS               DELIMITED BY SPACE10900055
109100                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10910055
109200                PC-COMMA                        DELIMITED BY SIZE 10920055
109300                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10930055
109400                AE-AD-ACCESS-LEVEL              DELIMITED BY SPACE10940055
109500                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10950055
109600                PC-COMMA                        DELIMITED BY SIZE 10960055
109700                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10970055
109800                AE-AD-ACCOUNT-CATEGORY          DELIMITED BY SPACE10980055
109900                PC-DOUBLE-QUOTE                 DELIMITED BY SIZE 10990055
110000             INTO PV-CERTIFICATION-RECORD                         11000055
110100         PERFORM 8200-WRITE-CERTIFICATION-RCD                     11010056
110200         PERFORM 7000-READ-EXTRACT-FILE                           11020055
110300     ELSE                                                         11030055
110400         IF (AE-AD-USER-GROUP-DESCRIPTION = SPACES)               11040055
110500             SET RA-UG-NO-DESCRIPTION TO TRUE                     11050055
110600         ELSE                                                     11060055
110700             MOVE AE-AD-USER-GROUP-DESCRIPTION TO                 11070055
110800                       RA-USER-GROUP-DESCRIPTION                  11080055
110900         END-IF                                                   11090055
111000         SET RA-IL-USER-GROUP TO TRUE                             11100055
111100         SEARCH ALL GE-USER-GROUP-ENTRY                           11110055
111200             AT END                                               11120055
111300                 SET PS-GS-EXPAND-GROUP TO TRUE                   11130055
111400             WHEN GE-USER-GROUP-NAME (GE-INDEX) =                 11140055
111500                                               AE-AD-GRANTED-TO-ID11150055
111600                 SET PS-GS-SUPPRESS-GROUP TO TRUE                 11160055
111700         END-SEARCH                                               11170055
111800         IF AE-AD-GROUP-WITHOUT-USERS                             11180055
111900             SET RA-UG-NO-USERS TO TRUE                           11190055
112000             SET PS-GS-SUPPRESS-GROUP TO TRUE                     11200055
112100             INITIALIZE PV-CERTIFICATION-RECORD                   11210055
112200                        AE-AD-USER-ID                             11220057
112300                        AE-AD-ACCOUNT-CATEGORY                    11230057
112400             STRING PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11240057
112500                    PC-GROUP-WITHOUT-USERS      DELIMITED BY SIZE 11250063
112600                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11260057
112700                    PC-COMMA                    DELIMITED BY SIZE 11270057
112800                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11280057
112900                    AE-RESOURCE-GROUP           DELIMITED BY SPACE11290057
113000                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11300057
113100                    PC-COMMA                    DELIMITED BY SIZE 11310057
113200                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11320057
113300                    AE-AD-GRANTED-TO-ID         DELIMITED BY SPACE11330059
113400                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11340057
113500                    PC-COMMA                    DELIMITED BY SIZE 11350057
113600                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11360057
113700                    AE-RESOURCE-CLASS           DELIMITED BY SPACE11370057
113800                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11380057
113900                    PC-COMMA                    DELIMITED BY SIZE 11390057
114000                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11400057
114100                    AE-AD-ACCESS-LEVEL          DELIMITED BY SPACE11410057
114200                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11420057
114300                    PC-COMMA                    DELIMITED BY SIZE 11430057
114400                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11440057
114500                    PC-CATEGORY-UNKNOWN         DELIMITED BY SIZE 11450063
114600                    PC-DOUBLE-QUOTE             DELIMITED BY SIZE 11460057
114700                 INTO PV-CERTIFICATION-RECORD                     11470057
114800             PERFORM 8200-WRITE-CERTIFICATION-RCD                 11480057
114900         ELSE                                                     11490057
115000             IF ((CC-SUPPRESS-ALL-GROUPS)                         11500057
115100                    OR (PS-GS-SUPPRESS-GROUP))                    11510057
115200                 SET RA-UG-GROUP-SUPPRESSED TO TRUE               11520057
115300                 SET PS-GS-SUPPRESS-GROUP TO TRUE                 11530057
115400             END-IF                                               11540057
115500         END-IF                                                   11550057
115600         IF (PS-GS-SUPPRESS-GROUP)                                11560057
115700             IF ((PV-LINE-COUNT + 1) > PC-PAGE-SIZE)              11570057
115800                 PERFORM 8000-PRINT-TITLE-LINES                   11580057
115900             END-IF                                               11590057
116000         ELSE                                                     11600057
116100             IF ((PV-LINE-COUNT + 2) > PC-PAGE-SIZE)              11610057
116200                 PERFORM 8000-PRINT-TITLE-LINES                   11620057
116300             END-IF                                               11630057
116400         END-IF                                                   11640057
116500         WRITE AR-AUDIT-REPORT-LINE                               11650057
116600             FROM RA-RESOURCE-ACCESS-LINE                         11660057
116700             AFTER ADVANCING PV-ADVANCE-COUNT LINES               11670057
116800         ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT                    11680057
116900         SET PV-AC-SINGLE-SPACE TO TRUE                           11690057
117000         MOVE RA-RESOURCE-ACCESS-LINE TO AD-DETAIL-LINE           11700057
117100         PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD                   11710057
117200         SET RA-UG-EXPANSION-CONTINUED TO TRUE                    11720057
117300                                                                  11730057
117400         PERFORM                                                  11740057
117500                 UNTIL ((PS-END-OF-EXTRACT-FILE)                  11750057
117600                         OR (AE-RESOURCE-CLASS NOT =              11760057
117700                                  PV-CURRENT-RESOURCE-CLASS)      11770057
117800                         OR (AE-RESOURCE-GROUP NOT =              11780057
117900                                  PV-CURRENT-RESOURCE-GROUP)      11790057
118000                         OR (AE-AD-GRANTED-TO-ID NOT =            11800057
118100                                  PV-CURRENT-GRANTED-TO-ID))      11810057
118200             IF (PS-GS-SUPPRESS-GROUP)                            11820057
118300                 PERFORM 7000-READ-EXTRACT-FILE                   11830057
118400             ELSE                                                 11840057
118500                 PERFORM 4000-PROCESS-GROUP-EXPANSION             11850057
118600             END-IF                                               11860057
118700         END-PERFORM                                              11870057
118800     END-IF.                                                      11880057
118900*3000-EXIT.                                                       11890057
119000                                                                  11900057
119100******************************************************************11910057
119200*                                                                *11920055
119300******************************************************************11930055
119400                                                                  11940055
119500 4000-PROCESS-GROUP-EXPANSION.                                    11950055
119600     MOVE AE-AD-USER-ID TO GE-USER-ID.                            11960055
119700     PERFORM 5000-PREPARE-USER-DETAILS.                           11970055
119800                                                                  11980055
119900     MOVE IU-INDIVIDUAL-USER-DETAILS TO                           11990055
120000               GE-INDIVIDUAL-USER-DETAILS.                        12000055
120100     IF ((PV-LINE-COUNT + 1) > PC-PAGE-SIZE)                      12010055
120200         PERFORM 8000-PRINT-TITLE-LINES                           12020055
120300         WRITE AR-AUDIT-REPORT-LINE                               12030055
120400             FROM RA-RESOURCE-ACCESS-LINE                         12040055
120500             AFTER ADVANCING PV-ADVANCE-COUNT LINES               12050055
120600         SET PV-AC-SINGLE-SPACE TO TRUE                           12060055
120700     END-IF.                                                      12070055
120800     WRITE AR-AUDIT-REPORT-LINE                                   12080055
120900         FROM GE-GROUP-EXPANSION-LINE                             12090055
121000         AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  12100055
121100     ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT.                       12110055
121200     SET PV-AC-SINGLE-SPACE TO TRUE.                              12120055
121300     MOVE GE-GROUP-EXPANSION-LINE TO AD-DETAIL-LINE.              12130055
121400     PERFORM 8100-WRITE-AUDIT-DETAIL-RECORD.                      12140055
121500                                                                  12150055
121600     INITIALIZE PV-CERTIFICATION-RECORD.                          12160055
121700     STRING PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12170055
121800            AE-AD-USER-ID                       DELIMITED BY SPACE12180055
121900            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12190055
122000            PC-COMMA                            DELIMITED BY SIZE 12200055
122100            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12210055
122200            AE-RESOURCE-GROUP                   DELIMITED BY SPACE12220055
122300            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12230055
122400            PC-COMMA                            DELIMITED BY SIZE 12240055
122500            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12250055
122600            AE-AD-GRANTED-TO-ID                 DELIMITED BY SPACE12260058
122700            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12270055
122800            PC-COMMA                            DELIMITED BY SIZE 12280055
122900            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12290055
123000            AE-RESOURCE-CLASS                   DELIMITED BY SPACE12300055
123100            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12310055
123200            PC-COMMA                            DELIMITED BY SIZE 12320055
123300            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12330055
123400            AE-AD-ACCESS-LEVEL                  DELIMITED BY SPACE12340055
123500            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12350055
123600            PC-COMMA                            DELIMITED BY SIZE 12360055
123700            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12370055
123800            AE-AD-ACCOUNT-CATEGORY              DELIMITED BY SPACE12380055
123900            PC-DOUBLE-QUOTE                     DELIMITED BY SIZE 12390055
124000         INTO PV-CERTIFICATION-RECORD.                            12400055
124100     PERFORM 8200-WRITE-CERTIFICATION-RCD.                        12410056
124200                                                                  12420055
124300     PERFORM 7000-READ-EXTRACT-FILE.                              12430055
124400*4000-EXIT.                                                       12440055
124500                                                                  12450055
124600******************************************************************12460055
124700*                                                                *12470055
124800******************************************************************12480055
124900                                                                  12490055
125000 5000-PREPARE-USER-DETAILS.                                       12500055
125100     INITIALIZE IU-ACCOUNT-CATEGORY.                              12510055
125200     IF ((AE-AD-ACCOUNT-NOT-DEFINED)                              12520055
125300             OR (AE-AD-CATEGORY-NOT-DEFINED))                     12530055
125400         SET AE-AD-CATEGORY-UNKNOWN TO TRUE                       12540055
125500     END-IF.                                                      12550055
125600     STRING PC-OPEN-PARENTHESIS               DELIMITED BY SIZE   12560055
125700            AE-AD-ACCOUNT-CATEGORY            DELIMITED BY SPACES 12570055
125800            PC-CLOSE-PARENTHESIS              DELIMITED BY SIZE   12580055
125900         INTO IU-ACCOUNT-CATEGORY.                                12590055
126000                                                                  12600055
126100     IF (AE-AD-ACCOUNT-NOT-DEFINED)                               12610055
126200         SET IU-UN-NO-DESCRIPTION TO TRUE                         12620055
126300     ELSE                                                         12630055
126400         MOVE AE-AD-USER-NAME TO IU-USER-NAME                     12640055
126500     END-IF.                                                      12650055
126600                                                                  12660055
126700     IF (CC-INCLUDE-HR-INFORMATION)                               12670055
126800         SET IU-EMPLOYEE-ID-TAG TO TRUE                           12680055
126900         MOVE AE-AD-EMPLOYEE-ID-X TO IU-EMPLOYEE-ID               12690055
127000         IF ((IU-EMPLOYEE-ID = SPACES)                            12700055
127100                 OR (IU-EMPLOYEE-ID = HIGH-VALUES))               12710055
127200             SET IU-EMPLOYEE-ID-NOT-AVAILABLE TO TRUE             12720055
127300         END-IF                                                   12730055
127400     END-IF.                                                      12740055
127500*5000-EXIT.                                                       12750055
127600                                                                  12760055
127700******************************************************************12770055
127800*                                                                *12780055
127900******************************************************************12790055
128000                                                                  12800055
128100 7000-READ-EXTRACT-FILE.                                          12810055
128200     READ RACF-AUDIT-EXTRACT-FILE                                 12820055
128300         INTO AE-AUDIT-EXTRACT-FILE-RECORD                        12830055
128400         AT END                                                   12840055
128500             SET PS-END-OF-EXTRACT-FILE TO TRUE                   12850055
128600     END-READ.                                                    12860055
128700*7000-EXIT.                                                       12870055
128800                                                                  12880055
128900******************************************************************12890055
129000*                                                                *12900055
129100******************************************************************12910055
129200                                                                  12920055
129300 7100-READ-RESOURCE-OWNER-FILE.                                   12930055
129400     READ RESOURCE-OWNER-FILE                                     12940055
129500         INTO RO-RESOURCE-OWNER-RCD                               12950055
129600         AT END                                                   12960055
129700             SET PS-END-OF-OWNER-FILE TO TRUE                     12970055
129800     END-READ.                                                    12980055
129900*7100-EXIT.                                                       12990055
130000                                                                  13000055
130100******************************************************************13010055
130200*                                                                *13020055
130300******************************************************************13030055
130400                                                                  13040055
130500 7200-READ-GRP-SUP-FILE.                                          13050055
130600     READ GROUP-SUPPRESSION-FILE                                  13060055
130700         INTO GS-GROUP-SUPPRESSION-RCD                            13070055
130800         AT END                                                   13080055
130900             SET PS-END-OF-GRP-SUP-FILE TO TRUE                   13090055
131000     END-READ.                                                    13100055
131100*7200-EXIT.                                                       13110055
131200                                                                  13120055
131300******************************************************************13130055
131400*                                                                *13140055
131500******************************************************************13150055
131600                                                                  13160055
131700 8000-PRINT-TITLE-LINES.                                          13170055
131800     ADD 1 TO PV-PAGE-COUNT.                                      13180055
131900     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     13190055
132000                                                                  13200055
132100     WRITE AR-AUDIT-REPORT-LINE                                   13210055
132200         FROM DP132-STANDRD-HEADER-132-COLS                       13220055
132300         AFTER ADVANCING PAGE.                                    13230055
132400     INITIALIZE DP132-LASER-NEW-PAGE-INDICATR.                    13240055
132500     WRITE AR-AUDIT-REPORT-LINE                                   13250055
132600         FROM HL2-HEADING-LINE-2                                  13260055
132700         AFTER ADVANCING 1 LINE.                                  13270055
132800     MOVE +2 TO PV-LINE-COUNT.                                    13280055
132900                                                                  13290055
133000     SET PV-AC-DOUBLE-SPACE TO TRUE                               13300055
133100     PERFORM                                                      13310055
133200             VARYING RH-INDEX                                     13320055
133300             FROM 1 BY 1                                          13330055
133400             UNTIL (RH-INDEX > PV-RESOURCE-HEADING-LINE-COUNT)    13340055
133500         WRITE AR-AUDIT-REPORT-LINE                               13350054
133600             FROM RH-RESOURCE-HEADING-LINE (RH-INDEX)             13360054
133700             AFTER ADVANCING PV-ADVANCE-COUNT LINES               13370054
133800         SET PV-AC-SINGLE-SPACE TO TRUE                           13380054
133900     END-PERFORM.                                                 13390054
134000                                                                  13400054
134100     ADD PV-RESOURCE-HEADING-LINE-COUNT TO PV-LINE-COUNT.         13410054
134200     SET PV-AC-DOUBLE-SPACE TO TRUE.                              13420054
134300*8000-EXIT.                                                       13430054
134400                                                                  13440055
134500******************************************************************13450055
134600*                                                                *13460055
134700******************************************************************13470055
134800                                                                  13480055
134900 8100-WRITE-AUDIT-DETAIL-RECORD.                                  13490055
135000     WRITE AD-AUDIT-DETAIL-RECORD                                 13500055
135100         FROM AD-AUDIT-DETAIL-RCD.                                13510055
135200*8100-EXIT.                                                       13520055
135300                                                                  13530055
135400******************************************************************13540055
135500*                                                                *13550055
135600******************************************************************13560055
135700                                                                  13570055
135800 8200-WRITE-CERTIFICATION-RCD.                                    13580056
135900     WRITE CF-CERTIFICATION-RECORD                                13590055
136000         FROM PV-CERTIFICATION-RECORD.                            13600055
136100*8200-EXIT.                                                       13610055
136200                                                                  13620055
136300******************************************************************13630055
136400*  CLOSE ALL FILES.                                              *13640055
136500******************************************************************13650055
136600                                                                  13660055
136700 9000-EOJ-ROUTINE.                                                13670055
136800     CLOSE RACF-AUDIT-EXTRACT-FILE                                13680055
136900           RESOURCE-OWNER-FILE                                    13690055
137000           GROUP-SUPPRESSION-FILE                                 13700055
137100           AUDIT-DETAIL-FILE                                      13710055
137200           CERTIFICATION-FILE                                     13720056
137300           AUDIT-REPORT-FILE.                                     13730055
137400*9000-EXIT.                                                       13740055
