000100 IDENTIFICATION DIVISION.                                         00010004
000200 PROGRAM-ID.    XLKUT029.                                         00020004
000300 AUTHOR.        RON KRIER.                                        00030004
000400 INSTALLATION.  KOHLS.                                            00040004
000500 DATE-WRITTEN   MARCH, 29, 2003.                                  00050004
000600 DATE-COMPILED.                                                   00060004
000700                                                                  00070004
000800* ************************************************************** *00080004
000900* * XLKUT029.  "PURCHASE ORDER DOMAIN INTEGRITY"               * *00090004
001000* *                                                            * *00100004
001100* * PURPOSE:                                                   * *00110004
001200* * THIS PROGRAM CREATES AN EXTRACT FILE FROM: TPLNSHP.        * *00120004
001300* * THIS EXTRACT FILE CONSISTS OF ROWS ELIGIBLE TO BE TO PART  * *00130004
001400* * OF THE INTEGRITY PROCESS BETWEEN THE RMS PURCHASE ORDER    * *00140004
001500* * SYSTEM AND THE LOGISTICS DOMAIN PURCHASE ORDER TABLES.     * *00150004
001600* *                                                            * *00160004
001700* * PROCESSING OVERVIEW:                                       * *00170004
001800* *   THIS PROGRAM WILL READ THE INPUT DRIVER FILE AND THEN    * *00180004
001900* *   PERFORM A SELECT ON THE TPLNSHP TABLE.  DATA RETRIEVED   * *00190004
002000* *   FROM THE SELECT WILL THEN BE WRITTEN TO THE OUTPUT FILE. * *00200004
002000* *                                                            * *00200004
002000* *   06/25/14 GB  CHANGE FOR RMS13                            * *00200004
      * *   IF THE EXTENDED CANCEL DATE IS POPULATED                            
      * *   (PLNSHP-EXT-CAN-DTE) POPULATE THE NOT AFTER DATE                    
      * *   (PLNSHP-CAN-IFNOT-SHIP-DTE) WITH THE EXT CANCEL DATE                
      * *   THIS WILL SYNC UP THE DATA INTEGRITY FIELD WITH SAME                
      * *   CHANGE MADE IN XLPO PROCESSING                                      
002100**************************************************************** *00210004
002200 ENVIRONMENT DIVISION.                                            00220004
002300 CONFIGURATION SECTION.                                           00230004
002400 SOURCE-COMPUTER.        IBM-3090.                                00240004
002500 OBJECT-COMPUTER.        IBM-3090.                                00250004
002600                                                                  00260004
002700 INPUT-OUTPUT SECTION.                                            00270004
002800 FILE-CONTROL.                                                    00280004
002900                                                                  00290004
003000     SELECT IN-DRIVER-FILE                ASSIGN TO IN01.         00300004
003100     SELECT OUT-EXTRACT-FILE              ASSIGN TO OUT01.        00310004
003110     SELECT OUT-ERROR-FILE                ASSIGN TO OUT02.        00310002
003200                                                                  00320004
003300******************************************************************00330004
003400 DATA DIVISION.                                                   00340004
003500 FILE SECTION.                                                    00350004
003600                                                                  00360004
003700 FD  IN-DRIVER-FILE                                               00370004
003800     RECORDING MODE IS F                                          00380004
003900     LABEL RECORDS ARE STANDARD                                   00390004
004000     BLOCK CONTAINS 0 RECORDS.                                    00400004
004100 01  IN-DRIVER-RECORD                PIC  X(030).                 00410004
004200                                                                  00420004
004300**** TPLNSHP:                                                     00430004
004400 FD  OUT-EXTRACT-FILE                                             00440004
004500     RECORDING MODE IS F                                          00450004
004600     LABEL RECORDS ARE STANDARD                                   00460004
004700     BLOCK CONTAINS 0 RECORDS.                                    00470004
004800 01  OUT-EXTRACT-RECORD              PIC  X(184).                 00480005
004900                                                                  00490004
004920 FD  OUT-ERROR-FILE                                               00440002
004930     RECORDING MODE IS F                                          00450002
004940     LABEL RECORDS ARE STANDARD                                   00460002
004950     BLOCK CONTAINS 0 RECORDS.                                    00470002
004960 01  OUT-ERROR-RECORD                PIC  X(200).                 00480002
004970                                                                  00490002
005000                                                                  00500004
005100                                                                  00510004
005200 WORKING-STORAGE SECTION.                                         00520004
005300                                                                  00530004
005400 01  PC-PROGRAM-CONSTANTS.                                        00540004
005500     05  PC-CURRENT-PROGRAM-NAME     PIC X(08) VALUE 'XLKUT029'.  00550004
005600     05  PC-PGM-PROGRESS-DESC.                                    00560004
005700         10  PC-BEGINNING            PIC X(09) VALUE 'BEGINNING'. 00570004
005800         10  PC-CONTINUING           PIC X(10) VALUE              00580004
005900                                               'CONTINUING'.      00590004
006000         10  PC-ENDING               PIC X(06) VALUE 'ENDING'.    00600004
006100         10  PC-ABENDING             PIC X(08) VALUE 'ABENDING'.  00610004
006200     05  PC-ABEND-INFO.                                           00620004
006300         10  PC-ABEND                PIC X(11) VALUE              00630004
006400                                               '** ABEND **'.     00640004
006500         10  PC-ABEND-MSG-PARA       PIC X(15) VALUE              00650004
006600                                               '- PARA       : '. 00660004
006700         10  PC-ABEND-MSG-DISPLAY-PARA                            00670004
006800                                     PIC X(15) VALUE              00680004
006900                                               '  CALLED PARA: '. 00690004
007000         10  PC-ABEND-MSG-NUMBER     PIC X(15) VALUE              00700004
007100                                               '  FOR ABEND# : '. 00710004
007200         10  PC-ABEND-MSG-DESC       PIC X(15) VALUE              00720004
007300                                               '- ERROR IS   : '. 00730004
007400         10  PC-ABEND-MSG-INDENT-15  PIC X(15) VALUE SPACES.      00740004
007500         10  PC-ABEND-MSG-ACTION     PIC X(15) VALUE              00750004
007600                                               '- ACTION     : '. 00760004
007700     05  PC-HOW-OFTEN-TO-DISPLAY     PIC 9(9)  VALUE 5000.        00770004
005500     05  PC-DEFAULT-DATE             PIC X(10) VALUE              00550004
005500                                             '0001-01-01'.        00550004
007800                                                                  00780004
007900 01  PS-PROGRAM-SWITCHES.                                         00790004
008000     05  PS-IN-DRIVER-EOF-SW         PIC X(01) VALUE 'N'.         00800004
008100         88  PS-IN-DRIVER-EOF                  VALUE 'Y'.         00810004
008200         88  PS-IN-DRIVER-NOT-EOF              VALUE 'N'.         00820004
008300     05  PS-TABLE-DATA-FOUND-SW      PIC X(01) VALUE 'N'.         00830004
008400         88  PS-TABLE-DATA-FOUND               VALUE 'Y'.         00840004
008500         88  PS-TABLE-DATA-NOT-FOUND           VALUE 'N'.         00850004
008600                                                                  00860004
008700 01  PV-PROGRAM-VARIABLES.                                        00870004
008800     05  PV-PO-NBR-COMP              PIC S9(9) VALUE 0 COMP.      00880004
008900     05  PV-PO-NBR-NUM               PIC  9(9) VALUE 0.           00890004
009000     05  PV-IN-DRIVER-RECS-READ-CNT  PIC  9(9) VALUE 0.           00900004
009100     05  PV-RECS-WITH-MATCHES-CNT    PIC  9(9) VALUE 0.           00910004
009200     05  PV-TABLE-ROW-SELECT-CNT     PIC  9(9) VALUE 0.           00920004
009300     05  PV-EXTRACT-WRITTEN-CNT      PIC  9(9) VALUE 0.           00930004
009310     05  PV-ERROR-WRITTEN-CNT        PIC  9(9) VALUE 0.           00930004
033100     05  PV-NULL-IND-1               PIC S9(04) VALUE +0 COMP.            
033300     05  PV-NULL-IND-2               PIC S9(04) VALUE +0 COMP.            
009400                                                                  00940004
009500     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.      00950004
009510     05  PV-ERROR-RECORD             PIC X(200) VALUE SPACES.     00950004
009600     05  PV-DB2-OPERATION-MSG-1      PIC X(79) VALUE SPACES.      00960004
009700     05  PV-DB2-TABLE-NAME           PIC X(18) VALUE SPACES.      00970004
009800     05  PV-DISPLAY-NTH-MULTIPLE     PIC 9(9)  VALUE 0.           00980004
009900     05  PV-DISPLAY-NTH-REMAINDER    PIC 9(9)  VALUE 0.           00990004
010000     05  PV-SQLCODE                  PIC +999  VALUE ZERO.        01000004
010100                                                                  01010004
010200     05  PV-TMST                     PIC X(26) VALUE SPACES.      01020004
010300     05  PV-TIMESTAMP-DETAIL                                      01030004
010400         REDEFINES                                                01040004
010500         PV-TMST.                                                 01050004
010600         10  PV-TIMESTAMP-19.                                     01060004
010700             15  PV-TMS-DATE.                                     01070004
010800                 20  PV-TMS-YEAR.                                 01080004
010900                     25  PV-TMS-CC   PIC X(02).                   01090004
011000                     25  PV-TMS-YY   PIC X(02).                   01100004
011100                 20  FILLER          PIC X(01).                   01110004
011200                 20  PV-TMS-MONTH    PIC X(02).                   01120004
011300                 20  FILLER          PIC X(01).                   01130004
011400                 20  PV-TMS-DAY      PIC X(02).                   01140004
011500             15  FILLER              PIC X(01).                   01150004
011600             15  PV-TMS-HOUR         PIC X(02).                   01160004
011700             15  FILLER              PIC X(01).                   01170004
011800             15  PV-TMS-MINUTE       PIC X(02).                   01180004
011900             15  FILLER              PIC X(01).                   01190004
012000             15  PV-TMS-SECOND       PIC X(02).                   01200004
012100         10  FILLER                  PIC X(01).                   01210004
012200         10  PV-TMS-MSECOND          PIC X(06).                   01220004
012300                                                                  01230004
012400 01  DM-DISPLAY-MESSAGE.                                          01240004
012500     05  DM-01-10.                                                01250004
012600         10  DM-PROGRAM              PIC X(08) VALUE SPACE.       01260004
012700         10  FILLER                  PIC X(02) VALUE ': '.        01270004
012800     05  DM-11-80.                                                01280004
012900         10  FILLER                  PIC X(37) VALUE              01290004
013000                        'SELECT ROWS MATCHING PO DRIVER FILE, '.  01300004
013100         10  FILLER                  PIC X(30) VALUE              01310004
013200                        'CREATING TPLNSHP EXTRACT FILE.'.         01320004
013300         10  FILLER                  PIC X(01) VALUE SPACE.       01330004
013400         10  FILLER                  PIC X(01) VALUE ALL '*'.     01340004
013500     05  DM-81-120.                                               01350004
013600         10  FILLER                  PIC X(40) VALUE ALL '*'.     01360004
013700                                                                  01370004
013800 01  DP-DISPLAY-PROGRESS-MSG.                                     01380004
013900     05  DP-PROGRAM                  PIC X(08) VALUE SPACE.       01390004
014000     05  FILLER                      PIC X(02) VALUE SPACE.       01400004
014100     05  DP-STATUS-DESCRIPTION       PIC X(10) VALUE SPACE.       01410004
014200     05  FILLER                      PIC X(04) VALUE ' AT '.      01420004
014300     05  DP-TIMESTAMP-19             PIC X(19) VALUE SPACE.       01430004
014400     05  FILLER                      PIC X(03) VALUE '.  '.       01440004
014500     05  FILLER                      PIC X(03) VALUE              01450004
014600                                         'IN:'.                   01460004
014700     05  DP-IN-CNT                   PIC ZZZ,ZZZ,ZZ9              01470004
014800                                               VALUE ZERO.        01480004
014900     05  FILLER                      PIC X(02) VALUE ', '.        01490004
015000*    05  FILLER                      PIC X(16) VALUE              01500004
015100*                                        'DRIVER W/ROW(S):'.      01510004
015200*    05  DP-MATCHES-FOUND-CNT        PIC ZZZ,ZZZ,ZZ9              01520004
015300*                                              VALUE ZERO.        01530004
015400*    05  FILLER                      PIC X(02) VALUE ', '.        01540004
015500     05  FILLER                      PIC X(14) VALUE              01550004
015600                                         'ROWS SELECTED:'.        01560004
015700     05  DP-ROWS-SELECTED-CNT        PIC ZZZ,ZZZ,ZZ9              01570004
015800                                               VALUE ZERO.        01580004
015900     05  FILLER                      PIC X(02) VALUE ', '.        01590004
016000     05  FILLER                      PIC X(04) VALUE              01600004
016100                                         'OUT:'.                  01610004
016200     05  DP-OUT-CNT                  PIC ZZZ,ZZZ,ZZ9              01620004
016300                                               VALUE ZERO.        01630004
016400     05  FILLER                      PIC X(01) VALUE '.'.         01640004
016500                                                                  01650004
016600 01  ABEND-CODE                      PIC S9(04)                   01660004
016700                                               VALUE ZEROES       01670004
016800                                               COMP SYNC.         01680004
016900                                                                  01690004
017000*---------------------------------------------------------------* 01700004
017100*  DB2 FORMATTED MESSAGE AREA                                     01710004
017200*---------------------------------------------------------------* 01720004
017300     COPY DPWS004.                                                01730004
017400                                                                  01740004
017500                                                                  01750004
017600*---------------------------------------------------------------* 01760004
017700*  XLRD013 - RECORD LAYOUT FOR PO DRIVER FILE, INPUT.             01770004
017800*---------------------------------------------------------------* 01780004
017900     COPY XLRD013.                                                01790004
018000                                                                  01800004
018100                                                                  01810004
018200*---------------------------------------------------------------* 01820004
018300*    DB2 AREA FOR TPLNSHP                                       * 01830004
018400*---------------------------------------------------------------* 01840004
018500     EXEC SQL                                                     01850004
018600          INCLUDE TPLNSHP                                         01860004
018700     END-EXEC.                                                    01870004
018800                                                                  01880004
018900*---------------------------------------------------------------* 01890004
019000*    DB2 AREA FOR COMMUNICATIONS                                * 01900004
019100*---------------------------------------------------------------* 01910004
019200     EXEC SQL                                                     01920004
019300          INCLUDE SQLCA                                           01930004
019400     END-EXEC.                                                    01940004
019500                                                                  01950004
019600                                                                  01960004
019700 PROCEDURE DIVISION.                                              01970004
019800********************                                              01980004
019900                                                                  01990004
020000 0000-PROGRAM-MAINLINE.                                           02000004
020100                                                                  02010004
020200     PERFORM 1000-INITIALIZE.                                     02020004
020300                                                                  02030004
020400     SET PS-IN-DRIVER-NOT-EOF TO TRUE.                            02040004
020500     PERFORM 2000-PROCESS-DRIVER-FILE                             02050004
020600         UNTIL PS-IN-DRIVER-EOF.                                  02060004
020700                                                                  02070004
020800     PERFORM 6000-EOJ-ROUTINE.                                    02080004
020900     STOP RUN.                                                    02090004
021000                                                                  02100004
021100                                                                  02110004
021200* ************************************************************** *02120004
021300* * INITIALIZATIONS                                            * *02130004
021400* ************************************************************** *02140004
021500                                                                  02150004
021600 1000-INITIALIZE.                                                 02160004
021700                                                                  02170004
021800     MOVE PC-CURRENT-PROGRAM-NAME TO DM-PROGRAM.                  02180004
021900     DISPLAY DM-DISPLAY-MESSAGE.                                  02190004
022000                                                                  02200004
022100     MOVE PC-BEGINNING              TO DP-STATUS-DESCRIPTION.     02210004
022200     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           02220004
022300                                                                  02230004
022400     PERFORM 9000-OPEN-IN-DRIVER-FILE.                            02240004
022500     PERFORM 9700-OPEN-OUT-EXTRACT-FILE.                          02250004
022510     PERFORM 9800-OPEN-OUT-ERROR-FILE.                            02250004
022600                                                                  02260004
022700                                                                  02270004
022800* ************************************************************** *02280004
022900* * READ DRIVER FILE                                           * *02290004
023000* * SELECT DATA FROM TPLNSHP BASED ON PO NUMBER FROM DRIVER    * *02300004
023100* * FILE                                                       * *02310004
023200* * WRITE DATA FROM TPLNSHP TO THE OUTPUT FILE                 * *02320004
023300* *        ROWS FOR THIS INPUT DRIVER RECORD                   * *02330004
023400* ************************************************************** *02340004
023500                                                                  02350004
023600 2000-PROCESS-DRIVER-FILE.                                        02360004
023700                                                                  02370004
023800     PERFORM 9050-READ-IN-DRIVER-FILE.                            02380004
023900                                                                  02390004
024000     IF  PS-IN-DRIVER-EOF                                         02400004
024100         CONTINUE                                                 02410004
024200     ELSE                                                         02420004
024300         MOVE XL013-PO-NBR TO         PV-PO-NBR-COMP              02430004
024400                                      PV-PO-NBR-NUM               02440004
024500         PERFORM 2100-CHECK-PGM-PROGRESS                          02450004
024600         INITIALIZE DCLTPLNSHP                                    02460004
024700         SET PS-TABLE-DATA-NOT-FOUND TO TRUE                      02470004
024800         PERFORM 9100-SELECT-TABLE                                02480004
024900         IF  PS-TABLE-DATA-NOT-FOUND                              02490004
025000             CONTINUE                                             02500004
025100         ELSE                                                     02510004
025200             PERFORM 9750-WRITE-EXTRACT-RECORD                    02520004
025300         END-IF                                                   02530004
025400     END-IF.                                                      02540004
025500                                                                  02550004
025600                                                                  02560004
025700* ************************************************************** *02570004
025800* *    EVERY NTH RECORD (IE: INITIAL SETTING 1000), REPORT     * *02580004
025900* *    RECORD COUNT AND CURRENT DATE/TIME.  THIS WILL ASSIST   * *02590004
026000* *    WITH RUN-TIME ESTIMATE OF TIME REMAINING TO COMPLETE.   * *02600004
026100* ************************************************************** *02610004
026200                                                                  02620004
026300 2100-CHECK-PGM-PROGRESS.                                         02630004
026400     DIVIDE    PV-IN-DRIVER-RECS-READ-CNT                         02640004
026500         BY        PC-HOW-OFTEN-TO-DISPLAY                        02650004
026600         GIVING    PV-DISPLAY-NTH-MULTIPLE                        02660004
026700         REMAINDER PV-DISPLAY-NTH-REMAINDER.                      02670004
026800                                                                  02680004
026900     IF PV-DISPLAY-NTH-REMAINDER = ZERO                           02690004
027000         MOVE PC-CONTINUING         TO DP-STATUS-DESCRIPTION      02700004
027100         PERFORM 6200-DISPLAY-PGM-PROGRESS                        02710004
027200     END-IF.                                                      02720004
027300                                                                  02730004
027400                                                                  02740004
027500* ************************************************************** *02750004
027600* * DISPLAY END OF RUN MESSAGE, CLOSE THE OUTPUT FILES         * *02760004
027700* ************************************************************** *02770004
027800                                                                  02780004
027900 6000-EOJ-ROUTINE.                                                02790004
028000                                                                  02800004
028100     PERFORM 9090-CLOSE-IN-DRIVER-FILE.                           02810004
028200     PERFORM 9790-CLOSE-OUT-EXTRACT-FILE.                         02820004
028300                                                                  02830004
028400     MOVE PC-ENDING                 TO DP-STATUS-DESCRIPTION.     02840004
028500     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           02850004
028600                                                                  02860004
028700                                                                  02870004
028800* ************************************************************** *02880004
028900* * DISPLAY PROGRAM PROGRESS.                                  * *02890004
029000* ************************************************************** *02900004
029100                                                                  02910004
029200 6200-DISPLAY-PGM-PROGRESS.                                       02920004
029300                                                                  02930004
029400     EXEC SQL                                                     02940004
029500          SET :PV-TMST = CURRENT TIMESTAMP                        02950004
029600     END-EXEC.                                                    02960004
029700                                                                  02970004
029800     MOVE PC-CURRENT-PROGRAM-NAME   TO DP-PROGRAM.                02980004
029900     MOVE PV-TIMESTAMP-19           TO DP-TIMESTAMP-19.           02990004
030000     MOVE PV-IN-DRIVER-RECS-READ-CNT                              03000004
030100                                    TO DP-IN-CNT.                 03010004
030200*    MOVE PV-RECS-WITH-MATCHES-CNT  TO DP-MATCHES-FOUND-CNT.      03020004
030300     MOVE PV-TABLE-ROW-SELECT-CNT   TO DP-ROWS-SELECTED-CNT.      03030004
030400     MOVE PV-EXTRACT-WRITTEN-CNT    TO DP-OUT-CNT.                03040004
030500                                                                  03050004
030600     DISPLAY DP-DISPLAY-PROGRESS-MSG.                             03060004
030700                                                                  03070004
030800                                                                  03080004
030900* ************************************************************** *03090004
031000* * OPEN  INPUT DRIVER FILE                                    * *03100004
031100* ************************************************************** *03110004
031200                                                                  03120004
031300 9000-OPEN-IN-DRIVER-FILE.                                        03130004
031400                                                                  03140004
031500     OPEN  INPUT  IN-DRIVER-FILE.                                 03150004
031600                                                                  03160004
031700                                                                  03170004
031800* ************************************************************** *03180004
031900* * READ  INPUT DRIVER FILE OF ELIGIBLE DATA TO EXTRACT        * *03190004
032000* ************************************************************** *03200004
032100                                                                  03210004
032200 9050-READ-IN-DRIVER-FILE.                                        03220004
032300                                                                  03230004
032400     READ IN-DRIVER-FILE                                          03240004
032500          INTO XL013-DRIVER-RECORD-LAYOUT                         03250004
032600          AT END                                                  03260004
032700              SET PS-IN-DRIVER-EOF TO TRUE.                       03270004
032800                                                                  03280004
032900     IF PS-IN-DRIVER-EOF                                          03290004
033000         CONTINUE                                                 03300004
033100     ELSE                                                         03310004
033200         ADD +1 TO PV-IN-DRIVER-RECS-READ-CNT                     03320004
033300     END-IF.                                                      03330004
033400                                                                  03340004
033500                                                                  03350004
033600* ************************************************************** *03360004
033700* * CLOSE INPUT DRIVER FILE                                    * *03370004
033800* ************************************************************** *03380004
033900                                                                  03390004
034000 9090-CLOSE-IN-DRIVER-FILE.                                       03400004
034100                                                                  03410004
034200     CLOSE IN-DRIVER-FILE.                                        03420004
034300                                                                  03430004
034400                                                                  03440004
034500* ************************************************************** *03450004
034600* * OPEN  TABLE CURSOR                                         * *03460004
034700* ************************************************************** *03470004
034800                                                                  03480004
034900 9100-SELECT-TABLE.                                               03490004
035000                                                                  03500004
035100     EXEC SQL                                                     03510004
035200           SELECT PO_NBR                                          03520004
035300                  SHIPT_NBR                                       03530004
035400                 ,VER_NBR                                         03540004
035500                 ,VER_STATUS_CDE                                  03550004
035600                 ,SHIPT_TYP_CDE                                   03560004
035700                 ,SHIPT_DEST_NBR                                  03570004
035800                 ,SHIPT_POINT_TXT                                 03580004
035900                 ,FOB_POINT_TXT                                   03590004
036000                 ,FRGT_PAYT_CDE                                   03600004
036100                 ,VEND_FRGT_PCT                                   03610004
036200                 ,KOHLS_FRGT_PCT                                  03620004
036300                 ,LATE_SHIPT_IND                                  03630004
036400                 ,EARLY_SHIPT_IND                                 03640004
036500                 ,PARTIAL_SHIPT_IND                               03650004
036600                 ,BCKORDS_PERMTD_IND                              03660004
036700                 ,PORT_ENTR_DESC                                  03670004
036800                 ,STRT_FCTRY_DTE                                  03680004
036900                 ,LAST_FCTRY_DTE                                  03690004
037000                 ,DONT_SHIP_BEF_DTE                               03700004
037100                 ,CAN_IFNOT_SHIP_DTE                              03710004
037200                 ,EXT_CAN_DTE                                     03720004
037210                 ,LAST_UPD_TMST                                   03721004
037220                 ,STATUS_CDE                                      03722004
037230                 ,ENT_ID                                          03723004
037240                 ,PO_NBR                                          03724004
037250                 ,LAST_UPD_BY_UID                                 03725004
037260                 ,FOB_CDE                                         03726004
037270                 ,POE_CDE                                         03727004
037300          INTO  :PLNSHP-SHIPT-NBR                                 03730004
037400               ,:PLNSHP-VER-NBR                                   03740004
037500               ,:PLNSHP-VER-STATUS-CDE                            03750004
037600               ,:PLNSHP-SHIPT-TYP-CDE                             03760004
037700               ,:PLNSHP-SHIPT-DEST-NBR                            03770004
037800               ,:PLNSHP-SHIPT-POINT-TXT                           03780004
037900               ,:PLNSHP-FOB-POINT-TXT                             03790004
038000               ,:PLNSHP-FRGT-PAYT-CDE                             03800004
038100               ,:PLNSHP-VEND-FRGT-PCT                             03810004
038200               ,:PLNSHP-KOHLS-FRGT-PCT                            03820004
038300               ,:PLNSHP-LATE-SHIPT-IND                            03830004
038400               ,:PLNSHP-EARLY-SHIPT-IND                           03840004
038500               ,:PLNSHP-PARTIAL-SHIPT-IND                         03850004
038600               ,:PLNSHP-BCKORDS-PERMTD-IND                        03860004
038700               ,:PLNSHP-PORT-ENTR-DESC                            03870004
038800               ,:PLNSHP-STRT-FCTRY-DTE                            03880004
038900               ,:PLNSHP-LAST-FCTRY-DTE                            03890004
039000               ,:PLNSHP-DONT-SHIP-BEF-DTE                         03900004
039100               ,:PLNSHP-CAN-IFNOT-SHIP-DTE                        03910004
039200               ,:PLNSHP-EXT-CAN-DTE                               03920004
039300               ,:PLNSHP-LAST-UPD-TMST                             03930004
039310               ,:PLNSHP-STATUS-CDE                                03931004
039320               ,:PLNSHP-ENT-ID                                    03932004
039330               ,:PLNSHP-PO-NBR                                    03933004
039340               ,:PLNSHP-LAST-UPD-BY-UID                           03934004
039350               ,:PLNSHP-FOB-CDE :PV-NULL-IND-1                    03935004
039360               ,:PLNSHP-POE-CDE :PV-NULL-IND-2                    03936004
039400           FROM   TPLNSHP                                         03940004
039500          WHERE  PO_NBR = :PV-PO-NBR-COMP                         03950004
039600            AND  VER_STATUS_CDE = 'A'                             03960004
039700           WITH  UR                                               03970004
039800     END-EXEC.                                                    03980004
039900                                                                  03990004
040000     EVALUATE TRUE                                                04000004
040100         WHEN SQLCODE = ZERO                                      04010004
040200              ADD +1                  TO PV-TABLE-ROW-SELECT-CNT  04020004
040300              SET PS-TABLE-DATA-FOUND TO TRUE                     04030004
040200              IF PV-NULL-IND-1 < 0                                        
040300                  MOVE SPACES TO PLNSHP-FOB-CDE                   04030004
040200              END-IF                                                      
040200              IF PV-NULL-IND-2 < 0                                        
040300                  MOVE SPACES TO PLNSHP-POE-CDE                   04030004
040200              END-IF                                                      
      **GB 06/28/14                                                             
                    IF PLNSHP-EXT-CAN-DTE  >  PC-DEFAULT-DATE                   
                       MOVE PLNSHP-EXT-CAN-DTE TO                               
                                    PLNSHP-CAN-IFNOT-SHIP-DTE                   
                    END-IF                                                      
      **GB 06/28/14                                                             
040400         WHEN SQLCODE = +100                                      04040004
040500              CONTINUE                                            04050004
040600         WHEN SQLWARN0 NOT EQUAL SPACE                            04060004
040700         WHEN SQLCODE NOT EQUAL ZERO                              04070004
040800              MOVE '9100-SELECT-TABLE'                            04080004
040900                                 TO PV-PARAGRAPH-NAME             04090004
041000              MOVE 'SELECT DATA'                                  04100004
041100                                 TO PV-DB2-OPERATION-MSG-1        04110004
041200              MOVE 'TPLNSHP'     TO PV-DB2-TABLE-NAME             04120004
041300              PERFORM 9999-DB2-ABEND                              04130004
041400     END-EVALUATE.                                                04140004
041500                                                                  04150004
041600                                                                  04160004
041700                                                                  04170004
041800* ************************************************************** *04180004
041900* * OPEN OUTPUT EXTRACT FILE                                   * *04190004
042000* ************************************************************** *04200004
042100                                                                  04210004
042200 9700-OPEN-OUT-EXTRACT-FILE.                                      04220004
042300                                                                  04230004
042400     OPEN OUTPUT OUT-EXTRACT-FILE.                                04240004
042500                                                                  04250004
042600                                                                  04260004
042700* ************************************************************** *04270004
042800* * WRITE A RECORD TO THE TABLE EXTRACT FILE                   * *04280004
042900* ************************************************************** *04290004
043000                                                                  04300004
043100 9750-WRITE-EXTRACT-RECORD.                                       04310004
043200                                                                  04320004
043300     WRITE  OUT-EXTRACT-RECORD  FROM  DCLTPLNSHP.                 04330004
043400     ADD +1 TO PV-EXTRACT-WRITTEN-CNT.                            04340004
043500                                                                  04350004
043600                                                                  04360004
043700* ************************************************************** *04370004
043800* * CLOSE OUTPUT EXTRACT FILE                                  * *04380004
043900* ************************************************************** *04390004
044000                                                                  04400004
044100 9790-CLOSE-OUT-EXTRACT-FILE.                                     04410004
044200                                                                  04420004
044300     CLOSE OUT-EXTRACT-FILE.                                      04430004
044400                                                                  04440004
044410                                                                  04830002
044420* ************************************************************** *04840002
044430* * OPEN OUTPUT ERROR FILE                                     * *04850002
044440* ************************************************************** *04860002
044450                                                                  04870002
044460 9800-OPEN-OUT-ERROR-FILE.                                        04880002
044470                                                                  04890002
044480     OPEN OUTPUT OUT-ERROR-FILE.                                  04900002
044490                                                                  04910002
044491                                                                  04920002
044492* ************************************************************** *04930002
044493* * WRITE A RECORD TO THE TABLE ERROR FILE                     * *04940002
044494* ************************************************************** *04950002
044495                                                                  04960002
044496 9850-WRITE-ERROR-RECORD.                                         04970002
044497                                                                  04980002
044498     WRITE  OUT-ERROR-RECORD    FROM  PV-ERROR-RECORD.            04990002
044499     ADD +1 TO PV-ERROR-WRITTEN-CNT.                              05000002
044500                                                                  05010002
044510                                                                  05020002
044520* ************************************************************** *05030002
044530* * CLOSE OUTPUT ERROR FILE                                    * *05040002
044540* ************************************************************** *05050002
044550                                                                  05060002
044560 9890-CLOSE-OUT-ERROR-FILE.                                       05070002
044570                                                                  05080002
044580     CLOSE OUT-ERROR-FILE.                                        05090002
044590                                                                  05100002
044591                                                                  05110002
044592* ************************************************************** *05120002
044593* * DISPLAY INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT *05130002
044594* * AND CALL THE ABEND PROCESSOR IN THE EVENT THAT AN          * *05140002
044595* * SQL ERROR OR WARNING CODE OCCURS.                          * *05150002
044596* ************************************************************** *05160002
044597                                                                  05170002
044598 9999-DB2-ABEND.                                                  05180002
044599                                                                  05190002
044600     MOVE SQLCODE TO PV-SQLCODE.                                        02
044610     STRING  'PROGRAM - '    PC-CURRENT-PROGRAM-NAME                    02
044620             ' PARAGRAPH - ' PV-PARAGRAPH-NAME                          02
044630             ' TABLE - '     PV-DB2-TABLE-NAME                          02
044640             ' OPERATION - ' PV-DB2-OPERATION-MSG-1 (1:30)              02
044650             ' SQLCODE --- ' PV-SQLCODE                                 02
044660             ' PO NBR ---- ' PV-PO-NBR-NUM                              04
044670             DELIMITED BY SIZE                                            
044680             INTO PV-ERROR-RECORD.                                        
044690                                                                        03
044691     PERFORM 9850-WRITE-ERROR-RECORD.                                     
044692                                                                        02
044700                                                                  04450004
