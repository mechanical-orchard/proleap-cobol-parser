000100*----------------------------------------------------------       00010061
000200 IDENTIFICATION DIVISION.                                         00020061
000300*----------------------------------------------------------       00030061
000400 PROGRAM-ID.    EPKUT101.                                         00040061
000500 AUTHOR.        ALEXIS KEIKER.                                    00050061
000600 DATE-WRITTEN.  DECEMBER 10, 2002.                                00060061
000700                                                                  00070061
000800*----------------------------------------------------------       00080061
000900*            PROMO CONTROL CARD POPULATOR                         00090074
001000*----------------------------------------------------------       00100061
001100* THIS PROGRAM UPDATES FOUR CONTROL CARDS.  IT UPDATES            00110098
001101* EPCC101, EPCC102, EPCC107, AND EPCC113.  IT READS IN CONTROL    00110192
001102* CARDS EPCC111 AND EPCC107 AND SAVES THOSE VALUES.  IT USES      00110292
001103* THE DATE IN EPCC111 TO GET THE FUTURE DATE FOR EPCC107.  THE    00110392
001104* CONTENTS IN EPCC107 IS THEN SAVED AND USED TO REPLACE THE       00110476
001105* THE DATE IN EPCC101.  THIS PROGRAM ALSO GETS A CURRENT          00110576
001106* TIMESTAMP AND LOADS IT INTO EPCC102.  IT ALSO UPDATES           00110692
001107* CONTROL CARD EPCC113 BY ADDING +1 TO THE DATE THAT WAS PUT      00110792
001108* IN CONTROL CARD EPCC107.                                        00110892
001110*----------------------------------------------------------       00111061
001120* HISTORY LOG:                                                    00112061
001130*                                                                 00113061
001131*----------------------------------------------------------       00113161
001132* DATE:                                                           00113261
001133* WR/IR#:                                                         00113361
001134* PROGRAMMER:                                                     00113461
001135* DESCRIPTION:                                                    00113561
001136*                                                                 00113661
001137*----------------------------------------------------------       00113761
001138 ENVIRONMENT DIVISION.                                            00113861
001139*----------------------------------------------------------       00113961
001140 CONFIGURATION SECTION.                                           00114061
001150 SOURCE-COMPUTER. IBM-3090.                                       00115061
001160 OBJECT-COMPUTER. IBM-3090.                                       00116061
001170                                                                  00117061
001180 INPUT-OUTPUT SECTION.                                            00118061
001190                                                                  00119061
001200 FILE-CONTROL.                                                    00120061
001300                                                                  00130061
001310     SELECT CC-BATCH-DTE-FILE                                     00131068
001320       ASSIGN TO INP01.                                           00132066
001330                                                                  00133066
001331     SELECT CC-FUT-OFFSET-FILE                                    00133181
001332       ASSIGN TO UPD01.                                           00133282
001333                                                                  00133382
001334     SELECT CC-LAST-OFFSET-FILE                                   00133475
001335       ASSIGN TO UPD02.                                           00133578
001336                                                                  00133675
001400     SELECT CC-TIMESTAMP-FILE                                     00140068
001410       ASSIGN TO UPD03.                                           00141075
001450                                                                  00145061
001451     SELECT CC-CORR-FUT-FILE                                      00145191
001452       ASSIGN TO UPD04.                                           00145291
001453                                                                  00145391
001460*----------------------------------------------------------       00146061
001470 DATA DIVISION.                                                   00147061
001480*----------------------------------------------------------       00148061
001490 FILE SECTION.                                                    00149061
001500                                                                  00150061
001501 FD  CC-BATCH-DTE-FILE                                            00150168
001502     RECORDING MODE IS F                                          00150266
001503     LABEL RECORDS ARE STANDARD                                   00150366
001504     RECORD CONTAINS 80 CHARACTERS                                00150466
001505     DATA RECORD IS CC-BATCH-DTE-RECORD.                          00150568
001506                                                                  00150666
001507 01  CC-BATCH-DTE-RECORD          PIC X(80).                      00150768
001508                                                                  00150866
001509 FD  CC-LAST-OFFSET-FILE                                          00150975
001510     RECORDING MODE IS F                                          00151075
001511     LABEL RECORDS ARE STANDARD                                   00151175
001512     RECORD CONTAINS 80 CHARACTERS                                00151275
001513     DATA RECORD IS CC-LAST-OFFSET-RECORD.                        00151375
001514                                                                  00151475
001515 01  CC-LAST-OFFSET-RECORD        PIC X(80).                      00151575
001516                                                                  00151675
001517 FD  CC-FUT-OFFSET-FILE                                           00151768
001520     RECORDING MODE IS F                                          00152066
001530     LABEL RECORDS ARE STANDARD                                   00153066
001540     RECORD CONTAINS 80 CHARACTERS                                00154075
001550     DATA RECORD IS CC-FUT-OFFSET-RECORD.                         00155068
001560                                                                  00156066
001570 01  CC-FUT-OFFSET-RECORD         PIC X(80).                      00157075
001580                                                                  00158066
001960 FD  CC-TIMESTAMP-FILE                                            00196068
001970     RECORDING MODE IS F                                          00197061
001980     LABEL RECORDS ARE STANDARD                                   00198061
001990     RECORD CONTAINS 80 CHARACTERS                                00199062
001991     DATA RECORD IS CC-TIMESTAMP-RECORD.                          00199168
001992                                                                  00199261
001993 01  CC-TIMESTAMP-RECORD          PIC X(80).                      00199368
001994                                                                  00199461
001995 FD  CC-CORR-FUT-FILE                                             00199591
001996     RECORDING MODE IS F                                          00199691
001997     LABEL RECORDS ARE STANDARD                                   00199791
001998     RECORD CONTAINS 80 CHARACTERS                                00199891
001999     DATA RECORD IS CC-CORR-FUT-RECORD.                           00199991
002000                                                                  00200091
002001 01  CC-CORR-FUT-RECORD           PIC X(80).                      00200191
002002                                                                  00200291
002003                                                                  00200361
002004*---------------------------------------------------------        00200461
002005                                                                  00200561
002006 WORKING-STORAGE SECTION.                                         00200661
002007                                                                  00200761
002010 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      00201061
002100                                                  COMP SYNC.      00210061
002200     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    00220061
002300     88  AC-DB2-ERROR                             VALUE +4013.    00230061
002310     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00231061
002320                                                                  00232061
002330*---------------------------------------------------------        00233061
002340* PC- PROGRAM CONSTANTS                                           00234061
002350*----------------------------------------------------------       00235061
002360 01  PC-PROGRAM-CONSTANTS.                                        00236061
002370     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'EPKUT101'. 00237062
002380     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00238071
002390     05  PC-ONE-DAY-AHEAD             PIC X(05) VALUE '00001'.    00239091
002400                                                                  00240061
002500*----------------------------------------------------------       00250061
002600* PS- PROGRAM SWITCHES                                            00260061
002700*----------------------------------------------------------       00270061
002800 01  PS-PROGRAM-SWITCHES.                                         00280061
002900     05  PS-END-OF-FILE-SW            PIC X(01)  VALUE 'N'.       00290061
003000         88  PS-END-OF-FILE                      VALUE 'Y'.       00300061
003100         88  PS-NOT-END-OF-FILE                  VALUE 'N'.       00310061
003200                                                                  00320061
003300*----------------------------------------------------------       00330061
003400* PV- PROGRAM VARIABLES                                           00340061
003500*----------------------------------------------------------       00350061
003600 01 PV-PROGRAM-VARIABLES.                                         00360061
003700    05  PV-PARAGRAPH-NAME             PIC X(30) VALUE SPACES.     00370068
003800    05  PV-OPERATION-MSG-1            PIC X(40) VALUE SPACES.     00380068
003900    05  PV-OPERATION-MSG-2            PIC X(40) VALUE SPACES.     00390068
003901    05  PV-DB2-OPERATION              PIC X(30) VALUE SPACE.      00390172
003902    05  PV-SQL-SUB                    PIC S9(4) VALUE +0 COMP.    00390271
003903    05  PV-BATCH-OFFSET-DTE           PIC X(10) VALUE SPACES.     00390393
003904    05  PV-CORR-FUT-DTE               PIC X(10) VALUE SPACES.     00390493
003905    05  PV-FUTURE-OFFSET-DTE          PIC X(10) VALUE SPACES.     00390593
003915    05  PV-FUT-OFFST-NBR              PIC S9(05) VALUE +0.        00391571
003916    05  PV-SAVE-FUT-OFFST-NBR         PIC 9(02) VALUE 0.          00391671
003917    05  PV-SAVE-DAYS-AHEAD            PIC X(05) VALUE SPACES.     00391771
003918    05  PV-SAVE-LAST-NBR              PIC X(02) VALUE SPACES.     00391868
003919    05  PV-SAVE-LAST-DTE              PIC X(10) VALUE SPACES.     00391993
003920    05  PV-SAVE-DATE                  PIC X(10) VALUE SPACES.     00392093
004000    05  PV-SAVE-CCYY-MM-DD            PIC X(10) VALUE SPACES.     00400093
004240    05  PV-TIMESTAMP                  PIC X(26) VALUE SPACES.     00424069
004300                                                                  00430061
004400*----------------------------------------------------------       00440066
004500* CONTROL CARD EPCC111 LAYOUT                                     00450085
004600*----------------------------------------------------------       00460066
004700     COPY EPRD111.                                                00470090
004800                                                                  00480066
004900*----------------------------------------------------------       00490066
005000* CONTROL CARD EPCC101 LAYOUT                                     00500073
005100*----------------------------------------------------------       00510066
005200     COPY EPRD101.                                                00520086
005300                                                                  00530066
005400*----------------------------------------------------------       00540066
005500* CONTROL CARD EPCC102 LAYOUT                                     00550073
005600*----------------------------------------------------------       00560066
005700     COPY EPRD102.                                                00570088
005800                                                                  00580066
005810*----------------------------------------------------------       00581075
005820* CONTROL CARD EPCC107 LAYOUT                                     00582075
005830*----------------------------------------------------------       00583075
005840     COPY EPRD107.                                                00584087
005850                                                                  00585075
005860*----------------------------------------------------------       00586091
005870* CONTROL CARD EPCC113 LAYOUT                                     00587091
005880*----------------------------------------------------------       00588091
005890     COPY EPRD113.                                                00589091
005891                                                                  00589191
005900*----------------------------------------------------------       00590069
006000* DATE ROUTINE COPY MEMBERS                                       00600069
006100*----------------------------------------------------------       00610069
006200     COPY DPWS500.                                                00620069
006300                                                                  00630069
006400*-----------------------------------------------------------      00640069
006500* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         00650069
006600*-----------------------------------------------------------      00660069
006700     COPY DPWS004.                                                00670069
006800                                                                  00680069
006810*-----------------------------------------------------------      00681069
006820* DB2 ABEND COPYBOOK                                              00682069
006830*-----------------------------------------------------------      00683069
006840     COPY DPWS900.                                                00684069
006850                                                                  00685069
006860*-----------------------------------------------------------      00686069
006870* DB2 MESSAGE AREA                                                00687069
006880*-----------------------------------------------------------      00688069
006890     COPY SQLCA2.                                                 00689069
006891                                                                  00689169
006892*-----------------------------------------------------------      00689269
006893* DB2 COMMUNICATIONS AREA                                         00689369
006894*-----------------------------------------------------------      00689469
006895     EXEC SQL                                                     00689569
006896          INCLUDE SQLCA                                           00689669
006897     END-EXEC.                                                    00689769
006898                                                                  00689869
006899*-----------------------------------------------------------      00689969
006900* DB2 TABLE XST00037(XST_INFC_CNTL) - PROMO INTERFACE CONTROL     00690069
006901*                                             TABLE               00690169
006902*-----------------------------------------------------------      00690269
006903     EXEC SQL                                                     00690369
006904          INCLUDE XST00037                                        00690469
006905     END-EXEC.                                                    00690569
006906                                                                  00690669
006910*----------------------------------------------------------       00691061
007000 PROCEDURE DIVISION.                                              00700061
007100*----------------------------------------------------------       00710061
007200 0000-MAINLINE.                                                   00720061
007300                                                                  00730061
007400     PERFORM 1000-INITIALIZATION.                                 00740061
007500                                                                  00750061
007600     PERFORM 2000-PROCESS-CNTL-CARDS.                             00760066
007800                                                                  00780061
007900     PERFORM 9999-WRAPUP.                                         00790061
008000                                                                  00800061
008100     GOBACK.                                                      00810061
008200                                                                  00820061
008300*0000-EXIT.                                                       00830061
008400 EJECT.                                                           00840061
008500                                                                  00850061
008600*----------------------------------------------------------       00860061
008700* 1000-INITIALIZATION.                                            00870061
008800*     INTIALIZES VARIABLES, OPENS ANY FILES, AND READS            00880061
008900*     THE INPUT FILES, SAVES VARIABLES, AND CLOSES THE INPUT      00890073
008910*     FILES.                                                      00891073
009000*----------------------------------------------------------       00900061
009100 1000-INITIALIZATION.                                             00910061
009200                                                                  00920061
009201     INITIALIZE EP111-CC-CONTROL-CARD                             00920185
009204                EP107-CC-CONTROL-CARD.                            00920487
009205                                                                  00920568
009210     OPEN INPUT CC-BATCH-DTE-FILE                                 00921068
009300                CC-FUT-OFFSET-FILE.                               00930068
009500                                                                  00950061
009800     PERFORM 1100-READ-BATCH-DTE-CARD.                            00980068
009810     PERFORM 1200-READ-FUT-OFFSET-CARD.                           00981068
009820                                                                  00982066
009821     IF EP111-CC-CRNT-DTE = SPACES                                00982194
009824        DISPLAY 'EMPTY CONTROL CARD'                              00982468
009825        DISPLAY 'BATCH DATE: ' EP111-CC-CRNT-DTE                  00982594
009828        MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME           00982868
009829        MOVE 'CONTROL CARD IS EMPTY' TO PV-OPERATION-MSG-1        00982968
009830        SET AC-CONTROL-CARD-ERROR TO TRUE                         00983072
009831        PERFORM 9000-ABEND                                        00983168
009832     END-IF.                                                      00983268
009833                                                                  00983368
009835     MOVE EP111-CC-CRNT-DTE      TO PV-SAVE-DATE.                 00983593
009836     MOVE EP107-CC-CRNT-NBR      TO PV-SAVE-LAST-NBR.             00983693
009840     MOVE EP107-CC-CRNT-DTE      TO PV-SAVE-LAST-DTE.             00984093
009900                                                                  00990061
009910     CLOSE CC-BATCH-DTE-FILE                                      00991068
009920           CC-FUT-OFFSET-FILE.                                    00992068
009930                                                                  00993066
010000*1000-EXIT.                                                       01000061
010100 EJECT.                                                           01010061
010200                                                                  01020061
010210*----------------------------------------------------------       01021068
010220* 1100-READ-BATCH-DTE-CARD.                                       01022068
010230*     READS IN THE CURRENT SYSTEM BATCH DATE(EPCC111)             01023085
010231*     CONTROL CARD.                                               01023168
010240*----------------------------------------------------------       01024068
010250 1100-READ-BATCH-DTE-CARD.                                        01025068
010260                                                                  01026068
010270     READ CC-BATCH-DTE-FILE                                       01027068
010280         INTO EP111-CC-CONTROL-CARD                               01028085
010292     END-READ.                                                    01029268
010293                                                                  01029368
010294*1100-EXIT.                                                       01029468
010295 EJECT.                                                           01029568
010296                                                                  01029668
010297*----------------------------------------------------------       01029768
010298* 1200-READ-FUT-OFFSET-CARD.                                      01029868
010299*     READS IN THE FUTURE OFFSET(EPCC107) CONTROL CARD.           01029975
010301*----------------------------------------------------------       01030168
010302 1200-READ-FUT-OFFSET-CARD.                                       01030268
010303                                                                  01030368
010304     READ CC-FUT-OFFSET-FILE                                      01030468
010305         INTO EP107-CC-CONTROL-CARD                               01030587
010307     END-READ.                                                    01030768
010308                                                                  01030868
010309*1200-EXIT.                                                       01030968
010310 EJECT.                                                           01031068
010311                                                                  01031168
010320*----------------------------------------------------------       01032061
010400* 2000-PROCESS-CNTL-CARDS.                                        01040068
010500*     UPDATES EPCC101, EPCC102, EPCC107, AND EPCC113              01050092
010600*     CONTROL CARDS FOR PROCESSING.                               01060092
010900*----------------------------------------------------------       01090061
011000 2000-PROCESS-CNTL-CARDS.                                         01100068
011100                                                                  01110061
011200     INITIALIZE EP101-CC-CONTROL-CARD                             01120086
011300                EP102-CC-CONTROL-CARD                             01130088
011310                EP107-CC-CONTROL-CARD                             01131091
011320                EP113-CC-CONTROL-CARD.                            01132091
011400                                                                  01140069
011500     SET EP101-CC-VALID-LAST-NBR-NM  TO TRUE.                     01150086
011510     SET EP101-CC-VALID-LATE-DTE-NM  TO TRUE.                     01151086
011520     SET EP107-CC-VALID-CRNT-NBR-NM  TO TRUE.                     01152087
011530     SET EP107-CC-VALID-CRNT-DTE-NM  TO TRUE.                     01153087
011540     SET EP102-CC-VALID-CONTROL-NAME TO TRUE.                     01154088
011550     SET EP113-CC-VALID-CRNT-DTE-NM  TO TRUE.                     01155091
011600                                                                  01160066
011601     MOVE PV-SAVE-DATE          TO PV-SAVE-CCYY-MM-DD.            01160193
011610     PERFORM 2100-SELECT-FUT-OFFSET-NBR.                          01161069
011611     PERFORM 2200-FUTURE-OFFSET-DTE.                              01161172
011613     MOVE PV-FUTURE-OFFSET-DTE  TO PV-BATCH-OFFSET-DTE.           01161393
011620     MOVE PV-FUT-OFFST-NBR      TO PV-SAVE-FUT-OFFST-NBR.         01162096
011630                                                                  01163066
011640     MOVE PC-ONE-DAY-AHEAD      TO PV-SAVE-DAYS-AHEAD.            01164093
011650     MOVE PV-BATCH-OFFSET-DTE   TO PV-SAVE-CCYY-MM-DD.            01165095
011660     PERFORM 2200-FUTURE-OFFSET-DTE.                              01166091
011680     MOVE PV-FUTURE-OFFSET-DTE  TO PV-CORR-FUT-DTE.               01168093
011690                                                                  01169091
011700     PERFORM 2300-SELECT-DB2-TIMESTAMP.                           01170091
011800                                                                  01180061
011900     PERFORM 2400-UPDATE-CNTL-CARDS.                              01190091
012700                                                                  01270061
012800*2000-EXIT.                                                       01280061
012900 EJECT.                                                           01290061
013000                                                                  01300061
013044*------------------------------------------------------           01304468
013045* 2100-SELECT-FUT-OFFSET-NBR.                                     01304569
013046*     SELECT THE FUTURE DAY OFFSET NUMBER FROM THE                01304668
013047*     XST_INTFC_CNTL TABLE.                                       01304768
013050*------------------------------------------------------           01305068
013060 2100-SELECT-FUT-OFFSET-NBR.                                      01306069
013070                                                                  01307068
013080     PERFORM                                                      01308068
013090         WITH TEST AFTER                                          01309068
013091         VARYING PV-SQL-SUB                                       01309168
013092         FROM 1 BY 1                                              01309268
013093         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 01309368
013094                   OR  SQLCODE = 0)                               01309468
013095                                                                  01309568
013096         EXEC SQL                                                 01309668
013097             SELECT  FUT_DAY_OFFST_NBR                            01309799
013098               INTO :XST00037-FUT-DAY-OFFST-NBR                   01309868
013099               FROM  XST_INTFC_CNTL                               01309968
                    WHERE APLSYS_CDE = 'EP'                             01310099
013100               WITH UR                                            01310168
013101         END-EXEC                                                 01310268
013102                                                                  01310368
013103         EVALUATE TRUE                                            01310468
013104             WHEN SQLCODE = -904                                  01310568
013105             WHEN SQLCODE = -911                                  01310668
013106             WHEN SQLCODE = -913                                  01310768
013107                  CONTINUE                                        01310868
013108             WHEN SQLCODE = 0                                     01310968
013109                  MOVE XST00037-FUT-DAY-OFFST-NBR TO              01311068
013110                                     PV-FUT-OFFST-NBR             01311168
013111                  MOVE PV-FUT-OFFST-NBR TO PV-SAVE-DAYS-AHEAD     01311268
013112             WHEN OTHER                                           01311368
013113                  MOVE '2100-SELECT-FUT-OFFSET-NBR'               01311471
013114                                TO  PV-PARAGRAPH-NAME             01311568
013115                  MOVE 'SELECT MAX OFFSET NBR'                    01311668
013116                                TO  PV-DB2-OPERATION              01311768
013117                  PERFORM 9100-SQL-ABEND                          01311871
013118         END-EVALUATE                                             01311968
013119     END-PERFORM.                                                 01312068
013120                                                                  01312168
013121     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         01312268
013122        MOVE '2100-SELECT-FUT-OFFSET-NBR'                         01312371
013123                              TO  PV-PARAGRAPH-NAME               01312468
013124        MOVE 'SELECT RETRIES EXCEEDED'                            01312568
013125                              TO  PV-DB2-OPERATION                01312668
013126        PERFORM 9100-SQL-ABEND                                    01312771
013127     END-IF.                                                      01312868
013128                                                                  01312968
013129*2100-EXIT.                                                       01313068
013130 EJECT.                                                           01313168
013131                                                                  01313268
013132*----------------------------------------------------------       01313369
013133* 2200-FUTURE-OFFSET-DTE.                                         01313469
013134*     GETS THE FUTURE OFFSET DATE BASED ON THE NUMBER FOUND       01313569
013135*     IN THE XST_INTFC_CNTL TABLE OR THE NUMBER PASSED TO         01313692
013136*     THIS PROCEDURE.                                             01313792
013137*----------------------------------------------------------       01313869
013138 2200-FUTURE-OFFSET-DTE.                                          01313969
013139                                                                  01314069
013140     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              01314169
013141     MOVE PV-SAVE-CCYY-MM-DD           TO DPG52-LK-DATE-INPUT.    01314269
013142     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   01314369
013143     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   01314469
013144     SET  DPG51-INCREMENT-DATE         TO TRUE.                   01314569
013145     MOVE PV-SAVE-DAYS-AHEAD           TO DPG51-INCR-DECR-DAYS-X. 01314669
013146                                                                  01314769
013147     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    01314869
013148                                             DPG54 DPG55 DPG56.   01314969
013149     EVALUATE TRUE                                                01315069
013150         WHEN DPG54-NO-ERROR                                      01315169
013151             DISPLAY 'DAYS AHEAD NEEDED: ' PV-SAVE-DAYS-AHEAD     01315269
013152             DISPLAY 'RETRIEVING FUTURE OFFSET DATE'              01315369
013153         WHEN DPG54-SEVERE-ERROR                                  01315469
013154             DISPLAY ' '                                          01315569
013155             DISPLAY '** ABEND ** IN XSKUT034'                    01315669
013156             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE'    01315769
013157             DISPLAY '** CALLED BY 2200-FUTURE-OFFSET-DTE'        01315871
013158             DISPLAY '** ERROR MESSAGE = '                        01315969
013159                               DPG54-ERROR-MESSAGE                01316069
013160             DISPLAY '** DPG51 = ' DPG51                          01316169
013161             DISPLAY '** DPG52 = ' DPG52                          01316269
013162             DISPLAY '** DPG53 = ' DPG53                          01316369
013163             DISPLAY '** DPG54 = ' DPG54                          01316469
013164             DISPLAY '** DPG55 = ' DPG55                          01316569
013165             DISPLAY '** DPG56 = ' DPG56                          01316669
013166             MOVE '2200-FUTURE-OFFSET-DTE'                        01316771
013167                                           TO PV-PARAGRAPH-NAME   01316869
013168             MOVE 'ERROR VALIDATING INPUT DATE'                   01316969
013169                                           TO PV-OPERATION-MSG-1  01317069
013170             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                01317171
013171             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  01317269
013172             PERFORM 9000-ABEND                                   01317371
013173     END-EVALUATE.                                                01317469
013174                                                                  01317569
013175     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-FUTURE-OFFSET-DTE.         01317669
013176     DISPLAY 'NEW FUTURE OFFSET DATE: ' PV-FUTURE-OFFSET-DTE.     01317769
013177                                                                  01317869
013178*2200-EXIT.                                                       01317969
013179 EJECT.                                                           01318069
013180                                                                  01318169
013181*----------------------------------------------------------       01318271
013182* 2300-SELECT-DB2-TIMESTAMP.                                      01318391
013183*     RETRIEVE TIMESTAMP FROM DB2.                                01318469
013184*----------------------------------------------------------       01318571
013185 2300-SELECT-DB2-TIMESTAMP.                                       01318691
013186                                                                  01318769
013187     EXEC SQL                                                     01318869
013188          SELECT CURRENT TIMESTAMP                                01318969
013189          INTO  :PV-TIMESTAMP                                     01319069
013190          FROM   SYSIBM.SYSDUMMY1                                 01319169
013191     END-EXEC.                                                    01319269
013192                                                                  01319369
013193     IF SQLCODE NOT EQUAL ZERO                                    01319469
013194        MOVE '2300-SELECT-DB2-TIME' TO PV-PARAGRAPH-NAME          01319591
013195        MOVE 'CANNOT GET CURRENT TIMESTAMP'                       01319671
013196                                      TO PV-DB2-OPERATION         01319771
013200        PERFORM 9100-SQL-ABEND                                    01320071
013300     END-IF.                                                      01330069
013400                                                                  01340069
013410*2300-EXIT.                                                       01341091
013500 EJECT.                                                           01350069
013600                                                                  01360069
013700*----------------------------------------------------------       01370071
013800* 2400-UPDATE-CNTL-CARDS.                                         01380091
013900*     UPDATES CONTROL CARDS EPCC101, EPCC102, EPCC107, AND        01390092
014000*     EPCC113.                                                    01400092
014100*----------------------------------------------------------       01410071
014200 2400-UPDATE-CNTL-CARDS.                                          01420091
014210                                                                  01421071
014211     MOVE PV-BATCH-OFFSET-DTE     TO EP107-CC-CRNT-DTE.           01421191
014212     MOVE PV-SAVE-FUT-OFFST-NBR   TO EP107-CC-CRNT-NBR.           01421287
014213     MOVE PV-SAVE-LAST-NBR        TO EP101-CC-LAST-NBR.           01421386
014214     MOVE PV-SAVE-LAST-DTE        TO EP101-CC-LAST-DTE.           01421486
014215     MOVE PV-CORR-FUT-DTE         TO EP113-CC-CRNT-DTE.           01421591
014217     MOVE PV-TIMESTAMP            TO EP102-CC-TIMESTAMP.          01421788
014218                                                                  01421871
014219     OPEN OUTPUT CC-LAST-OFFSET-FILE.                             01421984
014223     PERFORM 8000-WRITE-LAST-OFFSET-CARD.                         01422375
014224     CLOSE CC-LAST-OFFSET-FILE.                                   01422484
014225                                                                  01422584
014226     OPEN OUTPUT CC-FUT-OFFSET-FILE.                              01422684
014227     PERFORM 8100-WRITE-FUT-OFFSET-CARD.                          01422780
014228     CLOSE CC-FUT-OFFSET-FILE.                                    01422884
014229                                                                  01422984
014230     OPEN OUTPUT CC-TIMESTAMP-FILE.                               01423084
014231     PERFORM 8200-WRITE-TIMESTAMP-CARD.                           01423175
014232     CLOSE CC-TIMESTAMP-FILE.                                     01423284
014233                                                                  01423371
014234     OPEN OUTPUT CC-CORR-FUT-FILE.                                01423491
014235     PERFORM 8300-WRITE-CORR-DTE-CARD.                            01423591
014236     CLOSE CC-CORR-FUT-FILE.                                      01423691
014237                                                                  01423791
014238*2400-EXIT.                                                       01423891
014239 EJECT.                                                           01423971
014240                                                                  01424071
014241*----------------------------------------------------------       01424175
014242* 8000-WRITE-LAST-OFFSET-CARD.                                    01424275
014243*     WRITES LAST OFFSET CONTROL CARD RECORD TO EPCC101 CONTROL   01424375
014244*     CARD.                                                       01424475
014245*----------------------------------------------------------       01424575
014246 8000-WRITE-LAST-OFFSET-CARD.                                     01424675
014247                                                                  01424775
014248     WRITE CC-LAST-OFFSET-RECORD                                  01424875
014249         FROM EP101-CC-CONTROL-CARD.                              01424986
014250                                                                  01425075
014251*8000-EXIT.                                                       01425175
014252 EJECT.                                                           01425275
014253                                                                  01425375
014254*----------------------------------------------------------       01425466
014255* 8100-WRITE-FUT-OFFSET-CARD.                                     01425575
014256*     WRITES FUTURE OFFSET CONTROL CARD RECORD TO EPCC107 CONTROL 01425675
014257*     CARD.                                                       01425771
014260*----------------------------------------------------------       01426066
014300 8100-WRITE-FUT-OFFSET-CARD.                                      01430075
014400                                                                  01440066
014500     WRITE CC-FUT-OFFSET-RECORD                                   01450071
014600         FROM EP107-CC-CONTROL-CARD.                              01460087
014700                                                                  01470066
014800*8100-EXIT.                                                       01480075
014900 EJECT.                                                           01490066
015000                                                                  01500066
016100*----------------------------------------------------------       01610061
016200* 8200-WRITE-TIMESTAMP-CARD.                                      01620075
016300*     WRITES TIMESTAMP CONTROL CARD RECORD TO EPCC102 CONTROL     01630071
016310*     CARD.                                                       01631071
016400*----------------------------------------------------------       01640061
016500 8200-WRITE-TIMESTAMP-CARD.                                       01650075
016600                                                                  01660061
016700     WRITE CC-TIMESTAMP-RECORD                                    01670071
016800         FROM EP102-CC-CONTROL-CARD.                              01680088
016900                                                                  01690061
017200*8200-EXIT.                                                       01720075
017300 EJECT.                                                           01730061
017400                                                                  01740061
017410*----------------------------------------------------------       01741091
017420* 8300-WRITE-CORR-DTE-CARD.                                       01742091
017430*     WRITES THE CURRENT CORRECTIONS FUTURE DATE CONTROL CARD     01743092
017440*     RECORD TO THE EPCC113 CONTROL CARD.                         01744092
017450*----------------------------------------------------------       01745091
017460 8300-WRITE-CORR-DTE-CARD.                                        01746091
017470                                                                  01747091
017480     WRITE CC-CORR-FUT-RECORD                                     01748091
017490         FROM EP113-CC-CONTROL-CARD.                              01749091
017491                                                                  01749191
017492*8300-EXIT.                                                       01749291
017493 EJECT.                                                           01749391
017494                                                                  01749491
017500*---------------------------------------------------------        01750061
017600* 9000-ABEND.                                                     01760061
017700*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  01770061
017800*---------------------------------------------------------        01780061
017900 9000-ABEND.                                                      01790061
017910                                                                  01791061
018000     DISPLAY '** ABEND           **'.                             01800061
018100     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          01810061
018200     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        01820061
018300     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       01830061
018400     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       01840061
018500     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         01850061
018600                                                                  01860061
018601*9000-EXIT.                                                       01860173
018602 EJECT.                                                           01860273
018603                                                                  01860373
018610*---------------------------------------------------------        01861071
018620* 9100-SQL-ABEND.                                                 01862071
018630*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.01863071
018640*---------------------------------------------------------        01864071
018650 9100-SQL-ABEND.                                                  01865071
018651                                                                  01865172
018652     SET AC-DB2-ERROR TO TRUE.                                    01865271
018653                                                                  01865371
018660     DISPLAY '** ABEND     **'.                                   01866071
018670     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                01867072
018680     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              01868071
018690     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               01869071
018691                                                                  01869171
018692     COPY DPPD004.                                                01869271
018693     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         01869371
018694                                                                  01869471
018695*9100-EXIT.                                                       01869571
018696 EJECT.                                                           01869671
018697                                                                  01869771
018700*----------------------------------------------------------       01870061
018800* 9999-WRAPUP.                                                    01880061
018900*     DISPLAYS ANY NEEDED INFORMATION.                            01890099
019000*----------------------------------------------------------       01900061
019100 9999-WRAPUP.                                                     01910061
019200                                                                  01920061
019300     DISPLAY ' '.                                                 01930097
019600     DISPLAY 'EPCC111 CONTROL CARD'.                              01960085
019700     DISPLAY EP111-CC-CONTROL-CARD-DISPLY.                        01970089
019800     DISPLAY ' '.                                                 01980068
019810     DISPLAY 'EPCC101 CONTROL CARD'.                              01981068
019820     DISPLAY EP101-CC-CONTROL-CARD-DISPLY.                        01982086
019830     DISPLAY ' '.                                                 01983068
019840     DISPLAY 'EPCC102 CONTROL CARD'.                              01984068
019850     DISPLAY EP102-CC-CONTROL-CARD-DISPLY.                        01985088
019851     DISPLAY ' '.                                                 01985175
019852     DISPLAY 'EPCC107 CONTROL CARD'.                              01985275
019853     DISPLAY EP107-CC-CONTROL-CARD-DISPLY.                        01985387
019854     DISPLAY ' '.                                                 01985491
019855     DISPLAY 'EPCC113 CONTROL CARD'.                              01985591
019856     DISPLAY EP113-CC-CONTROL-CARD-DISPLY.                        01985691
019860                                                                  01986068
019900*9999-EXIT.                                                       01990061
020000 EJECT.                                                           02000061
020100                                                                  02010061
