       IDENTIFICATION DIVISION.                                         00010071
       PROGRAM-ID.    PXKUT014.                                         00020071
       AUTHOR.        KOHLS DEPARTMENT STORES.                          00030071
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040071
       DATE-WRITTEN.  03/31/2005.                                       00050071
       DATE-COMPILED.                                                   00060071
      ******************************************************************00070071
      **THIS PROGRAM WILL READ IN A FILE SUMMARIZED BY DEPT/STORE       00080071
      **     AND LOOKUP THE DMA NAME/NUMBER AND REGION/DISTRICT NBRS.   00090071
      ******************************************************************00100071
      **DATE:03/31/2005 MADE BY:JULIE TEWES INITIAL PROGRAM WRITE       00110071
      ******************************************************************00120071
      **DATE:04/12/2005 MADE BY:JULIE TEWES CHANGE FILE LAYOUT LENGTH   00130071
      ******************************************************************00140071
      **DATE:05/20/2005 MADE BY:DAVID WELLER - P000764184               00141071
      ******************************************************************00142071
      **DATE:10/31/2005 MADE BY:JULIE TEWES EXTEND FILE LAYOUT FOR      00143071
      **                PRICE OPTIMIZATION                              00143171
      ******************************************************************00144071
      **DATE:09/21/2007 MADE BY:DAVID WELLER                            00145071
      **    IF INPUT FILE HAS NO ROWS, DON'T TRY TO PROCESS IT.         00146071
      ******************************************************************00147071
      **DATE:09/23/2007 MADE BY:MARGARET MORRISON                       00147171
      **    ALLOW FOR AN ADDITIONAL DMA.                                00147271
      ******************************************************************00147371
      ******************************************************************00147471
      **DATE:09/24/2007 MADE BY:MARGARET MORRISON                       00147571
      **    REMOVE EMPTY INPUT FILE PROCESSING.                         00147671
      ******************************************************************00147771
      ******************************************************************00147880
      **DATE:10/05/2015 MADE BY:SARVESWARAN N S KANNAN.                 00147980
      **    INCREASED THE HEADER FILE LENGTH FROM 500 TO 520            00148080
      **    TO ACCOMODATE NEW DMA COLUMN VALUES.                        00148180
      **    FIND FOR TAG #CHGFIX TO SEE THE CHANGES.                    00148280
      **    ADDED ANOTHER COLUMN PXRD022-DMA-17-NM IN THE               00148380
      **    COPYBOOK PXRD022.                                           00148480
      **    ADDED ANOTHER COLUMN PXRD021-DMA-17-QTY IN THE              00148580
      **    COPYBOOK PXRD021.                                           00148680
      ******************************************************************00149080
       ENVIRONMENT DIVISION.                                            00150071
       CONFIGURATION SECTION.                                           00160071
       SOURCE-COMPUTER.    IBM-3090.                                    00170071
       OBJECT-COMPUTER.    IBM-3090.                                    00180071
       INPUT-OUTPUT SECTION.                                            00190071
       FILE-CONTROL.                                                    00200071
                                                                        00210071
           SELECT INPUT-FILE                                            00220071
                  ASSIGN TO INP01.                                      00230071
           SELECT HEADER-FILE                                           00240071
                  ASSIGN TO OUT01.                                      00250071
           SELECT OUTPUT-FILE                                           00260071
                  ASSIGN TO OUT02.                                      00270071
                                                                        00280071
       DATA DIVISION.                                                   00290071
       FILE SECTION.                                                    00300071
                                                                        00310071
       FD  INPUT-FILE                                                   00320071
           RECORDING MODE IS F                                          00330071
           LABEL RECORDS OMITTED                                        00340071
           BLOCK CONTAINS 0 RECORDS                                     00350071
           DATA RECORD IS INPUT-RECORD.                                 00360071
       01  INPUT-RECORD                        PIC X(187).              00370071
      *01  INPUT-RECORD                        PIC X(161).              00371071
                                                                        00380071
       FD  OUTPUT-FILE                                                  00390071
           RECORDING MODE IS F                                          00400071
           LABEL RECORDS OMITTED                                        00410071
           BLOCK CONTAINS 0 RECORDS                                     00420071
           DATA RECORD IS OUTPUT-RECORD.                                00430071
       01  OUTPUT-RECORD                       PIC X(100).              00440079
                                                                        00450071
       FD  HEADER-FILE                                                  00460071
           RECORDING MODE IS F                                          00470071
           LABEL RECORDS OMITTED                                        00480071
           BLOCK CONTAINS 0 RECORDS                                     00490071
           DATA RECORD IS HEADER-RECORD.                                00500071
      *01  HEADER-RECORD                       PIC X(500).              00510077
CHGFIX 01  HEADER-RECORD                       PIC X(520).              00511077
                                                                        00520071
       WORKING-STORAGE SECTION.                                         00530071
      ******************************************************************00540071
      **PROGRAM SWITCHES                                                00550071
      ******************************************************************00560071
       01  PS-SWITCH-AREAS.                                             00570071
           05  PS-END-OF-INPUT-FILE-SW         PIC X(01)  VALUE 'N'.    00580071
               88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.    00590071
               88  PS-NOT-END-OF-INPUT-FILE               VALUE 'N'.    00600071
           05  PS-END-OF-DMA-CSR-SW            PIC X(01)  VALUE 'N'.    00610071
               88  PS-END-OF-DMA-CSR                      VALUE 'Y'.    00620071
               88  PS-NOT-END-OF-DMA-CSR                  VALUE 'N'.    00630071
      ******************************************************************00640071
      **DATE TIME FIELDS                                                00650071
      ******************************************************************00660071
       01 DF-DATE-TIME-FIELDS.                                          00670071
          05 DF-ACCEPT-DATE                    PIC X(06) VALUE SPACES.  00680071
          05 DF-ACCEPT-TIME                    PIC X(08) VALUE SPACES.  00690071
      ******************************************************************00700071
      **PROGRAM HOLD FIELDS                                             00710071
      ******************************************************************00720071
       01 PH-PROGRAM-HOLD.                                              00730071
          05 PH-STR-NBR                        PIC S9(04)  COMP         00740071
                                                         VALUE ZEROS.   00750071
      ******************************************************************00760071
      **OUTPUT HOLD FIELDS                                              00770071
      ******************************************************************00780071
       01 OH-OUTPUT-HOLD-FIELDS.                                        00790071
          05 OH-DMA-NBR-1                      PIC S9(04)V COMP-3       00800071
                                                         VALUE ZEROS.   00810071
          05 OH-DMA-NBR-2                      PIC S9(04)V COMP-3       00820071
                                                         VALUE ZEROS.   00830071
          05 OH-DMA-NBR-3                      PIC S9(04)V COMP-3       00840071
                                                         VALUE ZEROS.   00850071
          05 OH-DMA-NBR-4                      PIC S9(04)V COMP-3       00860071
                                                         VALUE ZEROS.   00870071
          05 OH-DMA-NBR-5                      PIC S9(04)V COMP-3       00880071
                                                         VALUE ZEROS.   00890071
          05 OH-DMA-NBR-6                      PIC S9(04)V COMP-3       00900071
                                                         VALUE ZEROS.   00910071
          05 OH-DMA-NBR-7                      PIC S9(04)V COMP-3       00920071
                                                         VALUE ZEROS.   00930071
          05 OH-DMA-NBR-8                      PIC S9(04)V COMP-3       00940071
                                                         VALUE ZEROS.   00950071
          05 OH-DMA-NBR-9                      PIC S9(04)V COMP-3       00960071
                                                         VALUE ZEROS.   00970071
          05 OH-DMA-NBR-10                     PIC S9(04)V COMP-3       00980071
                                                         VALUE ZEROS.   00990071
          05 OH-DMA-NBR-11                     PIC S9(04)V COMP-3       01000071
                                                         VALUE ZEROS.   01010071
          05 OH-DMA-NBR-12                     PIC S9(04)V COMP-3       01020071
                                                         VALUE ZEROS.   01030071
          05 OH-DMA-NBR-13                     PIC S9(04)V COMP-3       01040071
                                                         VALUE ZEROS.   01050071
          05 OH-DMA-NBR-14                     PIC S9(04)V COMP-3       01060071
                                                         VALUE ZEROS.   01070071
          05 OH-DMA-NBR-15                     PIC S9(04)V COMP-3       01071073
                                                         VALUE ZEROS.   01072073
          05 OH-DMA-NBR-16                     PIC S9(04)V COMP-3       01073073
                                                         VALUE ZEROS.   01073175
CHGFIX    05 OH-DMA-NBR-17                     PIC S9(04)V COMP-3       01073275
CHGFIX                                                   VALUE ZEROS.   01073375
      ******************************************************************01080071
      **PROGRAM COUNTERS                                                01090071
      ******************************************************************01100071
       01  PC-PROGRAM-COUNTERS.                                         01110071
           05  PC-INPUT-RECORDS-READ           PIC 9(06) VALUE ZEROS.   01120071
           05  PC-OUTPUT-RECORDS-WRITTEN       PIC 9(06) VALUE ZEROS.   01130071
           05  PC-DMA-CSR-RECORD-COUNT         PIC 9(06) VALUE ZEROS.   01140071
      ****************************************************************  01150071
      **ABEND INFORMATION                                               01160071
      ****************************************************************  01170071
       01  AC-ABEND-FIELDS.                                             01180071
           05  AC-ABEND-CODE                   PIC S9(04) VALUE ZERO    01190071
                                                           COMP SYNC.   01200071
               88  AC-TABLE-ERROR                        VALUE +4004.   01210071
               88  AC-DB2-ERROR                          VALUE +4013.   01220071
       01  PV-MISC-ABEND-FIELDS.                                        01230071
           05  PV-PARAGRAPH-NAME               PIC X(30) VALUE SPACE.   01240071
           05  PV-OPERATION-MSG-1              PIC X(40) VALUE SPACE.   01250071
           05  PV-OPERATION-MSG-2              PIC X(40) VALUE SPACE.   01260071
           05  PV-DB2-OPERATION                PIC X(30) VALUE SPACE.   01270071
      ******************************************************************01280071
      **COPYBOOKS                                                       01290071
      ******************************************************************01300071
      ****INPUT RECORD LAYOUT                                           01310071
           COPY PXRD004.                                                01320071
      ****OUTPUT RECORD LAYOUT                                          01330071
           COPY PXRD021.                                                01340071
      ****HEADER RECORD LAYOUT                                          01350071
           COPY PXRD022.                                                01360071
      ****ABEND ROUTINE INFORMATION                                     01370071
           COPY SQLCA2.                                                 01380071
      ****ABEND ROUTINE INFORMATION                                     01390071
           COPY DPWS004.                                                01400071
      ******************************************************************01410071
      **TABLE INCLUSIONS                                                01420071
      ******************************************************************01430071
      ***XS DOMAIN LOCATION DISTRICT TABLE                              01440071
           EXEC SQL                                                     01450071
                INCLUDE XST00002                                        01460071
           END-EXEC.                                                    01470071
      ***XS DOMAIN DISTRICT TABLE                                       01480071
           EXEC SQL                                                     01490071
                INCLUDE XST00003                                        01500071
           END-EXEC.                                                    01510071
      ***XS DOMAIN DISTRICT REGION TABLE                                01520071
           EXEC SQL                                                     01530071
                INCLUDE XST00004                                        01540071
           END-EXEC.                                                    01550071
      ***XS DOMAIN DEPT TABLE                                           01560071
           EXEC SQL                                                     01570071
                INCLUDE XST00015                                        01580071
           END-EXEC.                                                    01590071
      ***XS DOMAIN DMA TABLE                                            01600071
           EXEC SQL                                                     01610071
                INCLUDE XST00067                                        01620071
           END-EXEC.                                                    01630071
      *****DB2 TABLE INCLUSION                                          01640071
           EXEC SQL                                                     01650071
                INCLUDE SQLCA                                           01660071
           END-EXEC.                                                    01670071
      ******************************************************************01680071
      **CURSOR DECLARES                                                 01690071
      ******************************************************************01700071
           EXEC SQL                                                     01710071
                DECLARE DMA_CSR CURSOR FOR                              01720071
                  SELECT DMA_NBR                                        01730071
                        ,DMA_NM                                         01740071
                  FROM   XST_DMA                                        01750071
                  ORDER BY DMA_NBR                                      01760071
                  WITH UR                                               01770071
           END-EXEC.                                                    01780071
                                                                        01790071
       PROCEDURE DIVISION.                                              01800071
      ******************************************************************01810071
       000-MAINLINE-PROCESSING.                                         01820071
                                                                        01830071
           PERFORM 1000-INITIALIZATION.                                 01840071
           PERFORM 2000-PROCESS-RECORDS                                 01850071
                   UNTIL PS-END-OF-INPUT-FILE.                          01860071
           PERFORM 9999-WRAPUP.                                         01870071
           GOBACK.                                                      01880071
                                                                        01890071
       EJECT.                                                           01900071
      ******************************************************************01910071
      **INITIALIZATION ROUTINE                                          01920071
      ******************************************************************01930071
       1000-INITIALIZATION.                                             01940071
                                                                        01950071
           MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             01960071
                                                                        01970071
           OPEN INPUT  INPUT-FILE                                       01980071
                OUTPUT OUTPUT-FILE                                      01990071
                       HEADER-FILE.                                     02000071
                                                                        02010071
           ACCEPT DF-ACCEPT-TIME FROM TIME.                             02020071
           ACCEPT DF-ACCEPT-DATE FROM DATE.                             02030071
                                                                        02040071
           PERFORM 9999-READ-INPUT-RECORD.                              02050071
                                                                        02060071
           MOVE PXRD004-STR-NBR TO PH-STR-NBR.                          02061071
                                                                        02070071
           PERFORM 1100-RETRIEVE-DMA-AREAS.                             02080071
                                                                        02090071
       EJECT.                                                           02100071
      ******************************************************************02110071
      **RETRIEVE DMA                                                    02120071
      ******************************************************************02130071
       1100-RETRIEVE-DMA-AREAS.                                         02140071
                                                                        02150071
           MOVE '1100-RETRIEVE-DMA-AREAS' TO PV-PARAGRAPH-NAME.         02160071
                                                                        02170071
           ADD +1                     TO PC-DMA-CSR-RECORD-COUNT.       02180071
                                                                        02190071
           PERFORM 1120-OPEN-DMA-CSR.                                   02200071
           PERFORM 1140-FETCH-DMA-CSR                                   02210071
                   UNTIL PS-END-OF-DMA-CSR.                             02220071
           PERFORM 1160-CLOSE-DMA-CSR.                                  02230071
                                                                        02240071
           MOVE PXRD004-EFF-DATE      TO PXRD022-EFF-DATE.              02250071
                                                                        02260071
           WRITE HEADER-RECORD FROM PXRD022-YELLOW-TICKET-HDR-FILE.     02270071
                                                                        02280071
       EJECT.                                                           02290071
      ******************************************************************02300071
      **OPEN DMA CSR                                                    02310071
      ******************************************************************02320071
       1120-OPEN-DMA-CSR.                                               02330071
                                                                        02340071
           MOVE '1120-OPEN-DMA-CSR'  TO PV-PARAGRAPH-NAME.              02350071
                                                                        02360071
           EXEC SQL                                                     02370071
                OPEN DMA_CSR                                            02380071
           END-EXEC.                                                    02390071
                                                                        02400071
           EVALUATE TRUE                                                02410071
              WHEN SQLCODE = ZERO                                       02420071
                   CONTINUE                                             02430071
              WHEN OTHER                                                02440071
                   PERFORM 9999-DISPLAY-STATISTICS                      02450071
                   PERFORM 9999-SQL-ERROR                               02460071
           END-EVALUATE.                                                02470071
                                                                        02480071
       EJECT.                                                           02490071
      ******************************************************************02500071
      **FETCH DMA CSR                                                   02510071
      ******************************************************************02520071
       1140-FETCH-DMA-CSR.                                              02530071
                                                                        02540071
           MOVE '1140-FETCH-DMA-CSR'  TO PV-PARAGRAPH-NAME.             02550071
                                                                        02560071
           EXEC SQL                                                     02570071
                FETCH DMA_CSR INTO                                      02580071
                          :XST00067-DMA-NBR                             02590071
                        , :XST00067-DMA-NM                              02600071
           END-EXEC.                                                    02610071
                                                                        02620071
           EVALUATE TRUE                                                02630071
              WHEN SQLCODE = ZERO                                       02640071
                   PERFORM 1145-MOVE-HEADERS-TO-OUTPUT                  02650071
                   ADD +1                    TO PC-DMA-CSR-RECORD-COUNT 02660071
              WHEN SQLCODE = +100                                       02670071
                   SET PS-END-OF-DMA-CSR     TO TRUE                    02680071
              WHEN OTHER                                                02690071
                   PERFORM 9999-DISPLAY-STATISTICS                      02700071
                   PERFORM 9999-SQL-ERROR                               02710071
           END-EVALUATE.                                                02720071
                                                                        02730071
       EJECT.                                                           02740071
      ******************************************************************02750071
      **MOVE DMA HEADERS TO OUTPUT                                      02760071
      ******************************************************************02770071
       1145-MOVE-HEADERS-TO-OUTPUT.                                     02780071
                                                                        02790071
           MOVE '1145-MOVE-HEADERS-TO-OUTPUT' TO PV-PARAGRAPH-NAME.     02800071
                                                                        02810071
           EVALUATE TRUE                                                02820071
              WHEN PC-DMA-CSR-RECORD-COUNT = 1                          02830071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-1-NM       02840071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-1           02850071
              WHEN PC-DMA-CSR-RECORD-COUNT = 2                          02860071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-2-NM       02870071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-2           02880071
              WHEN PC-DMA-CSR-RECORD-COUNT = 3                          02890071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-3-NM       02900071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-3           02910071
              WHEN PC-DMA-CSR-RECORD-COUNT = 4                          02920071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-4-NM       02930071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-4           02940071
              WHEN PC-DMA-CSR-RECORD-COUNT = 5                          02950071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-5-NM       02960071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-5           02970071
              WHEN PC-DMA-CSR-RECORD-COUNT = 6                          02980071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-6-NM       02990071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-6           03000071
              WHEN PC-DMA-CSR-RECORD-COUNT = 7                          03010071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-7-NM       03020071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-7           03030071
              WHEN PC-DMA-CSR-RECORD-COUNT = 8                          03040071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-8-NM       03050071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-8           03060071
              WHEN PC-DMA-CSR-RECORD-COUNT = 9                          03070071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-9-NM       03080071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-9           03090071
              WHEN PC-DMA-CSR-RECORD-COUNT = 10                         03100071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-10-NM      03110071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-10          03120071
              WHEN PC-DMA-CSR-RECORD-COUNT = 11                         03130071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-11-NM      03140071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-11          03150071
              WHEN PC-DMA-CSR-RECORD-COUNT = 12                         03160071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-12-NM      03170071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-12          03180071
              WHEN PC-DMA-CSR-RECORD-COUNT = 13                         03190071
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-13-NM      03200071
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-13          03210071
              WHEN PC-DMA-CSR-RECORD-COUNT = 14                         03210171
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-14-NM      03210271
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-14          03210371
              WHEN PC-DMA-CSR-RECORD-COUNT = 15                         03210472
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-15-NM      03210572
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-15          03210672
              WHEN PC-DMA-CSR-RECORD-COUNT = 16                         03210772
                   MOVE XST00067-DMA-NM       TO PXRD022-DMA-16-NM      03210872
                   MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-16          03210972
CHGFIX        WHEN PC-DMA-CSR-RECORD-COUNT = 17                         03211074
CHGFIX             MOVE XST00067-DMA-NM       TO PXRD022-DMA-17-NM      03212074
CHGFIX             MOVE XST00067-DMA-NBR      TO OH-DMA-NBR-17          03213074
              WHEN OTHER                                                03220071
                   DISPLAY 'OUT OF ROOM FOR DMA AREAS..'                03230071
                   PERFORM 9999-DISPLAY-STATISTICS                      03240071
                   PERFORM 9999-SQL-ERROR                               03250071
           END-EVALUATE.                                                03260071
                                                                        03270071
       EJECT.                                                           03280071
      ******************************************************************03290071
      **CLOSE DMA CSR                                                   03300071
      ******************************************************************03310071
       1160-CLOSE-DMA-CSR.                                              03320071
                                                                        03330071
           MOVE '1160-CLOSE-DMA-CSR'  TO PV-PARAGRAPH-NAME.             03340071
                                                                        03350071
           EXEC SQL                                                     03360071
                CLOSE DMA_CSR                                           03370071
           END-EXEC.                                                    03380071
                                                                        03390071
           EVALUATE TRUE                                                03400071
              WHEN SQLCODE = ZERO                                       03410071
                   CONTINUE                                             03420071
              WHEN OTHER                                                03430071
                   PERFORM 9999-DISPLAY-STATISTICS                      03440071
                   PERFORM 9999-SQL-ERROR                               03450071
           END-EVALUATE.                                                03460071
                                                                        03470071
       EJECT.                                                           03480071
      ******************************************************************03490071
      **PROCESS INPUT RECORD TO CHECK ROWS                              03500071
      ******************************************************************03510071
       2000-PROCESS-RECORDS.                                            03520071
                                                                        03530071
           MOVE '2000-PROCESS-RECORDS'  TO PV-PARAGRAPH-NAME.           03540071
                                                                        03550071
           PERFORM 2100-DMA-LOOKUP.                                     03560071
           PERFORM 2200-DIST-REGN-LOOKUP.                               03570071
                                                                        03580071
           MOVE PXRD004-STR-NBR          TO PXRD021-STR-NBR.            03590071
           MOVE PXRD004-LOC-NM           TO PXRD021-LOC-NM.             03600071
           MOVE XST00004-DIST-NBR        TO PXRD021-DIST-NBR.           03610071
           MOVE XST00004-REGN-NBR        TO PXRD021-REGN-NBR.           03620071
                                                                        03630071
           PERFORM 2300-MOVE-STR-EXPTED-QTY.                            03640071
                                                                        03650071
           PERFORM 9999-READ-INPUT-RECORD.                              03660071
                                                                        03670071
           IF  PH-STR-NBR NOT EQUAL PXRD004-STR-NBR                     03680071
               PERFORM 9999-WRITE-OUTPUT-RECORD                         03690071
               MOVE PXRD004-STR-NBR      TO PH-STR-NBR                  03700071
               INITIALIZE PXRD021-YELLOW-TICKET-SUM-FILE                03710071
           END-IF.                                                      03720071
                                                                        03730071
       EJECT.                                                           03740071
      ******************************************************************03750071
      **DMA LOOKUP                                                      03760071
      ******************************************************************03770071
       2100-DMA-LOOKUP.                                                 03780071
                                                                        03790071
           MOVE '2100-DMA-LOOKUP'     TO PV-PARAGRAPH-NAME.             03800071
                                                                        03810071
           MOVE PXRD004-DEPT-NBR      TO XST00015-DEPT-NBR.             03820071
                                                                        03830071
           EXEC SQL                                                     03840071
                SELECT B.DMA_NBR                                        03850071
                      ,B.DMA_NM                                         03860071
                INTO   :XST00067-DMA-NBR                                03870071
                      ,:XST00067-DMA-NM                                 03880071
                FROM   XST_DEPT A                                       03890071
                      ,XST_DMA  B                                       03900071
                WHERE A.DMA_NBR   = B.DMA_NBR                           03910071
                  AND A.DEPT_NBR  = :XST00015-DEPT-NBR                  03920071
                WITH UR                                                 03930071
           END-EXEC.                                                    03940071
                                                                        03950071
           EVALUATE TRUE                                                03960071
              WHEN SQLCODE = +0                                         03970071
                   CONTINUE                                             03980071
              WHEN OTHER                                                03990071
                   DISPLAY 'LOOKUP DMA NBR AND NAME....'                04000071
                   DISPLAY 'DEPT_NBR ' XST00015-DEPT-NBR                04010071
                   PERFORM 9999-DISPLAY-STATISTICS                      04020071
                   PERFORM 9999-SQL-ERROR                               04030071
           END-EVALUATE.                                                04040071
                                                                        04050071
       EJECT.                                                           04060071
      ******************************************************************04070071
      **DISTRICT/REGION LOOKUP                                          04080071
      ******************************************************************04090071
       2200-DIST-REGN-LOOKUP.                                           04100071
                                                                        04110071
           MOVE '2200-DIST-REGN-LOOKUP' TO PV-PARAGRAPH-NAME.           04120071
                                                                        04130071
           MOVE PXRD004-STR-NBR         TO XST00002-LOC-NBR.            04140071
                                                                        04150071
           EXEC SQL                                                     04160071
                SELECT C.DIST_NBR                                       04170071
                      ,C.REGN_NBR                                       04180071
                INTO  :XST00004-DIST-NBR                                04190071
                     ,:XST00004-REGN-NBR                                04200071
                FROM  XST_LOC_DIST    A                                 04210071
                     ,XST_DIST        B                                 04220071
                     ,XST_DIST_REGN   C                                 04230071
                WHERE A.DIST_NBR  = B.DIST_NBR                          04240071
                  AND B.DIST_NBR  = C.DIST_NBR                          04250071
                  AND A.END_DTE   IS NULL                               04260071
                  AND C.END_DTE   IS NULL                               04270071
                  AND A.LOC_NBR   = :XST00002-LOC-NBR                   04280071
                WITH UR                                                 04290071
           END-EXEC.                                                    04300071
                                                                        04310071
           EVALUATE TRUE                                                04320071
              WHEN SQLCODE = +0                                         04330071
                   CONTINUE                                             04340071
              WHEN SQLCODE = +100                                       04350071
                   MOVE 9999          TO XST00004-DIST-NBR              04360071
                   MOVE 9999          TO XST00004-REGN-NBR              04370071
              WHEN OTHER                                                04380071
                   DISPLAY 'DIST/REGN LOOKUP....'                       04390071
                   DISPLAY 'LOCATION NBR ' XST00002-LOC-NBR             04400071
                   PERFORM 9999-DISPLAY-STATISTICS                      04410071
                   PERFORM 9999-SQL-ERROR                               04420071
           END-EVALUATE.                                                04430071
                                                                        04440071
       EJECT.                                                           04450071
      ******************************************************************04460071
      **MOVE STR EXPTED TO CORRECT OUTPUT FIELD                         04470071
      ******************************************************************04480071
       2300-MOVE-STR-EXPTED-QTY.                                        04490071
                                                                        04500071
           MOVE '2300-MOVE-STR-EXPTED-QTY'      TO PV-PARAGRAPH-NAME.   04510071
                                                                        04520071
           EVALUATE TRUE                                                04530071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-1                      04540071
                   COMPUTE PXRD021-DMA-1-QTY                            04550071
                           = PXRD021-DMA-1-QTY + PXRD004-STR-EXPTED-QTY 04560071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-2                      04570071
                   COMPUTE PXRD021-DMA-2-QTY                            04580071
                           = PXRD021-DMA-2-QTY + PXRD004-STR-EXPTED-QTY 04590071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-3                      04600071
                   COMPUTE PXRD021-DMA-3-QTY                            04610071
                           = PXRD021-DMA-3-QTY + PXRD004-STR-EXPTED-QTY 04620071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-4                      04630071
                   COMPUTE PXRD021-DMA-4-QTY                            04640071
                           = PXRD021-DMA-4-QTY + PXRD004-STR-EXPTED-QTY 04650071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-5                      04660071
                   COMPUTE PXRD021-DMA-5-QTY                            04670071
                           = PXRD021-DMA-5-QTY + PXRD004-STR-EXPTED-QTY 04680071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-6                      04690071
                   COMPUTE PXRD021-DMA-6-QTY                            04700071
                           = PXRD021-DMA-6-QTY + PXRD004-STR-EXPTED-QTY 04710071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-7                      04720071
                   COMPUTE PXRD021-DMA-7-QTY                            04730071
                           = PXRD021-DMA-7-QTY + PXRD004-STR-EXPTED-QTY 04740071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-8                      04750071
                   COMPUTE PXRD021-DMA-8-QTY                            04760071
                           = PXRD021-DMA-8-QTY + PXRD004-STR-EXPTED-QTY 04770071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-9                      04780071
                   COMPUTE PXRD021-DMA-9-QTY                            04790071
                           = PXRD021-DMA-9-QTY + PXRD004-STR-EXPTED-QTY 04800071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-10                     04810071
                   COMPUTE PXRD021-DMA-10-QTY                           04820071
                           = PXRD021-DMA-10-QTY + PXRD004-STR-EXPTED-QTY04830071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-11                     04840071
                   COMPUTE PXRD021-DMA-11-QTY                           04850071
                           = PXRD021-DMA-11-QTY + PXRD004-STR-EXPTED-QTY04860071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-12                     04870071
                   COMPUTE PXRD021-DMA-12-QTY                           04880071
                           = PXRD021-DMA-12-QTY + PXRD004-STR-EXPTED-QTY04890071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-13                     04900071
                   COMPUTE PXRD021-DMA-13-QTY                           04910071
                           = PXRD021-DMA-13-QTY + PXRD004-STR-EXPTED-QTY04920071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-14                     04930071
                   COMPUTE PXRD021-DMA-14-QTY                           04940071
                           = PXRD021-DMA-14-QTY + PXRD004-STR-EXPTED-QTY04950071
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-15                     04951072
                   COMPUTE PXRD021-DMA-15-QTY                           04952072
                           = PXRD021-DMA-15-QTY + PXRD004-STR-EXPTED-QTY04953072
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-16                     04954072
                   COMPUTE PXRD021-DMA-16-QTY                           04955072
                           = PXRD021-DMA-16-QTY + PXRD004-STR-EXPTED-QTY04956072
              WHEN XST00067-DMA-NBR = OH-DMA-NBR-17                     04957076
                   COMPUTE PXRD021-DMA-17-QTY                           04958076
                           = PXRD021-DMA-17-QTY + PXRD004-STR-EXPTED-QTY04959076
              WHEN OTHER                                                04960071
                   DISPLAY 'NO ASSIGNED DMA.....'                       04970071
                   PERFORM 9999-DISPLAY-STATISTICS                      04980071
                   PERFORM 9999-SQL-ERROR                               04990071
           END-EVALUATE.                                                05000071
                                                                        05010071
       EJECT.                                                           05020071
      ******************************************************************05030071
      **READ INPUT RECORD                                               05040071
      ******************************************************************05050071
       9999-READ-INPUT-RECORD.                                          05060071
                                                                        05070071
           READ INPUT-FILE INTO PXRD004-YELLOW-TICKET-UNLOAD            05080071
                AT END                                                  05090071
                SET PS-END-OF-INPUT-FILE TO TRUE                        05100071
           END-READ.                                                    05110071
                                                                        05120071
           IF  PS-NOT-END-OF-INPUT-FILE                                 05130071
               ADD +1                      TO PC-INPUT-RECORDS-READ     05140071
           END-IF.                                                      05150071
                                                                        05160071
       EJECT.                                                           05170071
      ****************************************************************  05180071
      **WRITE OUTPUT RECORD                                             05190071
      ****************************************************************  05200071
       9999-WRITE-OUTPUT-RECORD.                                        05210071
                                                                        05220071
           WRITE OUTPUT-RECORD FROM PXRD021-YELLOW-TICKET-SUM-FILE.     05230071
                                                                        05240071
           ADD +1              TO PC-OUTPUT-RECORDS-WRITTEN.            05250071
                                                                        05260071
       EJECT.                                                           05270071
      ******************************************************************05280071
      **CLOSE INPUT FILES.                                              05290071
      ******************************************************************05300071
       9999-WRAPUP.                                                     05310071
                                                                        05320071
           CLOSE INPUT-FILE                                             05330071
                 OUTPUT-FILE                                            05340071
                 HEADER-FILE.                                           05350071
                                                                        05360071
           PERFORM 9999-DISPLAY-STATISTICS.                             05370071
                                                                        05380071
       EJECT.                                                           05390071
      ******************************************************************05400071
      **DISPLAY PROGRAM STATS                                           05410071
      ******************************************************************05420071
       9999-DISPLAY-STATISTICS.                                         05430071
                                                                        05440071
           DISPLAY '*************************************************'. 05450071
           DISPLAY '* PROGRAM...........: PXKUT014'.                    05460071
           DISPLAY '* DATE..............: ' DF-ACCEPT-DATE.             05470071
           DISPLAY '* TIME..............: ' DF-ACCEPT-TIME.             05480071
           DISPLAY '* RECORDS READ......: ' PC-INPUT-RECORDS-READ.      05490071
           DISPLAY '* OUTPUT RECORDS WRITTEN...: '                      05500071
                                              PC-OUTPUT-RECORDS-WRITTEN.05510071
           DISPLAY '*************************************************'. 05520071
                                                                        05530071
       EJECT.                                                           05540071
      ******************************************************************05550071
      * ABEND ROUTINE FOR BAD SQL CALLS                                *05560071
      ******************************************************************05570071
       9999-SQL-ERROR.                                                  05580071
                                                                        05590071
           DISPLAY '** ABEND     **'.                                   05600071
           DISPLAY '** PROGRAM   ** = PXKUT014'.                        05610071
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              05620071
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               05630071
      ***************************************************************** 05640071
      *    COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED  05650071
      *    TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.   05660071
      ***************************************************************** 05670071
           COPY DPPD004.                                                05680071
           SET AC-DB2-ERROR TO TRUE.                                    05690071
           CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05700071
                                                                        05710071
       EJECT.                                                           05720071
