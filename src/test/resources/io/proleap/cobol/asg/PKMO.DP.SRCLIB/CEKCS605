000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    CEKCS605.                                         00040000
000500 AUTHOR.        DENISE HAHN.                                      00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  12-14-1999.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000***** NOTE:    THIS PROGRAM USES MQ SERIES AND MUST BE COMPILED   00100002
001100*****          WITH THE MQ SERIES SWITCH SET TO 'Y'.              00110002
001200*---------------------------------------------------------------* 00120000
001300*    S605 - CENTRAL STOCK INTERFACE - PULL ADD BY SKU           * 00130000
001400*---------------------------------------------------------------* 00140000
001410*                                                               * 00141054
001420* CHANGE HISTORY:                                               * 00142054
001430* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES         * 00143054
001440* ------- ---------- ----------- -------------------------------- 00144054
001450* WR38216 04-26-2010 C. TWIEHAUS  EFC1-2 TRANSFERS              * 00145054
001460*---------------------------------------------------------------* 00146054
001470* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00147062
001480* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00148063
001490* MAKING THE CALL DYNAMIC VS STATIC.                              00149063
001491*----------------------------------------------------------------*00149163
001492* CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00149263
001493* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00149363
001494* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00149463
001495*-----------------------------------------------------------------00149563
001492* CHANGED 09/18/2023    BY JEAN KURK       WR: CHG0293403         00149674
001493* CODE LIMIT OF 999 LINES PER CS PULL                             00149774
001495*-----------------------------------------------------------------00149974
001500                                                                  00150054
001600 ENVIRONMENT DIVISION.                                            00160000
001700                                                                  00170000
001800 DATA DIVISION.                                                   00180000
001900                                                                  00190000
002000 WORKING-STORAGE SECTION.                                         00200000
002100                                                                  00210000
002200                                                                  00220000
002300*    API CONTROL BLOCKS                                           00230000
002400                                                                  00240000
002500 01  MQM-OBJECT-DESCRIPTOR.                                       00250000
002600     COPY CMQODV.                                                 00260000
002700 01  MQM-MESSAGE-DESCRIPTOR.                                      00270000
002800     COPY CMQMDV.                                                 00280000
002900 01  MQM-GET-MESSAGE-OPTIONS.                                     00290000
003000     COPY CMQGMOV.                                                00300000
003100 01  MQM-PUT-MESSAGE-OPTIONS.                                     00310000
003200     COPY CMQPMOV.                                                00320000
003300                                                                  00330000
003400*    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   00340000
003500*    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          00350000
003600                                                                  00360000
003700 01  MQM-CONSTANTS.                                               00370000
003800     COPY CMQV.                                                   00380000
003900                                                                  00390000
004000 01  DK-DB2-KEYS.                                                 00400000
004100     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    00410000
004200                                                    COMP.         00420000
004300     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00430000
004400     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    00440000
004500                                                    COMP.         00450000
004600     15  DK-LINE-STATUS                 PIC  X(02)  VALUE SPACES. 00460000
004700     05  DK-STORE-NUMBER                PIC  9(04)  VALUE 0.      00470040
004800                                                                  00480040
004900                                                                  00490040
005000 01  PC-PROGRAM-CONSTANTS.                                        00500040
005010     05  PC-SPACE                  PIC  X(01)  VALUE ' '.         00501063
005100     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE605A  '.  00510040
005200     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM605 '.  00520040
005300     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS605'.  00530040
005400     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'CEKCS609'.  00540040
005500     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00550040
005600     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00560040
005700     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00570040
005800     05  PC-ONE                    PIC S9(01)  VALUE +1.          00580040
005900     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00590040
006000     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +12          00600040
006100                                               COMP SYNC.         00610040
006200     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +1           00620040
006300                                               COMP SYNC.         00630040
006400     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00640040
006500                                               COMP-3.            00650040
006600     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00660040
006700                                               COMP SYNC.         00670040
006800     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00680040
006900                                               COMP-3.            00690040
007000     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00700040
007100     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00710040
007200     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00720040
007300     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00730040
007400     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00740040
007500     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00750040
007600     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00760040
007700                                               COMP.              00770040
007800     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00780040
007900     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00790040
008000     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00800040
008100     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00810040
008200     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00820040
008300     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00830040
008400     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00840040
008500     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00850040
008600     05  PC-01                     PIC  X(02)  VALUE '01'.        00860040
008700     05  PC-MQCOMMIT               PIC X(08)   VALUE 'CSQBCOMM'.  00870040
008800     05  PC-MQCONN                 PIC X(08)   VALUE 'CSQCCONN'.  00880040
008900     05  PC-MQOPEN                 PIC X(08)   VALUE 'CSQCOPEN'.  00890040
009000     05  PC-MQINQ                  PIC X(08)   VALUE 'CSQCINQ'.   00900040
009100     05  PC-MQGET                  PIC X(08)   VALUE 'CSQCGET'.   00910040
009200     05  PC-MQPUT                  PIC X(08)   VALUE 'CSQCPUT'.   00920040
009300     05  PC-MQPUT1                 PIC X(08)   VALUE 'CSQCPUT1'.  00930040
009400     05  PC-MQCLOSE                PIC X(08)   VALUE 'CSQCCLOS'.  00940040
009500     05  PC-MQDISC                 PIC X(08)   VALUE 'CSQCDISC'.  00950040
009600     05  PC-QMGR-NAME              PIC X(04)   VALUE SPACES.      00960040
009700         88  PC-PROD-QMGR-NAME                 VALUE 'QKSP'.      00970040
009800         88  PC-TEST-QMGR-NAME                 VALUE 'QKST'.      00980040
009900         88  PC-QA-QMGR-NAME                   VALUE 'QKSQ'.      00990040
010000*                                                                 01000040
010100*----------------------------------------------------------------*01010040
010200*  DESCRIPTION CONSTANTS                                         *01020040
010300*----------------------------------------------------------------*01030040
010400     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  01040040
010500     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  01050040
010600     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  01060040
010700     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  01070040
010800     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  01080040
010900     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  01090040
011000     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  01100040
011100     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  01110040
011200     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  01120040
011300     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  01130040
011400     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.01140040
011500     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.01150040
011600     05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     01160040
011700                                           VALUE '** UNKNOWN **'. 01170040
011800*                                                                 01180040
011900*----------------------------------------------------------------*01190040
012000*  SYSTEM MESSAGES                                               *01200040
012100*----------------------------------------------------------------*01210040
012200*   00005 = INVALID VALUE                                        *01220040
012300*   00007 = REQUIRED ENTRY                                       *01230040
012400*   00008 = MUST BE NUMERIC                                      *01240040
012500*   00045 = INVALID FUNCTION KEY                                 *01250040
012600*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01260040
012700*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01270040
012800*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01280040
012900*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01290040
013000*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01300040
013100*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01310040
013200*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01320040
013300*   00069 - TOP OF LIST                                          *01330040
013400*   00070 - BOTTOM OF LIST                                       *01340040
013500*   00073 - SKU DOES NOT EXIST                                   *01350040
013600*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01360040
013700*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01370040
013800*   00279 - MORE ITEMS TO DISPLAY                                *01380040
013900*   00746 = INVALID PRINTER DESTINATION                          *01390040
014000*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01400040
014100*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *01410040
014200*   01961 = YOU MUST ENTER THE UNITS                             *01420040
014300*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           01430040
014400*   02225 = CANNOT CONFIRM DISTRIBUTION - PULL CANCELLED          01440040
014500*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01450040
014600*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01460040
014700*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01470040
014800*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01480040
014900*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01490040
015000*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    01500040
015100*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   01510040
015200*   02256 - CANCEL LINE ITEM - PRESS F2 TO CONFIRM                01520040
015300*   02257 - UNCANCEL LINE ITEM - PRESS F2 TO CONFIRM              01530040
015400*   02258 - CONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM       01540040
015500*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01550040
015600*   02260 - CONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM  01560040
015700*   02261 - UNCONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM01570040
015800*   02262 - CONFIRM PULL - PRESS F2 TO CONFIRM                    01580040
015900*   02263 - UNCONFIRM PULL - PRESS F2 TO CONFIRM                  01590040
016000*   02264 - CONFIRM LINE ITEM - PRESS F2 TO CONFIRM               01600040
016100*   02265 - UNCONFIRM LINE ITEM - PRESS F2 TO CONFIRM             01610040
016200*   02266 - ALL SELECTED ITEMS MUST HAVE THE SAME STATUS          01620040
016300*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01630040
016400*   02268 - CANNOT CANCEL/UNCANCEL - LINE(S) ALREADY POSTED/DISTRB01640040
016500*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01650040
016600*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01660040
016700*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01670040
016800*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01680040
016900*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01690040
017000*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01700040
017100*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01710040
017200*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01720040
017300*   02278 = ALL SELECTED LINES MUST HAVE THE SAME STATUS TO PER  *01730040
017400*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01740040
017500*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01750040
017600*   02289 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS DISTRIBTD01760040
017700*   02290 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS POSTED   01770040
017800*   02291 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS CANCELLED01780040
017900*   02303 - ADD FAILED - SELECTION HAS ALREADY BEEN ADDED         01790040
018000*   02304 - LINE ITEM INFO MUST BE ADDED BEFORE ADDING STORE INFO 01800040
018100*   02309 - UPC INFORMATION IS NOT AVAILABLE FOR THIS SKU         01810040
018200*   02310 - SKU INFORMATION IS NOT AVAILABLE FOR THIS UPC         01820040
018300*   02314 - PULL QTY(ROQ) CANNOT BE GREATER THAN CENTRAL STOCK ON 01830040
018400*   02352 - LINES HAVE BEEN ADDED - USE F24 TO ADD STORE DISTRIBUT01840040
018400*   03821 - MAX # OF LINES EXCEEDED FOR THIS CENTRAL STOCK PULL   01841070
018500*   99901 - INVALID COMMAND WAS ENTERED                          *01850040
018600*----------------------------------------------------------------*01860040
018700     05  PC-TSYMSG-NUMBERS.                                       01870040
018800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01880040
018900         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01890040
019000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01900040
019100         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01910040
019200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01920040
019300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01930040
019400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01940040
019500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01950040
019600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01960040
019700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01970040
019800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01980040
019900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01990040
020000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  02000040
020100         10  PC-TSYMSG-00073            PIC  9(05)  VALUE 00073.  02010040
020200         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  02020040
020300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  02030040
020400         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  02040040
020500         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  02050040
020600         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  02060040
020700         10  PC-TSYMSG-00994            PIC  9(05)  VALUE 00994.  02070040
020800         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  02080040
020900         10  PC-TSYMSG-01961            PIC  9(05)  VALUE 01961.  02090040
021000         10  PC-TSYMSG-02224            PIC  9(05)  VALUE 02224.  02100040
021100         10  PC-TSYMSG-02225            PIC  9(05)  VALUE 02225.  02110040
021200         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  02120040
021300         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  02130040
021400         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  02140040
021500         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  02150040
021600         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  02160040
021700         10  PC-TSYMSG-02254            PIC  9(05)  VALUE 02254.  02170040
021800         10  PC-TSYMSG-02255            PIC  9(05)  VALUE 02255.  02180040
021900         10  PC-TSYMSG-02256            PIC  9(05)  VALUE 02256.  02190040
022000         10  PC-TSYMSG-02257            PIC  9(05)  VALUE 02257.  02200040
022100         10  PC-TSYMSG-02258            PIC  9(05)  VALUE 02258.  02210040
022200         10  PC-TSYMSG-02259            PIC  9(05)  VALUE 02259.  02220040
022300         10  PC-TSYMSG-02260            PIC  9(05)  VALUE 02260.  02230040
022400         10  PC-TSYMSG-02261            PIC  9(05)  VALUE 02261.  02240040
022500         10  PC-TSYMSG-02262            PIC  9(05)  VALUE 02262.  02250040
022600         10  PC-TSYMSG-02263            PIC  9(05)  VALUE 02263.  02260040
022700         10  PC-TSYMSG-02264            PIC  9(05)  VALUE 02264.  02270040
022800         10  PC-TSYMSG-02265            PIC  9(05)  VALUE 02265.  02280040
022900         10  PC-TSYMSG-02266            PIC  9(05)  VALUE 02266.  02290040
023000         10  PC-TSYMSG-02267            PIC  9(05)  VALUE 02267.  02300040
023100         10  PC-TSYMSG-02268            PIC  9(05)  VALUE 02268.  02310040
023200         10  PC-TSYMSG-02269            PIC  9(05)  VALUE 02269.  02320040
023300         10  PC-TSYMSG-02270            PIC  9(05)  VALUE 02270.  02330040
023400         10  PC-TSYMSG-02271            PIC  9(05)  VALUE 02271.  02340040
023500         10  PC-TSYMSG-02272            PIC  9(05)  VALUE 02272.  02350040
023600         10  PC-TSYMSG-02273            PIC  9(05)  VALUE 02273.  02360040
023700         10  PC-TSYMSG-02274            PIC  9(05)  VALUE 02274.  02370040
023800         10  PC-TSYMSG-02275            PIC  9(05)  VALUE 02275.  02380040
023900         10  PC-TSYMSG-02276            PIC  9(05)  VALUE 02276.  02390040
024000         10  PC-TSYMSG-02278            PIC  9(05)  VALUE 02278.  02400040
024100         10  PC-TSYMSG-02287            PIC  9(05)  VALUE 02287.  02410040
024200         10  PC-TSYMSG-02288            PIC  9(05)  VALUE 02288.  02420040
024300         10  PC-TSYMSG-02289            PIC  9(05)  VALUE 02289.  02430040
024400         10  PC-TSYMSG-02290            PIC  9(05)  VALUE 02290.  02440040
024500         10  PC-TSYMSG-02291            PIC  9(05)  VALUE 02291.  02450040
024600         10  PC-TSYMSG-02303            PIC  9(05)  VALUE 02303.  02460040
024700         10  PC-TSYMSG-02304            PIC  9(05)  VALUE 02304.  02470040
024800         10  PC-TSYMSG-02309            PIC  9(05)  VALUE 02309.  02480040
024900         10  PC-TSYMSG-02310            PIC  9(05)  VALUE 02310.  02490040
025000         10  PC-TSYMSG-02314            PIC  9(05)  VALUE 02314.  02500040
025100         10  PC-TSYMSG-02352            PIC  9(05)  VALUE 02352.  02510040
025200         10  PC-TSYMSG-02677            PIC  9(05)  VALUE 02677.  02520040
025200         10  PC-TSYMSG-03821            PIC  9(05)  VALUE 03821.  02521070
025300         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02530040
025400                                                                  02540040
025500                                                                  02550040
025600*                    MQ CALL ERROR MESSAGES                       02560040
025700 01  PE-PROGRAM-ERROR-MESSAGES.                                   02570040
025800     05  PE-MQ-ERROR-NUMBER           PIC X(02) VALUE '01'.       02580040
025900     05  PE-MQ-ERROR-MESSAGE.                                     02590040
026000         10  FILLER                   PIC X(08) VALUE             02600040
026100                                                'MQ ERR: '.       02610040
026200         10  PE-MQ-CALL-TYPE          PIC X(7)  VALUE SPACES.     02620040
026300             88  PE-MQ-CONNECT                  VALUE 'MQCONN '.  02630040
026400             88  PE-MQ-OPEN                     VALUE 'MQOPEN '.  02640040
026500             88  PE-MQ-INQ                      VALUE 'MQINQ  '.  02650040
026600             88  PE-MQ-GET                      VALUE 'MQGET  '.  02660040
026700             88  PE-MQ-PUT                      VALUE 'MQPUT  '.  02670040
026800             88  PE-MQ-PUT1                     VALUE 'MQPUT1 '.  02680040
026900             88  PE-MQ-CLOSE                    VALUE 'MQCLOSE'.  02690040
027000             88  PE-MQ-DISCONNECT               VALUE 'MQDISC '.  02700040
027100         10  FILLER                   PIC X(04) VALUE ' OF '.     02710040
027200         10  PE-MQ-QMANAGER           PIC X(05) VALUE SPACES.     02720040
027300         10  FILLER                   PIC X(01) VALUE SPACES.     02730040
027400         10  PE-MQ-QNAME              PIC X(20) VALUE SPACES.     02740040
027500         10  FILLER                   PIC X(10) VALUE             02750040
027600                                        'COMP CDE: '.             02760040
027700         10  PE-MQ-COMPLETION-CODE    PIC 9(04) VALUE ZEROS.      02770040
027800         10  FILLER                   PIC X(01) VALUE SPACES.     02780040
027900         10  FILLER                   PIC X(12) VALUE             02790040
028000                                      'REASON CDE: '.             02800040
028100         10  PE-MQ-REASON-CODE        PIC 9(04) VALUE ZEROS.      02810040
028200         10  FILLER                   PIC X(01) VALUE ' '.        02820040
028300         10  PE-MQ-REASON-DESC        PIC X(30) VALUE SPACES.     02830040
028400     05  PE-MQ-INFORMATIONAL-NUMBER   PIC X(02) VALUE '02'.       02840040
028500     05  PE-MQ-INFO-MESSAGE.                                      02850040
028600         10  FILLER                   PIC X(06) VALUE             02860040
028700                                                'QMGR: '.         02870040
028800         10  PE-MQ-QMGR               PIC X(10) VALUE SPACES.     02880040
028900         10  FILLER                   PIC X(18) VALUE             02890040
029000                                          'STORE STATS MSG: '.    02900040
029100         10  PE-MQ-STATS-MSG          PIC X(1032) VALUE SPACES.   02910040
029200     05  PE-DB2-ERROR-NUMBER          PIC X(02) VALUE '02'.       02920040
029300     05  PE-DB2-ERROR-MESSAGE.                                    02930040
029400         10  FILLER                   PIC X(11) VALUE             02940040
029500                                                'DB2 ERROR: '.    02950040
029600         10  FILLER                   PIC X(08) VALUE             02960040
029700                                                'SQLWARN='.       02970040
029800         10  PE-DB2-WARNING           PIC X(8)  VALUE SPACES.     02980040
029900         10  FILLER                   PIC X(08) VALUE             02990040
030000                                                'SQLCODE='.       03000040
030100         10  PE-DB2-CODE              PIC Z(8)9-  VALUE SPACES.   03010040
030200         10  FILLER                   PIC X(06) VALUE             03020040
030300                                                ' PARA='.         03030040
030400         10  PE-DB2-PARAGRAPH         PIC X(18)  VALUE SPACES.    03040040
030500         10  FILLER                   PIC X(08) VALUE             03050040
030600                                                ' ACTION='.       03060040
030700         10  PE-DB2-ACTION            PIC X(20)  VALUE SPACES.    03070040
030800                                                                  03080040
030900*                                                                 03090040
031000 01  PS-PROGRAM-SWITCHES.                                         03100040
031100     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    03110040
031200         88  PS-NO-ERROR                            VALUE 'N'.    03120040
031300         88  PS-ERROR                               VALUE 'Y'.    03130040
031400     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    03140040
031500         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    03150040
031600         88  PS-BLOCK-ERROR                         VALUE 'N'.    03160040
031700     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE 'N'.    03170040
031800         88  PS-CONFIRM-PROCESSING                  VALUE 'Y'.    03180040
031900         88  PS-NOT-CONFIRM-PROCESSING              VALUE 'N'.    03190040
032000     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    03200040
032100         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    03210040
032200         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    03220040
032300     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    03230040
032400         88  PS-COMMAREA-VALID                      VALUE 'Y'.    03240040
032500         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    03250040
032600     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    03260040
032700         88  PS-DONE                                VALUE 'Y'.    03270040
032800         88  PS-NOT-DONE                            VALUE 'N'.    03280040
032900     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    03290040
033000         88  PS-LIST-END                            VALUE 'Y'.    03300040
033100         88  PS-NO-LIST-END                         VALUE 'N'.    03310040
033200     05  PS-MQ-ERROR-SW                 PIC  X(01)  VALUE 'N'.    03320040
033300         88  PS-MQ-ERROR                            VALUE 'Y'.    03330040
033400         88  PS-NO-MQ-ERROR                         VALUE 'N'.    03340040
033500     05  PS-MQ-SETUP-SW                 PIC  X(01)  VALUE 'N'.    03350040
033600         88  PS-MQ-SETUP-COMPLETE                   VALUE 'Y'.    03360040
033700         88  PS-MQ-SETUP-NOT-COMPLETE               VALUE 'N'.    03370040
033800     05  PS-REDUCE-QTY-SW               PIC  X(01)  VALUE 'N'.    03380040
033900         88  PS-REDUCE-QTY                          VALUE 'Y'.    03390040
034000         88  PS-NO-REDUCE-QTY                       VALUE 'N'.    03400040
034100     05  PS-SKU-NOT-FOUND-SW            PIC  X(01)  VALUE 'N'.    03410040
034200         88  PS-SKU-NOT-FOUND                       VALUE 'Y'.    03420040
034300         88  PS-SKU-FOUND                           VALUE 'N'.    03430040
034400     05  PS-SKU-NOT-PROCESSED-SW        PIC  X(01)  VALUE 'N'.    03440040
034500         88  PS-SKU-NOT-PROCESSED                   VALUE 'Y'.    03450040
034600         88  PS-SKU-PROCESSED                       VALUE 'N'.    03460040
034610     05  PS-PROCESS-MQ-SW               PIC  X(01)  VALUE 'N'.    03461053
034620         88  PS-PROCESS-MQ-YES                      VALUE 'Y'.    03462052
034630         88  PS-PROCESS-MQ-NO                       VALUE 'N'.    03463052
034700*                                                                 03470040
034800 01  PV-PROGRAM-VARIABLES.                                        03480040
034900     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  03490040
035000                                        COMP SYNC.                03500040
035100     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 03510040
035200     05  PV-SUB                         PIC S9(04)  VALUE +0      03520040
035300                                                    COMP SYNC.    03530040
035400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      03540040
035500                                                    COMP SYNC.    03550040
035600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      03560040
035700                                                    COMP-3.       03570040
035800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      03580040
035900                                                    COMP-3.       03590040
036000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      03600040
036100                                                    COMP-3.       03610040
036200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      03620040
036300                                                    COMP-3.       03630040
036400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +1      03640040
036500                                                    COMP-3.       03650040
036600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03660040
036700                                                    COMP-3.       03670040
036800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      03680040
036900                                                    COMP-3.       03690040
037000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03700040
037100                                                    COMP SYNC.    03710040
037200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03720040
037300                                                    COMP SYNC.    03730040
037400     05  PV-ITEM                        PIC S9(04)  VALUE +0      03740040
037500                                                    COMP SYNC.    03750040
037600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03760040
037700                                                    COMP SYNC.    03770040
037800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03780040
037900                                                    COMP SYNC.    03790040
038000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03800040
038100                                                    COMP SYNC.    03810040
038200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03820040
038300                                                    COMP SYNC.    03830040
038400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03840040
038500                                                    COMP SYNC.    03850040
038600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03860040
038700                                                    COMP SYNC.    03870040
038800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03880040
038900                                                    COMP SYNC.    03890040
039000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03900040
039100                                                    COMP SYNC.    03910040
039200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03920040
039300                                                    COMP SYNC.    03930040
039400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03940040
039500                                                    COMP SYNC.    03950040
039600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03960040
039700                                                    COMP SYNC.    03970040
039800     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03980040
039900                                                    COMP SYNC.    03990040
040000     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      04000040
040100                                                    COMP SYNC.    04010040
040200     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      04020040
040300                                                    COMP.         04030040
040400     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      04040040
040500                                                    COMP.         04050040
040600     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      04060040
040700                                                    COMP.         04070040
040600     05  PV-MAX-PULL-LINES              PIC S9(9) COMP VALUE 0.   04071071
040800     05  PV-SOFT-ABORT-MSG.                                       04080040
040900         10  FILLER            PIC X(12) VALUE ' CEKCS605 - '.    04090040
041000         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       04100040
041100         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    04110040
041200         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    04120040
041300         10  PV-SOFT-PARAGRAPH PIC X(30).                         04130040
041400     05  PV-MQ-SOFT-ABORT-MSG.                                    04140040
041500         10  FILLER            PIC X(12) VALUE ' CEKCS605 - '.    04150040
041600         10  FILLER            PIC X(09) VALUE 'RSN CODE '.       04160040
041700         10  PV-REASON-CODE    PIC ZZZZZZZZ9-.                    04170040
041800         10  FILLER            PIC X(03) VALUE ' - '.             04180040
041900         10  PV-MQ-REASON-TXT  PIC X(30).                         04190040
042000         10  FILLER            PIC X(06) VALUE 'PARA: '.          04200040
042100         10  PV-MQ-PARAGRAPH   PIC X(30).                         04210040
042200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     04220040
042300                                                     COMP SYNC.   04230040
042400     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 04240040
042500     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 04250040
042600     05  PV-CICS-MSG-HOLD.                                        04260040
042700         10  FILLER                      PIC  X(01)  VALUE SPACE. 04270040
042800         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 04280040
042900     05  PV-CICS-MSG-HOLD2.                                       04290040
043000         10  FILLER                      PIC  X(01)  VALUE SPACE. 04300040
043100         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 04310040
043200                                                                  04320040
043300                                                                  04330040
043400     05  PV-CREATE-TMST                 PIC X(26)   VALUE SPACES. 04340040
043500     05  PV-CREATE-TMST-R REDEFINES  PV-CREATE-TMST.              04350040
043600         10   PV-CREATE-CC              PIC X(02).                04360040
043700         10   PV-CREATE-YY              PIC X(02).                04370040
043800         10   FILLER                    PIC X(01).                04380040
043900         10   PV-CREATE-MM              PIC X(02).                04390040
044000         10   FILLER                    PIC X(01).                04400040
044100         10   PV-CREATE-DD              PIC X(02).                04410040
044200         10   FILLER                    PIC X(16).                04420040
044300     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      04430040
044400     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             04440040
044500         10  PV-CURRENT-YY         PIC  9(04).                    04450040
044600         10  FILLER                PIC  X(01).                    04460040
044700         10  PV-CURRENT-MM         PIC  9(02).                    04470040
044800         10  FILLER                PIC  X(01).                    04480040
044900         10  PV-CURRENT-DD         PIC  9(02).                    04490040
045000     05  PV-TRANS-SOURCE-DESC.                                    04500040
045100         10  FILLER                PIC  X(05)   VALUE 'PULL '.    04510040
045200         10  PV-TRANS-PULL-NBR     PIC  X(09).                    04520040
045300         10  FILLER                PIC  X(26)   VALUE SPACES.     04530040
045400                                                                  04540040
045500     05  PV-CREATE-MMDDYY.                                        04550040
045600         10   PV-CREATE-EDIT-MM         PIC X(02)   VALUE SPACES. 04560040
045700         10   PV-CREATE-SLASH-1         PIC X(01)   VALUE SPACES. 04570040
045800         10   PV-CREATE-EDIT-DD         PIC X(02)   VALUE SPACES. 04580040
045900         10   PV-CREATE-SLASH-2         PIC X(01)   VALUE SPACES. 04590040
046000         10   PV-CREATE-EDIT-YY         PIC X(02)   VALUE SPACES. 04600040
046100     05  PV-STATUS-MMDDYY.                                        04610040
046200         10   PV-STATUS-EDIT-MM         PIC X(02)   VALUE SPACES. 04620040
046300         10   PV-STATUS-SLASH-1         PIC X(01)   VALUE SPACES. 04630040
046400         10   PV-STATUS-EDIT-DD         PIC X(02)   VALUE SPACES. 04640040
046500         10   PV-STATUS-SLASH-2         PIC X(01)   VALUE SPACES. 04650040
046600         10   PV-STATUS-EDIT-YY         PIC X(02)   VALUE SPACES. 04660040
046700     05  PV-SELECT-FROM-DATE.                                     04670040
046800         10   PV-SELECT-FROM-EDIT-MM    PIC X(02)   VALUE SPACES. 04680040
046900         10   PV-SELECT-FROM-SLASH-1    PIC X(01)   VALUE SPACES. 04690040
047000         10   PV-SELECT-FROM-EDIT-DD    PIC X(02)   VALUE SPACES. 04700040
047100         10   PV-SELECT-FROM-SLASH-2    PIC X(01)   VALUE SPACES. 04710040
047200         10   PV-SELECT-FROM-EDIT-YY    PIC X(04)   VALUE SPACES. 04720040
047300     05  PV-PULL-SOURCE                 PIC X(02)   VALUE SPACES. 04730040
047400         88   PV-SOURCE-ADAM                        VALUE 'AD'.   04740040
047500         88   PV-SOURCE-INFOREM                     VALUE 'IN'.   04750040
047600         88   PV-SOURCE-MANUAL                      VALUE 'MA'.   04760040
047700         88   PV-SOURCE-UNKNOWN                     VALUE SPACES. 04770040
047800     05  PV-PULL-STATUS                 PIC X(02)   VALUE SPACES. 04780040
047900         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   04790040
048000         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   04800040
048100         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   04810040
048200         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   04820040
048300         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   04830040
048400     05  PV-LINE-STATUS                 PIC X(02)   VALUE SPACES. 04840040
048500         88   PV-LINE-STATUS-NEW                    VALUE 'NW'.   04850040
048600         88   PV-LINE-STATUS-CANCELLED              VALUE 'CA'.   04860040
048700         88   PV-LINE-STATUS-INPROCESS              VALUE 'IP'.   04870040
048800         88   PV-LINE-STATUS-DISTRIBTD              VALUE 'DS'.   04880040
048900         88   PV-LINE-STATUS-POSTED                 VALUE 'PD'.   04890040
049000     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  04900040
049100                                                    COMP.         04910040
049200     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  04920040
049300                                                    COMP.         04930040
049400     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  04940040
049500                                                    COMP.         04950040
049600     05  PV-CEPLDS-DISTRB-QTY            PIC S9(09) VALUE ZEROES  04960040
049700                                                    COMP.         04970040
049800     05  PV-CEPLDS-STORE-COUNT           PIC S9(09) VALUE ZEROES  04980040
049900                                                    COMP.         04990040
050000                                                                  05000040
050100     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 05010040
050200         88   PV-TYPE-1-ADAM                        VALUE 'AD'.   05020040
050300         88   PV-TYPE-1-INFOREM                     VALUE 'IN'.   05030040
050400         88   PV-TYPE-1-MANUAL                      VALUE 'MA'.   05040040
050500     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 05050040
050600         88   PV-TYPE-2-ADAM                        VALUE 'AD'.   05060040
050700         88   PV-TYPE-2-INFOREM                     VALUE 'IN'.   05070040
050800         88   PV-TYPE-2-MANUAL                      VALUE 'MA'.   05080040
050900     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 05090040
051000         88   PV-TYPE-3-ADAM                        VALUE 'AD'.   05100040
051100         88   PV-TYPE-3-INFOREM                     VALUE 'IN'.   05110040
051200         88   PV-TYPE-3-MANUAL                      VALUE 'MA'.   05120040
051300                                                                  05130040
051400     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 05140040
051500         88   PV-STATUS-1-NEW                       VALUE 'NW'.   05150040
051600         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   05160040
051700         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   05170040
051800         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   05180040
051900         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   05190040
052000     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 05200040
052100         88   PV-STATUS-2-NEW                       VALUE 'NW'.   05210040
052200         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   05220040
052300         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   05230040
052400         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   05240040
052500         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   05250040
052600     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 05260040
052700         88   PV-STATUS-3-NEW                       VALUE 'NW'.   05270040
052800         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   05280040
052900         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   05290040
053000         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   05300040
053100         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   05310040
053200     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 05320040
053300         88   PV-STATUS-4-NEW                       VALUE 'NW'.   05330040
053400         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   05340040
053500         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   05350040
053600         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   05360040
053700         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   05370040
053800     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 05380040
053900         88   PV-STATUS-5-NEW                       VALUE 'NW'.   05390040
054000         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   05400040
054100         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   05410040
054200         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   05420040
054300         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   05430040
054400                                                                  05440040
054500     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 05450040
054600     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 05460040
054700     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 05470040
054800     05  PV-LINE-NUMBER                  PIC  9(04) VALUE ZEROES. 05480040
054900     05  PV-CEPLIT-ITM-NBR               PIC  9(15) VALUE ZEROES. 05490040
055000     05  PV-SKU-NUMBER                   PIC  9(08) VALUE ZEROES. 05500040
055100     05  PV-SKU-DESCRIPTION              PIC  X(15) VALUE SPACES. 05510040
055200     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 05520040
055300     05  PV-LINE-STATUS-DESC             PIC  X(09) VALUE SPACES. 05530040
055400     05  PV-NBR-STORES                   PIC  9(05) VALUE ZEROES. 05540040
055500     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05550040
055600     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05560040
055700     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 05570040
055800     05  PV-UPDATE-UNITS                 PIC  9(05) VALUE ZEROES. 05580040
055900                                                                  05590040
056000     05  PV-CS-PRINTER-ID                PIC  X(08) VALUE SPACES. 05600040
056100     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 05610040
056200     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 05620040
056300     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 05630040
056400     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 05640040
056500     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 05650040
056600     05  PV-DIST-PULL-UNITS              PIC  9(06) VALUE ZEROES. 05660040
056700                                                                  05670040
056800     05  PV-SEL-TERM-ID                  PIC  X(04).              05680040
056900     05  PV-SEL-TASK-NUMBER              PIC  9(05).              05690040
057000     05  PV-SEL-SEQ                      PIC  9(01).              05700040
057100                                                                  05710040
057200     05  PV-LINES-POSTED-DISTRB          PIC S9(09)  COMP.        05720040
057300     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     05730040
057400                                                     COMP SYNC.   05740040
057500     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      05750040
057600     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      05760040
057700     05  PV-SEL-CNCL-CNT                 PIC S9(09)  COMP-3       05770040
057800                                                     VALUE ZEROES.05780040
057900     05  PV-SEL-UNCNCL-CNT               PIC S9(09)  COMP-3       05790040
058000                                                     VALUE ZEROES.05800040
058100     05  PV-NUMBER-OF-STORES             PIC  9(05)  VALUE ZEROES.05810040
058200     05  PV-4-DIGIT-STORE                PIC  Z(04)  VALUE ZEROES.05820040
058300     05  PV-SELECTED                     PIC S9(09)  VALUE ZEROES 05830040
058400                                                     COMP-3.      05840040
058500     05  PV-QM-NAME                     PIC X(48).                05850040
058600     05  PV-MSGLENGTH            PIC S9(9) BINARY VALUE +1083.    05860040
058700     05  PV-DATA-LENGTH          PIC S9(9) BINARY.                05870040
058800     05  PV-SELECT-COUNT         PIC S9(9) BINARY VALUE 1.        05880040
058900     05  PV-SELECTOR-TABLE.                                       05890040
059000         10  PV-SELECTOR         PIC S9(9) BINARY OCCURS 1 TIMES. 05900040
059100     05  PV-INT-ATTR-COUNT       PIC S9(9) BINARY VALUE 0.        05910040
059200     05  PV-INT-ATTR-TABLE.                                       05920040
059300         10  PV-INT-ATTR         PIC S9(9) BINARY OCCURS 1 TIMES. 05930040
059400     05  PV-CHAR-ATTR-LENGTH     PIC S9(9) BINARY VALUE 48.       05940040
059500     05  PV-CHAR-ATTRS           PIC X(48).                       05950040
059600     05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        05960040
059700     05  PV-GQ-HANDLE            PIC S9(9) BINARY VALUE 0.        05970040
059800     05  PV-PQ-HANDLE            PIC S9(9) BINARY VALUE 0.        05980040
059900     05  PV-OPEN-OPTIONS         PIC S9(9) BINARY.                05990040
060000     05  PV-COMPLETION-CODE      PIC S9(9) BINARY.                06000040
060100     05  PV-REASON               PIC S9(9) BINARY.                06010040
060200     05  PV-CON-REASON           PIC S9(9) BINARY.                06020040
060300     05  PV-OBJECTNAME           PIC X(48).                       06030040
060400     05  PV-OBJECTQMGRNAME       PIC X(48).                       06040040
060500     05  PV-INSUFFIFIENT-QTY     PIC X(40)                        06050040
060600               VALUE 'INSUFFICIENT QUANTITY FOR OPERATION'.       06060040
060700     05  PV-SKU-NOT-FOUND        PIC X(40)                        06070040
060800               VALUE 'SKU NOT FOUND'.                             06080040
060900     05  WS-MQCHECK              PIC  X(08)   VALUE 'MQR2C'.      06090040
061000     05  PV-MQ-REASON-TEXT       PIC  X(30)   VALUE SPACES.       06100040
061100                                                                  06110040
061200******************************************************************06120040
061300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **06130040
061400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **06140040
061500**  APPLICATION-SPECIFIC COMMAREA.                              **06150040
061600******************************************************************06160040
061700 01  LQW-LIST-QUEUE-WORK-AREA.                                    06170040
061800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  06180040
061900     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           06190040
062000                                        INDEXED BY LQW-IDX.       06200040
062100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       06210040
062200         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               06220040
062300         10  LQW-SELECTED-SW            PIC  X(01).               06230040
062400             88  LQW-SELECT                         VALUE 'S'.    06240040
062500             88  LQW-DESELECT                       VALUE ' '.    06250040
062600         10  LQW-ACTION                 PIC  X(03).               06260040
062700             88  LQW-DEL                            VALUE 'DEL'.  06270040
062800             88  LQW-INQ                            VALUE 'INQ'.  06280040
062900             88  LQW-UPD                            VALUE 'UPD'.  06290040
063000             88  LQW-ERR                            VALUE 'ERR'.  06300040
063100             88  LQW-ADD                            VALUE 'ADD'.  06310040
063200         10  LQW-SKU                    PIC  X(08).               06320040
063300         10  LQW-UNITS                  PIC  Z(05).               06330040
063400         10  LQW-AVAIL-UNITS            PIC  Z(05).               06340040
063500         10  LQW-LINE-NBR               PIC  Z(04).               06350040
063600         10  LQW-SKU-DESCRIPTION        PIC  X(25).               06360040
063700         10  LQW-SKU-RETAIL             PIC  Z(05).99.            06370040
063800         10  LQW-LINE-ITEM              PIC  9(15).               06380040
063900                                                                  06390040
064000                                                                  06400040
064100*---------------------------------------------------------------* 06410040
064200* LOGISTICS DOMAIN ACCESS MODULE                                * 06420040
064300*---------------------------------------------------------------* 06430040
064400     COPY XLWS001.                                                06440040
064500                                                                  06450040
064600*---------------------------------------------------------------* 06460040
064700*   LOCATION DOMAIN ACCESS MODULE (XLKUT071)                    * 06470040
064800*---------------------------------------------------------------* 06480040
064900     COPY XLWS071.                                                06490040
065000                                                                  06500040
065100*---------------------------------------------------------------* 06510040
065200* SELECTON QUEUE LAYOUT                                         * 06520040
065300*---------------------------------------------------------------* 06530040
065400     COPY CEWS003.                                                06540040
065500                                                                  06550040
065600*---------------------------------------------------------------* 06560040
065700* MQ SERIES MESSAGE LAYOUT                                      * 06570040
065800*---------------------------------------------------------------* 06580040
065900     COPY CERD016.                                                06590040
066000                                                                  06600040
066100*---------------------------------------------------------------* 06610040
066200*    MAP LAYOUT                                                 * 06620040
066300*---------------------------------------------------------------* 06630040
066400                                                                  06640040
066500     COPY CEKM605.                                                06650040
066600*                                                                 06660040
066700 01  MR-OCCURS-LAYOUT                   REDEFINES  CE605AO.       06670040
066800     05  FILLER                         PIC X(140).               06680040
066900     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          06690040
067000         10  MR-SELECTL                 PIC S9(04) COMP.          06700040
067100         10  MR-SELECTA                 PIC  X(01).               06710040
067200         10  MR-SELECTC                 PIC  X(01).               06720040
067300         10  MR-SELECTH                 PIC  X(01).               06730040
067400         10  MR-SELECTI                 PIC  X(01).               06740040
067500                                                                  06750040
067600         10  MR-ACTIONL                 PIC S9(04) COMP.          06760040
067700         10  MR-ACTIONA                 PIC  X(01).               06770040
067800         10  MR-ACTIONC                 PIC  X(01).               06780040
067900         10  MR-ACTIONH                 PIC  X(01).               06790040
068000         10  MR-ACTION                  PIC  X(03).               06800040
068100                                                                  06810040
068200         10  MR-SKU-NBRL                PIC S9(04) COMP.          06820040
068300         10  MR-SKU-NBRA                PIC  X(01).               06830040
068400         10  MR-SKU-NBRC                PIC  X(01).               06840040
068500         10  MR-SKU-NBRH                PIC  X(01).               06850040
068600         10  MR-SKU-NBR-X.                                        06860040
068700             15  MR-SKU-NBR             PIC  X(08).               06870040
068800                                                                  06880040
068900         10  MR-UNITSL                  PIC S9(04) COMP.          06890040
069000         10  MR-UNITSA                  PIC  X(01).               06900040
069100         10  MR-UNITSC                  PIC  X(01).               06910040
069200         10  MR-UNITSH                  PIC  X(01).               06920040
069300         10  MR-UNITS-X.                                          06930040
069400             15  MR-UNITS               PIC  Z(05).               06940040
069500                                                                  06950040
069600         10  MR-A-UNITSL                PIC S9(04) COMP.          06960040
069700         10  MR-A-UNITSA                PIC  X(01).               06970040
069800         10  MR-A-UNITSC                PIC  X(01).               06980040
069900         10  MR-A-UNITSH                PIC  X(01).               06990040
070000         10  MR-A-UNITS-X.                                        07000040
070100             15  MR-A-UNITS             PIC  Z(05).               07010040
070200                                                                  07020040
070300         10  MR-LINE-NUMBERL            PIC S9(04) COMP.          07030040
070400         10  MR-LINE-NUMBERA            PIC  X(01).               07040040
070500         10  MR-LINE-NUMBERC            PIC  X(01).               07050040
070600         10  MR-LINE-NUMBERH            PIC  X(01).               07060040
070700         10  MR-LINE-NUMBER-X.                                    07070040
070800             15  MR-LINE-NUMBER         PIC  Z(04).               07080040
070900                                                                  07090040
071000         10  MR-SKU-DESCL               PIC S9(04) COMP.          07100040
071100         10  MR-SKU-DESCA               PIC  X(01).               07110040
071200         10  MR-SKU-DESCC               PIC  X(01).               07120040
071300         10  MR-SKU-DESCH               PIC  X(01).               07130040
071400         10  MR-SKU-DESC                PIC  X(25).               07140040
071500                                                                  07150040
071600         10  MR-SKU-RETAILL             PIC S9(04) COMP.          07160040
071700         10  MR-SKU-RETAILA             PIC  X(01).               07170040
071800         10  MR-SKU-RETAILC             PIC  X(01).               07180040
071900         10  MR-SKU-RETAILH             PIC  X(01).               07190040
072000         10  MR-SKU-RETAIL              PIC  Z(05).99.            07200040
072100                                                                  07210040
072200     05  FILLER                         PIC  X(12).               07220040
072300                                                                  07230040
072400                                                                  07240040
072500*----------------------------------------------------------------*07250040
072600*  SENDING/RECEIVING AREA FOR THE                                *07260040
072700*  PRINTER VALIDATION ROUTING (DPKCS060)                         *07270040
072800*----------------------------------------------------------------*07280040
072900     COPY DPWS072.                                                07290040
073000                                                                  07300040
073100                                                                  07310040
073200*---------------------------------------------------------------* 07320040
073300*    ATTRIBUTE SETTINGS COPYBOOK.                               * 07330040
073400*---------------------------------------------------------------* 07340040
073500                                                                  07350040
073600     COPY DPWS015.                                                07360040
073700                                                                  07370040
073800     COPY EPWS000.                                                07380040
073900                                                                  07390040
074000*---------------------------------------------------------------* 07400040
074100*    FUNCTION KEYS COPYBOOK.                                    * 07410040
074200*---------------------------------------------------------------* 07420040
074300                                                                  07430040
074400     COPY DPWS016.                                                07440040
074500                                                                  07450040
074600*---------------------------------------------------------------* 07460040
074700*    NUMERIC EDIT LAYOUT.                                       * 07470040
074800*---------------------------------------------------------------* 07480040
074900                                                                  07490040
075000     COPY DPWS010I.                                               07500040
075100 EJECT                                                            07510040
075200*---------------------------------------------------------------* 07520040
075300*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 07530063
075400*---------------------------------------------------------------* 07540040
075500                                                                  07550040
075600     COPY DPWS030.                                                07560040
075610     COPY DPWS930.                                                07561063
075700 EJECT                                                            07570040
075800*---------------------------------------------------------------* 07580040
075900*    STANDARD COMMAREA.                                         * 07590040
076000*---------------------------------------------------------------* 07600040
076100                                                                  07610040
076200     COPY DPWS020.                                                07620040
076300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07630040
076400                                                                  07640040
076500*---------------------------------------------------------------* 07650040
076600* INTER-APPLICATION COMMAREA.                                   * 07660040
076700*   CEWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 07670040
076800*             SPEC SCREEN.                                      * 07680040
076900*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07690040
077000*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 07700040
077100*   CEWS006 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07710040
077200*             THIS LIST PROGRAMMING -ADD BY SKU/UPC FUNCTION.   * 07720040
077300*---------------------------------------------------------------* 07730040
077400                                                                  07740040
077500         10  INTER-APPL-COMM-AREA       PIC X(200).               07750040
077600     COPY CEWS001.                                                07760040
077700     COPY CEWS002.                                                07770040
077800     COPY CEWS006.                                                07780040
077900*---------------------------------------------------------------* 07790040
078000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 07800040
078100*---------------------------------------------------------------* 07810040
078200         10  ASC-SPECIFIC-COMMAREA.                               07820040
078300             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          07830040
078400             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 07840040
078500                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          07850040
078600             15  ASC-CURR-FCLTY-ID           PIC  X(04).          07860040
078700             15  ASC-CURR-FCLTY-ID-N REDEFINES                    07870040
078800                     ASC-CURR-FCLTY-ID       PIC  9(04).          07880040
078900             15  ASC-CS-LOC                  PIC  X(04).          07890040
079000             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               07900040
079100                 20  ASC-CS-LOC-N            PIC  9(04).          07910040
079200             15  ASC-CS-LOCATION-DESC        PIC  X(25).          07920040
079300             15  ASC-CS-PRINTER-ID           PIC  X(08).          07930040
079400             15  ASC-PULL-NBR                PIC  X(09).          07940040
079500             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           07950040
079600                 20  ASC-PULL-NBR-N          PIC  9(09).          07960040
079700             15  ASC-REF-NBR                 PIC  X(15).          07970040
079800             15  ASC-PULL-STATUS             PIC  X(02).          07980040
079900                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     07990040
080000                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     08000040
080100                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     08010040
080200                 88  ASC-PULL-NEW                 VALUE 'NW'.     08020040
080300                 88  ASC-PULL-POSTED              VALUE 'PD'.     08030040
080400             15  ASC-PULL-TYPE               PIC  X(02).          08040040
080500                 88  ASC-PULL-SRC-ADAM            VALUE 'MA'.     08050040
080600                 88  ASC-PULL-SRC-INFOREM         VALUE 'MR'.     08060040
080700                 88  ASC-PULL-SRC-MANUAL          VALUE 'UC'.     08070040
080710                 88  ASC-PULL-SRC-XFER            VALUE 'XF'.     08071063
080800             15  ASC-LAST-SKU-ENTERED        PIC  X(08).          08080040
080900             15  ASC-LAST-UPC-ENTERED        PIC  X(15).          08090040
081000             15  ASC-USER-ID                 PIC  X(08).          08100040
081100             15  ASC-STORE-NBR               PIC  9(05).          08110040
081200                                                                  08120040
081300             15  FILLER                      PIC  X(109).         08130040
081400*-----------------------------------------------------------------08140040
081500             15  ASC-BLK-SUB                  PIC S9(04) COMP     08150040
081600                                                         SYNC.    08160040
081700             15  ASC-ITEM-SUB                 PIC S9(04) COMP     08170040
081800                                                         SYNC.    08180040
081900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  08190040
082000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  08200040
082100             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  08210040
082200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  08220040
082300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  08230040
082400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     08240040
082500                                                         SYNC.    08250040
082600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  08260040
082700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  08270040
082800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         08280040
082900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     08290040
083000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     08300040
083100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         08310040
083200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     08320040
083300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     08330040
083400             15  ASC-LIST-QUEUE-NAME.                             08340040
083500                 20  ASC-LIST-TERM-ID         PIC  X(04).         08350040
083600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  08360040
083700                 20  ASC-LIST-SEQ             PIC  9(01).         08370040
083800                                                                  08380040
083900             15  ASC-START-ITEM-REQUEST.                          08390040
084000                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         08400040
084100                                                                  08410040
084200             15  ASC-SEL-SUB                  PIC S9(4) COMP.     08420040
084300             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     08430040
084400             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          08440040
084500                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 08450040
084600             15  ASC-SEL-QUEUE-NAME.                              08460040
084700                 20  ASC-SEL-TERM-ID          PIC  X(04).         08470040
084800                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  08480040
084900                 20  ASC-SEL-SEQ              PIC  9(01).         08490040
085000             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  08500040
085100                                                                  08510040
085200*-----------------------------------------------------------------08520040
085300                                                                  08530040
085400             15  ASC-BLOCK-ENTRIES OCCURS 1 TIMES.                08540040
085500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  08550040
085600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   08560040
085700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   08570040
085800                                                                  08580040
085900                 20  ASC-ITEM-ARRAY.                              08590040
086000                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        08600040
086100                         30  ASC-LIST-ITEM-NUMBER                 08610040
086200                                                     PIC S9(09)   08620040
086300                                                     COMP-3.      08630040
086400                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  08640040
086500                             88  ASC-VALID-SELECT    VALUE ' '    08650040
086600                                                           'S'    08660040
086700                                                           'B'    08670040
086800                                                           'E'.   08680040
086900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   08690040
087000                             88  ASC-TEMP-SELECT     VALUE 'S'.   08700040
087100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   08710040
087200                             88  ASC-TEMP-END        VALUE 'E'.   08720040
087300                         30  ASC-SELECTED-SW         PIC  X(01).  08730040
087400                             88  ASC-NO-SELECT       VALUE ' '.   08740040
087500                             88  ASC-SELECT          VALUE 'S'.   08750040
087600                             88  ASC-BEGIN           VALUE 'B'.   08760040
087700                             88  ASC-END             VALUE 'E'.   08770040
087800                         30  ASC-ACTION              PIC  X(03).  08780040
087900                         30  ASC-SKU                 PIC  X(08).  08790040
088000                         30  ASC-SKU-R REDEFINES ASC-SKU.         08800040
088100                             35  ASC-SKU-N           PIC  9(08).  08810040
088200                         30  ASC-UNITS               PIC  X(05).  08820040
088300                         30  ASC-UNITS-R REDEFINES ASC-UNITS.     08830040
088400                             35  ASC-UNITS-N         PIC  9(05).  08840040
088500                         30  ASC-AVAIL-UNITS         PIC  X(05).  08850040
088600                         30  ASC-AVAIL-UNITS-R REDEFINES          08860040
088700                             ASC-AVAIL-UNITS.                     08870040
088800                             35  ASC-AVAIL-UNITS-N   PIC  9(05).  08880040
088900                         30  ASC-LINE-NBR            PIC  X(04).  08890040
089000                         30  ASC-LINE-NBR-R REDEFINES             08900040
089100                                            ASC-LINE-NBR.         08910040
089200                             35  ASC-LINE-NBR-N      PIC  9(04).  08920040
089300                         30  ASC-SKU-DESCRIPTION     PIC  X(25).  08930040
089400                         30  ASC-SKU-RETAIL        PIC  9(05).99. 08940040
089500                         30  ASC-LINE-ITEM         PIC  9(15).    08950040
089600                                                                  08960040
089700     EJECT                                                        08970040
089800*---------------------------------------------------------------* 08980040
089900*    ABEND PROCESSING COPYBOOK.                                 * 08990040
090000*---------------------------------------------------------------* 09000040
090100                                                                  09010040
090200     COPY DPWS013.                                                09020040
090300                                                                  09030040
090400 EJECT                                                            09040040
090500*---------------------------------------------------------------* 09050040
090600*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 09060040
090700*---------------------------------------------------------------* 09070040
090800     EXEC SQL                                                     09080040
090900          INCLUDE TCEPLRQ                                         09090040
091000     END-EXEC.                                                    09100040
091100*---------------------------------------------------------------* 09110040
091200*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 09120040
091300*---------------------------------------------------------------* 09130040
091400     EXEC SQL                                                     09140040
091500          INCLUDE TCEPLDS                                         09150040
091600     END-EXEC.                                                    09160040
091700*---------------------------------------------------------------* 09170040
091800*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 09180040
091900*---------------------------------------------------------------* 09190040
092000     EXEC SQL                                                     09200040
092100          INCLUDE TCEPLIT                                         09210040
092200     END-EXEC.                                                    09220040
092300*---------------------------------------------------------------* 09230040
092400*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 09240040
092500*---------------------------------------------------------------* 09250040
092600     EXEC SQL                                                     09260040
092700          INCLUDE TCEPLST                                         09270040
092800     END-EXEC.                                                    09280040
092900*---------------------------------------------------------------* 09290040
093000*    TSK - UPC TABLE                                            * 09300040
093100*---------------------------------------------------------------* 09310040
093200     EXEC SQL                                                     09320040
093300          INCLUDE TUPCSKU                                         09330040
093400     END-EXEC.                                                    09340040
093500*-----------------------------------------------------------------09350040
093600*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 09360040
093700*-----------------------------------------------------------------09370040
093800     EXEC SQL                                                     09380040
093900          INCLUDE TKRPRPM                                         09390040
094000     END-EXEC.                                                    09400040
094100                                                                  09410040
094200*---------------------------------------------------------------* 09420040
094300*    DB2 AREA FOR COMMUNICATIONS                                * 09430040
094400*---------------------------------------------------------------* 09440040
094500     EXEC SQL                                                     09450040
094600          INCLUDE SQLCA                                           09460040
094700     END-EXEC.                                                    09470040
094800                                                                  09480040
094900*---------------------------------------------------------------* 09490040
095000*    LINE ITEM CURSOR                                           * 09500040
095100*---------------------------------------------------------------* 09510040
095200                                                                  09520040
095300     EXEC SQL                                                     09530040
095400          DECLARE LINE-ITEM-CSR CURSOR FOR                        09540040
095500              SELECT  CNSTK_REQ_PL_NBR                            09550040
095600                     ,PL_LNE_NBR                                  09560040
095700                     ,ITM_NBR                                     09570040
095800                     ,PL_REQ_QTY                                  09580040
095900                     ,ACTL_PL_QTY                                 09590040
096000                     ,STAT_CDE                                    09600040
096100                     ,UNT_RTL_AMT                                 09610040
096200                FROM  TCEPLIT                                     09620040
096300               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          09630040
096400            ORDER BY  PL_LNE_NBR                                  09640040
096500     END-EXEC.                                                    09650040
096600                                                                  09660040
096700                                                                  09670040
096800                                                                  09680040
096900 LINKAGE SECTION.                                                 09690040
097000                                                                  09700040
097100 01  DFHCOMMAREA.                                                 09710040
097200     05  FILLER                         OCCURS  1 TO 4072 TIMES   09720040
097300                                        DEPENDING ON EIBCALEN.    09730040
097400         10  FILLER                     PIC X.                    09740040
097500                                                                  09750040
097600 EJECT                                                            09760040
097700 PROCEDURE DIVISION.                                              09770040
097800******************************************************************09780040
097900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09790040
098000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09800040
098100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09810040
098200******************************************************************09820040
098300 0000-MAIN-MODULE.                                                09830040
098400     INITIALIZE DP030-CICS-API-FIELDS.                            09840040
098400     PERFORM 7010-GET-MAX-LINES.                                  09841073
098500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09850040
098600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09860040
098700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09870040
098800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09880040
098900     MOVE LENGTH OF CE605AI        TO DP030-MAP-LENGTH (1).       09890040
099000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09900040
099100     PERFORM 0001-CALL-CICS-ARCH-API.                             09910040
099200*                                                                 09920040
099300     PERFORM 1000-CONTROL-PROCESSING                              09930040
099400*                                                                 09940040
099500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09950040
099600     PERFORM 0001-CALL-CICS-ARCH-API.                             09960040
099700                                                                  09970040
099800******************************************************************09980040
099900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **09990040
100000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **10000040
100100******************************************************************10010040
100200 0001-CALL-CICS-ARCH-API.                                         10020040
100300     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10030063
100400                                    DFHCOMMAREA                   10040061
100500                                    DP030-CICS-API-FIELDS         10050061
100600                                    DP020-STANDARD-COMMAREA       10060061
100700                                    CE605AI.                      10070061
100800*                                                                 10080040
100900     IF  DP030-RC-CALL-SUCCESSFUL                                 10090040
101000         CONTINUE                                                 10100040
101100     ELSE                                                         10110040
101200         SET DP013-NO-ROLLBACK                                    10120040
101300             DP013-XCTL-DISPLAY-RESTART                           10130040
101400             DP013-CICS-ABEND      TO TRUE                        10140040
101500         MOVE '0001-CALL-CICS-ARCH-API'                           10150040
101600                                   TO DP013-PARAGRAPH             10160040
101610         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10161063
101620-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10162063
101900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10190040
102000         PERFORM DP013-0000-PROCESS-ABEND                         10200040
102100     END-IF.                                                      10210040
102200*----------------------------------------------------------------*10220040
102300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10230040
102400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10240040
102500*                                                                *10250040
102600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10260040
102700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10270040
102800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10280040
102900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10290040
103000*----------------------------------------------------------------*10300040
103100                                                                  10310040
103200 1000-CONTROL-PROCESSING.                                         10320040
103300                                                                  10330040
103400     EVALUATE TRUE                                                10340040
103500         WHEN DP020-NEXT-ACT-INITIAL                              10350040
103600             INITIALIZE ASC-SPECIFIC-COMMAREA                     10360040
103700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10370040
103800                                      ASC-SEL-TERM-ID             10380040
103900             MOVE DP020-SRC-TASK-NUMBER                           10390040
104000                                   TO ASC-LIST-TASK-NUMBER        10400040
104100                                      ASC-SEL-TASK-NUMBER         10410040
104200             MOVE PC-LIST-QUEUE-SEQ                               10420040
104300                                   TO ASC-LIST-SEQ                10430040
104400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 10440040
104500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10450040
104600***-----$TEMPLATE NOTE$-------------------------------------------10460040
104700*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,10470040
104800*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  10480040
104900*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.10490040
105000***---------------------------------------------------------------10500040
105100             IF  PS-COMMAREA-NOT-VALID                            10510040
105200                 SET DP020-NEXT-ACT-APPL-ERROR                    10520040
105300                                   TO TRUE                        10530040
105400             ELSE                                                 10540040
105500                 PERFORM 4000-BUILD-INITIAL-PANEL                 10550040
105600             END-IF                                               10560040
105700                                                                  10570040
105800         WHEN DP020-NEXT-ACT-READ-MAP                             10580040
105900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10590040
106000                                   TO PV-TOP-ITEM                 10600040
106100             PERFORM 2000-PROCESS-PANEL                           10610040
106200                                                                  10620040
106300         WHEN DP020-NEXT-ACT-RETURN                               10630040
106400             MOVE 1  TO  ASC-ITEM-AT-TOP-OF-PANEL                 10640040
106500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10650040
106600                                   TO PV-TOP-ITEM                 10660040
106700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10670040
106800             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 10680040
106900             PERFORM 3200-RESET-ATTRIBUTES                        10690040
107000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10700040
107100                                                                  10710040
107200         WHEN OTHER                                               10720040
107300             SET DP013-LOGIC-ABEND TO TRUE                        10730040
107400             SET DP013-NO-ROLLBACK TO TRUE                        10740040
107500             MOVE '1000-CONTROL-PROCESSING'                       10750040
107600                                   TO DP013-PARAGRAPH             10760040
107700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10770040
107800                                   TO DP013-MESSAGE-TEXT(1)       10780040
107900             PERFORM DP013-0000-PROCESS-ABEND                     10790040
108000     END-EVALUATE.                                                10800040
108100                                                                  10810040
108200                                                                  10820040
108300*----------------------------------------------------------------*10830040
108400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10840040
108500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10850040
108600*----------------------------------------------------------------*10860040
108700 1100-PROCESS-INTER-APPL-COMM.                                    10870040
108800                                                                  10880040
108900     SET PS-COMMAREA-VALID         TO TRUE.                       10890040
109000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     10900040
109100                                                                  10910040
109200     MOVE CE006-CURR-OPER-UNT-ID-N TO ASC-CURR-OPER-UNT-ID-N.     10920040
109300     MOVE CE006-CURR-FCLTY-ID-N    TO ASC-CURR-FCLTY-ID-N.        10930040
109400     MOVE CE006-CS-LOCATION        TO ASC-CS-LOC-N.               10940040
109500     MOVE CE006-CS-PRINTER-ID      TO ASC-CS-PRINTER-ID.          10950040
109600     MOVE CE006-PULL-NBR           TO ASC-PULL-NBR-N.             10960040
109700     MOVE CE006-REF-NBR            TO ASC-REF-NBR.                10970040
109800     MOVE CE006-USER-ID            TO ASC-USER-ID.                10980040
109900     MOVE CE006-STORE-NBR          TO ASC-STORE-NBR.              10990040
109910     MOVE CE006-PULL-TYPE          TO ASC-PULL-TYPE.              10991063
110000                                                                  11000040
110100                                                                  11010040
110200                                                                  11020040
110300                                                                  11030040
110400                                                                  11040040
110500*----------------------------------------------------------------*11050040
110600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11060040
110700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11070040
110800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11080040
110900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11090040
111000* FUNCTION KEYS CAN GET THIS FAR.                                *11100040
111100*----------------------------------------------------------------*11110040
111200                                                                  11120040
111300 2000-PROCESS-PANEL.                                              11130040
111400     EVALUATE TRUE                                                11140040
111500         WHEN DP020-SRC-AID = DP016-CLEAR                         11150040
111600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11160040
111700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11170040
111800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11180040
111900                                                                  11190040
112000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11200040
112100             PERFORM 2050-DELETE-LIST-QUEUE                       11210040
112200             PERFORM 4000-BUILD-INITIAL-PANEL                     11220040
112300                                                                  11230040
112400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11240040
112500             PERFORM 2140-DESELECT-ALL-ITEMS                      11250040
112600*            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11260040
112700                                                                  11270040
112800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11280040
112900             PERFORM 2150-SELECT-ALL-ITEMS                        11290040
113000*            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11300040
113100                                                                  11310040
113200         WHEN OTHER                                               11320040
113300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11330040
113400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11340040
113500                                                                  11350040
113600             IF  PS-NO-ERROR                                      11360040
113700                 SET DP030-CONTINUE-GO                            11370040
113800                                 TO TRUE                          11380040
113900                 PERFORM 2100-CHECK-FUNCTION-KEY                  11390040
114000             ELSE                                                 11400040
114100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11410040
114200                 SET DP030-OVERRIDE-GO                            11420040
114300                                 TO TRUE                          11430040
114400             END-IF                                               11440040
114500     END-EVALUATE.                                                11450040
114600 EJECT                                                            11460040
114700*----------------------------------------------------------------*11470040
114800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *11480040
114900*----------------------------------------------------------------*11490040
115000 2050-DELETE-LIST-QUEUE.                                          11500040
115100                                                                  11510040
115200     EXEC CICS                                                    11520040
115300         DELETEQ TS                                               11530040
115400             QUEUE (ASC-LIST-QUEUE-NAME)                          11540040
115500             RESP  (PV-CICS-RESP)                                 11550040
115600     END-EXEC.                                                    11560040
115700                                                                  11570040
115800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11580040
115900        (PV-CICS-RESP = DFHRESP(QIDERR))                          11590040
116000         CONTINUE                                                 11600040
116100     ELSE                                                         11610040
116200         SET DP013-CICS-ABEND      TO TRUE                        11620040
116300         SET DP013-NO-ROLLBACK     TO TRUE                        11630040
116400                                                                  11640040
116500         MOVE '2050-DELETE-LIST-QUEUE'                            11650040
116600                                   TO DP013-PARAGRAPH             11660040
116700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11670040
116800                                   TO DP013-MESSAGE-TEXT (1)      11680040
116900         PERFORM DP013-0000-PROCESS-ABEND                         11690040
117000     END-IF.                                                      11700040
117100                                                                  11710040
117200     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11720040
117300 EJECT                                                            11730040
117400*----------------------------------------------------------------*11740040
117500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11750040
117600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11760040
117700* CICS ARCHITECTURE API.                                         *11770040
117800*----------------------------------------------------------------*11780040
117900 2100-CHECK-FUNCTION-KEY.                                         11790040
118000                                                                  11800040
118100     EVALUATE TRUE                                                11810040
118200*                                                                 11820040
118300* F13 - ADD LINE ITEMS   (LOCAL-FUNC-01)                          11830040
118400*                                                                 11840040
118500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11850040
118600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11860040
118700                 PERFORM 4700-PROCESS-ADD-FUNCTION                11870040
118800                     VARYING PV-ITEM  FROM 1 BY 1                 11880040
118900                     UNTIL PV-ITEM >  1                           11890040
119000                        OR PS-SOFT-ABORT-ERROR                    11900040
119100                 MOVE  +1  TO  PV-TOP-ITEM                        11910040
119200                               ASC-LIST-ITEM-NUMBER (1 1)         11920040
119300                               ASC-ITEM-AT-TOP-OF-PANEL           11930040
119400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11940040
119500             ELSE                                                 11950040
119600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11960040
119700                 SET DP030-OVERRIDE-GO                            11970040
119800                                   TO TRUE                        11980040
119900                 MOVE PC-TSYMSG-00057                             11990040
120000                                   TO DP020-MSG-NUMBER            12000040
120100                 SET DP020-MSG-WARNING                            12010040
120200                                   TO TRUE                        12020040
120300             END-IF                                               12030040
120400*                                                                 12040040
120500* F17 - ITEM LIST       (LOCAL-FUNC-02)                           12050040
120600*                                                                 12060040
120700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12070040
120800              MOVE  +1  TO  ASC-ITEM-AT-TOP-OF-PANEL              12080040
120900              INITIALIZE CE001-INTER-APPL-COMMAREA                12090040
121000                                                                  12100040
121100              MOVE ASC-CURR-OPER-UNT-ID-N                         12110040
121200                                    TO CE001-CURR-OPER-UNT-ID-N   12120040
121300              MOVE ASC-CURR-FCLTY-ID-N                            12130040
121400                                    TO CE001-CURR-FCLTY-ID-N      12140040
121500              MOVE ASC-CS-LOC       TO CE001-CS-LOCATION          12150040
121600              MOVE ASC-CS-PRINTER-ID                              12160040
121700                                    TO CE001-CS-PRINTER-ID        12170040
121800              MOVE ASC-PULL-NBR-N   TO CE001-PULL-NBR             12180040
121900              MOVE ASC-REF-NBR      TO CE001-REF-NBR              12190040
122000              SET  CE001-SELECT-ALL                               12200040
122100                   CE001-SELECT-SRC-ALL                           12210040
122200                   CE001-LIST-SEQ-CR-DTE TO TRUE                  12220040
122300              MOVE ZEROES           TO CE001-PULL-SELECT-DATE-FROM12230040
122400              MOVE ZEROES           TO CE001-PULL-SELECT-DATE-TO  12240040
122500              MOVE ASC-PULL-STATUS  TO CE001-CURR-PULL-STATUS     12250040
122600              MOVE ASC-PULL-TYPE    TO CE001-CURR-PULL-TYPE       12260040
122700                                                                  12270040
122800*                                                                 12280040
122900* F22 - ADD BU UPC       (LOCAL-FUNC-03)                          12290040
123000*                                                                 12300040
123100         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              12310040
123200                                                                  12320040
123300              MOVE  +1  TO  ASC-ITEM-AT-TOP-OF-PANEL              12330040
123400              INITIALIZE CE006-INTER-APPL-COMMAREA                12340040
123500              MOVE ASC-CURR-OPER-UNT-ID-N                         12350040
123600                                      TO CE006-CURR-OPER-UNT-ID-N 12360040
123700              MOVE ASC-CURR-FCLTY-ID-N                            12370040
123800                                      TO CE006-CURR-FCLTY-ID-N    12380040
123900              MOVE ASC-CS-LOC         TO CE006-CS-LOCATION        12390040
124000              MOVE ASC-CS-PRINTER-ID  TO CE006-CS-PRINTER-ID      12400040
124100              MOVE ASC-PULL-NBR-N     TO CE006-PULL-NBR           12410040
124200              MOVE ASC-REF-NBR        TO CE006-REF-NBR            12420040
124300              MOVE ASC-USER-ID        TO CE006-USER-ID            12430040
124400              MOVE ASC-STORE-NBR      TO CE006-STORE-NBR          12440040
124500*                                                                 12450040
124600* F24 - ADD STORE       (LOCAL-FUNC-04)                           12460040
124700*                                                                 12470040
124800         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              12480040
124900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12490040
125000                 INITIALIZE CE002-INTER-APPL-COMMAREA             12500040
125100                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12510040
125200                                TO CE002-NUMBER-OF-SELECTED-ITEMS 12520040
125300                 MOVE ASC-CURR-OPER-UNT-ID-N                      12530040
125400                                    TO CE002-CURR-OPER-UNT-ID-N   12540040
125500                 MOVE ASC-CURR-FCLTY-ID-N                         12550040
125600                                    TO CE002-CURR-FCLTY-ID-N      12560040
125700                 MOVE ASC-CS-LOC-N                                12570040
125800                                    TO CE002-CS-LOCATION          12580040
125900                 MOVE ASC-CS-PRINTER-ID                           12590040
126000                                    TO CE002-CS-PRINTER-ID        12600040
126100                 MOVE ASC-PULL-NBR-N                              12610040
126200                                    TO CE002-PULL-NBR             12620040
126300                 MOVE ASC-REF-NBR   TO CE002-REF-NBR              12630040
126400                 MOVE ASC-PULL-STATUS                             12640040
126500                                    TO CE002-PULL-SELECT-STATUS   12650040
126510                 MOVE ASC-PULL-TYPE TO CE002-CURR-PULL-TYPE       12651063
126600                 PERFORM 5000-PREPARE-SEL-QUEUE                   12660040
126700             ELSE                                                 12670040
126800                 SET DP030-OVERRIDE-GO                            12680040
126900                                   TO TRUE                        12690040
127000                 MOVE PC-TSYMSG-00057                             12700040
127100                                   TO DP020-MSG-NUMBER            12710040
127200                 SET DP020-MSG-WARNING                            12720040
127300                                   TO TRUE                        12730040
127400             END-IF                                               12740040
127500*                                                                 12750040
127600* ENTER KEY                                                       12760040
127700*                                                                 12770040
127800         WHEN DP020-SRC-AID = DP016-ENTER                         12780040
127900             MOVE +1 TO ASC-BLK-SUB                               12790040
128000             PERFORM 5100-WRITE-TEMP-STORAGE                      12800040
128100             MOVE 1  TO  ASC-LIST-ITEM-NUMBER (1 1)               12810040
128200             MOVE 1  TO  PV-TOP-ITEM                              12820040
128300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12830040
128400*                                                                 12840040
128500* OTHER KEY                                                       12850040
128600*                                                                 12860040
128700         WHEN OTHER                                               12870040
128800             SET DP013-NO-ROLLBACK                                12880040
128900                 DP013-XCTL-DISPLAY-RESTART                       12890040
129000                 DP013-CICS-ABEND  TO TRUE                        12900040
129100             MOVE '2100-CHECK-FUNCTION-KEY'                       12910040
129200                                   TO DP013-PARAGRAPH             12920040
129300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12930040
129400                                   TO DP013-MESSAGE-TEXT (1)      12940040
129500             PERFORM DP013-0000-PROCESS-ABEND                     12950040
129600     END-EVALUATE.                                                12960040
129700*                                                                 12970040
129800*----------------------------------------------------------------*12980040
129900*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12990040
130000*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13000040
130100*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13010040
130200*    MESSAGE.                                                    *13020040
130300*----------------------------------------------------------------*13030040
130400                                                                  13040040
130500 2110-BROWSE-BACKWARD.                                            13050040
130600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13060040
130700         GIVING PV-TOP-ITEM.                                      13070040
130800*                                                                 13080040
130900     IF  ((PV-TOP-ITEM < +1)                                      13090040
131000       OR (PV-TOP-ITEM = +1))                                     13100040
131100         MOVE +1                   TO PV-TOP-ITEM                 13110040
131200*        -- TOP OF LIST --                                        13120040
131300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13130040
131400         SET DP020-MSG-INFORMATIONAL TO TRUE                      13140040
131500     END-IF.                                                      13150040
131600                                                                  13160040
131700 EJECT                                                            13170040
131800*----------------------------------------------------------------*13180040
131900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13190040
132000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13200040
132100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13210040
132200*----------------------------------------------------------------*13220040
132300                                                                  13230040
132400 2120-BROWSE-FORWARD.                                             13240040
132500                                                                  13250040
132600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13260040
132700         GIVING PV-TOP-ITEM.                                      13270040
132800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13280040
132900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13290040
133000                                   TO PV-TOP-ITEM                 13300040
133100*        -- BOTTOM OF LIST --                                     13310040
133200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13320040
133300         SET DP020-MSG-INFORMATIONAL                              13330040
133400                                   TO TRUE                        13340040
133500     ELSE                                                         13350040
133600         COMPUTE PV-BOTTOM-ITEM =                                 13360040
133700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13370040
133800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13380040
133900*            -- BOTTOM OF LIST --                                 13390040
134000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13400040
134100             SET DP020-MSG-INFORMATIONAL                          13410040
134200                                   TO TRUE                        13420040
134300         END-IF                                                   13430040
134400     END-IF.                                                      13440040
134500 EJECT                                                            13450040
134600*----------------------------------------------------------------*13460040
134700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13470040
134800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13480040
134900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13490040
135000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13500040
135100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13510040
135200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13520040
135300*----------------------------------------------------------------*13530040
135400                                                                  13540040
135500 2130-CHECK-FOR-JUMP-BROWSE.                                      13550040
135600     SET PS-NO-ERROR               TO TRUE.                       13560040
135700     IF (ASC-START-ITEM-REQUEST = SPACE)                          13570040
135800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13580040
135900                                   TO PV-TOP-ITEM                 13590040
136000     ELSE                                                         13600040
136100         MOVE ASC-START-ITEM-REQUEST                              13610040
136200                                   TO DP010I-UNEDITED-FIELD       13620040
136300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       13630040
136400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     13640040
136500         SET DP010I-NEGATIVE-NOT-ALLOWED                          13650040
136600                                   TO TRUE                        13660040
136700         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13670063
136710              USING DP010I-NUMERIC-EDIT-AREA                      13671063
136800                                                                  13680040
136900         IF  NOT DP010I-ERROR-DETECTED                            13690040
137000             MOVE DP010I-NUMERIC-FIELD                            13700040
137100                                   TO  ASC-START-ITEM-REQUEST-N   13710040
137200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  13720040
137300                 IF  ASC-START-ITEM-REQUEST-N >                   13730040
137400                                          ASC-NUMBER-OF-ITEMS-READ13740040
137500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         13750040
137600                     COMPUTE PV-TOP-ITEM =                        13760040
137700                             ASC-NUMBER-OF-ITEMS-READ             13770040
137800                             - PC-ITEMS-PER-PANEL + 1             13780040
137900                     IF  PV-TOP-ITEM < +1                         13790040
138000                         MOVE +1   TO PV-TOP-ITEM                 13800040
138100                         MOVE PC-TSYMSG-00070                     13810040
138200                                   TO DP020-MSG-NUMBER            13820040
138300                         SET DP020-MSG-INFORMATIONAL              13830040
138400                                   TO TRUE                        13840040
138500                     END-IF                                       13850040
138600                 ELSE                                             13860040
138700                     MOVE ASC-START-ITEM-REQUEST-N                13870040
138800                                   TO PV-TOP-ITEM                 13880040
138900                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      13890040
139000                     COMPUTE PV-BOTTOM-ITEM =                     13900040
139100                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13910040
139200                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13920040
139300*                        -- BOTTOM OF LIST --                     13930040
139400                         MOVE PC-TSYMSG-00070                     13940040
139500                                   TO DP020-MSG-NUMBER            13950040
139600                         SET DP020-MSG-INFORMATIONAL              13960040
139700                                   TO TRUE                        13970040
139800                     END-IF                                       13980040
139900                 END-IF                                           13990040
140000             ELSE                                                 14000040
140100*                --- VALUE OUT OF RANGE ----                      14010040
140200                 MOVE PC-TSYMSG-00101                             14020040
140300                                   TO DP020-MSG-NUMBER            14030040
140400                 MOVE -1           TO ASEL01L                     14040040
140500                 SET DP030-SET-CURSOR-APPL-1                      14050040
140600                                   TO TRUE                        14060040
140700                 SET DP020-MSG-FATAL                              14070040
140800                                   TO TRUE                        14080040
140900                 SET PS-ERROR      TO TRUE                        14090040
141000             END-IF                                               14100040
141100                                                                  14110040
141200         ELSE                                                     14120040
141300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14130040
141400             MOVE -1               TO ASEL01L                     14140040
141500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14150040
141600             SET DP020-MSG-FATAL   TO TRUE                        14160040
141700             SET PS-ERROR          TO TRUE                        14170040
141800         END-IF                                                   14180040
141900     END-IF.                                                      14190040
142000 EJECT                                                            14200040
142100*----------------------------------------------------------------*14210040
142200*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14220040
142300*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14230040
142400*----------------------------------------------------------------*14240040
142500 2140-DESELECT-ALL-ITEMS.                                         14250040
142600     MOVE +1                       TO ASC-BLK-SUB.                14260040
142700                                                                  14270040
142800     PERFORM 2141-CLEAR-SELECTED-INDS                             14280040
142900         VARYING ASC-ITEM-SUB                                     14290040
143000         FROM 1 BY 1                                              14300040
143100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14310040
143200                                                                  14320040
143300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14330040
143400                                   TO PV-LIST-ITEM-NUMBER.        14340040
143500                                                                  14350040
143600     MOVE  1  TO  PV-FIRST-BLOCK-IN-ARRAY.                        14360040
143700                                                                  14370040
143800     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14380040
143900        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      14390040
144000         MOVE +1                   TO ASC-BLK-SUB                 14400040
144100                                                                  14410040
144200         PERFORM 5100-WRITE-TEMP-STORAGE                          14420040
144300                                                                  14430040
144400         MOVE +1                   TO PV-BLOCK-NUMBER             14440040
144500                                                                  14450040
144600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14460040
144700             PV-FIRST-BLOCK-IN-ARRAY - 1                          14470040
144800                                                                  14480040
144900         PERFORM                                                  14490040
145000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14500040
145100                                                                  14510040
145200             PERFORM 4410-READ-TEMP-STORAGE                       14520040
145300                                                                  14530040
145400             PERFORM 2141-CLEAR-SELECTED-INDS                     14540040
145500                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 14550040
145600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14560040
145700                                                                  14570040
145800             PERFORM 5100-WRITE-TEMP-STORAGE                      14580040
145900                                                                  14590040
146000             ADD +1                TO PV-BLOCK-NUMBER             14600040
146100                                                                  14610040
146200         END-PERFORM                                              14620040
146300                                                                  14630040
146400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14640040
146500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14650040
146600                                                                  14660040
146700         PERFORM                                                  14670040
146800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14680040
146900                   ASC-HIGHEST-BLOCK-WRITTEN                      14690040
147000                                                                  14700040
147100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14710040
147200                                   TO PV-BLOCK-NUMBER             14720040
147300                                                                  14730040
147400             PERFORM 4410-READ-TEMP-STORAGE                       14740040
147500                                                                  14750040
147600             PERFORM 2141-CLEAR-SELECTED-INDS                     14760040
147700                 VARYING ASC-ITEM-SUB                             14770040
147800                 FROM 1 BY 1                                      14780040
147900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14790040
148000                                                                  14800040
148100             PERFORM 5100-WRITE-TEMP-STORAGE                      14810040
148200                                                                  14820040
148300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14830040
148400                                                                  14840040
148500         END-PERFORM                                              14850040
148600                                                                  14860040
148700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14870040
148800                                   TO PV-BLOCK-NUMBER             14880040
148900                                                                  14890040
149000         PERFORM 4410-READ-TEMP-STORAGE                           14900040
149100     END-IF.                                                      14910040
149200                                                                  14920040
149300                                                                  14930040
149400     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 14940040
149500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.14950040
149600     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  14960040
149700                                                                  14970040
149800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14980040
149900                                                                  14990040
150000 EJECT                                                            15000040
150100*----------------------------------------------------------------*15010040
150200*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15020040
150300*----------------------------------------------------------------*15030040
150400                                                                  15040040
150500 2141-CLEAR-SELECTED-INDS.                                        15050040
150600                                                                  15060040
150700     IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)              15070040
150800         SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)              15080040
150900             ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        15090040
151000             ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      15100040
151100                              TO TRUE                             15110040
151200     END-IF.                                                      15120040
151300                                                                  15130040
151400                                                                  15140040
151500*----------------------------------------------------------------*15150040
151600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15160040
151700*  FOR ALL ITEMS.                                                *15170040
151800*----------------------------------------------------------------*15180040
151900                                                                  15190040
152000 2150-SELECT-ALL-ITEMS.                                           15200040
152100                                                                  15210040
152200     INITIALIZE                       PV-SELECTED.                15220040
152300     MOVE +1                       TO ASC-BLK-SUB.                15230040
152400                                                                  15240040
152500     PERFORM 2151-SET-SELECTED-INDS                               15250040
152600         VARYING ASC-ITEM-SUB                                     15260040
152700         FROM 1 BY 1                                              15270040
152800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15280040
152900                                                                  15290040
153000                                                                  15300040
153100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15310040
153200                                   TO PV-LIST-ITEM-NUMBER.        15320040
153300                                                                  15330040
153400         MOVE  1  TO  PV-FIRST-BLOCK-IN-ARRAY.                    15340040
153500                                                                  15350040
153600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15360040
153700        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    15370040
153800         MOVE +1                   TO ASC-BLK-SUB                 15380040
153900                                                                  15390040
154000         PERFORM 5100-WRITE-TEMP-STORAGE                          15400040
154100                                                                  15410040
154200         MOVE +1                   TO PV-BLOCK-NUMBER             15420040
154300                                                                  15430040
154400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15440040
154500             PV-FIRST-BLOCK-IN-ARRAY - 1                          15450040
154600                                                                  15460040
154700         PERFORM                                                  15470040
154800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15480040
154900                                                                  15490040
155000             PERFORM 4410-READ-TEMP-STORAGE                       15500040
155100                                                                  15510040
155200             PERFORM 2151-SET-SELECTED-INDS                       15520040
155300                 VARYING ASC-ITEM-SUB                             15530040
155400                 FROM 1 BY 1                                      15540040
155500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15550040
155600                                                                  15560040
155700             PERFORM 5100-WRITE-TEMP-STORAGE                      15570040
155800                                                                  15580040
155900             ADD +1                TO PV-BLOCK-NUMBER             15590040
156000                                                                  15600040
156100         END-PERFORM                                              15610040
156200                                                                  15620040
156300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15630040
156400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15640040
156500                                                                  15650040
156600         PERFORM                                                  15660040
156700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15670040
156800                   ASC-HIGHEST-BLOCK-WRITTEN                      15680040
156900                                                                  15690040
157000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15700040
157100                                   TO PV-BLOCK-NUMBER             15710040
157200                                                                  15720040
157300             PERFORM 4410-READ-TEMP-STORAGE                       15730040
157400                                                                  15740040
157500             PERFORM 2151-SET-SELECTED-INDS                       15750040
157600                 VARYING ASC-ITEM-SUB                             15760040
157700                 FROM 1 BY 1                                      15770040
157800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15780040
157900                                                                  15790040
158000             PERFORM 5100-WRITE-TEMP-STORAGE                      15800040
158100                                                                  15810040
158200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15820040
158300                                                                  15830040
158400         END-PERFORM                                              15840040
158500                                                                  15850040
158600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15860040
158700                                   TO PV-BLOCK-NUMBER             15870040
158800                                                                  15880040
158900         PERFORM 4410-READ-TEMP-STORAGE                           15890040
159000     END-IF.                                                      15900040
159100                                                                  15910040
159200                                                                  15920040
159300     MOVE PV-SELECTED TO                                          15930040
159400                       ASC-NUMBER-OF-SELECTED-ITEMS.              15940040
159500                                                                  15950040
159600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15960040
159700                                                                  15970040
159800 EJECT                                                            15980040
159900*----------------------------------------------------------------*15990040
160000*    MARK EACH ITEM AS BEING SELECTED.                           *16000040
160100*----------------------------------------------------------------*16010040
160200                                                                  16020040
160300 2151-SET-SELECTED-INDS.                                          16030040
160400                                                                  16040040
160500     IF  ASC-SKU-N(ASC-BLK-SUB ASC-ITEM-SUB) > 0                  16050040
160600         ADD  1  TO  PV-SELECTED                                  16060040
160700         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16070040
160800             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16080040
160900                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16090040
161000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16100040
161100                               TO  TRUE                           16110040
161200         END-IF                                                   16120040
161300     END-IF.                                                      16130040
161400******************************************************************16140040
161500** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **16150040
161600** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **16160040
161700******************************************************************16170040
161800 2200-MOVE-SCREEN-TO-COMMAREA.                                    16180040
161900                                                                  16190040
162000     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             16200040
162100     MOVE +1                       TO PV-SUB.                     16210040
162200*                                                                 16220040
162300     PERFORM 3100-SET-SUBSCRIPTS.                                 16230040
162400     IF  ASEL01L > ZERO                                           16240040
162500         MOVE 1                TO ASC-START-ITEM-REQUEST          16250040
162600     ELSE                                                         16260040
162700         INITIALIZE ASC-START-ITEM-REQUEST                        16270040
162800     END-IF.                                                      16280040
162900                                                                  16290040
163000     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16300040
163100         VARYING PV-SUB                                           16310040
163200         FROM 1 BY 1                                              16320040
163300         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16330040
163400******************************************************************16340040
163500** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**16350040
163600******************************************************************16360040
163700 2210-MOVE-LINES-TO-COMMAREA.                                     16370040
163800                                                                  16380040
163900     IF  MR-SELECTL (PV-SUB) > ZERO                               16390040
164000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16400040
164100         MOVE MR-SELECTI (PV-SUB)                                 16410040
164200                                   TO ASC-TEMP-SELECTED-SW        16420040
164300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16430040
164400     ELSE                                                         16440040
164500                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     16450040
164600                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        16460040
164700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16470040
164800     END-IF.                                                      16480040
164900                                                                  16490040
165000*                                                                 16500040
165100*** SKU NUMBER                                                    16510040
165200*                                                                 16520040
165300     IF  MR-SKU-NBRL (PV-SUB) > ZERO                              16530040
165400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16540040
165500         IF  MR-SKU-NBR (PV-SUB)  > SPACES                        16550040
165600             MOVE MR-SKU-NBR (PV-SUB) TO ASC-SKU                  16560040
165700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16570040
165800             MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) TO           16580040
165900                                    DP010I-UNEDITED-FIELD         16590040
166000             MOVE LENGTH OF ASC-SKU                               16600040
166100                                 TO DP010I-MAXIMUM-DIGITS         16610040
166200             MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS       16620040
166300             SET DP010I-NEGATIVE-NOT-ALLOWED                      16630040
166400                                 TO TRUE                          16640040
166500             CALL DP010I-NUMERIC-EDIT-ROUTINE                     16650063
166510                  USING DP010I-NUMERIC-EDIT-AREA                  16651063
166600                 IF  DP010I-ERROR-DETECTED                        16660040
166700                     CONTINUE                                     16670040
166800                 ELSE                                             16680040
166900                     MOVE DP010I-NUMERIC-FIELD                    16690040
167000                       TO ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB)    16700040
167100                     MOVE ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB)    16710040
167200                       TO MR-SKU-NBR (PV-SUB)                     16720040
167300                 END-IF                                           16730040
167400             END-IF                                               16740040
167500     ELSE                                                         16750040
167600         IF  MR-SKU-NBRA (PV-SUB) = DP015-ERASE-EOF               16760040
167700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         16770040
167800             MOVE ZEROES       TO ASC-SKU-N                       16780040
167900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16790040
168000         END-IF                                                   16800040
168100     END-IF.                                                      16810040
168200                                                                  16820040
168300*                                                                 16830040
168400*** UNITS                                                         16840040
168500*                                                                 16850040
168600     IF  MR-UNITSL (PV-SUB) > ZERO                                16860040
168700         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16870040
168800         MOVE MR-UNITS (PV-SUB) TO ASC-UNITS                      16880040
168900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      16890040
169000         MOVE ASC-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) TO             16900040
169100                                    DP010I-UNEDITED-FIELD         16910040
169200         MOVE LENGTH OF ASC-UNITS                                 16920040
169300                                 TO DP010I-MAXIMUM-DIGITS         16930040
169400         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       16940040
169500         SET DP010I-NEGATIVE-NOT-ALLOWED                          16950040
169600                                 TO TRUE                          16960040
169700         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16970063
169710              USING DP010I-NUMERIC-EDIT-AREA                      16971063
169800             IF  DP010I-ERROR-DETECTED                            16980040
169900                 CONTINUE                                         16990040
170000             ELSE                                                 17000040
170100                 MOVE DP010I-NUMERIC-FIELD                        17010040
170200                   TO ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)      17020040
170300                      MR-UNITS (PV-SUB)                           17030040
170400             END-IF                                               17040040
170500     ELSE                                                         17050040
170600         IF  MR-UNITSA (PV-SUB) = DP015-ERASE-EOF                 17060040
170700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         17070040
170800             MOVE ZEROES       TO ASC-UNITS-N                     17080040
170900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17090040
171000         END-IF                                                   17100040
171100     END-IF.                                                      17110040
171200                                                                  17120040
171300     ADD +1                        TO ASC-ITEM-SUB.               17130040
171400                                                                  17140040
171500******************************************************************17150040
171600** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **17160040
171700** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **17170040
171800******************************************************************17180040
171900 3000-EDIT-DATA-IN-COMMAREA.                                      17190040
171910                                                                  17191042
171920     PERFORM 7000-PROCESS-MQ-CHECK.                               17192043
171930                                                                  17193042
172000     SET PS-NO-ERROR               TO TRUE.                       17200040
172100     PERFORM 3200-RESET-ATTRIBUTES.                               17210040
172200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     17220040
172300                                                                  17230040
172400*-----------------------------------------------------------------17240040
172500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              17250040
172600* EDITTING IS DONE FROM THE BOTTOM UP.                            17260040
172700*-----------------------------------------------------------------17270040
172800                                                                  17280040
172900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17290040
173000         ASC-ITEMS-DISPLAYED - 1.                                 17300040
173100     PERFORM 3100-SET-SUBSCRIPTS.                                 17310040
173200                                                                  17320040
173300     MOVE ASC-CS-LOC-N    TO DK-STORE-NUMBER.                     17330040
173400     PERFORM 4600-GET-STORE-INFORMATION                           17340040
173500                                                                  17350041
173600     EXEC SQL                                                     17360041
173700         SET :PV-CURRENT-DATE = CURRENT DATE                      17370041
173800     END-EXEC.                                                    17380041
173900                                                                  17390041
174000*                                                                 17400040
174100     PERFORM 3300-EDIT-SELECTIONS                                 17410040
174200       VARYING PV-SUB FROM PV-SUB BY -1                           17420040
174300         UNTIL PV-SUB < +1.                                       17430040
174400     IF PS-MQ-SETUP-COMPLETE                                      17440040
174410       AND PS-PROCESS-MQ-YES                                      17441051
174500         PERFORM 8060-MQ-DISCONNECT                               17450040
174600     END-IF.                                                      17460040
174700*                                                                 17470040
174800     MOVE  +1  TO  ASC-START-OF-SELECTED-RANGE.                   17480040
174900     MOVE  +12 TO  ASC-END-OF-SELECTED-RANGE.                     17490040
175000*                                                                 17500040
175100     IF  PS-NO-ERROR                                              17510040
175200         PERFORM 3400-CHECK-RANGE-SEQUENCE                        17520040
175300     END-IF.                                                      17530040
175400*                                                                 17540040
175500     IF  ((PS-NO-ERROR)                                           17550040
175600       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   17560040
175700       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    17570040
175800             PERFORM 3500-MARK-RANGE-AS-SELECTED                  17580040
175900     END-IF.                                                      17590040
176000                                                                  17600040
176100                                                                  17610040
176200*----------------------------------------------------------------*17620040
176300*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17630040
176400*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17640040
176500*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17650040
176600*                                                                *17660040
176700*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17670040
176800*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17680040
176900*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17690040
177000*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17700040
177100*----------------------------------------------------------------*17710040
177200 3100-SET-SUBSCRIPTS.                                             17720040
177300                                                                  17730040
177400*    MOVE  +1                      TO ASC-ITEM-SUB.               17740040
177500*    MOVE  +1                      TO ASC-BLK-SUB.                17750040
177600                                                                  17760040
177700     COMPUTE ASC-ITEM-SUB =                                       17770040
177800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17780040
177900                                                                  17790040
178000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17800040
178100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17810040
178200                                                                  17820040
178300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               17830040
178400     ELSE                                                         17840040
178500         MOVE +1                     TO ASC-BLK-SUB               17850040
178600     END-IF.                                                      17860040
178700                                                                  17870040
178800***  IF  ASC-ITEM-SUB < +1                                        17880040
178900***      MOVE  +1                  TO ASC-ITEM-SUB                17890040
179000***  END-IF.                                                      17900040
179100******************************************************************17910040
179200** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **17920040
179300******************************************************************17930040
179400                                                                  17940040
179500 3200-RESET-ATTRIBUTES.                                           17950040
179600*                                                                 17960040
179700     PERFORM                                                      17970040
179800         VARYING PV-SUB                                           17980040
179900         FROM 1 BY 1                                              17990040
180000         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18000040
180100         MOVE DP015-UNP-ALP-NOR-MDT                               18010040
180200                                   TO MR-SELECTA (PV-SUB)         18020040
180300                                      MR-SKU-NBRA (PV-SUB)        18030040
180400         MOVE DP015-UNP-ALP-NOR-OFF                               18040040
180500                                   TO MR-UNITSA (PV-SUB)          18050040
180600         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         18060040
180700                                      MR-SKU-NBRC (PV-SUB)        18070040
180800                                      MR-UNITSC (PV-SUB)          18080040
180900         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         18090040
181000                                      MR-SKU-NBRH (PV-SUB)        18100040
181100                                      MR-UNITSH (PV-SUB)          18110040
181200         MOVE DP015-ASK-DRK-OFF                                   18120040
181300                                   TO MR-SKU-RETAILA (PV-SUB)     18130040
181400                                      MR-A-UNITSA (PV-SUB)        18140040
181500     END-PERFORM.                                                 18150040
181600******************************************************************18160040
181700** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **18170040
181800** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **18180040
181900** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **18190040
182000** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **18200040
182100******************************************************************18210040
182200 3300-EDIT-SELECTIONS.                                            18220040
182300     IF  ASC-BLK-SUB  < +1                                        18230040
182400         MOVE +1  TO  ASC-BLK-SUB                                 18240040
182500     END-IF.                                                      18250040
182600                                                                  18260040
182700     EVALUATE TRUE                                                18270040
182800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18280040
182900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18290040
183000                 CONTINUE                                         18300040
183100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18310040
183200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18320040
183300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   18330040
183400                 MOVE ASC-TEMP-SELECTED-SW                        18340040
183500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18350040
183600                                TO ASC-SELECTED-SW                18360040
183700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18370040
183800             END-IF                                               18380040
183900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18390040
184000                 = SPACE                                          18400040
184100             EVALUATE TRUE                                        18410040
184200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       18420040
184300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18430040
184400                     MOVE SPACE TO ASC-SELECTED-SW                18440040
184500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18450040
184600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        18460040
184700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    18470040
184800                     MOVE SPACE TO ASC-SELECTED-SW                18480040
184900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18490040
185000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18500040
185100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      18510040
185200                     MOVE SPACE TO ASC-SELECTED-SW                18520040
185300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18530040
185400             END-EVALUATE                                         18540040
185500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18550040
185600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18560040
185700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18570040
185800             END-IF                                               18580040
185900             PERFORM 3310-EDIT-RANGE                              18590040
186000         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18600040
186100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18610040
186200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18620040
186300             END-IF                                               18630040
186400             PERFORM 3310-EDIT-RANGE                              18640040
186500         WHEN OTHER                                               18650040
186600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           18660040
186700             SET DP020-MSG-FATAL    TO TRUE                       18670040
186800             MOVE -1                TO MR-SELECTL (PV-SUB)        18680040
186900             SET DP030-SET-CURSOR-APPL-1                          18690040
187000                                    TO TRUE                       18700040
187100             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        18710040
187200             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        18720040
187300             SET PS-ERROR TO TRUE                                 18730040
187400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18740040
187500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     18750040
187600                 MOVE SPACE         TO ASC-SELECTED-SW            18760040
187700                                        (ASC-BLK-SUB ASC-ITEM-SUB)18770040
187800             END-IF                                               18780040
187900     END-EVALUATE.                                                18790040
188000                                                                  18800040
188100     PERFORM 3305-EDIT-LINES.                                     18810040
188200                                                                  18820040
188300                                                                  18830040
188400     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 18840040
188500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               18850040
188600     IF  ASC-ITEM-SUB < 1                                         18860040
188700         SUBTRACT +1 FROM ASC-BLK-SUB                             18870040
188800         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                18880040
188900     END-IF.                                                      18890040
189000                                                                  18900040
189100                                                                  18910040
189200*----------------------------------------------------------------*18920040
189300*  EDIT SELECTED LINES                                           *18930040
189400*----------------------------------------------------------------*18940040
189500 3305-EDIT-LINES.                                                 18950040
189600                                                                  18960040
189700     IF  ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES              18970040
189800             MOVE  ASC-ITEM-SUB                                   18980040
189900               TO  ASC-LIST-ITEM-NUMBER                           18990040
190000                   (ASC-BLK-SUB ASC-ITEM-SUB)                     19000040
190100     END-IF.                                                      19010040
190200                                                                  19020040
190300     IF  ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES              19030040
190400         MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) TO               19040040
190500                                    DP010I-UNEDITED-FIELD         19050040
190600         MOVE LENGTH OF ASC-SKU                                   19060040
190700                                 TO DP010I-MAXIMUM-DIGITS         19070040
190800         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19080040
190900         SET DP010I-NEGATIVE-NOT-ALLOWED                          19090040
191000                                 TO TRUE                          19100040
191100         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19110063
191110              USING DP010I-NUMERIC-EDIT-AREA                      19111063
191200             IF  DP010I-ERROR-DETECTED                            19120040
191300                 SET PS-ERROR                                     19130040
191400                     DP020-MSG-FATAL TO  TRUE                     19140040
191500                 MOVE PC-TSYMSG-00008                             19150040
191600                                     TO DP020-MSG-NUMBER          19160040
191700                 MOVE DP015-RED      TO MR-SKU-NBRC (PV-SUB)      19170040
191800                 MOVE DP015-REVERSE  TO MR-SKU-NBRH (PV-SUB)      19180040
191900                 MOVE -1             TO MR-SKU-NBRL (PV-SUB)      19190040
192000                 SET DP030-SET-CURSOR-APPL-1                      19200040
192100                                     TO TRUE                      19210040
192200             ELSE                                                 19220040
192300                 MOVE DP010I-NUMERIC-FIELD                        19230040
192400                                     TO ASC-SKU-N                 19240040
192500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19250040
192600                 MOVE  ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB)       19260040
192700                                     TO MR-SKU-NBR (PV-SUB)       19270040
192800             END-IF                                               19280040
192900     ELSE                                                         19290040
193000         MOVE  SPACES  TO  ASC-SKU-DESCRIPTION                    19300040
193100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19310040
193200     END-IF.                                                      19320040
193300                                                                  19330040
193400     IF  ASC-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES            19340040
193500         MOVE ASC-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) TO             19350040
193600                                    DP010I-UNEDITED-FIELD         19360040
193700         MOVE LENGTH OF ASC-UNITS                                 19370040
193800                                 TO DP010I-MAXIMUM-DIGITS         19380040
193900         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19390040
194000         SET DP010I-NEGATIVE-NOT-ALLOWED                          19400040
194100                                 TO TRUE                          19410040
194200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19420063
194210              USING DP010I-NUMERIC-EDIT-AREA                      19421063
194300             IF  DP010I-ERROR-DETECTED                            19430040
194400                 SET PS-ERROR                                     19440040
194500                     DP020-MSG-FATAL TO  TRUE                     19450040
194600                 MOVE PC-TSYMSG-00008                             19460040
194700                                     TO DP020-MSG-NUMBER          19470040
194800                 MOVE DP015-RED      TO MR-UNITSC (PV-SUB)        19480040
194900                 MOVE DP015-REVERSE  TO MR-UNITSH (PV-SUB)        19490040
195000                 MOVE -1             TO MR-UNITSL (PV-SUB)        19500040
195100                 SET DP030-SET-CURSOR-APPL-1                      19510040
195200                                     TO TRUE                      19520040
195300             ELSE                                                 19530040
195400                 MOVE DP010I-NUMERIC-FIELD                        19540040
195500                                     TO ASC-UNITS-N               19550040
195600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19560040
195700                                        MR-UNITS (PV-SUB)         19570040
195800             END-IF                                               19580040
195900     END-IF.                                                      19590040
196000                                                                  19600040
196100     EVALUATE TRUE                                                19610040
196200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              19620040
196300              EVALUATE TRUE                                       19630040
196400                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      19640040
196500                       IF XL071-E-BUS-IND   = 'Y' AND             19650040
196600                          XL071-LOC-TYP-CDE = 'DS' AND            19660040
196700                          PS-MQ-SETUP-NOT-COMPLETE AND            19670047
196710                          PS-PROCESS-MQ-YES                       19671047
196800                           PERFORM 8000-MQ-SETUP                  19680040
196900                       END-IF                                     19690040
197000                       PERFORM 3600-ADD-EDITS                     19700040
197100                  WHEN OTHER                                      19710040
197200                       IF  ASC-SKU-N(ASC-BLK-SUB ASC-ITEM-SUB) > 019720040
197300                           IF XL071-E-BUS-IND   = 'Y' AND         19730040
197400                              XL071-LOC-TYP-CDE = 'DS' AND        19740040
197500                              PS-MQ-SETUP-NOT-COMPLETE AND        19750047
197510                              PS-PROCESS-MQ-YES                   19751047
197600                               PERFORM 8000-MQ-SETUP              19760040
197700                           END-IF                                 19770040
197800                           PERFORM 3650-GET-SKU-INFO              19780040
197900                       END-IF                                     19790040
198000              END-EVALUATE                                        19800040
198100                                                                  19810040
198200         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              19820040
198300              EVALUATE TRUE                                       19830040
198400                  WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      19840040
198500                       PERFORM 3700-ADD-STORE-EDITS               19850040
198600              END-EVALUATE                                        19860040
198700                                                                  19870040
198800         WHEN DP020-SRC-AID = DP016-ENTER                         19880040
198900              IF  ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0        19890040
199000                  IF XL071-E-BUS-IND   = 'Y' AND                  19900040
199100                     XL071-LOC-TYP-CDE = 'DS' AND                 19910040
199200                     PS-MQ-SETUP-NOT-COMPLETE AND                 19920047
199210                     PS-PROCESS-MQ-YES                            19921047
199300                      PERFORM 8000-MQ-SETUP                       19930040
199400                  END-IF                                          19940040
199500                  PERFORM 3650-GET-SKU-INFO                       19950040
199600              END-IF                                              19960040
199700                                                                  19970040
199800     END-EVALUATE.                                                19980040
199900                                                                  19990040
200000                                                                  20000040
200100******************************************************************20010040
200200** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **20020040
200300** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **20030040
200400** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**20040040
200500** THE ENDING.                                                  **20050040
200600******************************************************************20060040
200700 3310-EDIT-RANGE.                                                 20070040
200800     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                20080040
200900         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   20090040
201000             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)20100040
201100                                   TO ASC-SELECTED-SW             20110040
201200                                        (ASC-BLK-SUB ASC-ITEM-SUB)20120040
201300             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 20130040
201400         ELSE                                                     20140040
201500             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20150040
201600                 CONTINUE                                         20160040
201700             ELSE                                                 20170040
201800*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20180040
201900                 MOVE PC-TSYMSG-00054                             20190040
202000                                   TO DP020-MSG-NUMBER            20200040
202100                 SET DP020-MSG-FATAL                              20210040
202200                                   TO TRUE                        20220040
202300                 MOVE -1           TO MR-SELECTL (PV-SUB)         20230040
202400                 SET DP030-SET-CURSOR-APPL-1                      20240040
202500                                   TO TRUE                        20250040
202600                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         20260040
202700                 MOVE DP015-UNDERLINE                             20270040
202800                                   TO MR-SELECTH (PV-SUB)         20280040
202900                 SET PS-ERROR      TO TRUE                        20290040
203000             END-IF                                               20300040
203100         END-IF                                                   20310040
203200     ELSE                                                         20320040
203300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20330040
203400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20340040
203500                                   TO ASC-SELECTED-SW             20350040
203600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20360040
203700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20370040
203800         ELSE                                                     20380040
203900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20390040
204000                 CONTINUE                                         20400040
204100             ELSE                                                 20410040
204200*                -- ONLY ONE END-OF-RANGE ALLOWED --              20420040
204300                 MOVE PC-TSYMSG-00055                             20430040
204400                                   TO DP020-MSG-NUMBER            20440040
204500                 SET DP020-MSG-FATAL                              20450040
204600                                   TO TRUE                        20460040
204700                 MOVE -1           TO MR-SELECTL (PV-SUB)         20470040
204800                 SET DP030-SET-CURSOR-APPL-1                      20480040
204900                                   TO TRUE                        20490040
205000                 SET PS-ERROR      TO TRUE                        20500040
205100             END-IF                                               20510040
205200         END-IF                                                   20520040
205300     END-IF.                                                      20530040
205400*                                                                 20540040
205500******************************************************************20550040
205600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20560040
205700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20570040
205800******************************************************************20580040
205900 3400-CHECK-RANGE-SEQUENCE.                                       20590040
206000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20600040
206100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20610040
206200       AND  ASC-START-OF-SELECTED-RANGE >                         20620040
206300                                         ASC-END-OF-SELECTED-RANGE20630040
206400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20640040
206500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20650040
206600         SET DP020-MSG-FATAL TO TRUE                              20660040
206700         SET PS-ERROR TO TRUE                                     20670040
206800         PERFORM 3410-POSITION-AT-ERROR                           20680040
206900     END-IF.                                                      20690040
207000******************************************************************20700040
207100** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20710040
207200** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20720040
207300** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20730040
207400******************************************************************20740040
207500 3410-POSITION-AT-ERROR.                                          20750040
207600     SET DP030-SET-CURSOR-APPL-1                                  20760040
207700                                   TO TRUE.                       20770040
207800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20780040
207900                    - PV-TOP-ITEM + 1.                            20790040
208000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20800040
208100         CONTINUE                                                 20810040
208200     ELSE                                                         20820040
208300         MOVE -1                   TO MR-SELECTL (PV-SUB)         20830040
208400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20840040
208500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20850040
208600     END-IF.                                                      20860040
208700*                                                                 20870040
208800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20880040
208900                    - PV-TOP-ITEM + 1.                            20890040
209000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20900040
209100         CONTINUE                                                 20910040
209200     ELSE                                                         20920040
209300         MOVE -1                   TO MR-SELECTL (PV-SUB)         20930040
209400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20940040
209500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20950040
209600     END-IF.                                                      20960040
209700 EJECT                                                            20970040
209800*----------------------------------------------------------------*20980040
209900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *20990040
210000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *21000040
210100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *21010040
210200*----------------------------------------------------------------*21020040
210300                                                                  21030040
210400 3500-MARK-RANGE-AS-SELECTED.                                     21040040
210500     MOVE +1                       TO  ASC-BLK-SUB.               21050040
210600     PERFORM 3510-MARK-SELECTED-INDS                              21060040
210700         VARYING ASC-ITEM-SUB                                     21070040
210800         FROM 1 BY 1                                              21080040
210900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21090040
211000                                                                  21100040
211100                                                                  21110040
211200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21120040
211300                                   TO  PV-LIST-ITEM-NUMBER.       21130040
211400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21140040
211500         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21150040
211600               PC-ITEMS-PER-PANEL).                               21160040
211700                                                                  21170040
211800     MOVE ASC-START-OF-SELECTED-RANGE                             21180040
211900                                   TO PV-START-OF-SELECTED-RANGE. 21190040
212000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21200040
212100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21210040
212200               PC-ITEMS-PER-PANEL).                               21220040
212300                                                                  21230040
212400     MOVE ASC-END-OF-SELECTED-RANGE                               21240040
212500                                   TO  PV-END-OF-SELECTED-RANGE.  21250040
212600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21260040
212700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21270040
212800               PC-ITEMS-PER-PANEL).                               21280040
212900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21290040
213000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21300040
213100                                                                  21310040
213200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21320040
213300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21330040
213400         MOVE +1                   TO ASC-BLK-SUB                 21340040
213500         PERFORM 5100-WRITE-TEMP-STORAGE                          21350040
213600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21360040
213700             PV-FIRST-BLOCK-IN-ARRAY - 1                          21370040
213800                                                                  21380040
213900         PERFORM                                                  21390040
214000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21400040
214100                   PV-PREV-BLOCK-IN-ARRAY                         21410040
214200             MOVE PV-FIRST-BLOCK-IN-RANGE                         21420040
214300                                   TO PV-BLOCK-NUMBER             21430040
214400             PERFORM 4410-READ-TEMP-STORAGE                       21440040
214500             PERFORM 3510-MARK-SELECTED-INDS                      21450040
214600                 VARYING ASC-ITEM-SUB                             21460040
214700                 FROM 1 BY 1                                      21470040
214800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21480040
214900             PERFORM 5100-WRITE-TEMP-STORAGE                      21490040
215000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21500040
215100         END-PERFORM                                              21510040
215200                                                                  21520040
215300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21530040
215400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21540040
215500         PERFORM                                                  21550040
215600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21560040
215700                   PV-LAST-BLOCK-IN-RANGE                         21570040
215800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21580040
215900                                   TO PV-BLOCK-NUMBER             21590040
216000             PERFORM 4410-READ-TEMP-STORAGE                       21600040
216100             PERFORM 3510-MARK-SELECTED-INDS                      21610040
216200                 VARYING ASC-ITEM-SUB                             21620040
216300                 FROM 1 BY 1                                      21630040
216400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21640040
216500             PERFORM 5100-WRITE-TEMP-STORAGE                      21650040
216600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21660040
216700         END-PERFORM                                              21670040
216800                                                                  21680040
216900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21690040
217000                                   TO PV-BLOCK-NUMBER             21700040
217100         PERFORM 4410-READ-TEMP-STORAGE                           21710040
217200     END-IF.                                                      21720040
217300                                                                  21730040
217400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21740040
217500                                      ASC-END-OF-SELECTED-RANGE.  21750040
217600                                                                  21760040
217700 EJECT                                                            21770040
217800*----------------------------------------------------------------*21780040
217900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21790040
218000*----------------------------------------------------------------*21800040
218100                                                                  21810040
218200 3510-MARK-SELECTED-INDS.                                         21820040
218300                                                                  21830040
218400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21840040
218500                                ASC-ITEM-SUB) >                   21850040
218600         ASC-START-OF-SELECTED-RANGE)                             21860040
218700     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21870040
218800                                ASC-ITEM-SUB) =                   21880040
218900         ASC-START-OF-SELECTED-RANGE)                             21890040
219000                                                                  21900040
219100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21910040
219200                                    ASC-ITEM-SUB) <               21920040
219300             ASC-END-OF-SELECTED-RANGE)                           21930040
219400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21940040
219500                                    ASC-ITEM-SUB) =               21950040
219600             ASC-END-OF-SELECTED-RANGE)                           21960040
219700                                                                  21970040
219800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21980040
219900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              21990040
220000                               TO TRUE                            22000040
220100             END-IF                                               22010040
220200         END-IF                                                   22020040
220300     END-IF.                                                      22030040
220400                                                                  22040040
220500                                                                  22050040
220600*----------------------------------------------------------------*22060040
220700* ADD EDITS                                                      *22070040
220800*----------------------------------------------------------------*22080040
220900 3600-ADD-EDITS.                                                  22090040
221000                                                                  22100040
221100     IF  ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)  >  SPACES            22110040
221200         CONTINUE                                                 22120040
221300     ELSE                                                         22130040
221400         SET PS-ERROR                                             22140040
221500             DP020-MSG-FATAL          TO TRUE                     22150040
221600          MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER         22160040
221700          MOVE DP015-RED              TO MR-SKU-NBRC (LQW-IDX)    22170040
221800          MOVE DP015-REVERSE          TO MR-SKU-NBRH (LQW-IDX)    22180040
221900          MOVE -1                     TO MR-SKU-NBRL (LQW-IDX)    22190040
222000          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     22200040
222100     END-IF.                                                      22210040
222200                                                                  22220040
222300     MOVE  ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-SKU-NUMBER. 22230040
222400     IF  PS-NO-ERROR                                              22240040
222500* REPLACED THE SKU&UPC RETRIEVAL WITH A CALL TO    WR/IR# 230ZZ   22250040
222600* THE XLKUT001 MODULE                              WR/IR# 230ZZ   22260040
222700*        PERFORM 3610-VALIDATE-SKU                 WR/IR# 230ZZ   22270040
222800*    END-IF.                                       WR/IR# 230ZZ   22280040
222900*    IF  PS-NO-ERROR                               WR/IR# 230ZZ   22290040
223000*        PERFORM 3615-GET-UPC-INFO                 WR/IR# 230ZZ   22300040
223100         PERFORM 3610-GET-SKU-AND-UPC                             22310040
223200     END-IF.                                                      22320040
223300                                                                  22330040
223400     IF  PS-NO-ERROR                                              22340040
223500         IF  ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0           22350040
223600             CONTINUE                                             22360040
223700         ELSE                                                     22370040
223800             SET PS-ERROR                                         22380040
223900                 DP020-MSG-FATAL          TO TRUE                 22390040
224000              MOVE PC-TSYMSG-01961        TO DP020-MSG-NUMBER     22400040
224100              MOVE DP015-RED              TO MR-UNITSC (LQW-IDX)  22410040
224200              MOVE DP015-REVERSE          TO MR-UNITSH (LQW-IDX)  22420040
224300              MOVE -1                     TO MR-UNITSL (LQW-IDX)  22430040
224400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 22440040
224500         END-IF                                                   22450040
224600     END-IF.                                                      22460040
224700                                                                  22470040
224800     IF  PS-NO-ERROR                                              22480040
224900         IF  ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES     22490040
225000             SET PS-ERROR                                         22500040
225100                 DP020-MSG-FATAL          TO TRUE                 22510040
225200              MOVE PC-TSYMSG-02303        TO DP020-MSG-NUMBER     22520040
225300              MOVE DP015-RED              TO MR-SELECTC (LQW-IDX) 22530040
225400              MOVE DP015-REVERSE          TO MR-SELECTH (LQW-IDX) 22540040
225500              MOVE -1                     TO MR-SELECTL (LQW-IDX) 22550040
225600              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 22560040
225700         END-IF                                                   22570040
225800     END-IF.                                                      22580040
225900                                                                  22590040
226000     IF PS-NO-ERROR AND                                           22600040
226100        XL071-E-BUS-IND   = 'Y' AND                               22610040
226200        XL071-LOC-TYP-CDE = 'DS' AND                              22620040
226300        PS-MQ-SETUP-COMPLETE AND                                  22630048
226310        PS-PROCESS-MQ-YES                                         22631048
226400         INITIALIZE CE016-INV-TRANS-RECORD                        22640040
226500         MOVE PV-SKU-NUMBER    TO CE016-SKU-NUMBER                22650040
226600         MOVE ASC-CS-LOC-N     TO CE016-STORE-NUMBER              22660040
226700         SET CE016-TRANS-TYPE-GET TO TRUE                         22670040
226800         SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE                22680040
226900         MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE                22690040
227000         MOVE ZERO             TO CE016-TRANS-RESV-QTY            22700040
227100                                  CE016-TRANS-AVAIL-QTY           22710040
227200         MOVE ASC-PULL-NBR     TO PV-TRANS-PULL-NBR               22720040
227300         MOVE PV-TRANS-SOURCE-DESC                                22730040
227400                               TO CE016-TRANS-SOURCE-DESC         22740040
227500         SET PS-NO-REDUCE-QTY TO TRUE                             22750040
227600         SET PS-SKU-FOUND     TO TRUE                             22760040
227700         SET PS-SKU-PROCESSED TO TRUE                             22770040
227800         PERFORM 8010-MQ-PUT1                                     22780040
227900         IF PS-NO-MQ-ERROR AND                                    22790040
228000            CE016-TRANS-SUCCESSFUL                                22800040
228100             MOVE CE016-TRANS-AVAIL-QTY    TO ASC-AVAIL-UNITS-N   22810040
228200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22820040
228201* 04/28/2010 CT START ADDED '99999'                               22820154
228300             IF ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES   22830054
228310                                                     OR '99999'   22831054
228320* 04/28/2010 CT END                                               22832054
228400                 MOVE CE016-TRANS-AVAIL-QTY  TO ASC-UNITS-N       22840040
228500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22850040
228600             ELSE                                                 22860040
228700                 IF ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) >      22870040
228800                   ASC-AVAIL-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)   22880040
228900                     SET PS-ERROR TO TRUE                         22890040
229000                     MOVE PC-TSYMSG-02314  TO  DP020-MSG-NUMBER   22900040
229100                     MOVE DP015-RED        TO MR-UNITSC (LQW-IDX) 22910040
229200                     MOVE DP015-REVERSE    TO MR-UNITSH (LQW-IDX) 22920040
229300                     MOVE -1               TO MR-UNITSL (LQW-IDX) 22930040
229400                 END-IF                                           22940040
229500             END-IF                                               22950040
229600         ELSE                                                     22960040
229700             MOVE ZERO                     TO ASC-AVAIL-UNITS-N   22970040
229800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22980040
229900             IF PS-SKU-NOT-FOUND                                  22990040
230000                 SET PS-ERROR TO TRUE                             23000040
230100              MOVE  '*** INVALID SKU ***' TO                      23010040
230200                    ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)23020040
230300                 MOVE PC-TSYMSG-02677  TO  DP020-MSG-NUMBER       23030040
230400             END-IF                                               23040040
230500         END-IF                                                   23050040
230600     END-IF.                                                      23060040
230700                                                                  23070040
230800*----------------------------------------------------------------*23080040
230900* CALL THE LOGISTICS DOMAIN MODULE                 WR/IR#230ZZ   *23090040
231000*----------------------------------------------------------------*23100040
231100 3610-GET-SKU-AND-UPC.                                            23110040
231200                                                                  23120040
231300     INITIALIZE XL001-ITEM-COMMAREA.                              23130040
231400     MOVE PV-SKU-NUMBER  TO  XL001-KEY-SKU.                       23140040
231500     SET  XL001-BY-NUMERIC-SKU                                    23150040
231600          XL001-SELECT-SKU                                        23160040
231700          XL001-SELECT-SKU-STR                                    23170040
231800          XL001-SELECT-UPC     TO TRUE.                           23180040
231900                                                                  23190040
232000     CALL XL001-VSM-PGM USING  DFHEIBLK                           23200040
232100                               XL001-COMMAREA                     23210040
232200                               XL001-ITEM-COMMAREA.               23220040
232300     EVALUATE TRUE                                                23230040
232400         WHEN XL001-SUCCESSFUL                                    23240040
232500           IF XL001-GP-QTY > 1                                    23250040
232600              COMPUTE ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB) = 23260040
232700                      XL001-GP-AMT / XL001-GP-QTY                 23270040
232800           ELSE                                                   23280040
232900              MOVE  XL001-UNT-RTL-AMT                             23290040
233000                 TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)    23300040
233100           END-IF                                                 23310040
233200                                                                  23320040
233210           PERFORM 3680-INSPECT-XL001-SKU-DESC                    23321063
233300           MOVE  XL001-SKU-DESC                                   23330040
233400                 TO  ASC-SKU-DESCRIPTION                          23340040
233500                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23350040
233600           MOVE  XL001-ITM-NBR                                    23360040
233700                 TO  ASC-LINE-ITEM  (ASC-BLK-SUB ASC-ITEM-SUB)    23370040
233800         WHEN XL001-SKU-CONTENTION                                23380040
233900         WHEN XL001-SKU-STR-CONTENTION                            23390040
234000         WHEN XL001-UPC-CONTENTION                                23400040
234100             MOVE XL001-SKU-SQLCODE         TO PV-SOFT-SQLCODE    23410040
234200             MOVE '3620-SQL-CHECK-SKU-VIEW' TO PV-SOFT-PARAGRAPH  23420040
234300             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  23430040
234400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23440040
234500               TO PV-COMMAREA-LENGTH                              23450040
234600             EXEC CICS                                            23460040
234700                  WRITEQ TD                                       23470040
234800                   QUEUE  ('CSSL')                                23480040
234900                    FROM  (PV-CICS-MSG-AREA2)                     23490040
235000                  LENGTH  (PV-COMMAREA-LENGTH)                    23500040
235100                    RESP  (PV-CICS-RESP)                          23510040
235200             END-EXEC                                             23520040
235300             MOVE  PC-TSYMSG-00994  TO  DP020-MSG-NUMBER          23530040
235400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              23540040
235500             PERFORM 9900-SOFT-ABORT                              23550040
235600             PERFORM 3640-SQL-CHECK-STR-VIEW                      23560040
235700             PERFORM 3660-SQL-CHECK-UPC-VIEW                      23570040
235800         WHEN OTHER                                               23580040
235900              PERFORM 3620-SQL-CHECK-SKU-VIEW                     23590040
236000     END-EVALUATE.                                                23600040
236100                                                                  23610040
236200*----------------------------------------------------------------*23620040
236300* RC CHECKING FOR SKU VIEW                         WR/IR#230ZZ   *23630040
236400*----------------------------------------------------------------*23640040
236500 3620-SQL-CHECK-SKU-VIEW.                                         23650040
236600     EVALUATE TRUE                                                23660040
236700         WHEN XL001-SKU-SQLCODE = 0                               23670040
236710           PERFORM 3680-INSPECT-XL001-SKU-DESC                    23671063
236800           MOVE  XL001-SKU-DESC                                   23680040
236900                 TO  ASC-SKU-DESCRIPTION                          23690040
237000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     23700040
237100           MOVE  XL001-ITM-NBR                                    23710040
237200                 TO  ASC-LINE-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)     23720040
237300           PERFORM 3640-SQL-CHECK-STR-VIEW                        23730040
237400           PERFORM 3660-SQL-CHECK-UPC-VIEW                        23740040
237500         WHEN XL001-SKU-SQLCODE = +100                            23750040
237600              MOVE  '*** INVALID SKU ***'                         23760040
237700                TO  ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)23770040
237800              MOVE  ZEROES                                        23780040
237900                TO  ASC-LINE-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      23790040
238000              SET PS-ERROR                                        23800040
238100                  DP020-MSG-FATAL TO  TRUE                        23810040
238200              MOVE PC-TSYMSG-00073                                23820040
238300                                    TO DP020-MSG-NUMBER           23830040
238400              MOVE DP015-RED        TO MR-SKU-NBRC (ASC-ITEM-SUB) 23840040
238500              MOVE DP015-REVERSE    TO MR-SKU-NBRH (ASC-ITEM-SUB) 23850040
238600              MOVE -1               TO MR-SKU-NBRL (ASC-ITEM-SUB) 23860040
238700              SET DP030-SET-CURSOR-APPL-1                         23870040
238800                                    TO TRUE                       23880040
238900              PERFORM 3640-SQL-CHECK-STR-VIEW                     23890040
239000              PERFORM 3660-SQL-CHECK-UPC-VIEW                     23900040
239100         WHEN XL001-SKU-CONTENTION                                23910040
239200             MOVE XL001-SKU-SQLCODE         TO PV-SOFT-SQLCODE    23920040
239300             MOVE '3620-SQL-CHECK-SKU-VIEW' TO PV-SOFT-PARAGRAPH  23930040
239400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  23940040
239500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     23950040
239600               TO PV-COMMAREA-LENGTH                              23960040
239700             EXEC CICS                                            23970040
239800                  WRITEQ TD                                       23980040
239900                   QUEUE  ('CSSL')                                23990040
240000                    FROM  (PV-CICS-MSG-AREA2)                     24000040
240100                  LENGTH  (PV-COMMAREA-LENGTH)                    24010040
240200                    RESP  (PV-CICS-RESP)                          24020040
240300             END-EXEC                                             24030040
240400             MOVE  PC-TSYMSG-00994  TO  DP020-MSG-NUMBER          24040040
240500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              24050040
240600             PERFORM 9900-SOFT-ABORT                              24060040
240700             PERFORM 3640-SQL-CHECK-STR-VIEW                      24070040
240800             PERFORM 3660-SQL-CHECK-UPC-VIEW                      24080040
240900         WHEN OTHER                                               24090040
241000              MOVE ' 3620-SQL-CHECK-SKU-VIEW'                     24100040
241100                               TO DP013-PARAGRAPH                 24110040
241200              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           24120040
241300              STRING ' PULL-'           DELIMITED BY SIZE         24130040
241400                     PV-PULL-NUMBER     DELIMITED BY SIZE         24140040
241500                     '  -  LINE-'       DELIMITED BY SIZE         24150040
241600                     PV-LINE-NUMBER     DELIMITED BY SIZE         24160040
241700                     '  -  ITEM NBR-'   DELIMITED BY SIZE         24170040
241800                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         24180040
241900                     '  TRYING TO GET SKU INFORMATION'            24190040
242000                                        DELIMITED BY SIZE         24200040
242100                             INTO DP013-MESSAGE-TEXT (1)          24210040
242200              MOVE XL001-SQLCA TO DP013-SQLCA                     24220040
242300              MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (2)        24230040
242400              SET DP013-DB2-ABEND                                 24240040
242500                  DP013-XCTL-DISPLAY-RESTART                      24250040
242600                                   TO TRUE                        24260040
242700                  PERFORM DP013-0000-PROCESS-ABEND                24270040
242800     END-EVALUATE.                                                24280040
242900                                                                  24290040
243000                                                                  24300040
243100*----------------------------------------------------------------*24310040
243200* CHECK STR VIEW RETURN CODES                      WR/IR# 230ZZ  *24320040
243300*----------------------------------------------------------------*24330040
243400                                                                  24340040
243500 3640-SQL-CHECK-STR-VIEW.                                         24350040
243600                                                                  24360040
243700     EVALUATE TRUE                                                24370040
243800         WHEN XL001-SKU-STR-SQLCODE = 0                           24380040
243900           IF XL001-GP-QTY > 1                                    24390040
244000              COMPUTE ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB) = 24400040
244100                      XL001-GP-AMT / XL001-GP-QTY                 24410040
244200           ELSE                                                   24420040
244300              MOVE  XL001-UNT-RTL-AMT                             24430040
244400                 TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)    24440021
244500           END-IF                                                 24450040
244600              PERFORM 3660-SQL-CHECK-UPC-VIEW                     24460040
244700         WHEN XL001-SKU-STR-SQLCODE = +100                        24470040
244800              MOVE  ZEROES                                        24480040
244900                TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)     24490040
245000              MOVE  ZEROES                                        24500040
245100                TO  ASC-LINE-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      24510040
245200              SET PS-ERROR                                        24520040
245300                  DP020-MSG-FATAL TO  TRUE                        24530040
245400               MOVE PC-TSYMSG-00073                               24540040
245500                                     TO DP020-MSG-NUMBER          24550040
245600               MOVE DP015-RED        TO MR-SKU-NBRC (ASC-ITEM-SUB)24560040
245700               MOVE DP015-REVERSE    TO MR-SKU-NBRH (ASC-ITEM-SUB)24570040
245800               MOVE -1               TO MR-SKU-NBRL (ASC-ITEM-SUB)24580040
245900               SET DP030-SET-CURSOR-APPL-1                        24590040
246000                                     TO TRUE                      24600040
246100              PERFORM 3660-SQL-CHECK-UPC-VIEW                     24610040
246200         WHEN XL001-SKU-STR-CONTENTION                            24620040
246300             MOVE XL001-SKU-STR-SQLCODE     TO PV-SOFT-SQLCODE    24630040
246400             MOVE '3640-SQL-CHECK-STR-VIEW' TO PV-SOFT-PARAGRAPH  24640040
246500             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  24650040
246600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24660040
246700               TO PV-COMMAREA-LENGTH                              24670040
246800             EXEC CICS                                            24680040
246900                  WRITEQ TD                                       24690040
247000                   QUEUE  ('CSSL')                                24700040
247100                    FROM  (PV-CICS-MSG-AREA2)                     24710040
247200                  LENGTH  (PV-COMMAREA-LENGTH)                    24720040
247300                    RESP  (PV-CICS-RESP)                          24730040
247400             END-EXEC                                             24740040
247500             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          24750040
247600             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              24760040
247700             PERFORM 9900-SOFT-ABORT                              24770040
247800             PERFORM 3660-SQL-CHECK-UPC-VIEW                      24780040
247900         WHEN OTHER                                               24790040
248000              MOVE ' 3640-SQL-CHECK-STR-VIEW'                     24800040
248100                               TO DP013-PARAGRAPH                 24810040
248200              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           24820040
248300              STRING ' PULL-'           DELIMITED BY SIZE         24830040
248400                     PV-PULL-NUMBER     DELIMITED BY SIZE         24840040
248500                     '  -  LINE-'       DELIMITED BY SIZE         24850040
248600                     PV-LINE-NUMBER     DELIMITED BY SIZE         24860040
248700                     '  -  ITEM NBR-'   DELIMITED BY SIZE         24870040
248800                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         24880040
248900                     '  TRYING TO GET STR INFORMATION'            24890040
249000                                        DELIMITED BY SIZE         24900040
249100                             INTO DP013-MESSAGE-TEXT (1)          24910040
249200              MOVE XL001-SQLCA TO DP013-SQLCA                     24920040
249300              MOVE 'XLV_STR '  TO DP013-DB2-TABLE-NAME (2)        24930040
249400              SET DP013-DB2-ABEND                                 24940040
249500                  DP013-XCTL-DISPLAY-RESTART                      24950040
249600                                   TO TRUE                        24960040
249700                  PERFORM DP013-0000-PROCESS-ABEND                24970040
249800     END-EVALUATE.                                                24980040
249900                                                                  24990040
250000*----------------------------------------------------------------*25000040
250100* RC CHECKING FOR UPC VIEW                         WR/IR#230ZZ   *25010040
250200*----------------------------------------------------------------*25020040
250300 3660-SQL-CHECK-UPC-VIEW.                                         25030040
250400                                                                  25040040
250500     EVALUATE TRUE                                                25050040
250600         WHEN XL001-UPC-SQLCODE = +0                              25060040
250700              CONTINUE                                            25070040
250800         WHEN XL001-UPC-SQLCODE = -811                            25080040
250900              CONTINUE                                            25090040
251000         WHEN XL001-UPC-SQLCODE = +100                            25100040
251100              SET PS-ERROR                                        25110040
251200                  DP020-MSG-FATAL TO  TRUE                        25120040
251300               MOVE PC-TSYMSG-02309                               25130040
251400                                     TO DP020-MSG-NUMBER          25140040
251500               MOVE DP015-RED        TO MR-SKU-NBRC (ASC-ITEM-SUB)25150040
251600               MOVE DP015-REVERSE    TO MR-SKU-NBRH (ASC-ITEM-SUB)25160040
251700               MOVE -1               TO MR-SKU-NBRL (ASC-ITEM-SUB)25170040
251800               SET DP030-SET-CURSOR-APPL-1                        25180040
251900                                     TO TRUE                      25190040
252000         WHEN OTHER                                               25200040
252100              MOVE ' 3660-SQL-CHECK-UPC-VIEW'                     25210040
252200                               TO DP013-PARAGRAPH                 25220040
252300              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           25230040
252400              STRING ' PULL-'           DELIMITED BY SIZE         25240040
252500                     PV-PULL-NUMBER     DELIMITED BY SIZE         25250040
252600                     '  -  LINE-'       DELIMITED BY SIZE         25260040
252700                     PV-LINE-NUMBER     DELIMITED BY SIZE         25270040
252800                     '  -  ITEM NBR-'   DELIMITED BY SIZE         25280040
252900                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         25290040
253000                     '  TRYING TO GET UPC INFORMATION'            25300040
253100                                        DELIMITED BY SIZE         25310040
253200                             INTO DP013-MESSAGE-TEXT (1)          25320040
253300              MOVE XL001-SQLCA TO DP013-SQLCA                     25330040
253400              MOVE 'XLV_UPC '  TO DP013-DB2-TABLE-NAME (2)        25340040
253500              SET DP013-DB2-ABEND                                 25350040
253600                  DP013-XCTL-DISPLAY-RESTART                      25360040
253700                                   TO TRUE                        25370040
253800                  PERFORM DP013-0000-PROCESS-ABEND                25380040
253900     END-EVALUATE.                                                25390040
254000                                                                  25400040
254100                                                                  25410040
254200*----------------------------------------------------------------*25420040
254300* GET SKU INFORMATION                            WR/IR# 230ZZ    *25430040
254400*----------------------------------------------------------------*25440040
254500 3650-GET-SKU-INFO.                                               25450040
254600     INITIALIZE  XL001-ITEM-COMMAREA.                             25460040
254700                                                                  25470040
254800     MOVE  ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB)                   25480040
254900                              TO PV-SKU-NUMBER.                   25490040
255000     MOVE  PV-SKU-NUMBER      TO XL001-KEY-SKU.                   25500040
255100                                                                  25510040
255200     SET  XL001-BY-NUMERIC-SKU                                    25520040
255300          XL001-SELECT-SKU                                        25530040
255400          XL001-SELECT-SKU-STR  TO TRUE.                          25540040
255500                                                                  25550040
255600     CALL XL001-VSM-PGM USING  DFHEIBLK                           25560040
255700                               XL001-COMMAREA                     25570040
255800                               XL001-ITEM-COMMAREA.               25580040
255900                                                                  25590040
256000     EVALUATE TRUE                                                25600040
256100         WHEN XL001-SUCCESSFUL                                    25610040
256200           IF XL001-GP-QTY > 1                                    25620040
256300              COMPUTE ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB) = 25630040
256400                      XL001-GP-AMT / XL001-GP-QTY                 25640040
256500           ELSE                                                   25650040
256600              MOVE  XL001-UNT-RTL-AMT                             25660040
256700                 TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)    25670021
256800           END-IF                                                 25680040
256810              PERFORM 3680-INSPECT-XL001-SKU-DESC                 25681063
256900              MOVE  XL001-SKU-DESC                                25690040
257000                TO  ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)25700040
257100         WHEN OTHER                                               25710040
257200              PERFORM 3660-CHECK-SQLCODE-SKU-VIEW                 25720040
257300              PERFORM 3670-CHECK-SQLCODE-STR-VIEW                 25730040
257400     END-EVALUATE.                                                25740040
257500                                                                  25750040
257600     IF XL001-SUCCESSFUL AND                                      25760040
257700        XL071-E-BUS-IND   = 'Y' AND                               25770040
257800        XL071-LOC-TYP-CDE = 'DS' AND                              25780040
257900        PS-MQ-SETUP-COMPLETE     AND                              25790049
257910        PS-PROCESS-MQ-YES                                         25791049
258000         INITIALIZE CE016-INV-TRANS-RECORD                        25800040
258100         MOVE PV-SKU-NUMBER    TO CE016-SKU-NUMBER                25810040
258200         MOVE ASC-CS-LOC-N     TO CE016-STORE-NUMBER              25820040
258300         SET CE016-TRANS-TYPE-GET TO TRUE                         25830040
258400         SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE                25840040
258500         MOVE PV-CURRENT-DATE  TO CE016-TRANS-DATE                25850040
258600         MOVE ZERO             TO CE016-TRANS-RESV-QTY            25860040
258700                                  CE016-TRANS-AVAIL-QTY           25870040
258800         MOVE ASC-PULL-NBR     TO PV-TRANS-PULL-NBR               25880040
258900         MOVE PV-TRANS-SOURCE-DESC                                25890040
259000                               TO CE016-TRANS-SOURCE-DESC         25900040
259100         SET PS-NO-REDUCE-QTY TO TRUE                             25910040
259200         SET PS-SKU-FOUND     TO TRUE                             25920040
259300         SET PS-SKU-PROCESSED TO TRUE                             25930040
259400         PERFORM 8010-MQ-PUT1                                     25940040
259500         IF PS-NO-MQ-ERROR AND                                    25950040
259600            CE016-TRANS-SUCCESSFUL                                25960040
259700             MOVE CE016-TRANS-AVAIL-QTY    TO ASC-AVAIL-UNITS-N   25970040
259800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     25980040
259810* 04/28/2010 CT START ADDED '99999'                               25981054
259900             IF ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES   25990040
259910                                                     OR '99999'   25991054
259920* 04/28/2010 CT END                                               25992054
260000                 MOVE CE016-TRANS-AVAIL-QTY  TO ASC-UNITS-N       26000040
260100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     26010040
260200             ELSE                                                 26020040
260300                 IF ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB) >      26030040
260400                   ASC-AVAIL-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)   26040040
260500                     SET PS-ERROR TO TRUE                         26050040
260600                     MOVE PC-TSYMSG-02314  TO  DP020-MSG-NUMBER   26060040
260700                     MOVE DP015-RED        TO MR-UNITSC (LQW-IDX) 26070040
260800                     MOVE DP015-REVERSE    TO MR-UNITSH (LQW-IDX) 26080040
260900                     MOVE -1               TO MR-UNITSL (LQW-IDX) 26090040
261000                 END-IF                                           26100040
261100             END-IF                                               26110040
261200         ELSE                                                     26120040
261300             MOVE ZERO                     TO ASC-AVAIL-UNITS-N   26130040
261400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     26140040
261500             IF PS-SKU-NOT-FOUND                                  26150040
261600                 SET PS-ERROR TO TRUE                             26160040
261700                 MOVE  '*** INVALID SKU ***' TO                   26170040
261800                    ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)26180040
261900                 SET PS-ERROR TO TRUE                             26190040
262000                 MOVE PC-TSYMSG-02677  TO  DP020-MSG-NUMBER       26200040
262100             END-IF                                               26210040
262200         END-IF                                                   26220040
262300     END-IF.                                                      26230040
262400                                                                  26240040
262500*----------------------------------------------------------------*26250040
262600* RETURN CODE CHECK FOR SKU                      WR/IR# 230ZZ    *26260040
262700*----------------------------------------------------------------*26270040
262800 3660-CHECK-SQLCODE-SKU-VIEW.                                     26280040
262900     EVALUATE TRUE                                                26290040
263000         WHEN XL001-SKU-SQLCODE = +0                              26300040
263010              PERFORM 3680-INSPECT-XL001-SKU-DESC                 26301063
263100              MOVE  XL001-SKU-DESC                                26310040
263200                TO  ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)26320040
263300              PERFORM 3670-CHECK-SQLCODE-STR-VIEW                 26330040
263400         WHEN XL001-SKU-SQLCODE = +100                            26340040
263500              MOVE  '*** INVALID SKU ***'                         26350040
263600                TO  ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)26360040
263700              PERFORM 3670-CHECK-SQLCODE-STR-VIEW                 26370040
263800         WHEN OTHER                                               26380040
263900              MOVE ' 3650-GET-SKU-INFO'                           26390040
264000                               TO DP013-PARAGRAPH                 26400040
264100              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           26410040
264200              STRING ' PULL-'           DELIMITED BY SIZE         26420040
264300                     PV-PULL-NUMBER     DELIMITED BY SIZE         26430040
264400                     '  -  LINE-'       DELIMITED BY SIZE         26440040
264500                     PV-LINE-NUMBER     DELIMITED BY SIZE         26450040
264600                     '  -  ITEM NBR-'   DELIMITED BY SIZE         26460040
264700                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         26470040
264800                     '  TRYING TO GET SKU INFORMATION'            26480040
264900                                        DELIMITED BY SIZE         26490040
265000                             INTO DP013-MESSAGE-TEXT (1)          26500040
265100              MOVE SQLCA       TO DP013-SQLCA                     26510040
265200              MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (2)        26520040
265300              SET DP013-DB2-ABEND                                 26530040
265400                  DP013-XCTL-DISPLAY-RESTART                      26540040
265500                                   TO TRUE                        26550040
265600                  PERFORM DP013-0000-PROCESS-ABEND                26560040
265700     END-EVALUATE.                                                26570040
265800                                                                  26580040
265900                                                                  26590040
266000*----------------------------------------------------------------*26600040
266100* RETURN CODE CHECK FOR SKU STR VIEW             WR/IR# 230ZZ    *26610040
266200*----------------------------------------------------------------*26620040
266300 3670-CHECK-SQLCODE-STR-VIEW.                                     26630040
266400                                                                  26640040
266500     EVALUATE TRUE                                                26650040
266600         WHEN XL001-SKU-STR-SQLCODE = +0                          26660040
266700           IF XL001-GP-QTY > 1                                    26670040
266800              COMPUTE ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB) = 26680040
266900                      XL001-GP-AMT / XL001-GP-QTY                 26690040
267000           ELSE                                                   26700040
267100              MOVE  XL001-UNT-RTL-AMT                             26710040
267200                 TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)    26720021
267300           END-IF                                                 26730040
267400         WHEN XL001-SKU-STR-SQLCODE = +100                        26740040
267500              MOVE  ZEROES                                        26750040
267600                TO  ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)     26760040
267700         WHEN OTHER                                               26770040
267800              MOVE ' 3670-CHECK-SQLCODE-STR-VIEW'                 26780040
267900                               TO DP013-PARAGRAPH                 26790040
268000              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           26800040
268100              STRING ' PULL-'           DELIMITED BY SIZE         26810040
268200                     PV-PULL-NUMBER     DELIMITED BY SIZE         26820040
268300                     '  -  LINE-'       DELIMITED BY SIZE         26830040
268400                     PV-LINE-NUMBER     DELIMITED BY SIZE         26840040
268500                     '  -  ITEM NBR-'   DELIMITED BY SIZE         26850040
268600                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         26860040
268700                     '  TRYING TO GET STR INFORMATION'            26870040
268800                                        DELIMITED BY SIZE         26880040
268900                             INTO DP013-MESSAGE-TEXT (1)          26890040
269000              MOVE SQLCA       TO DP013-SQLCA                     26900040
269100              MOVE 'XLV_STR '  TO DP013-DB2-TABLE-NAME (2)        26910040
269200              SET DP013-DB2-ABEND                                 26920040
269300                  DP013-XCTL-DISPLAY-RESTART                      26930040
269400                                   TO TRUE                        26940040
269500                  PERFORM DP013-0000-PROCESS-ABEND                26950040
269600     END-EVALUATE.                                                26960040
269700                                                                  26970040
269800*----------------------------------------------------------------*26980040
269900* INSPECT THE SKU DESCRIPTION FROM XLKUT001 TO CONVERT INVALID   *26990063
269910* CHARACTERS TO SPACES.                                          *26991063
270000*----------------------------------------------------------------*27000040
270100 3680-INSPECT-XL001-SKU-DESC.                                     27010063
270200                                                                  27020040
270202     MOVE SPACE TO  PC-SPACE.                                     27020263
270203     INSPECT XL001-SKU-DESC      REPLACING ALL                    27020363
270204         quote BY PC-SPACE.                                       27020463
270205     INSPECT XL001-SKU-DESC      REPLACING ALL                    27020563
270206         '&'   BY PC-SPACE.                                       27020663
270207     INSPECT XL001-SKU-DESC      REPLACING ALL                    27020763
270208         '"'   BY PC-SPACE.                                       27020863
270209     INSPECT XL001-SKU-DESC      REPLACING ALL                    27020963
270210         '<'   BY PC-SPACE.                                       27021063
270211     INSPECT XL001-SKU-DESC      REPLACING ALL                    27021163
270212         '>'   BY PC-SPACE.                                       27021263
270213*-------------------------                                        27021363
270214* ADDED CHECK FOR HEX 05                                          27021466
270215*-------------------------                                        27021563
270216     INSPECT XL001-SKU-DESC      REPLACING ALL                    27021663
270217         '	'   BY PC-SPACE.                                       27021766
270218     INSPECT XL001-SKU-DESC      REPLACING ALL                    27021863
270219         ''   BY PC-SPACE.                                       27021963
270220     INSPECT XL001-SKU-DESC      REPLACING ALL                    27022063
270221         ';'   BY PC-SPACE.                                       27022163
270222     INSPECT XL001-SKU-DESC      REPLACING ALL                    27022263
270223         LOW-VALUES BY PC-SPACE.                                  27022363
270224*-------------------------                                        27022463
270225* ADDED CHECK FOR HEX 3F                                          27022563
270226*-------------------------                                        27022663
270227     INSPECT XL001-SKU-DESC      REPLACING ALL                    27022763
270228         ''   BY PC-SPACE.                                       27022863
270229*-------------------------                                        27022963
270230* ADDED CHECK FOR HEX 71                                          27023063
270231*-------------------------                                        27023163
270232     INSPECT XL001-SKU-DESC      REPLACING ALL                    27023263
270233         ''   BY PC-SPACE.                                       27023363
270236                                                                  27023663
270237*----------------------------------------------------------------*27023763
270238* ADD STORE EDITS                                                *27023863
270240*----------------------------------------------------------------*27024063
270250 3700-ADD-STORE-EDITS.                                            27025063
270260                                                                  27026063
270300     IF  PS-NO-ERROR                                              27030040
270400         IF  ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES     27040040
270500             CONTINUE                                             27050040
270600         ELSE                                                     27060040
270700             SET PS-ERROR                                         27070040
270800                 DP020-MSG-FATAL          TO TRUE                 27080040
270900              MOVE PC-TSYMSG-02304        TO DP020-MSG-NUMBER     27090040
271000              MOVE DP015-RED              TO MR-SELECTC (PV-SUB)  27100040
271100              MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)  27110040
271200              MOVE -1                     TO MR-SELECTL (PV-SUB)  27120040
271300              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 27130040
271400         END-IF                                                   27140040
271500     END-IF.                                                      27150040
271600                                                                  27160040
271700                                                                  27170040
271800                                                                  27180040
271900*----------------------------------------------------------------*27190040
272000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *27200040
272100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *27210040
272200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *27220040
272300*    DISPLAY THE PANEL TO USER.                                  *27230040
272400*----------------------------------------------------------------*27240040
272500 4000-BUILD-INITIAL-PANEL.                                        27250040
272600                                                                  27260040
272700     INITIALIZE                 ASC-BLOCK-ENTRIES (1)             27270040
272800     MOVE 1                  TO ASC-LIST-ITEM-NUMBER(1 1).        27280040
272900     MOVE +1                 TO ASC-BLK-SUB.                      27290040
273000                                                                  27300040
273100     MOVE +0                 TO ASC-ITEM-SUB                      27310040
273200                                ASC-NUMBER-OF-ITEMS-READ          27320040
273300                                ASC-NUMBER-OF-SELECTED-ITEMS      27330040
273400                                ASC-HIGHEST-BLOCK-WRITTEN         27340040
273500                                ASC-START-OF-SELECTED-RANGE       27350040
273600                                ASC-END-OF-SELECTED-RANGE         27360040
273700                                ASC-ITEM-AT-TOP-OF-PANEL.         27370040
273800     MOVE  +12               TO ASC-NUMBER-OF-ITEMS-READ.         27380040
273900                                                                  27390040
274000                                                                  27400040
274100     MOVE -1                 TO MR-SELECTL (1)                    27410040
274200     SET DP030-SET-CURSOR-APPL-1                                  27420040
274300                             TO TRUE                              27430040
274400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        27440040
274500                                                                  27450040
274600                                                                  27460040
274700                                                                  27470040
274800                                                                  27480040
274900*----------------------------------------------------------------*27490040
275000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *27500040
275100*----------------------------------------------------------------*27510040
275200                                                                  27520040
275300 4400-MOVE-COMMAREA-TO-SCREEN.                                    27530040
275400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             27540040
275500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1))))         27550040
275600             MOVE +1    TO ASC-BLK-SUB                            27560040
275700             PERFORM 5100-WRITE-TEMP-STORAGE                      27570040
275800             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             27580040
275900                 GIVING PV-BLOCK-NUMBER                           27590040
276000                 REMAINDER PV-REMAINDER                           27600040
276100             IF  PV-REMAINDER > ZERO                              27610040
276200                 ADD +1 TO PV-BLOCK-NUMBER                        27620040
276300             END-IF                                               27630040
276400             MOVE +1    TO ASC-BLK-SUB                            27640040
276500             PERFORM 4410-READ-TEMP-STORAGE                       27650040
276600     END-IF.                                                      27660040
276700     MOVE +1            TO ASC-BLK-SUB.                           27670040
276800     COMPUTE ASC-ITEM-SUB =                                       27680040
276900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              27690040
277000         + PC-ITEMS-PER-PANEL).                                   27700040
277100*                                                                 27710040
277200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        27720040
277300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            27730040
277400     END-IF.                                                      27740040
277500*                                                                 27750040
277600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           27760040
277700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                27770040
277800     PERFORM 4420-FORMAT-LIST-LINES                               27780040
277900         VARYING PV-SUB                                           27790040
278000         FROM PC-ITEMS-PER-PANEL BY -1                            27800040
278100         UNTIL PV-SUB < +1.                                       27810040
278200*                                                                 27820040
278300     COMPUTE ASC-ITEMS-DISPLAYED =                                27830040
278400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          27840040
278500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL.   27850040
278600                                                                  27860040
278700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27870040
278800                                   TO ASELITO.                    27880040
278900                                                                  27890040
279000     MOVE ASC-CS-LOC-N               TO PV-4-DIGIT-STORE.         27900040
279100     MOVE PV-4-DIGIT-STORE           TO ALOCIDO.                  27910040
279200                                                                  27920040
279300     MOVE ASC-PULL-NBR-N             TO APULNOO                   27930040
279400                                        DK-PULL-NUMBER.           27940040
279500                                                                  27950040
279600     PERFORM 4510-GET-PULL-STATUS.                                27960040
279700     PERFORM 4520-GET-LINE-ITEM.                                  27970040
279800     IF  PV-CEPLIT-ITEM-QTY  >  0                                 27980040
279900         PERFORM 4530-GET-LAST-LINE                               27990040
280000     END-IF.                                                      28000040
280100                                                                  28010040
280200     MOVE PV-CEPLIT-ITEM-QTY         TO ALNENOO.                  28020040
280300     MOVE PV-CEPLIT-REQ-QTY          TO ATOTUTO.                  28030040
280400                                                                  28040040
280500     MOVE ASC-LAST-SKU-ENTERED       TO ALSTSKO.                  28050040
280600     MOVE ASC-LAST-UPC-ENTERED       TO ALSTUPO.                  28060040
280700                                                                  28070040
280800     EVALUATE TRUE                                                28080040
280900         WHEN ASC-PULL-CANCELLED                                  28090040
281000              MOVE PC-PULL-STATUS-CANCELLED TO APULSTO            28100040
281100         WHEN ASC-PULL-DISTRIBUTED                                28110040
281200              MOVE PC-DISTRIB-DESC          TO APULSTO            28120040
281300         WHEN ASC-PULL-IN-PROCESS                                 28130040
281400              MOVE PC-IN-PROCESS-DESC       TO APULSTO            28140040
281500         WHEN ASC-PULL-NEW                                        28150040
281600              MOVE PC-NEW-DESC              TO APULSTO            28160040
281700         WHEN ASC-PULL-POSTED                                     28170040
281800              MOVE PC-POSTED-DESC           TO APULSTO            28180040
281900         WHEN OTHER                                               28190040
282000              MOVE PC-UNKNOWN-DESC          TO APULSTO            28200040
282100     END-EVALUATE.                                                28210040
282200                                                                  28220040
282300     MOVE ASC-STORE-NBR                     TO ASTRNOO.           28230040
282400     IF  ASC-STORE-NBR  >  0                                      28240040
282500         MOVE  ASC-STORE-NBR  TO DK-STORE-NUMBER                  28250040
282600         PERFORM 4600-GET-STORE-INFORMATION                       28260040
282700         EXEC SQL                                                 28270041
282800             SET :PV-CURRENT-DATE = CURRENT DATE                  28280041
282900         END-EXEC                                                 28290041
283000     END-IF.                                                      28300040
283100     MOVE XL071-LOC-NM                      TO MSTRNMEO.          28310040
283200                                                                  28320040
283300                                                                  28330040
283400*----------------------------------------------------------------*28340040
283500*                                                                *28350040
283600*----------------------------------------------------------------*28360040
283700 4410-READ-TEMP-STORAGE.                                          28370040
283800                                                                  28380040
283900     EXEC CICS                                                    28390040
284000         READQ TS                                                 28400040
284100             QUEUE (ASC-LIST-QUEUE-NAME)                          28410040
284200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28420040
284300             ITEM  (PV-BLOCK-NUMBER)                              28430040
284400             RESP  (PV-CICS-RESP)                                 28440040
284500     END-EXEC.                                                    28450040
284600                                                                  28460040
284700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       28470040
284800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     28480040
284900         CONTINUE                                                 28490040
285000     ELSE                                                         28500040
285100         SET DP013-CICS-ABEND     TO TRUE                         28510040
285200         SET DP013-NO-ROLLBACK    TO TRUE                         28520040
285300         MOVE '4410-READ-TEMP-STORAGE'                            28530040
285400                                  TO DP013-PARAGRAPH              28540040
285500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      28550040
285600                                  TO DP013-MESSAGE-TEXT(1)        28560040
285700         PERFORM DP013-0000-PROCESS-ABEND                         28570040
285800     END-IF.                                                      28580040
285900                                                                  28590040
286000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             28600040
286100*                                                                 28610040
286200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         28620040
286300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               28630040
286400     END-IF.                                                      28640040
286500 EJECT                                                            28650040
286600*----------------------------------------------------------------*28660040
286700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *28670040
286800*----------------------------------------------------------------*28680040
286900                                                                  28690040
287000 4420-FORMAT-LIST-LINES.                                          28700040
287100     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      28710040
287200         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                28720040
287300         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           28730040
287400                                    MR-SKU-NBRA (PV-SUB)          28740040
287500                                    MR-UNITSA (PV-SUB)            28750040
287600                                    MR-LINE-NUMBERA (PV-SUB)      28760040
287700                                    MR-SKU-RETAILA (PV-SUB)       28770040
287800                                    MR-A-UNITSA (PV-SUB)          28780040
287900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           28790040
288000                                    MR-SKU-NBRH (PV-SUB)          28800040
288100                                    MR-UNITSH (PV-SUB)            28810040
288200                                    MR-LINE-NUMBERH (PV-SUB)      28820040
288300                                    MR-SKU-RETAILH (PV-SUB)       28830040
288400                                    MR-A-UNITSH (PV-SUB)          28840040
288500         MOVE SPACE              TO MR-SELECTI (PV-SUB)           28850040
288600                                    MR-ACTION (PV-SUB)            28860040
288700                                    MR-SKU-DESC (PV-SUB)          28870040
288800                                                                  28880040
288900         MOVE ZEROES             TO MR-SKU-NBR (PV-SUB)           28890040
289000                                    MR-UNITS (PV-SUB)             28900040
289100                                    MR-LINE-NUMBER (PV-SUB)       28910040
289200                                    MR-SKU-RETAIL (PV-SUB)        28920040
289300                                    MR-A-UNITS (PV-SUB)           28930040
289400     ELSE                                                         28940040
289500         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      28950040
289600                                                   > SPACE        28960040
289700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 28970040
289800                                 TO MR-SELECTI (PV-SUB)           28980040
289900         ELSE                                                     28990040
290000             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      29000040
290100                                 TO MR-SELECTI (PV-SUB)           29010040
290200         END-IF                                                   29020040
290300*                                                                 29030040
290400         IF  DP030-SET-CURSOR-TRAILER                             29040040
290500             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)29050040
290600                 > SPACE)                                         29060040
290700               OR (PV-SUB = 1))                                   29070040
290800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               29080040
290900                MOVE -1          TO MR-SELECTL (PV-SUB)           29090040
291000             END-IF                                               29100040
291100         END-IF                                                   29110040
291200*                                                                 29120040
291300         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               29130040
291400                                 TO MR-ACTION (PV-SUB)            29140040
291500         MOVE ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB)                29150040
291600                                 TO MR-SKU-NBR (PV-SUB)           29160040
291700         MOVE ASC-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)              29170040
291800                                 TO MR-UNITS (PV-SUB)             29180040
291900         MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             29190040
292000                                 TO MR-LINE-NUMBER (PV-SUB)       29200040
292100         MOVE ASC-SKU-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)      29210040
292200                                 TO MR-SKU-DESC (PV-SUB)          29220040
292300         MOVE ASC-SKU-RETAIL (ASC-BLK-SUB ASC-ITEM-SUB)           29230040
292400                                 TO MR-SKU-RETAIL (PV-SUB)        29240040
292500         MOVE ASC-AVAIL-UNITS-N (ASC-BLK-SUB ASC-ITEM-SUB)        29250040
292600                                 TO MR-A-UNITS (PV-SUB)           29260040
292700                                                                  29270040
292800*2/2     IF  ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB)    > 0 AND      29280040
292900         IF  ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACE      29290040
293000             MOVE DP015-ASK-NOR-MDT                               29300040
293100                                   TO MR-SKU-NBRA (PV-SUB)        29310040
293200                                      MR-UNITSA (PV-SUB)          29320040
293300             MOVE DP015-BLUE       TO MR-SKU-NBRC (PV-SUB)        29330040
293400                                      MR-UNITSC (PV-SUB)          29340040
293500             MOVE DP015-HL-OFF     TO MR-SKU-NBRH (PV-SUB)        29350040
293600                                      MR-UNITSH (PV-SUB)          29360040
293700         END-IF                                                   29370040
293800                                                                  29380040
293900         IF  ASC-SKU-N (ASC-BLK-SUB ASC-ITEM-SUB) > 0  OR         29390040
294000             ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > SPACE      29400040
294100             MOVE DP015-ASK-NOR-OFF                               29410040
294200                                 TO MR-SKU-RETAILA (PV-SUB)       29420040
294300                                    MR-A-UNITSA (PV-SUB)          29430040
294400         ELSE                                                     29440040
294500             MOVE DP015-ASK-DRK-OFF                               29450040
294600                                 TO MR-SKU-RETAILA (PV-SUB)       29460040
294700                                    MR-A-UNITSA (PV-SUB)          29470040
294800         END-IF                                                   29480040
294900                                                                  29490040
295000     SUBTRACT +1 FROM ASC-ITEM-SUB                                29500040
295100     IF  ASC-ITEM-SUB < + 1                                       29510040
295200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  29520040
295300         MOVE +1                 TO ASC-BLK-SUB                   29530040
295400     END-IF.                                                      29540040
295500                                                                  29550040
295600                                                                  29560040
295700*----------------------------------------------------------------*29570040
295800* GET PULL CURRENT STATUS                                        *29580040
295900*----------------------------------------------------------------*29590040
296000 4510-GET-PULL-STATUS.                                            29600040
296100                                                                  29610040
296200     MOVE  ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                     29620040
296300                                                                  29630040
296400     EXEC SQL                                                     29640040
296500         SELECT  STAT_CDE                                         29650040
296600           INTO  :CEPLRQ-STAT-CDE                                 29660040
296700           FROM  TCEPLRQ                                          29670040
296800          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             29680040
296900     END-EXEC.                                                    29690040
297000                                                                  29700040
297100     EVALUATE TRUE                                                29710040
297200         WHEN SQLCODE = +0                                        29720040
297300              MOVE  CEPLRQ-STAT-CDE   TO  ASC-PULL-STATUS         29730040
297400         WHEN SQLCODE = -904                                      29740040
297500         WHEN SQLCODE = -911                                      29750040
297600         WHEN SQLCODE = -913                                      29760040
297700             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    29770040
297800             MOVE '4010-GET-PULL-STATUS '   TO PV-SOFT-PARAGRAPH  29780040
297900             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  29790040
298000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     29800040
298100               TO PV-COMMAREA-LENGTH                              29810040
298200             EXEC CICS                                            29820040
298300                  WRITEQ TD                                       29830040
298400                   QUEUE  ('CSSL')                                29840040
298500                    FROM  (PV-CICS-MSG-AREA2)                     29850040
298600                  LENGTH  (PV-COMMAREA-LENGTH)                    29860040
298700                    RESP  (PV-CICS-RESP)                          29870040
298800             END-EXEC                                             29880040
298900             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29890040
299000             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              29900040
299100             PERFORM 9900-SOFT-ABORT                              29910040
299200         WHEN OTHER                                               29920040
299300              MOVE '4010-GET-PULL-STATUS '                        29930040
299400                               TO DP013-PARAGRAPH                 29940040
299500              MOVE 'GET PULL PULL STATUS     '                    29950040
299600                               TO DP013-MESSAGE-TEXT (1)          29960040
299700              MOVE SQLCA       TO DP013-SQLCA                     29970040
299800              MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)        29980040
299900              SET DP013-DB2-ABEND                                 29990040
300000                  DP013-XCTL-DISPLAY-RESTART                      30000040
300100                                   TO TRUE                        30010040
300200                  PERFORM DP013-0000-PROCESS-ABEND                30020040
300300     END-EVALUATE.                                                30030040
300400                                                                  30040040
300500                                                                  30050040
300600*----------------------------------------------------------------*30060040
300700* GET TOTAL NUMBER OF ACTIVE LINES & TOTAL NUMBER OF UNITS       *30070040
300800*----------------------------------------------------------------*30080040
300900 4520-GET-LINE-ITEM.                                              30090040
301000                                                                  30100040
301100     MOVE  ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                     30110040
301200                                                                  30120040
301300     INITIALIZE  PV-CEPLIT-ITEM-QTY                               30130040
301400                 PV-CEPLIT-REQ-QTY.                               30140040
301500                                                                  30150040
301600     EXEC SQL                                                     30160040
301700         SELECT  COUNT(*)                                         30170040
301800                ,SUM(PL_REQ_QTY)                                  30180040
301900           INTO  :PV-CEPLIT-ITEM-QTY                              30190040
302000                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               30200040
302100           FROM  TCEPLIT                                          30210040
302200          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             30220040
302300            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    30230040
302400     END-EXEC                                                     30240040
302500                                                                  30250040
302600     EVALUATE TRUE                                                30260040
302700         WHEN SQLCODE = +0                                        30270040
302800              CONTINUE                                            30280040
302900         WHEN SQLCODE = -904                                      30290040
303000         WHEN SQLCODE = -911                                      30300040
303100         WHEN SQLCODE = -913                                      30310040
303200             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30320040
303300             MOVE '4020-GET-LINE-ITEM  '    TO PV-SOFT-PARAGRAPH  30330040
303400             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30340040
303500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30350040
303600               TO PV-COMMAREA-LENGTH                              30360040
303700             EXEC CICS                                            30370040
303800                  WRITEQ TD                                       30380040
303900                   QUEUE  ('CSSL')                                30390040
304000                    FROM  (PV-CICS-MSG-AREA2)                     30400040
304100                  LENGTH  (PV-COMMAREA-LENGTH)                    30410040
304200                    RESP  (PV-CICS-RESP)                          30420040
304300             END-EXEC                                             30430040
304400             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30440040
304500             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              30450040
304600             PERFORM 9900-SOFT-ABORT                              30460040
304700         WHEN OTHER                                               30470040
304800              MOVE '4020-GET-LINE-ITEM'                           30480040
304900                               TO DP013-PARAGRAPH                 30490040
305000              MOVE 'GET PULL ITEM QUANTITIES '                    30500040
305100                               TO DP013-MESSAGE-TEXT (1)          30510040
305200              MOVE SQLCA       TO DP013-SQLCA                     30520040
305300              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        30530040
305400              SET DP013-DB2-ABEND                                 30540040
305500                  DP013-XCTL-DISPLAY-RESTART                      30550040
305600                                   TO TRUE                        30560040
305700                  PERFORM DP013-0000-PROCESS-ABEND                30570040
305800     END-EVALUATE.                                                30580040
305900                                                                  30590040
306000                                                                  30600040
306100*----------------------------------------------------------------*30610040
306200* GET LAST LINE ENTERED (MAX LINE NUMBER)                        *30620040
306300*----------------------------------------------------------------*30630040
306400 4530-GET-LAST-LINE.                                              30640040
306500                                                                  30650040
306600     MOVE  ASC-PULL-NBR-N  TO  DK-PULL-NUMBER                     30660040
306700                                                                  30670040
306800     INITIALIZE  ASC-LAST-SKU-ENTERED                             30680040
306900                 ASC-LAST-UPC-ENTERED.                            30690040
307000                                                                  30700040
307100     EXEC SQL                                                     30710040
307200          SELECT MAX(PL_LNE_NBR)                                  30720040
307300           INTO  :CEPLIT-PL-LNE-NBR :PV-NULL-IND-3                30730040
307400           FROM  TCEPLIT                                          30740040
307500          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             30750040
307600     END-EXEC                                                     30760040
307700                                                                  30770040
307800     EVALUATE TRUE                                                30780040
307900         WHEN SQLCODE = +0                                        30790040
308000              MOVE  CEPLIT-PL-LNE-NBR  TO  DK-LINE-NUMBER         30800040
308100              PERFORM 4540-GET-LAST-ITEM-NBR                      30810040
308200         WHEN SQLCODE = +100                                      30820040
308300              MOVE  SPACES  TO  ASC-LAST-SKU-ENTERED              30830040
308400         WHEN SQLCODE = -904                                      30840040
308500         WHEN SQLCODE = -911                                      30850040
308600         WHEN SQLCODE = -913                                      30860040
308700             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    30870040
308800             MOVE '4020-GET-LINE-ITEM  '    TO PV-SOFT-PARAGRAPH  30880040
308900             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  30890040
309000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     30900040
309100               TO PV-COMMAREA-LENGTH                              30910040
309200             EXEC CICS                                            30920040
309300                  WRITEQ TD                                       30930040
309400                   QUEUE  ('CSSL')                                30940040
309500                    FROM  (PV-CICS-MSG-AREA2)                     30950040
309600                  LENGTH  (PV-COMMAREA-LENGTH)                    30960040
309700                    RESP  (PV-CICS-RESP)                          30970040
309800             END-EXEC                                             30980040
309900             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30990040
310000             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              31000040
310100             PERFORM 9900-SOFT-ABORT                              31010040
310200         WHEN OTHER                                               31020040
310300              MOVE '4030-GET-LAST-LINE'                           31030040
310400                               TO DP013-PARAGRAPH                 31040040
310500              MOVE 'GET LAST LINE NUMBER ENTERED'                 31050040
310600                               TO DP013-MESSAGE-TEXT (1)          31060040
310700              MOVE SQLCA       TO DP013-SQLCA                     31070040
310800              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        31080040
310900              SET DP013-DB2-ABEND                                 31090040
311000                  DP013-XCTL-DISPLAY-RESTART                      31100040
311100                                   TO TRUE                        31110040
311200                  PERFORM DP013-0000-PROCESS-ABEND                31120040
311300     END-EVALUATE.                                                31130040
311400                                                                  31140040
311500                                                                  31150040
311600*----------------------------------------------------------------*31160040
311700* GET LAST LINE ENTERED (MAX LINE NUMBER)                        *31170040
311800*----------------------------------------------------------------*31180040
311900 4540-GET-LAST-ITEM-NBR.                                          31190040
312000                                                                  31200040
312100     EXEC SQL                                                     31210040
312200          SELECT ITM_NBR                                          31220040
312300           INTO  :CEPLIT-ITM-NBR                                  31230040
312400           FROM  TCEPLIT                                          31240040
312500          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             31250040
312600            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             31260040
312700     END-EXEC                                                     31270040
312800                                                                  31280040
312900     EVALUATE TRUE                                                31290040
313000         WHEN SQLCODE = +0                                        31300040
313100              PERFORM 4550-GET-LAST-SKU                           31310040
313200         WHEN SQLCODE = -904                                      31320040
313300         WHEN SQLCODE = -911                                      31330040
313400         WHEN SQLCODE = -913                                      31340040
313500             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    31350040
313600             MOVE '4540-GET-LAST-ITEM-NBR'  TO PV-SOFT-PARAGRAPH  31360040
313700             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  31370040
313800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31380040
313900               TO PV-COMMAREA-LENGTH                              31390040
314000             EXEC CICS                                            31400040
314100                  WRITEQ TD                                       31410040
314200                   QUEUE  ('CSSL')                                31420040
314300                    FROM  (PV-CICS-MSG-AREA2)                     31430040
314400                  LENGTH  (PV-COMMAREA-LENGTH)                    31440040
314500                    RESP  (PV-CICS-RESP)                          31450040
314600             END-EXEC                                             31460040
314700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          31470040
314800             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              31480040
314900             PERFORM 9900-SOFT-ABORT                              31490040
315000         WHEN OTHER                                               31500040
315100              MOVE '4540-GET-LAST-ITEM-NBR'                       31510040
315200                               TO DP013-PARAGRAPH                 31520040
315300              MOVE 'GET ITEM NBR FOR LAST LINE ENTERED'           31530040
315400                               TO DP013-MESSAGE-TEXT (1)          31540040
315500              MOVE SQLCA       TO DP013-SQLCA                     31550040
315600              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        31560040
315700              SET DP013-DB2-ABEND                                 31570040
315800                  DP013-XCTL-DISPLAY-RESTART                      31580040
315900                                   TO TRUE                        31590040
316000                  PERFORM DP013-0000-PROCESS-ABEND                31600040
316100     END-EVALUATE.                                                31610040
316200                                                                  31620040
316300                                                                  31630040
316400*----------------------------------------------------------------*31640040
316500*  GET LAST SKU ENTERED                           WR/IR 230ZZ    *31650040
316600*----------------------------------------------------------------*31660040
316700 4550-GET-LAST-SKU.                                               31670040
316800     INITIALIZE  XL001-ITEM-COMMAREA.                             31680040
316900                                                                  31690040
317000     MOVE CEPLIT-ITM-NBR   TO  XL001-KEY-ITM-NBR.                 31700040
317100                                                                  31710040
317200     SET  XL001-BY-ITEM                                           31720040
317300          XL001-SELECT-SKU TO TRUE.                               31730040
317400                                                                  31740040
317500     CALL XL001-VSM-PGM USING  DFHEIBLK                           31750040
317600                               XL001-COMMAREA                     31760040
317700                               XL001-ITEM-COMMAREA.               31770040
317800                                                                  31780040
317900     EVALUATE TRUE                                                31790040
318000         WHEN XL001-SUCCESSFUL                                    31800040
318100              MOVE  XL001-SKU-NBR  TO  PV-SKU-NUMBER              31810040
318200              MOVE  PV-SKU-NUMBER  TO  ASC-LAST-SKU-ENTERED       31820040
318300              PERFORM 4555-GET-LAST-UPC                           31830040
318400         WHEN XL001-SKU-CONTENTION                                31840040
318500             MOVE XL001-SKU-SQLCODE         TO PV-SOFT-SQLCODE    31850040
318600             MOVE '4550-GET-LAST-SKU'       TO PV-SOFT-PARAGRAPH  31860040
318700             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  31870040
318800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     31880040
318900               TO PV-COMMAREA-LENGTH                              31890040
319000             EXEC CICS                                            31900040
319100                  WRITEQ TD                                       31910040
319200                   QUEUE  ('CSSL')                                31920040
319300                    FROM  (PV-CICS-MSG-AREA2)                     31930040
319400                  LENGTH  (PV-COMMAREA-LENGTH)                    31940040
319500                    RESP  (PV-CICS-RESP)                          31950040
319600             END-EXEC                                             31960040
319700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          31970040
319800             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              31980040
319900             PERFORM 9900-SOFT-ABORT                              31990040
320000         WHEN OTHER                                               32000040
320100              MOVE ' 4550-GET-LAST-SKU'                           32010040
320200                               TO DP013-PARAGRAPH                 32020040
320300              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           32030040
320400              STRING ' PULL-'           DELIMITED BY SIZE         32040040
320500                     PV-PULL-NUMBER     DELIMITED BY SIZE         32050040
320600                     '  -  LINE-'       DELIMITED BY SIZE         32060040
320700                     PV-LINE-NUMBER     DELIMITED BY SIZE         32070040
320800                     '  -  ITEM NBR-'   DELIMITED BY SIZE         32080040
320900                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         32090040
321000                     '  TRYING TO GET LAST SKU NUMBER'            32100040
321100                                        DELIMITED BY SIZE         32110040
321200                             INTO DP013-MESSAGE-TEXT (1)          32120040
321300              MOVE XL001-SQLCA TO DP013-SQLCA                     32130040
321400              MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (2)        32140040
321500              SET DP013-DB2-ABEND                                 32150040
321600                  DP013-XCTL-DISPLAY-RESTART                      32160040
321700                                   TO TRUE                        32170040
321800                  PERFORM DP013-0000-PROCESS-ABEND                32180040
321900     END-EVALUATE.                                                32190040
322000                                                                  32200040
322100                                                                  32210040
322200*----------------------------------------------------------------*32220040
322300*  GET LAST UPC ENTERED                             WR/IR# 230ZZ *32230040
322400*----------------------------------------------------------------*32240040
322500 4555-GET-LAST-UPC.                                               32250040
322600     INITIALIZE  XL001-ITEM-COMMAREA.                             32260040
322700                                                                  32270040
322800     MOVE CEPLIT-ITM-NBR   TO  XL001-KEY-ITM-NBR.                 32280040
322900                                                                  32290040
323000     SET  XL001-BY-ITEM                                           32300040
323100          XL001-SELECT-SKU                                        32310040
323200          XL001-SELECT-UPC TO  TRUE.                              32320040
323300                                                                  32330040
323400     CALL XL001-VSM-PGM USING  DFHEIBLK                           32340040
323500                               XL001-COMMAREA                     32350040
323600                               XL001-ITEM-COMMAREA.               32360040
323700                                                                  32370040
323800     EVALUATE TRUE                                                32380040
323900         WHEN XL001-SUCCESSFUL                                    32390040
324000              MOVE  XL001-UPC-NBR   TO  ASC-LAST-UPC-ENTERED      32400040
324100         WHEN OTHER                                               32410040
324200              PERFORM 4557-CHECK-SKU-SQLCODE                      32420040
324300              PERFORM 4559-CHECK-UPC-SQLCODE                      32430040
324400     END-EVALUATE.                                                32440040
324500                                                                  32450040
324600 4557-CHECK-SKU-SQLCODE.                                          32460040
324700                                                                  32470040
324800     EVALUATE TRUE                                                32480040
324900         WHEN XL001-SKU-SQLCODE = 0                               32490040
325000              PERFORM 4559-CHECK-UPC-SQLCODE                      32500040
325100         WHEN XL001-SKU-SQLCODE = +100                            32510040
325200              MOVE  '*** UNKNOWN ***' TO  ASC-LAST-UPC-ENTERED    32520040
325300         WHEN XL001-SKU-CONTENTION                                32530040
325400             MOVE XL001-SKU-SQLCODE         TO PV-SOFT-SQLCODE    32540040
325500             MOVE '4557-CHECK-SKU-SQLCODE ' TO PV-SOFT-PARAGRAPH  32550040
325600             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  32560040
325700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     32570040
325800               TO PV-COMMAREA-LENGTH                              32580040
325900             EXEC CICS                                            32590040
326000                  WRITEQ TD                                       32600040
326100                   QUEUE  ('CSSL')                                32610040
326200                    FROM  (PV-CICS-MSG-AREA2)                     32620040
326300                  LENGTH  (PV-COMMAREA-LENGTH)                    32630040
326400                    RESP  (PV-CICS-RESP)                          32640040
326500             END-EXEC                                             32650040
326600             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          32660040
326700             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              32670040
326800             PERFORM 9900-SOFT-ABORT                              32680040
326900         WHEN OTHER                                               32690040
327000              MOVE ' 4557-CHECK-SKU-SQLCODE '                     32700040
327100                               TO DP013-PARAGRAPH                 32710040
327200              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           32720040
327300              STRING ' PULL-'           DELIMITED BY SIZE         32730040
327400                     PV-PULL-NUMBER     DELIMITED BY SIZE         32740040
327500                     '  -  LINE-'       DELIMITED BY SIZE         32750040
327600                     PV-LINE-NUMBER     DELIMITED BY SIZE         32760040
327700                     '  -  ITEM NBR-'   DELIMITED BY SIZE         32770040
327800                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         32780040
327900                     '  TRYING TO GET LAST SKU NUMBER'            32790040
328000                                        DELIMITED BY SIZE         32800040
328100                             INTO DP013-MESSAGE-TEXT (1)          32810040
328200              MOVE XL001-SQLCA TO DP013-SQLCA                     32820040
328300              MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (2)        32830040
328400              SET DP013-DB2-ABEND                                 32840040
328500                  DP013-XCTL-DISPLAY-RESTART                      32850040
328600                                   TO TRUE                        32860040
328700                  PERFORM DP013-0000-PROCESS-ABEND                32870040
328800     END-EVALUATE.                                                32880040
328900                                                                  32890040
329000 4559-CHECK-UPC-SQLCODE.                                          32900040
329100                                                                  32910040
329200     EVALUATE TRUE                                                32920040
329300         WHEN XL001-UPC-SQLCODE = 0                               32930040
329400              CONTINUE                                            32940040
329500         WHEN XL001-UPC-SQLCODE = +100                            32950040
329600              MOVE  '*** UNKNOWN ***' TO  ASC-LAST-UPC-ENTERED    32960040
329700         WHEN XL001-UPC-SQLCODE = -811                            32970040
329800              MOVE  '*** MULTIPLE ***' TO  ASC-LAST-UPC-ENTERED   32980040
329900         WHEN XL001-UPC-CONTENTION                                32990040
330000             MOVE XL001-UPC-SQLCODE         TO PV-SOFT-SQLCODE    33000040
330100             MOVE '4559-CHECK-UPC-SQLCODE ' TO PV-SOFT-PARAGRAPH  33010040
330200             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  33020040
330300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     33030040
330400               TO PV-COMMAREA-LENGTH                              33040040
330500             EXEC CICS                                            33050040
330600                  WRITEQ TD                                       33060040
330700                   QUEUE  ('CSSL')                                33070040
330800                    FROM  (PV-CICS-MSG-AREA2)                     33080040
330900                  LENGTH  (PV-COMMAREA-LENGTH)                    33090040
331000                    RESP  (PV-CICS-RESP)                          33100040
331100             END-EXEC                                             33110040
331200             MOVE  PC-TSYMSG-00994  TO  DP020-MSG-NUMBER          33120040
331300             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              33130040
331400             PERFORM 9900-SOFT-ABORT                              33140040
331500         WHEN OTHER                                               33150040
331600              MOVE ' 4559-CHECK-UPC-SQLCODE '                     33160040
331700                               TO DP013-PARAGRAPH                 33170040
331800              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           33180040
331900              STRING ' PULL-'           DELIMITED BY SIZE         33190040
332000                     PV-PULL-NUMBER     DELIMITED BY SIZE         33200040
332100                     '  -  LINE-'       DELIMITED BY SIZE         33210040
332200                     PV-LINE-NUMBER     DELIMITED BY SIZE         33220040
332300                     '  -  ITEM NBR-'   DELIMITED BY SIZE         33230040
332400                     PV-CEPLIT-ITM-NBR  DELIMITED BY SIZE         33240040
332500                     '  TRYING TO GET LAST SKU NUMBER'            33250040
332600                                        DELIMITED BY SIZE         33260040
332700                             INTO DP013-MESSAGE-TEXT (1)          33270040
332800              MOVE XL001-SQLCA TO DP013-SQLCA                     33280040
332900              MOVE 'XLV_UPC '  TO DP013-DB2-TABLE-NAME (2)        33290040
333000              SET DP013-DB2-ABEND                                 33300040
333100                  DP013-XCTL-DISPLAY-RESTART                      33310040
333200                                   TO TRUE                        33320040
333300                  PERFORM DP013-0000-PROCESS-ABEND                33330040
333400     END-EVALUATE.                                                33340040
333500                                                                  33350040
333600                                                                  33360040
333700****************************************************************  33370040
333800*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION FOR        *  33380040
333900*                                                              *  33390040
334000****************************************************************  33400040
334100 4600-GET-STORE-INFORMATION.                                      33410040
334200                                                                  33420040
334300     INITIALIZE XL071-COMMAREA.                                   33430040
334400     MOVE DK-STORE-NUMBER TO XL071-LOCATION-NUMBER.               33440040
334500                                                                  33450040
334600     CALL XL071-LOCATION-MODULE USING                             33460040
334700                                DFHEIBLK                          33470040
334800                                XL071-COMMAREA                    33480040
334900                                XL071-COMMAREA-REC.               33490040
335000                                                                  33500040
335100     EVALUATE TRUE                                                33510040
335200         WHEN XL071-NO-ERRORS                                     33520040
335300              CONTINUE                                            33530040
335400                                                                  33540040
335500         WHEN OTHER                                               33550040
335600              MOVE ' 4600-GET-STORE-INFORMATION'                  33560040
335700                               TO DP013-PARAGRAPH                 33570040
335800              MOVE CEPLIT-ITM-NBR TO  PV-CEPLIT-ITM-NBR           33580040
335900              STRING ' PULL-'                                     33590040
336000                     PV-PULL-NUMBER                               33600040
336100                     '  -  LINE-'                                 33610040
336200                     PV-LINE-NUMBER                               33620040
336300                     '  -  ITEM NBR-'                             33630040
336400                     PV-CEPLIT-ITM-NBR                            33640040
336500                     '  TRYING TO GET LAST SKU NUMBER'            33650040
336600                                        DELIMITED BY SIZE         33660040
336700                             INTO DP013-MESSAGE-TEXT (1)          33670040
336800              MOVE XL071-SQLCODE   TO SQLCODE                     33680040
336900              MOVE XL071-SQLCA     TO DP013-SQLCA                 33690040
337000              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    33700040
337100              SET DP013-DB2-ABEND                                 33710040
337200                  DP013-XCTL-DISPLAY-RESTART                      33720040
337300                                   TO TRUE                        33730040
337400                  PERFORM DP013-0000-PROCESS-ABEND                33740040
337500                                                                  33750040
337600     END-EVALUATE.                                                33760040
337700                                                                  33770040
337800                                                                  33780040
337900*----------------------------------------------------------------*33790040
338000*  ADD FUNCTION                                                  *33800040
338100*----------------------------------------------------------------*33810040
338200 4700-PROCESS-ADD-FUNCTION.                                       33820040
338300                                                                  33830040
338400     MOVE +1                       TO ASC-BLK-SUB.                33840040
338500     PERFORM 5100-WRITE-TEMP-STORAGE.                             33850040
338600                                                                  33860040
338700     PERFORM 6112-READ-LIST-QUEUE.                                33870040
338800                                                                  33880040
338900     SET  LQW-IDX  TO   1.                                        33890040
339000                                                                  33900040
339100     IF PS-NO-SOFT-ABORT-ERROR                                    33910040
339200       IF PV-CICS-RESP = DFHRESP (NORMAL)                         33920040
339300         PERFORM                                                  33930040
339400         VARYING LQW-IDX  FROM 1 BY 1                             33940040
339500         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     33950040
339600            OR   PS-SOFT-ABORT-ERROR                              33960040
339700            OR   PS-ERROR                                         33970040
339800             IF  LQW-SELECT (LQW-IDX)                             33980040
339900                 PERFORM 4705-PROCESS-SELECTED-LINES              33990040
340000             END-IF                                               34000040
340100         END-PERFORM                                              34010040
340200       END-IF                                                     34020040
340300     END-IF.                                                      34030040
340400                                                                  34040040
340500     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           34050040
340600     PERFORM 6111-WRITE-LIST-QUEUE.                               34060040
340700                                                                  34070040
340800     MOVE +1                     TO  ASC-BLK-SUB.                 34080040
340900     PERFORM 4410-READ-TEMP-STORAGE.                              34090040
341000                                                                  34100040
341100                                                                  34110040
341200                                                                  34120040
341300*----------------------------------------------------------------*34130040
341400*                                                                *34140040
341500*----------------------------------------------------------------*34150040
341600 4705-PROCESS-SELECTED-LINES.                                     34160040
341700                                                                  34170040
341800     PERFORM 4710-ADD-LINES.                                      34180040
341900                                                                  34190040
342000     IF  PS-NO-ERROR                                              34200040
342100         SET DP020-MSG-INFORMATIONAL  TO  TRUE                    34210058
342200         MOVE PC-TSYMSG-02352  TO  DP020-MSG-NUMBER               34220040
342300     END-IF.                                                      34230040
342400                                                                  34240040
342500                                                                  34250040
342600*----------------------------------------------------------------*34260040
342700*                                                                *34270040
342800*                                                                *34280040
342900*----------------------------------------------------------------*34290040
343000 4710-ADD-LINES.                                                  34300040
343100                                                                  34310040
343200     MOVE ASC-PULL-NBR                   TO PV-PULL-NUMBER        34320040
343300                                                                  34330040
343400     IF  LQW-SELECT (LQW-IDX)                                     34340040
343500         IF  PS-NO-ERROR                                          34350040
343600             IF XL071-E-BUS-IND   = 'Y' AND                       34360040
343700                XL071-LOC-TYP-CDE = 'DS' AND                      34370050
343710                PS-PROCESS-MQ-YES                                 34371050
343800                 PERFORM 4740-RESERVE-QUANTITY                    34380040
343900                 IF PS-REDUCE-QTY                                 34390040
344000                     IF LQW-UNITS (LQW-IDX) =                     34400040
344100                                     LQW-AVAIL-UNITS (LQW-IDX)    34410040
344200                         MOVE CE016-TRANS-AVAIL-QTY TO            34420040
344300                                         LQW-UNITS (LQW-IDX)      34430040
344400                         PERFORM 4740-RESERVE-QUANTITY            34440040
344500                     ELSE                                         34450040
344600                         SET PS-ERROR TO TRUE                     34460040
344700                         MOVE PC-TSYMSG-02314 TO DP020-MSG-NUMBER 34470040
344800                         MOVE DP015-RED     TO MR-UNITSC (LQW-IDX)34480040
344900                         MOVE DP015-REVERSE TO MR-UNITSH (LQW-IDX)34490040
345000                         MOVE -1           TO MR-UNITSL (LQW-IDX) 34500040
345100                     END-IF                                       34510040
345200                 END-IF                                           34520040
345300             ELSE                                                 34530040
345400                 SET CE016-TRANS-SUCCESSFUL TO TRUE               34540040
345500             END-IF                                               34550040
345600         END-IF                                                   34560040
345700         IF  PS-NO-ERROR                                          34570040
345800             PERFORM 4715-GET-NEXT-LINE-NBR                       34580040
345900         END-IF                                                   34590040
346000                                                                  34600040
346100         IF  PS-NO-ERROR                                          34610040
346200             PERFORM 4720-INSERT-TCEPLIT                          34620040
346300         END-IF                                                   34630040
346400                                                                  34640040
346500         IF  PS-NO-ERROR                                          34650040
346600             PERFORM 4725-INSERT-TCEPLST                          34660040
346700         END-IF                                                   34670040
346800                                                                  34680040
346900         IF  PS-NO-ERROR                                          34690040
347000             IF  ASC-STORE-NBR  >  0                              34700040
347100                PERFORM 4730-INSERT-TCEPLDS                       34710040
347200             END-IF                                               34720040
347300         END-IF                                                   34730040
347400                                                                  34740040
347500         IF  PS-NO-ERROR                                          34750040
347600             MOVE  LQW-SKU (LQW-IDX)                              34760040
347700               TO  ASC-LAST-SKU-ENTERED                           34770040
347800         END-IF                                                   34780040
347900                                                                  34790040
348000                                                                  34800040
348100     END-IF.                                                      34810040
348200                                                                  34820040
348300     IF PS-NO-ERROR AND                                           34830040
348400        CE016-TRANS-SUCCESSFUL                                    34840040
348500                                                                  34850040
348600         EXEC CICS SYNCPOINT                                      34860040
348700         END-EXEC                                                 34870040
348800                                                                  34880040
348900         SET  LQW-ADD (LQW-IDX)        TO  TRUE                   34890040
349000         MOVE LQW-SELECTED-SW (LQW-IDX)                           34900040
349100                            TO LQW-TEMP-SELECTED-SW (LQW-IDX)     34910040
349200     END-IF.                                                      34920040
349300                                                                  34930040
349400                                                                  34940040
349500*----------------------------------------------------------------*34950040
349600*                                                                *34960040
349700*----------------------------------------------------------------*34970040
349800 4715-GET-NEXT-LINE-NBR.                                          34980040
349900                                                                  34990040
350000     MOVE ASC-PULL-NBR-N             TO DK-PULL-NUMBER.           35000040
350100                                                                  35010040
350200     EXEC SQL                                                     35020040
350300          SELECT MAX(PL_LNE_NBR)                                  35030040
350400           INTO  :CEPLIT-PL-LNE-NBR                               35040040
350500           FROM  TCEPLIT                                          35050040
350600          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             35060040
350700     END-EXEC                                                     35070040
350800                                                                  35080040
350900     EVALUATE TRUE                                                35090040
351000         WHEN SQLCODE = +0                                        35100040
351100              MOVE  CEPLIT-PL-LNE-NBR  TO  DK-LINE-NUMBER         35111069
351200              ADD   1                  TO  DK-LINE-NUMBER         35120040
351100              IF DK-LINE-NUMBER    > PV-MAX-PULL-LINES            35121072
351300                  SET PS-ERROR         TO  TRUE                   35121169
141300                  MOVE PC-TSYMSG-03821  TO DP020-MSG-NUMBER       35121270
141400                  MOVE -1               TO ASEL01L                35121370
141500                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             35121470
141600                  SET DP020-MSG-FATAL   TO TRUE                   35121570
351100              ELSE                                                35121769
351300                  MOVE  DK-LINE-NUMBER TO  LQW-LINE-NBR(LQW-IDX)  35121869
351100              END-IF                                              35122069
351300*             MOVE  DK-LINE-NUMBER     TO  LQW-LINE-NBR(LQW-IDX)  35130069
351400         WHEN SQLCODE = -305                                      35140040
351500              MOVE  1                  TO  DK-LINE-NUMBER         35150040
351600              MOVE  DK-LINE-NUMBER     TO  LQW-LINE-NBR(LQW-IDX)  35160040
351700         WHEN SQLCODE = -904                                      35170040
351800         WHEN SQLCODE = -911                                      35180040
351900         WHEN SQLCODE = -913                                      35190040
352000             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    35200040
352100             MOVE '4715-GET-NEXT-LINE-NBR'  TO PV-SOFT-PARAGRAPH  35210040
352200             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  35220040
352300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     35230040
352400               TO PV-COMMAREA-LENGTH                              35240040
352500             EXEC CICS                                            35250040
352600                  WRITEQ TD                                       35260040
352700                   QUEUE  ('CSSL')                                35270040
352800                    FROM  (PV-CICS-MSG-AREA2)                     35280040
352900                  LENGTH  (PV-COMMAREA-LENGTH)                    35290040
353000                    RESP  (PV-CICS-RESP)                          35300040
353100             END-EXEC                                             35310040
353200             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          35320040
353300             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              35330040
353400             PERFORM 9900-SOFT-ABORT                              35340040
353500         WHEN OTHER                                               35350040
353600              MOVE '4715-GET-NEXT-LINE-NBR'                       35360040
353700                               TO DP013-PARAGRAPH                 35370040
353800              MOVE 'GET NEXT LINE NUMBER'                         35380040
353900                               TO DP013-MESSAGE-TEXT (1)          35390040
354000              MOVE SQLCA       TO DP013-SQLCA                     35400040
354100              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        35410040
354200              SET DP013-DB2-ABEND                                 35420040
354300                  DP013-XCTL-DISPLAY-RESTART                      35430040
354400                                   TO TRUE                        35440040
354500                  PERFORM DP013-0000-PROCESS-ABEND                35450040
354600     END-EVALUATE.                                                35460040
354700                                                                  35470040
354800                                                                  35480040
354900*----------------------------------------------------------------*35490040
355000* INSERT ROW INTO CS PULL ITEM TABLE (TCEPLIT)                   *35500040
355100*----------------------------------------------------------------*35510040
355200 4720-INSERT-TCEPLIT.                                             35520040
355300                                                                  35530040
355400     MOVE  ASC-PULL-NBR-N           TO  CEPLIT-CNSTK-REQ-PL-NBR.  35540040
355500     MOVE  LQW-LINE-NBR (LQW-IDX)   TO  CEPLIT-PL-LNE-NBR.        35550040
355600     MOVE  LQW-LINE-ITEM (LQW-IDX)  TO  CEPLIT-ITM-NBR.           35560040
355700     MOVE  LQW-UNITS (LQW-IDX)      TO  CEPLIT-PL-REQ-QTY.        35570040
355800     MOVE  PC-NEW                   TO  CEPLIT-STAT-CDE.          35580040
355900     MOVE  LQW-SKU-RETAIL (LQW-IDX) TO  CEPLIT-UNT-RTL-AMT.       35590040
356000     MOVE  SPACES                   TO  CEPLIT-EXPRT-PRC-BTCH-ID. 35600040
356100                                                                  35610040
356200     EXEC SQL                                                     35620040
356300          INSERT                                                  35630040
356400          INTO  TCEPLIT                                           35640040
356500               (CNSTK_REQ_PL_NBR                                  35650040
356600               ,PL_LNE_NBR                                        35660040
356700               ,ITM_NBR                                           35670040
356800               ,PL_REQ_QTY                                        35680040
356900               ,ACTL_PL_QTY                                       35690040
357000               ,STAT_CDE                                          35700040
357100               ,UNT_RTL_AMT                                       35710040
357200               ,EXPRT_PRC_BTCH_ID)                                35720040
357300        VALUES                                                    35730040
357400              (:CEPLIT-CNSTK-REQ-PL-NBR                           35740040
357500              ,:CEPLIT-PL-LNE-NBR                                 35750040
357600              ,:CEPLIT-ITM-NBR                                    35760040
357700              ,:CEPLIT-PL-REQ-QTY                                 35770040
357800              ,NULL                                               35780040
357900              ,:CEPLIT-STAT-CDE                                   35790040
358000              ,:CEPLIT-UNT-RTL-AMT                                35800040
358100              ,:CEPLIT-EXPRT-PRC-BTCH-ID)                         35810040
358200     END-EXEC.                                                    35820040
358300                                                                  35830040
358400     EVALUATE TRUE                                                35840040
358500         WHEN SQLCODE = ZERO                                      35850040
358600              CONTINUE                                            35860040
358700                                                                  35870040
358800         WHEN SQLWARN0 NOT = +0                                   35880040
358900         WHEN SQLCODE < +0                                        35890040
359000         WHEN SQLCODE > +0                                        35900040
359100              SET PS-ERROR    TO TRUE                             35910040
359200              MOVE '4720-INSERT-TCEPLIT '                         35920040
359300                              TO DP013-PARAGRAPH                  35930040
359400              MOVE 'UNSUCCESSFUL INSERT IN CS ITEM      '         35940040
359500                              TO DP013-MESSAGE-TEXT (1)           35950040
359600              MOVE 'INSERT NEW REQUEST LINE ITEM        '         35960040
359700                              TO DP013-MESSAGE-TEXT (2)           35970040
359800              STRING ' PULL-'           DELIMITED BY SIZE         35980040
359900                     ASC-PULL-NBR-N     DELIMITED BY SIZE         35990040
360000                     '  -  LINE-'       DELIMITED BY SIZE         36000040
360100                     LQW-LINE-NBR (LQW-IDX)                       36010040
360200                                        DELIMITED BY SIZE         36020040
360300                             INTO DP013-MESSAGE-TEXT (3)          36030040
360400              MOVE SQLCA      TO DP013-SQLCA                      36040040
360500              MOVE 'TCEPLIT ' TO DP013-DB2-TABLE-NAME (1)         36050040
360600              SET DP013-DB2-ABEND                                 36060040
360700                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            36070040
360800              PERFORM DP013-0000-PROCESS-ABEND                    36080040
360900     END-EVALUATE.                                                36090040
361000                                                                  36100040
361100                                                                  36110040
361200*----------------------------------------------------------------*36120040
361300* INSERT ROW INTO CS PULL STATUS TABLE (TCEPLST)                 *36130040
361400*----------------------------------------------------------------*36140040
361500 4725-INSERT-TCEPLST.                                             36150040
361600                                                                  36160040
361700     MOVE  ASC-PULL-NBR-N         TO  CEPLST-CNSTK-REQ-PL-NBR.    36170040
361800     MOVE  LQW-LINE-NBR (LQW-IDX) TO  CEPLST-PL-LNE-NBR.          36180040
361900     MOVE  PC-NEW                 TO  CEPLST-STAT-CDE.            36190040
362000     MOVE  ASC-USER-ID            TO  CEPLST-CRE-BY-USR-ID.       36200040
362100                                                                  36210040
362200     EXEC SQL                                                     36220040
362300          INSERT                                                  36230040
362400          INTO  TCEPLST                                           36240040
362500               (CNSTK_REQ_PL_NBR                                  36250040
362600               ,PL_LNE_NBR                                        36260040
362700               ,CRE_TMST                                          36270040
362800               ,STAT_CDE                                          36280040
362900               ,CRE_BY_USR_ID)                                    36290040
363000        VALUES                                                    36300040
363100              (:CEPLST-CNSTK-REQ-PL-NBR                           36310040
363200              ,:CEPLST-PL-LNE-NBR                                 36320040
363300              , CURRENT TIMESTAMP                                 36330040
363400              ,:CEPLST-STAT-CDE                                   36340040
363500              ,:CEPLST-CRE-BY-USR-ID)                             36350040
363600     END-EXEC.                                                    36360040
363700                                                                  36370040
363800     EVALUATE TRUE                                                36380040
363900         WHEN SQLCODE = ZERO                                      36390040
364000              CONTINUE                                            36400040
364100                                                                  36410040
364200         WHEN SQLWARN0 NOT = +0                                   36420040
364300         WHEN SQLCODE < +0                                        36430040
364400         WHEN SQLCODE > +0                                        36440040
364500              SET PS-ERROR    TO TRUE                             36450040
364600              MOVE '4725-INSERT-TCEPLST'                          36460040
364700                              TO DP013-PARAGRAPH                  36470040
364800              MOVE 'UNSUCCESSFUL INSERT IN CS STATUS TBL'         36480040
364900                              TO DP013-MESSAGE-TEXT (1)           36490040
365000              MOVE 'INSERT STATUS FOR LINE              '         36500040
365100                              TO DP013-MESSAGE-TEXT (2)           36510040
365200              MOVE SQLCA      TO DP013-SQLCA                      36520040
365300              MOVE 'TCEPLST ' TO DP013-DB2-TABLE-NAME (1)         36530040
365400              SET DP013-DB2-ABEND                                 36540040
365500                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            36550040
365600          PERFORM DP013-0000-PROCESS-ABEND                        36560040
365700     END-EVALUATE.                                                36570040
365800                                                                  36580040
365900                                                                  36590040
366000*----------------------------------------------------------------*36600040
366100* INSERT ROW INTO CS PULL DISTRIBUTION TABLE (TCEPLDS)           *36610040
366200*----------------------------------------------------------------*36620040
366300 4730-INSERT-TCEPLDS.                                             36630040
366400                                                                  36640040
366500     MOVE  ASC-PULL-NBR-N         TO  CEPLDS-CNSTK-REQ-PL-NBR.    36650040
366600     MOVE  LQW-LINE-NBR (LQW-IDX) TO  CEPLDS-PL-LNE-NBR.          36660040
366700     MOVE  ASC-STORE-NBR          TO  CEPLDS-STR-NBR.             36670040
366800     MOVE  LQW-UNITS (LQW-IDX)    TO  CEPLDS-REQ-ORD-QTY.         36680040
366900                                                                  36690040
367000     EXEC SQL                                                     36700040
367100          INSERT                                                  36710040
367200          INTO  TCEPLDS                                           36720040
367300               (CNSTK_REQ_PL_NBR                                  36730040
367400               ,PL_LNE_NBR                                        36740040
367500               ,STR_NBR                                           36750040
367600               ,REQ_ORD_QTY                                       36760040
367700               ,ACTL_DISTRB_QTY)                                  36770040
367800        VALUES                                                    36780040
367900              (:CEPLDS-CNSTK-REQ-PL-NBR                           36790040
368000              ,:CEPLDS-PL-LNE-NBR                                 36800040
368100              ,:CEPLDS-STR-NBR                                    36810040
368200              ,:CEPLDS-REQ-ORD-QTY                                36820040
368300              ,NULL)                                              36830040
368400     END-EXEC.                                                    36840040
368500                                                                  36850040
368600     EVALUATE TRUE                                                36860040
368700         WHEN SQLCODE = ZERO                                      36870040
368800              CONTINUE                                            36880040
368900                                                                  36890040
369000         WHEN SQLWARN0 NOT = +0                                   36900040
369100         WHEN SQLCODE < +0                                        36910040
369200         WHEN SQLCODE > +0                                        36920040
369300              SET PS-ERROR    TO TRUE                             36930040
369400              MOVE '4730-INSERT-TCEPLDS'                          36940040
369500                              TO DP013-PARAGRAPH                  36950040
369600              MOVE 'UNSUCCESSFUL INSERT IN CS DISTRB TBL'         36960040
369700                              TO DP013-MESSAGE-TEXT (1)           36970040
369800              MOVE 'INSERT DISTRIBUTION                 '         36980040
369900                              TO DP013-MESSAGE-TEXT (2)           36990040
370000              MOVE SQLCA      TO DP013-SQLCA                      37000040
370100              MOVE 'TCEPLDS ' TO DP013-DB2-TABLE-NAME (1)         37010040
370200              SET DP013-DB2-ABEND                                 37020040
370300                  DP013-XCTL-DISPLAY-RESTART  TO  TRUE            37030040
370400          PERFORM DP013-0000-PROCESS-ABEND                        37040040
370500     END-EVALUATE.                                                37050040
370600                                                                  37060040
370700 4740-RESERVE-QUANTITY.                                           37070040
370800     INITIALIZE CE016-INV-TRANS-RECORD                            37080040
370900     MOVE LQW-SKU(LQW-IDX)     TO CE016-SKU-NUMBER.               37090040
371000     MOVE ASC-CS-LOC-N         TO CE016-STORE-NUMBER.             37100040
371100     SET CE016-TRANS-TYPE-X-TRANSFER TO TRUE.                     37110040
371200     SET CE016-TRANS-SRC-CENTRAL-STOCK TO TRUE.                   37120040
371300     MOVE ZERO                 TO CE016-TRANS-AVAIL-QTY.          37130040
371400     MOVE LQW-UNITS (LQW-IDX)  TO CE016-TRANS-RESV-QTY.           37140040
371500     MOVE PV-CURRENT-DATE TO CE016-TRANS-DATE.                    37150040
371600     MOVE ASC-PULL-NBR         TO PV-TRANS-PULL-NBR.              37160040
371700     MOVE PV-TRANS-SOURCE-DESC TO CE016-TRANS-SOURCE-DESC.        37170040
371800     SET PS-NO-REDUCE-QTY TO TRUE.                                37180040
371900     SET PS-SKU-FOUND     TO TRUE.                                37190040
372000     SET PS-SKU-PROCESSED TO TRUE.                                37200040
372100     PERFORM 8010-MQ-PUT1.                                        37210040
372200                                                                  37220040
372300*----------------------------------------------------------------*37230040
372400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *37240040
372500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *37250040
372600* FOR THE SELECTED ITEMS QUEUE.                                  *37260040
372700*                                                                *37270040
372800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *37280040
372900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *37290040
373000* THE ARRAY IS FULL.                                             *37300040
373100*----------------------------------------------------------------*37310040
373200                                                                  37320040
373300 5000-PREPARE-SEL-QUEUE.                                          37330040
373400                                                                  37340040
373500     MOVE +1                   TO  ASC-BLK-SUB.                   37350040
373600     PERFORM 5100-WRITE-TEMP-STORAGE.                             37360040
373700                                                                  37370040
373800     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          37380040
373900     PERFORM 6010-DELETE-SEL-QUEUE.                               37390040
374000                                                                  37400040
374100     SET ASC-UPDATE-TSQ        TO  TRUE.                          37410040
374200                                                                  37420040
374300     SET CE003-IDX             TO  1.                             37430040
374400     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       37440040
374500     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        37450040
374600                                                                  37460040
374700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           37470040
374800             VARYING PV-ITEM                                      37480040
374900             FROM 1 BY 1                                          37490040
375000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     37500040
375100                                                                  37510040
375200     IF  CE003-IDX > 1                                            37520040
375300         PERFORM 5205-WRITE-SEL-QUEUE                             37530040
375400         ADD +1                TO CE002-NUMBER-OF-TS-ITEMS        37540040
375500     END-IF.                                                      37550040
375600                                                                  37560040
375700                                                                  37570040
375800*----------------------------------------------------------------*37580040
375900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  THIS WILL ONLY *37590040
376000* CREATE ONE ENTRY IN THE SELECTION QUEUE.  THE NEXT PROGRAM     *37600040
376100* CAN ACCEPT MULTIPLE QUEUE ENTRIES, EACH CONTAINING A DIFFERENT *37610040
376200* LINE NUMBER.  SINCE THIS PROGRAM IS ONLY WORKING WITH ONE      *37620040
376300* LINE NUMBER IT WILL ONLY CREATE ONE ENTRY IN THE QUEUE.        *37630040
376400*                                                                *37640040
376500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *37650040
376600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *37660040
376700* THE ARRAY IS FULL.                                             *37670040
376800*----------------------------------------------------------------*37680040
376900 5000-PREPARE-SEL-QUEUE-1.                                        37690040
377000                                                                  37700040
377100     MOVE +1                   TO  ASC-BLK-SUB.                   37710040
377200     PERFORM 5100-WRITE-TEMP-STORAGE.                             37720040
377300                                                                  37730040
377400     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          37740040
377500     PERFORM 6010-DELETE-SEL-QUEUE.                               37750040
377600                                                                  37760040
377700     SET ASC-UPDATE-TSQ        TO  TRUE.                          37770040
377800                                                                  37780040
377900     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       37790040
378000     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        37800040
378100                                                                  37810040
378200     PERFORM 5200-FILL-SEL-QUEUE-RECORD-1.                        37820040
378300                                                                  37830040
378400     PERFORM 5205-WRITE-SEL-QUEUE                                 37840040
378500     ADD +1                    TO CE002-NUMBER-OF-TS-ITEMS.       37850040
378600                                                                  37860040
378700                                                                  37870040
378800*----------------------------------------------------------------*37880040
378900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *37890040
379000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *37900040
379100*----------------------------------------------------------------*37910040
379200                                                                  37920040
379300 5100-WRITE-TEMP-STORAGE.                                         37930040
379400     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     37940040
379500                                   TO PV-LIST-ITEM-NUMBER.        37950040
379600     COMPUTE PV-BLOCK-NUMBER =                                    37960040
379700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    37970040
379800                                                                  37980040
379900     IF  ASC-HIGHEST-BLOCK-WRITTEN  >  +1                         37990040
380000         MOVE  +1  TO  ASC-HIGHEST-BLOCK-WRITTEN                  38000040
380100     END-IF.                                                      38010040
380200                                                                  38020040
380300     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             38030040
380400     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             38040040
380500         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      38050040
380600             PERFORM 5105-REWRITE-ASC-LISTQ                       38060040
380700         END-IF                                                   38070040
380800     ELSE                                                         38080040
380900         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       38090040
381000         ASC-HIGHEST-BLOCK-WRITTEN + 1                            38100040
381100         PERFORM 5110-WRITE-ASC-LISTQ                             38110040
381200         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   38120040
381300     END-IF.                                                      38130040
381400                                                                  38140040
381500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             38150040
381600******************************************************************38160040
381700** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **38170040
381800** SPECIFIC COMMAREA.                                           **38180040
381900******************************************************************38190040
382000 5105-REWRITE-ASC-LISTQ.                                          38200040
382100     EXEC CICS                                                    38210040
382200         WRITEQ TS                                                38220040
382300             QUEUE (ASC-LIST-QUEUE-NAME)                          38230040
382400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               38240040
382500             ITEM  (PV-BLOCK-NUMBER)                              38250040
382600             REWRITE                                              38260040
382700             RESP  (PV-CICS-RESP)                                 38270040
382800     END-EXEC.                                                    38280040
382900                                                                  38290040
383000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           38300040
383100         CONTINUE                                                 38310040
383200     ELSE                                                         38320040
383300         SET DP013-CICS-ABEND            TO TRUE                  38330040
383400         SET DP013-NO-ROLLBACK           TO TRUE                  38340040
383500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       38350040
383600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     38360040
383700                                         TO DP013-MESSAGE-TEXT(1) 38370040
383800         PERFORM DP013-0000-PROCESS-ABEND                         38380040
383900     END-IF.                                                      38390040
384000                                                                  38400040
384100******************************************************************38410040
384200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **38420040
384300** SPECIFIC COMMAREA.                                           **38430040
384400******************************************************************38440040
384500 5110-WRITE-ASC-LISTQ.                                            38450040
384600     EXEC CICS                                                    38460040
384700         WRITEQ TS                                                38470040
384800             QUEUE (ASC-LIST-QUEUE-NAME)                          38480040
384900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               38490040
385000             ITEM  (PV-BLOCK-NUMBER)                              38500040
385100             RESP  (PV-CICS-RESP)                                 38510040
385200     END-EXEC.                                                    38520040
385300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      38530040
385400         SET DP013-CICS-ABEND      TO TRUE                        38540040
385500         SET DP013-NO-ROLLBACK     TO TRUE                        38550040
385600         MOVE '5110-WRITE-ASC-LISTQ'                              38560040
385700                                   TO DP013-PARAGRAPH             38570040
385800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           38580040
385900                                   TO DP013-MESSAGE-TEXT(1)       38590040
386000         PERFORM DP013-0000-PROCESS-ABEND                         38600040
386100     END-IF.                                                      38610040
386200 EJECT                                                            38620040
386300*----------------------------------------------------------------*38630040
386400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *38640040
386500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *38650040
386600*----------------------------------------------------------------*38660040
386700                                                                  38670040
386800 5200-FILL-SEL-QUEUE-RECORD.                                      38680040
386900                                                                  38690040
387000     PERFORM 6112-READ-LIST-QUEUE.                                38700040
387100                                                                  38710040
387200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38720040
387300         PERFORM                                                  38730040
387400         VARYING LQW-IDX                                          38740040
387500         FROM 1 BY 1                                              38750040
387600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38760040
387700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          38770040
387800                                                                  38780040
387900             IF  LQW-SELECT (LQW-IDX)                             38790040
388000                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              38800040
388100                                   TO CE003-ITEM (CE003-IDX)      38810040
388200                 MOVE SPACE        TO CE003-ACTION-SW (CE003-IDX) 38820040
388300                                                                  38830040
388400                 MOVE ASC-PULL-NBR TO  CE003-PULL-NUMBER          38840040
388500                                        (CE003-IDX)               38850040
388600                 MOVE ASC-REF-NBR  TO  CE003-REF-NUMBER           38860040
388700                                        (CE003-IDX)               38870040
388800                 MOVE ASC-CS-LOC   TO  CE003-CS-LOCATION          38880040
388900                                        (CE003-IDX)               38890040
389000                 MOVE ZEROES       TO  CE003-CREATE-DATE          38900040
389100                                        (CE003-IDX)               38910040
389200                 MOVE ASC-PULL-STATUS                             38920040
389300                                   TO  CE003-PULL-STATUS-CDE      38930040
389400                                        (CE003-IDX)               38940040
389500                 MOVE ZEROES       TO  CE003-NBR-ITEMS            38950040
389600                                        (CE003-IDX)               38960040
389700                 MOVE ZEROES       TO  CE003-NBR-STORES           38970040
389800                                        (CE003-IDX)               38980040
389900                 MOVE ZEROES       TO  CE003-REQ-PULL-UNITS       38990040
390000                                        (CE003-IDX)               39000040
390100                 MOVE ZEROES       TO  CE003-ACT-PULL-UNITS       39010040
390200                                        (CE003-IDX)               39020040
390300                 MOVE ZEROES       TO  CE003-DIST-PULL-UNITS      39030040
390400                                        (CE003-IDX)               39040040
390500                 MOVE ZEROES       TO  CE003-LINE-STATUS-CDE      39050040
390600                                        (CE003-IDX)               39060040
390700                 MOVE LQW-SKU (LQW-IDX)                           39070040
390800                                   TO  CE003-LINE-SKU             39080040
390900                                        (CE003-IDX)               39090040
391000                 MOVE LQW-SKU-RETAIL (LQW-IDX)                    39100040
391100                                   TO  CE003-LINE-SKU-RETAIL      39110040
391200                                        (CE003-IDX)               39120040
391300                 MOVE LQW-LINE-ITEM (LQW-IDX)                     39130040
391400                                   TO  CE003-LINE-ITEM            39140040
391500                                        (CE003-IDX)               39150040
391600                 MOVE LQW-LINE-NBR (LQW-IDX)                      39160040
391700                                   TO  CE003-LINE-NUMBER          39170040
391800                                        (CE003-IDX)               39180040
391900                                                                  39190040
392000                 SET CE003-IDX UP BY 1                            39200040
392100                 IF  CE003-IDX > CE003-MAX-ITEMS                  39210040
392200                     PERFORM 5205-WRITE-SEL-QUEUE                 39220040
392300                     ADD +1        TO CE002-NUMBER-OF-TS-ITEMS    39230040
392400                     INITIALIZE CE003-SELECTED-ITEM-ARRAY         39240040
392500                     SET CE003-IDX TO  1                          39250040
392600                 END-IF                                           39260040
392700             END-IF                                               39270040
392800         END-PERFORM                                              39280040
392900     END-IF.                                                      39290040
393000                                                                  39300040
393100                                                                  39310040
393200*----------------------------------------------------------------*39320040
393300*                                                                *39330040
393400*----------------------------------------------------------------*39340040
393500 5200-FILL-SEL-QUEUE-RECORD-1.                                    39350040
393600                                                                  39360040
393700     MOVE 1                 TO  CE003-ITEM (CE003-IDX)            39370040
393800     MOVE ASC-PULL-NBR-N    TO  CE003-PULL-NUMBER (CE003-IDX)     39380040
393900     MOVE ASC-REF-NBR       TO  CE003-REF-NUMBER (CE003-IDX)      39390040
394000     MOVE ZEROES            TO  CE003-LINE-NUMBER (CE003-IDX)     39400040
394100     MOVE ASC-CS-LOC-N      TO  CE003-CS-LOCATION (CE003-IDX)     39410040
394200     MOVE ZEROES            TO  CE003-CREATE-DATE (CE003-IDX)     39420040
394300     MOVE ASC-PULL-STATUS   TO  CE003-PULL-STATUS-CDE (CE003-IDX) 39430040
394400     MOVE ASC-PULL-TYPE     TO  CE003-PULL-SOURCE-CDE (CE003-IDX) 39440040
394500     MOVE ZEROES            TO  CE003-NBR-ITEMS (CE003-IDX)       39450040
394600                                CE003-NBR-STORES (CE003-IDX)      39460040
394700                                CE003-REQ-PULL-UNITS (CE003-IDX)  39470040
394800                                CE003-DIST-PULL-UNITS (CE003-IDX) 39480040
394900     MOVE SPACES            TO  CE003-LINE-STATUS-CDE (CE003-IDX) 39490040
395000     MOVE ZEROES            TO  CE003-LINE-SKU (CE003-IDX)        39500040
395100     MOVE ZEROES            TO  CE003-LINE-SKU-RETAIL (CE003-IDX).39510040
395200                                                                  39520040
395300                                                                  39530040
395400*----------------------------------------------------------------*39540040
395500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *39550040
395600*----------------------------------------------------------------*39560040
395700                                                                  39570040
395800 5205-WRITE-SEL-QUEUE.                                            39580040
395900                                                                  39590040
396000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            39600040
396100                                   TO CE003-SELECTED-ITEMS.       39610040
396200                                                                  39620040
396300     EXEC CICS                                                    39630040
396400          WRITEQ TS                                               39640040
396500              QUEUE (ASC-SEL-QUEUE-NAME)                          39650040
396600              FROM  (CE003-SELECT-RECORD)                         39660040
396700              ITEM  (PV-SEL-QUEUE-ITEM)                           39670040
396800              RESP  (PV-CICS-RESP)                                39680040
396900     END-EXEC.                                                    39690040
397000                                                                  39700040
397100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          39710040
397200         CONTINUE                                                 39720040
397300     ELSE                                                         39730040
397400         SET DP013-CICS-ABEND      TO TRUE                        39740040
397500         SET DP013-NO-ROLLBACK     TO TRUE                        39750040
397600         MOVE '5205-WRITE-SEL-QUEUE'                              39760040
397700                                   TO DP013-PARAGRAPH             39770040
397800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          39780040
397900                                   TO DP013-MESSAGE-TEXT(1)       39790040
398000         PERFORM DP013-0000-PROCESS-ABEND                         39800040
398100     END-IF.                                                      39810040
398200 EJECT                                                            39820040
398300******************************************************************39830040
398400** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **39840040
398500** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **39850040
398600** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **39860040
398700** THE USER.                                                    **39870040
398800******************************************************************39880040
398900 6000-REFRESH-PANEL-FROM-TEMP.                                    39890040
399000     IF  ASC-UPDATE-TSQ                                           39900040
399100         SET ASC-NO-TSQ-UPDATE TO TRUE                            39910040
399200         MOVE ZERO                 TO PV-SAVE-ITEM                39920040
399300                                      PV-SEL-QUEUE-ITEM           39930040
399400         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        39940040
399500                                   TO PV-HOLD-SELECTED-ITEMS      39950040
399600         MOVE +1                   TO PV-ITEMS-PROCESSED          39960040
399700         PERFORM 6100-UPDATE-TSQ                                  39970040
399800             UNTIL PV-ITEMS-PROCESSED >                           39980040
399900                                     PV-HOLD-SELECTED-ITEMS       39990040
400000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         40000040
400100     END-IF.                                                      40010040
400200                                                                  40020040
400300*----------------------------------------------------------------*40030040
400400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *40040040
400500*----------------------------------------------------------------*40050040
400600 6010-DELETE-SEL-QUEUE.                                           40060040
400700                                                                  40070040
400800     EXEC CICS                                                    40080040
400900         DELETEQ TS                                               40090040
401000             QUEUE (ASC-SEL-QUEUE-NAME)                           40100040
401100             RESP  (PV-CICS-RESP)                                 40110040
401200     END-EXEC.                                                    40120040
401300*                                                                 40130040
401400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      40140040
401500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         40150040
401600         CONTINUE                                                 40160040
401700     ELSE                                                         40170040
401800         SET DP013-CICS-ABEND TO TRUE                             40180040
401900         SET DP013-NO-ROLLBACK TO TRUE                            40190040
402000         MOVE '6010-DELETE-SEL-QUEUE'                             40200040
402100                        TO DP013-PARAGRAPH                        40210040
402200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         40220040
402300                        TO DP013-MESSAGE-TEXT (1)                 40230040
402400         PERFORM DP013-0000-PROCESS-ABEND                         40240040
402500     END-IF.                                                      40250040
402600                                                                  40260040
402700*----------------------------------------------------------------*40270040
402800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *40280040
402900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *40290040
403000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *40300040
403100*    THE TEMP QUEUE.                                             *40310040
403200*----------------------------------------------------------------*40320040
403300                                                                  40330040
403400 6100-UPDATE-TSQ.                                                 40340040
403500                                                                  40350040
403600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             40360040
403700     PERFORM 6105-READ-SEL-QUEUE.                                 40370040
403800     PERFORM                                                      40380040
403900         VARYING CE003-IDX                                        40390040
404000         FROM 1 BY 1                                              40400040
404100         UNTIL ((PV-ITEMS-PROCESSED >                             40410040
404200                              PV-HOLD-SELECTED-ITEMS)             40420040
404300         OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))             40430040
404400         IF  CE003-ACTION-SW (CE003-IDX) > SPACE                  40440040
404500             PERFORM 6110-PROCESS-ITEMS                           40450040
404600         END-IF                                                   40460040
404700         ADD +1                TO PV-ITEMS-PROCESSED              40470040
404800     END-PERFORM.                                                 40480040
404900     PERFORM 6111-WRITE-LIST-QUEUE.                               40490040
405000*----------------------------------------------------------------*40500040
405100*    READ THE LIST QUEUE RECORD.                                 *40510040
405200*----------------------------------------------------------------*40520040
405300                                                                  40530040
405400 6105-READ-SEL-QUEUE.                                             40540040
405500                                                                  40550040
405600     EXEC CICS                                                    40560040
405700          READQ TS                                                40570040
405800              QUEUE (ASC-SEL-QUEUE-NAME)                          40580040
405900              INTO  (CE003-SELECT-RECORD)                         40590040
406000              ITEM  (PV-SEL-QUEUE-ITEM)                           40600040
406100              RESP  (PV-CICS-RESP)                                40610040
406200     END-EXEC.                                                    40620040
406300*                                                                 40630040
406400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40640040
406500         CONTINUE                                                 40650040
406600     ELSE                                                         40660040
406700         SET DP013-CICS-ABEND      TO  TRUE                       40670040
406800         SET DP013-NO-ROLLBACK     TO  TRUE                       40680040
406900         MOVE '6105-READ-SEL-QUEUE'                               40690040
407000                                   TO  DP013-PARAGRAPH            40700040
407100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           40710040
407200                                   TO  DP013-MESSAGE-TEXT(1)      40720040
407300         PERFORM DP013-0000-PROCESS-ABEND                         40730040
407400     END-IF.                                                      40740040
407500 EJECT                                                            40750040
407600*----------------------------------------------------------------*40760040
407700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*40770040
407800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*40780040
407900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *40790040
408000*----------------------------------------------------------------*40800040
408100                                                                  40810040
408200 6110-PROCESS-ITEMS.                                              40820040
408300                                                                  40830040
408400     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          40840040
408500                     / PC-ITEMS-PER-PANEL).                       40850040
408600                                                                  40860040
408700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           40870040
408800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          40880040
408900             PERFORM 6111-WRITE-LIST-QUEUE                        40890040
409000         END-IF                                                   40900040
409100         MOVE PV-ITEM          TO PV-SAVE-ITEM                    40910040
409200                                                                  40920040
409300         PERFORM 6112-READ-LIST-QUEUE                             40930040
409400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               40940040
409500             CONTINUE                                             40950040
409600         END-IF                                                   40960040
409700     END-IF.                                                      40970040
409800                                                                  40980040
409900     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     40990040
410000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              41000040
410100                                                                  41010040
410200     IF  CE003-ACTION-SW(CE003-IDX) > SPACE                       41020040
410300         MOVE  SPACE  TO  LQW-TEMP-SELECTED-SW (PV-SUB)           41030040
410400                          LQW-SELECTED-SW (PV-SUB)                41040040
410500     END-IF                                                       41050040
410600     EVALUATE TRUE                                                41060040
410700         WHEN CE003-INQ (CE003-IDX)                               41070040
410800              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             41080040
410900                                                                  41090040
411000         WHEN CE003-UPD (CE003-IDX)                               41100040
411100              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             41110040
411200                                                                  41120040
411300         WHEN CE003-DEL (CE003-IDX)                               41130040
411400              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             41140040
411500                                                                  41150040
411600         WHEN CE003-ERR (CE003-IDX)                               41160040
411700              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             41170040
411800     END-EVALUATE.                                                41180040
411900                                                                  41190040
412000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                41200040
412100                                                                  41210040
412200*----------------------------------------------------------------*41220040
412300*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *41230040
412400*----------------------------------------------------------------*41240040
412500                                                                  41250040
412600 6111-WRITE-LIST-QUEUE.                                           41260040
412700                                                                  41270040
412800     EXEC CICS                                                    41280040
412900         WRITEQ TS                                                41290040
413000             QUEUE (ASC-LIST-QUEUE-NAME)                          41300040
413100             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     41310040
413200             ITEM  (PV-SAVE-ITEM)                                 41320040
413300             REWRITE                                              41330040
413400             RESP  (PV-CICS-RESP)                                 41340040
413500     END-EXEC.                                                    41350040
413600*                                                                 41360040
413700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          41370040
413800         CONTINUE                                                 41380040
413900     ELSE                                                         41390040
414000         SET DP013-CICS-ABEND  TO  TRUE                           41400040
414100         SET DP013-NO-ROLLBACK TO  TRUE                           41410040
414200         MOVE '6111-WRITE-LIST-QUEUE'                             41420040
414300                               TO  DP013-PARAGRAPH                41430040
414400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  41440040
414500                               TO  DP013-MESSAGE-TEXT(1)          41450040
414600         PERFORM DP013-0000-PROCESS-ABEND                         41460040
414700     END-IF.                                                      41470040
414800                                                                  41480040
414900 EJECT                                                            41490040
415000*----------------------------------------------------------------*41500040
415100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*41510040
415200*----------------------------------------------------------------*41520040
415300                                                                  41530040
415400 6112-READ-LIST-QUEUE.                                            41540040
415500                                                                  41550040
415600     EXEC CICS                                                    41560040
415700         READQ TS                                                 41570040
415800             QUEUE (ASC-LIST-QUEUE-NAME)                          41580040
415900             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     41590040
416000             ITEM  (PV-ITEM)                                      41600040
416100             RESP  (PV-CICS-RESP)                                 41610040
416200     END-EXEC.                                                    41620040
416300*                                                                 41630040
416400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          41640040
416500         CONTINUE                                                 41650040
416600     ELSE                                                         41660040
416700         SET DP013-CICS-ABEND        TO TRUE                      41670040
416800         SET DP013-NO-ROLLBACK       TO TRUE                      41680040
416900         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           41690040
417000         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    41700040
417100                                     TO DP013-MESSAGE-TEXT(1)     41710040
417200         PERFORM DP013-0000-PROCESS-ABEND                         41720040
417300     END-IF.                                                      41730040
417400                                                                  41740040
417410 7000-PROCESS-MQ-CHECK.                                           41741043
417412     MOVE ASC-CS-LOC-N           TO KRPRPM-LOC-ID                 41741253
417413                                                                  41741353
417414     EXEC SQL                                                     41741453
417415        SELECT FUNC_TXT                                           41741553
417416          INTO :KRPRPM-FUNC-TXT                                   41741653
417417          FROM TKRPRPM                                            41741753
417418         WHERE   LOC_ID            = :KRPRPM-LOC-ID               41741853
417419           AND   INTFC_SYS_CDE     = 'KHL'                        41741953
417420           AND   SYS_PRC_FUNC_CDE  = 'CEPLMQ'                     41742053
417421           AND   FUNC_PRC_STAT_CDE = 'AC'                         41742153
417422           AND (CURRENT DATE                                      41742253
417423       BETWEEN DATE(FUNC_BEG_TMST) AND                            41742353
417424               DATE(FUNC_END_TMST) )                              41742453
417425     END-EXEC.                                                    41742553
417426                                                                  41742653
417427     EVALUATE SQLCODE                                             41742753
417428         WHEN ZERO                                                41742853
417429             MOVE KRPRPM-FUNC-TXT TO PS-PROCESS-MQ-SW             41742953
417430         WHEN +100                                                41743053
417431             SET PS-PROCESS-MQ-NO TO TRUE                         41743153
417432         WHEN OTHER                                               41743253
417433              MOVE '7000-PROCESS-MQ-CHECK'                        41743353
417434                               TO DP013-PARAGRAPH                 41743453
417435              MOVE 'SELECT MQ PROCESS PARM'                       41743553
417436                               TO DP013-MESSAGE-TEXT (1)          41743653
417437              MOVE SQLCA       TO DP013-SQLCA                     41743753
417438              SET DP013-DB2-ABEND                                 41743853
417439                               TO TRUE                            41743953
417440              PERFORM DP013-0000-PROCESS-ABEND                    41744053
417448     END-EVALUATE.                                                41744843
417450                                                                  41745043
417410 7010-GET-MAX-LINES.                                              41746068
417413                                                                  41748068
417414     EXEC SQL                                                     41749068
417415        SELECT FUNC_QTY                                           41749171
417416          INTO :PV-MAX-PULL-LINES                                 41749268
417417          FROM TKRPRPM                                            41749368
417419         WHERE   INTFC_SYS_CDE     = 'RDM'                        41749568
417420           AND   SYS_PRC_FUNC_CDE  = 'MXPLLN'                     41749668
417421           AND   FUNC_PRC_STAT_CDE = 'AC'                         41749768
417425     END-EXEC.                                                    41750168
417426                                                                  41750268
417427     EVALUATE SQLCODE                                             41750368
417428         WHEN ZERO                                                41750468
417429             CONTINUE                                             41750568
417432         WHEN OTHER                                               41750868
417433              MOVE '7010-GET-MAX-LINES'                           41750968
417434                               TO DP013-PARAGRAPH                 41751068
417435              MOVE 'SELECT MAX PULL LINES'                        41751168
417436                               TO DP013-MESSAGE-TEXT (1)          41751268
417437              MOVE SQLCA       TO DP013-SQLCA                     41751368
417438              SET DP013-DB2-ABEND                                 41751468
417439                               TO TRUE                            41751568
417440              PERFORM DP013-0000-PROCESS-ABEND                    41751668
417448     END-EVALUATE.                                                41751768
417450                                                                  41751868
417500 8000-MQ-SETUP.                                                   41752040
417600                                                                  41760040
417700* DETERMINE THE SYSTEM                                            41770040
417800                                                                  41780040
417900     PERFORM EP000-0000-INITIALIZE.                               41790040
418000     IF EP000-PV-KOHLS-PROD-SYSTEM                                41800040
418100         SET PC-PROD-QMGR-NAME     TO TRUE                        41810040
418200     ELSE                                                         41820040
418300          IF EP000-PV-KOHLS-QA-SYSTEM                             41830040
418400              SET PC-QA-QMGR-NAME  TO TRUE                        41840040
418500          ELSE                                                    41850040
418600              SET PC-TEST-QMGR-NAME                               41860040
418700                                   TO TRUE                        41870040
418800          END-IF                                                  41880040
418900     END-IF.                                                      41890040
419000                                                                  41900040
419100* CONNECT TO THE QUEUE                                            41910040
419200                                                                  41920040
419300     SET PS-NO-MQ-ERROR            TO TRUE.                       41930040
419400     MOVE PC-QMGR-NAME             TO PV-QM-NAME.                 41940040
419500     CALL PC-MQCONN USING PV-QM-NAME                              41950040
419600                          PV-HCONN                                41960040
419700                          PV-COMPLETION-CODE                      41970040
419800                          PV-REASON.                              41980040
419900                                                                  41990040
420000*    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              42000040
420100*    AND EXIT                                                     42010040
420200                                                                  42020040
420300     MOVE PV-REASON TO PV-CON-REASON.                             42030040
420400     IF (PV-COMPLETION-CODE = MQCC-OK)                            42040040
420500         CONTINUE                                                 42050040
420600     ELSE                                                         42060040
420700         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       42070040
420800         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           42080040
420900         MOVE PV-QM-NAME           TO PE-MQ-QMANAGER              42090040
421000         SET  PE-MQ-CONNECT        TO TRUE                        42100040
421100         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       42110040
421200         MOVE PV-REASON            TO PE-MQ-REASON-CODE           42120040
421300         PERFORM 9900-MQ-ERROR                                    42130040
421400         SET PS-MQ-ERROR           TO TRUE                        42140040
421500         MOVE PC-TSYMSG-02677  TO  DP020-MSG-NUMBER               42150040
421600     END-IF.                                                      42160040
421700     IF PS-NO-MQ-ERROR                                            42170040
421800         SET PS-MQ-SETUP-COMPLETE TO TRUE                         42180040
421900     END-IF.                                                      42190040
422000                                                                  42200040
422100                                                                  42210040
422200*----------------------------------------------------------------*42220040
422300*  PUT THE MQ MESSAGE ONTO THE QUEUE                              42230040
422400*----------------------------------------------------------------*42240040
422500                                                                  42250040
422600 8010-MQ-PUT1.                                                    42260040
422700                                                                  42270040
422800     PERFORM 8070-GET-QUEUE-NAME.                                 42280040
422900     MOVE PV-OBJECTNAME            TO MQOD-OBJECTNAME.            42290040
423000     PERFORM 8090-GET-QMGR-NAME.                                  42300040
423100     MOVE PV-OBJECTQMGRNAME        TO MQOD-OBJECTQMGRNAME.        42310040
423200     COMPUTE MQPMO-OPTIONS         = MQPMO-FAIL-IF-QUIESCING      42320040
423300                                   + MQPMO-SYNCPOINT.             42330040
423400     MOVE MQFMT-STRING             TO MQMD-FORMAT.                42340040
423500     MOVE LENGTH OF CE016-INV-TRANS-RECORD                        42350040
423600                                   TO PV-MSGLENGTH.               42360040
423700                                                                  42370040
423800                                                                  42380040
423900     CALL PC-MQPUT1 USING PV-HCONN                                42390040
424000                          MQM-OBJECT-DESCRIPTOR                   42400040
424100                          MQM-MESSAGE-DESCRIPTOR                  42410040
424200                          MQM-PUT-MESSAGE-OPTIONS                 42420040
424300                          PV-MSGLENGTH                            42430040
424400                          CE016-INV-TRANS-RECORD                  42440040
424500                          PV-COMPLETION-CODE                      42450040
424600                          PV-REASON.                              42460040
424700                                                                  42470040
424800     IF (PV-COMPLETION-CODE = MQCC-OK)                            42480040
424900         CONTINUE                                                 42490040
425000     ELSE                                                         42500040
425100         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       42510040
425200         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           42520040
425300         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              42530040
425400         SET  PE-MQ-PUT1           TO TRUE                        42540040
425500         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       42550040
425600         MOVE PV-REASON            TO PE-MQ-REASON-CODE           42560040
425700         MOVE PV-REASON            TO  PV-REASON-CODE             42570040
425800         MOVE PV-MQ-REASON-TEXT    TO  PV-MQ-REASON-TXT           42580040
425900         PERFORM 9900-MQ-ERROR                                    42590040
426000         PERFORM 8060-MQ-DISCONNECT                               42600040
426100         SET PS-MQ-ERROR           TO TRUE                        42610040
426200         MOVE '8010-MQ-PUT1'       TO  PV-MQ-PARAGRAPH            42620040
426300         MOVE PV-MQ-SOFT-ABORT-MSG      TO PV-CICS-MSG-AREA2      42630040
426400         MOVE LENGTH OF PV-CICS-MSG-AREA2                         42640040
426500              TO PV-COMMAREA-LENGTH                               42650040
426600         EXEC CICS                                                42660040
426700              WRITEQ TD                                           42670040
426800               QUEUE  ('CSSL')                                    42680040
426900                FROM  (PV-CICS-MSG-AREA2)                         42690040
427000              LENGTH  (PV-COMMAREA-LENGTH)                        42700040
427100                RESP  (PV-CICS-RESP)                              42710040
427200         END-EXEC                                                 42720040
427300         MOVE  PC-TSYMSG-02677  TO  DP020-MSG-NUMBER              42730040
427400         SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE                  42740040
427500         PERFORM 9900-SOFT-ABORT                                  42750040
427600                                                                  42760040
427700     END-IF.                                                      42770040
427800                                                                  42780040
427900     IF PS-NO-MQ-ERROR                                            42790040
428000         PERFORM 8020-CICS-MQ-COMMIT                              42800040
428100     ELSE                                                         42810040
428200         PERFORM 8060-MQ-DISCONNECT                               42820040
428300     END-IF.                                                      42830040
428400*--------------------------------------------------------------*  42840040
428500*  COMMIT THE MQ PUT BY USING A CICS SYNCPOINT COMMAND.           42850040
428600*  (MQ COMMIT DOES NOT WORK IN CICS, THE SYNCPOINT MUST BE     *  42860040
428700*  USED)                                                          42870040
428800*--------------------------------------------------------------*  42880040
428900 8020-CICS-MQ-COMMIT.                                             42890040
429000                                                                  42900040
429100     EXEC CICS                                                    42910040
429200         SYNCPOINT                                                42920040
429300     END-EXEC.                                                    42930040
429400                                                                  42940040
429500     PERFORM 8030-MQ-GET-OPEN.                                    42950040
429600                                                                  42960040
429700*----------------------------------------------------------------*42970040
429800*  OPEN THE MESSAGE QUEUE THAT WILL GET THE RESPONSE MESSAGE     *42980040
429900*----------------------------------------------------------------*42990040
430000                                                                  43000040
430100 8030-MQ-GET-OPEN.                                                43010040
430200                                                                  43020040
430300     PERFORM 8080-GET-QUEUE-NAME.                                 43030040
430400     MOVE PV-OBJECTNAME            TO MQOD-OBJECTNAME.            43040040
430500     COMPUTE PV-OPEN-OPTIONS       = MQOO-INPUT-SHARED            43050040
430600                                   + MQOO-FAIL-IF-QUIESCING.      43060040
430700     MOVE PC-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        43070040
430800                                                                  43080040
430900     CALL PC-MQOPEN USING PV-HCONN                                43090040
431000                          MQM-OBJECT-DESCRIPTOR                   43100040
431100                          PV-OPEN-OPTIONS                         43110040
431200                          PV-GQ-HANDLE                            43120040
431300                          PV-COMPLETION-CODE                      43130040
431400                          PV-REASON.                              43140040
431500                                                                  43150040
431600     IF (PV-COMPLETION-CODE = MQCC-OK)                            43160040
431700         CONTINUE                                                 43170040
431800     ELSE                                                         43180040
431900         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       43190040
432000         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           43200040
432100         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              43210040
432200         SET  PE-MQ-OPEN           TO TRUE                        43220040
432300         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       43230040
432400         MOVE PV-REASON            TO PE-MQ-REASON-CODE           43240040
432500         MOVE PV-REASON            TO  PV-REASON-CODE             43250040
432600         MOVE PV-MQ-REASON-TEXT    TO  PV-MQ-REASON-TXT           43260040
432700         PERFORM 9900-MQ-ERROR                                    43270040
432800         PERFORM 8060-MQ-DISCONNECT                               43280040
432900         SET PS-MQ-ERROR           TO TRUE                        43290040
433000         MOVE '8030-MQ-GET-OPEN'   TO  PV-MQ-PARAGRAPH            43300040
433100         MOVE PV-MQ-SOFT-ABORT-MSG      TO PV-CICS-MSG-AREA2      43310040
433200         MOVE LENGTH OF PV-CICS-MSG-AREA2                         43320040
433300              TO PV-COMMAREA-LENGTH                               43330040
433400         EXEC CICS                                                43340040
433500              WRITEQ TD                                           43350040
433600               QUEUE  ('CSSL')                                    43360040
433700                FROM  (PV-CICS-MSG-AREA2)                         43370040
433800              LENGTH  (PV-COMMAREA-LENGTH)                        43380040
433900                RESP  (PV-CICS-RESP)                              43390040
434000         END-EXEC                                                 43400040
434100         MOVE  PC-TSYMSG-02677  TO  DP020-MSG-NUMBER              43410040
434200         SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE                  43420040
434300         PERFORM 9900-SOFT-ABORT                                  43430040
434400     END-IF.                                                      43440040
434500     IF PS-NO-MQ-ERROR                                            43450040
434600         PERFORM 8040-MQ-GET                                      43460040
434700     ELSE                                                         43470040
434800         PERFORM 8060-MQ-DISCONNECT                               43480040
434900     END-IF.                                                      43490040
435000                                                                  43500040
435100*----------------------------------------------------------------*43510040
435200*  WAIT FOR THE MESSAGE TO COME BACK FROM THE LOADER PROGRAM     *43520040
435300*  INDICATING THAT THE DATABSE LOAD WAS SUCCESSFUL                43530040
435400*----------------------------------------------------------------*43540040
435500                                                                  43550040
435600 8040-MQ-GET.                                                     43560040
435700                                                                  43570040
435800     MOVE 60000                    TO MQGMO-WAITINTERVAL.         43580040
435900     MOVE MQMD-MSGID               TO MQMD-CORRELID.              43590040
436000     MOVE MQMI-NONE                TO MQMD-MSGID.                 43600040
436100     COMPUTE MQGMO-OPTIONS         = MQGMO-WAIT                   43610040
436200                                   + MQGMO-FAIL-IF-QUIESCING      43620040
436300                                   + MQGMO-CONVERT.               43630040
436400     MOVE PC-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        43640040
436500                                                                  43650040
436600                                                                  43660040
436700     CALL PC-MQGET USING PV-HCONN                                 43670040
436800                         PV-GQ-HANDLE                             43680040
436900                         MQM-MESSAGE-DESCRIPTOR                   43690040
437000                         MQM-GET-MESSAGE-OPTIONS                  43700040
437100                         PV-MSGLENGTH                             43710040
437200                         CE016-INV-TRANS-RECORD                   43720040
437300                         PV-DATA-LENGTH                           43730040
437400                         PV-COMPLETION-CODE                       43740040
437500                         PV-REASON.                               43750040
437600                                                                  43760040
437700     IF (PV-COMPLETION-CODE = MQCC-OK)                            43770040
437800         CONTINUE                                                 43780040
437900     ELSE                                                         43790040
438000         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       43800040
438100         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           43810040
438200         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              43820040
438300         SET  PE-MQ-GET            TO TRUE                        43830040
438400         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       43840040
438500         MOVE PV-REASON            TO PE-MQ-REASON-CODE           43850040
438600         MOVE PV-REASON            TO  PV-REASON-CODE             43860040
438700         MOVE PV-MQ-REASON-TEXT    TO  PV-MQ-REASON-TXT           43870040
438800         PERFORM 9900-MQ-ERROR                                    43880040
438900         PERFORM 8060-MQ-DISCONNECT                               43890040
439000         SET PS-MQ-ERROR           TO TRUE                        43900040
439100         MOVE '8040-MQ-GET'        TO  PV-MQ-PARAGRAPH            43910040
439200         MOVE PV-MQ-SOFT-ABORT-MSG      TO PV-CICS-MSG-AREA2      43920040
439300         MOVE LENGTH OF PV-CICS-MSG-AREA2                         43930040
439400              TO PV-COMMAREA-LENGTH                               43940040
439500         EXEC CICS                                                43950040
439600              WRITEQ TD                                           43960040
439700               QUEUE  ('CSSL')                                    43970040
439800                FROM  (PV-CICS-MSG-AREA2)                         43980040
439900              LENGTH  (PV-COMMAREA-LENGTH)                        43990040
440000                RESP  (PV-CICS-RESP)                              44000040
440100         END-EXEC                                                 44010040
440200         MOVE  PC-TSYMSG-02677  TO  DP020-MSG-NUMBER              44020040
440300         SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE                  44030040
440400         PERFORM 9900-SOFT-ABORT                                  44040040
440500     END-IF.                                                      44050040
440600     IF CE016-TRANS-NOT-SUCCESSFUL                                44060040
440700         IF CE016-TRANS-SOURCE-DESC = PV-INSUFFIFIENT-QTY         44070040
440800             SET PS-REDUCE-QTY TO TRUE                            44080040
440900         ELSE                                                     44090040
441000             IF CE016-TRANS-SOURCE-DESC = PV-SKU-NOT-FOUND        44100040
441100                 SET PS-SKU-NOT-FOUND TO TRUE                     44110040
441200             ELSE                                                 44120040
441300                 SET PS-SKU-NOT-PROCESSED TO TRUE                 44130040
441400             END-IF                                               44140040
441500         END-IF                                                   44150040
441600     END-IF.                                                      44160040
441700     PERFORM 8050-MQ-GET-CLOSE.                                   44170040
441800                                                                  44180040
441900*----------------------------------------------------------------*44190040
442000*  CLOSE THE QUEUE THAT WAS OPENED TO GET THE RESPONSE MESSAGE   *44200040
442100*----------------------------------------------------------------*44210040
442200                                                                  44220040
442300 8050-MQ-GET-CLOSE.                                               44230040
442400                                                                  44240040
442500     CALL PC-MQCLOSE USING PV-HCONN                               44250040
442600                           PV-GQ-HANDLE                           44260040
442700                           MQCO-NONE                              44270040
442800                           PV-COMPLETION-CODE                     44280040
442900                           PV-REASON.                             44290040
443000                                                                  44300040
443100     IF (PV-COMPLETION-CODE = MQCC-OK)                            44310040
443200         CONTINUE                                                 44320040
443300     ELSE                                                         44330040
443400         CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT       44340040
443500         MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC           44350040
443600         MOVE PV-OBJECTQMGRNAME    TO PE-MQ-QMANAGER              44360040
443700         SET  PE-MQ-CLOSE          TO TRUE                        44370040
443800         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       44380040
443900         MOVE PV-REASON            TO PE-MQ-REASON-CODE           44390040
444000         MOVE PV-REASON            TO  PV-REASON-CODE             44400040
444100         MOVE PV-MQ-REASON-TEXT    TO  PV-MQ-REASON-TXT           44410040
444200         PERFORM 9900-MQ-ERROR                                    44420040
444300         PERFORM 8060-MQ-DISCONNECT                               44430040
444400         SET PS-MQ-ERROR           TO TRUE                        44440040
444500         MOVE '8050-MQ-GET-CLOSE'  TO  PV-MQ-PARAGRAPH            44450040
444600         MOVE PV-MQ-SOFT-ABORT-MSG      TO PV-CICS-MSG-AREA2      44460040
444700         MOVE LENGTH OF PV-CICS-MSG-AREA2                         44470040
444800              TO PV-COMMAREA-LENGTH                               44480040
444900         EXEC CICS                                                44490040
445000              WRITEQ TD                                           44500040
445100               QUEUE  ('CSSL')                                    44510040
445200                FROM  (PV-CICS-MSG-AREA2)                         44520040
445300              LENGTH  (PV-COMMAREA-LENGTH)                        44530040
445400                RESP  (PV-CICS-RESP)                              44540040
445500         END-EXEC                                                 44550040
445600         MOVE  PC-TSYMSG-02677  TO  DP020-MSG-NUMBER              44560040
445700         SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE                  44570040
445800         PERFORM 9900-SOFT-ABORT                                  44580040
445900     END-IF.                                                      44590040
446000                                                                  44600040
446100*----------------------------------------------------------------*44610040
446200*  DISCONNECT FROM THE QUEUE                                      44620040
446300*----------------------------------------------------------------*44630040
446400                                                                  44640040
446500 8060-MQ-DISCONNECT.                                              44650040
446600                                                                  44660040
446700     IF PV-CON-REASON              NOT EQUAL                      44670040
446800                                   MQRC-ALREADY-CONNECTED         44680040
446900         CALL PC-MQDISC USING PV-HCONN                            44690040
447000                              PV-COMPLETION-CODE                  44700040
447100                              PV-REASON                           44710040
447200         IF (PV-COMPLETION-CODE = MQCC-OK)                        44720040
447300             SET PS-MQ-SETUP-NOT-COMPLETE TO TRUE                 44730040
447400         ELSE                                                     44740040
447500             CALL WS-MQCHECK USING PV-REASON  PV-MQ-REASON-TEXT   44750040
447600             MOVE PV-MQ-REASON-TEXT    TO PE-MQ-REASON-DESC       44760040
447700             MOVE PV-OBJECTQMGRNAME TO PE-MQ-QMANAGER             44770040
447800             SET  PE-MQ-DISCONNECT TO TRUE                        44780040
447900             MOVE PV-COMPLETION-CODE                              44790040
448000                                   TO PE-MQ-COMPLETION-CODE       44800040
448100             MOVE PV-REASON        TO PE-MQ-REASON-CODE           44810040
448200             PERFORM 9900-MQ-ERROR                                44820040
448300             MOVE PC-TSYMSG-02677  TO  DP020-MSG-NUMBER           44830040
448400         END-IF                                                   44840040
448500     END-IF.                                                      44850040
448600                                                                  44860040
448700***************************************************************** 44870040
448800 8070-GET-QUEUE-NAME.                                             44880040
448900*     SELECT THE GET QUEUE NAME.                                  44890040
449000***************************************************************** 44900040
449100                                                                  44910040
449200     MOVE SPACES             TO PV-OBJECTNAME.                    44920040
449300     EXEC SQL                                                     44930040
449400         SELECT FUNC_TXT                                          44940040
449500           INTO :KRPRPM-FUNC-TXT                                  44950040
449600           FROM TKRPRPM                                           44960040
449700          WHERE SYS_PRC_FUNC_CDE  = 'RDMGQU'                      44970040
449800            AND LOC_ID            = 090                           44980040
449900            AND INTFC_SYS_CDE     = 'RDM'                         44990040
450000            AND FUNC_PRC_STAT_CDE = 'AC'                          45000040
450100            AND (CURRENT DATE                                     45010040
450200        BETWEEN DATE(FUNC_BEG_TMST) AND                           45020040
450300                DATE(FUNC_END_TMST) )                             45030040
450400     END-EXEC.                                                    45040040
450500                                                                  45050040
450600     EVALUATE SQLCODE                                             45060040
450700         WHEN ZERO                                                45070040
450800             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTNAME            45080040
450900         WHEN OTHER                                               45090040
451000              MOVE '8070-GET-QUEUE-NAME'                          45100040
451100                               TO DP013-PARAGRAPH                 45110040
451200              MOVE 'SELECT QUEUE NAME'                            45120040
451300                               TO DP013-MESSAGE-TEXT (1)          45130040
451400              MOVE SQLCA       TO DP013-SQLCA                     45140040
451500              SET DP013-DB2-ABEND                                 45150040
451600                               TO TRUE                            45160040
451700              PERFORM DP013-0000-PROCESS-ABEND                    45170040
451800     END-EVALUATE.                                                45180040
451900                                                                  45190040
452000***************************************************************** 45200040
452100 8080-GET-QUEUE-NAME.                                             45210040
452200*     SELECT THE PUT QUEUE NAME.                                  45220040
452300***************************************************************** 45230040
452400                                                                  45240040
452500     MOVE SPACES             TO PV-OBJECTNAME.                    45250040
452600     EXEC SQL                                                     45260040
452700         SELECT FUNC_TXT                                          45270040
452800           INTO :KRPRPM-FUNC-TXT                                  45280040
452900           FROM TKRPRPM                                           45290040
453000          WHERE SYS_PRC_FUNC_CDE  = 'RDMPQU'                      45300040
453100            AND LOC_ID            = 090                           45310040
453200            AND INTFC_SYS_CDE     = 'RDM'                         45320040
453300            AND FUNC_PRC_STAT_CDE = 'AC'                          45330040
453400            AND (CURRENT DATE                                     45340040
453500        BETWEEN DATE(FUNC_BEG_TMST) AND                           45350040
453600                DATE(FUNC_END_TMST) )                             45360040
453700     END-EXEC.                                                    45370040
453800                                                                  45380040
453900     EVALUATE SQLCODE                                             45390040
454000         WHEN ZERO                                                45400040
454100             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTNAME            45410040
454200         WHEN OTHER                                               45420040
454300              MOVE '8080-GET-QUEUE-NAME'                          45430040
454400                               TO DP013-PARAGRAPH                 45440040
454500              MOVE 'SELECT QUEUE NAME'                            45450040
454600                               TO DP013-MESSAGE-TEXT (1)          45460040
454700              MOVE SQLCA       TO DP013-SQLCA                     45470040
454800              SET DP013-DB2-ABEND                                 45480040
454900                               TO TRUE                            45490040
455000              PERFORM DP013-0000-PROCESS-ABEND                    45500040
455100     END-EVALUATE.                                                45510040
455200                                                                  45520040
455300***************************************************************** 45530040
455400 8090-GET-QMGR-NAME.                                              45540040
455500*     SELECT QUEUE NAME.                                          45550040
455600***************************************************************** 45560040
455700                                                                  45570040
455800     MOVE SPACES             TO PV-OBJECTQMGRNAME.                45580040
455900     EXEC SQL                                                     45590040
456000         SELECT FUNC_TXT                                          45600040
456100           INTO :KRPRPM-FUNC-TXT                                  45610040
456200           FROM TKRPRPM                                           45620040
456300          WHERE SYS_PRC_FUNC_CDE  = 'RDMQMG'                      45630040
456400            AND LOC_ID            = 090                           45640040
456500            AND INTFC_SYS_CDE     = 'RDM'                         45650040
456600            AND FUNC_PRC_STAT_CDE = 'AC'                          45660040
456700            AND (CURRENT DATE                                     45670040
456800        BETWEEN DATE(FUNC_BEG_TMST) AND                           45680040
456900                DATE(FUNC_END_TMST) )                             45690040
457000     END-EXEC.                                                    45700040
457100                                                                  45710040
457200     EVALUATE SQLCODE                                             45720040
457300         WHEN ZERO                                                45730040
457400             MOVE KRPRPM-FUNC-TXT     TO PV-OBJECTQMGRNAME        45740040
457500         WHEN OTHER                                               45750040
457600              MOVE '8090-GET-QMGR-NAME'                           45760040
457700                               TO DP013-PARAGRAPH                 45770040
457800              MOVE 'SELECT QUEUE MANAGER NAME'                    45780040
457900                               TO DP013-MESSAGE-TEXT (1)          45790040
458000              MOVE SQLCA       TO DP013-SQLCA                     45800040
458100              SET DP013-DB2-ABEND                                 45810040
458200                               TO TRUE                            45820040
458300              PERFORM DP013-0000-PROCESS-ABEND                    45830040
458400     END-EVALUATE.                                                45840040
458500                                                                  45850040
458600                                                                  45860040
458700                                                                  45870040
458800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 45880040
458900* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *45890040
459000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 45900040
459100 9100-READ-SEL-QUEUE.                                             45910040
459200     EXEC CICS                                                    45920040
459300         READQ TS                                                 45930040
459400             QUEUE (ASC-SEL-QUEUE-NAME)                           45940040
459500             INTO  (CE003-SELECT-RECORD)                          45950040
459600             ITEM  (ASC-SEL-ITEM)                                 45960040
459700             RESP  (PV-CICS-RESP)                                 45970040
459800     END-EXEC.                                                    45980040
459900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        45990040
460000         CONTINUE                                                 46000040
460100     ELSE                                                         46010040
460200         SET DP013-LOGIC-ABEND                                    46020040
460300             DP013-NO-ROLLBACK   TO   TRUE                        46030040
460400         MOVE '9100-READ-SEL-QUEUE'                               46040040
460500                                 TO   DP013-PARAGRAPH             46050040
460600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   46060040
460700                                 TO   DP013-MESSAGE-TEXT (1)      46070040
460800         PERFORM DP013-0000-PROCESS-ABEND                         46080040
460900     END-IF.                                                      46090040
461000                                                                  46100040
461100                                                                  46110040
461200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*46120040
461300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *46130040
461400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 46140040
461500 9200-REWRITE-SEL-QUEUE.                                          46150040
461600                                                                  46160040
461700     EXEC CICS                                                    46170040
461800          WRITEQ TS                                               46180040
461900              QUEUE  (ASC-SEL-QUEUE-NAME)                         46190040
462000              FROM   (CE003-SELECT-RECORD)                        46200040
462100              ITEM   (ASC-SEL-ITEM)                               46210040
462200              RESP   (PV-CICS-RESP)                               46220040
462300              REWRITE                                             46230040
462400     END-EXEC.                                                    46240040
462500                                                                  46250040
462600     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   46260040
462700         SET DP013-CICS-ABEND                                     46270040
462800             DP013-NO-ROLLBACK     TO TRUE                        46280040
462900         MOVE '9200-REWRITE-SEL-QUEUE'                            46290040
463000                                   TO DP013-PARAGRAPH             46300040
463100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   46310040
463200                                   TO DP013-MESSAGE-TEXT (1)      46320040
463300         PERFORM DP013-0000-PROCESS-ABEND                         46330040
463400     END-IF.                                                      46340040
463500                                                                  46350040
463600                                                                  46360040
463700*----------------------------------------------------------------*46370040
463800*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *46380040
463900*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *46390040
464000*----------------------------------------------------------------*46400040
464100 9900-SOFT-ABORT.                                                 46410040
464200                                                                  46420040
464300     EXEC CICS SYNCPOINT                                          46430040
464400          ROLLBACK                                                46440040
464500     END-EXEC.                                                    46450040
464600                                                                  46460040
464700     SET  PS-ERROR                                                46470040
464800          PS-SOFT-ABORT-ERROR                                     46480040
464900          DP020-MSG-FATAL       TO  TRUE.                         46490040
465000                                                                  46500040
465100                                                                  46510040
465200*-----------------------------------------------------------------46520040
465300*  MQ ERROR                                                       46530040
465400*-----------------------------------------------------------------46540040
465500 9900-MQ-ERROR.                                                   46550040
465600                                                                  46560040
465700     MOVE PE-MQ-ERROR-NUMBER TO EP000-SL-PI-MESSAGE-NUMBER.       46570040
465800     SET  EP000-SL-ERROR  TO  TRUE.                               46580040
465900     MOVE PC-ONE TO EP000-MESSAGE-LINE-COUNTER.                   46590040
466000     MOVE PE-MQ-ERROR-MESSAGE                                     46600040
466100           TO  EP000-MD-SYSTEM-LOG-MESSAGE                        46610040
466200               (EP000-MESSAGE-LINE-COUNTER).                      46620040
466300     PERFORM EP000-1000-POST-MESSAGE.                             46630040
466400                                                                  46640040
466500*----------------------------------------------------------------*46650040
466600*    ABEND PROCESSOR MODULE                                      *46660040
466700*----------------------------------------------------------------*46670040
466800                                                                  46680040
466900     COPY DPPD013.                                                46690040
467000     COPY EPPD000.                                                46700040
