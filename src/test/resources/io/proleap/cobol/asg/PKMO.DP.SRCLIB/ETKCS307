00001 *-----------------------*                                         08/05/94
00002  IDENTIFICATION DIVISION.                                         ETKCS307
00003 *-----------------------*                                            LV003
00004  PROGRAM-ID.    ETKCS307.                                         ETKCS307
00005  AUTHOR.        JO ANN SCHMIDT.                                   ETKCS307
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                          ETKCS307
00007  DATE-WRITTEN.  03-01-94.                                         ETKCS307
00008  DATE-COMPILED.                                                   ETKCS307
00009                                                                   ETKCS307
00010 *---------------------------------------------------------------* ETKCS307
00011 *    E307 - EDI TRADING PARTNER INQUIRY SCREEN                  * ETKCS307
00012 *                                                               * ETKCS307
00013 *    THIS PROGRAM ALLOWS THE USER TO VIEW THE TRADING           * ETKCS307
00014 *    PARTNERSHIP DETAILS FOR THE VENDOR SPECIFIED ON THE        * ETKCS307
00015 *    PRECEEDING LIST SCREEN (ETKCS301).                         * ETKCS307
00016 *                                                               * ETKCS307
00024 *    CHANGES:                                                   * ETKCS306
00024 *     03/20/97 TOM MEDREK - FIXED APPLICATION SPECIFIC SECTION. * ETKCS306
00024 *       ADDED NRF INDICATOR WHICH WAS ADDED TO ETWS300 &        * ETKCS306
00024 *       ETWS301 EARLIER.                                        * ETKCS306
00017 *---------------------------------------------------------------* ETKCS307
CICS  *  CHANGED 10/25/2022    BY BARB SCHULTZ    WR: CHG0277210        ETKCS306
CICS  *                                                                 ETKCS306
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL     ETKCS306
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      ETKCS306
CICS  *---------------------------------------------------------------* ETKCS307
00018                                                                   ETKCS307
00019                                                                   ETKCS307
00020  ENVIRONMENT DIVISION.                                            ETKCS307
00021                                                                   ETKCS307
00022                                                                   ETKCS307
00023                                                                   ETKCS307
00024  DATA DIVISION.                                                   ETKCS307
00025                                                                   ETKCS307
00026                                                                   ETKCS307
00027  EJECT                                                            ETKCS307
00028  WORKING-STORAGE SECTION.                                         ETKCS307
00029                                                                   ETKCS307
00030  01  DK-DB2-KEYS.                                                 ETKCS307
00031      05  DK-TP-DKEY                   PIC S9(09) VALUE +0         ETKCS307
00032                                                  COMP.            ETKCS307
00033      05  DK-NETWK-ID                  PIC  X(01).                 ETKCS307
00034                                                                   ETKCS307
00035  01  PC-PROGRAM-CONSTANTS.                                        ETKCS307
00036      05  PC-TRANS-ID                  PIC X(04)  VALUE 'E307'.    ETKCS307
00037      05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'ETKCS307'.ETKCS307
00038      05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'ET307A  '.ETKCS307
00039      05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'ETKM307 '.ETKCS307
00040      05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        ETKCS307
00041                                                  COMP.            ETKCS307
00042      05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        ETKCS307
00043                                                  COMP.            ETKCS307
00044      05  PC-1                         PIC S9(04) VALUE  +1        ETKCS307
00045                                                  COMP.            ETKCS307
00046      05  PC-TSYMSG-NUMBERS.                                       ETKCS307
00047          10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       ETKCS307
00048          10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       ETKCS307
00049          10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       ETKCS307
00050          10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       ETKCS307
00051          10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       ETKCS307
00052          10  PC-TSYMSG-00010      PIC  9(05)  VALUE  00010.       ETKCS307
00053          10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       ETKCS307
00054          10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       ETKCS307
00055          10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       ETKCS307
00056          10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       ETKCS307
00057          10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       ETKCS307
00058          10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       ETKCS307
00059          10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       ETKCS307
00060          10  PC-TSYMSG-00118      PIC  9(05)  VALUE  00118.       ETKCS307
00061          10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       ETKCS307
00062 *                                                                 ETKCS307
00063  01  PS-PROGRAM-SWITCHES.                                         ETKCS307
00064      05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         ETKCS307
00065          88  PS-ERROR                         VALUE  'Y'.         ETKCS307
00066          88  PS-NO-ERROR                      VALUE  'N'.         ETKCS307
00067      05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         ETKCS307
00068          88  PS-COMMAREA-VALID                VALUE  'Y'.         ETKCS307
00069          88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         ETKCS307
00070      05  PS-LIST-SW               PIC  X(01)  VALUE  'N'.         ETKCS307
00071          88  PS-LIST-END                      VALUE  'Y'.         ETKCS307
00072          88  PS-LIST-NOT-END                  VALUE  'N'.         ETKCS307
00073 *                                                                 ETKCS307
00074  01  PV-PROGRAM-VARIABLES.                                        ETKCS307
00075      05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            ETKCS307
00076                                               COMP SYNC.          ETKCS307
00077      05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            ETKCS307
00078                                               COMP SYNC.          ETKCS307
00079      05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            ETKCS307
00080                                               COMP SYNC.          ETKCS307
00081      05  PV-SLASH-DATE.                                           ETKCS307
00082          10  PV-SL-DATE.                                          ETKCS307
00083              15  PV-SL-DATE-MM     PIC X(02).                     ETKCS307
00084              15  FILLER            PIC X(01)    VALUE '/'.        ETKCS307
00085              15  PV-SL-DATE-DD     PIC X(02).                     ETKCS307
00086              15  FILLER            PIC X(01)    VALUE '/'.        ETKCS307
00087              15  PV-SL-DATE-YY     PIC X(02).                     ETKCS307
00088          10  PV-SL-DATE-CC         PIC X(02).                     ETKCS307
00089                                                                   ETKCS307
00090      05  PV-WORK-DATE.                                            ETKCS307
00091          10  PV-WORK-DATE-CCYY     PIC X(04).                     ETKCS307
00092          10  FILLER                PIC X(01).                     ETKCS307
00093          10  PV-WORK-DATE-MM       PIC X(02).                     ETKCS307
00094          10  FILLER                PIC X(01).                     ETKCS307
00095          10  PV-WORK-DATE-DD       PIC X(02).                     ETKCS307
00096                                                                   ETKCS307
00097  EJECT                                                            ETKCS307
00098      COPY MPWS023I.                                               ETKCS307
00099  EJECT                                                            ETKCS307
00100 **--------------------------------------------------------------**ETKCS307
00101 ** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **ETKCS307
00102 ** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **ETKCS307
00103 **--------------------------------------------------------------**ETKCS307
00104      COPY ETWS301.                                                ETKCS307
00105                                                                   ETKCS307
00106  EJECT                                                            ETKCS307
00107 *----------------------------------------------------------------*ETKCS307
00108 *    MAP LAYOUT                                                  *ETKCS307
00109 *----------------------------------------------------------------*ETKCS307
00110      COPY ETKM307.                                                ETKCS307
00111                                                                   ETKCS307
00112  EJECT                                                            ETKCS307
00113 *----------------------------------------------------------------*ETKCS307
00114 *    ATTRIBUTE SETTINGS COPYBOOK.                                *ETKCS307
00115 *----------------------------------------------------------------*ETKCS307
00116      COPY DPWS015.                                                ETKCS307
00117                                                                   ETKCS307
00118  EJECT                                                            ETKCS307
00119 *----------------------------------------------------------------*ETKCS307
00120 *    FUNCTION KEYS COPYBOOK                                      *ETKCS307
00121 *----------------------------------------------------------------*ETKCS307
00122      COPY DPWS016.                                                ETKCS307
00123                                                                   ETKCS307
00124  EJECT                                                            ETKCS307
00125 **--------------------------------------------------------------**ETKCS307
CICS  ** PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.            **ETKCS307
00128 **--------------------------------------------------------------**ETKCS307
00129      COPY DPWS030.                                                ETKCS307
CICS       COPY DPWS930.                                                ETKCS307
00130                                                                   ETKCS307
00131  EJECT                                                            ETKCS307
00132 **--------------------------------------------------------------**ETKCS307
00133 *    STANDARD COMMAREA.                                           ETKCS307
00134 **--------------------------------------------------------------**ETKCS307
00135                                                                   ETKCS307
00136      COPY DPWS020.                                                ETKCS307
00137      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                ETKCS307
00138                                                                   ETKCS307
00139  EJECT                                                            ETKCS307
00140 ***************************************************************** ETKCS307
00141 *    INTER-APPLICATION COMMAREA.                                  ETKCS307
00142 ***************************************************************** ETKCS307
00143                                                                   ETKCS307
00144          10  INTER-APPL-COMM-AREA PIC X(200).                     ETKCS307
00145      COPY ETWS300.                                                ETKCS307
00146                                                                   ETKCS307
00147 ******************************************************************ETKCS307
00148 * INTER-APPLICATION COMMAREA FOR VENDOR BUSINESS FUNCTION LIST    ETKCS307
00149 ******************************************************************ETKCS307
00150                                                                   ETKCS307
00151      COPY VNWS001.                                                   CL**3
00152                                                                   ETKCS307
00153  EJECT                                                            ETKCS307
00154 ***************************************************************** ETKCS307
00155 *    APPLICATION SPECIFIC COMMMAREA.                              ETKCS307
00156 ***************************************************************** ETKCS307
00157                                                                   ETKCS307
00158          10  ASC-SPECIFIC-COMMAREA.                               ETKCS307
00159                                                                   ETKCS307
00160              15  ASC-INT-APPL-FORMAT-IND    PIC X(01).            ETKCS307
00161                  88  ASC-INT-APPL-CRIT-SPEC       VALUE ' '.      ETKCS307
00162                  88  ASC-INT-APPL-LIST            VALUE '2'.      ETKCS307
00163                                                                   ETKCS307
00164              15  ASC-TP-INFO-FOUND-SW   PIC X(01).                ETKCS307
00165                  88  ASC-TP-INFO-FOUND      VALUE 'Y'.            ETKCS307
00166                  88  ASC-TP-INFO-NOT-FOUND                        ETKCS307
00167                                             VALUE 'N'.            ETKCS307
00168              15  ASC-NETWK-INFO-FOUND-SW PIC X(01).               ETKCS307
00169                  88  ASC-NETWK-INFO-FOUND   VALUE 'Y'.            ETKCS307
00170                  88  ASC-NETWK-INFO-NOT-FOUND                     ETKCS307
00171                                             VALUE 'N'.            ETKCS307
00172                                                                   ETKCS307
00173              15  ASC-KEY-FIELDS.                                  ETKCS307
00174                  20  ASC-KEY-TP-DKEY               PIC S9(9) COMP.ETKCS307
00175                  20  ASC-KEY-INTRCONN-NETWK-ID     PIC X(01).     ETKCS307
00176                                                                   ETKCS307
00177              15  ASC-HOLD-FIELDS.                                 ETKCS307
00178                  20  ASC-HLD-ENT-ID                PIC S9(9) COMP.ETKCS307
00179                  20  ASC-HLD-VENDOR-NAME           PIC X(30).     ETKCS307
00180                  20  ASC-HLD-NETWK-ID              PIC X(01).     ETKCS307
TM0320                 20  ASC-NRFC-ID                   PIC  X(01).       CL**3
00181                  20  ASC-HLD-NETWK-NAME            PIC X(15).     ETKCS307
00182                                                                   ETKCS307
00183              15  ASC-SCREEN-FIELDS.                               ETKCS307
00184                                                                   ETKCS307
00185                  20  ASC-VENDOR-NAME               PIC  X(30).    ETKCS307
00186                  20  ASC-SER-LVL-CDE               PIC  X(03).    ETKCS307
00187                                                                   ETKCS307
00188                  20  ASC-VEND-INCHG-QUAL           PIC  X(02).    ETKCS307
00189                  20  ASC-VEND-INCHG-ID             PIC  X(15).    ETKCS307
00190                  20  ASC-NETWK-ID                  PIC  X(01).    ETKCS307
TM0320                 20  ASC-NRFC-ID                   PIC  X(01).       CL**3
00191                  20  ASC-NETWORK-NAME              PIC  X(15).    ETKCS307
00192                                                                   ETKCS307
00193                  20  ASC-KOHL-INCHG-QUAL           PIC  X(02).    ETKCS307
00194                  20  ASC-KOHL-INCHG-ID             PIC  X(15).    ETKCS307
00195                  20  ASC-INTRCONN-NETWK-IND        PIC  X(01).    ETKCS307
00196                  20  ASC-INTRCONN-NETWK-NME        PIC  X(15).    ETKCS307
00195                  20  ASC-FA-COMM-MTHD              PIC  X(01).    ETKCS307
00196                  20  ASC-FA-COMM-MTHD-NME          PIC  X(05).    ETKCS307
00197                                                                   ETKCS307
00198                  20  ASC-LAST-SEND-CNTL-NBRX.                     ETKCS307
00199                      25  ASC-LAST-SEND-CNTL-NBR    PIC  9(09).    ETKCS307
00200                  20  ASC-SEND-CNTL-NBR-CDE         PIC  X(01).    ETKCS307
00201 *                        ( 0 = NOTRK ; 1 = TRACK )                ETKCS307
00202                  20  ASC-SEND-FMT-NME              PIC  X(01).    ETKCS307
00203                  20  ASC-SEND-FMT-VER-CDE          PIC  X(05).    ETKCS307
00204                                                                   ETKCS307
00205                  20  ASC-OVRRD-SND-CNTL-NBRX.                     ETKCS307
00206                      25  ASC-OVRRD-SND-CNTL-NBR    PIC  9(09).    ETKCS307
00207                  20  ASC-OVRRD-SND-CNTL-ID         PIC  X(01).    ETKCS307
00208                                                                   ETKCS307
00209                  20  ASC-LAST-RECV-CNTL-NBRX.                     ETKCS307
00210                      25  ASC-LAST-RECV-CNTL-NBR    PIC  9(09).    ETKCS307
00211                  20  ASC-RECV-CNTL-NBR-CDE         PIC  X(01).    ETKCS307
00212 *                    ( 0 = NOTRK ; 1 = TRACK )                    ETKCS307
00213 *                    ( 3 = RETAIL; REMOVED FROM APPLICATION )     ETKCS307
00214                  20  ASC-RECV-FMT-NME              PIC  X(01).    ETKCS307
00215                  20  ASC-RECV-FMT-VER-CDE          PIC  X(05).    ETKCS307
00216                                                                   ETKCS307
00217                  20  ASC-OVRRD-RCV-CNTL-NBRX.                     ETKCS307
00218                      25  ASC-OVRRD-RCV-CNTL-NBR    PIC  9(09).    ETKCS307
00219                  20  ASC-OVRRD-RCV-CNTL-ID         PIC  X(01).    ETKCS307
00220                                                                   ETKCS307
00221                  20  ASC-SETUP-DTE                 PIC  X(10).    ETKCS307
00222                  20  ASC-SETUP-DTE-RDF     REDEFINES              ETKCS307
00223                      ASC-SETUP-DTE.                               ETKCS307
00224                      25  ASC-SETUP-DTE-MM          PIC  X(02).    ETKCS307
00225                      25  ASC-SETUP-DTE-S1          PIC  X(01).    ETKCS307
00226                      25  ASC-SETUP-DTE-DD          PIC  X(02).    ETKCS307
00227                      25  ASC-SETUP-DTE-S2          PIC  X(01).    ETKCS307
00228                      25  ASC-SETUP-DTE-CCYY        PIC  X(04).    ETKCS307
00229                  20  ASC-LAST-CHG-DTE              PIC  X(10).    ETKCS307
00230                  20  ASC-LAST-CHG-DTE-RDF  REDEFINES              ETKCS307
00231                      ASC-LAST-CHG-DTE.                            ETKCS307
00232                      25  ASC-LAST-CHG-DTE-MM       PIC  X(02).    ETKCS307
00233                      25  ASC-LAST-CHG-DTE-S1       PIC  X(01).    ETKCS307
00234                      25  ASC-LAST-CHG-DTE-DD       PIC  X(02).    ETKCS307
00235                      25  ASC-LAST-CHG-DTE-S2       PIC  X(01).    ETKCS307
00236                      25  ASC-LAST-CHG-DTE-CCYY     PIC  X(04).    ETKCS307
00237                  20  ASC-LAST-CHG-UID              PIC  X(08).    ETKCS307
00238                                                                   ETKCS307
00239                  20  ASC-ACTV-DTE                 PIC X(10).      ETKCS307
00240                  20  ASC-ACTV-DTE-RDF             REDEFINES       ETKCS307
00241                      ASC-ACTV-DTE.                                ETKCS307
00242                      25  ASC-ACTV-DTE-MM          PIC X(02).      ETKCS307
00243                      25  ASC-ACTV-DTE-S1          PIC X(01).      ETKCS307
00244                      25  ASC-ACTV-DTE-DD          PIC X(02).      ETKCS307
00245                      25  ASC-ACTV-DTE-S2          PIC X(01).      ETKCS307
00246                      25  ASC-ACTV-DTE-CCYY        PIC X(04).      ETKCS307
00247                  20  ASC-INACTV-DTE               PIC X(10).      ETKCS307
00248                  20  ASC-INACTV-DTE-RDF           REDEFINES       ETKCS307
00249                      ASC-INACTV-DTE.                              ETKCS307
00250                      25  ASC-INACTV-DTE-MM        PIC X(02).      ETKCS307
00251                      25  ASC-INACTV-DTE-S1        PIC X(01).      ETKCS307
00252                      25  ASC-INACTV-DTE-DD        PIC X(02).      ETKCS307
00253                      25  ASC-INACTV-DTE-S2        PIC X(01).      ETKCS307
00254                      25  ASC-INACTV-DTE-CCYY      PIC X(04).      ETKCS307
00255                                                                   ETKCS307
00256                  20  ASC-LAST-CALL-DTE            PIC X(10).      ETKCS307
00257                  20  ASC-LAST-CALL-DTE-RDF        REDEFINES       ETKCS307
00258                      ASC-LAST-CALL-DTE.                           ETKCS307
00259                      25  ASC-LAST-CALL-DTE-MM     PIC X(02).      ETKCS307
00260                      25  ASC-LAST-CALL-DTE-S1     PIC X(01).      ETKCS307
00261                      25  ASC-LAST-CALL-DTE-DD     PIC X(02).      ETKCS307
00262                      25  ASC-LAST-CALL-DTE-S2     PIC X(01).      ETKCS307
00263                      25  ASC-LAST-CALL-DTE-CCYY   PIC X(04).      ETKCS307
00264                  20  ASC-NEXT-CALL-DTE            PIC X(10).      ETKCS307
00265                  20  ASC-NEXT-CALL-DTE-RDF        REDEFINES       ETKCS307
00266                      ASC-NEXT-CALL-DTE.                           ETKCS307
00267                      25  ASC-NEXT-CALL-DTE-MM     PIC X(02).      ETKCS307
00268                      25  ASC-NEXT-CALL-DTE-S1     PIC X(01).      ETKCS307
00269                      25  ASC-NEXT-CALL-DTE-DD     PIC X(02).      ETKCS307
00270                      25  ASC-NEXT-CALL-DTE-S2     PIC X(01).      ETKCS307
00271                      25  ASC-NEXT-CALL-DTE-CCYY   PIC X(04).      ETKCS307
00272                                                                   ETKCS307
00273                  20  ASC-SEND-DATA-ELEM-IND       PIC X(02).      ETKCS307
00274                  20  ASC-SEND-DATA-ELEM-PRT       PIC X(01).      ETKCS307
00275                                                                   ETKCS307
00276                  20  ASC-SEND-SEG-TERM-IND        PIC X(02).      ETKCS307
00277                  20  ASC-SEND-SEG-TERM-PRT        PIC X(01).      ETKCS307
00278                                                                   ETKCS307
00279                  20  ASC-SEND-SUB-ELEM-IND        PIC X(02).      ETKCS307
00280                  20  ASC-SEND-SUB-ELEM-PRT        PIC X(01).      ETKCS307
00281                                                                   ETKCS307
00282                  20  ASC-NOTES-TXT                PIC X(80).      ETKCS307
00283                  20  ASC-NOTES-TXT-RDF        REDEFINES           ETKCS307
00284                      ASC-NOTES-TXT.                               ETKCS307
00285                      25  ASC-SEND-NOTE1           PIC X(40).      ETKCS307
00286                      25  ASC-SEND-NOTE2           PIC X(40).      ETKCS307
00287                                                                   ETKCS307
00288              15  ASC-OTHER-FIELDS.                                ETKCS307
00289                  20  ASC-TP-DKEY                   PIC S9(9) COMP.ETKCS307
00290                  20  ASC-ENT-ID                    PIC S9(9) COMP.ETKCS307
00291                                                                   ETKCS307
00292                  20  ASC-CURRENT-TIMESTAMP    PIC X(26).          ETKCS307
00293                  20  ASC-CURRENT-TS-RDF       REDEFINES           ETKCS307
00294                      ASC-CURRENT-TIMESTAMP.                       ETKCS307
00295                      25  ASC-CURRENT-DATE     PIC X(10).          ETKCS307
00296                      25  FILLER               PIC X(01).          ETKCS307
00297                      25  ASC-CURRENT-TIME.                        ETKCS307
00298                          30  ASC-HH           PIC 9(02).          ETKCS307
00299                          30  FILLER           PIC X(01).          ETKCS307
00300                          30  ASC-MIN          PIC 9(02).          ETKCS307
00301                          30  FILLER           PIC X(01).          ETKCS307
00302                          30  ASC-SEC          PIC 9(02).          ETKCS307
00303                          30  FILLER           PIC X(01).          ETKCS307
00304                          30  ASC-MILLI-SEC    PIC 9(06).          ETKCS307
00305                                                                   ETKCS307
00306              15  ASC-USE-SELECTION-QUEUE-IND                      ETKCS307
00307                                         PIC  X(01).               ETKCS307
00308                  88  ASC-USE-SELECTION-QUEUE        VALUE 'Y'.    ETKCS307
00309              15  ASC-SEL-QUEUE-NAME     PIC  X(08).               ETKCS307
00310                                                                   ETKCS307
00311              15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05)  COMP-3.       ETKCS307
00312              15  ASC-NUMBER-OF-SELECTED-ITEMS                     ETKCS307
00313                                         PIC S9(09)  COMP-3.       ETKCS307
00314              15  ASC-SEL-SUB            PIC S9(04)  COMP.         ETKCS307
00315              15  ASC-SEL-ITEM           PIC S9(04)  COMP.         ETKCS307
00316                                                                   ETKCS307
00317 /                                                                 ETKCS307
00318  EJECT                                                            ETKCS307
00319 *----------------------------------------------------------------*ETKCS307
00320 *    ABEND PROCESSING COPYBOOK.                                  *ETKCS307
00321 *----------------------------------------------------------------*ETKCS307
00322      COPY DPWS013.                                                ETKCS307
00323                                                                   ETKCS307
00324  EJECT                                                            ETKCS307
00325 *---------------------------------------------------------------* ETKCS307
00326 *    DB2 AREA FOR COMMUNICATIONS                                * ETKCS307
00327 *---------------------------------------------------------------* ETKCS307
00328      EXEC SQL                                                     ETKCS307
00329           INCLUDE SQLCA                                           ETKCS307
00330      END-EXEC.                                                    ETKCS307
00331                                                                   ETKCS307
00332  EJECT                                                            ETKCS307
00333 *---------------------------------------------------------------* ETKCS307
00334 *    DB2 AREA FOR THE TRADING PARTNERSHIP DB                    * ETKCS307
00335 *---------------------------------------------------------------* ETKCS307
00336      EXEC SQL                                                     ETKCS307
00337           INCLUDE TTRDPRT                                         ETKCS307
00338      END-EXEC.                                                    ETKCS307
00339                                                                   ETKCS307
00340  EJECT                                                            ETKCS307
00341 *---------------------------------------------------------------* ETKCS307
00342 *    DB2 AREA FOR THE TRADING PARTNERSHIP TRANSACTION SETS      * ETKCS307
00343 *---------------------------------------------------------------* ETKCS307
00344      EXEC SQL                                                     ETKCS307
00345           INCLUDE TTRDTRN                                         ETKCS307
00346      END-EXEC.                                                    ETKCS307
00347                                                                   ETKCS307
00348  EJECT                                                            ETKCS307
00349 *---------------------------------------------------------------* ETKCS307
00350 *    DB2 AREA FOR THE TRADING PARTNER FUNCTIONAL GROUPS         * ETKCS307
00351 *---------------------------------------------------------------* ETKCS307
00352      EXEC SQL                                                     ETKCS307
00353           INCLUDE TTRDFNC                                         ETKCS307
00354      END-EXEC.                                                    ETKCS307
00355                                                                   ETKCS307
00356  EJECT                                                            ETKCS307
00357 *---------------------------------------------------------------* ETKCS307
00358 *    DB2 AREA FOR THE NETWORK DB                                * ETKCS307
00359 *---------------------------------------------------------------* ETKCS307
00360      EXEC SQL                                                     ETKCS307
00361           INCLUDE TNETWRK                                         ETKCS307
00362      END-EXEC.                                                    ETKCS307
00363                                                                   ETKCS307
00364  EJECT                                                            ETKCS307
00371                                                                   ETKCS307
00373                                                                   ETKCS307
00374  LINKAGE SECTION.                                                 ETKCS307
00375                                                                   ETKCS307
00376  01  DFHCOMMAREA.                                                 ETKCS307
00377      05  FILLER                         OCCURS  1 TO 4072 TIMES   ETKCS307
00378                                         DEPENDING ON EIBCALEN.    ETKCS307
00379          10  FILLER                     PIC X.                    ETKCS307
00380                                                                   ETKCS307
00381  EJECT                                                            ETKCS307
00382                                                                   ETKCS307
00383  PROCEDURE DIVISION.                                              ETKCS307
00384                                                                   ETKCS307
00385 ***************************************************************** ETKCS307
00386 ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** ETKCS307
00387 ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** ETKCS307
00388 ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** ETKCS307
00389 **                                                             ** ETKCS307
00390 ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** ETKCS307
00391 ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** ETKCS307
00392 ***************************************************************** ETKCS307
00393                                                                   ETKCS307
00394  0000-MAIN-MODULE.                                                ETKCS307
00395                                                                   ETKCS307
00396      INITIALIZE DP030-CICS-API-FIELDS.                            ETKCS307
00397                                                                   ETKCS307
00398      MOVE +1                       TO DP030-NUMBER-OF-MAPS.       ETKCS307
00399      MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          ETKCS307
00400      MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         ETKCS307
00401                                                                   ETKCS307
00402      SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       ETKCS307
00403                                                                   ETKCS307
00404      MOVE LENGTH OF ET307AI        TO DP030-MAP-LENGTH (1).       ETKCS307
00405      MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     ETKCS307
00406                                                                   ETKCS307
00407      PERFORM 0001-CALL-CICS-ARCH-API.                             ETKCS307
00408                                                                   ETKCS307
00409      PERFORM 1000-CONTROL-PROCESSING.                             ETKCS307
00410                                                                   ETKCS307
00411      MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     ETKCS307
00412      PERFORM 0001-CALL-CICS-ARCH-API.                             ETKCS307
00413                                                                   ETKCS307
00414  EJECT                                                            ETKCS307
00415 *---------------------------------------------------------------* ETKCS307
00416 *   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * ETKCS307
00417 *   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * ETKCS307
00418 *---------------------------------------------------------------* ETKCS307
00419  0001-CALL-CICS-ARCH-API.                                         ETKCS307
00420                                                                   ETKCS307
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      ETKCS307
00422                                     DFHCOMMAREA                   ETKCS307
00423                                     DP030-CICS-API-FIELDS         ETKCS307
00424                                     DP020-STANDARD-COMMAREA       ETKCS307
00425                                     ET307AI.                      ETKCS307
00426 *                                                                 ETKCS307
00427      IF  DP030-RC-CALL-SUCCESSFUL                                 ETKCS307
00428          CONTINUE                                                 ETKCS307
00429      ELSE                                                         ETKCS307
00430          SET DP013-NO-ROLLBACK                                    ETKCS307
00431              DP013-XCTL-DISPLAY-RESTART                           ETKCS307
00432              DP013-CICS-ABEND      TO TRUE                        ETKCS307
00433          MOVE 'BEFORE 0000-MAIN-MODULE'                           ETKCS307
00434                                    TO DP013-PARAGRAPH             ETKCS307
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE OETKCS307
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      ETKCS307
00437          MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      ETKCS307
00438          PERFORM DP013-0000-PROCESS-ABEND                         ETKCS307
00439      END-IF.                                                      ETKCS307
00440                                                                   ETKCS307
00441  EJECT                                                            ETKCS307
00442 *----------------------------------------------------------------*ETKCS307
00443 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *ETKCS307
00444 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *ETKCS307
00445 *----------------------------------------------------------------*ETKCS307
00446                                                                   ETKCS307
00447  1000-CONTROL-PROCESSING.                                         ETKCS307
00448                                                                   ETKCS307
00449      EVALUATE TRUE                                                ETKCS307
00450                                                                   ETKCS307
00451          WHEN DP020-NEXT-ACT-INITIAL                              ETKCS307
00452                                                                   ETKCS307
00453               PERFORM 1100-PROCESS-INTER-APPL-COMM                ETKCS307
00454               IF  PS-COMMAREA-NOT-VALID                           ETKCS307
00455                   CONTINUE                                        ETKCS307
00456               ELSE                                                ETKCS307
00457                   PERFORM 4000-BUILD-INITIAL-PANEL                ETKCS307
00458               END-IF                                              ETKCS307
00459                                                                   ETKCS307
00460          WHEN DP020-NEXT-ACT-READ-MAP                             ETKCS307
00461              PERFORM 2000-PROCESS-PANEL                           ETKCS307
00462                                                                   ETKCS307
00463          WHEN DP020-NEXT-ACT-RETURN                               ETKCS307
00464              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 ETKCS307
00465                                                                   ETKCS307
00466          WHEN OTHER                                               ETKCS307
00467              SET DP013-LOGIC-ABEND                                ETKCS307
00468                  DP013-NO-ROLLBACK TO TRUE                        ETKCS307
00469              MOVE '1000-CONTROL-PROCESSING'                       ETKCS307
00470                                    TO DP013-PARAGRAPH             ETKCS307
00471              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   ETKCS307
00472                                    TO DP013-MESSAGE-TEXT(1)       ETKCS307
00473              MOVE DP020-NEXT-APPL-ACTIVITY                        ETKCS307
00474                                    TO DP013-MESSAGE-TEXT(2)       ETKCS307
00475              PERFORM DP013-0000-PROCESS-ABEND                     ETKCS307
00476      END-EVALUATE.                                                ETKCS307
00477                                                                   ETKCS307
00478  EJECT                                                            ETKCS307
00479 *----------------------------------------------------------------*ETKCS307
00480 *    DETERMINE THE KEY OF THE OBJECT TO BE INQUIRED ON, FROM THE *ETKCS307
00481 *    INTER-APPLICATION FORMAT CODE.                              *ETKCS307
00482 *----------------------------------------------------------------*ETKCS307
00483  1100-PROCESS-INTER-APPL-COMM.                                    ETKCS307
00484                                                                   ETKCS307
00485      SET PS-COMMAREA-VALID            TO TRUE.                    ETKCS307
00486                                                                   ETKCS307
00487      INITIALIZE ASC-SPECIFIC-COMMAREA.                            ETKCS307
00488                                                                   ETKCS307
00489      MOVE DP020-INT-APPL-FORMAT-IND                               ETKCS307
00490        TO ASC-INT-APPL-FORMAT-IND.                                ETKCS307
00491                                                                   ETKCS307
00492      SET ASC-USE-SELECTION-QUEUE TO TRUE.                         ETKCS307
00493                                                                   ETKCS307
00494      MOVE ET300-NBR-SELECTED-ITEMS                                ETKCS307
00495        TO ASC-NUMBER-OF-SELECTED-ITEMS.                           ETKCS307
00496      MOVE ET300-NUMBER-OF-TS-ITEMS                                ETKCS307
00497        TO ASC-NUMBER-OF-TS-ITEMS.                                 ETKCS307
00498      MOVE ET300-SEL-QUEUE-NAME                                    ETKCS307
00499        TO ASC-SEL-QUEUE-NAME.                                     ETKCS307
00500                                                                   ETKCS307
00501      PERFORM 1120-PREPARE-LIST-ENTRY.                             ETKCS307
00502                                                                   ETKCS307
00503 *    ** FOLLOWING N/A, ACCESSABLE ONLY FROM THE LIST SCREEN **    ETKCS307
00504 *    EVALUATE TRUE                                                ETKCS307
00505 *        WHEN ASC-INT-APPL-CRIT-SPEC                              ETKCS307
00506 *        WHEN ASC-INT-APPL-LIST                                   ETKCS307
00507 *        WHEN OTHER                                               ETKCS307
00508 *            MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             ETKCS307
00509 *            SET PS-ERROR                                         ETKCS307
00510 *                PS-COMMAREA-NOT-VALID                            ETKCS307
00511 *                DP020-MSG-FATAL                                  ETKCS307
00512 *                DP020-NEXT-ACT-APPL-ERROR                        ETKCS307
00513 *                                TO TRUE                          ETKCS307
00514 *    END-EVALUATE.                                                ETKCS307
00515                                                                   ETKCS307
00516  EJECT                                                            ETKCS307
00517 *----------------------------------------------------------------*ETKCS307
00518 * ENTRY TO THIS MODULE CAAME FROM A LIST PROGRAM.                *ETKCS307
00519 * RETRIEVE THE TRADING PARTNER INFO FROM THE TEMP                *ETKCS307
00520 *    STORAGE QUEUE PASSED BY THE LIST.                           *ETKCS307
00521 *----------------------------------------------------------------*ETKCS307
00522  1120-PREPARE-LIST-ENTRY.                                         ETKCS307
00523                                                                   ETKCS307
00524      MOVE ET301-MAX-ITEMS        TO ASC-SEL-SUB.                  ETKCS307
00525      MOVE ZERO                   TO ASC-SEL-ITEM.                 ETKCS307
00526                                                                   ETKCS307
00527      PERFORM 2110-GET-NEXT-REC.                                   ETKCS307
00528                                                                   ETKCS307
00529  EJECT                                                            ETKCS307
00530 *----------------------------------------------------------------*ETKCS307
00531 * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *ETKCS307
00532 * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *ETKCS307
00533 * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *ETKCS307
00534 * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *ETKCS307
00535 * FUNCTION KEYS CAN GET THIS FAR.                                *ETKCS307
00536 *----------------------------------------------------------------*ETKCS307
00537                                                                   ETKCS307
00538  2000-PROCESS-PANEL.                                              ETKCS307
00539                                                                   ETKCS307
00540      EVALUATE TRUE                                                ETKCS307
00541                                                                   ETKCS307
00542          WHEN DP020-SRC-AID = DP016-CLEAR                         ETKCS307
00543              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 ETKCS307
00544                                                                   ETKCS307
00545          WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     ETKCS307
00546              SET DP030-DONT-ERASE                                 ETKCS307
00547                  DP030-SEND-DATAONLY (PC-APPL-MAP)                ETKCS307
00548                                    TO TRUE                        ETKCS307
00549              PERFORM 4000-BUILD-INITIAL-PANEL                     ETKCS307
00550                                                                   ETKCS307
00551          WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             ETKCS307
00552              IF  ASC-USE-SELECTION-QUEUE                          ETKCS307
00553                  PERFORM 2110-GET-NEXT-REC                        ETKCS307
00554                  IF PS-LIST-END                                   ETKCS307
00555                     SET PS-LIST-NOT-END TO TRUE                   ETKCS307
00556                  ELSE                                             ETKCS307
00557                     PERFORM 4000-BUILD-INITIAL-PANEL              ETKCS307
00558                  END-IF                                           ETKCS307
00559              ELSE                                                 ETKCS307
00560 *                --- BOTTOM OF LIST ---                           ETKCS307
00561                  MOVE PC-TSYMSG-00070                             ETKCS307
00562                                    TO DP020-MSG-NUMBER            ETKCS307
00563                  SET DP020-MSG-INFORMATIONAL                      ETKCS307
00564                      PS-LIST-END   TO TRUE                        ETKCS307
00565              END-IF                                               ETKCS307
00566                                                                   ETKCS307
00567          WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             ETKCS307
00568              IF  ASC-USE-SELECTION-QUEUE                          ETKCS307
00569                  PERFORM 2120-GET-PREV-REC                        ETKCS307
00570                  IF PS-LIST-END                                   ETKCS307
00571                     SET PS-LIST-NOT-END TO TRUE                   ETKCS307
00572                  ELSE                                             ETKCS307
00573                     PERFORM 4000-BUILD-INITIAL-PANEL              ETKCS307
00574                END-IF                                             ETKCS307
00575              ELSE                                                 ETKCS307
00576 *                --- TOP OF LIST ---                              ETKCS307
00577                  MOVE PC-TSYMSG-00069                             ETKCS307
00578                                    TO DP020-MSG-NUMBER            ETKCS307
00579                  SET DP020-MSG-INFORMATIONAL                      ETKCS307
00580                      PS-LIST-END   TO TRUE                        ETKCS307
00581              END-IF                                               ETKCS307
00582                                                                   ETKCS307
00583          WHEN OTHER                                               ETKCS307
00584              PERFORM 2100-CHECK-FUNCTION-KEY                      ETKCS307
00585                                                                   ETKCS307
00586      END-EVALUATE.                                                ETKCS307
00587                                                                   ETKCS307
00588  EJECT                                                            ETKCS307
00589 *----------------------------------------------------------------*ETKCS307
00590 * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *ETKCS307
00591 * FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *ETKCS307
00592 * FROM THE CICS ARCHITECTURE API.                                *ETKCS307
00593 *----------------------------------------------------------------*ETKCS307
00594                                                                   ETKCS307
00595  2100-CHECK-FUNCTION-KEY.                                         ETKCS307
00596                                                                   ETKCS307
00597      EVALUATE TRUE                                                ETKCS307
00598          WHEN DP020-SRC-AID = DP016-ENTER                         ETKCS307
00599              CONTINUE                                             ETKCS307
00600                                                                   ETKCS307
00601          WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  ETKCS307
00602              IF DP020-SRC-AID = DP016-PF21                        ETKCS307
00603                  INITIALIZE VN001-INTER-APPL-COMMAREA             ETKCS307
00604                  MOVE ASC-VENDOR-NAME    TO VN001-VENDOR-NAME        CL**2
00605              ELSE                                                 ETKCS307
00606                  INITIALIZE ET300-INTER-APPL-COMMAREA             ETKCS307
00607                  MOVE ASC-KEY-TP-DKEY    TO ET300-TP-DKEY            CL**2
00608                  MOVE ASC-ENT-ID         TO ET300-ENT-ID             CL**2
00609                  MOVE ASC-VENDOR-NAME    TO ET300-VENDOR-NAME        CL**2
00610                  MOVE ASC-VEND-INCHG-ID  TO ET300-VEND-INCHG-ID      CL**2
00611                  MOVE ASC-VEND-INCHG-QUAL                            CL**2
00612                                          TO ET300-VEND-INCHG-QUAL    CL**2
00613                  MOVE ASC-NETWK-ID       TO ET300-NETWK-ID           CL**2
00614                  MOVE ASC-NETWORK-NAME   TO ET300-NETWORK-NAME       CL**2
00615              END-IF                                               ETKCS307
00616                                                                   ETKCS307
00617          WHEN OTHER                                               ETKCS307
00618              SET DP013-NO-ROLLBACK                                ETKCS307
00619                  DP013-XCTL-DISPLAY-RESTART                       ETKCS307
00620                  DP013-CICS-ABEND  TO TRUE                        ETKCS307
00621              MOVE '2000-PROCESS-PANEL'                            ETKCS307
00622                                    TO DP013-PARAGRAPH             ETKCS307
00623              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      ETKCS307
00624                                    TO DP013-MESSAGE-TEXT (1)      ETKCS307
00625              PERFORM DP013-0000-PROCESS-ABEND                     ETKCS307
00626                                                                   ETKCS307
00627      END-EVALUATE.                                                ETKCS307
00628                                                                   ETKCS307
00629  EJECT                                                            ETKCS307
00630 *----------------------------------------------------------------*ETKCS307
00631 * RETRIEVE THE FIRST OR NEXT TEMP STORAGE QUEUE RECORD           *ETKCS307
00632 *----------------------------------------------------------------*ETKCS307
00633  2110-GET-NEXT-REC.                                               ETKCS307
00634                                                                   ETKCS307
00635      ADD +1                        TO ASC-SEL-SUB.                ETKCS307
00636                                                                   ETKCS307
00637      IF  ASC-SEL-SUB > ET301-MAX-ITEMS                            ETKCS307
00638          ADD +1                    TO ASC-SEL-ITEM                ETKCS307
00639          MOVE +1                   TO ASC-SEL-SUB                 ETKCS307
00640      END-IF.                                                      ETKCS307
00641                                                                   ETKCS307
00642      IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                ETKCS307
00643                                                                   ETKCS307
00644          PERFORM 9100-READ-SEL-QUEUE                              ETKCS307
00645                                                                   ETKCS307
00646          IF  ET301-ITEM (ASC-SEL-SUB) > ZERO                      ETKCS307
00647                                                                   ETKCS307
00648              INITIALIZE ASC-KEY-FIELDS                            ETKCS307
00649                                                                   ETKCS307
00650              MOVE ET301-TP-DKEY         (ASC-SEL-SUB)             ETKCS307
00651                TO ASC-KEY-TP-DKEY                                 ETKCS307
00652                                                                   ETKCS307
00653              MOVE ET301-ENT-ID          (ASC-SEL-SUB)             ETKCS307
00654                TO ASC-HLD-ENT-ID                                  ETKCS307
00655              MOVE ET301-VENDOR-NAME     (ASC-SEL-SUB)             ETKCS307
00656                TO ASC-HLD-VENDOR-NAME                             ETKCS307
00657              MOVE ET301-NETWK-ID        (ASC-SEL-SUB)             ETKCS307
00658                TO ASC-HLD-NETWK-ID                                ETKCS307
00659              MOVE ET301-NETWK-NAME      (ASC-SEL-SUB)             ETKCS307
00660                TO ASC-HLD-NETWK-NAME                              ETKCS307
00661                                                                   ETKCS307
00662              INITIALIZE ASC-SCREEN-FIELDS                         ETKCS307
00663                                                                   ETKCS307
00664              SET ET301-INQ (ASC-SEL-SUB)                          ETKCS307
00665                                    TO TRUE                        ETKCS307
00666                                                                   ETKCS307
00667              PERFORM 9200-REWRITE-LIST-QUEUE                      ETKCS307
00668                                                                   ETKCS307
00669          ELSE                                                     ETKCS307
00670                                                                   ETKCS307
00671              SUBTRACT +1 FROM ASC-SEL-SUB                         ETKCS307
00672 *            --- BOTTOM OF LIST ---                               ETKCS307
00673              MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            ETKCS307
00674              SET DP020-MSG-INFORMATIONAL                          ETKCS307
00675                  PS-LIST-END       TO TRUE                        ETKCS307
00676          END-IF                                                   ETKCS307
00677                                                                   ETKCS307
00678      ELSE                                                         ETKCS307
00679                                                                   ETKCS307
00680          SUBTRACT +1 FROM ASC-SEL-ITEM                            ETKCS307
00681          MOVE ET301-MAX-ITEMS      TO ASC-SEL-SUB                 ETKCS307
00682          MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            ETKCS307
00683          SET DP020-MSG-INFORMATIONAL                              ETKCS307
00684              PS-LIST-END           TO TRUE                        ETKCS307
00685                                                                   ETKCS307
00686      END-IF.                                                      ETKCS307
00687                                                                   ETKCS307
00688  EJECT                                                            ETKCS307
00689 *----------------------------------------------------------------*ETKCS307
00690 * RETRIEVE THE PREVIOUS TEMP STORAGE QUEUE RECORD                *ETKCS307
00691 *----------------------------------------------------------------*ETKCS307
00692  2120-GET-PREV-REC.                                               ETKCS307
00693                                                                   ETKCS307
00694      SUBTRACT +1 FROM ASC-SEL-SUB.                                ETKCS307
00695                                                                   ETKCS307
00696      IF  ASC-SEL-SUB < +1                                         ETKCS307
00697          SUBTRACT +1 FROM ASC-SEL-ITEM                            ETKCS307
00698          MOVE ET301-MAX-ITEMS      TO ASC-SEL-SUB                 ETKCS307
00699      END-IF.                                                      ETKCS307
00700                                                                   ETKCS307
00701      IF  ASC-SEL-ITEM > ZERO                                      ETKCS307
00702                                                                   ETKCS307
00703          PERFORM 9100-READ-SEL-QUEUE                              ETKCS307
00704                                                                   ETKCS307
00705          INITIALIZE ASC-KEY-FIELDS                                ETKCS307
00706                                                                   ETKCS307
00707          MOVE ET301-TP-DKEY         (ASC-SEL-SUB)                 ETKCS307
00708            TO ASC-KEY-TP-DKEY                                     ETKCS307
00709                                                                   ETKCS307
00710          MOVE ET301-ENT-ID          (ASC-SEL-SUB)                 ETKCS307
00711            TO ASC-HLD-ENT-ID                                      ETKCS307
00712          MOVE ET301-VENDOR-NAME     (ASC-SEL-SUB)                 ETKCS307
00713            TO ASC-HLD-VENDOR-NAME                                 ETKCS307
00714          MOVE ET301-NETWK-ID        (ASC-SEL-SUB)                 ETKCS307
00715            TO ASC-HLD-NETWK-ID                                    ETKCS307
00716          MOVE ET301-NETWK-NAME      (ASC-SEL-SUB)                 ETKCS307
00717            TO ASC-HLD-NETWK-NAME                                  ETKCS307
00718                                                                   ETKCS307
00719          INITIALIZE ASC-SCREEN-FIELDS                             ETKCS307
00720                                                                   ETKCS307
00721          SET ET301-INQ (ASC-SEL-SUB)                              ETKCS307
00722                                TO TRUE                            ETKCS307
00723                                                                   ETKCS307
00724          PERFORM 9200-REWRITE-LIST-QUEUE                          ETKCS307
00725                                                                   ETKCS307
00726      ELSE                                                         ETKCS307
00727                                                                   ETKCS307
00728          MOVE +1                   TO ASC-SEL-ITEM                ETKCS307
00729                                       ASC-SEL-SUB                 ETKCS307
00730 *        --- TOP OF LIST ---                                      ETKCS307
00731          MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            ETKCS307
00732          SET DP020-MSG-INFORMATIONAL                              ETKCS307
00733              PS-LIST-END           TO TRUE                        ETKCS307
00734                                                                   ETKCS307
00735      END-IF.                                                      ETKCS307
00736                                                                   ETKCS307
00737  EJECT                                                            ETKCS307
00738 *----------------------------------------------------------------*ETKCS307
00739 *    VALIDATE THE QUEUE WAS PASSED.                              *ETKCS307
00740 *    DISPLAY THE FIRST ENTRY.                                    *ETKCS307
00741 *    (NOTE : JUSTIFICATION AND DISPLAY FIELD COLORS ARE ALL      *ETKCS307
00742 *            CONTROLLED WITHIN THE BMS MAP)                      *ETKCS307
00743 *----------------------------------------------------------------*ETKCS307
00744  4000-BUILD-INITIAL-PANEL.                                        ETKCS307
00745                                                                   ETKCS307
00746      SET DP030-SET-CURSOR-TRAILER  TO TRUE.                       ETKCS307
00747                                                                   ETKCS307
00748 *    ** DB2 TABLE DCLGEN'S **                                     ETKCS307
00749      INITIALIZE DCLTTRDPRT                                        ETKCS307
00750                 DCLTNETWRK.                                       ETKCS307
00751                                                                   ETKCS307
00752      INITIALIZE DK-DB2-KEYS                                       ETKCS307
00753                 ASC-SCREEN-FIELDS                                 ETKCS307
00754                 ASC-OTHER-FIELDS.                                 ETKCS307
00755                                                                   ETKCS307
00756      EXEC SQL                                                     ETKCS307
00757          SET :ASC-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           ETKCS307
00758      END-EXEC.                                                    ETKCS307
00759                                                                   ETKCS307
00760      EVALUATE TRUE                                                ETKCS307
00761          WHEN SQLCODE = 0                                         ETKCS307
00762              CONTINUE                                             ETKCS307
00763          WHEN OTHER                                               ETKCS307
00764              MOVE '4000-BUILD-INITIAL-PANEL'                      ETKCS307
00765                                TO DP013-PARAGRAPH                 ETKCS307
00766              MOVE 'SET VARIABLE TO CURRENT TIMESTAMP'             ETKCS307
00767                                TO DP013-MESSAGE-TEXT(1)           ETKCS307
00768              MOVE SQLCA        TO DP013-SQLCA                     ETKCS307
00769              MOVE 'N/A    '    TO DP013-DB2-TABLE-NAME (1)        ETKCS307
00770              SET DP013-DB2-ABEND                                  ETKCS307
00771                  DP013-XCTL-DISPLAY-RESTART TO TRUE               ETKCS307
00772              PERFORM DP013-0000-PROCESS-ABEND                     ETKCS307
00773      END-EVALUATE.                                                ETKCS307
00774                                                                   ETKCS307
00775      SET PS-NO-ERROR            TO TRUE.                          ETKCS307
00776      SET ASC-TP-INFO-FOUND      TO TRUE.                          ETKCS307
00777      SET ASC-NETWK-INFO-FOUND   TO TRUE.                          ETKCS307
00778                                                                   ETKCS307
00779      IF ASC-KEY-TP-DKEY > +0                                      ETKCS307
00780          MOVE ASC-KEY-TP-DKEY TO DK-TP-DKEY                       ETKCS307
00781          PERFORM 4300-SELECT-TTRDPRT                              ETKCS307
00782                                                                   ETKCS307
00783          IF ASC-TP-INFO-FOUND                                     ETKCS307
00784 *           ==> DETERMINE THE INTER-CONNECT NTWK NAME             ETKCS307
00785              IF ASC-KEY-INTRCONN-NETWK-ID = SPACE                 ETKCS307
00786                  MOVE SPACES TO ASC-INTRCONN-NETWK-NME            ETKCS307
00787                  SET  ASC-NETWK-INFO-FOUND TO TRUE                ETKCS307
00788              ELSE                                                 ETKCS307
00789                  MOVE ASC-KEY-INTRCONN-NETWK-ID                   ETKCS307
00790                    TO DK-NETWK-ID                                 ETKCS307
00791                  PERFORM 4350-SELECT-TNETWRK                      ETKCS307
00792              END-IF                                               ETKCS307
00793                                                                   ETKCS307
00794              IF ASC-NETWK-INFO-NOT-FOUND                          ETKCS307
00795                  SET PS-ERROR TO TRUE                             ETKCS307
00796              END-IF                                               ETKCS307
00797          ELSE                                                     ETKCS307
00798              SET PS-ERROR TO TRUE                                 ETKCS307
00799          END-IF                                                   ETKCS307
00800                                                                   ETKCS307
00801      ELSE                                                         ETKCS307
00802          SET PS-ERROR TO TRUE                                     ETKCS307
00803      END-IF.                                                      ETKCS307
00804                                                                   ETKCS307
00805      IF PS-ERROR                                                  ETKCS307
00806         MOVE PC-TSYMSG-00005           TO DP020-MSG-NUMBER        ETKCS307
00807         SET DP020-MSG-FATAL            TO TRUE                    ETKCS307
00808         SET DP020-NEXT-ACT-APPL-ERROR  TO TRUE                    ETKCS307
00809      END-IF.                                                      ETKCS307
00810                                                                   ETKCS307
00811      PERFORM 4100-CONVERT-HEX-BYTE.                               ETKCS307
00812      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        ETKCS307
00813                                                                   ETKCS307
00814  EJECT                                                            ETKCS307
00815 *----------------------------------------------------------------*ETKCS307
00816 *    USE THIS PARAGRAPH IF YOU NEED TO CONVERT THE EDI           *ETKCS307
00817 *    HEXADECIMAL 1 BYTE "SEPARATION / TERMINATION" CHARACTER     *ETKCS307
00818 *    TO IT'S DISPLAY COUNTER PART; OR THE REVERSE.               *ETKCS307
00819 *----------------------------------------------------------------*ETKCS307
00820  4100-CONVERT-HEX-BYTE.                                           ETKCS307
00821                                                                   ETKCS307
00822 * ====>  THE FOLLOWING SEARCH LOGIC ATTEMPTS TO                   ETKCS307
00823 * ====>  DETERMINE THE 1 BYTE HEX REPRESENTATION,                 ETKCS307
00824 * ====>  FROM THE 2 BYTE DECIMAL REPRESENTATION.                  ETKCS307
00825                                                                   ETKCS307
00826      SET MP023I-IDX TO +1                                         ETKCS307
00827      SEARCH MP023I-TABLE-ENTRY                                    ETKCS307
00828          AT END                                                   ETKCS307
00829              PERFORM 4110-SET-DFLT-SEND-DATA-ELEM                 ETKCS307
00830          WHEN ( MP023I-HEX(MP023I-IDX) =                          ETKCS307
00831                   ASC-SEND-DATA-ELEM-IND )                        ETKCS307
00832               MOVE MP023I-PRINT(MP023I-IDX) TO                    ETKCS307
00833                    ASC-SEND-DATA-ELEM-PRT                         ETKCS307
00834      END-SEARCH                                                   ETKCS307
00835                                                                   ETKCS307
00836      SET MP023I-IDX TO +1                                         ETKCS307
00837      SEARCH MP023I-TABLE-ENTRY                                    ETKCS307
00838          AT END                                                   ETKCS307
00839              PERFORM 4111-SET-DFLT-SEG-TERM                       ETKCS307
00840          WHEN ( MP023I-HEX(MP023I-IDX) =                          ETKCS307
00841                   ASC-SEND-SEG-TERM-IND )                         ETKCS307
00842               MOVE MP023I-PRINT(MP023I-IDX) TO                    ETKCS307
00843                    ASC-SEND-SEG-TERM-PRT                          ETKCS307
00844      END-SEARCH                                                   ETKCS307
00845                                                                   ETKCS307
00846      SET MP023I-IDX TO +1                                         ETKCS307
00847      SEARCH MP023I-TABLE-ENTRY                                    ETKCS307
00848          AT END                                                   ETKCS307
00849              PERFORM 4112-SET-DFLT-SEND-SUB-ELEM                  ETKCS307
00850          WHEN ( MP023I-HEX(MP023I-IDX) =                          ETKCS307
00851                   ASC-SEND-SUB-ELEM-IND )                         ETKCS307
00852               MOVE MP023I-PRINT(MP023I-IDX) TO                    ETKCS307
00853                    ASC-SEND-SUB-ELEM-PRT                          ETKCS307
00854      END-SEARCH.                                                  ETKCS307
00855                                                                   ETKCS307
00856  4110-SET-DFLT-SEND-DATA-ELEM.                                    ETKCS307
00857                                                                   ETKCS307
00858 * HEX 2F                                                          ETKCS307
00859      MOVE MP023I-HEX(1)            TO                             ETKCS307
00860           ASC-SEND-DATA-ELEM-IND                                  ETKCS307
00861      MOVE MP023I-PRINT(1)          TO                             ETKCS307
00862           ASC-SEND-DATA-ELEM-PRT.                                 ETKCS307
00863                                                                   ETKCS307
00864  4111-SET-DFLT-SEG-TERM.                                          ETKCS307
00865                                                                   ETKCS307
00866 * HEX 15                                                          ETKCS307
00867      MOVE MP023I-HEX(4)            TO                             ETKCS307
00868           ASC-SEND-SEG-TERM-IND                                   ETKCS307
00869      MOVE MP023I-PRINT(4)          TO                             ETKCS307
00870           ASC-SEND-SEG-TERM-PRT.                                  ETKCS307
00871                                                                   ETKCS307
00872  4112-SET-DFLT-SEND-SUB-ELEM.                                     ETKCS307
00873                                                                   ETKCS307
00874 * HEX 6E                                                          ETKCS307
00875      MOVE MP023I-HEX(3)            TO                             ETKCS307
00876           ASC-SEND-SUB-ELEM-IND                                   ETKCS307
00877      MOVE MP023I-PRINT(3)          TO                             ETKCS307
00878           ASC-SEND-SUB-ELEM-PRT.                                  ETKCS307
00879                                                                   ETKCS307
00880  EJECT                                                            ETKCS307
00881 *---------------------------------------------------------------- ETKCS307
00882 * SELECT A TRADING PARTNERSHIP                                    ETKCS307
00883 *---------------------------------------------------------------- ETKCS307
00884  4300-SELECT-TTRDPRT.                                             ETKCS307
00885                                                                   ETKCS307
00886      PERFORM                                                      ETKCS307
00887          WITH TEST AFTER                                          ETKCS307
00888          VARYING PV-RETRY-COUNTER                                 ETKCS307
00889          FROM 1 BY 1                                              ETKCS307
00890          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               ETKCS307
00891             OR (SQLCODE = +0)                                     ETKCS307
00892             OR (SQLCODE = +100)                                   ETKCS307
00893             OR (SQLCODE = -811))                                  ETKCS307
00894                                                                   ETKCS307
00895 * ? (SQLCODE = -811) MEANS DUPLICATES RESULTED                    ETKCS307
00896                                                                   ETKCS307
00897 * ?? ** IN FOLLOWING SELECTS WHERE CLAUSE, I MAY NOT NEED         ETKCS307
00898 * ?? ** TO SCREEN FOR RANGES, I S/B ABLE TO GET SPECIFIC DATA     ETKCS307
00899                                                                   ETKCS307
00900          EXEC SQL                                                 ETKCS307
00901                SELECT       TP_DKEY                               ETKCS307
00902                            ,ENT_ID                                ETKCS307
00903                            ,VEND_INCHG_ID                         ETKCS307
00904                            ,VEND_INCHG_ID_DESC                    ETKCS307
00905                            ,NETWK_ID                              ETKCS307
00906                            ,KOHL_INCHG_ID                         ETKCS307
00907                            ,KOHL_INCHG_ID_DESC                    ETKCS307
00908                            ,SEND_FMT_VER_CDE                      ETKCS307
00909                            ,SEND_FMT_NME                          ETKCS307
00910                            ,LAST_SEND_CNTL_NBR                    ETKCS307
00911                            ,SEND_CNTL_NBR_CDE                     ETKCS307
00912                            ,OVRRD_SND_CNTL_NBR                    ETKCS307
00913                            ,OVRRD_SND_CNTL_ID                     ETKCS307
00914                            ,RECV_FMT_VER_CDE                      ETKCS307
00915                            ,RECV_FMT_NME                          ETKCS307
00916                            ,LAST_RECV_CNTL_NBR                    ETKCS307
00917                            ,RECV_CNTL_NBR_CDE                     ETKCS307
00918                            ,OVRRD_RCV_CNTL_NBR                    ETKCS307
00919                            ,OVRRD_RCV_CNTL_ID                     ETKCS307
00920                            ,SETUP_DTE                             ETKCS307
00921                            ,LAST_CHG_DTE                          ETKCS307
00922                            ,LAST_CHG_UID                          ETKCS307
00923                            ,ACTV_DTE                              ETKCS307
00924                            ,INACTV_DTE                            ETKCS307
00925                            ,SER_LVL_CDE                           ETKCS307
00926                            ,NOTES_TXT                             ETKCS307
00927                            ,LAST_CALL_DTE                         ETKCS307
00928                            ,NEXT_CALL_DTE                         ETKCS307
00929                            ,SEND_DATA_ELEM_IND                    ETKCS307
00930                            ,SEND_SEG_TERM_IND                     ETKCS307
00931                            ,SEND_SUB_ELEM_IND                     ETKCS307
00932                            ,SEND_ACK_REQD_IND                     ETKCS307
00933                            ,INTRCONN_NETWK_IND                    ETKCS307
                                 ,FA_COM_MTHD_CDE                               
00934                INTO         :TRDPRT-TP-DKEY                       ETKCS307
00935                            ,:TRDPRT-ENT-ID                        ETKCS307
00936                            ,:TRDPRT-VEND-INCHG-ID                 ETKCS307
00937                            ,:TRDPRT-VEND-INCHG-ID-DESC            ETKCS307
00938                            ,:TRDPRT-NETWK-ID                      ETKCS307
00939                            ,:TRDPRT-KOHL-INCHG-ID                 ETKCS307
00940                            ,:TRDPRT-KOHL-INCHG-ID-DESC            ETKCS307
00941                            ,:TRDPRT-SEND-FMT-VER-CDE              ETKCS307
00942                            ,:TRDPRT-SEND-FMT-NME                  ETKCS307
00943                            ,:TRDPRT-LAST-SEND-CNTL-NBR            ETKCS307
00944                            ,:TRDPRT-SEND-CNTL-NBR-CDE             ETKCS307
00945                            ,:TRDPRT-OVRRD-SND-CNTL-NBR            ETKCS307
00946                            ,:TRDPRT-OVRRD-SND-CNTL-ID             ETKCS307
00947                            ,:TRDPRT-RECV-FMT-VER-CDE              ETKCS307
00948                            ,:TRDPRT-RECV-FMT-NME                  ETKCS307
00949                            ,:TRDPRT-LAST-RECV-CNTL-NBR            ETKCS307
00950                            ,:TRDPRT-RECV-CNTL-NBR-CDE             ETKCS307
00951                            ,:TRDPRT-OVRRD-RCV-CNTL-NBR            ETKCS307
00952                            ,:TRDPRT-OVRRD-RCV-CNTL-ID             ETKCS307
00953                            ,:TRDPRT-SETUP-DTE                     ETKCS307
00954                            ,:TRDPRT-LAST-CHG-DTE                  ETKCS307
00955                            ,:TRDPRT-LAST-CHG-UID                  ETKCS307
00956                            ,:TRDPRT-ACTV-DTE                      ETKCS307
00957                            ,:TRDPRT-INACTV-DTE                    ETKCS307
00958                            ,:TRDPRT-SER-LVL-CDE                   ETKCS307
00959                            ,:TRDPRT-NOTES-TXT                     ETKCS307
00960                            ,:TRDPRT-LAST-CALL-DTE                 ETKCS307
00961                            ,:TRDPRT-NEXT-CALL-DTE                 ETKCS307
00962                            ,:TRDPRT-SEND-DATA-ELEM-IND            ETKCS307
00963                            ,:TRDPRT-SEND-SEG-TERM-IND             ETKCS307
00964                            ,:TRDPRT-SEND-SUB-ELEM-IND             ETKCS307
00965                            ,:TRDPRT-SEND-ACK-REQD-IND             ETKCS307
00966                            ,:TRDPRT-INTRCONN-NETWK-IND            ETKCS307
                                 ,:TRDPRT-FA-COM-MTHD-CDE                       
00967              FROM   TTRDPRT                                       ETKCS307
00968              WHERE  TP_DKEY = :DK-TP-DKEY                         ETKCS307
00969          END-EXEC                                                 ETKCS307
00970                                                                   ETKCS307
00971          EVALUATE TRUE                                            ETKCS307
00972                                                                   ETKCS307
00973              WHEN SQLCODE = +0                                    ETKCS307
00974              WHEN SQLCODE = +100                                  ETKCS307
00975                  CONTINUE                                         ETKCS307
00976                                                                   ETKCS307
00977              WHEN SQLCODE = -811                                  ETKCS307
00978              WHEN SQLCODE = -904                                  ETKCS307
00979              WHEN SQLCODE = -913                                  ETKCS307
00980                  CONTINUE                                         ETKCS307
00981                                                                   ETKCS307
00982              WHEN SQLWARN0 NOT = SPACES                           ETKCS307
00983              WHEN SQLCODE < ZERO                                  ETKCS307
00984              WHEN SQLCODE > ZERO                                  ETKCS307
00985                  MOVE '4300-SELECT-TTRDPRT'                       ETKCS307
00986                                    TO DP013-PARAGRAPH             ETKCS307
00987                  MOVE 'SELECT ON TTRDPRT'                         ETKCS307
00988                                    TO DP013-MESSAGE-TEXT (1)      ETKCS307
00989                  MOVE SQLCA        TO DP013-SQLCA                 ETKCS307
00990                  MOVE 'TTRDPRT'    TO DP013-DB2-TABLE-NAME (1)    ETKCS307
00991                  SET DP013-DB2-ABEND                              ETKCS307
00992                      DP013-XCTL-DISPLAY-RESTART                   ETKCS307
00993                                    TO TRUE                        ETKCS307
00994                  PERFORM DP013-0000-PROCESS-ABEND                 ETKCS307
00995                                                                   ETKCS307
00996          END-EVALUATE                                             ETKCS307
00997                                                                   ETKCS307
00998      END-PERFORM.                                                 ETKCS307
00999                                                                   ETKCS307
01000      IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        ETKCS307
01001          MOVE '4300-SELECT-TTRDPRT'                               ETKCS307
01002                                    TO DP013-PARAGRAPH             ETKCS307
01003          MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     ETKCS307
01004                                    TO DP013-MESSAGE-TEXT (1)      ETKCS307
01005          MOVE 'A TTRDPRT ROW   '   TO DP013-MESSAGE-TEXT (2)      ETKCS307
01006          MOVE SQLCA                TO DP013-SQLCA                 ETKCS307
01007          MOVE 'TTRDPRT'            TO DP013-DB2-TABLE-NAME (1)    ETKCS307
01008          SET DP013-DB2-ABEND                                      ETKCS307
01009              DP013-XCTL-DISPLAY-RESTART                           ETKCS307
01010                                    TO TRUE                        ETKCS307
01011          PERFORM DP013-0000-PROCESS-ABEND                         ETKCS307
01012      END-IF.                                                      ETKCS307
01013                                                                   ETKCS307
01014      IF SQLCODE = +0                                              ETKCS307
01015 *       ** TRADING PARTNERSHIP RECORD FOUND **                    ETKCS307
01016         SET ASC-TP-INFO-FOUND TO TRUE                             ETKCS307
01017                                                                   ETKCS307
01018         MOVE TRDPRT-TP-DKEY                                       ETKCS307
01019           TO ASC-TP-DKEY                                          ETKCS307
01020                                                                   ETKCS307
01021 *       MOVE TRDPRT-ENT-ID                                        ETKCS307
01022         MOVE ASC-HLD-ENT-ID                                       ETKCS307
01023           TO ASC-ENT-ID                                           ETKCS307
01024                                                                   ETKCS307
01025         MOVE ASC-HLD-VENDOR-NAME                                  ETKCS307
01026           TO ASC-VENDOR-NAME                                      ETKCS307
01027                                                                   ETKCS307
01028         MOVE TRDPRT-VEND-INCHG-ID                                 ETKCS307
01029           TO ASC-VEND-INCHG-ID                                    ETKCS307
01030         MOVE TRDPRT-VEND-INCHG-ID-DESC                            ETKCS307
01031           TO ASC-VEND-INCHG-QUAL                                  ETKCS307
01032                                                                   ETKCS307
01033 *       MOVE TRDPRT-NETWK-ID                                      ETKCS307
01034         MOVE ASC-HLD-NETWK-ID                                     ETKCS307
01035           TO ASC-NETWK-ID                                         ETKCS307
01036         MOVE ASC-HLD-NETWK-NAME                                   ETKCS307
01037           TO ASC-NETWORK-NAME                                     ETKCS307
01038                                                                   ETKCS307
01039         MOVE TRDPRT-KOHL-INCHG-ID                                 ETKCS307
01040           TO ASC-KOHL-INCHG-ID                                    ETKCS307
01041         MOVE TRDPRT-KOHL-INCHG-ID-DESC                            ETKCS307
01042           TO ASC-KOHL-INCHG-QUAL                                  ETKCS307
01043         MOVE TRDPRT-SEND-FMT-VER-CDE                              ETKCS307
01044           TO ASC-SEND-FMT-VER-CDE                                 ETKCS307
01045         MOVE TRDPRT-SEND-FMT-NME                                  ETKCS307
01046           TO ASC-SEND-FMT-NME                                     ETKCS307
01047         MOVE TRDPRT-LAST-SEND-CNTL-NBR                            ETKCS307
01048           TO ASC-LAST-SEND-CNTL-NBR                               ETKCS307
01049         MOVE TRDPRT-SEND-CNTL-NBR-CDE                             ETKCS307
01050           TO ASC-SEND-CNTL-NBR-CDE                                ETKCS307
01051         MOVE TRDPRT-OVRRD-SND-CNTL-NBR                            ETKCS307
01052           TO ASC-OVRRD-SND-CNTL-NBR                               ETKCS307
01053         MOVE TRDPRT-OVRRD-SND-CNTL-ID                             ETKCS307
01054           TO ASC-OVRRD-SND-CNTL-ID                                ETKCS307
01055         MOVE TRDPRT-RECV-FMT-VER-CDE                              ETKCS307
01056           TO ASC-RECV-FMT-VER-CDE                                 ETKCS307
01057         MOVE TRDPRT-RECV-FMT-NME                                  ETKCS307
01058           TO ASC-RECV-FMT-NME                                     ETKCS307
01059         MOVE TRDPRT-LAST-RECV-CNTL-NBR                            ETKCS307
01060           TO ASC-LAST-RECV-CNTL-NBR                               ETKCS307
01061         MOVE TRDPRT-RECV-CNTL-NBR-CDE                             ETKCS307
01062           TO ASC-RECV-CNTL-NBR-CDE                                ETKCS307
01063         MOVE TRDPRT-OVRRD-RCV-CNTL-NBR                            ETKCS307
01064           TO ASC-OVRRD-RCV-CNTL-NBR                               ETKCS307
01065         MOVE TRDPRT-OVRRD-RCV-CNTL-ID                             ETKCS307
01066           TO ASC-OVRRD-RCV-CNTL-ID                                ETKCS307
              MOVE TRDPRT-FA-COM-MTHD-CDE                                       
                TO ASC-FA-COMM-MTHD                                             
                                                                                
              MOVE SPACES TO ASC-FA-COMM-MTHD-NME                               
              IF TRDPRT-FA-COM-MTHD-CDE = 'V'                                   
                  MOVE 'VAN  ' TO ASC-FA-COMM-MTHD-NME                          
              ELSE                                                              
                  IF TRDPRT-FA-COM-MTHD-CDE = 'F'                               
                      MOVE 'FTP  ' TO ASC-FA-COMM-MTHD-NME                      
                  ELSE                                                          
                      IF TRDPRT-FA-COM-MTHD-CDE = 'E'                           
                         MOVE 'EMAIL' TO ASC-FA-COMM-MTHD-NME                   
SP0403                ELSE                                                      
SP0403                    IF TRDPRT-FA-COM-MTHD-CDE = 'A'                       
SP0403                        MOVE 'AS2  ' TO ASC-FA-COMM-MTHD-NME              
SP0403                    END-IF                                                
                      END-IF                                                    
                  END-IF                                                        
              END-IF                                                            
01067                                                                   ETKCS307
01068         IF TRDPRT-SETUP-DTE = '9999-09-09'                        ETKCS307
01069             MOVE SPACES       TO ASC-SETUP-DTE                    ETKCS307
01070         ELSE                                                      ETKCS307
01071             MOVE TRDPRT-SETUP-DTE                                 ETKCS307
01072               TO PV-WORK-DATE                                     ETKCS307
01073                                                                   ETKCS307
01074             MOVE PV-WORK-DATE-MM                                  ETKCS307
01075               TO ASC-SETUP-DTE-MM                                 ETKCS307
01076             MOVE SPACE TO ASC-SETUP-DTE-S1                        ETKCS307
01077             MOVE PV-WORK-DATE-DD                                  ETKCS307
01078               TO ASC-SETUP-DTE-DD                                 ETKCS307
01079             MOVE SPACE TO ASC-SETUP-DTE-S2                        ETKCS307
01080             MOVE PV-WORK-DATE-CCYY                                ETKCS307
01081               TO ASC-SETUP-DTE-CCYY                               ETKCS307
01082         END-IF                                                    ETKCS307
01083                                                                   ETKCS307
01084         IF TRDPRT-LAST-CHG-DTE = '9999-09-09'                     ETKCS307
01085             MOVE SPACES       TO ASC-LAST-CHG-DTE                 ETKCS307
01086         ELSE                                                      ETKCS307
01087             MOVE TRDPRT-LAST-CHG-DTE                              ETKCS307
01088               TO PV-WORK-DATE                                     ETKCS307
01089                                                                   ETKCS307
01090             MOVE PV-WORK-DATE-MM                                  ETKCS307
01091               TO ASC-LAST-CHG-DTE-MM                              ETKCS307
01092             MOVE SPACE TO ASC-LAST-CHG-DTE-S1                     ETKCS307
01093             MOVE PV-WORK-DATE-DD                                  ETKCS307
01094               TO ASC-LAST-CHG-DTE-DD                              ETKCS307
01095             MOVE SPACE TO ASC-LAST-CHG-DTE-S2                     ETKCS307
01096             MOVE PV-WORK-DATE-CCYY                                ETKCS307
01097               TO ASC-LAST-CHG-DTE-CCYY                            ETKCS307
01098         END-IF                                                    ETKCS307
01099                                                                   ETKCS307
01100         MOVE TRDPRT-LAST-CHG-UID                                  ETKCS307
01101           TO ASC-LAST-CHG-UID                                     ETKCS307
01102                                                                   ETKCS307
01103         IF TRDPRT-ACTV-DTE = '9999-09-09'                         ETKCS307
01104             MOVE SPACES       TO ASC-ACTV-DTE                     ETKCS307
01105         ELSE                                                      ETKCS307
01106             MOVE TRDPRT-ACTV-DTE                                  ETKCS307
01107               TO PV-WORK-DATE                                     ETKCS307
01108                                                                   ETKCS307
01109             MOVE PV-WORK-DATE-MM                                  ETKCS307
01110               TO ASC-ACTV-DTE-MM                                  ETKCS307
01111             MOVE SPACE TO ASC-ACTV-DTE-S1                         ETKCS307
01112             MOVE PV-WORK-DATE-DD                                  ETKCS307
01113               TO ASC-ACTV-DTE-DD                                  ETKCS307
01114             MOVE SPACE TO ASC-ACTV-DTE-S2                         ETKCS307
01115             MOVE PV-WORK-DATE-CCYY                                ETKCS307
01116               TO ASC-ACTV-DTE-CCYY                                ETKCS307
01117         END-IF                                                    ETKCS307
01118                                                                   ETKCS307
01119         IF TRDPRT-INACTV-DTE = '9999-09-09'                       ETKCS307
01120             MOVE SPACES       TO ASC-INACTV-DTE                   ETKCS307
01121         ELSE                                                      ETKCS307
01122             MOVE TRDPRT-INACTV-DTE                                ETKCS307
01123               TO PV-WORK-DATE                                     ETKCS307
01124                                                                   ETKCS307
01125             MOVE PV-WORK-DATE-MM                                  ETKCS307
01126               TO ASC-INACTV-DTE-MM                                ETKCS307
01127             MOVE SPACE TO ASC-INACTV-DTE-S1                       ETKCS307
01128             MOVE PV-WORK-DATE-DD                                  ETKCS307
01129               TO ASC-INACTV-DTE-DD                                ETKCS307
01130             MOVE SPACE TO ASC-INACTV-DTE-S2                       ETKCS307
01131             MOVE PV-WORK-DATE-CCYY                                ETKCS307
01132               TO ASC-INACTV-DTE-CCYY                              ETKCS307
01133         END-IF                                                    ETKCS307
01134                                                                   ETKCS307
01135         MOVE TRDPRT-SER-LVL-CDE                                   ETKCS307
01136           TO ASC-SER-LVL-CDE                                      ETKCS307
01137         MOVE TRDPRT-NOTES-TXT                                     ETKCS307
01138           TO ASC-NOTES-TXT                                        ETKCS307
01139                                                                   ETKCS307
01140         IF TRDPRT-LAST-CALL-DTE = '9999-09-09'                    ETKCS307
01141             MOVE SPACES       TO ASC-LAST-CALL-DTE                ETKCS307
01142         ELSE                                                      ETKCS307
01143             MOVE TRDPRT-LAST-CALL-DTE                             ETKCS307
01144               TO PV-WORK-DATE                                     ETKCS307
01145                                                                   ETKCS307
01146             MOVE PV-WORK-DATE-MM                                  ETKCS307
01147               TO ASC-LAST-CALL-DTE-MM                             ETKCS307
01148             MOVE SPACE TO ASC-LAST-CALL-DTE-S1                    ETKCS307
01149             MOVE PV-WORK-DATE-DD                                  ETKCS307
01150               TO ASC-LAST-CALL-DTE-DD                             ETKCS307
01151             MOVE SPACE TO ASC-LAST-CALL-DTE-S2                    ETKCS307
01152             MOVE PV-WORK-DATE-CCYY                                ETKCS307
01153               TO ASC-LAST-CALL-DTE-CCYY                           ETKCS307
01154         END-IF                                                    ETKCS307
01155                                                                   ETKCS307
01156         IF TRDPRT-NEXT-CALL-DTE = '9999-09-09'                    ETKCS307
01157             MOVE SPACES       TO ASC-NEXT-CALL-DTE                ETKCS307
01158         ELSE                                                      ETKCS307
01159             MOVE TRDPRT-NEXT-CALL-DTE                             ETKCS307
01160               TO PV-WORK-DATE                                     ETKCS307
01161                                                                   ETKCS307
01162             MOVE PV-WORK-DATE-MM                                  ETKCS307
01163               TO ASC-NEXT-CALL-DTE-MM                             ETKCS307
01164             MOVE SPACE TO ASC-NEXT-CALL-DTE-S1                    ETKCS307
01165             MOVE PV-WORK-DATE-DD                                  ETKCS307
01166               TO ASC-NEXT-CALL-DTE-DD                             ETKCS307
01167             MOVE SPACE TO ASC-NEXT-CALL-DTE-S2                    ETKCS307
01168             MOVE PV-WORK-DATE-CCYY                                ETKCS307
01169               TO ASC-NEXT-CALL-DTE-CCYY                           ETKCS307
01170         END-IF                                                    ETKCS307
01171                                                                   ETKCS307
01172 *   **  MOVE TRDPRT-SEND-AUTH-INFO-ID   X(10)                     ETKCS307
01173 *   **  MOVE TRDPRT-SEND-AUTH-INF-DESC  X(02)                     ETKCS307
01174 *   **  MOVE TRDPRT-SEND-SEC-INFO-ID    X(10)                     ETKCS307
01175 *   **  MOVE TRDPRT-SEND-SEC-INFO-DESC  X(02)                     ETKCS307
01176                                                                   ETKCS307
01177         MOVE TRDPRT-SEND-DATA-ELEM-IND                            ETKCS307
01178           TO ASC-SEND-DATA-ELEM-IND                               ETKCS307
01179         MOVE TRDPRT-SEND-SEG-TERM-IND                             ETKCS307
01180           TO ASC-SEND-SEG-TERM-IND                                ETKCS307
01181         MOVE TRDPRT-SEND-SUB-ELEM-IND                             ETKCS307
01182           TO ASC-SEND-SUB-ELEM-IND                                ETKCS307
01183                                                                   ETKCS307
01184 *   **  MOVE TRDPRT-SEND-ACK-REQD-IND   X(01)                     ETKCS307
01185                                                                   ETKCS307
01186         MOVE TRDPRT-INTRCONN-NETWK-IND                            ETKCS307
01187           TO ASC-INTRCONN-NETWK-IND                               ETKCS307
01188              ASC-KEY-INTRCONN-NETWK-ID                            ETKCS307
01189                                                                   ETKCS307
01190      END-IF                                                       ETKCS307
01191                                                                   ETKCS307
01192      IF SQLCODE = +100                                            ETKCS307
01193 *       ** TRADING PARTNERSHIP RECORD NOT FOUND **                ETKCS307
01194         SET ASC-TP-INFO-NOT-FOUND TO TRUE                         ETKCS307
01195      END-IF.                                                      ETKCS307
01196                                                                   ETKCS307
01197  EJECT                                                            ETKCS307
01198 *---------------------------------------------------------------- ETKCS307
01199 *  RETRIEVE NETWORK DETAIL                                        ETKCS307
01200 *---------------------------------------------------------------- ETKCS307
01201                                                                   ETKCS307
01202  4350-SELECT-TNETWRK.                                             ETKCS307
01203                                                                   ETKCS307
01204      PERFORM                                                      ETKCS307
01205          WITH TEST AFTER                                          ETKCS307
01206          VARYING PV-RETRY-COUNTER                                 ETKCS307
01207          FROM 1 BY 1                                              ETKCS307
01208          UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               ETKCS307
01209             OR  (SQLCODE = +100)                                  ETKCS307
01210             OR  (SQLCODE = +0))                                   ETKCS307
01211                                                                   ETKCS307
01212          EXEC SQL                                                 ETKCS307
01213              SELECT    NETWK_ID                                   ETKCS307
01214                       ,NETWK_NME                                  ETKCS307
01215                INTO    :NETWRK-NETWK-ID                           ETKCS307
01216                       ,:NETWRK-NETWK-NME                          ETKCS307
01217               FROM  TNETWRK                                       ETKCS307
01218              WHERE  NETWK_ID = :DK-NETWK-ID                       ETKCS307
01219          END-EXEC                                                 ETKCS307
01220                                                                   ETKCS307
01221          EVALUATE TRUE                                            ETKCS307
01222              WHEN SQLCODE = +0                                    ETKCS307
01223              WHEN SQLCODE = +100                                  ETKCS307
01224                   CONTINUE                                        ETKCS307
01225                                                                   ETKCS307
01226              WHEN SQLCODE = -904                                  ETKCS307
01227              WHEN SQLCODE = -913                                  ETKCS307
01228                   CONTINUE                                        ETKCS307
01229                                                                   ETKCS307
01230              WHEN SQLWARN0 NOT = SPACE                            ETKCS307
01231              WHEN SQLCODE < +0                                    ETKCS307
01232              WHEN SQLCODE > +0                                    ETKCS307
01233                   MOVE '4350-SELECT-TNETWRK'                      ETKCS307
01234                                    TO DP013-PARAGRAPH             ETKCS307
01235                   MOVE 'SELECT ON TNETWRK'                        ETKCS307
01236                                    TO DP013-MESSAGE-TEXT (1)      ETKCS307
01237                   MOVE SQLCA       TO DP013-SQLCA                 ETKCS307
01238                   MOVE 'TNETWRK'   TO DP013-DB2-TABLE-NAME (1)    ETKCS307
01239                   SET DP013-DB2-ABEND                             ETKCS307
01240                       DP013-XCTL-DISPLAY-RESTART                  ETKCS307
01241                                    TO TRUE                        ETKCS307
01242                   PERFORM DP013-0000-PROCESS-ABEND                ETKCS307
01243          END-EVALUATE                                             ETKCS307
01244      END-PERFORM.                                                 ETKCS307
01245                                                                   ETKCS307
01246      IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        ETKCS307
01247          MOVE '4350-SELECT-TNETWRK'                               ETKCS307
01248                                    TO DP013-PARAGRAPH             ETKCS307
01249          MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   ETKCS307
01250                                    TO DP013-MESSAGE-TEXT (1)      ETKCS307
01251          MOVE 'ON TABLE TNETWRK '  TO DP013-MESSAGE-TEXT (2)      ETKCS307
01252          MOVE SQLCA                TO DP013-SQLCA                 ETKCS307
01253          SET DP013-DB2-ABEND                                      ETKCS307
01254              DP013-XCTL-DISPLAY-RESTART                           ETKCS307
01255                                    TO TRUE                        ETKCS307
01256          PERFORM DP013-0000-PROCESS-ABEND                         ETKCS307
01257      END-IF.                                                      ETKCS307
01258                                                                   ETKCS307
01259      IF SQLCODE = +0                                              ETKCS307
01260 *       ** NETWORK INFORMATION RECORD FOUND **                    ETKCS307
01261          SET  ASC-NETWK-INFO-FOUND TO TRUE                        ETKCS307
01262          MOVE NETWRK-NETWK-NME                                    ETKCS307
01263            TO ASC-INTRCONN-NETWK-NME                              ETKCS307
01264      ELSE                                                         ETKCS307
01265          SET  ASC-NETWK-INFO-NOT-FOUND TO TRUE                    ETKCS307
01266      END-IF.                                                      ETKCS307
01267                                                                   ETKCS307
01268  EJECT                                                            ETKCS307
01269 *----------------------------------------------------------------*ETKCS307
01270 *    MOVE THE DATA FROM THE COMMAREA TO THE SCREEN               *ETKCS307
01271 *----------------------------------------------------------------*ETKCS307
01272  4400-MOVE-COMMAREA-TO-SCREEN.                                    ETKCS307
01273                                                                   ETKCS307
01274      MOVE ASC-VENDOR-NAME                     TO VNDRNMEO.        ETKCS307
01275      MOVE ASC-SER-LVL-CDE                     TO SVCLVLO.         ETKCS307
01276                                                                   ETKCS307
01277      MOVE ASC-VEND-INCHG-QUAL                 TO VTPIDQO.         ETKCS307
01278      MOVE ASC-VEND-INCHG-ID                   TO VTPIDO.          ETKCS307
01279      MOVE ASC-NETWK-ID                        TO NTWKCDEO.        ETKCS307
01280      MOVE ASC-NETWORK-NAME                    TO NETWORKO.        ETKCS307
01281                                                                   ETKCS307
01282      MOVE ASC-KOHL-INCHG-QUAL                 TO KTPIDQO.         ETKCS307
01283      MOVE ASC-KOHL-INCHG-ID                   TO KTPIDO.          ETKCS307
01284      MOVE ASC-INTRCONN-NETWK-IND              TO ICNTCDEO.        ETKCS307
01285      MOVE ASC-INTRCONN-NETWK-NME              TO INTRCNTO.        ETKCS307
           MOVE ASC-FA-COMM-MTHD                    TO FACMTHO.                 
           MOVE ASC-FA-COMM-MTHD-NME                TO FACNMEO.                 
01286                                                                   ETKCS307
01287 *   *MOVE ASC-LAST-SEND-CNTL-NBRX                                 ETKCS307
01288      MOVE ASC-LAST-SEND-CNTL-NBR              TO SCTLNBRO.        ETKCS307
01289      MOVE ASC-SEND-CNTL-NBR-CDE               TO SCTLMTHO.        ETKCS307
01290      IF ASC-SEND-CNTL-NBR-CDE = '0'                               ETKCS307
01291          MOVE 'NOTRK   '                      TO SNDMTHDO         ETKCS307
01292      END-IF.                                                      ETKCS307
01293      IF ASC-SEND-CNTL-NBR-CDE = '1'                               ETKCS307
01294          MOVE 'TRACK   '                      TO SNDMTHDO         ETKCS307
01295      END-IF.                                                      ETKCS307
01296      MOVE ASC-SEND-FMT-NME                    TO SFMTNMEO.        ETKCS307
01297      MOVE ASC-SEND-FMT-VER-CDE                TO SFMTVERO.        ETKCS307
01298                                                                   ETKCS307
01299 *   *MOVE ASC-OVRRD-SND-CNTL-NBRX                                 ETKCS307
01300      MOVE ASC-OVRRD-SND-CNTL-NBR              TO SOVRDNO.         ETKCS307
01301      MOVE ASC-OVRRD-SND-CNTL-ID               TO SNDOVRDO.        ETKCS307
01302                                                                   ETKCS307
01303 *   *MOVE ASC-LAST-RECV-CNTL-NBRX                                 ETKCS307
01304      MOVE ASC-LAST-RECV-CNTL-NBR              TO RCTLNBRO.        ETKCS307
01305      MOVE ASC-RECV-CNTL-NBR-CDE               TO RCTLMTHO.        ETKCS307
01306      IF ASC-RECV-CNTL-NBR-CDE = '0'                               ETKCS307
01307          MOVE 'NOTRK   '                      TO RCVMTHDO         ETKCS307
01308      END-IF.                                                      ETKCS307
01309      IF ASC-RECV-CNTL-NBR-CDE = '1'                               ETKCS307
01310          MOVE 'TRACK   '                      TO RCVMTHDO         ETKCS307
01311      END-IF.                                                      ETKCS307
01312 **--- RETAIL CONTROL METHOD - REMOVED ---**                       ETKCS307
01313 **   IF ASC-RECV-CNTL-NBR-CDE = '3'                               ETKCS307
01314 **       MOVE 'RETAIL  '                      TO RCVMTHDO         ETKCS307
01315 **   END-IF.                                                      ETKCS307
01316      MOVE ASC-RECV-FMT-NME                    TO RFMTNMEO.        ETKCS307
01317      MOVE ASC-RECV-FMT-VER-CDE                TO RFMTVERO.        ETKCS307
01318                                                                   ETKCS307
01319 *   *MOVE ASC-OVRRD-RCV-CNTL-NBRX.                                ETKCS307
01320      MOVE ASC-OVRRD-RCV-CNTL-NBR              TO ROVRDNO.         ETKCS307
01321      MOVE ASC-OVRRD-RCV-CNTL-ID               TO RCVOVRDO.        ETKCS307
01322                                                                   ETKCS307
01323      MOVE ASC-SETUP-DTE                       TO STUPDTEO.        ETKCS307
01324      MOVE ASC-LAST-CHG-DTE                    TO LCHGDTEO.        ETKCS307
01325      MOVE ASC-LAST-CHG-UID                    TO USERIDO.         ETKCS307
01326                                                                   ETKCS307
01327      MOVE ASC-ACTV-DTE                        TO ACTVDTEO.        ETKCS307
01328      MOVE ASC-INACTV-DTE                      TO INACTVDO.        ETKCS307
01329                                                                   ETKCS307
01330      MOVE ASC-LAST-CALL-DTE                   TO LCNTDTEO.        ETKCS307
01331      MOVE ASC-NEXT-CALL-DTE                   TO NCNTDTEO.        ETKCS307
01332                                                                   ETKCS307
01333      MOVE ASC-SEND-DATA-ELEM-IND              TO SNDDESPO.        ETKCS307
01334      MOVE ASC-SEND-DATA-ELEM-PRT              TO SNDDEXO.         ETKCS307
01335                                                                   ETKCS307
01336      MOVE ASC-SEND-SEG-TERM-IND               TO SEGTERMO.        ETKCS307
01337      MOVE ASC-SEND-SEG-TERM-PRT               TO SEGTRMXO.        ETKCS307
01338                                                                   ETKCS307
01339      MOVE ASC-SEND-SUB-ELEM-IND               TO SUBESEPO.        ETKCS307
01340      MOVE ASC-SEND-SUB-ELEM-PRT               TO SUBESPXO.        ETKCS307
01341                                                                   ETKCS307
01342 *   *MOVE ASC-NOTES-TXT                                           ETKCS307
01343      MOVE ASC-SEND-NOTE1                      TO NOTES1O.         ETKCS307
01344      MOVE ASC-SEND-NOTE2                      TO NOTES2O.         ETKCS307
01345                                                                   ETKCS307
01346  EJECT                                                            ETKCS307
01347 *----------------------------------------------------------------*ETKCS307
01348 * READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *ETKCS307
01349 *----------------------------------------------------------------*ETKCS307
01350                                                                   ETKCS307
01351  9100-READ-SEL-QUEUE.                                             ETKCS307
01352      EXEC CICS                                                    ETKCS307
01353          READQ TS                                                 ETKCS307
01354              QUEUE (ASC-SEL-QUEUE-NAME)                           ETKCS307
01355              INTO  (ET301-SELECTED-VNDRS)                         ETKCS307
01356              ITEM  (ASC-SEL-ITEM)                                 ETKCS307
01357              RESP  (PV-CICS-RESPONSE)                             ETKCS307
01358      END-EXEC.                                                    ETKCS307
01359                                                                   ETKCS307
01360      IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   ETKCS307
01361          CONTINUE                                                 ETKCS307
01362      ELSE                                                         ETKCS307
01363         IF  PV-CICS-RESPONSE EQUAL DFHRESP(QIDERR)                ETKCS307
01364             MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER              ETKCS307
01365             SET DP020-MSG-WARNING TO TRUE                         ETKCS307
01366             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                 ETKCS307
01367         ELSE                                                      ETKCS307
01368          SET DP013-LOGIC-ABEND                                    ETKCS307
01369              DP013-NO-ROLLBACK     TO TRUE                        ETKCS307
01370          MOVE '9100-READ-SEL-QUEUE'                               ETKCS307
01371                                    TO DP013-PARAGRAPH             ETKCS307
01372          MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   ETKCS307
01373                                    TO DP013-MESSAGE-TEXT (1)      ETKCS307
01374          PERFORM DP013-0000-PROCESS-ABEND                         ETKCS307
01375         END-IF                                                    ETKCS307
01376      END-IF.                                                      ETKCS307
01377                                                                   ETKCS307
01378  EJECT                                                            ETKCS307
01379 *----------------------------------------------------------------*ETKCS307
01380 * UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *ETKCS307
01381 *----------------------------------------------------------------*ETKCS307
01382  9200-REWRITE-LIST-QUEUE.                                         ETKCS307
01383                                                                   ETKCS307
01384      EXEC CICS                                                    ETKCS307
01385           WRITEQ TS                                               ETKCS307
01386               QUEUE  (ASC-SEL-QUEUE-NAME)                         ETKCS307
01387               FROM (ET301-SELECTED-VNDRS)                         ETKCS307
01388               ITEM   (ASC-SEL-ITEM)                               ETKCS307
01389               RESP   (PV-CICS-RESPONSE)                           ETKCS307
01390               REWRITE                                             ETKCS307
01391      END-EXEC.                                                    ETKCS307
01392                                                                   ETKCS307
01393      IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               ETKCS307
01394          SET DP013-CICS-ABEND                                     ETKCS307
01395              DP013-NO-ROLLBACK     TO TRUE                        ETKCS307
01396          MOVE '9200-REWRITE-LIST-QUEUE'                           ETKCS307
01397                                    TO DP013-PARAGRAPH             ETKCS307
01398          MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   ETKCS307
01399                                    TO DP013-MESSAGE-TEXT (1)      ETKCS307
01400          PERFORM DP013-0000-PROCESS-ABEND                         ETKCS307
01401      END-IF.                                                      ETKCS307
01402                                                                   ETKCS307
01403 *----------------------------------------------------------------*ETKCS307
01404 *    ABEND PROCESSOR MODULE                                      *ETKCS307
01405 *----------------------------------------------------------------*ETKCS307
01406                                                                   ETKCS307
01407      COPY DPPD013.                                                ETKCS307
