000100 IDENTIFICATION DIVISION.                                         00010010
000200 PROGRAM-ID.    RCKCS234.                                         00020010
000300 AUTHOR.        LOUIE CRISOSTOMO.                                 00030010
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040010
000500 DATE-WRITTEN.  02-17-94.                                         00050010
000600 DATE-COMPILED.                                                   00060010
000700******************************************************************00070010
000800*    E234 - PO HEADER TROUBLE ROUTINE                             00080010
000900*                                                                 00090010
001000*    THIS IS A CALLED ROUTINE USED TO DETERMINE                   00100010
001100*    IF THE PURCHASE ORDER IS IN TROUBLE                          00110010
001200*                                                                 00120010
001300******************************************************************00130010
001400*    CHANGE MADE: GERMAN BANDA     WR#5148B                       00140010
001500*                                                                 00150010
001600*    09/13/2013                                                   00160010
001700*    CHANGE WAS MADE TO CALL THE RFID DETERMINE MODULE WHEN       00170010
001800*    A TROUBLE CODE OF 424 IS FOUND. WHEN DETERMINED RFID A NEW   00180010
001900*    TROUBLE CODE ROW IS CREATED. CHANGES CAN BE FOUND BEGINNING  00190010
002000*    AT 2900-TRBL-424-CHK.                                        00200010
002001*                                                                 00200110
002002******************************************************************00200210
002003*    CHANGE MADE: CHERI PARMLEY    WR#5148D                       00200310
002004*                                                                 00200410
002005*    02/10/2014                                                   00200510
002006*    DO NOT CREATE TROUBLE CODE OF 424 WHEN VENDOR IS TAGGING     00200610
002007*    IN 2920-CHECK-RFID-PO.                                       00200710
002008******************************************************************00200810
002009 ENVIRONMENT DIVISION.                                            00200910
002010 CONFIGURATION SECTION.                                           00201010
002011 SOURCE-COMPUTER.        IBM-3090.                                00201110
002012 OBJECT-COMPUTER.        IBM-3090.                                00201210
002013 DATA DIVISION.                                                   00201310
002014 WORKING-STORAGE SECTION.                                         00201410
002015                                                                  00201510
002016 01  PC-PROGRAM-CONSTANTS.                                        00201610
002017     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00201710
002018                                                COMP SYNC.        00201810
002019     05  PC-101                       PIC S9(4) COMP VALUE +101.  00201910
002020     05  PC-107                       PIC S9(4) COMP VALUE +107.  00202010
002030     05  PC-108                       PIC S9(4) COMP VALUE +108.  00203010
002040     05  PC-379                       PIC S9(4) COMP VALUE +379.  00204010
002050     05  PC-405                       PIC S9(4) COMP VALUE +405.  00205010
002060     05  PC-423                       PIC S9(4) COMP VALUE +423.  00206010
002070     05  PC-424                       PIC S9(4) COMP VALUE +424.  00207010
002080     05  PC-425                       PIC S9(4) COMP VALUE +425.  00208010
002090     05  PC-426                       PIC S9(4) COMP VALUE +426.  00209010
002100     05  PC-501                       PIC S9(4) COMP VALUE +501.  00210010
002200     05  PC-502                       PIC S9(4) COMP VALUE +502.  00220010
002300     05  PC-503                       PIC S9(4) COMP VALUE +503.  00230010
002400     05  PC-504                       PIC S9(4) COMP VALUE +504.  00240010
002500     05  PC-505                       PIC S9(4) COMP VALUE +505.  00250010
002600     05  PC-508                       PIC S9(4) COMP VALUE +508.  00260010
002700     05  PC-509                       PIC S9(4) COMP VALUE +509.  00270010
002800     05  PC-600                       PIC S9(4) COMP VALUE +600.  00280010
002900     05  PC-C                         PIC X(01) VALUE 'C'.        00290010
003000     05  PC-U                         PIC X(01) VALUE 'U'.        00300010
003100     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00310010
003200     05  PC-NO                        PIC X(01) VALUE 'N'.        00320010
003300     05  PC-YES                       PIC X(01) VALUE 'Y'.        00330010
003400     05  PC-PO-LEVEL                  PIC X(01) VALUE 'P'.        00340010
003500     05  PC-TMKCS521                  PIC X(08) VALUE             00350010
003600                                                'TMKCS521'.       00360010
003700     05  PC-RCKCS234                  PIC X(08) VALUE             00370010
003800                                                'RCKCS234'.       00380010
003900     05  PC-DEFAULT-DTE-MIN           PIC X(10) VALUE             00390010
004000                                                '0001-01-01'.     00400010
004100     05  PC-DEFAULT-DTE-MAX           PIC X(10) VALUE             00410010
004200                                                '9999-09-09'.     00420010
004300     05  PC-DEFAULT-TMST              PIC X(26) VALUE             00430010
004400                        '9999-09-09-09.09.09.999999'.             00440010
004500     05  PC-WK                        PIC X(02) VALUE 'WK'.       00450010
004600     05  PC-CM                        PIC X(02) VALUE 'CM'.       00460010
004700     05  PC-CA                        PIC X(02) VALUE 'CA'.       00470010
004800     05  PC-CB                        PIC X(02) VALUE 'CB'.       00480010
004900     05  PC-AC                        PIC X(02) VALUE 'AC'.       00490010
005000     05  PC-AP                        PIC X(02) VALUE 'AP'.       00500010
005100     05  PC-RV                        PIC X(02) VALUE 'RV'.       00510010
005200     05  PC-IE                        PIC X(02) VALUE 'IE'.       00520010
005300     05  PC-IF                        PIC X(02) VALUE 'IF'.       00530010
005400     05  PC-IM                        PIC X(02) VALUE 'IM'.       00540010
005500     05  PC-00                        PIC X(02) VALUE '00'.       00550010
005600     05  PC-01                        PIC X(02) VALUE '01'.       00560010
005700     05  PC-19                        PIC X(02) VALUE '19'.       00570010
005800     05  PC-20                        PIC X(02) VALUE '20'.       00580010
005900     05  PC-50                        PIC X(02) VALUE '50'.       00590010
006000     05  PC-CREATE-AUTO               PIC X(03) VALUE 'CRA'.      00600010
006100     05  PC-EARLY-TEXT.                                           00610010
006200         10  PC-EARLY-TEXT-1.                                     00620010
006300             15  PC-EARLY-TEXT-11     PIC X(32) VALUE             00630010
006400             '             VENDOR SHIP DATE : '.                  00640010
006500             15  PC-EARLY-DATE-11     PIC X(10).                  00650010
006600             15  FILLER               PIC X(08) VALUE SPACES.     00660010
006700         10  PC-EARLY-TEXT-2.                                     00670010
006800             15  PC-EARLY-TEXT-21     PIC X(32) VALUE             00680010
006900             '      DO NOT SHIP BEFORE DATE : '.                  00690010
007000             15  PC-EARLY-DATE-21     PIC X(10).                  00700010
007100             15  FILLER               PIC X(08) VALUE SPACES.     00710010
007200         10  PC-EARLY-TEXT-4.                                     00720010
007300             15  PC-EARLY-TEXT-41     PIC X(32) VALUE             00730010
007400             '                 ARRIVAL DATE : '.                  00740010
007500             15  PC-EARLY-DATE-41     PIC X(10).                  00750010
007600             15  FILLER               PIC X(08) VALUE SPACES.     00760010
007700         10  FILLER                   PIC X(50) VALUE SPACES.     00770010
007800     05  PC-LATE-TEXT.                                            00780010
007900         10  PC-LATE-TEXT-1.                                      00790010
008000             15  PC-LATE-TEXT-11      PIC X(32) VALUE             00800010
008100             '             VENDOR SHIP DATE : '.                  00810010
008200             15  PC-LATE-DATE-11      PIC X(10).                  00820010
008300             15  FILLER               PIC X(08) VALUE SPACES.     00830010
008400         10  PC-LATE-TEXT-2.                                      00840010
008500             15  PC-LATE-TEXT-21      PIC X(32) VALUE             00850010
008600             'CANCEL IF NOT SHIPPED BY DATE : '.                  00860010
008700             15  PC-LATE-DATE-21      PIC X(10).                  00870010
008800             15  FILLER               PIC X(08) VALUE SPACES.     00880010
008900         10  PC-LATE-TEXT-3.                                      00890010
009000             15  PC-LATE-TEXT-31      PIC X(32) VALUE             00900010
009100             '         EXTENDED CANCEL DATE : '.                  00910010
009200             15  PC-LATE-DATE-31      PIC X(10).                  00920010
009300             15  FILLER               PIC X(08) VALUE SPACES.     00930010
009400         10  PC-LATE-TEXT-5.                                      00940010
009500             15  PC-LATE-TEXT-51      PIC X(32) VALUE             00950010
009600             '                 ARRIVAL DATE : '.                  00960010
009700             15  PC-LATE-DATE-51      PIC X(10).                  00970010
009800             15  FILLER               PIC X(08) VALUE SPACES.     00980010
009900     05  PC-TEXT-DATE.                                            00990010
010000         10  PC-TEXT-DATE-MM          PIC X(02).                  01000010
010100         10  FILLER                   PIC X(01) VALUE '/'.        01010010
010200         10  PC-TEXT-DATE-DD          PIC X(02).                  01020010
010300         10  FILLER                   PIC X(01) VALUE '/'.        01030010
010400         10  PC-TEXT-DATE-CCYY        PIC X(04).                  01040010
010500                                                                  01050010
010600                                                                  01060010
010700     05  PS-DONE-SW                   PIC  X    VALUE 'N'.        01070010
010800         88  PS-NOT-DONE                        VALUE 'N'.        01080010
010900         88  PS-DONE                            VALUE 'Y'.        01090010
011000     05  PS-RV-FOUND-SW               PIC  X    VALUE 'N'.        01100010
011100         88  PS-RV-NOT-FOUND                    VALUE 'N'.        01110010
011200         88  PS-RV-FOUND                        VALUE 'Y'.        01120010
011300     05  PS-CREATE-379-405-TRBL-SW    PIC  X    VALUE 'N'.        01130010
011400         88  PS-CREATE-379-405-TRBL             VALUE 'Y'.        01140010
011500     05  PS-CREATE-423-TRBL-SW        PIC  X    VALUE 'N'.        01150010
011600         88  PS-CREATE-423-TRBL                 VALUE 'Y'.        01160010
011700     05  PS-CREATE-424-TRBL-SW        PIC  X    VALUE 'N'.        01170010
011800         88  PS-CREATE-424-TRBL                 VALUE 'Y'.        01180010
011900     05  PS-CREATE-425-TRBL-SW        PIC  X    VALUE 'N'.        01190010
012000         88  PS-CREATE-425-TRBL                 VALUE 'Y'.        01200010
012100     05  PS-CREATE-426-TRBL-SW        PIC  X    VALUE 'N'.        01210010
012200         88  PS-CREATE-426-TRBL                 VALUE 'Y'.        01220010
012300     05  PS-CHECK-PKG-CDE-SW          PIC  X    VALUE 'N'.        01230010
012400         88  PS-CHECK-PKG-CDE                   VALUE 'Y'.        01240010
012500     05  PS-ASNS-TO-WMS-SW        PIC X(01) VALUE 'N'.            01250010
012600         88  PS-ASNS-TO-WMS-YES             VALUE 'Y'.            01260010
012700         88  PS-ASNS-TO-WMS-NO              VALUE 'N'.            01270010
012800*                                                                 01280010
012801*** 6/2/14 - DMH BEGIN                                            01280110
012802*                                                                 01280210
012810     05  PS-CHECK-AUTRB1-SW          PIC X(01) VALUE 'N'.         01281010
012820         88  PS-CHECK-AUTRB1-YES               VALUE 'Y'.         01282010
012830         88  PS-CHECK-AUTRB1-NO                VALUE 'N'.         01283010
012831     05  PS-CHECK-AUTRB2-SW          PIC X(01) VALUE 'N'.         01283110
012832         88  PS-CHECK-AUTRB2-YES               VALUE 'Y'.         01283210
012833         88  PS-CHECK-AUTRB2-NO                VALUE 'N'.         01283310
012834     05  PS-CHECK-AUTRB3-SW          PIC X(01) VALUE 'N'.         01283455
012835         88  PS-CHECK-AUTRB3-YES               VALUE 'Y'.         01283555
012836         88  PS-CHECK-AUTRB3-NO                VALUE 'N'.         01283655
012840     05  PS-CONTINUE-TRBL-CHECK-SW   PIC X(01) VALUE 'N'.         01284010
012841         88  PS-CONTINUE-TRBL-CHECK-YES        VALUE 'Y'.         01284110
012842         88  PS-CONTINUE-TRBL-CHECK-NO         VALUE 'N'.         01284210
012843     05  PS-CREATE-CNTL-FLOW-SW      PIC X(01) VALUE 'N'.         01284311
012844         88  PS-CREATE-CNTL-FLOW-YES           VALUE 'Y'.         01284411
012845         88  PS-CREATE-CNTL-FLOW-NO            VALUE 'N'.         01284511
012852     05  PS-EOF-CNTLFLOW-CSR         PIC X(01) VALUE 'N'.         01285214
012853         88  PS-EOF-CNTLFLOW-CSR-YES           VALUE 'Y'.         01285314
012854         88  PS-EOF-CNTLFLOW-CSR-NO            VALUE 'N'.         01285414
012855*                                                                 01285510
012856*** 6/2/14 - DMH END                                              01285610
012860*                                                                 01286010
012861*                                                                 01286133
012862*** 10/25/14 - DMH END                                            01286233
012863*                                                                 01286333
012864*** 10/16      DMH BEGIN                                          01286435
012865*                                                                 01286535
012866     05  PS-AUTOTR-CRE-CURR-SW        PIC   X(03).                01286635
012867         88  PS-AUTOTR-CRE-OPER                 VALUE 'CRE'.      01286735
012868         88  PS-AUTOTR-CUR-OPER                 VALUE 'CUR'.      01286839
012869         88  PS-AUTOTR-RCV-OPER                 VALUE 'RCV'.      01286940
012870     05  PS-AUTOTRB-OPER-TYPE-SW      PIC   X(01).                01287040
012871         88  PS-AUTOTRB-OPER-DC                 VALUE 'D'.        01287140
012872         88  PS-AUTOTRB-OPER-EFC                VALUE 'E'.        01287240
012873     05  PS-CREATE-DC-EFC-LVL-SW    PIC  X(04)  VALUE SPACES.     01287340
012880         88  PS-CREATE-DC-ONLY                  VALUE 'DC  '.     01288033
012890         88  PS-CREATE-EFC-ONLY                 VALUE 'EFC '.     01289033
012891         88  PS-CREATE-BOTH                     VALUE 'BOTH'.     01289133
012892*                                                                 01289235
012893*** 10/16      DMH END                                            01289335
012894*                                                                 01289435
012900                                                                  01290010
013000 01  DK-DB2-KEYS.                                                 01300010
013100     05  DK-LOCATION-NBR              PIC 9(04)  VALUE ZERO.      01310010
013101*                                                                 01310115
013110     05  DK-PO-NBR                    PIC S9(9) COMP.             01311013
013120     05  DK-CNTL-FLOW-DEPT            PIC  S9(10)V9(5) COMP-3     01312015
013121                                                VALUE ZEROES.     01312115
013130     05  DK-CNTL-FLOW-TRBL-LBL        PIC  S9(10)V9(5) COMP-3     01313015
013131                                                VALUE ZEROES.     01313115
013140     05  DK-CNTL-FLOW-ENT-ID          PIC  S9(10)V9(5) COMP-3     01314015
013141                                                VALUE ZEROES.     01314115
013142     05  DK-CNTL-FLOW-PRO             PIC   X(16)                 01314254
013143                                                VALUE SPACES.     01314354
013150     05  DK-WORK-DEPT                 PIC  S9(10)V9(5) COMP-3     01315015
013151                                                VALUE ZEROES.     01315115
013160     05  DK-WORK-CL                   PIC  S9(10)V9(5) COMP-3     01316015
013161                                                VALUE ZEROES.     01316115
013170     05  DK-WORK-SUBCL                PIC  S9(10)V9(5) COMP-3     01317015
013171                                                VALUE ZEROES.     01317115
013180     05  DK-WORK-SKU                  PIC  S9(10)V9(5) COMP-3     01318015
013181                                                VALUE ZEROES.     01318115
013190     05  DK-WORK-TRBL-CDE             PIC  S9(10)V9(5) COMP-3     01319015
013191                                                VALUE ZEROES.     01319115
013192*                                                                 01319234
013193*** DMH 10/2016 - BEGIN                                           01319334
013194*                                                                 01319434
013195     05  DK-AUTOTRB-OPER              PIC  S9(4) COMP             01319539
013196                                                VALUE ZEROES.     01319639
013197*                                                                 01319734
013198*** DMH 10/2016 - END                                             01319834
013199*                                                                 01319934
013200                                                                  01320010
013300 01  PV-PROGRAM-VARIABLES.                                        01330010
013400     05  PV-ATTR-DEPT                 PIC  S9(10)V9(5) COMP-3.    01340010
013500     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        01350010
013600                                                COMP SYNC.        01360010
013700     05  PV-NUMBER-OF-RV              PIC S9(4) COMP              01370010
013800                                                VALUE +0.         01380010
013900     05  PV-DAYS-NBR                  PIC S9(4) VALUE 0 COMP.     01390010
014000     05  PV-EIBDATE.                                              01400010
014100         10  PV-EIBDATE-N             PIC 9(5).                   01410010
014200         10  FILLER                   PIC X(5).                   01420010
014300                                                                  01430010
014400     05  PV-RTV-SW                    PIC X(01)  VALUE SPACE.     01440010
014500                                                                  01450010
014600**  AHP - BEGIN - 04/08/08                                        01460010
014700     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         01470010
014800                                                 COMP-3.          01480010
014900**  AHP - END   - 04/08/08                                        01490010
015000                                                                  01500010
015100     05  PV-TEMP-TMST.                                            01510010
015200         10  PV-TMST-CCYY             PIC X(04).                  01520010
015300         10  FILLER                   PIC X(01).                  01530010
015400         10  PV-TMST-MM               PIC X(02).                  01540010
015500         10  FILLER                   PIC X(01).                  01550010
015600         10  PV-TMST-DD               PIC X(02).                  01560010
015700         10  FILLER                   PIC X(16).                  01570010
015800     05  PV-TEMP-DATE.                                            01580010
015900         10  PV-DATE-CCYY             PIC X(04).                  01590010
016000         10  FILLER                   PIC X(01).                  01600010
016100         10  PV-DATE-MM               PIC X(02).                  01610010
016200         10  FILLER                   PIC X(01).                  01620010
016300         10  PV-DATE-DD               PIC X(02).                  01630010
016400     05  PV-TEMP-YYMM.                                            01640010
016500         10  PV-TEMP-YY               PIC X(02).                  01650010
016600         10  PV-TEMP-MM               PIC X(02).                  01660010
016700     05  PV-VEND-SHIP-DTE.                                        01670010
016800         10  PV-VEND-SHIP-CCYY        PIC X(04).                  01680010
016900         10  PV-VEND-SHIP-MM          PIC X(02).                  01690010
017000         10  PV-VEND-SHIP-DD          PIC X(02).                  01700010
017100     05  PV-DONT-SHIP-BEF-DTE.                                    01710010
017200         10  PV-DONT-SHIP-CCYY        PIC X(04).                  01720010
017300         10  PV-DONT-SHIP-MM          PIC X(02).                  01730010
017400         10  PV-DONT-SHIP-DD          PIC X(02).                  01740010
017500     05  PV-CAN-IFNOT-SHIP-DTE.                                   01750010
017600         10  PV-CAN-IFNOT-CCYY        PIC X(04).                  01760010
017700         10  PV-CAN-IFNOT-MM          PIC X(02).                  01770010
017800         10  PV-CAN-IFNOT-DD          PIC X(02).                  01780010
017900     05  PV-EXT-CAN-DTE.                                          01790010
018000         10  PV-EXT-CAN-CCYY          PIC X(04).                  01800010
018100         10  PV-EXT-CAN-MM            PIC X(02).                  01810010
018200         10  PV-EXT-CAN-DD            PIC X(02).                  01820010
018300     05  PV-SHIPT-ERL-DAYS-NBR.                                   01830010
018400         10  PV-SHIPT-ERL-DAYS-CCYY   PIC X(04).                  01840010
018500         10  PV-SHIPT-ERL-DAYS-MM     PIC X(02).                  01850010
018600         10  PV-SHIPT-ERL-DAYS-DD     PIC X(02).                  01860010
018700     05  PV-SHIPT-LTE-DAYS-NBR.                                   01870010
018800         10  PV-SHIPT-LTE-DAYS-CCYY   PIC X(04).                  01880010
018900         10  PV-SHIPT-LTE-DAYS-MM     PIC X(02).                  01890010
019000         10  PV-SHIPT-LTE-DAYS-DD     PIC X(02).                  01900010
019100     05  PV-CAN-DATE.                                             01910010
019200         10  PV-CAN-CCYY              PIC X(04).                  01920010
019300         10  PV-CAN-MM                PIC X(02).                  01930010
019400         10  PV-CAN-DD                PIC X(02).                  01940010
019500     05  PV-REC-TMST.                                             01950010
019600         10  PV-REC-TMST-CCYYMM.                                  01960010
019700             15  PV-REC-TMST-CCYY         PIC X(04).              01970010
019800             15  PV-REC-TMST-MM           PIC X(02).              01980010
019900         10  PV-REC-TMST-DD           PIC X(02).                  01990010
020000                                                                  02000010
020100     05  PV-OP.                                                   02010010
020200         10  PV-OP-N                  PIC 9(4).                   02020010
020300     05  PV-FCLTY.                                                02030010
020400         10  PV-FCLTY-N               PIC 9.                      02040010
020500     05  PV-PO.                                                   02050010
020600         10  PV-PO-N                  PIC 9(8).                   02060010
020700     05  PV-LINE.                                                 02070010
020800         10  PV-LINE-N                PIC 999.                    02080010
020900     05  PV-REC-SEQ-NBR.                                          02090010
021000         10  PV-REC-SEQ-NBR-N         PIC 999.                    02100010
021100     05  PV-TRBL-RSN-CDE              PIC S9(4) COMP VALUE ZERO.  02110010
021200     05  PV-OPER-UNT-E                PIC X.                      02120010
021300         88  PV-OPER-UNT-ECOM                  VALUE 'Y'.         02130010
021400     05  PV-CRE-OPER-UNT-E            PIC X.                      02140010
021500         88  PV-CRE-OPER-UNT-ECOM              VALUE 'Y'.         02150010
021600     05  PV-CURR-OPER-UNT-E           PIC X.                      02160010
021700         88  PV-CURR-OPER-UNT-ECOM             VALUE 'Y'.         02170010
021710*                                                                 02171011
021720*** 6/2/14 - DMH END                                              02172011
021730*                                                                 02173011
021810     05  PV-CNTL-FLOW-DEPT            PIC 9(04) VALUE ZEROES.     02181011
021820     05  PV-CNTL-FLOW-TRBL-LBL        PIC  S9(10)V9(5) COMP-3     02182016
021821                                                VALUE ZEROES.     02182116
021822     05  PV-CNTL-FLOW-ENT-ID          PIC 9(09) VALUE ZEROES.     02182216
021823     05  PV-CNTL-FLOW-PRO             PIC X(16) VALUE SPACES.     02182354
021824     05  PV-WORK-DEPT                 PIC 9(04) VALUE ZEROES.     02182454
021825     05  PV-WORK-CL                   PIC 9(04) VALUE ZEROES.     02182554
021826     05  PV-WORK-SUBCL                PIC 9(04) VALUE ZEROES.     02182654
021827     05  PV-WORK-SKU                  PIC 9(08) VALUE ZEROES.     02182754
021828     05  PV-WORK-TRBL-CDE             PIC 9(04) VALUE ZEROES.     02182854
021829     05  PV-DISP-FLOW-TRBL-LBL        PIC 9(04) VALUE ZEROES.     02182954
021830                                                                  02183054
021831     05  PV-CICS-MSG-AREA             PIC X(100) VALUE SPACES.    02183154
021832     05  PV-DISP-OPER                 PIC ZZZ9   VALUE ZEROES.    02183254
021833     05  PV-DISP-RCV-OPER             PIC ZZZ9   VALUE ZEROES.    02183354
021834     05  PV-DISP-CRE-OPER             PIC ZZZ9   VALUE ZEROES.    02183454
021835     05  PV-DISP-CUR-OPER             PIC ZZZ9   VALUE ZEROES.    02183554
021836     05  PV-DISP-TM500-OPER           PIC ZZZ9   VALUE ZEROES.    02183654
021837     05  PV-DISP-TM500-FCLTY          PIC ZZZ9   VALUE ZEROES.    02183754
021838     05  PV-DISP-PO                   PIC 9(09)  VALUE ZEROES.    02183854
021839     05  PV-DISP-RCVR                 PIC 9(04)  VALUE ZEROES.    02183954
021840     05  PV-DISP-LINE                 PIC 9(04)  VALUE ZEROES.    02184054
021841     05  PV-DISP-SQL                  PIC -999   VALUE ZEROES.    02184162
021842     05  PV-DISP-CNTL-FLOW-TRBL       PIC Z(9).99999.             02184262
021843     05  PV-DISP-DK-WORK-TRBL-CDE     PIC 9(04)  VALUE ZEROES.    02184362
021844     05  PV-COMMAREA-LENGTH           PIC S9(04) VALUE +0         02184462
021845                                                 COMP SYNC.       02184562
021846     05  PV-CICS-RESP                 PIC S9(04) VALUE +0         02184662
021847                                                 COMP SYNC.       02184762
021848*                                                                 02184862
021849*** 6/2/14 - DMH END                                              02184962
021850*                                                                 02185062
021851*** 10/16  - DMH BEGIN                                            02185162
021852*                                                                 02185262
021853     05  PV-RCVR-OPER-TYPE            PIC  X(01) VALUE SPACE.     02185362
021854         88 PV-RCVR-OPER-DC                      VALUE 'N'.       02185462
021855         88 PV-RCVR-OPER-EFC                     VALUE 'Y'.       02185562
021856     05  PV-CRE-OPER-TYPE             PIC  X(01) VALUE SPACE.     02185662
021857         88 PV-CRE-OPER-DC                       VALUE 'N'.       02185762
021858         88 PV-CRE-OPER-EFC                      VALUE 'Y'.       02185862
021859     05  PV-CURR-OPER-TYPE            PIC  X(01) VALUE SPACE.     02185962
021860         88 PV-CURR-OPER-DC                      VALUE 'N'.       02186062
021861         88 PV-CURR-OPER-EFC                     VALUE 'Y'.       02186162
021862*                                                                 02186262
021863*** 10/16  - DMH END                                              02186362
021864*                                                                 02186462
021865                                                                  02186562
021870                                                                  02187043
021900 01  PRV-PROGRAM-RETURN-VARIABLES.                                02190010
022000     05  PRV-00                       PIC X(42) VALUE             02200010
022100         '00PROGRAM CALL WAS SUCCESSFUL             '.            02210010
022200     05  PRV-02                       PIC X(42) VALUE             02220010
022300         '02SHIPPING WINDOW ERROR                   '.            02230010
022400     05  PRV-1A                       PIC X(42) VALUE             02240010
022500         '1ARECORD NOT FOUND - TPURCHS SELECT       '.            02250010
022600     05  PRV-1B                       PIC X(42) VALUE             02260010
022700         '1BDB2-ERROR - TPURCHS SELECT              '.            02270010
022800     05  PRV-1C                       PIC X(42) VALUE             02280010
022900         '1CDB2-ERROR - TPLNSHP SELECT              '.            02290010
023000     05  PRV-1D                       PIC X(42) VALUE             02300010
023100         '1DDB2-ERROR - TCOCNTL SELECT              '.            02310010
023200     05  PRV-1E                       PIC X(42) VALUE             02320010
023300         '1EDB2-ERROR - TRECEIV SELECT              '.            02330010
023400     05  PRV-1F                       PIC X(42) VALUE             02340010
023500         '1FDB2-ERROR - XLT_LOC OR XLT_DC_LOC_ASGMT '.            02350010
023600     05  PRV-1G                       PIC X(42) VALUE             02360010
023700         '1GDB2-ERROR - TKRPRPM OPEN CURSOR         '.            02370010
023800     05  PRV-1H                       PIC X(42) VALUE             02380010
023900         '1HDB2-ERROR - TKRPRPM FETCH               '.            02390010
023910     05  PRV-1I                       PIC X(42) VALUE             02391010
023920         '1HDB2-ERROR - TKRPRPM SELECT              '.            02392010
023930     05  PRV-1J                       PIC X(42) VALUE             02393011
023940         '1HDB2-ERROR - WST INTEGRATION PARM SELECT '.            02394011
023950     05  PRV-1K                       PIC X(42) VALUE             02395013
023960         '1HDB2-ERROR - DEPT-CL-SUB CURSOR          '.            02396013
024000     05  PRV-TM500-RETURN-MSG.                                    02400010
024100         10  PRV-PGM                  PIC X(3).                   02410010
024200         10  FILLER                   PIC X(1).                   02420010
024300         10  PRV-PARA                 PIC X(4).                   02430010
024400         10  FILLER                   PIC X(1).                   02440010
024500         10  PRV-TBL                  PIC X(7).                   02450010
024600         10  FILLER                   PIC X(1).                   02460010
024700         10  PRV-OP                   PIC X(4).                   02470010
024800         10  FILLER                   PIC X(1).                   02480010
024900         10  PRV-FCLTY                PIC X(1).                   02490010
025000         10  FILLER                   PIC X(1).                   02500010
025100         10  PRV-PO                   PIC X(8).                   02510010
025200         10  FILLER                   PIC X(1).                   02520010
025300         10  PRV-LINE                 PIC X(3).                   02530010
025400         10  FILLER                   PIC X(1).                   02540010
025500         10  PRV-REC-SEQ-NBR          PIC X(3).                   02550010
025600                                                                  02560010
025700******************************************************************02570010
025800*    TROUBLE MANAGEMENT COPYBOOK AREA                             02580010
025900******************************************************************02590010
026000     COPY TMWS500.                                                02600010
026100                                                                  02610010
026200******************************************************************02620010
026300*    DATE CONVERSION COPYBOOK AREA                                02630010
026400******************************************************************02640010
026500     COPY DPWS500.                                                02650010
026600                                                                  02660010
026700******************************************************************02670010
026800* LOCATION MASTER INFORMATION - CALLED MODULE PARAMETERS          02680010
026900******************************************************************02690010
027000     COPY XLWS071.                                                02700010
027100*                                                                 02710010
027200******************************************************************02720010
027300******************************************************************02730010
027400* RFID CALLED MODULE COPYBOOK                                     02740010
027500******************************************************************02750010
027600     COPY SUWS093.                                                02760010
027700*                                                                 02770010
027800******************************************************************02780010
027900*    DB2 SQL COMMUNICATION AREA                                   02790010
028000******************************************************************02800010
028100     EXEC SQL                                                     02810010
028200          INCLUDE SQLCA                                           02820010
028300     END-EXEC.                                                    02830010
028400                                                                  02840010
028500******************************************************************02850010
028600*    DB2 DCLGEN FOR COMPANY CONTROL TABLE                         02860010
028700******************************************************************02870010
028800     EXEC SQL                                                     02880010
028900          INCLUDE TCOCNTL                                         02890010
029000     END-EXEC.                                                    02900010
029100                                                                  02910010
029200******************************************************************02920010
029300*    DB2 DCLGEN FOR PURCHASE TABLE                                02930010
029400******************************************************************02940010
029500     EXEC SQL                                                     02950010
029600          INCLUDE TPURCHS                                         02960010
029700     END-EXEC.                                                    02970010
029800                                                                  02980010
029900******************************************************************02990010
030000*    DB2 DCLGEN FOR RECEIVER TABLE                                03000010
030100******************************************************************03010010
030200     EXEC SQL                                                     03020010
030300          INCLUDE TRECEIV                                         03030010
030400     END-EXEC.                                                    03040010
030500                                                                  03050010
030600******************************************************************03060010
030700*    DB2 DCLGEN FOR PLANNED SHIPMENT TABLE                        03070010
030800******************************************************************03080010
030900     EXEC SQL                                                     03090010
031000          INCLUDE TPLNSHP                                         03100010
031100     END-EXEC.                                                    03110010
031200                                                                  03120010
031300******************************************************************03130010
031400*    DB2 DCLGEN FOR PURCHASE ITEM TABLE                           03140010
031500******************************************************************03150010
031600     EXEC SQL                                                     03160010
031700          INCLUDE TPURITM                                         03170010
031800     END-EXEC.                                                    03180010
031900                                                                  03190010
032000******************************************************************03200010
032100*    DB2 DCLGEN FOR KOHLS TO RETEK PROCESSING PARAMETERS          03210010
032200******************************************************************03220010
032300     EXEC SQL                                                     03230010
032400          INCLUDE TKRPRPM                                         03240010
032500     END-EXEC.                                                    03250010
032600                                                                  03260010
032700******************************************************************03270010
032800*  SQL AND COBOL DECLARATIONS FOR WST_INTGRTN_TYP                 03280010
032900******************************************************************03290010
033000     EXEC SQL                                                     03300010
033100          INCLUDE WST00008                                        03310010
033200     END-EXEC.                                                    03320010
033300******************************************************************03330010
033400*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_DEFN                   03340010
033500******************************************************************03350010
033600     EXEC SQL                                                     03360010
033700          INCLUDE WST00009                                        03370010
033800     END-EXEC.                                                    03380010
033900******************************************************************03390010
034000*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_ELEM                   03400010
034100******************************************************************03410010
034200     EXEC SQL                                                     03420010
034300          INCLUDE WST00010                                        03430010
034400     END-EXEC.                                                    03440010
034500                                                                  03450010
034600******************************************************************03460010
034700*  SQL AND COBOL DECLARATIONS FOR SEASONAL SET TABLE              03470010
034800******************************************************************03480010
034900     EXEC SQL                                                     03490010
035000          INCLUDE TSEASET                                         03500010
035100     END-EXEC.                                                    03510010
035101                                                                  03510113
035102******************************************************************03510213
035103*  SQL AND COBOL DECLARATIONS FOR XLT_SKU                         03510313
035104******************************************************************03510413
035105     EXEC SQL                                                     03510513
035106          INCLUDE XLT00003                                        03510613
035107     END-EXEC.                                                    03510713
035108                                                                  03510813
035109******************************************************************03510913
035110*  SQL AND COBOL DECLARATIONS FOR XLT_VND_STYL                    03511013
035111******************************************************************03511113
035112     EXEC SQL                                                     03511213
035113          INCLUDE XLT00004                                        03511313
035114     END-EXEC.                                                    03511413
035115                                                                  03511513
035116******************************************************************03511637
035117*  SQL AND COBOL DECLARATIONS FOR XLT_LOC                         03511737
035118******************************************************************03511837
035119     EXEC SQL                                                     03511937
035120          INCLUDE XLT00010                                        03512037
035130     END-EXEC.                                                    03513037
035140                                                                  03514037
035150******************************************************************03515056
035160*    DB2 DCLGEN FOR PACKSLIP TABLE                                03516056
035170******************************************************************03517056
035180     EXEC SQL                                                     03518056
035190          INCLUDE TPKSLIP                                         03519056
035200     END-EXEC.                                                    03520056
035300                                                                  03530056
035304******************************************************************03530414
035305* CONTROL FLOW - TROUBLE REASON CODE CURSOR                      *03530514
035306* DMH 6/2/14                                                     *03530614
035307* ADDED PARM 3 - DC (CREATE FOR DC)  EFC (CREATE FOR EFC)        *03530733
035308*                BOTH (CREATE TROUBLE FOR BOTH EFC & DC)         *03530833
035309******************************************************************03530933
035310     EXEC SQL                                                     03531033
035311          DECLARE CNTLFLOW_TROUBLE_CSR CURSOR FOR                 03531133
035312           SELECT                                                 03531233
035313                  D.ATTR_ELEM_NBR AS TROUBLE_CODE                 03531333
035314                , E.ATTR_ELEM_TXT AS CREATE_TYPE                  03531433
035315             FROM WST_INTGRTN_TYP A                               03531533
035316                , WST_ATTR_DEFN           B                       03531633
035317                , WST_ATTR_ELEM           C                       03531733
035318                , WST_ATTR_ELEM           D                       03531833
035319                , WST_ATTR_ELEM           E                       03531933
035320            WHERE A.INTGRTN_TYP_CDE    =  'CNTLFLOW'              03532033
035321              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         03532133
035322              AND B.ATTR_DEFN_SEQ_NBR = 1                         03532233
035323              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         03532333
035324              AND C.ATTR_DEFN_SEQ_NBR = 1                         03532433
035325              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         03532533
035326              AND D.ATTR_DEFN_SEQ_NBR = 2                         03532633
035327              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         03532733
035328              AND E.ATTR_DEFN_SEQ_NBR = 3                         03532833
035329              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       03532933
035330              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       03533033
035331              AND C.ATTR_ELEM_NBR     = :DK-CNTL-FLOW-TRBL-LBL    03533133
035332     END-EXEC.                                                    03533233
035333                                                                  03533333
035334                                                                  03533433
035335                                                                  03533533
035340/                                                                 03534033
035400 LINKAGE SECTION.                                                 03540010
035500                                                                  03550010
035600 01  DFHCOMMAREA.                                                 03560010
035700     05  FILLER                       OCCURS 1 TO 600  TIMES      03570010
035800                                      DEPENDING ON EIBCALEN.      03580010
035900         10  FILLER                   PIC X.                      03590010
036000                                                                  03600010
036100/                                                                 03610010
036200 PROCEDURE DIVISION.                                              03620010
036300                                                                  03630010
036400 0000-MAIN-MODULE.                                                03640010
036500                                                                  03650010
036600     PERFORM 1000-INITIAL-PROCESS.                                03660010
036700                                                                  03670010
036800     IF PS-NOT-DONE                                               03680010
036900         PERFORM 2000-MAIN-PROCESS                                03690010
037000         IF TM500-REC-SEQ-NBR > 0                                 03700010
037100             SET PS-NOT-DONE  TO TRUE                             03710010
037200             PERFORM 2500-TRBL-379-405-CHK                        03720010
037310*                                                                 03731010
037320*DMH 6/2/14 BEGIN                                                 03732010
037321*                                                                 03732111
037330             SET PS-NOT-DONE  TO TRUE                             03733011
037331*                                                                 03733135
037340* DMH 10/16 BEGIN                                                 03734035
037341            PERFORM 2620-CHECK-AUTO-TRBL-OPER                     03734135
037342            IF  PS-AUTOTR-CRE-OPER                                03734239
037343                MOVE  RECEIV-CRE-OPER-UNT-ID                      03734335
037344                  TO  DK-AUTOTRB-OPER                             03734435
037345            ELSE                                                  03734535
037346            IF  PS-AUTOTR-CUR-OPER                                03734640
037347                MOVE  RECEIV-CURR-OPER-UNT-ID                     03734735
037348                  TO  DK-AUTOTRB-OPER                             03734835
037350            ELSE                                                  03735040
037352                MOVE  RECEIV-OPER-UNT-ID                          03735240
037353                  TO  DK-AUTOTRB-OPER                             03735340
037354            END-IF                                                03735440
037355            END-IF                                                03735540
037356* DMH 10/16 END                                                   03735635
037360*                                                                 03736035
037410             PERFORM 2625-DETERMINE-TRBL-CHECK                    03741010
037411             PERFORM 2630-CNTL-FLOW-TRBL-PROCESSING               03741110
037412*DMH 6/2/14 END                                                   03741210
037420*                                                                 03742010
037500             SET PS-NOT-DONE  TO TRUE                             03750010
037600             PERFORM 2700-TRBL-426-CHK                            03760010
037700             SET PS-NOT-DONE  TO TRUE                             03770010
037800             PERFORM 2800-TRBL-423-CHK                            03780010
037900             IF PV-OPER-UNT-ECOM     OR                           03790010
038000                PV-CRE-OPER-UNT-ECOM OR                           03800010
038100                PV-CURR-OPER-UNT-ECOM                             03810010
038200                 CONTINUE                                         03820010
038300             ELSE                                                 03830010
038400                SET PS-NOT-DONE  TO TRUE                          03840010
038500                PERFORM 2900-TRBL-424-CHK                         03850010
038600             END-IF                                               03860010
038700         END-IF                                                   03870010
038800     END-IF.                                                      03880010
038900                                                                  03890010
039000     MOVE TM500-FIELDS TO DFHCOMMAREA.                            03900010
039100                                                                  03910010
039200     GOBACK.                                                      03920010
039300                                                                  03930010
039400                                                                  03940010
039500 1000-INITIAL-PROCESS.                                            03950010
039600******************************************************************03960010
039700*    THIS PARAGRAPH INITIALIZES THE TMWS500 COPYBOOK.             03970010
039800******************************************************************03980010
039900                                                                  03990010
040000     INITIALIZE TM500-FIELDS.                                     04000010
040100                                                                  04010010
040200     IF EIBCALEN = 0                                              04020010
040300         SET PS-DONE          TO TRUE                             04030010
040400     ELSE                                                         04040010
040500         MOVE DFHCOMMAREA     TO TM500-FIELDS                     04050010
040600         MOVE PRV-00          TO TM500-RETURN-DATA                04060010
040700         SET TM500-NO-TROUBLE TO TRUE                             04070010
040800     END-IF.                                                      04080010
040900                                                                  04090010
041000                                                                  04100010
041100 2000-MAIN-PROCESS.                                               04110010
041200******************************************************************04120010
041300*    THIS PARAGRAPH VALIDATES THE PO AND CHECKS FOR EARLY/LATE    04130010
041400*    TROUBLE.                                                     04140010
041500*    THE EARLY/LATE TROUBLE PARAGRAPH IS PERFORMED UNDER THESE    04150010
041600*    CONDITIONS:                                                  04160010
041700*    1) THE PO HAS AN APPROVED OR ACTIVE STATUS.                  04170010
041800*    2) A LATE IS BEING RESOLVED WITH RTV = 'N' (FROM TMKCS505)   04180010
041900*       AND THE PO IS NOW CANCELLED OR COMPLETE.                  04190010
042000*    3) A PO CANCELLED OR COMPLETE IS BEING RESOLVED AND THE      04200010
042100*       WINDOW HAS CHANGED.                                       04210010
042200******************************************************************04220010
042300                                                                  04230010
042400                                                                  04240010
042500     IF TM500-REC-SEQ-NBR > 0                                     04250010
042600         PERFORM 2100-VALIDATE-PO                                 04260010
042700                                                                  04270010
042800         IF PS-NOT-DONE                                           04280010
042900             AND ((PURCHS-STATUS-CDE = PC-AP OR PC-AC)            04290010
043000                   OR ((PURCHS-STATUS-CDE = PC-CA OR PC-CM)       04300010
043100                        AND TM500-RESOLVE-AUTO))                  04310010
043200             AND                                                  04320010
043300            (TM500-VEND-SHIP-DTE > PC-DEFAULT-DTE-MIN)            04330010
043400             AND                                                  04340010
043500            (TM500-VEND-SHIP-DTE < PC-DEFAULT-DTE-MAX)            04350010
043600             PERFORM 2200-EARLY-OR-LATE-TROUBLE                   04360010
043700         END-IF                                                   04370010
043800     END-IF.                                                      04380010
043900                                                                  04390010
044000                                                                  04400010
044100 2100-VALIDATE-PO.                                                04410010
044200******************************************************************04420010
044300*    THIS PARAGRAPH CALLS PARAGRAPH 2110 TO RETRIEVE THE STATUS   04430010
044400*    OF THE PO IN THE TTURCHS TABLE.  THEN IT CALLS PARAGRAPH 212004440010
044500*    TO CHECK THE PO STATUS FOR TROUBLE.                          04450010
044600* AUG. 2004 - ADDED DEPT TO THE SELECT IN 2110 FOR THE NEW        04460010
044700*             425 TROUBLE CHECK IN PARAGRAPH 2600.                04470010
044800******************************************************************04480010
044900                                                                  04490010
045000     PERFORM 2110-GET-TPURCHS.                                    04500010
045100                                                                  04510010
045200     IF PS-NOT-DONE                                               04520010
045300         PERFORM 2120-CHECK-STATUS-CDE                            04530010
045400         PERFORM 2130-CHECK-PACK-CDE-CHANGE                       04540010
045500         PERFORM 2140-CHECK-FLOWBACK-CDE                          04550010
045600     END-IF.                                                      04560010
045700                                                                  04570010
045800                                                                  04580010
045900 2110-GET-TPURCHS.                                                04590010
046000******************************************************************04600010
046100*    THIS RETRIEVES THE STATUS CODE, TYPE, AND DEPT.              04610010
046110*DMH - 6/2/14  ADDED SELECTION OF ENT_ID NEEDED FOR CONTROLLED    04611012
046120*              FLOW TROUBLE CHECK                                 04612012
046200******************************************************************04620010
046300                                                                  04630010
046400     PERFORM WITH TEST AFTER                                      04640010
046500         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    04650010
046600         UNTIL   SQLCODE = +0 OR                                  04660010
046700                 SQLCODE = +100 OR                                04670010
046800                 PS-DONE OR                                       04680010
046900                 PV-RETRY-COUNTER > PC-MAX-RETRIES                04690010
047000                                                                  04700010
047100         EXEC SQL                                                 04710010
047200              SELECT PO_TYP_CDE                                   04720010
047300                    ,DEPT_NBR                                     04730010
047400                    ,STATUS_CDE                                   04740010
047500                    ,PKGNG_CDE                                    04750010
047510                    ,ENT_ID                                       04751010
047600                INTO :PURCHS-PO-TYP-CDE                           04760010
047700                    ,:PURCHS-DEPT-NBR                             04770010
047800                    ,:PURCHS-STATUS-CDE                           04780010
047900                    ,:PURCHS-PKGNG-CDE                            04790010
047910                    ,:PURCHS-ENT-ID                               04791010
048000                FROM TPURCHS                                      04800010
048100               WHERE PO_NBR         = :TM500-PO-NBR               04810010
048200                 AND VER_STATUS_CDE = :PC-ACTIVE                  04820010
048300         END-EXEC                                                 04830010
048400                                                                  04840010
048500         EVALUATE TRUE                                            04850010
048600             WHEN SQLCODE = +0                                    04860010
048700                  CONTINUE                                        04870010
048800                                                                  04880010
048900             WHEN SQLCODE = +100                                  04890010
049000                  SET PS-DONE  TO TRUE                            04900010
049100                  MOVE SPACES  TO TM500-SQLCA                     04910010
049200                  MOVE ZEROES  TO TM500-SQLCODE                   04920010
049300                  MOVE PRV-1A  TO TM500-RETURN-DATA               04930010
049400                                                                  04940010
049500                  MOVE PC-C    TO TM500-CRUD-IND                  04950010
049600                  MOVE PC-101  TO TM500-TRBL-RSN-CDE              04960010
049700                  PERFORM 3000-CREATE-TROUBLE-RECORD              04970010
049800                                                                  04980010
049900                  SET TM500-IN-TROUBLE TO TRUE                    04990010
050000                                                                  05000010
050100             WHEN SQLCODE = -904                                  05010010
050200             WHEN SQLCODE = -911                                  05020010
050300             WHEN SQLCODE = -913                                  05030010
050400                  CONTINUE                                        05040010
050500                                                                  05050010
050600             WHEN OTHER                                           05060010
050700                  SET  PS-DONE TO TRUE                            05070010
050800                  MOVE SQLCA   TO TM500-SQLCA                     05080010
050900                  MOVE SQLCODE TO TM500-SQLCODE                   05090010
051000                  MOVE PRV-1B  TO TM500-RETURN-DATA               05100010
051100                                                                  05110010
051200                  MOVE SPACES    TO PRV-TM500-RETURN-MSG          05120010
051300                  MOVE '2110'    TO PRV-PARA                      05130010
051400                  MOVE 'TPURCHS' TO PRV-TBL                       05140010
051500                  PERFORM 9999-RETURN-MSG                         05150010
051600         END-EVALUATE                                             05160010
051700     END-PERFORM.                                                 05170010
051800                                                                  05180010
051900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         05190010
052000         SET  PS-DONE TO TRUE                                     05200010
052100         MOVE SQLCA   TO TM500-SQLCA                              05210010
052200         MOVE SQLCODE TO TM500-SQLCODE                            05220010
052300         MOVE PRV-1B  TO TM500-RETURN-DATA                        05230010
052400                                                                  05240010
052500         MOVE SPACES    TO PRV-TM500-RETURN-MSG                   05250010
052600         MOVE '2110'    TO PRV-PARA                               05260010
052700         MOVE 'TPURCHS' TO PRV-TBL                                05270010
052800         PERFORM 9999-RETURN-MSG                                  05280010
052900     END-IF.                                                      05290010
053000                                                                  05300010
053100                                                                  05310010
053200 2120-CHECK-STATUS-CDE.                                           05320010
053300******************************************************************05330010
053400*    THIS PARAGRAPH VALIDATES THE STATUS OF A GIVEN PO.  IF       05340010
053500*    THE PO IS VALID, IT CALLS PARAGRAPH 3000 TO RESOLVE ANY      05350010
053600*    UNRESOLVED PO STATUS TROUBLE.  IF THE PO IS INVALID, IT      05360010
053700*    CALLS PARAGRAPH 3000 TO CREATE PO STATUS TROUBLE.            05370010
053800******************************************************************05380010
053900                                                                  05390010
054000     MOVE TM500-TRBL-RSN-CDE TO PV-TRBL-RSN-CDE                   05400010
054100     IF TM500-RESOLVE-AUTO                                        05410010
054200         MOVE PC-U   TO TM500-CRUD-IND                            05420010
054300         MOVE PC-101 TO TM500-TRBL-RSN-CDE                        05430010
054400         PERFORM 3000-CREATE-TROUBLE-RECORD                       05440010
054500     END-IF.                                                      05450010
054600     IF TM500-RESOLVE-SPECIFIC                                    05460010
054700         MOVE PC-U   TO TM500-CRUD-IND                            05470010
054800         PERFORM 3000-CREATE-TROUBLE-RECORD                       05480010
054900     END-IF.                                                      05490010
055000                                                                  05500010
055100     IF PS-NOT-DONE                                               05510010
055200         EVALUATE TRUE                                            05520010
055300             WHEN PURCHS-STATUS-CDE = PC-AC                       05530010
055400             WHEN PURCHS-STATUS-CDE = PC-AP                       05540010
055500                  IF TM500-RESOLVE-AUTO                           05550010
055600                      MOVE PC-U   TO TM500-CRUD-IND               05560010
055700                      MOVE PC-108 TO TM500-TRBL-RSN-CDE           05570010
055800* PO IN WORKSHEET STATUS                                          05580010
055900                      PERFORM 3000-CREATE-TROUBLE-RECORD          05590010
056000                  END-IF                                          05600010
056100                                                                  05610010
056200                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           05620010
056300                      MOVE PC-U   TO TM500-CRUD-IND               05630010
056400                      MOVE PC-504 TO TM500-TRBL-RSN-CDE           05640010
056500* PO COMPLETE                                                     05650010
056600                      PERFORM 3000-CREATE-TROUBLE-RECORD          05660010
056700                  END-IF                                          05670010
056800                                                                  05680010
056900                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           05690010
057000                      MOVE PC-U   TO TM500-CRUD-IND               05700010
057100                      MOVE PC-503 TO TM500-TRBL-RSN-CDE           05710010
057200* PO CANCELLED                                                    05720010
057300                      PERFORM 3000-CREATE-TROUBLE-RECORD          05730010
057400                  END-IF                                          05740010
057500                                                                  05750010
057600                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           05760010
057700                      MOVE PC-U   TO TM500-CRUD-IND               05770010
057800                      MOVE PC-107 TO TM500-TRBL-RSN-CDE           05780010
057900* PO NOT APPROVED                                                 05790010
058000                      PERFORM 3000-CREATE-TROUBLE-RECORD          05800010
058100                  END-IF                                          05810010
058200                                                                  05820010
058300             WHEN PURCHS-STATUS-CDE = PC-WK                       05830010
058400                  MOVE PC-C   TO TM500-CRUD-IND                   05840010
058500                  MOVE PC-108 TO TM500-TRBL-RSN-CDE               05850010
058600                  PERFORM 3000-CREATE-TROUBLE-RECORD              05860010
058700                                                                  05870010
058800                  SET TM500-IN-TROUBLE TO TRUE                    05880010
058900                                                                  05890010
059000                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           05900010
059100                      MOVE PC-U   TO TM500-CRUD-IND               05910010
059200                      MOVE PC-504 TO TM500-TRBL-RSN-CDE           05920010
059300                      PERFORM 3000-CREATE-TROUBLE-RECORD          05930010
059400                  END-IF                                          05940010
059500                                                                  05950010
059600                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           05960010
059700                      MOVE PC-U   TO TM500-CRUD-IND               05970010
059800                      MOVE PC-503 TO TM500-TRBL-RSN-CDE           05980010
059900                      PERFORM 3000-CREATE-TROUBLE-RECORD          05990010
060000                  END-IF                                          06000010
060100                                                                  06010010
060200                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06020010
060300                      MOVE PC-U   TO TM500-CRUD-IND               06030010
060400                      MOVE PC-107 TO TM500-TRBL-RSN-CDE           06040010
060500                      PERFORM 3000-CREATE-TROUBLE-RECORD          06050010
060600                  END-IF                                          06060010
060700                                                                  06070010
060800             WHEN PURCHS-STATUS-CDE = PC-CM                       06080010
060900                  MOVE PC-C   TO TM500-CRUD-IND                   06090010
061000                  MOVE PC-504 TO TM500-TRBL-RSN-CDE               06100010
061100                  MOVE TM500-RTV-SW TO PV-RTV-SW                  06110010
061200                  MOVE SPACES       TO TM500-RTV-SW               06120010
061300                  PERFORM 3000-CREATE-TROUBLE-RECORD              06130010
061400                  MOVE PV-RTV-SW TO TM500-RTV-SW                  06140010
061500                                                                  06150010
061600                  SET TM500-IN-TROUBLE TO TRUE                    06160010
061700                                                                  06170010
061800                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06180010
061900                      MOVE PC-U   TO TM500-CRUD-IND               06190010
062000                      MOVE PC-108 TO TM500-TRBL-RSN-CDE           06200010
062100                      PERFORM 3000-CREATE-TROUBLE-RECORD          06210010
062200                  END-IF                                          06220010
062300                                                                  06230010
062400                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06240010
062500                      MOVE PC-U   TO TM500-CRUD-IND               06250010
062600                      MOVE PC-503 TO TM500-TRBL-RSN-CDE           06260010
062700                      MOVE TM500-RTV-SW TO PV-RTV-SW              06270010
062800                      MOVE SPACES   TO TM500-RTV-SW               06280010
062900                      PERFORM 3000-CREATE-TROUBLE-RECORD          06290010
063000                      MOVE PV-RTV-SW TO TM500-RTV-SW              06300010
063100                  END-IF                                          06310010
063200                                                                  06320010
063300                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06330010
063400                      MOVE PC-U   TO TM500-CRUD-IND               06340010
063500                      MOVE PC-107 TO TM500-TRBL-RSN-CDE           06350010
063600                      PERFORM 3000-CREATE-TROUBLE-RECORD          06360010
063700                  END-IF                                          06370010
063800                                                                  06380010
063900             WHEN PURCHS-STATUS-CDE = PC-CA                       06390010
064000                  MOVE PC-C   TO TM500-CRUD-IND                   06400010
064100                  MOVE PC-503 TO TM500-TRBL-RSN-CDE               06410010
064200                  MOVE TM500-RTV-SW TO PV-RTV-SW                  06420010
064300                  MOVE SPACES       TO TM500-RTV-SW               06430010
064400                  PERFORM 3000-CREATE-TROUBLE-RECORD              06440010
064500                  MOVE PV-RTV-SW    TO TM500-RTV-SW               06450010
064600                                                                  06460010
064700                  SET TM500-IN-TROUBLE TO TRUE                    06470010
064800                                                                  06480010
064900                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06490010
065000                      MOVE PC-U   TO TM500-CRUD-IND               06500010
065100                      MOVE PC-108 TO TM500-TRBL-RSN-CDE           06510010
065200                      PERFORM 3000-CREATE-TROUBLE-RECORD          06520010
065300                  END-IF                                          06530010
065400                                                                  06540010
065500                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06550010
065600                      MOVE PC-U   TO TM500-CRUD-IND               06560010
065700                      MOVE PC-504 TO TM500-TRBL-RSN-CDE           06570010
065800                      MOVE TM500-RTV-SW TO PV-RTV-SW              06580010
065900                      MOVE SPACES   TO TM500-RTV-SW               06590010
066000                      PERFORM 3000-CREATE-TROUBLE-RECORD          06600010
066100                      MOVE PV-RTV-SW TO TM500-RTV-SW              06610010
066200                  END-IF                                          06620010
066300                                                                  06630010
066400                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06640010
066500                      MOVE PC-U   TO TM500-CRUD-IND               06650010
066600                      MOVE PC-107 TO TM500-TRBL-RSN-CDE           06660010
066700                      PERFORM 3000-CREATE-TROUBLE-RECORD          06670010
066800                  END-IF                                          06680010
066900                                                                  06690010
067000             WHEN OTHER                                           06700010
067100                  MOVE PC-C   TO TM500-CRUD-IND                   06710010
067200                  MOVE PC-107 TO TM500-TRBL-RSN-CDE               06720010
067300                  PERFORM 3000-CREATE-TROUBLE-RECORD              06730010
067400                                                                  06740010
067500                  SET TM500-IN-TROUBLE TO TRUE                    06750010
067600                                                                  06760010
067700                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06770010
067800                      MOVE PC-U   TO TM500-CRUD-IND               06780010
067900                      MOVE PC-108 TO TM500-TRBL-RSN-CDE           06790010
068000                      PERFORM 3000-CREATE-TROUBLE-RECORD          06800010
068100                  END-IF                                          06810010
068200                                                                  06820010
068300                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06830010
068400                      MOVE PC-U   TO TM500-CRUD-IND               06840010
068500                      MOVE PC-504 TO TM500-TRBL-RSN-CDE           06850010
068600                      PERFORM 3000-CREATE-TROUBLE-RECORD          06860010
068700                  END-IF                                          06870010
068800                                                                  06880010
068900                  IF TM500-RESOLVE-AUTO AND PS-NOT-DONE           06890010
069000                      MOVE PC-U   TO TM500-CRUD-IND               06900010
069100                      MOVE PC-503 TO TM500-TRBL-RSN-CDE           06910010
069200                      PERFORM 3000-CREATE-TROUBLE-RECORD          06920010
069300                  END-IF                                          06930010
069400                                                                  06940010
069500         END-EVALUATE                                             06950010
069600     END-IF.                                                      06960010
069700/                                                                 06970010
069800                                                                  06980010
069900 2130-CHECK-PACK-CDE-CHANGE.                                      06990010
070000******************************************************************07000010
070100* THIS PARAGRAPH CHECKS FOR A PACKAGING CODE CHANGE.              07010010
070200******************************************************************07020010
070300                                                                  07030010
070400     PERFORM WITH TEST AFTER                                      07040010
070500         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    07050010
070600         UNTIL   SQLCODE = +0 OR                                  07060010
070700                 SQLCODE = +100 OR                                07070010
070800                 PS-DONE OR                                       07080010
070900                 PV-RETRY-COUNTER > PC-MAX-RETRIES                07090010
071000                                                                  07100010
071100         EXEC SQL                                                 07110010
071200              SELECT COUNT(*)                                     07120010
071300                INTO :PV-NUMBER-OF-RV                             07130010
071400                FROM TPURITM                                      07140010
071500               WHERE PO_NBR         = :TM500-PO-NBR               07150010
071600                 AND STATUS_CDE     = :PC-RV                      07160010
071700                 AND VER_STATUS_CDE = :PC-ACTIVE                  07170010
071800         END-EXEC                                                 07180010
071900                                                                  07190010
072000         EVALUATE TRUE                                            07200010
072100             WHEN SQLCODE = +0                                    07210010
072200                  IF PV-NUMBER-OF-RV > 0                          07220010
072300                     SET PS-RV-FOUND TO TRUE                      07230010
072400                  END-IF                                          07240010
072500                                                                  07250010
072600             WHEN SQLCODE = +100                                  07260010
072700             WHEN SQLCODE = -904                                  07270010
072800             WHEN SQLCODE = -911                                  07280010
072900             WHEN SQLCODE = -913                                  07290010
073000                  CONTINUE                                        07300010
073100                                                                  07310010
073200             WHEN OTHER                                           07320010
073300                  SET  PS-DONE TO TRUE                            07330010
073400                  MOVE SQLCA   TO TM500-SQLCA                     07340010
073500                  MOVE SQLCODE TO TM500-SQLCODE                   07350010
073600                  MOVE PRV-1B  TO TM500-RETURN-DATA               07360010
073700                                                                  07370010
073800                  MOVE SPACES    TO PRV-TM500-RETURN-MSG          07380010
073900                  MOVE '2130'    TO PRV-PARA                      07390010
074000                  MOVE 'TPURITM' TO PRV-TBL                       07400010
074100                  PERFORM 9999-RETURN-MSG                         07410010
074200         END-EVALUATE                                             07420010
074300     END-PERFORM.                                                 07430010
074400                                                                  07440010
074500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         07450010
074600         SET  PS-DONE TO TRUE                                     07460010
074700         MOVE SQLCA   TO TM500-SQLCA                              07470010
074800         MOVE SQLCODE TO TM500-SQLCODE                            07480010
074900         MOVE PRV-1B  TO TM500-RETURN-DATA                        07490010
075000                                                                  07500010
075100         MOVE SPACES    TO PRV-TM500-RETURN-MSG                   07510010
075200         MOVE '2130'    TO PRV-PARA                               07520010
075300         MOVE 'TPURITM' TO PRV-TBL                                07530010
075400         PERFORM 9999-RETURN-MSG                                  07540010
075500     END-IF.                                                      07550010
075600                                                                  07560010
075700     IF PS-RV-FOUND AND PS-NOT-DONE                               07570010
075800         MOVE PC-C TO TM500-CRUD-IND                              07580010
075900         MOVE PC-505 TO TM500-TRBL-RSN-CDE                        07590010
076000         PERFORM 3000-CREATE-TROUBLE-RECORD                       07600010
076100         SET TM500-IN-TROUBLE TO TRUE                             07610010
076200     END-IF.                                                      07620010
076300                                                                  07630010
076400     IF PS-RV-NOT-FOUND AND PS-NOT-DONE AND TM500-RESOLVE-AUTO    07640010
076500         MOVE PC-U TO TM500-CRUD-IND                              07650010
076600         MOVE PC-505 TO TM500-TRBL-RSN-CDE                        07660010
076700         PERFORM 3000-CREATE-TROUBLE-RECORD                       07670010
076800     END-IF.                                                      07680010
076900                                                                  07690010
077000                                                                  07700010
077100 2140-CHECK-FLOWBACK-CDE.                                         07710010
077200******************************************************************07720010
077300* THIS PARAGRAPH CHECKS FOR FLOWBACK PO TROUBLE.                  07730010
077400******************************************************************07740010
077500                                                                  07750010
077600     INITIALIZE PS-CREATE-426-TRBL-SW.                            07760010
077700     IF PURCHS-PO-TYP-CDE = 'FB' OR                               07770010
077800        PURCHS-PO-TYP-CDE = 'IF'                                  07780010
077900         SET PS-CREATE-426-TRBL TO TRUE                           07790010
078000     END-IF.                                                      07800010
078100                                                                  07810010
078200                                                                  07820010
078300 2200-EARLY-OR-LATE-TROUBLE.                                      07830010
078400******************************************************************07840010
078500*    THIS PARAGRAPH CHECKS FOR EARLY/LATE TROUBLE.                07850010
078600******************************************************************07860010
078700                                                                  07870010
078800     PERFORM 2210-GET-TPLNSHP.                                    07880010
078900                                                                  07890010
079000     IF PS-NOT-DONE                                               07900010
079100         PERFORM 2220-GET-TCOCNTL                                 07910010
079200     END-IF.                                                      07920010
079300                                                                  07930010
079400     IF PS-NOT-DONE                                               07940010
079500         PERFORM 2230-GET-TRECEIV                                 07950010
079600     END-IF.                                                      07960010
079700                                                                  07970010
079800     IF PS-NOT-DONE                                               07980010
079900         PERFORM 2240-CHECK-IF-EARLY-OR-LATE                      07990010
080000     END-IF.                                                      08000010
080100                                                                  08010010
080200/                                                                 08020010
080300 2210-GET-TPLNSHP.                                                08030010
080400******************************************************************08040010
080500*    THIS PARAGRAPH RETRIEVES DATA FROM TPLNSHP TABLE TO BE USED  08050010
080600*    TO CHECK FOR EARLY/LATE TROUBLE.                             08060010
080700******************************************************************08070010
080800                                                                  08080010
080900     PERFORM WITH TEST AFTER                                      08090010
081000         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    08100010
081100         UNTIL   SQLCODE = +0 OR                                  08110010
081200                 PS-DONE OR                                       08120010
081300                 PV-RETRY-COUNTER > PC-MAX-RETRIES                08130010
081400                                                                  08140010
081500         EXEC SQL                                                 08150010
081600              SELECT DONT_SHIP_BEF_DTE                            08160010
081700                   , CAN_IFNOT_SHIP_DTE                           08170010
081800                   , EXT_CAN_DTE                                  08180010
081900                INTO :PLNSHP-DONT-SHIP-BEF-DTE                    08190010
082000                   , :PLNSHP-CAN-IFNOT-SHIP-DTE                   08200010
082100                   , :PLNSHP-EXT-CAN-DTE                          08210010
082200                FROM TPLNSHP                                      08220010
082300               WHERE PO_NBR         = :TM500-PO-NBR               08230010
082400                 AND VER_STATUS_CDE = :PC-ACTIVE                  08240010
082500         END-EXEC                                                 08250010
082600                                                                  08260010
082700         EVALUATE TRUE                                            08270010
082800             WHEN SQLCODE = +0                                    08280010
082900                  CONTINUE                                        08290010
083000                                                                  08300010
083100             WHEN SQLCODE = -904                                  08310010
083200             WHEN SQLCODE = -911                                  08320010
083300             WHEN SQLCODE = -913                                  08330010
083400                  CONTINUE                                        08340010
083500                                                                  08350010
083600             WHEN OTHER                                           08360010
083700                  SET PS-DONE  TO TRUE                            08370010
083800                  MOVE SQLCA   TO TM500-SQLCA                     08380010
083900                  MOVE SQLCODE TO TM500-SQLCODE                   08390010
084000                  MOVE PRV-1C  TO TM500-RETURN-DATA               08400010
084100                                                                  08410010
084200                  MOVE SPACES    TO PRV-TM500-RETURN-MSG          08420010
084300                  MOVE '2210'    TO PRV-PARA                      08430010
084400                  MOVE 'TPLNSHP' TO PRV-TBL                       08440010
084500                  PERFORM 9999-RETURN-MSG                         08450010
084600         END-EVALUATE                                             08460010
084700     END-PERFORM.                                                 08470010
084800                                                                  08480010
084900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         08490010
085000         SET PS-DONE  TO TRUE                                     08500010
085100         MOVE SQLCA   TO TM500-SQLCA                              08510010
085200         MOVE SQLCODE TO TM500-SQLCODE                            08520010
085300         MOVE PRV-1C  TO TM500-RETURN-DATA                        08530010
085400                                                                  08540010
085500         MOVE SPACES    TO PRV-TM500-RETURN-MSG                   08550010
085600         MOVE '2210'    TO PRV-PARA                               08560010
085700         MOVE 'TPLNSHP' TO PRV-TBL                                08570010
085800         PERFORM 9999-RETURN-MSG                                  08580010
085900     END-IF.                                                      08590010
086000                                                                  08600010
086100/                                                                 08610010
086200 2220-GET-TCOCNTL.                                                08620010
086300******************************************************************08630010
086400*    THIS PARAGRAPH RETRIEVES DATA FROM TCOCNTL TABLE TO BE USED  08640010
086500*    TO CHECK FOR EARLY/LATE TROUBLE.                             08650010
086600******************************************************************08660010
086700                                                                  08670010
086800     PERFORM WITH TEST AFTER                                      08680010
086900         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    08690010
087000         UNTIL   SQLCODE = +0 OR                                  08700010
087100                 PS-DONE OR                                       08710010
087200                 PV-RETRY-COUNTER > PC-MAX-RETRIES                08720010
087300                                                                  08730010
087400         EXEC SQL                                                 08740010
087500              SELECT SHIPT_ERL_DAYS_NBR                           08750010
087600                   , SHIPT_LTE_DAYS_NBR                           08760010
087700                INTO :COCNTL-SHIPT-ERL-DAYS-NBR                   08770010
087800                   , :COCNTL-SHIPT-LTE-DAYS-NBR                   08780010
087900                FROM TCOCNTL                                      08790010
088000               WHERE OPER_UNT_ID = :TM500-OPER-UNT-ID             08800010
088100                 AND FCLTY_ID    = :TM500-FCLTY-ID                08810010
088200         END-EXEC                                                 08820010
088300                                                                  08830010
088400         EVALUATE TRUE                                            08840010
088500             WHEN SQLCODE = +0                                    08850010
088600                  CONTINUE                                        08860010
088700                                                                  08870010
088800             WHEN SQLCODE = -904                                  08880010
088900             WHEN SQLCODE = -911                                  08890010
089000             WHEN SQLCODE = -913                                  08900010
089100                  CONTINUE                                        08910010
089200                                                                  08920010
089300             WHEN OTHER                                           08930010
089400                  SET PS-DONE  TO TRUE                            08940010
089500                  MOVE SQLCA   TO TM500-SQLCA                     08950010
089600                  MOVE SQLCODE TO TM500-SQLCODE                   08960010
089700                  MOVE PRV-1D  TO TM500-RETURN-DATA               08970010
089800                                                                  08980010
089900                  MOVE SPACES    TO PRV-TM500-RETURN-MSG          08990010
090000                  MOVE '2220'    TO PRV-PARA                      09000010
090100                  MOVE 'TCOCNTL' TO PRV-TBL                       09010010
090200                  PERFORM 9999-RETURN-MSG                         09020010
090300         END-EVALUATE                                             09030010
090400     END-PERFORM.                                                 09040010
090500                                                                  09050010
090600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         09060010
090700         SET PS-DONE  TO TRUE                                     09070010
090800         MOVE SQLCA   TO TM500-SQLCA                              09080010
090900         MOVE SQLCODE TO TM500-SQLCODE                            09090010
091000         MOVE PRV-1D  TO TM500-RETURN-DATA                        09100010
091100                                                                  09110010
091200         MOVE SPACES    TO PRV-TM500-RETURN-MSG                   09120010
091300         MOVE '2220'    TO PRV-PARA                               09130010
091400         MOVE 'TCOCNTL' TO PRV-TBL                                09140010
091500         PERFORM 9999-RETURN-MSG                                  09150010
091600     END-IF.                                                      09160010
091700                                                                  09170010
091800/                                                                 09180010
091900 2230-GET-TRECEIV.                                                09190010
092000******************************************************************09200010
092100*    THIS PARAGRAPH RETRIEVES DATA FROM TRECEIV TABLE TO BE USED  09210010
092200*    TO CHECK FOR EARLY/LATE TROUBLE.                             09220010
092300******************************************************************09230010
092400                                                                  09240010
092500     PERFORM WITH TEST AFTER                                      09250010
092600         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    09260010
092700         UNTIL   SQLCODE = +0 OR                                  09270010
092800                 PS-DONE OR                                       09280010
092900                 PV-RETRY-COUNTER > PC-MAX-RETRIES                09290010
093000                                                                  09300010
093100         EXEC SQL                                                 09310010
093200              SELECT REC_TMST                                     09320010
093300                INTO :RECEIV-REC-TMST                             09330010
093400                FROM TRECEIV                                      09340010
093500               WHERE OPER_UNT_ID    = :TM500-OPER-UNT-ID          09350010
093600                 AND FCLTY_ID       = :TM500-FCLTY-ID             09360010
093700                 AND ORD_NBR        = :TM500-PO-NBR               09370010
093800                 AND REC_SEQ_NBR    = :TM500-REC-SEQ-NBR          09380010
093900                 AND VER_STATUS_CDE = :PC-ACTIVE                  09390010
094000         END-EXEC                                                 09400010
094100                                                                  09410010
094200         EVALUATE TRUE                                            09420010
094300             WHEN SQLCODE = +0                                    09430010
094400                  CONTINUE                                        09440010
094500                                                                  09450010
094600             WHEN SQLCODE = -904                                  09460010
094700             WHEN SQLCODE = -911                                  09470010
094800             WHEN SQLCODE = -913                                  09480010
094900                  CONTINUE                                        09490010
095000                                                                  09500010
095100             WHEN OTHER                                           09510010
095200                  SET PS-DONE  TO TRUE                            09520010
095300                  MOVE SQLCA   TO TM500-SQLCA                     09530010
095400                  MOVE SQLCODE TO TM500-SQLCODE                   09540010
095500                  MOVE PRV-1E  TO TM500-RETURN-DATA               09550010
095600                                                                  09560010
095700                  MOVE SPACES    TO PRV-TM500-RETURN-MSG          09570010
095800                  MOVE '2230'    TO PRV-PARA                      09580010
095900                  MOVE 'TRECEIV' TO PRV-TBL                       09590010
096000                  PERFORM 9999-RETURN-MSG                         09600010
096100         END-EVALUATE                                             09610010
096200     END-PERFORM.                                                 09620010
096300                                                                  09630010
096400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         09640010
096500         SET PS-DONE  TO TRUE                                     09650010
096600         MOVE SQLCA   TO TM500-SQLCA                              09660010
096700         MOVE SQLCODE TO TM500-SQLCODE                            09670010
096800         MOVE PRV-1E  TO TM500-RETURN-DATA                        09680010
096900                                                                  09690010
097000         MOVE SPACES    TO PRV-TM500-RETURN-MSG                   09700010
097100         MOVE '2230'    TO PRV-PARA                               09710010
097200         MOVE 'TRECEIV' TO PRV-TBL                                09720010
097300         PERFORM 9999-RETURN-MSG                                  09730010
097400     END-IF.                                                      09740010
097500                                                                  09750010
097600/                                                                 09760010
097700 2240-CHECK-IF-EARLY-OR-LATE.                                     09770010
097800******************************************************************09780010
097900*    THIS PARAGRAPH CALLS PARAGRAPH 2241 WHICH CONVERTS DATES     09790010
098000*    TO THE SAME FORMAT BEFORE CHECKING IF THE PO IS EARLY OR LATE09800010
098100*    IF THE PO IS EARLY, IT CALLS PARAGRAPH 2242.  IF THE PO IS   09810010
098200*    LATE, IT CALLS 2243.  OTHERWISE, IT RESOLVES ANY UNRESOLVE   09820010
098300*    EARLY/LATE TROUBLE BY CALLING PARAGRAPH 2244.                09830010
098400*                                                                 09840010
098500*    IF RESOLVING PO CANCELLED OR COMPLETE, EARLY OR LATE TROUBLE 09850010
098600*    EXISTS, AND THE SHIPPING WINDOW HAS CHANGED, THE LATE TROUBLE09860010
098700*    IS NOT RESOLVED.  THE RTV INDICATOR MUST BE KEYED ON THE     09870010
098800*    MANUAL RESOLVE SCREEN.                                       09880010
098900******************************************************************09890010
099000                                                                  09900010
099100     PERFORM 2241-CONV-DATES-TO-CCYYMMDD.                         09910010
099200                                                                  09920010
099300     IF PV-VEND-SHIP-DTE < PV-DONT-SHIP-BEF-DTE                   09930010
099400         IF PV-TRBL-RSN-CDE = PC-509                              09940010
099500             SET PS-DONE  TO TRUE                                 09950010
099600             MOVE SPACES  TO TM500-SQLCA                          09960010
099700             MOVE ZEROES  TO TM500-SQLCODE                        09970010
099800             MOVE PRV-02  TO TM500-RETURN-DATA                    09980010
099900         ELSE                                                     09990010
100000             PERFORM 2242-EARLY-TROUBLE                           10000010
100100         END-IF                                                   10010010
100200     ELSE                                                         10020010
100300                                                                  10030010
100400         IF PLNSHP-EXT-CAN-DTE = PC-DEFAULT-DTE-MIN               10040010
100500* THERE'S NO EXTENDED-CANCEL DATE                                 10050010
100600                                                                  10060010
100700             IF PV-VEND-SHIP-DTE > PV-CAN-IFNOT-SHIP-DTE          10070010
100800* THE SHIP DATE IS PAST THE CANCEL-IF-NOT-SHIPPED-BEFORE DATE     10080010
100900                 MOVE PV-CAN-IFNOT-SHIP-DTE TO PV-CAN-DATE        10090010
101000                 PERFORM 2243-LATE-TROUBLE                        10100010
101100                                                                  10110010
101200             ELSE                                                 10120010
101300                                                                  10130010
101400* THE SHIP DATE WAS LATE BUT IS NOW EARLIER THAN THE              10140010
101500* CANCEL-IF-NOT-SHIPPED-BEFORE DATE - RESOLVE THE LATE TROUBLE    10150010
101600                                                                  10160010
101700                 IF TM500-RESOLVE-AUTO                            10170010
101800                     IF TM500-FROM-LIST-SCREEN                    10180010
101900                       OR PURCHS-PO-TYP-CDE = PC-IE               10190010
102000                       OR PURCHS-PO-TYP-CDE = PC-IF               10200010
102100                       OR PURCHS-PO-TYP-CDE = PC-IM               10210010
102200                        CONTINUE                                  10220010
102300                     ELSE                                         10230010
102400                        PERFORM 2244-UPDATE-LATE-TROUBLE          10240010
102500                     END-IF                                       10250010
102600                 END-IF                                           10260010
102700             END-IF                                               10270010
102800                                                                  10280010
102900         ELSE                                                     10290010
103000                                                                  10300010
103100             IF PV-VEND-SHIP-DTE > PV-EXT-CAN-DTE                 10310010
103200*  THE SHIP DATE IS PAST THE EXTENDED-CANCEL DATE                 10320010
103300                 MOVE PV-EXT-CAN-DTE TO PV-CAN-DATE               10330010
103400                 PERFORM 2243-LATE-TROUBLE                        10340010
103500                                                                  10350010
103600             ELSE                                                 10360010
103700                                                                  10370010
103800* THE SHIP DATE IS STILL LATE BUT NOT PAST THE EXTENDED-CANCEL    10380010
103900* DATE - RESOLVE THE LATE TROUBLE                                 10390010
104000                 IF TM500-RESOLVE-AUTO                            10400010
104100                     IF TM500-FROM-LIST-SCREEN                    10410010
104200                       OR PURCHS-PO-TYP-CDE = PC-IE               10420010
104300                       OR PURCHS-PO-TYP-CDE = PC-IF               10430010
104400                       OR PURCHS-PO-TYP-CDE = PC-IM               10440010
104500                        CONTINUE                                  10450010
104600                     ELSE                                         10460010
104700                        PERFORM 2244-UPDATE-LATE-TROUBLE          10470010
104800                     END-IF                                       10480010
104900                 END-IF                                           10490010
105000             END-IF                                               10500010
105100         END-IF                                                   10510010
105200     END-IF.                                                      10520010
105300                                                                  10530010
105400                                                                  10540010
105500 2241-CONV-DATES-TO-CCYYMMDD.                                     10550010
105600******************************************************************10560010
105700*    THIS PARAGRAPH CONVERTS ALL DATES PERTINENT TO THE EARLY/LATE10570010
105800*    TROUBLE CHECK TO THE SAME DATE FORMAT.                       10580010
105900******************************************************************10590010
106000                                                                  10600010
106100     MOVE TM500-VEND-SHIP-DTE       TO PV-TEMP-DATE.              10610010
106200     MOVE PV-DATE-CCYY              TO PV-VEND-SHIP-CCYY.         10620010
106300     MOVE PV-DATE-MM                TO PV-VEND-SHIP-MM.           10630010
106400     MOVE PV-DATE-DD                TO PV-VEND-SHIP-DD.           10640010
106500                                                                  10650010
106600     MOVE PLNSHP-DONT-SHIP-BEF-DTE  TO PV-TEMP-DATE.              10660010
106700     MOVE PV-DATE-CCYY              TO PV-DONT-SHIP-CCYY.         10670010
106800     MOVE PV-DATE-MM                TO PV-DONT-SHIP-MM.           10680010
106900     MOVE PV-DATE-DD                TO PV-DONT-SHIP-DD.           10690010
107000                                                                  10700010
107100     MOVE PLNSHP-CAN-IFNOT-SHIP-DTE TO PV-TEMP-DATE.              10710010
107200     MOVE PV-DATE-CCYY              TO PV-CAN-IFNOT-CCYY.         10720010
107300     MOVE PV-DATE-MM                TO PV-CAN-IFNOT-MM.           10730010
107400     MOVE PV-DATE-DD                TO PV-CAN-IFNOT-DD.           10740010
107500                                                                  10750010
107600     MOVE PLNSHP-EXT-CAN-DTE        TO PV-TEMP-DATE.              10760010
107700     MOVE PV-DATE-CCYY              TO PV-EXT-CAN-CCYY.           10770010
107800     MOVE PV-DATE-MM                TO PV-EXT-CAN-MM.             10780010
107900     MOVE PV-DATE-DD                TO PV-EXT-CAN-DD.             10790010
108000                                                                  10800010
108100     MOVE RECEIV-REC-TMST           TO PV-TEMP-TMST.              10810010
108200     MOVE PV-TMST-CCYY              TO PV-REC-TMST-CCYY.          10820010
108300     MOVE PV-TMST-MM                TO PV-REC-TMST-MM.            10830010
108400     MOVE PV-TMST-DD                TO PV-REC-TMST-DD.            10840010
108500                                                                  10850010
108600                                                                  10860010
108700 2242-EARLY-TROUBLE.                                              10870010
108800******************************************************************10880010
108900*    THIS PARAGRAPH CALLS PARAGRAPH 2242 THAT CREATES THE DETAILS 10890010
109000*    FOR EARLY TROUBLE.  IT THEN DETERMINES WHETHER EARLY TROUBLE 10900010
109100*    IS WITHIN COMPANY GUIDELINES OR NOT.                         10910010
109200*    IF RESOLVING PO CANCELLED OR COMPLETE, EARLY TROUBLE EXISTS, 10920010
109300*    AND THE SHIPPING WINDOW HAS CHANGED, THE EARLY TROUBLE IS    10930010
109400*    NOT RESOLVED.  THE RTV INDICATOR MUST BE KEYED ON THE MANUAL 10940010
109500*    RESOLVE SCREEN.                                              10950010
109600******************************************************************10960010
109700                                                                  10970010
109800     PERFORM 2242-CREATE-EARLY-TEXT.                              10980010
109900                                                                  10990010
110000     COMPUTE PV-DAYS-NBR = COCNTL-SHIPT-ERL-DAYS-NBR + 1          11000010
110100     INITIALIZE  DPG51 DPG52                                      11010010
110200                 DPG53 DPG54                                      11020010
110300                 DPG55 DPG56                                      11030010
110400     SET DPG51-DECREMENT-DATE       TO TRUE                       11040010
110500     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE                       11050010
110600     SET DPG52-LK-DTE-ISO           TO TRUE                       11060010
110700     MOVE SPACES                    TO DPG52-LK-DATE-INPUT        11070010
110800     MOVE PV-DONT-SHIP-BEF-DTE      TO DPG52-LK-DATE-INPUT        11080010
110900     MOVE PV-DAYS-NBR               TO DPG51-INCR-DECR-BUS-DAYS-9 11090010
111000     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          11100010
111100                           DPG53 DPG54                            11110010
111200                           DPG55 DPG56                            11120010
111300     MOVE DPG55-DB2-ISO-DATE TO PV-SHIPT-ERL-DAYS-NBR             11130010
111400                                                                  11140010
111500                                                                  11150010
111600     EVALUATE TRUE                                                11160010
111700         WHEN PV-VEND-SHIP-DTE NOT < PV-SHIPT-ERL-DAYS-NBR        11170010
111800           OR PURCHS-PO-TYP-CDE = PC-IE                           11180010
111900           OR PURCHS-PO-TYP-CDE = PC-IF                           11190010
112000           OR PURCHS-PO-TYP-CDE = PC-IM                           11200010
112100* OR THE PO IS AN IMPORT                                          11210010
112200* THE SHIP DATE IS EARLY BUT WITHIN THE LIMITS                    11220010
112300             MOVE PC-C   TO TM500-CRUD-IND                        11230010
112400             MOVE PC-501 TO TM500-TRBL-RSN-CDE                    11240010
112500             MOVE SPACES TO TM500-RTV-SW                          11250010
112600             PERFORM 3000-CREATE-TROUBLE-RECORD                   11260010
112700             SET TM500-ADD-DETAILS TO TRUE                        11270010
112800             MOVE SPACES TO TM500-FREEFORM-TEXT                   11280010
112900             IF PS-NOT-DONE AND TM500-RESOLVE-AUTO                11290010
113000                 IF TM500-FROM-LIST-SCREEN                        11300010
113100                   OR PURCHS-PO-TYP-CDE = PC-IE                   11310010
113200                   OR PURCHS-PO-TYP-CDE = PC-IF                   11320010
113300                   OR PURCHS-PO-TYP-CDE = PC-IM                   11330010
113400                     CONTINUE                                     11340010
113500                 ELSE                                             11350010
113600                     PERFORM 2245-UPDATE-EARLY-TROUBLE            11360010
113700                 END-IF                                           11370010
113800             END-IF                                               11380010
113900         WHEN OTHER                                               11390010
114000* THE SHIP DATE IS EARLIER THAN THE LIMIT DATE                    11400010
114100             MOVE PC-C TO TM500-CRUD-IND                          11410010
114200             MOVE PC-502 TO TM500-TRBL-RSN-CDE                    11420010
114300             MOVE SPACES TO TM500-RTV-SW                          11430010
114400             PERFORM 3000-CREATE-TROUBLE-RECORD                   11440010
114500             SET TM500-IN-TROUBLE TO TRUE                         11450010
114600             SET TM500-NO-DETAILS TO TRUE                         11460010
114700     END-EVALUATE.                                                11470010
114800                                                                  11480010
114900                                                                  11490010
115000 2242-CREATE-EARLY-TEXT.                                          11500010
115100******************************************************************11510010
115200*    THIS PARAGRAPH CREATES THE DETAILS FOR EARLY TROUBLE.        11520010
115300******************************************************************11530010
115400                                                                  11540010
115500     SET  TM500-ADD-DETAILS TO TRUE.                              11550010
115600     MOVE PC-RCKCS234       TO TM500-CRE-UID.                     11560010
115700                                                                  11570010
115800     MOVE PV-VEND-SHIP-CCYY TO PC-TEXT-DATE-CCYY.                 11580010
115900     MOVE PV-VEND-SHIP-MM   TO PC-TEXT-DATE-MM.                   11590010
116000     MOVE PV-VEND-SHIP-DD   TO PC-TEXT-DATE-DD.                   11600010
116100                                                                  11610010
116200     MOVE PC-TEXT-DATE      TO PC-EARLY-DATE-11.                  11620010
116300                                                                  11630010
116400     MOVE PV-DONT-SHIP-CCYY TO PC-TEXT-DATE-CCYY.                 11640010
116500     MOVE PV-DONT-SHIP-MM   TO PC-TEXT-DATE-MM.                   11650010
116600     MOVE PV-DONT-SHIP-DD   TO PC-TEXT-DATE-DD.                   11660010
116700                                                                  11670010
116800     MOVE PC-TEXT-DATE      TO PC-EARLY-DATE-21.                  11680010
116900                                                                  11690010
117000     IF  PV-TEMP-TMST = '9999-09-09-09.09.09.999999'              11700010
117100        MOVE 'ENROUTE'      TO PC-EARLY-DATE-41                   11710010
117200     ELSE                                                         11720010
117300        MOVE PV-TMST-CCYY   TO PC-TEXT-DATE-CCYY                  11730010
117400        MOVE PV-TMST-MM     TO PC-TEXT-DATE-MM                    11740010
117500        MOVE PV-TMST-DD     TO PC-TEXT-DATE-DD                    11750010
117600        MOVE PC-TEXT-DATE   TO PC-EARLY-DATE-41.                  11760010
117700                                                                  11770010
117800     MOVE PC-EARLY-TEXT     TO TM500-FREEFORM-TEXT.               11780010
117900                                                                  11790010
118000                                                                  11800010
118100 2243-LATE-TROUBLE.                                               11810010
118200******************************************************************11820010
118300*    THIS PARAGRAPH CALLS PARAGRAPH 2243 THAT CREATES THE DETAILS 11830010
118400*    FOR LATE TROUBLE.  IT THEN DETERMINES WHETHER LATE TROUBLE   11840010
118500*    IS WITHIN COMPANY GUIDELINES OR NOT.                         11850010
118600*    IF RESOLVING PO CANCELLED OR COMPLETE, LATE TROUBLE EXISTS,  11860010
118700*    AND THE SHIPPING WINDOW HAS CHANGED, THE LATE TROUBLE IS     11870010
118800*    NOT RESOLVED.  THE RTV INDICATOR MUST BE KEYED ON THE MANUAL 11880010
118900*    RESOLVE SCREEN.                                              11890010
119000******************************************************************11900010
119100                                                                  11910010
119200     PERFORM 2243-CREATE-LATE-TEXT.                               11920010
119300                                                                  11930010
119400     COMPUTE PV-DAYS-NBR = COCNTL-SHIPT-LTE-DAYS-NBR + 1.         11940010
119500                                                                  11950010
119600     INITIALIZE  DPG51 DPG52                                      11960010
119700                 DPG53 DPG54                                      11970010
119800                 DPG55 DPG56                                      11980010
119900     SET  DPG51-INCREMENT-DATE       TO TRUE.                     11990010
120000     SET  DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                     12000010
120100     SET  DPG52-LK-DTE-ISO           TO TRUE.                     12010010
120200     MOVE SPACES      TO DPG52-LK-DATE-INPUT.                     12020010
120300     MOVE PV-CAN-DATE TO DPG52-LK-DATE-INPUT.                     12030010
120400     MOVE PV-DAYS-NBR TO DPG51-INCR-DECR-BUS-DAYS-9.              12040010
120500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          12050010
120600                           DPG53 DPG54                            12060010
120700                           DPG55 DPG56.                           12070010
120800     MOVE DPG55-DB2-ISO-DATE TO PV-SHIPT-LTE-DAYS-NBR.            12080010
120900                                                                  12090010
121000     EVALUATE TRUE                                                12100010
121100         WHEN PV-VEND-SHIP-DTE < PV-SHIPT-LTE-DAYS-NBR            12110010
121200* LATE BUT EARLIER THAN THE LIMIT DATE                            12120010
121300           OR PURCHS-PO-TYP-CDE = PC-IE                           12130010
121400           OR PURCHS-PO-TYP-CDE = PC-IF                           12140010
121500           OR PURCHS-PO-TYP-CDE = PC-IM                           12150010
121600* OR THE PO IS AN IMPORT                                          12160010
121700              MOVE PC-C   TO TM500-CRUD-IND                       12170010
121800              MOVE PC-508 TO TM500-TRBL-RSN-CDE                   12180010
121900              MOVE TM500-RTV-SW TO PV-RTV-SW                      12190010
122000              MOVE SPACES       TO TM500-RTV-SW                   12200010
122100              PERFORM 3000-CREATE-TROUBLE-RECORD                  12210010
122200              MOVE PV-RTV-SW    TO TM500-RTV-SW                   12220010
122300              SET TM500-ADD-DETAILS TO TRUE                       12230010
122400              MOVE SPACES TO TM500-FREEFORM-TEXT                  12240010
122500              IF PS-NOT-DONE AND TM500-RESOLVE-AUTO               12250010
122600                 IF TM500-FROM-LIST-SCREEN                        12260010
122700                   OR PURCHS-PO-TYP-CDE = PC-IE                   12270010
122800                   OR PURCHS-PO-TYP-CDE = PC-IF                   12280010
122900                   OR PURCHS-PO-TYP-CDE = PC-IM                   12290010
123000                     CONTINUE                                     12300010
123100                 ELSE                                             12310010
123200                    PERFORM 2244-UPDATE-LATE-TROUBLE              12320010
123300                 END-IF                                           12330010
123400              END-IF                                              12340010
123500         WHEN OTHER                                               12350010
123600* LATE AND PAST THE LIMIT DATE                                    12360010
123700              MOVE PC-C TO TM500-CRUD-IND                         12370010
123800              MOVE PC-509 TO TM500-TRBL-RSN-CDE                   12380010
123900              SET TM500-ADD-DETAILS TO TRUE                       12390010
124000              PERFORM 3000-CREATE-TROUBLE-RECORD                  12400010
124100              SET TM500-IN-TROUBLE TO TRUE                        12410010
124200              SET TM500-NO-DETAILS TO TRUE                        12420010
124300     END-EVALUATE.                                                12430010
124400                                                                  12440010
124500                                                                  12450010
124600 2243-CREATE-LATE-TEXT.                                           12460010
124700******************************************************************12470010
124800*    THIS PARAGRAPH CREATES THE DETAILS FOR LATE TROUBLE.         12480010
124900******************************************************************12490010
125000                                                                  12500010
125100     SET  TM500-ADD-DETAILS TO TRUE.                              12510010
125200     MOVE PC-RCKCS234       TO TM500-CRE-UID.                     12520010
125300                                                                  12530010
125400     MOVE PV-VEND-SHIP-CCYY TO PC-TEXT-DATE-CCYY.                 12540010
125500     MOVE PV-VEND-SHIP-MM   TO PC-TEXT-DATE-MM.                   12550010
125600     MOVE PV-VEND-SHIP-DD   TO PC-TEXT-DATE-DD.                   12560010
125700                                                                  12570010
125800     MOVE PC-TEXT-DATE      TO PC-LATE-DATE-11.                   12580010
125900                                                                  12590010
126000     MOVE PV-CAN-IFNOT-CCYY TO PC-TEXT-DATE-CCYY.                 12600010
126100     MOVE PV-CAN-IFNOT-MM   TO PC-TEXT-DATE-MM.                   12610010
126200     MOVE PV-CAN-IFNOT-DD   TO PC-TEXT-DATE-DD.                   12620010
126300                                                                  12630010
126400     MOVE PC-TEXT-DATE      TO PC-LATE-DATE-21.                   12640010
126500                                                                  12650010
126600     IF PLNSHP-EXT-CAN-DTE = PC-DEFAULT-DTE-MIN                   12660010
126700         MOVE SPACES            TO PC-LATE-DATE-31                12670010
126800     ELSE                                                         12680010
126900         MOVE PV-EXT-CAN-CCYY   TO PC-TEXT-DATE-CCYY              12690010
127000         MOVE PV-EXT-CAN-MM     TO PC-TEXT-DATE-MM                12700010
127100         MOVE PV-EXT-CAN-DD     TO PC-TEXT-DATE-DD                12710010
127200                                                                  12720010
127300         MOVE PC-TEXT-DATE      TO PC-LATE-DATE-31                12730010
127400     END-IF.                                                      12740010
127500                                                                  12750010
127600     IF  PV-TEMP-TMST = '9999-09-09-09.09.09.999999'              12760010
127700        MOVE 'ENROUTE'      TO PC-LATE-DATE-51                    12770010
127800     ELSE                                                         12780010
127900        MOVE PV-TMST-CCYY   TO PC-TEXT-DATE-CCYY                  12790010
128000        MOVE PV-TMST-MM     TO PC-TEXT-DATE-MM                    12800010
128100        MOVE PV-TMST-DD     TO PC-TEXT-DATE-DD                    12810010
128200        MOVE PC-TEXT-DATE   TO PC-LATE-DATE-51.                   12820010
128300                                                                  12830010
128400     MOVE PC-LATE-TEXT      TO TM500-FREEFORM-TEXT.               12840010
128500                                                                  12850010
128600                                                                  12860010
128700 2244-UPDATE-LATE-TROUBLE.                                        12870010
128800******************************************************************12880010
128900*    THIS PARAGRAPH CALLS PARAGRAPH 3000 WHICH WILL RESOLVE ANY   12890010
129000*    UNRESOLVED LATE OUTSIDE LIMITS TROUBLES.                     12900010
129100******************************************************************12910010
129200                                                                  12920010
129300     MOVE PC-U   TO TM500-CRUD-IND.                               12930010
129400     MOVE PC-509 TO TM500-TRBL-RSN-CDE.                           12940010
129500     PERFORM 3000-CREATE-TROUBLE-RECORD.                          12950010
129600                                                                  12960010
129700                                                                  12970010
129800 2245-UPDATE-EARLY-TROUBLE.                                       12980010
129900******************************************************************12990010
130000*    THIS PARAGRAPH CALLS PARAGRAPH 3000 WHICH WILL RESOLVE ANY   13000010
130100*    UNRESOLVE EARLY OUTSIDE LIMITS TROUBLES.                     13010010
130200******************************************************************13020010
130300                                                                  13030010
130400     MOVE PC-U   TO TM500-CRUD-IND.                               13040010
130500     MOVE PC-502 TO TM500-TRBL-RSN-CDE.                           13050010
130600     PERFORM 3000-CREATE-TROUBLE-RECORD.                          13060010
130700                                                                  13070010
130800 2500-TRBL-379-405-CHK.                                           13080010
130900     INITIALIZE PS-CHECK-PKG-CDE-SW                               13090010
131000                PS-CREATE-379-405-TRBL-SW                         13100010
131100     PERFORM 2510-GET-TRECEIV                                     13110010
131200     IF PS-NOT-DONE                                               13120010
131300         MOVE TM500-OPER-UNT-ID TO DK-LOCATION-NBR                13130010
131400         PERFORM 2520-GET-BUS-IND                                 13140010
131500         MOVE XL071-E-BUS-IND   TO PV-OPER-UNT-E                  13150010
131600     END-IF                                                       13160010
131700     IF PS-NOT-DONE                                               13170010
131800         MOVE RECEIV-CRE-OPER-UNT-ID                              13180010
131900                                TO DK-LOCATION-NBR                13190010
132000         PERFORM 2520-GET-BUS-IND                                 13200010
132100         MOVE XL071-E-BUS-IND   TO PV-CRE-OPER-UNT-E              13210010
132200     END-IF                                                       13220010
132300     IF PS-NOT-DONE                                               13230010
132400         MOVE RECEIV-CURR-OPER-UNT-ID                             13240010
132500                                TO DK-LOCATION-NBR                13250010
132600         PERFORM 2520-GET-BUS-IND                                 13260010
132700         MOVE XL071-E-BUS-IND   TO PV-CURR-OPER-UNT-E             13270010
132800     END-IF                                                       13280010
132900     IF PS-NOT-DONE                                               13290010
133000         PERFORM 2502-FINAL-CHECKING                              13300010
133100         IF PS-CREATE-379-405-TRBL                                13310010
133200            PERFORM 2501-CHECK-TKRPRPM                            13320010
133300            IF PS-ASNS-TO-WMS-YES                                 13330010
133400               IF RECEIV-CURR-OPER-UNT-ID NOT =                   13340010
133500                                           RECEIV-CRE-OPER-UNT-ID 13350010
133600                 AND PV-CRE-OPER-UNT-ECOM                         13360010
133700**  AHP - BEGIN 04/08/08                                          13370010
133800                   INITIALIZE PV-DB2-COUNT                        13380010
133900                   PERFORM 2530-CHECK-FOR-REPURP                  13390010
134000                   IF PV-DB2-COUNT > 0                            13400010
134100                       MOVE PC-C        TO TM500-CRUD-IND         13410010
134200                       MOVE PC-379      TO TM500-TRBL-RSN-CDE     13420010
134300                       PERFORM 3000-CREATE-TROUBLE-RECORD         13430010
134400                       MOVE PC-C        TO TM500-CRUD-IND         13440010
134500                       MOVE PC-405      TO TM500-TRBL-RSN-CDE     13450010
134600                       PERFORM 3000-CREATE-TROUBLE-RECORD         13460010
134700                       SET TM500-IN-TROUBLE TO TRUE               13470010
134800                   END-IF                                         13480010
134900               END-IF                                             13490010
135000            ELSE                                                  13500010
135100                INITIALIZE PV-DB2-COUNT                           13510010
135200                PERFORM 2530-CHECK-FOR-REPURP                     13520010
135300                IF PV-DB2-COUNT > 0                               13530010
135400                    MOVE PC-C     TO TM500-CRUD-IND               13540010
135500                    MOVE PC-379   TO TM500-TRBL-RSN-CDE           13550010
135600                    PERFORM 3000-CREATE-TROUBLE-RECORD            13560010
135700                    MOVE PC-C     TO TM500-CRUD-IND               13570010
135800                    MOVE PC-405   TO TM500-TRBL-RSN-CDE           13580010
135900                    PERFORM 3000-CREATE-TROUBLE-RECORD            13590010
136000                    SET TM500-IN-TROUBLE TO TRUE                  13600010
136100                END-IF                                            13610010
136200            END-IF                                                13620010
136300         END-IF                                                   13630010
136400     END-IF.                                                      13640010
136500** AHP - END  - 04/08/08                                          13650010
136600*----------------------------------------------------------------*13660010
136700*  CHECK PARM TABLE TO SEE IF DC IS TURNED ON TO DOWNLOAD ASN'S   13670010
136800*  TO WMS.                                                        13680010
136900*----------------------------------------------------------------*13690010
137000 2501-CHECK-TKRPRPM.                                              13700010
137100                                                                  13710010
137200     EXEC SQL                                                     13720010
137300          SELECT   FUNC_TXT                                       13730010
137400            INTO  :KRPRPM-FUNC-TXT                                13740010
137500            FROM                                                  13750010
137600                  TKRPRPM A                                       13760010
137700            WHERE                                                 13770010
137800                  LOC_ID            = :RECEIV-CRE-OPER-UNT-ID     13780010
137900              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    13790010
138000              AND FUNC_PRC_STAT_CDE = 'AC'                        13800010
138100              AND INTFC_SYS_CDE     = 'KHL'                       13810010
138200              AND FUNC_TXT          = 'Y'                         13820010
138300              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           13830010
138400     END-EXEC.                                                    13840010
138500                                                                  13850010
138600     EVALUATE TRUE                                                13860010
138700         WHEN SQLCODE = ZERO                                      13870010
138800             SET PS-ASNS-TO-WMS-YES    TO TRUE                    13880010
138900         WHEN SQLCODE = +100                                      13890010
139000             SET PS-ASNS-TO-WMS-NO     TO TRUE                    13900010
139100         WHEN SQLWARN0 NOT = SPACES                               13910010
139200         WHEN SQLCODE  NOT = ZERO                                 13920010
139300             SET PS-DONE  TO TRUE                                 13930010
139400             MOVE SQLCA   TO TM500-SQLCA                          13940010
139500             MOVE SQLCODE TO TM500-SQLCODE                        13950010
139600             MOVE PRV-1E  TO TM500-RETURN-DATA                    13960010
139700                                                                  13970010
139800             MOVE SPACES    TO PRV-TM500-RETURN-MSG               13980010
139900             MOVE '2510'    TO PRV-PARA                           13990010
140000             MOVE 'TKRPRPM' TO PRV-TBL                            14000010
140100             PERFORM 9999-RETURN-MSG                              14010010
140200     END-EVALUATE.                                                14020010
140300                                                                  14030010
140400 2502-FINAL-CHECKING.                                             14040010
140500     IF PV-OPER-UNT-ECOM                                          14050010
140600       AND (NOT PV-CRE-OPER-UNT-ECOM)                             14060010
140700       AND (NOT PV-CURR-OPER-UNT-ECOM)                            14070010
140800         SET PS-CHECK-PKG-CDE     TO TRUE                         14080010
140900     END-IF                                                       14090010
141000     IF PS-CHECK-PKG-CDE                                          14100010
141100         IF (PURCHS-PKGNG-CDE = ' '                               14110010
141200             OR PURCHS-PKGNG-CDE = 'M'                            14120010
141300             OR PURCHS-PKGNG-CDE = 'I')                           14130010
141400             SET PS-CREATE-379-405-TRBL                           14140010
141500                                  TO TRUE                         14150010
141600         END-IF                                                   14160010
141700     END-IF.                                                      14170010
141800                                                                  14180010
141900 2510-GET-TRECEIV.                                                14190010
142000                                                                  14200010
142100     PERFORM WITH TEST AFTER                                      14210010
142200         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    14220010
142300         UNTIL   SQLCODE = +0 OR                                  14230010
142400                 PS-DONE OR                                       14240010
142500                 PV-RETRY-COUNTER > PC-MAX-RETRIES                14250010
142600                                                                  14260010
142700         EXEC SQL                                                 14270010
142800              SELECT PACK_BY_ST_IND                               14280010
142900                    ,OPER_UNT_ID                                  14290040
142910                    ,CRE_OPER_UNT_ID                              14291040
143000                    ,CURR_OPER_UNT_ID                             14300010
143100                    ,PKGNG_CDE                                    14310010
143200                INTO :RECEIV-PACK-BY-ST-IND                       14320010
143300                    ,:RECEIV-OPER-UNT-ID                          14330040
143310                    ,:RECEIV-CRE-OPER-UNT-ID                      14331040
143400                    ,:RECEIV-CURR-OPER-UNT-ID                     14340010
143500                    ,:RECEIV-PKGNG-CDE                            14350010
143600                FROM TRECEIV                                      14360010
143700               WHERE OPER_UNT_ID    = :TM500-OPER-UNT-ID          14370010
143800                 AND FCLTY_ID       = :TM500-FCLTY-ID             14380010
143900                 AND ORD_NBR        = :TM500-PO-NBR               14390010
144000                 AND REC_SEQ_NBR    = :TM500-REC-SEQ-NBR          14400010
144100                 AND VER_STATUS_CDE = :PC-ACTIVE                  14410010
144200         END-EXEC                                                 14420010
144300                                                                  14430010
144400         EVALUATE TRUE                                            14440010
144500             WHEN SQLCODE = +0                                    14450010
144600                  CONTINUE                                        14460010
144700                                                                  14470010
144800             WHEN SQLCODE = -904                                  14480010
144900             WHEN SQLCODE = -911                                  14490010
145000             WHEN SQLCODE = -913                                  14500010
145100                  CONTINUE                                        14510010
145200                                                                  14520010
145300             WHEN OTHER                                           14530010
145400                  SET PS-DONE  TO TRUE                            14540010
145500                  MOVE SQLCA   TO TM500-SQLCA                     14550010
145600                  MOVE SQLCODE TO TM500-SQLCODE                   14560010
145700                  MOVE PRV-1E  TO TM500-RETURN-DATA               14570010
145800                                                                  14580010
145900                  MOVE SPACES    TO PRV-TM500-RETURN-MSG          14590010
146000                  MOVE '2510'    TO PRV-PARA                      14600010
146100                  MOVE 'TRECEIV' TO PRV-TBL                       14610010
146200                  PERFORM 9999-RETURN-MSG                         14620010
146300         END-EVALUATE                                             14630010
146400     END-PERFORM.                                                 14640010
146500                                                                  14650010
146600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         14660010
146700         SET PS-DONE  TO TRUE                                     14670010
146800         MOVE SQLCA   TO TM500-SQLCA                              14680010
146900         MOVE SQLCODE TO TM500-SQLCODE                            14690010
147000         MOVE PRV-1E  TO TM500-RETURN-DATA                        14700010
147100                                                                  14710010
147200         MOVE SPACES    TO PRV-TM500-RETURN-MSG                   14720010
147300         MOVE '2510'    TO PRV-PARA                               14730010
147400         MOVE 'TRECEIV' TO PRV-TBL                                14740010
147500         PERFORM 9999-RETURN-MSG                                  14750010
147600     END-IF.                                                      14760010
147700                                                                  14770010
147800 2520-GET-BUS-IND.                                                14780010
147900     INITIALIZE XL071-COMMAREA-REC.                               14790010
148000     MOVE DK-LOCATION-NBR            TO XL071-LOCATION-NUMBER.    14800010
148100                                                                  14810010
148200     CALL XL071-LOCATION-MODULE  USING  DFHEIBLK                  14820010
148300                                        XL071-COMMAREA            14830010
148400                                        XL071-COMMAREA-REC.       14840010
148500     EVALUATE TRUE                                                14850010
148600         WHEN XL071-NO-ERRORS                                     14860010
148700         WHEN XL071-DC-ASGMT-NOT-FND                              14870010
148800             CONTINUE                                             14880010
148900         WHEN OTHER                                               14890010
149000             SET PS-DONE    TO TRUE                               14900010
149100             MOVE XL071-SQLCA                                     14910010
149200                            TO TM500-SQLCA                        14920010
149300             MOVE XL071-SQLCODE                                   14930010
149400                            TO TM500-SQLCODE                      14940010
149500             MOVE PRV-1F    TO TM500-RETURN-DATA                  14950010
149600             MOVE SPACES    TO PRV-TM500-RETURN-MSG               14960010
149700             MOVE '2520'    TO PRV-PARA                           14970010
149800             MOVE XL071-DB2-TABLE                                 14980010
149900                            TO PRV-TBL                            14990010
150000             PERFORM 9999-RETURN-MSG                              15000010
150100     END-EVALUATE.                                                15010010
150200                                                                  15020010
150300**  AHP - BEGIN - 04/08/08                                        15030010
150400 2530-CHECK-FOR-REPURP.                                           15040010
150500                                                                  15050010
150600     PERFORM WITH TEST AFTER                                      15060010
150700         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    15070010
150800         UNTIL   SQLCODE = +0 OR                                  15080010
150900                 PS-DONE OR                                       15090010
151000                 PV-RETRY-COUNTER > PC-MAX-RETRIES                15100010
151100                                                                  15110010
151200         EXEC SQL                                                 15120010
151300            SELECT   COUNT(*)                                     15130010
151400            INTO :PV-DB2-COUNT                                    15140010
151500            FROM                                                  15150010
151600                  WST_INTGRTN_TYP  A                              15160010
151700               ,  WST_ATTR_DEFN    B                              15170010
151800               ,  WST_ATTR_ELEM    C                              15180010
151900               ,  WST_ATTR_ELEM    D                              15190010
152000               ,  WST_ATTR_ELEM    E                              15200010
152100               ,  WST_ATTR_ELEM    F                              15210010
152200               ,  WST_ATTR_ELEM    G                              15220010
152300           WHERE                                                  15230010
152400              A.INTGRTN_TYP_CDE   = 'EFCREPURP'                   15240010
152500             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          15250010
152600             AND B.ATTR_DEFN_SEQ_NBR = 1                          15260010
152700             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          15270010
152800             AND C.ATTR_DEFN_SEQ_NBR = 1                          15280010
152900             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          15290010
153000             AND D.ATTR_DEFN_SEQ_NBR = 2                          15300010
153100             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          15310010
153200             AND E.ATTR_DEFN_SEQ_NBR = 3                          15320010
153300             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          15330010
153400             AND F.ATTR_DEFN_SEQ_NBR = 4                          15340010
153500             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          15350010
153600             AND G.ATTR_DEFN_SEQ_NBR = 5                          15360010
153700             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        15370010
153800             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        15380010
153900             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        15390010
154000             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        15400010
154100             AND C.ATTR_ELEM_NBR     = :RECEIV-CURR-OPER-UNT-ID   15410010
154200             AND D.ATTR_ELEM_NBR     = :TM500-OPER-UNT-ID         15420010
154300             AND E.ATTR_ELEM_TXT     = 'Y'                        15430010
154400             AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP          15440010
154500       AND G.ATTR_ELEM_TMST = '9999-09-09-23.59.59.999999'        15450010
154600         END-EXEC                                                 15460010
154700                                                                  15470010
154800***  C.ATTR_ELEM_NBR = 1 = DC NUMBER                              15480010
154900***  D.ATTR_ELEM_NBR = 2 = EFC NUMBER                             15490010
155000                                                                  15500010
155100***  WHEN 810 PROCESING FOR 870, CURR OPER = 810, CRE OPER = 870  15510010
155200                                                                  15520010
155300         EVALUATE TRUE                                            15530010
155400             WHEN SQLCODE = +0                                    15540010
155500                  CONTINUE                                        15550010
155600                                                                  15560010
155700             WHEN SQLCODE = -904                                  15570010
155800             WHEN SQLCODE = -911                                  15580010
155900             WHEN SQLCODE = -913                                  15590010
156000                  CONTINUE                                        15600010
156100                                                                  15610010
156200             WHEN OTHER                                           15620010
156300                 SET PS-DONE  TO TRUE                             15630010
156400                 MOVE SQLCA   TO TM500-SQLCA                      15640010
156500                 MOVE SQLCODE TO TM500-SQLCODE                    15650010
156600                 MOVE PRV-1E  TO TM500-RETURN-DATA                15660010
156700                                                                  15670010
156800                 MOVE SPACES    TO PRV-TM500-RETURN-MSG           15680010
156900                 MOVE '2530'            TO PRV-PARA               15690010
157000                 MOVE 'WST_INTGRTN_TYP' TO PRV-TBL                15700010
157100                 PERFORM 9999-RETURN-MSG                          15710010
157200         END-EVALUATE                                             15720010
157300     END-PERFORM.                                                 15730010
157400                                                                  15740010
157500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         15750010
157600         SET PS-DONE  TO TRUE                                     15760010
157700         MOVE SQLCA   TO TM500-SQLCA                              15770010
157800         MOVE SQLCODE TO TM500-SQLCODE                            15780010
157900         MOVE PRV-1E  TO TM500-RETURN-DATA                        15790010
158000                                                                  15800010
158100         MOVE SPACES    TO PRV-TM500-RETURN-MSG                   15810010
158200         MOVE '2530'    TO PRV-PARA                               15820010
158300         MOVE 'WST_INTGRTN_TYP' TO PRV-TBL                        15830010
158400         PERFORM 9999-RETURN-MSG                                  15840010
158500     END-IF.                                                      15850010
158600** AHP - END  - 04/08/08                                          15860010
158700                                                                  15870010
158710                                                                  15871034
158800****************************************************************  15880034
158900* DETERMINE WHICH OPER TO USE FOR CHECKING AUTO-TROUBLE CREATE    15890034
159000* DMH 10/2016 - BEGIN                                             15900034
159100****************************************************************  15910034
159200 2620-CHECK-AUTO-TRBL-OPER.                                       15920034
159300                                                                  15930034
159400     MOVE  ZEROES                     TO  DK-AUTOTRB-OPER.        15940039
159500     SET   PS-AUTOTR-CRE-OPER                                     15950034
159600           PS-AUTOTRB-OPER-DC                                     15960039
159700           PS-CREATE-BOTH             TO  TRUE.                   15970034
159800                                                                  15980034
159900* CHECK TROUBLE AT DEPT LEVEL                                     15990034
160000     EXEC SQL                                                     16000034
160100          SELECT  A.FUNC_TXT                                      16010034
160110               ,  B.E_BUS_IND                                     16011034
160111               ,  C.E_BUS_IND                                     16011140
160120               ,  D.E_BUS_IND                                     16012040
160200            INTO  :PS-AUTOTR-CRE-CURR-SW                          16020034
160210               ,  :PV-RCVR-OPER-TYPE                              16021040
160211               ,  :PV-CRE-OPER-TYPE                               16021140
160220               ,  :PV-CURR-OPER-TYPE                              16022034
160300            FROM  TKRPRPM A                                       16030034
160311               ,  XLT_LOC B                                       16031134
160320               ,  XLT_LOC C                                       16032034
160330               ,  XLT_LOC D                                       16033040
160400            WHERE A.LOC_ID            =  90                       16040036
160500              AND A.SYS_PRC_FUNC_CDE  = 'AUTRBO'                  16050034
160600              AND A.FUNC_PRC_STAT_CDE = 'AC'                      16060034
160700              AND A.INTFC_SYS_CDE     = 'KHL'                     16070034
160900              AND A.FUNC_BEG_TMST    <= CURRENT TIMESTAMP         16090034
161000              AND A.FUNC_END_TMST    >= CURRENT TIMESTAMP         16100034
161010              AND B.LOC_NBR           = :RECEIV-OPER-UNT-ID       16101040
161011              AND C.LOC_NBR           = :RECEIV-CRE-OPER-UNT-ID   16101140
161020              AND D.LOC_NBR           = :RECEIV-CURR-OPER-UNT-ID  16102040
161100     END-EXEC.                                                    16110034
161200                                                                  16120034
161300     EVALUATE TRUE                                                16130034
161400         WHEN SQLCODE = ZERO                                      16140034
161600         WHEN SQLCODE = +100                                      16160034
161601         WHEN SQLCODE = -305                                      16160153
161610              CONTINUE                                            16161035
161800         WHEN SQLWARN0 NOT = SPACES                               16180034
161900         WHEN SQLCODE  NOT = ZERO                                 16190034
162000             SET PS-DONE    TO TRUE                               16200034
162100             MOVE SQLCA     TO TM500-SQLCA                        16210034
162200             MOVE SQLCODE   TO TM500-SQLCODE                      16220034
162300             MOVE PRV-1I    TO TM500-RETURN-DATA                  16230034
162400             MOVE 'AUTRBO'  TO PRV-TM500-RETURN-MSG               16240034
162500             MOVE '2620'    TO PRV-PARA                           16250034
162600             MOVE 'TKRPRPM' TO PRV-TBL                            16260034
162700             PERFORM 9999-RETURN-MSG                              16270034
162800     END-EVALUATE.                                                16280034
162900                                                                  16290051
162910*** TEST ONLY - BEGIN                                             16291041
163100***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16310051
163200***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-OPER            16320051
163310***     MOVE  TM500-PO-NBR             TO PV-DISP-PO              16331051
163330***     MOVE  TM500-REC-SEQ-NBR        TO PV-DISP-RCVR            16333051
163331***     MOVE  TM500-PO-LNE-NBR         TO PV-DISP-LINE            16333151
163332***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16333251
163333***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16333351
163334***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16333451
163340***                                                               16334051
163400***     STRING ' RCKCS234-2620-AUTRBO   '                         16340051
163500***             PV-DISP-OPER '-'                                  16350051
163510***             PV-DISP-PO   '-'                                  16351051
163520***             PV-DISP-RCVR '-'                                  16352051
163530***             PV-DISP-LINE               DELIMITED BY SIZE      16353051
163600***                                 INTO PV-CICS-MSG-AREA         16360051
163700***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16370051
163800***                                   TO PV-COMMAREA-LENGTH       16380051
163900***     EXEC CICS                                                 16390051
164000***         WRITEQ TD                                             16400051
164100***             QUEUE   ('CSSL')                                  16410051
164200***             FROM    (PV-CICS-MSG-AREA )                       16420051
164300***             LENGTH  (PV-COMMAREA-LENGTH)                      16430051
164400***             RESP    (PV-CICS-RESP)                            16440051
164500***     END-EXEC                                                  16450051
164601***                                                               16460151
164610***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16461051
164620***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16462051
164630***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16463051
164640***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16464051
164690***     STRING ' RCKCS234-2620-AUTRBO   '                         16469051
164691***            'USE OPER:' PS-AUTOTR-CRE-CURR-SW                  16469151
164692***            '  '                                               16469251
164693***            'RCV:' PV-DISP-RCV-OPER ' ' PV-RCVR-OPER-TYPE      16469351
164694***            '  '                                               16469451
164695***            'CRE:' PV-DISP-CRE-OPER ' ' PV-CRE-OPER-TYPE       16469551
164696***            '  '                                               16469651
164697***            'CUR:' PV-DISP-CUR-OPER ' ' PV-CURR-OPER-TYPE      16469751
164698***                                        DELIMITED BY SIZE      16469851
164699***                                 INTO PV-CICS-MSG-AREA         16469951
164700***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16470051
164701***                                   TO PV-COMMAREA-LENGTH       16470151
164702***     EXEC CICS                                                 16470251
164703***         WRITEQ TD                                             16470351
164704***             QUEUE   ('CSSL')                                  16470451
164710***             FROM    (PV-CICS-MSG-AREA )                       16471051
164720***             LENGTH  (PV-COMMAREA-LENGTH)                      16472051
164730***             RESP    (PV-CICS-RESP)                            16473051
164740***     END-EXEC.                                                 16474051
164750***                                                               16475051
164751***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16475151
164752***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16475251
164753***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16475351
164755***     STRING ' RCKCS234-2620-AUTRBO   '                         16475551
164758***            'TM500:' PV-DISP-TM500-OPER  '-'                   16475851
164760***                     PV-DISP-TM500-FCLTY                       16476051
164763***                                        DELIMITED BY SIZE      16476351
164764***                                 INTO PV-CICS-MSG-AREA         16476451
164765***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16476551
164766***                                   TO PV-COMMAREA-LENGTH       16476651
164767***     EXEC CICS                                                 16476751
164768***         WRITEQ TD                                             16476851
164769***             QUEUE   ('CSSL')                                  16476951
164770***             FROM    (PV-CICS-MSG-AREA )                       16477051
164771***             LENGTH  (PV-COMMAREA-LENGTH)                      16477151
164772***             RESP    (PV-CICS-RESP)                            16477251
164773***     END-EXEC.                                                 16477351
164780*** TEST ONLY - END                                               16478041
164800                                                                  16480041
164914                                                                  16491410
164920                                                                  16492010
164930****************************************************************  16493010
164940* DETERMINE WHICH AUTO TROUBLE WILL BE CHECKED                    16494010
164941* DMH 6/2/14 - BEGIN                                              16494110
164950****************************************************************  16495010
165000 2625-DETERMINE-TRBL-CHECK.                                       16500010
165019                                                                  16501910
165020     SET  PS-CHECK-AUTRB1-NO                                      16502010
165021          PS-CHECK-AUTRB2-NO                                      16502110
165022          PS-CHECK-AUTRB3-NO                                      16502255
165023          PS-CONTINUE-TRBL-CHECK-YES                              16502355
165024          PS-CREATE-CNTL-FLOW-NO      TO  TRUE.                   16502455
165025                                                                  16502555
165026* CHECK TROUBLE AT DEPT LEVEL                                     16502655
165027     EXEC SQL                                                     16502755
165028          SELECT  FUNC_TXT                                        16502855
165029            INTO  :PS-CHECK-AUTRB1-SW                             16502955
165030            FROM  TKRPRPM                                         16503055
165031            WHERE LOC_ID            = :DK-AUTOTRB-OPER            16503155
165032              AND SYS_PRC_FUNC_CDE  = 'AUTRB1'                    16503255
165033              AND FUNC_PRC_STAT_CDE = 'AC'                        16503355
165034              AND INTFC_SYS_CDE     = 'KHL'                       16503455
165035              AND FUNC_TXT          = 'Y'                         16503555
165036              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           16503655
165037              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           16503755
165038     END-EXEC.                                                    16503855
165039                                                                  16503955
165040     EVALUATE TRUE                                                16504055
165041         WHEN SQLCODE = ZERO                                      16504155
165042             SET PS-CHECK-AUTRB1-YES   TO TRUE                    16504255
165043         WHEN SQLCODE = +100                                      16504355
165044             SET PS-CHECK-AUTRB1-NO    TO TRUE                    16504455
165045         WHEN SQLWARN0 NOT = SPACES                               16504555
165046         WHEN SQLCODE  NOT = ZERO                                 16504655
165047             SET PS-DONE    TO TRUE                               16504755
165048             MOVE SQLCA     TO TM500-SQLCA                        16504855
165049             MOVE SQLCODE   TO TM500-SQLCODE                      16504955
165050             MOVE PRV-1I    TO TM500-RETURN-DATA                  16505055
165051             MOVE 'AUTRB1'  TO PRV-TM500-RETURN-MSG               16505155
165052             MOVE '2625'    TO PRV-PARA                           16505255
165053             MOVE 'TKRPRPM' TO PRV-TBL                            16505355
165054             PERFORM 9999-RETURN-MSG                              16505455
165055     END-EVALUATE.                                                16505555
165056                                                                  16505655
165057* CHECK TROUBLE AT VENDOR/DEPT LEVEL                              16505755
165058     EXEC SQL                                                     16505855
165059          SELECT  FUNC_TXT                                        16505955
165060            INTO  :PS-CHECK-AUTRB2-SW                             16506055
165061            FROM  TKRPRPM                                         16506155
165062            WHERE LOC_ID            = :DK-AUTOTRB-OPER            16506255
165063              AND SYS_PRC_FUNC_CDE  = 'AUTRB2'                    16506355
165064              AND FUNC_PRC_STAT_CDE = 'AC'                        16506455
165065              AND INTFC_SYS_CDE     = 'KHL'                       16506555
165066              AND FUNC_TXT          = 'Y'                         16506655
165067              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           16506755
165068              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           16506855
165069     END-EXEC.                                                    16506955
165070                                                                  16507055
165071     EVALUATE TRUE                                                16507155
165072         WHEN SQLCODE = ZERO                                      16507255
165073             SET PS-CHECK-AUTRB2-YES   TO TRUE                    16507355
165074         WHEN SQLCODE = +100                                      16507455
165075             SET PS-CHECK-AUTRB2-NO    TO TRUE                    16507555
165076         WHEN SQLWARN0 NOT = SPACES                               16507655
165077         WHEN SQLCODE  NOT = ZERO                                 16507755
165078             SET PS-DONE    TO TRUE                               16507855
165079             MOVE SQLCA     TO TM500-SQLCA                        16507955
165080             MOVE SQLCODE   TO TM500-SQLCODE                      16508055
165081             MOVE PRV-1I    TO TM500-RETURN-DATA                  16508155
165082             MOVE 'AUTRB2'  TO PRV-TM500-RETURN-MSG               16508255
165083             MOVE '2625'    TO PRV-PARA                           16508355
165084             MOVE 'TKRPRPM' TO PRV-TBL                            16508455
165085             PERFORM 9999-RETURN-MSG                              16508555
165086     END-EVALUATE.                                                16508655
165090                                                                  16509012
165100* CHECK TROUBLE AT PRO (FREIGHT BILL)                             16510055
165110     EXEC SQL                                                     16511055
165120          SELECT  FUNC_TXT                                        16512055
165130            INTO  :PS-CHECK-AUTRB3-SW                             16513055
165140            FROM  TKRPRPM                                         16514055
165141            WHERE LOC_ID            = :DK-AUTOTRB-OPER            16514155
165142              AND SYS_PRC_FUNC_CDE  = 'AUTRB3'                    16514255
165143              AND FUNC_PRC_STAT_CDE = 'AC'                        16514355
165144              AND INTFC_SYS_CDE     = 'KHL'                       16514455
165145              AND FUNC_TXT          = 'Y'                         16514555
165146              AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP           16514655
165147              AND FUNC_END_TMST    >= CURRENT TIMESTAMP           16514755
165148     END-EXEC.                                                    16514855
165149                                                                  16514955
165150     EVALUATE TRUE                                                16515055
165151         WHEN SQLCODE = ZERO                                      16515155
165152             SET PS-CHECK-AUTRB3-YES   TO TRUE                    16515255
165153         WHEN SQLCODE = +100                                      16515355
165154             SET PS-CHECK-AUTRB3-NO    TO TRUE                    16515455
165155         WHEN SQLWARN0 NOT = SPACES                               16515555
165156         WHEN SQLCODE  NOT = ZERO                                 16515655
165157             SET PS-DONE    TO TRUE                               16515755
165158             MOVE SQLCA     TO TM500-SQLCA                        16515855
165159             MOVE SQLCODE   TO TM500-SQLCODE                      16515955
165160             MOVE PRV-1I    TO TM500-RETURN-DATA                  16516055
165161             MOVE 'AUTRB3'  TO PRV-TM500-RETURN-MSG               16516155
165162             MOVE '2625'    TO PRV-PARA                           16516255
165163             MOVE 'TKRPRPM' TO PRV-TBL                            16516355
165164             PERFORM 9999-RETURN-MSG                              16516455
165165     END-EVALUATE.                                                16516555
165167                                                                  16516727
165168                                                                  16516863
165169*** TEST ONLY - BEGIN                                             16516963
165170***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16517067
165171***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-OPER            16517167
165172***     MOVE  TM500-PO-NBR             TO PV-DISP-PO              16517267
165173***     MOVE  TM500-REC-SEQ-NBR        TO PV-DISP-RCVR            16517367
165174***     MOVE  TM500-PO-LNE-NBR         TO PV-DISP-LINE            16517467
165175***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16517567
165176***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16517667
165177***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16517767
165178***                                                               16517867
165179***     STRING ' RCKCS234-2625-DETERMINE-TRBL-CHECK-AUTRB3 '      16517967
165181***             PV-DISP-OPER '-'                                  16518167
165182***             PV-DISP-PO   '-'                                  16518267
165183***             PV-DISP-RCVR '-'                                  16518367
165184***             PV-DISP-LINE               DELIMITED BY SIZE      16518467
165185***                                 INTO PV-CICS-MSG-AREA         16518567
165186***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16518667
165187***                                   TO PV-COMMAREA-LENGTH       16518767
165188***     EXEC CICS                                                 16518867
165189***         WRITEQ TD                                             16518967
165190***             QUEUE   ('CSSL')                                  16519067
165191***             FROM    (PV-CICS-MSG-AREA )                       16519167
165192***             LENGTH  (PV-COMMAREA-LENGTH)                      16519267
165193***             RESP    (PV-CICS-RESP)                            16519367
165194***     END-EXEC                                                  16519467
165195***                                                               16519567
165196***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16519667
165197***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16519767
165198***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16519867
165199***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16519967
165200***     STRING ' RCKCS234-2625-AUTRB3 '                           16520067
165201***            'USE OPER:' PS-AUTOTR-CRE-CURR-SW                  16520167
165202***            '  '                                               16520267
165203***            'RCV:' PV-DISP-RCV-OPER ' ' PV-RCVR-OPER-TYPE      16520367
165204***            '  '                                               16520467
165205***            'CRE:' PV-DISP-CRE-OPER ' ' PV-CRE-OPER-TYPE       16520567
165206***            '  '                                               16520667
165207***            'CUR:' PV-DISP-CUR-OPER ' ' PV-CURR-OPER-TYPE      16520767
165208***                                        DELIMITED BY SIZE      16520867
165209***                                 INTO PV-CICS-MSG-AREA         16520967
165210***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16521067
165211***                                   TO PV-COMMAREA-LENGTH       16521167
165212***     EXEC CICS                                                 16521267
165213***         WRITEQ TD                                             16521367
165214***             QUEUE   ('CSSL')                                  16521467
165215***             FROM    (PV-CICS-MSG-AREA )                       16521567
165216***             LENGTH  (PV-COMMAREA-LENGTH)                      16521667
165217***             RESP    (PV-CICS-RESP)                            16521767
165218***     END-EXEC.                                                 16521867
165219***                                                               16521967
165220***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16522067
165221***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16522167
165222***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16522267
165223***     STRING ' RCKCS234-2625-AUTRB3 '                           16522367
165224***            'TM500:' PV-DISP-TM500-OPER  '-'                   16522467
165225***                     PV-DISP-TM500-FCLTY                       16522567
165226***                                        DELIMITED BY SIZE      16522667
165227***                                 INTO PV-CICS-MSG-AREA         16522767
165228***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16522867
165229***                                   TO PV-COMMAREA-LENGTH       16522967
165230***     EXEC CICS                                                 16523067
165231***         WRITEQ TD                                             16523167
165232***             QUEUE   ('CSSL')                                  16523267
165233***             FROM    (PV-CICS-MSG-AREA )                       16523367
165234***             LENGTH  (PV-COMMAREA-LENGTH)                      16523467
165235***             RESP    (PV-CICS-RESP)                            16523567
165236***     END-EXEC.                                                 16523667
165237***                                                               16523767
165238***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16523867
165239***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16523967
165240***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16524067
165241***     STRING ' RCKCS234-2625-AUTRB3 '                           16524167
165242***            'SW:'    PS-CONTINUE-TRBL-CHECK-SW  ':'            16524267
165243***                     PS-CHECK-AUTRB3-SW         ':'            16524367
165244***                                        DELIMITED BY SIZE      16524467
165245***                                 INTO PV-CICS-MSG-AREA         16524567
165246***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16524667
165247***                                   TO PV-COMMAREA-LENGTH       16524767
165248***     EXEC CICS                                                 16524867
165249***         WRITEQ TD                                             16524967
165250***             QUEUE   ('CSSL')                                  16525067
165251***             FROM    (PV-CICS-MSG-AREA )                       16525167
165252***             LENGTH  (PV-COMMAREA-LENGTH)                      16525267
165253***             RESP    (PV-CICS-RESP)                            16525367
165254***     END-EXEC.                                                 16525468
165255*** TEST ONLY - END                                               16525563
165256                                                                  16525663
165257                                                                  16525763
165258****************************************************************  16525863
165259* DETERMINE WHICH AUTO TROUBLE WILL BE CHECKED                    16525963
165260* DMH 6/2/14 - BEGIN                                              16526063
165261****************************************************************  16526163
165262 2630-CNTL-FLOW-TRBL-PROCESSING.                                  16526263
165263                                                                  16526367
165264*** TEST ONLY - BEGIN                                             16526463
165265***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16526567
165266***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-OPER            16526667
165267***     MOVE  TM500-PO-NBR             TO PV-DISP-PO              16526767
165268***     MOVE  TM500-REC-SEQ-NBR        TO PV-DISP-RCVR            16526867
165269***     MOVE  TM500-PO-LNE-NBR         TO PV-DISP-LINE            16526967
165270***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16527067
165271***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16527167
165272***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16527267
165273***                                                               16527367
165274***     STRING ' RCKCS234-2630-AUTRB3   '                         16527467
165275***             PV-DISP-OPER '-'                                  16527567
165276***             PV-DISP-PO   '-'                                  16527667
165277***             PV-DISP-RCVR '-'                                  16527767
165278***             PV-DISP-LINE               DELIMITED BY SIZE      16527867
165279***                                 INTO PV-CICS-MSG-AREA         16527967
165280***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16528067
165281***                                   TO PV-COMMAREA-LENGTH       16528167
165282***     EXEC CICS                                                 16528267
165283***         WRITEQ TD                                             16528367
165284***             QUEUE   ('CSSL')                                  16528467
165285***             FROM    (PV-CICS-MSG-AREA )                       16528567
165286***             LENGTH  (PV-COMMAREA-LENGTH)                      16528667
165287***             RESP    (PV-CICS-RESP)                            16528767
165288***     END-EXEC                                                  16528867
165289***                                                               16528967
165290***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16529067
165291***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16529167
165292***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16529267
165293***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16529367
165294***     STRING ' RCKCS234-2630-AUTRB3   '                         16529467
165295***            'USE OPER:' PS-AUTOTR-CRE-CURR-SW                  16529567
165296***            '  '                                               16529667
165297***            'RCV:' PV-DISP-RCV-OPER ' ' PV-RCVR-OPER-TYPE      16529767
165298***            '  '                                               16529867
165299***            'CRE:' PV-DISP-CRE-OPER ' ' PV-CRE-OPER-TYPE       16529967
165300***            '  '                                               16530067
165301***            'CUR:' PV-DISP-CUR-OPER ' ' PV-CURR-OPER-TYPE      16530167
165302***                                        DELIMITED BY SIZE      16530267
165303***                                 INTO PV-CICS-MSG-AREA         16530367
165304***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16530467
165305***                                   TO PV-COMMAREA-LENGTH       16530567
165306***     EXEC CICS                                                 16530667
165307***         WRITEQ TD                                             16530767
165308***             QUEUE   ('CSSL')                                  16530867
165309***             FROM    (PV-CICS-MSG-AREA )                       16530967
165310***             LENGTH  (PV-COMMAREA-LENGTH)                      16531067
165311***             RESP    (PV-CICS-RESP)                            16531167
165312***     END-EXEC.                                                 16531267
165313***                                                               16531367
165314***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16531467
165315***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16531567
165316***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16531667
165317***     STRING ' RCKCS234-2630-AUTRB3   '                         16531767
165318***            'TM500:' PV-DISP-TM500-OPER  '-'                   16531867
165319***                     PV-DISP-TM500-FCLTY                       16531967
165320***                                        DELIMITED BY SIZE      16532067
165321***                                 INTO PV-CICS-MSG-AREA         16532167
165322***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16532267
165323***                                   TO PV-COMMAREA-LENGTH       16532367
165324***     EXEC CICS                                                 16532467
165325***         WRITEQ TD                                             16532567
165326***             QUEUE   ('CSSL')                                  16532667
165327***             FROM    (PV-CICS-MSG-AREA )                       16532767
165328***             LENGTH  (PV-COMMAREA-LENGTH)                      16532867
165329***             RESP    (PV-CICS-RESP)                            16532967
165330***     END-EXEC.                                                 16533067
165331***                                                               16533167
165332***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16533267
165333***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16533367
165334***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16533467
165335***     STRING ' RCKCS234-2630-AUTRB3   '                         16533567
165336***            'SW:'    PS-CONTINUE-TRBL-CHECK-SW                 16533667
165337***                     PS-CHECK-AUTRB3-SW                        16533767
165338***                                        DELIMITED BY SIZE      16533867
165339***                                 INTO PV-CICS-MSG-AREA         16533967
165340***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16534067
165341***                                   TO PV-COMMAREA-LENGTH       16534167
165342***     EXEC CICS                                                 16534267
165343***         WRITEQ TD                                             16534367
165344***             QUEUE   ('CSSL')                                  16534467
165345***             FROM    (PV-CICS-MSG-AREA )                       16534567
165346***             LENGTH  (PV-COMMAREA-LENGTH)                      16534667
165347***             RESP    (PV-CICS-RESP)                            16534767
165348***     END-EXEC.                                                 16534867
165349*** TEST ONLY - END                                               16534963
165350                                                                  16535063
165351     IF  PS-CONTINUE-TRBL-CHECK-YES  AND                          16535163
165352         PS-CHECK-AUTRB3-YES                                      16535263
165353         PERFORM 2660-CHK-BULK-PRO                                16535363
165354         IF  RECEIV-PKGNG-CDE = 'B'  AND                          16535463
165355             PKSLIP-PRO-NBR   > SPACES                            16535563
165356             MOVE  PKSLIP-PRO-NBR   TO  PV-CNTL-FLOW-PRO          16535663
165357             PERFORM 2665-CHK-PRO-TRBL                            16535763
165358         END-IF                                                   16535863
165359     END-IF.                                                      16535963
165360                                                                  16536067
165361*** TEST ONLY - BEGIN                                             16536163
165362***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16536267
165363***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-OPER            16536367
165364***     MOVE  TM500-PO-NBR             TO PV-DISP-PO              16536467
165365***     MOVE  TM500-REC-SEQ-NBR        TO PV-DISP-RCVR            16536567
165366***     MOVE  TM500-PO-LNE-NBR         TO PV-DISP-LINE            16536667
165367***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16536767
165368***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16536867
165369***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16536967
165370***                                                               16537067
165371***     STRING ' RCKCS234-2630-AUTRB3   '                         16537167
165372***             PV-DISP-OPER '-'                                  16537267
165373***             PV-DISP-PO   '-'                                  16537367
165374***             PV-DISP-RCVR '-'                                  16537467
165375***             PV-DISP-LINE               DELIMITED BY SIZE      16537567
165376***                                 INTO PV-CICS-MSG-AREA         16537667
165377***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16537767
165378***                                   TO PV-COMMAREA-LENGTH       16537867
165379***     EXEC CICS                                                 16537967
165380***         WRITEQ TD                                             16538067
165381***             QUEUE   ('CSSL')                                  16538167
165382***             FROM    (PV-CICS-MSG-AREA )                       16538267
165383***             LENGTH  (PV-COMMAREA-LENGTH)                      16538367
165384***             RESP    (PV-CICS-RESP)                            16538467
165385***     END-EXEC                                                  16538567
165386***                                                               16538667
165387***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16538767
165388***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16538867
165389***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16538967
165390***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16539067
165391***     STRING ' RCKCS234-2630-AUTRB3   '                         16539167
165392***            'USE OPER:' PS-AUTOTR-CRE-CURR-SW                  16539267
165393***            '  '                                               16539367
165394***            'RCV:' PV-DISP-RCV-OPER ' ' PV-RCVR-OPER-TYPE      16539467
165395***            '  '                                               16539567
165396***            'CRE:' PV-DISP-CRE-OPER ' ' PV-CRE-OPER-TYPE       16539667
165397***            '  '                                               16539767
165398***            'CUR:' PV-DISP-CUR-OPER ' ' PV-CURR-OPER-TYPE      16539867
165399***                                        DELIMITED BY SIZE      16539967
165400***                                 INTO PV-CICS-MSG-AREA         16540067
165401***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16540167
165402***                                   TO PV-COMMAREA-LENGTH       16540267
165403***     EXEC CICS                                                 16540367
165404***         WRITEQ TD                                             16540467
165405***             QUEUE   ('CSSL')                                  16540567
165406***             FROM    (PV-CICS-MSG-AREA )                       16540667
165407***             LENGTH  (PV-COMMAREA-LENGTH)                      16540767
165408***             RESP    (PV-CICS-RESP)                            16540867
165409***     END-EXEC.                                                 16540967
165410***                                                               16541067
165411***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16541167
165412***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16541267
165413***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16541367
165414***     STRING ' RCKCS234-2630-AUTRB3   '                         16541467
165415***            'TM500:' PV-DISP-TM500-OPER  '-'                   16541567
165416***                     PV-DISP-TM500-FCLTY                       16541667
165417***                                        DELIMITED BY SIZE      16541767
165418***                                 INTO PV-CICS-MSG-AREA         16541867
165419***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16541967
165420***                                   TO PV-COMMAREA-LENGTH       16542067
165421***     EXEC CICS                                                 16542167
165422***         WRITEQ TD                                             16542267
165423***             QUEUE   ('CSSL')                                  16542367
165424***             FROM    (PV-CICS-MSG-AREA )                       16542467
165425***             LENGTH  (PV-COMMAREA-LENGTH)                      16542567
165426***             RESP    (PV-CICS-RESP)                            16542667
165427***     END-EXEC.                                                 16542767
165428***                                                               16542867
165429***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16542967
165430***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16543067
165431***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16543167
165432***     STRING ' RCKCS234-2630-AUTRB3   '                         16543267
165433***            'PKGNG_CDE:'   RECEIV-PKGNG-CDE                    16543367
165434***            'PKSLIP_PRO:'  PKSLIP-PRO-NBR                      16543467
165435***                     PS-CHECK-AUTRB3-SW                        16543567
165436***                                        DELIMITED BY SIZE      16543667
165437***                                 INTO PV-CICS-MSG-AREA         16543767
165438***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16543867
165439***                                   TO PV-COMMAREA-LENGTH       16543967
165440***     EXEC CICS                                                 16544067
165441***         WRITEQ TD                                             16544167
165442***             QUEUE   ('CSSL')                                  16544267
165443***             FROM    (PV-CICS-MSG-AREA )                       16544367
165444***             LENGTH  (PV-COMMAREA-LENGTH)                      16544467
165445***             RESP    (PV-CICS-RESP)                            16544567
165446***     END-EXEC.                                                 16544667
165447*** TEST ONLY - END                                               16544763
165448                                                                  16544863
165449                                                                  16544963
165450     IF  PS-CONTINUE-TRBL-CHECK-YES  AND                          16545063
165451         PS-CHECK-AUTRB1-YES                                      16545163
165452             MOVE  PURCHS-DEPT-NBR  TO  PV-CNTL-FLOW-DEPT         16545263
165453         PERFORM 2640-CHK-DEPT-TRBL                               16545363
165454     END-IF.                                                      16545463
165455                                                                  16545563
165456     IF  PS-CONTINUE-TRBL-CHECK-YES  AND                          16545663
165457         PS-CHECK-AUTRB2-YES                                      16545763
165458             MOVE  PURCHS-DEPT-NBR  TO  PV-CNTL-FLOW-DEPT         16545863
165459             MOVE  PURCHS-ENT-ID    TO  PV-CNTL-FLOW-ENT-ID       16545963
165460         PERFORM 2650-CHK-VNDR-DEPT-TRBL                          16546063
165461     END-IF.                                                      16546163
165462                                                                  16546263
165463     IF  PS-CREATE-CNTL-FLOW-YES                                  16546363
165464         PERFORM 2685-CREATE-CNTL-FLOW-TRBL                       16546463
165465     END-IF.                                                      16546563
165466                                                                  16546663
165467                                                                  16546763
165468****************************************************************  16546863
165469* CHECK DEPT IF CONTROL FLOW TROUBLE IS NEEDED                    16546963
165470* DMH 6/2/14 - BEGIN                                              16547063
165471****************************************************************  16547163
165472 2640-CHK-DEPT-TRBL.                                              16547263
165473                                                                  16547363
165474     SET  PS-CREATE-CNTL-FLOW-NO  TO  TRUE.                       16547463
165475     MOVE PV-CNTL-FLOW-DEPT       TO  DK-CNTL-FLOW-DEPT.          16547563
165476                                                                  16547663
165477     EXEC SQL                                                     16547763
165478       SELECT D.ATTR_ELEM_NBR                                     16547863
165479         INTO :PV-CNTL-FLOW-TRBL-LBL                              16547963
165480         FROM  WST_INTGRTN_TYP  A                                 16548063
165481              ,WST_ATTR_DEFN    B                                 16548163
165482              ,WST_ATTR_ELEM    C                                 16548263
165483              ,WST_ATTR_ELEM    D                                 16548363
165484              ,WST_ATTR_ELEM    E                                 16548463
165485              ,WST_ATTR_ELEM    F                                 16548563
165486          WHERE A.INTGRTN_TYP_CDE   = 'AUTRBL01'                  16548663
165487            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           16548763
165488            AND B.ATTR_DEFN_SEQ_NBR = 1                           16548863
165489            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           16548963
165490            AND C.ATTR_DEFN_SEQ_NBR = 1                           16549063
165491            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           16549163
165492            AND D.ATTR_DEFN_SEQ_NBR = 2                           16549263
165493            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           16549363
165494            AND E.ATTR_DEFN_SEQ_NBR = 3                           16549463
165495            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           16549563
165496            AND F.ATTR_DEFN_SEQ_NBR = 4                           16549663
165497            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         16549763
165498            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         16549863
165499            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         16549963
165500            AND C.ATTR_ELEM_NBR     = :DK-CNTL-FLOW-DEPT          16550063
165501            AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           16550163
165502            AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP           16550263
165503     END-EXEC.                                                    16550363
165504                                                                  16550463
165505     EVALUATE TRUE                                                16550563
165506         WHEN SQLCODE = +0                                        16550663
165507              SET PS-CREATE-CNTL-FLOW-YES   TO  TRUE              16550763
165508              SET PS-CONTINUE-TRBL-CHECK-NO TO  TRUE              16550863
165509                                                                  16550963
165510         WHEN SQLCODE = +100                                      16551063
165511              CONTINUE                                            16551163
165512                                                                  16551263
165513         WHEN SQLCODE = -904                                      16551363
165514         WHEN SQLCODE = -911                                      16551463
165515         WHEN SQLCODE = -913                                      16551563
165516              CONTINUE                                            16551663
165517                                                                  16551763
165518         WHEN OTHER                                               16551863
165519              SET  PS-DONE         TO TRUE                        16551963
165520              MOVE SQLCA           TO TM500-SQLCA                 16552063
165521              MOVE SQLCODE         TO TM500-SQLCODE               16552163
165522              MOVE PRV-1J          TO TM500-RETURN-DATA           16552263
165523                                                                  16552363
165524              MOVE SPACES          TO PRV-TM500-RETURN-MSG        16552463
165525              STRING 'DEPT:'                                      16552563
165526                      PV-CNTL-FLOW-DEPT                           16552663
165527                                      DELIMITED BY SIZE           16552763
165528                                 INTO PRV-TM500-RETURN-MSG        16552863
165529              MOVE '2640'          TO PRV-PARA                    16552963
165530              MOVE 'WST8-10'       TO PRV-TBL                     16553063
165531              PERFORM 9999-RETURN-MSG                             16553163
165532     END-EVALUATE.                                                16553263
165533                                                                  16553363
165534                                                                  16553463
165535****************************************************************  16553563
165536* CHECK VENDOR/DEPT IF CONTROL FLOW TROUBLE IS NEEDED             16553663
165537* DMH 6/2/14 - BEGIN                                              16553763
165538****************************************************************  16553863
165539 2650-CHK-VNDR-DEPT-TRBL.                                         16553963
165540                                                                  16554063
165541     SET  PS-CREATE-CNTL-FLOW-NO  TO  TRUE.                       16554163
165542     MOVE PV-CNTL-FLOW-ENT-ID     TO  DK-CNTL-FLOW-ENT-ID.        16554263
165543     MOVE PV-CNTL-FLOW-DEPT       TO  DK-CNTL-FLOW-DEPT.          16554363
165544                                                                  16554463
165545     EXEC SQL                                                     16554563
165546       SELECT E.ATTR_ELEM_NBR                                     16554663
165547         INTO :PV-CNTL-FLOW-TRBL-LBL                              16554763
165548         FROM  WST_INTGRTN_TYP  A                                 16554863
165549              ,WST_ATTR_DEFN    B                                 16554963
165550              ,WST_ATTR_ELEM    C                                 16555063
165551              ,WST_ATTR_ELEM    D                                 16555163
165552              ,WST_ATTR_ELEM    E                                 16555263
165553              ,WST_ATTR_ELEM    F                                 16555363
165554              ,WST_ATTR_ELEM    G                                 16555463
165555        WHERE A.INTGRTN_TYP_CDE   =  'AUTRBL02'                   16555563
165556          AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE             16555663
165557          AND B.ATTR_DEFN_SEQ_NBR = 1                             16555763
165558          AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE             16555863
165559          AND C.ATTR_DEFN_SEQ_NBR = 1                             16555963
165560          AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE             16556063
165561          AND D.ATTR_DEFN_SEQ_NBR = 2                             16556163
165562          AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE             16556263
165563          AND E.ATTR_DEFN_SEQ_NBR = 3                             16556363
165564          AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE             16556463
165565          AND F.ATTR_DEFN_SEQ_NBR = 4                             16556563
165566          AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE             16556663
165567          AND G.ATTR_DEFN_SEQ_NBR = 5                             16556763
165568          AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR           16556863
165569          AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR           16556963
165570          AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR           16557063
165571          AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR           16557163
165572          AND C.ATTR_ELEM_NBR     = :DK-CNTL-FLOW-ENT-ID          16557263
165573          AND D.ATTR_ELEM_NBR     = :DK-CNTL-FLOW-DEPT            16557363
165574          AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP             16557463
165575          AND G.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP             16557563
165576     END-EXEC.                                                    16557663
165577                                                                  16557763
165578     EVALUATE TRUE                                                16557863
165579         WHEN SQLCODE = +0                                        16557963
165580              SET PS-CREATE-CNTL-FLOW-YES   TO  TRUE              16558063
165581              SET PS-CONTINUE-TRBL-CHECK-NO TO  TRUE              16558163
165582                                                                  16558263
165583         WHEN SQLCODE = +100                                      16558363
165584              CONTINUE                                            16558463
165585                                                                  16558563
165586         WHEN SQLCODE = -904                                      16558663
165587         WHEN SQLCODE = -911                                      16558763
165588         WHEN SQLCODE = -913                                      16558863
165589              CONTINUE                                            16558963
165590                                                                  16559063
165591         WHEN OTHER                                               16559163
165592              SET  PS-DONE         TO TRUE                        16559263
165593              MOVE SQLCA           TO TM500-SQLCA                 16559363
165594              MOVE SQLCODE         TO TM500-SQLCODE               16559463
165595              MOVE PRV-1J          TO TM500-RETURN-DATA           16559563
165596                                                                  16559663
165597              MOVE SPACES          TO PRV-TM500-RETURN-MSG        16559763
165598              STRING 'VNDR:'                                      16559863
165599                      PV-CNTL-FLOW-ENT-ID                         16559963
165600                     '  DEPT:'                                    16560063
165601                      PV-CNTL-FLOW-DEPT                           16560163
165602                                      DELIMITED BY SIZE           16560263
165603                                 INTO PRV-TM500-RETURN-MSG        16560363
165604              MOVE '2650'          TO PRV-PARA                    16560463
165605              MOVE 'WST8-10'       TO PRV-TBL                     16560563
165606              PERFORM 9999-RETURN-MSG                             16560663
165607     END-EVALUATE.                                                16560763
165608                                                                  16560863
165609                                                                  16560963
165610******************************************************************16561063
165611*    THIS PARAGRAPH RETRIEVES DATA FROM TRECEIV & TPKSLIP TABLE   16561163
165612*    TO SELECT PACKAGE TYPE (B/M) & PRO NUMBER                    16561263
165613******************************************************************16561363
165614 2660-CHK-BULK-PRO.                                               16561463
165615                                                                  16561563
165616     MOVE SPACES  TO  RECEIV-PKGNG-CDE                            16561663
165617                      PKSLIP-PRO-NBR.                             16561763
165618                                                                  16561863
165619     PERFORM WITH TEST AFTER                                      16561963
165620         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    16562063
165621         UNTIL   SQLCODE = +0 OR                                  16562163
165622                 SQLCODE = +100 OR                                16562265
165623                 PS-DONE OR                                       16562365
165624                 PV-RETRY-COUNTER > PC-MAX-RETRIES                16562465
165625                                                                  16562565
165626         EXEC SQL                                                 16562665
165627              SELECT A.PKGNG_CDE                                  16562765
165628                   , B.PRO_NBR                                    16562865
165629                INTO :RECEIV-PKGNG-CDE                            16562965
165630                   , :PKSLIP-PRO-NBR                              16563065
165631                FROM TRECEIV A                                    16563165
165632                   , TPKSLIP B                                    16563265
165633               WHERE A.OPER_UNT_ID    = :TM500-OPER-UNT-ID        16563365
165634                 AND A.FCLTY_ID       = :TM500-FCLTY-ID           16563465
165635                 AND A.ORD_NBR        = :TM500-PO-NBR             16563565
165636                 AND A.REC_SEQ_NBR    = :TM500-REC-SEQ-NBR        16563665
165637                 AND A.VER_STATUS_CDE = :PC-ACTIVE                16563765
165638                 AND A.ORD_NBR        = B.PO_NBR                  16563865
165639                 AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR             16563965
165640                 AND B.VER_STAT_CDE   = 'A'                       16564065
165642                WITH UR                                           16564265
165643         END-EXEC                                                 16564365
165644                                                                  16564465
165645         EVALUATE TRUE                                            16564565
165646             WHEN SQLCODE = +0                                    16564665
165647                  CONTINUE                                        16564765
165648                                                                  16564865
165649             WHEN SQLCODE = +100                                  16564965
165650                  MOVE SPACES  TO  PKSLIP-PRO-NBR                 16565065
165652                                                                  16565265
165653             WHEN SQLCODE = -904                                  16565365
165654             WHEN SQLCODE = -911                                  16565465
165655             WHEN SQLCODE = -913                                  16565565
165656                  CONTINUE                                        16565665
165657                                                                  16565765
165658             WHEN OTHER                                           16565865
165659                  SET PS-DONE  TO TRUE                            16565965
165660                  MOVE SQLCA   TO TM500-SQLCA                     16566065
165661                  MOVE SQLCODE TO TM500-SQLCODE                   16566165
165662                  MOVE PRV-1E  TO TM500-RETURN-DATA               16566265
165663                                                                  16566365
165664                  MOVE SPACES    TO PRV-TM500-RETURN-MSG          16566465
165665                  MOVE '2260'    TO PRV-PARA                      16566565
165666                  MOVE 'TRECEIV' TO PRV-TBL                       16566665
165667                  PERFORM 9999-RETURN-MSG                         16566765
165668         END-EVALUATE                                             16566865
165669     END-PERFORM.                                                 16566965
165670                                                                  16567065
165671     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         16567165
165672         SET PS-DONE  TO TRUE                                     16567265
165673         MOVE SQLCA   TO TM500-SQLCA                              16567365
165674         MOVE SQLCODE TO TM500-SQLCODE                            16567465
165675         MOVE PRV-1E  TO TM500-RETURN-DATA                        16567565
165676                                                                  16567665
165677         MOVE SPACES    TO PRV-TM500-RETURN-MSG                   16567765
165678         MOVE '2260'    TO PRV-PARA                               16567865
165679         MOVE 'TRECEIV' TO PRV-TBL                                16567965
165680         PERFORM 9999-RETURN-MSG                                  16568065
165681     END-IF.                                                      16568165
165682                                                                  16568267
165683*** TEST ONLY - BEGIN                                             16568365
165684***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16568467
165685***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-OPER            16568567
165686***     MOVE  TM500-PO-NBR             TO PV-DISP-PO              16568667
165687***     MOVE  TM500-REC-SEQ-NBR        TO PV-DISP-RCVR            16568767
165688***     MOVE  TM500-PO-LNE-NBR         TO PV-DISP-LINE            16568867
165689***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16568967
165690***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16569067
165691***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16569167
165692***     MOVE  SQLCODE                  TO PV-DISP-SQL             16569267
165693***                                                               16569367
165694***     STRING ' RCKCS234-2660-TRECEIV - AFTER '                  16569467
165695***             PV-DISP-OPER '-'                                  16569567
165696***             PV-DISP-PO   '-'                                  16569667
165697***             PV-DISP-RCVR '-'                                  16569767
165698***             PV-DISP-LINE                                      16569867
165699***            '  SQL:'  PV-DISP-SQL       DELIMITED BY SIZE      16569967
165700***                                 INTO PV-CICS-MSG-AREA         16570067
165701***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16570167
165702***                                   TO PV-COMMAREA-LENGTH       16570267
165703***     EXEC CICS                                                 16570367
165704***         WRITEQ TD                                             16570467
165705***             QUEUE   ('CSSL')                                  16570567
165706***             FROM    (PV-CICS-MSG-AREA )                       16570667
165707***             LENGTH  (PV-COMMAREA-LENGTH)                      16570767
165708***             RESP    (PV-CICS-RESP)                            16570867
165709***     END-EXEC                                                  16570967
165710***                                                               16571067
165711***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16571167
165712***     MOVE  RECEIV-OPER-UNT-ID       TO PV-DISP-RCV-OPER        16571267
165713***     MOVE  RECEIV-CRE-OPER-UNT-ID   TO PV-DISP-CRE-OPER        16571367
165714***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO PV-DISP-CUR-OPER        16571467
165715***     STRING ' RCKCS234-2630-AUTRB3   '                         16571567
165716***            'USE OPER:' PS-AUTOTR-CRE-CURR-SW                  16571667
165717***            '  '                                               16571767
165718***            'RCV:' PV-DISP-RCV-OPER ' ' PV-RCVR-OPER-TYPE      16571867
165719***            '  '                                               16571967
165720***            'CRE:' PV-DISP-CRE-OPER ' ' PV-CRE-OPER-TYPE       16572067
165721***            '  '                                               16572167
165722***            'CUR:' PV-DISP-CUR-OPER ' ' PV-CURR-OPER-TYPE      16572267
165723***                                        DELIMITED BY SIZE      16572367
165724***                                 INTO PV-CICS-MSG-AREA         16572467
165725***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16572567
165726***                                   TO PV-COMMAREA-LENGTH       16572667
165727***     EXEC CICS                                                 16572767
165728***         WRITEQ TD                                             16572867
165729***             QUEUE   ('CSSL')                                  16572967
165730***             FROM    (PV-CICS-MSG-AREA )                       16573067
165731***             LENGTH  (PV-COMMAREA-LENGTH)                      16573167
165732***             RESP    (PV-CICS-RESP)                            16573267
165733***     END-EXEC.                                                 16573367
165734***                                                               16573467
165735***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16573567
165736***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16573667
165737***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16573767
165738***     STRING ' RCKCS234-2630-AUTRB3   '                         16573867
165739***            'TM500:' PV-DISP-TM500-OPER  '-'                   16573967
165740***                     PV-DISP-TM500-FCLTY                       16574067
165741***                                        DELIMITED BY SIZE      16574167
165742***                                 INTO PV-CICS-MSG-AREA         16574267
165743***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16574367
165744***                                   TO PV-COMMAREA-LENGTH       16574467
165745***     EXEC CICS                                                 16574567
165746***         WRITEQ TD                                             16574667
165747***             QUEUE   ('CSSL')                                  16574767
165748***             FROM    (PV-CICS-MSG-AREA )                       16574867
165749***             LENGTH  (PV-COMMAREA-LENGTH)                      16574967
165750***             RESP    (PV-CICS-RESP)                            16575067
165751***     END-EXEC.                                                 16575167
165752***                                                               16575267
165753***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16575367
165754***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      16575467
165755***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     16575567
165756***     STRING ' RCKCS234-2630-AUTRB3   '                         16575667
165757***            'PKGNG_CDE:'   RECEIV-PKGNG-CDE                    16575767
165758***            'PKSLIP_PRO:'  PKSLIP-PRO-NBR                      16575867
165759***                     PS-CHECK-AUTRB3-SW                        16575967
165760***                                        DELIMITED BY SIZE      16576067
165761***                                 INTO PV-CICS-MSG-AREA         16576167
165762***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16576267
165763***                                   TO PV-COMMAREA-LENGTH       16576367
165764***     EXEC CICS                                                 16576467
165765***         WRITEQ TD                                             16576567
165766***             QUEUE   ('CSSL')                                  16576667
165767***             FROM    (PV-CICS-MSG-AREA )                       16576767
165768***             LENGTH  (PV-COMMAREA-LENGTH)                      16576867
165769***             RESP    (PV-CICS-RESP)                            16576967
165770***     END-EXEC.                                                 16577067
165771*** TEST ONLY - END                                               16577165
165772                                                                  16577265
165773                                                                  16577365
165774****************************************************************  16577465
165775* CHECK PRO IF CONTROL FLOW TROUBLE IS NEEDED                     16577565
165776* DMH 4/26/23 - BEGIN                                             16577665
165777****************************************************************  16577765
165778 2665-CHK-PRO-TRBL.                                               16577865
165779                                                                  16577965
165780     SET  PS-CREATE-CNTL-FLOW-NO  TO  TRUE.                       16578065
165781     MOVE PV-CNTL-FLOW-PRO        TO  DK-CNTL-FLOW-PRO.           16578165
165782                                                                  16578265
165783     EXEC SQL                                                     16578365
165784       SELECT D.ATTR_ELEM_NBR                                     16578465
165785         INTO :PV-CNTL-FLOW-TRBL-LBL                              16578565
165786         FROM  WST_INTGRTN_TYP  A                                 16578665
165787              ,WST_ATTR_DEFN    B                                 16578765
165788              ,WST_ATTR_ELEM    C                                 16578865
165789              ,WST_ATTR_ELEM    D                                 16578965
165790              ,WST_ATTR_ELEM    E                                 16579065
165791              ,WST_ATTR_ELEM    F                                 16579165
165792              ,WST_ATTR_ELEM    G                                 16579265
165793          WHERE A.INTGRTN_TYP_CDE   = 'AUTRBL03'                  16579365
165794            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           16579465
165795            AND B.ATTR_DEFN_SEQ_NBR = 1                           16579565
165796            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           16579665
165797            AND C.ATTR_DEFN_SEQ_NBR = 1                           16579765
165798            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           16579865
165799            AND D.ATTR_DEFN_SEQ_NBR = 2                           16579965
165800            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           16580065
165801            AND E.ATTR_DEFN_SEQ_NBR = 3                           16580165
165802            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           16580265
165803            AND F.ATTR_DEFN_SEQ_NBR = 4                           16580365
165804            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           16580465
165805            AND G.ATTR_DEFN_SEQ_NBR = 5                           16580565
165806            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         16580665
165807            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         16580765
165808            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         16580865
165809            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         16580965
165810            AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           16581065
165811            AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP           16581165
165812            AND C.ATTR_ELEM_TXT     =                             16581265
165813                SUBSTR(CHAR(:DK-CNTL-FLOW-PRO),1,G.ATTR_ELEM_NBR) 16581365
165814     END-EXEC.                                                    16581465
165815                                                                  16581565
165816     EVALUATE TRUE                                                16581665
165817         WHEN SQLCODE = +0                                        16581765
165818              SET PS-CREATE-CNTL-FLOW-YES   TO  TRUE              16581865
165819*DMH          SET PS-CONTINUE-TRBL-CHECK-NO TO  TRUE              16581966
165820                                                                  16582065
165821         WHEN SQLCODE = +100                                      16582165
165822              CONTINUE                                            16582265
165823                                                                  16582365
165824         WHEN SQLCODE = -904                                      16582465
165825         WHEN SQLCODE = -911                                      16582565
165826         WHEN SQLCODE = -913                                      16582665
165827              CONTINUE                                            16582765
165828                                                                  16582865
165829         WHEN OTHER                                               16582965
165830              SET  PS-DONE         TO TRUE                        16583065
165831              MOVE SQLCA           TO TM500-SQLCA                 16583165
165832              MOVE SQLCODE         TO TM500-SQLCODE               16583265
165833              MOVE PRV-1J          TO TM500-RETURN-DATA           16583365
165834                                                                  16583465
165835              MOVE SPACES          TO PRV-TM500-RETURN-MSG        16583565
165836              STRING 'PRO: '                                      16583665
165837                      PV-CNTL-FLOW-PRO                            16583765
165838                                      DELIMITED BY SIZE           16583865
165839                                 INTO PRV-TM500-RETURN-MSG        16583965
165840              MOVE '2665'          TO PRV-PARA                    16584065
165841              MOVE 'WST8-10'       TO PRV-TBL                     16584165
165842              PERFORM 9999-RETURN-MSG                             16584265
165843     END-EVALUATE.                                                16584365
165844                                                                  16584465
165845                                                                  16584565
165846                                                                  16584665
165847                                                                  16584765
165848****************************************************************  16584865
165849* USING CURSOR - DETERMINE WHAT CONTROL FLOW TROUBLES ARE TO      16584965
165850* BE CREATED.                                                     16585065
165851* DMH 6/2/14 - BEGIN                                              16585165
165852****************************************************************  16585265
165853 2685-CREATE-CNTL-FLOW-TRBL.                                      16585365
165854                                                                  16585465
165855     MOVE PV-CNTL-FLOW-TRBL-LBL  TO  DK-CNTL-FLOW-TRBL-LBL.       16585565
165856                                                                  16585665
165857     PERFORM 2687-OPEN-CNTL-FLOW-CSR.                             16585765
165858                                                                  16585865
165859     PERFORM 2690-FETCH-CNTL-FLOW-CSR                             16585965
165860       UNTIL PS-EOF-CNTLFLOW-CSR-YES.                             16586065
165861                                                                  16586165
165862     PERFORM 2692-CLOSE-CNTL-FLOW-CSR.                            16586265
165863                                                                  16586365
165864                                                                  16586465
165865****************************************************************  16586565
165866* USING CURSOR - DETERMINE WHAT CONTROL FLOW TROUBLES ARE TO      16586665
165867* BE CREATED.                                                     16586765
165868* DMH 6/2/14 - BEGIN                                              16586865
165869****************************************************************  16586965
165870 2687-OPEN-CNTL-FLOW-CSR.                                         16587065
165871                                                                  16587165
165872     EXEC SQL                                                     16587265
165873         OPEN CNTLFLOW_TROUBLE_CSR                                16587365
165874     END-EXEC.                                                    16587465
165875                                                                  16587565
165876     EVALUATE TRUE                                                16587665
165877         WHEN SQLCODE = +0                                        16587765
165878              CONTINUE                                            16587865
165879                                                                  16587965
165880         WHEN OTHER                                               16588065
165881              MOVE SQLCA           TO TM500-SQLCA                 16588165
165882              MOVE SQLCODE         TO TM500-SQLCODE               16588265
165883              MOVE PRV-1K          TO TM500-RETURN-DATA           16588365
165884              MOVE PV-CNTL-FLOW-TRBL-LBL                          16588465
165885                                   TO PV-DISP-FLOW-TRBL-LBL       16588565
165886                                                                  16588665
165887              MOVE SPACES          TO PRV-TM500-RETURN-MSG        16588765
165888              STRING 'TRBL LEVEL:'                                16588865
165889                      PV-DISP-FLOW-TRBL-LBL                       16588965
165890                                      DELIMITED BY SIZE           16589065
165891                                 INTO PRV-TM500-RETURN-MSG        16589165
165892              MOVE '2687'          TO PRV-PARA                    16589265
165893              MOVE 'WST8-10'       TO PRV-TBL                     16589365
165894              PERFORM 9999-RETURN-MSG                             16589465
165895     END-EVALUATE.                                                16589565
165896                                                                  16589665
165897                                                                  16589765
165898****************************************************************  16589865
165899* USING CURSOR - DETERMINE WHAT CONTROL FLOW TROUBLES ARE TO      16589965
165900* BE CREATED.                                                     16590065
165901* DMH 6/2/14 - BEGIN                                              16590165
165902****************************************************************  16590265
165903 2690-FETCH-CNTL-FLOW-CSR.                                        16590365
165904                                                                  16590465
165905     EXEC SQL                                                     16590565
165906         FETCH CNTLFLOW_TROUBLE_CSR                               16590665
165907          INTO :DK-WORK-TRBL-CDE                                  16590765
165908             , :PS-CREATE-DC-EFC-LVL-SW                           16590865
165909     END-EXEC.                                                    16590965
165910                                                                  16591065
165911     EVALUATE TRUE                                                16591165
165912         WHEN SQLCODE = +0                                        16591265
165913                                                                  16591365
165914*** TEST ONLY - BEGIN                                             16591465
165915***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16591565
165916***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-OPER            16591665
165917***     MOVE  TM500-PO-NBR             TO PV-DISP-PO              16591765
165918***     MOVE  TM500-REC-SEQ-NBR        TO PV-DISP-RCVR            16591865
165919***     MOVE  TM500-PO-LNE-NBR         TO PV-DISP-LINE            16591965
165920***                                                               16592065
165921***     STRING ' RCKCS234-2690-CNTLFLOW '                         16592165
165922***             PV-DISP-OPER '-'                                  16592265
165923***             PV-DISP-PO   '-'                                  16592365
165924***             PV-DISP-RCVR '-'                                  16592465
165925***             PV-DISP-LINE               DELIMITED BY SIZE      16592565
165926***                                 INTO PV-CICS-MSG-AREA         16592665
165927***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16592765
165928***                                   TO PV-COMMAREA-LENGTH       16592865
165929***     EXEC CICS                                                 16592965
165930***         WRITEQ TD                                             16593065
165931***             QUEUE   ('CSSL')                                  16593165
165932***             FROM    (PV-CICS-MSG-AREA )                       16593265
165933***             LENGTH  (PV-COMMAREA-LENGTH)                      16593365
165934***             RESP    (PV-CICS-RESP)                            16593465
165935***     END-EXEC                                                  16593565
165936***                                                               16593665
165937***     MOVE  SPACES            TO PV-CICS-MSG-AREA               16593765
165938***     MOVE  DK-WORK-TRBL-CDE  TO  PV-DISP-DK-WORK-TRBL-CDE      16593865
165939***     STRING ' RCKCS234-2690-CNTLFLOW '                         16593965
165940***            'TRBL:'     PV-DISP-DK-WORK-TRBL-CDE               16594065
165941***            '  '                                               16594165
165942***            'DC/EFC LEVEL:' PS-CREATE-DC-EFC-LVL-SW            16594265
165943***                                        DELIMITED BY SIZE      16594365
165944***                                 INTO PV-CICS-MSG-AREA         16594465
165945***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16594565
165946***                                   TO PV-COMMAREA-LENGTH       16594665
165947***     EXEC CICS                                                 16594765
165948***         WRITEQ TD                                             16594865
165949***             QUEUE   ('CSSL')                                  16594965
165950***             FROM    (PV-CICS-MSG-AREA )                       16595065
165951***             LENGTH  (PV-COMMAREA-LENGTH)                      16595165
165952***             RESP    (PV-CICS-RESP)                            16595265
165953***     END-EXEC                                                  16595365
165954***                                                               16595465
165955***     MOVE  SPACES            TO PV-CICS-MSG-AREA               16595565
165956***     STRING ' RCKCS234-2690-CNTLFLOW '                         16595665
165957***            'OPER TYPE: '  PS-AUTOTR-CRE-CURR-SW               16595765
165958***            '  CRE:'       PV-CRE-OPER-TYPE                    16595865
165959***            '  CURR:'      PV-CURR-OPER-TYPE                   16595965
165960***            '  RCVR:'      PV-RCVR-OPER-TYPE                   16596065
165961***                                        DELIMITED BY SIZE      16596165
165962***                                 INTO PV-CICS-MSG-AREA         16596265
165963***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16596365
165964***                                   TO PV-COMMAREA-LENGTH       16596465
165965***     EXEC CICS                                                 16596565
165966***         WRITEQ TD                                             16596665
165967***             QUEUE   ('CSSL')                                  16596765
165968***             FROM    (PV-CICS-MSG-AREA )                       16596865
165969***             LENGTH  (PV-COMMAREA-LENGTH)                      16596965
165970***             RESP    (PV-CICS-RESP)                            16597065
165971***     END-EXEC                                                  16597165
165972*** TEST ONLY - END                                               16597265
165973                                                                  16597365
165974* IF THE TROUBLE NEEDS TO BE CREATED FOR THE DC & EFC             16597465
165975* PROCEED TO CREATE THE TROUBLE - NO ADDITIONAL CHECKING          16597565
165976* IS REQUIRED.                                                    16597665
165977                                                                  16597765
165978         EVALUATE TRUE                                            16597865
165979             WHEN PS-CREATE-BOTH                                  16597965
165980                  PERFORM 2691-CREATE-CNTL-FLOW-TRBL              16598065
165981                                                                  16598165
165982* IF THE TROUBLE ONLY NEEDS TO BE CREATE FOR A DC                 16598265
165983* THEN CHECK IF THE REQUESTED OPER IS DC                          16598365
165984* IF THE REQUESTED OPER IS A DC THEN PROCEED TO CREATE            16598465
165985* THE TROUBLE.                                                    16598565
165986                                                                  16598665
165987             WHEN PS-CREATE-DC-ONLY                               16598765
165988                  IF (PS-AUTOTR-CRE-OPER AND PV-CRE-OPER-DC) OR   16598865
165989                     (PS-AUTOTR-CUR-OPER AND PV-CURR-OPER-DC) OR  16598965
165990                     (PS-AUTOTR-RCV-OPER AND PV-RCVR-OPER-DC)     16599065
165991                      PERFORM 2691-CREATE-CNTL-FLOW-TRBL          16599165
165992                  ELSE                                            16599265
165993                      CONTINUE                                    16599365
165994                  END-IF                                          16599465
165995                                                                  16599565
165996* IF THE TROUBLE ONLY NEEDS TO BE CREATE FOR A EFC                16599665
165997* THEN CHECK IF THE REQUESTED OPER IS EFC                         16599765
165998* IF THE REQUESTED OPER IS A EFC THEN PROCEED TO CREATE           16599865
165999* THE TROUBLE.                                                    16599965
166000                                                                  16600065
166001             WHEN PS-CREATE-EFC-ONLY                              16600165
166002                  IF (PS-AUTOTR-CRE-OPER AND PV-CRE-OPER-EFC) OR  16600265
166003                     (PS-AUTOTR-CUR-OPER AND PV-CURR-OPER-EFC) OR 16600365
166004                     (PS-AUTOTR-RCV-OPER AND PV-RCVR-OPER-EFC)    16600465
166005                      PERFORM 2691-CREATE-CNTL-FLOW-TRBL          16600565
166006                  ELSE                                            16600665
166007                      CONTINUE                                    16600765
166008                  END-IF                                          16600865
166009         END-EVALUATE                                             16600965
166010                                                                  16601065
166011                                                                  16601165
166012         WHEN SQLCODE = +100                                      16601265
166013              SET  PS-EOF-CNTLFLOW-CSR-YES  TO  TRUE              16601365
166014                                                                  16601465
166015         WHEN OTHER                                               16601565
166016              SET  PS-EOF-CNTLFLOW-CSR-YES  TO  TRUE              16601665
166017              MOVE SQLCA           TO TM500-SQLCA                 16601765
166018              MOVE SQLCODE         TO TM500-SQLCODE               16601865
166019              MOVE PRV-1K          TO TM500-RETURN-DATA           16601965
166020              MOVE PV-CNTL-FLOW-TRBL-LBL                          16602065
166021                                   TO PV-DISP-FLOW-TRBL-LBL       16602165
166022                                                                  16602265
166023              MOVE SPACES          TO PRV-TM500-RETURN-MSG        16602365
166024              STRING 'TROUBLE LEVEL:'                             16602465
166025                      PV-DISP-FLOW-TRBL-LBL                       16602565
166026                                      DELIMITED BY SIZE           16602665
166027                                 INTO PRV-TM500-RETURN-MSG        16602765
166028              MOVE '2690'          TO PRV-PARA                    16602865
166029              MOVE 'WST8-10'       TO PRV-TBL                     16602965
166030              PERFORM 9999-RETURN-MSG                             16603065
166031     END-EVALUATE.                                                16603165
166032                                                                  16603265
166033                                                                  16603365
166034****************************************************************  16603465
166035* CREATE THE CONTROL FLOW TROUBLE                                 16603565
166036* DMH 10/2016  BEGIN                                              16603665
166037****************************************************************  16603765
166038 2691-CREATE-CNTL-FLOW-TRBL.                                      16603865
166039                                                                  16603965
166040*** TEST ONLY - BEGIN                                             16604065
166041***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        16604165
166042***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-OPER            16604265
166043***     MOVE  TM500-PO-NBR             TO PV-DISP-PO              16604365
166044***     MOVE  TM500-REC-SEQ-NBR        TO PV-DISP-RCVR            16604465
166045***     MOVE  TM500-PO-LNE-NBR         TO PV-DISP-LINE            16604565
166046***                                                               16604665
166047***     STRING ' RCKCS234-2691-TROUBLE  '                         16604765
166048***             PV-DISP-OPER '-'                                  16604865
166049***             PV-DISP-PO   '-'                                  16604965
166050***             PV-DISP-RCVR '-'                                  16605065
166051***             PV-DISP-LINE               DELIMITED BY SIZE      16605165
166052***                                 INTO PV-CICS-MSG-AREA         16605265
166053***     MOVE LENGTH OF PV-CICS-MSG-AREA                           16605365
166054***                                   TO PV-COMMAREA-LENGTH       16605465
166055***     EXEC CICS                                                 16605565
166056***         WRITEQ TD                                             16605665
166057***             QUEUE   ('CSSL')                                  16605765
166058***             FROM    (PV-CICS-MSG-AREA )                       16605865
166059***             LENGTH  (PV-COMMAREA-LENGTH)                      16605965
166060***             RESP    (PV-CICS-RESP)                            16606065
166061***     END-EXEC                                                  16606165
166062***                                                               16606265
166063*** TEST ONLY - END                                               16606365
166064                                                                  16606465
166065                                                                  16606565
166066         MOVE PC-C              TO TM500-CRUD-IND                 16606665
166067         MOVE DK-WORK-TRBL-CDE  TO PV-WORK-TRBL-CDE               16606765
166068         MOVE PV-WORK-TRBL-CDE  TO TM500-TRBL-RSN-CDE             16606865
166069         SET TM500-IN-TROUBLE   TO TRUE                           16606965
166070         PERFORM 3000-CREATE-TROUBLE-RECORD.                      16607065
166071                                                                  16607165
166072                                                                  16607265
166073****************************************************************  16607365
166074* USING CURSOR - DETERMINE WHAT CONTROL FLOW TROUBLES ARE TO      16607465
166075* BE CREATED.                                                     16607565
166076* DMH 6/2/14 - BEGIN                                              16607665
166077****************************************************************  16607765
166078 2692-CLOSE-CNTL-FLOW-CSR.                                        16607865
166079                                                                  16607965
166080     EXEC SQL                                                     16608065
166081         CLOSE CNTLFLOW_TROUBLE_CSR                               16608165
166082     END-EXEC.                                                    16608265
166083                                                                  16608365
166084     EVALUATE TRUE                                                16608465
166085         WHEN SQLCODE = +0                                        16608565
166086              CONTINUE                                            16608665
166087                                                                  16608765
166088         WHEN OTHER                                               16608865
166089              MOVE SQLCA           TO TM500-SQLCA                 16608965
166090              MOVE SQLCODE         TO TM500-SQLCODE               16609065
166091              MOVE PRV-1K          TO TM500-RETURN-DATA           16609165
166092              MOVE PV-CNTL-FLOW-TRBL-LBL                          16609265
166093                                   TO PV-DISP-FLOW-TRBL-LBL       16609365
166094                                                                  16609465
166095              MOVE SPACES          TO PRV-TM500-RETURN-MSG        16609565
166096              STRING 'TRBL LEVEL'                                 16609665
166097                      PV-DISP-FLOW-TRBL-LBL                       16609765
166098                                      DELIMITED BY SIZE           16609865
166099                                 INTO PRV-TM500-RETURN-MSG        16609965
166100              MOVE '2692'          TO PRV-PARA                    16610065
166101              MOVE 'WST8-10'       TO PRV-TBL                     16610165
166102              PERFORM 9999-RETURN-MSG                             16610265
166103     END-EVALUATE.                                                16610365
166104                                                                  16610465
166105                                                                  16610565
166106****************************************************************  16610665
166107*                                                                 16610765
166108****************************************************************  16610865
166109 2700-TRBL-426-CHK.                                               16610965
166110                                                                  16611065
166111     IF PS-CREATE-426-TRBL                                        16611165
166112         MOVE PC-C   TO TM500-CRUD-IND                            16611265
166113         MOVE PC-426 TO TM500-TRBL-RSN-CDE                        16611365
166114         SET TM500-IN-TROUBLE TO TRUE                             16611465
166115         PERFORM 3000-CREATE-TROUBLE-RECORD                       16611565
166116     END-IF.                                                      16611665
166117                                                                  16611765
166118 2800-TRBL-423-CHK.                                               16611865
166120                                                                  16612010
166200     INITIALIZE PS-CREATE-423-TRBL-SW.                            16620010
166300                                                                  16630010
166400     PERFORM 2820-CHECK-RED-RDC-PO                                16640010
166500                                                                  16650010
166600     IF PS-CREATE-423-TRBL                                        16660010
166700         MOVE PC-C            TO TM500-CRUD-IND                   16670010
166800         MOVE PC-423          TO TM500-TRBL-RSN-CDE               16680010
166900         SET TM500-IN-TROUBLE TO TRUE                             16690010
167000         PERFORM 3000-CREATE-TROUBLE-RECORD                       16700010
167100     END-IF.                                                      16710010
167200                                                                  16720010
167300****************************************************************  16730010
167400*  CHECK RED RDC TROUBLE      - USED FOR 423 TROUBLE              16740010
167500****************************************************************  16750010
167600 2820-CHECK-RED-RDC-PO.                                           16760010
167700                                                                  16770010
167800     MOVE  'N'                     TO  PS-CREATE-423-TRBL-SW.     16780010
167900                                                                  16790010
168000     EXEC SQL                                                     16800010
168100       SELECT G.SEASET_SHRT_NM                                    16810010
168200         INTO :SEASET-SEASET-SHRT-NM                              16820010
168300         FROM  WST_INTGRTN_TYP  A                                 16830010
168400              ,WST_ATTR_DEFN    B                                 16840010
168500              ,WST_ATTR_ELEM    C                                 16850010
168600              ,WST_ATTR_ELEM    D                                 16860010
168700              ,WST_ATTR_ELEM    E                                 16870010
168800              ,WST_ATTR_ELEM    F                                 16880010
168900              ,TSEASET          G                                 16890010
169000              ,TPURCHS          H                                 16900010
169100          WHERE A.INTGRTN_TYP_CDE   = 'EFCATRDC'                  16910010
169200            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           16920010
169300            AND B.ATTR_DEFN_SEQ_NBR = 1                           16930010
169400            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           16940010
169500            AND C.ATTR_DEFN_SEQ_NBR = 1                           16950010
169600            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           16960010
169700            AND D.ATTR_DEFN_SEQ_NBR = 2                           16970010
169800            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           16980010
169900            AND E.ATTR_DEFN_SEQ_NBR = 3                           16990010
170000            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           17000010
170100            AND F.ATTR_DEFN_SEQ_NBR = 4                           17010010
170200            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         17020010
170300            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         17030010
170400            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         17040010
170500            AND C.ATTR_ELEM_TXT     = G.SEASET_TYP_CDE            17050010
170600            AND D.ATTR_ELEM_TXT     = 'ACTIVE'                    17060010
170700            AND E.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           17070010
170800            AND F.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP           17080010
170900            AND G.SEASET_SHRT_NM    = H.SEASET_SHRT_NM            17090010
171000            AND G.SEASET_YR         = H.SEASET_YR                 17100010
171100            AND H.PO_NBR            = :TM500-PO-NBR               17110010
171200            AND H.VER_STATUS_CDE    = 'A'                         17120010
171300     END-EXEC.                                                    17130010
171400                                                                  17140010
171500     EVALUATE TRUE                                                17150010
171600         WHEN SQLCODE = +0                                        17160010
171700              SET PS-CREATE-423-TRBL  TO  TRUE                    17170010
171800                                                                  17180010
171900         WHEN SQLCODE = +100                                      17190010
172000              CONTINUE                                            17200010
172100                                                                  17210010
172200         WHEN SQLCODE = -904                                      17220010
172300         WHEN SQLCODE = -911                                      17230010
172400         WHEN SQLCODE = -913                                      17240010
172500              CONTINUE                                            17250010
172600                                                                  17260010
172700         WHEN OTHER                                               17270010
172800              SET  PS-DONE         TO TRUE                        17280010
172900              MOVE SQLCA           TO TM500-SQLCA                 17290010
173000              MOVE SQLCODE         TO TM500-SQLCODE               17300010
173100              MOVE PRV-1H          TO TM500-RETURN-DATA           17310010
173200                                                                  17320010
173300              MOVE SPACES          TO PRV-TM500-RETURN-MSG        17330010
173400              MOVE '2620'          TO PRV-PARA                    17340010
173500              MOVE 'WST8-10'       TO PRV-TBL                     17350010
173600              PERFORM 9999-RETURN-MSG                             17360010
173700     END-EVALUATE.                                                17370010
173800                                                                  17380010
173900                                                                  17390010
174000 2900-TRBL-424-CHK.                                               17400010
174100                                                                  17410010
174200     INITIALIZE PS-CREATE-424-TRBL-SW.                            17420010
174300                                                                  17430010
174400     PERFORM 2920-CHECK-RFID-PO                                   17440010
174500                                                                  17450010
174600     IF PS-CREATE-424-TRBL                                        17460010
174700         MOVE PC-C            TO TM500-CRUD-IND                   17470010
174800         MOVE PC-424          TO TM500-TRBL-RSN-CDE               17480010
174900         SET TM500-IN-TROUBLE TO TRUE                             17490010
175000         PERFORM 3000-CREATE-TROUBLE-RECORD                       17500010
175100     END-IF.                                                      17510010
175200                                                                  17520010
175300 2920-CHECK-RFID-PO.                                              17530010
175400     SET SU093-PO-LEVEL-CHECK         TO TRUE.                    17540010
175500     SET SU093-RFID-STR-CHK-NEEDED-NO  TO TRUE.                   17550010
175600     SET SU093-CHECK-BY-DEPT-SUBCLS-YES  TO TRUE                  17560010
175700     SET SU093-CHECK-BY-DC               TO TRUE                  17570010
175800                                                                  17580010
175900     MOVE TM500-PO-NBR                 TO SU093-KEY-PO.           17590010
176000     MOVE RECEIV-CURR-OPER-UNT-ID      TO SU093-KEY-OPER-UNT-ID.  17600010
176100                                                                  17610010
176200     CALL SU093-RFID-PGM       USING DFHEIBLK                     17620010
176300                                     SU093-COMMAREA               17630010
176400                                     SU093-ITEM-COMMAREA.         17640010
176500                                                                  17650010
176600*CLP 02/10/14 START                                               17660010
176700     EVALUATE TRUE                                                17670010
176800       WHEN SU093-SUCCESSFUL                                      17680010
176801**GB 10/15/15 ONLY DO EVALUATE IF SU093-RFID-YES                  17680132
176810          IF SU093-RFID-YES                                       17681032
176900            EVALUATE TRUE                                         17690010
177000              WHEN SU093-VNDR-DPT-RFID-COMPLI-YES                 17700010
177100              WHEN SU093-VNDR-DPT-RFID-TAGS-YES                   17710010
177200                  CONTINUE                                        17720010
177300              WHEN SU093-RFID-KOHL-DEPT-SUBCL-YES                 17730010
177400*                 DEPT IS RFID ON THE DPTSCL ROW                  17740010
177500                  SET PS-CREATE-424-TRBL  TO TRUE                 17750010
177600             END-EVALUATE                                         17760010
177610          END-IF                                                  17761032
177700*CLP 02/10/14 END                                                 17770010
177800      WHEN OTHER                                                  17780010
177900            SET  PS-DONE         TO TRUE                          17790010
178000            MOVE SU093-SQLCA     TO TM500-SQLCA                   17800010
178100            MOVE SU093-SQLCODE   TO TM500-SQLCODE                 17810010
178200            MOVE 'UNSUCCESSFUL CALL TO RFID MODULE'               17820010
178300                                 TO TM500-RETURN-DATA             17830010
178400                                                                  17840010
178500            MOVE SPACES          TO PRV-TM500-RETURN-MSG          17850010
178600            MOVE '2920'          TO PRV-PARA                      17860010
178700            MOVE SU093-ERROR-NBR TO PRV-TBL                       17870010
178800            PERFORM 9999-RETURN-MSG                               17880010
178900     END-EVALUATE.                                                17890010
179000*                                                                 17900010
179100 3000-CREATE-TROUBLE-RECORD.                                      17910010
179200******************************************************************17920010
179300*    THIS PARAGRAPH CALLS PROGRAM TMKCS521 WHICH WILL MAINTAIN    17930010
179400*    TROUBLE RECORDS IN TTRBNTF AND TTRBDTL TABLES.  IT ALSO      17940010
179500*    CHECKS TO MAKE SURE THAT IF IT IS IN AUTO-RESOLVE,  IT MUST  17950010
179600*    NOT HAVE ANY DETAILS.  THEREFORE, IT SAVES THE DETAILS AND   17960010
179700*    RE-INSTATE THE DETAILS WHEN RETURNING FROM TMKCS521.         17970010
179800******************************************************************17980010
179810                                                                  17981052
179830*** TEST ONLY - BEGIN                                             17983049
179840***     MOVE  SPACES                   TO PV-CICS-MSG-AREA        17984052
179841***     MOVE  TM500-OPER-UNT-ID        TO PV-DISP-TM500-OPER      17984152
179842***     MOVE  TM500-FCLTY-ID           TO PV-DISP-TM500-FCLTY     17984252
179860***     MOVE  TM500-PO-NBR             TO PV-DISP-PO              17986052
179870***     MOVE  TM500-REC-SEQ-NBR        TO PV-DISP-RCVR            17987052
179880***     MOVE  TM500-PO-LNE-NBR         TO PV-DISP-LINE            17988052
179890***                                                               17989052
179891***     STRING ' RCKCS234-3000-TROUBLE  '                         17989152
179892***             PV-DISP-TM500-OPER  '-'                           17989252
179893***             PV-DISP-TM500-FCLTY '-'                           17989352
179894***             PV-DISP-PO   '-'                                  17989452
179895***             PV-DISP-RCVR '-'                                  17989552
179896***             PV-DISP-LINE               DELIMITED BY SIZE      17989652
179897***                                 INTO PV-CICS-MSG-AREA         17989752
179898***     MOVE LENGTH OF PV-CICS-MSG-AREA                           17989852
179899***                                   TO PV-COMMAREA-LENGTH       17989952
179900***     EXEC CICS                                                 17990052
179901***         WRITEQ TD                                             17990152
179902***             QUEUE   ('CSSL')                                  17990252
179903***             FROM    (PV-CICS-MSG-AREA )                       17990352
179904***             LENGTH  (PV-COMMAREA-LENGTH)                      17990452
179905***             RESP    (PV-CICS-RESP)                            17990552
179906***     END-EXEC                                                  17990652
179908*** TEST ONLY - END                                               17990849
179909                                                                  17990949
179910                                                                  17991010
180000     IF TM500-FREEFORM-TEXT > SPACES AND                          18000010
180100        TM500-ADD-DETAILS AND TM500-RESOLVE-AUTO AND TM500-UPDATE 18010010
180200         SET TM500-NO-DETAILS TO TRUE                             18020010
180300     END-IF.                                                      18030010
180400                                                                  18040010
180500     EXEC CICS                                                    18050010
180600         LINK PROGRAM  (PC-TMKCS521)                              18060010
180700              COMMAREA (TM500-FIELDS)                             18070010
180800              LENGTH   (PC-600)                                   18080010
180900     END-EXEC.                                                    18090010
181000                                                                  18100010
181100     IF TM500-FREEFORM-TEXT > SPACES AND                          18110010
181200        TM500-NO-DETAILS AND TM500-RESOLVE-AUTO AND TM500-UPDATE  18120010
181300         SET TM500-ADD-DETAILS TO TRUE                            18130010
181400     END-IF.                                                      18140010
181500                                                                  18150010
181600     EVALUATE TRUE                                                18160010
181700         WHEN TM500-CALL-SUCCESSFUL                               18170010
181800         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        18180010
181900              CONTINUE                                            18190010
182000                                                                  18200010
182100         WHEN OTHER                                               18210010
182200              SET PS-DONE TO TRUE                                 18220010
182300     END-EVALUATE.                                                18230010
182400                                                                  18240010
182500                                                                  18250010
182600 9999-RETURN-MSG.                                                 18260010
182700******************************************************************18270010
182800*    THIS PARAGRAPH IS USED AS A TOOL TO DISPLAY MORE DETAILS     18280010
182900*    DURING ABEND CONDITIONS.                                     18290010
183000******************************************************************18300010
183100                                                                  18310010
183200     COMPUTE PV-OP-N = TM500-OPER-UNT-ID * 1.                     18320010
183300     COMPUTE PV-FCLTY-N = TM500-FCLTY-ID * 1.                     18330010
183400     COMPUTE PV-PO-N = TM500-PO-NBR      * 1.                     18340010
183500     COMPUTE PV-LINE-N = TM500-PO-LNE-NBR * 1.                    18350010
183600     COMPUTE PV-REC-SEQ-NBR-N = TM500-REC-SEQ-NBR * 1.            18360010
183700                                                                  18370010
183800     MOVE '234'                 TO PRV-PGM.                       18380010
183900     MOVE PV-OP                 TO PRV-OP.                        18390010
184000     MOVE PV-FCLTY              TO PRV-FCLTY.                     18400010
184100     MOVE PV-PO                 TO PRV-PO.                        18410010
184200     MOVE PV-LINE               TO PRV-LINE.                      18420010
184300     MOVE PV-REC-SEQ-NBR        TO PRV-REC-SEQ-NBR.               18430010
184400                                                                  18440010
184500     MOVE PRV-TM500-RETURN-MSG  TO TM500-RETURN-MSG.              18450010
