000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    TRKCS158.                                         00040099
000500 AUTHOR.        ABRAHAM IVERSON.                                  00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  01-26-04.                                         00070099
000800 DATE-COMPILED.                                                   00080099
000900*----------------------------------------------------------------*00090099
001000*    Y158 - ADD/UPDATE/DELETE ORG CODES                          *00100099
001100*                                                                *00110099
001200*    THIS PROGRAM ALLOWS THE USER TO ADD/UPDATE/DELETE ORG       *00120099
001300*    CODES.  THE ORG DESCRIPTION MUST BE ENTERED FOR THE         *00130099
001400*    ADD FUNCTION.                                               *00140099
001500*                                                                *00150099
001600*    02/19/2003     MADE CHANGES TO INCLUDE THE DECONSOLIDATOR   *00160099
001700*                   SCAC TO ORG SCREENS    -VISWA KARUTURI       *00170099
001800*----------------------------------------------------------------*00180099
CICS  * CHANGED  1/12/2023    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
001900                                                                  00190099
002000 ENVIRONMENT DIVISION.                                            00200099
002100                                                                  00210099
002200 DATA DIVISION.                                                   00220099
002300                                                                  00230099
002400 WORKING-STORAGE SECTION.                                         00240099
002500                                                                  00250099
002600 01  DK-DB2-KEYS.                                                 00260099
002800     05  DK-IMPRT-ORGN-CDE              PIC  X(03)  VALUE SPACE.  00280099
002900     05  DK-IMPRT-ORGN-TYP-CDE          PIC  X(03)  VALUE SPACE.  00290099
002700     05  DK-CNTRY-CDE                   PIC  X(03)  VALUE SPACE.  00270099
003300     05  DK-STAT-CDE                    PIC  X(01)  VALUE SPACE.  00330099
003400     05  DK-FUNC-CDE                    PIC  X(01)  VALUE SPACE.  00340099
003500*                                                                 00350099
003600 01  PC-PROGRAM-CONSTANTS.                                        00360099
003700     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'TR158A  '.  00370099
003800     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'TRKM158 '.  00380099
003900     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'TRKCS158'.  00390099
004800     05  PC-A                     PIC  X(01)  VALUE 'A'.          00480099
004800     05  PC-D                     PIC  X(01)  VALUE 'D'.          00480099
004900     05  PC-I                     PIC  X(01)  VALUE 'I'.          00490099
004900     05  PC-U                     PIC  X(01)  VALUE 'U'.          00490099
005000     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00500099
005200     05  PC-TSYMSG-NUMBERS.                                       00520099
005300         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00530099
005400         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00540099
005500         10  PC-TSYMSG-00035      PIC  9(05)  VALUE  00035.       00550099
005600         10  PC-TSYMSG-00050      PIC  9(05)  VALUE  00050.       00560099
005700         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00570099
005800         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00580099
005900         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00590099
006000         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00600099
006100         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00610099
006200         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00620099
006300         10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       00630099
006400         10  PC-TSYMSG-00117      PIC  9(05)  VALUE  00117.       00640099
006500         10  PC-TSYMSG-00223      PIC  9(05)  VALUE  00223.       00650099
006600         10  PC-TSYMSG-00224      PIC  9(05)  VALUE  00224.       00660099
006700         10  PC-TSYMSG-00224      PIC  9(05)  VALUE  00224.       00670099
006800         10  PC-TSYMSG-00068      PIC  9(05)  VALUE  00068.       00680099
006900         10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       00690099
007000         10  PC-TSYMSG-01450      PIC  9(05)  VALUE  01450.       00700099
007100         10  PC-TSYMSG-01644      PIC  9(05)  VALUE  01644.       00710099
007200         10  PC-TSYMSG-01646      PIC  9(05)  VALUE  01646.       00720099
007300     05  PC-INTER-APPL-CODES.                                     00730099
007400         10  PC-INTER-APPL-CRIT-ADD   PIC X(01)  VALUE '1'.       00740099
007500         10  PC-INTER-APPL-CRIT-UPD   PIC X(01)  VALUE '2'.       00750099
007600         10  PC-INTER-APPL-CRIT-DEL   PIC X(01)  VALUE '3'.       00760099
007700         10  PC-INTER-APPL-LIST-ADD   PIC X(01)  VALUE '4'.       00770099
007800         10  PC-INTER-APPL-LIST-DEL   PIC X(01)  VALUE '5'.       00780099
007900         10  PC-INTER-APPL-LIST-COPY  PIC X(01)  VALUE '7'.       00790099
003500*                                                                 00350099
008100 01  PS-PROGRAM-SWITCHES.                                         00810099
008200     05  PS-ERROR-SW              PIC  X(01)  VALUE 'N'.          00820099
008300         88  PS-ERROR                         VALUE 'Y'.          00830099
008400         88  PS-NO-ERROR                      VALUE 'N'.          00840099
008500     05  PS-COMMAREA-SW           PIC X(01)   VALUE 'N'.          00850099
008600         88  PS-COMMAREA-VALID                VALUE 'Y'.          00860099
008700         88  PS-COMMAREA-NOT-VALID            VALUE 'N'.          00870099
008800     05  PS-LIST-END-SW           PIC X(01)   VALUE 'N'.          00880099
008900         88  PS-LIST-END                      VALUE 'Y'.          00890099
009000         88  PS-NO-LIST-END                   VALUE 'N'.          00900099
009100*                                                                 00910099
009200 01  PV-PROGRAM-VARIABLES.                                        00920099
009300     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00930099
009400                                              COMP SYNC.          00940099
009500     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00950099
009600                                              COMP SYNC.          00960099
009700     05  PV-LOCK-RETRY-COUNTER    PIC S9(04)  VALUE +0            00970099
009800                                              COMP SYNC.          00980099
009900     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            00990099
010000                                              COMP SYNC.          01000099
010100     05  PV-DISPLAY-TASK          PIC 9(05).                      01010099
010200                                                                  01020099
011100*----------------------------------------------------------------*01110099
011200*    CALLING PARAMETERS FOR LOCKING MODULE DPKCS044              *01120099
011300*----------------------------------------------------------------*01130099
011500     COPY DPWS044.                                                01150099
011600 EJECT                                                            01160099
011700*----------------------------------------------------------------*01170099
011800*    MAP LAYOUT                                                  *01180099
011900*----------------------------------------------------------------*01190099
012100     COPY TRKM158.                                                01210099
012400 EJECT                                                            01240099
012500*----------------------------------------------------------------*01250099
012600*    ATTRIBUTE SETTINGS COPYBOOK.                                *01260099
012700*----------------------------------------------------------------*01270099
012900     COPY DPWS015.                                                01290099
013600 EJECT                                                            01360099
013100*----------------------------------------------------------------*01310099
013200*    FUNCTION KEYS COPYBOOK                                      *01320099
013300*----------------------------------------------------------------*01330099
013500     COPY DPWS016.                                                01350099
013600 EJECT                                                            01360099
013700***************************************************************** 01370099
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          *         
013900***************************************************************** 01390099
014000     COPY DPWS030.                                                01400099
CICS       COPY DPWS930.                                                        
014100 EJECT                                                            01410099
014200***************************************************************** 01420099
014300*    STANDARD COMMAREA.                                           01430099
014400***************************************************************** 01440099
014500                                                                  01450099
014600     COPY DPWS020.                                                01460099
014700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01470099
014800                                                                  01480099
014900***************************************************************** 01490099
015000*    INTER-APPLICATION COMMAREA.                                  01500099
015100***************************************************************** 01510099
015200                                                                  01520099
015300         10  INTER-APPL-COMM-AREA PIC X(230).                     01530099
015400     COPY TRWS157.                                                01540099
015500***************************************************************** 01550099
015600*    SPECIFIC COMMMAREA FOR TRKCS158.                             01560099
015700***************************************************************** 01570099
               10  ASC-SPECIFIC-COMMAREA.                                       
015900             15  ASC-FORMAT-IND                 PIC  X(01).       01590099
016000                 88  ASC-ADD-ORG                        VALUE '1',01600099
                                                                    '4'.        
016100                 88  ASC-UPD-ORG                        VALUE '2'.        
016200                 88  ASC-DEL-ORG                        VALUE '3'.01620099
016300                 88  ASC-UPD-FROM-LIST                  VALUE '4'.01630099
016400                 88  ASC-DEL-FROM-LIST                  VALUE '5'.01640099
016500                 88  ASC-ADD-FROM-LIST                  VALUE '6'.01650099
016600             15  ASC-ADD-COMPLETE-SW            PIC  X(01).       01660099
016700                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.01670099
016800                 88  ASC-ADD-PENDING                    VALUE 'N'.01680099
016900             15  ASC-UPD-COMPLETE-SW            PIC  X(01).       01690099
017000                 88  ASC-UPD-COMPLETE                   VALUE 'Y'.01700099
017100                 88  ASC-UPD-PENDING                    VALUE 'N'.01710099
017200             15  ASC-DEL-COMPLETE-SW            PIC  X(01).       01720099
017300                 88  ASC-DEL-COMPLETE                   VALUE 'Y'.01730099
017400                 88  ASC-DEL-PENDING                    VALUE 'N'.01740099
017500             15  ASC-COUNTRY-DESC-CHANGED-SW      PIC  X(01).     01750099
017600                 88  ASC-COUNTRY-DESC-CHANGED          VALUE 'Y'. 01760099
017700                 88  ASC-COUNTRY-DESC-NOT-CHANGED      VALUE ' '. 01770099
                   15  ASC-IMPRT-ORGN-CDE             PIC  X(03).               
                   15  ASC-IMPRT-ORGN-TYP-CDE         PIC  X(03).               
017900             15  ASC-CNTRY-CDE                  PIC  X(03).       01790099
                   15  ASC-STD-EDI-CDE                PIC  X(05).               
                   15  ASC-CTY-NM                     PIC  X(30).               
                   15  ASC-STAT-CDE                   PIC  X(01).               
019300             15  ASC-COUNTRY-CODE-DESC          PIC  X(40).       01930099
019400             15  ASC-COUNTRY-CODE-IND           PIC  X(01).       01940099
019500                 88  ASC-VALID-COUNTRY-CODE    VALUE 'Y'.         01950099
019600                 88  ASC-INACTIVE-COUNTRY-CODE VALUE 'I'.         01960099
019700                 88  ASC-INVALID-COUNTRY-CODE  VALUE 'N'.         01970099
020200             15  ASC-ORG-CODE-IND               PIC  X(01).       02020099
020300                 88  ASC-VALID-ORG-CODE        VALUE 'Y'.         02030099
020400                 88  ASC-INVALID-ORG-CODE      VALUE 'N'.         02040099
020500             15  ASC-USE-SELECTION-QUEUE-IND PIC  X(01).          02050099
020600                 88  ASC-USE-SEL-QUEUE         VALUE 'Y'.         02060099
020700             15  ASC-LIST-QUEUE-NAME.                             02070099
020800                 20  ASC-LIST-TERM-ID                PIC  X(04).  02080099
020900                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   02090099
021000                                                          COMP-3. 02100099
021100                 20  ASC-LIST-SEQ                    PIC  9(01).  02110099
021200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02120099
021300                                            PIC S9(09) COMP-3.    02130099
021400             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    02140099
021500             15  ASC-SEL-QUEUE-NAME.                              02150099
021600                 20  ASC-SEL-TERM-ID        PIC X(04).            02160099
021700                 20  ASC-SEL-TASK           PIC S9(05) COMP-3.    02170099
021800                 20  ASC-SEL-SEQ            PIC 9(01).            02180099
021900             15  ASC-SEL-SUB                PIC S9(04) COMP.      02190099
022000             15  ASC-SEL-ITEM               PIC S9(04) COMP.      02200099
022100     EJECT                                                        02210099
022200*----------------------------------------------------------------*02220099
022300*    ABEND PROCESSING COPYBOOK.                                  *02230099
022400*----------------------------------------------------------------*02240099
022600     COPY DPWS013.                                                02260099
022700                                                                  02270099
024300*---------------------------------------------------------------* 02430099
024400*    DB2 AREA FOR TRANSPORATION ORG TABLE                       * 02440099
024500*---------------------------------------------------------------* 02450099
024600     EXEC SQL                                                     02460099
024700          INCLUDE TRT00010                                        02470099
024800     END-EXEC.                                                    02480099
026500*---------------------------------------------------------------* 02650099
026600*    DB2 AREA FOR AUDIT ORG TABLE                               * 02660099
026700*---------------------------------------------------------------* 02670099
026800     EXEC SQL                                                     02680099
026900          INCLUDE TRT00011                                        02690099
027000     END-EXEC.                                                    02700099
025700*---------------------------------------------------------------* 02570099
025800*    DB2 AREA FOR COUNTRY CODE TABLE                            * 02580099
025900*---------------------------------------------------------------* 02590099
026000     EXEC SQL                                                     02600099
026100          INCLUDE TCNTRY                                          02610099
026200     END-EXEC.                                                    02620099
027200*---------------------------------------------------------------* 02720099
027300*    DB2 AREA FOR COMMUNICATIONS                                * 02730099
027400*---------------------------------------------------------------* 02740099
027500     EXEC SQL                                                     02750099
027600          INCLUDE SQLCA                                           02760099
027700     END-EXEC.                                                    02770099
027800                                                                  02780099
027900 EJECT                                                            02790099
030900                                                                  03090099
030900                                                                  03090099
031000 LINKAGE SECTION.                                                 03100099
031100 01  DFHCOMMAREA.                                                 03110099
031200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03120099
031300                                        DEPENDING ON EIBCALEN.    03130099
031400         10  FILLER                     PIC  X(01).               03140099
031500                                                                  03150099
031600                                                                  03160099
031700 PROCEDURE DIVISION.                                              03170099
031800***************************************************************** 03180099
031900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03190099
032000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03200099
032100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03210099
032200**                                                             ** 03220099
032300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03230099
032400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03240099
032500***************************************************************** 03250099
032600 0000-MAIN-MODULE.                                                03260099
032700     INITIALIZE DP030-CICS-API-FIELDS.                            03270099
032800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03280099
032900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03290099
033000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03300099
033100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03310099
033200     MOVE LENGTH OF TR158AI        TO DP030-MAP-LENGTH (1).       03320099
033300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03330099
033400     PERFORM 0001-CALL-CICS-ARCH-API.                             03340099
033500*                                                                 03350099
033600     PERFORM 1000-CONTROL-PROCESSING                              03360099
033700*                                                                 03370099
033800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03380099
033900     PERFORM 0001-CALL-CICS-ARCH-API.                             03390099
034000                                                                  03400099
034100 0001-CALL-CICS-ARCH-API.                                         03410099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
034300                                    DFHCOMMAREA                           
034400                                    DP030-CICS-API-FIELDS                 
034500                                    DP020-STANDARD-COMMAREA               
034600                                    TR158AI.                              
034700*                                                                 03470099
034800     IF  DP030-RC-CALL-SUCCESSFUL                                 03480099
034900         CONTINUE                                                 03490099
035000     ELSE                                                         03500099
035100         SET DP013-NO-ROLLBACK                                    03510099
035200             DP013-XCTL-DISPLAY-RESTART                           03520099
035300             DP013-CICS-ABEND      TO TRUE                        03530099
035400         MOVE 'BEFORE 0000-MAIN-MODULE'                           03540099
035500                                   TO DP013-PARAGRAPH             03550099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
035800         MOVE DP030-RETURN-CODE                                   03580099
035900                                   TO DP013-MESSAGE-TEXT (3)      03590099
036000         PERFORM DP013-0000-PROCESS-ABEND                         03600099
036100     END-IF.                                                      03610099
036200 EJECT                                                            03620099
036300*----------------------------------------------------------------*03630099
036400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03640099
036500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03650099
036600*----------------------------------------------------------------*03660099
036700                                                                  03670099
036800 1000-CONTROL-PROCESSING.                                         03680099
036900                                                                  03690099
037000     EVALUATE TRUE                                                03700099
037100         WHEN DP020-NEXT-ACT-INITIAL                              03710099
037200             INITIALIZE ASC-SPECIFIC-COMMAREA                     03720099
040700             PERFORM 1100-PROCESS-INTER-APPL-COMM                 04070099
040800             PERFORM 4000-BUILD-INITIAL-PANEL                     04080099
040900             IF ASC-ADD-ORG                                       04090099
041000               CONTINUE                                           04100099
041100             ELSE                                                 04110099
041200               PERFORM 3000-EDIT-DATA-IN-COMMAREA                 04120099
041300             END-IF                                               04130099
041400                                                                  04140099
041500         WHEN DP020-NEXT-ACT-READ-MAP                             04150099
041600             PERFORM 2000-PROCESS-PANEL                           04160099
+41700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04170099
041800                                                                  04180099
041900         WHEN DP020-NEXT-ACT-RETURN                               04190099
042000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04200099
042100                                                                  04210099
042200         WHEN OTHER                                               04220099
042300             SET DP013-LOGIC-ABEND                                04230099
042400                 DP013-NO-ROLLBACK TO TRUE                        04240099
042500             MOVE '1000-CONTROL-PROCESSING'                       04250099
042600                                   TO DP013-PARAGRAPH             04260099
042700             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04270099
042800                                   TO DP013-MESSAGE-TEXT(1)       04280099
042900             MOVE DP020-NEXT-APPL-ACTIVITY                        04290099
043000                                   TO DP013-MESSAGE-TEXT(2)       04300099
043100             PERFORM DP013-0000-PROCESS-ABEND                     04310099
043200     END-EVALUATE.                                                04320099
043300                                                                  04330099
043400*----------------------------------------------------------------*04340099
043500*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *04350099
043600*    INTER-APPLICATION FORMAT CODE.                              *04360099
043700*                                                                *04370099
043800*    PERFORM SPECIFIC VALIDATIONS FOR EACH "MODE" AND BASED      *04380099
043900*    ON WHERE THE PROGRAM WAS INITIATED FROM.                    *04390099
044000*----------------------------------------------------------------*04400099
044100 1100-PROCESS-INTER-APPL-COMM.                                    04410099
                                                                                
           MOVE TR157-CNTRY-CDE           TO ASC-CNTRY-CDE              03730099
                                             DK-CNTRY-CDE.                      
           MOVE TR157-IMPRT-ORGN-CDE      TO ASC-IMPRT-ORGN-CDE.                
           MOVE TR157-IMPRT-ORGN-TYP-CDE  TO ASC-IMPRT-ORGN-TYP-CDE.            
           MOVE TR157-STD-EDI-CDE         TO ASC-STD-EDI-CDE.                   
           MOVE TR157-CTY-NM              TO ASC-CTY-NM.                        
           MOVE DP020-INT-APPL-FORMAT-IND TO ASC-FORMAT-IND.            04000099
           PERFORM 4300-SELECT-COUNTRY-CODE.                                    
           MOVE CNTRY-CNTRY-NM            TO ASC-COUNTRY-CODE-DESC.             
           MOVE -1                        TO AORGCODL.                  04910099
           SET DP030-SET-CURSOR-APPL-1    TO TRUE.                      04920099
067100                                                                  06710099
069600*----------------------------------------------------------------*06960099
069700* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06970099
069800* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06980099
069900* EDITS.                                                         *06990099
070000*----------------------------------------------------------------*07000099
070100 2000-PROCESS-PANEL.                                              07010099
070200                                                                  07020099
070300     EVALUATE TRUE                                                07030099
070400                                                                  07040099
070500         WHEN DP020-SRC-AID = DP016-CLEAR                         07050099
070700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07070099
070600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07060099
070800                                                                  07080099
070900         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    07090099
071100              MOVE TR157-IMPRT-ORGN-CDE                                   
                                        TO ASC-IMPRT-ORGN-CDE                   
071200                                     DK-IMPRT-ORGN-CDE            07120099
071100              MOVE TR157-IMPRT-ORGN-TYP-CDE                               
                                        TO ASC-IMPRT-ORGN-TYP-CDE               
071200                                     DK-IMPRT-ORGN-TYP-CDE        07120099
071300              PERFORM 4100-SELECT-ORG                             07130099
071400                                                                  07140099
071500              IF  ASC-VALID-ORG-CODE                              07150099
071600              AND TRT00010-STAT-CDE = PC-I                        07160099
071700                   SET ASC-DEL-COMPLETE TO TRUE                   07170099
071800              END-IF                                              07180099
071900                                                                  07190099
072000              IF  ASC-DEL-COMPLETE                                07200099
072100                  MOVE PC-TSYMSG-00116  TO DP020-MSG-NUMBER       07210099
072300                  SET DP020-MSG-FATAL                             07230099
072400                      PS-ERROR          TO TRUE                   07240099
072500              ELSE                                                07250099
072600                  SET DP030-CONTINUE-GO TO TRUE                   07260099
072900                  PERFORM 7000-DEL-ORG-CODE                       07290099
073000             END-IF                                               07300099
073100                                                                  07310099
073200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07320099
073400             SET TR157-RECORD-UPDATED       TO TRUE               07340099
073800             MOVE -1                        TO AORGCODL           07380099
                   SET DP030-SET-CURSOR-APPL-1    TO TRUE                       
074000             MOVE ZEROES                    TO DP020-MSG-NUMBER   07400099
074100             MOVE DP020-INT-APPL-FORMAT-IND TO ASC-FORMAT-IND     07410099
073600             PERFORM 3200-RESET-ATTRIBUTES                        07360099
074200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07420099
074600                                                                  07460099
079700         WHEN OTHER                                               07970099
079800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07980099
079900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07990099
080000             IF  PS-NO-ERROR                                      08000099
080100                 PERFORM 2100-CHECK-FUNCTION-KEY                  08010099
080200                 SET DP030-CONTINUE-GO TO TRUE                    08020099
080300             ELSE                                                 08030099
080400                 SET DP030-OVERRIDE-GO TO TRUE                    08040099
080500             END-IF                                               08050099
080600     END-EVALUATE.                                                08060099
080700                                                                  08070099
080800 EJECT                                                            08080099
080900******************************************************************08090099
081000** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **08100099
081100** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **08110099
081200** FROM THE CICS ARCHITECTURE API.                              **08120099
081300******************************************************************08130099
081400 2100-CHECK-FUNCTION-KEY.                                         08140099
081500                                                                  08150099
081600     EVALUATE TRUE                                                08160099
081700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08170099
081800                                                                  08180099
081900             MOVE ASC-IMPRT-ORGN-CDE     TO DK-IMPRT-ORGN-CDE     08190099
                   MOVE ASC-IMPRT-ORGN-TYP-CDE TO DK-IMPRT-ORGN-TYP-CDE         
082100             PERFORM 4100-SELECT-ORG                              08210099
082200                                                                  08220099
082300             IF  ASC-VALID-ORG-CODE                               08230099
082500             AND TRT00010-STAT-CDE = PC-A                         08250099
082600                 SET ASC-ADD-COMPLETE TO TRUE                     08260099
082900             END-IF                                               08290099
083000                                                                  08300099
083100             IF NOT ASC-ADD-COMPLETE                              08310099
083200                IF ASC-VALID-ORG-CODE                             08320099
                         MOVE PC-U TO DK-FUNC-CDE                               
                         PERFORM 6200-UPDATE-AUDIT-ORG-CODE                     
083300                   PERFORM 7200-ACTIVATE-ORG                      08330099
083400                ELSE                                              08340099
083500                   PERFORM 6150-INSERT-ORG-CODE                   08350099
083600                END-IF                                            08360099
083700                SET ASC-ADD-COMPLETE  TO TRUE                     08370099
083900*               THE ORG CODE HAS BEEN ADDED                       08390099
084100                MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER         08410099
084200                SET ASC-ADD-ORG TO TRUE                           08420099
084300                MOVE +1 TO TR157-NUMBER-OF-TS-ITEMS               08430099
084400                PERFORM 3200-RESET-ATTRIBUTES                     08440099
087900                SET DP020-MSG-INFORMATIONAL  TO TRUE              08790099
084500                                                                  08450099
                      MOVE ASC-COUNTRY-CODE-DESC TO TR157-CNTRY-CDE             
                      MOVE ASC-IMPRT-ORGN-CDE    TO TR157-IMPRT-ORGN-CDE        
                      MOVE ASC-CTY-NM            TO TR157-CTY-NM                
                      MOVE ASC-STD-EDI-CDE       TO TR157-STD-EDI-CDE           
087800                                                                  08780099
088100                PERFORM 2110-PREPARE-INTER-APPL-COMM              08810099
088200             ELSE                                                 08820099
088300                MOVE PC-TSYMSG-00223  TO DP020-MSG-NUMBER         08830099
088400             END-IF                                               08840099
088500                                                                  08850099
088600         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              08860099
                   MOVE PC-U TO DK-FUNC-CDE                                     
406200             PERFORM 6200-UPDATE-AUDIT-ORG-CODE                   40620099
088700             PERFORM 6100-UPDATE-ORG-CODE                         08870099
088800             SET ASC-UPD-COMPLETE                                 08880099
088900                 ASC-COUNTRY-DESC-NOT-CHANGED TO TRUE             08890099
089300             MOVE PC-TSYMSG-00059             TO DP020-MSG-NUMBER 08930099
089400             SET DP020-MSG-INFORMATIONAL      TO TRUE             08940099
089600             PERFORM 2110-PREPARE-INTER-APPL-COMM                 08960099
089700                                                                  08970099
092400         WHEN DP020-SRC-AID = DP016-ENTER                         09240099
092500             CONTINUE                                             09250099
092600                                                                  09260099
092700         WHEN OTHER                                               09270099
092800             SET DP013-NO-ROLLBACK                                09280099
092900                 DP013-XCTL-DISPLAY-RESTART                       09290099
093000                 DP013-CICS-ABEND  TO TRUE                        09300099
093100             MOVE '2100-CHECK-FUNCTION-KEY'                       09310099
093200                                   TO DP013-PARAGRAPH             09320099
093300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09330099
093400                                   TO DP013-MESSAGE-TEXT (1)      09340099
093500             PERFORM DP013-0000-PROCESS-ABEND                     09350099
093600     END-EVALUATE.                                                09360099
093700 EJECT                                                            09370099
093800******************************************************************09380099
093900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **09390099
094000** INTER-APPLICATION COMMAREA.                                  **09400099
094100******************************************************************09410099
094200 2110-PREPARE-INTER-APPL-COMM.                                    09420099
094300      MOVE ASC-CNTRY-CDE         TO TR157-CNTRY-CDE.              09430099
094400      MOVE ASC-STD-EDI-CDE       TO TR157-STD-EDI-CDE.            09440099
            MOVE ASC-CTY-NM            TO TR157-CTY-NM.                         
094700                                                                  09470099
115300*----------------------------------------------------------------*11530099
115400* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *11540099
115500* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *11550099
115600* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *11560099
115700*----------------------------------------------------------------*11570099
105000*----------------------------------------------------------------*10500099
105100* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*10510099
105200* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *10520099
105300* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *10530099
105400*----------------------------------------------------------------*10540099
105500                                                                  10550099
105600 2200-MOVE-SCREEN-TO-COMMAREA.                                    10560099
105700                                                                  10570099
105800     IF  AORGCODL > ZERO                                          10580099
105900         MOVE AORGCODI             TO ASC-IMPRT-ORGN-CDE          10590099
106000     ELSE                                                         10600099
106100         IF  AORGCODF = DP015-ERASE-EOF                           10610099
106200             MOVE SPACE            TO ASC-IMPRT-ORGN-CDE          10620099
106300         END-IF                                                   10630099
106400     END-IF.                                                      10640099
105700                                                                  10570099
105800     IF  AORGTYPL > ZERO                                          10580099
105900         MOVE AORGTYPI             TO ASC-IMPRT-ORGN-TYP-CDE      10590099
106000     ELSE                                                         10600099
106100         IF  AORGTYPF = DP015-ERASE-EOF                           10610099
106200             MOVE SPACE            TO ASC-IMPRT-ORGN-TYP-CDE      10620099
106300         END-IF                                                   10630099
106400     END-IF.                                                      10640099
105700                                                                  10570099
105800     IF  ACNTCODL > ZERO                                          10580099
105900         MOVE ACNTCODI             TO ASC-CNTRY-CDE               10590099
106000     ELSE                                                         10600099
106100         IF  ACNTCODF = DP015-ERASE-EOF                           10610099
106200             MOVE SPACE            TO ASC-CNTRY-CDE               10620099
106200             MOVE SPACE            TO ASC-COUNTRY-CODE-DESC       10620099
106300         END-IF                                                   10630099
106400     END-IF.                                                      10640099
105700                                                                  10570099
105800     IF  AEDICODL > ZERO                                          10580099
105900         MOVE AEDICODI             TO ASC-STD-EDI-CDE             10590099
106000     ELSE                                                         10600099
106100         IF  AEDICODF = DP015-ERASE-EOF                           10610099
106200             MOVE SPACE            TO ASC-STD-EDI-CDE             10620099
106300         END-IF                                                   10630099
106400     END-IF.                                                      10640099
105700                                                                  10570099
105800     IF  AORGCTYL > ZERO                                          10580099
105900         MOVE AORGCTYI             TO ASC-CTY-NM                  10590099
106000     ELSE                                                         10600099
106100         IF  AORGCTYF = DP015-ERASE-EOF                           10610099
106200             MOVE SPACE            TO ASC-CTY-NM                  10620099
106300         END-IF                                                   10630099
106400     END-IF.                                                      10640099
105700                                                                  10570099
105800     IF  ACNTDESL > ZERO                                          10580099
105900         MOVE ACNTDESI             TO ASC-COUNTRY-CODE-DESC       10590099
106000     ELSE                                                         10600099
106100         IF  ACNTDESF = DP015-ERASE-EOF                           10610099
106200             MOVE SPACE            TO ASC-COUNTRY-CODE-DESC       10620099
106300         END-IF                                                   10630099
106400     END-IF.                                                      10640099
                                                                                
115900 3000-EDIT-DATA-IN-COMMAREA.                                      11590099
116000                                                                  11600099
116100     PERFORM 3200-RESET-ATTRIBUTES.                               11610099
149400                                                                  14940099
149300     MOVE ASC-CNTRY-CDE TO DK-CNTRY-CDE.                          14930099
149500     PERFORM 4300-SELECT-COUNTRY-CODE.                            14950099
149600                                                                  14960099
           EVALUATE TRUE                                                        
116700        WHEN ASC-UPD-ORG                                          11670099
116800             PERFORM 3120-UPD-ORG                                 11680099
116700        WHEN ASC-ADD-ORG                                          11670099
               AND TR157-NUMBER-OF-TS-ITEMS = ZERO                              
                   PERFORM 3130-ADD-ORG                                         
118900     END-EVALUATE.                                                11890099
                                                                                
133000 3120-UPD-ORG.                                                    13300099
133100                                                                  13310099
           IF ASC-INVALID-COUNTRY-CODE                                  9       
              SET PS-ERROR                                              9       
                  DP020-MSG-FATAL         TO TRUE                       9       
              MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER           9       
              MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCODA                   9       
              MOVE DP015-RED              TO ACNTCODC                   9       
              MOVE DP015-REVERSE          TO ACNTCODH                   9       
              MOVE -1                     TO ACNTCODL                   9       
              SET DP030-SET-CURSOR-APPL-1 TO TRUE                               
              MOVE SPACES                 TO CNTRY-CNTRY-NM             15070099
           END-IF                                                       9       
                                                                        9       
           IF ASC-INACTIVE-COUNTRY-CODE                                 9       
              SET PS-ERROR                                              9       
                  DP020-MSG-FATAL         TO TRUE                       9       
              MOVE PC-TSYMSG-01644        TO DP020-MSG-NUMBER           9       
              MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCODA                   9       
              MOVE DP015-RED              TO ACNTCODC                   9       
              MOVE DP015-REVERSE          TO ACNTCODH                   9       
              MOVE -1                     TO ACNTCODL                   9       
              SET DP030-SET-CURSOR-APPL-1 TO TRUE                               
              MOVE SPACES                 TO CNTRY-CNTRY-NM             9       
           END-IF                                                       9       
152400                                                                  15240099
152500     MOVE CNTRY-CNTRY-NM            TO ASC-COUNTRY-CODE-DESC      15250099
152600                                       ACNTDESO.                  15260099
152700                                                                  15270099
152800     IF ASC-CTY-NM = SPACES                                       15280099
152900         SET PS-ERROR                                             15290099
153000             DP020-MSG-FATAL         TO TRUE                      15300099
153100         MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER          15310099
153200         MOVE DP015-UNP-ALP-BRT-OFF  TO AORGCTYA                  15320099
153400         MOVE DP015-RED              TO AORGCTYC                  15340099
153500         MOVE DP015-REVERSE          TO AORGCTYH                  15350099
153600         MOVE -1                     TO AORGCTYL                  15360099
               SET DP030-SET-CURSOR-APPL-1 TO TRUE                              
153800     ELSE                                                         15380099
153900         MOVE DP015-GREEN            TO AORGCTYC                  15390099
154000         MOVE DP015-UNDERLINE        TO AORGCTYH                  15400099
154100     END-IF.                                                      15410099
154200                                                                  15420099
154300     IF ASC-STD-EDI-CDE = SPACES                                  15430099
154500           SET PS-ERROR                                           15450099
154600               DP020-MSG-FATAL         TO TRUE                    15460099
154700           MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER        15470099
154800           MOVE DP015-UNP-ALP-BRT-OFF  TO AEDICODA                15480099
155000           MOVE DP015-RED              TO AEDICODC                15500099
155100           MOVE DP015-REVERSE          TO AEDICODH                15510099
155200           MOVE -1                     TO AEDICODL                15520099
                 SET DP030-SET-CURSOR-APPL-1 TO TRUE                            
155400     ELSE                                                         15540099
155500           MOVE DP015-GREEN           TO AEDICODC                 15550099
155600           MOVE DP015-UNDERLINE       TO AEDICODH                 15560099
155700     END-IF.                                                      15570099
                                                                                
       3130-ADD-ORG.                                                    13300099
                                                                                
           IF ASC-INVALID-COUNTRY-CODE                                  9       
              SET PS-ERROR                                              9       
                  DP020-MSG-FATAL         TO TRUE                       9       
              MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER           9       
              MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCODA                   9       
              MOVE DP015-RED              TO ACNTCODC                   9       
              MOVE DP015-REVERSE          TO ACNTCODH                   9       
              MOVE -1                     TO ACNTCODL                   9       
              SET DP030-SET-CURSOR-APPL-1 TO TRUE                               
              MOVE SPACES                 TO CNTRY-CNTRY-NM             15070099
           END-IF                                                       9       
                                                                        9       
           IF ASC-INACTIVE-COUNTRY-CODE                                 9       
              SET PS-ERROR                                              9       
                  DP020-MSG-FATAL         TO TRUE                       9       
              MOVE PC-TSYMSG-01644        TO DP020-MSG-NUMBER           9       
              MOVE DP015-UNP-ALP-BRT-OFF  TO ACNTCODA                   9       
              MOVE DP015-RED              TO ACNTCODC                   9       
              MOVE DP015-REVERSE          TO ACNTCODH                   9       
              MOVE -1                     TO ACNTCODL                   9       
              SET DP030-SET-CURSOR-APPL-1 TO TRUE                               
              MOVE SPACES                 TO CNTRY-CNTRY-NM             9       
           END-IF                                                       9       
152400                                                                  15240099
152500     MOVE CNTRY-CNTRY-NM            TO ASC-COUNTRY-CODE-DESC      15250099
152600                                       ACNTDESO.                  15260099
152700                                                                  15270099
152800     IF ASC-CTY-NM = SPACES                                       15280099
152900         SET PS-ERROR                                             15290099
153000             DP020-MSG-FATAL         TO TRUE                      15300099
153100         MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER          15310099
153200         MOVE DP015-UNP-ALP-BRT-OFF  TO AORGCTYA                  15320099
153400         MOVE DP015-RED              TO AORGCTYC                  15340099
153500         MOVE DP015-REVERSE          TO AORGCTYH                  15350099
153600         MOVE -1                     TO AORGCTYL                  15360099
               SET DP030-SET-CURSOR-APPL-1 TO TRUE                              
153800     ELSE                                                         15380099
153900         MOVE DP015-GREEN            TO AORGCTYC                  15390099
154000         MOVE DP015-UNDERLINE        TO AORGCTYH                  15400099
154100     END-IF.                                                      15410099
154200                                                                  15420099
154300     IF ASC-STD-EDI-CDE = SPACES                                  15430099
154500           SET PS-ERROR                                           15450099
154600               DP020-MSG-FATAL         TO TRUE                    15460099
154700           MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER        15470099
154800           MOVE DP015-UNP-ALP-BRT-OFF  TO AEDICODA                15480099
155000           MOVE DP015-RED              TO AEDICODC                15500099
155100           MOVE DP015-REVERSE          TO AEDICODH                15510099
155200           MOVE -1                     TO AEDICODL                15520099
                 SET DP030-SET-CURSOR-APPL-1 TO TRUE                            
155400     ELSE                                                         15540099
155500           MOVE DP015-GREEN            TO AEDICODC                15550099
155600           MOVE DP015-UNDERLINE        TO AEDICODH                15560099
155700     END-IF.                                                      15570099
                                                                                
           IF  ASC-IMPRT-ORGN-CDE     > SPACES                                  
           AND ASC-IMPRT-ORGN-TYP-CDE > SPACES                                  
              MOVE ASC-IMPRT-ORGN-CDE     TO DK-IMPRT-ORGN-CDE          08190099
              MOVE ASC-IMPRT-ORGN-TYP-CDE TO DK-IMPRT-ORGN-TYP-CDE              
              PERFORM 4100-SELECT-ORG                                   08210099
                                                                                
              IF ASC-VALID-ORG-CODE                                             
                 IF TRT00010-STAT-CDE = PC-A                                    
                    SET PS-ERROR                                        9       
                        DP020-MSG-FATAL         TO TRUE                 9       
                    MOVE PC-TSYMSG-01646        TO DP020-MSG-NUMBER     9       
                    MOVE DP015-UNP-ALP-BRT-OFF  TO AORGCODA             9       
                                                   AORGTYPA                     
                    MOVE DP015-RED              TO AORGCODC             9       
                                                   AORGTYPC                     
                    MOVE DP015-REVERSE          TO AORGCODH             9       
                                                   AORGTYPH                     
                    MOVE -1                     TO AORGCODL             9       
                    SET DP030-SET-CURSOR-APPL-1 TO TRUE                         
                 ELSE                                                           
                    MOVE ZEROES                 TO DP020-MSG-NUMBER     9       
                    MOVE TRT00010-IMPRT-ORGN-CDE                                
                                            TO ASC-IMPRT-ORGN-CDE               
                                               TR157-IMPRT-ORGN-CDE             
                    MOVE TRT00010-IMPRT-ORGN-TYP-CDE                            
                                            TO ASC-IMPRT-ORGN-TYP-CDE           
                                               TR157-IMPRT-ORGN-TYP-CDE         
                    MOVE TRT00010-CNTRY-CDE                                     
                                            TO ASC-CNTRY-CDE                    
                                               TR157-CNTRY-CDE                  
                                               DK-CNTRY-CDE                     
                    MOVE TRT00010-STD-EDI-CDE                                   
                                            TO ASC-STD-EDI-CDE                  
                                               TR157-STD-EDI-CDE                
                    MOVE TRT00010-CTY-NM                                        
                                            TO ASC-CTY-NM                       
                                               TR157-CTY-NM                     
                    PERFORM 4300-SELECT-COUNTRY-CODE                    14950099
                    MOVE CNTRY-CNTRY-NM     TO ASC-COUNTRY-CODE-DESC            
                                                                                
                    MOVE +1 TO TR157-NUMBER-OF-TS-ITEMS                         
                    PERFORM 3200-RESET-ATTRIBUTES                               
                 END-IF                                                         
              END-IF                                                            
           ELSE                                                                 
              IF ASC-IMPRT-ORGN-CDE = SPACES                            15430099
                    SET PS-ERROR                                        15450099
                        DP020-MSG-FATAL         TO TRUE                 15460099
                    MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER     15470099
                    MOVE DP015-UNP-ALP-BRT-OFF  TO AORGCODA             15480099
                    MOVE DP015-RED              TO AORGCODC             15500099
                    MOVE DP015-REVERSE          TO AORGCODH             15510099
                    MOVE -1                     TO AORGCODL             15520099
                    SET DP030-SET-CURSOR-APPL-1 TO TRUE                         
              END-IF                                                    15540099
              IF ASC-IMPRT-ORGN-TYP-CDE = SPACES                        15430099
                    SET PS-ERROR                                        15450099
                        DP020-MSG-FATAL         TO TRUE                 15460099
                    MOVE PC-TSYMSG-01450        TO DP020-MSG-NUMBER     15470099
                    MOVE DP015-UNP-ALP-BRT-OFF  TO AORGTYPA             15480099
                    MOVE DP015-RED              TO AORGTYPC             15500099
                    MOVE DP015-REVERSE          TO AORGTYPH             15510099
                    MOVE -1                     TO AORGTYPL             15520099
                    SET DP030-SET-CURSOR-APPL-1 TO TRUE                         
              END-IF                                                    15540099
           END-IF.                                                              
                                                                                
243500 3200-RESET-ATTRIBUTES.                                           24350099
243600*                                                                 24360099
243700     EVALUATE TRUE                                                24370099
253300                                                                  25330099
253400         WHEN ASC-UPD-ORG                                         25340099
253500             MOVE DP015-PRO-NOR-OFF        TO AORGCODA            25350099
253600                                              AORGTYPA            25360099
254000                                              ACNTDESA            25400099
253700             MOVE DP015-UNP-ALP-NOR-OFF    TO ACNTCODA            25370099
253800                                              AEDICODA            25380099
253900                                              AORGCTYA            25390099
254100             MOVE DP015-HL-OFF             TO AORGCODH            25410099
254200                                              AORGTYPH            25420099
254600                                              ACNTDESH            25460099
254300             MOVE DP015-UNDERLINE          TO ACNTCODH            25430099
254400                                              AEDICODH            25440099
254500                                              AORGCTYH            25450099
254700             MOVE DP015-BLUE               TO AORGCODC            25470099
254800                                              AORGTYPC            25480099
255200                                              ACNTDESC            25520099
254900             MOVE DP015-GREEN              TO ACNTCODC            25490099
255000                                              AEDICODC            25500099
255100                                              AORGCTYC            25510099
253400         WHEN ASC-ADD-ORG                                         25340099
                AND TR157-NUMBER-OF-TS-ITEMS = ZERO                             
253500             MOVE DP015-UNP-ALP-NOR-OFF    TO AORGCODA            25350099
253600                                              AORGTYPA            25360099
253700                                              ACNTCODA            25370099
253800                                              AEDICODA            25380099
253900                                              AORGCTYA            25390099
254000             MOVE DP015-PRO-NOR-OFF        TO ACNTDESA            25400099
254100             MOVE DP015-UNDERLINE          TO AORGCODH            25410099
254200                                              AORGTYPH            25420099
254300                                              ACNTCODH            25430099
254400                                              AEDICODH            25440099
254500                                              AORGCTYH            25450099
254600             MOVE DP015-HL-OFF             TO ACNTDESH            25460099
254700             MOVE DP015-GREEN              TO AORGCODC            25470099
254800                                              AORGTYPC            25480099
254900                                              ACNTCODC            25490099
255000                                              AEDICODC            25500099
255100                                              AORGCTYC            25510099
255200             MOVE DP015-BLUE               TO ACNTDESC            25520099
256700                                                                  25670099
256800         WHEN ASC-DEL-ORG                                         25680099
257000             MOVE DP015-PRO-NOR-OFF        TO AORGCODA            25700099
257100                                              AORGTYPA            25710099
257200                                              ACNTCODA            25720099
257300                                              AEDICODA            25730099
257400                                              AORGCTYA            25740099
257500                                              ACNTDESA            25750099
258200             MOVE DP015-HL-OFF             TO AORGCODH            25820099
258300                                              AORGTYPH            25830099
258400                                              ACNTCODH            25840099
258500                                              AEDICODH            25850099
258600                                              AORGCTYH            25860099
258700                                              ACNTDESH            25870099
259300             MOVE DP015-BLUE               TO AORGCODC            25930099
259400                                              AORGTYPC            25940099
259500                                              ACNTCODC            25950099
259600                                              AEDICODC            25960099
259700                                              AORGCTYC            25970099
259800                                              ACNTDESC            25980099
                                                                                
260300             MOVE PC-TSYMSG-00004         TO DP020-MSG-NUMBER     26030099
260500             SET ASC-DEL-PENDING                                  26050099
260600                 DP020-MSG-INFORMATIONAL  TO TRUE                 26060099
260800                                                                  26080099
260900             MOVE ASC-IMPRT-ORGN-CDE      TO DK-IMPRT-ORGN-CDE    26090099
260900             MOVE ASC-IMPRT-ORGN-TYP-CDE  TO DK-IMPRT-ORGN-TYP-CDE26090099
261100             PERFORM 4100-SELECT-ORG                              26110099
261200                                                                  26120099
261600             IF TRT00010-STAT-CDE = PC-I                          26160099
261700                SET PS-ERROR                                      26170099
261800                    DP020-MSG-FATAL   TO TRUE                     26180099
261900                MOVE PC-TSYMSG-00116  TO DP020-MSG-NUMBER         26190099
262000             END-IF                                               26200099
                                                                                
265200         WHEN OTHER                                               26520099
265300             MOVE DP015-PRO-NOR-OFF        TO AORGCODA            26530099
265400                                              AORGTYPA            26540099
265500                                              ACNTCODA            26550099
265600                                              AEDICODA            26560099
265700                                              AORGCTYA            26570099
265800                                              ACNTDESA            26580099
265900             MOVE DP015-HL-OFF             TO AORGCODH            26590099
266000                                              AORGTYPH            26600099
266100                                              ACNTCODH            26610099
266200                                              AEDICODH            26620099
266300                                              AORGCTYH            26630099
266400                                              ACNTDESH            26640099
266500             MOVE DP015-BLUE               TO AORGCODC            26650099
266600                                              AORGTYPC            26660099
266700                                              ACNTCODC            26670099
266800                                              AEDICODC            26680099
266900                                              AORGCTYC            26690099
267000                                              ACNTDESC            26700099
268300     END-EVALUATE.                                                26830099
268400                                                                  26840099
155800                                                                  15580099
285400*----------------------------------------------------------------*28540099
285500* GET THE NEXT AVAILABLE MESSAGE NUMBER, MOVE IT TO THE SCREEN   *28550099
285600* AND POSITION THE CURSOR FOR THE INITIAL PANEL.                 *28560099
285700*----------------------------------------------------------------*28570099
285800                                                                  28580099
285900 4000-BUILD-INITIAL-PANEL.                                        28590099
                                                                                
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                                
                                                                                
           IF ASC-ADD-ORG                                                       
              IF TR157-NUMBER-OF-TS-ITEMS > ZERO                                
                 MOVE DP015-PRO-NOR-OFF           TO AORGCODA           26530099
                                                     AORGTYPA                   
                                                     ACNTCODA                   
                                                     AEDICODA                   
                                                     AORGCTYA                   
                                                     ACNTDESA                   
                 MOVE DP015-HL-OFF                TO AORGCODH                   
                                                     AORGTYPH                   
                                                     ACNTCODH                   
                                                     AEDICODH                   
                                                     AORGCTYH                   
                                                     ACNTDESH                   
                 MOVE DP015-BLUE                  TO AORGCODC                   
                                                     AORGTYPC                   
                                                     ACNTCODC                   
                                                     AEDICODC                   
                                                     AORGCTYC                   
                                                     ACNTDESC                   
              ELSE                                                              
                 MOVE DP015-UNP-ALP-NOR-OFF       TO AORGCODA           26530099
                                                     AORGTYPA                   
                                                     AEDICODA                   
                                                     AORGCTYA                   
                                                     ACNTCODA                   
                 MOVE DP015-PRO-NOR-OFF           TO ACNTDESA                   
                 MOVE DP015-UNDERLINE             TO AORGCODH                   
                                                     AORGTYPH                   
                                                     AEDICODH                   
                                                     AORGCTYH                   
                                                     ACNTCODH                   
                 MOVE DP015-HL-OFF                TO ACNTDESH                   
                 MOVE DP015-GREEN                 TO AORGCODC                   
                                                     AORGTYPC                   
                                                     AEDICODC                   
                                                     AORGCTYC                   
                                                     ACNTCODC                   
                 MOVE DP015-BLUE                  TO ACNTDESC                   
              END-IF                                                            
           END-IF.                                                              
340900*                                                                 34090099
341000 4100-SELECT-ORG.                                                 34100099
341100                                                                  34110099
341200     EXEC SQL                                                     34120099
341300         SELECT IMPRT_ORGN_CDE                                    34130099
341400               ,IMPRT_ORGN_TYP_CDE                                34140099
341500               ,CNTRY_CDE                                         34150099
341600               ,STD_EDI_CDE                                       34160099
341700               ,CTY_NM                                            34170099
341800               ,STAT_CDE                                          34180099
341900               ,LAST_UPD_TMST                                     34190099
342000               ,LAST_UPD_USR_ID                                   34200099
342200           INTO :TRT00010-IMPRT-ORGN-CDE                          34220099
342300               ,:TRT00010-IMPRT-ORGN-TYP-CDE                      34230099
342400               ,:TRT00010-CNTRY-CDE                               34240099
342500               ,:TRT00010-STD-EDI-CDE                             34250099
342600               ,:TRT00010-CTY-NM                                  34260099
342700               ,:TRT00010-STAT-CDE                                34270099
342800               ,:TRT00010-LAST-UPD-TMST                           34280099
342900               ,:TRT00010-LAST-UPD-USR-ID                         34290099
343100           FROM TRT_IMPRT_ORGN A                                  34310099
343200          WHERE A.IMPRT_ORGN_CDE     = :DK-IMPRT-ORGN-CDE         34320099
                  AND A.IMPRT_ORGN_TYP_CDE = :DK-IMPRT-ORGN-TYP-CDE             
343300            AND A.STAT_CDE IN (:PC-A, :PC-I)                      34330099
343400     END-EXEC                                                     34340099
343500                                                                  34350099
343600         EVALUATE TRUE                                            34360099
343700             WHEN SQLCODE = ZERO                                  34370099
343800                 SET ASC-VALID-ORG-CODE TO TRUE                   34380099
343900             WHEN SQLCODE = +100                                  34390099
344000                 SET ASC-INVALID-ORG-CODE TO TRUE                 34400099
344300             WHEN OTHER                                           34430099
344400                 MOVE '4100-SELECT-ORG    '                       34440099
344500                                   TO DP013-PARAGRAPH             34450099
344600                 MOVE 'SQL ERROR SELECTING COUNTRY NAME'          34460099
344700                                   TO DP013-MESSAGE-TEXT (1)      34470099
344800                 MOVE SQLCA        TO DP013-SQLCA                 34480099
344900                 MOVE 'TRT_IMPRT_ORGN' TO DP013-DB2-TABLE-NAME (1)34490099
345000                 SET DP013-DB2-ABEND                              34500099
345100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           34510099
345200                 PERFORM DP013-0000-PROCESS-ABEND                 34520099
345300         END-EVALUATE.                                            34530099
345400                                                                  34540099
345500 EJECT                                                            34550099
367400*                                                                 36740099
367500 4300-SELECT-COUNTRY-CODE.                                        36750099
367600                                                                  36760099
367700     EXEC SQL                                                     36770099
367800         SELECT A.CNTRY_NM                                        36780099
                     ,A.STAT_CDE                                                
367900           INTO :CNTRY-CNTRY-NM                                   36790099
                     ,:CNTRY-STAT-CDE                                           
368000           FROM TCNTRY A                                          36800099
368100          WHERE A.CNTRY_CDE = :DK-CNTRY-CDE                       36810099
368300     END-EXEC                                                     36830099
368400                                                                  36840099
368500         EVALUATE TRUE                                            36850099
368600             WHEN SQLCODE = ZERO                                  36860099
                       IF CNTRY-STAT-CDE = PC-A                                 
368700                    SET ASC-VALID-COUNTRY-CODE        TO TRUE     36870099
                       ELSE IF CNTRY-STAT-CDE = PC-I                            
                               SET ASC-INACTIVE-COUNTRY-CODE TO TRUE            
                            ELSE                                                
                               SET ASC-INVALID-COUNTRY-CODE  TO TRUE            
                            END-IF                                              
                       END-IF                                                   
368800             WHEN SQLCODE = +100                                  36880099
368900                 SET ASC-INVALID-COUNTRY-CODE TO TRUE             36890099
369000                 MOVE SPACES TO CNTRY-CNTRY-NM                    36900099
369100             WHEN OTHER                                           36910099
369200                 MOVE '4300-SELECT-COUNTRY-CODE'                  36920099
369300                                   TO DP013-PARAGRAPH             36930099
369400                 MOVE 'SQL ERROR SELECTING COUNTRY NAME'          36940099
369500                                   TO DP013-MESSAGE-TEXT (1)      36950099
369600                 MOVE SQLCA        TO DP013-SQLCA                 36960099
369700                 MOVE 'TCNTRY  '   TO DP013-DB2-TABLE-NAME (1)    36970099
369800                 SET DP013-DB2-ABEND                              36980099
369900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36990099
370000                 PERFORM DP013-0000-PROCESS-ABEND                 37000099
370100         END-EVALUATE.                                            37010099
380700*----------------------------------------------------------------*38070099
380800*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *38080099
380900*----------------------------------------------------------------*38090099
381000                                                                  38100099
381100 4400-MOVE-COMMAREA-TO-SCREEN.                                    38110099
                                                                                
           MOVE ASC-IMPRT-ORGN-CDE     TO AORGCODO.                             
           MOVE ASC-IMPRT-ORGN-TYP-CDE TO AORGTYPO.                             
           MOVE ASC-CNTRY-CDE          TO ACNTCODO.                             
           MOVE ASC-STD-EDI-CDE        TO AEDICODO.                             
           MOVE ASC-CTY-NM             TO AORGCTYO.                             
           MOVE ASC-COUNTRY-CODE-DESC  TO ACNTDESO.                             
                                                                                
401900*----------------------------------------------------------------*40190099
402000* UPDATE A ROW IN THE TRT_IMPRT_ORGN TABLE.                      *40200099
402100*----------------------------------------------------------------*40210099
402200 6100-UPDATE-ORG-CODE.                                            40220099
                                                                                
           MOVE ASC-IMPRT-ORGN-CDE     TO DK-IMPRT-ORGN-CDE                     
           MOVE ASC-IMPRT-ORGN-TYP-CDE TO DK-IMPRT-ORGN-TYP-CDE                 
           MOVE ASC-CNTRY-CDE          TO TRT00010-CNTRY-CDE                    
           MOVE ASC-STD-EDI-CDE        TO TRT00010-STD-EDI-CDE                  
           MOVE ASC-CTY-NM             TO TRT00010-CTY-NM                       
           MOVE DP020-USERID           TO TRT00010-LAST-UPD-USR-ID              
404300                                                                  40430099
404400     EXEC SQL                                                     40440099
404500       UPDATE TRT_IMPRT_ORGN                                      40450099
404600         SET  CNTRY_CDE          = :TRT00010-CNTRY-CDE            40460099
404900            , STD_EDI_CDE        = :TRT00010-STD-EDI-CDE          40490099
405000            , CTY_NM             = :TRT00010-CTY-NM               40500099
405200            , LAST_UPD_TMST      = CURRENT TIMESTAMP              40520099
405300            , LAST_UPD_USR_ID    = :TRT00010-LAST-UPD-USR-ID      40530099
405500       WHERE  IMPRT_ORGN_CDE     = :DK-IMPRT-ORGN-CDE             40550099
               AND  IMPRT_ORGN_TYP_CDE = :DK-IMPRT-ORGN-TYP-CDE                 
405700     END-EXEC.                                                    40570099
405800                                                                  40580099
405900     EVALUATE TRUE                                                40590099
406000         WHEN SQLCODE = ZERO                                      40600099
406100             MOVE 'U' TO DK-FUNC-CDE                              40610099
406400         WHEN SQLCODE = +100                                      40640099
406500             CONTINUE                                             40650099
406600         WHEN SQLWARN0 NOT = SPACES                               40660099
406700         WHEN SQLCODE < ZERO                                      40670099
406800         WHEN SQLCODE > ZERO                                      40680099
406900             MOVE '6100-UPDATE-ORG-CODE'                          40690099
407000                               TO DP013-PARAGRAPH                 40700099
407100             MOVE 'UPDATE A ROW INTO THE ORG CODE TABLE'          40710099
407200                               TO DP013-MESSAGE-TEXT(1)           40720099
407300             MOVE SQLCA        TO DP013-SQLCA                     40730099
407400             MOVE 'TRT_IMPRT_ORGN' TO DP013-DB2-TABLE-NAME (1)    40740099
407500             SET DP013-DB2-ABEND                                  40750099
407600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               40760099
407700             PERFORM DP013-0000-PROCESS-ABEND                     40770099
407800     END-EVALUATE.                                                40780099
407900                                                                  40790099
408100*----------------------------------------------------------------*40810099
408200* INSERT A ROW IN THE TIMFOB TABLE.                              *40820099
408300*----------------------------------------------------------------*40830099
408400 6150-INSERT-ORG-CODE.                                            40840099
                                                                                
           MOVE ASC-IMPRT-ORGN-CDE     TO TRT00010-IMPRT-ORGN-CDE.              
           MOVE ASC-IMPRT-ORGN-TYP-CDE TO TRT00010-IMPRT-ORGN-TYP-CDE.          
           MOVE ASC-CNTRY-CDE          TO TRT00010-CNTRY-CDE.                   
           MOVE ASC-STD-EDI-CDE        TO TRT00010-STD-EDI-CDE.                 
           MOVE ASC-CTY-NM             TO TRT00010-CTY-NM.                      
           MOVE DP020-USERID           TO TRT00010-LAST-UPD-USR-ID.             
414600                                                                  41460099
417200     EXEC SQL                                                     41720099
417300       INSERT INTO TRT_IMPRT_ORGN                                 41730099
417400             ( IMPRT_ORGN_CDE                                     41740099
417500              ,IMPRT_ORGN_TYP_CDE                                 41750099
417600              ,CNTRY_CDE                                          41760099
417700              ,STD_EDI_CDE                                        41770099
417800              ,CTY_NM                                             41780099
417900              ,STAT_CDE                                           41790099
418000              ,LAST_UPD_TMST                                      41800099
418100              ,LAST_UPD_USR_ID)                                   41810099
418500       VALUES                                                     41850099
418600            ( :TRT00010-IMPRT-ORGN-CDE                            41860099
418700             ,:TRT00010-IMPRT-ORGN-TYP-CDE                        41870099
418800             ,:TRT00010-CNTRY-CDE                                 41880099
418900             ,:TRT00010-STD-EDI-CDE                               41890099
419000             ,:TRT00010-CTY-NM                                    41900099
419100             ,:PC-A                                               41910099
419200             ,CURRENT TIMESTAMP                                   41920099
419300             ,:TRT00010-LAST-UPD-USR-ID)                          41930099
419700     END-EXEC.                                                    41970099
419800                                                                  41980099
419900     EVALUATE TRUE                                                41990099
420000         WHEN SQLCODE = ZERO                                      42000099
420100             CONTINUE                                             42010099
420200         WHEN SQLWARN0 NOT = SPACES                               42020099
420300         WHEN SQLCODE < ZERO                                      42030099
420400         WHEN SQLCODE > ZERO                                      42040099
420500             MOVE '6150-INSERT-ORG-CODE'                          42050099
420600                               TO DP013-PARAGRAPH                 42060099
420700             MOVE 'INSERT A ROW INTO THE ORG CODE TABLE'          42070099
420800                               TO DP013-MESSAGE-TEXT(1)           42080099
420900             MOVE SQLCA        TO DP013-SQLCA                     42090099
421000             MOVE 'TAUORG'     TO DP013-DB2-TABLE-NAME (1)        42100099
421100             SET DP013-DB2-ABEND                                  42110099
421200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               42120099
421300             PERFORM DP013-0000-PROCESS-ABEND                     42130099
421400     END-EVALUATE.                                                42140099
421500                                                                  42150099
414200*----------------------------------------------------------------*41420099
414300* UPDATE A ROW IN THE ORG AUDIT TABLE.                           *41430099
414400*----------------------------------------------------------------*41440099
414500 6200-UPDATE-AUDIT-ORG-CODE.                                      41450099
                                                                                
           MOVE TRT00010-IMPRT-ORGN-CDE     TO TRT00011-IMPRT-ORGN-CDE.         
           MOVE TRT00010-IMPRT-ORGN-TYP-CDE TO                                  
                                            TRT00011-IMPRT-ORGN-TYP-CDE.        
           MOVE TRT00010-CNTRY-CDE          TO TRT00011-CNTRY-CDE.              
           MOVE TRT00010-STD-EDI-CDE        TO TRT00011-STD-EDI-CDE.            
           MOVE TRT00010-CTY-NM             TO TRT00011-CTY-NM.                 
           MOVE TRT00010-STAT-CDE           TO TRT00011-STAT-CDE.               
           MOVE DP020-USERID                TO TRT00011-LAST-UPD-USR-ID.        
           MOVE DK-FUNC-CDE                 TO TRT00011-AUD-FUNC-CDE.           
414600                                                                  41460099
417200     EXEC SQL                                                     41720099
417300       INSERT INTO TRT_AUD_IMPRT_ORGN                             41730099
417400             ( IMPRT_ORGN_CDE                                     41740099
417500              ,IMPRT_ORGN_TYP_CDE                                 41750099
417600              ,CNTRY_CDE                                          41760099
417700              ,STD_EDI_CDE                                        41770099
417800              ,CTY_NM                                             41780099
417900              ,STAT_CDE                                           41790099
418000              ,LAST_UPD_TMST                                      41800099
418100              ,LAST_UPD_USR_ID                                    41810099
418200              ,AUD_FUNC_CDE)                                      41820099
418500       VALUES                                                     41850099
418600            ( :TRT00011-IMPRT-ORGN-CDE                            41860099
418700             ,:TRT00011-IMPRT-ORGN-TYP-CDE                        41870099
418800             ,:TRT00011-CNTRY-CDE                                 41880099
418900             ,:TRT00011-STD-EDI-CDE                               41890099
419000             ,:TRT00011-CTY-NM                                    41900099
419100             ,:TRT00011-STAT-CDE                                  41910099
419200             ,CURRENT TIMESTAMP                                   41920099
419300             ,:TRT00011-LAST-UPD-USR-ID                           41930099
419400             ,:TRT00011-AUD-FUNC-CDE)                             41940099
419700     END-EXEC.                                                    41970099
419800                                                                  41980099
419900     EVALUATE TRUE                                                41990099
420000         WHEN SQLCODE = ZERO                                      42000099
420100             CONTINUE                                             42010099
420200         WHEN SQLWARN0 NOT = SPACES                               42020099
420300         WHEN SQLCODE < ZERO                                      42030099
420400         WHEN SQLCODE > ZERO                                      42040099
420500             MOVE '6200-UPDATE-AUDCIT-ORG-CODE'                   42050099
420600                               TO DP013-PARAGRAPH                 42060099
420700             MOVE 'UPDATE A ROW ON THE ORG CODE TABLE'            42070099
420800                               TO DP013-MESSAGE-TEXT(1)           42080099
420900             MOVE SQLCA        TO DP013-SQLCA                     42090099
421000             MOVE 'TAUORG'     TO DP013-DB2-TABLE-NAME (1)        42100099
421100             SET DP013-DB2-ABEND                                  42110099
421200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               42120099
421300             PERFORM DP013-0000-PROCESS-ABEND                     42130099
421400     END-EVALUATE.                                                42140099
421500                                                                  42150099
421600 7000-DEL-ORG-CODE.                                               42160099
421700                                                                  42170099
421800     MOVE PC-I        TO DK-STAT-CDE.                             42180099
422000     MOVE PC-D        TO DK-FUNC-CDE.                             42200099
422100                                                                  42210099
422200     PERFORM 6200-UPDATE-AUDIT-ORG-CODE.                          42220099
422300     PERFORM 7100-INACTIVATE-ORG.                                 42230099
422400                                                                  42240099
422500     MOVE PC-TSYMSG-00115    TO DP020-MSG-NUMBER.                 42250099
422600     SET DP020-MSG-INFORMATIONAL                                  42260099
422700         ASC-DEL-COMPLETE    TO TRUE.                             42270099
422800                                                                  42280099
423300*----------------------------------------------------------------*42330099
423400* DELETE A ROW IN THE TRT_IMPRT_ORGN TABLE.                      *42340099
423500*----------------------------------------------------------------*42350099
423600 7100-INACTIVATE-ORG.                                             42360099
423700                                                                  42370099
423800     MOVE TR157-IMPRT-ORGN-TYP-CDE TO DK-IMPRT-ORGN-TYP-CDE       42380099
423800     MOVE TR157-IMPRT-ORGN-CDE     TO DK-IMPRT-ORGN-CDE           42380099
423900     MOVE DP020-USERID             TO TRT00010-LAST-UPD-USR-ID    42390099
424000                                                                  42400099
424100     EXEC SQL                                                     42410099
424200       UPDATE TRT_IMPRT_ORGN                                      42420099
424300         SET  STAT_CDE           = :PC-I                          42430099
424400             ,LAST_UPD_TMST      = CURRENT TIMESTAMP              42440099
424500             ,LAST_UPD_USR_ID    = :TRT00010-LAST-UPD-USR-ID      42450099
424600       WHERE  IMPRT_ORGN_CDE     = :DK-IMPRT-ORGN-CDE             42460099
               AND  IMPRT_ORGN_TYP_CDE = :DK-IMPRT-ORGN-TYP-CDE                 
424700     END-EXEC.                                                    42470099
424800                                                                  42480099
424900     EVALUATE TRUE                                                42490099
425000         WHEN SQLCODE = ZERO                                      42500099
425100             CONTINUE                                             42510099
425200         WHEN SQLWARN0 NOT = SPACES                               42520099
425300         WHEN SQLCODE < ZERO                                      42530099
425400         WHEN SQLCODE > ZERO                                      42540099
425500             MOVE '7100-INACTIVATE-ORG'                           42550099
425600                               TO DP013-PARAGRAPH                 42560099
425700             MOVE 'UPDATE A ROW INTO THE ORG CODE TABLE'          42570099
425800                               TO DP013-MESSAGE-TEXT(1)           42580099
425900             MOVE SQLCA        TO DP013-SQLCA                     42590099
426000             MOVE 'TRT_IMPRT_ORGN' TO DP013-DB2-TABLE-NAME (1)    42600099
426100             SET DP013-DB2-ABEND                                  42610099
426200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               42620099
426300             PERFORM DP013-0000-PROCESS-ABEND                     42630099
426400     END-EVALUATE.                                                42640099
426500 EJECT                                                            42650099
422800                                                                  42280099
423300*----------------------------------------------------------------*42330099
423400* DELETE A ROW IN THE TRT_IMPRT_ORGN TABLE.                      *42340099
423500*----------------------------------------------------------------*42350099
423600 7200-ACTIVATE-ORG.                                               42360099
423700                                                                  42370099
423800     MOVE TRT00010-IMPRT-ORGN-TYP-CDE TO DK-IMPRT-ORGN-TYP-CDE    42380099
423800     MOVE TRT00010-IMPRT-ORGN-CDE     TO DK-IMPRT-ORGN-CDE        42380099
423900     MOVE DP020-USERID                TO TRT00010-LAST-UPD-USR-ID 42390099
424000                                                                  42400099
424100     EXEC SQL                                                     42410099
424200       UPDATE TRT_IMPRT_ORGN                                      42420099
424300         SET  STAT_CDE           = :PC-A                          42430099
424400             ,LAST_UPD_TMST      = CURRENT TIMESTAMP              42440099
424500             ,LAST_UPD_USR_ID    = :TRT00010-LAST-UPD-USR-ID      42450099
424600       WHERE  IMPRT_ORGN_CDE     = :DK-IMPRT-ORGN-CDE             42460099
               AND  IMPRT_ORGN_TYP_CDE = :DK-IMPRT-ORGN-TYP-CDE                 
424700     END-EXEC.                                                    42470099
424800                                                                  42480099
424900     EVALUATE TRUE                                                42490099
425000         WHEN SQLCODE = ZERO                                      42500099
425100             CONTINUE                                             42510099
425200         WHEN SQLWARN0 NOT = SPACES                               42520099
425300         WHEN SQLCODE < ZERO                                      42530099
425400         WHEN SQLCODE > ZERO                                      42540099
425500             MOVE '7200-ACTIVATE-ORG'                             42550099
425600                                    TO DP013-PARAGRAPH            42560099
425700             MOVE 'UPDATE A ROW INTO THE ORG CODE TABLE'          42570099
425800                                    TO DP013-MESSAGE-TEXT(1)      42580099
425900             MOVE SQLCA             TO DP013-SQLCA                42590099
426000             MOVE 'TRT_IMPRT_ORGN'  TO DP013-DB2-TABLE-NAME (1)   42600099
426100             SET DP013-DB2-ABEND                                  42610099
426200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               42620099
426300             PERFORM DP013-0000-PROCESS-ABEND                     42630099
426400     END-EVALUATE.                                                42640099
426500 EJECT                                                            42650099
432500                                                                  43250099
432600*----------------------------------------------------------------*43260099
432700*    ABEND PROCESSOR MODULE                                      *43270099
432800*----------------------------------------------------------------*43280099
432900                                                                  43290099
433000     COPY DPPD013.                                                43300099
433100                                                                  43310099
433200*----------------------------------------------------------------*43320099
433300*    LINK TO CICS OBJECT LOCKING MODULE                          *43330099
433400*----------------------------------------------------------------*43340099
433500                                                                  43350099
433600     COPY DPPD044.                                                43360099
