000100***************************************************************** 00010036
000200 IDENTIFICATION DIVISION.                                         00020036
000300***************************************************************** 00030036
000400                                                                  00040036
000500 PROGRAM-ID.             SUKRP016.                                00050036
000600 AUTHOR.                 STEPHANIE HERON.                         00060036
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070036
000800 DATE-WRITTEN            OCTOBER 1997.                            00080036
000900 DATE-COMPILED.                                                   00090036
001000***************************************************************** 00100036
001100***************************************************************** 00110036
001200*  THIS PROGRAM WILL CREATE THE SUMMARY OF CARTONS IN AN        * 00120036
001300*  OPENED STATUS FOR AN AUDIT CONTROL NUMBER.                   * 00130036
001600*                                                               * 00130142
001600*  CHANGED 10/13/14 BY CHERI PARMLEY                            * 00130243
001700*   EXPANDED PO# FROM 7 TO 8 DIGITS     CHG#0094517             * 00130342
001400***************************************************************** 00140036
001500 ENVIRONMENT DIVISION.                                            00150036
001600                                                                  00160036
001700 CONFIGURATION SECTION.                                           00170036
001800                                                                  00180036
001900 SOURCE-COMPUTER.        IBM-3090.                                00190036
002000 OBJECT-COMPUTER.        IBM-3090.                                00200036
002100                                                                  00210036
002200 INPUT-OUTPUT SECTION.                                            00220036
002300                                                                  00230036
002400 FILE-CONTROL.                                                    00240036
002500*                                                                 00250036
002600     SELECT PRINT-CONTROL-FILE                                    00260036
002700         ASSIGN TO PRTIN.                                         00270036
002800                                                                  00280036
002900     SELECT PRINT-FILE                                            00290036
003000         ASSIGN TO RPT01.                                         00300036
003100                                                                  00310036
003200*                                                                 00320036
003300*                                                                 00330036
003400***************************************************************** 00340036
003500 DATA DIVISION.                                                   00350036
003600***************************************************************** 00360036
003700*                                                                 00370036
003800 FILE SECTION.                                                    00380036
003900*                                                                 00390036
004000 FD  PRINT-CONTROL-FILE                                           00400036
004100     RECORDING MODE IS F                                          00410036
004200     BLOCK CONTAINS 0  RECORDS.                                   00420036
004300 01  PRINT-CONTROL-CARD              PIC  X(080).                 00430036
004400*                                                                 00440036
004500 FD  PRINT-FILE                                                   00450036
004600     RECORDING MODE IS F                                          00460036
004700     BLOCK CONTAINS 0  RECORDS.                                   00470036
004800 01  PRINT-RECORD                    PIC  X(132).                 00480036
004900*                                                                 00490036
005000 WORKING-STORAGE SECTION.                                         00500036
005100*                                                                 00510036
005200 01  PROGRAM-SWITCHES.                                            00520036
005300     05  PS-END-OF-CARDIN-FILE-SW    PIC  X(01)    VALUE 'N'.     00530036
005400         88  PS-END-OF-CARDIN-FILE                 VALUE 'Y'.     00540036
005500         88  PS-NOT-END-OF-CARDIN-FILE             VALUE 'N'.     00550036
005600     05  PS-END-OF-CARTON-CURSOR-SW  PIC  X(01)    VALUE 'N'.     00560036
005700         88  PS-END-OF-CARTON-CURSOR               VALUE 'Y'.     00570036
005800         88  PS-NOT-END-OF-CARTON-CURSOR           VALUE 'N'.     00580036
005900     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00590036
006000         88  PS-FIRST-TIME                         VALUE 'Y'.     00600036
006100         88  PS-NOT-FIRST-TIME                     VALUE 'N'.     00610036
006200     05  PS-ERROR-FOUND-SW           PIC  X(01)    VALUE 'N'.     00620036
006300         88  PS-ERROR-FOUND                        VALUE 'Y'.     00630036
006400         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     00640036
006500     05  PS-RECEIVER-ERROR-SW        PIC  X(01)    VALUE 'N'.     00650036
006600         88  PS-RECEIVER-ERROR                     VALUE 'Y'.     00660036
006700         88  PS-NO-RECEIVER-ERROR                  VALUE 'N'.     00670036
006800*                                                                 00680036
006900 01  PC-CONSTANTS.                                                00690036
007000     05  PC-1                        PIC S9(03)    VALUE +1       00700036
007100                                                   COMP-3.        00710036
007200     05  PC-2                        PIC S9(03)    VALUE +2       00720036
007300                                                   COMP-3.        00730036
007400     05  PC-3                        PIC S9(03)    VALUE +3       00740036
007500                                                   COMP-3.        00750036
007600     05  PC-7                        PIC S9(01)    VALUE +7.      00760036
007700     05  PC-14                       PIC S9(03)    VALUE +14      00770036
007800                                                   COMP-3.        00780036
007900     05  PC-60                       PIC S9(03)    VALUE +60      00790036
008000                                                   COMP-3.        00800036
008100     05  PC-DASH                     PIC  X(01)    VALUE '-'.     00810036
008200     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00820036
008210     05  PC-E                        PIC  X(01)    VALUE 'E'.     00821037
008300     05  PC-00                       PIC  X(02)    VALUE '00'.    00830036
008400     05  PC-LONG-NAME                PIC  X(02)    VALUE '01'.    00840036
008500     05  PC-ACTIVE-STATUS            PIC  X(01)    VALUE 'A'.     00850036
008600     05  PC-100-PCT-CHECK            PIC  X(10)    VALUE          00860036
008700         '100% CHECK'.                                            00870036
008800     05  PC-SPOT-CHECK               PIC  X(10)    VALUE          00880036
008900         'SPOT CHECK'.                                            00890036
009000     05  PC-REWORK                   PIC  X(10)    VALUE          00900036
009100         'REWORK    '.                                            00910036
009200     05  PC-UNKNOWN                  PIC  X(10)    VALUE          00920036
009300         'UNKNOWN   '.                                            00930036
009400     05  PC-IN-PROCESS               PIC  X(10)    VALUE          00940036
009500         'IN PROCESS'.                                            00950036
009600     05  PC-COMPLETE                 PIC  X(10)    VALUE          00960036
009700         'COMPLETE  '.                                            00970036
009800     05  PC-POSTPONED                PIC  X(10)    VALUE          00980036
009900         'POSTPONED '.                                            00990036
010000     05  PC-DEFAULT-TMST             PIC  X(26)    VALUE          01000036
010100         '9999-09-09-09.09.09.999999'.                            01010036
010200     05  PC-SUKRP016                 PIC  X(08)    VALUE          01020036
010300         'SUKRP016'.                                              01030036
010400     05  PC-BLANK-LINE               PIC  X(132)   VALUE SPACES.  01040036
010500     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01050036
010600*                                                                 01060036
010700 01  PV-MISC-FIELDS.                                              01070036
010800     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01080036
010900                                                   COMP-3.        01090036
011000     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01100036
011100                                                   COMP-3.        01110036
011200     05  PV-LINE-TOTAL               PIC S9(04)    VALUE ZERO     01120036
011300                                                   COMP SYNC.     01130036
011400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01140036
011500                                                   COMP SYNC.     01150036
011600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01160036
011700     05  PV-AUD-CNTL-NBR             PIC  9(09)    VALUE ZERO.    01170036
011800     05  PV-OPER-UNT-ID              PIC  9(03)    VALUE ZERO.    01180036
011900     05  PV-UNITS-SCAN               PIC S9(07)    VALUE ZERO     01190036
012000                                                   COMP-3.        01200036
012100     05  PV-OPEN-COUNT               PIC S9(09)    VALUE ZERO     01210036
012200                                                   COMP-3.        01220036
012300     05  PV-POST-COUNT               PIC S9(09)    VALUE ZERO     01230036
012400                                                   COMP-3.        01240036
012500     05  PV-CLOSE-COUNT              PIC S9(09)    VALUE ZERO     01250036
012600                                                   COMP-3.        01260036
012700     05  PV-HOLD-TRN-NBR             PIC S9(09)    VALUE ZERO     01270036
012800                                                   COMP.          01280036
012900     05  PV-HOLD-REC-SEQ-NBR         PIC S9(09)    VALUE ZERO     01290036
013000                                                   COMP.          01300036
013100     05  PV-PO-RECEIVER.                                          01310036
      *CLP 10/13/14 START                                               01311040
013200         10  PV-PO                   PIC  ZZZZZZZ9 VALUE ZERO.    01320040
013300         10  FILLER                  PIC  X(01)    VALUE '-'.     01330036
013400         10  PV-RECEIVER             PIC  9(04)    VALUE ZERO.    01340036
013500     05  PV-CURR-PO-RECEIVER.                                     01350036
013600         10  PV-CURR-PO-NBR          PIC  ZZZZZZZ9 VALUE ZERO.    01360040
013700         10  PV-CURR-REC-SEQ-NBR     PIC  9(04)    VALUE ZERO.    01370036
013800     05  PV-PREV-PO-RECEIVER.                                     01380036
013900         10  PV-PREV-PO-NBR          PIC  ZZZZZZZ9 VALUE ZERO.    01390040
014000         10  PV-PREV-REC-SEQ-NBR     PIC  9(04)    VALUE ZERO.    01400036
014100     05  PV-KEY-PO-RECEIVER.                                      01410036
014200         10  PV-KEY-PO-NBR           PIC  ZZZZZZ9  VALUE ZERO.    01420036
014300         10  PV-KEY-REC-SEQ-NBR      PIC  9(04)    VALUE ZERO.    01430036
      *CLP 10/13/14 END                                                 01431040
014400     05  PV-TODAYS-DATE.                                          01440036
014500         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01450036
014600         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01460036
014700         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01470036
014800     05  PV-TODAYS-TIME.                                          01480036
014900         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01490036
015000         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01500036
015100         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01510036
015200         10  FILLER                  PIC  9(02)    VALUE ZERO.    01520036
015300     05  PV-DB2-DATE.                                             01530036
015400         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    01540036
015500         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    01550036
015600         10  FILLER                  PIC  X(01)    VALUE ZERO.    01560036
015700         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    01570036
015800         10  FILLER                  PIC  X(01)    VALUE ZERO.    01580036
015900         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    01590036
016000     05  PV-DB2-TMST.                                             01600036
016100         10 PV-DB2-TMST-CCYY          PIC  9(04).                 01610036
016200         10 FILLER                    PIC  X(01).                 01620036
016300         10 PV-DB2-TMST-MM            PIC  9(02).                 01630036
016400         10 FILLER                    PIC  X(01).                 01640036
016500         10 PV-DB2-TMST-DD            PIC  9(02).                 01650036
016600         10 FILLER                    PIC  X(01).                 01660036
016700         10 PV-DB2-TMST-HH            PIC  9(02).                 01670036
016800         10 FILLER                    PIC  X(01).                 01680036
016900         10 PV-DB2-TMST-MN            PIC  9(02).                 01690036
017000         10 FILLER                    PIC  X(01).                 01700036
017100         10 PV-DB2-TMST-SS            PIC  9(02).                 01710036
017200         10 FILLER                    PIC  X(07).                 01720036
017300     05  PV-FORMAT-DATE.                                          01730036
017400         10 PV-FORMAT-DATE-MM         PIC  9(02).                 01740036
017500         10 FILLER                    PIC  X(01) VALUE '/'.       01750036
017600         10 PV-FORMAT-DATE-DD         PIC  9(02).                 01760036
017700         10 FILLER                    PIC  X(01) VALUE '/'.       01770036
017800         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 01780036
017900     05  PV-FORMAT-TIME.                                          01790036
018000         10 PV-FORMAT-TIME-HH         PIC  9(02).                 01800036
018100         10 FILLER                    PIC  X(01) VALUE ':'.       01810036
018200         10 PV-FORMAT-TIME-MN         PIC  9(02).                 01820036
018300     05  PV-SERIAL-SHIP-CODE          PIC  9(18).                 01830036
018400     05  FILLER REDEFINES PV-SERIAL-SHIP-CODE.                    01840036
018500         10  PV-SERIAL-SHIP-CODE-1    PIC  X(01).                 01850036
018600         10  PV-SERIAL-SHIP-CODE-2-8  PIC  X(07).                 01860036
018700         10  PV-SERIAL-SHIP-CODE-9-17 PIC  X(09).                 01870036
018800         10  PV-SERIAL-SHIP-CODE-18   PIC  X(01).                 01880036
018900     05  PV-OUT-SERIAL-SHIP-CODE.                                 01890036
019000         10  FILLER                   PIC  X(05)    VALUE '(00) '.01900036
019100         10  PV-OUT-S-S-C-1           PIC  X(01).                 01910036
019200         10  FILLER                   PIC  X(01) VALUE SPACES.    01920036
019300         10  PV-OUT-S-S-C-2-8         PIC  X(07).                 01930036
019400         10  FILLER                   PIC  X(01) VALUE SPACES.    01940036
019500         10  PV-OUT-S-S-C-9-17        PIC  X(09).                 01950036
019600         10  FILLER                   PIC  X(01) VALUE SPACES.    01960036
019700         10  PV-OUT-S-S-C-18          PIC  X(01).                 01970036
019800******************************************************************01980036
019900* COPY BOOK WITH PRINTEK/CODE V PRINTER CODES                     01990036
020000******************************************************************02000036
020100     COPY DSWS004.                                                02010036
020200                                                                  02020036
020300******************************************************************02030036
020400*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02040036
020500******************************************************************02050036
020600     COPY DPWS132O.                                               02060036
020700*                                                                 02070036
020800*                                                                 02080036
020900 01  HEADING-LINES.                                               02090036
021000     05  HEADING-LINE-0.                                          02100036
021100         10  FILLER                  PIC  X(52)    VALUE SPACES.  02110036
021200         10  FILLER                  PIC  X(28)    VALUE          02120036
021300             'VENDOR ACCURACY CARTON AUDIT'.                      02130036
021400         10  FILLER                  PIC  X(52)    VALUE SPACES.  02140036
021500*                                                                 02150036
021600     05  HEADING-LINE-1.                                          02160036
021700         10  FILLER                  PIC  X(40)    VALUE SPACES.  02170036
021800         10  FILLER                  PIC  X(28)    VALUE          02180036
021900             'SUMMARY OF CARTONS IN AN OPE'.                      02190036
022000         10  FILLER                  PIC  X(23)    VALUE          02200036
022100             'NED STATUS FOR AN AUDIT'.                           02210036
022200         10  FILLER                  PIC  X(41)    VALUE SPACES.  02220036
022300*                                                                 02230036
022400     05  HEADING-LINE-2.                                          02240036
022500         10  FILLER                  PIC  X(03)    VALUE SPACE.   02250036
022600         10  FILLER                  PIC  X(23)    VALUE          02260036
022700             'AUDIT CONTROL NUMBER:  '.                           02270036
022800         10  HL2-AUD-CNTL-NBR        PIC  X(10)    VALUE SPACES.  02280036
022900         10  FILLER                  PIC  X(08)    VALUE SPACE.   02290036
023000         10  FILLER                  PIC  X(13)    VALUE          02300036
023100             'AUDIT TYPE:  '.                                     02310036
023200         10  HL2-AUDIT-TYPE          PIC  X(10)    VALUE SPACES.  02320036
023300         10  FILLER                  PIC  X(18)    VALUE SPACE.   02330036
023400         10  FILLER                  PIC  X(21)    VALUE          02340036
023500             'AUDIT STATUS:        '.                             02350036
023600         10  HL2-AUDIT-STATUS        PIC  X(10)    VALUE SPACES.  02360036
023700         10  FILLER                  PIC  X(11)    VALUE SPACES.  02370036
023800*                                                                 02380036
023900     05  HEADING-LINE-3.                                          02390036
024000         10  FILLER                  PIC  X(03)    VALUE SPACES.  02400036
024100         10  FILLER                  PIC  X(20)    VALUE          02410036
024200             'NBR OF CART OPENED: '.                              02420036
024300         10  FILLER                  PIC  X(05)    VALUE SPACES.  02430036
024400         10  HL3-NBR-OPN-CTN         PIC ZZZZZZ9.                 02440036
024500         10  FILLER                  PIC  X(09)    VALUE SPACES.  02450036
024600         10  FILLER                  PIC  X(23)    VALUE          02460036
024700             'NBR OF CART POSTPONED: '.                           02470036
024800         10  FILLER                  PIC  X(02)    VALUE SPACES.  02480036
024900         10  HL3-NBR-PP-CTN          PIC ZZZZZZ9.                 02490036
025000         10  FILLER                  PIC  X(09)    VALUE SPACES.  02500036
025100         10  FILLER                  PIC  X(20)    VALUE          02510036
025200             'NBR OF CART CLOSED: '.                              02520036
025300         10  HL3-NBR-CLD-CTN         PIC ZZZZZZ9.                 02530036
025400*                                                                 02540036
025500     05  HEADING-LINE-4.                                          02550036
025600         10  FILLER                  PIC  X(03)    VALUE SPACES.  02560036
025700         10  FILLER                  PIC  X(13)    VALUE          02570036
025800             'PO/RECEIVER: '.                                     02580036
025900         10  HL4-PO-RECEIVER-PRINT.                               02590036
      *CLP 10/13/14                                                     02591040
026000             15  HL4-PO-NBR          PIC  ZZZZZZZ9 VALUE ZEROES.  02600040
026100             15  FILLER              PIC  X(03)    VALUE ' - '.   02610036
026200             15  HL4-REC-SEQ-NBR     PIC  9999     VALUE ZEROES.  02620036
026300*                                                                 02630036
026400     05  HEADING-LINE-5.                                          02640036
026500         10  FILLER                  PIC  X(34)    VALUE SPACES.  02650036
026600         10  FILLER                  PIC  X(03)    VALUE          02660036
026700             'STR'.                                               02670036
026800         10  FILLER                  PIC  X(56)    VALUE SPACES.  02680036
026900         10  FILLER                  PIC  X(09)    VALUE          02690036
027000             'LAST SCAN'.                                         02700036
027100         10  FILLER                  PIC  X(23)    VALUE SPACES.  02710036
027200         10  FILLER                  PIC  X(07)    VALUE          02720036
027300             'UNITS'.                                             02730036
027400                                                                  02740036
027500     05  HEADING-LINE-6.                                          02750036
027600         10  FILLER                  PIC  X(06)    VALUE SPACES.  02760036
027700         10  FILLER                  PIC  X(16)    VALUE          02770036
027800             'SERIAL SHIP CODE'.                                  02780036
027900         10  FILLER                  PIC  X(12)    VALUE SPACES.  02790036
028000         10  FILLER                  PIC  X(03)    VALUE          02800036
028100             'NBR'.                                               02810036
028200         10  FILLER                  PIC  X(04)    VALUE SPACES.  02820036
028300         10  FILLER                  PIC  X(06)    VALUE          02830036
028400             'STATUS'.                                            02840036
028500         10  FILLER                  PIC  X(07)    VALUE SPACES.  02850036
028600         10  FILLER                  PIC  X(13)    VALUE          02860036
028700             'CARTON START'.                                      02870036
028800         10  FILLER                  PIC  X(06)    VALUE SPACES.  02880036
028900         10  FILLER                  PIC  X(12)    VALUE          02890036
029000             'CARTON STOP'.                                       02900036
029100         10  FILLER                  PIC  X(08)    VALUE SPACES.  02910036
029200         10  FILLER                  PIC  X(09)    VALUE          02920036
029300             'ASSOCIATE'.                                         02930036
029400         10  FILLER                  PIC  X(03)    VALUE SPACES.  02940036
029500         10  FILLER                  PIC  X(09)    VALUE          02950036
029600             'LAST SCAN'.                                         02960036
029700         10  FILLER                  PIC  X(10)    VALUE SPACES.  02970036
029800         10  FILLER                  PIC  X(07)    VALUE          02980036
029900             'SCANNED'.                                           02990036
030000         10  FILLER                  PIC  X(33)    VALUE SPACES.  03000036
030100*                                                                 03010036
030200*                                                                 03020036
030300*                                                                 03030036
030400 01  MISCELLANEOUS-LINES.                                         03040036
030500     05  END-OF-REPORT-LINE.                                      03050036
030600         10  FILLER                  PIC  X(44)    VALUE SPACES.  03060036
030700         10  FILLER                  PIC  X(45)    VALUE          03070036
030800             '*******   E N D   O F   R E P O R T   *******'.     03080036
030900         10  FILLER                  PIC  X(43)    VALUE SPACES.  03090036
031000*                                                                 03100036
031100 01  DETAIL-LINES.                                                03110036
031200     05  DETAIL-LINE1.                                            03120036
031300         10  FILLER                  PIC  X(06)    VALUE SPACES.  03130036
031400         10  DL1-SERIAL-SHIP-CODE    PIC  X(26)    VALUE SPACES.  03140036
031500         10  FILLER                  PIC  X(01)    VALUE SPACES.  03150036
031600         10  DL1-STR-NBR             PIC  ZZZ9     VALUE ZEROES.  03160036
031700         10  FILLER                  PIC  X(04)    VALUE SPACES.  03170036
031800         10  DL1-STATUS              PIC  X(10)    VALUE SPACES.  03180036
031900         10  FILLER                  PIC  X(03)    VALUE SPACES.  03190036
032000         10  DL1-CTN-STRT-DATE.                                   03200036
032100             15  DL1-CTN-STRT-MM     PIC  X(02)    VALUE ZEROES.  03210036
032200             15  FILLER              PIC  X(01)    VALUE '/'.     03220036
032300             15  DL1-CTN-STRT-DD     PIC  X(02)    VALUE ZEROES.  03230036
032400             15  FILLER              PIC  X(01)    VALUE '/'.     03240036
032500             15  DL1-CTN-STRT-CCYY   PIC  X(04)    VALUE ZEROES.  03250036
032600             15  FILLER              PIC  X(02)    VALUE SPACES.  03260036
032700         10  DL1-CTN-STRT-TIME.                                   03270036
032800             15  DL1-CTN-STRT-HH     PIC  X(02)    VALUE SPACES.  03280036
032900             15  FILLER              PIC  X(01)    VALUE ':'.     03290036
033000             15  DL1-CTN-STRT-MN     PIC  X(02)    VALUE SPACES.  03300036
033100             15  FILLER              PIC  X(02)    VALUE SPACES.  03310036
033200         10  DL1-CTN-STP-DATE.                                    03320036
033300             15  DL1-CTN-STP-MM      PIC  X(02)    VALUE ZEROES.  03330036
033400             15  DL1-STP-DASH1       PIC  X(01)    VALUE SPACES.  03340036
033500             15  DL1-CTN-STP-DD      PIC  X(02)    VALUE ZEROES.  03350036
033600             15  DL1-STP-DASH2       PIC  X(01)    VALUE SPACES.  03360036
033700             15  DL1-CTN-STP-CCYY    PIC  X(04)    VALUE ZEROES.  03370036
033800             15  FILLER              PIC  X(02)    VALUE SPACES.  03380036
033900         10  DL1-CTN-STP-TIME.                                    03390036
034000             15  DL1-CTN-STP-HH      PIC  X(02)    VALUE SPACES.  03400036
034100             15  DL1-STP-COLON       PIC  X(01)    VALUE SPACES.  03410036
034200             15  DL1-CTN-STP-MN      PIC  X(02)    VALUE SPACES.  03420036
034300         10  FILLER                  PIC  X(03)    VALUE SPACES.  03430036
034400         10  DL1-USR-ID              PIC  X(08)    VALUE SPACES.  03440036
034500         10  FILLER                  PIC  X(04)    VALUE SPACES.  03450036
034600         10  DL1-LST-SCN-DATE.                                    03460036
034700             15  DL1-LST-SCN-MM      PIC  X(02)    VALUE ZEROES.  03470036
034800             15  FILLER              PIC  X(01)    VALUE '/'.     03480036
034900             15  DL1-LST-SCN-DD      PIC  X(02)    VALUE ZEROES.  03490036
035000             15  FILLER              PIC  X(01)    VALUE '/'.     03500036
035100             15  DL1-LST-SCN-CCYY    PIC  X(04)    VALUE ZEROES.  03510036
035200             15  FILLER              PIC  X(02)    VALUE SPACES.  03520036
035300         10  DL1-LST-SCN-TIME.                                    03530036
035400             15  DL1-LST-SCN-HH      PIC  X(02)    VALUE SPACES.  03540036
035500             15  FILLER              PIC  X(01)    VALUE ':'.     03550036
035600             15  DL1-LST-SCN-MN      PIC  X(02)    VALUE SPACES.  03560036
035700         10  FILLER                  PIC  X(02)    VALUE SPACES.  03570036
035800         10  DL1-UNT-SCN             PIC  ZZZZZZ9  VALUE ZEROES.  03580036
035900         10  FILLER                  PIC  X(02)    VALUE SPACES.  03590036
036000                                                                  03600036
036100 01  CC-CONTROL-CARD.                                             03610036
036200     05  CC-AUD-CNTL-NBR              PIC  S9(9).                 03620036
036300                                                                  03630036
036400 01  CC-PRINTER-CARD.                                             03640036
036500     05  CC-PRINTER-ID                PIC  X(08).                 03650036
036600     05  CC-PRTR-CNTL-IND             PIC  X(01).                 03660036
036700     05  CC-TRACK-NBR                 PIC  9(01).                 03670036
036800*DMB 9/18/01                                                      03680036
036900     05  CC-BRCDE-IND                 PIC  X(01)  VALUE SPACE.    03690036
037000     05  CC-PRTR-CUT-IND              PIC  X(01)  VALUE SPACE.    03700036
037100                                                                  03710036
037200*                                                                 03720036
037300*  COPY BOOK FOR THE SHIPPING UNIT AUDIT TABLE (TSUNAUD)          03730036
037400*                                                                 03740036
037500     EXEC SQL                                                     03750036
037600          INCLUDE TSUNAUD                                         03760036
037700     END-EXEC.                                                    03770036
037800*                                                                 03780036
037900*  COPY BOOK FOR SHIPPING UNIT AUDIT TRANSACTIONS TABLE           03790036
038000*  (TSUATRN)                                                      03800036
038100*                                                                 03810036
038200     EXEC SQL                                                     03820036
038300          INCLUDE TSUATRN                                         03830036
038400     END-EXEC.                                                    03840036
038500*                                                                 03850036
038600*  COPY BOOK FOR SHIPPING UNIT CONTENT AUDIT                      03860036
038700*                                                                 03870036
038800     EXEC SQL                                                     03880036
038900          INCLUDE TSUAUPC                                         03890036
039000     END-EXEC.                                                    03900036
039100*  DB2 COMMUNICATION AREA                                         03910036
039200*                                                                 03920036
039300     EXEC SQL                                                     03930036
039400         INCLUDE SQLCA                                            03940036
039500     END-EXEC.                                                    03950036
039600 EJECT                                                            03960036
039700*  DB2 COMMUNICATION AREA2                                        03970036
039800*                                                                 03980036
039900     COPY SQLCA2.                                                 03990036
040000                                                                  04000036
040100 EJECT                                                            04010036
040200                                                                  04020036
040300     EXEC SQL                                                     04030036
040400          DECLARE CTN-CSR CURSOR FOR                              04040036
040500            SELECT SHIPT_UNT_ID                                   04050036
040600                  ,DEST_OPER_UNT_ID                               04060036
040700                  ,TRN_NBR                                        04070036
040800                  ,REC_SEQ_NBR                                    04080036
040900                  ,UNT_AUD_STAT_CDE                               04090036
041000                  ,UNT_AUD_STRT_TMST                              04100036
041100                  ,UNT_AUD_STP_TMST                               04110036
041200             FROM  TSUATRN                                        04120036
041300             WHERE AUD_CNTL_NBR = :SUNAUD-AUD-CNTL-NBR            04130036
041400             AND   UNT_AUD_STAT_CDE NOT IN ('CM')                 04140036
041500             ORDER BY  TRN_NBR                                    04150036
041600                      ,REC_SEQ_NBR                                04160036
041700                      ,SHIPT_UNT_ID                               04170036
041800     END-EXEC.                                                    04180036
041900                                                                  04190036
042000 PROCEDURE DIVISION.                                              04200036
042100*                                                                 04210036
042200 0000-MAINLINE-PROCESSING.                                        04220036
042300******************************************************************04230036
042400**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      04240036
042500******************************************************************04250036
042600     OPEN INPUT PRINT-CONTROL-FILE.                               04260036
042700     OPEN OUTPUT PRINT-FILE.                                      04270036
042800*                                                                 04280036
042900     PERFORM 1000-INITIALIZATION.                                 04290036
043000*                                                                 04300036
043100     PERFORM 2000-PROCESS-SU                                      04310036
043200         UNTIL PS-END-OF-CARTON-CURSOR.                           04320036
043300*                                                                 04330036
043400     WRITE PRINT-RECORD                                           04340036
043500       FROM END-OF-REPORT-LINE                                    04350036
043600         AFTER ADVANCING 2 LINES.                                 04360036
043700*                                                                 04370036
043800*DMB 9/18/01        IF CC-PRTR-CNTL-IND = 'P'                     04380036
043900      IF CC-PRTR-CUT-IND = 'Y'                                    04390036
044000          WRITE PRINT-RECORD                                      04400036
044100              FROM DS004-PLC-CUT-FORM                             04410036
044200          AFTER ADVANCING 1 LINE                                  04420036
044300      END-IF.                                                     04430036
044400                                                                  04440036
044500     CLOSE PRINT-FILE PRINT-CONTROL-FILE.                         04450036
044600*                                                                 04460036
044700     GOBACK.                                                      04470036
044800*                                                                 04480036
044900*                                                                 04490036
045000 1000-INITIALIZATION.                                             04500036
045100******************************************************************04510036
045200**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04520036
045300******************************************************************04530036
045400     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           04540036
045500     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   04550036
045600                                                                  04560036
045700     READ PRINT-CONTROL-FILE INTO CC-PRINTER-CARD.                04570036
045800     DISPLAY 'PRINT CARD = ' CC-PRINTER-CARD.                     04580036
045900                                                                  04590036
046000     ACCEPT PV-TODAYS-DATE                                        04600036
046100       FROM DATE.                                                 04610036
046200*                                                                 04620036
046300     ACCEPT PV-TODAYS-TIME                                        04630036
046400       FROM TIME.                                                 04640036
046500*                                                                 04650036
046600     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             04660036
046700     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                 04670036
046800     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                   04680036
046900     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                  04690036
047000*                                                                 04700036
047100     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  04710036
047200     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                04720036
047300     MOVE PC-SUKRP016        TO DP132O-PROGRAM-NAME.              04730036
047400                                                                  04740036
047500     PERFORM 1100-SELECT-TSUNAUD.                                 04750036
047600                                                                  04760036
047700     MOVE SUNAUD-AUD-CNTL-NBR      TO HL2-AUD-CNTL-NBR.           04770036
047800                                                                  04780036
047900     EVALUATE SUNAUD-AUD-STAT-CDE                                 04790036
048000         WHEN 'IP'                                                04800036
048100              MOVE PC-IN-PROCESS   TO HL2-AUDIT-STATUS            04810036
048200         WHEN 'CM'                                                04820036
048300              MOVE PC-COMPLETE     TO HL2-AUDIT-STATUS            04830036
048400         WHEN 'PP'                                                04840036
048500              MOVE PC-POSTPONED    TO HL2-AUDIT-STATUS            04850036
048600     END-EVALUATE.                                                04860036
048700                                                                  04870036
048800     EVALUATE SUNAUD-AUD-TYP-CDE                                  04880036
048900         WHEN '01'                                                04890036
049000             MOVE PC-100-PCT-CHECK TO HL2-AUDIT-TYPE              04900036
049100         WHEN '02'                                                04910036
049200             MOVE PC-SPOT-CHECK    TO HL2-AUDIT-TYPE              04920036
049300         WHEN '03'                                                04930036
049400             MOVE PC-REWORK        TO HL2-AUDIT-TYPE              04940036
049500         WHEN OTHER                                               04950036
049600             MOVE PC-UNKNOWN       TO HL2-AUDIT-TYPE              04960036
049700     END-EVALUATE.                                                04970036
049800                                                                  04980036
049900     PERFORM 1110-GET-OPEN-COUNT.                                 04990036
050000     PERFORM 1120-GET-POST-COUNT.                                 05000036
050100     PERFORM 1130-GET-CLOSE-COUNT.                                05010036
050200                                                                  05020036
050300     MOVE PV-OPEN-COUNT TO HL3-NBR-OPN-CTN.                       05030036
050400     MOVE PV-POST-COUNT TO HL3-NBR-PP-CTN.                        05040036
050500     MOVE PV-CLOSE-COUNT TO HL3-NBR-CLD-CTN.                      05050036
050600                                                                  05060036
050700*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  05070036
050800     IF CC-PRTR-CNTL-IND = 'P'                                    05080036
050900         MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR     05090036
051000         MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI          05100036
051100                                                                  05110036
051200         WRITE PRINT-RECORD                                       05120036
051300             FROM DS004-PLC-LOAD-FORM                             05130036
051400         AFTER ADVANCING 1 LINE                                   05140036
051500     END-IF.                                                      05150036
051600                                                                  05160036
051700     PERFORM 8000-WRITE-REPORT-HEADERS.                           05170036
051800                                                                  05180036
051900     PERFORM 2400-OPEN-CURSOR.                                    05190036
052000                                                                  05200036
052100     PERFORM 2500-FETCH-CURSOR.                                   05210036
052200*                                                                 05220036
052300 1100-SELECT-TSUNAUD.                                             05230036
052400******************************************************************05240036
052500**  SELECT INFORMATION FROM THE SHIPPING UNIT AUDIT TABLE FOR THE 05250036
052600**  HEADER PORTION OF THE REPORT.                                 05260036
052700******************************************************************05270036
052800     INITIALIZE DCLTSUNAUD.                                       05280036
052900                                                                  05290036
053000     MOVE '1100-SELECT-TSUNAUD '                                  05300036
053100                                 TO PV-ABEND-PARAGRAPH.           05310036
053200                                                                  05320036
053300     MOVE CC-AUD-CNTL-NBR        TO SUNAUD-AUD-CNTL-NBR           05330036
053400                                                                  05340036
053500     EXEC SQL                                                     05350036
053600       SELECT                                                     05360036
053700              AUD_TYP_CDE                                         05370036
053800             ,AUD_STAT_CDE                                        05380036
053900         INTO                                                     05390036
054000             :SUNAUD-AUD-TYP-CDE                                  05400036
054100            ,:SUNAUD-AUD-STAT-CDE                                 05410036
054200         FROM  TSUNAUD                                            05420036
054300        WHERE  AUD_CNTL_NBR = :SUNAUD-AUD-CNTL-NBR                05430036
054400     END-EXEC.                                                    05440036
054500                                                                  05450036
054600     EVALUATE TRUE                                                05460036
054700       WHEN SQLCODE = ZEROS                                       05470036
054800         CONTINUE                                                 05480036
054900       WHEN OTHER                                                 05490036
055000         DISPLAY 'AUDIT CONTROL NUMBER IS ' SUNAUD-AUD-CNTL-NBR   05500036
055100         DISPLAY PV-ABEND-PARAGRAPH                               05510036
055200         PERFORM Z999-SQL-ERROR                                   05520036
055300     END-EVALUATE.                                                05530036
055400                                                                  05540036
055500 1110-GET-OPEN-COUNT.                                             05550036
055600******************************************************************05560036
055700**  SELECT THE NUMBER OF CARTONS THAT ARE IN AN OPEN (INPROCESS)  05570036
055800**  STATUS.                                                       05580036
055900******************************************************************05590036
056000                                                                  05600036
056100     MOVE '1110-GET-OPEN-COUNT '                                  05610036
056200                                 TO PV-ABEND-PARAGRAPH.           05620036
056300                                                                  05630036
056400     EXEC SQL                                                     05640036
056500       SELECT COUNT(*)                                            05650036
056600         INTO                                                     05660036
056700             :PV-OPEN-COUNT                                       05670036
056800         FROM  TSUATRN                                            05680036
056900        WHERE  AUD_CNTL_NBR = :SUNAUD-AUD-CNTL-NBR                05690036
057000          AND  UNT_AUD_STAT_CDE = 'IP'                            05700036
057100     END-EXEC.                                                    05710036
057200                                                                  05720036
057300     EVALUATE TRUE                                                05730036
057400       WHEN SQLCODE = ZEROS                                       05740036
057500         CONTINUE                                                 05750036
057600       WHEN SQLCODE = +100                                        05760036
057700         MOVE ZEROES TO PV-OPEN-COUNT                             05770036
057800       WHEN OTHER                                                 05780036
057900         DISPLAY 'AUDIT CONTROL NUMBER IS ' SUNAUD-AUD-CNTL-NBR   05790036
058000         DISPLAY PV-ABEND-PARAGRAPH                               05800036
058100         PERFORM Z999-SQL-ERROR                                   05810036
058200     END-EVALUATE.                                                05820036
058300                                                                  05830036
058400*                                                                 05840036
058500 1120-GET-POST-COUNT.                                             05850036
058600******************************************************************05860036
058700**  SELECT THE NUMBER OF CARTONS THAT ARE IN A POSTPONE STATUS    05870036
058800******************************************************************05880036
058900                                                                  05890036
059000     MOVE '1120-GET-POST-COUNT '                                  05900036
059100                                 TO PV-ABEND-PARAGRAPH.           05910036
059200                                                                  05920036
059300     EXEC SQL                                                     05930036
059400       SELECT COUNT(*)                                            05940036
059500         INTO                                                     05950036
059600             :PV-POST-COUNT                                       05960036
059700         FROM  TSUATRN                                            05970036
059800        WHERE  AUD_CNTL_NBR = :SUNAUD-AUD-CNTL-NBR                05980036
059900          AND  UNT_AUD_STAT_CDE = 'PP'                            05990036
060000     END-EXEC.                                                    06000036
060100                                                                  06010036
060200     EVALUATE TRUE                                                06020036
060300       WHEN SQLCODE = ZEROS                                       06030036
060400         CONTINUE                                                 06040036
060500       WHEN SQLCODE = +100                                        06050036
060600         MOVE ZEROES TO PV-POST-COUNT                             06060036
060700       WHEN OTHER                                                 06070036
060800         DISPLAY 'AUDIT CONTROL NUMBER IS ' SUNAUD-AUD-CNTL-NBR   06080036
060900         DISPLAY PV-ABEND-PARAGRAPH                               06090036
061000         PERFORM Z999-SQL-ERROR                                   06100036
061100     END-EVALUATE.                                                06110036
061200                                                                  06120036
061300*                                                                 06130036
061400 1130-GET-CLOSE-COUNT.                                            06140036
061500******************************************************************06150036
061600**  SELECT THE NUMBER OF CARTONS THAT ARE IN A POSTPONE STATUS    06160036
061700******************************************************************06170036
061800                                                                  06180036
061900     MOVE '1130-GET-CLOSE-COUNT'                                  06190036
062000                                 TO PV-ABEND-PARAGRAPH.           06200036
062100                                                                  06210036
062200     EXEC SQL                                                     06220036
062300       SELECT COUNT(*)                                            06230036
062400         INTO                                                     06240036
062500             :PV-CLOSE-COUNT                                      06250036
062600         FROM  TSUATRN                                            06260036
062700        WHERE  AUD_CNTL_NBR = :SUNAUD-AUD-CNTL-NBR                06270036
062800          AND  UNT_AUD_STAT_CDE = 'CM'                            06280036
062900     END-EXEC.                                                    06290036
063000                                                                  06300036
063100     EVALUATE TRUE                                                06310036
063200       WHEN SQLCODE = ZEROS                                       06320036
063300         CONTINUE                                                 06330036
063400       WHEN SQLCODE = +100                                        06340036
063500         MOVE ZEROES TO PV-CLOSE-COUNT                            06350036
063600       WHEN OTHER                                                 06360036
063700         DISPLAY 'AUDIT CONTROL NUMBER IS ' SUNAUD-AUD-CNTL-NBR   06370036
063800         DISPLAY PV-ABEND-PARAGRAPH                               06380036
063900         PERFORM Z999-SQL-ERROR                                   06390036
064000     END-EVALUATE.                                                06400036
064100                                                                  06410036
064200*                                                                 06420036
064300 2000-PROCESS-SU.                                                 06430036
064400******************************************************************06440036
064500*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *06450036
064600*  VENDOR ACCURACY CARTON AUDIT REPORT.                          *06460036
064700******************************************************************06470036
064800*                                                                 06480036
064900     IF SUATRN-TRN-NBR = PV-HOLD-TRN-NBR AND                      06490036
065000        SUATRN-REC-SEQ-NBR = PV-HOLD-REC-SEQ-NBR                  06500036
065100        CONTINUE                                                  06510036
065200     ELSE                                                         06520036
065300        MOVE SUATRN-TRN-NBR   TO PV-HOLD-TRN-NBR                  06530036
065400                                 HL4-PO-NBR                       06540036
065500        MOVE SUATRN-REC-SEQ-NBR TO PV-HOLD-REC-SEQ-NBR            06550036
065600                                   HL4-REC-SEQ-NBR                06560036
065700        WRITE PRINT-RECORD                                        06570036
065800              FROM HEADING-LINE-4                                 06580036
065900                   AFTER ADVANCING 2 LINE                         06590036
066000        WRITE PRINT-RECORD                                        06600036
066100              FROM HEADING-LINE-5                                 06610036
066200                   AFTER ADVANCING 2 LINE                         06620036
066300        WRITE PRINT-RECORD                                        06630036
066400              FROM HEADING-LINE-6                                 06640036
066500                   AFTER ADVANCING 1 LINE                         06650036
066600        WRITE PRINT-RECORD                                        06660036
066700              FROM PC-BLANK-LINE                                  06670036
066800                   AFTER ADVANCING 1 LINE                         06680036
066900        ADD +6 TO PV-LINE-CNT                                     06690036
067000     END-IF.                                                      06700036
067100                                                                  06710036
067200     PERFORM 2200-PRINT-DETAIL.                                   06720036
067300     PERFORM 2500-FETCH-CURSOR.                                   06730036
067400*                                                                 06740036
067500                                                                  06750036
067600 2200-PRINT-DETAIL.                                               06760036
067700******************************************************************06770036
067800*  FORMAT AND PRINT THE DETAIL LINE                              *06780036
067900******************************************************************06790036
068000                                                                  06800036
068100     MOVE SUATRN-SHIPT-UNT-ID    TO PV-SERIAL-SHIP-CODE.          06810036
068200     MOVE PV-SERIAL-SHIP-CODE-1    TO PV-OUT-S-S-C-1.             06820036
068300     MOVE PV-SERIAL-SHIP-CODE-2-8  TO PV-OUT-S-S-C-2-8.           06830036
068400     MOVE PV-SERIAL-SHIP-CODE-9-17 TO PV-OUT-S-S-C-9-17.          06840036
068500     MOVE PV-SERIAL-SHIP-CODE-18   TO PV-OUT-S-S-C-18.            06850036
068600     MOVE PV-OUT-SERIAL-SHIP-CODE TO DL1-SERIAL-SHIP-CODE.        06860036
068700                                                                  06870036
068800     MOVE SUATRN-DEST-OPER-UNT-ID  TO DL1-STR-NBR.                06880036
068900                                                                  06890036
069000     EVALUATE SUATRN-UNT-AUD-STAT-CDE                             06900036
069100        WHEN 'IP'                                                 06910036
069200             MOVE PC-IN-PROCESS    TO DL1-STATUS                  06920036
069300        WHEN 'PP'                                                 06930036
069400             MOVE PC-POSTPONED     TO DL1-STATUS                  06940036
069500        WHEN 'CM'                                                 06950036
069600             MOVE PC-COMPLETE      TO DL1-STATUS                  06960036
069700     END-EVALUATE.                                                06970036
069800                                                                  06980036
069900     MOVE SUATRN-UNT-AUD-STRT-TMST TO PV-DB2-TMST.                06990036
070000     MOVE PV-DB2-TMST-MM       TO DL1-CTN-STRT-MM.                07000036
070100     MOVE PV-DB2-TMST-DD       TO DL1-CTN-STRT-DD.                07010036
070200     MOVE PV-DB2-TMST-CCYY     TO DL1-CTN-STRT-CCYY.              07020036
070300     MOVE PV-DB2-TMST-HH       TO DL1-CTN-STRT-HH.                07030036
070400     MOVE PV-DB2-TMST-MN       TO DL1-CTN-STRT-MN.                07040036
070500                                                                  07050036
070600     IF  SUATRN-UNT-AUD-STP-TMST = PC-DEFAULT-TMST                07060036
070700         MOVE SPACES TO DL1-CTN-STP-DATE                          07070036
070800                        DL1-CTN-STP-TIME                          07080036
070900     ELSE                                                         07090036
071000         MOVE SUATRN-UNT-AUD-STP-TMST                             07100036
071100                               TO PV-DB2-TMST                     07110036
071200         MOVE PV-DB2-TMST-MM   TO DL1-CTN-STP-MM                  07120036
071300         MOVE PV-DB2-TMST-DD   TO DL1-CTN-STP-DD                  07130036
071400         MOVE PV-DB2-TMST-CCYY TO DL1-CTN-STP-CCYY                07140036
071500         MOVE PV-DB2-TMST-HH   TO DL1-CTN-STP-HH                  07150036
071600         MOVE PV-DB2-TMST-MN   TO DL1-CTN-STP-MN                  07160036
071700         MOVE '/'              TO DL1-STP-DASH1                   07170036
071800                                  DL1-STP-DASH2                   07180036
071900         MOVE ':'              TO DL1-STP-COLON                   07190036
072000     END-IF.                                                      07200036
072100                                                                  07210036
072200     PERFORM 2300-GET-LAST-SCAN.                                  07220036
072300                                                                  07230036
072400     MOVE SUAUPC-SCN-TMST  TO PV-DB2-TMST.                        07240036
072500     MOVE PV-DB2-TMST-MM   TO DL1-LST-SCN-MM.                     07250036
072600     MOVE PV-DB2-TMST-DD   TO DL1-LST-SCN-DD.                     07260036
072700     MOVE PV-DB2-TMST-CCYY TO DL1-LST-SCN-CCYY.                   07270036
072800     MOVE PV-DB2-TMST-HH   TO DL1-LST-SCN-HH.                     07280036
072900     MOVE PV-DB2-TMST-MN   TO DL1-LST-SCN-MN.                     07290036
073000                                                                  07300036
073100     MOVE SUAUPC-AUD-USR-ID TO DL1-USR-ID.                        07310036
073200                                                                  07320036
073300     PERFORM 2350-GET-UNITS-SCANNED.                              07330036
073400                                                                  07340036
073500     MOVE PV-UNITS-SCAN    TO DL1-UNT-SCN.                        07350036
073600                                                                  07360036
073700     WRITE PRINT-RECORD                                           07370036
073800           FROM DETAIL-LINES                                      07380036
073900                AFTER ADVANCING 1 LINE.                           07390036
074000                                                                  07400036
074100 2300-GET-LAST-SCAN.                                              07410036
074200******************************************************************07420036
074300*  SELECT THE USER ID AND SCAN TIMESTAMP FOR THE MOST RESET ROW  *07430036
074400******************************************************************07440036
074500     INITIALIZE DCLTSUAUPC.                                       07450036
074600                                                                  07460036
074700     MOVE '2300-GET-LAST-SCAN'   TO PV-ABEND-PARAGRAPH.           07470036
074800                                                                  07480036
074900     EXEC SQL                                                     07490036
075000          SELECT  A.SCN_TMST                                      07500036
075100                , A.AUD_USR_ID                                    07510036
075200            INTO  :SUAUPC-SCN-TMST                                07520036
075300                , :SUAUPC-AUD-USR-ID                              07530036
075400            FROM  TSUAUPC A                                       07540036
075500           WHERE  A.AUD_CNTL_NBR = :SUNAUD-AUD-CNTL-NBR           07550036
075600           AND    A.SHIPT_UNT_ID = :SUATRN-SHIPT-UNT-ID           07560036
075610           AND    A.SCN_TYP_CDE <> :PC-E                          07561038
075700           AND    A.SCN_TMST =                                    07570036
075800                  (SELECT MAX(B.SCN_TMST)                         07580036
075900                    FROM  TSUAUPC B                               07590036
076000                    WHERE B.AUD_CNTL_NBR = A.AUD_CNTL_NBR         07600036
076100                      AND B.SHIPT_UNT_ID = A.SHIPT_UNT_ID)        07610036
076200     END-EXEC.                                                    07620036
076300                                                                  07630036
076400     EVALUATE TRUE                                                07640036
076500       WHEN SQLCODE = ZEROS                                       07650036
076600       WHEN SQLCODE = +100                                        07660036
076700         CONTINUE                                                 07670036
076800       WHEN OTHER                                                 07680036
076900         DISPLAY PV-ABEND-PARAGRAPH                               07690036
077000         DISPLAY 'AUDIT CONTROL NUMBER:  ' SUNAUD-AUD-CNTL-NBR    07700036
077100         DISPLAY 'SHIPT UNIT ID          ' SUATRN-SHIPT-UNT-ID    07710036
077200         PERFORM Z999-SQL-ERROR                                   07720036
077300     END-EVALUATE.                                                07730036
077400                                                                  07740036
077500 2350-GET-UNITS-SCANNED.                                          07750036
077600******************************************************************07760036
077700*  SELECT THE TOTAL NUMBER OF UNITS SCANNED FOR THE CARTON       *07770036
077800******************************************************************07780036
077810*GB 2/26/02 CHANGED COUNT(*) TO SUM(SCND_UNT_QTY) AND IGNORE******07781037
077820*SCAN TYPES OF 'E'                                    ************07782037
077900                                                                  07790036
078000     INITIALIZE PV-UNITS-SCAN.                                    07800036
078100                                                                  07810036
078200     MOVE '2350-GET-UNITS-SCANNED' TO PV-ABEND-PARAGRAPH.         07820036
078300                                                                  07830036
078400     EXEC SQL                                                     07840036
078500          SELECT  SUM(SCND_UNT_QTY)                               07850037
078600            INTO  :PV-UNITS-SCAN                                  07860036
078700            FROM  TSUAUPC                                         07870036
078800           WHERE  AUD_CNTL_NBR = :SUNAUD-AUD-CNTL-NBR             07880036
078900           AND    SHIPT_UNT_ID = :SUATRN-SHIPT-UNT-ID             07890036
078910           AND    SCN_TYP_CDE <> :PC-E                            07891037
079000     END-EXEC.                                                    07900036
079100                                                                  07910036
079200     EVALUATE TRUE                                                07920036
079300       WHEN SQLCODE = ZEROS                                       07930036
079301         CONTINUE                                                 07930139
079310       WHEN SQLCODE = -305                                        07931039
079320            MOVE ZEROES TO PV-UNITS-SCAN                          07932039
079400       WHEN SQLCODE = +100                                        07940036
079500         CONTINUE                                                 07950036
079600       WHEN OTHER                                                 07960036
079700         DISPLAY PV-ABEND-PARAGRAPH                               07970036
079800         DISPLAY 'AUDIT CONTROL NUMBER:  ' SUNAUD-AUD-CNTL-NBR    07980036
079900         DISPLAY 'SHIPT UNIT ID          ' SUATRN-SHIPT-UNT-ID    07990036
080000         PERFORM Z999-SQL-ERROR                                   08000036
080100     END-EVALUATE.                                                08010036
080200                                                                  08020036
080300                                                                  08030036
080400 2400-OPEN-CURSOR.                                                08040036
080500******************************************************************08050036
080600**  OPEN THE CARTON CURSOR                                        08060036
080700******************************************************************08070036
080800     INITIALIZE DCLTSUATRN.                                       08080036
080900                                                                  08090036
081000     MOVE '2400-OPEN-CURSOR    '                                  08100036
081100                                 TO PV-ABEND-PARAGRAPH.           08110036
081200                                                                  08120036
081300     EXEC SQL                                                     08130036
081400       OPEN CTN-CSR                                               08140036
081500     END-EXEC.                                                    08150036
081600                                                                  08160036
081700     EVALUATE TRUE                                                08170036
081800       WHEN SQLCODE = ZEROS                                       08180036
081900         CONTINUE                                                 08190036
082000       WHEN OTHER                                                 08200036
082100         DISPLAY 'AUDIT CONTROL NUMBER IS ' CC-AUD-CNTL-NBR       08210036
082200         DISPLAY PV-ABEND-PARAGRAPH                               08220036
082300         PERFORM Z999-SQL-ERROR                                   08230036
082400     END-EVALUATE.                                                08240036
082500                                                                  08250036
082600                                                                  08260036
082700 2500-FETCH-CURSOR.                                               08270036
082800******************************************************************08280036
082900*  FETCH THE CARTON INFORMATION                                  *08290036
083000******************************************************************08300036
083100     INITIALIZE DCLTSUATRN.                                       08310036
083200                                                                  08320036
083300     MOVE '2100-FETCH-TRECEIV-INFO'                               08330036
083400                                 TO PV-ABEND-PARAGRAPH.           08340036
083500                                                                  08350036
083600     EXEC SQL                                                     08360036
083700          FETCH CTN-CSR                                           08370036
083800           INTO :SUATRN-SHIPT-UNT-ID                              08380036
083900               ,:SUATRN-DEST-OPER-UNT-ID                          08390036
084000               ,:SUATRN-TRN-NBR                                   08400036
084100               ,:SUATRN-REC-SEQ-NBR                               08410036
084200               ,:SUATRN-UNT-AUD-STAT-CDE                          08420036
084300               ,:SUATRN-UNT-AUD-STRT-TMST                         08430036
084400               ,:SUATRN-UNT-AUD-STP-TMST                          08440036
084500     END-EXEC.                                                    08450036
084600                                                                  08460036
084700     EVALUATE TRUE                                                08470036
084800       WHEN SQLCODE = ZEROS                                       08480036
084900         CONTINUE                                                 08490036
085000       WHEN SQLCODE = +100                                        08500036
085100         SET PS-END-OF-CARTON-CURSOR TO TRUE                      08510036
085200       WHEN OTHER                                                 08520036
085300         DISPLAY PV-ABEND-PARAGRAPH                               08530036
085400         PERFORM Z999-SQL-ERROR                                   08540036
085500     END-EVALUATE.                                                08550036
085600                                                                  08560036
085700                                                                  08570036
085800 8000-WRITE-REPORT-HEADERS.                                       08580036
085900******************************************************************08590036
086000*  PRINT THE HEADING FOR THE REPORT.                             *08600036
086100******************************************************************08610036
086200     PERFORM 8200-WRITE-TOP-LINE.                                 08620036
086300*                                                                 08630036
086400     WRITE PRINT-RECORD                                           08640036
086500       FROM HEADING-LINE-0                                        08650036
086600         AFTER ADVANCING 2 LINE.                                  08660036
086700*                                                                 08670036
086800     WRITE PRINT-RECORD                                           08680036
086900       FROM HEADING-LINE-1                                        08690036
087000         AFTER ADVANCING 1 LINE.                                  08700036
087100*                                                                 08710036
087200     WRITE PRINT-RECORD                                           08720036
087300       FROM HEADING-LINE-2                                        08730036
087400         AFTER ADVANCING 3 LINES.                                 08740036
087500*                                                                 08750036
087600     WRITE PRINT-RECORD                                           08760036
087700       FROM HEADING-LINE-3                                        08770036
087800         AFTER ADVANCING 1 LINES.                                 08780036
087900*                                                                 08790036
088000     MOVE 11                      TO PV-LINE-CNT.                 08800036
088100*                                                                 08810036
088200*                                                                 08820036
088300 8200-WRITE-TOP-LINE.                                             08830036
088400******************************************************************08840036
088500*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *08850036
088600*     NEEDED FOR AN ASN NUMBER.                                  *08860036
088700******************************************************************08870036
088800     ADD 1                        TO PV-PAGE-CNT.                 08880036
088900*                                                                 08890036
089000     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          08900036
089100*                                                                 08910036
089200     WRITE PRINT-RECORD                                           08920036
089300       FROM DP132O-STANDRD-HEADER-132-COLS                        08930036
089400         AFTER ADVANCING PAGE.                                    08940036
089500*                                                                 08950036
089600*                                                                 08960036
089700 8400-WRITE-DETAIL-LINES.                                         08970036
089800******************************************************************08980036
089900*     WRITES THE DETAIL LINE INFORMATION.                        *08990036
090000******************************************************************09000036
090100     WRITE PRINT-RECORD                                           09010036
090200       FROM DETAIL-LINE1                                          09020036
090300         AFTER ADVANCING 1 LINE.                                  09030036
090400*                                                                 09040036
090500     ADD +1                          TO PV-LINE-CNT.              09050036
090600*                                                                 09060036
090700*                                                                 09070036
090800******************************************************************09080036
090900*     SQL WARNING OR ERROR PROCESSING                            *09090036
091000******************************************************************09100036
091100                                                                  09110036
091200*                                                                 09120036
091300 Z999-SQL-ERROR.                                                  09130036
091400*---------------                                                  09140036
091500                                                                  09150036
091600     MOVE SQLCODE    TO SQLCODE2.                                 09160036
091700     MOVE SQLERRD(3) TO SQLERRD3.                                 09170036
091800     DISPLAY '** ABEND **       ** = SQLERROR'.                   09180036
091900     DISPLAY '** PROGRAM        ** = SUKRP016'.                   09190036
092000     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  09200036
092100     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  09210036
092200     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   09220036
092300     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  09230036
092400     EXEC SQL                                                     09240036
092500         COMMIT                                                   09250036
092600     END-EXEC.                                                    09260036
092700     MOVE +4013 TO PV-ABEND-CODE.                                 09270036
092800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09280036
