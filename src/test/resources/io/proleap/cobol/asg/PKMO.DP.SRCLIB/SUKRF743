000010 IDENTIFICATION DIVISION.                                         00001000
000020******************************************************************00002000
000030 PROGRAM-ID.             SUKRF743.                                00003009
000040 AUTHOR.                 DAN HINTZ.                               00004000
000050 INSTALLATION.           KOHLS.                                   00005000
000060 DATE-WRITTEN.           JULY 2016.                               00006000
000070 DATE-COMPILED.                                                   00007000
000080******************************************************************00008000
000090* THIS PROGRAM ALLOWS AN ASSOCIATE TO DO RELEASE DIRECTIVES ON A  00009000
000100* CARTON BY CARTON BASIS.                                         00010000
000110******************************************************************00011019
000120 ENVIRONMENT DIVISION.                                            00012000
000130 DATA DIVISION.                                                   00013000
000140******************************************************************00014000
000150 WORKING-STORAGE SECTION.                                         00015000
000160******************************************************************00016000
000170 01  DK-DB2-KEYS.                                                 00017000
000180     05  DK-BRCDE-NBR            PIC  X(22)          VALUE SPACES.00018000
000190     05  DK-SML-BRCDE1         REDEFINES DK-BRCDE-NBR.            00019000
000200         10  DK-SML-BRCDE1-01-02 PIC  9(02).                      00020000
000210         10  DK-SML-BRCDE1-03-20 PIC  9(18).                      00021000
000220         10  DK-SML-BRCDE1-21-22 PIC  X(02).                      00022000
000230     05  DK-SML-BRCDE2         REDEFINES DK-BRCDE-NBR.            00023000
000240         10  DK-SML-BRCDE2-01-20 PIC  9(20).                      00024000
000250         10  DK-SML-BRCDE2-21-22 PIC  X(02).                      00025000
000260     05  DK-P2L-BRCDE1         REDEFINES DK-BRCDE-NBR.            00026000
000270         10  DK-P2L-BRCDE1-01-01 PIC  9(01).                      00027000
000280         10  DK-P2L-BRCDE1-02-22 PIC  9(21).                      00028000
000290     05  DK-P2L-BRCDE2         REDEFINES DK-BRCDE-NBR.            00029000
000300         10  DK-P2L-BRCDE2-01-22 PIC  9(22).                      00030000
000301     05  DK-PO-NBR               PIC S9(09) COMP     VALUE +0.    00030100
000303     05  DK-OPER-UNT-ID          PIC S9(4)  COMP     VALUE +0.    00030300
000304/                                                                 00030400
000305 01  WS-AUTO-CONVEYOR-PARAMETERS.                                 00030500
000306     05  WS-AUTOCY-DIRECTIVE-MODE      PIC X(01)     VALUE SPACES.00030600
000307         88  ALL-CARTONS-DIRECTIVES-MODE             VALUE 'A'.   00030700
000308         88  EXCEPTION-DIRECTIVES-MODE               VALUE 'E'.   00030800
000309         88  NO-DIRECTIVES-MODE                      VALUE 'N'.   00030900
000310/                                                                 00031000
000311 01  DN-DB2-NULL-INDICATORS.                                      00031100
000313     05  DN-CASI-CDE             PIC S9(04) COMP     VALUE +0.    00031300
000314     05  DN-AUD-FALR-RSN-NM      PIC S9(04) COMP     VALUE +0.    00031400
000315     05  DN-STR-ZN-ID            PIC S9(04) COMP     VALUE +0.    00031500
000316     05  DN-SEASET-YR            PIC S9(04) COMP     VALUE +0.    00031600
000317     05  DN-SEASET-SHRT-NM       PIC S9(04) COMP     VALUE +0.    00031700
000320/                                                                 00032000
000322 01  PC-PROGRAM-CONSTANTS.                                        00032200
000330     05  PC-TRANID               PIC X(04)           VALUE 'S743'.00033013
000340     05  PC-TRANID-HELP          PIC X(04)           VALUE 'Z278'.00034000
000350     05  PC-TRANID-MENU          PIC X(04)           VALUE 'S500'.00035000
000360     05  PC-PROG-NAME            PIC X(08)           VALUE        00036000
000370                                           'SUKRF743'.            00037009
000380     05  PC-PROG-NAME-HELP       PIC X(08)           VALUE        00038000
000390                                           'DPKRF278'.            00039000
000400     05  PC-PROG-NAME-MENU       PIC X(08)           VALUE        00040000
000410                                           'SUKRF500'.            00041000
000411     05  PC-PROG-NAME-DDG        PIC X(08)           VALUE        00041100
000412                                           'SUKUT129'.            00041200
000420     05  PC-MSG001               PIC X(19)           VALUE        00042000
000430                                           'ENTER BARCODE      '. 00043000
000440     05  PC-MSG002               PIC X(19)           VALUE        00044000
000450                                           'INVALID BARCODE    '. 00045000
000460     05  PC-MSG003               PIC X(19)           VALUE        00046000
000470                                           'BARCODE MUST BE > 0'. 00047000
000471     05  PC-MSG004               PIC X(19)           VALUE        00047100
000472                                           'AUDIT IS NOT PASSED'. 00047210
000475     05  PC-MSG005               PIC X(19)           VALUE        00047510
000476                                           'RLSE DIRECTIVE SENT'. 00047610
000477     05  PC-MSG006               PIC X(19)           VALUE        00047710
000478                                           'DC SET-NO DIRCTVES '. 00047800
000479     05  PC-DG-ERROR-PARM        PIC X(19)           VALUE        00047920
000480                                           'PARM ERROR/SUKUT129'. 00048020
000481     05  PC-DG-ERROR-DB2         PIC X(19)           VALUE        00048120
000482                                           'DB2  ERROR/SUKUT129'. 00048220
000483     05  PC-DG-ERROR-MQ          PIC X(19)           VALUE        00048320
000484                                           'MQ   ERROR/SUKUT129'. 00048420
000485     05  PC-DG-ERROR-OTHR        PIC X(19)           VALUE        00048520
000486                                           'OTHR ERROR/SUKUT129'. 00048620
000487/                                                                 00048720
000490 01  PS-PROGRAM-SWITCHES.                                         00049000
000500     05  PS-EDIT-ERROR-SW        PIC X(01)           VALUE ' '.   00050000
000510         88 PS-EDIT-ERROR                            VALUE 'Y'.   00051000
000513     05  PS-DIRECTIVE-SW         PIC X(01)           VALUE ' '.   00051300
000514         88 PS-NO-DIRECTIVE-FOUND                    VALUE 'N'.   00051400
000515         88 PS-DIRECTIVE-RLSED                       VALUE 'R'.   00051500
000516     05  PS-AUDIT-DIRECTIVE-SW   PIC X(01)           VALUE ' '.   00051620
000517         88 PS-NOT-AUDIT-DIRECTIVE                   VALUE 'N'.   00051700
000518         88 PS-AUDIT-DIRECTIVE                       VALUE 'Y'.   00051800
000519     05  PS-ADD-ONLY-DIRECTIVE-SW PIC X(01)          VALUE ' '.   00051904
000520         88 PS-NOT-ADD-ONLY-DIRECTIVE                VALUE 'N'.   00052004
000521         88 PS-ADD-ONLY-DIRECTIVE                    VALUE 'Y'.   00052104
000522/                                                                 00052204
000530 01  PV-PROGRAM-VARIABLES.                                        00053000
000540     05  PV-MESSAGE-AREA         PIC  X(19)          VALUE SPACES.00054000
000550     05  PV-CICS-RESPONSE        PIC S9(09) COMP SYNC VALUE +0.   00055000
000560     05  PV-CHAR-COUNT           PIC S9(04) COMP SYNC VALUE +0.   00056000
000570     05  PV-CTN                  PIC  X(22)          VALUE SPACES.00057000
000571     05  PV-LOC                  PIC  X(50)          VALUE SPACES.00057100
000572     05  PV-PO-NBR-DISP-X.                                        00057217
000573         10  PV-PO-NBR-DISP-N    PIC  9(09)          VALUE ZEROS. 00057317
000574/                                                                 00057417
000575 01  PV-LOG-MSG.                                                  00057517
000576     05  FILLER                       PIC X(12) VALUE             00057617
000577         ' S743 ERROR '.                                          00057717
000578           05  FILLER                 PIC X(06) VALUE             00057817
000579               'USER= '.                                          00057917
000580           05  PV-LOG-USER-ID         PIC X(08) VALUE SPACES.     00058017
000581           05  FILLER                 PIC X(10) VALUE             00058117
000582               ' SQLCODE= '.                                      00058217
000583           05  PV-SQLCODE             PIC -9(03).                 00058317
000585/                                                                 00058517
000590/                                                                 00059000
000671******************************************************************00067100
000672*    DIRECTIVE GENERATOR REQUEST COMMUNICATION AREA               00067200
000673******************************************************************00067300
000674     COPY SUWS090.                                                00067400
000675/                                                                 00067500
000680******************************************************************00068000
000690*  COPY BOOK FOR THE LOGIN INFO SUBROUTINE.                       00069000
000700******************************************************************00070000
000710     COPY DPWS026.                                                00071000
000720/                                                                 00072000
000780******************************************************************00078000
000790* SCREEN ERROR MESSAGES                                           00079000
000800******************************************************************00080000
000810     COPY PCWS034.                                                00081000
000820/                                                                 00082000
000830******************************************************************00083000
000840* HELP SCREEN WORK AREA                                           00084000
000850******************************************************************00085000
000860     COPY PCWS188.                                                00086000
000870/                                                                 00087000
000880******************************************************************00088000
000890* HELP SCREEN COMMAREA                                            00089000
000900******************************************************************00090000
000910     COPY PCWS192.                                                00091000
000920/                                                                 00092000
000930******************************************************************00093000
000940*  MAP LAYOUT                                                     00094000
000950******************************************************************00095000
000960     COPY SUKM743.                                                00096009
000970/                                                                 00097000
000980******************************************************************00098000
000990*  PROGRAM COMMAREA                                               00099000
001000******************************************************************00100000
001010 01  CA-COMMAREA.                                                 00101000
001020     COPY SUWS001.                                                00102000
001030     05  CA-PROGRAM-DATA.                                         00103000
001040         10  CA-MAP-ACARTN       PIC  X(22)          VALUE SPACES.00104000
001041*CLP 09/26/2014                                                   00104100
001050         10  CA-MAP-ARCVR        PIC  X(12)          VALUE SPACES.00105000
001051         10  CA-MAP-ARCVR-N    REDEFINES CA-MAP-ARCVR.            00105100
001052             15  CA-MAP-PO       PIC  9(08).                      00105200
001053             15  CA-MAP-DASH     PIC  X(01).                      00105300
001054             15  CA-MAP-RCVR-SEQ-NBR                              00105410
001055                                 PIC  9(03).                      00105510
001060         10  CA-MAP-ACDEST       PIC  X(05)          VALUE SPACES.00106000
001061         10  CA-MAP-ACDEST-N   REDEFINES CA-MAP-ACDEST            00106100
001070                                 PIC  9(05).                      00107000
001071         10  CA-MAP-ARLSE        PIC  X(20)          VALUE SPACES.00107100
001080         10  CA-MAP-AMSGLN       PIC  X(19)          VALUE SPACES.00108000
001090         10  CA-LOCATION-NBR     PIC S9(04) COMP     VALUE +0.    00109000
001100         10  CA-USERID           PIC  X(08)          VALUE SPACES.00110000
001110/                                                                 00111000
001120******************************************************************00112000
001130*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   00113000
001140******************************************************************00114000
001150     COPY DPWS015.                                                00115000
001160/                                                                 00116000
001170******************************************************************00117000
001180*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00118000
001190******************************************************************00119000
001200     COPY DFHAID.                                                 00120000
001210/                                                                 00121000
001220******************************************************************00122000
001230*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00123000
001240******************************************************************00124000
001250     COPY DPWS013.                                                00125000
001260/                                                                 00126000
001270******************************************************************00127000
001280*  SQL AND COBOL DECLARATIONS FOR SUT_PO_AUD_REQ                  00128004
001290******************************************************************00129000
001300     EXEC SQL                                                     00130000
001310         INCLUDE SUT00015                                         00131004
001320     END-EXEC.                                                    00132000
001330/                                                                 00133000
001340******************************************************************00134004
001350*  SQL AND COBOL DECLARATIONS FOR SUT_CART_DIRV_TRKG              00135004
001360******************************************************************00136004
001370     EXEC SQL                                                     00137004
001380         INCLUDE SUT00102                                         00138004
001390     END-EXEC.                                                    00139004
001400/                                                                 00140004
001541******************************************************************00154100
001542*  SQL AND COBOL DECLARATIONS FOR TPURCHS                         00154200
001543******************************************************************00154300
001544     EXEC SQL                                                     00154400
001545          INCLUDE TPURCHS                                         00154500
001546     END-EXEC.                                                    00154600
001547/                                                                 00154700
001549******************************************************************00154900
001550*  DB2 DECLARATION - PARAMETER TABLE                              00155000
001560*      TABLE (TKRPRPM)                                            00156000
001570******************************************************************00157000
001580     EXEC SQL                                                     00158000
001590         INCLUDE TKRPRPM                                          00159000
001600     END-EXEC.                                                    00160000
001900/                                                                 00190000
002090******************************************************************00209000
002100*  DB2 AREA FOR COMMUNICATIONS.                                   00210000
002110******************************************************************00211000
002120     EXEC SQL                                                     00212000
002130         INCLUDE SQLCA                                            00213000
002140     END-EXEC.                                                    00214000
002150/                                                                 00215000
002160 LINKAGE SECTION.                                                 00216000
002170                                                                  00217000
002180 01  DFHCOMMAREA.                                                 00218000
002190     05  FILLER                     OCCURS  1 TO 4072 TIMES       00219000
002200                                    DEPENDING ON EIBCALEN.        00220000
002210         10  FILLER                   PIC X(01).                  00221000
002220/                                                                 00222000
002230 PROCEDURE DIVISION.                                              00223000
002240                                                                  00224000
002250******************************************************************00225000
002260* 0000-PROGRAM-MAINLINE                                          *00226000
002270******************************************************************00227000
002280 0000-PROGRAM-MAINLINE.                                           00228000
002290                                                                  00229000
002300     EVALUATE TRUE                                                00230000
002310*****************************************                         00231000
002320*  DIRECT ENTRY USING S743 NOT ALLOWED  *                         00232009
002330*****************************************                         00233000
002340         WHEN EIBCALEN = ZERO                                     00234003
002350             MOVE PC034-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA 00235003
002360             PERFORM 8110-RETURN                                  00236003
002370*****************************************                         00237000
002380*  INITIAL ENTRY FROM MENU              *                         00238000
002390*****************************************                         00239000
002400         WHEN EIBTRNID = PC-TRANID-MENU                           00240000
002410             INITIALIZE          CA-COMMAREA                      00241000
002420             MOVE DFHCOMMAREA TO CA-COMMAREA                      00242000
002430             PERFORM 1000-GET-LOGON-INFO                          00243000
002440             MOVE PC-MSG001   TO AMSGLNO                          00244000
002450             PERFORM 8000-SEND-MAP-ERASE                          00245000
002460             PERFORM 8100-RETURN-TRANID                           00246000
002470*****************************************                         00247000
002480*  CONTINUE PROCESSING                  *                         00248000
002490*****************************************                         00249000
002500         WHEN EIBTRNID = PC-TRANID                                00250000
002501             MOVE DFHCOMMAREA TO CA-COMMAREA                      00250100
002510             PERFORM 8020-RECEIVE-MAP                             00251000
002520*****************************************                         00252000
002530*  BACK FROM THE HELP SCREEN            *                         00253000
002540*****************************************                         00254000
002550         WHEN EIBTRNID = PC-TRANID-HELP                           00255000
002560             MOVE DFHCOMMAREA          TO PC192-COMMAREA          00256000
002570             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             00257000
002580             MOVE CA-MAP-ACARTN        TO ACARTNO                 00258000
002590             MOVE CA-MAP-ARCVR         TO ARCVRO                  00259000
002600             MOVE CA-MAP-ACDEST        TO ACDESTO                 00260000
002610             MOVE CA-MAP-ARLSE         TO ARLSEO                  00261000
002620             MOVE CA-MAP-AMSGLN        TO AMSGLNO                 00262000
002630             PERFORM 8000-SEND-MAP-ERASE                          00263000
002640             PERFORM 8100-RETURN-TRANID                           00264000
002650*****************************************                         00265000
002660*  INVALID PROGRAM ENTRY                *                         00266000
002670*****************************************                         00267000
002680         WHEN OTHER                                               00268000
002690             MOVE PC034-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA 00269000
002700             PERFORM 8110-RETURN                                  00270000
002710     END-EVALUATE.                                                00271000
002720                                                                  00272000
002730     EVALUATE TRUE                                                00273000
002740*****************************************                         00274000
002750*  TRANSFER TO HELP SCREEN              *                         00275000
002760*****************************************                         00276000
002770         WHEN EIBAID = DFHPF1                                     00277000
002780             PERFORM 1200-HELP-SCREEN                             00278000
002790             PERFORM 8220-XCTL-TO-HELP                            00279000
002800*****************************************                         00280000
002810*  RESET SCREEN                         *                         00281000
002820*****************************************                         00282000
002830         WHEN EIBAID = DFHCLEAR                                   00283000
002840             MOVE SPACES    TO ACARTNO                            00284000
002850                               ARCVRO                             00285000
002860                               ACDESTO                            00286000
002870                               ARLSEO                             00287000
002880                               CA-MAP-ACARTN                      00288000
002890                               CA-MAP-ARCVR                       00289000
002900                               CA-MAP-ACDEST                      00290000
002910                               CA-MAP-ARLSE                       00291000
002920                               CA-MAP-AMSGLN                      00292000
002930             MOVE PC-MSG001 TO AMSGLNO                            00293000
002940             PERFORM 8000-SEND-MAP-ERASE                          00294000
002950             PERFORM 8100-RETURN-TRANID                           00295000
002960*****************************************                         00296000
002970*  TRANSFER BACK TO MENU                *                         00297000
002980*****************************************                         00298000
002990         WHEN EIBAID = DFHPF3                                     00299000
003000             SET SU001-INITIALIZE-SCREEN TO TRUE                  00300000
003010             MOVE PC-PROG-NAME           TO SU001-LAST-PROGRAM    00301000
003020             MOVE PC-TRANID              TO SU001-TRAN-ID         00302000
003030             PERFORM 8200-XCTL-TO-MENU                            00303000
003040*****************************************                         00304000
003050*  PROCESS SCREEN INPUT                 *                         00305000
003060*****************************************                         00306000
003070         WHEN EIBAID = DFHENTER                                   00307000
003071             PERFORM 1010-SEL-AUTO-DIRECTIVE                      00307100
003074             IF ( NO-DIRECTIVES-MODE )                            00307400
003075                 MOVE PC-MSG006 TO AMSGLNO                        00307510
003076             ELSE                                                 00307600
003081                 PERFORM 2000-PROCESS-SCREEN-FIELDS               00308100
003090                 IF ( PS-EDIT-ERROR )                             00309000
003100                     CONTINUE                                     00310000
003120                 ELSE                                             00312000
003121                     INITIALIZE DCLSUT00102                       00312100
003130                     PERFORM 3000-CHECK-AUDIT-PASSED-DIRV         00313002
003132                     IF ( PS-NO-DIRECTIVE-FOUND )                 00313202
003134                         CONTINUE                                 00313400
003135                     ELSE                                         00313500
003136                          PERFORM 4000-FORMAT-RLSE-DIRECTIVE      00313600
003137                     END-IF                                       00313700
003138                 END-IF                                           00313800
003139             END-IF                                               00313900
003140*****************************************                         00314000
003150*  INVALID KEY                          *                         00315000
003160*****************************************                         00316000
003170         WHEN OTHER                                               00317000
003180             MOVE PC034-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO        00318000
003210     END-EVALUATE.                                                00321000
003220                                                                  00322000
003230     PERFORM 8010-SEND-MAP-DATA-ONLY.                             00323000
003240     PERFORM 8100-RETURN-TRANID.                                  00324000
003250                                                                  00325000
003260     GOBACK.                                                      00326000
003270/                                                                 00327000
003280******************************************************************00328000
003290* 1000-GET-LOGON-INFO                                            *00329000
003300******************************************************************00330000
003310 1000-GET-LOGON-INFO.                                             00331000
003320                                                                  00332000
003330     MOVE EIBTRMID  TO  DP026-QUEUE-TERM.                         00333000
003340     MOVE +1        TO  DP026-TS-ITEM.                            00334000
003350                                                                  00335000
003360     EXEC CICS INQUIRE                                            00336000
003370               TRANSACTION  (DP026-LOGON-ROUTINE)                 00337000
003380               REMOTESYSTEM (DP026-SYSID)                         00338000
003390     END-EXEC.                                                    00339000
003400                                                                  00340000
003410     IF ( DP026-SYSID = SPACES )                                  00341000
003420         EXEC CICS READQ TS                                       00342000
003430                   QUEUE  (DP026-QUEUE-NAME)                      00343000
003440                   ITEM   (DP026-TS-ITEM)                         00344000
003450                   INTO   (DP026-SIGN-ON-INFO)                    00345000
003460                   RESP   (DP026-CICS-RESPONSE)                   00346000
003470         END-EXEC                                                 00347000
003480     ELSE                                                         00348000
003490         EXEC CICS READQ TS                                       00349000
003500                   QUEUE  (DP026-QUEUE-NAME)                      00350000
003510                   SYSID  (DP026-SYSID)                           00351000
003520                   ITEM   (DP026-TS-ITEM)                         00352000
003530                   INTO   (DP026-SIGN-ON-INFO)                    00353000
003540                   RESP   (DP026-CICS-RESPONSE)                   00354000
003550         END-EXEC                                                 00355000
003560     END-IF.                                                      00356000
003570                                                                  00357000
003580     EVALUATE TRUE                                                00358000
003590         WHEN DP026-CICS-RESPONSE = DFHRESP (NORMAL)              00359000
003600             MOVE DP026-LOCATION-NBR TO CA-LOCATION-NBR           00360000
003601                                        DK-OPER-UNT-ID            00360100
003610             MOVE DP026-USERID       TO CA-USERID                 00361000
003620             CONTINUE                                             00362000
003630         WHEN OTHER                                               00363000
003640             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00364000
003650             MOVE '1000-GET-LOGON-INFO' TO DP013-PARAGRAPH        00365000
003660             STRING PC-PROG-NAME                                  00366000
003670                    ' - UNABLE TO READ LOGON TSQ'                 00367000
003680                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00368000
003690             SET DP013-CICS-ABEND                                 00369000
003700                 DP013-ROLLBACK         TO TRUE                   00370000
003710             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00371000
003720             MOVE PC034-CICS-FATAL-ERROR-MSG TO AMSGLNO           00372000
003730             MOVE SPACES                     TO ACARTNO           00373000
003740                                                ARCVRO            00374000
003750                                                ACDESTO           00375000
003760                                                ARLSEO            00376000
003770             PERFORM 8010-SEND-MAP-DATA-ONLY                      00377000
003780             PERFORM 8100-RETURN-TRANID                           00378000
003790     END-EVALUATE.                                                00379000
003800/                                                                 00380000
003801******************************************************************00380100
003802* 1010-SEL-AUTO-DIRECTIVE                                        *00380200
003803*     DETERMINE AUTO CONVEYER MODE                               *00380300
003804*     'N' = NO DIRECTIVES                                        *00380400
003805*     'E' = ISSUED FOR EXCEPTIONS                                *00380500
003806*     'A' = ISSUED FOR ALL CARTONS                               *00380600
003807******************************************************************00380700
003808 1010-SEL-AUTO-DIRECTIVE.                                         00380800
003809                                                                  00380900
003810     MOVE CA-LOCATION-NBR TO DK-OPER-UNT-ID.                      00381000
003811                                                                  00381100
003812     EXEC SQL                                                     00381200
003813         SELECT FUNC_TXT                                          00381300
003814           INTO :WS-AUTOCY-DIRECTIVE-MODE                         00381400
003815           FROM TKRPRPM                                           00381500
003816          WHERE INTFC_SYS_CDE        = 'KHL'                      00381600
003817            AND SYS_PRC_FUNC_CDE     = 'ACAUDT'                   00381700
003818            AND FUNC_PRC_STAT_CDE    = 'AC'                       00381800
003819            AND FUNC_BEG_TMST       <=  CURRENT TIMESTAMP         00381900
003820            AND FUNC_END_TMST       >=  CURRENT TIMESTAMP         00382000
003821            AND LOC_ID               =  :DK-OPER-UNT-ID           00382100
003822     END-EXEC                                                     00382200
003823                                                                  00382300
003824     EVALUATE TRUE                                                00382400
003825       WHEN SQLCODE     = ZERO                                    00382500
003826           CONTINUE                                               00382600
003827       WHEN SQLCODE NOT = ZERO                                    00382700
003828             MOVE PC-PROG-NAME              TO DP013-PROGRAM      00382800
003829             MOVE '1010-SEL-AUTO-DIRECTIVE' TO DP013-PARAGRAPH    00382900
003830             STRING PC-PROG-NAME                                  00383000
003831                    ' - UNABLE TO SELECT '                        00383100
003832                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00383200
003833             MOVE SQLCA              TO DP013-SQLCA               00383300
003834             MOVE 'TKRPRPM'          TO DP013-DB2-TABLE-NAME (1)  00383400
003835             SET DP013-CICS-ABEND                                 00383500
003836                 DP013-ROLLBACK      TO TRUE                      00383600
003837             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00383700
003838             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLNO            00383800
003839             MOVE SPACES                    TO ACARTNO            00383900
003840                                               ARCVRO             00384000
003841                                               ACDESTO            00384100
003842                                               ARLSEO             00384200
003843             PERFORM 8010-SEND-MAP-DATA-ONLY                      00384300
003844             PERFORM 8100-RETURN-TRANID                           00384400
003845     END-EVALUATE.                                                00384500
003846******************************************************************00384600
003847* 1200-HELP-SCREEN                                               *00384700
003848******************************************************************00384800
003849 1200-HELP-SCREEN.                                                00384900
003850                                                                  00385000
003860     MOVE PC-PROG-NAME                TO PC192-PROGRAM-NAME.      00386000
003870     COPY PCPD188.                                                00387000
003880     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      00388000
003890     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    00389000
003900/                                                                 00390000
003910******************************************************************00391000
003920* 2000-PROCESS-SCREEN-FIELDS                                     *00392000
003930******************************************************************00393000
003940 2000-PROCESS-SCREEN-FIELDS.                                      00394000
003950                                                                  00395000
003960     INSPECT ACARTNI REPLACING ALL LOW-VALUES BY SPACES.          00396000
003970     MOVE ACARTNI TO PV-CTN.                                      00397000
003980     MOVE +0      TO PV-CHAR-COUNT.                               00398000
003990     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         00399000
004000            BEFORE INITIAL SPACE.                                 00400000
004010                                                                  00401000
004020     EVALUATE TRUE                                                00402000
004030         WHEN PV-CHAR-COUNT = +0                                  00403000
004040             MOVE 'Y'                    TO PS-EDIT-ERROR-SW      00404000
004050             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               00405000
004060             MOVE PC-MSG001              TO AMSGLNO               00406000
004070         WHEN PV-CHAR-COUNT = +18                                 00407000
004080             IF ( PV-CTN(01:18) NUMERIC ) AND                     00408000
004090                ( PV-CTN(01:18) > ZEROS )                         00409000
004100                 MOVE 0             TO DK-SML-BRCDE1-01-02        00410000
004110                 MOVE PV-CTN(01:18) TO DK-SML-BRCDE1-03-20        00411000
004120                 MOVE SPACES        TO DK-SML-BRCDE1-21-22        00412000
004130             ELSE                                                 00413000
004140                 IF ( PV-CTN(01:18) = ZEROS )                     00414000
004150                     MOVE 'Y'                                     00415000
004160                                         TO PS-EDIT-ERROR-SW      00416000
004170                     MOVE DP015-UNP-ALP-BRT-MDT                   00417000
004180                                         TO ACARTNA               00418000
004190                     MOVE PC-MSG003      TO AMSGLNO               00419000
004200                 ELSE                                             00420000
004210                     MOVE 'Y'                                     00421000
004220                                         TO PS-EDIT-ERROR-SW      00422000
004230                     MOVE DP015-UNP-ALP-BRT-MDT                   00423000
004240                                         TO ACARTNA               00424000
004250                     MOVE PC-MSG002      TO AMSGLNO               00425000
004260                 END-IF                                           00426000
004270             END-IF                                               00427000
004280         WHEN PV-CHAR-COUNT = +20                                 00428000
004290             IF ( PV-CTN(01:20) NUMERIC ) AND                     00429000
004300                ( PV-CTN(01:20) > ZEROS )                         00430000
004310                 MOVE PV-CTN(01:20) TO DK-SML-BRCDE2-01-20        00431000
004320                 MOVE SPACES        TO DK-SML-BRCDE1-21-22        00432000
004330             ELSE                                                 00433000
004340                 IF ( PV-CTN(01:20) = ZEROS )                     00434000
004350                     MOVE 'Y'                                     00435000
004360                                         TO PS-EDIT-ERROR-SW      00436000
004370                     MOVE DP015-UNP-ALP-BRT-MDT                   00437000
004380                                         TO ACARTNA               00438000
004390                     MOVE PC-MSG003      TO AMSGLNO               00439000
004400                 ELSE                                             00440000
004410                     MOVE 'Y'                                     00441000
004420                                         TO PS-EDIT-ERROR-SW      00442000
004430                     MOVE DP015-UNP-ALP-BRT-MDT                   00443000
004440                                         TO ACARTNA               00444000
004450                     MOVE PC-MSG002      TO AMSGLNO               00445000
004460                 END-IF                                           00446000
004470             END-IF                                               00447000
004480         WHEN PV-CHAR-COUNT = +21                                 00448000
004490             IF ( PV-CTN(01:21) NUMERIC ) AND                     00449000
004500                ( PV-CTN(01:21) > ZEROS )                         00450000
004510                 MOVE 0             TO DK-P2L-BRCDE1-01-01        00451000
004520                 MOVE PV-CTN(01:21) TO DK-P2L-BRCDE1-02-22        00452000
004530             ELSE                                                 00453000
004540                 IF ( PV-CTN(01:21) = ZEROS )                     00454000
004550                     MOVE 'Y'                                     00455000
004560                                         TO PS-EDIT-ERROR-SW      00456000
004570                     MOVE DP015-UNP-ALP-BRT-MDT                   00457000
004580                                         TO ACARTNA               00458000
004590                     MOVE PC-MSG003      TO AMSGLNO               00459000
004600                 ELSE                                             00460000
004610                     MOVE 'Y'                                     00461000
004620                                         TO PS-EDIT-ERROR-SW      00462000
004630                     MOVE DP015-UNP-ALP-BRT-MDT                   00463000
004640                                         TO ACARTNA               00464000
004650                     MOVE PC-MSG002      TO AMSGLNO               00465000
004660                 END-IF                                           00466000
004670             END-IF                                               00467000
004680         WHEN PV-CHAR-COUNT = +22                                 00468000
004690             IF ( PV-CTN NUMERIC ) AND                            00469000
004700                ( PV-CTN > ZEROS )                                00470000
004710                 MOVE PV-CTN TO DK-P2L-BRCDE2-01-22               00471000
004720             ELSE                                                 00472000
004730                 IF ( PV-CTN = ZEROS )                            00473000
004740                     MOVE 'Y'                                     00474000
004750                                         TO PS-EDIT-ERROR-SW      00475000
004760                     MOVE DP015-UNP-ALP-BRT-MDT                   00476000
004770                                         TO ACARTNA               00477000
004780                     MOVE PC-MSG003      TO AMSGLNO               00478000
004790                 ELSE                                             00479000
004800                     MOVE 'Y'                                     00480000
004810                                         TO PS-EDIT-ERROR-SW      00481000
004820                     MOVE DP015-UNP-ALP-BRT-MDT                   00482000
004830                                         TO ACARTNA               00483000
004840                     MOVE PC-MSG002      TO AMSGLNO               00484000
004850                 END-IF                                           00485000
004860             END-IF                                               00486000
004870         WHEN OTHER                                               00487000
004880             MOVE 'Y'                    TO PS-EDIT-ERROR-SW      00488000
004890             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               00489000
004900             MOVE PC-MSG002              TO AMSGLNO               00490000
004910     END-EVALUATE.                                                00491000
004920/                                                                 00492000
005321******************************************************************00532100
005322* 3000-CHECK-AUDIT-PASSED-DIRV.                                  *00532202
005323*     CHECK TO SEE IF THE LAST DIRECTIVE SENT FOR THIS CONTAINER *00532300
005324*     WAS A DELETE DIRECTIVE BECAUSE THE AUDIT HAD PASSED.  IN   *00532400
005325*     THIS CASE, THE DELETE DIRECTIVE NEVER MADE IT TO EITHER    *00532500
005326*     THE DEMATIC OR WYNRIGHT APPLICATION AND NEEDS TO BE SENT   *00532600
005327*     AGAIN SO THAT THE CONTAINER MAKES IT TO ITS FINAL          *00532700
005328*     DESTINATION.                                               *00532800
005329******************************************************************00532900
005330 3000-CHECK-AUDIT-PASSED-DIRV.                                    00533002
005331                                                                  00533100
005332     SET PS-NOT-AUDIT-DIRECTIVE TO TRUE.                          00533200
005333                                                                  00533300
005334     EXEC SQL                                                     00533400
005335         SELECT                                                   00533500
005336               BRCDE_NBR                                          00533600
005337              ,CRE_TMST                                           00533700
005338              ,OPER_UNT_ID                                        00533800
005339              ,DIRV_RSN_CDE                                       00533900
005340              ,LGCL_LOC_NM                                        00534000
005341              ,AUD_CNTL_NBR                                       00534100
005342              ,SHIPT_UNT_ID                                       00534200
005343              ,AUD_STAT_CDE                                       00534300
005344              ,PO_NBR                                             00534400
005345              ,RCVR_SEQ_NBR                                       00534500
005346              ,PO_LNE_NBR                                         00534600
005347              ,PREPK_ID                                           00534700
005348              ,STR_NBR                                            00534800
005349              ,CRE_PGM_NM                                         00534900
005350              ,ACKNL_SEQ_NBR                                      00535000
005351              ,CASI_CDE                                           00535100
005352              ,CART_STAT_CDE                                      00535200
005353              ,AUD_FALR_RSN_NM                                    00535300
005354              ,STR_ZN_ID                                          00535400
005355              ,SEASET_YR                                          00535500
005356              ,SEASET_SHRT_NM                                     00535600
005357              ,CNVYR_PRC_ACTN_NM                                  00535700
005358              ,CRE_BY_USR_ID                                      00535800
005359         INTO  :SUT00102-BRCDE-NBR                                00535900
005360              ,:SUT00102-CRE-TMST                                 00536000
005361              ,:SUT00102-OPER-UNT-ID                              00536100
005362              ,:SUT00102-DIRV-RSN-CDE                             00536200
005363              ,:SUT00102-LGCL-LOC-NM                              00536300
005364              ,:SUT00102-AUD-CNTL-NBR                             00536400
005365              ,:SUT00102-SHIPT-UNT-ID                             00536500
005366              ,:SUT00102-AUD-STAT-CDE                             00536600
005367              ,:SUT00102-PO-NBR                                   00536700
005368              ,:SUT00102-RCVR-SEQ-NBR                             00536800
005369              ,:SUT00102-PO-LNE-NBR                               00536900
005370              ,:SUT00102-PREPK-ID                                 00537000
005371              ,:SUT00102-STR-NBR                                  00537100
005372              ,:SUT00102-CRE-PGM-NM                               00537200
005373              ,:SUT00102-ACKNL-SEQ-NBR                            00537300
005374              ,:SUT00102-CASI-CDE        :DN-CASI-CDE             00537400
005375              ,:SUT00102-CART-STAT-CDE                            00537500
005376              ,:SUT00102-AUD-FALR-RSN-NM :DN-AUD-FALR-RSN-NM      00537600
005377              ,:SUT00102-STR-ZN-ID       :DN-STR-ZN-ID            00537700
005378              ,:SUT00102-SEASET-YR       :DN-SEASET-YR            00537800
005379              ,:SUT00102-SEASET-SHRT-NM  :DN-SEASET-SHRT-NM       00537900
005380              ,:SUT00102-CNVYR-PRC-ACTN-NM                        00538000
005381              ,:SUT00102-CRE-BY-USR-ID                            00538100
005382           FROM   SUT_CART_DIRV_TRKG  A                           00538218
005383          WHERE   A.BRCDE_NBR      = :DK-BRCDE-NBR                00538318
005384            AND ((A.DIRV_RSN_CDE  IN ('AUN', 'AUP'))              00538418
005385             OR  (A.DIRV_RSN_CDE   = 'RLO'  AND                   00538518
005386                  A.LGCL_LOC_NM    = 'BARCODE')                   00538620
005387             OR  (A.DIRV_RSN_CDE   = 'RLC'  AND                   00538720
005388                  A.LGCL_LOC_NM    = 'ALL')                       00538820
005389             OR  (A.DIRV_RSN_CDE   = 'RLF'  AND                   00538920
005390                  A.LGCL_LOC_NM    = 'ALL'))                      00539020
005391            AND   A.CRE_TMST       =                              00539120
005392                  ( SELECT MAX (CRE_TMST)                         00539220
005393                    FROM SUT_CART_DIRV_TRKG B                     00539320
005394                    WHERE B.BRCDE_NBR  =  A.BRCDE_NBR             00539420
005400                    )                                             00540018
005437     END-EXEC.                                                    00543700
005438                                                                  00543800
005439     EVALUATE TRUE                                                00543900
005440       WHEN SQLCODE = ZEROS                                       00544000
005441           SET PS-AUDIT-DIRECTIVE          TO TRUE                00544100
005442           PERFORM 3010-GET-ENT-ID                                00544200
005443       WHEN SQLCODE = +100                                        00544300
005444           PERFORM 3020-CHECK-IF-ONLY-ADD-SENT                    00544404
005445       WHEN OTHER                                                 00544500
005446             MOVE CA-USERID           TO PV-LOG-USER-ID           00544617
005447             MOVE SQLCODE             TO PV-SQLCODE               00544717
005449             PERFORM 9903-WRITE-CICS-LOG                          00544917
005450             MOVE PC-PROG-NAME             TO DP013-PROGRAM       00545000
005451             MOVE '3000-CHECK-AUDIT-PASSED-DIRV'                  00545103
005452                                           TO DP013-PARAGRAPH     00545200
005453             STRING PC-PROG-NAME                                  00545300
005454                    ' - UNABLE TO SELECT '                        00545400
005455                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00545500
005456             STRING 'BARCODE : '                                  00545617
005457                    DK-BRCDE-NBR                                  00545717
005458                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (2) 00545817
005459             MOVE SQLCA              TO DP013-SQLCA               00545917
005460             MOVE 'SUT_CART_DIRV_TRKG' TO DP013-DB2-TABLE-NAME (1)00546017
005461             SET DP013-CICS-ABEND                                 00546117
005462                 DP013-ROLLBACK      TO TRUE                      00546217
005463             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00546317
005464             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLNO            00546417
005465             MOVE SPACES                    TO ACARTNO            00546517
005466                                               ARCVRO             00546617
005467                                               ACDESTO            00546717
005468                                               ARLSEO             00546817
005469             PERFORM 8010-SEND-MAP-DATA-ONLY                      00546917
005470             PERFORM 8100-RETURN-TRANID                           00547017
005471     END-EVALUATE.                                                00547117
005472/                                                                 00547217
005473******************************************************************00547317
005474* 3010-GET-ENT-ID                                                *00547417
005475******************************************************************00547517
005476 3010-GET-ENT-ID.                                                 00547617
005477                                                                  00547717
005478     MOVE SUT00102-PO-NBR TO DK-PO-NBR.                           00547817
005479                                                                  00547917
005480     EXEC SQL                                                     00548017
005481         SELECT ENT_ID                                            00548117
005482         INTO  :PURCHS-ENT-ID                                     00548217
005483         FROM   TPURCHS    PO1                                    00548317
005484         WHERE  PO1.PO_NBR = :DK-PO-NBR                           00548417
005485           AND  PO1.VER_NBR =                                     00548517
005486                     (                                            00548617
005487                      SELECT MAX(VER_NBR)                         00548717
005488                      FROM   TPURCHS   PO2                        00548817
005489                      WHERE  PO2.PO_NBR  =  PO1.PO_NBR            00548917
005490                     )                                            00549017
005491     END-EXEC.                                                    00549117
005492                                                                  00549217
005493     EVALUATE TRUE                                                00549317
005494       WHEN SQLCODE = ZEROS                                       00549417
005495           CONTINUE                                               00549517
005496       WHEN SQLCODE = +100                                        00549617
005497           MOVE +0 TO PURCHS-ENT-ID                               00549717
005498       WHEN OTHER                                                 00549817
005499             MOVE CA-USERID           TO PV-LOG-USER-ID           00549917
005500             MOVE SQLCODE             TO PV-SQLCODE               00550017
005501             PERFORM 9903-WRITE-CICS-LOG                          00550117
005505             MOVE PC-PROG-NAME      TO DP013-PROGRAM              00550517
005506             MOVE '3010-GET-ENT-ID' TO DP013-PARAGRAPH            00550617
005507             STRING PC-PROG-NAME                                  00550717
005508                    ' - UNABLE TO SELECT '                        00550817
005509                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00550917
005510             MOVE DK-PO-NBR          TO PV-PO-NBR-DISP-N          00551017
005511             STRING 'PO NBR: '                                    00551117
005512                    PV-PO-NBR-DISP-X                              00551217
005513                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (2) 00551317
005514             MOVE SQLCA              TO DP013-SQLCA               00551417
005515             MOVE 'TPURCHS'          TO DP013-DB2-TABLE-NAME (1)  00551517
005516             SET DP013-CICS-ABEND                                 00551617
005517                 DP013-ROLLBACK      TO TRUE                      00551717
005518             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00551817
005519             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLNO            00551917
005520             MOVE SPACES                    TO ACARTNO            00552017
005521                                               ARCVRO             00552117
005522                                               ACDESTO            00552217
005523                                               ARLSEO             00552317
005524             PERFORM 8010-SEND-MAP-DATA-ONLY                      00552417
005525             PERFORM 8100-RETURN-TRANID                           00552517
005526     END-EVALUATE.                                                00552617
005527/                                                                 00552717
005528******************************************************************00552817
005529*  3020-CHECK-IF-ONLY-ADD-SENT                                   *00552917
005530*     HAD ONLY THE ADD DIRECTIVE BEEN SENT AND THE AUDIT IS      *00553017
005531*     PASSED?  THIS WOULD BE THE CASE WHERE THE DELETE           *00553117
005532*     DIRECTIVES DID NOT GET SENT DUE TO A DB2 CONTENTION ISSUE. *00553217
005533******************************************************************00553317
005534 3020-CHECK-IF-ONLY-ADD-SENT.                                     00553417
005535                                                                  00553517
005536     SET PS-NOT-ADD-ONLY-DIRECTIVE TO TRUE.                       00553617
005537                                                                  00553717
005538     EXEC SQL                                                     00553817
005539         SELECT                                                   00553917
005540               A.BRCDE_NBR                                        00554017
005541              ,A.CRE_TMST                                         00554117
005542              ,A.OPER_UNT_ID                                      00554217
005543              ,A.DIRV_RSN_CDE                                     00554317
005544              ,A.LGCL_LOC_NM                                      00554417
005545              ,A.AUD_CNTL_NBR                                     00554517
005546              ,A.SHIPT_UNT_ID                                     00554617
005547              ,A.AUD_STAT_CDE                                     00554717
005548              ,A.PO_NBR                                           00554817
005549              ,A.RCVR_SEQ_NBR                                     00554917
005550              ,A.PO_LNE_NBR                                       00555017
005551              ,A.PREPK_ID                                         00555117
005552              ,A.STR_NBR                                          00555217
005553              ,A.CRE_PGM_NM                                       00555317
005554              ,A.ACKNL_SEQ_NBR                                    00555417
005555              ,A.CASI_CDE                                         00555517
005556              ,A.CART_STAT_CDE                                    00555617
005557              ,A.AUD_FALR_RSN_NM                                  00555717
005558              ,A.STR_ZN_ID                                        00555817
005559              ,A.SEASET_YR                                        00555917
005560              ,A.SEASET_SHRT_NM                                   00556017
005561              ,A.CNVYR_PRC_ACTN_NM                                00556117
005562              ,A.CRE_BY_USR_ID                                    00556217
005563              ,B.AUD_STAT_CDE                                     00556317
005564         INTO  :SUT00102-BRCDE-NBR                                00556417
005565              ,:SUT00102-CRE-TMST                                 00556517
005566              ,:SUT00102-OPER-UNT-ID                              00556617
005567              ,:SUT00102-DIRV-RSN-CDE                             00556717
005568              ,:SUT00102-LGCL-LOC-NM                              00556817
005569              ,:SUT00102-AUD-CNTL-NBR                             00556917
005570              ,:SUT00102-SHIPT-UNT-ID                             00557017
005571              ,:SUT00102-AUD-STAT-CDE                             00557117
005572              ,:SUT00102-PO-NBR                                   00557217
005573              ,:SUT00102-RCVR-SEQ-NBR                             00557317
005574              ,:SUT00102-PO-LNE-NBR                               00557417
005575              ,:SUT00102-PREPK-ID                                 00557517
005576              ,:SUT00102-STR-NBR                                  00557617
005577              ,:SUT00102-CRE-PGM-NM                               00557717
005578              ,:SUT00102-ACKNL-SEQ-NBR                            00557817
005579              ,:SUT00102-CASI-CDE         :DN-CASI-CDE            00557917
005580              ,:SUT00102-CART-STAT-CDE                            00558017
005581              ,:SUT00102-AUD-FALR-RSN-NM  :DN-AUD-FALR-RSN-NM     00558117
005582              ,:SUT00102-STR-ZN-ID        :DN-STR-ZN-ID           00558217
005583              ,:SUT00102-SEASET-YR        :DN-SEASET-YR           00558317
005584              ,:SUT00102-SEASET-SHRT-NM   :DN-SEASET-SHRT-NM      00558417
005585              ,:SUT00102-CNVYR-PRC-ACTN-NM                        00558517
005586              ,:SUT00102-CRE-BY-USR-ID                            00558617
005587              ,:SUT00015-AUD-STAT-CDE                             00558717
005588           FROM  SUT_CART_DIRV_TRKG  A                            00558817
005589              ,  SUT_PO_AUD_REQ      B                            00558917
005590          WHERE  A.BRCDE_NBR      = :DK-BRCDE-NBR                 00559017
005591*           AND  A.CNVYR_PRC_ACTN_NM NOT IN ('DELETE')            00559117
005592            AND  A.CRE_TMST       =                               00559217
005593                   ( SELECT MAX (C.CRE_TMST)                      00559317
005594                     FROM SUT_CART_DIRV_TRKG C                    00559417
005595                     WHERE C.BRCDE_NBR  =  A.BRCDE_NBR            00559517
005596                     )                                            00559617
005597            AND  A.DIRV_RSN_CDE IN ('AUQ','AUU')                  00559717
005598            AND  A.AUD_CNTL_NBR  = B.AUD_CNTL_NBR                 00559817
005599            AND  B.AUD_STAT_CDE IN ('N', 'P')                     00559917
005600     END-EXEC.                                                    00560017
005601                                                                  00560117
005602     EVALUATE TRUE                                                00560217
005603       WHEN SQLCODE = ZEROS                                       00560317
005604           SET PS-DIRECTIVE-RLSED                                 00560417
005605               PS-ADD-ONLY-DIRECTIVE TO TRUE                      00560517
005606       WHEN SQLCODE = +100                                        00560617
005607           SET PS-NO-DIRECTIVE-FOUND TO TRUE                      00560717
005608           MOVE PC-MSG004            TO AMSGLNO                   00560817
005610           MOVE SPACES               TO ARCVRO                    00561019
005611                                        ACDESTO                   00561119
005612                                        ARLSEO                    00561219
005614                                        CA-MAP-ARCVR              00561419
005615                                        CA-MAP-ACDEST             00561519
005616                                        CA-MAP-ARLSE              00561619
005618       WHEN OTHER                                                 00561817
005619             MOVE CA-USERID           TO PV-LOG-USER-ID           00561917
005620             MOVE SQLCODE             TO PV-SQLCODE               00562017
005621             PERFORM 9903-WRITE-CICS-LOG                          00562117
005622             MOVE PC-PROG-NAME               TO DP013-PROGRAM     00562217
005623             MOVE '3020-CHECK-IF-ONLY-ADD-SENT'                   00562317
005624                                       TO DP013-PARAGRAPH         00562417
005625             STRING PC-PROG-NAME                                  00562517
005626                    ' - UNABLE TO SELECT '                        00562617
005627                 DELIMITED BY SIZE   INTO DP013-MESSAGE-TEXT (1)  00562717
005628             STRING 'BARCODE : '                                  00562817
005629                    DK-BRCDE-NBR                                  00562917
005630                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (2) 00563017
005631             MOVE SQLCA                TO DP013-SQLCA             00563117
005632             MOVE 'SUT_CART_DIRV_TRKG' TO DP013-DB2-TABLE-NAME (1)00563217
005633             MOVE 'SUT_PO_AUD_REQ    ' TO DP013-DB2-TABLE-NAME (2)00563317
005634             SET DP013-CICS-ABEND                                 00563417
005635                 DP013-ROLLBACK        TO TRUE                    00563517
005636             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00563617
005637             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLNO            00563717
005638             MOVE SPACES                    TO ACARTNO            00563817
005639                                               ARCVRO             00563917
005640                                               ACDESTO            00564017
005641                                               ARLSEO             00564117
005642             PERFORM 8010-SEND-MAP-DATA-ONLY                      00564217
005643             PERFORM 8100-RETURN-TRANID                           00564317
005644     END-EVALUATE.                                                00564417
005650/                                                                 00565004
005700******************************************************************00570000
005701* 4000-FORMAT-RLSE-DIRECTIVE                                     *00570100
005702******************************************************************00570200
005703 4000-FORMAT-RLSE-DIRECTIVE.                                      00570300
005704                                                                  00570400
005705     INITIALIZE SU090-DG-REQUEST-COMMAREA.                        00570500
005706                                                                  00570600
005707     MOVE '00'                    TO SU090-RET-CODE.              00570700
005708                                                                  00570800
005710     MOVE 'RESEND'                TO SU090-CALLING-PGM.           00571004
005714                                                                  00571400
005715     SET  SU090-ONLINE            TO TRUE.                        00571500
005716     MOVE CA-LOCATION-NBR         TO SU090-OPER-UNT-ID.           00571600
005717                                                                  00571700
005718     IF ( ALL-CARTONS-DIRECTIVES-MODE )                           00571800
005719         SET SU090-ADD-ACTION     TO TRUE                         00571900
005720     ELSE                                                         00572000
005721         IF  SUT00102-DIRV-RSN-CDE = 'RLO'                        00572116
005722             SET SU090-ADD-ACTION TO TRUE                         00572216
005723         ELSE                                                     00572316
005724             SET SU090-DELETE-ACTION                              00572416
005725                                  TO TRUE                         00572516
005726     END-IF.                                                      00572616
005727                                                                  00572716
005728     SET SU090-CARTON-DIRECTIVE   TO TRUE.                        00572816
005729                                                                  00572916
005730     IF  PS-ADD-ONLY-DIRECTIVE                                    00573016
005731         IF  SUT00015-AUD-STAT-CDE = 'P'                          00573116
005732             MOVE 'AUP'           TO SU090-DIRV-RSN-CDE           00573216
005733             MOVE 'P'             TO SU090-AUD-STAT-CDE           00573316
005734         ELSE                                                     00573416
005735             MOVE 'AUN'           TO SU090-DIRV-RSN-CDE           00573516
005736             MOVE 'N'             TO SU090-AUD-STAT-CDE           00573616
005737         END-IF                                                   00573716
005738     ELSE                                                         00573816
005739         MOVE SUT00102-DIRV-RSN-CDE                               00573916
005740                                  TO SU090-DIRV-RSN-CDE           00574016
005741         MOVE SUT00102-AUD-STAT-CDE                               00574116
005742                                  TO SU090-AUD-STAT-CDE           00574216
005743     END-IF.                                                      00574316
005744                                                                  00574416
005745     EVALUATE TRUE                                                00574516
005746         WHEN SUT00102-SHIPT-UNT-ID > +0                          00574616
005747             MOVE 'S'                   TO SU090-BRCDE-TYP-CDE    00574716
005748             MOVE SUT00102-SHIPT-UNT-ID TO SU090-SML-BRCDE-NBR    00574816
005749             MOVE SPACES                TO SU090-P2L-BRCDE-NBR    00574916
005750         WHEN SUT00102-SHIPT-UNT-ID = +0                          00575016
005751             MOVE 'P'                   TO SU090-BRCDE-TYP-CDE    00575116
005752             MOVE ZEROS                 TO SU090-SML-BRCDE-NBR    00575216
005753             MOVE SUT00102-BRCDE-NBR    TO SU090-P2L-BRCDE-NBR    00575316
005754         WHEN OTHER                                               00575416
005755             MOVE ' '                   TO SU090-BRCDE-TYP-CDE    00575516
005756             MOVE ZEROS                 TO SU090-SML-BRCDE-NBR    00575616
005757             MOVE SPACES                TO SU090-P2L-BRCDE-NBR    00575716
005758     END-EVALUATE.                                                00575816
005759                                                                  00575916
005760     MOVE SUT00102-PO-NBR          TO SU090-PO-NBR.               00576016
005761     MOVE SUT00102-PO-LNE-NBR      TO SU090-PO-LNE-NBR.           00576116
005762     MOVE SUT00102-PREPK-ID        TO SU090-PO-PREPK-ID.          00576216
005763     MOVE SUT00102-RCVR-SEQ-NBR    TO SU090-RCVR-SEQ-NBR.         00576316
005764     MOVE SUT00102-CART-STAT-CDE   TO SU090-CART-STAT-CDE.        00576416
005765     MOVE SUT00102-AUD-CNTL-NBR    TO SU090-AUD-CNTL-NBR          00576516
005766     MOVE SUT00102-STR-NBR         TO SU090-STR-NBR.              00576616
005767     MOVE CA-USERID                TO SU090-ASSOC-ID.             00576716
005768*                                                                 00576816
005769* NULLABLE FIELDS                                                 00576916
005770*                                                                 00577016
005771     EVALUATE TRUE                                                00577116
005772         WHEN DN-CASI-CDE = +0                                    00577216
005773             MOVE SUT00102-CASI-CDE                               00577316
005774               TO SU090-CASI-CDE                                  00577416
005775         WHEN DN-AUD-FALR-RSN-NM = +0                             00577516
005776             MOVE SUT00102-AUD-FALR-RSN-NM                        00577616
005777               TO SU090-AUD-FAIL-RSN                              00577716
005778         WHEN DN-STR-ZN-ID = +0                                   00577816
005779             MOVE SUT00102-STR-ZN-ID                              00577916
005780               TO SU090-STR-ZN                                    00578016
005781         WHEN DN-SEASET-YR = +0                                   00578116
005782             MOVE SUT00102-SEASET-YR                              00578216
005783               TO SU090-SEASET-YR                                 00578316
005784         WHEN DN-SEASET-SHRT-NM = +0                              00578416
005785             MOVE SUT00102-SEASET-SHRT-NM                         00578516
005786               TO SU090-SEASET-CDE                                00578616
005787     END-EVALUATE.                                                00578716
005788                                                                  00578816
005789     IF  PS-ADD-ONLY-DIRECTIVE                                    00578916
005790         MOVE SPACES              TO SU090-CASI-CDE               00579016
005791     END-IF.                                                      00579116
005792                                                                  00579216
005793     INSPECT SU090-DG-REQUEST-COMMAREA                            00579316
005794         REPLACING ALL LOW-VALUES BY '?'.                         00579416
005795                                                                  00579516
005796     CALL PC-PROG-NAME-DDG USING DFHEIBLK                         00579616
005797                                 SU090-COMMAREA                   00579716
005798                                 SU090-DG-REQUEST-COMMAREA.       00579816
005799                                                                  00579916
005800     IF ( SU090-SUCCESS )                                         00580016
005801         MOVE PC-MSG005           TO AMSGLNO                      00580116
005802         MOVE SUT00102-PO-NBR     TO CA-MAP-PO                    00580216
005803         MOVE '-'                 TO CA-MAP-DASH                  00580316
005804         MOVE SUT00102-RCVR-SEQ-NBR                               00580416
005805                                  TO CA-MAP-RCVR-SEQ-NBR          00580516
005806         MOVE CA-MAP-ARCVR        TO ARCVRO                       00580616
005807         IF ( SU090-BRCDE-TYP-CDE = 'S' )                         00580716
005808             MOVE SUT00102-STR-NBR                                00580816
005809                                  TO CA-MAP-ACDEST-N              00580916
005810                                     ACDESTO                      00581016
005811         ELSE                                                     00581116
005812             MOVE 'P2L  '         TO CA-MAP-ACDEST                00581216
005813                                     ACDESTO                      00581316
005814         END-IF                                                   00581416
005815         IF  SU090-DIRV-RSN-CDE = 'AUP'                           00581516
005816             MOVE 'AUDIT PASSED        '                          00581616
005817                                  TO CA-MAP-ARLSE                 00581716
005818                                     ARLSEO                       00581816
005819         ELSE                                                     00581916
005820             IF  SU090-DIRV-RSN-CDE = 'AUN'                       00582016
005821                 MOVE 'AUD NO LONGER NEEDED'                      00582116
005822                                  TO CA-MAP-ARLSE                 00582216
005823                                     ARLSEO                       00582316
005824             ELSE                                                 00582416
005825                 IF  SU090-DIRV-RSN-CDE = 'RLF'                   00582521
005826                     MOVE 'CTN RELEASE MANUALLY'                  00582621
005827                                      TO CA-MAP-ARLSE             00582721
005828                                         ARLSEO                   00582821
005829                 ELSE                                             00582921
005830                     IF  SU090-DIRV-RSN-CDE = 'RLC'               00583021
005831                         MOVE 'CTN RELEASE BY AUDIT'              00583121
005832                                          TO CA-MAP-ARLSE         00583221
005833                                             ARLSEO               00583321
005834                     ELSE                                         00583421
005835                         MOVE 'CTN RELEASED ONLINE '              00583521
005836                                          TO CA-MAP-ARLSE         00583621
005837                                             ARLSEO               00583721
005838                     END-IF                                       00583821
005839                 END-IF                                           00583921
005840             END-IF                                               00584016
005841         END-IF                                                   00584116
005842     ELSE                                                         00584216
005843         MOVE PC-PROG-NAME                 TO DP013-PROGRAM       00584316
005844         MOVE '4000-FORMAT-RLSE-DIRECTIVE' TO DP013-PARAGRAPH     00584416
005845         STRING PC-PROG-NAME                                      00584516
005846                ' - CALL TO PGM SUKUT129 FAILED'                  00584616
005847             DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1)     00584716
005848         STRING 'RET-CODE = '   SU090-RET-CODE                    00584816
005849                ',PGM = '       SU090-ERR-PROGRAM                 00584916
005850                ',PARAGRAPH = ' SU090-ERR-PARAGRAPH               00585016
005851                ',ASSOC = '     SU090-ASSOC-ID                    00585116
005852                ',SML = '       SU090-SML-BRCDE-NBR               00585216
005853                ',P2L = '       SU090-P2L-BRCDE-NBR               00585316
005854             DELIMITED BY SIZE INTO DP013-MESSAGE-TEXT (2)        00585416
005855         MOVE SU090-SQLCA      TO DP013-SQLCA                     00585516
005856         SET DP013-CICS-ABEND                                     00585616
005857             DP013-ROLLBACK      TO TRUE                          00585716
005858         PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                   00585816
005859         MOVE SPACES                    TO ACARTNO                00585916
005860                                           ARCVRO                 00586016
005861                                           ACDESTO                00586116
005862                                           ARLSEO                 00586216
005863         EVALUATE TRUE                                            00586316
005864             WHEN SU090-PARAMETER-ERROR                           00586416
005865                 MOVE PC-DG-ERROR-PARM TO AMSGLNO                 00586516
005866             WHEN SU090-DB2-ERROR                                 00586616
005867                 MOVE PC-DG-ERROR-DB2  TO AMSGLNO                 00586716
005868             WHEN SU090-MQ-ERROR                                  00586816
005869                 MOVE PC-DG-ERROR-MQ   TO AMSGLNO                 00586916
005870             WHEN SU090-OTHER-ERROR                               00587016
005871                 MOVE PC-DG-ERROR-OTHR TO AMSGLNO                 00587116
005872         END-EVALUATE                                             00587216
005873         PERFORM 8010-SEND-MAP-DATA-ONLY                          00587316
005874         PERFORM 8100-RETURN-TRANID                               00587416
005875     END-IF.                                                      00587516
005876/                                                                 00587616
005877******************************************************************00587716
005878* 8000-SEND-MAP-ERASE                                            *00587816
005879******************************************************************00587916
005880 8000-SEND-MAP-ERASE.                                             00588016
005881                                                                  00588116
005882     MOVE -1 TO ACARTNL.                                          00588216
005883                                                                  00588316
005884     EXEC CICS SEND                                               00588416
005885               MAP    ('SU743A')                                  00588516
005886               MAPSET ('SUKM743')                                 00588616
005887               ERASE                                              00588716
005888               CURSOR                                             00588816
005889               RESP   (PV-CICS-RESPONSE)                          00588916
005890     END-EXEC.                                                    00589016
005891                                                                  00589116
005892     EVALUATE TRUE                                                00589216
005893         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00589316
005894             CONTINUE                                             00589416
005895         WHEN OTHER                                               00589516
005896             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00589616
005897             MOVE '8000-SEND-MAP-ERASE' TO DP013-PARAGRAPH        00589716
005898             STRING PC-PROG-NAME                                  00589816
005899                    ' - UNABLE TO SEND MAP'                       00589916
005900                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00590016
005901             SET DP013-CICS-ABEND                                 00590116
005902                 DP013-ROLLBACK         TO TRUE                   00590216
005903             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00590316
005904     END-EVALUATE.                                                00590416
005905/                                                                 00590516
005906******************************************************************00590616
005907* 8010-SEND-MAP-DATA-ONLY                                        *00590716
005908******************************************************************00590816
005909 8010-SEND-MAP-DATA-ONLY.                                         00590916
005910                                                                  00591016
005911     MOVE -1 TO ACARTNL.                                          00591116
005912                                                                  00591216
005913     EXEC CICS SEND                                               00591316
005914               MAP    ('SU743A')                                  00591416
005915               MAPSET ('SUKM743')                                 00591516
005916               CURSOR                                             00591616
005917               DATAONLY                                           00591716
005918               RESP   (PV-CICS-RESPONSE)                          00591816
005919     END-EXEC.                                                    00591916
005920                                                                  00592016
005921     EVALUATE TRUE                                                00592116
005922         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00592216
005923             CONTINUE                                             00592316
005924         WHEN OTHER                                               00592416
005925             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00592516
005926             MOVE '8010-SEND-MAP-DATA-ONLY'                       00592616
005927                                        TO DP013-PARAGRAPH        00592716
005928             STRING PC-PROG-NAME                                  00592816
005929                    ' - UNABLE TO SEND MAP'                       00592916
005930                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00593016
005931             SET DP013-CICS-ABEND                                 00593116
005932                 DP013-ROLLBACK         TO TRUE                   00593216
005933             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00593316
005934     END-EVALUATE.                                                00593416
005935/                                                                 00593516
005936******************************************************************00593616
005937* 8020-RECEIVE-MAP                                               *00593716
005938******************************************************************00593816
005939 8020-RECEIVE-MAP.                                                00593916
005940                                                                  00594016
005941     EXEC CICS RECEIVE                                            00594116
005942               MAP    ('SU743A')                                  00594216
005943               MAPSET ('SUKM743')                                 00594316
005944                RESP   (PV-CICS-RESPONSE)                         00594416
005945     END-EXEC.                                                    00594516
005946                                                                  00594616
005947     EVALUATE TRUE                                                00594716
005948         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00594816
005949             CONTINUE                                             00594916
005950         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                00595016
005951             CONTINUE                                             00595100
005952         WHEN OTHER                                               00595200
005960             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00596000
005970             MOVE '8020-RECEIVE-MAP'    TO DP013-PARAGRAPH        00597000
005980             STRING PC-PROG-NAME                                  00598000
005990                    ' - UNABLE TO RECEIVE MAP'                    00599000
006000                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00600000
006010             SET DP013-CICS-ABEND                                 00601000
006020                 DP013-ROLLBACK         TO TRUE                   00602000
006030            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                00603000
006040     END-EVALUATE.                                                00604000
006050/                                                                 00605000
006060******************************************************************00606000
006070* 8100-RETURN-TRANID                                             *00607000
006080******************************************************************00608000
006090 8100-RETURN-TRANID.                                              00609000
006100                                                                  00610000
006110     EXEC CICS RETURN                                             00611000
006120               TRANSID  (PC-TRANID)                               00612000
006130               COMMAREA (CA-COMMAREA)                             00613000
006140               LENGTH   (LENGTH OF CA-COMMAREA)                   00614000
006150               RESP     (PV-CICS-RESPONSE)                        00615000
006160     END-EXEC.                                                    00616000
006170                                                                  00617000
006180     EVALUATE TRUE                                                00618000
006190         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00619000
006200             CONTINUE                                             00620000
006210         WHEN OTHER                                               00621000
006220             MOVE PC-PROG-NAME          TO DP013-PROGRAM          00622000
006230             MOVE '8100-RETURN-TRANIND' TO DP013-PARAGRAPH        00623000
006240             STRING PC-PROG-NAME                                  00624000
006250                    ' - UNABLE TO RETURN TO TRANID'               00625000
006260                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00626000
006270             SET DP013-CICS-ABEND       TO TRUE                   00627000
006280             SET DP013-ROLLBACK         TO TRUE                   00628000
006290             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00629000
006300     END-EVALUATE.                                                00630000
006310/                                                                 00631000
006320******************************************************************00632000
006330* 8110-RETURN                                                    *00633000
006340******************************************************************00634000
006350 8110-RETURN.                                                     00635000
006360                                                                  00636000
006370     EXEC CICS SEND                                               00637000
006380               FROM   (PV-MESSAGE-AREA)                           00638000
006390               LENGTH (LENGTH OF PV-MESSAGE-AREA)                 00639000
006400               ERASE                                              00640000
006410     END-EXEC.                                                    00641000
006420                                                                  00642000
006430     EXEC CICS RETURN                                             00643000
006440     END-EXEC.                                                    00644000
006450/                                                                 00645000
006460******************************************************************00646000
006470* 8200-XCTL-TO-MENU                                              *00647000
006480******************************************************************00648000
006490 8200-XCTL-TO-MENU.                                               00649000
006500                                                                  00650000
006510     EXEC CICS XCTL                                               00651000
006520               PROGRAM   (PC-PROG-NAME-MENU)                      00652000
006530               COMMAREA  (SU001-COMMON-DATA)                      00653000
006540               LENGTH    (LENGTH OF SU001-COMMON-DATA)            00654000
006550               RESP      (PV-CICS-RESPONSE)                       00655000
006560     END-EXEC.                                                    00656000
006570                                                                  00657000
006580     EVALUATE TRUE                                                00658000
006590         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00659000
006600              CONTINUE                                            00660000
006610         WHEN OTHER                                               00661000
006620             MOVE PC-PROG-NAME        TO DP013-PROGRAM            00662000
006630             MOVE '8200-XCTL-TO-MENU' TO DP013-PARAGRAPH          00663000
006640             STRING PC-PROG-NAME                                  00664000
006650                    ' - UNABLE TO XCTL TO PROGRAM: '              00665000
006660                    PC-PROG-NAME-MENU                             00666000
006670                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00667000
006680             SET DP013-CICS-ABEND                                 00668000
006690                 DP013-ROLLBACK              TO TRUE              00669000
006700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00670000
006710             MOVE PC034-CICS-FATAL-ERROR-MSG TO AMSGLNO           00671000
006720             MOVE SPACES                     TO ACARTNO           00672000
006730                                                ARCVRO            00673000
006740                                                ACDESTO           00674000
006750                                                ARLSEO            00675000
006760             PERFORM 8010-SEND-MAP-DATA-ONLY                      00676000
006770             PERFORM 8100-RETURN-TRANID                           00677000
006780     END-EVALUATE.                                                00678000
006790/                                                                 00679000
006800******************************************************************00680000
006810* 8220-XCTL-TO-HELP                                              *00681000
006820******************************************************************00682000
006830 8220-XCTL-TO-HELP.                                               00683000
006840                                                                  00684000
006850     EXEC CICS XCTL                                               00685000
006860               PROGRAM   (PC-PROG-NAME-HELP)                      00686000
006870               COMMAREA  (PC192-COMMAREA)                         00687000
006880               LENGTH    (LENGTH OF PC192-COMMAREA)               00688000
006890               RESP      (PV-CICS-RESPONSE)                       00689000
006900     END-EXEC.                                                    00690000
006910                                                                  00691000
006920     EVALUATE TRUE                                                00692000
006930         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 00693000
006940              CONTINUE                                            00694000
006950         WHEN OTHER                                               00695000
006960             MOVE PC-PROG-NAME        TO DP013-PROGRAM            00696000
006970             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          00697000
006980             STRING PC-PROG-NAME                                  00698000
006990                    ' - UNABLE TO XCTL TO PROGRAM: '              00699000
007000                    PC-PROG-NAME-HELP                             00700000
007010                 DELIMITED BY SIZE    INTO DP013-MESSAGE-TEXT (1) 00701000
007020             SET DP013-CICS-ABEND                                 00702000
007030                 DP013-ROLLBACK              TO TRUE              00703000
007040             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               00704000
007050             MOVE PC034-CICS-FATAL-ERROR-MSG TO AMSGLNO           00705000
007060             MOVE SPACES                     TO ACARTNO           00706000
007070                                                ARCVRO            00707000
007080                                                ACDESTO           00708000
007090                                                ARLSEO            00709000
007100             PERFORM 8010-SEND-MAP-DATA-ONLY                      00710000
007110             PERFORM 8100-RETURN-TRANID                           00711000
007120     END-EVALUATE.                                                00712000
007130/                                                                 00713000
007131******************************************************************00713117
007132* 9903-WRITE-CICS-LOG.                                           *00713217
007133*                                                                *00713317
007134* WRITE THE SQLCODE ERROR MESSAGE LINE TO THE CICS LOG           *00713417
007135******************************************************************00713517
007136 9903-WRITE-CICS-LOG.                                             00713617
007137                                                                  00713717
007138     MOVE SQLCODE                     TO PV-SQLCODE               00713817
007139                                                                  00713917
007140     EXEC CICS                                                    00714017
007141         WRITEQ TD                                                00714117
007142             QUEUE  ('CSSL')                                      00714217
007143             FROM   (PV-LOG-MSG)                                  00714317
007144             RESP   (PV-CICS-RESPONSE)                            00714417
007145     END-EXEC.                                                    00714517
007146                                                                  00714617
007147/                                                                 00714717
007148******************************************************************00714817
007150* 9999-WRITE-MESSAGE-TO-CICS-LOG                                 *00715000
007160******************************************************************00716000
007170 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  00717000
007180                                                                  00718000
007190     MOVE PC-PROG-NAME     TO DP013-PROGRAM.                      00719000
007200     MOVE DFHEIBLK         TO DP013-DFHEIBLK.                     00720000
007210     INITIALIZE DP013-SRC-TASK-NUMBER                             00721000
007220                DP013-STACK.                                      00722000
007230     SET DP013-LINK-RETURN TO TRUE.                               00723000
007240                                                                  00724000
007250     EXEC CICS LINK                                               00725000
007260               PROGRAM   (DP013-NAME)                             00726000
007270               COMMAREA  (DP013-PARAMETERS)                       00727000
007280               LENGTH    (DP013-LENGTH)                           00728000
007290     END-EXEC.                                                    00729000
