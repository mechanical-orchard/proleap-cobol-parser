000100***************************************************************** 00010019
000200 IDENTIFICATION DIVISION.                                         00020019
000300***************************************************************** 00030019
000400 PROGRAM-ID.    XLKUT038.                                         00040019
000500 AUTHOR.        DEANNA BRANTNER.                                  00050019
000600 INSTALLATION.  KOHLS.                                            00060019
000700 DATE-WRITTEN   APRIL, 2003.                                      00070019
000800 DATE-COMPILED.                                                   00080019
000900***************************************************************** 00090019
001000*  THIS PROGRAM WILL REFORMAT THE EXTRACT FILES FOR TPURCHS,      00100019
001100*  TPURITM, TALLPLN, AND TMESTDS INTO ONE FILE FOR EASIER         00110019
001200*  PROCESSING BY XLKUT039 AND XLKUT040.                           00120019
001300* ****************************************************************00130019
001400* CHANGE DESCRIPTION                                              00140019
001401* ****************************************************************00140120
001410* 03/14/2012 AS PART OF THE INNER OUTER PACKAGING      * *        00141020
001420*    PROJECT, TWO FIELDS ADDED TO TPURITM TABLE.               * *00142020
001430*     (INNR_PK_QTY , OUTR_PK_QTY)                              * *00143020
001440*     PROGRAM CHANGES TO INCREASE FD TO 299                    * *00144020
001450* MADE BY: GERMAN BANDA                                           00145020
001500* ****************************************************************00150019
001600* DATE  05/12/2010                                                00160019
001700*  CHANGE MADE: ADDED A NEW IR INDICATOR(WHSE_RPLNT_IND) IN       00170019
001800*  TPURCHS TABLE UNDER IMPORT REPLENISHMENT PROJECT. CHANGES MADE 00180019
001900*  ACCORDINGLY FOR THE SAME.                                      00190019
002000* MADE BY: MONIKA SACHDEVA         TKID: TKMAW78                  00200019
002100* CHANGES TAGGED AS MS 05/12/2010                                 00210019
002200***************************************************************** 00220019
002300 ENVIRONMENT DIVISION.                                            00230019
002400 INPUT-OUTPUT SECTION.                                            00240019
002500                                                                  00250019
002600 FILE-CONTROL.                                                    00260019
002700                                                                  00270019
002800     SELECT TPURCHS-FILE                                          00280019
002900         ASSIGN TO INP01.                                         00290019
003000                                                                  00300019
003100     SELECT TPURITM-FILE                                          00310019
003200         ASSIGN TO INP02.                                         00320019
003300                                                                  00330019
003400     SELECT TALLPLN-FILE                                          00340019
003500         ASSIGN TO INP03.                                         00350019
003600                                                                  00360019
003700     SELECT TMESTDS-FILE                                          00370019
003800         ASSIGN TO INP04.                                         00380019
003900                                                                  00390019
004000     SELECT OUTPUT-FILE                                           00400019
004100         ASSIGN TO OUT01.                                         00410019
004200                                                                  00420019
004300***************************************************************** 00430019
004400 DATA DIVISION.                                                   00440019
004500***************************************************************** 00450019
004600 FILE SECTION.                                                    00460019
004700                                                                  00470019
004800 FD  TPURCHS-FILE                                                 00480019
004900     RECORDING MODE IS F                                          00490019
005000     BLOCK CONTAINS 0 RECORDS                                     00500019
005100     LABEL RECORDS ARE STANDARD.                                  00510019
005200                                                                  00520019
005300** CHANGE THE RECORD LENGTH TO ACCOMODATE THE NEW INDICATOR **    00530019
005400** MS 05/12/2010 BEG                                              00540019
005500*01  TPURCHS-RECORD               PIC X(481).                     00550019
005600 01  TPURCHS-RECORD               PIC X(482).                     00560019
005700** MS 05/12/2010 END                                              00570019
005800                                                                  00580019
005900 FD  TPURITM-FILE                                                 00590019
006000     RECORDING MODE IS F                                          00600019
006100     BLOCK CONTAINS 0 RECORDS                                     00610019
006200     LABEL RECORDS ARE STANDARD.                                  00620019
006300                                                                  00630019
006400 01  TPURITM-RECORD               PIC X(299).                     00640020
006500                                                                  00650019
006600 FD  TALLPLN-FILE                                                 00660019
006700     RECORDING MODE IS F                                          00670019
006800     BLOCK CONTAINS 0 RECORDS                                     00680019
006900     LABEL RECORDS ARE STANDARD.                                  00690019
007000                                                                  00700019
007100 01  TALLPLN-RECORD               PIC X(106).                     00710019
007200                                                                  00720019
007300 FD  TMESTDS-FILE                                                 00730019
007400     RECORDING MODE IS F                                          00740019
007500     BLOCK CONTAINS 0 RECORDS                                     00750019
007600     LABEL RECORDS ARE STANDARD.                                  00760019
007700                                                                  00770019
007800 01  TMESTDS-RECORD               PIC X(024).                     00780019
007900                                                                  00790019
008000 FD  OUTPUT-FILE                                                  00800019
008100     RECORDING MODE IS F                                          00810019
008200     BLOCK CONTAINS 0 RECORDS                                     00820019
008300     LABEL RECORDS ARE STANDARD.                                  00830019
008400                                                                  00840019
008500 01  OUTPUT-RECORD                PIC X(530).                     00850019
008600                                                                  00860019
008700***************************************************************** 00870019
008800 WORKING-STORAGE SECTION.                                         00880019
008900                                                                  00890019
009000 01  PS-PROGRAM-SWITCHES.                                         00900019
009100     05  PS-EOF-TPURCHS-SW            PIC X(01)  VALUE 'N'.       00910019
009200         88  PS-EOF-TPURCHS-YES                  VALUE 'Y'.       00920019
009300         88  PS-EOF-TPURCHS-NO                   VALUE 'N'.       00930019
009400     05  PS-EOF-TPURITM-SW            PIC X(01)  VALUE 'N'.       00940019
009500         88  PS-EOF-TPURITM-YES                  VALUE 'Y'.       00950019
009600         88  PS-EOF-TPURITM-NO                   VALUE 'N'.       00960019
009700     05  PS-EOF-TALLPLN-SW            PIC X(01)  VALUE 'N'.       00970019
009800         88  PS-EOF-TALLPLN-YES                  VALUE 'Y'.       00980019
009900         88  PS-EOF-TALLPLN-NO                   VALUE 'N'.       00990019
010000     05  PS-EOF-TMESTDS-SW            PIC X(01)  VALUE 'N'.       01000019
010100         88  PS-EOF-TMESTDS-YES                  VALUE 'Y'.       01010019
010200         88  PS-EOF-TMESTDS-NO                   VALUE 'N'.       01020019
010300     05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       01030019
010400         88  PS-FIRST-TIME                       VALUE 'Y'.       01040019
010500         88  PS-NOT-FIRST-TIME                   VALUE 'N'.       01050019
010600                                                                  01060019
010700 01  PC-PROGRAM-CONSTANTS.                                        01070019
010800     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT038'.01080019
010900                                                                  01090019
011000 01  PV-PROGRAM-VARIABLES.                                        01100019
011100     05  PV-RECS-READ-TPURCHS         PIC  9(09) VALUE  0.        01110019
011200     05  PV-RECS-READ-TPURITM         PIC  9(09) VALUE  0.        01120019
011300     05  PV-RECS-READ-TALLPLN         PIC  9(09) VALUE  0.        01130019
011400     05  PV-RECS-READ-TMESTDS         PIC  9(09) VALUE  0.        01140019
011500     05  PV-OUTPUTS-WRITTEN           PIC  9(09) VALUE  0.        01150019
011600                                                                  01160019
011700 01  PV-ABEND-FIELDS.                                             01170019
011800     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT038'.01180019
011900     05  FILLER                       PIC  X(01) VALUE SPACES.    01190019
012000     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    01200019
012100     05  FILLER                       PIC  X(01) VALUE SPACES.    01210019
012200     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01220019
012300     05  FILLER                       PIC  X(01) VALUE SPACES.    01230019
012400     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01240019
012500                                                                  01250019
012600***********************************************************       01260019
012700*  COPYBOOK USED FOR THE TPURCHS INPUT FILE               *       01270019
012800***********************************************************       01280019
012900     EXEC SQL                                                     01290019
013000         INCLUDE TPURCHS                                          01300019
013100     END-EXEC.                                                    01310019
013200                                                                  01320019
013300***********************************************************       01330019
013400*  COPYBOOK USED FOR THE TPURITM INPUT FILE               *       01340019
013500***********************************************************       01350019
013600     EXEC SQL                                                     01360019
013700         INCLUDE TPURITM                                          01370019
013800     END-EXEC.                                                    01380019
013900                                                                  01390019
014000***********************************************************       01400019
014100*  COPYBOOK USED FOR THE TALLPLN INPUT FILE               *       01410019
014200***********************************************************       01420019
014300     EXEC SQL                                                     01430019
014400         INCLUDE TALLPLN                                          01440019
014500     END-EXEC.                                                    01450019
014600                                                                  01460019
014700***********************************************************       01470019
014800*  COPYBOOK USED FOR THE TMESTDS INPUT FILE               *       01480019
014900***********************************************************       01490019
015000     EXEC SQL                                                     01500019
015100         INCLUDE TMESTDS                                          01510019
015200     END-EXEC.                                                    01520019
015300                                                                  01530019
015400***********************************************************       01540019
015500*  COPYBOOK USED FOR THE OUTPUT FILE                              01550019
015600***********************************************************       01560019
015700 01  PC-OUTPUT-RECORD.                                            01570019
015800     COPY XLRD029.                                                01580019
015900                                                                  01590019
016000***************************************************************** 01600019
016100 PROCEDURE DIVISION.                                              01610019
016200***************************************************************** 01620019
016300     DISPLAY '**** BEGINNING XLKUT038 ****'.                      01630019
016400     DISPLAY ' '.                                                 01640019
016500                                                                  01650019
016600     OPEN INPUT  TPURCHS-FILE                                     01660019
016700                 TPURITM-FILE                                     01670019
016800                 TALLPLN-FILE                                     01680019
016900                 TMESTDS-FILE                                     01690019
017000          OUTPUT OUTPUT-FILE.                                     01700019
017100                                                                  01710019
017200     PERFORM 1000-PROCESS-INPUT-FILE                              01720019
017300       UNTIL PS-EOF-TMESTDS-YES.                                  01730019
017400                                                                  01740019
017500     DISPLAY '   INPUT TPURCHS RECS    = ' PV-RECS-READ-TPURCHS.  01750019
017600     DISPLAY '   INPUT TPURITM RECS    = ' PV-RECS-READ-TPURITM.  01760019
017700     DISPLAY '   INPUT TALLPLN RECS    = ' PV-RECS-READ-TALLPLN.  01770019
017800     DISPLAY '   INPUT TMESTDS RECS    = ' PV-RECS-READ-TMESTDS.  01780019
017900     DISPLAY '  OUTPUT XLRD029 RECS    = ' PV-OUTPUTS-WRITTEN.    01790019
018000     DISPLAY ' '.                                                 01800019
018100     DISPLAY '****  END OF  XLKUT038  ****'.                      01810019
018200                                                                  01820019
018300     GOBACK.                                                      01830019
018400                                                                  01840019
018500***************************************************************** 01850019
018600*  PROCESS INPUT FILE                                           * 01860019
018700***************************************************************** 01870019
018800 1000-PROCESS-INPUT-FILE.                                         01880019
018900                                                                  01890019
019000     MOVE '1000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       01900019
019100                                                                  01910019
019200     PERFORM 2000-READ-TPURCHS-INPUT-FILE UNTIL                   01920019
019300                                   PS-EOF-TPURCHS-YES.            01930019
019400     CLOSE TPURCHS-FILE.                                          01940019
019500                                                                  01950019
019600     PERFORM 3000-READ-TPURITM-INPUT-FILE UNTIL                   01960019
019700                                   PS-EOF-TPURITM-YES.            01970019
019800     CLOSE TPURITM-FILE.                                          01980019
019900                                                                  01990019
020000     PERFORM 4000-READ-TALLPLN-INPUT-FILE UNTIL                   02000019
020100                                   PS-EOF-TALLPLN-YES.            02010019
020200     CLOSE TALLPLN-FILE.                                          02020019
020300                                                                  02030019
020400     PERFORM 5000-READ-TMESTDS-INPUT-FILE UNTIL                   02040019
020500                                   PS-EOF-TMESTDS-YES.            02050019
020600     CLOSE TMESTDS-FILE.                                          02060019
020700                                                                  02070019
020800***************************************************************** 02080019
020900*  READ A TPURCHS RECORD                                          02090019
021000***************************************************************** 02100019
021100 2000-READ-TPURCHS-INPUT-FILE.                                    02110019
021200                                                                  02120019
021300     MOVE '2000-READ-TPURCHS-INPUT-FILE' TO PV-ABEND-PARAGRAPH.   02130019
021400                                                                  02140019
021500     INITIALIZE XL029-DATA.                                       02150019
021600     INITIALIZE DCLTPURCHS.                                       02160019
021700                                                                  02170019
021800     READ TPURCHS-FILE                                            02180019
021900          INTO DCLTPURCHS                                         02190019
022000            AT END                                                02200019
022100               SET PS-EOF-TPURCHS-YES TO TRUE                     02210019
022200     END-READ.                                                    02220019
022300                                                                  02230019
022400     IF PS-EOF-TPURCHS-YES                                        02240019
022500        CONTINUE                                                  02250019
022600     ELSE                                                         02260019
022700        MOVE PURCHS-PO-NBR TO XL029-PO-NBR                        02270019
022800        MOVE ZEROES        TO XL029-PO-LNE-NBR                    02280019
022900        MOVE '1'           TO XL029-RECORD-TYPE                   02290019
023000        MOVE DCLTPURCHS    TO XL029-DATA-AREA                     02300019
023100        ADD +1             TO PV-RECS-READ-TPURCHS                02310019
023200        PERFORM 7000-WRITE-OUTPUT                                 02320019
023300     END-IF.                                                      02330019
023400                                                                  02340019
023500***************************************************************** 02350019
023600*  READ A TPURITM RECORD                                          02360019
023700***************************************************************** 02370019
023800 3000-READ-TPURITM-INPUT-FILE.                                    02380019
023900                                                                  02390019
024000     MOVE '3000-READ-TPURITM-INPUT-FILE' TO PV-ABEND-PARAGRAPH.   02400019
024100                                                                  02410019
024200     INITIALIZE XL029-DATA.                                       02420019
024300     INITIALIZE DCLTPURITM.                                       02430019
024400                                                                  02440019
024500     READ TPURITM-FILE                                            02450019
024600          INTO DCLTPURITM                                         02460019
024700            AT END                                                02470019
024800               SET PS-EOF-TPURITM-YES TO TRUE                     02480019
024900     END-READ.                                                    02490019
025000                                                                  02500019
025100     IF PS-EOF-TPURITM-YES                                        02510019
025200        CONTINUE                                                  02520019
025300     ELSE                                                         02530019
025400        MOVE PURITM-PO-NBR      TO XL029-PO-NBR                   02540019
025500        MOVE PURITM-PO-LNE-NBR  TO XL029-PO-LNE-NBR               02550019
025600        MOVE '2'                TO XL029-RECORD-TYPE              02560019
025700        MOVE DCLTPURITM         TO XL029-DATA-AREA                02570019
025800        ADD +1                  TO PV-RECS-READ-TPURITM           02580019
025900        PERFORM 7000-WRITE-OUTPUT                                 02590019
026000     END-IF.                                                      02600019
026100                                                                  02610019
026200***************************************************************** 02620019
026300*  READ A TALLPLN RECORD                                          02630019
026400***************************************************************** 02640019
026500 4000-READ-TALLPLN-INPUT-FILE.                                    02650019
026600                                                                  02660019
026700     MOVE '4000-READ-TALLPLN-INPUT-FILE' TO PV-ABEND-PARAGRAPH.   02670019
026800                                                                  02680019
026900     INITIALIZE XL029-DATA.                                       02690019
027000     INITIALIZE DCLTALLPLN.                                       02700019
027100                                                                  02710019
027200     READ TALLPLN-FILE                                            02720019
027300          INTO DCLTALLPLN                                         02730019
027400            AT END                                                02740019
027500               SET PS-EOF-TALLPLN-YES TO TRUE                     02750019
027600     END-READ.                                                    02760019
027700                                                                  02770019
027800     IF PS-EOF-TALLPLN-YES                                        02780019
027900        CONTINUE                                                  02790019
028000     ELSE                                                         02800019
028100        MOVE ALLPLN-PO-NBR      TO XL029-PO-NBR                   02810019
028200        MOVE ALLPLN-PO-LNE-NBR  TO XL029-PO-LNE-NBR               02820019
028300        MOVE '3'                TO XL029-RECORD-TYPE              02830019
028400        MOVE DCLTALLPLN         TO XL029-DATA-AREA                02840019
028500        ADD +1                  TO PV-RECS-READ-TALLPLN           02850019
028600        PERFORM 7000-WRITE-OUTPUT                                 02860019
028700     END-IF.                                                      02870019
028800                                                                  02880019
028900***************************************************************** 02890019
029000*  READ A TMESTDS RECORD                                          02900019
029100***************************************************************** 02910019
029200 5000-READ-TMESTDS-INPUT-FILE.                                    02920019
029300                                                                  02930019
029400     MOVE '5000-READ-TMESTDS-INPUT-FILE' TO PV-ABEND-PARAGRAPH.   02940019
029500                                                                  02950019
029600     INITIALIZE XL029-DATA.                                       02960019
029700     INITIALIZE DCLTMESTDS.                                       02970019
029800                                                                  02980019
029900     READ TMESTDS-FILE                                            02990019
030000          INTO DCLTMESTDS                                         03000019
030100            AT END                                                03010019
030200               SET PS-EOF-TMESTDS-YES TO TRUE                     03020019
030300     END-READ.                                                    03030019
030400                                                                  03040019
030500     IF PS-EOF-TMESTDS-YES                                        03050019
030600        CONTINUE                                                  03060019
030700     ELSE                                                         03070019
030800        MOVE MESTDS-PO-NBR      TO XL029-PO-NBR                   03080019
030900        MOVE MESTDS-PO-LNE-NBR  TO XL029-PO-LNE-NBR               03090019
031000        MOVE '4'                TO XL029-RECORD-TYPE              03100019
031100        MOVE DCLTMESTDS         TO XL029-DATA-AREA                03110019
031200        ADD +1                  TO PV-RECS-READ-TMESTDS           03120019
031300        PERFORM 7000-WRITE-OUTPUT                                 03130019
031400     END-IF.                                                      03140019
031500                                                                  03150019
031600***************************************************************** 03160019
031700*  WRITE A RECORDS TO THE LOGISTICS SKU OUTPUT FILE             * 03170019
031800***************************************************************** 03180019
031900 7000-WRITE-OUTPUT.                                               03190019
032000                                                                  03200019
032100     WRITE OUTPUT-RECORD FROM                                     03210019
032200         XL029-DATA                                               03220019
032300     END-WRITE.                                                   03230019
032400     ADD +1                 TO PV-OUTPUTS-WRITTEN.                03240019
032500                                                                  03250019
