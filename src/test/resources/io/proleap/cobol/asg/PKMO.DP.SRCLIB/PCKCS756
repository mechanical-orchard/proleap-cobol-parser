000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             PCKCS756.                                00040000
000500 AUTHOR.                 LARRY SCHLEICHER.                        00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060000
000700 DATE-WRITTEN            DEC, 2001.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000* THIS PROGRAM IS A MODULE USED IN THE UNITS WORKED APPLICATION.  00100000
001100* IT WILL:                                                        00110000
001200*    -  DETERMINE THE BUSINESS DATE AND SHIFT BASED ON THE        00120000
001300*       TRANSACTION TIMESTAMP AND DC NUMBER                       00130000
001400*    -  DETERMINE WHAT HAS BEEN PREVIOUSLY POSTED TO THE UNITS    00140000
001500*       WORKED DATABASES FOR CONFIRMATION, UPLOADED P2L           00150000
001600*       TRANSACTIONS AND/OR VERIFICATION                          00160000
001700*    -  UPDATE OR INSERT ROWS IN THE ON THE UNITS WORKED DATABASES00170000
001800******************************************************************00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000 DATA DIVISION.                                                   00200000
002100******************************************************************00210000
002200 WORKING-STORAGE SECTION.                                         00220000
002300                                                                  00230000
002400 01  DK-DB2-KEYS.                                                 00240000
002500     05  DK-PO-NBR                PIC S9(09)  COMP.               00250000
002600     05  DK-PO-LINE-NBR           PIC S9(09)  COMP.               00260000
002700     05  DK-OPER-UNT-ID           PIC S9(04)  COMP.               00270000
002800     05  DK-RCVR-SEQ-NBR          PIC S9(09)  COMP.               00280000
002900     05  DK-BUS-DTE               PIC  X(10).                     00290000
003000     05  DK-SHIFT-NBR             PIC S9(04)  COMP.               00300000
003100     05  DK-PRCG-AREA-CDE         PIC  X(06).                     00310000
003200                                                                  00320000
003300*----------------------------------------------------------------*00330000
003400* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00340000
003500*----------------------------------------------------------------*00350000
003600     COPY PCWS238.                                                00360000
003700                                                                  00370000
003800* WORK AREA FOR RCKUT061                                          00380000
003900     COPY RCWS033.                                                00390000
004000/                                                                 00400000
004100******************************************************************00410000
004200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00420000
004300******************************************************************00430000
004400     COPY DPWS013.                                                00440000
004500                                                                  00450000
004600*----------------------------------------------------------------*00460000
004700*  PROGRAM CONSTANTS                                             *00470000
004800*----------------------------------------------------------------*00480000
004900 01  PC-PROGRAM-CONSTANTS.                                        00490000
005000     05  PC-F                     PIC  X(01)  VALUE 'F'.          00500000
005100     05  PC-I                     PIC  X(01)  VALUE 'I'.          00510000
005200     05  PC-N                     PIC  X(01)  VALUE 'N'.          00520000
005300                                                                  00530000
005400     05  PC-P                     PIC  X(01)  VALUE 'P'.          00540000
005410     05  PC-Q                     PIC  X(01)  VALUE 'Q'.          00541000
005420     05  PC-C                     PIC  X(01)  VALUE 'C'.          00542000
005430     05  PC-U                     PIC  X(01)  VALUE 'U'.          00543000
005440     05  PC-A                     PIC  X(01)  VALUE 'A'.          00544000
005450     05  PC-V                     PIC  X(01)  VALUE 'V'.          00545000
005460     05  PC-X                     PIC  X(01)  VALUE 'X'.          00546000
005470     05  PC-B                     PIC  X(01)  VALUE 'B'.          00547000
005480     05  PC-D                     PIC  X(01)  VALUE 'D'.          00548000
005490     05  PC-W                     PIC  X(01)  VALUE 'W'.          00549000
005500     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00550000
005600                                                                  00560000
005700     05  PC-IP                    PIC  X(02)  VALUE 'IP'.         00570000
005800     05  PC-02                    PIC  X(02)  VALUE '02'.         00580000
005900     05  PC-3                     PIC  S9(4) COMP  VALUE 3.       00590000
006000     05  PC-DEFAULT               PIC  X(06)  VALUE 'DEFALT'.     00600000
006100     05  PC-DEFAULT-DATE          PIC  X(26)  VALUE               00610000
006200                                  '9999-09-09-09.09.09.999999'.   00620000
006300     05  PC-LOG-QUEUE             PIC  X(04)  VALUE 'CSSL'.       00630000
006400     05  PC-MSG-TABLE-SIZE        PIC S9(03) COMP-3 VALUE 200.    00640000
006500     05  PC-END-TM                PIC  X(08) VALUE '24.00.00'.    00650000
006510     05  PC-BEG-TM                PIC  X(08) VALUE '00.00.00'.    00651003
006600     05  PC-PROCESS-AREA-PGM      PIC  X(08) VALUE 'RCKUT061'.    00660000
006700     05  PC-VERIFY-ADJUST-PGM     PIC  X(08) VALUE 'PCKCS759'.    00670000
006800     05  PC-DISPLAY-PO                PIC 9(8)   VALUE ZEROS.     00680000
006900     05  PC-DISPLAY-RCVR              PIC 9(8)   VALUE ZEROS.     00690000
007000     05  PC-DISPLAY-LINE              PIC 9(8)   VALUE ZEROS.     00700000
007100     05  PC-DISPLAY-OPER              PIC 9(4)   VALUE ZEROS.     00710000
007200                                                                  00720000
007300*----------------------------------------------------------------*00730000
007400*  PROGRAM SWITCHES                                              *00740000
007500*----------------------------------------------------------------*00750000
007600 01  PS-PROGRAM-SWITCHES.                                         00760000
007700     05  PS-END-OF-RET-PRICE-CSR-SW      PIC  X(01)  VALUE 'N'.   00770000
007800         88  PS-NOT-END-OF-RET-PRICE-CSR             VALUE 'N'.   00780000
007900         88  PS-END-OF-RET-PRICE-CSR                 VALUE 'Y'.   00790000
008000     05  PS-WORK-STARTED-SW              PIC  X(01)  VALUE 'N'.   00800000
008100         88  PS-NO-WORK-STARTED                      VALUE 'N'.   00810000
008200         88  PS-WORK-STARTED                         VALUE 'Y'.   00820000
008300     05  PS-SHOW-DEBUG-SW                PIC  X(01)  VALUE 'N'.   00830000
008400         88  PS-DONT-SHOW-DEBUG-INFO                 VALUE 'N'.   00840000
008500         88  PS-SHOW-DEBUG-INFO                      VALUE 'Y'.   00850000
008600     05  PS-REQ-REC-FOUND-SW             PIC  X(01)  VALUE 'N'.   00860000
008700         88  PS-REQ-REC-FOUND                        VALUE 'Y'.   00870000
008800         88  PS-NO-REQ-REC-FOUND                     VALUE 'N'.   00880000
008900     05  PS-NO-AUDIT-STARTED-SW          PIC  X(01)  VALUE 'N'.   00890000
009000         88  PS-AUDIT-STARTED                        VALUE 'Y'.   00900000
009100         88  PS-NO-AUDIT-STARTED                     VALUE 'N'.   00910000
009200     05  PS-BK-AUDIT-STARTED-SW          PIC  X(01)  VALUE 'N'.   00920000
009300         88  PS-BK-AUDIT-STARTED                     VALUE 'Y'.   00930000
009400         88  PS-NO-BK-AUDIT-STARTED                  VALUE 'N'.   00940000
009500     05  PS-PP-AUDIT-STARTED-SW          PIC  X(01)  VALUE 'N'.   00950000
009600         88  PS-PP-AUDIT-STARTED                     VALUE 'Y'.   00960000
009700         88  PS-NO-PP-AUDIT-STARTED                  VALUE 'N'.   00970000
009800     05  PS-PS-AUDIT-STARTED-SW          PIC  X(01)  VALUE 'N'.   00980000
009900         88  PS-PS-AUDIT-STARTED                     VALUE 'Y'.   00990000
010000         88  PS-NO-PS-AUDIT-STARTED                  VALUE 'N'.   01000000
010100     05  PS-PO-FAILED-FOUND-SW           PIC  X(01)  VALUE 'N'.   01010000
010200         88  PS-PO-FAILED-FOUND                      VALUE 'Y'.   01020000
010300         88  PS-NO-PO-FAILED-FOUND                   VALUE 'N'.   01030000
010400     05  PS-DEPT-RANK-FOUND-SW           PIC  X(01)  VALUE 'N'.   01040000
010500         88  PS-DEPT-RANK-FOUND                      VALUE 'Y'.   01050000
010600         88  PS-NO-DEPT-RANK-FOUND                   VALUE 'N'.   01060000
010700     05  PS-PASSED-AUDITS-FOUND-SW       PIC  X(01)  VALUE 'N'.   01070000
010800         88  PS-PASSED-AUDITS-FOUND                  VALUE 'Y'.   01080000
010900         88  PS-NO-PASSED-AUDITS-FOUND               VALUE 'N'.   01090000
011000     05  PS-FAILED-AUDITS-FOUND-SW       PIC  X(01)  VALUE 'N'.   01100000
011100         88  PS-FAILED-AUDITS-FOUND                  VALUE 'Y'.   01110000
011200         88  PS-NO-FAILED-AUDITS-FOUND               VALUE 'N'.   01120000
011300     05  PS-AUDIT-NBR-IND                PIC  X(01)  VALUE 'N'.   01130000
011400         88  PS-AUDIT-NBR-EXISTS                     VALUE 'Y'.   01140000
011500         88  PS-AUDIT-NBR-NOT-EXISTS                 VALUE 'N'.   01150000
011600     05  PS-VEND-RANK-FOUND-SW           PIC  X(01)  VALUE 'N'.   01160000
011700         88  PS-VEND-RANK-FOUND                      VALUE 'Y'.   01170000
011800         88  PS-NO-VEND-RANK-FOUND                   VALUE 'N'.   01180000
011900     05  PS-DEFAULT-RANK-FOUND-SW        PIC  X(01)  VALUE 'N'.   01190000
012000         88  PS-DEFAULT-RANK-FOUND                   VALUE 'Y'.   01200000
012100         88  PS-NO-DEFAULT-RANK-FOUND                VALUE 'N'.   01210000
012200     05  PS-VEND-DEPT-FOUND-SW           PIC  X(01)  VALUE 'N'.   01220000
012300         88  PS-VEND-DEPT-FOUND                      VALUE 'Y'.   01230000
012400         88  PS-NO-VEND-DEPT-FOUND                   VALUE 'N'.   01240000
012500     05  PS-PO-INFO-FOUND-SW             PIC  X(01)  VALUE 'N'.   01250000
012600         88  PS-PO-INFO-FOUND                        VALUE 'Y'.   01260000
012700         88  PS-NO-PO-INFO-FOUND                     VALUE 'N'.   01270000
012800     05  PS-LINE-LEVEL-FOUND-SW          PIC  X(01)  VALUE 'N'.   01280000
012900         88  PS-LINE-LEVEL-FOUND                     VALUE 'Y'.   01290000
013000         88  PS-NO-LINE-LEVEL-FOUND                  VALUE 'N'.   01300000
013100     05  PS-PO-LEVEL-FOUND-SW            PIC  X(01)  VALUE 'N'.   01310000
013200         88  PS-PO-LEVEL-FOUND                       VALUE 'Y'.   01320000
013300         88  PS-NO-PO-LEVEL-FOUND                    VALUE 'N'.   01330000
013400     05  PS-AUDIT-IS-REQUIRED-SW         PIC  X(01)  VALUE 'N'.   01340000
013500         88  PS-AUDIT-IS-REQUIRED                    VALUE 'Y'.   01350000
013600         88  PS-AUDIT-IS-NOT-REQUIRED                VALUE 'N'.   01360000
013700     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01370000
013800         88  PS-ERROR                                VALUE 'Y'.   01380000
013900         88  PS-ERROR-NO                             VALUE 'N'.   01390000
014000     05  PS-INACTIVE-CRTN-FND-SW         PIC  X(01)  VALUE 'N'.   01400000
014100         88  PS-INACTIVE-CRTN-FND                    VALUE 'Y'.   01410000
014200     05  PS-PROCESS-RMS-INTERFACE-SW     PIC  X(01)  VALUE 'N'.   01420000
014300         88  PS-PROCESS-RMS-INTERFACE-YES            VALUE 'Y'.   01430000
014400         88  PS-PROCESS-RMS-INTERFACE-NO             VALUE 'N'.   01440000
014410     05  PS-CHECK-OVERLAPPING-SHFTS-SW   PIC  X(01)  VALUE 'Y'.   01441001
014420         88  PS-CONTINUE-CHECKING                    VALUE 'Y'.   01442001
014430         88  PS-DONE-CHECKING                        VALUE 'N'.   01443001
014440     05  PS-POST-UNITS-WORKED-SW         PIC  X(01)  VALUE ' '.   01444029
014450         88  PS-POST-UNITS-WORKED-YES                VALUE 'Y'.   01445030
014460         88  PS-POST-UNITS-WORKED-NO                 VALUE 'N'.   01446030
014500                                                                  01450000
014600*----------------------------------------------------------------*01460000
014700*  PROGRAM VARIABLES                                             *01470000
014800*----------------------------------------------------------------*01480000
014900 01  PV-PROGRAM-VARIABLES.                                        01490000
015000                                                                  01500000
015100     05  PV-DISPLAY-PO-NBR               PIC 999999999-.          01510000
015200     05  PV-DISPLAY-PO-LINE-NBR          PIC 999999999-.          01520000
015300     05  PV-DISPLAY-PREPK-ID             PIC 9999-.               01530000
015400     05  PV-DISPLAY-OPER-UNT-ID          PIC 9999-.               01540000
015500     05  PV-DISPLAY-INBND-TRIP-ID        PIC 999999999-.          01550000
015600     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 999999999-.          01560000
015700     05  PV-DISPLAY-SHIPT-UNT-ID         PIC 999999999999999999-. 01570000
015800     05  PV-DISPLAY-ENT-ID               PIC 999999999-.          01580000
015900     05  PV-DISPLAY-DEPT-NBR             PIC 9999-.               01590000
016000     05  PV-DISPLAY-CK-AFT-DAY-QTY       PIC 9999-.               01600000
016100     05  PV-DISPLAY-LIMIT-DAYS           PIC 999999999-.          01610000
016200     05  PV-DISPLAY-SHIFT                PIC 9999-.               01620000
016300                                                                  01630000
016400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACES.01640000
016500                                                                  01650000
016600     05  PV-CICS-MSG-AREA3               PIC  X(100) VALUE SPACES.01660000
016700                                                                  01670000
016800     05  PV-PASSED-COUNT                 PIC S9(4)  COMP.         01680000
016900     05  PV-DB2-COUNT-EXP-SCN            PIC S9(4)  VALUE +0      01690000
017000                                                    COMP.         01700000
017100     05  PV-CARTONS-TO-AUDIT             PIC S9(9)  VALUE +0      01710000
017200                                                    COMP.         01720000
017300     05  PV-UNITS-TO-AUDIT               PIC S9(9)  VALUE +0      01730000
017400                                                    COMP.         01740000
017500     05  PV-TOTAL-CARTONS                PIC S9(9)  VALUE +0      01750000
017600                                                    COMP.         01760000
017700     05  PV-TOTAL-UNITS                  PIC S9(9)  VALUE +0      01770000
017800                                                    COMP.         01780000
017900     05  PV-TOTAL-AP-VERIFY-QTY          PIC S9(15) VALUE +0      01790000
018000                                                    COMP.         01800000
018100     05  PV-SUM-EXPTD-ALLOC              PIC S9(9)  VALUE +0      01810000
018200                                                    COMP.         01820000
018300     05  PV-SUM-OF-ALL-LINES             PIC S9(9)  VALUE +0      01830000
018400                                                    COMP.         01840000
018500     05  PV-SUM-UNIT-QTY                 PIC S9(09) VALUE +0      01850000
018600                                                    COMP.         01860000
018700     05  PV-SUM-CART-QTY                 PIC S9(09) VALUE +0      01870000
018800                                                    COMP.         01880000
018900     05  PV-SUM-EXTENDED-RETAIL          PIC S9(09)V9(2) VALUE +0 01890000
019000                                                    COMP-3.       01900000
019100     05  PV-UPDT-UNIT-QTY                PIC S9(09) VALUE +0      01910000
019200                                                    COMP.         01920000
019300     05  PV-UPDT-CART-QTY                PIC S9(09) VALUE +0      01930000
019400                                                    COMP.         01940000
019410     05  PV-UPDT-EXTD-RTL                PIC S9(09)V9(2) VALUE +0 01941000
019420                                                    COMP-3.       01942000
019430     05  PV-RCVR-WRKD-QTY                PIC S9(09) VALUE +0      01943000
019440                                                    COMP.         01944000
019450     05  PV-SUM-ACTUAL-CARTON-COUNT      PIC S9(04) VALUE +0      01945000
019460                                                    COMP.         01946000
019470     05  PV-SUM-AP-VERIFY-QTY            PIC S9(09) VALUE +0      01947000
019480                                                    COMP.         01948000
019490     05  PV-UPDATE-QTY                   PIC S9(09) VALUE +0      01949000
019500                                                    COMP.         01950000
019600     05  PV-LINE-RETAIL                  PIC S9(15)V9(2) VALUE +0 01960000
019700                                                    COMP.         01970000
019800     05  PV-TOTAL-RECEIVER-RETAIL        PIC S9(15)V9(2) VALUE +0 01980000
019900                                                    COMP.         01990000
020000     05  PV-KEY-DATE                     PIC  X(10) VALUE SPACES. 02000000
020100     05  PV-KEY-DATE-R REDEFINES PV-KEY-DATE.                     02010000
020200         10  PV-KEY-CC                   PIC  9(02).              02020000
020300         10  PV-KEY-YY                   PIC  9(02).              02030000
020400         10  PV-DASH-1                   PIC  X(01).              02040000
020500         10  PV-KEY-MM                   PIC  9(02).              02050000
020600         10  PV-DASH-2                   PIC  X(01).              02060000
020700         10  PV-KEY-DD                   PIC  9(02).              02070000
020800                                                                  02080000
020900     05  PV-AUDIT-CNTL-NBR-X             PIC  X(09) VALUE SPACE.  02090000
021000     05  PV-AUDIT-CNTL-NBR  REDEFINES                             02100000
021100         PV-AUDIT-CNTL-NBR-X             PIC  9(09).              02110000
021200     05  PV-LIMIT-DAYS                   PIC S9(09) COMP.         02120000
021300     05  PV-SHPD-QTY-SUM                 PIC S9(09) COMP-3.       02130000
021400     05  PV-CARTON-COUNT                 PIC S9(09) COMP.         02140000
021500     05  PV-CICS-MSG-AREA                PIC  X(80) VALUE SPACE.  02150000
021600     05  PV-CICS-RESPONSE                PIC S9(08) VALUE ZEROS   02160000
021700                                                    COMP SYNC.    02170000
021800     05  PV-RCKUT061-COMMAREA            PIC X(01)  VALUE SPACE.  02180000
021900     05  PV-EIBTASKN                     PIC Z(06)9.              02190000
022000     05  PV-PREV-SEQUENCE                PIC S9(05) COMP-3        02200000
022100                                                     VALUE ZERO.  02210000
022200     05  PV-NEXT-SEQUENCE                PIC S9(05) COMP-3        02220000
022300                                                     VALUE ZERO.  02230000
022400     05  PV-CURRENT-TMST                 PIC  X(26)  VALUE SPACES.02240000
022500     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             02250000
022600         10  PV-CURR-CC                  PIC  9(02).              02260000
022700         10  PV-CURR-YY                  PIC  9(02).              02270000
022800         10  FILLER                      PIC  X(01).              02280000
022900         10  PV-CURR-MM                  PIC  9(02).              02290000
023000         10  FILLER                      PIC  X(01).              02300000
023100         10  PV-CURR-DD                  PIC  9(02).              02310000
023200         10  FILLER                      PIC  X(01).              02320000
023300         10  PV-CURR-HH                  PIC  9(02).              02330000
023400         10  FILLER                      PIC  X(01).              02340000
023500         10  PV-CURR-MN                  PIC  9(02).              02350000
023600         10  FILLER                      PIC  X(01).              02360000
023700         10  PV-CURR-SS                  PIC  9(02).              02370000
023800         10  FILLER                      PIC  X(07).              02380000
023900     05  PV-BUSINES-DATE                 PIC  X(26)  VALUE SPACES.02390000
024000     05  PV-BUSINES-DATE-R REDEFINES PV-BUSINES-DATE.             02400000
024100         10  PV-BUSN-CC                  PIC  9(02).              02410000
024200         10  PV-BUSN-YY                  PIC  9(02).              02420000
024300         10  FILLER                      PIC  X(01).              02430000
024400         10  PV-BUSN-MM                  PIC  9(02).              02440000
024500         10  FILLER                      PIC  X(01).              02450000
024600         10  PV-BUSN-DD                  PIC  9(02).              02460000
024700         10  FILLER                      PIC  X(01).              02470000
024800         10  PV-BUSN-HH                  PIC  9(02).              02480000
024900         10  FILLER                      PIC  X(01).              02490000
025000         10  PV-BUSN-MN                  PIC  9(02).              02500000
025100         10  FILLER                      PIC  X(01).              02510000
025200         10  PV-BUSN-SS                  PIC  9(02).              02520000
025300         10  FILLER                      PIC  X(07).              02530000
025310     05  PV-BUSINES-DATE-PREV            PIC  X(26)  VALUE SPACES.02531001
025320     05  PV-BUSINES-DATE-R-PREV REDEFINES PV-BUSINES-DATE-PREV.   02532001
025330         10  PV-BUSN-CC-PREV             PIC  9(02).              02533001
025340         10  PV-BUSN-YY-PREV             PIC  9(02).              02534001
025350         10  FILLER                      PIC  X(01).              02535001
025360         10  PV-BUSN-MM-PREV             PIC  9(02).              02536001
025370         10  FILLER                      PIC  X(01).              02537001
025380         10  PV-BUSN-DD-PREV             PIC  9(02).              02538001
025390         10  FILLER                      PIC  X(01).              02539001
025391         10  PV-BUSN-HH-PREV             PIC  9(02).              02539101
025392         10  FILLER                      PIC  X(01).              02539201
025393         10  PV-BUSN-MN-PREV             PIC  9(02).              02539301
025394         10  FILLER                      PIC  X(01).              02539401
025395         10  PV-BUSN-SS-PREV             PIC  9(02).              02539501
025396         10  FILLER                      PIC  X(07).              02539601
025400     05  PV-WRKD-TMST                    PIC  X(26)  VALUE SPACES.02540000
025500     05  PV-SHIFT-TIME                   PIC  X(08)  VALUE SPACES.02550000
025600     05  PV-SHIFT-TIME-R REDEFINES PV-SHIFT-TIME.                 02560000
025700         10  PV-SHFT-HH                  PIC  9(02).              02570000
025800         10  PV-PERIOD-1                 PIC  X(01).              02580000
025900         10  PV-SHFT-MN                  PIC  9(02).              02590000
026000         10  PV-PERIOD-2                 PIC  X(01).              02600000
026100         10  PV-SHFT-SS                  PIC  9(02).              02610000
026200/                                                                 02620000
026300 01  PT-MSG-TABLE.                                                02630000
026400     05  PT-MSG-LINES OCCURS 200 TIMES                            02640000
026500                              INDEXED BY PT-MSG-IDX.              02650000
026600         10  PT-MSG-SEQ                  PIC S9(05) COMP-3.       02660000
026700         10  PT-MSG-LINE                 PIC X(69).               02670000
026800                                                                  02680000
026900     05  PV-COMMAREA-LENGTH              PIC S9(04)  COMP         02690000
027000                                                     VALUE ZERO.  02700000
027100     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  02710000
027200                                                     COMP SYNC.   02720000
027300                                                                  02730000
027400*---------------------------------------------------------------* 02740000
027500*    DB2 AREA FOR THE PURCHASE ITEM TABLE                       * 02750000
027600*---------------------------------------------------------------* 02760000
027700     EXEC SQL                                                     02770000
027800          INCLUDE TPURITM                                         02780000
027900     END-EXEC.                                                    02790000
028000*---------------------------------------------------------------* 02800000
028100*    DB2 AREA FOR THE RECEIVER TABLE                            * 02810000
028200*---------------------------------------------------------------* 02820000
028300     EXEC SQL                                                     02830000
028400          INCLUDE TRECEIV                                         02840000
028500     END-EXEC.                                                    02850000
028600*---------------------------------------------------------------* 02860000
028700*    DB2 AREA FOR THE RECEIVER DISTRO TABLE                     * 02870000
028800*---------------------------------------------------------------* 02880000
028900     EXEC SQL                                                     02890000
029000          INCLUDE TRECDIS                                         02900000
029100     END-EXEC.                                                    02910000
029200*---------------------------------------------------------------* 02920000
029300*    DB2 AREA FOR RECEIVER ITEM TABLE                           * 02930000
029400*---------------------------------------------------------------* 02940000
029500     EXEC SQL                                                     02950000
029600          INCLUDE TRECITM                                         02960000
029700     END-EXEC.                                                    02970000
029800*---------------------------------------------------------------* 02980000
029900*  DB2 AREA FOR THE PCT SHIFT TABLE (PCT_SHFT)                    02990000
030000*---------------------------------------------------------------* 03000000
030100     EXEC SQL                                                     03010000
030200         INCLUDE PCT00004                                         03020000
030300     END-EXEC.                                                    03030000
030400*---------------------------------------------------------------* 03040000
030500*  DB2 AREA FOR THE PCT SUMMARY WORKED TABLE (PCT_SUM_WRKD)       03050000
030600*---------------------------------------------------------------* 03060000
030700     EXEC SQL                                                     03070000
030800         INCLUDE PCT00005                                         03080000
030900     END-EXEC.                                                    03090000
031000*---------------------------------------------------------------* 03100000
031100*  DB2 AREA FOR THE PCT SUMMARY VERIFIED TABLE (PCT_SUM_VRFD)     03110000
031200*---------------------------------------------------------------* 03120000
031300     EXEC SQL                                                     03130000
031400         INCLUDE PCT00006                                         03140000
031500     END-EXEC.                                                    03150000
031600*---------------------------------------------------------------* 03160000
031700*  DB2 AREA FOR THE PCT RCVR LINE DETAIL TABLE                    03170000
031800*  (PCT_RCVR_LNE_DTL)                                             03180000
031900*---------------------------------------------------------------* 03190000
032000     EXEC SQL                                                     03200000
032100         INCLUDE PCT00007                                         03210000
032200     END-EXEC.                                                    03220000
032300                                                                  03230000
032400*---------------------------------------------------------------* 03240000
032500*    RECVG SYSTEMS PARM TABLE                                     03250000
032600*---------------------------------------------------------------* 03260000
032700     EXEC SQL                                                     03270000
032800         INCLUDE TKRPRPM                                          03280000
032900     END-EXEC.                                                    03290000
033000                                                                  03300000
033100*---------------------------------------------------------------* 03310000
033200*    DB2 DCLGEN FOR DATE ATTRIBUTE TABLE                        * 03320000
033300*---------------------------------------------------------------* 03330000
033400     EXEC SQL                                                     03340000
033500          INCLUDE TDTATTR                                         03350000
033600     END-EXEC.                                                    03360000
033700*----------------------------------------------------------------*03370000
033800*  COMMUNICATIONS AREA FOR DB2                                   *03380000
033900*----------------------------------------------------------------*03390000
034000     EXEC SQL                                                     03400000
034100         INCLUDE SQLCA                                            03410000
034200     END-EXEC.                                                    03420000
034300                                                                  03430000
034400***************************************************************** 03440000
034500*  RETAIL PRICE CURSOR                                            03450000
034600***************************************************************** 03460000
034700     EXEC SQL                                                     03470000
034800       DECLARE RET-PRICE-CSR CURSOR FOR                           03480000
034900         SELECT A.ORD_LNE_NBR                                     03490000
035000             ,  B.UNT_RTL_PR_AMT                                  03500000
035100          FROM  TRECITM A                                         03510000
035200             ,  TPURITM B                                         03520000
035300          WHERE A.ORD_NBR             = :DK-PO-NBR                03530000
035400            AND A.REC_SEQ_NBR         = :DK-RCVR-SEQ-NBR          03540000
035500            AND A.ORD_NBR             = B.PO_NBR                  03550000
035600            AND A.PO_VER_NBR          = B.VER_NBR                 03560000
035700            AND A.ORD_LNE_NBR         = B.APP_PO_LNE_NBR          03570000
035800            AND A.VER_STATUS_CDE      = 'A'                       03580000
035900           WITH UR                                                03590000
036000     END-EXEC.                                                    03600000
036100                                                                  03610000
036200                                                                  03620000
036300******************************************************************03630000
036400 LINKAGE SECTION.                                                 03640000
036500******************************************************************03650000
036600 01  DFHCOMMAREA.                                                 03660000
036700     05  FILLER                         OCCURS  1 TO 4072 TIMES   03670000
036800                                      DEPENDING ON EIBCALEN.      03680000
036900         10  FILLER                   PIC X.                      03690000
037000                                                                  03700000
037100******************************************************************03710000
037200 PROCEDURE DIVISION.                                              03720000
037300******************************************************************03730000
037400 0000-PROGRAM-MAINLINE.                                           03740000
037500     MOVE EIBTASKN                 TO PV-EIBTASKN                 03750000
037600     INITIALIZE                        PC238-COMM-AREA.           03760000
037700     MOVE DFHCOMMAREA              TO  PC238-COMM-AREA.           03770000
037800                                                                  03780000
037900*    MOVE PC238-WRKD-OPER-UNT-ID  TO DK-OPER-UNT-ID.              03790000
038000*    PERFORM 8900-SELECT-TKRPRPM.                                 03800000
038100                                                                  03810000
038200*    STRING ' PS-SHOW-DEBUG-SW= ' PS-SHOW-DEBUG-SW                03820000
038300*        DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  03830000
038400*    PERFORM 9990-WRITE-CICS.                                     03840000
038500                                                                  03850000
038600* RESERVE THE LOG QUEUE FOR THE EXCLUSIVE USE OF THIS TRANSACTION 03860000
038700* TO KEEP OTHER TRANSACTIONS FROM INTERUPTING THE DISPLAY.        03870000
038800* THIS IS DONE ONLY IF THE DEBUGGING FLAG FOR THE DC IS           03880000
038900* SWITCHED ON.  IF AN ERROR OCCURS WHEN THE FLAG IS OFF,          03890000
039000* WE WILL ENQ THE LOG BEFORE DUMPING THE MESSAGE TABLE.           03900000
039100                                                                  03910000
039200*    IF PS-SHOW-DEBUG-INFO                                        03920000
039300*        EXEC CICS ENQ                                            03930000
039400*            RESOURCE(PC-LOG-QUEUE)                               03940000
039500*        END-EXEC                                                 03950000
039600*    END-IF                                                       03960000
039700                                                                  03970000
039800     INITIALIZE PT-MSG-TABLE.                                     03980000
039900                                                                  03990000
040000* THE FOLLOWING COMMENTED CODE CAN BE USED TO DETERMINE IF        04000000
040100* THE ROUTINE IS IN FACT GETTING CALLED.                          04010000
040200*                                                                 04020000
040300*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    04030000
040400*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  04040000
040500*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  04050000
040600*    MOVE PC238-WRKD-OPER-UNT-ID                                  04060000
040700*                            TO PC-DISPLAY-OPER.                  04070000
040800*    STRING ' PCKCS756 - '      DELIMITED BY SIZE                 04080000
040900*           ' PC238 DATA RECEIVED - '                             04090000
041000*                               DELIMITED BY SIZE                 04100000
041100*           PC-DISPLAY-PO       DELIMITED BY SIZE                 04110000
041200*           ' - '               DELIMITED BY SIZE                 04120000
041300*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 04130000
041400*           ' - '               DELIMITED BY SIZE                 04140000
041500*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 04150000
041600*           ' - '               DELIMITED BY SIZE                 04160000
041700*           PC-DISPLAY-OPER     DELIMITED BY SIZE                 04170000
041800*                        INTO PV-CICS-MSG-AREA3.                  04180000
041900*    MOVE LENGTH OF PV-CICS-MSG-AREA3                             04190000
042000*                          TO PV-COMMAREA-LENGTH.                 04200000
042100*    PERFORM 9200-WRITE-TO-CICS-LOG.                              04210000
042200                                                                  04220000
042300     IF PC238-DIRECT-STORE-YES                                    04230000
042400          CONTINUE                                                04240000
042500     ELSE                                                         04250000
042600        PERFORM 1000-DETRMN-BUS-DAY-SHIFT                         04260000
042700     END-IF                                                       04270000
042800                                                                  04280000
042900     IF  PC238-MOD-UNSUCCESSFUL                                   04290000
043000         CONTINUE                                                 04300000
043100     ELSE                                                         04310000
043200         MOVE PC238-PO-NBR           TO DK-PO-NBR                 04320000
043300         MOVE PC238-RCVR-SEQ-NBR     TO DK-RCVR-SEQ-NBR           04330000
043400         MOVE PC238-PO-LNE-NBR       TO DK-PO-LINE-NBR            04340000
043401         PERFORM 7800-SELECT-TRECEIV                              04340130
043402         PERFORM 8720-TKRPRPM-RCVR-TYPES                          04340230
043403                                                                  04340330
043404**WHEN THE RECEIVER TYPE SETS PS-POST-UNITS-WORKED-NO TO TRUE     04340430
043405**AND LINE NBR NOT = ZERO (TRAN TYPE Y AND W)                     04340530
043420**DO NOT PROCESS THE UNITS, ONLY CALL 6600-                       04342000
043430                                                                  04343000
043440         EVALUATE TRUE                                            04344000
043441             WHEN PS-POST-UNITS-WORKED-NO                         04344130
043442                  IF PC238-TRANS-TYPE-CDE NOT EQUAL PC-Y          04344230
043443                    AND PC238-TRANS-TYPE-CDE NOT EQUAL PC-W       04344330
043444                      PERFORM 6600-VERIFY-ADJUST                  04344430
043445                  END-IF                                          04344530
043446**WHEN DIRECT STORE, OR WHEN THE NET ADJSUTED QTY IS ZERO         04344628
043448**DO NOT PROCESS THE UNITS, ONLY CALL 6600-                       04344828
043450             WHEN PC238-DIRECT-STORE-YES                          04345000
043460             WHEN (PC238-WRKD-UNT-QTY = 0) AND                    04346000
043470                  (PC238-TRANS-TYPE-CDE NOT EQUAL PC-Y  AND       04347000
043480                  PC238-TRANS-TYPE-CDE NOT EQUAL PC-W )           04348000
043490                 PERFORM 6600-VERIFY-ADJUST                       04349025
043500             WHEN PC238-TRANS-TYPE-CDE = PC-P                     04350000
043600                 PERFORM 2000-PACK-TO-LIGHT-UPLOAD                04360000
043700* DMH 6/24/03 - BEGIN                                             04370000
043800             WHEN PC238-TRANS-TYPE-CDE = PC-Q                     04380000
043810                 PERFORM 2100-PACK-TO-LIGHT-ADJUSTMENT            04381000
043820                 IF PC238-TOT-QUEUE-ITEMS > 0                     04382000
043821                    PERFORM 6600-VERIFY-ADJUST                    04382100
043822                 END-IF                                           04382200
043823* DMH 6/24/03 - BEGIN                                             04382300
043824             WHEN PC238-TRANS-TYPE-CDE = PC-C                     04382400
043825                 PERFORM 2500-FULL-CASE-CONFIRMATION              04382500
043826             WHEN PC238-TRANS-TYPE-CDE = PC-U                     04382600
043827                 PERFORM 3000-FULL-CASE-UN-CONFIRMATION           04382700
043828             WHEN PC238-TRANS-TYPE-CDE = PC-A                     04382800
043829                 PERFORM 3500-FULL-CASE-CONFIRM-ADJ               04382900
043830             WHEN PC238-TRANS-TYPE-CDE = PC-V                     04383000
043840                 PERFORM 4000-LINE-VERIFICATION                   04384000
043850                 IF PC238-MOD-SUCCESSFUL                          04385000
043860                    PERFORM 6600-VERIFY-ADJUST                    04386000
043870                 END-IF                                           04387000
043880             WHEN PC238-TRANS-TYPE-CDE = PC-X                     04388000
043890                 PERFORM 4500-LINE-UN-VERIFICATION                04389000
043900                 IF PC238-MOD-SUCCESSFUL                          04390000
044000                    PERFORM 6600-VERIFY-ADJUST                    04400000
044100                 END-IF                                           04410000
044200             WHEN PC238-TRANS-TYPE-CDE = PC-B                     04420000
044300             WHEN PC238-TRANS-TYPE-CDE = PC-D                     04430000
044400                 PERFORM 5000-LINE-VERIFICATION-ADJ               04440000
044500                 IF PC238-MOD-SUCCESSFUL                          04450000
044600                    PERFORM 6600-VERIFY-ADJUST                    04460000
044700                 END-IF                                           04470000
044800             WHEN PC238-TRANS-TYPE-CDE = PC-W                     04480000
044900                 PERFORM 5500-RECV-VERIFICATION                   04490000
045000             WHEN PC238-TRANS-TYPE-CDE = PC-Y                     04500000
045100                 PERFORM 6000-RECV-UN-VERIFICTN                   04510000
045200         END-EVALUATE.                                            04520000
045300                                                                  04530000
045400     PERFORM 9998-RETURN.                                         04540000
045500                                                                  04550000
045600 1000-DETRMN-BUS-DAY-SHIFT.                                       04560000
045700                                                                  04570000
045800     MOVE PC238-WRKD-OPER-UNT-ID  TO DK-OPER-UNT-ID.              04580000
045900                                                                  04590000
046000     PERFORM 8700-GET-TKRPRPM.                                    04600000
046100                                                                  04610000
046200     PERFORM 8800-GET-SHIFT.                                      04620000
046300                                                                  04630000
046400     IF  PC238-MOD-UNSUCCESSFUL                                   04640000
046500         CONTINUE                                                 04650000
046600     ELSE                                                         04660000
046700         MOVE PV-KEY-DATE         TO DK-BUS-DTE                   04670000
046800                                     PC238-BUSINES-DTE            04680000
046900         PERFORM 8850-SELECT-FISCAL-INFO                          04690000
047000         MOVE DTATTR-FSCL-YR-NBR         TO PC238-FSCL-YR-NBR     04700000
047100         MOVE DTATTR-FSCL-MN-NBR         TO PC238-FSCL-MN-NBR     04710000
047200         MOVE DTATTR-FSCL-WK-NBR         TO PC238-FSCL-WK-NBR     04720000
047300         MOVE DTATTR-WK-IN-MN-NBR        TO PC238-WK-IN-MN-NBR    04730000
047400         MOVE DTATTR-DAY-OF-WK-NBR       TO PC238-DAY-OF-WK-NBR   04740000
047500         MOVE DTATTR-LY-THIS-DAY-KY-DTE                           04750000
047600                                      TO PC238-LY-THIS-DAY-KY-DTE 04760000
047700         MOVE DTATTR-FSCL-MN-BEG-DTE     TO PC238-FSCL-MN-BEG-DTE 04770000
047800         MOVE DTATTR-FSCL-MN-END-DTE     TO PC238-FSCL-MN-END-DTE 04780000
047900         MOVE DTATTR-FSCL-WK-BEG-DTE     TO PC238-FSCL-WK-BEG-DTE 04790000
048000         MOVE DTATTR-FSCL-WK-END-DTE     TO PC238-FSCL-WK-END-DTE 04800000
048100     END-IF.                                                      04810000
048200                                                                  04820000
048300 1500-PROCESS-AREA-RETRIEVAL.                                     04830000
048400                                                                  04840000
048500     INITIALIZE RC033-FIELDS.                                     04850000
048600                                                                  04860000
048700     MOVE PC238-PO-NBR                TO RC033-PO-NBR.            04870000
048800     MOVE PC238-PO-LNE-NBR            TO RC033-PO-LNE-NBR.        04880000
048900     MOVE PC238-RCVR-SEQ-NBR          TO RC033-REC-SEQ-NBR.       04890000
049000     MOVE PC238-WRKD-OPER-UNT-ID      TO RC033-OPER-UNT-ID.       04900000
049100     MOVE +1                          TO RC033-FCLTY-ID.          04910000
049200                                                                  04920000
049300     IF  PC238-MANUAL-VERIFY                                      04930000
049400         SET RC033-VERIFICATION   TO TRUE                         04940000
049500     END-IF.                                                      04950000
049600                                                                  04960000
049700     SET RC033-CHECK-EXIST        TO TRUE.                        04970000
049800                                                                  04980000
049900     CALL PC-PROCESS-AREA-PGM USING DFHEIBLK                      04990000
050000                                    PV-RCKUT061-COMMAREA          05000000
050100                                    RC033-FIELDS.                 05010000
050200                                                                  05020000
050300     IF RC033-CALL-SUCCESSFUL                                     05030000
050400         SET RC033-BYPASS-CHECK-EXIST TO TRUE                     05040000
050500                                                                  05050000
050600         IF RC033-WO-EXISTS                                       05060000
050700             SET RC033-GET-WO-INST TO TRUE                        05070000
050800             CALL PC-PROCESS-AREA-PGM USING DFHEIBLK              05080000
050900                                            PV-RCKUT061-COMMAREA  05090000
051000                                            RC033-FIELDS          05100000
051100***  CHANGE TO CICS ABEND                                         05110000
051200         ELSE                                                     05120000
051300             MOVE '1500-PROCESS-AREA-RETRIEVAL'                   05130000
051400                             TO DP013-PARAGRAPH                   05140000
051500             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        05150000
051600             STRING 'PO NBR: '         DELIMITED BY SIZE          05160000
051700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          05170000
051800                           INTO DP013-MESSAGE-TEXT(1)             05180000
051900             MOVE DK-RCVR-SEQ-NBR                                 05190000
052000                             TO PV-DISPLAY-RCVR-SEQ-NBR           05200000
052100             STRING 'RECV SEQ: '       DELIMITED BY SIZE          05210000
052200                 PV-DISPLAY-RCVR-SEQ-NBR                          05220000
052300                                       DELIMITED BY SIZE          05230000
052400                           INTO DP013-MESSAGE-TEXT(2)             05240000
052500             MOVE DK-PO-LINE-NBR    TO PV-DISPLAY-PO-LINE-NBR     05250000
052600             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          05260000
052700                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          05270000
052800                           INTO DP013-MESSAGE-TEXT(3)             05280000
052900             MOVE RC033-SQLCODE                                   05290000
053000                             TO DP013-SQLCA                       05300000
053100                                PC238-BAD-SQL-CDE                 05310000
053200             MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME(1)           05320000
053300                                PC238-BAD-TABLE-NAME              05330000
053400             MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME(2)           05340000
053500             SET PC238-DB2-FUNCTION-SELECT TO TRUE                05350000
053600             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                05360000
053700             SET DP013-DB2-ABEND                                  05370000
053800                             TO TRUE                              05380000
053900             SET DP013-NO-ROLLBACK                                05390000
054000                             TO TRUE                              05400000
054100             PERFORM 9999-WRITE-CICS-LOG-MSG                      05410000
054200         END-IF                                                   05420000
054300     ELSE                                                         05430000
054400***  CHANGE TO CICS ABEND                                         05440000
054500                                                                  05450000
054600         MOVE '1500-PROCESS-AREA-RETRIEVAL'                       05460000
054700                         TO DP013-PARAGRAPH                       05470000
054800         MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR            05480000
054900         STRING 'PO NBR: '         DELIMITED BY SIZE              05490000
055000             PV-DISPLAY-PO-NBR     DELIMITED BY SIZE              05500000
055100                       INTO DP013-MESSAGE-TEXT(1)                 05510000
055200         MOVE DK-RCVR-SEQ-NBR                                     05520000
055300                         TO PV-DISPLAY-RCVR-SEQ-NBR               05530000
055400         STRING 'RECV SEQ: '       DELIMITED BY SIZE              05540000
055500             PV-DISPLAY-RCVR-SEQ-NBR                              05550000
055600                                   DELIMITED BY SIZE              05560000
055700                       INTO DP013-MESSAGE-TEXT(2)                 05570000
055800         MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR       05580000
055900         STRING 'PO LINE NBR: '    DELIMITED BY SIZE              05590000
056000            PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE              05600000
056100                       INTO DP013-MESSAGE-TEXT(3)                 05610000
056200         MOVE RC033-SQLCODE                                       05620000
056300                         TO DP013-SQLCA                           05630000
056400                            PC238-BAD-SQL-CDE                     05640000
056500         MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME(1)               05650000
056600                            PC238-BAD-TABLE-NAME                  05660000
056700         MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME(2)               05670000
056800         SET PC238-DB2-FUNCTION-SELECT TO TRUE                    05680000
056900         SET PC238-MOD-UNSUCCESSFUL    TO TRUE                    05690000
057000         SET DP013-DB2-ABEND                                      05700000
057100                         TO TRUE                                  05710000
057200         SET DP013-NO-ROLLBACK                                    05720000
057300                         TO TRUE                                  05730000
057400         PERFORM 9999-WRITE-CICS-LOG-MSG                          05740000
057500                                                                  05750000
057600     END-IF.                                                      05760000
057700     STRING ' 1000-DETERMINE-IF-AUDIT-REQ'                        05770000
057800         DELIMITED BY SIZE                                        05780000
057900         INTO PV-CICS-MSG-AREA.                                   05790000
058000     PERFORM 9990-WRITE-CICS.                                     05800000
058100                                                                  05810000
058200 2000-PACK-TO-LIGHT-UPLOAD.                                       05820000
058300     STRING ' 2000-PACK-TO-LIGHT-UPLOAD'                          05830000
058400         DELIMITED BY SIZE                                        05840000
058500         INTO PV-CICS-MSG-AREA.                                   05850000
058600     PERFORM 9990-WRITE-CICS.                                     05860000
058700     SET PC238-MOD-SUCCESSFUL TO TRUE.                            05870000
058800                                                                  05880000
058900     IF PC238-NO-RETAIL-PRC                                       05890000
059000         PERFORM 7000-SELECT-RETAIL-PRICE                         05900000
059100     END-IF.                                                      05910000
059200                                                                  05920000
059300     IF PC238-MOD-SUCCESSFUL                                      05930000
059400         IF PC238-NO-PRCG-AREA-CDE                                05940000
059500             PERFORM 1500-PROCESS-AREA-RETRIEVAL                  05950000
059600             IF RC033-WO-EXISTS AND                               05960000
059700                RC033-CALL-SUCCESSFUL                             05970000
059800                 MOVE RC033-RETURN-P2L-AREA TO PC238-PRCG-AREA-CDE05980000
059900             END-IF                                               05990000
060000         END-IF                                                   06000000
060100     END-IF.                                                      06010000
060200                                                                  06020000
060300     IF PC238-MOD-SUCCESSFUL                                      06030000
060400         MOVE PC238-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE         06040000
060500         PERFORM 7100-SUM-PREVIOUS-UPLOADS                        06050000
060600         IF PC238-MOD-SUCCESSFUL                                  06060000
060700             IF PV-SUM-UNIT-QTY < PC238-WRKD-UNT-QTY              06070000
060800                 COMPUTE PV-UPDATE-QTY =                          06080000
060900                      PC238-WRKD-UNT-QTY - PV-SUM-UNIT-QTY        06090000
061000                 PERFORM 7200-CHECK-IF-WORK-STARTED               06100000
061100                 PERFORM 6500-BUILD-LINE-DETAIL                   06110000
061200                 PERFORM 6530-BUILD-PCT-SUM-WORKED                06120000
061300                 MOVE ZEROES TO PV-UPDATE-QTY                     06130000
061400             END-IF                                               06140000
061500         END-IF                                                   06150000
061600     END-IF.                                                      06160000
061700                                                                  06170000
061800                                                                  06180000
061900* DMH 6/23/03 - BEGIN                                             06190000
062000 2100-PACK-TO-LIGHT-ADJUSTMENT.                                   06200000
062100     STRING ' 2100-PACK-TO-LIGHT-ADJUSTMENT'                      06210000
062110         DELIMITED BY SIZE                                        06211000
062111         INTO PV-CICS-MSG-AREA.                                   06211100
062112     PERFORM 9990-WRITE-CICS.                                     06211200
062113     SET PC238-MOD-SUCCESSFUL TO TRUE.                            06211300
062114                                                                  06211400
062115     IF PC238-NO-RETAIL-PRC                                       06211500
062116         PERFORM 7000-SELECT-RETAIL-PRICE                         06211600
062117     END-IF.                                                      06211700
062118                                                                  06211800
062119     IF PC238-MOD-SUCCESSFUL                                      06211900
062120         IF PC238-NO-PRCG-AREA-CDE                                06212000
062121             PERFORM 1500-PROCESS-AREA-RETRIEVAL                  06212100
062122             IF RC033-WO-EXISTS AND                               06212200
062123                RC033-CALL-SUCCESSFUL                             06212300
062124                 MOVE RC033-RETURN-P2L-AREA TO PC238-PRCG-AREA-CDE06212400
062125             END-IF                                               06212500
062126         END-IF                                                   06212600
062127     END-IF.                                                      06212700
062128                                                                  06212800
062129     IF PC238-MOD-SUCCESSFUL                                      06212900
062130         MOVE PC238-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE         06213000
062131         PERFORM 7100-SUM-PREVIOUS-UPLOADS                        06213100
062132         IF PC238-MOD-SUCCESSFUL                                  06213200
062133                 MOVE  PC238-WRKD-UNT-QTY                         06213300
062134                   TO  PV-UPDATE-QTY                              06213400
062135                 PERFORM 7200-CHECK-IF-WORK-STARTED               06213500
062136                 PERFORM 6500-BUILD-LINE-DETAIL                   06213600
062137                 PERFORM 6530-BUILD-PCT-SUM-WORKED                06213700
062138                 MOVE ZEROES TO PV-UPDATE-QTY                     06213800
062139         END-IF                                                   06213900
062140     END-IF.                                                      06214000
062141* DMH 6/23/03 - END                                               06214100
062142                                                                  06214200
062143                                                                  06214300
062144 2500-FULL-CASE-CONFIRMATION.                                     06214400
062145     STRING ' 2500-FULL-CASE-CONFIRMATION'                        06214500
062146         DELIMITED BY SIZE                                        06214600
062147         INTO PV-CICS-MSG-AREA.                                   06214700
062148     PERFORM 9990-WRITE-CICS.                                     06214800
062149     SET PC238-MOD-SUCCESSFUL TO TRUE.                            06214900
062150                                                                  06215000
062160     IF PC238-NO-RETAIL-PRC                                       06216000
062170         PERFORM 7000-SELECT-RETAIL-PRICE                         06217000
062180     END-IF.                                                      06218000
062190                                                                  06219000
062200     IF PC238-MOD-SUCCESSFUL                                      06220000
062300         IF PC238-NO-PRCG-AREA-CDE                                06230000
062400             PERFORM 1500-PROCESS-AREA-RETRIEVAL                  06240000
062500             IF RC033-WO-EXISTS AND                               06250000
062600                RC033-CALL-SUCCESSFUL                             06260000
062700                 MOVE RC033-RETURN-LAST-AREA                      06270000
062800                                          TO PC238-PRCG-AREA-CDE  06280000
062900             END-IF                                               06290000
063000         END-IF                                                   06300000
063100     END-IF.                                                      06310000
063200                                                                  06320000
063300     IF PC238-MOD-SUCCESSFUL                                      06330000
063400         MOVE PC238-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE         06340000
063500         PERFORM 7600-SUM-PREVIOUS-CONFIRMS                       06350000
063600         IF PC238-MOD-SUCCESSFUL                                  06360000
063700             IF PV-SUM-UNIT-QTY < PC238-WRKD-UNT-QTY              06370000
063800                 COMPUTE PV-UPDATE-QTY =                          06380000
063900                      PC238-WRKD-UNT-QTY - PV-SUM-UNIT-QTY        06390000
064000                 PERFORM 7200-CHECK-IF-WORK-STARTED               06400000
064100                 PERFORM 6500-BUILD-LINE-DETAIL                   06410000
064200                 PERFORM 6530-BUILD-PCT-SUM-WORKED                06420000
064300                 MOVE ZEROES TO PV-UPDATE-QTY                     06430000
064400             END-IF                                               06440000
064500         END-IF                                                   06450000
064600     END-IF.                                                      06460000
064700                                                                  06470000
064800 3000-FULL-CASE-UN-CONFIRMATION.                                  06480000
064900     STRING ' 3000-FULL-CASE-UN-CONFIRMATION'                     06490000
065000         DELIMITED BY SIZE                                        06500000
065100         INTO PV-CICS-MSG-AREA.                                   06510000
065200     PERFORM 9990-WRITE-CICS.                                     06520000
065300     SET PC238-MOD-SUCCESSFUL TO TRUE.                            06530000
065400                                                                  06540000
065500     IF PC238-NO-PRCG-AREA-CDE                                    06550000
065600         PERFORM 1500-PROCESS-AREA-RETRIEVAL                      06560000
065700         IF RC033-WO-EXISTS AND                                   06570000
065800            RC033-CALL-SUCCESSFUL                                 06580000
065900             MOVE RC033-RETURN-FCSE-AREA TO PC238-PRCG-AREA-CDE   06590000
066000         END-IF                                                   06600000
066100     END-IF.                                                      06610000
066200                                                                  06620000
066300     IF PC238-MOD-SUCCESSFUL                                      06630000
066400         MOVE PC238-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE         06640000
066500         MOVE PC238-WRKD-UNT-QTY TO PV-UPDATE-QTY                 06650000
066600         PERFORM 6500-BUILD-LINE-DETAIL                           06660000
066700     END-IF.                                                      06670000
066800                                                                  06680000
066900 3500-FULL-CASE-CONFIRM-ADJ.                                      06690000
067000     STRING ' 3500-FULL-CASE-CONFIRM-ADJ'                         06700000
067100         DELIMITED BY SIZE                                        06710000
067200         INTO PV-CICS-MSG-AREA.                                   06720000
067300     PERFORM 9990-WRITE-CICS.                                     06730000
067400     SET PC238-MOD-SUCCESSFUL TO TRUE.                            06740000
067500                                                                  06750000
067600     IF PC238-NO-RETAIL-PRC                                       06760000
067700         PERFORM 7000-SELECT-RETAIL-PRICE                         06770000
067800     END-IF.                                                      06780000
067900                                                                  06790000
068000     IF PC238-MOD-SUCCESSFUL                                      06800000
068100         IF PC238-NO-PRCG-AREA-CDE                                06810000
068200             PERFORM 1500-PROCESS-AREA-RETRIEVAL                  06820000
068300             IF RC033-WO-EXISTS AND                               06830000
068400                RC033-CALL-SUCCESSFUL                             06840000
068500                 MOVE RC033-RETURN-FCSE-AREA                      06850000
068600                                         TO PC238-PRCG-AREA-CDE   06860000
068700             END-IF                                               06870000
068800         END-IF                                                   06880000
068900     END-IF.                                                      06890000
069000                                                                  06900000
069100     IF PC238-MOD-SUCCESSFUL                                      06910000
069200         MOVE PC238-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE         06920000
069300         PERFORM 7200-CHECK-IF-WORK-STARTED                       06930000
069400     END-IF.                                                      06940000
069500                                                                  06950000
069600     IF PC238-MOD-SUCCESSFUL                                      06960000
069700         MOVE PC238-WRKD-UNT-QTY TO PV-UPDATE-QTY                 06970000
069800         PERFORM 6500-BUILD-LINE-DETAIL                           06980000
069900         PERFORM 6530-BUILD-PCT-SUM-WORKED                        06990000
070000         MOVE ZEROES TO PV-UPDATE-QTY                             07000000
070100     END-IF.                                                      07010000
070200                                                                  07020000
070300 4000-LINE-VERIFICATION.                                          07030000
070400     STRING ' 4000-LINE-VERIFICATION'                             07040000
070500         DELIMITED BY SIZE                                        07050000
070600         INTO PV-CICS-MSG-AREA.                                   07060000
070700     PERFORM 9990-WRITE-CICS.                                     07070000
070800     SET PC238-MOD-SUCCESSFUL TO TRUE.                            07080000
070900                                                                  07090000
071000     IF PC238-NO-RETAIL-PRC                                       07100000
071100         PERFORM 7000-SELECT-RETAIL-PRICE                         07110000
071200     END-IF.                                                      07120000
071300                                                                  07130000
071400     IF PC238-MOD-SUCCESSFUL                                      07140000
071500         IF PC238-NO-PRCG-AREA-CDE                                07150000
071600             PERFORM 1500-PROCESS-AREA-RETRIEVAL                  07160000
071700             IF RC033-WO-EXISTS AND                               07170000
071800                RC033-CALL-SUCCESSFUL                             07180000
071900                 MOVE RC033-RETURN-LAST-AREA                      07190000
072000                                           TO PC238-PRCG-AREA-CDE 07200000
072100             END-IF                                               07210000
072200         END-IF                                                   07220000
072300     END-IF.                                                      07230000
072400                                                                  07240000
072500     IF PC238-MOD-SUCCESSFUL                                      07250000
072600         MOVE PC238-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE         07260000
072700         PERFORM 7700-SUM-PREVIOUS-VERIFIED                       07270000
072800         IF PC238-MOD-SUCCESSFUL AND                              07280000
072900            PV-SUM-UNIT-QTY < PC238-WRKD-UNT-QTY                  07290000
073000             COMPUTE PV-UPDATE-QTY =                              07300000
073100                  PC238-WRKD-UNT-QTY - PV-SUM-UNIT-QTY            07310000
073200             PERFORM 7200-CHECK-IF-WORK-STARTED                   07320000
073300             PERFORM 6500-BUILD-LINE-DETAIL                       07330000
073400             PERFORM 6530-BUILD-PCT-SUM-WORKED                    07340000
073500             MOVE ZEROES TO PV-UPDATE-QTY                         07350000
073600         END-IF                                                   07360000
073700     END-IF.                                                      07370000
073800                                                                  07380000
073900 4500-LINE-UN-VERIFICATION.                                       07390000
074000     STRING ' 4500-LINE-UN-VERIFICATION'                          07400000
074100         DELIMITED BY SIZE                                        07410000
074200         INTO PV-CICS-MSG-AREA.                                   07420000
074300     PERFORM 9990-WRITE-CICS.                                     07430000
074400     SET PC238-MOD-SUCCESSFUL TO TRUE.                            07440000
074500                                                                  07450000
074600     IF PC238-NO-PRCG-AREA-CDE                                    07460000
074700         PERFORM 1500-PROCESS-AREA-RETRIEVAL                      07470000
074800         IF RC033-WO-EXISTS AND                                   07480000
074900            RC033-CALL-SUCCESSFUL                                 07490000
075000             MOVE RC033-RETURN-LAST-AREA TO PC238-PRCG-AREA-CDE   07500000
075100         END-IF                                                   07510000
075200     END-IF.                                                      07520000
075300     IF PC238-MOD-SUCCESSFUL                                      07530000
075400         MOVE PC238-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE         07540000
075500         MOVE ZERO                    TO PV-UPDATE-QTY            07550000
075600                                         PC238-WRKD-UNT-QTY       07560000
075700                                         PC238-WRKD-CART-QTY      07570000
075800                                         PC238-UNT-RETAIL-PRC     07580000
075900         PERFORM 6500-BUILD-LINE-DETAIL                           07590000
076000     END-IF.                                                      07600000
076100                                                                  07610000
076200 5000-LINE-VERIFICATION-ADJ.                                      07620000
076300     STRING ' 5000-LINE-VERIFICATION-ADJ'                         07630000
076400         DELIMITED BY SIZE                                        07640000
076500         INTO PV-CICS-MSG-AREA.                                   07650000
076600     PERFORM 9990-WRITE-CICS.                                     07660000
076700     SET PC238-MOD-SUCCESSFUL TO TRUE.                            07670000
076800                                                                  07680000
076900     IF PC238-NO-RETAIL-PRC                                       07690000
077000         PERFORM 7000-SELECT-RETAIL-PRICE                         07700000
077100     END-IF.                                                      07710000
077200                                                                  07720000
077300     IF PC238-MOD-SUCCESSFUL                                      07730000
077400         IF PC238-NO-PRCG-AREA-CDE                                07740000
077500             PERFORM 1500-PROCESS-AREA-RETRIEVAL                  07750000
077600             IF RC033-WO-EXISTS AND                               07760000
077700                RC033-CALL-SUCCESSFUL                             07770000
077800                 IF PC238-TRANS-TYPE-CDE = PC-B                   07780000
077900                    MOVE RC033-RETURN-LAST-AREA                   07790000
078000                                            TO PC238-PRCG-AREA-CDE07800000
078100                 ELSE                                             07810000
078200                    MOVE RC033-RETURN-FCSE-AREA                   07820000
078300                                            TO PC238-PRCG-AREA-CDE07830000
078400                 END-IF                                           07840000
078500             END-IF                                               07850000
078600         END-IF                                                   07860000
078700     END-IF.                                                      07870000
078800                                                                  07880000
078900     IF PC238-MOD-SUCCESSFUL                                      07890000
079000         MOVE PC238-PRCG-AREA-CDE     TO DK-PRCG-AREA-CDE         07900000
079100         PERFORM 7200-CHECK-IF-WORK-STARTED                       07910000
079200         IF PC238-MOD-SUCCESSFUL                                  07920000
079300             MOVE PC238-WRKD-UNT-QTY TO PV-UPDATE-QTY             07930000
079400             PERFORM 6500-BUILD-LINE-DETAIL                       07940000
079500             PERFORM 6530-BUILD-PCT-SUM-WORKED                    07950000
079600             MOVE ZEROES TO PV-UPDATE-QTY                         07960000
079700         END-IF                                                   07970000
079800     END-IF.                                                      07980000
079900                                                                  07990000
080000 5500-RECV-VERIFICATION.                                          08000000
080100     STRING ' 5500-RECV-VERIFICATION'                             08010000
080200         DELIMITED BY SIZE                                        08020000
080300         INTO PV-CICS-MSG-AREA.                                   08030000
080400     PERFORM 9990-WRITE-CICS.                                     08040000
080500     SET PC238-MOD-SUCCESSFUL TO TRUE.                            08050000
080600                                                                  08060000
080700     PERFORM 7800-SELECT-TRECEIV.                                 08070000
080800     IF PC238-MOD-SUCCESSFUL                                      08080000
080900         SET PS-NOT-END-OF-RET-PRICE-CSR TO TRUE                  08090000
081000         PERFORM 7900-OPEN-RET-PRICE-CURSOR                       08100000
081100         PERFORM 8000-FETCH-RET-PRICE-CURSOR                      08110000
081200              UNTIL PS-END-OF-RET-PRICE-CSR                       08120000
081300         PERFORM 8100-CLOSE-RET-PRICE-CURSOR                      08130000
081400     END-IF.                                                      08140000
081500     IF PC238-MOD-SUCCESSFUL                                      08150000
081600         PERFORM 8300-SUM-PREVIOUS-UPLOADS                        08160000
081700     END-IF.                                                      08170000
081800     IF (PC238-MOD-SUCCESSFUL AND                                 08180000
081900       (PV-SUM-UNIT-QTY < PV-TOTAL-AP-VERIFY-QTY) OR              08190000
082000       (PV-SUM-CART-QTY < PV-SUM-ACTUAL-CARTON-COUNT) OR          08200000
082100       (PV-SUM-EXTENDED-RETAIL < PV-TOTAL-RECEIVER-RETAIL))       08210000
082200           COMPUTE PV-UPDT-UNIT-QTY = PV-TOTAL-AP-VERIFY-QTY -    08220000
082300                                      PV-SUM-UNIT-QTY             08230000
082400           COMPUTE PV-UPDT-CART-QTY = PV-SUM-ACTUAL-CARTON-COUNT -08240000
082500                                      PV-SUM-CART-QTY             08250000
082600           COMPUTE PV-UPDT-EXTD-RTL = PV-TOTAL-RECEIVER-RETAIL -  08260000
082700                                      PV-SUM-EXTENDED-RETAIL      08270000
082800           IF PV-UPDT-UNIT-QTY < ZERO                             08280000
082900               MOVE ZEROES TO PV-UPDT-UNIT-QTY                    08290000
083000           END-IF                                                 08300000
083100           IF PV-UPDT-CART-QTY < ZERO                             08310000
083200               MOVE ZEROES TO PV-UPDT-UNIT-QTY                    08320000
083300           END-IF                                                 08330000
083400           IF PV-UPDT-EXTD-RTL < ZERO                             08340000
083410               MOVE ZEROES TO PV-UPDT-UNIT-QTY                    08341000
083420           END-IF                                                 08342000
083430           MOVE PC238-SHFT-NBR          TO DK-SHIFT-NBR           08343000
083440           PERFORM 8400-CHECK-IF-WORK-STARTED                     08344000
083450           IF PC238-MOD-SUCCESSFUL                                08345000
083460               PERFORM 6500-BUILD-LINE-DETAIL                     08346000
083470               PERFORM 6560-BUILD-PCT-SUM-VERIFIED                08347000
083480               MOVE ZEROES TO PV-UPDATE-QTY                       08348000
083490           END-IF                                                 08349000
083500     END-IF.                                                      08350000
083600                                                                  08360000
083700 6000-RECV-UN-VERIFICTN.                                          08370000
083800     STRING ' 6000-RECV-UN-VERIFICTN'                             08380000
083900         DELIMITED BY SIZE                                        08390000
084000         INTO PV-CICS-MSG-AREA.                                   08400000
084100     PERFORM 9990-WRITE-CICS.                                     08410000
084200     SET PC238-MOD-SUCCESSFUL TO TRUE.                            08420000
084300                                                                  08430000
084400     IF PC238-NO-PRCG-AREA-CDE                                    08440000
084500         PERFORM 1500-PROCESS-AREA-RETRIEVAL                      08450000
084600         IF RC033-WO-EXISTS AND                                   08460000
084700            RC033-CALL-SUCCESSFUL                                 08470000
084800             MOVE RC033-RETURN-LAST-AREA TO PC238-PRCG-AREA-CDE   08480000
084900         END-IF                                                   08490000
085000     END-IF.                                                      08500000
085100     IF PC238-MOD-SUCCESSFUL                                      08510000
085200         MOVE PC238-WRKD-UNT-QTY TO PV-UPDATE-QTY                 08520000
085300         PERFORM 6500-BUILD-LINE-DETAIL                           08530000
085400     END-IF.                                                      08540000
085500                                                                  08550000
085600 6500-BUILD-LINE-DETAIL.                                          08560000
085700     STRING ' 6500-BUILD-LINE-DETAIL'                             08570000
085800         DELIMITED BY SIZE                                        08580000
085900         INTO PV-CICS-MSG-AREA.                                   08590000
086000     PERFORM 9990-WRITE-CICS.                                     08600000
086100     INITIALIZE DCLPCT00007.                                      08610000
086200                                                                  08620000
086300     MOVE PC238-PO-NBR            TO PCT00007-PO-NBR.             08630000
086400     MOVE PC238-RCVR-SEQ-NBR      TO PCT00007-RCVR-SEQ-NBR.       08640000
086500     MOVE PC238-PO-LNE-NBR        TO PCT00007-PO-LNE-NBR.         08650000
086600     MOVE PC238-TRANS-TYPE-CDE    TO PCT00007-ACTN-CDE.           08660000
086700     MOVE PC238-WRKD-TMST         TO PCT00007-WRKD-UNT-TMST.      08670000
086800     MOVE PC238-BUSINES-DTE       TO PCT00007-BUS-DTE.            08680000
086900     MOVE PC238-WRKD-OPER-UNT-ID  TO PCT00007-OPER-UNT-ID.        08690000
087000     MOVE PC238-SHFT-NBR          TO PCT00007-SHFT-NBR.           08700000
087100     MOVE PC238-PRCG-AREA-CDE     TO PCT00007-PRCG-AREA-CDE.      08710000
087200     IF PC238-TRANS-TYPE-CDE = PC-W                               08720000
087300         MOVE PV-UPDT-UNIT-QTY    TO PCT00007-UNT-QTY             08730000
087400         MOVE PV-UPDT-CART-QTY    TO PCT00007-CART-QTY            08740000
087500         MOVE PV-UPDT-EXTD-RTL    TO PCT00007-EXTD-RTL-AMT        08750000
087600     ELSE                                                         08760000
087700         MOVE PV-UPDATE-QTY       TO PCT00007-UNT-QTY             08770000
087800         MOVE PC238-WRKD-CART-QTY TO PCT00007-CART-QTY            08780000
087900         COMPUTE PCT00007-EXTD-RTL-AMT =                          08790000
088000              PC238-UNT-RETAIL-PRC * PV-UPDATE-QTY                08800000
088100     END-IF.                                                      08810000
088200     PERFORM 7300-INSERT-LINE-DETAIL.                             08820000
088300                                                                  08830000
088400 6530-BUILD-PCT-SUM-WORKED.                                       08840000
088500     STRING ' 6530-BUILD-PCT-SUM-WORKED'                          08850000
088600         DELIMITED BY SIZE                                        08860000
088700         INTO PV-CICS-MSG-AREA.                                   08870000
088800     PERFORM 9990-WRITE-CICS.                                     08880000
088900     INITIALIZE DCLPCT00005.                                      08890000
089000                                                                  08900000
089100     MOVE PC238-BUSINES-DTE       TO PCT00005-BUS-DTE             08910000
089200                                     DK-BUS-DTE.                  08920000
089300     MOVE PC238-WRKD-OPER-UNT-ID  TO PCT00005-OPER-UNT-ID         08930000
089400                                     DK-OPER-UNT-ID.              08940000
089500     MOVE PC238-SHFT-NBR          TO PCT00005-SHFT-NBR            08950000
089600                                     DK-SHIFT-NBR.                08960000
089700     MOVE PC238-PRCG-AREA-CDE     TO PCT00005-PRCG-AREA-CDE       08970000
089800                                     DK-PRCG-AREA-CDE.            08980000
089900     MOVE PV-UPDATE-QTY           TO PCT00005-UNT-WRKD-QTY.       08990000
090000     MOVE PC238-WRKD-CART-QTY     TO PCT00005-CART-WRKD-QTY.      09000000
090100     IF PS-NO-WORK-STARTED                                        09010000
090200         ADD  +1                  TO PV-RCVR-WRKD-QTY             09020000
090300     ELSE                                                         09030000
090400         MOVE +0                  TO PV-RCVR-WRKD-QTY             09040000
090500     END-IF.                                                      09050000
090600     COMPUTE PCT00005-EXTD-RTL-WRKD-AMT =                         09060000
090700          PC238-UNT-RETAIL-PRC * PV-UPDATE-QTY.                   09070000
090800     PERFORM 7400-UPDATE-PCT-SUM-WORK.                            09080000
090900     IF SQLCODE = +100                                            09090000
091000         PERFORM 7500-INSERT-PCT-SUM-WORK                         09100000
091100     END-IF.                                                      09110000
091200                                                                  09120000
091300 6560-BUILD-PCT-SUM-VERIFIED.                                     09130000
091400                                                                  09140000
091500     STRING ' 6560-BUILD-PCT-SUM-VERIFIED'                        09150000
091600         DELIMITED BY SIZE                                        09160000
091700         INTO PV-CICS-MSG-AREA.                                   09170000
091800     PERFORM 9990-WRITE-CICS.                                     09180000
091900                                                                  09190000
092000     IF PS-NO-WORK-STARTED                                        09200000
092100        MOVE +1                  TO PV-RCVR-WRKD-QTY              09210000
092200     ELSE                                                         09220000
092300        MOVE +0                  TO PV-RCVR-WRKD-QTY              09230000
092400     END-IF.                                                      09240000
092500     PERFORM 8500-UPDATE-PCT-SUM-VERIFIED.                        09250000
092600                                                                  09260000
092700     IF SQLCODE = +100                                            09270000
092800         INITIALIZE DCLPCT00006                                   09280000
092900         MOVE PC238-BUSINES-DTE      TO PCT00006-BUS-DTE          09290000
093000         MOVE PC238-WRKD-OPER-UNT-ID TO PCT00006-OPER-UNT-ID      09300000
093100         MOVE PC238-SHFT-NBR         TO PCT00006-SHFT-NBR         09310000
093200         MOVE PV-UPDT-UNIT-QTY       TO PCT00006-UNT-VRFD-QTY     09320000
093300         MOVE PV-UPDT-CART-QTY       TO PCT00006-CART-VRFD-QTY    09330000
093400         MOVE PV-RCVR-WRKD-QTY       TO PCT00006-PO-RCVR-VRFD-QTY 09340000
093500         MOVE PV-UPDT-EXTD-RTL       TO PCT00006-EXTD-RTL-VRFD-AMT09350000
093600         PERFORM 8600-INSERT-PCT-SUM-VERIFIED                     09360000
093700     END-IF.                                                      09370000
093800                                                                  09380000
093900****************************************************************  09390000
094000* CALL VERIFY ADJUSTMENT MODULE TO SEND TO RMS-PO              *  09400000
094100****************************************************************  09410000
094200 6600-VERIFY-ADJUST.                                              09420000
094300     PERFORM 8710-GET-TKRPRPM-RMS.                                09430000
094400                                                                  09440000
094410     IF  PS-PROCESS-RMS-INTERFACE-YES                             09441000
094420       PERFORM 6610-GET-RECITM                                    09442000
094421       IF RECITM-ITM-NBR = ZEROS                                  09442100
094422            EXEC CICS                                             09442200
094423                DELETEQ TS                                        09442300
094424                    QUEUE (PC238-VRFY-ADJ-QUEUE-NAME)             09442400
094425                    RESP  (PV-CICS-RESP)                          09442500
094426            END-EXEC                                              09442600
094427                                                                  09442700
094428            EVALUATE PV-CICS-RESP                                 09442800
094429                WHEN DFHRESP(NORMAL)                              09442900
094430                    CONTINUE                                      09443000
094431                WHEN DFHRESP(QIDERR)                              09443100
094432                    CONTINUE                                      09443200
094433                WHEN OTHER                                        09443300
094434                    CONTINUE                                      09443400
094435            END-EVALUATE                                          09443500
094436       ELSE                                                       09443600
094437         IF  RECITM-PREPK-ID = ZEROS                              09443700
094438         OR  PC238-ODD-UNIT-YES                                   09443800
094439             MOVE SPACES TO PC238-VRFY-ADJ-DRIVE-LNE              09443900
094440             IF  PC238-MOD-UNSUCCESSFUL                           09444000
094441                 CONTINUE                                         09444100
094442             ELSE                                                 09444200
094443                 PERFORM 6620-LINK-VRFY-ADJ                       09444300
094444             END-IF                                               09444400
094445         ELSE                                                     09444500
094446             IF  RECITM-PREPK-ID > ZEROS                          09444600
094447             AND RECITM-PREPK-DRV-LNE-CDE = 'A'                   09444700
094448                 MOVE  RECITM-PREPK-DRV-LNE-CDE                   09444800
094449                   TO  PC238-VRFY-ADJ-DRIVE-LNE                   09444900
094450                 IF  PC238-MOD-UNSUCCESSFUL                       09445000
094451                     CONTINUE                                     09445100
094452                 ELSE                                             09445200
094453                     PERFORM 6620-LINK-VRFY-ADJ                   09445300
094454                 END-IF                                           09445400
094455             END-IF                                               09445500
094456         END-IF                                                   09445600
094457       END-IF                                                     09445700
094458     ELSE                                                         09445800
094459         EXEC CICS                                                09445900
094460             DELETEQ TS                                           09446000
094461                 QUEUE (PC238-VRFY-ADJ-QUEUE-NAME)                09446100
094462                 RESP  (PV-CICS-RESP)                             09446200
094463         END-EXEC                                                 09446300
094464                                                                  09446400
094465         EVALUATE PV-CICS-RESP                                    09446500
094466             WHEN DFHRESP(NORMAL)                                 09446600
094467                 CONTINUE                                         09446700
094468             WHEN DFHRESP(QIDERR)                                 09446800
094469                 CONTINUE                                         09446900
094470             WHEN OTHER                                           09447000
094471                 CONTINUE                                         09447100
094472         END-EVALUATE                                             09447200
094473     END-IF.                                                      09447300
094474*                                                                 09447400
094475*        IF  RECITM-PREPK-ID  =  ZEROES            OR             09447500
094476*           (RECITM-PREPK-ID  >  ZEROES  AND                      09447600
094477*            RECITM-PREPK-DRV-LNE-CDE   =  'A')                   09447700
094478*            MOVE  RECITM-PREPK-DRV-LNE-CDE                       09447800
094479*              TO  PC238-VRFY-ADJ-DRIVE-LNE                       09447900
094480*              IF PC238-MOD-SUCCESSFUL                            09448000
094481*                 PERFORM 6620-LINK-VRFY-ADJ                      09448100
094482*              END-IF                                             09448200
094483*        END-IF                                                   09448300
094484                                                                  09448400
094485                                                                  09448500
094486 6610-GET-RECITM.                                                 09448600
094487     STRING ' 6610-GET-RECITM '                                   09448700
094488         DELIMITED BY SIZE                                        09448800
094489         INTO PV-CICS-MSG-AREA.                                   09448900
094490     PERFORM 9990-WRITE-CICS.                                     09449000
094491                                                                  09449100
094492     EXEC SQL                                                     09449200
094493          SELECT PREPK_ID                                         09449300
094494                ,PREPK_DRV_LNE_CDE                                09449400
094495                ,ITM_NBR                                          09449500
094496           INTO  :RECITM-PREPK-ID                                 09449600
094497                ,:RECITM-PREPK-DRV-LNE-CDE                        09449700
094498                ,:RECITM-ITM-NBR                                  09449800
094499            FROM TRECITM                                          09449900
094500           WHERE ORD_NBR             = :DK-PO-NBR                 09450000
094501             AND REC_SEQ_NBR         = :DK-RCVR-SEQ-NBR           09450100
094502             AND ORD_LNE_NBR         = :DK-PO-LINE-NBR            09450200
094503     END-EXEC.                                                    09450300
094504                                                                  09450400
094505     EVALUATE TRUE                                                09450500
094506         WHEN SQLCODE = ZERO                                      09450600
094507             CONTINUE                                             09450700
094508         WHEN SQLWARN0 NOT = SPACES                               09450800
094509         WHEN SQLCODE NOT EQUAL ZERO                              09450900
094510             MOVE '6610-GET-RECITM'                               09451000
094520                             TO DP013-PARAGRAPH                   09452000
094521             MOVE DK-PO-NBR        TO PV-DISPLAY-PO-NBR           09452100
094522             MOVE DK-RCVR-SEQ-NBR  TO PV-DISPLAY-RCVR-SEQ-NBR     09452200
094523             MOVE DK-PO-LINE-NBR   TO PV-DISPLAY-PO-LINE-NBR      09452300
094524             STRING 'PO NBR: '                                    09452400
094525                 PV-DISPLAY-PO-NBR    DELIMITED BY SIZE           09452500
094526                                 INTO DP013-MESSAGE-TEXT(1)       09452600
094527             STRING 'RECV SEQ: '                                  09452700
094528                 PV-DISPLAY-RCVR-SEQ-NBR                          09452800
094529                                      DELIMITED BY SIZE           09452900
094530                                 INTO DP013-MESSAGE-TEXT(2)       09453000
094531             STRING 'PO LINE NBR: '   DELIMITED BY SIZE           09453100
094532                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          09453200
094533                                 INTO DP013-MESSAGE-TEXT(3)       09453300
094534             MOVE SQLCA      TO DP013-SQLCA                       09453400
094535             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 09453500
094536             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME(1)           09453600
094537                                PC238-BAD-TABLE-NAME              09453700
094538             SET PC238-DB2-FUNCTION-SELECT TO TRUE                09453800
094539             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                09453900
094540             SET DP013-DB2-ABEND           TO TRUE                09454000
094541             SET DP013-NO-ROLLBACK         TO TRUE                09454100
094542             PERFORM 9999-WRITE-CICS-LOG-MSG                      09454200
094543     END-EVALUATE.                                                09454300
094544                                                                  09454400
094545                                                                  09454500
094546 6620-LINK-VRFY-ADJ.                                              09454600
094547                                                                  09454700
094548     EXEC CICS                                                    09454800
094549          LINK PROGRAM  (PC-VERIFY-ADJUST-PGM)                    09454900
094550               COMMAREA (PC238-COMM-AREA)                         09455000
094551               RESP     (PV-CICS-RESP)                            09455100
094552     END-EXEC                                                     09455200
094553                                                                  09455300
094554     EVALUATE TRUE                                                09455400
094555         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     09455500
094556              CONTINUE                                            09455600
094557         WHEN OTHER                                               09455700
094558             MOVE '6620-LINK-VRFY-ADJ'                            09455800
094559                             TO DP013-PARAGRAPH                   09455900
094560             MOVE DK-PO-NBR        TO PV-DISPLAY-PO-NBR           09456000
094561             MOVE DK-RCVR-SEQ-NBR  TO PV-DISPLAY-RCVR-SEQ-NBR     09456100
094562             MOVE DK-PO-LINE-NBR   TO PV-DISPLAY-PO-LINE-NBR      09456200
094563             STRING 'PO NBR: '                                    09456300
094564                 PV-DISPLAY-PO-NBR    DELIMITED BY SIZE           09456400
094565                                 INTO DP013-MESSAGE-TEXT(1)       09456500
094566             STRING 'RECV SEQ: '                                  09456600
094567                 PV-DISPLAY-RCVR-SEQ-NBR                          09456700
094568                                      DELIMITED BY SIZE           09456800
094569                                 INTO DP013-MESSAGE-TEXT(2)       09456900
094570             STRING 'PO LINE NBR: '   DELIMITED BY SIZE           09457000
094571                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          09457100
094572                                 INTO DP013-MESSAGE-TEXT(3)       09457200
094573             MOVE SQLCA      TO DP013-SQLCA                       09457300
094574             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 09457400
094575             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME(1)           09457500
094576                                PC238-BAD-TABLE-NAME              09457600
094577             SET PC238-DB2-FUNCTION-SELECT TO TRUE                09457700
094578             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                09457800
094579             SET DP013-DB2-ABEND           TO TRUE                09457900
094580             SET DP013-NO-ROLLBACK         TO TRUE                09458000
094590             PERFORM 9999-WRITE-CICS-LOG-MSG                      09459000
094600     END-EVALUATE.                                                09460000
094601                                                                  09460100
094602                                                                  09460200
094603 7000-SELECT-RETAIL-PRICE.                                        09460300
094604     STRING ' 7000-SELECT-RETAIL-PRICE'                           09460400
094605         DELIMITED BY SIZE                                        09460500
094606         INTO PV-CICS-MSG-AREA.                                   09460600
094607     PERFORM 9990-WRITE-CICS.                                     09460700
094608     EXEC SQL                                                     09460800
094609          SELECT UNT_RTL_PR_AMT                                   09460900
094610           INTO  :PURITM-UNT-RTL-PR-AMT                           09461000
094620            FROM TRECITM A                                        09462000
094630                ,TPURITM B                                        09463000
094640           WHERE A.ORD_NBR           = :DK-PO-NBR                 09464000
094650             AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR           09465000
094660             AND A.ORD_LNE_NBR       = :DK-PO-LINE-NBR            09466000
094670             AND A.ORD_NBR           = B.PO_NBR                   09467000
094680             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           09468000
094690             AND A.PO_VER_NBR        = B.VER_NBR                  09469000
094700             WITH UR                                              09470000
094800     END-EXEC.                                                    09480000
094900                                                                  09490000
095000     EVALUATE TRUE                                                09500000
095100         WHEN SQLCODE = ZERO                                      09510000
095200             MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC 09520000
095300         WHEN SQLWARN0 NOT = SPACES                               09530000
095400         WHEN SQLCODE NOT EQUAL ZERO                              09540000
095500             MOVE '7000-SELECT-RETAIL-PRICE'                      09550000
095600                             TO DP013-PARAGRAPH                   09560000
095700             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        09570000
095800             STRING 'PO NBR: '         DELIMITED BY SIZE          09580000
095900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          09590000
096000                           INTO DP013-MESSAGE-TEXT(1)             09600000
096100             MOVE DK-RCVR-SEQ-NBR                                 09610000
096200                             TO PV-DISPLAY-RCVR-SEQ-NBR           09620000
096300             STRING 'RECV SEQ: '       DELIMITED BY SIZE          09630000
096400                 PV-DISPLAY-RCVR-SEQ-NBR                          09640000
096500                                       DELIMITED BY SIZE          09650000
096600                           INTO DP013-MESSAGE-TEXT(2)             09660000
096700             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   09670000
096800             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          09680000
096900                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          09690000
097000                           INTO DP013-MESSAGE-TEXT(3)             09700000
097100             MOVE SQLCA      TO DP013-SQLCA                       09710000
097200             MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME(1)           09720000
097300                                PC238-BAD-TABLE-NAME              09730000
097400             MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME(2)           09740000
097500             SET PC238-DB2-FUNCTION-SELECT TO TRUE                09750000
097600             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                09760000
097700             SET DP013-DB2-ABEND                                  09770000
097800                             TO TRUE                              09780000
097900             SET DP013-NO-ROLLBACK                                09790000
098000                             TO TRUE                              09800000
098100             PERFORM 9999-WRITE-CICS-LOG-MSG                      09810000
098200     END-EVALUATE.                                                09820000
098300                                                                  09830000
098400 7100-SUM-PREVIOUS-UPLOADS.                                       09840000
098500     STRING ' 7100-SUM-PREVIOUS-UPLOADS'                          09850000
098600         DELIMITED BY SIZE                                        09860000
098700         INTO PV-CICS-MSG-AREA.                                   09870000
098800     PERFORM 9990-WRITE-CICS.                                     09880000
098900     EXEC SQL                                                     09890000
099000          SELECT SUM(UNT_QTY)                                     09900000
099100           INTO  :PV-SUM-UNIT-QTY                                 09910000
099200            FROM PCT_RCVR_LNE_DTL                                 09920000
099300           WHERE PO_NBR              = :DK-PO-NBR                 09930000
099400             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           09940000
099500             AND PO_LNE_NBR          = :DK-PO-LINE-NBR            09950000
099600             AND ACTN_CDE           IN (:PC-P, :PC-Q)             09960000
099700     END-EXEC.                                                    09970000
099800                                                                  09980000
099900     EVALUATE TRUE                                                09990000
100000         WHEN SQLCODE = ZERO                                      10000000
100100             CONTINUE                                             10010000
100200         WHEN SQLCODE = +100                                      10020000
100300         WHEN SQLCODE = -305                                      10030000
100400             MOVE +0     TO PV-SUM-UNIT-QTY                       10040000
100500         WHEN SQLWARN0 NOT = SPACES                               10050000
100600         WHEN SQLCODE NOT EQUAL ZERO                              10060000
100700             MOVE '7100-SUM-PREVIOUS-UPLOADS'                     10070000
100800                             TO DP013-PARAGRAPH                   10080000
100900             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        10090000
101000             STRING 'PO NBR: '         DELIMITED BY SIZE          10100000
101100                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          10110000
101200                           INTO DP013-MESSAGE-TEXT(1)             10120000
101300             MOVE DK-RCVR-SEQ-NBR                                 10130000
101400                             TO PV-DISPLAY-RCVR-SEQ-NBR           10140000
101500             STRING 'RECV SEQ: '       DELIMITED BY SIZE          10150000
101600                 PV-DISPLAY-RCVR-SEQ-NBR                          10160000
101700                                       DELIMITED BY SIZE          10170000
101800                           INTO DP013-MESSAGE-TEXT(2)             10180000
101900             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   10190000
102000             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          10200000
102100                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          10210000
102200                           INTO DP013-MESSAGE-TEXT(3)             10220000
102300             MOVE SQLCA      TO DP013-SQLCA                       10230000
102400             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 10240000
102500             MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)           10250000
102600                                PC238-BAD-TABLE-NAME              10260000
102700             SET PC238-DB2-FUNCTION-SELECT TO TRUE                10270000
102800             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                10280000
102900             SET DP013-DB2-ABEND                                  10290000
103000                             TO TRUE                              10300000
103100             SET DP013-NO-ROLLBACK                                10310000
103200                             TO TRUE                              10320000
103300             PERFORM 9999-WRITE-CICS-LOG-MSG                      10330000
103400     END-EVALUATE.                                                10340000
103500                                                                  10350000
103600 7200-CHECK-IF-WORK-STARTED.                                      10360000
103700     STRING ' 7200-CHECK-IF-WORK-STARTED'                         10370000
103800         DELIMITED BY SIZE                                        10380000
103900         INTO PV-CICS-MSG-AREA.                                   10390000
104000     PERFORM 9990-WRITE-CICS.                                     10400000
104100                                                                  10410000
104200     MOVE PC238-SHFT-NBR          TO DK-SHIFT-NBR.                10420000
104300                                                                  10430000
104400     EXEC SQL                                                     10440000
104500          SELECT PO_NBR                                           10450000
104600           INTO  :PCT00007-PO-NBR                                 10460000
104700            FROM PCT_RCVR_LNE_DTL                                 10470000
104800           WHERE PO_NBR              = :DK-PO-NBR                 10480000
104900             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           10490000
105000             AND BUS_DTE             = :DK-BUS-DTE                10500000
105100             AND SHFT_NBR            = :DK-SHIFT-NBR              10510000
105200             AND PRCG_AREA_CDE       = :DK-PRCG-AREA-CDE          10520000
105300     END-EXEC.                                                    10530000
105400                                                                  10540000
105500     EVALUATE TRUE                                                10550000
105600         WHEN SQLCODE = ZERO                                      10560000
105700         WHEN SQLCODE = -811                                      10570000
105800             SET PS-WORK-STARTED  TO TRUE                         10580000
105900         WHEN SQLCODE = +100                                      10590000
106000             SET PS-NO-WORK-STARTED  TO TRUE                      10600000
106100         WHEN SQLWARN0 NOT = SPACES                               10610000
106200         WHEN SQLCODE NOT EQUAL ZERO                              10620000
106300             MOVE '7200-CHECK-IF-WORK-STARTED'                    10630000
106400                             TO DP013-PARAGRAPH                   10640000
106500             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        10650000
106600             STRING 'PO NBR: '         DELIMITED BY SIZE          10660000
106700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          10670000
106800                           INTO DP013-MESSAGE-TEXT(1)             10680000
106900             MOVE DK-RCVR-SEQ-NBR                                 10690000
107000                             TO PV-DISPLAY-RCVR-SEQ-NBR           10700000
107100             STRING 'RECV SEQ: '       DELIMITED BY SIZE          10710000
107200                 PV-DISPLAY-RCVR-SEQ-NBR                          10720000
107300                                       DELIMITED BY SIZE          10730000
107400                           INTO DP013-MESSAGE-TEXT(2)             10740000
107500             STRING 'BUS DATE:  '      DELIMITED BY SIZE          10750000
107600                DK-BUS-DTE             DELIMITED BY SIZE          10760000
107700                           INTO DP013-MESSAGE-TEXT(3)             10770000
107800             MOVE DK-SHIFT-NBR        TO PV-DISPLAY-SHIFT         10780000
107900             STRING 'SHIFT, PROCESS AREA '                        10790000
108000                                       DELIMITED BY SIZE          10800000
108100                PV-DISPLAY-SHIFT       DELIMITED BY SIZE          10810000
108200                ' '                    DELIMITED BY SIZE          10820000
108300                DK-PRCG-AREA-CDE       DELIMITED BY SIZE          10830000
108400                           INTO DP013-MESSAGE-TEXT(4)             10840000
108500             MOVE SQLCA      TO DP013-SQLCA                       10850000
108600             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 10860000
108700             MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)           10870000
108800                                PC238-BAD-TABLE-NAME              10880000
108900             SET PC238-DB2-FUNCTION-SELECT TO TRUE                10890000
109000             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                10900000
109100             SET DP013-DB2-ABEND                                  10910000
109200                             TO TRUE                              10920000
109300             SET DP013-NO-ROLLBACK                                10930000
109400                             TO TRUE                              10940000
109500             PERFORM 9999-WRITE-CICS-LOG-MSG                      10950000
109600     END-EVALUATE.                                                10960000
109700                                                                  10970000
109800 7300-INSERT-LINE-DETAIL.                                         10980000
109900     STRING ' 7300-INSERT-LINE-DETAIL'                            10990000
110000         DELIMITED BY SIZE                                        11000000
110100         INTO PV-CICS-MSG-AREA.                                   11010000
110200     PERFORM 9990-WRITE-CICS.                                     11020000
110300     EXEC SQL                                                     11030000
110400        INSERT INTO PCT_RCVR_LNE_DTL                              11040000
110500               (PO_NBR                                            11050000
110600             ,  RCVR_SEQ_NBR                                      11060000
110700             ,  PO_LNE_NBR                                        11070000
110800             ,  ACTN_CDE                                          11080000
110900             ,  WRKD_UNT_TMST                                     11090000
111000             ,  BUS_DTE                                           11100000
111100             ,  OPER_UNT_ID                                       11110000
111200             ,  SHFT_NBR                                          11120000
111300             ,  UNT_QTY                                           11130000
111400             ,  CART_QTY                                          11140000
111500             ,  PRCG_AREA_CDE                                     11150000
111600             ,  EXTD_RTL_AMT)                                     11160000
111700        VALUES (:PCT00007-PO-NBR                                  11170000
111800             ,  :PCT00007-RCVR-SEQ-NBR                            11180000
111900             ,  :PCT00007-PO-LNE-NBR                              11190000
112000             ,  :PCT00007-ACTN-CDE                                11200000
112100             ,  :PCT00007-WRKD-UNT-TMST                           11210000
112200             ,  :PCT00007-BUS-DTE                                 11220000
112300             ,  :PCT00007-OPER-UNT-ID                             11230000
112400             ,  :PCT00007-SHFT-NBR                                11240000
112500             ,  :PCT00007-UNT-QTY                                 11250000
112600             ,  :PCT00007-CART-QTY                                11260000
112700             ,  :PCT00007-PRCG-AREA-CDE                           11270000
112800             ,  :PCT00007-EXTD-RTL-AMT)                           11280000
112900     END-EXEC.                                                    11290000
113000                                                                  11300000
113100     EVALUATE TRUE                                                11310000
113200         WHEN SQLCODE = ZERO                                      11320000
113300             CONTINUE                                             11330000
113400         WHEN SQLWARN0 NOT = SPACES                               11340000
113500         WHEN SQLCODE NOT EQUAL ZERO                              11350000
113600             MOVE '7300-INSERT-LINE-DETAIL'                       11360000
113700                             TO DP013-PARAGRAPH                   11370000
113800             MOVE PCT00007-PO-NBR     TO PV-DISPLAY-PO-NBR        11380000
113900             MOVE PCT00007-RCVR-SEQ-NBR                           11390000
114000                             TO PV-DISPLAY-RCVR-SEQ-NBR           11400000
114100             MOVE PCT00007-PO-LNE-NBR TO PV-DISPLAY-PO-LINE-NBR   11410000
114200             MOVE PCT00007-SHFT-NBR   TO PV-DISPLAY-SHIFT         11420000
114300             STRING 'PO NBR: '         DELIMITED BY SIZE          11430000
114400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          11440000
114500                    ' - RECV SEQ: '    DELIMITED BY SIZE          11450000
114600                 PV-DISPLAY-RCVR-SEQ-NBR                          11460000
114700                                       DELIMITED BY SIZE          11470000
114800                           INTO DP013-MESSAGE-TEXT(1)             11480000
114900             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          11490000
115000                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          11500000
115100                    ' - ACTION CODE: ' DELIMITED BY SIZE          11510000
115200                PCT00007-ACTN-CDE      DELIMITED BY SIZE          11520000
115300                           INTO DP013-MESSAGE-TEXT(2)             11530000
115400             STRING 'WORKED TMST: '    DELIMITED BY SIZE          11540000
115500                 PCT00007-WRKD-UNT-TMST                           11550000
115600                                       DELIMITED BY SIZE          11560000
115700                           INTO DP013-MESSAGE-TEXT(3)             11570000
115800             STRING 'BUSINESS DATE: '  DELIMITED BY SIZE          11580000
115900                PCT00007-BUS-DTE       DELIMITED BY SIZE          11590000
116000                    ' - SHIFT: '       DELIMITED BY SIZE          11600000
116100                PV-DISPLAY-SHIFT       DELIMITED BY SIZE          11610000
116200                           INTO DP013-MESSAGE-TEXT(4)             11620000
116300             MOVE SQLCA      TO DP013-SQLCA                       11630000
116400             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 11640000
116500             MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)           11650000
116600                                PC238-BAD-TABLE-NAME              11660000
116700             SET PC238-DB2-FUNCTION-INSERT TO TRUE                11670000
116800             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                11680000
116900             SET DP013-DB2-ABEND                                  11690000
117000                             TO TRUE                              11700000
117100             SET DP013-NO-ROLLBACK                                11710000
117200                             TO TRUE                              11720000
117300             PERFORM 9999-WRITE-CICS-LOG-MSG                      11730000
117400     END-EVALUATE.                                                11740000
117500                                                                  11750000
117600 7400-UPDATE-PCT-SUM-WORK.                                        11760000
117700     STRING ' 7400-UPDATE-PCT-SUM-WORK'                           11770000
117800         DELIMITED BY SIZE                                        11780000
117900         INTO PV-CICS-MSG-AREA.                                   11790000
118000     PERFORM 9990-WRITE-CICS.                                     11800000
118100     EXEC SQL                                                     11810000
118200          UPDATE PCT_SUM_WRKD                                     11820000
118300          SET    PO_RCVR_WRKD_QTY = PO_RCVR_WRKD_QTY +            11830000
118400                                                :PV-RCVR-WRKD-QTY 11840000
118500               , UNT_WRKD_QTY     = UNT_WRKD_QTY + :PV-UPDATE-QTY 11850000
118600               , EXTD_RTL_WRKD_AMT = EXTD_RTL_WRKD_AMT +          11860000
118700                                     :PCT00005-EXTD-RTL-WRKD-AMT  11870000
118800          WHERE  BUS_DTE          = :DK-BUS-DTE                   11880000
118900            AND  OPER_UNT_ID      = :DK-OPER-UNT-ID               11890000
119000            AND  SHFT_NBR         = :DK-SHIFT-NBR                 11900000
119100            AND  PRCG_AREA_CDE    = :DK-PRCG-AREA-CDE             11910000
119200     END-EXEC.                                                    11920000
119300                                                                  11930000
119400     EVALUATE TRUE                                                11940000
119500         WHEN SQLCODE = ZERO                                      11950000
119600         WHEN SQLCODE = +100                                      11960000
119700             CONTINUE                                             11970000
119800         WHEN SQLWARN0 NOT = SPACES                               11980000
119900         WHEN SQLCODE NOT EQUAL ZERO                              11990000
120000             MOVE '7400-UPDATE-PCT-SUM-WORK'                      12000000
120100                             TO DP013-PARAGRAPH                   12010000
120200             STRING 'BUSINESS DATE '   DELIMITED BY SIZE          12020000
120300                 DK-BUS-DTE            DELIMITED BY SIZE          12030000
120400                           INTO DP013-MESSAGE-TEXT(1)             12040000
120500             MOVE DK-OPER-UNT-ID   TO PV-DISPLAY-OPER-UNT-ID      12050000
120600             STRING 'OPER UNIT '       DELIMITED BY SIZE          12060000
120700                 PV-DISPLAY-OPER-UNT-ID                           12070000
120800                                       DELIMITED BY SIZE          12080000
120900                           INTO DP013-MESSAGE-TEXT(2)             12090000
121000             MOVE DK-SHIFT-NBR        TO PV-DISPLAY-SHIFT         12100000
121100             STRING 'SHIFT NUMBER '    DELIMITED BY SIZE          12110000
121200                PV-DISPLAY-SHIFT       DELIMITED BY SIZE          12120000
121300                           INTO DP013-MESSAGE-TEXT(3)             12130000
121400             STRING 'PROCESS AREA: '   DELIMITED BY SIZE          12140000
121500                DK-PRCG-AREA-CDE       DELIMITED BY SIZE          12150000
121600                           INTO DP013-MESSAGE-TEXT(4)             12160000
121700             MOVE SQLCA      TO DP013-SQLCA                       12170000
121800             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 12180000
121900             MOVE 'PCT00005' TO DP013-DB2-TABLE-NAME(1)           12190000
122000                                PC238-BAD-TABLE-NAME              12200000
122100             SET PC238-DB2-FUNCTION-UPDATE TO TRUE                12210000
122200             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                12220000
122300             SET DP013-DB2-ABEND                                  12230000
122400                             TO TRUE                              12240000
122500             SET DP013-NO-ROLLBACK                                12250000
122600                             TO TRUE                              12260000
122700             PERFORM 9999-WRITE-CICS-LOG-MSG                      12270000
122800     END-EVALUATE.                                                12280000
122900                                                                  12290000
123000 7500-INSERT-PCT-SUM-WORK.                                        12300000
123100     STRING ' 7500-INSERT-PCT-SUM-WORK'                           12310000
123200         DELIMITED BY SIZE                                        12320000
123300         INTO PV-CICS-MSG-AREA.                                   12330000
123400     PERFORM 9990-WRITE-CICS.                                     12340000
123500     MOVE PV-RCVR-WRKD-QTY TO PCT00005-PO-RCVR-WRKD-QTY.          12350000
123600     EXEC SQL                                                     12360000
123700        INSERT INTO PCT_SUM_WRKD                                  12370000
123800               (BUS_DTE                                           12380000
123900             ,  OPER_UNT_ID                                       12390000
124000             ,  SHFT_NBR                                          12400000
124100             ,  PRCG_AREA_CDE                                     12410000
124200             ,  UNT_WRKD_QTY                                      12420000
124300             ,  CART_WRKD_QTY                                     12430000
124400             ,  PO_RCVR_WRKD_QTY                                  12440000
124500             ,  EXTD_RTL_WRKD_AMT)                                12450000
124600        VALUES (:PCT00005-BUS-DTE                                 12460000
124700             ,  :PCT00005-OPER-UNT-ID                             12470000
124800             ,  :PCT00005-SHFT-NBR                                12480000
124900             ,  :PCT00005-PRCG-AREA-CDE                           12490000
125000             ,  :PCT00005-UNT-WRKD-QTY                            12500000
125100             ,  :PCT00005-CART-WRKD-QTY                           12510000
125200             ,  :PCT00005-PO-RCVR-WRKD-QTY                        12520000
125300             ,  :PCT00005-EXTD-RTL-WRKD-AMT)                      12530000
125400     END-EXEC.                                                    12540000
125500                                                                  12550000
125600     EVALUATE TRUE                                                12560000
125700         WHEN SQLCODE = ZERO                                      12570000
125800             CONTINUE                                             12580000
125801                                                                  12580130
125802** DMH 11/12/14 - BEGIN                                           12580230
125810         WHEN SQLCODE = -803                                      12581031
125820             PERFORM 7400-UPDATE-PCT-SUM-WORK                     12582030
125833** DMH 11/12/14 - END                                             12583330
125840                                                                  12584030
125900         WHEN SQLWARN0 NOT = SPACES                               12590000
126000         WHEN SQLCODE NOT EQUAL ZERO                              12600000
126100             MOVE '7500-INSERT-PCT-SUM-WORK'                      12610000
126200                             TO DP013-PARAGRAPH                   12620000
126300             STRING 'BUSINESS DATE '   DELIMITED BY SIZE          12630000
126400                 DK-BUS-DTE            DELIMITED BY SIZE          12640000
126500                           INTO DP013-MESSAGE-TEXT(1)             12650000
126600             MOVE DK-OPER-UNT-ID   TO PV-DISPLAY-OPER-UNT-ID      12660000
126700             STRING 'OPER UNIT '       DELIMITED BY SIZE          12670000
126800                 PV-DISPLAY-OPER-UNT-ID                           12680000
126900                                       DELIMITED BY SIZE          12690000
127000                           INTO DP013-MESSAGE-TEXT(2)             12700000
127100             MOVE DK-SHIFT-NBR        TO PV-DISPLAY-SHIFT         12710000
127200             STRING 'SHIFT NUMBER '    DELIMITED BY SIZE          12720000
127300                PV-DISPLAY-SHIFT       DELIMITED BY SIZE          12730000
127400                           INTO DP013-MESSAGE-TEXT(3)             12740000
127500             STRING 'PROCESS AREA: '   DELIMITED BY SIZE          12750000
127600                DK-PRCG-AREA-CDE       DELIMITED BY SIZE          12760000
127700                           INTO DP013-MESSAGE-TEXT(4)             12770000
127800             MOVE SQLCA      TO DP013-SQLCA                       12780000
127900             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 12790000
128000             MOVE 'PCT00005' TO DP013-DB2-TABLE-NAME(1)           12800000
128100                                PC238-BAD-TABLE-NAME              12810000
128200             SET PC238-DB2-FUNCTION-INSERT TO TRUE                12820000
128300             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                12830000
128400             SET DP013-DB2-ABEND                                  12840000
128500                             TO TRUE                              12850000
128600             SET DP013-NO-ROLLBACK                                12860000
128700                             TO TRUE                              12870000
128800             PERFORM 9999-WRITE-CICS-LOG-MSG                      12880000
128900     END-EVALUATE.                                                12890000
129000                                                                  12900000
129100 7600-SUM-PREVIOUS-CONFIRMS.                                      12910000
129200     STRING ' 7600-SUM-PREVIOUS-CONFIRMS'                         12920000
129300         DELIMITED BY SIZE                                        12930000
129400         INTO PV-CICS-MSG-AREA.                                   12940000
129500     PERFORM 9990-WRITE-CICS.                                     12950000
129600                                                                  12960000
129700     EXEC SQL                                                     12970000
129800          SELECT SUM(UNT_QTY)                                     12980000
129900           INTO  :PV-SUM-UNIT-QTY                                 12990000
130000            FROM PCT_RCVR_LNE_DTL                                 13000000
130100           WHERE PO_NBR              = :DK-PO-NBR                 13010000
130200             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           13020000
130300             AND PO_LNE_NBR          = :DK-PO-LINE-NBR            13030000
130400             AND ACTN_CDE           IN (:PC-A, :PC-C)             13040000
130500     END-EXEC.                                                    13050000
130600                                                                  13060000
130700     EVALUATE TRUE                                                13070000
130800         WHEN SQLCODE = ZERO                                      13080000
130900             CONTINUE                                             13090000
131000         WHEN SQLCODE = +100                                      13100000
131100         WHEN SQLCODE = -305                                      13110000
131200             MOVE +0     TO PV-SUM-UNIT-QTY                       13120000
131300         WHEN SQLWARN0 NOT = SPACES                               13130000
131400         WHEN SQLCODE NOT EQUAL ZERO                              13140000
131500             MOVE '7600-SUM-PREVIOUS-CONFIRMS'                    13150000
131600                             TO DP013-PARAGRAPH                   13160000
131700             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        13170000
131800             STRING 'PO NBR: '         DELIMITED BY SIZE          13180000
131900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          13190000
132000                           INTO DP013-MESSAGE-TEXT(1)             13200000
132100             MOVE DK-RCVR-SEQ-NBR                                 13210000
132200                             TO PV-DISPLAY-RCVR-SEQ-NBR           13220000
132300             STRING 'RECV SEQ: '       DELIMITED BY SIZE          13230000
132400                 PV-DISPLAY-RCVR-SEQ-NBR                          13240000
132500                                       DELIMITED BY SIZE          13250000
132600                           INTO DP013-MESSAGE-TEXT(2)             13260000
132700             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   13270000
132800             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          13280000
132900                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          13290000
133000                           INTO DP013-MESSAGE-TEXT(3)             13300000
133100             MOVE SQLCA      TO DP013-SQLCA                       13310000
133200             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 13320000
133300             MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)           13330000
133400                                PC238-BAD-TABLE-NAME              13340000
133500             SET PC238-DB2-FUNCTION-SELECT TO TRUE                13350000
133600             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                13360000
133700             SET DP013-DB2-ABEND                                  13370000
133800                             TO TRUE                              13380000
133900             SET DP013-NO-ROLLBACK                                13390000
134000                             TO TRUE                              13400000
134100             PERFORM 9999-WRITE-CICS-LOG-MSG                      13410000
134200     END-EVALUATE.                                                13420000
134300                                                                  13430000
134400 7700-SUM-PREVIOUS-VERIFIED.                                      13440000
134500     STRING ' 7700-SUM-PREVIOUS-VERIFIED'                         13450000
134600         DELIMITED BY SIZE                                        13460000
134700         INTO PV-CICS-MSG-AREA.                                   13470000
134800     PERFORM 9990-WRITE-CICS.                                     13480000
134900     EXEC SQL                                                     13490000
135000          SELECT SUM(UNT_QTY)                                     13500000
135100           INTO  :PV-SUM-UNIT-QTY                                 13510000
135200            FROM PCT_RCVR_LNE_DTL                                 13520000
135300           WHERE PO_NBR              = :DK-PO-NBR                 13530000
135400             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           13540000
135500             AND PO_LNE_NBR          = :DK-PO-LINE-NBR            13550000
135600             AND ACTN_CDE           IN (:PC-A, :PC-B, :PC-C,      13560000
135700                                        :PC-P, :PC-V, :PC-Q)      13570000
135710           WITH UR                                                13571033
135800     END-EXEC.                                                    13580000
135900                                                                  13590000
136000     EVALUATE TRUE                                                13600000
136100         WHEN SQLCODE = ZERO                                      13610000
136200             CONTINUE                                             13620000
136300         WHEN SQLCODE = +100                                      13630000
136400         WHEN SQLCODE = -305                                      13640000
136500             MOVE +0     TO PV-SUM-UNIT-QTY                       13650000
136600         WHEN SQLWARN0 NOT = SPACES                               13660000
136700         WHEN SQLCODE NOT EQUAL ZERO                              13670000
136800             MOVE '7700-SUM-PREVIOUS-VERIFIED'                    13680000
136900                             TO DP013-PARAGRAPH                   13690000
137000             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        13700000
137100             STRING 'PO NBR: '         DELIMITED BY SIZE          13710000
137200                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          13720000
137300                           INTO DP013-MESSAGE-TEXT(1)             13730000
137400             MOVE DK-RCVR-SEQ-NBR                                 13740000
137500                             TO PV-DISPLAY-RCVR-SEQ-NBR           13750000
137600             STRING 'RECV SEQ: '       DELIMITED BY SIZE          13760000
137700                 PV-DISPLAY-RCVR-SEQ-NBR                          13770000
137800                                       DELIMITED BY SIZE          13780000
137900                           INTO DP013-MESSAGE-TEXT(2)             13790000
138000             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   13800000
138100             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          13810000
138200                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          13820000
138300                           INTO DP013-MESSAGE-TEXT(3)             13830000
138400             MOVE SQLCA      TO DP013-SQLCA                       13840000
138500             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 13850000
138600             MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)           13860000
138700                                PC238-BAD-TABLE-NAME              13870000
138800             SET PC238-DB2-FUNCTION-SELECT TO TRUE                13880000
138900             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                13890000
139000             SET DP013-DB2-ABEND                                  13900000
139100                             TO TRUE                              13910000
139200             SET DP013-NO-ROLLBACK                                13920000
139300                             TO TRUE                              13930000
139400             PERFORM 9999-WRITE-CICS-LOG-MSG                      13940000
139500     END-EVALUATE.                                                13950000
139600                                                                  13960000
139700 7800-SELECT-TRECEIV.                                             13970000
139800     STRING ' 7800-SELECT-TRECEIV'                                13980000
139900         DELIMITED BY SIZE                                        13990000
140000         INTO PV-CICS-MSG-AREA.                                   14000000
140100     PERFORM 9990-WRITE-CICS.                                     14010000
140200                                                                  14020000
140300     EXEC SQL                                                     14030000
140400*         SELECT SUM(ACTL_CART_CNT)                               14040008
140410          SELECT ACTL_CART_CNT                                    14041008
140420                ,REC_TYP_CDE                                      14042017
140500           INTO  :PV-SUM-ACTUAL-CARTON-COUNT                      14050000
140510                ,:RECEIV-REC-TYP-CDE                              14051017
140600            FROM TRECEIV                                          14060000
140700           WHERE ORD_NBR             = :DK-PO-NBR                 14070000
140800             AND REC_SEQ_NBR         = :DK-RCVR-SEQ-NBR           14080000
140900            WITH UR                                               14090000
141000     END-EXEC.                                                    14100000
141100                                                                  14110000
141200     EVALUATE TRUE                                                14120000
141300         WHEN SQLCODE = ZERO                                      14130000
141400             CONTINUE                                             14140000
141500         WHEN SQLCODE = +100                                      14150000
141600         WHEN SQLCODE = -305                                      14160000
141700             MOVE +0     TO PV-SUM-ACTUAL-CARTON-COUNT            14170000
141800         WHEN SQLWARN0 NOT = SPACES                               14180000
141900         WHEN SQLCODE NOT EQUAL ZERO                              14190000
142000             MOVE '7800-SELECT-TRECEIV'                           14200000
142100                             TO DP013-PARAGRAPH                   14210000
142200             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        14220000
142300             STRING 'PO NBR: '         DELIMITED BY SIZE          14230000
142400                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          14240000
142500                           INTO DP013-MESSAGE-TEXT(1)             14250000
142600             MOVE DK-RCVR-SEQ-NBR                                 14260000
142700                             TO PV-DISPLAY-RCVR-SEQ-NBR           14270000
142800             STRING 'RECV SEQ: '       DELIMITED BY SIZE          14280000
142900                 PV-DISPLAY-RCVR-SEQ-NBR                          14290000
143000                                       DELIMITED BY SIZE          14300000
143100                           INTO DP013-MESSAGE-TEXT(2)             14310000
143200             MOVE SQLCA      TO DP013-SQLCA                       14320000
143300             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 14330000
143400             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           14340017
143500                                PC238-BAD-TABLE-NAME              14350000
143600             SET PC238-DB2-FUNCTION-SELECT TO TRUE                14360000
143700             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                14370000
143800             SET DP013-DB2-ABEND                                  14380000
143900                             TO TRUE                              14390000
144000             SET DP013-NO-ROLLBACK                                14400000
144100                             TO TRUE                              14410000
144200             PERFORM 9999-WRITE-CICS-LOG-MSG                      14420000
144300     END-EVALUATE.                                                14430000
144400                                                                  14440000
144500*----------------------------------------------------------------*14450000
144600* OPEN THE UNIT PRICE CURSOR                                     *14460000
144700*----------------------------------------------------------------*14470000
144800                                                                  14480000
144900 7900-OPEN-RET-PRICE-CURSOR.                                      14490000
145000     STRING ' 7900-OPEN-RET-PRICE-CURSOR'                         14500000
145100         DELIMITED BY SIZE                                        14510000
145200         INTO PV-CICS-MSG-AREA.                                   14520000
145300     PERFORM 9990-WRITE-CICS.                                     14530000
145400                                                                  14540000
145500     EXEC SQL                                                     14550000
145600          OPEN RET-PRICE-CSR                                      14560000
145700     END-EXEC.                                                    14570000
145800                                                                  14580000
145900     EVALUATE TRUE                                                14590000
146000         WHEN SQLCODE = ZERO                                      14600000
146100              CONTINUE                                            14610000
146200         WHEN SQLWARN0 NOT = SPACES                               14620000
146300         WHEN SQLCODE  < ZERO                                     14630000
146400         WHEN SQLCODE  > ZERO                                     14640000
146500              MOVE '7900-OPEN-RET-PRICE-CURSOR'                   14650000
146600                              TO DP013-PARAGRAPH                  14660000
146700              MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR       14670000
146800              STRING 'PO NBR: '         DELIMITED BY SIZE         14680000
146900                  PV-DISPLAY-PO-NBR     DELIMITED BY SIZE         14690000
147000                            INTO DP013-MESSAGE-TEXT(1)            14700000
147100              MOVE DK-RCVR-SEQ-NBR                                14710000
147200                              TO PV-DISPLAY-RCVR-SEQ-NBR          14720000
147300              STRING 'RECV SEQ: '       DELIMITED BY SIZE         14730000
147400                  PV-DISPLAY-RCVR-SEQ-NBR                         14740000
147500                                        DELIMITED BY SIZE         14750000
147600                            INTO DP013-MESSAGE-TEXT(2)            14760000
147700              MOVE SQLCA      TO DP013-SQLCA                      14770000
147800             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 14780000
147900              MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME(1)          14790000
148000                                 PC238-BAD-TABLE-NAME             14800000
148100              MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME(2)          14810000
148200              SET PC238-DB2-FUNCTION-OPEN   TO TRUE               14820000
148300              SET PC238-MOD-UNSUCCESSFUL    TO TRUE               14830000
148400              SET DP013-DB2-ABEND                                 14840000
148500                              TO TRUE                             14850000
148600              SET DP013-NO-ROLLBACK                               14860000
148700                              TO TRUE                             14870000
148800              PERFORM 9999-WRITE-CICS-LOG-MSG                     14880000
148900     END-EVALUATE.                                                14890000
149000                                                                  14900000
149100 EJECT                                                            14910000
149200                                                                  14920000
149300                                                                  14930000
149400 8000-FETCH-RET-PRICE-CURSOR.                                     14940000
149500     STRING ' 8000-FETCH-RET-PRICE-CURSOR'                        14950000
149600         DELIMITED BY SIZE                                        14960000
149700         INTO PV-CICS-MSG-AREA.                                   14970000
149800     PERFORM 9990-WRITE-CICS.                                     14980000
149900                                                                  14990000
150000     EXEC SQL                                                     15000000
150100          FETCH RET-PRICE-CSR                                     15010000
150200           INTO :RECITM-ORD-LNE-NBR                               15020000
150300             ,  :PURITM-UNT-RTL-PR-AMT                            15030000
150400     END-EXEC.                                                    15040000
150500                                                                  15050000
150600     EVALUATE TRUE                                                15060000
150700         WHEN SQLCODE = ZERO                                      15070000
150800             PERFORM 8200-SUM-TRECDIS                             15080000
150900         WHEN SQLCODE = +100                                      15090000
151000             SET PS-END-OF-RET-PRICE-CSR TO TRUE                  15100000
151100         WHEN SQLWARN0 NOT = SPACES                               15110000
151200         WHEN SQLCODE NOT EQUAL ZERO                              15120000
151300             MOVE '8000-FETCH-RET-PRICE-CURSOR'                   15130000
151400                             TO DP013-PARAGRAPH                   15140000
151500             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        15150000
151600             STRING 'PO NBR: '         DELIMITED BY SIZE          15160000
151700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          15170000
151800                           INTO DP013-MESSAGE-TEXT(1)             15180000
151900             MOVE DK-RCVR-SEQ-NBR                                 15190000
152000                             TO PV-DISPLAY-RCVR-SEQ-NBR           15200000
152100             STRING 'RECV SEQ: '       DELIMITED BY SIZE          15210000
152200                 PV-DISPLAY-RCVR-SEQ-NBR                          15220000
152300                                       DELIMITED BY SIZE          15230000
152400                           INTO DP013-MESSAGE-TEXT(2)             15240000
152500             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   15250000
152600             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          15260000
152700                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          15270000
152800                           INTO DP013-MESSAGE-TEXT(3)             15280000
152900             MOVE SQLCA      TO DP013-SQLCA                       15290000
153000             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 15300000
153100             MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)           15310000
153200                                PC238-BAD-TABLE-NAME              15320000
153300             SET PC238-DB2-FUNCTION-FETCH  TO TRUE                15330000
153400             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                15340000
153500             SET DP013-DB2-ABEND                                  15350000
153600                             TO TRUE                              15360000
153700             SET DP013-NO-ROLLBACK                                15370000
153800                             TO TRUE                              15380000
153900             PERFORM 9999-WRITE-CICS-LOG-MSG                      15390000
154000     END-EVALUATE.                                                15400000
154100                                                                  15410000
154200*----------------------------------------------------------------*15420000
154300* CLOSE THE RETAIL PRICE CURSOR                                  *15430000
154400*----------------------------------------------------------------*15440000
154500 8100-CLOSE-RET-PRICE-CURSOR.                                     15450000
154600     STRING ' 8100-CLOSE-RET-PRICE-CURSOR'                        15460000
154700         DELIMITED BY SIZE                                        15470000
154800         INTO PV-CICS-MSG-AREA.                                   15480000
154900     PERFORM 9990-WRITE-CICS.                                     15490000
155000                                                                  15500000
155100     EXEC SQL                                                     15510000
155200          CLOSE RET-PRICE-CSR                                     15520000
155300     END-EXEC.                                                    15530000
155400                                                                  15540000
155500     EVALUATE TRUE                                                15550000
155600         WHEN SQLCODE = ZERO                                      15560000
155700              CONTINUE                                            15570000
155800         WHEN SQLWARN0 NOT = SPACES                               15580000
155900         WHEN SQLCODE  < ZERO                                     15590000
156000         WHEN SQLCODE  > ZERO                                     15600000
156100              MOVE '8100-CLOSE-RET-PRICE-CURSOR'                  15610000
156200                             TO DP013-PARAGRAPH                   15620000
156300              MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR       15630000
156400              STRING 'PO NBR: '         DELIMITED BY SIZE         15640000
156500                  PV-DISPLAY-PO-NBR     DELIMITED BY SIZE         15650000
156600                            INTO DP013-MESSAGE-TEXT(1)            15660000
156700              MOVE DK-RCVR-SEQ-NBR                                15670000
156800                              TO PV-DISPLAY-RCVR-SEQ-NBR          15680000
156900              STRING 'RECV SEQ: '       DELIMITED BY SIZE         15690000
157000                  PV-DISPLAY-RCVR-SEQ-NBR                         15700000
157100                                        DELIMITED BY SIZE         15710000
157200                            INTO DP013-MESSAGE-TEXT(2)            15720000
157300              MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR  15730000
157400              STRING 'PO LINE NBR: '    DELIMITED BY SIZE         15740000
157500                 PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE         15750000
157600                            INTO DP013-MESSAGE-TEXT(3)            15760000
157700              MOVE SQLCA      TO DP013-SQLCA                      15770000
157800              MOVE SQLCODE    TO PC238-BAD-SQL-CDE                15780000
157900              MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)          15790000
158000                                 PC238-BAD-TABLE-NAME             15800000
158100              SET PC238-DB2-FUNCTION-CLOSE  TO TRUE               15810000
158200              SET PC238-MOD-UNSUCCESSFUL    TO TRUE               15820000
158300              SET DP013-DB2-ABEND                                 15830000
158400                              TO TRUE                             15840000
158500              SET DP013-NO-ROLLBACK                               15850000
158600                              TO TRUE                             15860000
158700              PERFORM 9999-WRITE-CICS-LOG-MSG                     15870000
158800     END-EVALUATE.                                                15880000
158900                                                                  15890000
159000 8200-SUM-TRECDIS.                                                15900000
159100     STRING ' 8200-SUM-TRECDIS'                                   15910000
159200         DELIMITED BY SIZE                                        15920000
159300         INTO PV-CICS-MSG-AREA.                                   15930000
159400     PERFORM 9990-WRITE-CICS.                                     15940000
159500                                                                  15950000
159600     EXEC SQL                                                     15960000
159700          SELECT SUM(AP_VERIFY_ITM_QTY)                           15970000
159800           INTO  :PV-SUM-AP-VERIFY-QTY                            15980000
159900            FROM TRECDIS                                          15990000
160000           WHERE ORD_NBR             = :DK-PO-NBR                 16000000
160100             AND ORD_LNE_NBR         = :RECITM-ORD-LNE-NBR        16010000
160200             AND REC_SEQ_NBR         = :DK-RCVR-SEQ-NBR           16020000
160300             WITH UR                                              16030000
160400     END-EXEC.                                                    16040000
160500                                                                  16050000
160600     EVALUATE TRUE                                                16060000
160700         WHEN SQLCODE = ZERO                                      16070000
160800             COMPUTE PV-LINE-RETAIL = PV-SUM-AP-VERIFY-QTY *      16080000
160900                       PURITM-UNT-RTL-PR-AMT                      16090000
161000             ADD PV-SUM-AP-VERIFY-QTY TO PV-TOTAL-AP-VERIFY-QTY   16100000
161100             ADD PV-LINE-RETAIL TO PV-TOTAL-RECEIVER-RETAIL       16110000
161200         WHEN SQLCODE = -305                                      16120000
161300             MOVE +0   TO PV-SUM-AP-VERIFY-QTY                    16130000
161400         WHEN SQLWARN0 NOT = SPACES                               16140000
161500         WHEN SQLCODE NOT EQUAL ZERO                              16150000
161600             MOVE '8200-SUM-TRECDIS'                              16160000
161700                             TO DP013-PARAGRAPH                   16170000
161800             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        16180000
161900             STRING 'PO NBR: '         DELIMITED BY SIZE          16190000
162000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          16200000
162100                           INTO DP013-MESSAGE-TEXT(1)             16210000
162200             MOVE RECITM-ORD-LNE-NBR                              16220000
162300                                       TO PV-DISPLAY-PO-LINE-NBR  16230000
162400             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          16240000
162500                 PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE         16250000
162600                           INTO DP013-MESSAGE-TEXT(2)             16260000
162700             MOVE DK-RCVR-SEQ-NBR                                 16270000
162800                             TO PV-DISPLAY-RCVR-SEQ-NBR           16280000
162900             STRING 'RECV SEQ: '       DELIMITED BY SIZE          16290000
163000                 PV-DISPLAY-RCVR-SEQ-NBR                          16300000
163100                                       DELIMITED BY SIZE          16310000
163200                           INTO DP013-MESSAGE-TEXT(3)             16320000
163300             MOVE SQLCA      TO DP013-SQLCA                       16330000
163400             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 16340000
163500             MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME(1)           16350000
163600                                PC238-BAD-TABLE-NAME              16360000
163700             SET PC238-DB2-FUNCTION-SELECT TO TRUE                16370000
163800             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                16380000
163900             SET DP013-DB2-ABEND                                  16390000
164000                             TO TRUE                              16400000
164100             SET DP013-NO-ROLLBACK                                16410000
164200                             TO TRUE                              16420000
164300             PERFORM 9999-WRITE-CICS-LOG-MSG                      16430000
164400     END-EVALUATE.                                                16440000
164500                                                                  16450000
164600 8300-SUM-PREVIOUS-UPLOADS.                                       16460000
164700     STRING ' 7100-SUM-PREVIOUS-UPLOADS'                          16470000
164800         DELIMITED BY SIZE                                        16480000
164900         INTO PV-CICS-MSG-AREA.                                   16490000
165000     PERFORM 9990-WRITE-CICS.                                     16500000
165100     EXEC SQL                                                     16510000
165200          SELECT SUM(UNT_QTY), SUM(CART_QTY), SUM(EXTD_RTL_AMT)   16520000
165300           INTO  :PV-SUM-UNIT-QTY                                 16530000
165400              ,  :PV-SUM-CART-QTY                                 16540000
165500              ,  :PV-SUM-EXTENDED-RETAIL                          16550000
165600            FROM PCT_RCVR_LNE_DTL                                 16560000
165700           WHERE PO_NBR              = :DK-PO-NBR                 16570000
165800             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           16580000
165900             AND PO_LNE_NBR          = 0                          16590000
166000             AND ACTN_CDE            = :PC-W                      16600000
166100     END-EXEC.                                                    16610000
166200                                                                  16620000
166300     EVALUATE TRUE                                                16630000
166400         WHEN SQLCODE = ZERO                                      16640000
166500             CONTINUE                                             16650000
166600         WHEN SQLCODE = +100                                      16660000
166700         WHEN SQLCODE = -305                                      16670000
166800             MOVE +0     TO PV-SUM-UNIT-QTY                       16680000
166900                            PV-SUM-CART-QTY                       16690000
167000                            PV-SUM-EXTENDED-RETAIL                16700000
167100         WHEN SQLWARN0 NOT = SPACES                               16710000
167200         WHEN SQLCODE NOT EQUAL ZERO                              16720000
167300             MOVE '8300-SUM-PREVIOUS-UPLOADS'                     16730000
167400                             TO DP013-PARAGRAPH                   16740000
167500             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        16750000
167600             STRING 'PO NBR: '         DELIMITED BY SIZE          16760000
167700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          16770000
167800                           INTO DP013-MESSAGE-TEXT(1)             16780000
167900             MOVE DK-RCVR-SEQ-NBR                                 16790000
168000                             TO PV-DISPLAY-RCVR-SEQ-NBR           16800000
168100             STRING 'RECV SEQ: '       DELIMITED BY SIZE          16810000
168200                 PV-DISPLAY-RCVR-SEQ-NBR                          16820000
168300                                       DELIMITED BY SIZE          16830000
168400                           INTO DP013-MESSAGE-TEXT(2)             16840000
168500             MOVE SQLCA      TO DP013-SQLCA                       16850000
168600             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 16860000
168700             MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)           16870000
168800                                PC238-BAD-TABLE-NAME              16880000
168900             SET PC238-DB2-FUNCTION-SELECT TO TRUE                16890000
169000             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                16900000
169100             SET DP013-DB2-ABEND                                  16910000
169200                             TO TRUE                              16920000
169300             SET DP013-NO-ROLLBACK                                16930000
169400                             TO TRUE                              16940000
169500             PERFORM 9999-WRITE-CICS-LOG-MSG                      16950000
169600     END-EVALUATE.                                                16960000
169700                                                                  16970000
169800                                                                  16980000
169900 8400-CHECK-IF-WORK-STARTED.                                      16990000
170000     STRING ' 8400-CHECK-IF-WORK-STARTED'                         17000000
170100         DELIMITED BY SIZE                                        17010000
170200         INTO PV-CICS-MSG-AREA.                                   17020000
170300     PERFORM 9990-WRITE-CICS.                                     17030000
170400                                                                  17040000
170500     EXEC SQL                                                     17050000
170600          SELECT PO_NBR                                           17060000
170700           INTO  :PCT00007-PO-NBR                                 17070000
170800            FROM PCT_RCVR_LNE_DTL                                 17080000
170900           WHERE PO_NBR              = :DK-PO-NBR                 17090000
171000             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           17100000
171100             AND PO_LNE_NBR          = 0                          17110000
171200             AND BUS_DTE             = :DK-BUS-DTE                17120000
171300             AND SHFT_NBR            = :DK-SHIFT-NBR              17130000
171400             AND ACTN_CDE            = :PC-W                      17140000
171500     END-EXEC.                                                    17150000
171600                                                                  17160000
171700     EVALUATE TRUE                                                17170000
171800         WHEN SQLCODE = ZERO                                      17180000
171900         WHEN SQLCODE = -811                                      17190000
172000             SET PS-WORK-STARTED  TO TRUE                         17200000
172100         WHEN SQLCODE = +100                                      17210000
172200             SET PS-NO-WORK-STARTED  TO TRUE                      17220000
172300         WHEN SQLWARN0 NOT = SPACES                               17230000
172400         WHEN SQLCODE NOT EQUAL ZERO                              17240000
172500             MOVE '8400-CHECK-IF-WORK-STARTED'                    17250000
172600                             TO DP013-PARAGRAPH                   17260000
172700             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        17270000
172800             STRING 'PO NBR: '         DELIMITED BY SIZE          17280000
172900                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          17290000
173000                           INTO DP013-MESSAGE-TEXT(1)             17300000
173100             MOVE DK-RCVR-SEQ-NBR                                 17310000
173200                             TO PV-DISPLAY-RCVR-SEQ-NBR           17320000
173300             STRING 'RECV SEQ: '       DELIMITED BY SIZE          17330000
173400                 PV-DISPLAY-RCVR-SEQ-NBR                          17340000
173500                                       DELIMITED BY SIZE          17350000
173600                           INTO DP013-MESSAGE-TEXT(2)             17360000
173700             STRING 'BUS DATE:  '      DELIMITED BY SIZE          17370000
173800                DK-BUS-DTE             DELIMITED BY SIZE          17380000
173900                           INTO DP013-MESSAGE-TEXT(3)             17390000
174000             MOVE DK-SHIFT-NBR        TO PV-DISPLAY-SHIFT         17400000
174100             STRING 'SHIFT, PROCESS AREA '                        17410000
174200                                       DELIMITED BY SIZE          17420000
174300                PV-DISPLAY-SHIFT       DELIMITED BY SIZE          17430000
174400                ' '                    DELIMITED BY SIZE          17440000
174500                DK-PRCG-AREA-CDE       DELIMITED BY SIZE          17450000
174600                           INTO DP013-MESSAGE-TEXT(4)             17460000
174700             MOVE SQLCA      TO DP013-SQLCA                       17470000
174800             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 17480000
174900             MOVE 'PCT00007' TO DP013-DB2-TABLE-NAME(1)           17490000
175000                                PC238-BAD-TABLE-NAME              17500000
175100             SET PC238-DB2-FUNCTION-SELECT TO TRUE                17510000
175200             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                17520000
175300             SET DP013-DB2-ABEND                                  17530000
175400                             TO TRUE                              17540000
175500             SET DP013-NO-ROLLBACK                                17550000
175600                             TO TRUE                              17560000
175700             PERFORM 9999-WRITE-CICS-LOG-MSG                      17570000
175800     END-EVALUATE.                                                17580000
175900                                                                  17590000
176000 8500-UPDATE-PCT-SUM-VERIFIED.                                    17600000
176100     STRING ' 8500-UPDATE-PCT-SUM-VERIFIED'                       17610000
176200         DELIMITED BY SIZE                                        17620000
176300         INTO PV-CICS-MSG-AREA.                                   17630000
176400     PERFORM 9990-WRITE-CICS.                                     17640000
176500                                                                  17650000
176600     EXEC SQL                                                     17660000
176700          UPDATE PCT_SUM_VRFD                                     17670000
176800          SET    UNT_VRFD_QTY       = UNT_VRFD_QTY                17680000
176900                                              + :PV-UPDT-UNIT-QTY 17690000
177000             ,   CART_VRFD_QTY      = CART_VRFD_QTY               17700000
177100                                              + :PV-UPDT-CART-QTY 17710000
177200             ,   PO_RCVR_VRFD_QTY   = PO_RCVR_VRFD_QTY            17720000
177300                                              + :PV-RCVR-WRKD-QTY 17730000
177400             ,   EXTD_RTL_VRFD_AMT  = EXTD_RTL_VRFD_AMT           17740000
177500                                              + :PV-UPDT-EXTD-RTL 17750000
177600          WHERE  BUS_DTE          = :DK-BUS-DTE                   17760000
177700            AND  OPER_UNT_ID      = :DK-OPER-UNT-ID               17770000
177800            AND  SHFT_NBR         = :DK-SHIFT-NBR                 17780000
177900     END-EXEC.                                                    17790000
178000                                                                  17800000
178100     EVALUATE TRUE                                                17810000
178200         WHEN SQLCODE = ZERO                                      17820000
178300         WHEN SQLCODE = +100                                      17830000
178400             CONTINUE                                             17840000
178500         WHEN SQLWARN0 NOT = SPACES                               17850000
178600         WHEN SQLCODE NOT EQUAL ZERO                              17860000
178700             MOVE '8500-UPDATE-PCT-SUM-VERIFIED'                  17870000
178800                             TO DP013-PARAGRAPH                   17880000
178900             STRING 'BUSINESS DATE '   DELIMITED BY SIZE          17890000
179000                 PCT00006-BUS-DTE      DELIMITED BY SIZE          17900000
179100                           INTO DP013-MESSAGE-TEXT(1)             17910000
179200             MOVE PCT00006-OPER-UNT-ID                            17920000
179300                                   TO PV-DISPLAY-OPER-UNT-ID      17930000
179400             STRING 'OPER UNIT '       DELIMITED BY SIZE          17940000
179500                 PV-DISPLAY-OPER-UNT-ID                           17950000
179600                                       DELIMITED BY SIZE          17960000
179700                           INTO DP013-MESSAGE-TEXT(2)             17970000
179800             MOVE PCT00006-SHFT-NBR   TO PV-DISPLAY-SHIFT         17980000
179900             STRING 'SHIFT NUMBER '    DELIMITED BY SIZE          17990000
180000                PV-DISPLAY-SHIFT       DELIMITED BY SIZE          18000000
180100                           INTO DP013-MESSAGE-TEXT(3)             18010000
180200             MOVE SQLCA      TO DP013-SQLCA                       18020000
180300             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 18030000
180400             MOVE 'PCT00006' TO DP013-DB2-TABLE-NAME(1)           18040000
180500                                PC238-BAD-TABLE-NAME              18050000
180600             SET PC238-DB2-FUNCTION-UPDATE TO TRUE                18060000
180700             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                18070000
180800             SET DP013-DB2-ABEND                                  18080000
180900                             TO TRUE                              18090000
181000             SET DP013-NO-ROLLBACK                                18100000
181100                             TO TRUE                              18110000
181200             PERFORM 9999-WRITE-CICS-LOG-MSG                      18120000
181300     END-EVALUATE.                                                18130000
181400                                                                  18140000
181500 8600-INSERT-PCT-SUM-VERIFIED.                                    18150000
181600     STRING ' 8600-INSERT-PCT-SUM-VERIFIED'                       18160000
181700         DELIMITED BY SIZE                                        18170000
181800         INTO PV-CICS-MSG-AREA.                                   18180000
181900     PERFORM 9990-WRITE-CICS.                                     18190000
182000                                                                  18200000
182100     EXEC SQL                                                     18210000
182200        INSERT INTO PCT_SUM_VRFD                                  18220000
182300               (BUS_DTE                                           18230000
182400             ,  OPER_UNT_ID                                       18240000
182500             ,  SHFT_NBR                                          18250000
182600             ,  UNT_VRFD_QTY                                      18260000
182700             ,  CART_VRFD_QTY                                     18270000
182800             ,  PO_RCVR_VRFD_QTY                                  18280000
182900             ,  EXTD_RTL_VRFD_AMT)                                18290000
183000        VALUES (:PCT00006-BUS-DTE                                 18300000
183100             ,  :PCT00006-OPER-UNT-ID                             18310000
183200             ,  :PCT00006-SHFT-NBR                                18320000
183300             ,  :PCT00006-UNT-VRFD-QTY                            18330000
183400             ,  :PCT00006-CART-VRFD-QTY                           18340000
183500             ,  :PCT00006-PO-RCVR-VRFD-QTY                        18350000
183600             ,  :PCT00006-EXTD-RTL-VRFD-AMT)                      18360000
183700     END-EXEC.                                                    18370000
183800                                                                  18380000
183900     EVALUATE TRUE                                                18390000
184000         WHEN SQLCODE = ZERO                                      18400000
184100             CONTINUE                                             18410000
184101*                                                                 18410132
184102** DMH 11/11/14 BEGIN                                             18410232
184110         WHEN SQLCODE = -803                                      18411032
184120             PERFORM 8500-UPDATE-PCT-SUM-VERIFIED                 18412032
184140** DMH 11/11/14 END                                               18414032
184150*                                                                 18415032
184200         WHEN SQLWARN0 NOT = SPACES                               18420000
184300         WHEN SQLCODE NOT EQUAL ZERO                              18430000
184400             MOVE '8600-INSERT-PCT-SUM-VERIFIED'                  18440000
184500                             TO DP013-PARAGRAPH                   18450000
184600             STRING 'BUSINESS DATE '   DELIMITED BY SIZE          18460000
184700                 PCT00006-BUS-DTE      DELIMITED BY SIZE          18470000
184800                           INTO DP013-MESSAGE-TEXT(1)             18480000
184900             MOVE PCT00006-OPER-UNT-ID                            18490000
185000                                   TO PV-DISPLAY-OPER-UNT-ID      18500000
185100             STRING 'OPER UNIT '       DELIMITED BY SIZE          18510000
185200                 PV-DISPLAY-OPER-UNT-ID                           18520000
185300                                       DELIMITED BY SIZE          18530000
185400                           INTO DP013-MESSAGE-TEXT(2)             18540000
185500             MOVE PCT00006-SHFT-NBR   TO PV-DISPLAY-SHIFT         18550000
185600             STRING 'SHIFT NUMBER '    DELIMITED BY SIZE          18560000
185700                PV-DISPLAY-SHIFT       DELIMITED BY SIZE          18570000
185800                           INTO DP013-MESSAGE-TEXT(3)             18580000
185900             MOVE SQLCA      TO DP013-SQLCA                       18590000
186000             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 18600000
186100             MOVE 'PCT00006' TO DP013-DB2-TABLE-NAME(1)           18610000
186200                                PC238-BAD-TABLE-NAME              18620000
186300             SET PC238-DB2-FUNCTION-INSERT TO TRUE                18630000
186400             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                18640000
186500             SET DP013-DB2-ABEND                                  18650000
186600                             TO TRUE                              18660000
186700             SET DP013-NO-ROLLBACK                                18670000
186800                             TO TRUE                              18680000
186900             PERFORM 9999-WRITE-CICS-LOG-MSG                      18690000
187000     END-EVALUATE.                                                18700000
187100                                                                  18710000
187200*----------------------------------------------------------------*18720000
187300*    RETRIEVE THE TIMEZN SYS-PRC-FUNC-CDE TO DETERMINE THE NUMBER 18730000
187400*    OF HOURS TO ADD OR SUBTRACT FROM THE CURRENT TIME INORDER    18740000
187500*    TO BE IN THE CORRECT TIMEZONE.                               18750000
187600*----------------------------------------------------------------*18760000
187700*                                                                 18770000
187800 8700-GET-TKRPRPM.                                                18780000
187900                                                                  18790000
188000     MOVE PC238-WRKD-TMST       TO PV-WRKD-TMST.                  18800000
188100                                                                  18810000
188200     EXEC SQL                                                     18820000
188300         SELECT (TIMESTAMP(:PV-WRKD-TMST)  + FUNC_QTY HOURS)      18830000
188400               ,(TIMESTAMP(:PV-WRKD-TMST)  + FUNC_QTY HOURS)      18840000
188500                 + 1 DAY                                          18850000
188510               ,(TIMESTAMP(:PV-WRKD-TMST)  + FUNC_QTY HOURS)      18851001
188520                 - 1 DAY                                          18852004
188600           INTO   :PV-CURRENT-TMST                                18860000
188700                 ,:PV-BUSINES-DATE                                18870000
188710                 ,:PV-BUSINES-DATE-PREV                           18871002
188800           FROM   TKRPRPM                                         18880000
188900          WHERE LOC_ID           = :DK-OPER-UNT-ID                18890000
189000            AND INTFC_SYS_CDE    = 'KHL'                          18900000
189100            AND SYS_PRC_FUNC_CDE = 'TIMEZN'                       18910000
189200            AND FUNC_PRC_STAT_CDE = 'AC'                          18920000
189300     END-EXEC.                                                    18930000
189400                                                                  18940000
189500     EVALUATE TRUE                                                18950000
189600         WHEN SQLCODE = +0                                        18960000
189700             MOVE PV-CURR-HH  TO PV-SHFT-HH                       18970000
189800             MOVE PV-CURR-MN  TO PV-SHFT-MN                       18980000
189900             MOVE PV-CURR-SS  TO PV-SHFT-SS                       18990000
190000             MOVE '.'         TO PV-PERIOD-1                      19000000
190100                                 PV-PERIOD-2                      19010000
190200         WHEN OTHER                                               19020000
190300             MOVE '8700-GET-TKRPRPM   '   TO DP013-PARAGRAPH      19030000
190400             MOVE 'GETTING TIMEZN INFO' TO DP013-MESSAGE-TEXT (1) 19040000
190500             MOVE DK-OPER-UNT-ID TO  PV-DISPLAY-OPER-UNT-ID       19050000
190600             MOVE PC238-PO-NBR       TO PC-DISPLAY-PO             19060000
190700             MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR           19070000
190800             MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE           19080000
190900             STRING  ' OPER UNIT   - '                            19090000
191000                     PV-DISPLAY-OPER-UNT-ID                       19100000
191100                     PC-DISPLAY-PO                                19110000
191200                     ' - '                                        19120000
191300                     PC-DISPLAY-RCVR                              19130000
191400                     ' - '                                        19140000
191500                     PC-DISPLAY-LINE                              19150000
191600                                       DELIMITED BY SIZE          19160000
191700                             INTO DP013-MESSAGE-TEXT (2)          19170000
191800             MOVE SQLCA   TO DP013-SQLCA                          19180000
191900             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 19190000
192000             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)          19200000
192100                                PC238-BAD-TABLE-NAME              19210000
192200             SET PC238-DB2-FUNCTION-SELECT TO TRUE                19220000
192300             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                19230000
192400             SET DP013-DB2-ABEND                                  19240000
192500                             TO TRUE                              19250000
192600             SET DP013-NO-ROLLBACK                                19260000
192700                             TO TRUE                              19270000
192800             PERFORM 9999-WRITE-CICS-LOG-MSG                      19280000
192900     END-EVALUATE.                                                19290000
193000                                                                  19300000
193100*----------------------------------------------------------------*19310000
193200*    CHECK THE PARM VALUE TO DETERMINE WHETER TO CALL THE         19320000
193300*    RMS PO RECEIPT PUBLISHING MODULE(PCKCS759)                   19330000
193400*----------------------------------------------------------------*19340000
193500*                                                                 19350000
193600 8710-GET-TKRPRPM-RMS.                                            19360000
193700                                                                  19370000
193800     EXEC SQL                                                     19380000
193900          SELECT FUNC_END_TMST                                    19390000
194000          INTO  :KRPRPM-FUNC-END-TMST                             19400000
194010          FROM   TKRPRPM                                          19401000
194020          WHERE  SYS_PRC_FUNC_CDE  = 'RMSRIN'                     19402000
194030            AND  LOC_ID            =  090                         19403000
194040            AND  INTFC_SYS_CDE     = 'RMS'                        19404000
194050            AND  FUNC_PRC_STAT_CDE = 'AC'                         19405000
194060            AND  FUNC_TXT          = 'Y'                          19406000
194070     END-EXEC.                                                    19407000
194080                                                                  19408000
194090     EVALUATE TRUE                                                19409000
194100         WHEN SQLCODE = +0                                        19410000
194110              SET PS-PROCESS-RMS-INTERFACE-YES TO TRUE            19411000
194111         WHEN SQLCODE = +100                                      19411100
194112              SET PS-PROCESS-RMS-INTERFACE-NO TO TRUE             19411200
194113         WHEN OTHER                                               19411300
194114             MOVE '8710-GET-TKRPRPM-RMS'  TO DP013-PARAGRAPH      19411400
194115             MOVE 'GETTING TIMEZN INFO' TO DP013-MESSAGE-TEXT (1) 19411500
194116             MOVE DK-OPER-UNT-ID TO  PV-DISPLAY-OPER-UNT-ID       19411600
194117             STRING  ' OPER UNIT   - ' DELIMITED BY SIZE          19411700
194118                     PV-DISPLAY-OPER-UNT-ID                       19411800
194119                                       DELIMITED BY SIZE          19411900
194120                             INTO DP013-MESSAGE-TEXT (2)          19412000
194130             MOVE SQLCA   TO DP013-SQLCA                          19413000
194131             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 19413100
194132             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)          19413200
194133                                PC238-BAD-TABLE-NAME              19413300
194134             SET PC238-DB2-FUNCTION-SELECT TO TRUE                19413400
194135             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                19413500
194136             SET DP013-DB2-ABEND                                  19413600
194137                             TO TRUE                              19413700
194138             SET DP013-NO-ROLLBACK                                19413800
194139                             TO TRUE                              19413900
194140             PERFORM 9999-WRITE-CICS-LOG-MSG                      19414000
194141     END-EVALUATE.                                                19414100
194142                                                                  19414210
194143*----------------------------------------------------------------*19414310
194144*    CHECK THE PARM VALUE TO FIND WHICH RECEIVER TYPES WILL       19414410
194145*    BYPASS POSTING UNITS WORKED                                  19414510
194146*----------------------------------------------------------------*19414610
194147*                                                                 19414710
194148 8720-TKRPRPM-RCVR-TYPES.                                         19414810
194149                                                                  19414910
194150     EXEC SQL                                                     19415010
194151          SELECT FUNC_TXT                                         19415121
194152          INTO  :KRPRPM-FUNC-TXT                                  19415210
194153          FROM   TKRPRPM                                          19415310
194154          WHERE  SYS_PRC_FUNC_CDE  = 'UWBYPS'                     19415411
194155            AND  LOC_ID            =  090                         19415510
194156            AND  INTFC_SYS_CDE     = 'KHL'                        19415611
194157            AND  FUNC_PRC_STAT_CDE = 'AC'                         19415710
194159     END-EXEC.                                                    19415910
194160                                                                  19416010
194161     EVALUATE TRUE                                                19416110
194162         WHEN SQLCODE = +0                                        19416210
194163              IF RECEIV-REC-TYP-CDE = KRPRPM-FUNC-TXT (1:2)       19416311
194164                                   OR KRPRPM-FUNC-TXT (4:2)       19416411
194165                                   OR KRPRPM-FUNC-TXT (7:2)       19416529
194166                                   OR KRPRPM-FUNC-TXT (10:2)      19416629
194167                                   OR KRPRPM-FUNC-TXT (13:2)      19416729
194168                                   OR KRPRPM-FUNC-TXT (16:2)      19416829
194169                                   OR KRPRPM-FUNC-TXT (19:2)      19416929
194170                                   OR KRPRPM-FUNC-TXT (22:2)      19417029
194171                  SET PS-POST-UNITS-WORKED-NO  TO TRUE            19417112
194172              ELSE                                                19417212
194173                  SET PS-POST-UNITS-WORKED-YES TO TRUE            19417312
194174              END-IF                                              19417412
194175         WHEN SQLCODE = +100                                      19417510
194176                  SET PS-POST-UNITS-WORKED-YES TO TRUE            19417612
194177         WHEN OTHER                                               19417710
194178             MOVE '8720-TKRPRPM-RCVR-TYPES'                       19417814
194179                                         TO DP013-PARAGRAPH       19417914
194180             MOVE 'GETTING RCVR TYPES '  TO DP013-MESSAGE-TEXT (1)19418014
194181             MOVE 'PARM UWBYPS'          TO DP013-MESSAGE-TEXT (2)19418114
194182             MOVE SQLCA   TO DP013-SQLCA                          19418214
194183             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 19418314
194184             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)          19418414
194185                                PC238-BAD-TABLE-NAME              19418514
194186             SET PC238-DB2-FUNCTION-SELECT TO TRUE                19418614
194187             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                19418714
194188             SET DP013-DB2-ABEND                                  19418814
194189                             TO TRUE                              19418914
194190             SET DP013-NO-ROLLBACK                                19419014
194191                             TO TRUE                              19419114
194192             PERFORM 9999-WRITE-CICS-LOG-MSG                      19419214
194193     END-EVALUATE.                                                19419314
194194                                                                  19419414
194195*----------------------------------------------------------------*19419514
194196*    LOOK AT SHIFT TABLE TO SEE IF DATE NEEDS TO BE INCREMENTED.  19419614
194197*----------------------------------------------------------------*19419714
194198*                                                                 19419814
194199 8800-GET-SHIFT.                                                  19419914
194200                                                                  19420014
194201     EXEC SQL                                                     19420114
194202         SELECT SHFT_NBR, SHFT_BEG_TM, SHFT_END_TM                19420214
194203           INTO :PCT00004-SHFT-NBR                                19420314
194204              , :PCT00004-SHFT-BEG-TM                             19420414
194205              , :PCT00004-SHFT-END-TM                             19420514
194206           FROM   PCT_SHFT                                        19420614
194210          WHERE OPER_UNT_ID      = :DK-OPER-UNT-ID                19421000
194300            AND ((SHFT_BEG_TM <= :PV-SHIFT-TIME                   19430000
194400            AND   SHFT_END_TM >= :PV-SHIFT-TIME)                  19440000
194500             OR  (SHFT_END_TM >= :PV-SHIFT-TIME                   19450000
194600            AND   SHFT_BEG_TM > SHFT_END_TM)                      19460000
194700             OR  (SHFT_BEG_TM <= :PV-SHIFT-TIME                   19470000
194800            AND   SHFT_BEG_TM > SHFT_END_TM))                     19480000
194900     END-EXEC.                                                    19490000
195000                                                                  19500000
195100     EVALUATE TRUE                                                19510000
195200         WHEN SQLCODE = +0                                        19520000
195300             MOVE PCT00004-SHFT-NBR     TO PC238-SHFT-NBR         19530000
195400             MOVE '-'                   TO PV-DASH-1              19540000
195500                                           PV-DASH-2              19550000
195600                                           PC238-BUSINESS-DASH-1  19560000
195700                                           PC238-BUSINESS-DASH-2  19570000
195800             IF  PCT00004-SHFT-BEG-TM > PCT00004-SHFT-END-TM      19580000
195810                 IF PCT00004-SHFT-NBR = 2                         19581001
195820                    PERFORM 8810-CHECK-OVERLAPPING-SHIFTS         19582001
195830                 END-IF                                           19583001
195840                 IF PS-DONE-CHECKING                              19584001
195850                    CONTINUE                                      19585001
195860                 ELSE                                             19586001
195900                   IF  PV-SHIFT-TIME >= PCT00004-SHFT-BEG-TM      19590001
196000                   AND PV-SHIFT-TIME < PC-END-TM                  19600001
196100                       MOVE PV-BUSN-CC    TO PC238-BUSINESS-DTE-CC19610001
196200                                             PV-KEY-CC            19620001
196300                       MOVE PV-BUSN-YY    TO PC238-BUSINESS-DTE-YY19630001
196400                                             PV-KEY-YY            19640001
196500                       MOVE PV-BUSN-MM    TO PC238-BUSINESS-DTE-MM19650001
196600                                             PV-KEY-MM            19660001
196700                       MOVE PV-BUSN-DD    TO PC238-BUSINESS-DTE-DD19670001
196800                                             PV-KEY-DD            19680001
196900                   ELSE                                           19690001
197000                       MOVE PV-CURR-CC    TO PC238-BUSINESS-DTE-CC19700001
197100                                             PV-KEY-CC            19710001
197200                       MOVE PV-CURR-YY    TO PC238-BUSINESS-DTE-YY19720001
197300                                             PV-KEY-YY            19730001
197400                       MOVE PV-CURR-MM    TO PC238-BUSINESS-DTE-MM19740001
197500                                             PV-KEY-MM            19750001
197600                       MOVE PV-CURR-DD    TO PC238-BUSINESS-DTE-DD19760001
197700                                             PV-KEY-DD            19770001
197800                   END-IF                                         19780001
197810                 END-IF                                           19781001
197900             ELSE                                                 19790000
198000                 MOVE PV-CURR-CC        TO PC238-BUSINESS-DTE-CC  19800000
198100                                           PV-KEY-CC              19810000
198200                 MOVE PV-CURR-YY        TO PC238-BUSINESS-DTE-YY  19820000
198300                                           PV-KEY-YY              19830000
198400                 MOVE PV-CURR-MM        TO PC238-BUSINESS-DTE-MM  19840000
198500                                           PV-KEY-MM              19850000
198600                 MOVE PV-CURR-DD        TO PC238-BUSINESS-DTE-DD  19860000
198700                                           PV-KEY-DD              19870000
198800             END-IF                                               19880000
198900         WHEN SQLCODE = +100                                      19890000
199000             SET PC238-MOD-BAD-NO-SHIFT    TO TRUE                19900000
199100             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                19910000
199200         WHEN OTHER                                               19920000
199300             MOVE '8800-GET-SHIFT     '   TO DP013-PARAGRAPH      19930000
199400             MOVE 'GETTING SHIFT INFO' TO DP013-MESSAGE-TEXT (1)  19940000
199500             MOVE DK-OPER-UNT-ID TO  PV-DISPLAY-OPER-UNT-ID       19950000
199600             MOVE PC238-PO-NBR       TO PC-DISPLAY-PO             19960000
199700             MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR           19970000
199800             MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE           19980000
199900             STRING  ' OPER UNIT   - '                            19990000
200000                     PV-DISPLAY-OPER-UNT-ID                       20000000
200100                     PC-DISPLAY-PO                                20010000
200200                     ' - '                                        20020000
200300                     PC-DISPLAY-RCVR                              20030000
200400                     ' - '                                        20040000
200500                     PC-DISPLAY-LINE                              20050000
200510                                       DELIMITED BY SIZE          20051000
200520                             INTO DP013-MESSAGE-TEXT (2)          20052000
200530             MOVE SQLCA   TO DP013-SQLCA                          20053000
200540             MOVE SQLCODE    TO PC238-BAD-SQL-CDE                 20054000
200550             MOVE 'PCT_SHFT' TO DP013-DB2-TABLE-NAME (1)          20055000
200560                                PC238-BAD-TABLE-NAME              20056000
200570             SET PC238-DB2-FUNCTION-SELECT TO TRUE                20057000
200580             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                20058000
200590             SET DP013-DB2-ABEND                                  20059000
200600                             TO TRUE                              20060000
200700             SET DP013-NO-ROLLBACK                                20070000
200800                             TO TRUE                              20080000
200900             PERFORM 9999-WRITE-CICS-LOG-MSG                      20090000
201000     END-EVALUATE.                                                20100000
201100                                                                  20110000
201110 8810-CHECK-OVERLAPPING-SHIFTS.                                   20111001
201120     IF  (PCT00004-SHFT-BEG-TM  < PC-END-TM AND                   20112001
201130          PCT00004-SHFT-END-TM  > PC-BEG-TM )                     20113001
201140            IF PV-SHIFT-TIME > PCT00004-SHFT-BEG-TM AND           20114001
201150               PV-SHIFT-TIME < PC-END-TM                          20115001
201160                  MOVE PV-CURR-CC        TO PC238-BUSINESS-DTE-CC 20116001
201170                                            PV-KEY-CC             20117001
201180                  MOVE PV-CURR-YY        TO PC238-BUSINESS-DTE-YY 20118001
201190                                            PV-KEY-YY             20119001
201191                  MOVE PV-CURR-MM        TO PC238-BUSINESS-DTE-MM 20119101
201192                                            PV-KEY-MM             20119201
201193                  MOVE PV-CURR-DD        TO PC238-BUSINESS-DTE-DD 20119301
201194                                            PV-KEY-DD             20119401
201195                 SET PS-DONE-CHECKING    TO TRUE                  20119501
201196            ELSE                                                  20119601
201197                 MOVE PV-BUSN-CC-PREV    TO PC238-BUSINESS-DTE-CC 20119701
201198                                            PV-KEY-CC             20119801
201199                 MOVE PV-BUSN-YY-PREV    TO PC238-BUSINESS-DTE-YY 20119901
201200                                            PV-KEY-YY             20120001
201201                 MOVE PV-BUSN-MM-PREV    TO PC238-BUSINESS-DTE-MM 20120101
201202                                            PV-KEY-MM             20120201
201203                 MOVE PV-BUSN-DD-PREV    TO PC238-BUSINESS-DTE-DD 20120301
201204                                            PV-KEY-DD             20120401
201205                 SET PS-DONE-CHECKING    TO TRUE                  20120501
201206            END-IF                                                20120601
201207     ELSE                                                         20120701
201208            SET PS-CONTINUE-CHECKING TO TRUE                      20120801
201209     END-IF.                                                      20120901
201210                                                                  20121001
201220 8850-SELECT-FISCAL-INFO.                                         20122000
201300     EXEC SQL                                                     20130000
201400         SELECT FSCL_YR_NBR                                       20140000
201500            ,   FSCL_MN_NBR                                       20150000
201600            ,   FSCL_WK_NBR                                       20160000
201700            ,   WK_IN_MN_NBR                                      20170000
201800            ,   DAY_OF_WK_NBR                                     20180000
201900            ,   LY_THIS_DAY_KY_DTE                                20190000
202000            ,   FSCL_MN_BEG_DTE                                   20200000
202100            ,   FSCL_MN_END_DTE                                   20210000
202200            ,   FSCL_WK_BEG_DTE                                   20220000
202300            ,   FSCL_WK_END_DTE                                   20230000
202400         INTO  :DTATTR-FSCL-YR-NBR                                20240000
202500            ,  :DTATTR-FSCL-MN-NBR                                20250000
202600            ,  :DTATTR-FSCL-WK-NBR                                20260000
202700            ,  :DTATTR-WK-IN-MN-NBR                               20270000
202800            ,  :DTATTR-DAY-OF-WK-NBR                              20280000
202900            ,  :DTATTR-LY-THIS-DAY-KY-DTE                         20290000
203000            ,  :DTATTR-FSCL-MN-BEG-DTE                            20300000
203100            ,  :DTATTR-FSCL-MN-END-DTE                            20310000
203200            ,  :DTATTR-FSCL-WK-BEG-DTE                            20320000
203300            ,  :DTATTR-FSCL-WK-END-DTE                            20330000
203400         FROM   TDTATTR                                           20340000
203500         WHERE KY_DTE = :DK-BUS-DTE                               20350000
203600     END-EXEC.                                                    20360000
203700                                                                  20370000
203800     EVALUATE TRUE                                                20380000
203900         WHEN SQLCODE = 0                                         20390000
204000              CONTINUE                                            20400000
204100         WHEN SQLWARN NOT = SPACE                                 20410000
204200         WHEN SQLCODE NOT = ZERO                                  20420000
204300             MOVE '8850-SELECT-FISCAL-INFO'                       20430000
204400                                    TO DP013-PARAGRAPH            20440000
204500             MOVE 'SELECT FISCAL INFORMATION'                     20450000
204600                                    TO DP013-MESSAGE-TEXT(1)      20460000
204700             MOVE DK-BUS-DTE        TO DP013-MESSAGE-TEXT(2)      20470000
204800             MOVE SQLCA             TO DP013-SQLCA                20480000
204900             MOVE SQLCODE           TO PC238-BAD-SQL-CDE          20490000
205000             MOVE 'TDTATTR '        TO DP013-DB2-TABLE-NAME (1)   20500000
205100                                       PC238-BAD-TABLE-NAME       20510000
205200             SET PC238-DB2-FUNCTION-SELECT TO TRUE                20520000
205300             SET PC238-MOD-UNSUCCESSFUL    TO TRUE                20530000
205400             SET DP013-DB2-ABEND                                  20540000
205500                             TO TRUE                              20550000
205600             SET DP013-NO-ROLLBACK                                20560000
205700                             TO TRUE                              20570000
205800             PERFORM 9999-WRITE-CICS-LOG-MSG                      20580000
205900     END-EVALUATE.                                                20590000
206000*                                                                 20600000
206100                                                                  20610000
206200 9200-WRITE-TO-CICS-LOG.                                          20620000
206300                                                                  20630000
206400     EXEC CICS                                                    20640000
206500          WRITEQ TD                                               20650000
206600          QUEUE  ('CSSL')                                         20660000
206700          FROM  (PV-CICS-MSG-AREA3)                               20670000
206800          LENGTH  (PV-COMMAREA-LENGTH)                            20680000
206900          RESP  (PV-CICS-RESP)                                    20690000
207000     END-EXEC.                                                    20700000
207100                                                                  20710000
207200     MOVE SPACES TO PV-CICS-MSG-AREA3.                            20720000
207300                                                                  20730000
207400                                                                  20740000
207500 9990-WRITE-CICS.                                                 20750000
207600                                                                  20760000
207700* IF YOU'RE AT THE LAST OCCURRENCE OF THE TABLE,                  20770000
207800* THE NEXT MESSAGE WILL GO INTO THE FIRST OCCURRENCE.  KEEP       20780000
207900* INCREMENTING THE SEQUENCE SO THAT IF THE TABLE IS DUMPED TO THE 20790000
208000* LOG YOU WILL BE ABLE TO SEE THE LAST 200 LINES AND HOW THEY     20800000
208100* WRAPPED AROUND.                                                 20810000
208200                                                                  20820000
208300     EVALUATE TRUE                                                20830000
208400     WHEN PT-MSG-IDX < PC-MSG-TABLE-SIZE                          20840000
208500         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 20850000
208600         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         20860000
208700         SET PT-MSG-IDX UP BY 1                                   20870000
208800     WHEN PT-MSG-IDX = PC-MSG-TABLE-SIZE                          20880000
208900         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 20890000
209000         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         20900000
209100         SET PT-MSG-IDX               TO 1                        20910000
209200     END-EVALUATE                                                 20920000
209300                                                                  20930000
209400     COMPUTE PV-NEXT-SEQUENCE = PV-PREV-SEQUENCE + 1              20940000
209500     MOVE PV-NEXT-SEQUENCE            TO PT-MSG-SEQ (PT-MSG-IDX)  20950000
209600                                                                  20960000
209700                                                                  20970000
209800*  IF THE DC HAS TRACE PROCESSING TURNED ON, ALL MESSAGES WILL    20980000
209900*  BE DISPLAYED AS THEY OCCUR.  DUMPING THE MESSAGE TABLE WILL    20990000
210000*  BE UNNECESSARY BECAUSE OF THE REAL-TIME DISPLAYS.              21000000
210100*                                                                 21010000
210200     IF PS-SHOW-DEBUG-INFO                                        21020000
210300         PERFORM 9991-WRITEQ                                      21030000
210400     END-IF                                                       21040000
210500     MOVE SPACES                      TO PV-CICS-MSG-AREA.        21050000
210600                                                                  21060000
210700                                                                  21070000
210800 9991-WRITEQ.                                                     21080000
210900     EXEC CICS                                                    21090000
211000         WRITEQ TD                                                21100000
211100         QUEUE(PC-LOG-QUEUE)                                      21110000
211200         FROM(PV-CICS-MSG-AREA)                                   21120000
211300         RESP(PV-CICS-RESPONSE)                                   21130000
211400     END-EXEC.                                                    21140000
211500                                                                  21150000
211600*-----------------------------------------------------------------21160000
211700*  RETURN TO CALLING PROGRAM                                      21170000
211800*-----------------------------------------------------------------21180000
211900 9998-RETURN.                                                     21190000
212000                                                                  21200000
212100     STRING ' 9998-RETURN'                                        21210000
212200         DELIMITED BY SIZE                                        21220000
212300         INTO PV-CICS-MSG-AREA.                                   21230000
212400     PERFORM 9990-WRITE-CICS.                                     21240000
212500                                                                  21250000
212600* THE FOLLOWING COMMENTED CODE CAN BE USED TO DETERMINE IF        21260000
212700* THE ROUTINE IS IN FACT GETTING CALLED.                          21270000
212800*                                                                 21280000
212900*    INITIALIZE                    PV-CICS-MSG-AREA2.             21290000
213000*    STRING ' PCKCS756 ENDED - TASK = '                           21300000
213100*             PV-EIBTASKN                                         21310000
213200*             DELIMITED BY SIZE                                   21320000
213300*                             INTO PV-CICS-MSG-AREA2              21330000
213400*    PERFORM 9999-WRITE-TO-CSSL.                                  21340000
213500                                                                  21350000
213600     MOVE PC238-COMM-AREA               TO DFHCOMMAREA.           21360000
213700                                                                  21370000
213800     EXEC CICS                                                    21380000
213900          RETURN                                                  21390000
214000     END-EXEC.                                                    21400000
214100                                                                  21410000
214200                                                                  21420000
214300 9999-WRITE-TO-CSSL.                                              21430000
214400     STRING ' PCKCS756 - 9999-WRITE-TO-CSSL'                      21440031
214500              DELIMITED BY SIZE                                   21450031
214600         INTO PV-CICS-MSG-AREA.                                   21460000
214700     PERFORM 9990-WRITE-CICS.                                     21470000
214800     MOVE LENGTH OF PV-CICS-MSG-AREA2                             21480000
214900       TO PV-COMMAREA-LENGTH                                      21490000
215000     EXEC CICS                                                    21500000
215100          WRITEQ TD                                               21510000
215200           QUEUE   ('CSSL')                                       21520000
215300            FROM   (PV-CICS-MSG-AREA2)                            21530000
215400          LENGTH   (PV-COMMAREA-LENGTH)                           21540000
215500            RESP   (PV-CICS-RESP)                                 21550000
215600     END-EXEC.                                                    21560000
215700                                                                  21570000
215800*                                                                 21580000
215900 9999-WRITE-CICS-LOG-MSG.                                         21590000
216000     STRING ' 9999-WRITE-CICS-LOG-MSG'                            21600000
216100         DELIMITED BY SIZE                                        21610000
216200         INTO PV-CICS-MSG-AREA.                                   21620000
216300     PERFORM 9990-WRITE-CICS.                                     21630000
216400     MOVE 'PCKCS756'                 TO DP013-PROGRAM.            21640000
216500     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           21650000
216600     INITIALIZE DP013-SRC-TASK-NUMBER                             21660000
216700                DP013-STACK.                                      21670000
216800     SET DP013-LINK-RETURN           TO TRUE.                     21680000
216900                                                                  21690000
217000     EXEC CICS                                                    21700000
217100         LINK                                                     21710000
217200             PROGRAM   (DP013-NAME)                               21720000
217300             COMMAREA  (DP013-PARAMETERS)                         21730000
217400             LENGTH    (DP013-LENGTH)                             21740000
217500     END-EXEC.                                                    21750000
217600                                                                  21760000
