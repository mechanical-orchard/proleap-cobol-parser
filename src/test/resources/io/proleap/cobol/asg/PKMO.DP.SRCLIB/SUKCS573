000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS573.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  SEPTEMBER, 2001                                   00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S573 - SHIPPING DOOR STATUS  - OUTBOUND ASSOCIATE LIST SCRN* 00100000
001100*---------------------------------------------------------------* 00110000
001200*  10/16/2017 - JIM HUNTER                         CHG0181045   * 00120016
001300*               SET FUNCTION TO 'SHIP TRLR KIOSK' WHEN          * 00130017
001400*               CREATE BY PROGRAM = SUKCS808                    * 00140017
001500*               OR 'SHIP SUM KIOSK' WHEN                        * 00150017
001600*               CREATE BY PROGRAM = SUKC808S    (FIND 181045)   * 00160017
001700*---------------------------------------------------------------* 00170017
001710* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00171031
001720* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00172032
001730* MAKING THE CALL DYNAMIC VS STATIC.                              00173032
001731*                                                                 00173143
001732* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00173239
001733* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00173339
001740*---------------------------------------------------------------* 00174032
001800 ENVIRONMENT DIVISION.                                            00180000
001900 DATA DIVISION.                                                   00190000
002000                                                                  00200000
002100 WORKING-STORAGE SECTION.                                         00210000
002200 01  DK-DB2-KEYS.                                                 00220000
002300     05  DK-CASE                        PIC  X(01)  VALUE SPACES. 00230000
002400     05  DK-USER-CODE                   PIC  X(08)  VALUE SPACES. 00240000
002500     05  DK-START-TMST                  PIC  X(26)  VALUE SPACES. 00250000
002600     05  DK-END-TMST                    PIC  X(26)  VALUE SPACES. 00260000
002700     05  DK-PC-DEFAULT-TMST             PIC  X(26) VALUE          00270000
002800                                     '9999-09-09-09.09.09.999999'.00280000
002900     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00290000
003000                                                   COMP.          00300000
003100     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00310000
003200                                                   COMP.          00320000
003300     05  DK-TRIP-ID                     PIC S9(09) COMP.          00330000
003400     05  DK-DOOR-ID                     PIC  X(04) VALUE SPACES.  00340000
003500     05  DK-TRLR-SRL-NBR                PIC S9(09) COMP.          00350000
003600     05  DK-TRLR-ID                     PIC  X(12).               00360000
003700     05  DK-SML-NBR                     PIC S9(18)V COMP-3.       00370000
003800                                                                  00380000
003900 01  PC-PROGRAM-CONSTANTS.                                        00390000
004000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU573A  '.  00400000
004100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM573'.   00410000
004200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS573'.  00420000
004300     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00430000
004400     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00440000
004500     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00450000
004600     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00460000
004700     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +11          00470000
004800                                               COMP SYNC.         00480000
004900     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00490000
005000                                               COMP SYNC.         00500000
005100     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00510000
005200                                               COMP-3.            00520000
005300     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00530000
005400                                               COMP SYNC.         00540000
005500     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00550000
005600                                               COMP-3.            00560000
005700     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00570000
005800     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00580000
005900     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00590000
006000     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00600000
006100     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00610000
006200     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00620000
006300                                               COMP.              00630000
006400     05  PC-01                     PIC  X(02)  VALUE '01'.        00640000
006500     05  PC-PO                     PIC  X(02)  VALUE 'PO'.        00650000
006600     05  PC-SH                     PIC  X(02)  VALUE 'SH'.        00660000
006700     05  PC-A                      PIC  X(01)  VALUE 'A'.         00670000
006800     05  PC-D                      PIC  X(01)  VALUE 'D'.         00680000
006900     05  PC-S                      PIC  X(01)  VALUE 'S'.         00690000
007000     05  PC-I                      PIC  X(01)  VALUE 'I'.         00700000
007100     05  PC-SHON                   PIC  X(04)  VALUE 'SHON'.      00710000
007200     05  PC-SHOF                   PIC  X(04)  VALUE 'SHOF'.      00720000
007300*                                                                 00730000
007400     05  PC-PCKRF743           PIC  X(15) VALUE 'TRAILER LOG-IN '.00740000
007500     05  PC-PCKRF870           PIC  X(15) VALUE 'OPEN TRAILER'.   00750000
007600     05  PC-PCKRF872           PIC  X(15) VALUE 'SIGN ON TRAILER'.00760000
007700     05  PC-PCKRF874           PIC  X(15) VALUE 'DIVERT BEG/END'. 00770000
007800     05  PC-PCKR874A           PIC  X(15) VALUE 'RF-BEGIN CUTOF'. 00780000
007900     05  PC-PCKR874B           PIC  X(15) VALUE 'RF-END CUTOFF '. 00790000
008000     05  PC-PCKRF875           PIC  X(15) VALUE 'OPEN TRAILER'.   00800000
008100     05  PC-PCKRF877           PIC  X(15) VALUE 'CLOSE TRAILER'.  00810000
008200     05  PC-PCKRF878           PIC  X(15) VALUE 'SIGN ON TRAILER'.00820000
008300     05  PC-PCKRF879           PIC  X(15) VALUE 'SCAN ON/OFF CTN'.00830000
008400     05  PC-PCKRF898           PIC  X(15) VALUE 'SIGN ON TRAILER'.00840000
008500     05  PC-SUKCS561           PIC  X(15) VALUE 'DESKTOP END    '.00850000
008600     05  PC-SUKC564A           PIC  X(15) VALUE 'DESKTOP BEGIN  '.00860000
008700     05  PC-SUKC564B           PIC  X(15) VALUE 'DESKTOP END    '.00870000
008800     05  PC-SUKC568A           PIC  X(15) VALUE 'OPEN @ STORE   '.00880000
008900     05  PC-SUKC568B           PIC  X(15) VALUE 'UNLOAD @ STORE '.00890000
009000*WEB SERVICE PROGRAM SUKCS802 ADDED                               00900010
009100     05  PC-SUKC802A           PIC  X(15) VALUE 'STRREC OPEN@STR'.00910012
009200     05  PC-SUKC802B           PIC  X(15) VALUE 'STRREC UNLD@STR'.00920012
009300*                                                                 00930008
009400     05  PC-SUKCS808           PIC  X(15) VALUE 'SHIP TRLR KIOSK'.00940015
009500     05  PC-SUKC808S           PIC  X(15) VALUE 'SHIP SUM KIOSK '.00950016
009600*                                                                 00960015
009700     05  PC-SUKC597A           PIC  X(15) VALUE 'SHIP TRAILER   '.00970013
009800     05  PC-SUKC597B           PIC  X(15) VALUE 'RELEASE TRAILER'.00980000
009900     05  PC-SUKC597C           PIC  X(15) VALUE 'RLSE STORG TRLR'.00990000
010000     05  PC-SUKCS597           PIC  X(15) VALUE 'SHIP/RELEASE   '.01000000
010100                                                                  01010007
010200     05  PC-SUKUT574           PIC  X(15) VALUE 'BATCH SUMMARY  '.01020007
010300     05  PC-SUKCS574           PIC  X(15) VALUE 'CICS SUMMARY   '.01030007
010400     05  PC-PCKR743A           PIC  X(15) VALUE 'ASSOC ON SUMMRY'.01040007
010500     05  PC-PCKR877A           PIC  X(15) VALUE 'CLOSE TRLR SUMM'.01050007
010600     05  PC-SUKC597D           PIC  X(15) VALUE 'SHIP/REL SUMMRY'.01060007
010700     05  PC-SUKCS766           PIC  X(15) VALUE 'TRIP SRL UPDATE'.01070011
010710     05  PC-SUKUT576           PIC  X(15) VALUE 'SUMMARY REFRESH'.01071025
010711                                                                  01071126
010720     05  PC-SUKUP38A           PIC  X(15) VALUE 'REG TRLR DAYS  '.01072026
010730     05  PC-SUKUP38B           PIC  X(15) VALUE 'VIRTL TRLR DAYS'.01073026
010740     05  PC-SUKUP38C           PIC  X(15) VALUE 'REG TRLR INV   '.01074026
010750     05  PC-SUKUP38D           PIC  X(15) VALUE 'VIRTL TRLR INV '.01075026
010760     05  PC-SUKUP38E           PIC  X(15) VALUE 'REG TRLR RFID  '.01076026
010770     05  PC-SUKUP38F           PIC  X(15) VALUE 'VIRTL TRLR RFID'.01077026
010780     05  PC-SUKUP38G           PIC  X(15) VALUE 'FORCED EARLY   '.01078026
010790     05  PC-SUKUP38H           PIC  X(15) VALUE 'FORCE EXCEPTION'.01079026
010791     05  PC-SUKUP038           PIC  X(15) VALUE 'ASSUMPTIVE RECV'.01079126
010792     05  PC-SUKU040A           PIC  X(15) VALUE 'FORCED OPEN@STR'.01079242
010793     05  PC-SUKU040C           PIC  X(15) VALUE 'FORCED OPEN@STR'.01079345
010794     05  PC-SUKU040B           PIC  X(15) VALUE 'FORCED UNLD@STR'.01079445
010795     05  PC-SUKU040D           PIC  X(15) VALUE 'FORCED UNLD@STR'.01079545
010800                                                                  01080000
010900*----------------------------------------------------------------*01090000
011000*  SYSTEM MESSAGES                                               *01100000
011100*----------------------------------------------------------------*01110000
011200*   00005 = INVALID VALUE                                        *01120000
011300*   00008 = MUST BE NUMERIC                                      *01130000
011400*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01140000
011500*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01150000
011600*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01160000
011700*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01170000
011800*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01180000
011900*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01190000
012000*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01200000
012100*   00069 - TOP OF LIST                                          *01210000
012200*   00070 - BOTTOM OF LIST                                       *01220000
012300*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01230000
012400*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01240000
012500*   00279 - MORE ITEMS TO DISPLAY                                *01250000
012600*   00743 - TRIP DOES NOT EXIST                                  *01260000
012700*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS DATA             *01270000
012800*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01280000
012900*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01290000
013000*   02792 = ENDING CUTOFF ALREADY EXISTS FOR TRLR-BEGIN CUTOFF NE*01300000
013100*   02793 = CARTON IS ALREADY LOADED ONTO A TRAILER.             *01310000
013200*   02796 = END CUTOFF ASSIGNMENT SUCCESSFUL.                    *01320000
013300*   02799 = END CARTON DIVERT TIME MUST BE GREATER THAN BEGIN CAR*01330000
013400*   99901 = INVALID COMMAND WAS ENTERED                          *01340000
013500*----------------------------------------------------------------*01350000
013600     05  PC-TSYMSG-NUMBERS.                                       01360000
013700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01370000
013800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01380000
013900         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01390000
014000         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01400000
014100         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01410000
014200         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01420000
014300         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01430000
014400         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01440000
014500         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01450000
014600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01460000
014700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01470000
014800         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01480000
014900         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01490000
015000         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01500000
015100         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01510000
015200         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01520000
015300         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01530000
015400         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01540000
015500         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01550000
015600         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01560000
015700         10  PC-TSYMSG-02792            PIC  9(05)  VALUE 02792.  01570000
015800         10  PC-TSYMSG-02793            PIC  9(05)  VALUE 02793.  01580000
015900         10  PC-TSYMSG-02796            PIC  9(05)  VALUE 02796.  01590000
016000         10  PC-TSYMSG-02799            PIC  9(05)  VALUE 02799.  01600000
016100         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01610000
016200*                                                                 01620000
016300 01  PS-PROGRAM-SWITCHES.                                         01630000
016400     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01640000
016500         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01650000
016600         88  PS-BLOCK-ERROR                         VALUE 'N'.    01660000
016700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01670000
016800         88  PS-NO-ERROR                            VALUE 'Y'.    01680000
016900         88  PS-ERROR                               VALUE 'N'.    01690000
017000     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01700000
017100         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01710000
017200         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01720000
017300     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01730000
017400         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01740000
017500         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01750000
017600     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01760000
017700         88  PS-DONE                                VALUE 'Y'.    01770000
017800         88  PS-NOT-DONE                            VALUE 'N'.    01780000
017900     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01790000
018000         88  PS-LIST-END                            VALUE 'Y'.    01800000
018100         88  PS-NO-LIST-END                         VALUE 'N'.    01810000
018200     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01820000
018300         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01830000
018400         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01840000
018500     05  PS-TRIP-OPEN-SW                PIC  X(01)  VALUE ' '.    01850000
018600         88  PS-TRIP-OPEN                           VALUE 'Y'.    01860000
018700         88  PS-TRIP-NOT-OPEN                       VALUE 'N'.    01870000
018800*                                                                 01880000
018900 01  PV-PROGRAM-VARIABLES.                                        01890000
019000     05  PV-RACF-ERROR-CODE              PIC  9(04) VALUE ZEROES. 01900000
019100     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01910000
019200                                                     COMP SYNC.   01920000
019300     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01930000
019400     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01940000
019500     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01950000
019600                                        COMP SYNC.                01960000
019700     05  PV-SUB                         PIC S9(04)  VALUE +0      01970000
019800                                                    COMP SYNC.    01980000
019900     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01990000
020000                                                    COMP SYNC.    02000000
020100     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02010000
020200                                                    COMP-3.       02020000
020300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02030000
020400                                                    COMP-3.       02040000
020500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02050000
020600                                                    COMP-3.       02060000
020700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02070000
020800                                                    COMP-3.       02080000
020900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02090000
021000                                                    COMP-3.       02100000
021100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02110000
021200                                                    COMP-3.       02120000
021300     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02130000
021400                                                    COMP-3.       02140000
021500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02150000
021600                                                    COMP SYNC.    02160000
021700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02170000
021800                                                    COMP SYNC.    02180000
021900     05  PV-ITEM                        PIC S9(04)  VALUE +0      02190000
022000                                                    COMP SYNC.    02200000
022100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02210000
022200                                                    COMP SYNC.    02220000
022300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02230000
022400                                                    COMP SYNC.    02240000
022500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02250000
022600                                                    COMP SYNC.    02260000
022700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02270000
022800                                                    COMP SYNC.    02280000
022900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02290000
023000                                                    COMP SYNC.    02300000
023100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02310000
023200                                                    COMP SYNC.    02320000
023300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02330000
023400                                                    COMP SYNC.    02340000
023500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02350000
023600                                                    COMP SYNC.    02360000
023700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02370000
023800                                                    COMP SYNC.    02380000
023900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02390000
024000                                                    COMP SYNC.    02400000
024100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02410000
024200                                                    COMP SYNC.    02420000
024300     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02430000
024400                                                    COMP SYNC.    02440000
024500     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02450000
024600                                                    COMP SYNC.    02460000
024700     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02470000
024800                                                    COMP.         02480000
024900     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02490000
025000                                                    COMP.         02500000
025100     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02510000
025200                                                    COMP.         02520000
025300     05  PV-SOFT-ABORT-MSG.                                       02530000
025400         10  FILLER            PIC X(12) VALUE ' SUKCS573 - '.    02540000
025500         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02550000
025600         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02560000
025700         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02570000
025800         10  PV-SOFT-PARAGRAPH PIC X(30).                         02580000
025900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02590000
026000                                                     COMP SYNC.   02600000
026100     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02610000
026200     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02620000
026300     05  PV-CICS-MSG-HOLD.                                        02630000
026400         10  FILLER                      PIC  X(01)  VALUE SPACE. 02640000
026500         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02650000
026600     05  PV-CICS-MSG-HOLD2.                                       02660000
026700         10  FILLER                      PIC  X(01)  VALUE SPACE. 02670000
026800         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02680000
026900                                                                  02690000
027000     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02700000
027100     05  PV-TMST-R REDEFINES  PV-TMST.                            02710000
027200         10   PV-TMST-DATE.                                       02720000
027300             15   PV-TMST-CCYY          PIC X(04).                02730000
027400             15   FILLER                PIC X(01).                02740000
027500             15   PV-TMST-MM            PIC X(02).                02750000
027600             15   FILLER                PIC X(01).                02760000
027700             15   PV-TMST-DD            PIC X(02).                02770000
027800         10   FILLER                    PIC X(01).                02780000
027900         10   PV-TMST-TIME.                                       02790000
028000             15   PV-TMST-HRS           PIC X(02).                02800000
028100             15   FILLER                PIC X(01).                02810000
028200             15   PV-TMST-MIN           PIC X(02).                02820000
028300         10   FILLER                    PIC X(01).                02830000
028400         10   PV-TMST-SEC               PIC X(02).                02840000
028500         10   FILLER                    PIC X(07).                02850000
028600     05  PV-FROM-TMST.                                            02860000
028700         10   PV-FROM-YY    PIC X(04)  VALUE ZEROES.              02870000
028800         10   FILLER        PIC X(01)  VALUE '-'.                 02880000
028900         10   PV-FROM-MM    PIC X(02)  VALUE ZEROES.              02890000
029000         10   FILLER        PIC X(01)  VALUE '-'.                 02900000
029100         10   PV-FROM-DD    PIC X(02)  VALUE ZEROES.              02910000
029200         10   FILLER        PIC X(16)  VALUE '-00.00.00.000000'.  02920000
029300     05  PV-TO-TMST.                                              02930000
029400         10   PV-TO-YY      PIC X(04)  VALUE ZEROES.              02940000
029500         10   FILLER        PIC X(01)  VALUE '-'.                 02950000
029600         10   PV-TO-MM      PIC X(02)  VALUE ZEROES.              02960000
029700         10   FILLER        PIC X(01)  VALUE '-'.                 02970000
029800         10   PV-TO-DD      PIC X(02)  VALUE ZEROES.              02980000
029900         10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  02990000
030000     05  PV-DATE-DISPLAY.                                         03000000
030100         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 03010000
030200         10   PV-SLASH-1                PIC X(01)   VALUE '-'.    03020000
030300         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 03030000
030400         10   PV-SLASH-2                PIC X(01)   VALUE '-'.    03040000
030500         10   PV-DISPLAY-CCYY           PIC X(04)   VALUE SPACES. 03050000
030600     05  PV-TIME-DISPLAY.                                         03060000
030700         10   PV-AT                     PIC X(03)   VALUE SPACES. 03070000
030800         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 03080000
030900         10   PV-SEMICOLON-1            PIC X(01)   VALUE SPACES. 03090000
031000         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 03100000
031100         10   PV-SEMICOLON-2            PIC X(01)   VALUE SPACES. 03110000
031200         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 03120000
031300     05  PV-DATE-TIME.                                            03130000
031400         10   PV-DT-CC             PIC X(02)  VALUE '20'.         03140000
031500         10   PV-DT-YY             PIC X(02)  VALUE ZEROES.       03150000
031600         10   FILLER               PIC X(01)  VALUE '-'.          03160000
031700         10   PV-DT-MM             PIC X(02)  VALUE ZEROES.       03170000
031800         10   FILLER               PIC X(01)  VALUE '-'.          03180000
031900         10   PV-DT-DD             PIC X(02)  VALUE ZEROES.       03190000
032000         10   FILLER               PIC X(01)  VALUE '-'.          03200000
032100         10   PV-DT-HRS            PIC X(02)   VALUE SPACES.      03210000
032200         10   FILLER               PIC X(01)   VALUE '.'.         03220000
032300         10   PV-DT-MIN            PIC X(02)   VALUE SPACES.      03230000
032400         10   FILLER               PIC X(01)   VALUE '.'.         03240000
032500         10   PV-DT-SEC            PIC X(09)   VALUE '59.999999'. 03250000
032600     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 03260000
032700     05  PV-USA-DATE                     PIC  X(10) VALUE SPACES. 03270000
032800     05  PV-JIS-TIME                     PIC  X(05) VALUE SPACES. 03280000
032900     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 03290000
033000     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 03300000
033100     05  PV-SEL-TERM-ID                  PIC  X(04).              03310000
033200     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03320000
033300     05  PV-SEL-SEQ                      PIC  9(01).              03330000
033400     05  PV-NAME                         PIC  X(30).              03340000
033410     05  PV-DISP-SQLCODE1                PIC  -999.               03341021
033420     05  PV-DISP-SQLCODE2                PIC  -999.               03342021
033430     05  PV-UNION-SELECTION              PIC  X.                  03343035
033440         88  PV-UNION-TRACKING                      VALUE 'A'.    03344035
033450         88  PV-UNION-TSUOBTS                       VALUE 'B'.    03345036
033500                                                                  03350000
033600******************************************************************03360000
033700**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03370000
033800**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03380000
033900**  APPLICATION-SPECIFIC COMMAREA.                              **03390000
034000******************************************************************03400000
034100 01  LQW-LIST-QUEUE-WORK-AREA.                                    03410000
034200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03420000
034300     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           03430000
034400                                        INDEXED BY LQW-IDX.       03440000
034500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03450000
034600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03460000
034700         10  LQW-SELECTED-SW            PIC  X(01).               03470000
034800             88  LQW-SELECT                         VALUE 'S'.    03480000
034900             88  LQW-DESELECT                       VALUE ' '.    03490000
035000         10  LQW-ACTION                 PIC  X(03).               03500000
035100             88  LQW-DEL                            VALUE 'DEL'.  03510000
035200             88  LQW-INQ                            VALUE 'INQ'.  03520000
035300             88  LQW-UPD                            VALUE 'UPD'.  03530000
035400             88  LQW-ERR                            VALUE 'ERR'.  03540000
035500         10  LQW-USER-ID                PIC  X(08).               03550000
035600         10  LQW-NAME                   PIC  X(30).               03560000
035700         10  LQW-FUNCTION               PIC  X(15).               03570000
035800         10  LQW-STAT-DATE              PIC  X(10).               03580000
035900         10  LQW-STAT-TIME              PIC  X(05).               03590000
036000                                                                  03600000
036100*---------------------------------------------------------------* 03610000
036200* SELECTON QUEUE LAYOUT                                         * 03620000
036300*---------------------------------------------------------------* 03630000
036400     COPY SUWS010.                                                03640000
036500                                                                  03650000
036600*----------------------------------------------------------------*03660003
036700***  LAYOUT FOR THE TEMP ASSOC INFO SUBROUTINE                    03670003
036800*----------------------------------------------------------------*03680003
036900     COPY XLWS067.                                                03690003
037000                                                                  03700003
037100*---------------------------------------------------------------* 03710000
037200*    MAP LAYOUT                                                 * 03720000
037300*---------------------------------------------------------------* 03730000
037400     COPY SUKM573.                                                03740000
037500*                                                                 03750000
037600 01  MR-OCCURS-LAYOUT                   REDEFINES  SU573AO.       03760000
037700     05  FILLER                         PIC X(203).               03770000
037800     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          03780000
037900         10  MR-USER-IDL                PIC S9(04) COMP.          03790000
038000         10  MR-USER-IDA                PIC  X(01).               03800000
038100         10  MR-USER-IDC                PIC  X(01).               03810000
038200         10  MR-USER-IDH                PIC  X(01).               03820000
038300         10  MR-USER-ID                 PIC  X(08).               03830000
038400                                                                  03840000
038500         10  MR-NAMEL                   PIC S9(04) COMP.          03850000
038600         10  MR-NAMEA                   PIC  X(01).               03860000
038700         10  MR-NAMEC                   PIC  X(01).               03870000
038800         10  MR-NAMEH                   PIC  X(01).               03880000
038900         10  MR-NAME                    PIC  X(30).               03890000
039000                                                                  03900000
039100         10  MR-FUNCTIONL               PIC S9(04) COMP.          03910000
039200         10  MR-FUNCTIONA               PIC  X(01).               03920000
039300         10  MR-FUNCTIONC               PIC  X(01).               03930000
039400         10  MR-FUNCTIONH               PIC  X(01).               03940000
039500         10  MR-FUNCTION                PIC  X(15).               03950000
039600                                                                  03960000
039700         10  MR-STAT-DATEL              PIC S9(04) COMP.          03970000
039800         10  MR-STAT-DATEA              PIC  X(01).               03980000
039900         10  MR-STAT-DATEC              PIC  X(01).               03990000
040000         10  MR-STAT-DATEH              PIC  X(01).               04000000
040100         10  MR-STAT-DATE               PIC  X(10).               04010000
040200                                                                  04020000
040300         10  MR-STAT-TIMEL              PIC S9(04) COMP.          04030000
040400         10  MR-STAT-TIMEA              PIC  X(01).               04040000
040500         10  MR-STAT-TIMEC              PIC  X(01).               04050000
040600         10  MR-STAT-TIMEH              PIC  X(01).               04060000
040700         10  MR-STAT-TIME               PIC  X(05).               04070000
040800                                                                  04080000
040900     05  FILLER                         PIC X(011).               04090000
041000*---------------------------------------------------------------* 04100000
041100*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04110000
041200*---------------------------------------------------------------* 04120000
041300     COPY DPWS015.                                                04130000
041400                                                                  04140000
041500*---------------------------------------------------------------* 04150000
041600*    FUNCTION KEYS COPYBOOK.                                    * 04160000
041700*---------------------------------------------------------------* 04170000
041800     COPY DPWS016.                                                04180000
041900                                                                  04190000
042000*----------------------------------------------------------------*04200000
042100**  SECURITY SUBROUTINE PARAMETERS                                04210000
042200*----------------------------------------------------------------*04220000
042300     COPY DPWS008.                                                04230000
042400                                                                  04240000
042500*---------------------------------------------------------------* 04250000
042600*    NUMERIC EDIT LAYOUT.                                       * 04260000
042700*---------------------------------------------------------------* 04270000
042800     COPY DPWS010I.                                               04280000
042900                                                                  04290000
043000*---------------------------------------------------------------* 04300000
043100*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04310039
043200*---------------------------------------------------------------* 04320000
043300     COPY DPWS030.                                                04330000
043310     COPY DPWS930.                                                04331039
043400                                                                  04340000
043500*---------------------------------------------------------------* 04350000
043600*    STANDARD COMMAREA.                                         * 04360000
043700*---------------------------------------------------------------* 04370000
043800     COPY DPWS020.                                                04380000
043900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04390000
044000                                                                  04400000
044100*---------------------------------------------------------------* 04410000
044200* INTER-APPLICATION COMMAREA.                                   * 04420000
044300*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04430000
044400*             SPEC SCREEN.                                      * 04440000
044500*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04450000
044600*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04460000
044700*---------------------------------------------------------------* 04470000
044800                                                                  04480000
044900         10  INTER-APPL-COMM-AREA       PIC X(200).               04490000
045000     COPY SUWS008.                                                04500000
045100     COPY SUWS009.                                                04510000
045200*---------------------------------------------------------------* 04520000
045300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04530000
045400*---------------------------------------------------------------* 04540000
045500         10  ASC-SPECIFIC-COMMAREA.                               04550000
045600             15  ASC-OPER-UNT-ID             PIC  X(04).          04560000
045700             15  ASC-OPER-UNT-ID-N REDEFINES                      04570000
045800                     ASC-OPER-UNT-ID         PIC  9(04).          04580000
045900             15  ASC-SCAC-CODE-H             PIC  X(04).          04590000
046000             15  ASC-SCAC-CODE-L             PIC  X(04).          04600000
046100             15  ASC-MANUAL                  PIC  9(06).          04610000
046200             15  ASC-DIVERT                  PIC  9(06).          04620000
046300             15  ASC-TRLR-SRL-NMBR-H         PIC  9(09).          04630000
046400             15  ASC-TRLR-SRL-NMBR-L         PIC  9(09).          04640000
046500             15  ASC-TRLR-ID-H               PIC  X(12).          04650000
046600             15  ASC-TRLR-ID-L               PIC  X(12).          04660000
046700             15  ASC-OTBND-TRIP-ID           PIC  9(09).          04670000
046800             15  ASC-DOORSLOT                PIC  X(06).          04680000
046900             15  ASC-NUMBER                  PIC  X(06).          04690000
047000             15  ASC-DOOR-DESC               PIC  X(25).          04700000
047100             15  ASC-TOTAL                   PIC  9(06).          04710000
047200             15  ASC-DOOR-ID                 PIC  X(04).          04720000
047300             15  ASC-DOOR-TYPE               PIC  X(02).          04730000
047400             15  ASC-STR-NBR-X               PIC  X(04).          04740000
047500             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           04750000
047600                 20  ASC-STR-NBR             PIC  9(04).          04760000
047700             15  ASC-TRIP-DEST-OPER          PIC  X(04).          04770000
047800             15 ASC-TRIP-DEST-OPER-X REDEFINES ASC-TRIP-DEST-OPER.04780000
047900                 20  ASC-TRIP-DEST-OPER-N    PIC  9(04).          04790000
048000             15  ASC-STATUS-DATE             PIC  X(10).          04800000
048100             15  ASC-STATUS-TIME             PIC  X(05).          04810000
048200             15  ASC-USERID                  PIC  X(08).          04820000
048300             15  ASC-TRIP-STAT-CDE           PIC  X(02).          04830000
048400             15  ASC-TRIP-STAT-DESC          PIC  X(10).          04840000
048500             15  FILLER                      PIC  X(025).         04850000
048600*-----------------------------------------------------------------04860000
048700             15  ASC-BLK-SUB                  PIC S9(04) COMP     04870000
048800                                                         SYNC.    04880000
048900             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04890000
049000                                                         SYNC.    04900000
049100             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04910000
049200             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04920000
049300             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04930000
049400             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04940000
049500             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04950000
049600             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04960000
049700                                                         SYNC.    04970000
049800             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04980000
049900             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04990000
050000             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05000000
050100                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05010000
050200                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05020000
050300             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05030000
050400                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05040000
050500                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05050000
050600             15  ASC-LIST-QUEUE-NAME.                             05060000
050700                 20  ASC-LIST-TERM-ID         PIC  X(04).         05070000
050800                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05080000
050900                 20  ASC-LIST-SEQ             PIC  9(01).         05090000
051000                                                                  05100000
051100             15  ASC-START-ITEM-REQUEST.                          05110000
051200                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05120000
051300                                                                  05130000
051400             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05140000
051500             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05150000
051600             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05160000
051700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05170000
051800             15  ASC-SEL-QUEUE-NAME.                              05180000
051900                 20  ASC-SEL-TERM-ID          PIC  X(04).         05190000
052000                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05200000
052100                 20  ASC-SEL-SEQ              PIC  9(01).         05210000
052200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05220000
052300                                                                  05230000
052400*-----------------------------------------------------------------05240000
052500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05250000
052600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05260000
052700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05270000
052800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05280000
052900                                                                  05290000
053000                 20  ASC-ITEM-ARRAY.                              05300000
053100                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        05310000
053200                         30  ASC-LIST-ITEM-NUMBER                 05320000
053300                                                     PIC S9(09)   05330000
053400                                                     COMP-3.      05340000
053500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05350000
053600                             88  ASC-VALID-SELECT    VALUE ' '    05360000
053700                                                           'S'    05370000
053800                                                           'B'    05380000
053900                                                           'E'.   05390000
054000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05400000
054100                             88  ASC-TEMP-SELECT     VALUE 'S'.   05410000
054200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05420000
054300                             88  ASC-TEMP-END        VALUE 'E'.   05430000
054400                         30  ASC-SELECTED-SW         PIC  X(01).  05440000
054500                             88  ASC-NO-SELECT       VALUE ' '.   05450000
054600                             88  ASC-SELECT          VALUE 'S'.   05460000
054700                             88  ASC-BEGIN           VALUE 'B'.   05470000
054800                             88  ASC-END             VALUE 'E'.   05480000
054900                         30  ASC-ACTION               PIC  X(03). 05490000
055000                         30  ASC-USER-ID              PIC  X(08). 05500000
055100                         30  ASC-NAME                 PIC  X(30). 05510000
055200                         30  ASC-FUNCTION             PIC  X(15). 05520000
055300                         30  ASC-STAT-DATE            PIC  X(10). 05530000
055400                         30  ASC-STAT-TIME            PIC  X(05). 05540000
055500                                                                  05550000
055600*---------------------------------------------------------------* 05560000
055700*    ABEND PROCESSING COPYBOOK.                                 * 05570000
055800*---------------------------------------------------------------* 05580000
055900     COPY DPWS013.                                                05590000
056000                                                                  05600000
056100*---------------------------------------------------------------* 05610000
056200*    SUT_OTBND_LOC                                                05620000
056300*---------------------------------------------------------------* 05630000
056400     EXEC SQL                                                     05640000
056500          INCLUDE SUT00027                                        05650000
056600     END-EXEC.                                                    05660000
056700                                                                  05670000
056800*---------------------------------------------------------------* 05680000
056900*    SUT_OTBND_CART                                               05690000
057000*---------------------------------------------------------------* 05700000
057100     EXEC SQL                                                     05710000
057200          INCLUDE SUT00024                                        05720000
057300     END-EXEC.                                                    05730000
057400                                                                  05740000
057500*---------------------------------------------------------------* 05750000
057600*    TSULBXF - SHIPT UNT CROSS REFERENCE                          05760000
057700*---------------------------------------------------------------* 05770000
057800     EXEC SQL                                                     05780000
057900          INCLUDE TSULBXF                                         05790000
058000     END-EXEC.                                                    05800000
058100                                                                  05810000
058200*---------------------------------------------------------------* 05820000
058300*    SUT_OTBND_UPC - OUTBOUND SHIPT UNT UPC TABLE                 05830000
058400*---------------------------------------------------------------* 05840000
058500     EXEC SQL                                                     05850000
058600          INCLUDE SUT00028                                        05860000
058700     END-EXEC.                                                    05870000
058800                                                                  05880000
058900*---------------------------------------------------------------* 05890000
059000*    TSUOBTR - OUTBOUND TRAILER TRIP                            * 05900000
059100*---------------------------------------------------------------* 05910000
059200     EXEC SQL                                                     05920000
059300          INCLUDE TSUOBTR                                         05930000
059400     END-EXEC.                                                    05940000
059500                                                                  05950000
059600*---------------------------------------------------------------* 05960000
059700*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 05970000
059800*---------------------------------------------------------------* 05980000
059900     EXEC SQL                                                     05990000
060000          INCLUDE TSUOBTS                                         06000000
060100     END-EXEC.                                                    06010000
060200                                                                  06020000
060300*---------------------------------------------------------------* 06030000
060400*    TSUOBSC - TRIP STATUS CODE DESCRIPTION                       06040000
060500*---------------------------------------------------------------* 06050000
060600     EXEC SQL                                                     06060000
060700          INCLUDE TSUOBSC                                         06070000
060800     END-EXEC.                                                    06080000
060900                                                                  06090000
061000*---------------------------------------------------------------* 06100000
061100*    TSUCDOT - CARTON DIVERT - TRIP ASSOCIATION TABLE             06110000
061200*---------------------------------------------------------------* 06120000
061300     EXEC SQL                                                     06130000
061400          INCLUDE TSUCDOT                                         06140000
061500     END-EXEC.                                                    06150000
061600                                                                  06160000
061700*---------------------------------------------------------------* 06170000
061800*    TSUCRDV - CARTON DIVERT TABLE                                06180000
061900*---------------------------------------------------------------* 06190000
062000     EXEC SQL                                                     06200000
062100          INCLUDE TSUCRDV                                         06210000
062200     END-EXEC.                                                    06220000
062300                                                                  06230000
062400*---------------------------------------------------------------* 06240000
062500*    SUT_TRIP_WRKR_AUD TABLE                                      06250000
062600*---------------------------------------------------------------* 06260000
062700     EXEC SQL                                                     06270000
062800          INCLUDE SUT00006                                        06280000
062900     END-EXEC.                                                    06290000
063000                                                                  06300000
063100*---------------------------------------------------------------* 06310000
063200*    TCNDCDR - DC TO DOOR ASSIGNMENT                            * 06320000
063300*---------------------------------------------------------------* 06330000
063400     EXEC SQL                                                     06340000
063500          INCLUDE TCNDCDR                                         06350000
063600     END-EXEC.                                                    06360000
063700                                                                  06370000
063800*---------------------------------------------------------------* 06380000
063900*   TCNDRST - DC DOOR TO STORE ASSOCIATION TABLE                * 06390000
064000*---------------------------------------------------------------* 06400000
064100     EXEC SQL                                                     06410000
064200          INCLUDE TCNDRST                                         06420000
064300     END-EXEC.                                                    06430000
064400                                                                  06440000
064500*---------------------------------------------------------------* 06450000
064600*    TCNTRID - TRAILIER ID TABLE                                  06460000
064700*---------------------------------------------------------------* 06470000
064800     EXEC SQL                                                     06480000
064900          INCLUDE TCNTRID                                         06490000
065000     END-EXEC.                                                    06500000
065100                                                                  06510000
065110*---------------------------------------------------------------* 06511035
065120*    XLT_LOC                                                      06512035
065130*---------------------------------------------------------------* 06513035
065140     EXEC SQL                                                     06514035
065150          INCLUDE XLT00010                                        06515035
065160     END-EXEC.                                                    06516035
065170                                                                  06517035
065200*---------------------------------------------------------------* 06520000
065300*    DB2 AREA FOR COMMUNICATIONS                                * 06530000
065400*---------------------------------------------------------------* 06540000
065500     EXEC SQL                                                     06550000
065600          INCLUDE SQLCA                                           06560000
065700     END-EXEC.                                                    06570000
065800                                                                  06580000
065900*---------------------------------------------------------------* 06590000
066000*    AUDIT TABLE CURSOR                                           06600000
066100*---------------------------------------------------------------* 06610000
066200      EXEC SQL                                                    06620000
066300          DECLARE AUDIT-CSR CURSOR FOR                            06630000
066400           SELECT 'A'                                             06640035
066410                 ,USR_ID                                          06641035
066500                 ,CRE_TMST                                        06650035
066600                 ,CHAR(DATE(CRE_TMST),USA)                        06660035
066700                 ,SUBSTR(CHAR(TIME(CRE_TMST),JIS),1,5)            06670035
066800                 ,CRE_BY_PGM_NM                                   06680035
066900             FROM SUT_TRIP_WRKR_AUD                               06690035
067000            WHERE OTBND_TRIP_ID    = :DK-TRIP-ID                  06700035
067010            UNION                                                 06701035
067020           SELECT 'B'                                             06702035
067021                 ,A.OTBND_STAT_USR_ID                             06702135
067030                 ,A.OTBND_STAT_TMST                               06703035
067040                 ,CHAR(DATE(A.OTBND_STAT_TMST),USA)               06704035
067050                 ,SUBSTR(CHAR(TIME(A.OTBND_STAT_TMST),JIS),1,5)   06705035
067060                 ,A.TRIP_STAT_CDE||'-'||(CHAR(A.STAT_OPER_UNT_ID))06706035
067070             FROM TSUOBTS A                                       06707035
067071                , XLT_LOC B                                       06707135
067080            WHERE A.OTBND_TRIP_ID     = :DK-TRIP-ID               06708035
067090              AND A.STAT_OPER_UNT_ID  = B.LOC_NBR                 06709035
067091              AND B.E_BUS_IND         = 'Y'                       06709135
067100            ORDER BY 3                                            06710037
067110             WITH UR                                              06711035
067200         END-EXEC.                                                06720000
067300                                                                  06730000
067400******************************************************************06740000
067500* VARIOUS CURSORS, SELECTS, AND WORKING STORAGE AREAS FOR         06750000
067600* RETRIEVING CARTONS                                              06760000
067700******************************************************************06770000
067800     COPY PCWS049.                                                06780000
067900     COPY PCWS050.                                                06790000
068000                                                                  06800000
068100*-----------------------------------------------------------------06810000
068200 LINKAGE SECTION.                                                 06820000
068300                                                                  06830000
068400 01  DFHCOMMAREA.                                                 06840000
068500     05  FILLER                         OCCURS  1 TO 4072 TIMES   06850000
068600                                        DEPENDING ON EIBCALEN.    06860000
068700         10  FILLER                     PIC X.                    06870000
068800                                                                  06880000
068900                                                                  06890000
069000 PROCEDURE DIVISION.                                              06900000
069100******************************************************************06910000
069200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06920000
069300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06930000
069400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06940000
069500******************************************************************06950000
069600 0000-MAIN-MODULE.                                                06960000
069700     INITIALIZE DP030-CICS-API-FIELDS.                            06970000
069800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06980000
069900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06990000
070000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07000000
070100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07010000
070200     MOVE LENGTH OF SU573AI        TO DP030-MAP-LENGTH (1).       07020000
070300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07030000
070400     PERFORM 0001-CALL-CICS-ARCH-API.                             07040000
070500*                                                                 07050000
070600     PERFORM 1000-CONTROL-PROCESSING                              07060000
070700*                                                                 07070000
070800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07080000
070900     PERFORM 0001-CALL-CICS-ARCH-API.                             07090000
071000                                                                  07100000
071100******************************************************************07110000
071200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07120000
071300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07130000
071400******************************************************************07140000
071500 0001-CALL-CICS-ARCH-API.                                         07150000
071600*    CALL 'DPKCS030' USING DFHEIBLK                               07160039
071610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07161039
071700                           DFHCOMMAREA                            07170000
071800                           DP030-CICS-API-FIELDS                  07180000
071900                           DP020-STANDARD-COMMAREA                07190000
072000                           SU573AI.                               07200000
072100*                                                                 07210000
072200     IF  DP030-RC-CALL-SUCCESSFUL                                 07220000
072300         CONTINUE                                                 07230000
072400     ELSE                                                         07240000
072500         SET DP013-NO-ROLLBACK                                    07250000
072600             DP013-XCTL-DISPLAY-RESTART                           07260000
072700             DP013-CICS-ABEND      TO TRUE                        07270000
072800         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        07280000
072900*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07290039
073000*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07300039
073010         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O07301039
073020-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07302039
073100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07310000
073200         PERFORM DP013-0000-PROCESS-ABEND                         07320000
073300     END-IF.                                                      07330000
073400                                                                  07340000
073500*----------------------------------------------------------------*07350000
073600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07360000
073700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07370000
073800*                                                                *07380000
073900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07390000
074000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07400000
074100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07410000
074200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07420000
074300*----------------------------------------------------------------*07430000
074400 1000-CONTROL-PROCESSING.                                         07440000
074500                                                                  07450000
074600     EVALUATE TRUE                                                07460000
074700         WHEN DP020-NEXT-ACT-INITIAL                              07470000
074800             INITIALIZE ASC-SPECIFIC-COMMAREA                     07480000
074900             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07490000
075000                                      ASC-SEL-TERM-ID             07500000
075100             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   07510000
075200                                           ASC-SEL-TASK-NUMBER    07520000
075300             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              07530000
075400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 07540000
075500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07550000
075600             PERFORM 4000-BUILD-INITIAL-PANEL                     07560000
075700                                                                  07570000
075800         WHEN DP020-NEXT-ACT-READ-MAP                             07580000
075900             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07590000
076000             PERFORM 2000-PROCESS-PANEL                           07600000
076100                                                                  07610000
076200         WHEN DP020-NEXT-ACT-RETURN                               07620000
076300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07630000
076400             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               07640000
076500             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 07650000
076600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07660000
076700                                                                  07670000
076800         WHEN OTHER                                               07680000
076900             SET DP013-LOGIC-ABEND TO TRUE                        07690000
077000             SET DP013-NO-ROLLBACK TO TRUE                        07700000
077100             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    07710000
077200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07720000
077300                                   TO DP013-MESSAGE-TEXT(1)       07730000
077400             PERFORM DP013-0000-PROCESS-ABEND                     07740000
077500     END-EVALUATE.                                                07750000
077600                                                                  07760000
077700*----------------------------------------------------------------*07770000
077800* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07780000
077900* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07790000
078000*----------------------------------------------------------------*07800000
078100 1100-PROCESS-INTER-APPL-COMM.                                    07810000
078200                                                                  07820000
078300     SET PS-COMMAREA-VALID         TO TRUE.                       07830000
078400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07840000
078500                                                                  07850000
078600     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          07860000
078700         MOVE SU008-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        07870000
078800                                         DK-OPER-UNT-ID           07880000
078900         MOVE SU008-DOOR-ID           TO ASC-DOOR-ID              07890000
079000         MOVE SU008-SCAC-CDE          TO ASC-SCAC-CODE-H          07900000
079100         MOVE SU008-TRLR-SRL-NBR      TO ASC-TRLR-SRL-NMBR-H      07910000
079200         MOVE SU008-DEST-STR-NBR      TO ASC-TRIP-DEST-OPER-N     07920000
079300         MOVE SU008-TRIP-ID           TO ASC-OTBND-TRIP-ID        07930000
079400                                         DK-TRIP-ID               07940000
079500     ELSE                                                         07950000
079600         SET ASC-USE-SELECTION-QUEUE TO TRUE                      07960000
079700         MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                   07970000
079800                                      ASC-NUMBER-OF-SELECTED-ITEMS07980000
079900         MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  07990000
080000         MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      08000000
080100         MOVE SU009-OPER-UNT-ID        TO ASC-OPER-UNT-ID-N       08010000
080200                                          DK-OPER-UNT-ID          08020000
080300         MOVE SU009-TRLR-SRL-NBR       TO ASC-TRLR-SRL-NMBR-H     08030000
080400                                          DK-TRLR-SRL-NBR         08040000
080500         MOVE SU009-SCAC-CDE           TO ASC-SCAC-CODE-H         08050000
080600         MOVE SU009-TRLR-ID            TO ASC-TRLR-ID-H           08060000
080700                                          DK-TRLR-ID              08070000
080800         PERFORM 1120-PREPARE-LIST-ENTRY                          08080000
080900     END-IF.                                                      08090000
081000                                                                  08100000
081100*-----------------------------------------------------------------08110000
081200 1120-PREPARE-LIST-ENTRY.                                         08120000
081300                                                                  08130000
081400     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                08140000
081500     MOVE ZERO                     TO ASC-SEL-ITEM.               08150000
081600     PERFORM 1130-GET-NEXT-RECORD.                                08160000
081700                                                                  08170000
081800*-----------------------------------------------------------------08180000
081900*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08190000
082000*-----------------------------------------------------------------08200000
082100 1130-GET-NEXT-RECORD.                                            08210000
082200                                                                  08220000
082300     ADD +1                       TO ASC-SEL-SUB.                 08230000
082400                                                                  08240000
082500     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            08250000
082600         ADD +1                   TO ASC-SEL-ITEM                 08260000
082700         MOVE +1                  TO ASC-SEL-SUB                  08270000
082800     END-IF.                                                      08280000
082900                                                                  08290000
083000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08300000
083100         PERFORM 9100-READ-SEL-QUEUE                              08310000
083200         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      08320000
083300             MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)  TO            08330000
083400                                              ASC-TRLR-SRL-NMBR-L 08340000
083500             MOVE SU010-TRIP-ID (ASC-SEL-SUB)                     08350000
083600                                           TO ASC-OTBND-TRIP-ID   08360000
083700             MOVE SU010-STAT-DATE (ASC-SEL-SUB)                   08370000
083800                                             TO ASC-STATUS-DATE   08380000
083900             MOVE SU010-DEST-NBR (ASC-SEL-SUB)                    08390000
084000                                           TO ASC-TRIP-DEST-OPER-N08400000
084100             MOVE SU010-DOOR-ID (ASC-SEL-SUB) TO ASC-DOOR-ID      08410000
084101*                                                                 08410119
084110* DMH 2/26/19 - POPULATED BOTH SCAC FIELDS WHEN COMING FROM LIST  08411019
084120*               ADDED ASC-SCAC-CODE-H                             08412019
084130*                                                                 08413019
084200             MOVE SU010-SCAC (ASC-SEL-SUB) TO ASC-SCAC-CODE-L     08420000
084210                                              ASC-SCAC-CODE-H     08421019
084300             MOVE SU010-TRLR-ID (ASC-SEL-SUB) TO ASC-TRLR-ID-L    08430000
084400             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  08440000
084500             PERFORM 9200-REWRITE-SEL-QUEUE                       08450000
084600         ELSE                                                     08460000
084700             SUBTRACT +1 FROM ASC-SEL-SUB                         08470000
084800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08480000
084900             SET DP020-MSG-INFORMATIONAL                          08490000
085000             PS-LIST-END             TO TRUE                      08500000
085100         END-IF                                                   08510000
085200     ELSE                                                         08520000
085300         SUBTRACT +1 FROM ASC-SEL-ITEM                            08530000
085400         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  08540000
085500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             08550000
085600         SET DP020-MSG-INFORMATIONAL                              08560000
085700             PS-LIST-END             TO TRUE                      08570000
085800     END-IF.                                                      08580000
085900                                                                  08590000
086000*-----------------------------------------------------------------08600000
086100*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *08610000
086200*    PROCESSED.                                                  *08620000
086300*-----------------------------------------------------------------08630000
086400 1140-GET-PREV-RECORD.                                            08640000
086500                                                                  08650000
086600     SUBTRACT +1 FROM ASC-SEL-SUB.                                08660000
086700                                                                  08670000
086800     IF  ASC-SEL-SUB < +1                                         08680000
086900         SUBTRACT +1 FROM ASC-SEL-ITEM                            08690000
087000         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  08700000
087100     END-IF.                                                      08710000
087200                                                                  08720000
087300     IF  ASC-SEL-ITEM > ZERO                                      08730000
087400         PERFORM 9100-READ-SEL-QUEUE                              08740000
087500         MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB) TO                 08750000
087600                                               ASC-TRLR-SRL-NMBR-L08760000
087700         MOVE SU010-TRIP-ID (ASC-SEL-SUB)  TO ASC-OTBND-TRIP-ID   08770000
087800         MOVE SU010-STAT-DATE (ASC-SEL-SUB) TO ASC-STATUS-DATE    08780000
087900         MOVE SU010-DEST-NBR (ASC-SEL-SUB) TO ASC-TRIP-DEST-OPER-N08790000
088000         MOVE SU010-DOOR-ID (ASC-SEL-SUB) TO ASC-DOOR-ID          08800000
088010*                                                                 08801019
088020* DMH 2/26/19 - POPULATED BOTH SCAC FIELDS WHEN COMING FROM LIST  08802019
088030*               ADDED ASC-SCAC-CODE-H                             08803019
088040*                                                                 08804019
088100         MOVE SU010-SCAC (ASC-SEL-SUB) TO ASC-SCAC-CODE-L         08810000
088110                                          ASC-SCAC-CODE-H         08811019
088200         MOVE SU010-TRLR-ID (ASC-SEL-SUB) TO ASC-TRLR-ID-L        08820000
088300         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      08830000
088400         PERFORM 9200-REWRITE-SEL-QUEUE                           08840000
088500     ELSE                                                         08850000
088600         MOVE +1                  TO ASC-SEL-ITEM                 08860000
088700                                     ASC-SEL-SUB                  08870000
088800         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             08880000
088900         SET DP020-MSG-INFORMATIONAL                              08890000
089000             PS-LIST-END             TO TRUE                      08900000
089100     END-IF.                                                      08910000
089200                                                                  08920000
089300*----------------------------------------------------------------*08930000
089400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08940000
089500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08950000
089600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08960000
089700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08970000
089800* FUNCTION KEYS CAN GET THIS FAR.                                *08980000
089900*----------------------------------------------------------------*08990000
090000 2000-PROCESS-PANEL.                                              09000000
090100     EVALUATE TRUE                                                09010000
090200         WHEN DP020-SRC-AID = DP016-CLEAR                         09020000
090300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09030000
090400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09040000
090500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09050000
090600                                                                  09060000
090700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09070000
090800             PERFORM 2050-DELETE-LIST-QUEUE                       09080000
090900             PERFORM 4000-BUILD-INITIAL-PANEL                     09090000
091000                                                                  09100000
091100         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09110000
091200             PERFORM 2140-DESELECT-ALL-ITEMS                      09120000
091300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09130000
091400                                                                  09140000
091500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09150000
091600             PERFORM 2150-SELECT-ALL-ITEMS                        09160000
091700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09170000
091800                                                                  09180000
091900         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09190000
092000             IF  ASC-USE-SELECTION-QUEUE                          09200000
092100                 PERFORM 1130-GET-NEXT-RECORD                     09210000
092200                 IF PS-LIST-END                                   09220000
092300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09230000
092400                     SET PS-NO-LIST-END TO TRUE                   09240000
092500                 ELSE                                             09250000
092600                     PERFORM 2050-DELETE-LIST-QUEUE               09260000
092700                     PERFORM 3200-RESET-ATTRIBUTES                09270000
092800                     PERFORM 4000-BUILD-INITIAL-PANEL             09280000
092900                 END-IF                                           09290000
093000              ELSE                                                09300000
093100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09310000
093200*                --- BOTTOM OF LIST ---                           09320000
093300                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         09330000
093400                 SET DP020-MSG-INFORMATIONAL TO TRUE              09340000
093500             END-IF                                               09350000
093600                                                                  09360000
093700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09370000
093800             IF  ASC-USE-SELECTION-QUEUE                          09380000
093900                 PERFORM 1140-GET-PREV-RECORD                     09390000
094000                 IF PS-LIST-END                                   09400000
094100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09410000
094200                     SET PS-NO-LIST-END TO TRUE                   09420000
094300                 ELSE                                             09430000
094400                     PERFORM 2050-DELETE-LIST-QUEUE               09440000
094500                     PERFORM 3200-RESET-ATTRIBUTES                09450000
094600                     PERFORM 4000-BUILD-INITIAL-PANEL             09460000
094700                 END-IF                                           09470000
094800             ELSE                                                 09480000
094900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09490000
095000                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         09500000
095100                 SET DP020-MSG-INFORMATIONAL TO TRUE              09510000
095200             END-IF                                               09520000
095300                                                                  09530000
095400         WHEN OTHER                                               09540000
095500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09550000
095600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09560000
095700                                                                  09570000
095800             IF  PS-NO-ERROR                                      09580000
095900                 SET DP030-CONTINUE-GO TO TRUE                    09590000
096000                 PERFORM 2100-CHECK-FUNCTION-KEY                  09600000
096100             ELSE                                                 09610000
096200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09620000
096300                 SET DP030-OVERRIDE-GO TO TRUE                    09630000
096400             END-IF                                               09640000
096500     END-EVALUATE.                                                09650000
096600                                                                  09660000
096700*----------------------------------------------------------------*09670000
096800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09680000
096900*----------------------------------------------------------------*09690000
097000 2050-DELETE-LIST-QUEUE.                                          09700000
097100                                                                  09710000
097200     EXEC CICS                                                    09720000
097300         DELETEQ TS                                               09730000
097400             QUEUE (ASC-LIST-QUEUE-NAME)                          09740000
097500             RESP  (PV-CICS-RESP)                                 09750000
097600     END-EXEC.                                                    09760000
097700                                                                  09770000
097800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       09780000
097900        (PV-CICS-RESP = DFHRESP(QIDERR))                          09790000
098000         CONTINUE                                                 09800000
098100     ELSE                                                         09810000
098200         SET DP013-CICS-ABEND      TO TRUE                        09820000
098300         SET DP013-NO-ROLLBACK     TO TRUE                        09830000
098400                                                                  09840000
098500         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         09850000
098600         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09860000
098700                                   TO DP013-MESSAGE-TEXT (1)      09870000
098800         PERFORM DP013-0000-PROCESS-ABEND                         09880000
098900     END-IF.                                                      09890000
099000                                                                  09900000
099100     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  09910000
099200                                                                  09920000
099300*----------------------------------------------------------------*09930000
099400* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09940000
099500* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09950000
099600* CICS ARCHITECTURE API.                                         *09960000
099700*----------------------------------------------------------------*09970000
099800 2100-CHECK-FUNCTION-KEY.                                         09980000
099900                                                                  09990000
100000     EVALUATE TRUE                                                10000000
100100*                                                                 10010000
100200* F6 - FIRST PAGE                                                 10020000
100300         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10030000
100400             MOVE +1               TO PV-TOP-ITEM                 10040000
100500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10050000
100600*                                                                 10060000
100700* F7 - PREVIOUS PAGE                                              10070000
100800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10080000
100900             PERFORM 2110-BROWSE-BACKWARD                         10090000
101000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10100000
101100*                                                                 10110000
101200* F8 - NEXT PAGE                                                  10120000
101300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10130000
101400             PERFORM 2120-BROWSE-FORWARD                          10140000
101500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10150000
101600*                                                                 10160000
101700* ENTER KEY                                                       10170000
101800         WHEN DP020-SRC-AID = DP016-ENTER                         10180000
101900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10190000
102000             IF  PS-ERROR                                         10200000
102100                 CONTINUE                                         10210000
102200             ELSE                                                 10220000
102300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10230000
102400             END-IF                                               10240000
102500                                                                  10250000
102600         WHEN OTHER                                               10260000
102700             SET DP013-NO-ROLLBACK                                10270000
102800                 DP013-XCTL-DISPLAY-RESTART                       10280000
102900                 DP013-CICS-ABEND  TO TRUE                        10290000
103000             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    10300000
103100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10310000
103200                                   TO DP013-MESSAGE-TEXT (1)      10320000
103300             PERFORM DP013-0000-PROCESS-ABEND                     10330000
103400     END-EVALUATE.                                                10340000
103500*                                                                 10350000
103600*----------------------------------------------------------------*10360000
103700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10370000
103800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10380000
103900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10390000
104000*    MESSAGE.                                                    *10400000
104100*----------------------------------------------------------------*10410000
104200 2110-BROWSE-BACKWARD.                                            10420000
104300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10430000
104400         GIVING PV-TOP-ITEM.                                      10440000
104500*                                                                 10450000
104600     IF  ((PV-TOP-ITEM < +1)                                      10460000
104700       OR (PV-TOP-ITEM = +1))                                     10470000
104800         MOVE +1                   TO PV-TOP-ITEM                 10480000
104900*        -- TOP OF LIST --                                        10490000
105000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10500000
105100         SET DP020-MSG-INFORMATIONAL TO TRUE                      10510000
105200     END-IF.                                                      10520000
105300                                                                  10530000
105400*----------------------------------------------------------------*10540000
105500*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10550000
105600*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *10560000
105700*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *10570000
105800*----------------------------------------------------------------*10580000
105900 2120-BROWSE-FORWARD.                                             10590000
106000                                                                  10600000
106100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              10610000
106200         GIVING PV-TOP-ITEM.                                      10620000
106300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   10630000
106400         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             10640000
106500*        -- BOTTOM OF LIST --                                     10650000
106600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10660000
106700         SET DP020-MSG-INFORMATIONAL  TO TRUE                     10670000
106800     ELSE                                                         10680000
106900         COMPUTE PV-BOTTOM-ITEM =                                 10690000
107000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 10700000
107100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            10710000
107200*            -- BOTTOM OF LIST --                                 10720000
107300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            10730000
107400             SET DP020-MSG-INFORMATIONAL TO TRUE                  10740000
107500         END-IF                                                   10750000
107600     END-IF.                                                      10760000
107700                                                                  10770000
107800*----------------------------------------------------------------*10780000
107900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *10790000
108000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *10800000
108100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *10810000
108200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *10820000
108300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *10830000
108400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *10840000
108500*----------------------------------------------------------------*10850000
108600 2130-CHECK-FOR-JUMP-BROWSE.                                      10860000
108700     SET PS-NO-ERROR               TO TRUE.                       10870000
108800     IF (ASC-START-ITEM-REQUEST = SPACE)                          10880000
108900         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             10890000
109000     ELSE                                                         10900000
109100         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     10910000
109200         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       10920000
109300         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     10930000
109400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10940000
109500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10950032
109510              USING DP010I-NUMERIC-EDIT-AREA                      10951032
109600                                                                  10960000
109700         IF  NOT DP010I-ERROR-DETECTED                            10970000
109800             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N10980000
109900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  10990000
110000                 IF  ASC-START-ITEM-REQUEST-N >                   11000000
110100                                          ASC-NUMBER-OF-ITEMS-READ11010000
110200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11020000
110300                     COMPUTE PV-TOP-ITEM =                        11030000
110400                             ASC-NUMBER-OF-ITEMS-READ             11040000
110500                             - PC-ITEMS-PER-PANEL + 1             11050000
110600                     IF  PV-TOP-ITEM < +1                         11060000
110700                         MOVE +1   TO PV-TOP-ITEM                 11070000
110800                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 11080000
110900                         SET DP020-MSG-INFORMATIONAL TO TRUE      11090000
111000                     END-IF                                       11100000
111100                 ELSE                                             11110000
111200                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 11120000
111300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11130000
111400                     COMPUTE PV-BOTTOM-ITEM =                     11140000
111500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11150000
111600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11160000
111700*                        -- BOTTOM OF LIST --                     11170000
111800                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 11180000
111900                         SET DP020-MSG-INFORMATIONAL TO TRUE      11190000
112000                     END-IF                                       11200000
112100                 END-IF                                           11210000
112200             ELSE                                                 11220000
112300*                --- VALUE OUT OF RANGE ----                      11230000
112400                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        11240000
112500                 MOVE -1           TO ASTRTITL                    11250000
112600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11260000
112700                 MOVE DP015-REVERSE TO ASTRTITH                   11270000
112800                 MOVE DP015-RED    TO ASTRTITC                    11280000
112900                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           11290000
113000                 SET DP020-MSG-FATAL                              11300000
113100                     PS-ERROR        TO TRUE                      11310000
113200             END-IF                                               11320000
113300         ELSE                                                     11330000
113400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11340000
113500             MOVE -1               TO ASTRTITL                    11350000
113600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11360000
113700             MOVE DP015-REVERSE    TO ASTRTITH                    11370000
113800             MOVE DP015-RED        TO ASTRTITC                    11380000
113900             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               11390000
114000             SET DP020-MSG-FATAL   TO TRUE                        11400000
114100             SET PS-ERROR          TO TRUE                        11410000
114200         END-IF                                                   11420000
114300     END-IF.                                                      11430000
114400                                                                  11440000
114500*----------------------------------------------------------------*11450000
114600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *11460000
114700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *11470000
114800*----------------------------------------------------------------*11480000
114900 2140-DESELECT-ALL-ITEMS.                                         11490000
115000     MOVE +1                       TO ASC-BLK-SUB.                11500000
115100                                                                  11510000
115200     PERFORM 2141-CLEAR-SELECTED-INDS                             11520000
115300         VARYING ASC-ITEM-SUB                                     11530000
115400         FROM 1 BY 1                                              11540000
115500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11550000
115600                                                                  11560000
115700     ADD +1                        TO ASC-BLK-SUB.                11570000
115800                                                                  11580000
115900     PERFORM 2141-CLEAR-SELECTED-INDS                             11590000
116000         VARYING ASC-ITEM-SUB                                     11600000
116100         FROM 1 BY 1                                              11610000
116200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11620000
116300                                                                  11630000
116400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               11640000
116500                                   TO PV-LIST-ITEM-NUMBER.        11650000
116600                                                                  11660000
116700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11670000
116800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    11680000
116900                                                                  11690000
117000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11700000
117100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      11710000
117200         MOVE +1                   TO ASC-BLK-SUB                 11720000
117300                                                                  11730000
117400         PERFORM 5100-WRITE-TEMP-STORAGE                          11740000
117500         MOVE +2                   TO ASC-BLK-SUB                 11750000
117600         PERFORM 5100-WRITE-TEMP-STORAGE                          11760000
117700         MOVE +1                   TO ASC-BLK-SUB                 11770000
117800                                                                  11780000
117900         MOVE +1                   TO PV-BLOCK-NUMBER             11790000
118000                                                                  11800000
118100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11810000
118200             PV-FIRST-BLOCK-IN-ARRAY - 1                          11820000
118300                                                                  11830000
118400         PERFORM                                                  11840000
118500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       11850000
118600                                                                  11860000
118700             PERFORM 4410-READ-TEMP-STORAGE                       11870000
118800                                                                  11880000
118900             PERFORM 2141-CLEAR-SELECTED-INDS                     11890000
119000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 11900000
119100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11910000
119200                                                                  11920000
119300             PERFORM 5100-WRITE-TEMP-STORAGE                      11930000
119400                                                                  11940000
119500             ADD +1                TO PV-BLOCK-NUMBER             11950000
119600                                                                  11960000
119700         END-PERFORM                                              11970000
119800                                                                  11980000
119900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11990000
120000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12000000
120100                                                                  12010000
120200         PERFORM                                                  12020000
120300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12030000
120400                   ASC-HIGHEST-BLOCK-WRITTEN                      12040000
120500                                                                  12050000
120600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12060000
120700                                   TO PV-BLOCK-NUMBER             12070000
120800                                                                  12080000
120900             PERFORM 4410-READ-TEMP-STORAGE                       12090000
121000                                                                  12100000
121100             PERFORM 2141-CLEAR-SELECTED-INDS                     12110000
121200                 VARYING ASC-ITEM-SUB                             12120000
121300                 FROM 1 BY 1                                      12130000
121400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12140000
121500                                                                  12150000
121600             PERFORM 5100-WRITE-TEMP-STORAGE                      12160000
121700                                                                  12170000
121800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12180000
121900         END-PERFORM                                              12190000
122000                                                                  12200000
122100         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          12210000
122200         PERFORM 4410-READ-TEMP-STORAGE                           12220000
122300     END-IF.                                                      12230000
122400                                                                  12240000
122500                                                                  12250000
122600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 12260000
122700     MOVE +0                     TO ASC-START-OF-SELECTED-RANGE.  12270000
122800     MOVE +0                     TO ASC-END-OF-SELECTED-RANGE.    12280000
122900                                                                  12290000
123000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12300000
123100                                                                  12310000
123200*----------------------------------------------------------------*12320000
123300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *12330000
123400*----------------------------------------------------------------*12340000
123500 2141-CLEAR-SELECTED-INDS.                                        12350000
123600                                                                  12360000
123700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           12370000
123800             NOT EQUAL ZERO                                       12380000
123900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12390000
124000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12400000
124100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    12410000
124200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  12420000
124300                                   TO TRUE                        12430000
124400         END-IF                                                   12440000
124500     END-IF.                                                      12450000
124600                                                                  12460000
124700*----------------------------------------------------------------*12470000
124800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *12480000
124900*  FOR ALL ITEMS.                                                *12490000
125000*----------------------------------------------------------------*12500000
125100 2150-SELECT-ALL-ITEMS.                                           12510000
125200                                                                  12520000
125300     MOVE +1                       TO ASC-BLK-SUB.                12530000
125400                                                                  12540000
125500     PERFORM 2151-SET-SELECTED-INDS                               12550000
125600         VARYING ASC-ITEM-SUB                                     12560000
125700         FROM 1 BY 1                                              12570000
125800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12580000
125900                                                                  12590000
126000     ADD +1                        TO ASC-BLK-SUB.                12600000
126100                                                                  12610000
126200     PERFORM 2151-SET-SELECTED-INDS                               12620000
126300         VARYING ASC-ITEM-SUB                                     12630000
126400         FROM 1 BY 1                                              12640000
126500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12650000
126600                                                                  12660000
126700     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       12670000
126800                                                                  12680000
126900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12690000
127000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12700000
127100                                                                  12710000
127200     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            12720000
127300         MOVE +1                   TO ASC-BLK-SUB                 12730000
127400                                                                  12740000
127500         PERFORM 5100-WRITE-TEMP-STORAGE                          12750000
127600         MOVE +2                   TO ASC-BLK-SUB                 12760000
127700         PERFORM 5100-WRITE-TEMP-STORAGE                          12770000
127800         MOVE +1                   TO ASC-BLK-SUB                 12780000
127900         MOVE +1                   TO PV-BLOCK-NUMBER             12790000
128000     END-IF.                                                      12800000
128100*                                                                 12810000
128200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12820000
128300        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    12830000
128400         MOVE +1                   TO ASC-BLK-SUB                 12840000
128500                                                                  12850000
128600         PERFORM 5100-WRITE-TEMP-STORAGE                          12860000
128700         MOVE +2                   TO ASC-BLK-SUB                 12870000
128800         PERFORM 5100-WRITE-TEMP-STORAGE                          12880000
128900         MOVE +1                   TO ASC-BLK-SUB                 12890000
129000         MOVE +1                   TO PV-BLOCK-NUMBER             12900000
129100                                                                  12910000
129200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12920000
129300             PV-FIRST-BLOCK-IN-ARRAY - 1                          12930000
129400                                                                  12940000
129500         PERFORM                                                  12950000
129600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12960000
129700                                                                  12970000
129800             PERFORM 4410-READ-TEMP-STORAGE                       12980000
129900                                                                  12990000
130000             PERFORM 2151-SET-SELECTED-INDS                       13000000
130100                 VARYING ASC-ITEM-SUB                             13010000
130200                 FROM 1 BY 1                                      13020000
130300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13030000
130400                                                                  13040000
130500             PERFORM 5100-WRITE-TEMP-STORAGE                      13050000
130600                                                                  13060000
130700             ADD +1                TO PV-BLOCK-NUMBER             13070000
130800                                                                  13080000
130900         END-PERFORM                                              13090000
131000                                                                  13100000
131100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13110000
131200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13120000
131300                                                                  13130000
131400         PERFORM                                                  13140000
131500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13150000
131600                   ASC-HIGHEST-BLOCK-WRITTEN                      13160000
131700                                                                  13170000
131800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13180000
131900                                   TO PV-BLOCK-NUMBER             13190000
132000                                                                  13200000
132100             PERFORM 4410-READ-TEMP-STORAGE                       13210000
132200                                                                  13220000
132300             PERFORM 2151-SET-SELECTED-INDS                       13230000
132400                 VARYING ASC-ITEM-SUB                             13240000
132500                 FROM 1 BY 1                                      13250000
132600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13260000
132700                                                                  13270000
132800             PERFORM 5100-WRITE-TEMP-STORAGE                      13280000
132900                                                                  13290000
133000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13300000
133100                                                                  13310000
133200         END-PERFORM                                              13320000
133300                                                                  13330000
133400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13340000
133500                                   TO PV-BLOCK-NUMBER             13350000
133600                                                                  13360000
133700         PERFORM 4410-READ-TEMP-STORAGE                           13370000
133800     END-IF.                                                      13380000
133900                                                                  13390000
134000                                                                  13400000
134100     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             13410000
134200                       ASC-NUMBER-OF-SELECTED-ITEMS.              13420000
134300                                                                  13430000
134400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13440000
134500                                                                  13450000
134600*----------------------------------------------------------------*13460000
134700*    MARK EACH ITEM AS BEING SELECTED.                           *13470000
134800*----------------------------------------------------------------*13480000
134900 2151-SET-SELECTED-INDS.                                          13490000
135000                                                                  13500000
135100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13510000
135200             NOT EQUAL ZERO                                       13520000
135300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13530000
135400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13540000
135500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        13550000
135600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13560000
135700                               TO  TRUE                           13570000
135800         END-IF                                                   13580000
135900     END-IF.                                                      13590000
136000                                                                  13600000
136100******************************************************************13610000
136200** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **13620000
136300** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **13630000
136400******************************************************************13640000
136500 2200-MOVE-SCREEN-TO-COMMAREA.                                    13650000
136600                                                                  13660000
136700     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             13670000
136800     MOVE +1                       TO PV-SUB.                     13680000
136900*                                                                 13690000
137000     PERFORM 3100-SET-SUBSCRIPTS.                                 13700000
137100     IF  ASTRTITL > ZERO                                          13710000
137200         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          13720000
137300     ELSE                                                         13730000
137400         IF  ASTRTITF = DP015-ERASE-EOF                           13740000
137500             INITIALIZE ASC-START-ITEM-REQUEST                    13750000
137600         END-IF                                                   13760000
137700     END-IF.                                                      13770000
137800                                                                  13780000
137900******************************************************************13790000
138000** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **13800000
138100** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **13810000
138200******************************************************************13820000
138300 3000-EDIT-DATA-IN-COMMAREA.                                      13830000
138400     SET PS-NO-ERROR               TO TRUE.                       13840000
138500     PERFORM 3200-RESET-ATTRIBUTES.                               13850000
138600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     13860000
138700                                                                  13870000
138800**                                                                13880000
138900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              13890000
139000* EDITTING IS DONE FROM THE BOTTOM UP.                            13900000
139100**                                                                13910000
139200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       13920000
139300         ASC-ITEMS-DISPLAYED - 1.                                 13930000
139400     PERFORM 3100-SET-SUBSCRIPTS.                                 13940000
139500*                                                                 13950000
139600     IF  PS-NO-ERROR                                              13960000
139700         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        13970000
139800     END-IF.                                                      13980000
139900                                                                  13990000
140000*                                                                 14000000
140100     IF  ((PS-NO-ERROR)                                           14010000
140200       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   14020000
140300       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    14030000
140400             PERFORM 3500-MARK-RANGE-AS-SELECTED                  14040000
140500     END-IF.                                                      14050000
140600                                                                  14060000
140700*----------------------------------------------------------------*14070000
140800*   3005-EDIT-COMMAREA-BLOCKS                                    *14080000
140900*----------------------------------------------------------------*14090000
141000 3005-EDIT-COMMAREA-BLOCKS.                                       14100000
141100     MOVE +1                       TO PV-BLOCK-NUMBER.            14110000
141200     MOVE +1                       TO ASC-BLK-SUB.                14120000
141300     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               14130000
141400                                                                  14140000
141500     COMPUTE PV-BLOCK-NUMBER  =                                   14150000
141600        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 14160000
141700            PC-ITEMS-PER-PANEL.                                   14170000
141800                                                                  14180000
141900     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          14190000
142000                                                                  14200000
142100     PERFORM                                                      14210000
142200       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          14220000
142300          OR PS-ERROR                                             14230000
142400          OR PS-BLOCK-ERROR                                       14240000
142500                                                                  14250000
142600             COMPUTE PV-ITEMS-HOLD  =                             14260000
142700                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        14270000
142800                     PC-ITEMS-PER-PANEL - 1                       14280000
142900                                                                  14290000
143000             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       14300000
143100                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               14310000
143200                     FROM  PV-ITEMS-HOLD                          14320000
143300                   GIVING  PV-ITEMS-DIFF                          14330000
143400                 SUBTRACT  PV-ITEMS-DIFF                          14340000
143500                     FROM  PC-ITEMS-PER-PANEL                     14350000
143600                   GIVING  PV-ITEMS-HOLD                          14360000
143700                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              14370000
143800                                              ASC-ITEM-SUB        14380000
143900                                              ASC-ITEMS-DISPLAYED 14390000
144000             ELSE                                                 14400000
144100                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              14410000
144200                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        14420000
144300             END-IF                                               14430000
144400                                                                  14440000
144500             MOVE +1               TO ASC-BLK-SUB                 14450000
144600                                                                  14460000
144700             PERFORM 5105-REWRITE-ASC-LISTQ                       14470000
144800                                                                  14480000
144900             MOVE +1                TO ASC-BLK-SUB                14490000
145000                                                                  14500000
145100             IF  PS-BLOCK-ERROR                                   14510000
145200                 SET  PS-ERROR     TO TRUE                        14520000
145300                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        14530000
145400                                   TO PV-TOP-ITEM                 14540000
145500             ELSE                                                 14550000
145600                 ADD  +1           TO PV-BLOCK-NUMBER             14560000
145700                 IF  PV-BLOCK-NUMBER >                            14570000
145800                     ASC-HIGHEST-BLOCK-WRITTEN                    14580000
145900                     MOVE +2       TO ASC-BLK-SUB                 14590000
146000                     PERFORM 4410-READ-TEMP-STORAGE               14600000
146100                     MOVE +1       TO ASC-BLK-SUB                 14610000
146200                 ELSE                                             14620000
146300                     PERFORM 4410-READ-TEMP-STORAGE               14630000
146400                     ADD  +1        TO PV-BLOCK-NUMBER            14640000
146500                     MOVE +2        TO ASC-BLK-SUB                14650000
146600                     PERFORM 4410-READ-TEMP-STORAGE               14660000
146700                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            14670000
146800                     MOVE +1        TO ASC-BLK-SUB                14680000
146900                 END-IF                                           14690000
147000             END-IF                                               14700000
147100     END-PERFORM.                                                 14710000
147200                                                                  14720000
147300     IF  PV-ORIGINAL-BLOCK  = +1    OR                            14730000
147400         PS-ERROR                   OR                            14740000
147500         PS-BLOCK-ERROR                                           14750000
147600         CONTINUE                                                 14760000
147700     ELSE                                                         14770000
147800         MOVE +1                 TO PV-BLOCK-NUMBER               14780000
147900         MOVE +1                 TO ASC-BLK-SUB                   14790000
148000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  14800000
148100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           14810000
148200         PERFORM 4410-READ-TEMP-STORAGE                           14820000
148300                                                                  14830000
148400         PERFORM                                                  14840000
148500           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              14850000
148600              OR PS-ERROR                                         14860000
148700              OR PS-BLOCK-ERROR                                   14870000
148800                                                                  14880000
148900                 COMPUTE PV-ITEMS-HOLD  =                         14890000
149000                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    14900000
149100                         PC-ITEMS-PER-PANEL - 1                   14910000
149200                                                                  14920000
149300                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     14930000
149400                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           14940000
149500                         FROM  PV-ITEMS-HOLD                      14950000
149600                       GIVING  PV-ITEMS-DIFF                      14960000
149700                     SUBTRACT  PV-ITEMS-DIFF                      14970000
149800                         FROM  PC-ITEMS-PER-PANEL                 14980000
149900                       GIVING  PV-ITEMS-HOLD                      14990000
150000                         MOVE  PV-ITEMS-HOLD TO PV-SUB            15000000
150100                                                ASC-ITEM-SUB      15010000
150200                                               ASC-ITEMS-DISPLAYED15020000
150300                 ELSE                                             15030000
150400                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          15040000
150500                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    15050000
150600                 END-IF                                           15060000
150700                                                                  15070000
150800                 MOVE +1               TO ASC-BLK-SUB             15080000
150900                                                                  15090000
151000                 PERFORM 5105-REWRITE-ASC-LISTQ                   15100000
151100                                                                  15110000
151200                 MOVE +1                TO ASC-BLK-SUB            15120000
151300                                                                  15130000
151400                 IF  PS-BLOCK-ERROR                               15140000
151500                     SET  PS-ERROR     TO TRUE                    15150000
151600                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    15160000
151700                                       TO PV-TOP-ITEM             15170000
151800                 ELSE                                             15180000
151900                     ADD  +1            TO PV-BLOCK-NUMBER        15190000
152000                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      15200000
152100                         MOVE +2        TO ASC-BLK-SUB            15210000
152200                         PERFORM 4410-READ-TEMP-STORAGE           15220000
152300                         MOVE +1        TO ASC-BLK-SUB            15230000
152400                     ELSE                                         15240000
152500                         PERFORM 4410-READ-TEMP-STORAGE           15250000
152600                         ADD  +1        TO PV-BLOCK-NUMBER        15260000
152700                         MOVE +2        TO ASC-BLK-SUB            15270000
152800                         PERFORM 4410-READ-TEMP-STORAGE           15280000
152900                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        15290000
153000                         MOVE +1        TO ASC-BLK-SUB            15300000
153100                     END-IF                                       15310000
153200                 END-IF                                           15320000
153300     END-PERFORM.                                                 15330000
153400     MOVE +0 TO PV-ITEMS-HOLD.                                    15340000
153500                                                                  15350000
153600*----------------------------------------------------------------*15360000
153700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *15370000
153800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*15380000
153900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *15390000
154000*                                                                *15400000
154100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *15410000
154200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *15420000
154300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15430000
154400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15440000
154500*----------------------------------------------------------------*15450000
154600 3100-SET-SUBSCRIPTS.                                             15460000
154700                                                                  15470000
154800     COMPUTE ASC-ITEM-SUB =                                       15480000
154900         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15490000
155000                                                                  15500000
155100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15510000
155200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15520000
155300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               15530000
155400     ELSE                                                         15540000
155500         MOVE +1                     TO ASC-BLK-SUB               15550000
155600     END-IF.                                                      15560000
155700******************************************************************15570000
155800** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **15580000
155900******************************************************************15590000
156000 3200-RESET-ATTRIBUTES.                                           15600000
156100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   15610000
156200     MOVE DP015-GREEN              TO ASTRTITC.                   15620000
156300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   15630000
156400     MOVE -1                       TO ASTRTITL.                   15640000
156500     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       15650000
156600                                                                  15660000
156700******************************************************************15670000
156800** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **15680000
156900** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **15690000
157000** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**15700000
157100** THE ENDING.                                                  **15710000
157200******************************************************************15720000
157300 3310-EDIT-RANGE.                                                 15730000
157400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                15740000
157500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   15750000
157600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)15760000
157700                                   TO ASC-SELECTED-SW             15770000
157800                                        (ASC-BLK-SUB ASC-ITEM-SUB)15780000
157900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 15790000
158000         ELSE                                                     15800000
158100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     15810000
158200                 CONTINUE                                         15820000
158300             ELSE                                                 15830000
158400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        15840000
158500                 MOVE PC-TSYMSG-00054                             15850000
158600                                       TO DP020-MSG-NUMBER        15860000
158700                 MOVE -1               TO ASTRTITL                15870000
158800                 SET DP020-MSG-FATAL                              15880000
158900                     DP030-SET-CURSOR-APPL-1                      15890000
159000                     PS-ERROR          TO TRUE                    15900000
159100             END-IF                                               15910000
159200         END-IF                                                   15920000
159300     ELSE                                                         15930000
159400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     15940000
159500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 15950000
159600                                   TO ASC-SELECTED-SW             15960000
159700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15970000
159800             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   15980000
159900         ELSE                                                     15990000
160000             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       16000000
160100                 CONTINUE                                         16010000
160200             ELSE                                                 16020000
160300*                -- ONLY ONE END-OF-RANGE ALLOWED --              16030000
160400                 MOVE PC-TSYMSG-00055                             16040000
160500                                        TO DP020-MSG-NUMBER       16050000
160600                 MOVE -1                TO ASTRTITL               16060000
160700                 SET DP020-MSG-FATAL                              16070000
160800                     DP030-SET-CURSOR-APPL-1                      16080000
160900                     PS-ERROR           TO TRUE                   16090000
161000             END-IF                                               16100000
161100         END-IF                                                   16110000
161200     END-IF.                                                      16120000
161300*                                                                 16130000
161400*----------------------------------------------------------------*16140000
161500*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *16150000
161600*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *16160000
161700*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *16170000
161800*----------------------------------------------------------------*16180000
161900 3500-MARK-RANGE-AS-SELECTED.                                     16190000
162000     MOVE +1                       TO  ASC-BLK-SUB.               16200000
162100     PERFORM 3510-MARK-SELECTED-INDS                              16210000
162200         VARYING ASC-ITEM-SUB                                     16220000
162300         FROM 1 BY 1                                              16230000
162400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16240000
162500                                                                  16250000
162600     ADD +1                        TO ASC-BLK-SUB.                16260000
162700     PERFORM 3510-MARK-SELECTED-INDS                              16270000
162800         VARYING ASC-ITEM-SUB                                     16280000
162900         FROM 1 BY 1                                              16290000
163000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16300000
163100                                                                  16310000
163200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16320000
163300                                   TO  PV-LIST-ITEM-NUMBER.       16330000
163400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16340000
163500         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         16350000
163600               PC-ITEMS-PER-PANEL).                               16360000
163700                                                                  16370000
163800     MOVE ASC-START-OF-SELECTED-RANGE                             16380000
163900                                   TO PV-START-OF-SELECTED-RANGE. 16390000
164000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            16400000
164100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  16410000
164200               PC-ITEMS-PER-PANEL).                               16420000
164300                                                                  16430000
164400     MOVE ASC-END-OF-SELECTED-RANGE                               16440000
164500                                   TO  PV-END-OF-SELECTED-RANGE.  16450000
164600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             16460000
164700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    16470000
164800               PC-ITEMS-PER-PANEL).                               16480000
164900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             16490000
165000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             16500000
165100                                                                  16510000
165200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    16520000
165300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        16530000
165400         MOVE +1                   TO ASC-BLK-SUB                 16540000
165500         PERFORM 5100-WRITE-TEMP-STORAGE                          16550000
165600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16560000
165700             PV-FIRST-BLOCK-IN-ARRAY - 1                          16570000
165800                                                                  16580000
165900         PERFORM                                                  16590000
166000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      16600000
166100                   PV-PREV-BLOCK-IN-ARRAY                         16610000
166200             MOVE PV-FIRST-BLOCK-IN-RANGE                         16620000
166300                                   TO PV-BLOCK-NUMBER             16630000
166400             PERFORM 4410-READ-TEMP-STORAGE                       16640000
166500             PERFORM 3510-MARK-SELECTED-INDS                      16650000
166600                 VARYING ASC-ITEM-SUB                             16660000
166700                 FROM 1 BY 1                                      16670000
166800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16680000
166900             PERFORM 5100-WRITE-TEMP-STORAGE                      16690000
167000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     16700000
167100         END-PERFORM                                              16710000
167200                                                                  16720000
167300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16730000
167400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16740000
167500         PERFORM                                                  16750000
167600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16760000
167700                   PV-LAST-BLOCK-IN-RANGE                         16770000
167800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16780000
167900                                   TO PV-BLOCK-NUMBER             16790000
168000             PERFORM 4410-READ-TEMP-STORAGE                       16800000
168100             PERFORM 3510-MARK-SELECTED-INDS                      16810000
168200                 VARYING ASC-ITEM-SUB                             16820000
168300                 FROM 1 BY 1                                      16830000
168400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16840000
168500             PERFORM 5100-WRITE-TEMP-STORAGE                      16850000
168600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16860000
168700         END-PERFORM                                              16870000
168800                                                                  16880000
168900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16890000
169000                                   TO PV-BLOCK-NUMBER             16900000
169100         PERFORM 4410-READ-TEMP-STORAGE                           16910000
169200     END-IF.                                                      16920000
169300                                                                  16930000
169400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 16940000
169500                                      ASC-END-OF-SELECTED-RANGE.  16950000
169600                                                                  16960000
169700*----------------------------------------------------------------*16970000
169800* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *16980000
169900*----------------------------------------------------------------*16990000
170000 3510-MARK-SELECTED-INDS.                                         17000000
170100                                                                  17010000
170200     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17020000
170300                                ASC-ITEM-SUB) >                   17030000
170400         ASC-START-OF-SELECTED-RANGE)                             17040000
170500     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17050000
170600                                ASC-ITEM-SUB) =                   17060000
170700         ASC-START-OF-SELECTED-RANGE)                             17070000
170800                                                                  17080000
170900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17090000
171000                                    ASC-ITEM-SUB) <               17100000
171100             ASC-END-OF-SELECTED-RANGE)                           17110000
171200         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17120000
171300                                    ASC-ITEM-SUB) =               17130000
171400             ASC-END-OF-SELECTED-RANGE)                           17140000
171500                                                                  17150000
171600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17160000
171700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   17170000
171800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   17180000
171900                               TO TRUE                            17190000
172000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              17200000
172100                               TO TRUE                            17210000
172200                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    17220000
172300             END-IF                                               17230000
172400         END-IF                                                   17240000
172500     END-IF.                                                      17250000
172600                                                                  17260000
172700*----------------------------------------------------------------*17270000
172800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *17280000
172900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *17290000
173000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *17300000
173100*    DISPLAY THE PANEL TO USER.                                  *17310000
173200*----------------------------------------------------------------*17320000
173300 4000-BUILD-INITIAL-PANEL.                                        17330000
173400                                                                  17340000
173500     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            17350000
173600                                 ASC-BLOCK-ENTRIES (2).           17360000
173700     MOVE +1                 TO ASC-BLK-SUB.                      17370000
173800     SET ASC-ITEMS-LEFT-ON-DB                                     17380000
173900                             TO TRUE.                             17390000
174000                                                                  17400000
174100     MOVE +0                 TO ASC-ITEM-SUB                      17410000
174200                                ASC-NUMBER-OF-ITEMS-READ          17420000
174300                                ASC-NUMBER-OF-SELECTED-ITEMS      17430000
174400                                ASC-HIGHEST-BLOCK-WRITTEN         17440000
174500                                ASC-START-OF-SELECTED-RANGE       17450000
174600                                ASC-END-OF-SELECTED-RANGE         17460000
174700                                ASC-ITEM-AT-TOP-OF-PANEL          17470000
174800                                ASC-TOTAL                         17480000
174900                                ASC-MANUAL                        17490000
175000                                ASC-DIVERT.                       17500000
175100                                                                  17510000
175200     PERFORM 4010-SELECT-INFORMATION.                             17520000
175300     PERFORM 4076-COUNT-MANUAL-CRTNS.                             17530000
175400     PERFORM 4100-OPEN-CURSOR.                                    17540000
175500     PERFORM 4300-READ-ITEMS-FROM-DB.                             17550000
175600     PERFORM 4200-CLOSE-CURSOR.                                   17560000
175700                                                                  17570000
175800* DMH - 05/05/03 - BEGIN                                          17580000
175900*       IF A TRAILER IS UNLOADED AT STORE STATUS NO CARTONS ARE   17590000
176000*       ACTIVILY ATTACHED.                                        17600000
176100     IF  ASC-TRIP-STAT-CDE  =  'SU'                               17610000
176200         MOVE  ZEROES  TO  ASC-MANUAL                             17620000
176300                           ASC-DIVERT                             17630000
176400                           ASC-TOTAL                              17640000
176500     END-IF.                                                      17650000
176600* DMH - 05/05/03 - BEGIN                                          17660000
176700                                                                  17670000
176800     MOVE +1                   TO  PV-TOP-ITEM.                   17680000
176900*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        17690000
177000*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   17700000
177100*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      17710000
177200*    THE ORIGINAL SCREEN.                                         17720000
177300     EVALUATE TRUE                                                17730000
177400         WHEN SU010-SELECTED-ITEMS > 1                            17740000
177500             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  17750000
177600                 SET DP020-MSG-WARNING TO  TRUE                   17760000
177700                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       17770000
177800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17780000
177900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17790000
178000             ELSE                                                 17800000
178100                 MOVE -1               TO ASTRTITL                17810000
178200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17820000
178300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17830000
178400             END-IF                                               17840000
178500         WHEN OTHER                                               17850000
178600             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  17860000
178700                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            17870000
178800                 SET DP020-MSG-FATAL   TO  TRUE                   17880000
178900                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       17890000
179000             ELSE                                                 17900000
179100                 MOVE -1               TO ASTRTITL                17910000
179200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17920000
179300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17930000
179400             END-IF                                               17940000
179500     END-EVALUATE.                                                17950000
179600                                                                  17960000
179700*----------------------------------------------------------------*17970000
179800*    FILL TOP OF SCREEN WITH DATA                                 17980000
179900*----------------------------------------------------------------*17990000
180000 4010-SELECT-INFORMATION.                                         18000000
180100                                                                  18010000
180200     MOVE ASC-OPER-UNT-ID       TO  DK-OPER-UNT-ID                18020000
180300                                    PC049-DK-OPER-UNT-ID.         18030000
180400     IF ASC-TRLR-SRL-NMBR-H > ZEROES                              18040000
180500         MOVE ASC-TRLR-SRL-NMBR-H TO  DK-TRLR-SRL-NBR             18050000
180600     ELSE                                                         18060000
180700         MOVE ASC-TRLR-SRL-NMBR-L TO  DK-TRLR-SRL-NBR             18070000
180800     END-IF.                                                      18080000
180900     MOVE ASC-OTBND-TRIP-ID     TO  DK-TRIP-ID                    18090000
181000                                    PC049-DK-OTBND-TRIP-ID.       18100000
181100     MOVE ASC-TRIP-DEST-OPER-N  TO  DK-STORE-NUMBER.              18110000
181200                                                                  18120000
181300     IF ASC-DOOR-ID = SPACES                                      18130000
181400         PERFORM 4020-RETRIEVE-DOOR-ID                            18140000
181500     END-IF.                                                      18150000
181600     PERFORM 4025-GET-TRAILER-STATUS.                             18160000
181700     PERFORM 4075-GET-TRLR-ID.                                    18170000
181800                                                                  18180000
181900*----------------------------------------------------------------*18190000
182000*    RETRIEVE DOOR ID AND LOCATION DESCRIPTION                    18200000
182100*----------------------------------------------------------------*18210000
182200 4020-RETRIEVE-DOOR-ID.                                           18220000
182300                                                                  18230000
182400     EXEC SQL                                                     18240000
182500         SELECT  A.DOOR_ID                                        18250000
182600                ,B.DOOR_TYP_CDE                                   18260000
182700                ,C.DOOR_LOC_DESC                                  18270000
182800          INTO  :SUOBTS-DOOR-ID                                   18280000
182900               ,:SUOBTR-DOOR-TYP-CDE                              18290000
183000               ,:CNDCDR-DOOR-LOC-DESC                             18300000
183100           FROM  TSUOBTS A                                        18310000
183200                ,TSUOBTR B                                        18320000
183300                ,TCNDCDR C                                        18330000
183400          WHERE  A.OTBND_TRIP_ID    = :DK-TRIP-ID                 18340000
183500            AND  A.OTBND_TRIP_ID    = B.OTBND_TRIP_ID             18350000
183600            AND  A.DOOR_ID          = C.DOOR_ID                   18360000
183700            AND  A.STAT_OPER_UNT_ID = C.OPER_UNT_ID               18370000
183800            AND  OTBND_STAT_TMST IN                               18380000
183900                (SELECT  MAX(D.OTBND_STAT_TMST)                   18390000
184000                   FROM  TSUOBTS D                                18400000
184100                  WHERE  A.OTBND_TRIP_ID = D.OTBND_TRIP_ID)       18410000
184200     END-EXEC                                                     18420000
184300                                                                  18430000
184400     EVALUATE TRUE                                                18440000
184500         WHEN SQLCODE = ZERO                                      18450000
184600         WHEN SQLCODE = -811                                      18460000
184700             MOVE SUOBTS-DOOR-ID          TO ASC-DOOR-ID          18470000
184800             MOVE SUOBTR-DOOR-TYP-CDE     TO ASC-DOOR-TYPE        18480000
184900             MOVE CNDCDR-DOOR-LOC-DESC    TO ASC-DOOR-DESC        18490000
185000         WHEN SQLCODE = +100                                      18500000
185100             MOVE SPACES                  TO ASC-DOOR-ID          18510000
185200                                             ASC-DOOR-DESC        18520000
185300         WHEN SQLWARN0 NOT = SPACE                                18530000
185400         WHEN SQLCODE NOT = ZERO                                  18540000
185500              MOVE '4020-RETRIEVE-DOOR-ID' TO DP013-PARAGRAPH     18550000
185600              MOVE 'SELECT INFO PROBLEM '                         18560000
185700                               TO DP013-MESSAGE-TEXT (1)          18570000
185800              MOVE SQLCA       TO DP013-SQLCA                     18580000
185900              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (1)       18590000
186000              SET DP013-DB2-ABEND TO TRUE                         18600000
186100              PERFORM DP013-0000-PROCESS-ABEND                    18610000
186200     END-EVALUATE.                                                18620000
186300                                                                  18630000
186400*----------------------------------------------------------------*18640000
186500*    CURRENT STATUS FOR TRAILER                                   18650000
186600*----------------------------------------------------------------*18660000
186700 4025-GET-TRAILER-STATUS.                                         18670000
186800                                                                  18680000
186900     EXEC SQL                                                     18690000
187000         SELECT  A.TRIP_STAT_CDE                                  18700000
187100               , B.STAT_SHRT_DESC                                 18710000
187200          INTO  :SUOBTS-TRIP-STAT-CDE                             18720000
187300               ,:SUOBSC-STAT-SHRT-DESC                            18730000
187400           FROM  TSUOBTS A                                        18740000
187500                ,TSUOBSC B                                        18750000
187600          WHERE  A.OTBND_TRIP_ID    = :DK-TRIP-ID                 18760000
187700            AND  A.TRIP_STAT_CDE    = B.TRIP_STAT_CDE             18770000
187800            AND  OTBND_STAT_TMST IN                               18780000
187900                (SELECT  MAX(D.OTBND_STAT_TMST)                   18790000
188000                   FROM  TSUOBTS D                                18800000
188100                  WHERE  A.OTBND_TRIP_ID = D.OTBND_TRIP_ID)       18810000
188200     END-EXEC                                                     18820000
188300                                                                  18830000
188400     EVALUATE TRUE                                                18840000
188500         WHEN SQLCODE = ZERO                                      18850000
188600         WHEN SQLCODE = -811                                      18860000
188700             MOVE SUOBTS-TRIP-STAT-CDE    TO ASC-TRIP-STAT-CDE    18870000
188800             MOVE SUOBSC-STAT-SHRT-DESC   TO ASC-TRIP-STAT-DESC   18880000
188900         WHEN SQLCODE = +100                                      18890000
189000             MOVE SPACES                  TO ASC-TRIP-STAT-CDE    18900000
189100                                             ASC-TRIP-STAT-DESC   18910000
189200         WHEN SQLWARN0 NOT = SPACE                                18920000
189300         WHEN SQLCODE NOT = ZERO                                  18930000
189400              MOVE '4025-GET-TRAILER-STAT' TO DP013-PARAGRAPH     18940000
189500              MOVE 'SELECT TRAILER STATUS '                       18950000
189600                               TO DP013-MESSAGE-TEXT (1)          18960000
189700              MOVE SQLCA       TO DP013-SQLCA                     18970000
189800              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (1)       18980000
189900              SET DP013-DB2-ABEND TO TRUE                         18990000
190000              PERFORM DP013-0000-PROCESS-ABEND                    19000000
190100     END-EVALUATE.                                                19010000
190200                                                                  19020000
190300*----------------------------------------------------------------*19030000
190400*    RETRIEVE TRLR ID                                             19040000
190500*----------------------------------------------------------------*19050000
190600 4075-GET-TRLR-ID.                                                19060000
190700                                                                  19070000
190800     EXEC SQL                                                     19080000
190900         SELECT  TRLR_ID                                          19090000
191000          INTO  :CNTRID-TRLR-ID                                   19100000
191100           FROM  TCNTRID                                          19110000
191200          WHERE  TRLR_SRL_NBR     = :DK-TRLR-SRL-NBR              19120000
191300     END-EXEC.                                                    19130000
191400                                                                  19140000
191500     EVALUATE TRUE                                                19150000
191600         WHEN SQLCODE = ZERO                                      19160000
191700         WHEN SQLCODE = -811                                      19170000
191800             MOVE CNTRID-TRLR-ID          TO ASC-TRLR-ID-H        19180000
191900         WHEN SQLCODE = +100                                      19190000
192000             MOVE SPACES                  TO ASC-TRLR-ID-H        19200000
192100         WHEN SQLWARN0 NOT = SPACE                                19210000
192200         WHEN SQLCODE NOT = ZERO                                  19220000
192300              MOVE '4075-GET-TRLR-ID  ' TO DP013-PARAGRAPH        19230000
192400              MOVE 'SELECT INFO PROBLEM '                         19240000
192500                               TO DP013-MESSAGE-TEXT (1)          19250000
192600              MOVE SQLCA       TO DP013-SQLCA                     19260000
192700              MOVE 'TCNTRID '   TO DP013-DB2-TABLE-NAME (1)       19270000
192800              SET DP013-DB2-ABEND TO TRUE                         19280000
192900              PERFORM DP013-0000-PROCESS-ABEND                    19290000
193000     END-EVALUATE.                                                19300000
193100                                                                  19310000
193200*----------------------------------------------------------------*19320000
193300*    GET COUNT OF CARTONS MANUALLY SCANNED ONTO A GIVEN TRAILER.  19330000
193400*----------------------------------------------------------------*19340000
193500 4076-COUNT-MANUAL-CRTNS.                                         19350000
193600                                                                  19360000
193700     PERFORM P4000-CNT-SCAN-CRTN.                                 19370000
193800     MOVE PC049-PV-SCAN-COUNT TO ASC-MANUAL.                      19380000
193900     ADD PC049-PV-SCAN-COUNT  TO ASC-TOTAL.                       19390000
194000     PERFORM P4000-STRT-END-DVRT.                                 19400000
194100     PERFORM P3000-DOOR-STR-CSR.                                  19410000
194200     IF PC049-DIVERT-CUTOFFS-YES                                  19420000
194300         IF ASC-DOOR-TYPE = 'SH'                                  19430000
194400             PERFORM P4110-CNT-DVRT-CRTN-SHIP                     19440000
194500             MOVE PC049-PV-DVRT-COUNT  TO ASC-DIVERT              19450000
194600             ADD  PC049-PV-DVRT-COUNT  TO ASC-TOTAL               19460000
194700         ELSE                                                     19470000
194800             PERFORM P4100-CNT-DVRT-CRTN-SHTL                     19480000
194900             MOVE PC049-PV-DVRT-COUNT  TO ASC-DIVERT              19490000
195000             ADD  PC049-PV-DVRT-COUNT  TO ASC-TOTAL               19500000
195100         END-IF                                                   19510000
195200     ELSE                                                         19520000
195300         MOVE ZEROES               TO ASC-DIVERT                  19530000
195400     END-IF.                                                      19540000
195500                                                                  19550000
195600*----------------------------------------------------------------*19560000
195700* OPEN THE CURSOR                                                 19570000
195800*----------------------------------------------------------------*19580000
195900 4100-OPEN-CURSOR.                                                19590000
196000                                                                  19600000
196100     PERFORM                                                      19610000
196200         WITH TEST AFTER                                          19620000
196300         VARYING PV-RETRY-COUNTER                                 19630000
196400         FROM 1 BY 1                                              19640000
196500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19650000
196600                   OR (SQLCODE = ZERO))                           19660000
196700                                                                  19670000
196800         EXEC SQL                                                 19680000
196900              OPEN AUDIT-CSR                                      19690000
197000         END-EXEC                                                 19700000
197100                                                                  19710000
197200         EVALUATE TRUE                                            19720000
197300             WHEN SQLCODE = ZERO                                  19730000
197400             WHEN SQLCODE = -904                                  19740000
197500             WHEN SQLCODE = -913                                  19750000
197600                 CONTINUE                                         19760000
197700             WHEN SQLWARN0 NOT = SPACES                           19770000
197800             WHEN SQLCODE < ZERO                                  19780000
197900             WHEN SQLCODE > ZERO                                  19790000
198000                 MOVE '4100-OPEN-CURSOR' TO DP013-PARAGRAPH       19800000
198100                 MOVE 'OPEN CURSOR PROBLEM    - '                 19810000
198200                                   TO DP013-MESSAGE-TEXT (1)      19820000
198300                 MOVE SQLCA        TO DP013-SQLCA                 19830000
198400                 MOVE 'SUT_TRIP'   TO DP013-DB2-TABLE-NAME (1)    19840000
198500                 SET DP013-DB2-ABEND                              19850000
198600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19860000
198700                 PERFORM DP013-0000-PROCESS-ABEND                 19870000
198800         END-EVALUATE                                             19880000
198900     END-PERFORM.                                                 19890000
199000*                                                                 19900000
199100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19910000
199200         MOVE '4100-OPEN-CURSOR'   TO DP013-PARAGRAPH             19920000
199300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   19930000
199400                                   TO DP013-MESSAGE-TEXT (1)      19940000
199500         MOVE SQLCA                TO DP013-SQLCA                 19950000
199600         MOVE 'SUT_TRIP'           TO DP013-DB2-TABLE-NAME (1)    19960000
199700         SET DP013-DB2-ABEND                                      19970000
199800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   19980000
199900         PERFORM DP013-0000-PROCESS-ABEND                         19990000
200000     END-IF.                                                      20000000
200100                                                                  20010000
200200*----------------------------------------------------------------*20020000
200300* CLOSE THE CURSOR.                                               20030000
200400*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *20040000
200500*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *20050000
200600*   USER.                                                        *20060000
200700*----------------------------------------------------------------*20070000
200800 4200-CLOSE-CURSOR.                                               20080000
200900                                                                  20090000
201000     EXEC SQL                                                     20100000
201100         CLOSE AUDIT-CSR                                          20110000
201200     END-EXEC.                                                    20120000
201300                                                                  20130000
201400     EVALUATE TRUE                                                20140000
201500         WHEN SQLCODE = ZERO                                      20150000
201600         WHEN SQLCODE = +100                                      20160000
201700             CONTINUE                                             20170000
201800         WHEN SQLWARN0 NOT = SPACES                               20180000
201900         WHEN SQLCODE < ZERO                                      20190000
202000         WHEN SQLCODE > ZERO                                      20200000
202100             MOVE '4200-CLOSE-CURSOR' TO DP013-PARAGRAPH          20210000
202200             MOVE 'CLOSE CURSOR PROBLEM   '                       20220000
202300                               TO DP013-MESSAGE-TEXT (1)          20230000
202400             MOVE SQLCA        TO DP013-SQLCA                     20240000
202500             MOVE 'SUT_TRIP'   TO DP013-DB2-TABLE-NAME (1)        20250000
202600             SET DP013-DB2-ABEND                                  20260000
202700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20270000
202800             PERFORM DP013-0000-PROCESS-ABEND                     20280000
202900     END-EVALUATE.                                                20290000
203000                                                                  20300000
203100*----------------------------------------------------------------*20310000
203200*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20320000
203300*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20330000
203400*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20340000
203500*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20350000
203600*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20360000
203700*                                                                *20370000
203800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20380000
203900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20390000
204000*    UPON INITIALIZATION.                                        *20400000
204100*----------------------------------------------------------------*20410000
204200 4300-READ-ITEMS-FROM-DB.                                         20420000
204300                                                                  20430000
204400     PERFORM                                                      20440000
204500         VARYING PV-READ-COUNT                                    20450000
204600         FROM 1 BY 1                                              20460000
204700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20470000
204800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20480000
204900                                                                  20490000
205000         PERFORM 4310-FETCH                                       20500000
205100                                                                  20510000
205200         IF  ASC-ITEMS-LEFT-ON-DB                                 20520000
205300             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20530000
205400                 ADD +1            TO ASC-ITEM-SUB                20540000
205500             ELSE                                                 20550000
205600                 ADD +1            TO ASC-BLK-SUB                 20560000
205700                 MOVE +1           TO ASC-ITEM-SUB                20570000
205800                                                                  20580000
205900                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20590000
206000                     MOVE +1       TO ASC-BLK-SUB                 20600000
206100                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           20610000
206200                     PERFORM 5100-WRITE-TEMP-STORAGE              20620000
206300                     MOVE ASC-BLOCK-ENTRIES                       20630000
206400                                   (PC-MAX-BLOCKS-IN-ARRAY)       20640000
206500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20650000
206600                     ADD +1        TO ASC-BLK-SUB                 20660000
206700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20670000
206800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20680000
206900                                                          TO TRUE 20690000
207000                 END-IF                                           20700000
207100             END-IF                                               20710000
207200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    20720000
207300             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          20730000
207400             MOVE ASC-NUMBER-OF-ITEMS-READ                        20740000
207500                                   TO ASC-LIST-ITEM-NUMBER        20750000
207600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20760000
207700             MOVE SPACES           TO  ASC-ACTION                 20770000
207800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20780000
207900             MOVE SUT00006-USR-ID                                 20790000
208000                        TO ASC-USER-ID (ASC-BLK-SUB ASC-ITEM-SUB) 20800000
208100                           DK-USER-CODE                           20810000
209000             MOVE PV-USA-DATE                                     20900000
209100                      TO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 20910000
209200             MOVE PV-JIS-TIME                                     20920000
209300                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 20930000
209301                                                                  20930123
209310             IF  SUT00006-USR-ID  > ' '                           20931023
209400                 PERFORM 7000-USER-NAME                           20940023
209500                 IF XL067-KOHLS-NOT-FOUND                         20950023
209510                    IF  SUT00006-USR-ID   =  'ASSUMPTV'           20951030
209520                        MOVE 'ASSUMPTIVE RECEIPT PROCESS'         20952030
209530                                                   TO PV-NAME     20953030
209540                    ELSE                                          20954030
209550                    IF  PV-UNION-TSUOBTS                          20955035
209560                        MOVE 'EFC PROCESSING'                     20956035
209570                                                   TO PV-NAME     20957035
209580                        ELSE                                      20958035
209600                            MOVE SPACES            TO PV-NAME     20960035
209610                        END-IF                                    20961035
209620                    END-IF                                        20962035
209700                 ELSE                                             20970023
209800                    MOVE XL067-COMBINED-NAME-2 TO PV-NAME         20980030
209901                 END-IF                                           20990128
209910             ELSE                                                 20991023
209911                 IF  PV-UNION-TSUOBTS                             20991138
209912                     MOVE 'EFC PROCESSING'     TO PV-NAME         20991238
209914                 ELSE                                             20991438
209915                     MOVE SPACES               TO PV-NAME         20991538
209916                 END-IF                                           20991638
209930             END-IF                                               20993023
209940                                                                  20994023
210000             MOVE PV-NAME TO ASC-NAME (ASC-BLK-SUB ASC-ITEM-SUB)  21000000
210010                                                                  21001028
210100             EVALUATE SUT00006-CRE-BY-PGM-NM                      21010000
210200                 WHEN 'PCKRF870'                                  21020000
210300                     MOVE PC-PCKRF870                             21030000
210400                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21040000
210500                 WHEN 'PCKRF743'                                  21050000
210600                     MOVE PC-PCKRF743                             21060000
210700                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21070000
210800                 WHEN 'PCKRF874'                                  21080000
210900                     MOVE PC-PCKRF874                             21090000
211000                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21100000
211100                 WHEN 'PCKR874A'                                  21110000
211200                     MOVE PC-PCKR874A                             21120000
211300                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21130000
211400                 WHEN 'PCKR874B'                                  21140000
211500                     MOVE PC-PCKR874B                             21150000
211600                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21160000
211700                 WHEN 'PCKRF875'                                  21170000
211800                     MOVE PC-PCKRF875                             21180000
211900                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21190000
212000                 WHEN 'PCKRF877'                                  21200000
212100                     MOVE PC-PCKRF877                             21210000
212200                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21220000
212300                 WHEN 'PCKRF878'                                  21230000
212400                     MOVE PC-PCKRF878                             21240000
212500                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21250000
212600                 WHEN 'PCKRF879'                                  21260000
212700                     MOVE PC-PCKRF879                             21270000
212800                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21280000
212900                 WHEN 'PCKRF898'                                  21290000
213000                     MOVE PC-PCKRF898                             21300000
213100                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21310000
213200                 WHEN 'SUKCS561'                                  21320000
213300                     MOVE PC-SUKCS561                             21330000
213400                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21340000
213500                 WHEN 'SUKC564A'                                  21350000
213600                     MOVE PC-SUKC564A                             21360000
213700                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21370000
213800                 WHEN 'SUKC564B'                                  21380000
213900                     MOVE PC-SUKC564B                             21390000
214000                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21400000
214100                 WHEN 'SUKC568A'                                  21410000
214200                     MOVE PC-SUKC568A                             21420000
214300                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21430000
214400                 WHEN 'SUKC568B'                                  21440000
214500                     MOVE PC-SUKC568B                             21450000
214600                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21460000
214700                 WHEN 'SUKC802A'                                  21470009
214800                     MOVE PC-SUKC802A                             21480009
214900                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21490009
215000                 WHEN 'SUKC802B'                                  21500009
215100                     MOVE PC-SUKC802B                             21510009
215200                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21520009
215300                 WHEN 'SUKC597A'                                  21530000
215400                     MOVE PC-SUKC597A                             21540000
215500                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21550000
215600                 WHEN 'SUKC597B'                                  21560000
215700                     MOVE PC-SUKC597B                             21570000
215800                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21580000
215900                 WHEN 'SUKC597C'                                  21590000
216000                     MOVE PC-SUKC597C                             21600000
216100                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21610000
216200                 WHEN 'SUKCS597'                                  21620000
216300                     MOVE PC-SUKCS597                             21630000
216400                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21640000
216500                                                                  21650007
216600                 WHEN 'SUKUT574'                                  21660007
216700                     MOVE PC-SUKUT574                             21670007
216800                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21680007
216900                 WHEN 'SUKCS574'                                  21690007
217000                     MOVE PC-SUKCS574                             21700007
217100                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21710007
217200                 WHEN 'PCKR743A'                                  21720007
217300                     MOVE PC-PCKR743A                             21730007
217400                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21740007
217500                 WHEN 'PCKR877A'                                  21750007
217600                     MOVE PC-PCKR877A                             21760007
217700                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21770007
217800                 WHEN 'SUKC597D'                                  21780007
217900                     MOVE PC-SUKC597D                             21790007
218000                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21800007
218100                 WHEN 'SUKCS766'                                  21810011
218200                     MOVE PC-SUKCS766                             21820011
218300                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21830011
218400                 WHEN 'SUKCS808'                                  21840015
218500                     MOVE PC-SUKCS808                             21850015
218600                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21860015
218700                 WHEN 'SUKC808S'                                  21870016
218800                     MOVE PC-SUKC808S                             21880016
218900                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21890016
218910                 WHEN 'SUKUT576'                                  21891024
218920                     MOVE PC-SUKUT576                             21892024
218930                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21893024
218940                 WHEN 'SUKUP38A'                                  21894026
218950                     MOVE PC-SUKUP38A                             21895026
218960                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21896026
218970                 WHEN 'SUKUP38B'                                  21897026
218980                     MOVE PC-SUKUP38B                             21898026
218990                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21899026
218991                 WHEN 'SUKUP38C'                                  21899126
218992                     MOVE PC-SUKUP38C                             21899226
218993                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21899326
218994                 WHEN 'SUKUP38D'                                  21899426
218995                     MOVE PC-SUKUP38D                             21899526
218996                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21899626
218997                 WHEN 'SUKUP38E'                                  21899726
218998                     MOVE PC-SUKUP38E                             21899826
218999                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21899926
219000                 WHEN 'SUKUP38F'                                  21900026
219001                     MOVE PC-SUKUP38F                             21900126
219002                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21900226
219003                 WHEN 'SUKUP38G'                                  21900326
219004                     MOVE PC-SUKUP38G                             21900426
219005                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21900526
219006                 WHEN 'SUKUP38H'                                  21900626
219007                     MOVE PC-SUKUP38H                             21900726
219008                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21900826
219009                 WHEN 'SUKUP038'                                  21900926
219010                     MOVE PC-SUKUP038                             21901026
219011                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21901126
219012                 WHEN 'SUKU040A'                                  21901240
219013                 WHEN 'SUKU040C'                                  21901343
219014                     MOVE PC-SUKU040A                             21901443
219015                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21901543
219016                 WHEN 'SUKU040B'                                  21901643
219017                 WHEN 'SUKU040D'                                  21901743
219018                     MOVE PC-SUKU040B                             21901843
219019                       TO ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB) 21901943
219020                 WHEN OTHER                                       21902000
219030                      IF  PV-UNION-TSUOBTS                        21903035
219040                          MOVE  SUT00006-CRE-BY-PGM-NM            21904035
219050                            TO ASC-FUNCTION                       21905035
219060                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21906035
219070                      ELSE                                        21907035
219100                          MOVE 'UNKNOWN'                          21910035
219200                            TO ASC-FUNCTION                       21920035
219210                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21921035
219220                      END-IF                                      21922035
219300             END-EVALUATE                                         21930000
219400         END-IF                                                   21940000
219500     END-PERFORM.                                                 21950000
219600                                                                  21960000
219700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          21970000
219800         MOVE +1               TO ASC-BLK-SUB                     21980000
219900         PERFORM 5100-WRITE-TEMP-STORAGE                          21990000
220000         ADD +1                TO ASC-BLK-SUB                     22000000
220100         PERFORM 5100-WRITE-TEMP-STORAGE                          22010000
220200                                                                  22020000
220300         MOVE 1                TO ASC-BLK-SUB                     22030000
220400                                  PV-BLOCK-NUMBER                 22040000
220500         PERFORM 4410-READ-TEMP-STORAGE                           22050000
220600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             22060000
220700             MOVE 2            TO ASC-BLK-SUB                     22070000
220800                                  PV-BLOCK-NUMBER                 22080000
220900             PERFORM 4410-READ-TEMP-STORAGE                       22090000
221000         END-IF                                                   22100000
221100     END-IF.                                                      22110000
221200*----------------------------------------------------------------*22120000
221300*    FETCH THE CURSOR                                             22130000
221400*----------------------------------------------------------------*22140000
221500 4310-FETCH.                                                      22150000
221600                                                                  22160000
221700     EXEC SQL                                                     22170000
221800          FETCH AUDIT-CSR                                         22180000
221900         INTO  :PV-UNION-SELECTION                                22190035
221910              ,:SUT00006-USR-ID                                   22191035
222000              ,:SUT00006-CRE-TMST                                 22200000
222100              ,:PV-USA-DATE                                       22210000
222200              ,:PV-JIS-TIME                                       22220000
222300              ,:SUT00006-CRE-BY-PGM-NM                            22230000
222400     END-EXEC.                                                    22240000
222500                                                                  22250000
222600     IF  SQLCODE EQUAL + 100                                      22260000
222700         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      22270000
222800     END-IF.                                                      22280000
222900                                                                  22290000
223000*----------------------------------------------------------------*22300000
223100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *22310000
223200*----------------------------------------------------------------*22320000
223300 4400-MOVE-COMMAREA-TO-SCREEN.                                    22330000
223400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             22340000
223500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          22350000
223600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          22360000
223700             MOVE +1    TO ASC-BLK-SUB                            22370000
223800             PERFORM 5100-WRITE-TEMP-STORAGE                      22380000
223900             ADD +1     TO ASC-BLK-SUB                            22390000
224000             PERFORM 5100-WRITE-TEMP-STORAGE                      22400000
224100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             22410000
224200                 GIVING PV-BLOCK-NUMBER                           22420000
224300                 REMAINDER PV-REMAINDER                           22430000
224400             IF  PV-REMAINDER > ZERO                              22440000
224500                 ADD +1 TO PV-BLOCK-NUMBER                        22450000
224600             END-IF                                               22460000
224700             MOVE +1    TO ASC-BLK-SUB                            22470000
224800             PERFORM 4410-READ-TEMP-STORAGE                       22480000
224900             ADD +1     TO ASC-BLK-SUB                            22490000
225000                           PV-BLOCK-NUMBER                        22500000
225100             PERFORM 4410-READ-TEMP-STORAGE                       22510000
225200     END-IF.                                                      22520000
225300     MOVE +1            TO ASC-BLK-SUB.                           22530000
225400     COMPUTE ASC-ITEM-SUB =                                       22540000
225500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              22550000
225600         + PC-ITEMS-PER-PANEL).                                   22560000
225700*                                                                 22570000
225800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        22580000
225900         ADD +1         TO ASC-BLK-SUB                            22590000
226000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22600000
226100     END-IF.                                                      22610000
226200*                                                                 22620000
226300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           22630000
226400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                22640000
226500     PERFORM 4420-FORMAT-LIST-LINES                               22650000
226600         VARYING PV-SUB                                           22660000
226700         FROM PC-ITEMS-PER-PANEL BY -1                            22670000
226800         UNTIL PV-SUB < +1.                                       22680000
226900*                                                                 22690000
227000     COMPUTE ASC-ITEMS-DISPLAYED =                                22700000
227100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          22710000
227200*    MOVE -1                       TO ASTRTITL.                   22720000
227300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    22730000
227400                                      ASTRTITO.                   22740000
227500     MOVE -1                       TO ASTRTITL.                   22750000
227600     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       22760000
227700     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    22770000
227800     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    22780000
227900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            22790000
228000                                   TO ASELITO.                    22800000
228100                                                                  22810000
228200     MOVE ASC-OPER-UNT-ID            TO AOPERO.                   22820000
228300     IF  ASC-TRLR-SRL-NMBR-H > ZEROES                             22830000
228400         MOVE ASC-TRLR-SRL-NMBR-H    TO ATRLRO                    22840000
228500     ELSE                                                         22850000
228600         MOVE ASC-TRLR-SRL-NMBR-L    TO ATRLRO                    22860000
228700     END-IF.                                                      22870000
228800     MOVE ASC-OTBND-TRIP-ID          TO ATRIPO.                   22880000
228900     MOVE ASC-TRIP-DEST-OPER-N       TO ATRPDSTO.                 22890000
229000     IF  ASC-SCAC-CODE-H > SPACES                                 22900000
229100         MOVE ASC-SCAC-CODE-H        TO ASCACO                    22910000
229200     ELSE                                                         22920000
229300         MOVE ASC-SCAC-CODE-L        TO ASCACO                    22930000
229400     END-IF.                                                      22940000
229500     IF  ASC-TRLR-ID-H > SPACES                                   22950000
229600         MOVE ASC-TRLR-ID-H          TO ATRLRIDO                  22960000
229700     ELSE                                                         22970000
229800         MOVE ASC-TRLR-ID-L          TO ATRLRIDO                  22980000
229900     END-IF.                                                      22990000
229910*                                                                 22991018
230000     MOVE ASC-DOOR-ID                TO ADOORO.                   23000000
230100     MOVE ASC-DOOR-DESC              TO ADESCO.                   23010000
230200     MOVE ASC-MANUAL                 TO AMANUALO.                 23020000
230300     MOVE ASC-DIVERT                 TO ADIVERTO.                 23030000
230400     MOVE ASC-TOTAL                  TO ATOTALO.                  23040000
230500     MOVE ASC-TRIP-STAT-DESC         TO ASTATO.                   23050000
230600                                                                  23060000
230700     IF  DP020-MSG-NUMBER-X = SPACE                               23070000
230800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23080000
230900*            --- MORE ITEMS TO DISPLAY ----                       23090000
231000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23100000
231100             SET DP020-MSG-INFORMATIONAL TO TRUE                  23110000
231200         END-IF                                                   23120000
231300     END-IF.                                                      23130000
231400                                                                  23140000
231500*----------------------------------------------------------------*23150000
231600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23160000
231700*----------------------------------------------------------------*23170000
231800 4410-READ-TEMP-STORAGE.                                          23180000
231900                                                                  23190000
232000     EXEC CICS                                                    23200000
232100         READQ TS                                                 23210000
232200             QUEUE (ASC-LIST-QUEUE-NAME)                          23220000
232300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23230000
232400             ITEM  (PV-BLOCK-NUMBER)                              23240000
232500             RESP  (PV-CICS-RESP)                                 23250000
232600     END-EXEC.                                                    23260000
232700                                                                  23270000
232800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23280000
232900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     23290000
233000         CONTINUE                                                 23300000
233100     ELSE                                                         23310000
233200         SET DP013-CICS-ABEND     TO TRUE                         23320000
233300         SET DP013-NO-ROLLBACK    TO TRUE                         23330000
233400         MOVE '4410-READ-TEMP-STORAGE'                            23340000
233500                                  TO DP013-PARAGRAPH              23350000
233600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      23360000
233700                                  TO DP013-MESSAGE-TEXT(1)        23370000
233800         PERFORM DP013-0000-PROCESS-ABEND                         23380000
233900     END-IF.                                                      23390000
234000                                                                  23400000
234100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             23410000
234200*                                                                 23420000
234300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         23430000
234400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               23440000
234500     END-IF.                                                      23450000
234600                                                                  23460000
234700*----------------------------------------------------------------*23470000
234800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *23480000
234900*----------------------------------------------------------------*23490000
235000 4420-FORMAT-LIST-LINES.                                          23500000
235100     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      23510000
235200         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                23520000
235300         MOVE SPACE              TO MR-USER-ID (PV-SUB)           23530000
235400                                    MR-NAME (PV-SUB)              23540000
235500                                    MR-FUNCTION (PV-SUB)          23550000
235600                                    MR-STAT-DATE (PV-SUB)         23560000
235700                                    MR-STAT-TIME (PV-SUB)         23570000
235800     ELSE                                                         23580000
235900*                                                                 23590000
236000         MOVE ASC-USER-ID (ASC-BLK-SUB ASC-ITEM-SUB)              23600000
236100                                           TO MR-USER-ID (PV-SUB) 23610000
236200         MOVE ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB)            23620000
236300                                         TO MR-STAT-DATE (PV-SUB) 23630000
236400         MOVE ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB)            23640000
236500                                         TO MR-STAT-TIME (PV-SUB) 23650000
236600         MOVE ASC-NAME (ASC-BLK-SUB ASC-ITEM-SUB)                 23660000
236700                                              TO MR-NAME (PV-SUB) 23670000
236800         MOVE ASC-FUNCTION (ASC-BLK-SUB ASC-ITEM-SUB)             23680000
236900                                          TO MR-FUNCTION (PV-SUB) 23690000
237000     END-IF.                                                      23700000
237100     SUBTRACT +1 FROM ASC-ITEM-SUB                                23710000
237200     IF  ASC-ITEM-SUB < + 1                                       23720000
237300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23730000
237400         MOVE +1                 TO ASC-BLK-SUB                   23740000
237500     END-IF.                                                      23750000
237600                                                                  23760000
237700*----------------------------------------------------------------*23770000
237800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *23780000
237900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *23790000
238000* FOR THE SELECTED ITEMS QUEUE.                                  *23800000
238100*                                                                *23810000
238200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *23820000
238300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *23830000
238400* THE ARRAY IS FULL.                                             *23840000
238500*----------------------------------------------------------------*23850000
238600 5000-PREPARE-SEL-QUEUE.                                          23860000
238700                                                                  23870000
238800     MOVE +1                   TO  ASC-BLK-SUB.                   23880000
238900     PERFORM 5100-WRITE-TEMP-STORAGE.                             23890000
239000     ADD +1                    TO  ASC-BLK-SUB.                   23900000
239100     PERFORM 5100-WRITE-TEMP-STORAGE.                             23910000
239200                                                                  23920000
239300     MOVE ASC-SEL-QUEUE-NAME   TO  SU009-SEL-QUEUE-NAME.          23930000
239400     PERFORM 6010-DELETE-SEL-QUEUE.                               23940000
239500                                                                  23950000
239600     SET ASC-UPDATE-TSQ        TO  TRUE.                          23960000
239700                                                                  23970000
239800     SET SU010-IDX             TO  1.                             23980000
239900     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       23990000
240000     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        24000000
240100                                                                  24010000
240200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           24020000
240300             VARYING PV-ITEM                                      24030000
240400             FROM 1 BY 1                                          24040000
240500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     24050000
240600                                                                  24060000
240700     IF  SU010-IDX > 1                                            24070000
240800         PERFORM 5205-WRITE-SEL-QUEUE                             24080000
240900         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        24090000
241000     END-IF.                                                      24100000
241100*----------------------------------------------------------------*24110000
241200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *24120000
241300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *24130000
241400*----------------------------------------------------------------*24140000
241500 5100-WRITE-TEMP-STORAGE.                                         24150000
241600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     24160000
241700                                   TO PV-LIST-ITEM-NUMBER.        24170000
241800     COMPUTE PV-BLOCK-NUMBER =                                    24180000
241900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    24190000
242000                                                                  24200000
242100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             24210000
242200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             24220000
242300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      24230000
242400             PERFORM 5105-REWRITE-ASC-LISTQ                       24240000
242500         END-IF                                                   24250000
242600     ELSE                                                         24260000
242700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       24270000
242800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            24280000
242900         PERFORM 5110-WRITE-ASC-LISTQ                             24290000
243000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   24300000
243100     END-IF.                                                      24310000
243200                                                                  24320000
243300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24330000
243400                                                                  24340000
243500******************************************************************24350000
243600** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **24360000
243700** SPECIFIC COMMAREA.                                           **24370000
243800******************************************************************24380000
243900 5105-REWRITE-ASC-LISTQ.                                          24390000
244000     EXEC CICS                                                    24400000
244100         WRITEQ TS                                                24410000
244200             QUEUE (ASC-LIST-QUEUE-NAME)                          24420000
244300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24430000
244400             ITEM  (PV-BLOCK-NUMBER)                              24440000
244500             REWRITE                                              24450000
244600             RESP  (PV-CICS-RESP)                                 24460000
244700     END-EXEC.                                                    24470000
244800                                                                  24480000
244900     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           24490000
245000         CONTINUE                                                 24500000
245100     ELSE                                                         24510000
245200         SET DP013-CICS-ABEND            TO TRUE                  24520000
245300         SET DP013-NO-ROLLBACK           TO TRUE                  24530000
245400         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       24540000
245500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     24550000
245600                                         TO DP013-MESSAGE-TEXT(1) 24560000
245700         PERFORM DP013-0000-PROCESS-ABEND                         24570000
245800     END-IF.                                                      24580000
245900                                                                  24590000
246000******************************************************************24600000
246100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **24610000
246200** SPECIFIC COMMAREA.                                           **24620000
246300******************************************************************24630000
246400 5110-WRITE-ASC-LISTQ.                                            24640000
246500     EXEC CICS                                                    24650000
246600         WRITEQ TS                                                24660000
246700             QUEUE (ASC-LIST-QUEUE-NAME)                          24670000
246800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24680000
246900             ITEM  (PV-BLOCK-NUMBER)                              24690000
247000             RESP  (PV-CICS-RESP)                                 24700000
247100     END-EXEC.                                                    24710000
247200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      24720000
247300         SET DP013-CICS-ABEND      TO TRUE                        24730000
247400         SET DP013-NO-ROLLBACK     TO TRUE                        24740000
247500         MOVE '5110-WRITE-ASC-LISTQ'                              24750000
247600                                   TO DP013-PARAGRAPH             24760000
247700         MOVE 'ATTEMPTING TO WRITE ASC LIST QUEUE'                24770000
247800                                   TO DP013-MESSAGE-TEXT(1)       24780000
247900         PERFORM DP013-0000-PROCESS-ABEND                         24790000
248000     END-IF.                                                      24800000
248100                                                                  24810000
248200*----------------------------------------------------------------*24820000
248300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *24830000
248400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *24840000
248500*----------------------------------------------------------------*24850000
248600 5200-FILL-SEL-QUEUE-RECORD.                                      24860000
248700     PERFORM 6112-READ-LIST-QUEUE.                                24870000
248800                                                                  24880000
248900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       24890000
249000         PERFORM                                                  24900000
249100         VARYING LQW-IDX                                          24910000
249200         FROM 1 BY 1                                              24920000
249300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            24930000
249400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          24940000
249500                                                                  24950000
249600             IF  LQW-SELECT (LQW-IDX)                             24960000
249700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              24970000
249800                                   TO SU010-ITEM (SU010-IDX)      24980000
249900                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 24990000
250000                                                                  25000000
250100                 MOVE LQW-USER-ID (LQW-IDX) TO                    25010000
250200                                      SU010-USER-ID (SU010-IDX)   25020000
250300                 MOVE LQW-STAT-DATE (LQW-IDX) TO                  25030000
250400                                       SU010-STAT-DATE(SU010-IDX) 25040000
250500                 MOVE LQW-STAT-TIME (LQW-IDX) TO                  25050000
250600                                       SU010-STAT-TIME(SU010-IDX) 25060000
250700                 SET SU010-IDX UP BY 1                            25070000
250800                 IF  SU010-IDX > SU010-MAX-ITEMS                  25080000
250900                     PERFORM 5205-WRITE-SEL-QUEUE                 25090000
251000                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    25100000
251100                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         25110000
251200                     SET SU010-IDX TO  1                          25120000
251300                 END-IF                                           25130000
251400             END-IF                                               25140000
251500         END-PERFORM                                              25150000
251600     END-IF.                                                      25160000
251700                                                                  25170000
251800*----------------------------------------------------------------*25180000
251900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *25190000
252000*----------------------------------------------------------------*25200000
252100 5205-WRITE-SEL-QUEUE.                                            25210000
252200                                                                  25220000
252300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            25230000
252400                                   TO SU010-SELECTED-ITEMS.       25240000
252500                                                                  25250000
252600     EXEC CICS                                                    25260000
252700          WRITEQ TS                                               25270000
252800              QUEUE (ASC-SEL-QUEUE-NAME)                          25280000
252900              FROM  (SU010-SELECT-RECORD)                         25290000
253000              ITEM  (PV-SEL-QUEUE-ITEM)                           25300000
253100              RESP  (PV-CICS-RESP)                                25310000
253200     END-EXEC.                                                    25320000
253300                                                                  25330000
253400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          25340000
253500         CONTINUE                                                 25350000
253600     ELSE                                                         25360000
253700         SET DP013-CICS-ABEND      TO TRUE                        25370000
253800         SET DP013-NO-ROLLBACK     TO TRUE                        25380000
253900         MOVE '5205-WRITE-SEL-QUEUE'  TO DP013-PARAGRAPH          25390000
254000         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          25400000
254100                                   TO DP013-MESSAGE-TEXT(1)       25410000
254200         PERFORM DP013-0000-PROCESS-ABEND                         25420000
254300     END-IF.                                                      25430000
254400******************************************************************25440000
254500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **25450000
254600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **25460000
254700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **25470000
254800** THE USER.                                                    **25480000
254900******************************************************************25490000
255000 6000-REFRESH-PANEL-FROM-TEMP.                                    25500000
255100     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      25510000
255200         SET ASC-NO-TSQ-UPDATE TO TRUE                            25520000
255300         MOVE ZERO                 TO PV-SAVE-ITEM                25530000
255400                                      PV-SEL-QUEUE-ITEM           25540000
255500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        25550000
255600                                   TO PV-HOLD-SELECTED-ITEMS      25560000
255700         MOVE +1                   TO PV-ITEMS-PROCESSED          25570000
255800         PERFORM 6100-UPDATE-TSQ                                  25580000
255900             UNTIL PV-ITEMS-PROCESSED >                           25590000
256000                                     PV-HOLD-SELECTED-ITEMS       25600000
256100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         25610000
256200                    ASC-BLOCK-ENTRIES (2)                         25620000
256300     END-IF.                                                      25630000
256400                                                                  25640000
256500*----------------------------------------------------------------*25650000
256600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *25660000
256700*----------------------------------------------------------------*25670000
256800 6010-DELETE-SEL-QUEUE.                                           25680000
256900                                                                  25690000
257000     EXEC CICS                                                    25700000
257100         DELETEQ TS                                               25710000
257200             QUEUE (ASC-SEL-QUEUE-NAME)                           25720000
257300             RESP  (PV-CICS-RESP)                                 25730000
257400     END-EXEC.                                                    25740000
257500*                                                                 25750000
257600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      25760000
257700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         25770000
257800         CONTINUE                                                 25780000
257900     ELSE                                                         25790000
258000         SET DP013-CICS-ABEND TO TRUE                             25800000
258100         SET DP013-NO-ROLLBACK TO TRUE                            25810000
258200         MOVE '6010-DELETE-SEL-QUEUE'                             25820000
258300                        TO DP013-PARAGRAPH                        25830000
258400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         25840000
258500                        TO DP013-MESSAGE-TEXT (1)                 25850000
258600         PERFORM DP013-0000-PROCESS-ABEND                         25860000
258700     END-IF.                                                      25870000
258800                                                                  25880000
258900*----------------------------------------------------------------*25890000
259000*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *25900000
259100*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *25910000
259200*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *25920000
259300*    THE TEMP QUEUE.                                             *25930000
259400*----------------------------------------------------------------*25940000
259500 6100-UPDATE-TSQ.                                                 25950000
259600                                                                  25960000
259700     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             25970000
259800     PERFORM 6150-READ-SEL-QUEUE.                                 25980000
259900     PERFORM                                                      25990000
260000         VARYING SU010-IDX                                        26000000
260100         FROM 1 BY 1                                              26010000
260200         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     26020000
260300         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             26030000
260400         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  26040000
260500             PERFORM 6110-PROCESS-ITEMS                           26050000
260600         END-IF                                                   26060000
260700         ADD +1                TO PV-ITEMS-PROCESSED              26070000
260800     END-PERFORM.                                                 26080000
260900     PERFORM 6111-WRITE-LIST-QUEUE.                               26090000
261000                                                                  26100000
261100*----------------------------------------------------------------*26110000
261200*    READ THE LIST QUEUE RECORD.                                 *26120000
261300*----------------------------------------------------------------*26130000
261400 6150-READ-SEL-QUEUE.                                             26140000
261500                                                                  26150000
261600     EXEC CICS                                                    26160000
261700          READQ TS                                                26170000
261800              QUEUE (ASC-SEL-QUEUE-NAME)                          26180000
261900              INTO  (SU010-SELECT-RECORD)                         26190000
262000              ITEM  (PV-SEL-QUEUE-ITEM)                           26200000
262100              RESP  (PV-CICS-RESP)                                26210000
262200     END-EXEC.                                                    26220000
262300*                                                                 26230000
262400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26240000
262500         CONTINUE                                                 26250000
262600     ELSE                                                         26260000
262700         SET DP013-CICS-ABEND      TO  TRUE                       26270000
262800         SET DP013-NO-ROLLBACK     TO  TRUE                       26280000
262900         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           26290000
263000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           26300000
263100                                   TO  DP013-MESSAGE-TEXT(1)      26310000
263200         PERFORM DP013-0000-PROCESS-ABEND                         26320000
263300     END-IF.                                                      26330000
263400                                                                  26340000
263500*----------------------------------------------------------------*26350000
263600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*26360000
263700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*26370000
263800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *26380000
263900*----------------------------------------------------------------*26390000
264000 6110-PROCESS-ITEMS.                                              26400000
264100                                                                  26410000
264200     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          26420000
264300                     / PC-ITEMS-PER-PANEL).                       26430000
264400                                                                  26440000
264500     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           26450000
264600         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          26460000
264700             PERFORM 6111-WRITE-LIST-QUEUE                        26470000
264800         END-IF                                                   26480000
264900         MOVE PV-ITEM          TO PV-SAVE-ITEM                    26490000
265000                                                                  26500000
265100         PERFORM 6112-READ-LIST-QUEUE                             26510000
265200         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               26520000
265300             CONTINUE                                             26530000
265400         END-IF                                                   26540000
265500     END-IF.                                                      26550000
265600                                                                  26560000
265700     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     26570000
265800                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              26580000
265900     SET LQW-DESELECT (PV-SUB) TO    TRUE                         26590000
266000     MOVE LQW-SELECTED-SW (PV-SUB)                                26600000
266100                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  26610000
266200                                                                  26620000
266300     EVALUATE TRUE                                                26630000
266400         WHEN SU010-INQ (SU010-IDX)                               26640000
266500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             26650000
266600                                                                  26660000
266700         WHEN SU010-UPD (SU010-IDX)                               26670000
266800              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             26680000
266900                                                                  26690000
267000         WHEN SU010-DEL (SU010-IDX)                               26700000
267100              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             26710000
267200                                                                  26720000
267300         WHEN SU010-ERR (SU010-IDX)                               26730000
267400              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             26740000
267500     END-EVALUATE.                                                26750000
267600                                                                  26760000
267700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                26770000
267800                                                                  26780000
267900*----------------------------------------------------------------*26790000
268000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *26800000
268100*----------------------------------------------------------------*26810000
268200 6111-WRITE-LIST-QUEUE.                                           26820000
268300                                                                  26830000
268400     EXEC CICS                                                    26840000
268500         WRITEQ TS                                                26850000
268600             QUEUE (ASC-LIST-QUEUE-NAME)                          26860000
268700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     26870000
268800             ITEM  (PV-SAVE-ITEM)                                 26880000
268900             REWRITE                                              26890000
269000             RESP  (PV-CICS-RESP)                                 26900000
269100     END-EXEC.                                                    26910000
269200*                                                                 26920000
269300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26930000
269400         CONTINUE                                                 26940000
269500     ELSE                                                         26950000
269600         SET DP013-CICS-ABEND  TO  TRUE                           26960000
269700         SET DP013-NO-ROLLBACK TO  TRUE                           26970000
269800         MOVE '6111-WRITE-LIST-QUEUE'                             26980000
269900                               TO  DP013-PARAGRAPH                26990000
270000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  27000000
270100                               TO  DP013-MESSAGE-TEXT(1)          27010000
270200         PERFORM DP013-0000-PROCESS-ABEND                         27020000
270300     END-IF.                                                      27030000
270400                                                                  27040000
270500*----------------------------------------------------------------*27050000
270600*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*27060000
270700*----------------------------------------------------------------*27070000
270800 6112-READ-LIST-QUEUE.                                            27080000
270900                                                                  27090000
271000     EXEC CICS                                                    27100000
271100         READQ TS                                                 27110000
271200             QUEUE (ASC-LIST-QUEUE-NAME)                          27120000
271300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     27130000
271400             ITEM  (PV-ITEM)                                      27140000
271500             RESP  (PV-CICS-RESP)                                 27150000
271600     END-EXEC.                                                    27160000
271700*                                                                 27170000
271800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27180000
271900         CONTINUE                                                 27190000
272000     ELSE                                                         27200000
272100         SET DP013-CICS-ABEND        TO TRUE                      27210000
272200         SET DP013-NO-ROLLBACK       TO TRUE                      27220000
272300         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           27230000
272400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    27240000
272500                                     TO DP013-MESSAGE-TEXT(1)     27250000
272600         PERFORM DP013-0000-PROCESS-ABEND                         27260000
272700     END-IF.                                                      27270000
272800                                                                  27280000
272900 7000-USER-NAME.                                                  27290000
273000                                                                  27300001
273100     INITIALIZE XL067-USER-COMMAREA.                              27310001
273200                                                                  27320001
273300     SET XL067-BY-USER-ID            TO TRUE.                     27330001
273400     SET XL067-SELECT-KOHLS-USER     TO TRUE.                     27340001
273500                                                                  27350001
273600     MOVE DK-USER-CODE          TO XL067-KEY-USER-ID.             27360001
273700                                                                  27370001
273800     CALL XL067-USER-PGM USING DFHEIBLK                           27380004
273900                               XL067-COMMAREA                     27390004
274000                               XL067-USER-COMMAREA.               27400004
274100                                                                  27410004
274200     EVALUATE TRUE                                                27420001
274300         WHEN XL067-SUCCESSFUL                                    27430001
274400             CONTINUE                                             27440001
274500         WHEN OTHER                                               27450001
274600              DISPLAY '***********************************'       27460001
274700              DISPLAY '****     SUKCS573  ABEND       ****'       27470001
274800              DISPLAY '***********************************'       27480001
274900              DISPLAY '**  PARAGRAPH 7000-USER-NAME     **'       27490001
275000              DISPLAY '**  UNSUCCESSFUL CALL TO XLKUT067**'       27500001
275100              DISPLAY '**  SEE PROD COPYBOOK XLWS067    **'       27510001
275200              DISPLAY '**  XL067-RETURN-CODE:'  XL067-RETURN-CODE 27520001
275300              DISPLAY '***********************************'       27530001
275400              MOVE '7000-USER-NAME'    TO DP013-PARAGRAPH         27540021
275401              MOVE XL067-KOHLS-SQLCODE TO PV-DISP-SQLCODE1        27540121
275402              MOVE XL067-TEMP-SQLCODE  TO PV-DISP-SQLCODE2        27540221
275403                                                                  27540321
275410              STRING XL067-ACCESS-METHOD '-'                      27541021
275420                     XL067-VIEW-SELECTION '-'                     27542021
275430                     XL067-USER-FOUND-CODE '-'                    27543027
275500                                       DELIMITED BY SIZE          27550021
275600                                  INTO DP013-MESSAGE-TEXT (1)     27560021
275601                                                                  27560121
275610              STRING XL067-KEY-USER-ID    '-'                     27561021
275611                     XL067-KEY-FIRST-NAME '-'                     27561121
275612                     XL067-KEY-LAST-NAME                          27561221
275630                                       DELIMITED BY SIZE          27563021
275640                                  INTO DP013-MESSAGE-TEXT (2)     27564021
275641                                                                  27564121
275650              STRING XL067-RETURN-CODE     '  '                   27565021
275660                     PV-DISP-SQLCODE1      '  '                   27566021
275670                     PV-DISP-SQLCODE2                             27567021
275680                                       DELIMITED BY SIZE          27568021
275690                                  INTO DP013-MESSAGE-TEXT (3)     27569021
275691                                                                  27569121
275700              MOVE SQLCA            TO DP013-SQLCA                27570001
275800              MOVE 'XLT_USR '       TO DP013-DB2-TABLE-NAME (1)   27580001
275810                                                                  27581021
275900              SET DP013-DB2-ABEND   TO TRUE                       27590001
276000              PERFORM DP013-0000-PROCESS-ABEND                    27600001
276100     END-EVALUATE.                                                27610001
276200                                                                  27620001
276300/                                                                 27630000
276400*-----------------------------------------------------------------27640000
276500*  READ THE LIST QUEUE RECORD                                     27650000
276600*-----------------------------------------------------------------27660000
276700 9100-READ-SEL-QUEUE.                                             27670000
276800                                                                  27680000
276900     EXEC CICS                                                    27690000
277000         READQ TS                                                 27700000
277100             QUEUE (ASC-SEL-QUEUE-NAME)                           27710000
277200             INTO  (SU010-SELECT-RECORD)                          27720000
277300             ITEM  (ASC-SEL-ITEM)                                 27730000
277400             RESP  (PV-CICS-RESP)                                 27740000
277500     END-EXEC.                                                    27750000
277600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        27760000
277700         CONTINUE                                                 27770000
277800     ELSE                                                         27780000
277900         SET DP013-LOGIC-ABEND                                    27790000
278000             DP013-NO-ROLLBACK   TO   TRUE                        27800000
278100         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          27810000
278200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   27820000
278300                                 TO   DP013-MESSAGE-TEXT (1)      27830000
278400         PERFORM DP013-0000-PROCESS-ABEND                         27840000
278500     END-IF.                                                      27850000
278600                                                                  27860000
278700*-----------------------------------------------------------------27870000
278800* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *27880000
278900*-----------------------------------------------------------------27890000
279000 9200-REWRITE-SEL-QUEUE.                                          27900000
279100                                                                  27910000
279200     EXEC CICS                                                    27920000
279300          WRITEQ TS                                               27930000
279400              QUEUE  (ASC-SEL-QUEUE-NAME)                         27940000
279500              FROM   (SU010-SELECT-RECORD)                        27950000
279600              ITEM   (ASC-SEL-ITEM)                               27960000
279700              RESP   (PV-CICS-RESP)                               27970000
279800              REWRITE                                             27980000
279900     END-EXEC.                                                    27990000
280000                                                                  28000000
280100     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   28010000
280200         SET DP013-CICS-ABEND                                     28020000
280300             DP013-NO-ROLLBACK     TO TRUE                        28030000
280400         MOVE '9200-REWRITE-SEL-QUEUE'                            28040000
280500                                   TO DP013-PARAGRAPH             28050000
280600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   28060000
280700                                   TO DP013-MESSAGE-TEXT (1)      28070000
280800         PERFORM DP013-0000-PROCESS-ABEND                         28080000
280900     END-IF.                                                      28090000
281000                                                                  28100000
281100*----------------------------------------------------------------*28110000
281200*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *28120000
281300*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *28130000
281400*----------------------------------------------------------------*28140000
281500 9900-SOFT-ABORT.                                                 28150000
281600                                                                  28160000
281700     EXEC CICS SYNCPOINT                                          28170000
281800          ROLLBACK                                                28180000
281900     END-EXEC.                                                    28190000
282000                                                                  28200000
282100     SET  PS-ERROR                                                28210000
282200          PS-SOFT-ABORT-ERROR                                     28220000
282300          DP020-MSG-FATAL       TO  TRUE.                         28230000
282400                                                                  28240000
282500*----------------------------------------------------------------*28250000
282600*    ABEND PROCESSOR MODULE                                      *28260000
282700*----------------------------------------------------------------*28270000
282800     COPY DPPD013.                                                28280000
282900                                                                  28290000
283000***************************************************************** 28300000
283100* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 28310000
283200     COPY PCPD049.                                                28320000
