000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.             SUKRF501.                                00050001
000600 AUTHOR.                 LARRY SCHLEICHER.                        00060001
000700 INSTALLATION.           KOHLS.                                   00070001
000800 DATE-WRITTEN.           JUNE, 1996.                              00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100*----------------------------------------------------------------*00110001
001200* THIS PROGRAM DISPLAYS THE TRAILER START SCREEN ON THE LRT (LASER00120001
001300* RADIO TERMINAL).  IT WILL ACCEPT THE ENTRY OF THE TRAILER       00130001
001400* MANIFEST NUMBER AND A USING PRINTER INDICATOR.                  00140001
001500*----------------------------------------------------------------*00150001
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00152029
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00153029
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00154029
263968*---------------------------------------------------------------* 00155029
001600                                                                  00160001
001700******************************************************************00170001
001800 ENVIRONMENT DIVISION.                                            00180001
001900******************************************************************00190001
002000                                                                  00200001
002100******************************************************************00210001
002200 DATA DIVISION.                                                   00220001
002300******************************************************************00230001
002400                                                                  00240001
002500******************************************************************00250001
002600 WORKING-STORAGE SECTION.                                         00260001
002700******************************************************************00270001
002800*                                                                 00280001
002900 01  CA-COMMAREA.                                                 00290001
003000*----------------------------------------------------------------*00300001
003100*  COMMAREA LAYOUT FOR THE PACK BY STORE AUDIT PROJECT            00310001
003200*----------------------------------------------------------------*00320001
003300     COPY SUWS001.                                                00330013
003400                                                                  00340001
003600                                                                  00360001
003700*----------------------------------------------------------------*00370001
003800*  DB2 KEYS                                                      *00380001
003900*----------------------------------------------------------------*00390001
004000 01  DK-DB2-KEYS.                                                 00400001
004100     05  DK-CURR-OPER-UNT-ID             PIC  S9(4) COMP.         00410001
004200     05  DK-FCLTY-ID                     PIC  S9(4) VALUE +1      00420001
004300                                                    COMP.         00430001
004400     05  DK-TRIP-ID                      PIC  S9(9) COMP.         00440001
004500                                                                  00450001
004600*----------------------------------------------------------------*00460001
004700*  PROGRAM CONSTANTS                                             *00470001
004800*----------------------------------------------------------------*00480001
004900 01  PC-PROGRAM-CONSTANTS.                                        00490001
005000     05  PC-TRANID                       PIC  X(04)  VALUE 'S501'.00500001
005100     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00510001
005200                                                     COMP SYNC.   00520001
005300     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00530001
005400                                                     COMP SYNC.   00540001
005500*LMM 05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +300   00550004
005600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00560004
005700                                                     COMP SYNC.   00570001
005800     05  PC-MF-FORM-LENGTH               PIC S9(04)  VALUE +207   00580001
005900                                                     COMP SYNC.   00590001
006000     05  PC-FI-FORM-LENGTH               PIC S9(04)  VALUE +244   00600001
006100                                                     COMP SYNC.   00610001
006200     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00620001
006300                                                     COMP SYNC.   00630001
006800     05  PC-01                           PIC  X(02)  VALUE '01'.  00680001
006900     05  PC-49                           PIC  X(02)  VALUE '49'.  00690001
007000     05  PC-50                           PIC  X(02)  VALUE '50'.  00700001
007100     05  PC-95                           PIC  X(02)  VALUE '95'.  00710001
007200     05  PC-A                            PIC  X(01)  VALUE 'A'.   00720001
007210     05  PC-B                            PIC  X(01)  VALUE 'B'.   00721017
007300     05  PC-MGMX                         PIC  X(04)  VALUE 'MGMX'.00730001
007400     05  PC-UG                           PIC  X(02)  VALUE 'UG'.  00740001
007500     05  PC-90                           PIC  X(02)  VALUE '90'.  00750001
007600     05  PC-CORPORATE                    PIC S9(04)  VALUE 90     00760001
007700                                                     COMP.        00770001
007800                                                                  00780001
007900     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'SUKRF501'.   00790001
008000     05  PC-TRAILER-STOP-PGM        PIC X(08) VALUE 'SUKRF503'.   00800001
008100*LMM                                                              00810001
008200     05  PC-TRIP-START-PGM          PIC X(08) VALUE 'SUKRF529'.   00820001
008300     05  PC-SU-MENU-PGM             PIC X(08) VALUE 'SUKRF500'.   00830001
008400     05  PC-SU-SHIP-CODE-PGM        PIC X(08) VALUE 'SUKRF502'.   00840001
008500     05  PC-PRTR-VALIDATION-PGM     PIC X(08) VALUE 'DPKCS060'.   00850001
008600     05  PC-REPORT-PGM-1            PIC X(08) VALUE 'PCKCS126'.   00860001
008700     05  PC-REPORT-PGM-2            PIC X(08) VALUE 'SUKRF527'.   00870015
008800                                                                  00880001
008900*----------------------------------------------------------------*00890001
009000*   ERROR MESSAGES                                                00900001
009100*----------------------------------------------------------------*00910001
009200     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19)                     00920001
009300                                    VALUE  'DB2 ACCESS ERROR   '. 00930001
009400     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19)                     00940001
009500                                    VALUE  'UNRECOGNIZED PF KEY'. 00950001
009600     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19)                     00960001
009700                                    VALUE  'ENTER THROUGH MENU '. 00970001
009800     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19)                     00980001
009900                                    VALUE  'TRANS NOT AVAILABLE'. 00990001
010000     05  PC-PLS-ENT-FLD-MSG         PIC X(19)                     01000001
010100                                    VALUE  'PLEASE ENTER FIELD '. 01010001
010200     05  PC-MUST-BE-NUM-MSG         PIC X(19)                     01020001
010300                                    VALUE  'MUST BE NUMERIC    '. 01030001
010400     05  PC-MUST-BE-GT-0-MSG        PIC X(19)                     01040001
010500                                    VALUE  'MUST BE > ZERO     '. 01050001
010600     05  PC-MUST-BE-PBS-MSG         PIC X(19)                     01060001
010700                                    VALUE  'RCVR NOT PK-BY-STR '. 01070001
010800     05  PC-STR-NOT-XCRIBED-MSG     PIC X(19)                     01080001
010900                                    VALUE  'STR NOT TRANSCRIBED'. 01090001
011000     05  PC-CICS-ERR-MSG            PIC X(19)                     01100001
011100                                    VALUE  'CICS ACCESS ERROR  '. 01110001
011200     05  PC-INVALID-TRIP            PIC X(19)                     01120001
011300                                    VALUE  'INVALID TRIP ID    '. 01130001
011400     05  PC-TRIP-NOT-ARRIVED        PIC X(19)                     01140001
011500                                    VALUE  'TRAILER NOT AR     '. 01150001
011600     05  PC-PRT-IND-INVALID         PIC X(19)                     01160001
011700                                    VALUE  'PRNT IND INVALID   '. 01170001
011800     05  PC-PRT-ON-F2               PIC X(19)                     01180001
011900                                    VALUE 'IS PRTR ON? F2-CNFM'.  01190001
012000     05  PC-NOT-AVAILABLE           PIC X(19)                     01200001
012100                                    VALUE 'T - NOT AVAILABLE  '.  01210001
012200     05  PC-INVALID-PRTR-ID         PIC X(19)                     01220001
012300                                    VALUE 'INVALID PRINTER ID '.  01230001
012400     05  PC-INVALID-PRTR-W-BTCH     PIC X(19)                     01240001
012500                                    VALUE 'INVALID PRTR W/BTCH'.  01250001
018600*----------------------------------------------------------------*01860001
018700* PROGRAM SWITCHES                                               *01870001
018800*----------------------------------------------------------------*01880001
018900 01  PS-PROGRAM-SWITCHES.                                         01890001
019000     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01900001
019100         88  PS-VALID-INPUT                          VALUE 'Y'.   01910001
019200         88  PS-INVALID-INPUT                        VALUE 'N'.   01920001
019300     05  PS-TRIP-SW                      PIC  X(01)  VALUE ' '.   01930001
019400         88  PS-VALID-TRIP-ID                        VALUE 'Y'.   01940001
019500         88  PS-TRIP-NOT-ARRIVED                     VALUE 'A'.   01950001
019600         88  PS-INVALID-TRIP                         VALUE 'N'.   01960001
019700     05  PS-PRINTER-ID-SW                PIC  X(01)  VALUE 'Y'.   01970001
019800         88  PS-VALID-PRINTER-ID                     VALUE 'Y'.   01980001
019900         88  PS-INVALID-PRINTER-ID                   VALUE 'N'.   01990001
020000*                                                                 02000001
020100 01  DN-DB2-NULL-INDICATORS.                                      02010001
020200     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   02020001
020300*                                                                 02030001
020400*----------------------------------------------------------------*02040001
020500* PROGRAM VARIABLES                                              *02050001
020600*----------------------------------------------------------------*02060001
020700 01  PV-PROGRAM-VARIABLES.                                        02070001
020800     05  PV-CICS-MSG-AREA.                                        02080001
020900         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 02090001
021000         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 02100001
021100         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 02110001
021200         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 02120001
021300         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 02130001
021400         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 02140001
021500     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 02150001
021600     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 02160001
021700     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  02170001
021800                                                     COMP SYNC.   02180001
021900     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 02190001
022000     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  02200001
022100                                                     COMP SYNC.   02210001
022200     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  02220001
022300                                                     COMP SYNC.   02230001
022400     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  02240001
022500                                                     COMP SYNC.   02250001
022600     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    02260001
022700                                                     COMP SYNC.   02270001
022800     05  PV-RBA                          PIC S9(08)  VALUE +0     02280001
022900                                                     COMP SYNC.   02290001
023000*                                                                 02300001
023100     05  PV-PROGRAM-DATA.                                         02310001
023200         10  PV-MANIFEST.                                         02320001
023300             15  PV-MANIFEST-N           PIC  9(11).              02330001
023400         10  PV-PRINTER-ID.                                       02340001
023500             15  PV-PRINTER-ID-N         PIC  9(03) VALUE ZEROES. 02350001
023600             15  PV-OPER-UNIT            PIC S9(09) VALUE ZEROES. 02360001
023700******************************************************************02370001
023800*  B=BATCH  N=NO  Y=YES                                          *02380028
023900******************************************************************02390001
024000         10  PV-PRINT-IND                PIC  X(01).              02400001
024100             88  PV-VALID-PRINT-IND      VALUE 'B',               02410019
024300                                               'P', 'N', 'Y'.     02430028
024500             88  PV-NO-PRINTER           VALUE 'N'.               02450001
024800             88  PV-BATCH-PRINTER        VALUE 'B'.               02480001
025100             88  PV-YES-PRINTER          VALUE 'Y'.               02510001
025200             88  PV-PRINT-AND-PEEL       VALUE 'P'.               02520007
025300         10 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.  02530001
025400         10 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.      02540001
025500             15 FILLER                   PIC  X(03).              02550001
025600             15 PV-2-DIGIT-DC-ABBR       PIC  X(02).              02560001
025700                                                                  02570001
025800*----------------------------------------------------------------*02580001
025900*  GENERATED DSECT FOR THE SUKM501 MAPSET                         02590001
026000*----------------------------------------------------------------*02600001
026100     COPY SUKM501.                                                02610001
026200                                                                  02620001
026300*----------------------------------------------------------------*02630001
026400*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 02640001
026500*----------------------------------------------------------------*02650001
026600     COPY DPWS010I.                                               02660013
026700                                                                  02670001
026800*----------------------------------------------------------------*02680001
026900*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02690001
027000*----------------------------------------------------------------*02700001
027100     COPY DPWS013.                                                02710013
027200                                                                  02720001
027300*----------------------------------------------------------------*02730001
027400*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02740001
027500*----------------------------------------------------------------*02750001
027600     COPY DPWS015.                                                02760013
027700                                                                  02770001
027800*----------------------------------------------------------------*02780001
027900*  WORKING STORAGE AREA FOR NON-ARCHITECTURE PROGRAMS             02790001
028000*----------------------------------------------------------------*02800001
028100     COPY DPWS026.                                                02810013
028200                                                                  02820001
028300*----------------------------------------------------------------*02830001
028400*  SENDING/RECEIVING AREA FOR THE                                *02840001
028500*  PRINTER VALIDATION ROUTING (DPKCS060)                         *02850001
028600*----------------------------------------------------------------*02860001
028700     COPY DPWS072.                                                02870001
028800                                                                  02880001
028900*----------------------------------------------------------------*02890001
029000*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02900001
029100*----------------------------------------------------------------*02910001
029200     COPY DFHAID.                                                 02920001
029300                                                                  02930001
029400*---------------------------------------------------------------* 02940001
029500*    DB2 AREA FOR THE TRIP STATUS TABLE                         * 02950001
029600*---------------------------------------------------------------* 02960001
029700     EXEC SQL                                                     02970001
029800          INCLUDE TTRIPST                                         02980001
029900     END-EXEC.                                                    02990001
030000                                                                  03000001
030100*---------------------------------------------------------------* 03010001
030200*    DB2 AREA FOR THE TRIP STATUS CODE TABLE                    * 03020001
030300*---------------------------------------------------------------* 03030001
030400     EXEC SQL                                                     03040001
030500          INCLUDE TTRSTYP                                         03050001
030600     END-EXEC.                                                    03060001
030700                                                                  03070001
030800*---------------------------------------------------------------* 03080001
030900*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * 03090001
031000*---------------------------------------------------------------* 03100001
031100     EXEC SQL                                                     03110001
031200          INCLUDE TVHTRIP                                         03120001
031300     END-EXEC.                                                    03130001
031400                                                                  03140001
031500*----------------------------------------------------------------*03150001
031600*  DB2 AREA FOR THE logistics domain location master table       *03160026
031700*----------------------------------------------------------------*03170001
031800     EXEC SQL                                                     03180001
031900         INCLUDE XLT00010                                         03190026
032000     END-EXEC.                                                    03200001
032100                                                                  03210001
032200*----------------------------------------------------------------*03220001
032300*  DB2 AREA FOR THE COMPANY CONTROL TABLE                        *03230001
032400*----------------------------------------------------------------*03240001
032500     EXEC SQL                                                     03250001
032600         INCLUDE TCOCNTL                                          03260001
032700     END-EXEC.                                                    03270001
032800                                                                  03280001
032900*----------------------------------------------------------------*03290011
033000*  DB2 AREA FOR THE PARAMETER TABLE                              *03300011
033100*----------------------------------------------------------------*03310011
033200     EXEC SQL                                                     03320011
033300         INCLUDE TKRPRPM                                          03330011
033400     END-EXEC.                                                    03340011
033500                                                                  03350011
033600*---------------------------------------------------------------* 03360001
033700*  COMMUNICATIONS AREA FOR DB2                                    03370001
033800*---------------------------------------------------------------* 03380001
033900     EXEC SQL                                                     03390001
034000         INCLUDE SQLCA                                            03400001
034100     END-EXEC.                                                    03410001
034200                                                                  03420001
034300***************************************************************** 03430001
034400 LINKAGE SECTION.                                                 03440001
034500******************************************************************03450001
034600*01  DFHCOMMAREA                   PIC  X(300).                   03460003
034700 01  DFHCOMMAREA.                                                 03470004
034800     05  FILLER                       OCCURS 1 TO 4072 TIMES      03480004
034900                                      DEPENDING ON EIBCALEN.      03490004
035000         10  FILLER                   PIC X.                      03500004
035100                                                                  03510004
035200******************************************************************03520001
035300 PROCEDURE DIVISION.                                              03530001
035400******************************************************************03540001
035500 0000-PROGRAM-MAINLINE.                                           03550001
035600                                                                  03560001
035700*LMM                                                              03570004
035800     INITIALIZE CA-COMMAREA                                       03580004
035900     MOVE DFHCOMMAREA TO CA-COMMAREA.                             03590001
036000                                                                  03600001
036100     EXEC CICS                                                    03610001
036200         ASSIGN USERID (SU001-USER-ID)                            03620001
036300                RESP   (PV-CICS-RESPONSE)                         03630001
036400                FACILITY(PV-OPER-UNIT)                            03640001
036500     END-EXEC.                                                    03650001
036600                                                                  03660001
036700     EVALUATE TRUE                                                03670001
036800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03680001
036900             CONTINUE                                             03690001
037000         WHEN OTHER                                               03700001
037100            MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH       03710001
037200            MOVE 'UNABLE TO ASSIGN USER-ID'                       03720001
037300              TO DP013-MESSAGE-TEXT (1)                           03730001
037400            SET DP013-LOGIC-ABEND        TO TRUE                  03740001
037500            SET DP013-NO-ROLLBACK        TO TRUE                  03750001
037600            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                03760001
037700     END-EVALUATE.                                                03770001
037800                                                                  03780001
037810*TCR SET INIT DEFAULT PRINTER OPTION TO 'B' FOR BATCH             03781024
037811     SET PV-BATCH-PRINTER   TO TRUE.                              03781124
037812     MOVE PC-B              TO  APRTINDO                          03781224
037813                                PV-PRINT-IND.                     03781324
037820                                                                  03782024
037900     PERFORM DP026-0000-GET-LOGON-INFO.                           03790001
038000     MOVE DP026-LOCATION-NBR TO  SU001-CURR-OPER-UNT-ID.          03800026
038100*LMM                                                              03810001
038200     PERFORM 7500-GET-SCAC-TRAILER.                               03820001
038300     PERFORM 7000-GET-DC-LOCATION.                                03830001
038400     PERFORM 7010-LABEL-SCAN-PRINT.                               03840001
038500                                                                  03850001
038600                                                                  03860001
038700     EVALUATE TRUE                                                03870001
038800         WHEN EIBCALEN = ZERO                                     03880001
038900             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    03890001
039000             PERFORM 8300-RETURN                                  03900001
039100                                                                  03910001
039200         WHEN SU001-INITIALIZE-SCREEN                             03920014
039300         WHEN EIBAID = DFHCLEAR                                   03930014
039400              SET SU001-PROCESS-SCREEN TO TRUE                    03940014
039500              SET SU001-TRIP-NOT-CONFIRMED TO TRUE                03950014
039600              PERFORM 1000-INITIALIZE                             03960014
039700              PERFORM 8000-SEND-MAP                               03970014
039800              PERFORM 8200-RETURN-TRANID                          03980014
039900                                                                  03990014
040000         WHEN EIBAID = DFHPF3                                     04000001
040100              MOVE SPACES         TO SU001-TURN-PRINTER-ON-IND    04010001
040300              MOVE PC-TRIP-START-PGM TO PV-TRANSFER-PROGRAM       04030001
040400              PERFORM 4000-XCTL-LRT-MENU                          04040001
040500                                                                  04050001
040600         WHEN EIBAID = DFHPF2 AND                                 04060001
040700              SU001-TURN-PRINTER-ON                               04070001
040800              MOVE SPACES         TO SU001-TURN-PRINTER-ON-IND    04080001
042000              MOVE PC-SU-SHIP-CODE-PGM                            04200001
042100                                   TO PV-TRANSFER-PROGRAM         04210001
042200              PERFORM 4000-XCTL-LRT-MENU                          04220001
042300                                                                  04230001
042400         WHEN SU001-TURN-PRINTER-ON                               04240001
042500              PERFORM 8100-SEND-DATA-ONLY                         04250001
042600              PERFORM 8200-RETURN-TRANID                          04260001
042700                                                                  04270001
042800         WHEN EIBAID = DFHENTER                                   04280001
042900              SET PS-VALID-INPUT TO TRUE                          04290001
043000              PERFORM 2000-PROCESS-SCREEN-FIELDS                  04300001
043100                                                                  04310001
043200              IF  PS-VALID-INPUT                                  04320001
043300                  IF  PV-YES-PRINTER                              04330017
043600                          SET  SU001-TURN-PRINTER-ON TO TRUE      04360001
043700                          MOVE DP015-PRO-NOR-OFF  TO APRTINDA     04370001
043900                          MOVE PC-PRT-ON-F2       TO AMSGLNO      04390001
044000                          PERFORM 8100-SEND-DATA-ONLY             04400001
044100                          PERFORM 8200-RETURN-TRANID              04410001
044200                  END-IF                                          04420001
044300                  MOVE ZEROES           TO SU001-BATCH-NUMBER     04430001
044400*gb 4/21/02 beg                                                   04440009
044500                  IF  PV-PRINT-AND-PEEL                           04450009
044600                      PERFORM 7020-PRINT-PEEL-LABEL-SCAN          04460010
044700                  END-IF                                          04470009
044800*gb 4/21/02 beg                                                   04480009
044900                  MOVE PC-SU-SHIP-CODE-PGM                        04490001
045000                                        TO PV-TRANSFER-PROGRAM    04500001
045100                  PERFORM 4000-XCTL-LRT-MENU                      04510001
045200              ELSE                                                04520001
045300                  PERFORM 8100-SEND-DATA-ONLY                     04530001
045400                  PERFORM 8200-RETURN-TRANID                      04540001
045500              END-IF                                              04550001
045600                                                                  04560001
045700         WHEN OTHER                                               04570001
045800              MOVE -1                         TO APRTIDL          04580021
045900              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          04590001
046000              PERFORM 8100-SEND-DATA-ONLY                         04600001
046100              PERFORM 8200-RETURN-TRANID                          04610001
046200     END-EVALUATE.                                                04620001
046300                                                                  04630001
046400     GOBACK.                                                      04640001
046500                                                                  04650001
046600*                                                                 04660001
046700 1000-INITIALIZE.                                                 04670001
046800                                                                  04680001
046900     MOVE -1                          TO APRTIDL                  04690021
047000     IF  SU001-LAST-PROGRAM = PC-SU-MENU-PGM OR                   04700001
047100         SU001-LAST-PROGRAM = PC-TRIP-START-PGM OR                04710001
047200         SU001-LAST-PROGRAM = PC-TRAILER-STOP-PGM                 04720001
047300             INITIALIZE PV-PROGRAM-DATA                           04730001
047501             SET PV-BATCH-PRINTER   TO TRUE                       04750123
047510             MOVE PC-B              TO  APRTINDO                  04751017
047520                                        PV-PRINT-IND              04752023
047600             MOVE ZEROES            TO  APRTIDO                   04760001
047700             MOVE -1                TO  APRTIDL                   04770021
047800     ELSE                                                         04780001
048200                                                                  04820001
048400             MOVE PV-PRINTER-ID-N    TO  APRTIDO                  04840001
048500             MOVE PV-PRINTER-ID-N    TO  SU001-PRINTER-ID         04850001
048600             MOVE PV-PRINTER-ID-N    TO  SU001-PRINTER-ID-USE     04860001
048700     END-IF.                                                      04870001
048800*                                                                 04880001
048900*                                                                 04890001
049000 2000-PROCESS-SCREEN-FIELDS.                                      04900001
049100     PERFORM 2100-RECEIVE-MAP.                                    04910001
049200     PERFORM 2200-EDIT-INPUT.                                     04920001
049300                                                                  04930001
049400*                                                                 04940001
049500 2100-RECEIVE-MAP.                                                04950001
049600                                                                  04960001
049700     EXEC CICS                                                    04970001
049800         RECEIVE MAP    ('SU501A')                                04980001
049900                 MAPSET ('SUKM501')                               04990001
050000                 RESP   (PV-CICS-RESPONSE)                        05000001
050100     END-EXEC.                                                    05010001
050200                                                                  05020001
050300     EVALUATE TRUE                                                05030001
050400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05040001
050500             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   05050001
050600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                05060001
050700             CONTINUE                                             05070001
050800         WHEN OTHER                                               05080001
050900            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       05090001
051000            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)05100001
051100            SET DP013-LOGIC-ABEND        TO TRUE                  05110001
051200            SET DP013-NO-ROLLBACK        TO TRUE                  05120001
051300            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                05130001
051400     END-EVALUATE.                                                05140001
051500                                                                  05150001
051600*                                                                 05160001
051700 2110-RECEIVE-SCREEN-FIELDS.                                      05170001
051800                                                                  05180001
051900     IF  APRTINDL > ZERO                                          05190001
052000         MOVE APRTINDI TO PV-PRINT-IND                            05200001
052100     ELSE                                                         05210001
052200         IF APRTINDA = DP015-ERASE-EOF                            05220001
052300             MOVE SPACES TO PV-PRINT-IND                          05230001
052400         END-IF                                                   05240001
052500     END-IF.                                                      05250001
052600                                                                  05260001
053500     IF  APRTIDL > ZERO                                           05350001
053600         MOVE APRTIDI TO PV-PRINTER-ID                            05360001
053700     ELSE                                                         05370001
053800         IF APRTIDA = DP015-ERASE-EOF                             05380001
053900             MOVE SPACES TO PV-PRINTER-ID                         05390001
054000         END-IF                                                   05400001
054100     END-IF.                                                      05410001
054200                                                                  05420001
054300*                                                                 05430001
054400 2200-EDIT-INPUT.                                                 05440001
054500                                                                  05450001
054700     PERFORM 2230-EDIT-PRINT-IND.                                 05470001
054800     IF  PV-NO-PRINTER                                            05480001
054900         CONTINUE                                                 05490001
055000     ELSE                                                         05500001
055100         PERFORM 2260-EDIT-PRINTER-ID                             05510001
055200     END-IF.                                                      05520001
055300                                                                  05530001
055400*                                                                 05540001
055500 2230-EDIT-PRINT-IND.                                             05550001
055600     IF  PV-VALID-PRINT-IND                                       05560001
055700         MOVE PV-PRINT-IND           TO SU001-PRINTER-IND         05570001
055800     ELSE                                                         05580001
055900         SET PS-INVALID-INPUT        TO TRUE                      05590001
056000         MOVE DP015-UNP-ALP-BRT-MDT  TO APRTINDA                  05600001
056100         MOVE -1                     TO APRTINDL                  05610025
056200         MOVE PC-PRT-IND-INVALID     TO AMSGLNO                   05620001
056300     END-IF.                                                      05630001
057100                                                                  05710001
057200                                                                  05720001
064300******************************************************************06430001
064400*  VALIDATE PRINTER ID - MUST BE NUMERIC                         *06440001
064500*  IF PRINT OPTION = B (BATCH) VALIDATE PRINTER ID               *06450001
064600******************************************************************06460001
064700 2260-EDIT-PRINTER-ID.                                            06470001
064800                                                                  06480001
064900     EVALUATE TRUE                                                06490001
065000         WHEN PV-PRINTER-ID = SPACES                              06500001
065100             SET PS-INVALID-INPUT        TO TRUE                  06510001
065200             MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA               06520001
065300             MOVE -1                     TO APRTIDL               06530001
065400             MOVE PC-INVALID-PRTR-ID     TO AMSGLNO               06540001
065500         WHEN OTHER                                               06550001
065600             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              06560001
065700             MOVE PV-PRINTER-ID  TO  DP010I-UNEDITED-FIELD        06570001
065800             MOVE 03             TO  DP010I-MAXIMUM-DIGITS        06580001
065900             MOVE 0              TO  DP010I-MAXIMUM-DECIMALS      06590001
066000                                                                  06600001
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     06611029
263968                  USING DP010I-NUMERIC-EDIT-AREA                  06612029
066200                                                                  06620001
066300             IF  DP010I-ERROR-DETECTED                            06630001
066400                 SET PS-INVALID-INPUT        TO TRUE              06640001
066500                 MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA           06650001
066600                 MOVE -1                     TO APRTIDL           06660001
066700                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           06670001
066800             ELSE                                                 06680001
066900                 IF  DP010I-NUMERIC-FIELD = ZEROES                06690001
067000                     IF  PV-NO-PRINTER                            06700001
067100                         MOVE  ZEROES  TO SU001-PRINTER-ID        06710001
067200                     ELSE                                         06720001
067300                         SET PS-INVALID-INPUT        TO TRUE      06730001
067400                         MOVE DP015-UNP-NUM-BRT-MDT  TO APRTIDA   06740001
067500                         MOVE -1                     TO APRTIDL   06750001
067600                         MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO   06760001
067700                     END-IF                                       06770001
067800                 ELSE                                             06780001
067900                     IF  PV-BATCH-PRINTER  OR                     06790001
068000                         PV-PRINT-AND-PEEL                        06800007
068200                         PERFORM 2270-VALIDATE-PRINTER-ID         06820001
068300                         IF  PS-INVALID-PRINTER-ID                06830001
068400                             SET PS-INVALID-INPUT TO TRUE         06840001
068500                             MOVE DP015-UNP-NUM-BRT-MDT           06850001
068600                                                     TO APRTIDA   06860001
068700                             MOVE -1                 TO APRTIDL   06870001
068800                             MOVE PC-INVALID-PRTR-ID TO AMSGLNO   06880001
068900                         ELSE                                     06890001
069000                             IF  PV-BATCH-PRINTER  AND            06900001
069100                                 DP072-PRTR-INTFC-FTP             06910001
069200                                 SET PS-INVALID-INPUT TO TRUE     06920001
069300                                 MOVE DP015-UNP-NUM-BRT-MDT       06930001
069400                                                     TO APRTIDA   06940001
069500                                 MOVE -1             TO APRTIDL   06950001
069600                                 MOVE PC-INVALID-PRTR-W-BTCH      06960001
069700                                                     TO AMSGLNO   06970001
069800                             ELSE                                 06980001
069900                                 MOVE  PV-PRINTER-ID-N            06990001
070000                                   TO  SU001-PRINTER-ID           07000001
070100                         END-IF                                   07010001
070200                     ELSE                                         07020001
070300                         MOVE  PV-PRINTER-ID-N                    07030001
070400                               TO  SU001-PRINTER-ID               07040001
070500                         MOVE  PV-PRINTER-ID-N                    07050001
070600                               TO  SU001-PRINTER-ID-USE           07060001
070700                     END-IF                                       07070001
070800                 END-IF                                           07080001
070900             END-IF                                               07090001
071000     END-EVALUATE.                                                07100001
071100                                                                  07110001
071200                                                                  07120001
071300******************************************************************07130001
071400* VALIDATE PRINTER ID                                            *07140001
071500******************************************************************07150001
071600 2270-VALIDATE-PRINTER-ID.                                        07160001
071700     IF PV-PRINT-AND-PEEL                                         07170008
071800        MOVE PC-REPORT-PGM-2  TO  DP072-RPT-PGM-NME               07180008
071900     ELSE                                                         07190008
072000        MOVE PC-REPORT-PGM-1  TO  DP072-RPT-PGM-NME               07200008
072100     END-IF                                                       07210008
072200                                                                  07220008
072300     MOVE PV-PRINTER-ID    TO  DP072-PRINTER-ID.                  07230008
072400     MOVE PC-01            TO  DP072-RPT-PGM-TYP-ID.              07240001
072500     MOVE DP026-LOCATION-NBR                                      07250026
072510                           TO  DP072-ORIGIN-OPER-UNT-ID           07251026
072610                               DP072-OPER-UNT-ID.                 07261026
072700     MOVE 1                TO  DP072-ORIGIN-FCLTY-ID              07270001
072800                               DP072-FCLTY-ID.                    07280001
072900     SET DP072-VALIDATE    TO  TRUE.                              07290001
073000                                                                  07300001
073100     EXEC CICS                                                    07310001
073200          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  07320001
073300               COMMAREA (DP072-COMM-AREA)                         07330001
073400               RESP     (PV-CICS-RESPONSE)                        07340001
073500     END-EXEC                                                     07350001
073600                                                                  07360001
073700     EVALUATE TRUE                                                07370001
073800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07380001
073900              PERFORM 2275-VALIDATE-PRINTER-SML                   07390001
074000         WHEN OTHER                                               07400001
074100             SET PS-INVALID-PRINTER-ID  TO  TRUE                  07410001
074200     END-EVALUATE.                                                07420001
074300                                                                  07430001
074400                                                                  07440001
074500******************************************************************07450001
074600*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *07460001
074700*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *07470001
074800*  CAN BE PRINTED ON THIS PRINTER.                               *07480001
074900******************************************************************07490001
075000 2275-VALIDATE-PRINTER-SML.                                       07500001
075100                                                                  07510001
075200     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               07520001
075300         SET  PS-INVALID-PRINTER-ID   TO TRUE                     07530001
075400     END-IF.                                                      07540001
075500                                                                  07550001
075600     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  07560001
075700         CONTINUE                                                 07570001
075800     ELSE                                                         07580001
075900         SET  PS-INVALID-PRINTER-ID   TO TRUE                     07590001
076000     END-IF.                                                      07600001
083400                                                                  08340028
083500                                                                  08350028
083600*----------------------------------------------------------------*08360001
083700*  UPDATE THE TRIP STATUS                                        *08370001
083800*----------------------------------------------------------------*08380001
083900 3100-START-UNLOAD.                                               08390001
084000                                                                  08400001
084100     EXEC SQL                                                     08410001
084200         INSERT  INTO TTRIPST                                     08420001
084300                (TRIP_ID                                          08430001
084400                ,TRIP_STATUS_CDE                                  08440001
084500                ,STATUS_DTE                                       08450001
084600                ,STATUS_TME                                       08460001
084700                ,STATUS_UID                                       08470001
084800                ,OPER_UNT_ID                                      08480001
084900                ,FCLTY_ID                                         08490001
085000                ,FCLTY_AREA_ID)                                   08500001
085100        VALUES  (:TRIPST-TRIP-ID                                  08510001
085200                ,:TRIPST-TRIP-STATUS-CDE                          08520001
085300                ,CURRENT DATE                                     08530001
085400                ,CURRENT TIME                                     08540001
085500                ,:SU001-USER-ID                                   08550001
085600                ,:TRIPST-OPER-UNT-ID                              08560001
085700                ,:TRIPST-FCLTY-ID                                 08570001
085800                ,:TRIPST-FCLTY-AREA-ID)                           08580001
085900     END-EXEC.                                                    08590001
086000                                                                  08600001
086100     EVALUATE TRUE                                                08610001
086200         WHEN SQLCODE = +0                                        08620001
086300             CONTINUE                                             08630001
086400                                                                  08640001
086500         WHEN SQLWARN0 NOT = SPACES                               08650001
086600         WHEN SQLCODE < +0                                        08660001
086700         WHEN SQLCODE > +0                                        08670001
086800             MOVE '3100-START-UNLOAD'                             08680001
086900                               TO DP013-PARAGRAPH                 08690001
087000             MOVE 'INSERT ON TTRIPST'                             08700001
087100                               TO DP013-MESSAGE-TEXT(1)           08710001
087200             MOVE TRIPST-TRIP-ID                                  08720001
087300                               TO DP013-MESSAGE-TEXT(2)           08730001
087400             MOVE SQLCA        TO DP013-SQLCA                     08740001
087500             MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)        08750001
087600             SET DP013-DB2-ABEND                                  08760001
087700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               08770001
087800             PERFORM DP014-0000-PROCESS-ABEND                     08780001
087900     END-EVALUATE.                                                08790001
088000                                                                  08800001
088100*                                                                 08810001
088200 4000-XCTL-LRT-MENU.                                              08820001
088300     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     08830001
088400     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          08840001
088500*LMM                                                              08850004
088600     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           08860004
088700     EXEC CICS                                                    08870001
088800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    08880001
088900               COMMAREA  (CA-COMMAREA)                            08890001
089100               LENGTH    (PV-COMMAREA-LENGTH)                     08910004
089200               RESP      (PV-CICS-RESPONSE)                       08920001
089300     END-EXEC.                                                    08930001
089400                                                                  08940001
089500     EVALUATE TRUE                                                08950001
089600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08960001
089700             CONTINUE                                             08970001
089800         WHEN OTHER                                               08980001
089900             MOVE '4000-XCTL-TO-LRT-MENU'                         08990001
090000                 TO DP013-PARAGRAPH                               09000001
090100             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   09010001
090200                 TO DP013-MESSAGE-TEXT (1)                        09020001
090300             MOVE PV-TRANSFER-PROGRAM                             09030001
090400                 TO DP013-MESSAGE-TEXT (2)                        09040001
090500             SET DP013-CICS-ABEND  TO TRUE                        09050001
090600             SET DP013-NO-ROLLBACK TO TRUE                        09060001
090700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09070001
090800             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             09080001
090900             SET SU001-PROCESS-SCREEN TO TRUE                     09090001
091000             PERFORM 8000-SEND-MAP                                09100001
091100             PERFORM 8200-RETURN-TRANID                           09110001
091200     END-EVALUATE.                                                09120001
091300                                                                  09130001
093300 5050-RECEIVE.                                                    09330001
093400     EXEC CICS                                                    09340001
093500      RECEIVE INTO    (PV-RECEIVE-DATA)                           09350001
093600              LENGTH  (PC-RECEIVE-LENGTH)                         09360001
093700              RESP    (PV-CICS-RESPONSE)                          09370001
093800     END-EXEC.                                                    09380001
093900                                                                  09390001
094000     EVALUATE TRUE                                                09400001
094100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09410001
094200         WHEN PV-CICS-RESPONSE = DFHRESP (EOC)                    09420001
094300             CONTINUE                                             09430001
094400         WHEN OTHER                                               09440001
094500             MOVE '5050-RECEIVE         ' TO DP013-PARAGRAPH      09450001
094600             MOVE 'BAD RECEIVE        ' TO DP013-MESSAGE-TEXT (1) 09460001
094700             MOVE PV-RECEIVE-DATA       TO DP013-MESSAGE-TEXT (2) 09470001
094800             SET DP013-CICS-ABEND       TO TRUE                   09480001
094900             SET DP013-NO-ROLLBACK      TO TRUE                   09490001
095000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09500001
095100     END-EVALUATE.                                                09510001
095200                                                                  09520001
103800*----------------------------------------------------------------*10380001
103900*                                                                *10390001
104000*----------------------------------------------------------------*10400001
104100 7000-GET-DC-LOCATION.                                            10410001
104200                                                                  10420001
104300     MOVE  SPACES                    TO  SU001-DC-PRTD-AT-CDE.    10430001
104400     MOVE  SU001-CURR-OPER-UNT-ID    TO  DK-CURR-OPER-UNT-ID.     10440001
104500                                                                  10450001
104600     EXEC SQL                                                     10460001
104700          SELECT LOC_5_ABBR_NM                                    10470026
104800          INTO  :PV-DC-5-CHAR-ABBR                                10480001
104900          FROM   XLT_LOC                                          10490026
105000          WHERE  LOC_TYP_CDE = 'DC'                               10500026
105100          AND    LOC_NBR   = :DK-CURR-OPER-UNT-ID                 10510026
105200     END-EXEC.                                                    10520001
105300                                                                  10530001
105400     EVALUATE TRUE                                                10540001
105500         WHEN SQLCODE = ZERO                                      10550001
105600              MOVE  PV-2-DIGIT-DC-ABBR  TO  SU001-DC-PRTD-AT-CDE  10560001
105700                                                                  10570001
105800         WHEN SQLCODE = +100                                      10580001
105900              MOVE  PC-90   TO  SU001-DC-PRTD-AT-CDE              10590001
106000                                                                  10600001
106100         WHEN SQLWARN0 NOT = SPACES                               10610001
106200         WHEN SQLCODE NOT EQUAL ZERO                              10620001
106300             MOVE '7000-GET-DC-LOCATION'                          10630001
106400                             TO DP013-PARAGRAPH                   10640001
106500             MOVE 'SUKRF501 - GET DC LOCATION CODE'               10650001
106600                             TO DP013-MESSAGE-TEXT(1)             10660001
106700             MOVE SU001-CURR-OPER-UNT-ID                          10670001
106800                             TO DP013-MESSAGE-TEXT(2)             10680001
106900             MOVE SQLCA      TO DP013-SQLCA                       10690001
107000             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           10700026
107100             SET DP013-DB2-ABEND                                  10710001
107200                             TO TRUE                              10720001
107300             SET DP013-NO-ROLLBACK                                10730001
107400                             TO TRUE                              10740001
107500             SET DP013-XCTL-DISPLAY-RESTART                       10750001
107600                             TO TRUE                              10760001
107700             PERFORM DP014-0000-PROCESS-ABEND                     10770001
107800     END-EVALUATE.                                                10780001
107900                                                                  10790001
108000                                                                  10800001
108100*----------------------------------------------------------------*10810001
108200* GET THE DEFAULT NUMBER FOR WHEN TO PRINT LABELS                *10820001
108300*----------------------------------------------------------------*10830001
108400 7010-LABEL-SCAN-PRINT.                                           10840001
108500                                                                  10850001
108600     MOVE  ZEROES                  TO  SU001-PRT-LBL-ON-SCN-CNT.  10860001
108700     MOVE  SU001-CURR-OPER-UNT-ID  TO  DK-CURR-OPER-UNT-ID.       10870001
108800                                                                  10880001
108900     INITIALIZE DCLTCOCNTL.                                       10890001
109000                                                                  10900001
109100     EXEC SQL                                                     10910001
109200         SELECT  PRT_LBL_ON_SCN_CNT                               10920001
109300           INTO  :COCNTL-PRT-LBL-ON-SCN-CNT                       10930001
109400           FROM  TCOCNTL                                          10940001
109500          WHERE  OPER_UNT_ID = :DK-CURR-OPER-UNT-ID               10950001
109600            AND  FCLTY_ID    = :DK-FCLTY-ID                       10960001
109700     END-EXEC.                                                    10970001
109800                                                                  10980001
109900     EVALUATE TRUE                                                10990001
110000         WHEN SQLCODE = ZERO                                      11000001
110100              MOVE  COCNTL-PRT-LBL-ON-SCN-CNT                     11010001
110200                TO  SU001-PRT-LBL-ON-SCN-CNT                      11020001
110300                                                                  11030001
110400         WHEN SQLWARN0 NOT = SPACES                               11040001
110500         WHEN SQLCODE NOT EQUAL ZERO                              11050001
110600             MOVE '7010-LABEL-SCAN-PRINT'                         11060001
110700                             TO DP013-PARAGRAPH                   11070001
110800             MOVE 'SUKRF501 - GET DC LABEL SCAN PRINT AMOUNT'     11080001
110900                             TO DP013-MESSAGE-TEXT(1)             11090001
111000             MOVE SU001-CURR-OPER-UNT-ID                          11100001
111100                             TO DP013-MESSAGE-TEXT(2)             11110001
111200             MOVE SQLCA      TO DP013-SQLCA                       11120001
111300             MOVE 'TCOCNTL'  TO DP013-DB2-TABLE-NAME(1)           11130001
111400             SET DP013-DB2-ABEND                                  11140001
111500                             TO TRUE                              11150001
111600             SET DP013-NO-ROLLBACK                                11160001
111700                             TO TRUE                              11170001
111800             SET DP013-XCTL-DISPLAY-RESTART                       11180001
111900                             TO TRUE                              11190001
112000             PERFORM DP014-0000-PROCESS-ABEND                     11200001
112100     END-EVALUATE.                                                11210001
112200                                                                  11220001
112300*----------------------------------------------------------------*11230010
112400* GET THE DEFAULT NUMBER FOR WHEN TO PRINT LABELS                *11240010
112500*----------------------------------------------------------------*11250010
112600 7020-PRINT-PEEL-LABEL-SCAN.                                      11260010
112700     MOVE ZEROES                   TO  SU001-PRT-LBL-ON-SCN-CNT.  11270012
112800     MOVE  SU001-CURR-OPER-UNT-ID  TO  DK-CURR-OPER-UNT-ID.       11280010
112900                                                                  11290010
113000     INITIALIZE DCLTKRPRPM.                                       11300010
113100                                                                  11310010
113200     EXEC SQL                                                     11320010
113300         SELECT  FUNC_QTY                                         11330010
113400           INTO  :KRPRPM-FUNC-QTY                                 11340010
113500           FROM  TKRPRPM                                          11350010
113600          WHERE  LOC_ID             = :DK-CURR-OPER-UNT-ID        11360010
113700            AND  SYS_PRC_FUNC_CDE   = 'PAPQTY'                    11370010
113800     END-EXEC.                                                    11380010
113900                                                                  11390010
114000     EVALUATE TRUE                                                11400010
114100         WHEN SQLCODE = ZERO                                      11410010
114200              MOVE  KRPRPM-FUNC-QTY                               11420010
114300                TO  SU001-PRT-LBL-ON-SCN-CNT                      11430010
114400         WHEN SQLCODE = +100                                      11440010
114500              MOVE  +1                                            11450010
114600                TO  SU001-PRT-LBL-ON-SCN-CNT                      11460010
114700         WHEN SQLWARN0 NOT = SPACES                               11470010
114800         WHEN SQLCODE NOT EQUAL ZERO                              11480010
114900             MOVE '7020-PRINT-PEEL-LABEL-SCAN'                    11490010
115000                             TO DP013-PARAGRAPH                   11500010
115100             MOVE 'SUKRF501 - GET DC LABEL SCAN PRINT AMOUNT'     11510010
115200                             TO DP013-MESSAGE-TEXT(1)             11520010
115300             MOVE SU001-CURR-OPER-UNT-ID                          11530010
115400                             TO DP013-MESSAGE-TEXT(2)             11540010
115500             MOVE SQLCA      TO DP013-SQLCA                       11550010
115600             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           11560010
115700             SET DP013-DB2-ABEND                                  11570010
115800                             TO TRUE                              11580010
115900             SET DP013-NO-ROLLBACK                                11590010
116000                             TO TRUE                              11600010
116100             SET DP013-XCTL-DISPLAY-RESTART                       11610010
116200                             TO TRUE                              11620010
116300             PERFORM DP014-0000-PROCESS-ABEND                     11630010
116400     END-EVALUATE.                                                11640010
116500                                                                  11650010
116600*----------------------------------------------------------------*11660001
116700* GET SCAC AND TRAILER OF TRIP ID ENTERED ON SUKRF529 SCREEN     *11670001
116800*----------------------------------------------------------------*11680001
116900 7500-GET-SCAC-TRAILER.                                           11690001
117000     MOVE SU001-MANIFEST TO DK-TRIP-ID                            11700001
117100                                                                  11710001
117200     EXEC SQL                                                     11720001
117300         SELECT  OWNER_SCAC_ID                                    11730001
117400              ,  VEH_NBR                                          11740001
117500           INTO  :VHTRIP-OWNER-SCAC-ID                            11750001
117600              ,  :VHTRIP-VEH-NBR :DN-VEH-NBR                      11760001
117700           FROM  TVHTRIP                                          11770001
117800          WHERE  TRIP_ID     = :DK-TRIP-ID                        11780001
117900     END-EXEC.                                                    11790001
118000                                                                  11800001
118100     EVALUATE TRUE                                                11810001
118200         WHEN SQLCODE = ZERO                                      11820001
118300            IF DN-VEH-NBR = -1                                    11830001
118400               MOVE SPACES       TO VHTRIP-VEH-NBR                11840001
118500            END-IF                                                11850001
118600            MOVE VHTRIP-OWNER-SCAC-ID TO ASCACIDO                 11860001
118700                                         SU001-OWNER-SCAC-ID      11870013
118800            MOVE VHTRIP-VEH-NBR       TO ATRLRO                   11880001
118900                                         SU001-VEH-NBR            11890013
119000         WHEN SQLCODE = +100                                      11900001
119100              CONTINUE                                            11910001
119200         WHEN SQLWARN0 NOT = SPACES                               11920001
119300         WHEN SQLCODE NOT EQUAL ZERO                              11930001
119400             MOVE '7500-GET-SCAC-TRAILER'                         11940001
119500                             TO DP013-PARAGRAPH                   11950001
119600             MOVE 'SUKRF501 - GET SCAC-TRAILER'                   11960001
119700                             TO DP013-MESSAGE-TEXT(1)             11970001
119800             MOVE SU001-MANIFEST                                  11980001
119900                             TO DP013-MESSAGE-TEXT(2)             11990001
120000             MOVE SQLCA      TO DP013-SQLCA                       12000001
120100             MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME(1)           12010001
120200             SET DP013-DB2-ABEND                                  12020001
120300                             TO TRUE                              12030001
120400             SET DP013-NO-ROLLBACK                                12040001
120500                             TO TRUE                              12050001
120600             SET DP013-XCTL-DISPLAY-RESTART                       12060001
120700                             TO TRUE                              12070001
120800             PERFORM DP014-0000-PROCESS-ABEND                     12080001
120900     END-EVALUATE.                                                12090001
121000                                                                  12100001
121100*----------------------------------------------------------------*12110001
121200*                                                                *12120001
121300*----------------------------------------------------------------*12130001
121400                                                                  12140001
121500 8000-SEND-MAP.                                                   12150001
121600                                                                  12160001
121700     EXEC CICS                                                    12170001
121800         SEND MAP       ('SU501A')                                12180001
121900              MAPSET    ('SUKM501')                               12190001
122000              ERASE                                               12200001
122100              CURSOR                                              12210001
122200              RESP      (PV-CICS-RESPONSE)                        12220001
122300     END-EXEC.                                                    12230001
122400                                                                  12240001
122500     EVALUATE TRUE                                                12250001
122600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12260001
122700             CONTINUE                                             12270001
122800         WHEN OTHER                                               12280001
122900             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         12290001
123000             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  12300001
123100             SET DP013-CICS-ABEND      TO TRUE                    12310001
123200             SET DP013-NO-ROLLBACK     TO TRUE                    12320001
123300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               12330001
123400     END-EVALUATE.                                                12340001
123500                                                                  12350001
123600*                                                                 12360001
123700 8100-SEND-DATA-ONLY.                                             12370001
123800                                                                  12380001
123900     EXEC CICS                                                    12390001
124000         SEND MAP       ('SU501A')                                12400001
124100              MAPSET    ('SUKM501')                               12410001
124200              CURSOR                                              12420001
124300              DATAONLY                                            12430001
124400              RESP      (PV-CICS-RESPONSE)                        12440001
124500     END-EXEC.                                                    12450001
124600                                                                  12460001
124700     EVALUATE TRUE                                                12470001
124800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12480001
124900             CONTINUE                                             12490001
125000         WHEN OTHER                                               12500001
125100             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        12510001
125200             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 12520001
125300             SET DP013-CICS-ABEND       TO TRUE                   12530001
125400             SET DP013-NO-ROLLBACK      TO TRUE                   12540001
125500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               12550001
125600     END-EVALUATE.                                                12560001
125700                                                                  12570001
125800*                                                                 12580001
125900 8200-RETURN-TRANID.                                              12590001
126000*LMM                                                              12600004
126100     MOVE LENGTH OF CA-COMMAREA      TO PV-COMMAREA-LENGTH        12610004
126200     EXEC CICS                                                    12620001
126300         RETURN TRANSID  (PC-TRANID)                              12630001
126400                COMMAREA (CA-COMMAREA)                            12640001
126500*LMM            LENGTH   (PC-COMMAREA-LENGTH)                     12650004
126600                LENGTH   (PV-COMMAREA-LENGTH)                     12660004
126700                RESP     (PV-CICS-RESPONSE)                       12670001
126800     END-EXEC.                                                    12680001
126900                                                                  12690001
127000     EVALUATE TRUE                                                12700001
127100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12710001
127200             CONTINUE                                             12720001
127300         WHEN OTHER                                               12730001
127400             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        12740001
127500             MOVE 'UNABLE TO RETURN TO TRANID'                    12750001
127600                 TO DP013-MESSAGE-TEXT (1)                        12760001
127700             SET DP013-CICS-ABEND       TO TRUE                   12770001
127800             SET DP013-NO-ROLLBACK      TO TRUE                   12780001
127900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               12790001
128000     END-EVALUATE.                                                12800001
128100                                                                  12810001
128200*                                                                 12820001
128300 8300-RETURN.                                                     12830001
128400                                                                  12840001
128500     EXEC CICS                                                    12850001
128600         SEND FROM (PV-MESSAGE-AREA)                              12860001
128700              LENGTH (19)                                         12870001
128800              ERASE                                               12880001
128900     END-EXEC.                                                    12890001
129000                                                                  12900001
129100     EXEC CICS                                                    12910001
129200         RETURN                                                   12920001
129300     END-EXEC.                                                    12930001
129400                                                                  12940001
129500*                                                                 12950001
129600 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  12960001
129700                                                                  12970001
129800     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              12980001
129900     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             12990001
130000     INITIALIZE DP013-SRC-TASK-NUMBER                             13000001
130100                DP013-STACK.                                      13010001
130200     SET DP013-LINK-RETURN TO TRUE.                               13020001
130300                                                                  13030001
130400     EXEC CICS                                                    13040001
130500         LINK                                                     13050001
130600             PROGRAM   (DP013-NAME)                               13060001
130700             COMMAREA  (DP013-PARAMETERS)                         13070001
130800             LENGTH    (DP013-LENGTH)                             13080001
130900     END-EXEC.                                                    13090001
131000                                                                  13100001
131100*                                                                 13110001
131200*----------------------------------------------------------------*13120001
131300*    GET LOGON INFORMATION FOR NON-ARCHITECTURE PROGRAMS         *13130001
131400*----------------------------------------------------------------*13140001
131500                                                                  13150001
131600     COPY DPPD026.                                                13160013
131700                                                                  13170001
131800*                                                                 13180001
131900*----------------------------------------------------------------*13190001
132000*    ABEND PROCESSOR MODULE                                      *13200001
132100*----------------------------------------------------------------*13210001
132200                                                                  13220001
132300     COPY DPPD014.                                                13230013
132400                                                                  13240001
