000100****************************************************************  00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300****************************************************************  00030000
000400 PROGRAM-ID.    PCKUT001.                                         00040000
000500 AUTHOR.        WILLIAM B. BURT.                                  00050000
000600 DATE-WRITTEN.  MAY, 1994.                                        00060000
000700                                                                  00070000
000800****************************************************************  00080000
000900*   THIS PROGRAM EXTRACTS RECEIVER INFORMATION FOR RECEIVERS      00090000
001000*   THAT ARE CURRENTLY IN-PROCESS.  THIS INFORMATION WILL BE      00100000
001100*   USED TO CREATE THE "PROCESS AREA CURRENT ON HAND REPORT".     00110000
001200****************************************************************  00120000
001300                                                                  00130000
001400****************************************************************  00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600****************************************************************  00160000
001700                                                                  00170000
001800****************************************************************  00180000
001900 INPUT-OUTPUT SECTION.                                            00190000
002000****************************************************************  00200000
002100                                                                  00210000
002200****************************************************************  00220000
002300 FILE-CONTROL.                                                    00230000
002400****************************************************************  00240000
002500     SELECT EXTRACT-FILE                                          00250000
002600         ASSIGN TO OUT01.                                         00260000
002700                                                                  00270000
002800     SELECT OLD-RECEIVERS-FILE                                    00280000
002900         ASSIGN TO OUT02.                                         00290000
003000                                                                  00300000
003100     SELECT IP-EXTRACT-FILE                                       00310000
003200         ASSIGN TO OUT03.                                         00320000
003300                                                                  00330000
003400****************************************************************  00340000
003500 DATA DIVISION.                                                   00350000
003600****************************************************************  00360000
003700                                                                  00370000
003800****************************************************************  00380000
003900 FILE SECTION.                                                    00390000
004000****************************************************************  00400000
004100                                                                  00410000
004200 FD  EXTRACT-FILE                                                 00420000
004300     RECORDING MODE IS F                                          00430000
004400     LABEL RECORDS ARE STANDARD                                   00440000
004500     RECORD CONTAINS 200                                          00450016
004600     BLOCK CONTAINS 0 RECORDS                                     00460000
004700     DATA RECORD IS EXTRACT-RECORD.                               00470000
004710*** PRB0064829 START                                              00471016
004800*01  EXTRACT-RECORD                      PIC  X(150).             00480016
004810 01  EXTRACT-RECORD                      PIC  X(200).             00481016
004820*** PRB0064829 END                                                00482016
004900                                                                  00490000
005000 FD  OLD-RECEIVERS-FILE                                           00500000
005100     RECORDING MODE IS F                                          00510000
005200     LABEL RECORDS ARE STANDARD                                   00520000
005300     RECORD CONTAINS 200                                          00530016
005400     BLOCK CONTAINS 0 RECORDS                                     00540000
005500     DATA RECORD IS OLD-RECEIVERS-RECORD.                         00550000
005510*** PRB0064829 START                                              00551016
005600*01  OLD-RECEIVERS-RECORD                PIC  X(150).             00560016
005610 01  OLD-RECEIVERS-RECORD                PIC  X(200).             00561016
005620*** PRB0064829 END                                                00562016
005700                                                                  00570000
005800 FD  IP-EXTRACT-FILE                                              00580000
005900     RECORDING MODE IS F                                          00590000
006000     LABEL RECORDS ARE STANDARD                                   00600000
006100     RECORD CONTAINS 200                                          00610016
006200     BLOCK CONTAINS 0 RECORDS                                     00620000
006300     DATA RECORD IS IP-EXTRACT-RECORD.                            00630000
006310*** PRB0064829 START                                              00631016
006400*01  IP-EXTRACT-RECORD                   PIC  X(150).             00640016
006410 01  IP-EXTRACT-RECORD                   PIC  X(200).             00641016
006420*** PRB0064829 END                                                00642016
006500                                                                  00650000
006600/                                                                 00660000
006700 WORKING-STORAGE SECTION.                                         00670000
006800                                                                  00680000
006900 01  ABEND-CODE                          PIC S9(04)  VALUE ZERO   00690000
007000                                                     COMP SYNC.   00700000
007100 01  PV-PROGRAM-VARIABLES.                                        00710000
007200     05  PV-PKSL-ITM-QTY                 PIC S9(09)  VALUE ZERO   00720000
007300                                                     COMP SYNC.   00730000
007400     05  WS-COUNT                       PIC S9(09)  VALUE +0      00740000
007500                                                    COMP SYNC.    00750000
007600     05  WS-TMSTMP                      PIC X(26)   VALUE SPACES. 00760000
007700     05  PV-TMST                         PIC  X(26)  VALUE SPACE. 00770000
007800     05  FILLER  REDEFINES  PV-TMST.                              00780000
007900         10  PV-DATE.                                             00790000
008000             15  PV-TMST-DATE.                                    00800000
008100                 20  PV-TMST-DATE-CC     PIC  X(02).              00810000
008200                 20  PV-TMST-DATE-YY     PIC  X(02).              00820000
008300             15  PV-SLASH1               PIC  X(01).              00830000
008400             15  PV-TMST-DATE-MM         PIC  X(02).              00840000
008500             15  PV-SLASH2               PIC  X(01).              00850000
008600             15  PV-TMST-DATE-DD         PIC  X(02).              00860000
008700         10  FILLER                      PIC  X(16).              00870000
008800     05  PV-DATE2.                                                00880000
008900             15  PV-TMST-DATE-MM2        PIC  X(02).              00890000
009000             15  PV-SLASH3               PIC  X(01).              00900000
009100             15  PV-TMST-DATE-DD2        PIC  X(02).              00910000
009200             15  PV-SLASH4               PIC  X(01).              00920000
009300             15  PV-TMST-DATE2.                                   00930000
009400                 20  PV-TMST-DATE-CC2    PIC  X(02).              00940000
009500                 20  PV-TMST-DATE-YY2    PIC  X(02).              00950000
009600     05  PV-ABEND-PARAGRAPH              PIC  X(30)  VALUE SPACE. 00960000
009700     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 00970000
009800     05  PV-DISPLAY-KEYS.                                         00980000
009900         10  PV-DISPLAY-ORD-NBR          PIC  9(09)  VALUE ZEROS  00990000
010000                                                 BLANK WHEN ZEROS.01000000
010100         10  FILLER                      PIC  X(02)  VALUE SPACE. 01010000
010200         10  PV-DISP-PO                  PIC  Z(09)  VALUE ZEROS. 01020002
010210         10  PV-DISP-RCVR                PIC  9(04)  VALUE ZEROS. 01021002
010220         10  PV-DISP-LINE                PIC  9(04)  VALUE ZEROS. 01022003
010221         10  PV-DISP-OPER                PIC  Z(04)  VALUE ZEROS. 01022104
010222         10  PV-DISP-CURR                PIC  Z(04)  VALUE ZEROS. 01022204
010230         10  PV-DISPLAY-RCVR-SEQ-NBR     PIC  9(09)  VALUE ZEROS  01023001
010300                                                 BLANK WHEN ZEROS.01030000
010400         10  FILLER                      PIC  X(02)  VALUE SPACE. 01040000
010500         10  PV-DISPLAY-ORD-LNE-NBR      PIC  9(04)  VALUE ZEROS  01050000
010600                                                 BLANK WHEN ZEROS.01060000
010700         10  FILLER                      PIC  X(02)  VALUE SPACE. 01070000
010800         10  PV-DISPLAY-WORK-ORD-SEQ-NBR                          01080000
010900                                         PIC  9(04)  VALUE ZEROS  01090000
011000                                                 BLANK WHEN ZEROS.01100000
011100         10  FILLER                      PIC  X(02)  VALUE SPACE. 01110000
011200         10  PV-DISPLAY-OPER-UNT-ID      PIC  9(04)  VALUE ZEROS  01120000
011300                                                 BLANK WHEN ZEROS.01130000
011400         10  FILLER                      PIC  X(02)  VALUE SPACE. 01140000
011500         10  PV-DISPLAY-FCLTY-ID         PIC  9(04)  VALUE ZEROS  01150000
011600                                                 BLANK WHEN ZEROS.01160000
011700     05  PV-STORE-NUM.                                            01170000
011800         10  PV-NUM-STORE-NUM            PIC  9(03)  VALUE ZEROS. 01180000
011900     05  PV-DISPLAY-ENT-ID               PIC  9(09)  VALUE ZEROS. 01190000
012000     05  PV-DISPLAY-DEPT-NBR             PIC  9(03)  VALUE ZEROS. 01200000
012100     05  PV-PREV-OPER-EXTRACT            PIC  9(04)  VALUE ZEROS. 01210000
012200     05  PV-PREV-OPER-OLD-RCVR           PIC  9(04)  VALUE ZEROS. 01220000
012300     05  PV-TODAYS-DATE.                                          01230000
012400         10  PV-TODAYS-YY                PIC 9(02)   VALUE ZERO.  01240000
012500         10  PV-TODAYS-MM                PIC 9(02)   VALUE ZERO.  01250000
012600         10  PV-TODAYS-DD                PIC 9(02)   VALUE ZERO.  01260000
012700     05  PV-CURR-COMP-DATE.                                       01270000
012800         10  PV-CURR-COMP-DATE-CC        PIC 9(02)   VALUE ZEROES.01280000
012900         10  PV-CURR-COMP-DATE-YY        PIC 9(02)   VALUE ZEROES.01290000
013000         10  FILLER                      PIC X(01)   VALUE '-'.   01300000
013100         10  PV-CURR-COMP-DATE-MM        PIC 9(02)   VALUE ZEROES.01310000
013200         10  FILLER                      PIC X(01)   VALUE '-'.   01320000
013300         10  PV-CURR-COMP-DATE-DD        PIC 9(02)   VALUE ZEROES.01330000
013400     05  PV-TSTR-COMP-DATE               PIC X(10)   VALUE SPACES.01340000
013500     05  PV-DATE-MMDDYY.                                          01350000
013600         10  PV-MM                       PIC 9(02)   VALUE ZEROES.01360000
013700         10  PV-DD                       PIC 9(02)   VALUE ZEROES.01370000
013800         10  PV-YY                       PIC 9(02)   VALUE ZEROES.01380000
013900         10  FILLER                      PIC X(04)   VALUE SPACES.01390000
014000     05  PV-COMPARE-DATE.                                         01400000
014100         10  PV-COMPARE-YY               PIC 9(04)   VALUE ZEROES.01410000
014200         10  FILLER REDEFINES PV-COMPARE-YY.                      01420000
014300             15  PV-COMPARE-CC           PIC 9(02).               01430000
014400             15  PV-COMPARE-CY           PIC 9(02).               01440000
014500         10  PV-COMPARE-MM               PIC 9(02)   VALUE ZEROES.01450000
014600         10  PV-COMPARE-DD               PIC 9(02)   VALUE ZEROES.01460000
014700     05  PV-WRITE-DATE.                                           01470000
014800         10  PV-WRITE-MM                 PIC 9(02)   VALUE ZEROES.01480000
014900         10  FILLER                      PIC X(01)   VALUE '/'.   01490000
015000         10  PV-WRITE-DD                 PIC 9(02)   VALUE ZEROES.01500000
015100         10  FILLER                      PIC X(01)   VALUE '/'.   01510000
015200         10  PV-WRITE-YY                 PIC 9(02)   VALUE ZEROES.01520000
015300     05  PV-REC-DATE.                                             01530000
015400         10  PV-REC-YY                   PIC 9(04)   VALUE ZEROES.01540000
015500         10  PV-REC-MM                   PIC 9(02)   VALUE ZEROES.01550000
015600         10  PV-REC-DD                   PIC 9(02)   VALUE ZEROES.01560000
015601*** PRB0064829 START                                              01560116
015610     05  PV-OTB.                                                  01561016
015620         10  PV-OTB-MONTH                PIC X(03)   VALUE SPACES.01562019
015640         10  PV-OTB-YY                   PIC X(02)   VALUE SPACES.01564019
015641     05  PV-OTB-MON-CH                   PIC X(02)   VALUE SPACES.01564119
015642     05  PV-OTB-MON-NM                REDEFINES                   01564219
015643         PV-OTB-MON-CH                   PIC 9(02).               01564319
015650*** PRB0064829 END                                                01565016
015700                                                                  01570000
015800 01  CC-CONTROL-CARD.                                             01580000
015900     05  CC-CONSTANT                 PIC  X(07)      VALUE SPACE. 01590000
016000     05  FILLER                      PIC  X(01)      VALUE SPACE. 01600000
016100*    05  CC-DAYS                     PIC  9(03)      VALUE ZERO.  01610000
016200     05  CC-TIME-ZONE                PIC  X(25)      VALUE SPACE. 01620000
016300     05  FILLER                      PIC  X(44)      VALUE SPACE. 01630000
016400                                                                  01640000
016500 01  WS-TABLE-AREA.                                               01650000
016600     05  WS-DC-TABLE                 OCCURS 50 TIMES              01660000
016700                                     INDEXED BY DCT-IDX           01670000
016800                                                DCT-MAX-IDX.      01680000
016900         10  WS-DCT-OPER-UNIT-ID     PIC S9(04)    COMP.          01690000
017000         10  WS-DCT-CM-DATA-IND      PIC  X(01).                  01700000
017100             88  WS-CM-DATA-PROCESSED                VALUE 'Y'.   01710000
017200         10  WS-DCT-IP-DATA-IND      PIC  X(01).                  01720000
017300             88  WS-IP-DATA-PROCESSED                VALUE 'Y'.   01730000
017400         10  WS-DCT-DATA-FILE2-IND   PIC  X(01).                  01740000
017500             88  WS-DCT-DATA2-PROCESSED              VALUE 'Y'.   01750000
017600         10  WS-DCT-OPEN-DATE        PIC  X(10).                  01760000
017700         10  WS-DCT-CLOSE-DATE       PIC  X(10).                  01770000
017800                                                                  01780000
017900 01  PC-PROGRAM-CONSTANTS.                                        01790000
018000     05  PC-N                            PIC  X(01)  VALUE 'N'.   01800000
018100     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   01810000
018200     05  PC-IP                           PIC  X(02)  VALUE 'IP'.  01820000
018300     05  PC-CM                           PIC  X(02)  VALUE 'CM'.  01830000
018400     05  PC-ZZ                           PIC  X(02)  VALUE 'ZZ'.  01840000
018500     05  PC-1                            PIC  9(02)  VALUE 1.     01850000
018600     05  PC-19                           PIC  9(02)  VALUE 19.    01860000
018700     05  PC-20                           PIC  9(02)  VALUE 20.    01870000
018800     05  PC-90                           PIC  9(02)  VALUE 90.    01880000
018900     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        01890000
019000         'PCKUT001'.                                              01900000
019100     05  PC-PGM-DPKUT500                 PIC  X(08)  VALUE        01910000
019200         'DPKUT500'.                                              01920000
019300     05  PC-INIT-DATE                    PIC  X(10)  VALUE        01930000
019400         '9999-09-09'.                                            01940000
019500     05  PC-DEFAULT-DATE                 PIC  X(26)  VALUE        01950000
019600         '9999-00-00-00.00.00.000000'.                            01960000
019700     05  PC-DEFAULT-TMST                 PIC  X(26)  VALUE        01970000
019800         '9999-09-09-09.09.09.999999'.                            01980000
019801*** PRB0064829 START                                              01980116
019810     05  PC-MONTH-ABBR-TABLE.                                     01981016
019820         10  FILLER                   PIC  X(03) VALUE 'JAN'.     01982016
019830         10  FILLER                   PIC  X(03) VALUE 'FEB'.     01983016
019840         10  FILLER                   PIC  X(03) VALUE 'MAR'.     01984016
019850         10  FILLER                   PIC  X(03) VALUE 'APR'.     01985016
019860         10  FILLER                   PIC  X(03) VALUE 'MAY'.     01986016
019870         10  FILLER                   PIC  X(03) VALUE 'JUN'.     01987016
019880         10  FILLER                   PIC  X(03) VALUE 'JUL'.     01988016
019890         10  FILLER                   PIC  X(03) VALUE 'AUG'.     01989016
019891         10  FILLER                   PIC  X(03) VALUE 'SEP'.     01989116
019892         10  FILLER                   PIC  X(03) VALUE 'OCT'.     01989216
019893         10  FILLER                   PIC  X(03) VALUE 'NOV'.     01989316
019894         10  FILLER                   PIC  X(03) VALUE 'DEC'.     01989416
019895     05  FILLER REDEFINES PC-MONTH-ABBR-TABLE.                    01989516
019896         10  PC-MONTH-ABBR OCCURS 12 TIMES                        01989616
019897                                      PIC  X(03).                 01989716
019898*** PRB0064829 END                                                01989816
019900                                                                  01990000
020000 01  DK-DB2-KEYS.                                                 02000000
020100     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  02010000
020200                                                     COMP.        02020000
020300     05  DK-REC-SEQ-NBR                  PIC S9(09)  VALUE ZEROS  02030000
020400                                                     COMP.        02040000
020500     05  DK-ORD-LNE-NBR                  PIC S9(09)  VALUE ZEROS  02050000
020600                                                     COMP.        02060000
020700                                                                  02070000
020800 01  PS-PROGRAM-SWITCHES.                                         02080000
020900     05  PS-FIRST-TIME-TWKORIN0-SW       PIC  X(01)  VALUE 'N'.   02090009
021000         88  PS-FIRST-TIME-TWKORIN0                  VALUE 'Y'.   02100009
021100         88  PS-FIRST-TIME-TWKORIN0-NO               VALUE 'N'.   02110009
021101     05  PS-FIRST-TIME-TWKORIN0-NOP-SW   PIC  X(01)  VALUE 'N'.   02110111
021102         88  PS-FIRST-TIME-TWKORIN0-NOP              VALUE 'Y'.   02110211
021103         88  PS-FIRST-TIME-TWKORIN0-NOP-NO           VALUE 'N'.   02110311
021110     05  PS-WRITE-FROM-RECITM-SW         PIC  X(01)  VALUE 'N'.   02111009
021120         88  PS-WRITE-FROM-RECITM                    VALUE 'Y'.   02112009
021130         88  PS-NO-WRITE-FROM-RECITM                 VALUE 'N'.   02113009
021200     05  SW-END-OF-LINE                  PIC  X(01)  VALUE 'N'.   02120000
021300         88  SW-THATS-ALL-FOLKS                      VALUE 'Y'.   02130000
021400         88  SW-THERES-MORE                          VALUE 'N'.   02140000
021500     05  PS-TWKORIN-FOUND-SW             PIC  X(01)  VALUE 'N'.   02150001
021501         88  PS-TWKORIN-FOUND-YES                    VALUE 'Y'.   02150101
021502         88  PS-TWKORIN-FOUND-NO                     VALUE 'N'.   02150201
021503     05  PS-TWKORIN-NO-OPER-FOUND-SW     PIC  X(01)  VALUE 'N'.   02150312
021504         88  PS-TWKORIN-NO-OPER-FOUND-YES            VALUE 'Y'.   02150412
021505         88  PS-TWKORIN-NO-OPER-FOUND-NO             VALUE 'N'.   02150512
021510     05  PS-TWKORIN-CURSOR-SW            PIC  X(01)  VALUE 'N'.   02151001
021600         88  PS-EOF-TWKORIN-CSR                      VALUE 'Y'.   02160000
021610     05  PS-TWKORIN-NO-OPER-CURSOR-SW    PIC  X(01)  VALUE 'N'.   02161001
021620         88  PS-EOF-TWKORIN-NO-OPER-CSR              VALUE 'Y'.   02162001
021700     05  PS-LOCATION-CURSOR-SW           PIC  X(01)  VALUE 'N'.   02170000
021800         88  PS-EOF-LOCATION-CSR                     VALUE 'Y'.   02180000
021900     05  PS-TKRPRPM-CURSOR-SW            PIC  X(01)  VALUE 'N'.   02190000
022000         88  PS-EOF-TKRPRPM-CSR                      VALUE 'Y'.   02200000
022100     05  PS-TWKORIN-ZERO-SW              PIC  X(01)  VALUE 'N'.   02210000
022200         88  PS-EOF-TWKORIN-ZERO                     VALUE 'Y'.   02220000
022210     05  PS-TWKORIN-NO-OPER-ZERO-SW      PIC  X(01)  VALUE 'N'.   02221001
022220         88  PS-EOF-TWKORIN-NO-OPER-ZERO             VALUE 'Y'.   02222001
022300     05  PS-END-OF-TRECITM-CSR-SW        PIC  X(01)  VALUE 'N'.   02230000
022400         88  PS-END-OF-TRECITM-CSR                   VALUE 'Y'.   02240000
022500         88  PS-NOT-END-OF-TRECITM-CSR               VALUE 'N'.   02250000
022600     05  PS-VALID-DC-SW                  PIC  X(01)  VALUE 'I'.   02260000
022700         88  PS-VALID-DC                             VALUE 'V'.   02270000
022800         88  PS-INVALID-DC                           VALUE 'I'.   02280000
022900     05  PS-FILE-WRITE-SW                PIC  X(01)  VALUE 'I'.   02290000
023000         88  PS-FILE-1-WRITE                         VALUE 'V'.   02300000
023100         88  PS-FILE-2-WRITE                         VALUE 'I'.   02310000
023200     05  PS-TABLE-MATCH-SW               PIC  X(01)  VALUE 'N'.   02320000
023300         88  PS-TABLE-MATCH-FOUND                    VALUE 'Y'.   02330000
023400         88  PS-TABLE-MATCH-NOTFOUND                 VALUE 'N'.   02340000
023500                                                                  02350000
023510*** PRB0064829 START                                              02351016
023520******************************************************************02352016
023530*  COPYBOOK POWS055 (USED FOR OTB)                                02353016
023540******************************************************************02354016
023550     COPY POWS055.                                                02355016
023560*                                                                 02356016
023570*** PRB0064829 END                                                02357016
023600*                                                                 02360000
023700*  DCLGEN FOR THE DB2 WORK ORDER INSTRUCTION TABLE                02370000
023800*                                                                 02380000
023900     EXEC SQL                                                     02390000
024000          INCLUDE TWKORIN                                         02400000
024100     END-EXEC.                                                    02410000
024200                                                                  02420000
024300*                                                                 02430000
024400*  COPY BOOK FOR DB2 FORMATTED MESSAGE AREA                       02440000
024500*                                                                 02450000
024600     COPY DPWS004.                                                02460000
024700                                                                  02470000
024800******************************************************************02480000
024900*    CALENDAR ROUTINE                                             02490000
025000******************************************************************02500000
025100     COPY DPWS500.                                                02510000
025200                                                                  02520000
025300*                                                                 02530000
025400*  COPY BOOK FOR THE RECEIVER EXTRACT FILE                        02540000
025500*                                                                 02550000
025600     COPY PCRD002.                                                02560000
025700                                                                  02570000
025800*                                                                 02580000
025900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STATUS CODE TABLE  02590000
026000*                                                                 02600000
026100     EXEC SQL                                                     02610000
026200          INCLUDE TSTATCD                                         02620000
026300     END-EXEC.                                                    02630000
026400                                                                  02640000
026500*                                                                 02650000
026600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     02660000
026700*  HEADER TABLE                                                   02670000
026800*                                                                 02680000
026900     EXEC SQL                                                     02690000
027000          INCLUDE TPURCHS                                         02700000
027100     END-EXEC.                                                    02710000
027200                                                                  02720000
027300*                                                                 02730000
027400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     02740000
027500*  ITEM TABLE                                                     02750000
027600*                                                                 02760000
027700     EXEC SQL                                                     02770000
027800          INCLUDE TPURITM                                         02780000
027900     END-EXEC.                                                    02790000
028000                                                                  02800000
028100*                                                                 02810000
028200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPRIZE NAME    02820000
028300*  TABLE.                                                         02830000
028400*                                                                 02840000
028500     EXEC SQL                                                     02850000
028600          INCLUDE TENTNME                                         02860000
028700     END-EXEC.                                                    02870000
028800                                                                  02880000
028900*                                                                 02890000
029000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER TABLE     02900000
029100*                                                                 02910000
029200     EXEC SQL                                                     02920000
029300          INCLUDE TRECEIV                                         02930000
029400     END-EXEC.                                                    02940000
029500                                                                  02950000
029600*                                                                 02960000
029700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT - RECEIVER02970000
029800*  ASSOCIATION TABLE                                              02980000
029900*                                                                 02990000
030000     EXEC SQL                                                     03000000
030100          INCLUDE TSHPTPO                                         03010000
030200     END-EXEC.                                                    03020000
030300                                                                  03030000
030400*                                                                 03040000
030500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM TABLE 03050000
030600*                                                                 03060000
030700     EXEC SQL                                                     03070000
030800          INCLUDE TRECITM                                         03080000
030900     END-EXEC.                                                    03090000
031000                                                                  03100000
031100*                                                                 03110000
031200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE NOTIFICATIO03120000
031300*                                                                 03130000
031400     EXEC SQL                                                     03140000
031500          INCLUDE TTRBNTF                                         03150000
031600     END-EXEC.                                                    03160000
031700                                                                  03170000
031800*                                                                 03180000
031900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS          03190000
032000*  LOCATION TABLE                                                 03200000
032100*  (XLT_LOC)                                                      03210000
032200*                                                                 03220000
032300     EXEC SQL                                                     03230000
032400          INCLUDE XLT00010                                        03240000
032500     END-EXEC.                                                    03250000
032600                                                                  03260000
032700*                                                                 03270000
032800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE REASON CODE03280000
032900*  TABLE.                                                         03290000
033000*                                                                 03300000
033100     EXEC SQL                                                     03310000
033200          INCLUDE TTRBRSN                                         03320000
033300     END-EXEC.                                                    03330000
033400                                                                  03340000
033500*                                                                 03350000
033600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PARM TABLE.        03360000
033700*                                                                 03370000
033800     EXEC SQL                                                     03380000
033900          INCLUDE TKRPRPM                                         03390000
034000     END-EXEC.                                                    03400000
034100                                                                  03410000
034110*** PRB0064829 START                                              03411017
034120*  DCLGEN LAYOUT AND COBOL DECLARATION PLANNED SHIPMENT TABLE     03412017
034130*                                                                 03413017
034140     EXEC SQL                                                     03414017
034150          INCLUDE TPLNSHP                                         03415017
034160     END-EXEC.                                                    03416017
034161*** PRB0064829 END                                                03416117
034170                                                                  03417017
034200*                                                                 03420000
034300*                                                                 03430000
034400*  COMMUNICATION AREAS FOR DB2                                    03440000
034500*                                                                 03450000
034600     EXEC SQL                                                     03460000
034700         INCLUDE SQLCA                                            03470000
034800     END-EXEC.                                                    03480000
034900                                                                  03490000
035000*                                                                 03500000
035100******************************************************************03510000
035200*  TRECEIV CURSOR                                                *03520000
035300******************************************************************03530000
035400     EXEC SQL                                                     03540000
035500          DECLARE RECEIV_CSR CURSOR FOR                           03550000
035600          SELECT ORD_NBR,                                         03560000
035700                 REC_SEQ_NBR,                                     03570000
035800                 PO_VER_NBR,                                      03580000
035900                 STATUS_CDE,                                      03590000
036000                 PACK_BY_ST_IND,                                  03600000
036100                 REC_TMST,                                        03610000
036200                 EXPTED_CART_CNT,                                 03620000
036300                 ACTL_CART_CNT,                                   03630000
036400                 OPER_UNT_ID,                                     03640000
036500                 FCLTY_ID,                                        03650000
036600                 CURR_OPER_UNT_ID,                                03660000
036700                 CURR_FCLTY_ID                                    03670000
036800           FROM  TRECEIV                                          03680000
036900          WHERE (STATUS_CDE        IN (:PC-IP, :PC-CM)            03690000
037000            AND  VER_STATUS_CDE     =  'A')                       03700000
037100          WITH UR                                                 03710000
037200     END-EXEC.                                                    03720000
037300                                                                  03730000
037400******************************************************************03740000
037500*  TRECITM CURSOR                                                *03750000
037600******************************************************************03760000
037700     EXEC SQL                                                     03770000
037800          DECLARE TRECITM-CSR CURSOR FOR                          03780000
037900           SELECT ORD_LNE_NBR                                     03790000
038000                , PKSL_ITM_QTY                                    03800000
038100                , DTL_CK_ITM_QTY                                  03810000
038200             FROM TRECITM                                         03820000
038300            WHERE ORD_NBR          =  :RECEIV-ORD-NBR             03830000
038400              AND REC_SEQ_NBR      =  :RECEIV-REC-SEQ-NBR         03840000
038500              AND STATUS_CDE        IN (:PC-IP, :PC-CM)           03850000
038600              AND VER_STATUS_CDE   = 'A'                          03860000
038700            WITH UR                                               03870000
038800     END-EXEC.                                                    03880000
038900******************************************************************03890000
039000*  TWKORIN CURSOR                                                *03900000
039100******************************************************************03910000
039200     EXEC SQL                                                     03920000
039300          DECLARE TWKORIN_CSR CURSOR FOR                          03930000
039400             SELECT  STRT_TMST,                                   03940000
039500                     STOP_TMST,                                   03950000
039600                     PRC_FCLTY_AREA_ID,                           03960000
039700                     SCREEN_SEQ_NBR,                              03970000
039800                     LNE_LOC_CDE                                  03980000
039900               FROM  TWKORIN                                      03990000
040000              WHERE  (ORD_NBR            =  :DK-ORD-NBR           04000000
040100                AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR       04010000
040200                AND   ORD_LNE_NBR        =  :DK-ORD-LNE-NBR       04020000
040300                AND   WORK_ORD_SEQ_NBR   =  1                     04030000
040400                AND   OPER_UNT_ID        =  :RECEIV-OPER-UNT-ID   04040000
040500                AND   FCLTY_ID           =  :RECEIV-FCLTY-ID      04050000
040600                AND   VER_STATUS_CDE     =  'A')                  04060000
040700           ORDER BY  SCREEN_SEQ_NBR                               04070000
040800           WITH UR                                                04080000
040900     END-EXEC.                                                    04090000
041000                                                                  04100000
041100******************************************************************04110000
041200*  TWKORIN CURSOR - FOR LINE NUMBER = ZERO                       *04120000
041300******************************************************************04130000
041400     EXEC SQL                                                     04140000
041500          DECLARE WKORIN0_CSR CURSOR FOR                          04150000
041600             SELECT  STRT_TMST,                                   04160000
041700                     STOP_TMST,                                   04170000
041800                     PRC_FCLTY_AREA_ID,                           04180000
041900                     SCREEN_SEQ_NBR,                              04190000
042000                     LNE_LOC_CDE                                  04200000
042100               FROM  TWKORIN                                      04210000
042200              WHERE  (ORD_NBR            =  :DK-ORD-NBR           04220000
042300                AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR       04230000
042400                AND   ORD_LNE_NBR        =  0                     04240000
042500                AND   WORK_ORD_SEQ_NBR   =  1                     04250000
042600                AND   OPER_UNT_ID        =  :RECEIV-OPER-UNT-ID   04260000
042700                AND   FCLTY_ID           =  :RECEIV-FCLTY-ID      04270000
042800                AND   VER_STATUS_CDE     = 'A')                   04280000
042900           ORDER BY  SCREEN_SEQ_NBR                               04290000
043000           WITH UR                                                04300000
043100     END-EXEC.                                                    04310000
043200                                                                  04320000
043210******************************************************************04321001
043220*  TWKORIN CURSOR - NO OPER                                      *04322001
043230******************************************************************04323001
043240     EXEC SQL                                                     04324001
043250          DECLARE TWKORIN_NO_OPER_CSR CURSOR FOR                  04325001
043260             SELECT  STRT_TMST,                                   04326001
043270                     STOP_TMST,                                   04327001
043280                     PRC_FCLTY_AREA_ID,                           04328001
043290                     SCREEN_SEQ_NBR,                              04329001
043291                     LNE_LOC_CDE                                  04329101
043292               FROM  TWKORIN                                      04329201
043293              WHERE  (ORD_NBR            =  :DK-ORD-NBR           04329301
043294                AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR       04329401
043295                AND   ORD_LNE_NBR        =  :DK-ORD-LNE-NBR       04329501
043296                AND   WORK_ORD_SEQ_NBR   =  1                     04329601
043299                AND   VER_STATUS_CDE     =  'A')                  04329901
043300           ORDER BY  SCREEN_SEQ_NBR                               04330001
043301           WITH UR                                                04330101
043302     END-EXEC.                                                    04330201
043303                                                                  04330301
043304******************************************************************04330401
043305*  TWKORIN CURSOR - FOR LINE NUMBER = ZERO                       *04330501
043306******************************************************************04330601
043307     EXEC SQL                                                     04330701
043308          DECLARE WKORIN0_NO_OPER_CSR CURSOR FOR                  04330811
043309             SELECT  STRT_TMST,                                   04330901
043310                     STOP_TMST,                                   04331001
043311                     PRC_FCLTY_AREA_ID,                           04331101
043312                     SCREEN_SEQ_NBR,                              04331201
043313                     LNE_LOC_CDE                                  04331301
043314               FROM  TWKORIN                                      04331401
043315              WHERE  (ORD_NBR            =  :DK-ORD-NBR           04331501
043316                AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR       04331601
043317                AND   ORD_LNE_NBR        =  0                     04331701
043318                AND   WORK_ORD_SEQ_NBR   =  1                     04331801
043321                AND   VER_STATUS_CDE     = 'A')                   04332101
043322           ORDER BY  SCREEN_SEQ_NBR                               04332201
043323           WITH UR                                                04332301
043324     END-EXEC.                                                    04332401
043325                                                                  04332501
043330******************************************************************04333000
043400*  LOCATION CURSOR - PICKUP VALID DC'S TO BE REPORTED ON         *04340000
043500*  XLT_LOC (XLT00010)                                             04350000
043600******************************************************************04360000
043700     EXEC SQL                                                     04370000
043800          DECLARE LOCATION_CSR CURSOR FOR                         04380000
043900            SELECT LOC_NBR,                                       04390000
044000                   OPN_DTE,                                       04400000
044100                   CLO_DTE                                        04410000
044200            FROM   XLT_LOC                                        04420000
044300            WHERE  LOC_TYP_CDE = 'DC'                             04430000
044400            ORDER BY 1                                            04440000
044500            WITH UR                                               04450000
044600     END-EXEC.                                                    04460000
044700                                                                  04470000
044800******************************************************************04480000
044900*  TKRPRPM CURSOR - PICKUP VALID DC'S TO BE REPORTED ON          *04490000
045000*  XLT_LOC (XLT00010)                                             04500000
045100******************************************************************04510000
045200     EXEC SQL                                                     04520000
045300          DECLARE TKRPRPM_CSR CURSOR FOR                          04530000
045400            SELECT A.LOC_NBR,                                     04540000
045500                   A.OPN_DTE,                                     04550000
045600                   A.CLO_DTE                                      04560000
045700            FROM   XLT_LOC A,                                     04570000
045800                   TKRPRPM B                                      04580000
045900            WHERE  A.LOC_TYP_CDE      = 'DC'                      04590000
046000              AND  A.LOC_NBR          = B.LOC_ID                  04600000
046100              AND  B.SYS_PRC_FUNC_CDE = 'STATZN'                  04610000
046200              AND  B.INTFC_SYS_CDE    = 'KHL'                     04620000
046300              AND  B.FUNC_TXT         = :CC-TIME-ZONE             04630000
046400            ORDER BY 1                                            04640000
046500            WITH UR                                               04650000
046600     END-EXEC.                                                    04660000
046700                                                                  04670000
046800******************************************************************04680000
046900 PROCEDURE DIVISION.                                              04690000
047000******************************************************************04700000
047100                                                                  04710000
047200 0000-MAINLINE.                                                   04720000
047300     OPEN OUTPUT EXTRACT-FILE                                     04730000
047400                 IP-EXTRACT-FILE                                  04740000
047500                 OLD-RECEIVERS-FILE.                              04750000
047501***                                                               04750100
047502***   DISPLAY ONLY FOR TESTING                                    04750200
047503***                                                               04750300
047504      DISPLAY '** TEST VERSION **'.                               04750400
047505***                                                               04750500
047506     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           04750600
047507         DISPLAY '** TIMEZONE = ' CC-TIME-ZONE.                   04750700
047508     ACCEPT PV-TODAYS-DATE FROM DATE.                             04750800
047509     IF  PV-TODAYS-YY > PC-90                                     04750900
047510         MOVE PC-19    TO PV-CURR-COMP-DATE-CC                    04751000
047520     ELSE                                                         04752000
047530         MOVE PC-20    TO PV-CURR-COMP-DATE-CC.                   04753000
047540     PERFORM 1100-VALIDATE-CONTROL-CARD.                          04754000
047550     MOVE PV-TODAYS-MM TO PV-MM                                   04755000
047560                          PV-CURR-COMP-DATE-MM.                   04756000
047570     MOVE PV-TODAYS-DD TO PV-DD                                   04757000
047580                          PV-CURR-COMP-DATE-DD.                   04758000
047590     MOVE PV-TODAYS-YY TO PV-YY                                   04759000
047600                          PV-CURR-COMP-DATE-YY.                   04760000
047700     MOVE PV-CURR-COMP-DATE TO                                    04770000
047800          PV-TSTR-COMP-DATE.                                      04780000
047900     PERFORM 1300-SELECT-TKRPRPM.                                 04790000
048000     PERFORM 1200-CALCULATE-DATE.                                 04800000
048100     WRITE OLD-RECEIVERS-RECORD FROM PV-WRITE-DATE.               04810000
048200     IF CC-TIME-ZONE  = 'ALL'                                     04820000
048300         PERFORM 3000-LOAD-DC-TABLE                               04830000
048400     ELSE                                                         04840000
048500         PERFORM 3050-LOAD-DC-TABLE.                              04850000
048600     PERFORM A100-OPEN-RECEIV-CSR.                                04860000
048700                                                                  04870000
048800     PERFORM Y000-FETCH-RECEIV-CSR.                               04880000
048900     PERFORM 2000-PROCESS-CSR                                     04890000
049000       UNTIL  SW-THATS-ALL-FOLKS.                                 04900000
049100                                                                  04910000
049200     PERFORM X200-CLOSE-RECEIV-CSR.                               04920000
049300                                                                  04930000
049400     PERFORM 8000-CHECK-DC-ENTRIES                                04940000
049500         VARYING DCT-IDX FROM 1 BY 1                              04950000
049600             UNTIL DCT-IDX > DCT-MAX-IDX.                         04960000
049700                                                                  04970000
049800     CLOSE EXTRACT-FILE                                           04980000
049900           IP-EXTRACT-FILE                                        04990000
050000           OLD-RECEIVERS-FILE.                                    05000000
050100                                                                  05010000
050200     GOBACK.                                                      05020000
050300                                                                  05030000
050400******************************************************************05040000
050500*  VALIDATE THE CONTROL CARD.                                     05050000
050600******************************************************************05060000
050700 1100-VALIDATE-CONTROL-CARD.                                      05070000
050800     IF  CC-CONSTANT = 'CONTROL'                                  05080000
050900         CONTINUE                                                 05090000
051000     ELSE                                                         05100000
051100         DISPLAY '** ABEND **'                                    05110000
051200         DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME     05120000
051300         DISPLAY '** PARAGRAPH ** = 1100-VALIDATE-CONTROL-CARD'   05130000
051400         DISPLAY '** CONTROL CONSTANT INVALID'                    05140000
051500         DISPLAY '** CONTROL CONSTANT = ' CC-CONSTANT             05150000
051600         DISPLAY '** CHANGE TO CONTROL'                           05160000
051700         MOVE +4003              TO ABEND-CODE                    05170000
051800         CALL 'ILBOABN0' USING ABEND-CODE                         05180000
051900     END-IF.                                                      05190000
052000                                                                  05200000
052100     EVALUATE TRUE                                                05210000
052200         WHEN CC-TIME-ZONE  = 'ETZ'                               05220000
052300         WHEN CC-TIME-ZONE  = 'CTZ'                               05230000
052400         WHEN CC-TIME-ZONE  = 'MTZ'                               05240000
052500         WHEN CC-TIME-ZONE  = 'PTZ'                               05250000
052600         WHEN CC-TIME-ZONE  = 'ALL'                               05260000
052700             CONTINUE                                             05270000
052800         WHEN OTHER                                               05280000
052900             DISPLAY '** ABEND **'                                05290000
053000             DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME    05300000
053100             DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'  05310000
053200             DISPLAY '** TIMEZONE NOT VALID '                     05320000
053300             DISPLAY '** TIMEZONE = ' CC-TIME-ZONE                05330000
053400             MOVE +4003          TO ABEND-CODE                    05340000
053500             CALL 'ILBOABN0' USING ABEND-CODE                     05350000
053600     END-EVALUATE.                                                05360000
053700                                                                  05370000
053800 1200-CALCULATE-DATE.                                             05380000
053900     SET DPG51-DECREMENT-DATE TO TRUE.                            05390000
054000*    MOVE CC-DAYS TO DPG51-INCR-DECR-DAYS-9.                      05400000
054100     MOVE KRPRPM-FUNC-QTY  TO DPG51-INCR-DECR-DAYS-9.             05410000
054200     MOVE PV-TODAYS-DATE   TO DPG51-SYSTEM-DATE.                  05420000
054300                                                                  05430000
054400     MOVE PV-DATE-MMDDYY   TO DPG52-LK-DATE-INPUT.                05440000
054500     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      05450000
054600     SET DPG52-LK-DTE-GREG TO TRUE.                               05460000
054700                                                                  05470000
054800     CALL PC-PGM-DPKUT500 USING DPG51 DPG52                       05480000
054900                                DPG53 DPG54                       05490000
055000                                DPG55 DPG56.                      05500000
055100                                                                  05510000
055200     IF DPG54-NO-ERROR                                            05520000
055300         MOVE DPG55-DB2-ISO-DATE      TO PV-COMPARE-DATE          05530000
055400         MOVE PV-COMPARE-CY           TO PV-WRITE-YY              05540000
055500         MOVE PV-COMPARE-MM           TO PV-WRITE-MM              05550000
055600         MOVE PV-COMPARE-DD           TO PV-WRITE-DD              05560000
055700         DISPLAY 'COMPARE DATE: ' PV-WRITE-DATE                   05570000
055800     ELSE                                                         05580000
055900         DISPLAY '** ABEND ** IN PCKUT001'                        05590000
056000         DISPLAY 'PV-DATE-MMDDYY = ' PV-DATE-MMDDYY               05600000
056100         DISPLAY 'DATE ERROR : ' DPG54-ERROR-MESSAGE              05610000
056200         MOVE +4003 TO ABEND-CODE                                 05620000
056300         CALL 'ILBOABN0' USING ABEND-CODE                         05630000
056400     END-IF.                                                      05640000
056500                                                                  05650000
056600 1300-SELECT-TKRPRPM.                                             05660000
056700     MOVE '1300-SELECT-TKRPRPM'                                   05670000
056800         TO PV-ABEND-PARAGRAPH.                                   05680000
056900     MOVE 'SELECT NUMBER OF DAYS FOR AGING'                       05690000
057000         TO PV-DB2-OPERATION-ATTEMPTED.                           05700000
057100                                                                  05710000
057200     INITIALIZE DCLTKRPRPM.                                       05720000
057300                                                                  05730000
057400     EXEC SQL                                                     05740000
057500         SELECT  FUNC_QTY                                         05750000
057600           INTO  :KRPRPM-FUNC-QTY                                 05760000
057700           FROM  TKRPRPM                                          05770000
057800          WHERE  LOC_ID           = 90                            05780000
057900            AND  INTFC_SYS_CDE    = 'KHL'                         05790000
058000            AND  SYS_PRC_FUNC_CDE = 'RCVAGE'                      05800000
058100          WITH UR                                                 05810000
058200     END-EXEC.                                                    05820000
058300                                                                  05830000
058400     EVALUATE TRUE                                                05840000
058500         WHEN SQLCODE = ZERO                                      05850000
058600              CONTINUE                                            05860000
058700         WHEN SQLCODE = +100                                      05870000
058800         WHEN SQLWARN0 NOT = SPACE                                05880000
058900         WHEN SQLCODE < ZERO                                      05890000
059000         WHEN SQLCODE > ZERO                                      05900000
059100             PERFORM 9100-SQL-ABEND                               05910000
059200     END-EVALUATE.                                                05920000
059300                                                                  05930000
059400 2000-PROCESS-CSR.                                                05940000
059500                                                                  05950000
059600     INITIALIZE PC002-RECEIVER-EXT-RECORD.                        05960000
059700                                                                  05970000
059800     MOVE RECEIV-CURR-OPER-UNT-ID                                 05980000
059900                                TO PC002-CURRENT-OPER.            05990000
060000     SET PS-INVALID-DC TO TRUE.                                   06000000
060100     PERFORM 2600-CHECK-FOR-DC.                                   06010000
060200     IF  PS-VALID-DC                                              06020000
060300         PERFORM 2050-FORMAT-AND-WRITE                            06030000
060400     ELSE                                                         06040000
060500         NEXT SENTENCE.                                           06050000
060600                                                                  06060000
060700     PERFORM Y000-FETCH-RECEIV-CSR.                               06070000
060800                                                                  06080000
060900                                                                  06090000
061000 2050-FORMAT-AND-WRITE.                                           06100000
061100                                                                  06110000
061200     MOVE RECEIV-ORD-NBR TO   DK-ORD-NBR.                         06120000
061300     MOVE RECEIV-REC-SEQ-NBR TO   DK-REC-SEQ-NBR.                 06130000
061400     MOVE RECEIV-OPER-UNT-ID    TO PC002-LOGICAL-OPER.            06140000
061500     MOVE RECEIV-FCLTY-ID       TO PC002-LOGICAL-FCLTY.           06150000
061600     MOVE RECEIV-CURR-FCLTY-ID  TO PC002-CURRENT-FCLTY.           06160000
061700     PERFORM 7020-GET-TPURCHS-INFO.                               06170000
061800     PERFORM 7021-GET-SHRT-NM.                                    06180000
061900     PERFORM 7030-GET-AD-PICTURE.                                 06190000
062000     IF WS-COUNT GREATER THAN ZERO                                06200000
062100         MOVE 'P' TO PC002-AD-PICTURE-IND                         06210000
062200     END-IF.                                                      06220000
062300     PERFORM 7040-GET-TROUBLE.                                    06230000
062301*** PRB0064829 START                                              06230116
062310     PERFORM 4000-GET-OTB.                                        06231016
062320*** PRB0064829 END                                                06232016
062400     PERFORM 4500-GET-PROCESSING-AREA.                            06240000
062500     MOVE RECEIV-ORD-NBR           TO PC002-PO-NBR.               06250000
062600     MOVE RECEIV-REC-SEQ-NBR       TO PC002-REC-SEQ-NBR.          06260000
062700     IF RECEIV-PACK-BY-ST-IND = 'Y'                               06270000
062800         MOVE 'A'                  TO PC002-PROCESS-IND           06280000
062900     ELSE                                                         06290000
063000         MOVE 'N'                  TO PC002-PROCESS-IND           06300000
063100     END-IF.                                                      06310000
063200     MOVE RECEIV-REC-TMST          TO PV-TMST.                    06320000
063300     MOVE '/' TO PV-SLASH1                                        06330000
063400                 PV-SLASH2                                        06340000
063500                 PV-SLASH3                                        06350000
063600                 PV-SLASH4.                                       06360000
063700     MOVE PV-DATE                  TO PC002-REC-DATE.             06370000
063800     MOVE PV-TMST-DATE             TO PV-REC-YY.                  06380000
063900     MOVE PV-TMST-DATE-MM          TO PV-REC-MM                   06390000
064000                                      PV-TMST-DATE-MM2.           06400000
064100     MOVE PV-TMST-DATE-DD          TO PV-REC-DD                   06410000
064200                                      PV-TMST-DATE-DD2.           06420000
064300     MOVE PV-TMST-DATE-CC          TO PV-TMST-DATE-CC2.           06430000
064400     MOVE PV-TMST-DATE-YY          TO PV-TMST-DATE-YY2.           06440000
064500                                                                  06450000
064600     MOVE PV-DATE2                 TO  PC002-REC-DATE.            06460000
064700                                                                  06470000
064800     IF RECEIV-REC-TMST = PC-DEFAULT-TMST                         06480000
064900         SET PC002-PRE-RECEIVED    TO  TRUE                       06490000
065000     ELSE                                                         06500000
065100         SET PC002-NOT-PRE-RECEIVED TO TRUE                       06510000
065200     END-IF.                                                      06520000
065300                                                                  06530000
065400     IF RECEIV-ACTL-CART-CNT > ZERO                               06540000
065500         MOVE RECEIV-ACTL-CART-CNT     TO  PC002-CART-CNT         06550000
065600     ELSE                                                         06560000
065700         MOVE RECEIV-EXPTED-CART-CNT   TO  PC002-CART-CNT         06570000
065800     END-IF.                                                      06580000
065900                                                                  06590000
066000     PERFORM 7010-GET-PRIMARY-VNDR-NME.                           06600000
066100                                                                  06610000
066200     INITIALIZE PV-PKSL-ITM-QTY                                   06620000
066300                PC002-PKSL-ITM-QTY                                06630000
066400                PC002-PACKSLIP-IND.                               06640000
066500                                                                  06650000
066600     MOVE RECEIV-STATUS-CDE          TO PC002-STATUS-CDE.         06660000
066700                                                                  06670000
066800     IF RECEIV-STATUS-CDE = PC-IP                                 06680000
066900         PERFORM 7090-GET-PACKSLIP-IND                            06690000
067000     END-IF.                                                      06700000
067100                                                                  06710000
067200     SET PS-NOT-END-OF-TRECITM-CSR   TO TRUE.                     06720000
067300     SET PC002-DETAIL-RECORD         TO TRUE.                     06730000
067400     SET PS-NO-WRITE-FROM-RECITM     TO TRUE.                     06740000
067500                                                                  06750000
067600     PERFORM 7050-OPEN-TRECITM-CSR.                               06760000
067700                                                                  06770000
067800     PERFORM 7070-FETCH-TRECITM-CSR.                              06780000
067900                                                                  06790000
068000     PERFORM 7060-PROCESS-TRECITM-CSR                             06800000
068100         UNTIL PS-END-OF-TRECITM-CSR.                             06810000
068200                                                                  06820000
068300     PERFORM 7080-CLOSE-TRECITM-CSR.                              06830000
068400                                                                  06840000
068500     MOVE PV-PKSL-ITM-QTY            TO PC002-PKSL-ITM-QTY.       06850000
068600                                                                  06860000
068700     SET PS-FILE-1-WRITE TO TRUE.                                 06870000
068800     PERFORM 2800-WRITE-FOR-DC.                                   06880000
068900     PERFORM 2100-WRITE-OUTPUT-FILE.                              06890000
069000                                                                  06900000
069100     IF RECEIV-STATUS-CDE = PC-IP AND                             06910000
069200         PV-REC-DATE < PV-COMPARE-DATE                            06920000
069300         SET PS-FILE-2-WRITE TO TRUE                              06930000
069400         PERFORM 2800-WRITE-FOR-DC                                06940000
069500         SET PC002-DETAIL-RECORD TO TRUE                          06950000
069600         PERFORM 2200-WRITE-OUTPUT-FILE                           06960000
069700     END-IF.                                                      06970000
069800                                                                  06980000
069900     IF RECEIV-STATUS-CDE = PC-IP AND                             06990000
070000        PS-NO-WRITE-FROM-RECITM                                   07000000
070100         PERFORM 2300-WRITE-OUTPUT-FILE                           07010000
070200     END-IF.                                                      07020000
070300                                                                  07030000
070400                                                                  07040000
070500 2100-WRITE-OUTPUT-FILE.                                          07050000
070600     WRITE EXTRACT-RECORD FROM PC002-RECEIVER-EXT-RECORD.         07060000
070700                                                                  07070000
070800                                                                  07080000
070900 2200-WRITE-OUTPUT-FILE.                                          07090000
071000     WRITE OLD-RECEIVERS-RECORD FROM PC002-RECEIVER-EXT-RECORD.   07100000
071100                                                                  07110000
071200                                                                  07120000
071300 2300-WRITE-OUTPUT-FILE.                                          07130000
071400     WRITE IP-EXTRACT-RECORD FROM PC002-RECEIVER-EXT-RECORD.      07140000
071500                                                                  07150000
071600                                                                  07160000
071700 2600-CHECK-FOR-DC.                                               07170000
071800                                                                  07180000
071900     PERFORM 2700-CHECK-TABLE                                     07190000
072000         VARYING DCT-IDX FROM 1 BY 1                              07200000
072100             UNTIL DCT-IDX IS > DCT-MAX-IDX                       07210000
072200                OR PS-VALID-DC.                                   07220000
072300                                                                  07230000
072400                                                                  07240000
072500 2700-CHECK-TABLE.                                                07250000
072600                                                                  07260000
072700     IF  PC002-CURRENT-OPER = WS-DCT-OPER-UNIT-ID (DCT-IDX)       07270000
072800         SET PS-VALID-DC TO TRUE                                  07280000
072900     ELSE                                                         07290000
073000         NEXT SENTENCE.                                           07300000
073100                                                                  07310000
073200                                                                  07320000
073300 2800-WRITE-FOR-DC.                                               07330000
073400                                                                  07340000
073500     IF  PS-FILE-1-WRITE                                          07350000
073600*        IF  PC002-CURRENT-OPER = PV-PREV-OPER-EXTRACT            07360000
073700*            NEXT SENTENCE                                        07370000
073800*        ELSE                                                     07380000
073900             MOVE PC002-CURRENT-OPER TO PV-PREV-OPER-EXTRACT      07390000
074000             SET PS-TABLE-MATCH-NOTFOUND TO TRUE                  07400000
074100             PERFORM 2900-CHECK-TABLE                             07410000
074200                 VARYING DCT-IDX FROM 1 BY 1                      07420000
074300                     UNTIL DCT-IDX IS > DCT-MAX-IDX               07430000
074400                        OR PS-TABLE-MATCH-FOUND                   07440000
074500     ELSE                                                         07450000
074600         IF  PC002-CURRENT-OPER = PV-PREV-OPER-OLD-RCVR           07460000
074700             NEXT SENTENCE                                        07470000
074800         ELSE                                                     07480000
074900             MOVE PC002-CURRENT-OPER TO PV-PREV-OPER-OLD-RCVR     07490000
075000             SET PS-TABLE-MATCH-NOTFOUND TO TRUE                  07500000
075100             PERFORM 2900-CHECK-TABLE                             07510000
075200                 VARYING DCT-IDX FROM 1 BY 1                      07520000
075300                     UNTIL DCT-IDX IS > DCT-MAX-IDX               07530000
075400                        OR PS-TABLE-MATCH-FOUND.                  07540000
075500                                                                  07550000
075600                                                                  07560000
075700 2900-CHECK-TABLE.                                                07570000
075800                                                                  07580000
075900     IF  PC002-CURRENT-OPER = WS-DCT-OPER-UNIT-ID (DCT-IDX)       07590000
076000         SET PS-TABLE-MATCH-FOUND TO TRUE                         07600000
076100         IF  PS-FILE-1-WRITE                                      07610000
076200             IF  PC002-STATUS-CDE EQUAL PC-IP                     07620000
076300                 SET WS-IP-DATA-PROCESSED (DCT-IDX) TO TRUE       07630000
076400             ELSE                                                 07640000
076500                 SET WS-CM-DATA-PROCESSED (DCT-IDX) TO TRUE       07650000
076600         ELSE                                                     07660000
076700             SET WS-DCT-DATA2-PROCESSED (DCT-IDX) TO TRUE         07670000
076800     ELSE                                                         07680000
076900         NEXT SENTENCE.                                           07690000
077000                                                                  07700000
077100                                                                  07710000
077200 3000-LOAD-DC-TABLE.                                              07720000
077300                                                                  07730000
077400     PERFORM 3100-INIT-DC-TABLE                                   07740000
077500         VARYING DCT-IDX FROM 1 BY 1                              07750000
077600             UNTIL DCT-IDX > 50.                                  07760000
077700                                                                  07770000
077800     PERFORM 3200-OPEN-LOCATION.                                  07780000
077900     SET DCT-IDX TO 1.                                            07790000
078000     SET DCT-MAX-IDX TO 1.                                        07800000
078100     PERFORM 3300-LOAD-DC-TABLE                                   07810000
078200         UNTIL PS-EOF-LOCATION-CSR.                               07820000
078300     PERFORM 3500-CLOSE-LOCATION.                                 07830000
078400                                                                  07840000
078500                                                                  07850000
078600 3050-LOAD-DC-TABLE.                                              07860000
078700                                                                  07870000
078800     PERFORM 3100-INIT-DC-TABLE                                   07880000
078900         VARYING DCT-IDX FROM 1 BY 1                              07890000
079000             UNTIL DCT-IDX > 50.                                  07900000
079100                                                                  07910000
079200     PERFORM 3600-OPEN-TKRPRPM.                                   07920000
079300     SET DCT-IDX TO 1.                                            07930000
079400     SET DCT-MAX-IDX TO 1.                                        07940000
079500     PERFORM 3700-LOAD-DC-TABLE                                   07950000
079600         UNTIL PS-EOF-TKRPRPM-CSR.                                07960000
079700     PERFORM 3900-CLOSE-TKRPRPM.                                  07970000
079800                                                                  07980000
079900                                                                  07990000
080000 3100-INIT-DC-TABLE.                                              08000000
080100                                                                  08010000
080200     MOVE ZEROS TO WS-DCT-OPER-UNIT-ID (DCT-IDX).                 08020000
080300     MOVE SPACES TO WS-DCT-CM-DATA-IND (DCT-IDX)                  08030000
080400                    WS-DCT-IP-DATA-IND (DCT-IDX)                  08040000
080500                    WS-DCT-DATA-FILE2-IND (DCT-IDX).              08050000
080600     MOVE PC-INIT-DATE TO WS-DCT-OPEN-DATE (DCT-IDX)              08060000
080700                          WS-DCT-CLOSE-DATE (DCT-IDX).            08070000
080800                                                                  08080000
080900                                                                  08090000
081000 3200-OPEN-LOCATION.                                              08100000
081100                                                                  08110000
081200     MOVE '3200-OPEN-LOCATION'                                    08120000
081300         TO PV-ABEND-PARAGRAPH.                                   08130000
081400     MOVE 'OPEN THE LOCATION_CSR'                                 08140000
081500         TO PV-DB2-OPERATION-ATTEMPTED.                           08150000
081600                                                                  08160000
081700     EXEC SQL                                                     08170000
081800         OPEN LOCATION_CSR                                        08180000
081900     END-EXEC.                                                    08190000
082000                                                                  08200000
082100     EVALUATE TRUE                                                08210000
082200         WHEN SQLWARN0 NOT = SPACE                                08220000
082300         WHEN SQLCODE < ZERO                                      08230000
082400         WHEN SQLCODE > ZERO                                      08240000
082500             PERFORM 9100-SQL-ABEND                               08250000
082600         WHEN SQLCODE = ZEROS                                     08260000
082700              CONTINUE                                            08270000
082800     END-EVALUATE.                                                08280000
082900                                                                  08290000
083000                                                                  08300000
083100 3300-LOAD-DC-TABLE.                                              08310000
083200                                                                  08320000
083300     PERFORM 3400-FETCH-LOCATION-LOOP.                            08330000
083400                                                                  08340000
083500     IF  PS-EOF-LOCATION-CSR                                      08350000
083600         SET DCT-MAX-IDX DOWN BY 1                                08360000
083700     ELSE                                                         08370000
083800         MOVE XLT00010-LOC-NBR TO WS-DCT-OPER-UNIT-ID (DCT-IDX)   08380000
083900         MOVE XLT00010-OPN-DTE    TO                              08390000
084000              WS-DCT-OPEN-DATE (DCT-IDX)                          08400000
084100         MOVE XLT00010-CLO-DTE    TO                              08410000
084200              WS-DCT-CLOSE-DATE (DCT-IDX)                         08420000
084300         SET DCT-IDX UP BY 1                                      08430000
084400         SET DCT-MAX-IDX UP BY 1.                                 08440000
084500                                                                  08450000
084600                                                                  08460000
084700 3400-FETCH-LOCATION-LOOP.                                        08470000
084800                                                                  08480000
084900     MOVE '3400-FETCH-LOCATION'                                   08490000
085000         TO PV-ABEND-PARAGRAPH.                                   08500000
085100     MOVE 'FETCH THE LOCATION_CSR'                                08510000
085200         TO PV-DB2-OPERATION-ATTEMPTED.                           08520000
085300                                                                  08530000
085400     EXEC SQL                                                     08540000
085500          FETCH LOCATION_CSR                                      08550000
085600             INTO  :XLT00010-LOC-NBR,                             08560000
085700                   :XLT00010-OPN-DTE,                             08570000
085800                   :XLT00010-CLO-DTE                              08580000
085900     END-EXEC.                                                    08590000
086000                                                                  08600000
086100     EVALUATE TRUE                                                08610000
086200         WHEN SQLCODE = +0                                        08620000
086300              CONTINUE                                            08630000
086400         WHEN SQLCODE = +100                                      08640000
086500              SET PS-EOF-LOCATION-CSR TO TRUE                     08650000
086600         WHEN SQLWARN0 NOT = SPACE                                08660000
086700         WHEN SQLCODE < ZERO                                      08670000
086800         WHEN SQLCODE > ZERO                                      08680000
086900             PERFORM 9100-SQL-ABEND                               08690000
087000     END-EVALUATE.                                                08700000
087100                                                                  08710000
087200                                                                  08720000
087300 3500-CLOSE-LOCATION.                                             08730000
087400                                                                  08740000
087500     MOVE '3500-CLOSE-LOCATION'                                   08750000
087600         TO PV-ABEND-PARAGRAPH.                                   08760000
087700     MOVE 'CLOSE THE LOCATION_CSR'                                08770000
087800         TO PV-DB2-OPERATION-ATTEMPTED.                           08780000
087900                                                                  08790000
088000     EXEC SQL                                                     08800000
088100         CLOSE LOCATION_CSR                                       08810000
088200     END-EXEC.                                                    08820000
088300                                                                  08830000
088400     EVALUATE TRUE                                                08840000
088500         WHEN SQLWARN0 NOT = SPACE                                08850000
088600         WHEN SQLCODE < ZERO                                      08860000
088700         WHEN SQLCODE > ZERO                                      08870000
088800             PERFORM 9100-SQL-ABEND                               08880000
088900         WHEN SQLCODE = ZEROS                                     08890000
089000             CONTINUE                                             08900000
089100     END-EVALUATE.                                                08910000
089200                                                                  08920000
089300                                                                  08930000
089400 3600-OPEN-TKRPRPM.                                               08940000
089500                                                                  08950000
089600     MOVE '3600-OPEN-TKRPRPM'                                     08960000
089700         TO PV-ABEND-PARAGRAPH.                                   08970000
089800     MOVE 'OPEN THE TKRPRPM_CSR'                                  08980000
089900         TO PV-DB2-OPERATION-ATTEMPTED.                           08990000
090000                                                                  09000000
090100     EXEC SQL                                                     09010000
090200         OPEN TKRPRPM_CSR                                         09020000
090300     END-EXEC.                                                    09030000
090400                                                                  09040000
090500     EVALUATE TRUE                                                09050000
090600         WHEN SQLWARN0 NOT = SPACE                                09060000
090700         WHEN SQLCODE < ZERO                                      09070000
090800         WHEN SQLCODE > ZERO                                      09080000
090900             PERFORM 9100-SQL-ABEND                               09090000
091000         WHEN SQLCODE = ZEROS                                     09100000
091100              CONTINUE                                            09110000
091200     END-EVALUATE.                                                09120000
091300                                                                  09130000
091400                                                                  09140000
091500 3700-LOAD-DC-TABLE.                                              09150000
091600                                                                  09160000
091700     PERFORM 3800-FETCH-TKRPRPM-LOOP.                             09170000
091800                                                                  09180000
091900     IF  PS-EOF-TKRPRPM-CSR                                       09190000
092000         SET DCT-MAX-IDX DOWN BY 1                                09200000
092100     ELSE                                                         09210000
092200         MOVE XLT00010-LOC-NBR TO WS-DCT-OPER-UNIT-ID (DCT-IDX)   09220000
092300         MOVE XLT00010-OPN-DTE    TO                              09230000
092400              WS-DCT-OPEN-DATE (DCT-IDX)                          09240000
092500         MOVE XLT00010-CLO-DTE    TO                              09250000
092600              WS-DCT-CLOSE-DATE (DCT-IDX)                         09260000
092700         SET DCT-IDX UP BY 1                                      09270000
092800         SET DCT-MAX-IDX UP BY 1.                                 09280000
092900                                                                  09290000
093000                                                                  09300000
093100 3800-FETCH-TKRPRPM-LOOP.                                         09310000
093200                                                                  09320000
093300     MOVE '3400-FETCH-TKRPRPM'                                    09330000
093400         TO PV-ABEND-PARAGRAPH.                                   09340000
093500     MOVE 'FETCH THE TKRPRPM_CSR'                                 09350000
093600         TO PV-DB2-OPERATION-ATTEMPTED.                           09360000
093700                                                                  09370000
093800     EXEC SQL                                                     09380000
093900          FETCH TKRPRPM_CSR                                       09390000
094000             INTO  :XLT00010-LOC-NBR,                             09400000
094100                   :XLT00010-OPN-DTE,                             09410000
094200                   :XLT00010-CLO-DTE                              09420000
094300     END-EXEC.                                                    09430000
094400                                                                  09440000
094500     EVALUATE TRUE                                                09450000
094600         WHEN SQLCODE = +0                                        09460000
094700              CONTINUE                                            09470000
094800         WHEN SQLCODE = +100                                      09480000
094900              SET PS-EOF-TKRPRPM-CSR TO TRUE                      09490000
095000         WHEN SQLWARN0 NOT = SPACE                                09500000
095100         WHEN SQLCODE < ZERO                                      09510000
095200         WHEN SQLCODE > ZERO                                      09520000
095300             PERFORM 9100-SQL-ABEND                               09530000
095400     END-EVALUATE.                                                09540000
095500                                                                  09550000
095600                                                                  09560000
095700 3900-CLOSE-TKRPRPM.                                              09570000
095800                                                                  09580000
095900     MOVE '3900-CLOSE-TKRPRPM'                                    09590000
096000         TO PV-ABEND-PARAGRAPH.                                   09600000
096100     MOVE 'CLOSE THE TKRPRPM_CSR'                                 09610000
096200         TO PV-DB2-OPERATION-ATTEMPTED.                           09620000
096300                                                                  09630000
096400     EXEC SQL                                                     09640000
096500         CLOSE TKRPRPM_CSR                                        09650000
096600     END-EXEC.                                                    09660000
096700                                                                  09670000
096800     EVALUATE TRUE                                                09680000
096900         WHEN SQLWARN0 NOT = SPACE                                09690000
097000         WHEN SQLCODE < ZERO                                      09700000
097100         WHEN SQLCODE > ZERO                                      09710000
097200             PERFORM 9100-SQL-ABEND                               09720000
097300         WHEN SQLCODE = ZEROS                                     09730000
097400             CONTINUE                                             09740000
097500     END-EVALUATE.                                                09750000
097600                                                                  09760000
097610*** PRB0064829 START                                              09761016
097620******************************************************************09762016
097640 4000-GET-OTB.                                                    09764016
097641******************************************************************09764116
097650                                                                  09765016
097667     PERFORM 4010-GET-OTB-PERIOD.                                 09766724
097670                                                                  09767016
097690     PERFORM POPD055-CALC-WEEKLY-OTB.                             09769016
097693     IF POWS055-NO-ERROR                                          09769324
097694           MOVE POWS055-OTB-MONTH    TO PV-OTB-MON-CH             09769424
097695           MOVE PC-MONTH-ABBR (PV-OTB-MON-NM)                     09769524
097696                                     TO PV-OTB-MONTH              09769624
097697           MOVE POWS055-OTB-YY       TO PV-OTB-YY                 09769724
097698           MOVE PV-OTB               TO PC002-OPEN-TO-BUY-PERIOD  09769824
097699           MOVE POWS055-OTB-FSCL-WEEK-NBR                         09769924
097700                                     TO PC002-OPEN-TO-BUY-WEEK-NBR09770024
097701     ELSE                                                         09770124
097702           MOVE SPACES               TO PC002-OPEN-TO-BUY-PERIOD  09770224
097703           MOVE ZEROES               TO PC002-OPEN-TO-BUY-WEEK-NBR09770324
097704     END-IF.                                                      09770424
097705                                                                  09770524
097706******************************************************************09770624
097707 4010-GET-OTB-PERIOD.                                             09770724
097708******************************************************************09770824
097709                                                                  09770924
097710      MOVE '4010-GET-OTB-PERIOD'     TO PV-ABEND-PARAGRAPH.       09771024
097711                                                                  09771124
097712         EXEC SQL                                                 09771224
097713             SELECT A.OTB_PER_NBR                                 09771324
097714                  , B.DONT_SHIP_BEF_DTE                           09771424
097715               INTO :PURCHS-OTB-PER-NBR                           09771524
097716                  , :PLNSHP-DONT-SHIP-BEF-DTE                     09771624
097717               FROM TPURCHS A                                     09771724
097718                  , TPLNSHP B                                     09771824
097719              WHERE A.PO_NBR         = :DK-ORD-NBR                09771924
097720                AND A.VER_STATUS_CDE = 'A'                        09772024
097721                AND B.PO_NBR         = A.PO_NBR                   09772124
097722                AND B.VER_STATUS_CDE = 'A'                        09772224
097723                WITH UR                                           09772324
097724         END-EXEC                                                 09772424
097725                                                                  09772524
097726         EVALUATE TRUE                                            09772624
097727             WHEN SQLCODE = +0                                    09772724
097728               MOVE PLNSHP-DONT-SHIP-BEF-DTE TO POWS055-INPUT-DATE09772825
097729             WHEN SQLCODE = +100                                  09772916
097730               MOVE SPACES                   TO POWS055-INPUT-DATE09773025
097732             WHEN OTHER                                           09773216
097733               MOVE 'SELECT OTB PERIOD'                           09773325
097734                                     TO PV-DB2-OPERATION-ATTEMPTED09773418
097737               PERFORM 9100-SQL-ABEND                             09773725
097738         END-EVALUATE.                                            09773816
097739                                                                  09773916
097740*** PRB0064829 END                                                09774016
097750                                                                  09775000
097800 4500-GET-PROCESSING-AREA.                                        09780000
097810     SET  PS-TWKORIN-FOUND-NO  TO TRUE.                           09781001
097820                                                                  09782001
097900     PERFORM 4550-OPEN-TWKORIN.                                   09790000
098000     PERFORM 4600-FETCH-TWKORIN-LOOP.                             09800000
098100                                                                  09810000
098110     IF  PS-TWKORIN-FOUND-NO                                      09811002
098111***     MOVE  RECEIV-OPER-UNT-ID       TO  PV-DISP-OPER           09811114
098113***     MOVE  RECEIV-CURR-OPER-UNT-ID  TO  PV-DISP-CURR           09811314
098114***     MOVE  DK-ORD-NBR       TO  PV-DISP-PO                     09811414
098115***     MOVE  DK-REC-SEQ-NBR   TO  PV-DISP-RCVR                   09811514
098116***     MOVE  DK-ORD-LNE-NBR   TO  PV-DISP-LINE                   09811614
098120***     DISPLAY 'NO WORK ORDER INSTRUCTION FOUND - '              09812014
098131***              PV-DISP-PO  '-'                                  09813114
098140***              PV-DISP-RCVR '-'                                 09814014
098150***              PV-DISP-LINE                                     09815014
098151***              '   OPER-'                                       09815114
098152***              PV-DISP-OPER                                     09815214
098153***              '   CURR-'                                       09815314
098154***              PV-DISP-CURR                                     09815414
098155         PERFORM 4510-OPEN-TWKORIN-NO-OPER                        09815511
098156         PERFORM 4610-FETCH-TWKORIN-NO-OP-LOOP                    09815612
098157         IF  PS-TWKORIN-NO-OPER-FOUND-NO                          09815713
098158            MOVE  RECEIV-OPER-UNT-ID       TO  PV-DISP-OPER       09815813
098159            MOVE  RECEIV-CURR-OPER-UNT-ID  TO  PV-DISP-CURR       09815913
098160            MOVE  DK-ORD-NBR       TO  PV-DISP-PO                 09816013
098161            MOVE  DK-REC-SEQ-NBR   TO  PV-DISP-RCVR               09816113
098162            MOVE  DK-ORD-LNE-NBR   TO  PV-DISP-LINE               09816213
098163            DISPLAY 'NO WORK ORDER INSTRUCTION FOUND - '          09816313
098164                     PV-DISP-PO  '-'                              09816413
098165                     PV-DISP-RCVR '-'                             09816513
098166                     PV-DISP-LINE                                 09816613
098167                     '   OPER-'                                   09816713
098168                     PV-DISP-OPER                                 09816813
098169                     '   CURR-'                                   09816913
098170                     PV-DISP-CURR                                 09817013
098171                     '   *** NO OPER ***'                         09817113
098172     END-IF.                                                      09817202
098180                                                                  09818001
098200 4510-OPEN-TWKORIN-NO-OPER.                                       09820012
098300     MOVE '4510-OPEN-TWKORIN-NO-OPER'                             09830011
098400         TO PV-ABEND-PARAGRAPH.                                   09840000
098500     MOVE 'OPEN THE TWORIN_NO_OPER_CSR'                           09850011
098600         TO PV-DB2-OPERATION-ATTEMPTED.                           09860000
098700                                                                  09870000
098800     EXEC SQL                                                     09880000
098900         OPEN TWKORIN_NO_OPER_CSR                                 09890011
099000     END-EXEC.                                                    09900000
099100                                                                  09910000
099200     EVALUATE TRUE                                                09920000
099300         WHEN SQLWARN0 NOT = SPACE                                09930000
099400         WHEN SQLCODE < ZERO                                      09940000
099500         WHEN SQLCODE > ZERO                                      09950000
099600             PERFORM 9100-SQL-ABEND                               09960000
099700         WHEN SQLCODE = ZEROS                                     09970000
099800              CONTINUE                                            09980000
099900     END-EVALUATE.                                                09990000
100000                                                                  10000000
100001 4515-CLOSE-TWKORIN-NO-OPER.                                      10000111
100002     MOVE '4515-CLOSE-TWKORIN-NO-OPER'                            10000211
100003         TO PV-ABEND-PARAGRAPH.                                   10000311
100004     MOVE 'CLOSE THE TWORIN_NO_OPER_CSR'                          10000411
100005         TO PV-DB2-OPERATION-ATTEMPTED.                           10000511
100006                                                                  10000611
100007     EXEC SQL                                                     10000711
100008         CLOSE TWKORIN_NO_OPER_CSR                                10000811
100009     END-EXEC.                                                    10000911
100010                                                                  10001011
100011     EVALUATE TRUE                                                10001111
100012         WHEN SQLWARN0 NOT = SPACE                                10001211
100013         WHEN SQLCODE < ZERO                                      10001311
100014         WHEN SQLCODE > ZERO                                      10001411
100015             PERFORM 9100-SQL-ABEND                               10001511
100016         WHEN SQLCODE = ZEROS                                     10001611
100017             CONTINUE                                             10001711
100018     END-EVALUATE.                                                10001811
100019                                                                  10001911
100020 4550-OPEN-TWKORIN.                                               10002011
100021     MOVE '4550-OPEN-TWKORIN'                                     10002111
100030         TO PV-ABEND-PARAGRAPH.                                   10003011
100040     MOVE 'OPEN THE TWORIN_CSR'                                   10004011
100050         TO PV-DB2-OPERATION-ATTEMPTED.                           10005011
100060                                                                  10006011
100070     EXEC SQL                                                     10007011
100080         OPEN TWKORIN_CSR                                         10008011
100090     END-EXEC.                                                    10009011
100091                                                                  10009111
100092     EVALUATE TRUE                                                10009211
100093         WHEN SQLWARN0 NOT = SPACE                                10009311
100094         WHEN SQLCODE < ZERO                                      10009411
100095         WHEN SQLCODE > ZERO                                      10009511
100096             PERFORM 9100-SQL-ABEND                               10009611
100097         WHEN SQLCODE = ZEROS                                     10009711
100098              CONTINUE                                            10009811
100099     END-EVALUATE.                                                10009911
100100                                                                  10010011
100110 4575-CLOSE-TWKORIN.                                              10011000
100200     MOVE '4575-CLOSE-TWKORIN'                                    10020000
100300         TO PV-ABEND-PARAGRAPH.                                   10030000
100400     MOVE 'CLOSE THE TWORIN_CSR'                                  10040000
100500         TO PV-DB2-OPERATION-ATTEMPTED.                           10050000
100600                                                                  10060000
100700     EXEC SQL                                                     10070000
100800         CLOSE TWKORIN_CSR                                        10080000
100900     END-EXEC.                                                    10090000
101000                                                                  10100000
101100     EVALUATE TRUE                                                10110000
101200         WHEN SQLWARN0 NOT = SPACE                                10120000
101300         WHEN SQLCODE < ZERO                                      10130000
101400         WHEN SQLCODE > ZERO                                      10140000
101500             PERFORM 9100-SQL-ABEND                               10150000
101600         WHEN SQLCODE = ZEROS                                     10160000
101700             CONTINUE                                             10170000
101800     END-EVALUATE.                                                10180000
101900                                                                  10190000
102000 4600-FETCH-TWKORIN-LOOP.                                         10200000
102001                                                                  10200100
102010*** DMH - 10-20-2008 BEGIN                                        10201000
102020     INITIALIZE  WKORIN-LNE-LOC-CDE                               10202000
102030                 PC002-LNE-LOC-CDE.                               10203000
102040*** DMH - 10-20-2008 END                                          10204000
102050                                                                  10205000
102060     SET  PS-TWKORIN-FOUND-NO  TO  TRUE.                          10206001
102100     MOVE 'N' TO PS-TWKORIN-CURSOR-SW.                            10210000
102200     MOVE 'N' TO PS-TWKORIN-ZERO-SW.                              10220000
102300     PERFORM 4650-FETCH-TWKORIN.                                  10230000
102400     IF  PS-EOF-TWKORIN-CSR                                       10240000
102500       OR WKORIN-STRT-TMST > PC-DEFAULT-DATE                      10250000
102600         PERFORM 4575-CLOSE-TWKORIN                               10260000
102700         PERFORM 4800-OPEN-WKORIN0-CURSOR                         10270000
102701* DMH - BEGIN                                                     10270107
102710         MOVE  PC-DEFAULT-DATE  TO  WKORIN-STRT-TMST              10271008
102711         SET   PS-FIRST-TIME-TWKORIN0 TO TRUE                     10271108
102720* DMH - END                                                       10272008
102800         PERFORM 4850-FETCH-TWKORIN-ZERO                          10280000
102810         IF  PS-FIRST-TIME-TWKORIN0  AND                          10281010
102820             PS-EOF-TWKORIN-CSR                                   10282008
102821                 PERFORM 4805-CLOSE-WKORIN0                       10282108
102830         ELSE                                                     10283008
102900             IF  WKORIN-STRT-TMST > PC-DEFAULT-DATE               10290008
102910                 SET  PS-TWKORIN-FOUND-YES  TO  TRUE              10291008
103000                 MOVE WKORIN-PRC-FCLTY-AREA-ID TO                 10300008
103100                          PC002-PROCESS-AREA                      10310008
103200                 MOVE WKORIN-LNE-LOC-CDE TO                       10320008
103300                          PC002-LNE-LOC-CDE                       10330008
103400                 MOVE 'N' TO PS-TWKORIN-CURSOR-SW                 10340008
103500                 PERFORM 4805-CLOSE-WKORIN0                       10350008
103600             ELSE                                                 10360008
103610                 SET  PS-TWKORIN-FOUND-YES  TO  TRUE              10361008
103700                 MOVE WKORIN-PRC-FCLTY-AREA-ID TO                 10370008
103800                          PC002-PROCESS-AREA                      10380008
103900                 MOVE WKORIN-LNE-LOC-CDE TO                       10390008
104000                          PC002-LNE-LOC-CDE                       10400008
104100                 PERFORM 4850-FETCH-TWKORIN-ZERO                  10410008
104200                    UNTIL PS-EOF-TWKORIN-CSR                      10420008
104300                 PERFORM 4805-CLOSE-WKORIN0                       10430008
104400             END-IF                                               10440008
104410         END-IF                                                   10441008
104500     ELSE                                                         10450000
104510         SET  PS-TWKORIN-FOUND-YES  TO  TRUE                      10451001
104600         MOVE WKORIN-PRC-FCLTY-AREA-ID TO PC002-PROCESS-AREA      10460000
104700         MOVE WKORIN-LNE-LOC-CDE TO                               10470000
104800                  PC002-LNE-LOC-CDE                               10480000
104900         PERFORM 4650-FETCH-TWKORIN                               10490000
105000             UNTIL PS-EOF-TWKORIN-CSR                             10500000
105100         PERFORM 4575-CLOSE-TWKORIN                               10510000
105200     END-IF.                                                      10520000
105300                                                                  10530000
105310 4610-FETCH-TWKORIN-NO-OP-LOOP.                                   10531012
105320                                                                  10532011
105330*** DMH - 10-20-2008 BEGIN                                        10533011
105340     INITIALIZE  WKORIN-LNE-LOC-CDE                               10534011
105350                 PC002-LNE-LOC-CDE.                               10535011
105360*** DMH - 10-20-2008 END                                          10536011
105370                                                                  10537011
105380     SET  PS-TWKORIN-NO-OPER-FOUND-NO  TO  TRUE.                  10538013
105390     MOVE 'N' TO PS-TWKORIN-NO-OPER-CURSOR-SW.                    10539011
105391     MOVE 'N' TO PS-TWKORIN-NO-OPER-ZERO-SW.                      10539111
105392     PERFORM 4660-FETCH-TWKORIN-NO-OPER.                          10539211
105393     IF  PS-EOF-TWKORIN-NO-OPER-CSR                               10539311
105394       OR WKORIN-STRT-TMST > PC-DEFAULT-DATE                      10539411
105395         PERFORM 4515-CLOSE-TWKORIN-NO-OPER                       10539511
105396         PERFORM 4810-OPEN-WKORIN0-NO-OPER-CSR                    10539613
105397* DMH - BEGIN                                                     10539711
105398         MOVE  PC-DEFAULT-DATE  TO  WKORIN-STRT-TMST              10539811
105399         SET   PS-FIRST-TIME-TWKORIN0-NOP TO TRUE                 10539913
105400* DMH - END                                                       10540011
105401         PERFORM 4860-FETCH-TWKORIN-NO-OP-ZERO                    10540112
105402         IF  PS-FIRST-TIME-TWKORIN0-NOP     AND                   10540213
105403             PS-EOF-TWKORIN-NO-OPER-CSR                           10540311
105404                 PERFORM 4815-CLOSE-WKORIN0-NO-OPER               10540411
105405         ELSE                                                     10540511
105406             IF  WKORIN-STRT-TMST > PC-DEFAULT-DATE               10540611
105407                 SET  PS-TWKORIN-NO-OPER-FOUND-YES TO  TRUE       10540713
105408                 MOVE WKORIN-PRC-FCLTY-AREA-ID TO                 10540811
105409                          PC002-PROCESS-AREA                      10540911
105410                 MOVE WKORIN-LNE-LOC-CDE TO                       10541011
105411                          PC002-LNE-LOC-CDE                       10541111
105412                 MOVE 'N' TO PS-TWKORIN-NO-OPER-CURSOR-SW         10541211
105413                 PERFORM 4815-CLOSE-WKORIN0-NO-OPER               10541311
105414             ELSE                                                 10541411
105415                 SET  PS-TWKORIN-NO-OPER-FOUND-YES  TO  TRUE      10541511
105416                 MOVE WKORIN-PRC-FCLTY-AREA-ID TO                 10541611
105417                          PC002-PROCESS-AREA                      10541711
105418                 MOVE WKORIN-LNE-LOC-CDE TO                       10541811
105419                          PC002-LNE-LOC-CDE                       10541911
105420                 PERFORM 4860-FETCH-TWKORIN-NO-OP-ZERO            10542012
105421                    UNTIL PS-EOF-TWKORIN-NO-OPER-CSR              10542111
105422                 PERFORM 4815-CLOSE-WKORIN0-NO-OPER               10542211
105423             END-IF                                               10542311
105424         END-IF                                                   10542411
105425     ELSE                                                         10542511
105426         SET  PS-TWKORIN-NO-OPER-FOUND-YES  TO  TRUE              10542611
105427         MOVE WKORIN-PRC-FCLTY-AREA-ID TO PC002-PROCESS-AREA      10542711
105428         MOVE WKORIN-LNE-LOC-CDE TO                               10542811
105429                  PC002-LNE-LOC-CDE                               10542911
105430         PERFORM 4660-FETCH-TWKORIN-NO-OPER                       10543011
105431             UNTIL PS-EOF-TWKORIN-NO-OPER-CSR                     10543111
105432         PERFORM 4515-CLOSE-TWKORIN-NO-OPER                       10543211
105433     END-IF.                                                      10543311
105434                                                                  10543411
105440 4650-FETCH-TWKORIN.                                              10544000
105500     MOVE '4650-FETCH-TWKORIN'                                    10550000
105600         TO PV-ABEND-PARAGRAPH.                                   10560000
105700     MOVE 'FETCH THE TWORIN_CSR'                                  10570000
105800         TO PV-DB2-OPERATION-ATTEMPTED.                           10580000
105900                                                                  10590000
106000     EXEC SQL                                                     10600000
106100          FETCH TWKORIN_CSR                                       10610000
106200             INTO  :WKORIN-STRT-TMST,                             10620000
106300                   :WKORIN-STOP-TMST,                             10630000
106400                   :WKORIN-PRC-FCLTY-AREA-ID,                     10640000
106500                   :WKORIN-SCREEN-SEQ-NBR,                        10650000
106600                   :WKORIN-LNE-LOC-CDE                            10660000
106700     END-EXEC.                                                    10670000
106800                                                                  10680000
106900     EVALUATE TRUE                                                10690000
107000         WHEN SQLCODE = +0                                        10700000
107100              PERFORM 4675-CHECK-DATES                            10710000
107200         WHEN SQLCODE = +100                                      10720000
107300              SET PS-EOF-TWKORIN-CSR TO TRUE                      10730000
107400         WHEN SQLWARN0 NOT = SPACE                                10740000
107500         WHEN SQLCODE < ZERO                                      10750000
107600         WHEN SQLCODE > ZERO                                      10760000
107700             PERFORM 9100-SQL-ABEND                               10770000
107800     END-EVALUATE.                                                10780000
107900                                                                  10790000
107910 4660-FETCH-TWKORIN-NO-OPER.                                      10791011
107920     MOVE '4660-FETCH-TWKORIN-NO-OPER'                            10792011
107930         TO PV-ABEND-PARAGRAPH.                                   10793011
107940     MOVE 'FETCH THE TWORIN_NO_OPER_CSR'                          10794011
107950         TO PV-DB2-OPERATION-ATTEMPTED.                           10795011
107960                                                                  10796011
107970     EXEC SQL                                                     10797011
107980          FETCH TWKORIN_NO_OPER_CSR                               10798011
107990             INTO  :WKORIN-STRT-TMST,                             10799011
107991                   :WKORIN-STOP-TMST,                             10799111
107992                   :WKORIN-PRC-FCLTY-AREA-ID,                     10799211
107993                   :WKORIN-SCREEN-SEQ-NBR,                        10799311
107994                   :WKORIN-LNE-LOC-CDE                            10799411
107995     END-EXEC.                                                    10799511
107996                                                                  10799611
107997     EVALUATE TRUE                                                10799711
107998         WHEN SQLCODE = +0                                        10799811
108000              PERFORM 4675-CHECK-DATES                            10800011
108001         WHEN SQLCODE = +100                                      10800111
108002              SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE              10800211
108003         WHEN SQLWARN0 NOT = SPACE                                10800311
108004         WHEN SQLCODE < ZERO                                      10800411
108005         WHEN SQLCODE > ZERO                                      10800511
108006             PERFORM 9100-SQL-ABEND                               10800611
108007     END-EVALUATE.                                                10800711
108008                                                                  10800811
108010 4675-CHECK-DATES.                                                10801000
108100     IF  WKORIN-STRT-TMST LESS THAN PC-DEFAULT-DATE               10810000
108200         IF  WKORIN-STOP-TMST LESS THAN PC-DEFAULT-DATE           10820000
108300             MOVE WKORIN-LNE-LOC-CDE TO                           10830000
108400                      PC002-LNE-LOC-CDE                           10840000
108500             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     10850000
108600                        PC002-PROCESS-AREA                        10860000
108700         ELSE                                                     10870000
108800             MOVE WKORIN-LNE-LOC-CDE TO                           10880000
108900                      PC002-LNE-LOC-CDE                           10890000
109000             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     10900000
109100                        PC002-PROCESS-AREA                        10910000
109200             SET PS-EOF-TWKORIN-CSR TO TRUE                       10920000
109210             SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE               10921011
109300         END-IF                                                   10930000
109400     ELSE                                                         10940000
109500         SET PS-EOF-TWKORIN-CSR TO TRUE                           10950000
109510         SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE                   10951011
109600     END-IF.                                                      10960000
109700                                                                  10970000
109800 4800-OPEN-WKORIN0-CURSOR.                                        10980000
109900     MOVE '4800-OPEN-WKORIN0-CURSOR'                              10990000
110000         TO PV-ABEND-PARAGRAPH.                                   11000000
110100     MOVE 'OPEN THE WKORIN0_CSR'                                  11010000
110200         TO PV-DB2-OPERATION-ATTEMPTED.                           11020000
110300                                                                  11030000
110400     EXEC SQL                                                     11040000
110500         OPEN WKORIN0_CSR                                         11050000
110600     END-EXEC.                                                    11060000
110700                                                                  11070000
110800     EVALUATE TRUE                                                11080000
110900         WHEN SQLWARN0 NOT = SPACE                                11090000
111000         WHEN SQLCODE < ZERO                                      11100000
111100         WHEN SQLCODE > ZERO                                      11110000
111200             PERFORM 9100-SQL-ABEND                               11120000
111300         WHEN SQLCODE = ZERO                                      11130000
111400             CONTINUE                                             11140000
111500     END-EVALUATE.                                                11150000
111501                                                                  11150111
111510 4810-OPEN-WKORIN0-NO-OPER-CSR.                                   11151013
111520     MOVE '4810-OPEN-WKORIN0-NO-OPER-CSR'                         11152013
111530         TO PV-ABEND-PARAGRAPH.                                   11153011
111540     MOVE 'OPEN THE WKORIN0_NO_OPER_CSR'                          11154011
111550         TO PV-DB2-OPERATION-ATTEMPTED.                           11155011
111560                                                                  11156011
111570     EXEC SQL                                                     11157011
111580         OPEN WKORIN0_NO_OPER_CSR                                 11158011
111590     END-EXEC.                                                    11159011
111591                                                                  11159111
111592     EVALUATE TRUE                                                11159211
111593         WHEN SQLWARN0 NOT = SPACE                                11159311
111594         WHEN SQLCODE < ZERO                                      11159411
111595         WHEN SQLCODE > ZERO                                      11159511
111596             PERFORM 9100-SQL-ABEND                               11159611
111597         WHEN SQLCODE = ZERO                                      11159711
111598             CONTINUE                                             11159811
111599     END-EVALUATE.                                                11159911
111600                                                                  11160000
111700 4805-CLOSE-WKORIN0.                                              11170000
111800     MOVE '4805-CLOSE-WKORIN0'                                    11180000
111900         TO PV-ABEND-PARAGRAPH.                                   11190000
112000     MOVE 'CLOSE THE WKORIN0_CSR'                                 11200000
112100         TO PV-DB2-OPERATION-ATTEMPTED.                           11210000
112200                                                                  11220000
112300     EXEC SQL                                                     11230000
112400         CLOSE WKORIN0_CSR                                        11240000
112500     END-EXEC.                                                    11250000
112600                                                                  11260000
112700      EVALUATE TRUE                                               11270000
112800          WHEN SQLWARN0 NOT = SPACE                               11280000
112900          WHEN SQLCODE < ZERO                                     11290000
113000          WHEN SQLCODE > ZERO                                     11300000
113100             PERFORM 9100-SQL-ABEND                               11310000
113200          WHEN SQLCODE = 0                                        11320000
113300              CONTINUE                                            11330000
113400      END-EVALUATE.                                               11340000
113500                                                                  11350000
113510 4815-CLOSE-WKORIN0-NO-OPER.                                      11351011
113520     MOVE '4815-CLOSE-WKORIN0-NO-OPER'                            11352011
113530         TO PV-ABEND-PARAGRAPH.                                   11353011
113540     MOVE 'CLOSE THE WKORIN0_CSR_NO_OPER'                         11354011
113550         TO PV-DB2-OPERATION-ATTEMPTED.                           11355011
113560                                                                  11356011
113570     EXEC SQL                                                     11357011
113580         CLOSE WKORIN0_NO_OPER_CSR                                11358011
113590     END-EXEC.                                                    11359011
113591                                                                  11359111
113592      EVALUATE TRUE                                               11359211
113593          WHEN SQLWARN0 NOT = SPACE                               11359311
113594          WHEN SQLCODE < ZERO                                     11359411
113595          WHEN SQLCODE > ZERO                                     11359511
113596             PERFORM 9100-SQL-ABEND                               11359611
113597          WHEN SQLCODE = 0                                        11359711
113598              CONTINUE                                            11359811
113599      END-EVALUATE.                                               11359911
113600                                                                  11360011
113610 4850-FETCH-TWKORIN-ZERO.                                         11361000
113700     MOVE '4850-FETCH-TWKORIN-ZERO'                               11370000
113800         TO PV-ABEND-PARAGRAPH.                                   11380000
113900     MOVE 'FETCH THE WKORIN0_CSR'                                 11390000
114000         TO PV-DB2-OPERATION-ATTEMPTED.                           11400000
114100                                                                  11410000
114200     EXEC SQL                                                     11420000
114300          FETCH WKORIN0_CSR                                       11430000
114400             INTO  :WKORIN-STRT-TMST,                             11440000
114500                   :WKORIN-STOP-TMST,                             11450000
114600                   :WKORIN-PRC-FCLTY-AREA-ID,                     11460000
114700                   :WKORIN-SCREEN-SEQ-NBR,                        11470000
114800                   :WKORIN-LNE-LOC-CDE                            11480000
114900     END-EXEC.                                                    11490000
115000                                                                  11500000
115100     EVALUATE TRUE                                                11510000
115200         WHEN SQLCODE = +0                                        11520000
115210              SET  PS-FIRST-TIME-TWKORIN0-NOP-NO TO  TRUE         11521013
115300              PERFORM 4860-CHECK-DATES                            11530000
115400         WHEN SQLCODE = +100                                      11540000
115500              SET PS-EOF-TWKORIN-CSR TO TRUE                      11550000
115600         WHEN SQLWARN0 NOT = SPACE                                11560000
115700         WHEN SQLCODE < ZERO                                      11570000
115800         WHEN SQLCODE > ZERO                                      11580000
115900             PERFORM 9100-SQL-ABEND                               11590000
116000     END-EVALUATE.                                                11600000
116100                                                                  11610000
116110 4860-FETCH-TWKORIN-NO-OP-ZERO.                                   11611012
116120     MOVE '4850-FETCH-TWKORIN-NO-OPER-ZERO'                       11612011
116130         TO PV-ABEND-PARAGRAPH.                                   11613011
116140     MOVE 'FETCH THE WKORIN0_NO_OPER_CSR'                         11614011
116150         TO PV-DB2-OPERATION-ATTEMPTED.                           11615011
116160                                                                  11616011
116170     EXEC SQL                                                     11617011
116180          FETCH WKORIN0_NO_OPER_CSR                               11618011
116190             INTO  :WKORIN-STRT-TMST,                             11619011
116191                   :WKORIN-STOP-TMST,                             11619111
116192                   :WKORIN-PRC-FCLTY-AREA-ID,                     11619211
116193                   :WKORIN-SCREEN-SEQ-NBR,                        11619311
116194                   :WKORIN-LNE-LOC-CDE                            11619411
116195     END-EXEC.                                                    11619511
116196                                                                  11619611
116197     EVALUATE TRUE                                                11619711
116198         WHEN SQLCODE = +0                                        11619811
116199              SET  PS-FIRST-TIME-TWKORIN0-NOP-NO TO  TRUE         11619913
116200              PERFORM 4860-CHECK-DATES                            11620011
116201         WHEN SQLCODE = +100                                      11620111
116202              SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE              11620211
116203         WHEN SQLWARN0 NOT = SPACE                                11620311
116204         WHEN SQLCODE < ZERO                                      11620411
116205         WHEN SQLCODE > ZERO                                      11620511
116206             PERFORM 9100-SQL-ABEND                               11620611
116207     END-EVALUATE.                                                11620711
116208                                                                  11620811
116210 4860-CHECK-DATES.                                                11621000
116300     IF  WKORIN-STRT-TMST LESS THAN PC-DEFAULT-DATE               11630000
116400         IF  WKORIN-STOP-TMST LESS THAN PC-DEFAULT-DATE           11640000
116500             MOVE WKORIN-LNE-LOC-CDE TO                           11650000
116600                      PC002-LNE-LOC-CDE                           11660000
116700             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     11670000
116800                        PC002-PROCESS-AREA                        11680000
116900         ELSE                                                     11690000
117000             MOVE WKORIN-LNE-LOC-CDE TO                           11700000
117100                      PC002-LNE-LOC-CDE                           11710000
117200             MOVE WKORIN-PRC-FCLTY-AREA-ID TO                     11720000
117300                        PC002-PROCESS-AREA                        11730000
117400             SET PS-EOF-TWKORIN-CSR TO TRUE                       11740000
117410             SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE               11741011
117500         END-IF                                                   11750000
117600     ELSE                                                         11760000
117700             MOVE WKORIN-LNE-LOC-CDE TO                           11770000
117800                      PC002-LNE-LOC-CDE                           11780000
117900         MOVE WKORIN-PRC-FCLTY-AREA-ID TO                         11790000
118000                    PC002-PROCESS-AREA                            11800000
118100         SET PS-EOF-TWKORIN-CSR TO TRUE                           11810000
118110         SET PS-EOF-TWKORIN-NO-OPER-CSR TO TRUE                   11811011
118200     END-IF.                                                      11820000
118300                                                                  11830000
118400 A100-OPEN-RECEIV-CSR.                                            11840000
118500     MOVE 'A100-OPEN-RECEIV-CSR'                                  11850000
118600         TO PV-ABEND-PARAGRAPH.                                   11860000
118700     MOVE 'OPEN THE RECEIV_CSR'                                   11870000
118800         TO PV-DB2-OPERATION-ATTEMPTED.                           11880000
118900                                                                  11890000
119000     EXEC SQL                                                     11900000
119100         OPEN RECEIV_CSR                                          11910000
119200     END-EXEC.                                                    11920000
119300                                                                  11930000
119400     EVALUATE TRUE                                                11940000
119500         WHEN SQLWARN0 NOT = SPACE                                11950000
119600         WHEN SQLCODE < ZERO                                      11960000
119700         WHEN SQLCODE > ZERO                                      11970000
119800             PERFORM 9100-SQL-ABEND                               11980000
119900         WHEN SQLCODE = ZERO                                      11990000
120000             CONTINUE                                             12000000
120100     END-EVALUATE.                                                12010000
120200                                                                  12020000
120300 X200-CLOSE-RECEIV-CSR.                                           12030000
120400     MOVE 'X200-CLOSE-RECEIV-CSR'                                 12040000
120500         TO PV-ABEND-PARAGRAPH.                                   12050000
120600     MOVE 'CLOSE THE RECEIV_CSR'                                  12060000
120700         TO PV-DB2-OPERATION-ATTEMPTED.                           12070000
120800                                                                  12080000
120900     EXEC SQL                                                     12090000
121000         CLOSE RECEIV_CSR                                         12100000
121100     END-EXEC.                                                    12110000
121200                                                                  12120000
121300     EVALUATE TRUE                                                12130000
121400         WHEN SQLWARN0 NOT = SPACE                                12140000
121500         WHEN SQLCODE < ZERO                                      12150000
121600         WHEN SQLCODE > ZERO                                      12160000
121700             PERFORM 9100-SQL-ABEND                               12170000
121800         WHEN SQLCODE = ZERO                                      12180000
121900             CONTINUE                                             12190000
122000     END-EVALUATE.                                                12200000
122100                                                                  12210000
122200 Y000-FETCH-RECEIV-CSR.                                           12220000
122300     MOVE 'Y000-FETCH-RECEIV-CSR'                                 12230000
122400         TO PV-ABEND-PARAGRAPH.                                   12240000
122500     MOVE 'FETCH THE RECEIV_CSR'                                  12250000
122600         TO PV-DB2-OPERATION-ATTEMPTED.                           12260000
122700                                                                  12270000
122800     INITIALIZE DCLTRECEIV.                                       12280000
122900                                                                  12290000
123000     EXEC SQL                                                     12300000
123100         FETCH  RECEIV_CSR                                        12310000
123200          INTO  :RECEIV-ORD-NBR,                                  12320000
123300                :RECEIV-REC-SEQ-NBR,                              12330000
123400                :RECEIV-PO-VER-NBR,                               12340000
123500                :RECEIV-STATUS-CDE,                               12350000
123600                :RECEIV-PACK-BY-ST-IND,                           12360000
123700                :RECEIV-REC-TMST,                                 12370000
123800                :RECEIV-EXPTED-CART-CNT,                          12380000
123900                :RECEIV-ACTL-CART-CNT,                            12390000
124000                :RECEIV-OPER-UNT-ID,                              12400000
124100                :RECEIV-FCLTY-ID,                                 12410000
124200                :RECEIV-CURR-OPER-UNT-ID,                         12420000
124300                :RECEIV-CURR-FCLTY-ID                             12430000
124400     END-EXEC.                                                    12440000
124500                                                                  12450000
124600     EVALUATE TRUE                                                12460000
124700         WHEN SQLCODE = +100                                      12470000
124800             SET SW-THATS-ALL-FOLKS  TO  TRUE                     12480000
124900         WHEN SQLWARN0 NOT = SPACE                                12490000
125000         WHEN SQLCODE < ZERO                                      12500000
125100         WHEN SQLCODE > ZERO                                      12510000
125200             PERFORM 9100-SQL-ABEND                               12520000
125300         WHEN SQLCODE = ZERO                                      12530000
125400             CONTINUE                                             12540000
125500     END-EVALUATE.                                                12550000
125600                                                                  12560000
125700 7010-GET-PRIMARY-VNDR-NME.                                       12570000
125800     MOVE '7010-GET-PRIMARY-VNDR-NME'                             12580000
125900         TO PV-ABEND-PARAGRAPH.                                   12590000
126000     MOVE 'SELECT PRIMARY VNDR NAME'                              12600000
126100         TO PV-DB2-OPERATION-ATTEMPTED.                           12610000
126200                                                                  12620000
126300     INITIALIZE DCLTENTNME.                                       12630000
126400                                                                  12640000
126500     EXEC SQL                                                     12650000
126600         SELECT  ENT_NAME_DESC                                    12660000
126700           INTO  :ENTNME-ENT-NAME-DESC                            12670000
126800           FROM  TENTNME                                          12680000
126900          WHERE  (ENT_ID    =  :PURCHS-ENT-ID                     12690000
127000            AND   TYPE_CDE  =  '01')                              12700000
127010          WITH UR                                                 12701015
127100     END-EXEC.                                                    12710000
127200                                                                  12720000
127300     EVALUATE TRUE                                                12730000
127400         WHEN SQLCODE = ZERO                                      12740000
127500              MOVE ENTNME-ENT-NAME-DESC TO PC002-VNDR-NME         12750000
127600         WHEN SQLCODE = +100                                      12760000
127700              MOVE SPACES               TO PC002-VNDR-NME         12770000
127800         WHEN SQLWARN0 NOT = SPACE                                12780000
127900         WHEN SQLCODE < ZERO                                      12790000
128000         WHEN SQLCODE > ZERO                                      12800000
128100             PERFORM 9100-SQL-ABEND                               12810000
128200     END-EVALUATE.                                                12820000
128300                                                                  12830000
128400 7020-GET-TPURCHS-INFO.                                           12840000
128500     MOVE '7020-GET-TPURCHS-INFO'                                 12850000
128600         TO PV-ABEND-PARAGRAPH.                                   12860000
128700     MOVE 'GET INFO FROM TPURCHS'                                 12870000
128800         TO PV-DB2-OPERATION-ATTEMPTED.                           12880000
128900                                                                  12890000
129000     INITIALIZE DCLTPURCHS.                                       12900000
129100                                                                  12910000
129200     EXEC SQL                                                     12920000
129300         SELECT  NEW_STR_PO_IND                                   12930000
129400                ,DEPT_NBR                                         12940000
129500                ,ENT_ID                                           12950000
129600           INTO  :PURCHS-NEW-STR-PO-IND                           12960000
129700                ,:PURCHS-DEPT-NBR                                 12970000
129800                ,:PURCHS-ENT-ID                                   12980000
129900           FROM  TPURCHS                                          12990000
130000          WHERE  PO_NBR          =  :RECEIV-ORD-NBR               13000000
130100            AND  VER_NBR         =  :RECEIV-PO-VER-NBR            13010000
130200            AND  PO_CATEG_CDE    =  'MR'                          13020000
130210           WITH UR                                                13021016
130300     END-EXEC.                                                    13030000
130400                                                                  13040000
130500     EVALUATE TRUE                                                13050000
130600         WHEN SQLCODE = ZERO                                      13060000
130700              MOVE PURCHS-NEW-STR-PO-IND TO PC002-NEW-STR-IND     13070000
130800              MOVE PURCHS-DEPT-NBR       TO PC002-DEPT-NBR        13080000
130900         WHEN SQLCODE = +100                                      13090000
131000              MOVE SPACES                TO PC002-NEW-STR-IND     13100000
131100                                            PC002-DEPT-NBR        13110000
131200         WHEN SQLWARN0 NOT = SPACE                                13120000
131300         WHEN SQLCODE < ZERO                                      13130000
131400         WHEN SQLCODE > ZERO                                      13140000
131500             PERFORM 9100-SQL-ABEND                               13150000
131600     END-EVALUATE.                                                13160000
131700                                                                  13170000
131800 7021-GET-SHRT-NM.                                                13180000
131900     MOVE '7021-GET-SHRT-NM'                                      13190000
132000         TO PV-ABEND-PARAGRAPH.                                   13200000
132100     MOVE 'GET SEASONAL SET SHORT NAME'                           13210000
132200         TO PV-DB2-OPERATION-ATTEMPTED.                           13220000
132300                                                                  13230000
132400     INITIALIZE PURCHS-SEASET-SHRT-NM                             13240000
132500                                                                  13250000
132600     EXEC SQL                                                     13260000
132700         SELECT                                                   13270000
132800                 SEASET_SHRT_NM                                   13280000
132900             INTO                                                 13290000
133000                :PURCHS-SEASET-SHRT-NM                            13300000
133100           FROM  TPURCHS                                          13310000
133200          WHERE  PO_NBR          =  :RECEIV-ORD-NBR               13320000
133300            AND  VER_STATUS_CDE  =  'A'                           13330000
133310           WITH UR                                                13331016
133400     END-EXEC.                                                    13340000
133500                                                                  13350000
133600     EVALUATE TRUE                                                13360000
133700         WHEN SQLCODE = ZERO                                      13370000
133800              MOVE PURCHS-SEASET-SHRT-NM TO PC002-SEASET-NM       13380000
133900         WHEN SQLCODE = +100                                      13390000
134000              MOVE SPACES                TO PC002-SEASET-NM       13400000
134100         WHEN SQLWARN0 NOT = SPACE                                13410000
134200         WHEN SQLCODE < ZERO                                      13420000
134300         WHEN SQLCODE > ZERO                                      13430000
134400             PERFORM 9100-SQL-ABEND                               13440000
134500     END-EVALUATE.                                                13450000
134600                                                                  13460000
134700 7030-GET-AD-PICTURE.                                             13470000
134800     MOVE '7030-GET-AD-PICTURE'                                   13480000
134900         TO PV-ABEND-PARAGRAPH.                                   13490000
135000     MOVE 'GET AD PICTURE'                                        13500000
135100         TO PV-DB2-OPERATION-ATTEMPTED.                           13510000
135200                                                                  13520000
135300     MOVE SPACES TO PC002-AD-PICTURE-IND.                         13530000
135400                                                                  13540000
135500     EXEC SQL                                                     13550000
135600         SELECT  COUNT(*)                                         13560000
135700           INTO  :WS-COUNT                                        13570000
135800           FROM  TRECITM RITM                                     13580000
135900                ,TPURITM PITM                                     13590000
136000          WHERE  RITM.ORD_NBR         =  :RECEIV-ORD-NBR          13600000
136100            AND  RITM.REC_SEQ_NBR     =  :RECEIV-REC-SEQ-NBR      13610000
136200            AND  RITM.VER_STATUS_CDE  =  'A'                      13620000
136300            AND  RITM.STATUS_CDE      IN ('IP', 'CM')             13630000
136400            AND  RITM.OPER_UNT_ID     =  :RECEIV-OPER-UNT-ID      13640000
136500            AND  RITM.FCLTY_ID        =  :RECEIV-FCLTY-ID         13650000
136600            AND  PITM.PO_NBR          =  RITM.ORD_NBR             13660000
136700            AND  PITM.PO_LNE_NBR      =  RITM.ORD_LNE_NBR         13670000
136800            AND  PITM.VER_NBR         =  RITM.PO_VER_NBR          13680000
136900            AND  PITM.PIC_ITM_IND     =  'Y'                      13690000
137000            WITH UR                                               13700000
137100     END-EXEC.                                                    13710000
137200                                                                  13720000
137300     EVALUATE TRUE                                                13730000
137400         WHEN SQLCODE = +100                                      13740000
137500              MOVE SPACES TO PC002-AD-PICTURE-IND                 13750000
137600         WHEN SQLWARN0 NOT = SPACE                                13760000
137700         WHEN SQLCODE < ZERO                                      13770000
137800         WHEN SQLCODE > ZERO                                      13780000
137900             PERFORM 9100-SQL-ABEND                               13790000
138000         WHEN SQLCODE = ZERO                                      13800000
138100             CONTINUE                                             13810000
138200     END-EVALUATE.                                                13820000
138300                                                                  13830000
138400 7040-GET-TROUBLE.                                                13840000
138500     MOVE '7040-GET-TROUBLE'                                      13850000
138600         TO PV-ABEND-PARAGRAPH.                                   13860000
138700     MOVE 'GET TROUBLE'                                           13870000
138800         TO PV-DB2-OPERATION-ATTEMPTED.                           13880000
138900                                                                  13890000
139000     MOVE SPACES TO PC002-UNRESOLVED-TROUBLE                      13900000
139100                    PC002-MULTI-TROUBLE                           13910000
139200                    PC002-LATEST-TROUBLE.                         13920000
139300***************************************************************** 13930000
139400**** THE PROCESS FOR LOOKING AT TROUBLE IS CHANGING SLIGHTLY.     13940000
139500**** THE NEW PROCESS WILL COUNT ALL THE UNRESOLVED TROUBLE        13950000
139600**** FIRST.  IF THERE IS ONLY ONE, THEN THE DESCRIPTION WILL BE   13960000
139700**** MOVED TO THE PC002-LATEST-TROUBLE FIELD. IF THERE IS MORE    13970000
139800**** THAN ONE UNRESOLVED TROUBLE, A 'Y' WILL BE MOVED TO THE      13980000
139900**** PC002-MULTI-TROUBLE FIELD AND A DESCRIPTION WILL BE MOVED    13990000
140000**** TO THE PC002-LATEST-TROUBLE FIELD.  NEXT, A COUNT OF RESOLVED14000000
140100**** BUT NOT APPROVED TROUBLE WILL BE DONE.  IF THERE IS ONE OR   14010000
140200**** MORE, THEN AN '*' WILL BE MOVED TO THE PC002-UNRESOLVED-     14020000
140300**** TROUBLE FIELD.                                               14030000
140400**** 4/30/2002 - DEANNA BRANTNER                                  14040000
140500***************************************************************** 14050000
140600                                                                  14060000
140700******************* OLD WAY ***********************               14070000
140800*    PERFORM 7042-CALL-ALL-TROUBLE.                               14080000
140900*                                                                 14090000
141000*    IF WS-COUNT GREATER THAN 1                                   14100000
141100*        MOVE '*' TO PC002-MULTI-TROUBLE                          14110000
141200*    END-IF.                                                      14120000
141300*                                                                 14130000
141400*    IF WS-COUNT GREATER THAN ZERO                                14140000
141500*        PERFORM 7044-CALL-UNRESOLVED-TROUBLE                     14150000
141600*        IF WS-COUNT GREATER THAN ZERO                            14160000
141700*            MOVE 'Y' TO PC002-UNRESOLVED-TROUBLE                 14170000
141800*            PERFORM 7046-CALL-LATEST-TROUBLE                     14180000
141900*            MOVE TRBRSN-TRBL-SHT-DESC TO                         14190000
142000*                 PC002-LATEST-TROUBLE                            14200000
142100*        ELSE                                                     14210000
142200*            MOVE SPACES TO PC002-UNRESOLVED-TROUBLE              14220000
142300*                           PC002-MULTI-TROUBLE                   14230000
142400*        END-IF                                                   14240000
142500*    END-IF.                                                      14250000
142600********************* OLD WAY ENDS ******************             14260000
142700                                                                  14270000
142800******************* NEW WAY ***********************               14280000
142900     PERFORM 7044-CALL-UNRESOLVED-TROUBLE.                        14290000
143000     IF WS-COUNT GREATER THAN ZERO                                14300000
143100         PERFORM 7046-CALL-LATEST-TROUBLE                         14310000
143200         MOVE TRBRSN-TRBL-SHT-DESC TO PC002-LATEST-TROUBLE        14320000
143300         IF WS-COUNT GREATER THAN 1                               14330000
143400             MOVE 'Y' TO PC002-MULTI-TROUBLE                      14340000
143500         ELSE                                                     14350000
143600             MOVE SPACES TO PC002-MULTI-TROUBLE                   14360000
143700         END-IF                                                   14370000
143800     ELSE                                                         14380000
143900         MOVE SPACES TO PC002-LATEST-TROUBLE                      14390000
144000     END-IF.                                                      14400000
144100                                                                  14410000
144200     PERFORM 7042-CALL-RESOLVED-TROUBLE.                          14420000
144300     IF WS-COUNT GREATER THAN ZERO                                14430000
144400         MOVE '*' TO PC002-UNRESOLVED-TROUBLE                     14440000
144500     ELSE                                                         14450000
144600         MOVE SPACES TO PC002-UNRESOLVED-TROUBLE                  14460000
144700     END-IF.                                                      14470000
144800                                                                  14480000
144900 7042-CALL-RESOLVED-TROUBLE.                                      14490000
145000     MOVE '7042-CALL-ALL-TROUBLE'                                 14500000
145100         TO PV-ABEND-PARAGRAPH.                                   14510000
145200     EXEC SQL                                                     14520000
145300               SELECT  COUNT(*)                                   14530000
145400               INTO  :WS-COUNT                                    14540000
145500               FROM  TTRBNTF TRB                                  14550000
145600               WHERE TRB.PO_NBR       =  :RECEIV-ORD-NBR          14560000
145700                 AND TRB.REC_SEQ_NBR  =  :RECEIV-REC-SEQ-NBR      14570000
145800                 AND TRB.RESOLVED_IND = 'R'                       14580000
145900               WITH UR                                            14590000
146000     END-EXEC.                                                    14600000
146100                                                                  14610000
146200     EVALUATE TRUE                                                14620000
146300         WHEN SQLCODE = ZERO                                      14630000
146400         WHEN SQLCODE = +100                                      14640000
146500              CONTINUE                                            14650000
146600         WHEN SQLWARN0 NOT = SPACE                                14660000
146700         WHEN SQLCODE < ZERO                                      14670000
146800         WHEN SQLCODE > ZERO                                      14680000
146900             PERFORM 9100-SQL-ABEND                               14690000
147000     END-EVALUATE.                                                14700000
147100                                                                  14710000
147200 7044-CALL-UNRESOLVED-TROUBLE.                                    14720000
147300     MOVE '7044-CALL-UNRESOLVED-TROUBLE'                          14730000
147400         TO PV-ABEND-PARAGRAPH.                                   14740000
147500                                                                  14750000
147600     EXEC SQL                                                     14760000
147700               SELECT  COUNT(*)                                   14770000
147800               INTO  :WS-COUNT                                    14780000
147900               FROM   TTRBNTF TRB                                 14790000
148000               WHERE  TRB.PO_NBR      =  :RECEIV-ORD-NBR          14800000
148100                 AND TRB.REC_SEQ_NBR =  :RECEIV-REC-SEQ-NBR       14810000
148200                 AND TRB.RESOLVED_IND IN('N','I')                 14820000
148300               WITH UR                                            14830000
148400     END-EXEC.                                                    14840000
148500                                                                  14850000
148600     EVALUATE TRUE                                                14860000
148700         WHEN SQLCODE = ZERO                                      14870000
148800         WHEN SQLCODE = +100                                      14880000
148900              CONTINUE                                            14890000
149000         WHEN SQLWARN0 NOT = SPACE                                14900000
149100         WHEN SQLCODE < ZERO                                      14910000
149200         WHEN SQLCODE > ZERO                                      14920000
149300             PERFORM 9100-SQL-ABEND                               14930000
149400     END-EVALUATE.                                                14940000
149500                                                                  14950000
149600 7046-CALL-LATEST-TROUBLE.                                        14960000
149700     MOVE '7046-CALL-LATEST-TROUBLE'                              14970000
149800         TO PV-ABEND-PARAGRAPH.                                   14980000
149900                                                                  14990000
150000     EXEC SQL                                                     15000000
150100         SELECT RSN.TRBL_SHT_DESC                                 15010000
150200         INTO  :TRBRSN-TRBL-SHT-DESC                              15020000
150300         FROM  TTRBNTF TRB                                        15030000
150400             , TTRBRSN RSN                                        15040000
150500         WHERE  TRB.PO_NBR              = :RECEIV-ORD-NBR         15050000
150600            AND TRB.REC_SEQ_NBR         = :RECEIV-REC-SEQ-NBR     15060000
150700            AND TRB.TRBL_RSN_CDE        = RSN.TRBL_RSN_CDE        15070000
150800            AND TRB.NOTIF_TMST          =                         15080000
150900                (SELECT MAX(A.NOTIF_TMST)                         15090000
151000                    FROM TTRBNTF A                                15100000
151100                 WHERE                                            15110000
151200                        A.PO_NBR        = :RECEIV-ORD-NBR         15120000
151300                    AND A.REC_SEQ_NBR   = :RECEIV-REC-SEQ-NBR     15130000
151400                    AND A.RESOLVED_IND IN ('N','I')               15140000
151500                    AND NOT EXISTS                                15150000
151600                    (SELECT C.TRBL_RSN_CDE                        15160000
151700                       FROM TTRBRCN C                             15170000
151800                      WHERE C.RPT_PGM_NM  = 'PCKUT001'            15180000
151900                        AND A.TRBL_RSN_CDE  =  C.TRBL_RSN_CDE)    15190000
152000                )                                                 15200000
152100         WITH UR                                                  15210000
152200     END-EXEC.                                                    15220000
152300                                                                  15230000
152400     EVALUATE TRUE                                                15240000
152500         WHEN SQLCODE = ZERO                                      15250000
152600              CONTINUE                                            15260000
152700         WHEN SQLCODE = +100                                      15270000
152800              PERFORM 7047-CALL-LATEST-TROUBLE                    15280000
152900         WHEN SQLCODE = -811                                      15290000
153000              CONTINUE                                            15300000
153100         WHEN SQLWARN0 NOT = SPACE                                15310000
153200         WHEN SQLCODE < ZERO                                      15320000
153300         WHEN SQLCODE > ZERO                                      15330000
153400             PERFORM 9100-SQL-ABEND                               15340000
153500     END-EVALUATE.                                                15350000
153600                                                                  15360000
153700 7047-CALL-LATEST-TROUBLE.                                        15370000
153800     MOVE '7047-CALL-LATEST-TROUBLE'                              15380000
153900         TO PV-ABEND-PARAGRAPH.                                   15390000
154000                                                                  15400000
154100     EXEC SQL                                                     15410000
154200         SELECT RSN.TRBL_SHT_DESC                                 15420000
154300         INTO  :TRBRSN-TRBL-SHT-DESC                              15430000
154310         FROM  TTRBNTF TRB                                        15431000
154320             , TTRBRSN RSN                                        15432000
154330         WHERE  TRB.PO_NBR              = :RECEIV-ORD-NBR         15433000
154340            AND TRB.REC_SEQ_NBR         = :RECEIV-REC-SEQ-NBR     15434000
154350            AND TRB.TRBL_RSN_CDE        = RSN.TRBL_RSN_CDE        15435000
154360            AND TRB.NOTIF_TMST          =                         15436000
154370                (SELECT MAX(A.NOTIF_TMST)                         15437000
154380                    FROM TTRBNTF A                                15438000
154390                 WHERE                                            15439000
154391                        A.PO_NBR        = :RECEIV-ORD-NBR         15439100
154392                    AND A.REC_SEQ_NBR   = :RECEIV-REC-SEQ-NBR     15439200
154393                    AND A.RESOLVED_IND IN ('N','I'))              15439300
154394         WITH UR                                                  15439400
154395     END-EXEC.                                                    15439500
154396                                                                  15439600
154397     EVALUATE TRUE                                                15439700
154398         WHEN SQLCODE = ZERO                                      15439800
154399         WHEN SQLCODE = +100                                      15439900
154400         WHEN SQLCODE = -811                                      15440000
154410              CONTINUE                                            15441000
154411         WHEN SQLWARN0 NOT = SPACE                                15441100
154412         WHEN SQLCODE < ZERO                                      15441200
154413         WHEN SQLCODE > ZERO                                      15441300
154414             PERFORM 9100-SQL-ABEND                               15441400
154415     END-EVALUATE.                                                15441500
154416                                                                  15441600
154417******************************************************************15441700
154418*  OPEN THE TRECITM-CSR CURSOR.                                   15441800
154419******************************************************************15441900
154420 7050-OPEN-TRECITM-CSR.                                           15442000
154430     MOVE '7050-OPEN-TRECITM-CSR'                                 15443000
154440         TO PV-ABEND-PARAGRAPH.                                   15444000
154450     MOVE 'OPEN TRECITM CURSOR'                                   15445000
154460         TO PV-DB2-OPERATION-ATTEMPTED.                           15446000
154470                                                                  15447000
154480     EXEC SQL                                                     15448000
154490          OPEN TRECITM-CSR                                        15449000
154500     END-EXEC.                                                    15450000
154600                                                                  15460000
154700     EVALUATE TRUE                                                15470000
154800         WHEN SQLCODE = ZERO                                      15480000
154900             CONTINUE                                             15490000
155000         WHEN SQLWARN0 NOT = SPACES                               15500000
155100         WHEN SQLCODE < ZERO                                      15510000
155200         WHEN SQLCODE > ZERO                                      15520000
155300             PERFORM 9100-SQL-ABEND                               15530000
155400     END-EVALUATE.                                                15540000
155500                                                                  15550000
155600                                                                  15560000
155700******************************************************************15570000
155800*  PROCESS ALL OF THE LINES FOR A SPECIFIED RECEIVER TO RETRIEVE  15580000
155900*  THE NUMBER OF UNITS PROCESSED FOR THIS RECEIVER.  IF           15590000
156000*  DTL_CK_ITM_QTY FROM TRECITM IS GREATER THAN ZERO, USE THIS     15600000
156100*  AMOUNT FOR CALCULATING UNITS PROCESSED, OTHERWISE USE          15610000
156200*  PKSL_ITM_QTY TO CALCULATE UNITS PROCESSED.                     15620000
156300******************************************************************15630000
156400 7060-PROCESS-TRECITM-CSR.                                        15640000
156500     IF  RECITM-DTL-CK-ITM-QTY > 0                                15650000
156600         ADD RECITM-DTL-CK-ITM-QTY TO PV-PKSL-ITM-QTY             15660000
156700     ELSE                                                         15670000
156800         ADD RECITM-PKSL-ITM-QTY   TO PV-PKSL-ITM-QTY             15680000
156900     END-IF.                                                      15690000
157000                                                                  15700000
157100     IF RECEIV-STATUS-CDE = PC-IP                                 15710000
157200         IF RECITM-DTL-CK-ITM-QTY > 0                             15720000
157300             MOVE RECITM-DTL-CK-ITM-QTY TO PC002-PKSL-ITM-QTY     15730000
157400         ELSE                                                     15740000
157500             MOVE RECITM-PKSL-ITM-QTY   TO PC002-PKSL-ITM-QTY     15750000
157600         END-IF                                                   15760000
157700         MOVE RECITM-ORD-LNE-NBR        TO PC002-PO-LINE-NBR      15770000
157800         PERFORM 2300-WRITE-OUTPUT-FILE                           15780000
157900         SET PS-WRITE-FROM-RECITM TO TRUE                         15790000
158000     END-IF.                                                      15800000
158100                                                                  15810000
158200     PERFORM 7070-FETCH-TRECITM-CSR.                              15820000
158300                                                                  15830000
158400******************************************************************15840000
158500*  FETCH THE ROW FROM THE RESULTS TABLE USING THE CURSOR.        *15850000
158600******************************************************************15860000
158700 7070-FETCH-TRECITM-CSR.                                          15870000
158800     MOVE '7070-FETCH-TRECITM-CSR'                                15880000
158900         TO PV-ABEND-PARAGRAPH.                                   15890000
159000     MOVE 'FETCH A ROW FROM THE TRECITM CURSOR'                   15900000
159100         TO PV-DB2-OPERATION-ATTEMPTED.                           15910000
159200                                                                  15920000
159300     INITIALIZE DCLTRECITM.                                       15930000
159400                                                                  15940000
159500     EXEC SQL                                                     15950000
159600          FETCH TRECITM-CSR                                       15960000
159700           INTO :RECITM-ORD-LNE-NBR                               15970000
159800              , :RECITM-PKSL-ITM-QTY                              15980000
159900              , :RECITM-DTL-CK-ITM-QTY                            15990000
160000     END-EXEC.                                                    16000000
160100                                                                  16010000
160200     EVALUATE TRUE                                                16020000
160300         WHEN SQLCODE = ZERO                                      16030000
160400             CONTINUE                                             16040000
160500         WHEN SQLCODE = +100                                      16050000
160600             SET PS-END-OF-TRECITM-CSR                            16060000
160700                                 TO TRUE                          16070000
160800         WHEN SQLWARN0 NOT = SPACES                               16080000
160900         WHEN SQLCODE < ZERO                                      16090000
161000         WHEN SQLCODE > ZERO                                      16100000
161100             PERFORM 9100-SQL-ABEND                               16110000
161200     END-EVALUATE.                                                16120000
161300                                                                  16130000
161400                                                                  16140000
161500******************************************************************16150000
161600*  CLOSE THE TRECITM-CSR CURSOR.                                  16160000
161700******************************************************************16170000
161800 7080-CLOSE-TRECITM-CSR.                                          16180000
161900     MOVE '7080-CLOSE-TRECITM-CSR'                                16190000
162000         TO PV-ABEND-PARAGRAPH.                                   16200000
162100     MOVE 'CLOSE THE TRECITM CURSOR'                              16210000
162200         TO PV-DB2-OPERATION-ATTEMPTED.                           16220000
162300                                                                  16230000
162400     EXEC SQL                                                     16240000
162500          CLOSE TRECITM-CSR                                       16250000
162600     END-EXEC.                                                    16260000
162700                                                                  16270000
162800     EVALUATE TRUE                                                16280000
162900         WHEN SQLCODE = ZERO                                      16290000
163000             CONTINUE                                             16300000
163100         WHEN SQLWARN0 NOT = SPACES                               16310000
163200         WHEN SQLCODE < ZERO                                      16320000
163300         WHEN SQLCODE > ZERO                                      16330000
163400             PERFORM 9100-SQL-ABEND                               16340000
163500     END-EVALUATE.                                                16350000
163600                                                                  16360000
163700******************************************************************16370000
163800*  CLOSE THE TRECITM-CSR CURSOR.                                  16380000
163900******************************************************************16390000
164000 7090-GET-PACKSLIP-IND.                                           16400000
164100     MOVE '7090-GET-PACKSLIP-IND'                                 16410000
164200         TO PV-ABEND-PARAGRAPH.                                   16420000
164300     MOVE 'GET PACKSLIP INDICATOR FROM TSHPTPO'                   16430000
164400         TO PV-DB2-OPERATION-ATTEMPTED.                           16440000
164500                                                                  16450000
164600     INITIALIZE DCLTSHPTPO.                                       16460000
164700                                                                  16470000
164800     EXEC SQL                                                     16480000
164900         SELECT  PKSL_IND                                         16490000
165000           INTO  :SHPTPO-PKSL-IND                                 16500000
165100           FROM  TSHPTPO                                          16510000
165200          WHERE  PO_NBR          =  :RECEIV-ORD-NBR               16520000
165300            AND  REC_SEQ_NBR     =  :RECEIV-REC-SEQ-NBR           16530000
165400            AND  PRIM_SHIPT_IND  =  'Y'                           16540000
165500          WITH UR                                                 16550000
165600     END-EXEC.                                                    16560000
165700                                                                  16570000
165800     EVALUATE TRUE                                                16580000
165900         WHEN SQLCODE = ZERO                                      16590000
166000              MOVE SHPTPO-PKSL-IND       TO PC002-PACKSLIP-IND    16600000
166100         WHEN SQLCODE = +100                                      16610000
166200              MOVE PC-N                  TO PC002-PACKSLIP-IND    16620000
166300         WHEN SQLCODE = -811                                      16630000
166400              MOVE SHPTPO-PKSL-IND       TO PC002-PACKSLIP-IND    16640000
166500              DISPLAY 'ORD NUM ' RECEIV-ORD-NBR                   16650000
166600              ' RCVR ' RECEIV-REC-SEQ-NBR                         16660000
166700         WHEN SQLWARN0 NOT = SPACE                                16670000
166800         WHEN SQLCODE < ZERO                                      16680000
166900         WHEN SQLCODE > ZERO                                      16690000
167000             PERFORM 9100-SQL-ABEND                               16700000
167100     END-EVALUATE.                                                16710000
167200                                                                  16720000
167300                                                                  16730000
167400 8000-CHECK-DC-ENTRIES.                                           16740000
167500                                                                  16750000
167600     IF  WS-DCT-OPER-UNIT-ID (DCT-IDX) NOT EQUAL TO ZEROS         16760000
167700         IF  WS-DCT-OPEN-DATE (DCT-IDX) <= PV-TSTR-COMP-DATE      16770000
167800         AND WS-DCT-CLOSE-DATE (DCT-IDX) >= PV-TSTR-COMP-DATE     16780000
167900             INITIALIZE PC002-RECEIVER-EXT-RECORD                 16790000
168000             MOVE WS-DCT-OPER-UNIT-ID (DCT-IDX) TO                16800000
168100                  PC002-CURRENT-OPER                              16810000
168200             MOVE PC-1 TO PC002-CURRENT-FCLTY                     16820000
168300             SET  PC002-HEADER-RECORD TO TRUE                     16830000
168400             IF  WS-CM-DATA-PROCESSED (DCT-IDX)                   16840000
168500                 CONTINUE                                         16850000
168600             ELSE                                                 16860000
168700                 MOVE PC-CM TO PC002-STATUS-CDE                   16870000
168800                 IF SW-THATS-ALL-FOLKS                            16880000
168900                    CONTINUE                                      16890000
169000                 ELSE                                             16900000
169100                    WRITE EXTRACT-RECORD FROM                     16910000
169200                       PC002-RECEIVER-EXT-RECORD                  16920000
169300                 END-IF                                           16930000
169400             END-IF                                               16940000
169500             IF  WS-IP-DATA-PROCESSED (DCT-IDX)                   16950000
169600                 CONTINUE                                         16960000
169700             ELSE                                                 16970000
169800                 MOVE PC-IP TO PC002-STATUS-CDE                   16980000
169900                 WRITE EXTRACT-RECORD FROM                        16990000
170000                       PC002-RECEIVER-EXT-RECORD                  17000000
170100                 WRITE IP-EXTRACT-RECORD FROM                     17010000
170200                       PC002-RECEIVER-EXT-RECORD                  17020000
170300             END-IF                                               17030000
170400             IF  WS-DCT-DATA2-PROCESSED (DCT-IDX)                 17040000
170500                 CONTINUE                                         17050000
170600             ELSE                                                 17060000
170700                 MOVE PC-IP TO PC002-STATUS-CDE                   17070000
170800                 WRITE OLD-RECEIVERS-RECORD FROM                  17080000
170900                       PC002-RECEIVER-EXT-RECORD                  17090000
171000             END-IF                                               17100000
171100         ELSE                                                     17110000
171200             IF  WS-CM-DATA-PROCESSED (DCT-IDX)                   17120000
171300             OR  WS-IP-DATA-PROCESSED (DCT-IDX)                   17130000
171400             OR  WS-DCT-DATA2-PROCESSED (DCT-IDX)                 17140000
171500                 INITIALIZE PC002-RECEIVER-EXT-RECORD             17150000
171600                 MOVE WS-DCT-OPER-UNIT-ID (DCT-IDX) TO            17160000
171700                      PC002-CURRENT-OPER                          17170000
171800                 MOVE PC-1 TO PC002-CURRENT-FCLTY                 17180000
171900                 SET  PC002-HEADER-RECORD TO TRUE                 17190000
172000                 IF  WS-CM-DATA-PROCESSED (DCT-IDX)               17200000
172100                     CONTINUE                                     17210000
172200                 ELSE                                             17220000
172300                     MOVE PC-CM TO PC002-STATUS-CDE               17230000
172400                     WRITE EXTRACT-RECORD FROM                    17240000
172500                           PC002-RECEIVER-EXT-RECORD              17250000
172600                 END-IF                                           17260000
172700                 IF  WS-IP-DATA-PROCESSED (DCT-IDX)               17270000
172800                     CONTINUE                                     17280000
172900                 ELSE                                             17290000
173000                     MOVE PC-IP TO PC002-STATUS-CDE               17300000
173100                     WRITE EXTRACT-RECORD FROM                    17310000
173200                           PC002-RECEIVER-EXT-RECORD              17320000
173300                     WRITE IP-EXTRACT-RECORD FROM                 17330000
173400                           PC002-RECEIVER-EXT-RECORD              17340000
173500                 END-IF                                           17350000
173600                 IF  WS-DCT-DATA2-PROCESSED (DCT-IDX)             17360000
173700                     CONTINUE                                     17370000
173800                 ELSE                                             17380000
173900                     MOVE PC-IP TO PC002-STATUS-CDE               17390000
174000                     WRITE OLD-RECEIVERS-RECORD FROM              17400000
174100                           PC002-RECEIVER-EXT-RECORD              17410000
174200                 END-IF                                           17420000
174300             ELSE                                                 17430000
174400                 NEXT SENTENCE                                    17440000
174500     ELSE                                                         17450000
174600         NEXT SENTENCE.                                           17460000
174700                                                                  17470000
174800******************************************************************17480000
174900*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    17490000
175000*  ERROR OR WARNING CODE OCCURS.                                  17500000
175100******************************************************************17510000
175200 9100-SQL-ABEND.                                                  17520000
175300     DISPLAY '9100-SQL-ABEND'.                                    17530000
175400     DISPLAY '** ABEND     **'.                                   17540000
175500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        17550000
175600     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             17560000
175700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     17570000
175800                                                                  17580000
175900******************************************************************17590000
176000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    17600000
176100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         17610000
176200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     17620000
176300* FORMAT.                                                         17630000
176400******************************************************************17640000
176500     COPY DPPD004.                                                17650000
176600                                                                  17660000
176700     MOVE +4013                  TO ABEND-CODE.                   17670000
176800     CALL 'ILBOABN0' USING ABEND-CODE.                            17680000
176801                                                                  17680116
176810*** PRB0064829 START                                              17681016
176811* PROCEDURE DIVISION CODE FOR CALCULATING THE OTB INFORMATION     17681116
176820     COPY POPD055.                                                17682016
176821*** PRB0064829 END                                                17682116
176830                                                                  17683016
176900*9100-EXIT.                                                       17690000
