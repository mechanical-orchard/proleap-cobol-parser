000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    VNKUT052.                                         00020000
000300 AUTHOR.        MIKE BESKE.                                       00030000
000400 DATE-WRITTEN.  JUNE 2004.                                        00040000
000500***************************************************************** 00050000
000600*         VENDOR LEGACY PARENT FACTORY TEXT FILE PROGRAM        * 00060000
000700***************************************************************** 00070000
000800*    COBOL II                                                   * 00080000
000900***************************************************************** 00090000
001000*                                                               * 00100000
001100*    THE PURPOSE OF THIS PROGRAM IS TO CREATE A FILE TO BE      * 00110000
001200*    FTP'D TO THE LAN FOR THE MIO DEPARTMENT.  IT IS A COMMA    * 00120005
001300*    DELIMITED TEXT FILE.                                       * 00130005
001400*                                                               * 00140000
001500*    INPUT:  PARENT FACTORY DATA FILE      LRECL 150   VNRD050  * 00150003
001600*    OUTPUT: PARENT FACTORY TEXT FILE      LRECL 100   VNRD052  * 00160000
001700*                                                               * 00170000
001800***************************************************************** 00180000
001900* CHANGE RECORD:                                                * 00190000
002000*                                                               * 00200000
002100* 00/00/0000                                                    * 00210000
002200*      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00220000
002300*      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00230000
002400*      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00240000
002500* MADE BY: XXXXXXXXXXXX                          WR#00000       * 00250000
002600*                                                               * 00250111
002600* 3/02/2009                                                     * 00250211
002600*      CHANGES FOR MULTIPLE CARTON LABELER.                     * 00250311
002600*      REMOVED VN052-COMMA-4, VN052-COMMA-8, VN052-COMMA-9      * 00250411
002600*      ADDED MOVE OF VN050-SORT-ENT-ID TO VN052-RLTD-ENT-ID,    * 00251011
002600*      THIS IS REPLACING GVRNG-ENT-ID TO HOLD RELATED ENT ID.   * 00260011
002600*      REMOVED ALL REFERENCES TO GVRNG-ENT-ID AND CART-LBL-IND. * 00260111
002600*      THESE COLUMNS ARE BEING REMOVED FROM TEXTENT WITH        * 00260211
002600*      THIS PROJECT.                                            * 00260311
 02600* MADE BY: SUE BARTELT                           WR#32219       * 00260411
 02600*                                                               * 00261011
002700***************************************************************** 00270000
002800 ENVIRONMENT DIVISION.                                            00280000
002900                                                                  00290000
003000 INPUT-OUTPUT SECTION.                                            00300000
003100 FILE-CONTROL.                                                    00310000
003200                                                                  00320000
003300     SELECT DATA-FILE            ASSIGN TO UT-S-INP01.            00330000
003400     SELECT TEXT-FILE            ASSIGN TO UT-S-OUT01.            00340000
003500                                                                  00350000
003600 DATA DIVISION.                                                   00360000
003700                                                                  00370000
003800 FILE SECTION.                                                    00380000
003900                                                                  00390000
004000 FD  DATA-FILE                                                    00400000
004100     LABEL RECORDS ARE OMITTED                                    00410000
004200     RECORDING MODE IS F                                          00420000
004300     RECORD CONTAINS 150 CHARACTERS                               00430003
004400     BLOCK CONTAINS 0 RECORDS.                                    00440000
004500 01  DATA-RECORD                    PIC X(150).                   00450003
004600                                                                  00460000
004700 FD  TEXT-FILE                                                    00470000
004800     LABEL RECORDS ARE STANDARD                                   00480000
004900     RECORDING MODE IS F                                          00490000
005000     BLOCK CONTAINS 0 RECORDS.                                    00500000
005100 01  TEXT-RECORD.                                                 00510000
005200     05  FILLER                     PIC X(100).                   00520000
005300                                                                  00530000
005400 WORKING-STORAGE SECTION.                                         00540000
005500                                                                  00550000
005600 01  PROGRAM-COUNTERS.                                            00560000
005700     05  COUNT-RECORDS-IN           PIC S9(09) COMP-3 VALUE +0.   00570000
005800     05  COUNT-RECORDS-OUT          PIC S9(09) COMP-3 VALUE +0.   00580000
005900     05  PRT-COUNT-RECORDS-IN       PIC  Z(09) VALUE ZERO.        00590000
006000     05  PRT-COUNT-RECORDS-OUT      PIC  Z(09) VALUE ZERO.        00600000
006100                                                                  00610000
006200 01  PROGRAM-SWITCHES.                                            00620000
006300     05  PS-DATA-EOF-SW             PIC X  VALUE 'N'.             00630000
006400         88  PROCESSING-DATA               VALUE 'N'.             00640000
006500         88  DATA-EOF                      VALUE 'Y'.             00650000
006600                                                                  00660000
006700 01  PROGRAM-CONSTANTS.                                           00670000
006800     05  PC-PROGRAM-NAME            PIC X(08) VALUE 'VNKUT052'.   00680000
006900                                                                  00690000
007000 01  PROGRAM-VARIABLES.                                           00700000
007100     05  PV-ENT-ID-UNPK             PIC S9(9) VALUE ZEROS.        00710000
007200                                                                  00720000
007300 01  PV-ORIGINAL-DATE.                                            00730000
007400     05  PV-ORIG-CCYY               PIC X(04).                    00740000
007500     05  FILLER                     PIC X(01).                    00750000
007600     05  PV-ORIG-MM                 PIC X(02).                    00760000
007700     05  FILLER                     PIC X(01).                    00770000
007800     05  PV-ORIG-DD                 PIC X(02).                    00780000
007900                                                                  00790000
008000 01  PV-REFORMAT-DATE.                                            00800000
008100     05  PV-RFMT-MM                 PIC X(02).                    00810000
008200     05  FILLER                     PIC X(01)  VALUE '/'.         00820000
008300     05  PV-RFMT-DD                 PIC X(02).                    00830000
008400     05  FILLER                     PIC X(01)  VALUE '/'.         00840000
008500     05  PV-RFMT-CCYY               PIC X(04).                    00850000
008600                                                                  00860000
008700*--------------------------------------------------------------*  00870000
008800*  RECORD LAYOUT FOR PARENT FACTORY DATA FILE                  *  00880000
008900*--------------------------------------------------------------*  00890000
009000     COPY VNRD050.                                                00900000
009100 EJECT                                                            00910000
009200                                                                  00920000
009300*--------------------------------------------------------------*  00930000
009400*  RECORD LAYOUT FOR PARENT FACTORY TEXT FILE                  *  00940000
009500*--------------------------------------------------------------*  00950000
009600     COPY VNRD052.                                                00960000
009700 EJECT                                                            00970000
009800                                                                  00980000
009900************************                                          00990000
010000 PROCEDURE DIVISION.                                              01000000
010100************************                                          01010000
010200 A100-MAINLINE-ROUTINE.                                           01020000
010300                                                                  01030000
010400     PERFORM B100-INITIALIZATION.                                 01040000
010500                                                                  01050000
010600     PERFORM B200-CREATE-FTP-FILE                                 01060000
010700         UNTIL  DATA-EOF.                                         01070000
010800                                                                  01080000
010900     PERFORM B300-TERMINATION.                                    01090000
011000     GOBACK.                                                      01100000
011100                                                                  01110000
011200                                                                  01120000
011300*--------------------------------------------------------------*  01130000
011400*    INITIALIZATION PROCESSING                                 *  01140000
011500*--------------------------------------------------------------*  01150000
011600 B100-INITIALIZATION.                                             01160000
011700                                                                  01170000
011800     DISPLAY '*------------ PROGRAM:  VNKUT052 ------------*'     01180000
011900     DISPLAY '  RUN DATE = ' FUNCTION CURRENT-DATE(1:8)           01190000
012000             '  RUN TIME = ' FUNCTION CURRENT-DATE(9:6)           01200000
012100                                                                  01210000
012200     OPEN INPUT DATA-FILE                                         01220000
012300         OUTPUT TEXT-FILE.                                        01230000
012400                                                                  01240000
012500     INITIALIZE VN052-PARENT-FACTORY-REC.                         01250000
012600                                                                  01260000
012700     MOVE ',' TO VN052-COMMA-1  VN052-COMMA-2  VN052-COMMA-3      01270008
012800                                VN052-COMMA-5  VN052-COMMA-6      01280006
012900                 VN052-COMMA-7.                                   01290006
013000                                                                  01300000
013100     PERFORM R100-READ-DATA-FILE.                                 01310000
013200                                                                  01320000
013300*--------------------------------------------------------------*  01330000
013400*  THIS ROUTINE WILL CREATE THE FTP COUNT FILE.                *  01340000
013500*--------------------------------------------------------------*  01350000
013600 B200-CREATE-FTP-FILE.                                            01360000
013700                                                                  01370000
013800     MOVE VN050-ENT-NAME-DESC     TO VN052-ENT-NAME-DESC.         01380000
013900     INSPECT VN052-ENT-NAME-DESC  REPLACING ALL ',' BY ' '.       01390000
014000     MOVE VN050-ENT-ID            TO PV-ENT-ID-UNPK.              01400000
014100     MOVE PV-ENT-ID-UNPK          TO VN052-ENT-ID.                01410000
014200     MOVE VN050-PRTNR-TYP-CDE     TO VN052-PRTNR-TYP-CDE.         01420000
014300*    MOVE VN050-GVRNG-IND         TO VN052-GVRNG-IND.             01430006
014400     MOVE VN050-SORT-ENT-ID       TO PV-ENT-ID-UNPK.              01440010
014500     MOVE PV-ENT-ID-UNPK          TO VN052-RLTD-ENT-ID.           01450010
014600     MOVE VN050-STATUS-CDE        TO VN052-STATUS-CDE.            01460000
014700     MOVE VN050-CRE-DATE          TO PV-ORIGINAL-DATE.            01470000
014800     MOVE PV-ORIG-MM              TO PV-RFMT-MM.                  01480000
014900     MOVE PV-ORIG-DD              TO PV-RFMT-DD.                  01490000
015000     MOVE PV-ORIG-CCYY            TO PV-RFMT-CCYY.                01500000
015100     MOVE PV-REFORMAT-DATE        TO VN052-CRE-DATE.              01510000
015200     MOVE VN050-LAST-UPD-DATE     TO PV-ORIGINAL-DATE.            01520001
015300     MOVE PV-ORIG-MM              TO PV-RFMT-MM.                  01530001
015400     MOVE PV-ORIG-DD              TO PV-RFMT-DD.                  01540001
015500     MOVE PV-ORIG-CCYY            TO PV-RFMT-CCYY.                01550001
015600     MOVE PV-REFORMAT-DATE        TO VN052-LAST-UPD-DATE.         01560001
015700*    MOVE VN050-CART-LBL-IND      TO VN052-CART-LBL-IND.          01570006
015800*    MOVE VN050-CART-LBL-EFF-DTE  TO PV-ORIGINAL-DATE.            01580006
015900*    MOVE PV-ORIG-MM              TO PV-RFMT-MM.                  01590006
016000*    MOVE PV-ORIG-DD              TO PV-RFMT-DD.                  01600006
016100*    MOVE PV-ORIG-CCYY            TO PV-RFMT-CCYY.                01610006
016200*    MOVE PV-REFORMAT-DATE        TO VN052-CART-LBL-EFF-DTE.      01620006
016300                                                                  01630000
016400     PERFORM W100-WRITE-TEXT-RECORD                               01640000
016500                                                                  01650000
016600     PERFORM R100-READ-DATA-FILE.                                 01660000
016700                                                                  01670000
016800*---------------------------------------------------------------* 01680000
016900*  END OF PROGRAM PROCESSING:                                   * 01690000
017000*---------------------------------------------------------------* 01700000
017100 B300-TERMINATION.                                                01710000
017200                                                                  01720000
017300     MOVE COUNT-RECORDS-IN   TO PRT-COUNT-RECORDS-IN.             01730000
017400     MOVE COUNT-RECORDS-OUT  TO PRT-COUNT-RECORDS-OUT.            01740000
017500     DISPLAY '************************************************'.  01750000
017600     DISPLAY '****              VNKUT052                  ****'.  01760000
017700     DISPLAY '************************************************'.  01770000
017800     DISPLAY 'DATA RECORDS IN   = ' PRT-COUNT-RECORDS-IN.         01780000
017900     DISPLAY 'TEXT RECORDS OUT  = ' PRT-COUNT-RECORDS-OUT.        01790000
018000     DISPLAY '************************************************'.  01800000
018100                                                                  01810000
018200     CLOSE DATA-FILE                                              01820000
018300           TEXT-FILE.                                             01830000
018400                                                                  01840000
018500*--------------------------------------------------------------*  01850000
018600*  READS THE PARENT FACTORY DATA FILE                          *  01860000
018700*--------------------------------------------------------------*  01870000
018800 R100-READ-DATA-FILE.                                             01880000
018900                                                                  01890000
019000     READ DATA-FILE INTO VN050-PARENT-FACTORY-REC                 01900000
019100        AT END                                                    01910000
019200            SET DATA-EOF TO TRUE                                  01920000
019300        NOT AT END                                                01930000
019400            ADD 1 TO COUNT-RECORDS-IN                             01940000
019500     END-READ.                                                    01950000
019600                                                                  01960000
019700*--------------------------------------------------------------*  01970000
019800*  WRITES OUT PARENT FACTORY TEXT RECORD                       *  01980000
019900*--------------------------------------------------------------*  01990000
020000 W100-WRITE-TEXT-RECORD.                                          02000000
020100                                                                  02010000
020200     ADD 1 TO COUNT-RECORDS-OUT.                                  02020000
020300                                                                  02030000
020400     WRITE TEXT-RECORD FROM VN052-PARENT-FACTORY-REC.             02040000
