000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS295.                                         00020000
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  02-26-94                                          00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*    E295 - STORE DISTRIBUTION LIST                               00080000
000900*                                                                 00090000
001000*    DISPLAYS ALL STORE DISTRIBUTION FOR A RECEIVER.              00100000
001100*                                                                 00110000
001200******************************************************************00120000
001210*---------------------------------------------------------------* 00121029
001220* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00122030
001230* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00123030
001240* MAKING THE CALL DYNAMIC VS STATIC.                              00124030
001250*---------------------------------------------------------------* 00125030
001300 ENVIRONMENT DIVISION.                                            00130000
001400 DATA DIVISION.                                                   00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600                                                                  00160000
001700 01  PC-PROGRAM-CONSTANTS.                                        00170000
001800     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC295A  '. 00180000
001900     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM295 '. 00190000
002000     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS295'. 00200000
002100*                                                                 00210030
002200     05  PC-000                       PIC X(03) VALUE '000'.      00220000
002300     05  PC-999                       PIC X(03) VALUE '999'.      00230000
002400     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00240000
002500     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00250000
002600     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +10         00260000
002700                                                COMP SYNC.        00270000
002800     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00280000
002900                                                COMP SYNC.        00290000
003000     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00300000
003100                                                COMP SYNC.        00310000
003200     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00320000
003300                                                COMP SYNC.        00330000
003400     05  PC-01                        PIC X(02) VALUE '01'.       00340000
003500     05  PC-AC                        PIC X(02) VALUE 'AC'.       00350000
003600     05  PC-CM                        PIC X(02) VALUE 'CM'.       00360000
003700     05  PC-IN                        PIC X(02) VALUE 'IN'.       00370000
003800     05  PC-IP                        PIC X(02) VALUE 'IP'.       00380000
003900     05  PC-CB                        PIC X(02) VALUE 'CB'.       00390000
004000     05  PC-CA                        PIC X(02) VALUE 'CA'.       00400000
004100     05  PC-VE                        PIC X(02) VALUE 'VE'.       00410000
004200     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00420000
004300     05  PC-INACTIVE                  PIC X(01) VALUE 'I'.        00430000
004400     05  PC-I                         PIC X(01) VALUE 'I'.        00440000
004500     05  PC-A                         PIC X(01) VALUE 'A'.        00450000
004600     05  PC-DASH                      PIC X(01) VALUE '-'.        00460000
004700     05  PC-UPD                       PIC X(03) VALUE 'UPD'.      00470000
004800     05  PC-INTER-APPL-CODES.                                     00480000
004900         10  PC-INTER-APPL-WO         PIC X(01) VALUE '1'.        00490000
005000         10  PC-INTER-APPL-VERIFY     PIC X(01) VALUE '2'.        00500000
005100                                                                  00510000
005200     05  PC-TSYMSG-NUMBERS.                                       00520000
005300         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00530000
005400*            INVALID VALUE                                        00540000
005500         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00550000
005600*            MUST BE NUMERIC                                      00560000
005700         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00570000
005800*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00580000
005900         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00590000
006000*            NO END OF RANGE HAS BEEN SPECIFIED                   00600000
006100         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00610000
006200*            END OF RANGE PRECEDES START OF RANGE                 00620000
006300         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00630000
006400*            NO START OF RANGE HAS BEEN SPECIFIED                 00640000
006500         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00650000
006600*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00660000
006700         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00670000
006800*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00680000
006900         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00690000
007000*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00700000
007100         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      00710000
007200*            UPDATE(S) SUCCESSFUL                                 00720000
007300         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00730000
007400*            TOP OF LIST                                          00740000
007500         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00750000
007600*            BOTTOM OF LIST                                       00760000
007700         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      00770000
007800*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      00780000
007900         10  PC-TSYMSG-00148          PIC 9(5)  VALUE 00148.      00790000
008000*            DATA DOES NOT EXIST                                  00800000
008100         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      00810000
008200*            MORE ITEMS TO DISPLAY                                00820000
008300         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      00830000
008400*            UPDATE FUNCTION INVALID WITH RECEIVER STATUS         00840000
008500         10  PC-TSYMSG-00866          PIC 9(5)  VALUE 00866.      00850000
008600*            RCVR LNE QTY AND DISTR LNE QTY MUST MATCH            00860000
008700                                                                  00870000
008800 01  PS-PROGRAM-SWITCHES.                                         00880000
008900     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        00890000
009000         88  PS-NO-ERROR                        VALUE 'N'.        00900000
009100         88  PS-ERROR                           VALUE 'Y'.        00910000
009200     05  PS-SEARCH-STYLE-SW           PIC  X    VALUE 'N'.        00920000
009300         88  PS-INVALID-SEARCH-STYLE            VALUE 'N'.        00930000
009400         88  PS-VALID-SEARCH-STYLE              VALUE 'Y'.        00940000
009500     05  PS-PLAN-FOUND-SW             PIC  X    VALUE 'N'.        00950000
009600         88  PS-PLAN-NOT-FOUND                  VALUE 'N'.        00960000
009700         88  PS-PLAN-FOUND                      VALUE 'Y'.        00970000
009800                                                                  00980000
009900 01  DK-DB2-KEYS.                                                 00990000
010000     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01000000
010100     05  DK-PKSL-LNE-NBR              PIC S9(9) COMP VALUE +0.    01010000
010200     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    01020000
010300     05  DK-STR-NBR                   PIC S9(4) COMP VALUE +0.    01030000
010400                                                                  01040000
010500 01  PV-PROGRAM-VARIABLES.                                        01050000
010600     05  PV-SUB                       PIC S9(4) VALUE ZERO        01060000
010700                                                COMP SYNC.        01070000
010800     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        01080000
010900                                                COMP SYNC.        01090000
011000     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        01100000
011100                                                COMP-3.           01110000
011200     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        01120000
011300                                                COMP-3.           01130000
011400     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        01140000
011500                                                COMP-3.           01150000
011600     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        01160000
011700                                                COMP-3.           01170000
011800     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        01180000
011900                                                COMP-3.           01190000
012000     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        01200000
012100                                                COMP-3.           01210000
012200     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        01220000
012300                                                COMP-3.           01230000
012400     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        01240000
012500                                                COMP-3.           01250000
012600     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        01260000
012700                                                COMP SYNC.        01270000
012800     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        01280000
012900                                                COMP SYNC.        01290000
013000     05  PV-ITEM                      PIC S9(4) VALUE ZERO        01300000
013100                                                COMP SYNC.        01310000
013200     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        01320000
013300                                                COMP SYNC.        01330000
013400     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        01340000
013500                                                COMP SYNC.        01350000
013600     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        01360000
013700                                                COMP SYNC.        01370000
013800     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        01380000
013900                                                COMP SYNC.        01390000
014000     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        01400000
014100                                                COMP SYNC.        01410000
014200     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        01420000
014300                                                COMP SYNC.        01430000
014400     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01440000
014500                                                COMP SYNC.        01450000
014600     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        01460000
014700                                                COMP SYNC.        01470000
014800     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        01480000
014900                                                COMP SYNC.        01490000
015000     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        01500000
015100                                                COMP SYNC.        01510000
015200     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        01520000
015300                                                COMP SYNC.        01530000
015400     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        01540000
015500                                                COMP SYNC.        01550000
015600     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        01560000
015700                                                COMP SYNC.        01570000
015800     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        01580000
015900                                                COMP SYNC.        01590000
016000     05  PV-REC-IND                   PIC S9(4) VALUE ZERO        01600000
016100                                                COMP SYNC.        01610000
016200     05  PV-QTY-IND                   PIC S9(4) VALUE ZERO        01620000
016300                                                COMP SYNC.        01630000
016400     05  PV-DISTRO-IND                PIC S9(4) VALUE ZERO        01640000
016500                                                COMP SYNC.        01650000
016600     05  PV-VERIFIED-IND              PIC S9(4) VALUE ZERO        01660000
016700                                                COMP SYNC.        01670000
016800     05  PV-EXPTED-IND                PIC S9(4) VALUE ZERO        01680000
016900                                                COMP SYNC.        01690000
017000     05  PV-TOT-RCVD-IND              PIC S9(4) VALUE ZERO        01700000
017100                                                COMP SYNC.        01710000
017200     05  PV-REC-ITEMS                 PIC S9(9) VALUE ZERO        01720000
017300                                                COMP SYNC.        01730000
017400     05  PV-VERIFY-ITM-QTY            PIC S9(9) VALUE ZERO        01740000
017500                                                COMP SYNC.        01750000
017600     05  PV-TOT-REC-QTY               PIC S9(9) VALUE ZERO        01760000
017700                                                COMP SYNC.        01770000
017800     05  PV-SUM-DISTRO-QTY            PIC S9(9) VALUE ZERO        01780000
017900                                                COMP SYNC.        01790000
018000     05  PV-SUM-STR-DISTRO-QTY        PIC S9(9) VALUE ZERO        01800000
018100                                                COMP SYNC.        01810000
018200     05  PV-SUM-EXPTED-QTY            PIC S9(9) VALUE ZERO        01820000
018300                                                COMP SYNC.        01830000
018400     05  PV-SUM-VERIFIED-QTY          PIC S9(9) VALUE ZERO        01840000
018500                                                COMP SYNC.        01850000
018600     05  PV-DISTR-LNE-QTY             PIC S9(9) VALUE ZERO        01860000
018700                                                COMP SYNC.        01870000
018800     05  PV-TOTAL-RCVD                PIC S9(9) VALUE ZERO        01880000
018900                                                COMP SYNC.        01890000
019000     05  PV-OPEN-TO-REC               PIC S9(6) VALUE ZERO.       01900000
019100     05  PV-TOTAL-OTR                 PIC S9(6) VALUE ZERO.       01910000
019200     05  PV-NIS-SKU-NBR               PIC  9(8) VALUE ZERO.       01920000
019300                                                                  01930000
019400     05  PV-SKU-NBR.                                              01940000
019500         10  PV-SN-DEPT-NBR           PIC  X(3).                  01950000
019600         10  FILLER                   PIC  X    VALUE SPACES.     01960000
019700         10  PV-SN-CL-NBR             PIC  X(2).                  01970000
019800         10  FILLER                   PIC  X    VALUE SPACES.     01980000
019900         10  PV-SN-SEQ-NBR            PIC  X(8).                  01990000
020000     05  PV-AD-DATE-MM-DD-CCYY.                                   02000000
020100         10  PV-AD-DATE-MM            PIC X(02) VALUE SPACES.     02010000
020200         10  FILLER                   PIC X(01) VALUE '-'.        02020000
020300         10  PV-AD-DATE-DD            PIC X(02) VALUE SPACES.     02030000
020400         10  FILLER                   PIC X(01) VALUE '-'.        02040000
020500         10  PV-AD-DATE-CCYY          PIC X(04) VALUE SPACES.     02050000
020600     05  PV-DB2-DATE-FORMAT           PIC X(10).                  02060000
020700     05  PV-DB2-DATE-FORMAT-REDE.                                 02070000
020800         10  PV-DB2-CCYY.                                         02080000
020900             15  PV-DB2-CC            PIC X(02) VALUE SPACES.     02090000
021000             15  PV-DB2-YY            PIC X(02) VALUE SPACES.     02100000
021100         10  FILLER                   PIC X(01) VALUE '-'.        02110000
021200         10  PV-DB2-MM                PIC X(02) VALUE SPACES.     02120000
021300         10  FILLER                   PIC X(01) VALUE '-'.        02130000
021400         10  PV-DB2-DD                PIC X(02) VALUE SPACES.     02140000
021500     05  PV-SCREEN-DATE-FORMAT.                                   02150000
021600         10  PV-SCREEN-DATE-MM        PIC X(02) VALUE SPACES.     02160000
021700         10  PV-SCREEN-DATE-DD        PIC X(02) VALUE SPACES.     02170000
021800         10  PV-SCREEN-DATE-YY        PIC X(02) VALUE SPACES.     02180000
021900     05  PV-CHECK-FOR-DEFAULT-DATE    PIC X(10) VALUE SPACES.     02190000
022000         88  PV-DEFAULT-DATE                    VALUES            02200000
022100                                                '0001-01-01',     02210000
022200                                                '9999-09-09'.     02220000
022300     05  PV-DB2-CURRENT-TMST          PIC X(26).                  02230000
022400     05  PV-UNPACK-OPER-UNT-ID        PIC 9(04) VALUE ZEROS.      02240025
022500                                                                  02250000
022600 01  MSG-QUEUE-ITEM.                                              02260000
022700     05  FILLER                       PIC X(11)  VALUE            02270000
022800         'QUEUE NAME '.                                           02280000
022900     05  MSG-QUEUE-NAME               PIC X(08).                  02290000
023000     05  FILLER                       PIC X(14)  VALUE            02300000
023100         '  ITEM NUMBER '.                                        02310000
023200     05  MSG-SEL-ITEM                 PIC 9(04).                  02320000
023300                                                                  02330000
023400 01  MSG1-PO-REC.                                                 02340000
023500     05  FILLER                       PIC X(07)  VALUE            02350000
023600         'PO NBR '.                                               02360000
023700     05  MSG1-PO-NBR                  PIC 9(09).                  02370000
023800     05  FILLER                       PIC X(11)  VALUE            02380000
023900         '  REC SEQ  '.                                           02390000
024000     05  MSG1-REC-SEQ-NBR-N           PIC 9(09).                  02400000
024100     05  FILLER                       PIC X(12)  VALUE            02410000
024200         '  OPER UNIT '.                                          02420000
024300     05  MSG1-OPER-UNT-ID             PIC X(04).                  02430000
024400     05  FILLER                       PIC X(11)  VALUE            02440000
024500         '  FACILITY '.                                           02450000
024600     05  MSG1-FACILITY-ID             PIC X(04).                  02460000
024700                                                                  02470000
024800                                                                  02480000
024900 01  LQW-LIST-QUEUE-WORK-AREA.                                    02490000
025000     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     02500000
025100     05  LQW-ITEM-ENTRIES             OCCURS 10 TIMES             02510000
025200                                      INDEXED BY LQW-IDX.         02520000
025300         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          02530000
025400         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  02540000
025500         10  LQW-SELECTED-SW          PIC X(01).                  02550000
025600             88  LQW-SELECT                      VALUE 'S'.       02560000
025700             88  LQW-DESELECT                    VALUE ' '.       02570000
025800*BJ                                                               02580000
025900         10  LQW-STR-QTY-PREV         PIC 9(05).                  02590000
026000         10  LQW-STR-QTY              PIC 9(05).                  02600000
026100         10  LQW-STR-NBR              PIC 9(04).                  02610000
026200         10  LQW-EXPTED-ITM-QTY       PIC 9(05).                  02620000
026300         10  LQW-OPEN-TO-REC          PIC 9(06).                  02630000
026400         10  LQW-UNT-QTY              PIC 9(06).                  02640000
026500         10  LQW-TOT-REC              PIC 9(06).                  02650000
026600         10  LQW-VERFD-QTY            PIC 9(05).                  02660000
026700         10  LQW-STATUS               PIC X(02).                  02670000
026800         10  LQW-LAST-QTY-REC         PIC 9(06).                  02680000
026900         10  LQW-LAST-DTE-REC         PIC X(06).                  02690000
027000         10  LQW-PRIOR-QTY-REC        PIC 9(06).                  02700000
027100         10  LQW-PRIOR-DTE-REC        PIC X(06).                  02710000
027200                                                                  02720000
027300******************************************************************02730000
027400*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02740000
027500******************************************************************02750000
027600     COPY RCWS013.                                                02760024
027700                                                                  02770000
027800******************************************************************02780000
027900*    SELECTED ITEMS TEMPORARY STORAGE QUEUE WO ITEM LAYOUT        02790000
028000******************************************************************02800000
028100     COPY PCWS016.                                                02810024
028200                                                                  02820000
028300*----------------------------------------------------------------*02830017
028400* COPY BOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               02840023
028500*----------------------------------------------------------------*02850017
028600     COPY XLWS001.                                                02860000
028700                                                                  02870000
028800*----------------------------------------------------------------*02880024
028900* COPY BOOK FOR LOGISTICS DOMAIN LOCATION ACCESS MODULE (XLKUT071)02890024
029000*----------------------------------------------------------------*02900024
029100     COPY XLWS071.                                                02910024
029200                                                                  02920024
029300*----------------------------------------------------------------*02930017
029400*                                                                 02940000
029500******************************************************************02950000
029600*    BMS MAP                                                      02960000
029700******************************************************************02970000
029800     COPY RCKM295.                                                02980000
029900                                                                  02990000
030000 01  MR-OCCURS-LAYOUT                 REDEFINES RC295AO.          03000000
030100*BJ  05  FILLER                       PIC X(240).                 03010000
030200** CHG0094517  CHANGED FILLER LENGTH FROM 257 TO 258              03020028
030300     05  FILLER                       PIC X(258).                 03030028
030400     05  MR-SCROLL-AREA               OCCURS 10 TIMES.            03040000
030500         10  MR-SELECTL               PIC S9(4) COMP.             03050000
030600         10  MR-SELECTA               PIC X.                      03060000
030700         10  MR-SELECTC               PIC X.                      03070000
030800         10  MR-SELECTH               PIC X.                      03080000
030900         10  MR-SELECTI               PIC X.                      03090000
031000                                                                  03100000
031100         10  MR-STR-QTY-L             PIC S9(4) COMP.             03110000
031200         10  MR-STR-QTY-A             PIC X.                      03120000
031300         10  MR-STR-QTY-C             PIC X.                      03130000
031400         10  MR-STR-QTY-H             PIC X.                      03140000
031500         10  MR-STR-QTY.                                          03150000
031600             15  MR-STR-QTY-EDITED    PIC ZZZZ9.                  03160000
031700                                                                  03170000
031800         10  MR-STR-NBR-L             PIC S9(4) COMP.             03180000
031900         10  MR-STR-NBR-A             PIC X.                      03190000
032000         10  MR-STR-NBR-C             PIC X.                      03200000
032100         10  MR-STR-NBR-H             PIC X.                      03210000
032200         10  MR-STR-NBR               PIC X(04).                  03220000
032300                                                                  03230000
032400         10  MR-EXPTED-ITM-QTY-L      PIC S9(4) COMP.             03240000
032500         10  MR-EXPTED-ITM-QTY-A      PIC X.                      03250000
032600         10  MR-EXPTED-ITM-QTY-C      PIC X.                      03260000
032700         10  MR-EXPTED-ITM-QTY-H      PIC X.                      03270000
032800         10  MR-EXPTED-ITM-QTY.                                   03280000
032900             15  MR-EXPTED-ITM-QTY-EDITED                         03290000
033000                                      PIC ZZZZ9.                  03300000
033100                                                                  03310000
033200         10  MR-OPEN-TO-REC-L         PIC S9(4) COMP.             03320000
033300         10  MR-OPEN-TO-REC-A         PIC X.                      03330000
033400         10  MR-OPEN-TO-REC-C         PIC X.                      03340000
033500         10  MR-OPEN-TO-REC-H         PIC X.                      03350000
033600         10  MR-OPEN-TO-REC.                                      03360000
033700             15  MR-OPEN-TO-REC-EDITED                            03370000
033800                                      PIC ZZZZZ9.                 03380000
033900                                                                  03390000
034000         10  MR-ORDER-QTY-L           PIC S9(4) COMP.             03400000
034100         10  MR-ORDER-QTY-A           PIC X.                      03410000
034200         10  MR-ORDER-QTY-C           PIC X.                      03420000
034300         10  MR-ORDER-QTY-H           PIC X.                      03430000
034400         10  MR-ORDER-QTY.                                        03440000
034500             15  MR-ORDER-QTY-EDITED  PIC ZZZZZ9.                 03450000
034600                                                                  03460000
034700         10  MR-TOT-REC-L             PIC S9(4) COMP.             03470000
034800         10  MR-TOT-REC-A             PIC X.                      03480000
034900         10  MR-TOT-REC-C             PIC X.                      03490000
035000         10  MR-TOT-REC-H             PIC X.                      03500000
035100         10  MR-TOT-REC.                                          03510000
035200             15  MR-TOT-REC-EDITED    PIC ZZZZZ9.                 03520000
035300                                                                  03530000
035400         10  MR-VERFD-QTY-L           PIC S9(4) COMP.             03540000
035500         10  MR-VERFD-QTY-A           PIC X.                      03550000
035600         10  MR-VERFD-QTY-C           PIC X.                      03560000
035700         10  MR-VERFD-QTY-H           PIC X.                      03570000
035800         10  MR-VERFD-QTY.                                        03580000
035900             15  MR-VERFD-QTY-EDITED  PIC ZZZZ9.                  03590000
036000                                                                  03600000
036100         10  MR-STATUS-L              PIC S9(4) COMP.             03610000
036200         10  MR-STATUS-A              PIC X.                      03620000
036300         10  MR-STATUS-C              PIC X.                      03630000
036400         10  MR-STATUS-H              PIC X.                      03640000
036500         10  MR-STATUS                PIC X(02).                  03650000
036600                                                                  03660000
036700         10  MR-LAST-QTY-REC-L        PIC S9(4) COMP.             03670000
036800         10  MR-LAST-QTY-REC-A        PIC X.                      03680000
036900         10  MR-LAST-QTY-REC-C        PIC X.                      03690000
037000         10  MR-LAST-QTY-REC-H        PIC X.                      03700000
037100         10  MR-LAST-QTY-REC.                                     03710000
037200             15  MR-LAST-QTY-REC-EDITED                           03720000
037300                                      PIC ZZZZZ9.                 03730000
037400                                                                  03740000
037500         10  MR-LAST-DTE-REC-L        PIC S9(4) COMP.             03750000
037600         10  MR-LAST-DTE-REC-A        PIC X.                      03760000
037700         10  MR-LAST-DTE-REC-C        PIC X.                      03770000
037800         10  MR-LAST-DTE-REC-H        PIC X.                      03780000
037900         10  MR-LAST-DTE-REC          PIC X(06).                  03790000
038000                                                                  03800000
038100         10  MR-PRIOR-QTY-REC-L       PIC S9(4) COMP.             03810000
038200         10  MR-PRIOR-QTY-REC-A       PIC X.                      03820000
038300         10  MR-PRIOR-QTY-REC-C       PIC X.                      03830000
038400         10  MR-PRIOR-QTY-REC-H       PIC X.                      03840000
038500         10  MR-PRIOR-QTY-REC.                                    03850000
038600             15  MR-PRIOR-QTY-REC-EDITED                          03860000
038700                                      PIC ZZZZZ9.                 03870000
038800                                                                  03880000
038900         10  MR-PRIOR-DTE-REC-L       PIC S9(4) COMP.             03890000
039000         10  MR-PRIOR-DTE-REC-A       PIC X.                      03900000
039100         10  MR-PRIOR-DTE-REC-C       PIC X.                      03910000
039200         10  MR-PRIOR-DTE-REC-H       PIC X.                      03920000
039300         10  MR-PRIOR-DTE-REC         PIC X(06).                  03930000
039400                                                                  03940000
039500******************************************************************03950000
039600*    BMS ATTRIBUTES                                               03960000
039700******************************************************************03970000
039800     COPY DPWS015.                                                03980024
039900                                                                  03990000
040000******************************************************************04000000
040100*    FUNCTION KEYS                                                04010000
040200******************************************************************04020000
040300     COPY DPWS016.                                                04030024
040400                                                                  04040000
040500******************************************************************04050000
040600*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   04060000
040700******************************************************************04070000
040800     COPY DPWS010I.                                               04080024
040900                                                                  04090000
041000******************************************************************04100000
041100*    PARAMETER LIST FOR CICS API                                  04110000
041200******************************************************************04120000
041300     COPY DPWS030.                                                04130024
041310     COPY DPWS930.                                                04131030
041400                                                                  04140000
041500******************************************************************04150000
041600*    GLOBAL COMMUNICATION AREA                                    04160000
041700******************************************************************04170000
041800     COPY DPWS020.                                                04180024
041900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04190000
042000                                                                  04200000
042100******************************************************************04210000
042200*    INTER-APPLICATION COMMUNICATION AREA                         04220000
042300*    RCWS015 = INPUT FROM PACK SLIP LINE SUMMARY PROGRAM          04230000
042400******************************************************************04240000
042500         10  INTER-APPL-COMM-AREA       PIC X(200).               04250000
042600     COPY RCWS015.                                                04260024
042700     COPY PCWS000.                                                04270024
042800                                                                  04280000
042900******************************************************************04290000
043000*    APPLICATION SPECIFIC COMMUNICATION AREA                      04300000
043100******************************************************************04310000
043200         10  ASC-SPECIFIC-COMMAREA.                               04320000
043300             15  ASC-LIST-HEADER-INFO.                            04330000
043400                 20  ASC-KEY-RECEIVER.                            04340000
043500                     25  ASC-KEY-PO-NBR.                          04350000
043600** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  04360028
043700                         30  ASC-KEY-PO-NBR-N   PIC 9(08).        04370028
043800                     25  ASC-KEY-REC-DASH       PIC X(01).        04380000
043900                     25  ASC-KEY-REC-SEQ-NBR.                     04390000
044000                         30  ASC-KEY-REC-SEQ-NBR-N                04400000
044100                                                PIC 9(04).        04410000
044200                 20  ASC-KEY-PKSL-LNE-NBR       PIC 9(04).        04420000
044300                 20  ASC-KEY-AD-EVNT-DTE        PIC X(10).        04430000
044400                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        04440000
044500                 20  ASC-KEY-REC-LNE-QTY        PIC 9(06).        04450000
044600                 20  ASC-KEY-INNR-PACK-QTY      PIC 9(03).        04460000
044700                 20  ASC-KEY-CASE-PACK-QTY      PIC 9(03).        04470000
044800                 20  ASC-KEY-DISTR-LNE-QTY      PIC 9(06).        04480000
044900                 20  ASC-KEY-TOTAL-OTR          PIC 9(06).        04490000
045000                 20  ASC-KEY-SEQ-NBR            PIC S9(4) COMP.   04500000
045100                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   04510000
045200                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   04520000
045300                 20  ASC-KEY-FCLTY-DESC         PIC X(30).        04530000
045400                 20  ASC-KEY-PKSL-NBR           PIC X(10).        04540000
045500             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               04550000
045600                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       04560000
045700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04570000
045800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04580000
045900                                                                  04590000
046000                 20  ASC-ITEM-ARRAY.                              04600000
046100                     25  ASC-ITEM-ENTRIES  OCCURS 10 TIMES.       04610000
046200                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    04620000
046300                                                     COMP-3.      04630000
046400                         30  ASC-TEMP-SELECTED-SW    PIC X.       04640000
046500                             88  ASC-VALID-SELECT    VALUE ' '    04650000
046600                                                           'S'    04660000
046700                                                           'B'    04670000
046800                                                           'E'.   04680000
046900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04690000
047000                             88  ASC-TEMP-SELECT     VALUE 'S'.   04700000
047100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04710000
047200                             88  ASC-TEMP-END        VALUE 'E'.   04720000
047300                         30  ASC-SELECTED-SW         PIC  X.      04730000
047400                             88  ASC-NO-SELECT       VALUE ' '.   04740000
047500                             88  ASC-SELECT          VALUE 'S'.   04750000
047600                             88  ASC-BEGIN           VALUE 'B'.   04760000
047700                             88  ASC-END             VALUE 'E'.   04770000
047800*BJ                                                               04780000
047900                         30  ASC-STR-QTY-PREV        PIC 9(05).   04790000
048000                         30  ASC-STR-QTY             PIC X(05).   04800000
048100                         30  ASC-STR-QTY-N REDEFINES ASC-STR-QTY  04810000
048200                                                 PIC 9(05).       04820000
048300                         30  ASC-STR-NBR             PIC X(04).   04830000
048400                         30  ASC-STR-NBR-N REDEFINES ASC-STR-NBR  04840000
048500                                                     PIC 9(04).   04850000
048600                         30  ASC-EXPTED-ITM-QTY.                  04860000
048700                             35  ASC-EXPTED-ITM-QTY-N             04870000
048800                                                     PIC 9(05).   04880000
048900                         30  ASC-OPEN-TO-REC.                     04890000
049000                             35  ASC-OPEN-TO-REC-N   PIC 9(06).   04900000
049100                         30  ASC-UNT-QTY.                         04910000
049200                             35  ASC-UNT-QTY-N       PIC 9(06).   04920000
049300                         30  ASC-TOT-REC.                         04930000
049400                             35  ASC-TOT-REC-N       PIC 9(06).   04940000
049500                         30  ASC-VERFD-QTY.                       04950000
049600                             35  ASC-VERFD-QTY-N     PIC 9(05).   04960000
049700                         30  ASC-STATUS              PIC X(02).   04970000
049800                         30  ASC-LAST-QTY-REC.                    04980000
049900                             35  ASC-LAST-QTY-REC-N  PIC 9(06).   04990000
050000                         30  ASC-LAST-DTE-REC        PIC X(06).   05000000
050100                         30  ASC-PRIOR-QTY-REC.                   05010000
050200                             35  ASC-PRIOR-QTY-REC-N PIC 9(06).   05020000
050300                         30  ASC-PRIOR-DTE-REC       PIC X(06).   05030000
050400                                                                  05040000
050500             15  ASC-BLK-SUB                         PIC S9(4)    05050000
050600                                                     COMP SYNC.   05060000
050700             15  ASC-ITEM-SUB                        PIC S9(4)    05070000
050800                                                     COMP SYNC.   05080000
050900             15  ASC-SEL-SUB                         PIC S9(4)    05090000
051000                                                     COMP.        05100000
051100             15  ASC-SEL-ITEM                        PIC S9(4)    05110000
051200                                                     COMP.        05120000
051300             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    05130000
051400                                                     COMP-3.      05140000
051500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    05150000
051600                                                     COMP-3.      05160000
051700             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    05170000
051800                                                     COMP-3.      05180000
051900             15  ASC-ITEMS-DISPLAYED                 PIC S999     05190000
052000                                                     COMP-3.      05200000
052100             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    05210000
052200                                                     COMP-3.      05220000
052300             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    05230000
052400                                                     COMP-3.      05240000
052500             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    05250000
052600                                                     COMP SYNC.   05260000
052700             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    05270000
052800                                                     COMP-3.      05280000
052900             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    05290000
053000                                                     COMP-3.      05300000
053100             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       05310000
053200                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05320000
053300                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05330000
053400             15  ASC-UPDATE-SW                       PIC X.       05340000
053500                 88  ASC-CAN-UPDATE                  VALUE 'Y'.   05350000
053600                 88  ASC-CANT-UPDATE                 VALUE 'N'.   05360000
053700             15  ASC-LIST-QUEUE-NAME.                             05370000
053800                 20  ASC-LIST-TERM-ID                PIC X(4).    05380000
053900                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    05390000
054000                                                     COMP-3.      05400000
054100                 20  ASC-LIST-SEQ                    PIC 9.       05410000
054200             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    05420000
054300             15  ASC-SEL-QUEUE-NAME-OUT.                          05430000
054400                 20  ASC-SEL-TERM-ID                 PIC X(4).    05440000
054500                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    05450000
054600                                                     COMP-3.      05460000
054700                 20  ASC-SEL-SEQ                     PIC 9.       05470000
054800             15  ASC-START-ITEM-REQUEST.                          05480000
054900                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    05490000
055000             15  ASC-RECDIS-SW                       PIC X.       05500000
055100                 88  ASC-MORE-RECDIS                 VALUE 'Y'.   05510000
055200                 88  ASC-NO-MORE-RECDIS              VALUE 'N'.   05520000
055300             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    05530000
055400                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   05540000
055500             15  ASC-SKU-NBR                         PIC X(15).   05550000
055600             15  ASC-VEND-STYL-NAME                  PIC X(20).   05560000
055700             15  ASC-PURCHS-STATUS-CDE               PIC X(02).   05570000
055800             15  ASC-PURITM-STATUS-CDE               PIC X(02).   05580000
055900             15  ASC-PURITM-UNT-QTY                  PIC S9(9)    05590000
056000                                                         COMP.    05600000
056100             15  ASC-HOLD-INTER-APPL                 PIC X(200).  05610000
056200             15  ASC-INTER-APPL-CODE-IND             PIC X(01).   05620000
056300                 88  ASC-INTER-APPL-WO-LIST          VALUE '1'.   05630000
056400                 88  ASC-INTER-APPL-VERIFY           VALUE '2'.   05640000
056500                                                                  05650000
056600******************************************************************05660000
056700*    ABEND PROCESSING                                             05670000
056800******************************************************************05680000
056900     COPY DPWS013.                                                05690024
057000                                                                  05700000
057100******************************************************************05710000
057200*    DB2 SQL COMMUNICATION AREA                                   05720000
057300******************************************************************05730000
057400     EXEC SQL                                                     05740000
057500          INCLUDE SQLCA                                           05750000
057600     END-EXEC.                                                    05760000
057700                                                                  05770000
057800******************************************************************05780000
057900*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        05790000
058000******************************************************************05800000
058100     EXEC SQL                                                     05810000
058200          INCLUDE TPKSLIP                                         05820000
058300     END-EXEC.                                                    05830000
058400                                                                  05840000
058500******************************************************************05850000
058600*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          05860000
058700******************************************************************05870000
058800     EXEC SQL                                                     05880000
058900          INCLUDE TPKITEM                                         05890000
059000     END-EXEC.                                                    05900000
059100                                                                  05910000
059200******************************************************************05920000
059300*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          05930000
059400******************************************************************05940000
059500     EXEC SQL                                                     05950000
059600          INCLUDE TPURCHS                                         05960000
059700     END-EXEC.                                                    05970000
059800                                                                  05980000
059900******************************************************************05990000
060000*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     06000000
060100******************************************************************06010000
060200     EXEC SQL                                                     06020000
060300          INCLUDE TPURITM                                         06030000
060400     END-EXEC.                                                    06040000
060500                                                                  06050000
060600******************************************************************06060000
060700*    DB2 DCLGEN FOR RECEIVER TABLE                                06070000
060800******************************************************************06080000
060900     EXEC SQL                                                     06090000
061000          INCLUDE TRECEIV                                         06100000
061100     END-EXEC.                                                    06110000
061200                                                                  06120000
061300******************************************************************06130000
061400*    DB2 DCLGEN FOR RECEIVER ITEM TABLE                           06140000
061500******************************************************************06150000
061600     EXEC SQL                                                     06160000
061700          INCLUDE TRECITM                                         06170000
061800     END-EXEC.                                                    06180000
061900                                                                  06190000
062000******************************************************************06200000
062100*    DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                   06210000
062200******************************************************************06220000
062300     EXEC SQL                                                     06230000
062400          INCLUDE TRECDIS                                         06240000
062500     END-EXEC.                                                    06250000
062600                                                                  06260000
062700******************************************************************06270000
062800*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  06280000
062900******************************************************************06290000
063000     EXEC SQL                                                     06300000
063100          INCLUDE TENTNME                                         06310000
063200     END-EXEC.                                                    06320000
063300                                                                  06330000
063400******************************************************************06340000
063500*    DB2 DCLGEN FOR THE ALL PLAN TABLE                            06350000
063600******************************************************************06360000
063700     EXEC SQL                                                     06370000
063800          INCLUDE TALLPLN                                         06380000
063900     END-EXEC.                                                    06390000
064000                                                                  06400000
064100******************************************************************06410000
064200*    DB2 DCLGEN FOR THE MERCHANDISE DISTRIBUTION TABLE            06420000
064300******************************************************************06430000
064400     EXEC SQL                                                     06440000
064500          INCLUDE TMESTDS                                         06450000
064600     END-EXEC.                                                    06460000
064700                                                                  06470000
064800******************************************************************06480000
064900*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECEIVER DISTRIBUTION 06490000
065000******************************************************************06500000
065100     EXEC SQL                                                     06510000
065200          DECLARE RECDIS-CURSOR CURSOR FOR                        06520000
065300           SELECT EXPTED_ITM_QTY,                                 06530000
065400                  VERIFY_ITM_QTY,                                 06540000
065500                  AP_VERIFY_ITM_QTY,                              06550000
065600                  STR_NBR                                         06560000
065700             FROM TRECDIS                                         06570000
065800            WHERE ORD_NBR        = :DK-PO-NBR                     06580000
065900              AND ORD_LNE_NBR    = :DK-PKSL-LNE-NBR               06590000
066000              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                06600000
066100              AND OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID           06610000
066200              AND FCLTY_ID       = :ASC-KEY-FCLTY-ID              06620000
066400         ORDER BY STR_NBR                                         06640000
066500     END-EXEC.                                                    06650000
066600                                                                  06660000
066700******************************************************************06670000
066800*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PRIOR RCVR DISTRO     06680000
066900******************************************************************06690000
067000     EXEC SQL                                                     06700000
067100          DECLARE PRIOR-RCVR-CURSOR CURSOR FOR                    06710000
067200           SELECT DATE(A.REC_TMST)                                06720000
067300                , A.STATUS_CDE                                    06730000
067400                , A.REC_SEQ_NBR                                   06740000
067500                , B.EXPTED_ITM_QTY                                06750000
067600                , B.VERIFY_ITM_QTY                                06760000
067700                , B.AP_VERIFY_ITM_QTY                             06770000
067800             FROM TRECEIV A,                                      06780000
067900                  TRECDIS B                                       06790000
068000            WHERE A.ORD_NBR        = :DK-PO-NBR                   06800000
068100              AND A.ORD_NBR        = B.ORD_NBR                    06810000
068200              AND B.ORD_LNE_NBR    = :DK-PKSL-LNE-NBR             06820000
068300              AND A.REC_SEQ_NBR    < :DK-REC-SEQ-NBR              06830000
068400              AND B.STR_NBR        = :DK-STR-NBR                  06840000
068500              AND B.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID         06850000
068600              AND B.FCLTY_ID       = :ASC-KEY-FCLTY-ID            06860000
068700              AND A.VER_STATUS_CDE = :PC-ACTIVE                   06870000
068900         ORDER BY A.REC_SEQ_NBR DESC                              06890000
069000     END-EXEC.                                                    06900000
069100                                                                  06910000
069200 LINKAGE SECTION.                                                 06920000
069300                                                                  06930000
069400 01  DFHCOMMAREA.                                                 06940000
069500     05  FILLER                       OCCURS 1 TO 4072 TIMES      06950000
069600                                      DEPENDING ON EIBCALEN.      06960000
069700         10  FILLER                   PIC X.                      06970000
069800                                                                  06980000
069900                                                                  06990000
070000 PROCEDURE DIVISION.                                              07000000
070100                                                                  07010000
070200 0000-MAIN-MODULE.                                                07020000
070300                                                                  07030000
070400     INITIALIZE DP030-CICS-API-FIELDS.                            07040000
070500                                                                  07050000
070600     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         07060000
070700     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            07070000
070800     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           07080000
070900     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         07090000
071000     MOVE LENGTH OF RC295AI      TO DP030-MAP-LENGTH (1).         07100000
071100     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       07110000
071200     SET DP030-OVERRIDE-APPL-ERROR                                07120000
071300                                 TO TRUE.                         07130000
071400                                                                  07140000
071500     PERFORM 0001-CALL-CICS-ARCH-API.                             07150000
071600                                                                  07160000
071700     PERFORM 1000-CONTROL-PROCESSING.                             07170000
071800                                                                  07180000
071900     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       07190000
072000                                                                  07200000
072100     PERFORM 0001-CALL-CICS-ARCH-API.                             07210000
072200                                                                  07220000
072300 0001-CALL-CICS-ARCH-API.                                         07230000
072400                                                                  07240000
072510     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07251030
072600                                    DFHCOMMAREA                   07260030
072700                                    DP030-CICS-API-FIELDS         07270030
072800                                    DP020-STANDARD-COMMAREA       07280030
072900                                    RC295AI.                      07290030
073000                                                                  07300000
073100     IF DP030-RC-CALL-SUCCESSFUL OR                               07310000
073200        DP030-RC-APPL-ERROR                                       07320000
073300         CONTINUE                                                 07330000
073400     ELSE                                                         07340000
073500         SET DP013-CICS-ABEND                                     07350000
073600             DP013-NO-ROLLBACK                                    07360000
073700             DP013-XCTL-DISPLAY-RESTART                           07370000
073800                                 TO TRUE                          07380000
073900         MOVE '0001-CALL-CICS-ARCH-API'                           07390000
074000                                 TO DP013-PARAGRAPH               07400000
074020         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O07402030
074030-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07403030
074300         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        07430000
074400                                                                  07440000
074500         PERFORM DP013-0000-PROCESS-ABEND.                        07450000
074600                                                                  07460000
074700 1000-CONTROL-PROCESSING.                                         07470000
074800                                                                  07480000
074900     EVALUATE TRUE                                                07490000
075000                                                                  07500000
075100         WHEN DP030-RC-APPL-ERROR                                 07510000
075200              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07520000
075300                                 TO PV-TOP-ITEM                   07530000
075400              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      07540000
075500                                                                  07550000
075600              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                07560000
075700                                                                  07570000
075800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07580000
075900                                                                  07590000
076000                                                                  07600000
076100         WHEN DP020-NEXT-ACT-INITIAL                              07610000
076200              INITIALIZE ASC-SPECIFIC-COMMAREA                    07620000
076300              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              07630000
076400                                    ASC-SEL-TERM-ID               07640000
076500              MOVE DP020-SRC-TASK-NUMBER                          07650000
076600                                 TO ASC-LIST-TASK-NUMBER          07660000
076700                                    ASC-SEL-TASK-NUMBER           07670000
076800              MOVE PC-LIST-QUEUE-SEQ                              07680000
076900                                 TO ASC-LIST-SEQ                  07690000
077000              MOVE PC-SEL-QUEUE-SEQ                               07700000
077100                                 TO ASC-SEL-SEQ                   07710000
077200              SET PS-NO-ERROR    TO TRUE                          07720000
077300                                                                  07730000
077400              PERFORM 1100-PROCESS-INTER-APPL-COMM                07740000
077500                                                                  07750000
077600              IF PS-NO-ERROR                                      07760000
077700                  MOVE INTER-APPL-COMM-AREA                       07770000
077800                                 TO ASC-HOLD-INTER-APPL           07780000
077900                  PERFORM 4000-BUILD-INITIAL-PANEL                07790000
078000                  PERFORM 3200-RESET-ATTRIBUTES                   07800000
078100              END-IF                                              07810000
078200                                                                  07820000
078300                                                                  07830000
078400         WHEN DP020-NEXT-ACT-READ-MAP                             07840000
078500              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07850000
078600                                 TO PV-TOP-ITEM                   07860000
078700                                                                  07870000
078800              PERFORM 2000-PROCESS-PANEL                          07880000
078900                                                                  07890000
079000                                                                  07900000
079100         WHEN DP020-NEXT-ACT-RETURN                               07910000
079200              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07920000
079300                                 TO PV-TOP-ITEM                   07930000
079400              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      07940000
079500              MOVE ASC-HOLD-INTER-APPL                            07950000
079600                                 TO INTER-APPL-COMM-AREA          07960000
079700                                                                  07970000
079800                                                                  07980000
079900              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                07990000
080000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08000000
080100                                                                  08010000
080200                                                                  08020000
080300         WHEN OTHER                                               08030000
080400              SET DP013-LOGIC-ABEND                               08040000
080500                  DP013-NO-ROLLBACK                               08050000
080600                                 TO TRUE                          08060000
080700              MOVE '1000-CONTROL-PROCESSING'                      08070000
080800                                 TO DP013-PARAGRAPH               08080000
080900              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   08090000
081000                                 TO DP013-MESSAGE-TEXT(1)         08100000
081100                                                                  08110000
081200              PERFORM DP013-0000-PROCESS-ABEND                    08120000
081300                                                                  08130000
081400     END-EVALUATE.                                                08140000
081500                                                                  08150000
081600 1100-PROCESS-INTER-APPL-COMM.                                    08160000
081700                                                                  08170000
081800     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       08180000
081900     IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO                     08190000
082000         SET ASC-NO-TSQ-UPDATE                                    08200000
082100             DP020-MSG-FATAL                                      08210000
082200             DP020-NEXT-ACT-APPL-ERROR                            08220000
082300             PS-ERROR            TO TRUE                          08230000
082400         MOVE PC-TSYMSG-00057    TO DP020-MSG-NUMBER              08240000
082500     ELSE                                                         08250000
082600         MOVE RC015-PO-NBR       TO ASC-KEY-PO-NBR-N              08260000
082700         MOVE RC015-SEQ-NBR      TO ASC-KEY-SEQ-NBR               08270000
082800         MOVE RC015-REC-SEQ-NBR  TO ASC-KEY-REC-SEQ-NBR-N         08280000
082900         MOVE RC015-OPER-UNT-ID  TO ASC-KEY-OPER-UNT-ID           08290000
083000         MOVE RC015-FCLTY-ID     TO ASC-KEY-FCLTY-ID              08300000
083100         MOVE RC015-PKSL-NBR     TO ASC-KEY-PKSL-NBR              08310000
083200         SET ASC-USE-SELECTION-QUEUE                              08320000
083300                                 TO TRUE                          08330000
083400         MOVE RC015-NUMBER-OF-SELECTED-ITEMS                      08340000
083500                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  08350000
083600         MOVE RC015-NUMBER-OF-TS-ITEMS                            08360000
083700                                 TO ASC-NUMBER-OF-TS-ITEMS        08370000
083800         MOVE RC015-SEL-QUEUE-NAME                                08380000
083900                                 TO ASC-SEL-QUEUE-NAME-IN         08390000
084000         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   08400000
084100         MOVE ZERO               TO ASC-SEL-ITEM                  08410000
084200         PERFORM 2300-GET-NEXT-RECORD                             08420000
084300     END-IF.                                                      08430000
084400                                                                  08440000
084500 2000-PROCESS-PANEL.                                              08450000
084600                                                                  08460000
084700     EVALUATE TRUE                                                08470000
084800                                                                  08480000
084900         WHEN DP020-SRC-AID = DP016-CLEAR                         08490000
085000              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      08500000
085100                                                                  08510000
085200              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08520000
085300                                                                  08530000
085400                                                                  08540000
085500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08550000
085600                                                                  08560000
085700              PERFORM 2050-DELETE-LIST-QUEUE                      08570000
085800                                                                  08580000
085900              PERFORM 4000-BUILD-INITIAL-PANEL                    08590000
086000                                                                  08600000
086100              PERFORM 3200-RESET-ATTRIBUTES                       08610000
086200                                                                  08620000
086300         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   08630000
086400                                                                  08640000
086500              PERFORM 2140-DESELECT-ALL-ITEMS                     08650000
086600                                                                  08660000
086700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08670000
086800                                                                  08680000
086900         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 08690000
087000                                                                  08700000
087100              PERFORM 2150-SELECT-ALL-ITEMS                       08710000
087200                                                                  08720000
087300              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                08730000
087400                                                                  08740000
087500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08750000
087600             IF ASC-USE-SELECTION-QUEUE                           08760000
087700                 PERFORM 6200-DEL-LIST-QUEUE                      08770000
087800                 IF ASC-INTER-APPL-WO-LIST                        08780000
087900                     PERFORM 2400-GET-NEXT-WO-RECORD              08790000
088000                 ELSE                                             08800000
088100                     PERFORM 2300-GET-NEXT-RECORD                 08810000
088200                 END-IF                                           08820000
088300                 PERFORM 4000-BUILD-INITIAL-PANEL                 08830000
088400                 PERFORM 3200-RESET-ATTRIBUTES                    08840000
088500             ELSE                                                 08850000
088600*                --- BOTTOM OF LIST ---                           08860000
088700                 MOVE PC-TSYMSG-00070                             08870000
088800                                 TO DP020-MSG-NUMBER              08880000
088900                 SET DP020-MSG-INFORMATIONAL                      08890000
089000                                 TO TRUE                          08900000
089100             END-IF                                               08910000
089200                                                                  08920000
089300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08930000
089400             IF ASC-USE-SELECTION-QUEUE                           08940000
089500                 PERFORM 6200-DEL-LIST-QUEUE                      08950000
089600                 IF ASC-INTER-APPL-WO-LIST                        08960000
089700                     PERFORM 2410-GET-PREV-WO-RECORD              08970000
089800                 ELSE                                             08980000
089900                     PERFORM 2310-GET-PREV-RECORD                 08990000
090000                 END-IF                                           09000000
090100                 PERFORM 4000-BUILD-INITIAL-PANEL                 09010000
090200                 PERFORM 3200-RESET-ATTRIBUTES                    09020000
090300             ELSE                                                 09030000
090400*                --- TOP OF LIST ---                              09040000
090500                 MOVE PC-TSYMSG-00069                             09050000
090600                                 TO DP020-MSG-NUMBER              09060000
090700                 SET DP020-MSG-INFORMATIONAL                      09070000
090800                                 TO TRUE                          09080000
090900             END-IF                                               09090000
091000                                                                  09100000
091100                                                                  09110000
091200         WHEN OTHER                                               09120000
091300                                                                  09130000
091400              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                09140000
091500                                                                  09150000
091600              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  09160000
091700                                                                  09170000
091800              IF PS-NO-ERROR                                      09180000
091900                  SET DP030-CONTINUE-GO                           09190000
092000                                 TO TRUE                          09200000
092100                                                                  09210000
092200                  PERFORM 2100-CHECK-FUNCTION-KEY                 09220000
092300                                                                  09230000
092400              ELSE                                                09240000
092500                  SET DP030-OVERRIDE-GO                           09250000
092600                                 TO TRUE                          09260000
092700              END-IF                                              09270000
092800                                                                  09280000
092900     END-EVALUATE.                                                09290000
093000                                                                  09300000
093100 2050-DELETE-LIST-QUEUE.                                          09310000
093200                                                                  09320000
093300     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             09330000
093400                          RESP  (PV-CICS-RESP)                    09340000
093500                          END-EXEC.                               09350000
093600                                                                  09360000
093700     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      09370000
093800        (PV-CICS-RESP = DFHRESP (QIDERR))                         09380000
093900         CONTINUE                                                 09390000
094000     ELSE                                                         09400000
094100         SET DP013-CICS-ABEND                                     09410000
094200             DP013-NO-ROLLBACK   TO TRUE                          09420000
094300         MOVE '2050-DELETE-LIST-QUEUE'                            09430000
094400                                 TO DP013-PARAGRAPH               09440000
094500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 09450000
094600                                 TO DP013-MESSAGE-TEXT (1)        09460000
094700                                                                  09470000
094800         PERFORM DP013-0000-PROCESS-ABEND                         09480000
094900     END-IF.                                                      09490000
095000                                                                  09500000
095100     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    09510000
095200                                                                  09520000
095300 2100-CHECK-FUNCTION-KEY.                                         09530000
095400                                                                  09540000
095500     EVALUATE TRUE                                                09550000
095600                                                                  09560000
095700         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 09570000
095800             MOVE +1             TO PV-TOP-ITEM                   09580000
095900                                                                  09590000
096000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09600000
096100                                                                  09610000
096200             PERFORM 3200-RESET-ATTRIBUTES                        09620000
096300                                                                  09630000
096400                                                                  09640000
096500         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  09650000
096600                                                                  09660000
096700             PERFORM 2110-BROWSE-BACKWARD                         09670000
096800                                                                  09680000
096900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09690000
097000                                                                  09700000
097100             PERFORM 3200-RESET-ATTRIBUTES                        09710000
097200                                                                  09720000
097300                                                                  09730000
097400         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  09740000
097500                                                                  09750000
097600             PERFORM 2120-BROWSE-FORWARD                          09760000
097700                                                                  09770000
097800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09780000
097900                                                                  09790000
098000             PERFORM 3200-RESET-ATTRIBUTES                        09800000
098100                                                                  09810000
098200                                                                  09820000
098300         WHEN DP020-SRC-AID = DP016-ENTER                         09830000
098400                                                                  09840000
098500             PERFORM 2180-CHECK-FOR-JUMP-BROWSE                   09850000
098600                                                                  09860000
098700             IF PS-NO-ERROR                                       09870000
098800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09880000
098900             END-IF                                               09890000
099000                                                                  09900000
099100         WHEN OTHER                                               09910000
099200             SET DP013-CICS-ABEND                                 09920000
099300                 DP013-NO-ROLLBACK                                09930000
099400                 DP013-XCTL-DISPLAY-RESTART                       09940000
099500                                 TO TRUE                          09950000
099600             MOVE '2100-CHECK-FUNCTION-KEY'                       09960000
099700                                 TO DP013-PARAGRAPH               09970000
099800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09980000
099900                                 TO DP013-MESSAGE-TEXT (1)        09990000
100000                                                                  10000000
100100             PERFORM DP013-0000-PROCESS-ABEND                     10010000
100200     END-EVALUATE.                                                10020000
100300                                                                  10030000
100400 2110-BROWSE-BACKWARD.                                            10040000
100500                                                                  10050000
100600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10060000
100700         GIVING PV-TOP-ITEM.                                      10070000
100800                                                                  10080000
100900     IF PV-TOP-ITEM NOT > +1                                      10090000
101000         MOVE +1                 TO PV-TOP-ITEM                   10100000
101100         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              10110000
101200         SET DP020-MSG-INFORMATIONAL                              10120000
101300                                 TO TRUE.                         10130000
101400                                                                  10140000
101500 2120-BROWSE-FORWARD.                                             10150000
101600                                                                  10160000
101700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              10170000
101800         GIVING PV-TOP-ITEM.                                      10180000
101900                                                                  10190000
102000     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    10200000
102100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10210000
102200                                 TO PV-TOP-ITEM                   10220000
102300         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              10230000
102400         SET DP020-MSG-INFORMATIONAL                              10240000
102500                                 TO TRUE                          10250000
102600     ELSE                                                         10260000
102700         COMPUTE PV-BOTTOM-ITEM =                                 10270000
102800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 10280000
102900         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             10290000
103000             MOVE PC-TSYMSG-00070                                 10300000
103100                                 TO DP020-MSG-NUMBER              10310000
103200             SET DP020-MSG-INFORMATIONAL                          10320000
103300                                 TO TRUE.                         10330000
103400                                                                  10340000
103500 2180-CHECK-FOR-JUMP-BROWSE.                                      10350000
103600                                                                  10360000
103700     SET PS-NO-ERROR             TO TRUE.                         10370000
103800                                                                  10380000
103900     IF ASC-START-ITEM-REQUEST = SPACE                            10390000
104000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10400000
104100                                 TO PV-TOP-ITEM                   10410000
104200     ELSE                                                         10420000
104300         MOVE ASC-START-ITEM-REQUEST                              10430000
104400                                 TO DP010I-UNEDITED-FIELD         10440000
104500         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         10450000
104600         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       10460000
104700         SET DP010I-NEGATIVE-NOT-ALLOWED                          10470000
104800                                 TO TRUE                          10480000
104900                                                                  10490000
105010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10501029
105020              USING DP010I-NUMERIC-EDIT-AREA                      10502029
105100                                                                  10510000
105200         IF NOT DP010I-ERROR-DETECTED                             10520000
105300             MOVE DP010I-NUMERIC-FIELD                            10530000
105400                                 TO ASC-START-ITEM-REQUEST-N      10540000
105500             IF ASC-START-ITEM-REQUEST-N > ZERO                   10550000
105600                IF ASC-START-ITEM-REQUEST-N >                     10560000
105700                                          ASC-NUMBER-OF-ITEMS-READ10570000
105800                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        10580000
105900                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ10590000
106000                                          - PC-ITEMS-PER-PANEL + 110600000
106100                    IF PV-TOP-ITEM < +1                           10610000
106200                        MOVE +1  TO PV-TOP-ITEM                   10620000
106300                        MOVE PC-TSYMSG-00070                      10630000
106400                                 TO DP020-MSG-NUMBER              10640000
106500                        SET DP020-MSG-INFORMATIONAL               10650000
106600                                 TO TRUE                          10660000
106700                    END-IF                                        10670000
106800                ELSE                                              10680000
106900                    MOVE ASC-START-ITEM-REQUEST-N                 10690000
107000                                 TO PV-TOP-ITEM                   10700000
107100                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        10710000
107200                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        10720000
107300                                            PC-ITEMS-PER-PANEL - 110730000
107400                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  10740000
107500                         MOVE PC-TSYMSG-00070                     10750000
107600                                 TO DP020-MSG-NUMBER              10760000
107700                         SET DP020-MSG-INFORMATIONAL              10770000
107800                                 TO TRUE                          10780000
107900                    END-IF                                        10790000
108000                END-IF                                            10800000
108100             ELSE                                                 10810000
108200                 MOVE PC-TSYMSG-00101                             10820000
108300                                 TO DP020-MSG-NUMBER              10830000
108400                 MOVE DP015-UNP-NUM-BRT-MDT                       10840000
108500                                 TO ASTRTITA                      10850000
108600                 MOVE DP015-RED  TO ASTRTITC                      10860000
108700                 MOVE DP015-REVERSE                               10870000
108800                                 TO ASTRTITH                      10880000
108900                 SET PS-ERROR                                     10890000
109000                     DP020-MSG-FATAL                              10900000
109100                                 TO TRUE                          10910000
109200             END-IF                                               10920000
109300         ELSE                                                     10930000
109400             MOVE PC-TSYMSG-00008                                 10940000
109500                                 TO DP020-MSG-NUMBER              10950000
109600             MOVE DP015-UNP-NUM-BRT-MDT                           10960000
109700                                 TO ASTRTITA                      10970000
109800             MOVE DP015-RED      TO ASTRTITC                      10980000
109900             MOVE DP015-REVERSE  TO ASTRTITH                      10990000
110000             SET PS-ERROR                                         11000000
110100                 DP020-MSG-FATAL TO TRUE                          11010000
110200         END-IF                                                   11020000
110300     END-IF.                                                      11030000
110400                                                                  11040000
110500 2140-DESELECT-ALL-ITEMS.                                         11050000
110600                                                                  11060000
110700     MOVE +1                     TO ASC-BLK-SUB.                  11070000
110800                                                                  11080000
110900     PERFORM 2141-CLEAR-SELECTED-INDS                             11090000
111000             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    11100000
111100             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           11110000
111200                                                                  11120000
111300     ADD +1                      TO ASC-BLK-SUB.                  11130000
111400                                                                  11140000
111500     PERFORM 2141-CLEAR-SELECTED-INDS                             11150000
111600             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    11160000
111700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           11170000
111800                                                                  11180000
111900     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              11190000
112000                                 TO PV-LIST-ITEM-NUMBER.          11200000
112100                                                                  11210000
112200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11220000
112300             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).11230000
112400                                                                  11240000
112500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11250000
112600              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)11260000
112700         MOVE +1                 TO ASC-BLK-SUB                   11270000
112800                                                                  11280000
112900         PERFORM 5100-WRITE-TEMP-STORAGE                          11290000
113000                                                                  11300000
113100         MOVE +1                 TO PV-BLOCK-NUMBER               11310000
113200                                                                  11320000
113300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11330000
113400                                       PV-FIRST-BLOCK-IN-ARRAY - 111340000
113500                                                                  11350000
113600         PERFORM                                                  11360000
113700           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         11370000
113800                                                                  11380000
113900                 PERFORM 4410-READ-TEMP-STORAGE                   11390000
114000                                                                  11400000
114100                 PERFORM 2141-CLEAR-SELECTED-INDS                 11410000
114200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        11420000
114300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL11430000
114400                                                                  11440000
114500                 PERFORM 5100-WRITE-TEMP-STORAGE                  11450000
114600                                                                  11460000
114700                 ADD +1          TO PV-BLOCK-NUMBER               11470000
114800                                                                  11480000
114900         END-PERFORM                                              11490000
115000                                                                  11500000
115100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11510000
115200                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY11520000
115300                                                                  11530000
115400         PERFORM                                                  11540000
115500           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         11550000
115600                                         ASC-HIGHEST-BLOCK-WRITTEN11560000
115700                                                                  11570000
115800                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      11580000
115900                                 TO PV-BLOCK-NUMBER               11590000
116000                                                                  11600000
116100                 PERFORM 4410-READ-TEMP-STORAGE                   11610000
116200                                                                  11620000
116300                 PERFORM 2141-CLEAR-SELECTED-INDS                 11630000
116400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        11640000
116500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL11650000
116600                                                                  11660000
116700                 PERFORM 5100-WRITE-TEMP-STORAGE                  11670000
116800                                                                  11680000
116900                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        11690000
117000                                                                  11700000
117100         END-PERFORM                                              11710000
117200                                                                  11720000
117300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11730000
117400                                 TO PV-BLOCK-NUMBER               11740000
117500                                                                  11750000
117600         PERFORM 4410-READ-TEMP-STORAGE                           11760000
117700                                                                  11770000
117800     END-IF.                                                      11780000
117900                                                                  11790000
118000     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  11800000
118100                                    ASC-START-OF-SELECTED-RANGE   11810000
118200                                    ASC-END-OF-SELECTED-RANGE.    11820000
118300                                                                  11830000
118400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11840000
118500                                                                  11850000
118600 2141-CLEAR-SELECTED-INDS.                                        11860000
118700                                                                  11870000
118800     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO11880000
118900        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           11890000
119000            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          11900000
119100                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     11910000
119200                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  11920000
119300                                 TO TRUE.                         11930000
119400                                                                  11940000
119500 2150-SELECT-ALL-ITEMS.                                           11950000
119600                                                                  11960000
119700     MOVE +1                     TO ASC-BLK-SUB.                  11970000
119800                                                                  11980000
119900     PERFORM 2151-SET-SELECTED-INDS                               11990000
120000             VARYING ASC-ITEM-SUB FROM 1 BY 1                     12000000
120100             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           12010000
120200                                                                  12020000
120300     ADD +1                      TO ASC-BLK-SUB.                  12030000
120400                                                                  12040000
120500     PERFORM 2151-SET-SELECTED-INDS                               12050000
120600             VARYING ASC-ITEM-SUB FROM 1 BY 1                     12060000
120700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           12070000
120800                                                                  12080000
120900     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              12090000
121000                                 TO PV-LIST-ITEM-NUMBER.          12100000
121100                                                                  12110000
121200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12120000
121300             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).12130000
121400                                                                  12140000
121500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12150000
121600              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)12160000
121700         MOVE +1                 TO ASC-BLK-SUB                   12170000
121800                                                                  12180000
121900         PERFORM 5100-WRITE-TEMP-STORAGE                          12190000
122000                                                                  12200000
122100         MOVE +1                 TO PV-BLOCK-NUMBER               12210000
122200                                                                  12220000
122300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12230000
122400                                       PV-FIRST-BLOCK-IN-ARRAY - 112240000
122500                                                                  12250000
122600         PERFORM                                                  12260000
122700           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         12270000
122800                                                                  12280000
122900                 PERFORM 4410-READ-TEMP-STORAGE                   12290000
123000                                                                  12300000
123100                 PERFORM 2151-SET-SELECTED-INDS                   12310000
123200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        12320000
123300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL12330000
123400                                                                  12340000
123500                 PERFORM 5100-WRITE-TEMP-STORAGE                  12350000
123600                                                                  12360000
123700                 ADD +1          TO PV-BLOCK-NUMBER               12370000
123800                                                                  12380000
123900         END-PERFORM                                              12390000
124000                                                                  12400000
124100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12410000
124200                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY12420000
124300                                                                  12430000
124400         PERFORM                                                  12440000
124500           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         12450000
124600                                         ASC-HIGHEST-BLOCK-WRITTEN12460000
124700                                                                  12470000
124800                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      12480000
124900                                 TO PV-BLOCK-NUMBER               12490000
125000                                                                  12500000
125100                 PERFORM 4410-READ-TEMP-STORAGE                   12510000
125200                                                                  12520000
125300                 PERFORM 2151-SET-SELECTED-INDS                   12530000
125400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        12540000
125500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL12550000
125600                                                                  12560000
125700                 PERFORM 5100-WRITE-TEMP-STORAGE                  12570000
125800                                                                  12580000
125900                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        12590000
126000                                                                  12600000
126100         END-PERFORM                                              12610000
126200                                                                  12620000
126300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12630000
126400                                 TO PV-BLOCK-NUMBER               12640000
126500                                                                  12650000
126600         PERFORM 4410-READ-TEMP-STORAGE                           12660000
126700     END-IF.                                                      12670000
126800                                                                  12680000
126900     MOVE ASC-NUMBER-OF-ITEMS-READ                                12690000
127000                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 12700000
127100                                                                  12710000
127200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12720000
127300                                                                  12730000
127400 2151-SET-SELECTED-INDS.                                          12740000
127500                                                                  12750000
127600     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO12760000
127700        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              12770000
127800            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             12780000
127900                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        12790000
128000                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  12800000
128100                                 TO TRUE                          12810000
128200        END-IF                                                    12820000
128300     END-IF.                                                      12830000
128400                                                                  12840000
128500 2200-MOVE-SCREEN-TO-COMMAREA.                                    12850000
128600                                                                  12860000
128700     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               12870000
128800     MOVE +1                     TO PV-SUB.                       12880000
128900                                                                  12890000
129000     PERFORM 3100-SET-SUBSCRIPTS.                                 12900000
129100                                                                  12910000
129200     IF ASTRTITL > ZERO                                           12920000
129300         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        12930000
129400     ELSE                                                         12940000
129500         IF ASTRTITF = DP015-ERASE-EOF                            12950000
129600             INITIALIZE ASC-START-ITEM-REQUEST                    12960000
129700         END-IF                                                   12970000
129800     END-IF.                                                      12980000
129900                                                                  12990000
130000******************************************************************13000000
130100* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *13010000
130200* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *13020000
130300******************************************************************13030000
130400 2300-GET-NEXT-RECORD.                                            13040000
130500                                                                  13050000
130600     ADD +1                      TO ASC-SEL-SUB.                  13060000
130700                                                                  13070000
130800     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             13080000
130900         ADD +1                  TO ASC-SEL-ITEM                  13090000
131000         MOVE +1                 TO ASC-SEL-SUB                   13100000
131100     END-IF.                                                      13110000
131200                                                                  13120000
131300     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 13130000
131400         PERFORM 9100-READ-SEL-QUEUE                              13140000
131500         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       13150000
131600             MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                13160000
131700                                 TO ASC-KEY-PKSL-LNE-NBR          13170000
131800             SET RC013-INQ (ASC-SEL-SUB)                          13180000
131900                                 TO TRUE                          13190000
132000             PERFORM 9200-REWRITE-LIST-QUEUE                      13200000
132100         ELSE                                                     13210000
132200             SUBTRACT +1 FROM ASC-SEL-SUB                         13220000
132300*            --- BOTTOM OF LIST ---                               13230000
132400             MOVE PC-TSYMSG-00070                                 13240000
132500                                 TO DP020-MSG-NUMBER              13250000
132600             SET DP020-MSG-INFORMATIONAL                          13260000
132700                                 TO TRUE                          13270000
132800         END-IF                                                   13280000
132900     ELSE                                                         13290000
133000         SUBTRACT +1 FROM ASC-SEL-ITEM                            13300000
133100         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   13310000
133200         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              13320000
133300         SET DP020-MSG-INFORMATIONAL                              13330000
133400                                 TO TRUE                          13340000
133500     END-IF.                                                      13350000
133600                                                                  13360000
133700/                                                                 13370000
133800******************************************************************13380000
133900* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *13390000
134000* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *13400000
134100******************************************************************13410000
134200 2310-GET-PREV-RECORD.                                            13420000
134300                                                                  13430000
134400     SUBTRACT +1 FROM ASC-SEL-SUB.                                13440000
134500                                                                  13450000
134600     IF ASC-SEL-SUB < +1                                          13460000
134700         SUBTRACT +1 FROM ASC-SEL-ITEM                            13470000
134800         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   13480000
134900     END-IF.                                                      13490000
135000                                                                  13500000
135100     IF ASC-SEL-ITEM > ZERO                                       13510000
135200         PERFORM 9100-READ-SEL-QUEUE                              13520000
135300         MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                    13530000
135400                                 TO ASC-KEY-PKSL-LNE-NBR          13540000
135500     ELSE                                                         13550000
135600         MOVE +1                 TO ASC-SEL-ITEM                  13560000
135700                                    ASC-SEL-SUB                   13570000
135800*        --- TOP OF LIST ---                                      13580000
135900         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              13590000
136000         SET DP020-MSG-INFORMATIONAL                              13600000
136100                                 TO TRUE                          13610000
136200     END-IF.                                                      13620000
136300                                                                  13630000
136400******************************************************************13640000
136500* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE WO           *13650000
136600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *13660000
136700******************************************************************13670000
136800 2400-GET-NEXT-WO-RECORD.                                         13680000
136900                                                                  13690000
137000     ADD +1                      TO ASC-SEL-SUB.                  13700000
137100                                                                  13710000
137200     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             13720000
137300         ADD +1                  TO ASC-SEL-ITEM                  13730000
137400         MOVE +1                 TO ASC-SEL-SUB                   13740000
137500     END-IF.                                                      13750000
137600                                                                  13760000
137700     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 13770000
137800         PERFORM 9300-READ-WO-SEL-QUEUE                           13780000
137900         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       13790000
138000             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  13800000
138100                                 TO ASC-KEY-PKSL-LNE-NBR          13810000
138200             SET PC016-INQ (ASC-SEL-SUB)                          13820000
138300                                 TO TRUE                          13830000
138400             PERFORM 9400-REWRITE-WO-LIST-QUEUE                   13840000
138500         ELSE                                                     13850000
138600             SUBTRACT +1 FROM ASC-SEL-SUB                         13860000
138700*            --- BOTTOM OF LIST ---                               13870000
138800             MOVE PC-TSYMSG-00070                                 13880000
138900                                 TO DP020-MSG-NUMBER              13890000
139000             SET DP020-MSG-INFORMATIONAL                          13900000
139100                                 TO TRUE                          13910000
139200         END-IF                                                   13920000
139300     ELSE                                                         13930000
139400         SUBTRACT +1 FROM ASC-SEL-ITEM                            13940000
139500         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   13950000
139600         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              13960000
139700         SET DP020-MSG-INFORMATIONAL                              13970000
139800                                 TO TRUE                          13980000
139900     END-IF.                                                      13990000
140000                                                                  14000000
140100/                                                                 14010000
140200******************************************************************14020000
140300* GET THE KEYS OF THE PREVIOUS SELECTED WORK ORDER OBJECT FROM   *14030000
140400* THE INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                   *14040000
140500******************************************************************14050000
140600 2410-GET-PREV-WO-RECORD.                                         14060000
140700                                                                  14070000
140800     SUBTRACT +1 FROM ASC-SEL-SUB.                                14080000
140900                                                                  14090000
141000     IF ASC-SEL-SUB < +1                                          14100000
141100         SUBTRACT +1 FROM ASC-SEL-ITEM                            14110000
141200         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   14120000
141300     END-IF.                                                      14130000
141400                                                                  14140000
141500     IF ASC-SEL-ITEM > ZERO                                       14150000
141600         PERFORM 9300-READ-WO-SEL-QUEUE                           14160000
141700         MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                      14170000
141800                                 TO ASC-KEY-PKSL-LNE-NBR          14180000
141900     ELSE                                                         14190000
142000         MOVE +1                 TO ASC-SEL-ITEM                  14200000
142100                                    ASC-SEL-SUB                   14210000
142200*        --- TOP OF LIST ---                                      14220000
142300         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              14230000
142400         SET DP020-MSG-INFORMATIONAL                              14240000
142500                                 TO TRUE                          14250000
142600     END-IF.                                                      14260000
142700                                                                  14270000
142800 3000-EDIT-DATA-IN-COMMAREA.                                      14280000
142900                                                                  14290000
143000     SET PS-NO-ERROR             TO TRUE.                         14300000
143100                                                                  14310000
143200     PERFORM 3200-RESET-ATTRIBUTES.                               14320000
143300                                                                  14330000
143400     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       14340000
143500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       14350000
143600                                          ASC-ITEMS-DISPLAYED - 1.14360000
143700     PERFORM 3100-SET-SUBSCRIPTS.                                 14370000
143800                                                                  14380000
143900 3100-SET-SUBSCRIPTS.                                             14390000
144000                                                                  14400000
144100     COMPUTE ASC-ITEM-SUB =                                       14410000
144200                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.14420000
144300                                                                  14430000
144400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         14440000
144500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            14450000
144600         MOVE PC-MAX-BLOCKS-IN-ARRAY                              14460000
144700                                 TO ASC-BLK-SUB                   14470000
144800     ELSE                                                         14480000
144900         MOVE +1                 TO ASC-BLK-SUB                   14490000
145000     END-IF.                                                      14500000
145100                                                                  14510000
145200 3200-RESET-ATTRIBUTES.                                           14520000
145300                                                                  14530000
145400     MOVE DP015-HL-OFF           TO ADQTYH.                       14540000
145500     MOVE DP015-BLUE             TO ADQTYC.                       14550000
145600                                                                  14560000
145700     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     14570000
145800     MOVE DP015-GREEN            TO ASTRTITC.                     14580000
145900     MOVE DP015-UNDERLINE        TO ASTRTITH.                     14590000
146000     MOVE -1                     TO ASTRTITL.                     14600000
146100     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         14610000
146200                                                                  14620000
146300 4000-BUILD-INITIAL-PANEL.                                        14630000
146400                                                                  14640000
146500     INITIALIZE ASC-BLOCK-ENTRIES (1)                             14650000
146600                ASC-BLOCK-ENTRIES (2).                            14660000
146700                                                                  14670000
146800     MOVE +1                     TO ASC-BLK-SUB.                  14680000
146900     SET ASC-MORE-RECDIS         TO TRUE.                         14690000
147000                                                                  14700000
147100     MOVE ZERO                   TO ASC-ITEM-SUB                  14710000
147200                                    ASC-NUMBER-OF-ITEMS-READ      14720000
147300                                    ASC-NUMBER-OF-SELECTED-ITEMS  14730000
147400                                    ASC-HIGHEST-BLOCK-WRITTEN     14740000
147500                                    ASC-START-OF-SELECTED-RANGE   14750000
147600                                    ASC-END-OF-SELECTED-RANGE     14760000
147700                                    ASC-ITEM-AT-TOP-OF-PANEL.     14770000
147800*BJ                                                               14780000
147900     MOVE ZERO                   TO PV-TOTAL-OTR.                 14790000
148000                                                                  14800000
148100     PERFORM 4010-FORMAT-KEYS.                                    14810000
148200                                                                  14820000
148300     PERFORM 4020-GET-VENDOR-NAME.                                14830000
148400     PERFORM 4100-SELECT-PURITM-DATA.                             14840000
148500     MOVE PURCHS-DEPT-NBR        TO  PV-SN-DEPT-NBR.              14850000
148600     MOVE PURITM-VEND-STYL-NAME  TO  ASC-VEND-STYL-NAME           14860000
148700*                                                                 14870000
148800*----------------------------------------------------------------*14880017
148900* ADDED THE LOGIC TO CHECK FOR THE DUMMY SKU                     *14890000
149000* IF NOT DUMMY SKU CALL THE LOGISTICS DOMAIN ITEM ACCESS         *14900000
149100*                           MODULE                               *14910000
149200*----------------------------------------------------------------*14920017
149300     INITIALIZE XL001-ITEM-COMMAREA                               14930019
149400     INITIALIZE PV-NIS-SKU-NBR                                    14940019
149500*                                                                 14950019
149600     IF (PURITM-SKU-SEQ-NBR NOT = PC-000  AND                     14960019
149700         PURITM-SKU-SEQ-NBR NOT = PC-999) AND                     14970016
149800         SQLCODE = ZERO                                           14980016
149900                                                                  14990016
150000         PERFORM 4105-CALL-LOG-ITEM-ACCESS                        15000026
150100         MOVE PV-NIS-SKU-NBR         TO PV-SN-SEQ-NBR             15010021
150200         MOVE XL001-SUB-CL-NBR-2CH   TO PV-SN-CL-NBR              15020026
150300         MOVE PV-SKU-NBR             TO ASC-SKU-NBR               15030026
150400     ELSE                                                         15040000
150500         IF PURITM-SKU-SEQ-NBR = PC-000                           15050000
150600            MOVE '00000000'      TO  PV-SN-SEQ-NBR                15060000
150700            MOVE XL001-SUB-CL-NBR-2CH   TO PV-SN-CL-NBR           15070026
150800            MOVE PV-SKU-NBR      TO  ASC-SKU-NBR                  15080017
150900         ELSE                                                     15090000
151000            IF PURITM-SKU-SEQ-NBR = PC-999                        15100000
151100               MOVE '99999999'   TO  PV-SN-SEQ-NBR                15110021
151200               MOVE XL001-SUB-CL-NBR-2CH TO PV-SN-CL-NBR          15120026
151300               MOVE PV-SKU-NBR   TO  ASC-SKU-NBR                  15130021
151400            END-IF                                                15140000
151500         END-IF                                                   15150000
151600     END-IF                                                       15160000
151700                                                                  15170000
151800     PERFORM 4030-OPEN-CURSOR.                                    15180000
151900     PERFORM 4040-GET-REC-DISTRO.                                 15190000
152000     PERFORM 4050-CLOSE-CURSOR.                                   15200000
152100                                                                  15210000
152200     PERFORM 4060-GET-LOCATION-DESC.                              15220025
152300     PERFORM 4070-GET-TRECEIV.                                    15230000
152400                                                                  15240000
152500     PERFORM 4110-SELECT-RECITM-DATA.                             15250000
152600                                                                  15260000
152700     PERFORM 4120-OPEN-PRIOR-RCVR-CURSOR.                         15270000
152800     PERFORM 4130-PROCESS-PRIOR-RCVR-DISTRO.                      15280000
152900     PERFORM 4150-CLOSE-PRIOR-RCVR-CURSOR.                        15290000
153000                                                                  15300000
153100     MOVE PV-DISTR-LNE-QTY       TO ASC-KEY-DISTR-LNE-QTY.        15310000
153200     MOVE PV-TOTAL-OTR           TO ASC-KEY-TOTAL-OTR.            15320000
153300                                                                  15330000
153400     MOVE +1                     TO PV-TOP-ITEM.                  15340000
153500                                                                  15350000
153600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15360000
153700                                                                  15370000
153800 4010-FORMAT-KEYS.                                                15380000
153900                                                                  15390000
154000     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    15400000
154100     MOVE ASC-KEY-PKSL-LNE-NBR   TO DK-PKSL-LNE-NBR.              15410000
154200     MOVE ASC-KEY-REC-SEQ-NBR-N  TO DK-REC-SEQ-NBR.               15420000
154300                                                                  15430000
154400 4020-GET-VENDOR-NAME.                                            15440000
154500                                                                  15450000
154600     PERFORM WITH TEST AFTER                                      15460000
154700         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    15470000
154800         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             15480000
154900                 SQLCODE = ZERO OR                                15490000
155000                 SQLCODE = +100                                   15500000
155100                                                                  15510000
155200         EXEC SQL                                                 15520000
155300              SELECT B.ENT_NAME_DESC                              15530000
155400                   , A.DEPT_NBR                                   15540000
155500                   , A.STATUS_CDE                                 15550000
155600                INTO :ENTNME-ENT-NAME-DESC                        15560000
155700                   , :PURCHS-DEPT-NBR                             15570000
155800                   , :ASC-PURCHS-STATUS-CDE                       15580000
155900                FROM TPURCHS A,                                   15590000
156000                     TENTNME B                                    15600000
156100               WHERE A.VER_STATUS_CDE = :PC-ACTIVE                15610000
156200                 AND A.PO_NBR         = :DK-PO-NBR                15620000
156300                 AND A.ENT_ID         = B.ENT_ID                  15630000
156400                 AND B.TYPE_CDE       = :PC-01                    15640000
156500         END-EXEC                                                 15650000
156600                                                                  15660000
156700         EVALUATE TRUE                                            15670000
156800             WHEN SQLCODE = ZERO                                  15680000
156900             WHEN SQLCODE = +100                                  15690000
157000             WHEN SQLCODE = -904                                  15700000
157100             WHEN SQLCODE = -913                                  15710000
157200                  CONTINUE                                        15720000
157300                                                                  15730000
157400             WHEN SQLWARN0 NOT = SPACES                           15740000
157500             WHEN SQLCODE  NOT = ZERO                             15750000
157600                  MOVE '4020-GET-VENDOR-NAME'                     15760000
157700                                 TO DP013-PARAGRAPH               15770000
157800                  MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'       15780000
157900                                 TO DP013-MESSAGE-TEXT (1)        15790000
158000                  MOVE SQLCA     TO DP013-SQLCA                   15800000
158100                  MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)      15810000
158200                  SET DP013-DB2-ABEND                             15820000
158300                      DP013-XCTL-DISPLAY-RESTART                  15830000
158400                                 TO TRUE                          15840000
158500                                                                  15850000
158600                  PERFORM DP013-0000-PROCESS-ABEND                15860000
158700         END-EVALUATE                                             15870000
158800     END-PERFORM.                                                 15880000
158900                                                                  15890000
159000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         15900000
159100         MOVE '4020-GET-VENDOR-NAME'                              15910000
159200                                 TO DP013-PARAGRAPH               15920000
159300         MOVE 'MAX RETRIES EXCEEDED ON SELECT VENDOR NAME'        15930000
159400                                 TO DP013-MESSAGE-TEXT (1)        15940000
159500         MOVE SQLCA              TO DP013-SQLCA                   15950000
159600         MOVE 'TENTNME '         TO DP013-DB2-TABLE-NAME (1)      15960000
159700         SET DP013-XCTL-DISPLAY-RESTART                           15970000
159800             DP013-DB2-ABEND     TO TRUE                          15980000
159900                                                                  15990000
160000         PERFORM DP013-0000-PROCESS-ABEND                         16000000
160100     END-IF.                                                      16010000
160200                                                                  16020000
160300     IF SQLCODE = ZERO                                            16030000
160400         MOVE ENTNME-ENT-NAME-DESC                                16040000
160500                                 TO ASC-KEY-VENDOR-NAME           16050000
160600     ELSE                                                         16060000
160700         IF SQLCODE = +100                                        16070000
160800             MOVE 'VENDOR NOT FOUND'                              16080000
160900                                 TO ASC-KEY-VENDOR-NAME           16090000
161000         END-IF                                                   16100000
161100     END-IF.                                                      16110000
161200                                                                  16120000
161300 4030-OPEN-CURSOR.                                                16130000
161400                                                                  16140000
161500     PERFORM WITH TEST AFTER                                      16150000
161600         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    16160000
161700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             16170000
161800                 SQLCODE = ZERO                                   16180000
161900                                                                  16190000
162000         EXEC SQL                                                 16200000
162100              OPEN RECDIS-CURSOR                                  16210000
162200         END-EXEC                                                 16220000
162300                                                                  16230000
162400         EVALUATE TRUE                                            16240000
162500             WHEN SQLCODE = ZERO                                  16250000
162600             WHEN SQLCODE = -904                                  16260000
162700             WHEN SQLCODE = -913                                  16270000
162800                  CONTINUE                                        16280000
162900                                                                  16290000
163000             WHEN SQLWARN0 NOT = SPACES                           16300000
163100             WHEN SQLCODE  NOT = ZERO                             16310000
163200                  MOVE '4030-OPEN-CURSOR'                         16320000
163300                                 TO DP013-PARAGRAPH               16330000
163400                  MOVE 'UNSUCCESSFUL RECDIS CURSOR OPEN'          16340000
163500                                 TO DP013-MESSAGE-TEXT (1)        16350000
163600                  MOVE SQLCA     TO DP013-SQLCA                   16360000
163700                  MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)      16370000
163800                  SET DP013-XCTL-DISPLAY-RESTART                  16380000
163900                      DP013-DB2-ABEND                             16390000
164000                                 TO TRUE                          16400000
164100                                                                  16410000
164200                  PERFORM DP013-0000-PROCESS-ABEND                16420000
164300         END-EVALUATE                                             16430000
164400     END-PERFORM.                                                 16440000
164500                                                                  16450000
164600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         16460000
164700         MOVE '4030-OPEN-CURSOR' TO DP013-PARAGRAPH               16470000
164800         MOVE 'MAX RETRIES EXCEEDED ON RECDIS CURSOR OPEN'        16480000
164900                                 TO DP013-MESSAGE-TEXT (1)        16490000
165000         MOVE SQLCA              TO DP013-SQLCA                   16500000
165100         MOVE 'TRECDIS '         TO DP013-DB2-TABLE-NAME (1)      16510000
165200         SET DP013-XCTL-DISPLAY-RESTART                           16520000
165300             DP013-DB2-ABEND     TO TRUE                          16530000
165400                                                                  16540000
165500         PERFORM DP013-0000-PROCESS-ABEND                         16550000
165600     END-IF.                                                      16560000
165700                                                                  16570000
165800 4040-GET-REC-DISTRO.                                             16580000
165900                                                                  16590000
166000     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   16600000
166100         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    16610000
166200               ASC-NO-MORE-RECDIS                                 16620000
166300                                                                  16630000
166400         PERFORM 4042-FETCH-RECDIS                                16640000
166500                                                                  16650000
166600         IF ASC-MORE-RECDIS                                       16660000
166700             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 16670000
166800                 ADD +1          TO ASC-ITEM-SUB                  16680000
166900             ELSE                                                 16690000
167000                 ADD +1          TO ASC-BLK-SUB                   16700000
167100                 MOVE +1         TO ASC-ITEM-SUB                  16710000
167200                                                                  16720000
167300                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          16730000
167400                     MOVE +1     TO ASC-BLK-SUB                   16740000
167500                     SET ASC-BLOCK-MODIFIED (1)                   16750000
167600                                 TO TRUE                          16760000
167700                                                                  16770000
167800                     PERFORM 5100-WRITE-TEMP-STORAGE              16780000
167900                                                                  16790000
168000                     MOVE ASC-BLOCK-ENTRIES                       16800000
168100                                          (PC-MAX-BLOCKS-IN-ARRAY)16810000
168200                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)16820000
168300                     ADD +1      TO ASC-BLK-SUB                   16830000
168400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   16840000
168500                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     16850000
168600                                 TO TRUE                          16860000
168700                 END-IF                                           16870000
168800             END-IF                                               16880000
168900             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      16890000
169000             MOVE ASC-NUMBER-OF-ITEMS-READ                        16900000
169100                                 TO ASC-LIST-ITEM-NUMBER          16910000
169200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16920000
169300             MOVE RECDIS-STR-NBR TO ASC-STR-NBR-N                 16930000
169400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16940000
169500                                   DK-STR-NBR                     16950000
169600             MOVE RECDIS-EXPTED-ITM-QTY                           16960000
169700                                 TO ASC-EXPTED-ITM-QTY-N          16970000
169800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     16980000
169900                                    ASC-STR-QTY-PREV              16990000
170000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17000000
170100                                                                  17010000
170200             MOVE RECDIS-AP-VERIFY-ITM-QTY                        17020000
170300                                 TO ASC-VERFD-QTY-N               17030000
170400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17040000
170500             PERFORM 4200-CALC-OPEN-TO-REC                        17050000
170600             IF PV-OPEN-TO-REC > ZERO                             17060000
170700                 MOVE PV-OPEN-TO-REC TO ASC-OPEN-TO-REC-N         17070000
170800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17080000
170900                 ADD PV-OPEN-TO-REC TO PV-TOTAL-OTR               17090000
171000             ELSE                                                 17100000
171100                 MOVE ZERO           TO ASC-OPEN-TO-REC-N         17110000
171200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17120000
171300             END-IF                                               17130000
171400             PERFORM 4260-GET-ORDER-QTY                           17140000
171500             MOVE MESTDS-STR-DISTRO-QTY                           17150000
171600                                 TO ASC-UNT-QTY-N                 17160000
171700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17170000
171800             PERFORM 4250-SUM-STR-TOTAL-RECEIVED                  17180000
171900             MOVE PV-TOTAL-RCVD  TO ASC-TOT-REC-N                 17190000
172000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17200000
172100             IF RECDIS-VERIFY-ITM-QTY > 0                         17210000
172200                 COMPUTE PV-DISTR-LNE-QTY =                       17220000
172300                     PV-DISTR-LNE-QTY + RECDIS-VERIFY-ITM-QTY     17230000
172400             ELSE                                                 17240000
172500                 COMPUTE PV-DISTR-LNE-QTY =                       17250000
172600                     PV-DISTR-LNE-QTY + RECDIS-EXPTED-ITM-QTY     17260000
172700             END-IF                                               17270000
172800         END-IF                                                   17280000
172900     END-PERFORM.                                                 17290000
173000                                                                  17300000
173100     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           17310000
173200         MOVE +1                 TO ASC-BLK-SUB                   17320000
173300                                                                  17330000
173400         PERFORM 5100-WRITE-TEMP-STORAGE                          17340000
173500                                                                  17350000
173600         ADD +1                  TO ASC-BLK-SUB                   17360000
173700                                                                  17370000
173800         PERFORM 5100-WRITE-TEMP-STORAGE                          17380000
173900                                                                  17390000
174000         MOVE +1                 TO ASC-BLK-SUB                   17400000
174100                                    PV-BLOCK-NUMBER               17410000
174200                                                                  17420000
174300         PERFORM 4410-READ-TEMP-STORAGE                           17430000
174400                                                                  17440000
174500         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         17450000
174600             MOVE +2             TO ASC-BLK-SUB                   17460000
174700                                    PV-BLOCK-NUMBER               17470000
174800                                                                  17480000
174900             PERFORM 4410-READ-TEMP-STORAGE                       17490000
175000         END-IF                                                   17500000
175100     END-IF.                                                      17510000
175200                                                                  17520000
175300 4042-FETCH-RECDIS.                                               17530000
175400                                                                  17540000
175500     EXEC SQL                                                     17550000
175600          FETCH  RECDIS-CURSOR                                    17560000
175700           INTO :RECDIS-EXPTED-ITM-QTY,                           17570000
175800                :RECDIS-VERIFY-ITM-QTY,                           17580000
175900                :RECDIS-AP-VERIFY-ITM-QTY,                        17590000
176000                :RECDIS-STR-NBR                                   17600000
176100     END-EXEC.                                                    17610000
176200                                                                  17620000
176300     EVALUATE TRUE                                                17630000
176400         WHEN SQLCODE = ZERO                                      17640000
176500         WHEN SQLCODE = +100                                      17650000
176600              CONTINUE                                            17660000
176700                                                                  17670000
176800         WHEN SQLWARN0 NOT = SPACES                               17680000
176900         WHEN SQLCODE  NOT = ZERO                                 17690000
177000              MOVE '4042-FETCH-RECDIS'                            17700000
177100                                 TO DP013-PARAGRAPH               17710000
177200              MOVE 'UNSUCCESSFUL FETCH OF RECDIS CURSOR'          17720000
177300                                 TO DP013-MESSAGE-TEXT (1)        17730000
177400              MOVE SQLCA         TO DP013-SQLCA                   17740000
177500              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (1)      17750000
177600              SET DP013-DB2-ABEND                                 17760000
177700                  DP013-XCTL-DISPLAY-RESTART                      17770000
177800                                 TO TRUE                          17780000
177900                                                                  17790000
178000              PERFORM DP013-0000-PROCESS-ABEND                    17800000
178100     END-EVALUATE.                                                17810000
178200                                                                  17820000
178300     IF SQLCODE = +100                                            17830000
178400         SET ASC-NO-MORE-RECDIS  TO TRUE                          17840000
178500     END-IF.                                                      17850000
178600                                                                  17860000
178700 4050-CLOSE-CURSOR.                                               17870000
178800                                                                  17880000
178900     EXEC SQL                                                     17890000
179000          CLOSE RECDIS-CURSOR                                     17900000
179100     END-EXEC.                                                    17910000
179200                                                                  17920000
179300     EVALUATE TRUE                                                17930000
179400         WHEN SQLCODE = ZERO                                      17940000
179500              CONTINUE                                            17950000
179600                                                                  17960000
179700         WHEN SQLWARN0 NOT = SPACES                               17970000
179800         WHEN SQLCODE  NOT = ZERO                                 17980000
179900              MOVE '4050-CLOSE-CURSOR'                            17990000
180000                                 TO DP013-PARAGRAPH               18000000
180100              MOVE 'UNSUCCESSFUL RECDIS CURSOR CLOSE'             18010000
180200                                 TO DP013-MESSAGE-TEXT (1)        18020000
180300              MOVE SQLCA         TO DP013-SQLCA                   18030000
180400              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (1)      18040000
180500              SET DP013-DB2-ABEND                                 18050000
180600                  DP013-XCTL-DISPLAY-RESTART                      18060000
180700                                 TO TRUE                          18070000
180800                                                                  18080000
180900              PERFORM DP013-0000-PROCESS-ABEND                    18090000
181000     END-EVALUATE.                                                18100000
181100                                                                  18110000
181200******************************************************************18120000
181300*  GET THE LOCATION DESCRIPTION FROM XLT_LOC VIA XLKUT071        *18130025
181400******************************************************************18140000
181500                                                                  18150000
181600 4060-GET-LOCATION-DESC.                                          18160025
181700                                                                  18170000
181800     INITIALIZE XL071-COMMAREA-REC.                               18180025
181900                                                                  18190025
182000     MOVE ASC-KEY-OPER-UNT-ID   TO PV-UNPACK-OPER-UNT-ID.         18200025
182100     MOVE PV-UNPACK-OPER-UNT-ID TO XL071-LOCATION-NUMBER.         18210025
182200                                                                  18220025
182300     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    18230025
182400                                      XL071-COMMAREA              18240025
182500                                      XL071-COMMAREA-REC.         18250025
182600                                                                  18260000
182700     EVALUATE TRUE                                                18270025
182800         WHEN XL071-NO-ERRORS                                     18280025
182900             MOVE XL071-LOC-NM TO ASC-KEY-FCLTY-DESC              18290025
183000         WHEN XL071-LOC-NOT-FOUND                                 18300025
183100         WHEN XL071-SQLCODE-N = -904                              18310027
183200         WHEN XL071-SQLCODE-N = -913                              18320027
183300             MOVE SPACES TO ASC-KEY-FCLTY-DESC                    18330025
183400         WHEN XL071-BAD-DB2-RETURN                                18340025
183500             MOVE '4060-GET-LOCATION-DESC' TO DP013-PARAGRAPH     18350025
183600             MOVE 'CALL TO XLKUT071' TO DP013-MESSAGE-TEXT (1)    18360025
183700             STRING 'LOCATION NBR: '    DELIMITED BY SIZE         18370025
183800                  XL071-LOCATION-NUMBER DELIMITED BY SIZE         18380025
183900                                   INTO DP013-MESSAGE-TEXT(2)     18390025
184000             MOVE XL071-SQLCA        TO DP013-SQLCA               18400025
184100             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  18410025
184200             SET DP013-DB2-ABEND                                  18420025
184300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18430025
184400             PERFORM DP013-0000-PROCESS-ABEND                     18440025
184500     END-EVALUATE.                                                18450025
184600/                                                                 18460000
184700 4070-GET-TRECEIV.                                                18470000
184800                                                                  18480000
184900     EXEC SQL                                                     18490000
185000          SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP            18500000
185100     END-EXEC.                                                    18510000
185200                                                                  18520000
185300     EXEC SQL                                                     18530000
185400          SELECT                                                  18540000
185500                  A.ML_POST_TMST                                  18550000
185600                , A.FS_POST_TMST                                  18560000
185700                , A.STATUS_CDE                                    18570000
185800                , B.STATUS_CDE                                    18580000
185900            INTO                                                  18590000
186000                  :RECEIV-ML-POST-TMST                            18600000
186100                , :RECEIV-FS-POST-TMST                            18610000
186200                , :RECEIV-STATUS-CDE                              18620000
186300                , :RECITM-STATUS-CDE                              18630000
186400            FROM                                                  18640000
186500                  TRECEIV A                                       18650000
186600                , TRECITM B                                       18660000
186700            WHERE                                                 18670000
186800                  A.ORD_NBR          = :DK-PO-NBR                 18680000
186900              AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            18690000
187000              AND A.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       18700000
187100              AND A.FCLTY_ID         = :ASC-KEY-FCLTY-ID          18710000
187200              AND A.VER_STATUS_CDE   = :PC-ACTIVE                 18720000
187300              AND                                                 18730000
187400                  B.ORD_NBR          = :DK-PO-NBR                 18740000
187500              AND B.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            18750000
187600              AND B.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       18760000
187700              AND B.FCLTY_ID         = :ASC-KEY-FCLTY-ID          18770000
187800              AND B.VER_STATUS_CDE   = :PC-ACTIVE                 18780000
187900              AND B.ORD_LNE_NBR      = :DK-PKSL-LNE-NBR           18790000
188000     END-EXEC.                                                    18800000
188100                                                                  18810000
188200     EVALUATE TRUE                                                18820000
188300         WHEN SQLCODE = ZERO                                      18830000
188400         WHEN SQLCODE = +100                                      18840000
188500              CONTINUE                                            18850000
188600                                                                  18860000
188700         WHEN SQLWARN0 NOT = SPACES                               18870000
188800         WHEN SQLCODE  NOT = ZERO                                 18880000
188900              MOVE '4070-GET-TRECEIV'                             18890000
189000                                 TO DP013-PARAGRAPH               18900000
189100              MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'               18910000
189200                                 TO DP013-MESSAGE-TEXT (1)        18920000
189300              MOVE SQLCA         TO DP013-SQLCA                   18930000
189400              MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)      18940000
189500              MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)      18950000
189600              SET DP013-DB2-ABEND                                 18960000
189700                  DP013-XCTL-DISPLAY-RESTART                      18970000
189800                                 TO TRUE                          18980000
189900                                                                  18990000
190000              PERFORM DP013-0000-PROCESS-ABEND                    19000000
190100     END-EVALUATE.                                                19010000
190200******************************************************************19020000
190300*    GET THE AD EVENT DATE TO DISPLAY IN THE HEADER AREA          19030000
190400******************************************************************19040000
190500                                                                  19050000
190600 4100-SELECT-PURITM-DATA.                                         19060000
190700                                                                  19070000
190800     PERFORM WITH TEST AFTER                                      19080000
190900         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    19090000
191000         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             19100000
191100                 SQLCODE = ZERO OR                                19110000
191200                 SQLCODE = +100                                   19120000
191300                                                                  19130000
191400         EXEC SQL                                                 19140000
191500               SELECT AD_EVNT_DTE                                 19150000
191600                    , PO_LNE_NBR                                  19160000
191700                    , SKU_SEQ_NBR                                 19170000
191800                    , VEND_STYL_NAME                              19180000
191900                    , STATUS_CDE                                  19190000
192000                    , UNT_QTY                                     19200000
192100                    , ITM_NBR                                     19210000
192200                 INTO :PURITM-AD-EVNT-DTE                         19220000
192300                    , :PURITM-PO-LNE-NBR                          19230000
192400                    , :PURITM-SKU-SEQ-NBR                         19240000
192500                    , :PURITM-VEND-STYL-NAME                      19250000
192600                    , :ASC-PURITM-STATUS-CDE                      19260000
192700                    , :ASC-PURITM-UNT-QTY                         19270000
192800                    , :PURITM-ITM-NBR                             19280000
192900                 FROM TPURITM                                     19290000
193000                WHERE PO_NBR         = :DK-PO-NBR                 19300000
193100                  AND APP_PO_LNE_NBR = :DK-PKSL-LNE-NBR           19310000
193200                  AND VER_STATUS_CDE = :PC-ACTIVE                 19320000
193300         END-EXEC                                                 19330000
193400                                                                  19340000
193500         EVALUATE TRUE                                            19350000
193600             WHEN SQLCODE = ZERO                                  19360000
193700                 MOVE PURITM-AD-EVNT-DTE                          19370000
193800                                 TO PV-DB2-DATE-FORMAT            19380000
193900                                    PV-CHECK-FOR-DEFAULT-DATE     19390000
194000                 IF PV-DEFAULT-DATE                               19400000
194100                     MOVE SPACES TO ASC-KEY-AD-EVNT-DTE           19410000
194200                 ELSE                                             19420000
194300                     MOVE PV-DB2-CCYY                             19430000
194400                                 TO PV-AD-DATE-CCYY               19440000
194500                     MOVE PV-DB2-MM                               19450000
194600                                 TO PV-AD-DATE-MM                 19460000
194700                     MOVE PV-DB2-DD                               19470000
194800                                 TO PV-AD-DATE-DD                 19480000
194900                     MOVE PV-AD-DATE-MM-DD-CCYY                   19490000
195000                                 TO ASC-KEY-AD-EVNT-DTE           19500000
195100                 END-IF                                           19510000
195200             WHEN SQLCODE = +100                                  19520000
195300             WHEN SQLCODE = -904                                  19530000
195400             WHEN SQLCODE = -913                                  19540000
195500                  CONTINUE                                        19550000
195600                                                                  19560000
195700             WHEN SQLWARN0 NOT = SPACES                           19570000
195800             WHEN SQLCODE  NOT = ZERO                             19580000
195900                  MOVE '4100-SELECT-PURITM-DATA'                  19590000
196000                                 TO DP013-PARAGRAPH               19600000
196100                  MOVE 'UNSUCCESSFUL SELECT OF PURITM'            19610000
196200                                 TO DP013-MESSAGE-TEXT (1)        19620000
196300                  MOVE SQLCA     TO DP013-SQLCA                   19630000
196400                  MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)      19640000
196500                  SET DP013-DB2-ABEND                             19650000
196600                      DP013-XCTL-DISPLAY-RESTART                  19660000
196700                                 TO TRUE                          19670000
196800                                                                  19680000
196900                  PERFORM DP013-0000-PROCESS-ABEND                19690000
197000         END-EVALUATE                                             19700000
197100     END-PERFORM.                                                 19710000
197200                                                                  19720000
197300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         19730000
197400         MOVE '4100-SELECT-PURITM-DATA'                           19740000
197500                                 TO DP013-PARAGRAPH               19750000
197600         MOVE 'MAX RETRIES EXCEEDED ON SELECT OF PURITM'          19760000
197700                                 TO DP013-MESSAGE-TEXT (1)        19770000
197800         MOVE SQLCA              TO DP013-SQLCA                   19780000
197900         MOVE 'TPURITM '         TO DP013-DB2-TABLE-NAME (1)      19790000
198000         SET DP013-XCTL-DISPLAY-RESTART                           19800000
198100             DP013-DB2-ABEND     TO TRUE                          19810000
198200                                                                  19820000
198300         PERFORM DP013-0000-PROCESS-ABEND                         19830000
198400     END-IF.                                                      19840000
198500*                                                                 19850000
198600*----------------------------------------------------------------*19860017
198700* CALL TO LOGISTICS DOMAIN ITEM ACCESS MODULE                    *19870000
198800*----------------------------------------------------------------*19880017
198900*                                                                 19890000
199000 4105-CALL-LOG-ITEM-ACCESS.                                       19900026
199100******************************************************            19910000
199200******************************************************            19920000
199300                                                                  19930000
199400        MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.               19940000
199500                                                                  19950000
199600        SET  XL001-BY-ITEM                                        19960000
199700             XL001-SELECT-VND-STYL                                19970026
199800             XL001-SELECT-SKU TO TRUE.                            19980026
199900                                                                  19990026
200000        CALL XL001-VSM-PGM USING  DFHEIBLK                        20000026
200100                                  XL001-COMMAREA                  20010026
200200                                  XL001-ITEM-COMMAREA.            20020026
200300                                                                  20030026
200400        EVALUATE TRUE                                             20040026
200500                                                                  20050026
200600            WHEN XL001-SUCCESSFUL                                 20060026
200700                 MOVE XL001-SKU-NBR   TO PV-NIS-SKU-NBR           20070026
200800                                                                  20080000
200900            WHEN XL001-SKU-SQLCODE = +100                         20090000
201000            WHEN XL001-SKU-SQLCODE = -904                         20100000
201100            WHEN XL001-SKU-SQLCODE = -913                         20110000
201200                 CONTINUE                                         20120000
201300                                                                  20130000
201400            WHEN XL001-INVALID-ACCESS                             20140020
201500                 MOVE '4105-CALL-CICS-API-ARCH'                   20150000
201600                                    TO DP013-PARAGRAPH            20160000
201700                 MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'        20170020
201800                                    TO DP013-MESSAGE-TEXT (1)     20180000
201900                 MOVE SQLCA         TO DP013-SQLCA                20190000
202000                 MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)   20200020
202100                 SET DP013-DB2-ABEND                              20210000
202200                     DP013-XCTL-DISPLAY-RESTART                   20220000
202300                                    TO TRUE                       20230000
202400                                                                  20240000
202500                 PERFORM DP013-0000-PROCESS-ABEND                 20250000
202600                                                                  20260020
202700            WHEN OTHER                                            20270020
202800                 MOVE '4105-CALL-CICS-API-ARCH'                   20280020
202900                                    TO DP013-PARAGRAPH            20290020
203000                 MOVE 'UNSUCCESSFUL SELECT ON SKU'                20300020
203100                                    TO DP013-MESSAGE-TEXT (1)     20310020
203200                 MOVE XL001-SKU-SQLCODE                           20320022
203300                                    TO SQLCODE                    20330022
203400                 MOVE SQLCA         TO DP013-SQLCA                20340020
203500                 MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)   20350020
203600                 SET DP013-DB2-ABEND                              20360020
203700                     DP013-XCTL-DISPLAY-RESTART                   20370020
203800                                    TO TRUE                       20380020
203900                                                                  20390020
204000                 PERFORM DP013-0000-PROCESS-ABEND                 20400020
204100            END-EVALUATE.                                         20410020
204200                                                                  20420020
204300******************************************************************20430020
204400*    SELECT RECEIVER ITEM DATA TO DISPLAY IN THE HEADER AREA      20440000
204500******************************************************************20450000
204600                                                                  20460000
204700 4110-SELECT-RECITM-DATA.                                         20470000
204800                                                                  20480000
204900     INITIALIZE DCLTRECITM.                                       20490000
205000                                                                  20500000
205100     PERFORM WITH TEST AFTER                                      20510000
205200         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    20520000
205300         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             20530000
205400                 SQLCODE = ZERO OR                                20540000
205500                 SQLCODE = +100                                   20550000
205600                                                                  20560000
205700         EXEC SQL                                                 20570000
205800               SELECT INNR_PACK_QTY,                              20580000
205900                      CASE_PACK_QTY,                              20590000
206000                      PKSL_ITM_QTY,                               20600000
206100                      DTL_CK_ITM_QTY                              20610000
206200                 INTO :RECITM-INNR-PACK-QTY,                      20620000
206300                      :RECITM-CASE-PACK-QTY,                      20630000
206400                      :RECITM-PKSL-ITM-QTY,                       20640000
206500                      :RECITM-DTL-CK-ITM-QTY                      20650000
206600                 FROM TRECITM                                     20660000
206700                WHERE ORD_NBR        = :DK-PO-NBR                 20670000
206800                  AND ORD_LNE_NBR    = :DK-PKSL-LNE-NBR           20680000
206900                  AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR            20690000
207000                  AND OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID       20700000
207100                  AND FCLTY_ID       = :ASC-KEY-FCLTY-ID          20710000
207200                  AND VER_STATUS_CDE = :PC-ACTIVE                 20720000
207300         END-EXEC                                                 20730000
207400                                                                  20740000
207500         EVALUATE TRUE                                            20750000
207600             WHEN SQLCODE = ZERO                                  20760000
207700             WHEN SQLCODE = +100                                  20770000
207800             WHEN SQLCODE = -904                                  20780000
207900             WHEN SQLCODE = -913                                  20790000
208000                  CONTINUE                                        20800000
208100                                                                  20810000
208200             WHEN SQLWARN0 NOT = SPACES                           20820000
208300             WHEN SQLCODE  NOT = ZERO                             20830000
208400                  MOVE '4110-SELECT-RECITM-DATA'                  20840000
208500                                 TO DP013-PARAGRAPH               20850000
208600                  MOVE 'UNSUCCESSFUL SELECT OF RECITM HEADER DATA'20860000
208700                                 TO DP013-MESSAGE-TEXT (1)        20870000
208800                  MOVE SQLCA     TO DP013-SQLCA                   20880000
208900                  MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)      20890000
209000                  SET DP013-DB2-ABEND                             20900000
209100                      DP013-XCTL-DISPLAY-RESTART                  20910000
209200                                 TO TRUE                          20920000
209300                                                                  20930000
209400                  PERFORM DP013-0000-PROCESS-ABEND                20940000
209500         END-EVALUATE                                             20950000
209600     END-PERFORM.                                                 20960000
209700                                                                  20970000
209800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         20980000
209900         MOVE '4110-SELECT-RECITM-DATA'                           20990000
210000                                 TO DP013-PARAGRAPH               21000000
210100         MOVE 'MAX RETRIES EXCEEDED ON SELECT OF RECEIVER ITEMS'  21010000
210200                                 TO DP013-MESSAGE-TEXT (1)        21020000
210300         MOVE SQLCA              TO DP013-SQLCA                   21030000
210400         MOVE 'TRECITM '         TO DP013-DB2-TABLE-NAME (1)      21040000
210500         SET DP013-XCTL-DISPLAY-RESTART                           21050000
210600             DP013-DB2-ABEND     TO TRUE                          21060000
210700                                                                  21070000
210800         PERFORM DP013-0000-PROCESS-ABEND                         21080000
210900     END-IF.                                                      21090000
211000                                                                  21100000
211100     MOVE RECITM-INNR-PACK-QTY   TO ASC-KEY-INNR-PACK-QTY.        21110000
211200     MOVE RECITM-CASE-PACK-QTY   TO ASC-KEY-CASE-PACK-QTY.        21120000
211300                                                                  21130000
211400     IF RECITM-DTL-CK-ITM-QTY > 0                                 21140000
211500         MOVE RECITM-DTL-CK-ITM-QTY                               21150000
211600                                 TO ASC-KEY-REC-LNE-QTY           21160000
211700     ELSE                                                         21170000
211800         MOVE RECITM-PKSL-ITM-QTY                                 21180000
211900                                 TO ASC-KEY-REC-LNE-QTY           21190000
212000     END-IF.                                                      21200000
212100                                                                  21210000
212200 4120-OPEN-PRIOR-RCVR-CURSOR.                                     21220000
212300                                                                  21230000
212400     PERFORM WITH TEST AFTER                                      21240000
212500         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    21250000
212600         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             21260000
212700                 SQLCODE = ZERO                                   21270000
212800                                                                  21280000
212900         EXEC SQL                                                 21290000
213000              OPEN PRIOR-RCVR-CURSOR                              21300000
213100         END-EXEC                                                 21310000
213200                                                                  21320000
213300         EVALUATE TRUE                                            21330000
213400             WHEN SQLCODE = ZERO                                  21340000
213500             WHEN SQLCODE = -904                                  21350000
213600             WHEN SQLCODE = -913                                  21360000
213700                  CONTINUE                                        21370000
213800                                                                  21380000
213900             WHEN SQLWARN0 NOT = SPACES                           21390000
214000             WHEN SQLCODE  NOT = ZERO                             21400000
214100                  MOVE '4120-OPEN-PRIOR-RCVR-CURSOR'              21410000
214200                                 TO DP013-PARAGRAPH               21420000
214300                  MOVE 'UNSUCCESSFUL PRIOR RCVR CURSOR OPEN'      21430000
214400                                 TO DP013-MESSAGE-TEXT (1)        21440000
214500                  MOVE SQLCA     TO DP013-SQLCA                   21450000
214600                  MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)      21460000
214700                  MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (2)      21470000
214800                  SET DP013-XCTL-DISPLAY-RESTART                  21480000
214900                      DP013-DB2-ABEND                             21490000
215000                                 TO TRUE                          21500000
215100                                                                  21510000
215200                  PERFORM DP013-0000-PROCESS-ABEND                21520000
215300         END-EVALUATE                                             21530000
215400     END-PERFORM.                                                 21540000
215500                                                                  21550000
215600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         21560000
215700         MOVE '4120-OPEN-PRIOR-RCVR-CURSOR'                       21570000
215800                                 TO DP013-PARAGRAPH               21580000
215900         MOVE 'MAX RETRIES EXCEEDED ON PRIOR RCVR CURSOR OPEN'    21590000
216000                                 TO DP013-MESSAGE-TEXT (1)        21600000
216100         MOVE SQLCA              TO DP013-SQLCA                   21610000
216200         MOVE 'TRECEIV '         TO DP013-DB2-TABLE-NAME (1)      21620000
216300         MOVE 'TRECDIS '         TO DP013-DB2-TABLE-NAME (2)      21630000
216400         SET DP013-XCTL-DISPLAY-RESTART                           21640000
216500             DP013-DB2-ABEND     TO TRUE                          21650000
216600                                                                  21660000
216700         PERFORM DP013-0000-PROCESS-ABEND                         21670000
216800     END-IF.                                                      21680000
216900                                                                  21690000
217000 4130-PROCESS-PRIOR-RCVR-DISTRO.                                  21700000
217100                                                                  21710000
217200     PERFORM 4140-FETCH-PRIOR-RCVR.                               21720000
217300                                                                  21730000
217400     IF SQLCODE = +0                                              21740000
217500         MOVE RECEIV-STATUS-CDE  TO ASC-STATUS                    21750000
217600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21760000
217700         IF RECDIS-VERIFY-ITM-QTY > ZERO                          21770000
217800             MOVE RECDIS-AP-VERIFY-ITM-QTY                        21780000
217900                                 TO ASC-LAST-QTY-REC-N            21790000
218000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21800000
218100         ELSE                                                     21810000
218200             MOVE RECDIS-EXPTED-ITM-QTY                           21820000
218300                                 TO ASC-LAST-QTY-REC-N            21830000
218400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21840000
218500         END-IF                                                   21850000
218600         MOVE PV-DB2-DATE-FORMAT TO PV-DB2-DATE-FORMAT-REDE       21860000
218700         MOVE PV-DB2-MM          TO PV-SCREEN-DATE-MM             21870000
218800         MOVE PV-DB2-DD          TO PV-SCREEN-DATE-DD             21880000
218900         MOVE PV-DB2-YY          TO PV-SCREEN-DATE-YY             21890000
219000         MOVE PV-SCREEN-DATE-FORMAT                               21900000
219100                                 TO ASC-LAST-DTE-REC              21910000
219200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21920000
219300         PERFORM 4140-FETCH-PRIOR-RCVR                            21930000
219400         IF SQLCODE = +0                                          21940000
219500             IF RECDIS-VERIFY-ITM-QTY > ZERO                      21950000
219600                 MOVE RECDIS-AP-VERIFY-ITM-QTY                    21960000
219700                                 TO ASC-PRIOR-QTY-REC-N           21970000
219800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21980000
219900             ELSE                                                 21990000
220000                 MOVE RECDIS-EXPTED-ITM-QTY                       22000000
220100                                 TO ASC-PRIOR-QTY-REC-N           22010000
220200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22020000
220300             END-IF                                               22030000
220400             MOVE PV-DB2-DATE-FORMAT                              22040000
220500                                 TO PV-DB2-DATE-FORMAT-REDE       22050000
220600             MOVE PV-DB2-MM      TO PV-SCREEN-DATE-MM             22060000
220700             MOVE PV-DB2-DD      TO PV-SCREEN-DATE-DD             22070000
220800             MOVE PV-DB2-YY      TO PV-SCREEN-DATE-YY             22080000
220900             MOVE PV-SCREEN-DATE-FORMAT                           22090000
221000                                 TO ASC-PRIOR-DTE-REC             22100000
221100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22110000
221200         END-IF                                                   22120000
221300     END-IF.                                                      22130000
221400                                                                  22140000
221500 4140-FETCH-PRIOR-RCVR.                                           22150000
221600                                                                  22160000
221700     EXEC SQL                                                     22170000
221800          FETCH  PRIOR-RCVR-CURSOR                                22180000
221900           INTO :PV-DB2-DATE-FORMAT,                              22190000
222000                :RECEIV-STATUS-CDE,                               22200000
222100                :RECEIV-REC-SEQ-NBR,                              22210000
222200                :RECDIS-EXPTED-ITM-QTY,                           22220000
222300                :RECDIS-VERIFY-ITM-QTY,                           22230000
222400                :RECDIS-AP-VERIFY-ITM-QTY                         22240000
222500     END-EXEC.                                                    22250000
222600                                                                  22260000
222700     EVALUATE TRUE                                                22270000
222800         WHEN SQLCODE = ZERO                                      22280000
222900         WHEN SQLCODE = +100                                      22290000
223000              CONTINUE                                            22300000
223100                                                                  22310000
223200         WHEN SQLWARN0 NOT = SPACES                               22320000
223300         WHEN SQLCODE  NOT = ZERO                                 22330000
223400              MOVE '4140-FETCH-PRIOR-RCVR'                        22340000
223500                                 TO DP013-PARAGRAPH               22350000
223600              MOVE 'UNSUCCESSFUL FETCH OF PRIOR RCVR CURSOR'      22360000
223700                                 TO DP013-MESSAGE-TEXT (1)        22370000
223800              MOVE SQLCA         TO DP013-SQLCA                   22380000
223900              MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)      22390000
224000              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (2)      22400000
224100              SET DP013-DB2-ABEND                                 22410000
224200                  DP013-XCTL-DISPLAY-RESTART                      22420000
224300                                 TO TRUE                          22430000
224400                                                                  22440000
224500              PERFORM DP013-0000-PROCESS-ABEND                    22450000
224600     END-EVALUATE.                                                22460000
224700                                                                  22470000
224800 4150-CLOSE-PRIOR-RCVR-CURSOR.                                    22480000
224900                                                                  22490000
225000     EXEC SQL                                                     22500000
225100          CLOSE PRIOR-RCVR-CURSOR                                 22510000
225200     END-EXEC.                                                    22520000
225300                                                                  22530000
225400     EVALUATE TRUE                                                22540000
225500         WHEN SQLCODE = ZERO                                      22550000
225600              CONTINUE                                            22560000
225700                                                                  22570000
225800         WHEN SQLWARN0 NOT = SPACES                               22580000
225900         WHEN SQLCODE  NOT = ZERO                                 22590000
226000              MOVE '4150-CLOSE-PRIOR-RCVR-CURSOR'                 22600000
226100                                 TO DP013-PARAGRAPH               22610000
226200              MOVE 'UNSUCCESSFUL PRIOR RCVR CURSOR CLOSE'         22620000
226300                                 TO DP013-MESSAGE-TEXT (1)        22630000
226400              MOVE SQLCA         TO DP013-SQLCA                   22640000
226500              MOVE 'TRECEIV '    TO DP013-DB2-TABLE-NAME (1)      22650000
226600              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (2)      22660000
226700              SET DP013-DB2-ABEND                                 22670000
226800                  DP013-XCTL-DISPLAY-RESTART                      22680000
226900                                 TO TRUE                          22690000
227000                                                                  22700000
227100              PERFORM DP013-0000-PROCESS-ABEND                    22710000
227200     END-EVALUATE.                                                22720000
227300                                                                  22730000
227400******************************************************************22740000
227500*  COMPUTES THE OPEN TO RECEIVE AMOUNT FOR THE GIVEN STORE.       22750000
227600******************************************************************22760000
227700                                                                  22770000
227800 4200-CALC-OPEN-TO-REC.                                           22780000
227900                                                                  22790000
228000     MOVE ASC-KEY-PKSL-LNE-NBR   TO DK-PKSL-LNE-NBR.              22800000
228100                                                                  22810000
228200     PERFORM 4210-CHECK-FOR-ALLOC-PLAN.                           22820000
228300                                                                  22830000
228400     IF PS-PLAN-FOUND                                             22840000
228500         PERFORM 4220-SUM-MERCH-DISTRO                            22850000
228600         PERFORM 4225-SUM-STR-MERCH-DISTRO                        22860000
228700         IF ALLPLN-CURR-SPLIT-QTY = PV-SUM-DISTRO-QTY             22870000
228800             PERFORM 4230-SUM-RECEIVED-UNITS                      22880000
228900             PERFORM 4240-SUM-INPROCESS-UNITS                     22890000
229000             COMPUTE PV-OPEN-TO-REC = PV-SUM-STR-DISTRO-QTY -     22900000
229100                 (PV-SUM-VERIFIED-QTY + PV-SUM-EXPTED-QTY)        22910000
229200         ELSE                                                     22920000
229300             MOVE PV-SUM-STR-DISTRO-QTY                           22930000
229400                                 TO PV-OPEN-TO-REC                22940000
229500         END-IF                                                   22950000
229600     ELSE                                                         22960000
229700         MOVE ZERO               TO PV-OPEN-TO-REC                22970000
229800     END-IF.                                                      22980000
229900                                                                  22990000
230000/                                                                 23000000
230100******************************************************************23010000
230200*    CHECK IF A PLAN EXISTS FOR THIS PO                          *23020000
230300******************************************************************23030000
230400                                                                  23040000
230500 4210-CHECK-FOR-ALLOC-PLAN.                                       23050000
230600                                                                  23060000
230700     PERFORM                                                      23070000
230800         WITH TEST AFTER                                          23080000
230900         VARYING PV-RETRY-COUNTER                                 23090000
231000         FROM 1 BY 1                                              23100000
231100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23110000
231200             OR (SQLCODE = +0)                                    23120000
231300             OR (SQLCODE = +100))                                 23130000
231400                                                                  23140000
231500         EXEC SQL                                                 23150000
231600              SELECT PLAN_NBR,                                    23160000
231700                     CURR_SPLIT_QTY                               23170000
231800                INTO :ALLPLN-PLAN-NBR,                            23180000
231900                     :ALLPLN-CURR-SPLIT-QTY                       23190000
232000                FROM TALLPLN                                      23200000
232100               WHERE PO_NBR       = :DK-PO-NBR                    23210000
232200                 AND PO_LNE_NBR   = :PURITM-PO-LNE-NBR            23220000
232300                 AND DEST_NBR     = :ASC-KEY-OPER-UNT-ID          23230000
232400                 AND STATUS_CDE   = :PC-AC                        23240000
232500         END-EXEC                                                 23250000
232600                                                                  23260000
232700         EVALUATE TRUE                                            23270000
232800             WHEN SQLCODE = +0                                    23280000
232900                  SET PS-PLAN-FOUND                               23290000
233000                                 TO TRUE                          23300000
233100             WHEN SQLCODE = +100                                  23310000
233200                  SET PS-PLAN-NOT-FOUND                           23320000
233300                                 TO TRUE                          23330000
233400             WHEN SQLCODE = -904                                  23340000
233500             WHEN SQLCODE = -913                                  23350000
233600                  CONTINUE                                        23360000
233700                                                                  23370000
233800             WHEN SQLWARN0 NOT = SPACES                           23380000
233900             WHEN SQLCODE < +0                                    23390000
234000             WHEN SQLCODE > +0                                    23400000
234100                  MOVE '4210-CHECK-FOR-ALLOC-PLAN'                23410000
234200                                 TO DP013-PARAGRAPH               23420000
234300                  MOVE 'UNSUCCESSFUL SELECT OF TALLPLN'           23430000
234400                                 TO DP013-MESSAGE-TEXT (1)        23440000
234500                  MOVE SQLCA     TO DP013-SQLCA                   23450000
234600                  MOVE 'TALLPLN' TO DP013-DB2-TABLE-NAME (1)      23460000
234700                  SET DP013-DB2-ABEND                             23470000
234800                      DP013-XCTL-DISPLAY-RESTART                  23480000
234900                                 TO TRUE                          23490000
235000                  PERFORM DP013-0000-PROCESS-ABEND                23500000
235100         END-EVALUATE                                             23510000
235200     END-PERFORM.                                                 23520000
235300                                                                  23530000
235400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23540000
235500         MOVE '4210-CHECK-FOR-ALLOC-PLAN'                         23550000
235600                                 TO DP013-PARAGRAPH               23560000
235700         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TALLPLN'        23570000
235800                                 TO DP013-MESSAGE-TEXT (1)        23580000
235900         MOVE SQLCA              TO DP013-SQLCA                   23590000
236000         MOVE 'TALLPLN '         TO DP013-DB2-TABLE-NAME (1)      23600000
236100         SET DP013-XCTL-DISPLAY-RESTART                           23610000
236200             DP013-DB2-ABEND     TO TRUE                          23620000
236300         PERFORM DP013-0000-PROCESS-ABEND                         23630000
236400     END-IF.                                                      23640000
236500                                                                  23650000
236600/                                                                 23660000
236700******************************************************************23670000
236800*    SUM ALL STORE DISTRIBUTION QUANTITIES                       *23680000
236900******************************************************************23690000
237000                                                                  23700000
237100 4220-SUM-MERCH-DISTRO.                                           23710000
237200                                                                  23720000
237300     MOVE ZERO                   TO PV-SUM-DISTRO-QTY.            23730000
237400                                                                  23740000
237500     PERFORM                                                      23750000
237600         WITH TEST AFTER                                          23760000
237700         VARYING PV-RETRY-COUNTER                                 23770000
237800         FROM 1 BY 1                                              23780000
237900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23790000
238000             OR (SQLCODE = +0)                                    23800000
238100             OR (SQLCODE = +100))                                 23810000
238200                                                                  23820000
238300         EXEC SQL                                                 23830000
238400             SELECT  SUM(STR_DISTRO_QTY)                          23840000
238500               INTO  :PV-SUM-DISTRO-QTY :PV-DISTRO-IND            23850000
238600               FROM  TMESTDS                                      23860000
238700              WHERE  PO_NBR      = :DK-PO-NBR                     23870000
238800                AND  PO_LNE_NBR  = :PURITM-PO-LNE-NBR             23880000
238900                AND  PLAN_NBR    = :ALLPLN-PLAN-NBR               23890000
239000         END-EXEC                                                 23900000
239100                                                                  23910000
239200         EVALUATE TRUE                                            23920000
239300                                                                  23930000
239400             WHEN SQLCODE = +0                                    23940000
239500             WHEN SQLCODE = +100                                  23950000
239600             WHEN SQLCODE = -904                                  23960000
239700             WHEN SQLCODE = -913                                  23970000
239800                  CONTINUE                                        23980000
239900                                                                  23990000
240000             WHEN SQLWARN0 NOT = SPACES                           24000000
240100             WHEN SQLCODE < +0                                    24010000
240200             WHEN SQLCODE > +0                                    24020000
240300                  MOVE '4220-SUM-MERCH-DISTRO'                    24030000
240400                                 TO DP013-PARAGRAPH               24040000
240500                  MOVE 'UNSUCCESSFUL SUM OF TMESTDS'              24050000
240600                                 TO DP013-MESSAGE-TEXT (1)        24060000
240700                  MOVE SQLCA     TO DP013-SQLCA                   24070000
240800                  MOVE 'TMESTDS' TO DP013-DB2-TABLE-NAME (1)      24080000
240900                  SET DP013-DB2-ABEND                             24090000
241000                      DP013-XCTL-DISPLAY-RESTART                  24100000
241100                                 TO TRUE                          24110000
241200                  PERFORM DP013-0000-PROCESS-ABEND                24120000
241300         END-EVALUATE                                             24130000
241400     END-PERFORM.                                                 24140000
241500                                                                  24150000
241600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24160000
241700         MOVE '4220-SUM-MERCH-DISTRO'                             24170000
241800                                 TO DP013-PARAGRAPH               24180000
241900         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TMESTDS'        24190000
242000                                 TO DP013-MESSAGE-TEXT (1)        24200000
242100         MOVE SQLCA              TO DP013-SQLCA                   24210000
242200         MOVE 'TMESTDS '         TO DP013-DB2-TABLE-NAME (1)      24220000
242300         SET DP013-XCTL-DISPLAY-RESTART                           24230000
242400             DP013-DB2-ABEND     TO TRUE                          24240000
242500         PERFORM DP013-0000-PROCESS-ABEND                         24250000
242600     END-IF.                                                      24260000
242700                                                                  24270000
242800/                                                                 24280000
242900******************************************************************24290000
243000*    SUM SPECIFIC STORE DISTRIBUTION QUANTITIES                  *24300000
243100******************************************************************24310000
243200                                                                  24320000
243300 4225-SUM-STR-MERCH-DISTRO.                                       24330000
243400                                                                  24340000
243500     MOVE ZERO                   TO PV-SUM-STR-DISTRO-QTY.        24350000
243600                                                                  24360000
243700     PERFORM                                                      24370000
243800         WITH TEST AFTER                                          24380000
243900         VARYING PV-RETRY-COUNTER                                 24390000
244000         FROM 1 BY 1                                              24400000
244100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24410000
244200             OR (SQLCODE = +0)                                    24420000
244300             OR (SQLCODE = +100))                                 24430000
244400                                                                  24440000
244500         EXEC SQL                                                 24450000
244600             SELECT  SUM(STR_DISTRO_QTY)                          24460000
244700               INTO  :PV-SUM-STR-DISTRO-QTY :PV-DISTRO-IND        24470000
244800               FROM  TMESTDS                                      24480000
244900              WHERE  PO_NBR      = :DK-PO-NBR                     24490000
245000                AND  PO_LNE_NBR  = :PURITM-PO-LNE-NBR             24500000
245100                AND  PLAN_NBR    = :ALLPLN-PLAN-NBR               24510000
245200                AND  STR_NBR     = :DK-STR-NBR                    24520000
245300         END-EXEC                                                 24530000
245400                                                                  24540000
245500         EVALUATE TRUE                                            24550000
245600                                                                  24560000
245700             WHEN SQLCODE = +0                                    24570000
245800             WHEN SQLCODE = +100                                  24580000
245900             WHEN SQLCODE = -904                                  24590000
246000             WHEN SQLCODE = -913                                  24600000
246100                  CONTINUE                                        24610000
246200                                                                  24620000
246300             WHEN SQLWARN0 NOT = SPACES                           24630000
246400             WHEN SQLCODE < +0                                    24640000
246500             WHEN SQLCODE > +0                                    24650000
246600                  MOVE '4225-SUM-STR-MERCH-DISTRO'                24660000
246700                                 TO DP013-PARAGRAPH               24670000
246800                  MOVE 'UNSUCCESSFUL SUM OF TMESTDS'              24680000
246900                                 TO DP013-MESSAGE-TEXT (1)        24690000
247000                  MOVE SQLCA     TO DP013-SQLCA                   24700000
247100                  MOVE 'TMESTDS' TO DP013-DB2-TABLE-NAME (1)      24710000
247200                  SET DP013-DB2-ABEND                             24720000
247300                      DP013-XCTL-DISPLAY-RESTART                  24730000
247400                                 TO TRUE                          24740000
247500                  PERFORM DP013-0000-PROCESS-ABEND                24750000
247600         END-EVALUATE                                             24760000
247700     END-PERFORM.                                                 24770000
247800                                                                  24780000
247900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24790000
248000         MOVE '4225-SUM-STR-MERCH-DISTRO'                         24800000
248100                                 TO DP013-PARAGRAPH               24810000
248200         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TMESTDS'        24820000
248300                                 TO DP013-MESSAGE-TEXT (1)        24830000
248400         MOVE SQLCA              TO DP013-SQLCA                   24840000
248500         MOVE 'TMESTDS '         TO DP013-DB2-TABLE-NAME (1)      24850000
248600         SET DP013-XCTL-DISPLAY-RESTART                           24860000
248700             DP013-DB2-ABEND     TO TRUE                          24870000
248800         PERFORM DP013-0000-PROCESS-ABEND                         24880000
248900     END-IF.                                                      24890000
249000                                                                  24900000
249100/                                                                 24910000
249200******************************************************************24920000
249300*    SUM ALL RECEIVED UNITS FOR THIS PO, LINE, STORE             *24930000
249400******************************************************************24940000
249500                                                                  24950000
249600 4230-SUM-RECEIVED-UNITS.                                         24960000
249700                                                                  24970000
249800     MOVE ZERO                   TO PV-SUM-VERIFIED-QTY.          24980000
249900                                                                  24990000
250000     PERFORM                                                      25000000
250100         WITH TEST AFTER                                          25010000
250200         VARYING PV-RETRY-COUNTER                                 25020000
250300         FROM 1 BY 1                                              25030000
250400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25040000
250500             OR (SQLCODE = +0)                                    25050000
250600             OR (SQLCODE = +100))                                 25060000
250700                                                                  25070000
250800         EXEC SQL                                                 25080000
250900             SELECT  SUM(AP_VERIFY_ITM_QTY)                       25090000
251000               INTO  :PV-SUM-VERIFIED-QTY :PV-VERIFIED-IND        25100000
251100               FROM  TRECDIS A,                                   25110000
251200                     TRECEIV B                                    25120000
251300              WHERE   A.ORD_NBR        = :DK-PO-NBR               25130000
251400                AND   A.ORD_NBR        = B.ORD_NBR                25140000
251500                AND   A.ORD_LNE_NBR    = :DK-PKSL-LNE-NBR         25150000
251600                AND   A.REC_SEQ_NBR   ^= :DK-REC-SEQ-NBR          25160000
251700                AND   A.REC_SEQ_NBR    = B.REC_SEQ_NBR            25170000
251800                AND   A.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID     25180000
251900                AND   A.FCLTY_ID       = :ASC-KEY-FCLTY-ID        25190000
252100                AND   B.VER_STATUS_CDE = :PC-ACTIVE               25210000
252200                AND   A.STR_NBR        = :DK-STR-NBR              25220000
252300                AND   B.STATUS_CDE     = :PC-VE                   25230000
252400         END-EXEC                                                 25240000
252500                                                                  25250000
252600         EVALUATE TRUE                                            25260000
252700             WHEN SQLCODE = +0                                    25270000
252800             WHEN SQLCODE = +100                                  25280000
252900             WHEN SQLCODE = -904                                  25290000
253000             WHEN SQLCODE = -913                                  25300000
253100                  CONTINUE                                        25310000
253200                                                                  25320000
253300             WHEN SQLWARN0 NOT = SPACES                           25330000
253400             WHEN SQLCODE < +0                                    25340000
253500             WHEN SQLCODE > +0                                    25350000
253600                  MOVE '4230-SUM-RECEIVED-UNITS'                  25360000
253700                                 TO DP013-PARAGRAPH               25370000
253800                  MOVE 'UNSUCCESSFUL SUM OF TRECDIS'              25380000
253900                                 TO DP013-MESSAGE-TEXT (1)        25390000
254000                  MOVE SQLCA     TO DP013-SQLCA                   25400000
254100                  MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)      25410000
254200                  SET DP013-DB2-ABEND                             25420000
254300                      DP013-XCTL-DISPLAY-RESTART                  25430000
254400                                 TO TRUE                          25440000
254500                  PERFORM DP013-0000-PROCESS-ABEND                25450000
254600         END-EVALUATE                                             25460000
254700     END-PERFORM.                                                 25470000
254800                                                                  25480000
254900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25490000
255000         MOVE '4230-SUM-RECEIVED-UNITS'                           25500000
255100                                 TO DP013-PARAGRAPH               25510000
255200         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TRECDIS'        25520000
255300                                 TO DP013-MESSAGE-TEXT (1)        25530000
255400         MOVE SQLCA              TO DP013-SQLCA                   25540000
255500         MOVE 'TRECDIS '         TO DP013-DB2-TABLE-NAME (1)      25550000
255600         SET DP013-XCTL-DISPLAY-RESTART                           25560000
255700             DP013-DB2-ABEND     TO TRUE                          25570000
255800         PERFORM DP013-0000-PROCESS-ABEND                         25580000
255900     END-IF.                                                      25590000
256000                                                                  25600000
256100/                                                                 25610000
256200******************************************************************25620000
256300*    SUM ALL INPROCESS UNITS FOR THIS PO, LINE, STORE            *25630000
256400******************************************************************25640000
256500                                                                  25650000
256600 4240-SUM-INPROCESS-UNITS.                                        25660000
256700                                                                  25670000
256800     MOVE ZERO                   TO PV-SUM-EXPTED-QTY.            25680000
256900                                                                  25690000
257000     PERFORM                                                      25700000
257100         WITH TEST AFTER                                          25710000
257200         VARYING PV-RETRY-COUNTER                                 25720000
257300         FROM 1 BY 1                                              25730000
257400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25740000
257500             OR (SQLCODE = +0)                                    25750000
257600             OR (SQLCODE = +100))                                 25760000
257700                                                                  25770000
257800         EXEC SQL                                                 25780000
257900             SELECT  SUM(A.EXPTED_ITM_QTY)                        25790000
258000               INTO  :PV-SUM-EXPTED-QTY :PV-EXPTED-IND            25800000
258100               FROM  TRECDIS A,                                   25810000
258200                     TRECEIV B                                    25820000
258300              WHERE   A.ORD_NBR        = :DK-PO-NBR               25830000
258400                AND   A.ORD_NBR        = B.ORD_NBR                25840000
258500                AND   A.ORD_LNE_NBR    = :DK-PKSL-LNE-NBR         25850000
258600                AND   A.REC_SEQ_NBR   ^= :DK-REC-SEQ-NBR          25860000
258700                AND   A.REC_SEQ_NBR    = B.REC_SEQ_NBR            25870000
258800                AND   A.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID     25880000
258900                AND   A.FCLTY_ID       = :ASC-KEY-FCLTY-ID        25890000
259100                AND   B.VER_STATUS_CDE = :PC-ACTIVE               25910000
259200                AND   A.STR_NBR        = :DK-STR-NBR              25920000
259300                AND   B.STATUS_CDE    IN (:PC-IP, :PC-CM)         25930000
259400         END-EXEC                                                 25940000
259500                                                                  25950000
259600         EVALUATE TRUE                                            25960000
259700             WHEN SQLCODE = +0                                    25970000
259800             WHEN SQLCODE = +100                                  25980000
259900             WHEN SQLCODE = -904                                  25990000
260000             WHEN SQLCODE = -913                                  26000000
260100                  CONTINUE                                        26010000
260200                                                                  26020000
260300             WHEN SQLWARN0 NOT = SPACES                           26030000
260400             WHEN SQLCODE < +0                                    26040000
260500             WHEN SQLCODE > +0                                    26050000
260600                  MOVE '4240-SUM-INPROCESS-UNITS'                 26060000
260700                                 TO DP013-PARAGRAPH               26070000
260800                  MOVE 'UNSUCCESSFUL SUM OF TRECDIS'              26080000
260900                                 TO DP013-MESSAGE-TEXT (1)        26090000
261000                  MOVE SQLCA     TO DP013-SQLCA                   26100000
261100                  MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)      26110000
261200                  SET DP013-DB2-ABEND                             26120000
261300                      DP013-XCTL-DISPLAY-RESTART                  26130000
261400                                 TO TRUE                          26140000
261500                  PERFORM DP013-0000-PROCESS-ABEND                26150000
261600         END-EVALUATE                                             26160000
261700     END-PERFORM.                                                 26170000
261800                                                                  26180000
261900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26190000
262000         MOVE '4240-SUM-INPROCESS-UNITS'                          26200000
262100                                 TO DP013-PARAGRAPH               26210000
262200         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TRECDIS'        26220000
262300                                 TO DP013-MESSAGE-TEXT (1)        26230000
262400         MOVE SQLCA              TO DP013-SQLCA                   26240000
262500         MOVE 'TRECDIS '         TO DP013-DB2-TABLE-NAME (1)      26250000
262600         SET DP013-XCTL-DISPLAY-RESTART                           26260000
262700             DP013-DB2-ABEND     TO TRUE                          26270000
262800         PERFORM DP013-0000-PROCESS-ABEND                         26280000
262900     END-IF.                                                      26290000
263000                                                                  26300000
263100 4250-SUM-STR-TOTAL-RECEIVED.                                     26310000
263200                                                                  26320000
263300     MOVE ZEROS                  TO PV-TOTAL-RCVD.                26330000
263400                                                                  26340000
263500     PERFORM WITH TEST AFTER                                      26350000
263600         VARYING PV-RETRY-COUNTER  FROM 1 BY 1                    26360000
263700         UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR             26370000
263800                 SQLCODE = ZERO OR                                26380000
263900                 SQLCODE = +100                                   26390000
264000                                                                  26400000
264100         EXEC SQL                                                 26410000
264200               SELECT SUM (AP_VERIFY_ITM_QTY)                     26420000
264300                 INTO :PV-TOTAL-RCVD :PV-TOT-RCVD-IND             26430000
264400                 FROM TRECEIV A,                                  26440000
264500                      TRECDIS B                                   26450000
264600                WHERE A.ORD_NBR        = :DK-PO-NBR               26460000
264700                  AND A.ORD_NBR        = B.ORD_NBR                26470000
264800                  AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR            26480000
264900                  AND B.ORD_LNE_NBR    = :DK-PKSL-LNE-NBR         26490000
265000                  AND B.STR_NBR        = :DK-STR-NBR              26500000
265100                  AND B.OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID     26510000
265200                  AND B.FCLTY_ID       = :ASC-KEY-FCLTY-ID        26520000
265300                  AND A.VER_STATUS_CDE = :PC-ACTIVE               26530000
265500                  AND A.STATUS_CDE     = :PC-CM                   26550000
265600         END-EXEC                                                 26560000
265700                                                                  26570000
265800         EVALUATE TRUE                                            26580000
265900             WHEN SQLCODE = ZERO                                  26590000
266000             WHEN SQLCODE = +100                                  26600000
266100             WHEN SQLCODE = -904                                  26610000
266200             WHEN SQLCODE = -913                                  26620000
266300                  CONTINUE                                        26630000
266400                                                                  26640000
266500             WHEN SQLWARN0 NOT = SPACES                           26650000
266600             WHEN SQLCODE  NOT = ZERO                             26660000
266700                  MOVE '4250-SUM-STR-TOTAL-RECEIVED'              26670000
266800                                 TO DP013-PARAGRAPH               26680000
266900                  MOVE 'UNSUCCESSFUL SUM OF TOTAL RECEIVED ITEMS' 26690000
267000                                 TO DP013-MESSAGE-TEXT (1)        26700000
267100                  MOVE SQLCA     TO DP013-SQLCA                   26710000
267200                  MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)      26720000
267300                  MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (2)      26730000
267400                  SET DP013-DB2-ABEND                             26740000
267500                      DP013-XCTL-DISPLAY-RESTART                  26750000
267600                                 TO TRUE                          26760000
267700                                                                  26770000
267800                  PERFORM DP013-0000-PROCESS-ABEND                26780000
267900         END-EVALUATE                                             26790000
268000     END-PERFORM.                                                 26800000
268100                                                                  26810000
268200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         26820000
268300         MOVE '4250-SUM-STR-TOTAL-RECEIVED'                       26830000
268400                                 TO DP013-PARAGRAPH               26840000
268500         MOVE 'MAX RETRIES EXCEEDED ON SUM OF RECEIVED ITEMS'     26850000
268600                                 TO DP013-MESSAGE-TEXT (1)        26860000
268700         MOVE SQLCA              TO DP013-SQLCA                   26870000
268800         MOVE 'TRECEIV '         TO DP013-DB2-TABLE-NAME (1)      26880000
268900         MOVE 'TRECDIS '         TO DP013-DB2-TABLE-NAME (2)      26890000
269000         SET DP013-XCTL-DISPLAY-RESTART                           26900000
269100             DP013-DB2-ABEND     TO TRUE                          26910000
269200                                                                  26920000
269300         PERFORM DP013-0000-PROCESS-ABEND                         26930000
269400     END-IF.                                                      26940000
269500                                                                  26950000
269600/                                                                 26960000
269700******************************************************************26970000
269800*    GET THE ORDER QTY FROM THE PLANNED MERCHANDISE DISTRO TABLE *26980000
269900******************************************************************26990000
270000                                                                  27000000
270100 4260-GET-ORDER-QTY.                                              27010000
270200                                                                  27020000
270300     MOVE ZERO                   TO MESTDS-STR-DISTRO-QTY.        27030000
270400                                                                  27040000
270500     PERFORM                                                      27050000
270600         WITH TEST AFTER                                          27060000
270700         VARYING PV-RETRY-COUNTER                                 27070000
270800         FROM 1 BY 1                                              27080000
270900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27090000
271000             OR (SQLCODE = +0)                                    27100000
271100             OR (SQLCODE = +100))                                 27110000
271200                                                                  27120000
271300         EXEC SQL                                                 27130000
271400             SELECT  STR_DISTRO_QTY                               27140000
271500               INTO  :MESTDS-STR-DISTRO-QTY                       27150000
271600               FROM  TALLPLN A,                                   27160000
271700                     TMESTDS B                                    27170000
271800              WHERE  A.PO_NBR      = :DK-PO-NBR                   27180000
271900                AND  A.PO_NBR      = B.PO_NBR                     27190000
272000                AND  A.PO_LNE_NBR  = :PURITM-PO-LNE-NBR           27200000
272100                AND  A.PO_LNE_NBR  = B.PO_LNE_NBR                 27210000
272200                AND  A.PLAN_NBR    = B.PLAN_NBR                   27220000
272300                AND  A.DEST_NBR    = :ASC-KEY-OPER-UNT-ID         27230000
272400                AND  A.STATUS_CDE  = :PC-AC                       27240000
272500                AND  B.STR_NBR     = :DK-STR-NBR                  27250000
272600         END-EXEC                                                 27260000
272700                                                                  27270000
272800         EVALUATE TRUE                                            27280000
272900                                                                  27290000
273000             WHEN SQLCODE = +0                                    27300000
273100             WHEN SQLCODE = +100                                  27310000
273200             WHEN SQLCODE = -904                                  27320000
273300             WHEN SQLCODE = -913                                  27330000
273400                  CONTINUE                                        27340000
273500                                                                  27350000
273600             WHEN SQLWARN0 NOT = SPACES                           27360000
273700             WHEN SQLCODE < +0                                    27370000
273800             WHEN SQLCODE > +0                                    27380000
273900                  MOVE '4260-GET-ORDER-QTY'                       27390000
274000                                 TO DP013-PARAGRAPH               27400000
274100                  MOVE 'UNSUCCESSFUL SELECT OF TMESTDS'           27410000
274200                                 TO DP013-MESSAGE-TEXT (1)        27420000
274300                  MOVE SQLCA     TO DP013-SQLCA                   27430000
274400                  MOVE 'TALLPLN' TO DP013-DB2-TABLE-NAME (1)      27440000
274500                  MOVE 'TMESTDS' TO DP013-DB2-TABLE-NAME (2)      27450000
274600                  SET DP013-DB2-ABEND                             27460000
274700                      DP013-XCTL-DISPLAY-RESTART                  27470000
274800                                 TO TRUE                          27480000
274900                  PERFORM DP013-0000-PROCESS-ABEND                27490000
275000         END-EVALUATE                                             27500000
275100     END-PERFORM.                                                 27510000
275200                                                                  27520000
275300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27530000
275400         MOVE '4260-GET-ORDER-QTY'                                27540000
275500                                 TO DP013-PARAGRAPH               27550000
275600         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TMESTDS'        27560000
275700                                 TO DP013-MESSAGE-TEXT (1)        27570000
275800         MOVE SQLCA              TO DP013-SQLCA                   27580000
275900         MOVE 'TALLPLN '         TO DP013-DB2-TABLE-NAME (1)      27590000
276000         MOVE 'TMESTDS '         TO DP013-DB2-TABLE-NAME (2)      27600000
276100         SET DP013-XCTL-DISPLAY-RESTART                           27610000
276200             DP013-DB2-ABEND     TO TRUE                          27620000
276300         PERFORM DP013-0000-PROCESS-ABEND                         27630000
276400     END-IF.                                                      27640000
276500                                                                  27650000
276600 4400-MOVE-COMMAREA-TO-SCREEN.                                    27660000
276700                                                                  27670000
276800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         27680000
276900           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         27690000
277000           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            27700000
277100             MOVE +1             TO ASC-BLK-SUB                   27710000
277200                                                                  27720000
277300             PERFORM 5100-WRITE-TEMP-STORAGE                      27730000
277400                                                                  27740000
277500             ADD +1              TO ASC-BLK-SUB                   27750000
277600                                                                  27760000
277700             PERFORM 5100-WRITE-TEMP-STORAGE                      27770000
277800                                                                  27780000
277900             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             27790000
278000                 GIVING PV-BLOCK-NUMBER                           27800000
278100                 REMAINDER PV-REMAINDER                           27810000
278200             IF PV-REMAINDER > ZERO                               27820000
278300                 ADD +1          TO PV-BLOCK-NUMBER               27830000
278400             END-IF                                               27840000
278500             MOVE +1             TO ASC-BLK-SUB                   27850000
278600                                                                  27860000
278700             PERFORM 4410-READ-TEMP-STORAGE                       27870000
278800                                                                  27880000
278900             ADD +1              TO ASC-BLK-SUB                   27890000
279000                                    PV-BLOCK-NUMBER               27900000
279100                                                                  27910000
279200             PERFORM 4410-READ-TEMP-STORAGE                       27920000
279300                                                                  27930000
279400     END-IF.                                                      27940000
279500                                                                  27950000
279600     MOVE +1                     TO ASC-BLK-SUB.                  27960000
279700     COMPUTE ASC-ITEM-SUB =                                       27970000
279800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              27980000
279900                       + PC-ITEMS-PER-PANEL).                     27990000
280000                                                                  28000000
280100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         28010000
280200         ADD +1                  TO ASC-BLK-SUB                   28020000
280300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            28030000
280400     END-IF.                                                      28040000
280500                                                                  28050000
280600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           28060000
280700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                28070000
280800                                                                  28080000
280900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        28090000
281000                                                                  28100000
281100     PERFORM 4420-FORMAT-LIST-LINES                               28110000
281200         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            28120000
281300         UNTIL   PV-SUB < +1.                                     28130000
281400                                                                  28140000
281500     COMPUTE ASC-ITEMS-DISPLAYED =                                28150000
281600                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).28160000
281700     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      28170000
281800                                    ASTRTITO.                     28180000
281900     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                28190000
282000                                 TO AENDITO.                      28200000
282100     MOVE ASC-NUMBER-OF-ITEMS-READ                                28210000
282200                                 TO ATOTITO.                      28220000
282300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            28230000
282400                                 TO ASELITO.                      28240000
282500                                                                  28250000
282600     MOVE PC-DASH                TO ASC-KEY-REC-DASH.             28260000
282700     MOVE ASC-KEY-RECEIVER       TO ARCVRO.                       28270000
282800     MOVE ASC-KEY-PKSL-LNE-NBR   TO ALINEO.                       28280000
282900     MOVE ASC-KEY-OPER-UNT-ID    TO AOPERO.                       28290000
283000     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      28300000
283100     MOVE ASC-KEY-FCLTY-DESC     TO AFDESCO.                      28310000
283200     MOVE ASC-KEY-AD-EVNT-DTE    TO AADDTEO.                      28320000
283300     MOVE ASC-KEY-REC-LNE-QTY    TO ARQTYO.                       28330000
283400     MOVE ASC-KEY-INNR-PACK-QTY  TO AINNRO.                       28340000
283500     MOVE ASC-KEY-VENDOR-NAME    TO AVENDO.                       28350000
283600     MOVE ASC-KEY-TOTAL-OTR      TO ATOTRO.                       28360000
283700     MOVE ASC-KEY-DISTR-LNE-QTY  TO ADQTYO.                       28370000
283800     MOVE ASC-KEY-CASE-PACK-QTY  TO AOUTRO.                       28380000
283900     MOVE ASC-SKU-NBR            TO ASKUNBRO.                     28390000
284000     MOVE ASC-VEND-STYL-NAME     TO AVNSTYLO.                     28400000
284100                                                                  28410000
284200     IF DP020-MSG-NUMBER-X = SPACE                                28420000
284300        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    28430000
284400            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              28440000
284500            SET DP020-MSG-INFORMATIONAL                           28450000
284600                                 TO TRUE                          28460000
284700        END-IF                                                    28470000
284800     END-IF.                                                      28480000
284900                                                                  28490000
285000 4410-READ-TEMP-STORAGE.                                          28500000
285100                                                                  28510000
285200     EXEC CICS READQ TS                                           28520000
285300               QUEUE (ASC-LIST-QUEUE-NAME)                        28530000
285400               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            28540000
285500               ITEM  (PV-BLOCK-NUMBER)                            28550000
285600               RESP  (PV-CICS-RESP)                               28560000
285700     END-EXEC.                                                    28570000
285800                                                                  28580000
285900     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     28590000
286000         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      28600000
286100         CONTINUE                                                 28610000
286200     ELSE                                                         28620000
286300         SET DP013-CICS-ABEND                                     28630000
286400             DP013-NO-ROLLBACK   TO TRUE                          28640000
286500         MOVE '4410-READ-TEMP-STORAGE'                            28650000
286600                                 TO DP013-PARAGRAPH               28660000
286700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   28670000
286800                                 TO DP013-MESSAGE-TEXT (1)        28680000
286900                                                                  28690000
287000         PERFORM DP013-0000-PROCESS-ABEND                         28700000
287100     END-IF.                                                      28710000
287200                                                                  28720000
287300     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     28730000
287400                                 TO TRUE.                         28740000
287500                                                                  28750000
287600     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          28760000
287700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               28770000
287800     END-IF.                                                      28780000
287900                                                                  28790000
288000 4420-FORMAT-LIST-LINES.                                          28800000
288100                                                                  28810000
288200     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       28820000
288300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                28830000
288400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     28840000
288500                                    MR-STR-QTY-A     (PV-SUB)     28850000
288600         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     28860000
288700                                    MR-STR-QTY       (PV-SUB)     28870000
288800                                    MR-STR-NBR       (PV-SUB)     28880000
288900                                    MR-EXPTED-ITM-QTY(PV-SUB)     28890000
289000                                    MR-OPEN-TO-REC   (PV-SUB)     28900000
289100                                    MR-ORDER-QTY     (PV-SUB)     28910000
289200                                    MR-TOT-REC       (PV-SUB)     28920000
289300                                    MR-VERFD-QTY     (PV-SUB)     28930000
289400                                    MR-STATUS        (PV-SUB)     28940000
289500                                    MR-LAST-QTY-REC  (PV-SUB)     28950000
289600                                    MR-LAST-DTE-REC  (PV-SUB)     28960000
289700                                    MR-PRIOR-QTY-REC (PV-SUB)     28970000
289800     ELSE                                                         28980000
289900         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     28990000
290000                                                             SPACE29000000
290100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 29010000
290200                                 TO MR-SELECTI (PV-SUB)           29020000
290300         ELSE                                                     29030000
290400             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      29040000
290500                                 TO MR-SELECTI (PV-SUB)           29050000
290600         END-IF                                                   29060000
290700                                                                  29070000
290800         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            29080000
290900             IF ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)            29090000
291000                                   = SPACES                       29100000
291100                 MOVE SPACES TO MR-STR-QTY         (PV-SUB)       29110000
291200             ELSE                                                 29120000
291300                 MOVE ASC-STR-QTY-N  (ASC-BLK-SUB ASC-ITEM-SUB)   29130000
291400                                 TO MR-STR-QTY-EDITED  (PV-SUB)   29140000
291500             END-IF                                               29150000
291600             MOVE ASC-STR-NBR        (ASC-BLK-SUB ASC-ITEM-SUB)   29160000
291700                                 TO MR-STR-NBR         (PV-SUB)   29170000
291800             MOVE ASC-EXPTED-ITM-QTY-N                            29180000
291900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   29190000
292000                                 TO MR-EXPTED-ITM-QTY-EDITED      29200000
292100                                                       (PV-SUB)   29210000
292200             MOVE ASC-OPEN-TO-REC-N  (ASC-BLK-SUB ASC-ITEM-SUB)   29220000
292300                                 TO MR-OPEN-TO-REC-EDITED         29230000
292400                                                       (PV-SUB)   29240000
292500             MOVE ASC-UNT-QTY-N      (ASC-BLK-SUB ASC-ITEM-SUB)   29250000
292600                                 TO MR-ORDER-QTY-EDITED(PV-SUB)   29260000
292700             MOVE ASC-TOT-REC-N      (ASC-BLK-SUB ASC-ITEM-SUB)   29270000
292800                                 TO MR-TOT-REC-EDITED  (PV-SUB)   29280000
292900             MOVE ASC-VERFD-QTY-N    (ASC-BLK-SUB ASC-ITEM-SUB)   29290000
293000                                 TO MR-VERFD-QTY-EDITED(PV-SUB)   29300000
293100             MOVE ASC-STATUS         (ASC-BLK-SUB ASC-ITEM-SUB)   29310000
293200                                 TO MR-STATUS          (PV-SUB)   29320000
293300             MOVE ASC-LAST-QTY-REC-N (ASC-BLK-SUB ASC-ITEM-SUB)   29330000
293400                                 TO MR-LAST-QTY-REC-EDITED        29340000
293500                                                       (PV-SUB)   29350000
293600             MOVE ASC-LAST-DTE-REC   (ASC-BLK-SUB ASC-ITEM-SUB)   29360000
293700                                 TO MR-LAST-DTE-REC    (PV-SUB)   29370000
293800             MOVE ASC-PRIOR-QTY-REC-N(ASC-BLK-SUB ASC-ITEM-SUB)   29380000
293900                                 TO MR-PRIOR-QTY-REC-EDITED       29390000
294000                                                       (PV-SUB)   29400000
294100             MOVE ASC-PRIOR-DTE-REC  (ASC-BLK-SUB ASC-ITEM-SUB)   29410000
294200                                 TO MR-PRIOR-DTE-REC   (PV-SUB)   29420000
294300         END-IF                                                   29430000
294400     END-IF.                                                      29440000
294500                                                                  29450000
294600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               29460000
294700                                                                  29470000
294800     IF ASC-ITEM-SUB < +1                                         29480000
294900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  29490000
295000         MOVE +1                 TO ASC-BLK-SUB.                  29500000
295100                                                                  29510000
295200 4430-CHECK-FOR-BEGIN-AND-END.                                    29520000
295300                                                                  29530000
295400     IF ASC-START-OF-SELECTED-RANGE > ZERO                        29540000
295500        IF ASC-END-OF-SELECTED-RANGE = ZERO                       29550000
295600            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              29560000
295700            SET DP020-MSG-WARNING                                 29570000
295800                                 TO TRUE                          29580000
295900                                                                  29590000
296000            PERFORM 4431-POSITION-AT-WARNING                      29600000
296100                                                                  29610000
296200         END-IF                                                   29620000
296300     ELSE                                                         29630000
296400         IF ASC-END-OF-SELECTED-RANGE > ZERO                      29640000
296500             MOVE PC-TSYMSG-00053                                 29650000
296600                                 TO DP020-MSG-NUMBER              29660000
296700             SET DP020-MSG-WARNING                                29670000
296800                                 TO TRUE                          29680000
296900                                                                  29690000
297000             PERFORM 4431-POSITION-AT-WARNING                     29700000
297100                                                                  29710000
297200         END-IF                                                   29720000
297300     END-IF.                                                      29730000
297400                                                                  29740000
297500 4431-POSITION-AT-WARNING.                                        29750000
297600                                                                  29760000
297700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               29770000
297800                                                  PV-TOP-ITEM + 1.29780000
297900     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       29790000
298000         CONTINUE                                                 29800000
298100     ELSE                                                         29810000
298200         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           29820000
298300         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           29830000
298400     END-IF.                                                      29840000
298500                                                                  29850000
298600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.29860000
298700                                                                  29870000
298800     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       29880000
298900         CONTINUE                                                 29890000
299000     ELSE                                                         29900000
299100         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           29910000
299200         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           29920000
299300     END-IF.                                                      29930000
299400                                                                  29940000
299500 5100-WRITE-TEMP-STORAGE.                                         29950000
299600                                                                  29960000
299700     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    29970000
299800                                 TO PV-LIST-ITEM-NUMBER.          29980000
299900     COMPUTE PV-BLOCK-NUMBER = 1 +                                29990000
300000                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).30000000
300100                                                                  30010000
300200     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           30020000
300300        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       30030000
300400                                                                  30040000
300500            PERFORM 5105-REWRITE-ASC-LISTQ                        30050000
300600                                                                  30060000
300700        END-IF                                                    30070000
300800     ELSE                                                         30080000
300900         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       30090000
301000                                     ASC-HIGHEST-BLOCK-WRITTEN + 130100000
301100         PERFORM 5110-WRITE-ASC-LISTQ                             30110000
301200                                                                  30120000
301300         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     30130000
301400     END-IF.                                                      30140000
301500                                                                  30150000
301600     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     30160000
301700                                 TO TRUE.                         30170000
301800                                                                  30180000
301900 5105-REWRITE-ASC-LISTQ.                                          30190000
302000                                                                  30200000
302100     EXEC CICS WRITEQ TS                                          30210000
302200               QUEUE   (ASC-LIST-QUEUE-NAME)                      30220000
302300               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           30230000
302400               ITEM    (PV-BLOCK-NUMBER)                          30240000
302500               REWRITE                                            30250000
302600               RESP    (PV-CICS-RESP)                             30260000
302700     END-EXEC.                                                    30270000
302800                                                                  30280000
302900     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       30290000
303000         SET DP013-CICS-ABEND                                     30300000
303100             DP013-NO-ROLLBACK   TO TRUE                          30310000
303200         MOVE '5105-REWRITE-ASC-LISTQ'                            30320000
303300                                 TO DP013-PARAGRAPH               30330000
303400         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'30340000
303500                                 TO DP013-MESSAGE-TEXT (1)        30350000
303600         PERFORM DP013-0000-PROCESS-ABEND                         30360000
303700     END-IF.                                                      30370000
303800                                                                  30380000
303900 5110-WRITE-ASC-LISTQ.                                            30390000
304000                                                                  30400000
304100     EXEC CICS WRITEQ TS                                          30410000
304200               QUEUE (ASC-LIST-QUEUE-NAME)                        30420000
304300               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            30430000
304400               ITEM  (PV-BLOCK-NUMBER)                            30440000
304500               RESP  (PV-CICS-RESP)                               30450000
304600     END-EXEC.                                                    30460000
304700                                                                  30470000
304800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      30480000
304900         SET DP013-CICS-ABEND                                     30490000
305000             DP013-NO-ROLLBACK   TO TRUE                          30500000
305100         MOVE '5110-WRITE-ASC-LISTQ'                              30510000
305200                                 TO DP013-PARAGRAPH               30520000
305300         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  30530000
305400                                 TO DP013-MESSAGE-TEXT (1)        30540000
305500         PERFORM DP013-0000-PROCESS-ABEND                         30550000
305600     END-IF.                                                      30560000
305700                                                                  30570000
305800 5200-FILL-SEL-QUEUE-RECORD.                                      30580000
305900                                                                  30590000
306000     PERFORM 6112-READ-LIST-QUEUE.                                30600000
306100                                                                  30610000
306200     IF PV-CICS-RESP = DFHRESP (NORMAL)                           30620000
306300         PERFORM                                                  30630000
306400         VARYING LQW-IDX  FROM 1 BY 1                             30640000
306500         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  30650000
306600                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            30660000
306700                 MOVE SPACE      TO RC013-ACTION-SW  (RC013-IDX)  30670000
306800                 SET RC013-IDX UP BY 1                            30680000
306900                 IF RC013-IDX > RC013-MAX-ITEMS                   30690000
307000                                                                  30700000
307100                     PERFORM 5205-WRITE-SEL-QUEUE                 30710000
307200                                                                  30720000
307300                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      30730000
307400                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         30740000
307500                     SET RC013-IDX                                30750000
307600                                 TO 1                             30760000
307700                 END-IF                                           30770000
307800         END-PERFORM                                              30780000
307900     END-IF.                                                      30790000
308000                                                                  30800000
308100 5205-WRITE-SEL-QUEUE.                                            30810000
308200                                                                  30820000
308300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            30830000
308400                                 TO RC013-SELECTED-ITEMS.         30840000
308500                                                                  30850000
308600     EXEC CICS WRITEQ TS                                          30860000
308700               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     30870000
308800               FROM  (RC013-DC-SELECT-RECORD)                     30880000
308900               ITEM  (PV-SEL-QUEUE-ITEM)                          30890000
309000               RESP  (PV-CICS-RESP)                               30900000
309100     END-EXEC.                                                    30910000
309200                                                                  30920000
309300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       30930000
309400         SET DP013-CICS-ABEND                                     30940000
309500             DP013-NO-ROLLBACK   TO TRUE                          30950000
309600         MOVE '5205-WRITE-SEL-QUEUE'                              30960000
309700                                 TO DP013-PARAGRAPH               30970000
309800         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   30980000
309900                                 TO DP013-MESSAGE-TEXT (1)        30990000
310000         PERFORM DP013-0000-PROCESS-ABEND                         31000000
310100     END-IF.                                                      31010000
310200                                                                  31020000
310300/                                                                 31030000
310400 6000-REFRESH-PANEL-FROM-TEMP.                                    31040000
310500                                                                  31050000
310600     IF ASC-UPDATE-TSQ                                            31060000
310700         SET ASC-NO-TSQ-UPDATE   TO TRUE                          31070000
310800         MOVE ZERO               TO PV-SAVE-ITEM                  31080000
310900                                    PV-SEL-QUEUE-ITEM             31090000
311000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        31100000
311100                                 TO PV-HOLD-SELECTED-ITEMS        31110000
311200         PERFORM 6100-UPDATE-TSQ                                  31120000
311300           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS31130000
311400                                                                  31140000
311500         PERFORM 6010-DELETE-SEL-QUEUE                            31150000
311600                                                                  31160000
311700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         31170000
311800                    ASC-BLOCK-ENTRIES (2)                         31180000
311900                                                                  31190000
312000         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 31200000
312100                GIVING    PV-BLOCK-NUMBER                         31210000
312200                REMAINDER PV-REMAINDER                            31220000
312300                                                                  31230000
312400         IF PV-REMAINDER > ZERO                                   31240000
312500             ADD +1              TO PV-BLOCK-NUMBER               31250000
312600         END-IF                                                   31260000
312700                                                                  31270000
312800         MOVE +1                 TO ASC-BLK-SUB                   31280000
312900                                                                  31290000
313000         PERFORM 4410-READ-TEMP-STORAGE                           31300000
313100                                                                  31310000
313200         ADD +1                  TO ASC-BLK-SUB                   31320000
313300                            PV-BLOCK-NUMBER                       31330000
313400         PERFORM 4410-READ-TEMP-STORAGE                           31340000
313500                                                                  31350000
313600     END-IF.                                                      31360000
313700                                                                  31370000
313800 6010-DELETE-SEL-QUEUE.                                           31380000
313900                                                                  31390000
314000     EXEC CICS DELETEQ TS                                         31400000
314100               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     31410000
314200               RESP  (PV-CICS-RESP)                               31420000
314300     END-EXEC.                                                    31430000
314400                                                                  31440000
314500     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     31450000
314600         (PV-CICS-RESP = DFHRESP (QIDERR)))                       31460000
314700         CONTINUE                                                 31470000
314800     ELSE                                                         31480000
314900         SET DP013-CICS-ABEND                                     31490000
315000             DP013-NO-ROLLBACK   TO TRUE                          31500000
315100         MOVE '6010-DELETE-SEL-QUEUE'                             31510000
315200                                 TO DP013-PARAGRAPH               31520000
315300         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  31530000
315400                                 TO DP013-MESSAGE-TEXT (1)        31540000
315500         PERFORM DP013-0000-PROCESS-ABEND                         31550000
315600     END-IF.                                                      31560000
315700                                                                  31570000
315800 6100-UPDATE-TSQ.                                                 31580000
315900                                                                  31590000
316000     ADD 1                       TO PV-SEL-QUEUE-ITEM.            31600000
316100                                                                  31610000
316200     PERFORM 6105-READ-SEL-QUEUE.                                 31620000
316300                                                                  31630000
316400     PERFORM                                                      31640000
316500     VARYING RC013-IDX  FROM 1 BY 1                               31650000
316600     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       31660000
316700             RC013-IDX > RC013-MAX-ITEMS                          31670000
316800                                                                  31680000
316900         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   31690000
317000            PERFORM 6110-PROCESS-ITEMS                            31700000
317100         END-IF                                                   31710000
317200                                                                  31720000
317300         ADD +1                  TO PV-ITEMS-PROCESSED            31730000
317400     END-PERFORM.                                                 31740000
317500                                                                  31750000
317600     PERFORM 6111-WRITE-LIST-QUEUE.                               31760000
317700                                                                  31770000
317800                                                                  31780000
317900 6105-READ-SEL-QUEUE.                                             31790000
318000                                                                  31800000
318100     EXEC CICS READQ TS                                           31810000
318200               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     31820000
318300               INTO  (RC013-DC-SELECT-RECORD)                     31830000
318400               ITEM  (PV-SEL-QUEUE-ITEM)                          31840000
318500               RESP  (PV-CICS-RESP)                               31850000
318600     END-EXEC.                                                    31860000
318700                                                                  31870000
318800     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       31880000
318900         SET DP013-CICS-ABEND                                     31890000
319000             DP013-NO-ROLLBACK   TO TRUE                          31900000
319100         MOVE '6105-READ-SEL-QUEUE'                               31910000
319200                                 TO DP013-PARAGRAPH               31920000
319300         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    31930000
319400                                 TO DP013-MESSAGE-TEXT (1)        31940000
319500         PERFORM DP013-0000-PROCESS-ABEND                         31950000
319600     END-IF.                                                      31960000
319700                                                                  31970000
319800 6110-PROCESS-ITEMS.                                              31980000
319900                                                                  31990000
320000     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          32000000
320100                                            / PC-ITEMS-PER-PANEL).32010000
320200                                                                  32020000
320300     IF PV-ITEM NOT = PV-SAVE-ITEM                                32030000
320400        IF PV-SAVE-ITEM NOT = ZERO                                32040000
320500                                                                  32050000
320600            PERFORM 6111-WRITE-LIST-QUEUE                         32060000
320700                                                                  32070000
320800        END-IF                                                    32080000
320900        MOVE PV-ITEM             TO PV-SAVE-ITEM                  32090000
321000                                                                  32100000
321100        PERFORM 6112-READ-LIST-QUEUE                              32110000
321200                                                                  32120000
321300     END-IF.                                                      32130000
321400                                                                  32140000
321500     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   32150000
321600                                    LQW-LIST-ITEM-NUMBER (1)) + 1.32160000
321700     SET LQW-DESELECT (PV-SUB)   TO TRUE                          32170000
321800     MOVE LQW-SELECTED-SW (PV-SUB)                                32180000
321900                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).32190000
322000                                                                  32200000
322100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                32210000
322200                                                                  32220000
322300 6111-WRITE-LIST-QUEUE.                                           32230000
322400                                                                  32240000
322500     EXEC CICS WRITEQ TS                                          32250000
322600               QUEUE (ASC-LIST-QUEUE-NAME)                        32260000
322700               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   32270000
322800               ITEM  (PV-SAVE-ITEM)                               32280000
322900               REWRITE                                            32290000
323000               RESP  (PV-CICS-RESP)                               32300000
323100     END-EXEC.                                                    32310000
323200                                                                  32320000
323300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       32330000
323400         SET DP013-CICS-ABEND                                     32340000
323500             DP013-NO-ROLLBACK   TO TRUE                          32350000
323600         MOVE '6111-WRITE-LIST-QUEUE'                             32360000
323700                                 TO DP013-PARAGRAPH               32370000
323800         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'32380000
323900                                 TO DP013-MESSAGE-TEXT(1)         32390000
324000         PERFORM DP013-0000-PROCESS-ABEND                         32400000
324100     END-IF.                                                      32410000
324200                                                                  32420000
324300 6112-READ-LIST-QUEUE.                                            32430000
324400                                                                  32440000
324500     EXEC CICS READQ TS                                           32450000
324600               QUEUE (ASC-LIST-QUEUE-NAME)                        32460000
324700               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   32470000
324800               ITEM  (PV-ITEM)                                    32480000
324900               RESP  (PV-CICS-RESP)                               32490000
325000     END-EXEC.                                                    32500000
325100                                                                  32510000
325200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       32520000
325300         SET DP013-CICS-ABEND                                     32530000
325400             DP013-NO-ROLLBACK   TO TRUE                          32540000
325500         MOVE '6112-READ-LIST-QUEUE'                              32550000
325600                                 TO DP013-PARAGRAPH               32560000
325700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   32570000
325800                                 TO DP013-MESSAGE-TEXT(1)         32580000
325900         PERFORM DP013-0000-PROCESS-ABEND                         32590000
326000     END-IF.                                                      32600000
326100                                                                  32610000
326200******************************************************************32620000
326300* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *32630000
326400******************************************************************32640000
326500 6200-DEL-LIST-QUEUE.                                             32650000
326600                                                                  32660000
326700     EXEC CICS                                                    32670000
326800         DELETEQ TS                                               32680000
326900             QUEUE (ASC-LIST-QUEUE-NAME)                          32690000
327000             RESP  (PV-CICS-RESP)                                 32700000
327100     END-EXEC.                                                    32710000
327200                                                                  32720000
327300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      32730000
327400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         32740000
327500         CONTINUE                                                 32750000
327600     ELSE                                                         32760000
327700        SET DP013-CICS-ABEND     TO TRUE                          32770000
327800        SET DP013-NO-ROLLBACK    TO TRUE                          32780000
327900        MOVE '6200-DEL-LIST-QUEUE'                                32790000
328000                                 TO DP013-PARAGRAPH               32800000
328100        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               32810000
328200                                 TO DP013-MESSAGE-TEXT (1)        32820000
328300        PERFORM DP013-0000-PROCESS-ABEND                          32830000
328400     END-IF.                                                      32840000
328500/                                                                 32850000
328600******************************************************************32860000
328700* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *32870000
328800******************************************************************32880000
328900 9100-READ-SEL-QUEUE.                                             32890000
329000                                                                  32900000
329100     EXEC CICS                                                    32910000
329200         READQ TS                                                 32920000
329300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        32930000
329400             INTO  (RC013-DC-SELECT-RECORD)                       32940000
329500             ITEM  (ASC-SEL-ITEM)                                 32950000
329600             RESP  (PV-CICS-RESP)                                 32960000
329700     END-EXEC.                                                    32970000
329800                                                                  32980000
329900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        32990000
330000         CONTINUE                                                 33000000
330100     ELSE                                                         33010000
330200         SET DP013-LOGIC-ABEND                                    33020000
330300             DP013-NO-ROLLBACK   TO TRUE                          33030000
330400         MOVE '9100-READ-SEL-QUEUE'                               33040000
330500                                 TO DP013-PARAGRAPH               33050000
330600         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    33060000
330700                                 TO DP013-MESSAGE-TEXT (1)        33070000
330800         PERFORM DP013-0000-PROCESS-ABEND                         33080000
330900     END-IF.                                                      33090000
331000                                                                  33100000
331100/                                                                 33110000
331200******************************************************************33120000
331300* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *33130000
331400******************************************************************33140000
331500 9200-REWRITE-LIST-QUEUE.                                         33150000
331600     EXEC CICS                                                    33160000
331700          WRITEQ TS                                               33170000
331800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     33180000
331900              FROM    (RC013-DC-SELECT-RECORD)                    33190000
332000              ITEM    (ASC-SEL-ITEM)                              33200000
332100              RESP    (PV-CICS-RESP)                              33210000
332200              REWRITE                                             33220000
332300     END-EXEC.                                                    33230000
332400                                                                  33240000
332500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    33250000
332600         SET DP013-CICS-ABEND                                     33260000
332700             DP013-NO-ROLLBACK   TO TRUE                          33270000
332800         MOVE '9200-REWRITE-LIST-QUEUE'                           33280000
332900                                 TO DP013-PARAGRAPH               33290000
333000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   33300000
333100                                 TO DP013-MESSAGE-TEXT (1)        33310000
333200         PERFORM DP013-0000-PROCESS-ABEND                         33320000
333300     END-IF.                                                      33330000
333400/                                                                 33340000
333500******************************************************************33350000
333600* READ AN ITEM FROM THE INPUT SELECTED WORK ORDER ITEMS          *33360000
333700* TEMP STORAGE QUEUE.                                            *33370000
333800******************************************************************33380000
333900 9300-READ-WO-SEL-QUEUE.                                          33390000
334000                                                                  33400000
334100     EXEC CICS                                                    33410000
334200         READQ TS                                                 33420000
334300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        33430000
334400             INTO  (PC016-TS-SEL-REC)                             33440000
334500             ITEM  (ASC-SEL-ITEM)                                 33450000
334600             RESP  (PV-CICS-RESP)                                 33460000
334700     END-EXEC.                                                    33470000
334800                                                                  33480000
334900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        33490000
335000         CONTINUE                                                 33500000
335100     ELSE                                                         33510000
335200         SET DP013-LOGIC-ABEND                                    33520000
335300             DP013-NO-ROLLBACK   TO TRUE                          33530000
335400         MOVE '9300-READ-WO-SEL-QUEUE'                            33540000
335500                                 TO DP013-PARAGRAPH               33550000
335600         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    33560000
335700                                 TO DP013-MESSAGE-TEXT (1)        33570000
335800         MOVE ASC-SEL-QUEUE-NAME-IN TO MSG-QUEUE-NAME             33580000
335900         MOVE ASC-SEL-ITEM       TO MSG-SEL-ITEM                  33590000
336000         MOVE MSG-QUEUE-ITEM     TO DP013-MESSAGE-TEXT (2)        33600000
336100         MOVE PC000-PO-NBR-N     TO MSG1-PO-NBR                   33610000
336200         MOVE PC000-REC-SEQ-NBR-N                                 33620000
336300                                 TO MSG1-REC-SEQ-NBR-N            33630000
336400         MOVE PC000-OPERATING-UNIT-ID                             33640000
336500                                 TO MSG1-OPER-UNT-ID              33650000
336600         MOVE PC000-FACILITY-ID  TO MSG1-FACILITY-ID              33660000
336700         MOVE MSG1-PO-REC        TO DP013-MESSAGE-TEXT (3)        33670000
336800         PERFORM DP013-0000-PROCESS-ABEND                         33680000
336900     END-IF.                                                      33690000
337000                                                                  33700000
337100/                                                                 33710000
337200******************************************************************33720000
337300* UPDATE AN ITEM IN THE INPUT SELECTED WORK ORDER ITEMS          *33730000
337400* TEMP STORAGE QUEUE.                                            *33740000
337500******************************************************************33750000
337600 9400-REWRITE-WO-LIST-QUEUE.                                      33760000
337700     EXEC CICS                                                    33770000
337800          WRITEQ TS                                               33780000
337900              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     33790000
338000              FROM    (PC016-TS-SEL-REC)                          33800000
338100              ITEM    (ASC-SEL-ITEM)                              33810000
338200              RESP    (PV-CICS-RESP)                              33820000
338300              REWRITE                                             33830000
338400     END-EXEC.                                                    33840000
338500                                                                  33850000
338600     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    33860000
338700         SET DP013-CICS-ABEND                                     33870000
338800             DP013-NO-ROLLBACK   TO TRUE                          33880000
338900         MOVE '9400-REWRITE-WO-LIST-QUEUE'                        33890000
339000                                 TO DP013-PARAGRAPH               33900000
339100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   33910000
339200                                 TO DP013-MESSAGE-TEXT (1)        33920000
339300         PERFORM DP013-0000-PROCESS-ABEND                         33930000
339400     END-IF.                                                      33940000
339500                                                                  33950000
339600******************************************************************33960000
339700*    ABEND PROCESSING                                             33970000
339800******************************************************************33980000
339900     COPY DPPD013.                                                33990024
