000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.    APKRP122.                                         00020001
000300 AUTHOR.        NANCY EILBES.                                     00030001
000400 INSTALLATION.  KOHLS.                                            00040001
000500 DATE-WRITTEN   DECEMBER 2003.                                    00050001
000600 DATE-COMPILED.                                                   00060001
000700                                                                  00070001
000800*----------------------------------------------------------------*00080001
000900*  VENDOR MARKOUT OF STOCK ACTIVITY AND AGREEMENTS REPORT        *00090001
000910*  COBOL                                                         *00091001
000920*                                                                *00092001
000930*  THE PURPOSE OF THIS PROGRAM IS TO CREATE A REPORT OF PURCHASE *00093001
000940*  ACTIVITY, MOS DEDUCTIONS AND MOS VENDOR AGREEMENTS.           *00094001
000950*                                                                *00095001
000960*  THE PROGRAM USES THE EXTRACT FILE CREATED IN PROGRAM APKUT118 *00096001
000970*  WHICH HAS BEEN SORTED TO INCLUDE EITHER ALL ACTIVITY PLUS THE *00097001
000980*  MOS AGREEMENTS WITH THEIR ASSOCIATED ACTIVITY OR ELSE JUST    *00098001
000990*  THE MOS AGREEMENTS WITH THEIR ACTIVITY.                       *00099001
001300*----------------------------------------------------------------*00130001
001310* INPUT:                                                         *00131001
001320*  1. AGREEMENT ACTIVITY EXTRACT FILE         APRD081            *00132001
001330*  2. DATES USED CONTROL CARD                                    *00133001
001331*                                                                *00133101
001332* OUTPUT:                                                        *00133201
001333*  1. MARKOUT OF STOCK ACTIVITY AND AGREEMENT REPORT.            *00133301
001335*                                                                *00133501
001336*----------------------------------------------------------------*00133601
001337* CHANGE LOG:                                                    *00133701
001338*   DATE 12/08/2003                                              *00133801
001339*       CHANGE MADE: INITIAL VERSION.                            *00133901
001340*       MADE BY: NANCY EILBES            WR/IR #: WR25421        *00134001
001350*                                                                *00135001
001351*   DATE 04/22/2004                                              *00135112
001352*       CHANGE MADE: INCREASED RECORD LENGTH ON FILE USING       *00135212
001353*       COPYBOOK APRD081.  NO LOGIC CHANGES NEEDED.              *00135312
001354*       MADE BY: NANCY EILBES            WR/IR #: WR26677        *00135412
001355*                                                                *00135512
001356*   DATE 10/25/2004                                              *00135614
001357*       CHANGE MADE: REMOVED THE TEXT FILE FROM THE PROGRAM -    *00135714
001358*       IT WAS NOT BEING USED.                                   *00135814
001359*       MADE BY: NANCY EILBES            WR/IR #: WR26677        *00135914
001360*                                                                *00136014
001361******************************************************************00136114
001370 ENVIRONMENT DIVISION.                                            00137001
001380 CONFIGURATION SECTION.                                           00138001
001390 SOURCE-COMPUTER.        IBM-3090.                                00139001
001400 OBJECT-COMPUTER.        IBM-3090.                                00140001
001500                                                                  00150001
001600 INPUT-OUTPUT SECTION.                                            00160001
001700 FILE-CONTROL.                                                    00170001
001800                                                                  00180001
001900     SELECT ACTIVITY-EXTRACT-FILE        ASSIGN TO INP01.         00190001
002100     SELECT REPORT-FILE                  ASSIGN TO RPT01.         00210001
002200                                                                  00220001
002300 DATA DIVISION.                                                   00230001
002400 FILE SECTION.                                                    00240001
002500                                                                  00250001
002600 FD  ACTIVITY-EXTRACT-FILE                                        00260001
002700     RECORDING MODE IS F                                          00270001
002800     LABEL RECORDS ARE STANDARD                                   00280001
002900     BLOCK CONTAINS 0 RECORDS.                                    00290001
003000 01  ACTIVITY-EXTRACT-RECORD         PIC  X(250).                 00300011
003100                                                                  00310001
003900 FD  REPORT-FILE                                                  00390001
004000     RECORDING MODE IS F                                          00400001
004100     LABEL RECORDS ARE STANDARD                                   00410001
004110     BLOCK CONTAINS 0 RECORDS                                     00411001
004120     DATA RECORD IS REPORT-REC.                                   00412001
004130 01  REPORT-REC                      PIC  X(132).                 00413009
004140                                                                  00414001
004150 WORKING-STORAGE SECTION.                                         00415001
004160                                                                  00416001
004170 01  PC-PROGRAM-CONSTANTS.                                        00417001
004180     05  PC-PROGRAM-NAME     PIC X(08) VALUE 'APKRP122'.          00418001
004190                                                                  00419001
004200 01  PS-PROGRAM-SWITCHES.                                         00420001
004300     05  PS-END-OF-EXTRACT-SW        PIC X(01) VALUE 'N'.         00430001
004400         88  PS-END-OF-EXTRACT                 VALUE 'Y'.         00440001
004500                                                                  00450001
004600 01  CONTROL-CARD-ONE.                                            00460001
004700     05  CC-BEGIN-DTE            PIC X(10).                       00470001
004800     05  FILLER                  PIC X.                           00480001
004900     05  CC-END-DTE              PIC X(10).                       00490001
005000     05  FILLER                  PIC X(59).                       00500001
005100                                                                  00510001
005200 01  CONTROL-CARD-TWO.                                            00520001
005300     05  CC-SUBHEADING           PIC X(44).                       00530006
005400     05  FILLER                  PIC X(36).                       00540006
005500                                                                  00550001
005600 01  PV-REPORT-CONTROLS.                                          00560001
005700     05  PV-LINE-COUNT               PIC S999       VALUE +0.     00570009
005800     05  PC-LINES-PER-PAGE-MAX       PIC S999       VALUE +60.    00580009
005900     05  PV-PAGE-COUNT               PIC S9(05)     VALUE +0.     00590009
006000                                                                  00600001
006100 01  PV-PROGRAM-VARIABLES.                                        00610001
006200     05  PV-EARNED-ALW-AMT           PIC S9(12)V99  COMP-3.       00620009
006300     05  PV-UNTAKEN-AMT              PIC S9(12)V99  COMP-3.       00630009
006400     05  DM-GROSS-AMT                PIC S9(14)V99  VALUE ZERO.   00640001
006800     05  DM-EARNED                   PIC S9(14)V99  VALUE ZERO.   00680001
006900     05  DM-ACTUAL-TAKEN             PIC S9(14)V99  VALUE ZERO.   00690001
007000     05  DM-UNTAKEN-AMT              PIC S9(14)V99  VALUE ZERO.   00700001
007100     05  TOT-GROSS-AMT               PIC S9(14)V99  VALUE ZERO.   00710001
007500     05  TOT-EARNED                  PIC S9(14)V99  VALUE ZERO.   00750001
007600     05  TOT-ACTUAL-TAKEN            PIC S9(14)V99  VALUE ZERO.   00760001
007700     05  TOT-UNTAKEN-AMT             PIC S9(14)V99  VALUE ZERO.   00770001
007800     05  SAVE-DMA-NBR                PIC X(02)      VALUE SPACES. 00780001
007900     05  SAVE-VND-NBR                PIC X(09)      VALUE SPACES. 00790001
008000     05  SAVE-DEPT-NBR               PIC X(03)      VALUE SPACES. 00800001
008100     05  PV-DISCOUNT-PCT-EXPD        PIC 999V99     VALUE ZERO.   00810001
008200     05  PV-INPUT-EXTRACT-CNT        PIC 9(9)       VALUE ZERO.   00820001
008400                                                                  00840001
008500     05  PV-CURRENT-DATE.                                         00850001
008600         10  PV-CURRENT-CCYY.                                     00860001
008700             15  PV-CURRENT-CC       PIC 99         VALUE ZERO.   00870009
008800             15  PV-CURRENT-YEAR     PIC 99         VALUE ZERO.   00880009
008900         10  PV-CURRENT-MONTH        PIC 99         VALUE ZERO.   00890009
009000         10  PV-CURRENT-DAY          PIC 99         VALUE ZERO.   00900009
009100     05  PV-CURRENT-TIME.                                         00910001
009200         10  PV-CURRENT-HOUR         PIC 99         VALUE ZERO.   00920009
009300         10  PV-CURRENT-MINUTE       PIC 99         VALUE ZERO.   00930009
009400         10  FILLER                  PIC 99         VALUE ZERO.   00940009
009500                                                                  00950001
009600                                                                  00960001
009700*----------------------------------------------------------------*00970001
009800*    STANDARD HEADER LAYOUT                                       00980001
009900*----------------------------------------------------------------*00990001
010000     COPY DPWS132O.                                               01000001
010100                                                                  01010001
010200                                                                  01020001
010300*---------------------------------------------------------------* 01030001
010400*  RECORD LAYOUT FOR RECEIVER                                     01040001
010500*---------------------------------------------------------------* 01050001
010600     COPY APRD081.                                                01060001
011010                                                                  01101001
011020*----------------------------------------------------------------*01102001
011030*    REPORT LAYOUT                                                01103001
011040*----------------------------------------------------------------*01104001
011050                                                                  01105001
011060 01  HEADING-LINE-1.                                              01106001
011070     05  FILLER                  PIC X(40) VALUE SPACES.          01107009
011080     05  H1-TITLE                PIC X(52) VALUE                  01108009
011090     'PURCHASE ACTIVITY AND VENDOR MOS DISCOUNT AGREEMENTS'.      01109001
011100     05  FILLER                  PIC X(40) VALUE SPACES.          01110009
011200                                                                  01120001
011300 01  HEADING-LINE-2.                                              01130001
011400     05  FILLER                  PIC X(46) VALUE SPACES.          01140009
011500     05  FILLER                  PIC X(11) VALUE                  01150009
011600                                                  'FOR FISCAL '.  01160001
011700     05  H2-BEGIN-DTE            PIC X(10).                       01170009
011800     05  FILLER                  PIC X(09) VALUE ' THROUGH '.     01180009
011900     05  H2-END-DTE              PIC X(10).                       01190009
012000     05  FILLER                  PIC X(46) VALUE SPACES.          01200009
012100                                                                  01210001
012200 01  HEADING-LINE-3.                                              01220001
012300     05  FILLER                  PIC X(44) VALUE SPACES.          01230009
012400     05  H3-SUBHEADING           PIC X(44).                       01240009
012500     05  FILLER                  PIC X(44) VALUE SPACES.          01250009
012600                                                                  01260001
012700 01  HEADING-LINE-4.                                              01270001
012800     05  FILLER                  PIC X(30) VALUE 'VENDOR NAME'.   01280001
012900     05  FILLER                  PIC X(02) VALUE SPACES.          01290001
013000     05  FILLER                  PIC X(09) VALUE 'VENDOR # '.     01300001
013100     05  FILLER                  PIC X(02) VALUE SPACES.          01310001
013200     05  FILLER                  PIC X(03) VALUE 'DPT'.           01320001
013300     05  FILLER                  PIC X(08) VALUE SPACES.          01330001
013400     05  FILLER                  PIC X(10) VALUE ' RECEIPTS'.     01340001
013500     05  FILLER                  PIC X(08) VALUE SPACES.          01350001
014300     05  FILLER                  PIC X(05) VALUE ' PCNT'.         01430004
014900     05  FILLER                  PIC X(12) VALUE SPACES.          01490004
015000     05  FILLER                  PIC X(07) VALUE 'EARNED'.        01500001
015100     05  FILLER                  PIC X(06) VALUE SPACES.          01510004
015200     05  FILLER                  PIC X(13) VALUE 'ACTUAL TAKEN'.  01520001
015300     05  FILLER                  PIC X(05) VALUE SPACES.          01530004
015400     05  FILLER                  PIC X(12) VALUE ' DIFFERENCE'.   01540001
015410     05  FILLER                  PIC X(04) VALUE SPACES.          01541001
015500                                                                  01550001
015600 01  BLANK-LINE                  PIC X(132) VALUE SPACES.         01560001
015700                                                                  01570001
015800 01  DETAIL-LINE.                                                 01580001
015900     05  DL-VENDOR-NAME          PIC X(30) VALUE SPACES.          01590001
016000     05  FILLER                  PIC X(02) VALUE SPACES.          01600001
016100     05  DL-VENDOR-NBR           PIC X(09) VALUE SPACES.          01610001
016200     05  FILLER                  PIC X(02) VALUE SPACES.          01620001
016300     05  DL-DEPT-NBR             PIC X(03) VALUE SPACES.          01630001
016400     05  FILLER                  PIC X(02) VALUE SPACES.          01640001
016500     05  DL-GROSS-AMT            PIC -(12).99.                    01650001
016600     05  FILLER                  PIC X(08) VALUE SPACES.          01660004
017300     05  DL-DISCOUNT-PCT         PIC ZZ9.99.                      01730001
017400     05  FILLER                  PIC X(03) VALUE SPACES.          01740004
018000     05  DL-EARNED               PIC -(12).99.                    01800001
018100     05  FILLER                  PIC X(04) VALUE SPACES.          01810005
018300     05  DL-ACTUAL-TAKEN         PIC -(12).99.                    01830001
018400     05  FILLER                  PIC X(02) VALUE SPACES.          01840004
018500     05  DL-UNTAKEN-AMT          PIC -(12).99.                    01850001
018510     05  FILLER                  PIC X(05) VALUE SPACES.          01851001
018600                                                                  01860001
018700 01  DMA-HEADER-LINE.                                             01870001
018800     05  FILLER                  PIC X(10) VALUE 'DIVISION: '.    01880001
018900     05  DHD-DMA-NBR             PIC X(02) VALUE SPACES.          01890001
019000                                                                  01900001
019100 01  DASH-LINE.                                                   01910001
019200     05  FILLER                  PIC X(46) VALUE SPACES.          01920001
019500     05  FILLER                  PIC X(18) VALUE ALL '-'.         01950006
019600     05  FILLER                  PIC X(16) VALUE SPACES.          01960006
019700     05  FILLER                  PIC X(16) VALUE ALL '-'.         01970001
019800     05  FILLER                  PIC X(03) VALUE SPACES.          01980006
019900     05  FILLER                  PIC X(16) VALUE ALL '-'.         01990001
020200     05  FILLER                  PIC X(03) VALUE SPACES.          02020006
020300     05  FILLER                  PIC X(16) VALUE ALL '-'.         02030001
020400     05  FILLER                  PIC X(02) VALUE SPACES.          02040001
020500     05  FILLER                  PIC X(15) VALUE ALL '-'.         02050006
020600                                                                  02060001
020700 01  DMA-TOTAL-LINE.                                              02070001
020800     05  FILLER                  PIC X(25) VALUE                  02080001
020900                                 '     TOTALS FOR DIVISION '.     02090001
021000     05  DTOT-DMA-NBR            PIC X(02).                       02100001
021100     05  FILLER                  PIC X(1)  VALUE ':'.             02110001
021200     05  FILLER                  PIC X(18) VALUE SPACES.          02120001
021300     05  DTOT-GROSS-AMT          PIC -(14).99.                    02130001
022000     05  FILLER                  PIC X(17) VALUE SPACES.          02200006
022100     05  DTOT-EARNED             PIC -(12).99.                    02210001
022200     05  FILLER                  PIC X(04) VALUE SPACES.          02220006
022300     05  DTOT-ACTUAL-TAKEN       PIC -(12).99.                    02230001
022400     05  FILLER                  PIC X(02) VALUE SPACES.          02240007
022500     05  DTOT-UNTAKEN-AMT        PIC -(12).99.                    02250001
022600                                                                  02260001
022700 01  GRAND-TOTAL-LINE.                                            02270001
022800     05  FILLER                  PIC X(41) VALUE                  02280001
022900                                           '     GRAND TOTALS:'.  02290001
023000     05  FILLER                  PIC X(05) VALUE SPACES.          02300001
023100     05  TL-GROSS-AMT            PIC -(14).99.                    02310001
023200     05  FILLER                  PIC X(17) VALUE SPACES.          02320006
023900     05  TL-EARNED               PIC -(12).99.                    02390001
024000     05  FILLER                  PIC X(04) VALUE SPACES.          02400006
024100     05  TL-ACTUAL-TAKEN         PIC -(12).99.                    02410001
024200     05  FILLER                  PIC X(02) VALUE SPACES.          02420007
024300     05  TL-UNTAKEN-AMT          PIC -(12).99.                    02430001
024400                                                                  02440001
024500 01  END-OF-REPORT.                                               02450001
024600     05  FILLER                  PIC X(50) VALUE SPACES.          02460009
024700     05  FILLER                  PIC X(33) VALUE                  02470009
024800                              '***  E N D  O F  R E P O R T  ***'.02480001
024900     05  FILLER                  PIC X(49) VALUE SPACES.          02490009
025000                                                                  02500001
025100 PROCEDURE DIVISION.                                              02510001
025200                                                                  02520001
025300 A100-PROGRAM-MAINLINE.                                           02530001
025400                                                                  02540001
025500     PERFORM B100-INITIALIZE.                                     02550001
025600                                                                  02560001
025700     PERFORM B200-CREATE-REPORT                                   02570001
025800       UNTIL PS-END-OF-EXTRACT.                                   02580009
025900                                                                  02590001
026000     PERFORM B300-EOJ-ROUTINE.                                    02600001
026100                                                                  02610001
026200     GOBACK.                                                      02620001
026300                                                                  02630001
026400                                                                  02640001
026500******************************************************************02650001
026600*  INITIALIZATIONS                                               *02660001
026700******************************************************************02670001
026800 B100-INITIALIZE.                                                 02680001
026900                                                                  02690001
027000     OPEN INPUT  ACTIVITY-EXTRACT-FILE                            02700001
027100          OUTPUT REPORT-FILE.                                     02710014
027300                                                                  02730001
027400*    FORMAT HEADING DATA                                          02740001
027500     MOVE FUNCTION CURRENT-DATE TO PV-CURRENT-DATE.               02750001
027600     MOVE PV-CURRENT-MONTH      TO DP132O-RUN-MONTH.              02760001
027700     MOVE PV-CURRENT-DAY        TO DP132O-RUN-DAY.                02770001
027800     MOVE PV-CURRENT-YEAR       TO DP132O-RUN-YEAR.               02780001
027900                                                                  02790001
028000     ACCEPT PV-CURRENT-TIME FROM TIME.                            02800001
028100     MOVE PV-CURRENT-HOUR       TO DP132O-RUN-HOUR.               02810001
028200     MOVE PV-CURRENT-MINUTE     TO DP132O-RUN-MINUTE.             02820001
028300     MOVE PC-PROGRAM-NAME       TO DP132O-PROGRAM-NAME.           02830001
028400     MOVE 1                     TO DP132O-REPORT-NUMBER.          02840001
028500                                                                  02850001
028600     ACCEPT CONTROL-CARD-ONE.                                     02860001
028700     MOVE CC-BEGIN-DTE          TO H2-BEGIN-DTE.                  02870001
028800     MOVE CC-END-DTE            TO H2-END-DTE.                    02880001
028900                                                                  02890001
029000     ACCEPT CONTROL-CARD-TWO.                                     02900001
029100     MOVE CC-SUBHEADING         TO H3-SUBHEADING.                 02910001
029200                                                                  02920001
029300     PERFORM R100-READ-EXTRACT-FILE.                              02930001
029400     MOVE AP081-DMA-NBR  TO SAVE-DMA-NBR.                         02940001
029500     PERFORM W100-WRITE-HEADINGS.                                 02950001
029600                                                                  02960001
029700******************************************************************02970001
029800*  CREATE REPORT DETAIL LINES FROM INPUT FILE.  FILE CAN CONTAIN  02980001
029900*  2 RECORDS FOR THE SAME VENDOR/DEPT; ONE WITH THE AGREEMENT INFO02990001
030000*  AND THE SECOND WITHOUT.  IN THIS CASE, ONLY THE FIRST RECORD   03000001
030100*  IS PROCESSED.  IF A SECOND RECORD IS FOUND FOR A VENDOR/DEPT,  03010001
030200*  IT IS BYPASSED (ANOTHER READ IS DONE WITHOUT CREATING A LINE). 03020001
030300******************************************************************03030001
030400 B200-CREATE-REPORT.                                              03040001
030500                                                                  03050001
030600     IF SAVE-DMA-NBR = AP081-DMA-NBR                              03060001
030700        CONTINUE                                                  03070001
030800     ELSE                                                         03080001
030900        PERFORM D100-POPULATE-DMA-LINE                            03090001
031000        MOVE AP081-DMA-NBR TO SAVE-DMA-NBR                        03100001
031100        PERFORM W200-WRITE-DMA-HEADER                             03110001
031200     END-IF.                                                      03120001
031300                                                                  03130001
031400     IF  AP081-VENDOR-NBR = SAVE-VND-NBR                          03140001
031500     AND AP081-DEPT-NBR = SAVE-DEPT-NBR                           03150001
031600         CONTINUE                                                 03160001
031700     ELSE                                                         03170001
031710         IF AP081-AGR-AP-TRN-CDE = SPACES                         03171002
031720            MOVE ZERO TO AP081-OTHER-ACTVTY-AMT                   03172001
031730         END-IF                                                   03173001
031800         PERFORM C100-POPULATE-REPORT-RECORD                      03180001
032000         PERFORM W300-WRITE-REPORT-RECORD                         03200001
032100         MOVE AP081-VENDOR-NBR TO SAVE-VND-NBR                    03210001
032200         MOVE AP081-DEPT-NBR TO SAVE-DEPT-NBR                     03220001
032300     END-IF.                                                      03230001
032400                                                                  03240001
032500     PERFORM R100-READ-EXTRACT-FILE.                              03250001
032600                                                                  03260001
032700                                                                  03270001
032800******************************************************************03280001
032900*  CLOSE CURSOR & OUTPUT FILE, DISPLAY END OF RUN MESSAGE.       *03290001
033000******************************************************************03300001
033100 B300-EOJ-ROUTINE.                                                03310001
033200                                                                  03320001
033300     PERFORM D100-POPULATE-DMA-LINE.                              03330001
033400     PERFORM D200-POPULATE-TOTAL-LINE.                            03340001
033500     PERFORM W400-WRITE-EOR.                                      03350001
033600                                                                  03360001
033700     CLOSE ACTIVITY-EXTRACT-FILE                                  03370001
033900           REPORT-FILE.                                           03390001
034000                                                                  03400001
034100     DISPLAY 'RECORDS READ            = ' PV-INPUT-EXTRACT-CNT.   03410001
034300                                                                  03430001
034400******************************************************************03440001
034500*  FORMAT REPORT DETAIL                                           03450001
034600******************************************************************03460001
034700 C100-POPULATE-REPORT-RECORD.                                     03470001
034800                                                                  03480001
034900     MOVE AP081-VENDOR-NAME      TO DL-VENDOR-NAME.               03490009
035000     MOVE AP081-VENDOR-NBR       TO DL-VENDOR-NBR.                03500009
035100     MOVE AP081-DEPT-NBR         TO DL-DEPT-NBR.                  03510009
035400                                                                  03540001
035410     MOVE AP081-GROSS-PURCHS-AMT TO DL-GROSS-AMT.                 03541009
035500     MOVE AP081-OTHER-ACTVTY-AMT TO DL-ACTUAL-TAKEN.              03550009
035600     COMPUTE PV-DISCOUNT-PCT-EXPD = AP081-AGR-DISC-PCT * 100.     03560001
035700     MOVE PV-DISCOUNT-PCT-EXPD   TO DL-DISCOUNT-PCT.              03570009
036300                                                                  03630001
037600     COMPUTE PV-EARNED-ALW-AMT =                                  03760001
037700             AP081-GROSS-PURCHS-AMT * AP081-AGR-DISC-PCT.         03770001
037900                                                                  03790001
038000     MOVE PV-EARNED-ALW-AMT      TO DL-EARNED.                    03800009
038100                                                                  03810001
038200     COMPUTE PV-UNTAKEN-AMT =                                     03820001
038300             PV-EARNED-ALW-AMT - AP081-OTHER-ACTVTY-AMT.          03830004
038400     MOVE PV-UNTAKEN-AMT         TO DL-UNTAKEN-AMT.               03840009
038500                                                                  03850001
038600     ADD AP081-GROSS-PURCHS-AMT  TO DM-GROSS-AMT.                 03860009
039000     ADD PV-EARNED-ALW-AMT       TO DM-EARNED.                    03900009
039100     ADD AP081-OTHER-ACTVTY-AMT  TO DM-ACTUAL-TAKEN.              03910009
039200     ADD PV-UNTAKEN-AMT          TO DM-UNTAKEN-AMT.               03920009
039300                                                                  03930001
039844******************************************************************03984401
039845*  FORMAT DMA DETAIL                                              03984501
039846******************************************************************03984601
039847 D100-POPULATE-DMA-LINE.                                          03984701
039848                                                                  03984801
039849     MOVE SAVE-DMA-NBR     TO DTOT-DMA-NBR.                       03984909
039850     MOVE DM-GROSS-AMT     TO DTOT-GROSS-AMT.                     03985009
039890     MOVE DM-EARNED        TO DTOT-EARNED.                        03989009
039891     MOVE DM-ACTUAL-TAKEN  TO DTOT-ACTUAL-TAKEN.                  03989109
039892     MOVE DM-UNTAKEN-AMT   TO DTOT-UNTAKEN-AMT.                   03989209
039893                                                                  03989301
039894     WRITE REPORT-REC FROM DASH-LINE                              03989401
039895       AFTER ADVANCING +1 LINES.                                  03989501
039896                                                                  03989601
039897     WRITE REPORT-REC FROM DMA-TOTAL-LINE                         03989701
039898       AFTER ADVANCING +1 LINES.                                  03989801
039899                                                                  03989901
039900     ADD +2 TO PV-LINE-COUNT.                                     03990009
039901                                                                  03990101
039902     ADD DM-GROSS-AMT      TO TOT-GROSS-AMT.                      03990209
039906     ADD DM-EARNED         TO TOT-EARNED.                         03990609
039907     ADD DM-ACTUAL-TAKEN   TO TOT-ACTUAL-TAKEN.                   03990709
039908     ADD DM-UNTAKEN-AMT    TO TOT-UNTAKEN-AMT.                    03990809
039909                                                                  03990901
039910     MOVE ZERO TO DM-GROSS-AMT                                    03991009
039914                  DM-EARNED                                       03991409
039915                  DM-ACTUAL-TAKEN                                 03991509
039916                  DM-UNTAKEN-AMT.                                 03991609
039917                                                                  03991701
039922                                                                  03992201
039923******************************************************************03992301
039924*  FORMAT TOTAL LINE                                              03992409
039925******************************************************************03992501
039926 D200-POPULATE-TOTAL-LINE.                                        03992601
039927                                                                  03992701
039928     MOVE TOT-GROSS-AMT    TO TL-GROSS-AMT.                       03992809
039932     MOVE TOT-EARNED       TO TL-EARNED.                          03993209
039933     MOVE TOT-ACTUAL-TAKEN TO TL-ACTUAL-TAKEN.                    03993309
039934     MOVE TOT-UNTAKEN-AMT  TO TL-UNTAKEN-AMT.                     03993409
039935                                                                  03993501
039936     WRITE REPORT-REC FROM GRAND-TOTAL-LINE                       03993601
039937       AFTER ADVANCING +2 LINES.                                  03993701
039938                                                                  03993801
039939     ADD +2 TO PV-LINE-COUNT.                                     03993909
039940                                                                  03994001
039950                                                                  03995001
039960******************************************************************03996001
039970*   READ  INPUT EXTRACT FILE                                     *03997001
039980******************************************************************03998001
039990 R100-READ-EXTRACT-FILE.                                          03999001
040000                                                                  04000001
040100     INITIALIZE AP081-VNDAGR-EXTRACT.                             04010001
040200                                                                  04020001
040300     READ ACTIVITY-EXTRACT-FILE INTO AP081-VNDAGR-EXTRACT         04030001
040400       AT END SET PS-END-OF-EXTRACT TO TRUE.                      04040001
040500                                                                  04050001
040600     IF PS-END-OF-EXTRACT                                         04060001
040700         CONTINUE                                                 04070001
040800     ELSE                                                         04080001
040900         ADD +1 TO PV-INPUT-EXTRACT-CNT                           04090001
041000     END-IF.                                                      04100001
041100                                                                  04110001
041200                                                                  04120001
041300*----------------------------------------------------------------*04130001
041400*    WRITE PAGE HEADING LINES                                    *04140001
041500*----------------------------------------------------------------*04150001
041600 W100-WRITE-HEADINGS.                                             04160001
041700                                                                  04170001
041800     ADD +1             TO PV-PAGE-COUNT.                         04180009
041900     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    04190009
042000                                                                  04200001
042100     WRITE REPORT-REC FROM DP132O-STANDRD-HEADER-132-COLS         04210001
042200       AFTER ADVANCING PAGE.                                      04220001
042300                                                                  04230001
042400     WRITE REPORT-REC FROM HEADING-LINE-1                         04240001
042500       AFTER ADVANCING +1 LINES.                                  04250001
042600                                                                  04260001
042700     WRITE REPORT-REC FROM HEADING-LINE-2                         04270001
042800       AFTER ADVANCING +1 LINES.                                  04280001
042900                                                                  04290001
043000     WRITE REPORT-REC FROM HEADING-LINE-3                         04300001
043100       AFTER ADVANCING +1 LINES.                                  04310001
043200                                                                  04320001
043300     WRITE REPORT-REC FROM HEADING-LINE-4                         04330001
043400       AFTER ADVANCING +2 LINES.                                  04340001
043500                                                                  04350001
043600     WRITE REPORT-REC FROM BLANK-LINE                             04360001
043700       AFTER ADVANCING +1 LINES.                                  04370001
043800                                                                  04380001
043900     MOVE SAVE-DMA-NBR TO DHD-DMA-NBR.                            04390001
044000                                                                  04400001
044100     WRITE REPORT-REC FROM DMA-HEADER-LINE                        04410001
044200       AFTER ADVANCING +1 LINES.                                  04420001
044300                                                                  04430001
044400     WRITE REPORT-REC FROM BLANK-LINE                             04440001
044500       AFTER ADVANCING +1 LINES.                                  04450001
044600                                                                  04460001
044700     MOVE +9 TO PV-LINE-COUNT.                                    04470009
044800                                                                  04480001
044900*----------------------------------------------------------------*04490001
045000*    WRITE DMA HEADER LINE                                       *04500001
045100*----------------------------------------------------------------*04510001
045200 W200-WRITE-DMA-HEADER.                                           04520001
045300                                                                  04530001
045400     IF (PV-LINE-COUNT + 4) > PC-LINES-PER-PAGE-MAX               04540001
045500         PERFORM W100-WRITE-HEADINGS                              04550001
045700     ELSE                                                         04570009
045800         MOVE SAVE-DMA-NBR TO DHD-DMA-NBR                         04580009
046000         WRITE REPORT-REC FROM DMA-HEADER-LINE                    04600009
046100           AFTER ADVANCING +2 LINES                               04610009
046300         WRITE REPORT-REC FROM BLANK-LINE                         04630009
046400           AFTER ADVANCING +1 LINES                               04640009
046600         ADD +3 TO PV-LINE-COUNT                                  04660009
046610     END-IF.                                                      04661009
046700                                                                  04670001
046800******************************************************************04680001
046900*  WRITE OUT REPORT DETAIL LINE                                  *04690001
047000******************************************************************04700001
047100 W300-WRITE-REPORT-RECORD.                                        04710001
047200                                                                  04720001
047210     IF (PV-LINE-COUNT + 3) > PC-LINES-PER-PAGE-MAX               04721009
047220         PERFORM W100-WRITE-HEADINGS                              04722009
047230     END-IF.                                                      04723009
047240                                                                  04724009
047700     WRITE REPORT-REC FROM DETAIL-LINE                            04770001
047800       AFTER ADVANCING +1 LINES.                                  04780001
047900                                                                  04790001
048000     ADD +1 TO PV-LINE-COUNT.                                     04800009
048100                                                                  04810001
048200     INITIALIZE DETAIL-LINE.                                      04820001
048300                                                                  04830001
048400                                                                  04840001
048500*----------------------------------------------------------------*04850001
048600*    WRITE END OF REPORT LINE                                    *04860001
048700*----------------------------------------------------------------*04870001
048800 W400-WRITE-EOR.                                                  04880001
048900                                                                  04890001
049000     IF (PV-LINE-COUNT + 3) > PC-LINES-PER-PAGE-MAX               04900001
049100         MOVE SPACES TO DMA-HEADER-LINE                           04910001
049200                        SAVE-DMA-NBR                              04920001
049300         PERFORM W100-WRITE-HEADINGS                              04930001
049400     END-IF.                                                      04940001
049500                                                                  04950001
049600     WRITE REPORT-REC FROM END-OF-REPORT                          04960001
049700       AFTER ADVANCING +3 LINES.                                  04970001
049800                                                                  04980001
