000400******************************************************************00040001
000500 IDENTIFICATION DIVISION.                                         00050001
000600******************************************************************00060001
000700                                                                  00070001
000800 PROGRAM-ID.             PCKUP024.                                00080001
000900 AUTHOR.                 DENISE HAHN.                             00090001
001000 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00100001
001100 DATE-WRITTEN            FEBRUARY, 2024.                          00110001
001200 DATE-COMPILED.                                                   00120001
001300                                                                  00130001
001400*----------------------------------------------------------------*00140001
001500* THIS PROGRAM WILL READ AN INPUT FILE (PCRD086) CONTAINING       00150001
001600* PICKMADE EVENTS AND UPDATE UNITS WORKED.                        00160001
001700*                                                                 00170001
001800*  INPUT FILE IS SUMMARIZED BY OPER-PO-RCVR-PROCESS AREA          00180001
001900*                                                                 00190001
002000*  INPUT FILE WAS CREATED BY PCKUT120-PCKUT124.                   00200001
002600*----------------------------------------------------------------*00260001
002610* PCT00005 - PCT_SUM_WRKD                                        *00261015
002611*            FOR GIVEN BUSINESS DATE/OPER/SHIFT/PROCES AREA      *00261115
002612*            TOTALS - UNITS WORKED                               *00261215
002613*                     CARTONS (FOR P2L IS 0)                     *00261315
002614*                     # OF PO/RCVRS UNIQUE WORKED                *00261415
002615*                     EXTENDED RETAIL WORKED AMOUNT              *00261515
002616*                                                                *00261615
002617* PCT00007 - PCT_RCVR_LNE_DTL                                    *00261715
002618* - READ INPUT FILE                                              *00261815
002619* - CHECK IF PO/RCVR/LINE (P/Q) IS ALREADY ON DATABASE           *00261915
002620*   PCT_RCVR_LNE_DTL                                             *00262015
002621*   7000-CHECK-ALREADY-EXIST                                     *00262115
002622*   IF ALREADY THERE - SET 'Q'                                   *00262215
002623*   IF NOT ALREADY THERE - SET 'P'                               *00262315
002624* - CHECK IF WORK HAS ALREADY STARTED                            *00262415
002625*   PO/RCVR/BUS-DTE/SHIFT/PROCESS AREA                           *00262515
002626*   PCT_RCVR_LNE_DTL                                             *00262615
002627*   7005-CHECK-IF-WORK-STARTED                                   *00262715
002628*   IF ALREADY STARTED - # OF NEW RECEIVER IS 0                  *00262815
002629*  IF NOT ALREADY STARTED - # NEW RECEIVER = 1                   *00262915
002630*                                                                *00263015
002631*- INSERT UNITS WORKED - PCT_RCVR_LNE_DTL                        *00263115
002632*  7010-INSERT-UNIT-WORK                                         *00263215
002633*                                                                *00263315
002634*- UPDATE PCT_SUM_WRKD                                           *00263415
002635*  SO THE UPDATE FIRST SINCE THERE WILL MORE UPDATES             *00263515
002636*  THEN INSERTS.                                                 *00263615
002637*  INCREMENT THE 4 TOTAL COLUMNS ON THE TABLE                    *00263715
002638*  7015-UPDATE-SUM-WORKED                                        *00263815
002639*  IF THE UPDATE RETURNS +100                                    *00263915
002640*  INSERT PCT_SUM_WRKD                                           *00264015
002641*  7020-INSERT-SUM-WORKED                                        *00264115
002642*                                                                 00264244
002643* CHECKPOINT RESTART DB2 TABLES USED IN THE MODULES               00264344
002644*     - MODULES DPKUT900/DPKUT901                                 00264444
002645*     - TCKRSTINF                                                 00264544
002646*     - TCKRSTCNTL                                                00264644
002647*                                                                 00264750
002648* NOTE OPEN/CLOSE OF THE INPUT FILE IS CONTROLLED IN THE          00264850
002649* CHECKPOINT MODULE.  SO THE OPEN/CLOSE ARE COMMENTED OUT.        00264950
002670*----------------------------------------------------------------*00267015
002700                                                                  00270001
002800*----------------------------------------------------------------*00280001
002900 ENVIRONMENT DIVISION.                                            00290001
003000*----------------------------------------------------------------*00300001
003100 INPUT-OUTPUT SECTION.                                            00310001
003200                                                                  00320001
003300                                                                  00330001
003400 FILE-CONTROL.                                                    00340001
003500     SELECT PICKMADE-EXTRACT-IN      ASSIGN TO INP01.             00350001
003600                                                                  00360001
003800                                                                  00380001
003900                                                                  00390001
004000*----------------------------------------------------------------*00400001
004100 DATA DIVISION.                                                   00410001
004200*----------------------------------------------------------------*00420001
004300 FILE SECTION.                                                    00430001
004400                                                                  00440001
004500                                                                  00450001
004600 FD  PICKMADE-EXTRACT-IN                                          00460001
004700     RECORDING MODE IS F                                          00470001
004800     LABEL RECORDS ARE STANDARD                                   00480001
004900     BLOCK CONTAINS 0 RECORDS.                                    00490001
005000                                                                  00500001
005100 01  PICKMADE-RECORD-IN               PIC X(300).                 00510001
005200                                                                  00520001
006000                                                                  00600001
006100*----------------------------------------------------------------*00610001
006200 WORKING-STORAGE SECTION.                                         00620001
006300                                                                  00630001
006400 01  PS-PROGRAM-SWITCHES.                                         00640001
006500     05  PS-END-OF-INPUT-SW       PIC X(01)   VALUE 'N'.          00650001
006600         88  PS-EOF-INPUT-FILE                VALUE 'Y'.          00660001
006700         88  PS-NOT-EOF-INPUT-FILE            VALUE 'N'.          00670001
006710     05  PS-UNIT-WORK-STARTED-SW  PIC X(01)   VALUE 'N'.          00671006
006720         88  PS-UNIT-WORK-STARTED             VALUE 'Y'.          00672006
006730         88  PS-UNIT-WORK-STARTED-NO          VALUE 'N'.          00673006
006740     05  PS-ERROR-SW              PIC X(01)   VALUE 'N'.          00674006
006750         88  PS-ERROR                         VALUE 'Y'.          00675006
006760         88  PS-ERROR-NO                      VALUE 'N'.          00676006
006800                                                                  00680001
006900 01  PV-PROGRAM-VARIABLES.                                        00690001
007000                                                                  00700001
007100     05  PV-READ-COUNT                PIC S9(09) VALUE ZERO       00710001
007200                                                  COMP SYNC.      00720001
007300     05  PV-WRITE-COUNT               PIC S9(09) VALUE ZERO       00730001
007400                                                  COMP SYNC.      00740001
007500     05  PV-Q-COUNT                   PIC S9(09) VALUE ZERO       00750002
007510                                                  COMP SYNC.      00751002
007520     05  PV-P-COUNT                   PIC S9(09) VALUE ZERO       00752002
007530                                                  COMP SYNC.      00753002
007600     05  PV-DISP-CNT                  PIC ZZZ,ZZZ,ZZ9.            00760001
007700                                                                  00770001
007800     05  PV-DISP-OPER                 PIC 9999-.                  00780002
007900     05  PV-DISP-PO                   PIC 9(8).                   00790023
008000     05  PV-DISP-RCVR                 PIC 9(4).                   00800023
008100     05  PV-DISP-LINE                 PIC 9(4).                   00810023
008200     05  PV-DISP-SHIFT                PIC 9(4).                   00820023
008300     05  PV-DISP-REC-CNT              PIC Z(8)9.                  00830006
008310     05  PV-ACTN-CDE                  PIC X(01).                  00831002
008320     05  PV-SQLCODE                   PIC -999.                   00832006
008330     05  PV-SUM-UNIT-QTY              PIC S9(09) VALUE +0         00833006
008340                                                    COMP.         00834044
008350     05  PV-PO-NBR                   PIC S9(09)     COMP.         00835044
008370     05  PV-RCVR-WRKD-QTY            PIC S9(09)  VALUE +0         00837044
008380                                                    COMP.         00838044
008390     05  PV-PICKED-QTY               PIC S9(09)     COMP.         00839044
008391     05  PV-EXTD-RTL-AMT             PIC S9(9)V9(2) COMP-3.       00839117
008392                                                                  00839208
008393                                                                  00839337
008394*-----------------------------------------------------------------00839437
008395* CHECKPOINT FIELDS - BEGIN                                       00839537
008396*-----------------------------------------------------------------00839637
008421     05  PV-TIME                     PIC  X(08)    VALUE SPACES.  00842138
008422     05  PV-DISP-CONTROL             PIC S9(09)    COMP-3         00842238
008423                                                   VALUE ZERO.    00842338
008427     05  PC-OPEN-FUNC                PIC  X(05)    VALUE 'OPEN '. 00842744
008428     05  PC-TRANS-FUNC               PIC  X(05)    VALUE 'TRANS'. 00842844
008429     05  PC-CLOSE-FUNC               PIC  X(05)    VALUE 'CLOSE'. 00842944
008430     05  PC-RSTRT-FUNC               PIC  X(05)    VALUE 'RSTRT'. 00843044
008431     05  PC-CKPT-JOB-NAME            PIC  X(08)  VALUE 'PCK004'.  00843144
008432     05  PC-CKPT-PLAN-NAME           PIC  X(08)  VALUE 'PCKUP024'.00843244
008433*-----------------------------------------------------------------00843337
008434* CHECKPOINT FIELDS - END                                         00843437
008435*-----------------------------------------------------------------00843537
008436                                                                  00843637
008437                                                                  00843737
008440                                                                  00844001
008500 01 PC-PROGRAM-CONSTANTS.                                         00850001
008800     05 PC-PROGRAM-NAME              PIC X(08)  VALUE 'PCKUP024'. 00880001
008810     05 PC-P                         PIC X(01)  VALUE 'P'.        00881006
008820     05 PC-Q                         PIC X(01)  VALUE 'Q'.        00882006
008900                                                                  00890001
009000                                                                  00900001
009100 01  DK-DB2-KEYS.                                                 00910001
009310     05  DK-OPER-UNT-ID             PIC S9(04)  COMP.             00931007
009311     05  DK-PO-NBR                  PIC S9(09)  COMP.             00931107
009320     05  DK-RCVR-SEQ-NBR            PIC S9(09)  COMP.             00932001
009321     05  DK-LINE-NBR                PIC S9(09)  COMP.             00932103
009330     05  DK-BUS-DTE                 PIC  X(10).                   00933002
009340     05  DK-SHIFT-NBR               PIC S9(04)  COMP.             00934002
009350     05  DK-PRCG-AREA-CDE           PIC  X(06).                   00935002
009400                                                                  00940001
009500 01  PV-ABEND-CODE                    PIC S9(04)   VALUE ZERO.    00950006
009510                                                                  00951006
009600 01  PV-ABEND-FIELDS.                                             00960006
009700     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'PCKUP024'.00970006
009800     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    00980006
009900     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    00990006
010000     05  PV-ABEND-STRUCTURE-1         PIC X(15)  VALUE SPACES.    01000006
010100     05  PV-ABEND-STRUCTURE-2         PIC X(15)  VALUE SPACES.    01010006
010200     05  PV-ABEND-STRUCTURE-3         PIC X(15)  VALUE SPACES.    01020006
010300     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    01030006
010310     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01031006
010320     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01032006
010330     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01033006
010340     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01034006
010400                                                                  01040001
010410                                                                  01041036
010411*----------------------------------------------------------------*01041136
010412* CHECKPOINT RESTART                                              01041236
010420* TRANSACTION PRESENTATION MODULE PARAMETERS                      01042036
010421*----------------------------------------------------------------*01042136
010422 01  ABEND-CODE                       PIC S9(04)     VALUE +0     01042240
010423                                                     COMP SYNC.   01042340
010424     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 01042440
010425     88  ABEND-4002-READ-ERROR                       VALUE +4002. 01042540
010426     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 01042640
010427     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 01042740
010428     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 01042840
010429     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 01042940
010430     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 01043040
010431     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 01043140
010432     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 01043240
010433     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 01043340
010434                                                                  01043440
010435     COPY DPWS991.                                                01043536
010440                                                                  01044036
010450     COPY DPLS001.                                                01045036
010460         05  WORK-STRG-AREA          PIC X(150).                  01046036
010470                                                                  01047036
010480                                                                  01048036
010500                                                                  01050001
010600*----------------------------------------------------------------*01060001
010700* INPUT/OUTPUT RECORD LAYOUT                                      01070001
010800*----------------------------------------------------------------*01080001
010900     COPY PCRD086.                                                01090001
011000                                                                  01100001
011600*----------------------------------------------------------------*01160001
011700*    ABEND PROCESSING COPYBOOK.                                  *01170001
011800*----------------------------------------------------------------*01180001
011900     COPY DPWS013.                                                01190001
012000                                                                  01200001
012100*----------------------------------------------------------------*01210001
012200*  UNITS WORKED TABLE - PCT_SUM_WRKD                              01220005
012300*----------------------------------------------------------------*01230001
012400     EXEC SQL                                                     01240001
012500          INCLUDE PCT00005                                        01250005
012600     END-EXEC.                                                    01260001
012700                                                                  01270001
012710*----------------------------------------------------------------*01271005
012720*  UNITS WORKED TABLE - PCT_RCVR_LNE_DTL                          01272005
012730*        THE PRIMARY KEY                                          01273005
012740*            PO_NBR                                               01274005
012750*           ,RCVR_SEQ_NBR                                         01275005
012760*           ,PO_LNE_NBR                                           01276005
012770*           ,ACTN_CDE                                             01277005
012780*           ,WRKD_UNT_TMST                                        01278005
012790*----------------------------------------------------------------*01279005
012791     EXEC SQL                                                     01279105
012792          INCLUDE PCT00007                                        01279205
012793     END-EXEC.                                                    01279305
012794                                                                  01279405
012795*-----------------------------------------------------------------01279506
012796*  USED FOR DB2 ERROR MESSAGE BUILDING                            01279606
012797*-----------------------------------------------------------------01279706
012798     COPY DPWS004.                                                01279806
012799                                                                  01279906
012800                                                                  01280036
012820*----------------------------------------------------------------*01282041
012900*  COMMUNICATIONS AREA FOR DB2                                    01290001
013000*----------------------------------------------------------------*01300001
013100     EXEC SQL                                                     01310001
013200          INCLUDE SQLCA                                           01320001
013300     END-EXEC.                                                    01330001
013400                                                                  01340001
013401*----------------------------------------------------------------*01340144
013402*  COMMUNICATIONS AREA2 - FOR CHECKPOINT RESTART                  01340244
013403*----------------------------------------------------------------*01340344
013410     COPY SQLCA2.                                                 01341042
013440                                                                  01344041
013500*----------------------------------------------------------------*01350001
013600 PROCEDURE DIVISION.                                              01360001
013700*----------------------------------------------------------------*01370001
013800                                                                  01380001
013900*----------------------------------------------------------------*01390001
014000 0000-MAINLINE.                                                   01400001
014100*----------------------------------------------------------------*01410001
014200     DISPLAY '************************'.                          01420001
014300     DISPLAY '***     PCKUP024     ***'.                          01430001
014400     DISPLAY '************************'.                          01440001
014500     DISPLAY ' '.                                                 01450001
014600                                                                  01460001
014700     PERFORM 1000-INITIALIZE.                                     01470001
014800                                                                  01480001
014900     PERFORM 2000-PROCESS-INPUT-FILE                              01490001
015000         UNTIL PS-EOF-INPUT-FILE.                                 01500001
015100                                                                  01510001
015101*-----------------------------------------------------------------01510150
015102* CHECKPOINT - BEGIN                                              01510250
015103*-----------------------------------------------------------------01510350
015110     MOVE PC-CLOSE-FUNC               TO DP001-FUNC-CODE.         01511049
015120     PERFORM 7100-READ-INPUT-FILE.                                01512049
015130*-----------------------------------------------------------------01513050
015140* CHECKPOINT - END                                                01514050
015150*-----------------------------------------------------------------01515050
015200                                                                  01520001
015300     DISPLAY ' '.                                                 01530001
015400     MOVE PV-READ-COUNT TO PV-DISP-CNT.                           01540001
015500     DISPLAY 'TOTAL RECORDS READ          '    PV-DISP-CNT.       01550002
015600                                                                  01560001
015610     DISPLAY ' '.                                                 01561002
015620     MOVE PV-P-COUNT     TO PV-DISP-CNT.                          01562002
015630     DISPLAY 'TOTAL INITIAL UNIT RECORDS  '    PV-DISP-CNT.       01563002
015640     DISPLAY ' '.                                                 01564002
015641                                                                  01564102
015650     MOVE PV-Q-COUNT     TO PV-DISP-CNT.                          01565002
015660     DISPLAY 'TOTAL ADDITIONAL UNITS      '    PV-DISP-CNT.       01566002
015670     DISPLAY ' '.                                                 01567002
015680                                                                  01568002
016200**** CLOSE PICKMADE-EXTRACT-IN.                                   01620048
016400                                                                  01640001
016500     GOBACK.                                                      01650001
016600                                                                  01660001
016700                                                                  01670001
016800*----------------------------------------------------------------*01680001
016900 1000-INITIALIZE.                                                 01690001
017000*----------------------------------------------------------------*01700001
017040                                                                  01704027
017041*                                                                 01704136
017042*** CHECKPOINT BEGIN                                              01704236
017043*                                                                 01704336
017050     ACCEPT PC-CKPT-JOB-NAME FROM SYSIN.                          01705044
017060     MOVE PC-OPEN-FUNC           TO DP001-FUNC-CODE.              01706036
017061*                                                                 01706136
017062*** CHECKPOINT END                                                01706236
017063*                                                                 01706336
017070                                                                  01707036
017100     SET PS-NOT-EOF-INPUT-FILE TO TRUE.                           01710001
017200                                                                  01720001
017300*****OPEN INPUT  PICKMADE-EXTRACT-IN.                             01730048
017500                                                                  01750001
017900     PERFORM 7100-READ-INPUT-FILE.                                01790001
018000                                                                  01800001
018001*                                                                 01800136
018002*** CHECKPOINT BEGIN                                              01800236
018003*                                                                 01800336
018020     MOVE PC-TRANS-FUNC          TO DP001-FUNC-CODE.              01802036
018021*                                                                 01802136
018022*** CHECKPOINT END                                                01802236
018023*                                                                 01802336
018030                                                                  01803036
018100     IF PS-EOF-INPUT-FILE                                         01810001
018200         DISPLAY '** INPUT FILE IS EMPTY **'                      01820001
018300     END-IF.                                                      01830001
018400                                                                  01840001
018500                                                                  01850001
018600*----------------------------------------------------------------*01860001
018700 2000-PROCESS-INPUT-FILE.                                         01870001
018800*----------------------------------------------------------------*01880001
018840                                                                  01884027
018900     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       01890001
019000                                                                  01900001
019300     MOVE PC086-ORD-NBR         TO PCT00007-PO-NBR                01930002
019301                                   DK-PO-NBR.                     01930102
019310     MOVE PC086-RCVR-SEQ-NBR    TO PCT00007-RCVR-SEQ-NBR          01931002
019311                                   DK-RCVR-SEQ-NBR.               01931102
019320     MOVE PC086-ORD-LNE-NBR     TO PCT00007-PO-LNE-NBR            01932002
019330                                   DK-LINE-NBR.                   01933003
019350     MOVE PC086-BUS-DTE         TO PCT00007-BUS-DTE               01935002
019351                                   PCT00005-BUS-DTE               01935106
019352                                   DK-BUS-DTE.                    01935206
019360     MOVE PC086-OPER-UNT-ID     TO PCT00007-OPER-UNT-ID           01936009
019361                                   PCT00005-OPER-UNT-ID.          01936106
019370     MOVE PC086-SHFT-NBR        TO PCT00007-SHFT-NBR              01937002
019371                                   PCT00005-SHFT-NBR              01937106
019372                                   DK-SHIFT-NBR.                  01937206
019380     MOVE PC086-PICKED-QTY      TO PCT00007-UNT-QTY.              01938002
019390     MOVE 0                     TO PCT00007-CART-QTY              01939011
019391                                   PCT00005-CART-WRKD-QTY.        01939113
019392     MOVE PC086-PRCG-AREA-CDE   TO PCT00007-PRCG-AREA-CDE         01939206
019393                                   PCT00005-PRCG-AREA-CDE         01939306
019394                                   DK-PRCG-AREA-CDE.              01939406
019395     MOVE PC086-EXTD-RTL-AMT    TO PCT00007-EXTD-RTL-AMT.         01939506
019396                                                                  01939606
019397     SET PS-UNIT-WORK-STARTED-NO  TO TRUE.                        01939712
019398                                                                  01939806
019399     PERFORM 7000-CHECK-ALREADY-EXIST.                            01939906
019400     PERFORM 7005-CHECK-IF-WORK-STARTED.                          01940013
019401                                                                  01940106
019407     PERFORM 7010-INSERT-UNIT-WORK.                               01940704
019408                                                                  01940806
019409     IF  PS-UNIT-WORK-STARTED                                     01940906
019410         MOVE 0                TO PV-RCVR-WRKD-QTY                01941006
019411     ELSE                                                         01941106
019412         MOVE 1                TO PV-RCVR-WRKD-QTY                01941235
019413     END-IF.                                                      01941306
019414                                                                  01941406
019420     PERFORM 7015-UPDATE-SUM-WORKED.                              01942006
019500                                                                  01950001
019598*                                                                 01959802
021200                                                                  02120001
021300     PERFORM 7100-READ-INPUT-FILE.                                02130001
021400                                                                  02140001
028100*-----------------------------------------------------------------02810001
028200*  CHECK IF ROW ALREADY EXISTS FOR THE PO-RCVR-LINE               02820002
028300*-----------------------------------------------------------------02830001
028400 7000-CHECK-ALREADY-EXIST.                                        02840002
028404                                                                  02840429
028410     MOVE PC086-ORD-NBR             TO DK-PO-NBR                  02841029
028420     MOVE PC086-RCVR-SEQ-NBR        TO DK-RCVR-SEQ-NBR            02842029
028421     MOVE PC086-ORD-LNE-NBR         TO DK-LINE-NBR                02842129
028422                                                                  02842229
028431*            PV-DISP-LINE '-'.                                    02843133
028500     EXEC SQL                                                     02850002
028600          SELECT SUM(UNT_QTY)                                     02860006
028700           INTO  :PV-SUM-UNIT-QTY                                 02870006
028800            FROM PCT_RCVR_LNE_DTL                                 02880002
028900           WHERE PO_NBR              = :DK-PO-NBR                 02890002
029000             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           02900002
029010             AND PO_LNE_NBR          = :DK-LINE-NBR               02901002
029100             AND ACTN_CDE           IN (:PC-P, :PC-Q)             02910006
029320            WITH UR                                               02932006
029400     END-EXEC.                                                    02940002
029500                                                                  02950002
029600     EVALUATE TRUE                                                02960002
029700         WHEN SQLCODE = ZERO                                      02970002
029800         WHEN SQLCODE = -811                                      02980031
029902              MOVE 'Q'          TO PCT00007-ACTN-CDE              02990206
029903              ADD 1             TO PV-Q-COUNT                     02990306
029910                                                                  02991002
030000         WHEN SQLCODE = -305                                      03000006
030010         WHEN SQLCODE = +100                                      03001006
030020              MOVE 'P'          TO PCT00007-ACTN-CDE              03002006
030030              ADD 1             TO PV-P-COUNT                     03003006
030040              MOVE ZEROES       TO PV-SUM-UNIT-QTY                03004006
030110                                                                  03011002
030200         WHEN SQLWARN0 NOT = SPACES                               03020002
030210         WHEN SQLCODE NOT EQUAL ZERO                              03021002
030230             MOVE DK-PO-NBR          TO PV-DISP-PO                03023024
030240             MOVE DK-RCVR-SEQ-NBR    TO PV-DISP-RCVR              03024026
030250             MOVE DK-LINE-NBR        TO PV-DISP-LINE              03025024
030260             SET PS-ERROR               TO TRUE                   03026002
030270             DISPLAY ' 7000- '                                    03027024
030290                     PV-DISP-PO   '-'                             03029002
030300                     PV-DISP-RCVR '-'                             03030002
030310                     PV-DISP-LINE '-'                             03031002
030312             MOVE '7000-CHECK-ALREADY-EXIST'                      03031202
030313                                       TO PV-ABEND-PARAGRAPH      03031302
030314             MOVE 'CHECK UNITS WORKED EXISTS'                     03031402
030315                                       TO PV-ABEND-OPERATION      03031502
030316             MOVE 'PCT_RCVR_LNE_DTL'   TO PV-ABEND-STRUCTURE-1    03031602
030318             PERFORM 9900-DB2-ABEND                               03031802
030319     END-EVALUATE.                                                03031902
030321                                                                  03032101
030322                                                                  03032202
030323*-----------------------------------------------------------------03032306
030324*  CHECK IF WORK HAS ALREADY STARTED - PO-RCVR-DATE-SHFT-AREA     03032406
030325*-----------------------------------------------------------------03032506
030326 7005-CHECK-IF-WORK-STARTED.                                      03032606
030330                                                                  03033027
030331     MOVE PC086-ORD-NBR        TO  DK-PO-NBR.                     03033129
030332     MOVE PC086-RCVR-SEQ-NBR   TO  DK-RCVR-SEQ-NBR.               03033229
030333     MOVE PC086-BUS-DTE        TO  DK-BUS-DTE.                    03033329
030334     MOVE PC086-SHFT-NBR       TO  DK-SHIFT-NBR.                  03033429
030335     MOVE PC086-PRCG-AREA-CDE  TO  DK-PRCG-AREA-CDE.              03033529
030336                                                                  03033633
030351     EXEC SQL                                                     03035129
030352          SELECT PO_NBR                                           03035229
030353           INTO  :PV-PO-NBR                                       03035329
030354            FROM PCT_RCVR_LNE_DTL                                 03035429
030355           WHERE PO_NBR              = :DK-PO-NBR                 03035529
030356             AND RCVR_SEQ_NBR        = :DK-RCVR-SEQ-NBR           03035629
030357             AND BUS_DTE             = :DK-BUS-DTE                03035729
030358             AND SHFT_NBR            = :DK-SHIFT-NBR              03035829
030359             AND PRCG_AREA_CDE       = :DK-PRCG-AREA-CDE          03035929
030360            WITH UR                                               03036029
030361     END-EXEC.                                                    03036129
030362                                                                  03036229
030363     EVALUATE TRUE                                                03036329
030364         WHEN SQLCODE = ZERO                                      03036429
030365         WHEN SQLCODE = -811                                      03036532
030366             SET PS-UNIT-WORK-STARTED     TO TRUE                 03036632
030367                                                                  03036732
030368         WHEN SQLCODE = +100                                      03036832
030369             SET PS-UNIT-WORK-STARTED-NO  TO TRUE                 03036932
030370                                                                  03037032
030371         WHEN SQLWARN0 NOT = SPACES                               03037132
030372         WHEN SQLCODE NOT EQUAL ZERO                              03037232
030373             MOVE DK-PO-NBR          TO PV-DISP-PO                03037332
030374             MOVE DK-RCVR-SEQ-NBR    TO PV-DISP-RCVR              03037432
030375             MOVE DK-SHIFT-NBR       TO PV-DISP-SHIFT             03037532
030376             SET PS-ERROR               TO TRUE                   03037632
030377             DISPLAY ' 7005-'                                     03037732
030378                     PV-DISP-PO   '-'                             03037832
030379                     PV-DISP-RCVR '-'                             03037932
030380                     '  DATE:'    DK-BUS-DTE                      03038032
030381                     ' SHIFT:'    PV-DISP-SHIFT                   03038132
030382                     '  AREA:'    DK-PRCG-AREA-CDE                03038232
030383             MOVE '7005-CHECK-IF-WORK-STARTED'                    03038332
030384                                       TO PV-ABEND-PARAGRAPH      03038432
030385             MOVE 'CHECK UNITS WORKED EXISTS'                     03038532
030386                                       TO PV-ABEND-OPERATION      03038632
030387             MOVE 'PCT_RCVR_LNE_DTL'   TO PV-ABEND-STRUCTURE-1    03038732
030388             PERFORM 9900-DB2-ABEND                               03038832
030389     END-EVALUATE.                                                03038932
030390                                                                  03039032
030391                                                                  03039132
030392*-----------------------------------------------------------------03039232
030393*                                                                 03039332
030394*-----------------------------------------------------------------03039432
030395 7010-INSERT-UNIT-WORK.                                           03039532
030414                                                                  03041429
030415     EXEC SQL                                                     03041529
030416        INSERT INTO PCT_RCVR_LNE_DTL                              03041629
030417               (PO_NBR                                            03041729
030418             ,  RCVR_SEQ_NBR                                      03041829
030419             ,  PO_LNE_NBR                                        03041929
030420             ,  ACTN_CDE                                          03042029
030421             ,  WRKD_UNT_TMST                                     03042129
030422             ,  BUS_DTE                                           03042229
030423             ,  OPER_UNT_ID                                       03042329
030424             ,  SHFT_NBR                                          03042429
030425             ,  UNT_QTY                                           03042529
030426             ,  CART_QTY                                          03042629
030427             ,  PRCG_AREA_CDE                                     03042729
030428             ,  EXTD_RTL_AMT)                                     03042829
030429        VALUES (:PCT00007-PO-NBR                                  03042929
030430             ,  :PCT00007-RCVR-SEQ-NBR                            03043029
030431             ,  :PCT00007-PO-LNE-NBR                              03043129
030432             ,  :PCT00007-ACTN-CDE                                03043229
030433             ,  CURRENT TIMESTAMP                                 03043329
030434             ,  :PCT00007-BUS-DTE                                 03043429
030435             ,  :PCT00007-OPER-UNT-ID                             03043529
030436             ,  :PCT00007-SHFT-NBR                                03043629
030437             ,  :PCT00007-UNT-QTY                                 03043729
030438             ,  :PCT00007-CART-QTY                                03043829
030439             ,  :PCT00007-PRCG-AREA-CDE                           03043929
030440             ,  :PCT00007-EXTD-RTL-AMT)                           03044029
030441     END-EXEC.                                                    03044129
030442                                                                  03044229
030443     EVALUATE TRUE                                                03044329
030444         WHEN SQLCODE = ZERO                                      03044429
030445             CONTINUE                                             03044529
030446         WHEN SQLWARN0 NOT = SPACES                               03044629
030447         WHEN SQLCODE NOT EQUAL ZERO                              03044729
030448             MOVE PCT00007-OPER-UNT-ID  TO PV-DISP-OPER           03044829
030449             MOVE PCT00007-PO-NBR       TO PV-DISP-PO             03044929
030450             MOVE PCT00007-RCVR-SEQ-NBR TO PV-DISP-RCVR           03045029
030451             MOVE PCT00007-PO-LNE-NBR   TO PV-DISP-LINE           03045129
030452             MOVE PCT00007-SHFT-NBR     TO PV-DISP-SHIFT          03045229
030453             SET PS-ERROR               TO TRUE                   03045329
030454             DISPLAY ' 7010-'                                     03045429
030455                     PV-DISP-OPER '-'                             03045529
030456                     PV-DISP-PO   '-'                             03045629
030457                     PV-DISP-RCVR '-'                             03045729
030458                     PV-DISP-LINE '-'                             03045829
030459                     '  DATE:'    PCT00007-BUS-DTE                03045929
030460                     '  ACTN:'    PCT00007-ACTN-CDE               03046029
030461                     '  AREA:'    PCT00007-PRCG-AREA-CDE          03046129
030462             MOVE '7010-INSERT-UNIT-WORK   '                      03046229
030463                                       TO PV-ABEND-PARAGRAPH      03046329
030464             MOVE 'INSERT PCT_RCVR_LNE_DTL  '                     03046429
030465                                       TO PV-ABEND-OPERATION      03046529
030466             MOVE 'PCT_RCVR_LNE_DTL'   TO PV-ABEND-STRUCTURE-1    03046629
030467             PERFORM 9900-DB2-ABEND                               03046729
030468     END-EVALUATE.                                                03046829
030469                                                                  03046929
030470                                                                  03047029
030471*-----------------------------------------------------------------03047129
030472*                                                                 03047229
030473*-----------------------------------------------------------------03047329
030474 7015-UPDATE-SUM-WORKED.                                          03047429
030479                                                                  03047929
030480     MOVE  PC086-BUS-DTE        TO  DK-BUS-DTE                    03048029
030481     MOVE  PC086-OPER-UNT-ID    TO  DK-OPER-UNT-ID                03048129
030482     MOVE  PC086-SHFT-NBR       TO  DK-SHIFT-NBR                  03048229
030483     MOVE  PC086-PRCG-AREA-CDE  TO  DK-PRCG-AREA-CDE              03048329
030484                                                                  03048429
030485     MOVE  PC086-PICKED-QTY     TO  PV-PICKED-QTY                 03048529
030486     MOVE  PC086-EXTD-RTL-AMT   TO  PV-EXTD-RTL-AMT               03048629
030487                                                                  03048729
030488     EXEC SQL                                                     03048829
030489          UPDATE PCT_SUM_WRKD                                     03048929
030490          SET    PO_RCVR_WRKD_QTY = PO_RCVR_WRKD_QTY +            03049029
030491                                    :PV-RCVR-WRKD-QTY             03049129
030492               , UNT_WRKD_QTY     = UNT_WRKD_QTY +                03049229
030493                                    :PV-PICKED-QTY                03049329
030494               , EXTD_RTL_WRKD_AMT = EXTD_RTL_WRKD_AMT +          03049429
030495                                     :PV-EXTD-RTL-AMT             03049529
030496          WHERE  BUS_DTE          = :DK-BUS-DTE                   03049629
030497            AND  OPER_UNT_ID      = :DK-OPER-UNT-ID               03049729
030498            AND  SHFT_NBR         = :DK-SHIFT-NBR                 03049829
030499            AND  PRCG_AREA_CDE    = :DK-PRCG-AREA-CDE             03049929
030500     END-EXEC.                                                    03050029
030501                                                                  03050129
030502     EVALUATE TRUE                                                03050229
030503         WHEN SQLCODE = ZERO                                      03050329
030504             CONTINUE                                             03050429
030505         WHEN SQLCODE = +100                                      03050529
030506             MOVE DK-OPER-UNT-ID     TO PV-DISP-OPER              03050629
030507             MOVE DK-SHIFT-NBR       TO PV-DISP-SHIFT             03050729
030508             SET PS-ERROR               TO TRUE                   03050829
030509*            DISPLAY ' 7015- '                                    03050934
030510*                    ' BUS-DTE:' DK-BUS-DTE                       03051034
030511*                    '    OPER:' PV-DISP-OPER                     03051134
030512*                    '   SHIFT:' PV-DISP-SHIFT                    03051234
030513*                    '    AREA:' DK-PRCG-AREA-CDE                 03051334
030514             PERFORM 7020-INSERT-SUM-WORKED                       03051429
030515         WHEN SQLWARN0 NOT = SPACES                               03051529
030516         WHEN SQLCODE NOT EQUAL ZERO                              03051629
030517             MOVE DK-OPER-UNT-ID     TO PV-DISP-OPER              03051729
030518             MOVE DK-SHIFT-NBR       TO PV-DISP-SHIFT             03051829
030519             SET PS-ERROR               TO TRUE                   03051929
030520             DISPLAY ' 7015- '                                    03052029
030521                     ' BUS-DTE:' DK-BUS-DTE                       03052129
030522                     '    OPER:' PV-DISP-OPER                     03052229
030523                     '   SHIFT:' PV-DISP-SHIFT                    03052329
030524                     '    AREA:' DK-PRCG-AREA-CDE                 03052429
030525             MOVE '7015-UPDATE-SUM-WORKED  '                      03052529
030526                                       TO PV-ABEND-PARAGRAPH      03052629
030527             MOVE 'UPDATE PCT_SUM_WRKD      '                     03052729
030528                                       TO PV-ABEND-OPERATION      03052829
030529             MOVE 'PCT00005        '   TO PV-ABEND-STRUCTURE-1    03052929
030530             PERFORM 9900-DB2-ABEND                               03053029
030531     END-EVALUATE.                                                03053129
030532                                                                  03053229
030533                                                                  03053329
030534*-----------------------------------------------------------------03053429
030535*                                                                 03053529
030536*-----------------------------------------------------------------03053629
030537 7020-INSERT-SUM-WORKED.                                          03053729
030542                                                                  03054229
030543     MOVE  PV-RCVR-WRKD-QTY   TO PCT00005-PO-RCVR-WRKD-QTY.       03054329
030544     MOVE  PC086-PICKED-QTY   TO PCT00005-UNT-WRKD-QTY.           03054429
030545     MOVE  PC086-EXTD-RTL-AMT TO PCT00005-EXTD-RTL-WRKD-AMT.      03054529
030546                                                                  03054629
030547     EXEC SQL                                                     03054729
030548        INSERT INTO PCT_SUM_WRKD                                  03054829
030549               (BUS_DTE                                           03054929
030550             ,  OPER_UNT_ID                                       03055029
030551             ,  SHFT_NBR                                          03055129
030552             ,  PRCG_AREA_CDE                                     03055229
030553             ,  UNT_WRKD_QTY                                      03055329
030554             ,  CART_WRKD_QTY                                     03055429
030555             ,  PO_RCVR_WRKD_QTY                                  03055529
030556             ,  EXTD_RTL_WRKD_AMT)                                03055629
030557        VALUES (:PCT00005-BUS-DTE                                 03055729
030558             ,  :PCT00005-OPER-UNT-ID                             03055829
030559             ,  :PCT00005-SHFT-NBR                                03055929
030560             ,  :PCT00005-PRCG-AREA-CDE                           03056029
030561             ,  :PCT00005-UNT-WRKD-QTY                            03056129
030562             ,  :PCT00005-CART-WRKD-QTY                           03056229
030563             ,  :PCT00005-PO-RCVR-WRKD-QTY                        03056329
030564             ,  :PCT00005-EXTD-RTL-WRKD-AMT)                      03056429
030565     END-EXEC.                                                    03056529
030566                                                                  03056629
030567     EVALUATE TRUE                                                03056729
030568         WHEN SQLCODE = ZERO                                      03056829
030569             CONTINUE                                             03056929
030570                                                                  03057029
030571         WHEN SQLWARN0 NOT = SPACES                               03057129
030572         WHEN SQLCODE NOT EQUAL ZERO                              03057229
030573             MOVE PCT00005-OPER-UNT-ID TO PV-DISP-OPER            03057329
030574             MOVE PCT00005-SHFT-NBR    TO PV-DISP-SHIFT           03057429
030575             DISPLAY ' 7020- '                                    03057529
030576                     ' BUS-DTE:' PCT00005-BUS-DTE                 03057629
030577                     '    OPER:' PV-DISP-OPER                     03057729
030578                     '   SHIFT:' PV-DISP-SHIFT                    03057829
030579                     '    AREA:' DK-PRCG-AREA-CDE                 03057929
030580             SET PS-ERROR               TO TRUE                   03058029
030581             DISPLAY ' 7020-'                                     03058129
030582                     '  OPER:'    PV-DISP-OPER                    03058229
030583                     '  DATE:'    PCT00005-BUS-DTE                03058329
030584                     '  ACTN:'    PCT00007-ACTN-CDE               03058429
030585                     '  SHIFT:'   PV-DISP-SHIFT                   03058529
030586                     '  AREA:'    PCT00007-PRCG-AREA-CDE          03058629
030587             MOVE '7020-INSERT-SUM-WORKED  '                      03058729
030588                                       TO PV-ABEND-PARAGRAPH      03058829
030589             MOVE 'INSERT PCT_SUM_WRKD      '                     03058929
030590                                       TO PV-ABEND-OPERATION      03059029
030591             MOVE 'PCT00005        '   TO PV-ABEND-STRUCTURE-1    03059129
030592             PERFORM 9900-DB2-ABEND                               03059229
030593     END-EVALUATE.                                                03059329
030594                                                                  03059429
030595                                                                  03059529
030596*-----------------------------------------------------------------03059629
030597*                                                                 03059729
030598*-----------------------------------------------------------------03059829
030599 7100-READ-INPUT-FILE.                                            03059929
031397                                                                  03139728
031398*                                                                 03139836
031399*** CHECKPOINT BEGIN                                              03139936
031400*                                                                 03140036
031401     MOVE LENGTH OF PC086-EXPORT-RECORD-LAYOUT                    03140136
031402                                     TO DP001-WORK-STRG-LENGTH    03140236
031403     MOVE PC-CKPT-JOB-NAME           TO DP001-JOB-NAME            03140344
031404     MOVE PC-CKPT-PLAN-NAME          TO DP001-PLAN-NAME           03140436
031405                                                                  03140536
031406     PERFORM Z900-CALL-TRANS-PRES-MODULE                          03140636
031407                                                                  03140736
031408     MOVE DP001-TRANS-RECORD  TO PC086-EXPORT-RECORD-LAYOUT       03140836
031432                                                                  03143236
031443     IF DP001-PREP-TRANS-EOF                                      03144336
031444         SET PS-EOF-INPUT-FILE        TO TRUE                     03144439
031445     ELSE                                                         03144536
031446         ADD 1                        TO PV-READ-COUNT            03144638
031447                                         PV-DISP-CONTROL          03144745
031448         MOVE PC086-ORD-NBR           TO PV-DISP-PO               03144845
031449         MOVE PC086-RCVR-SEQ-NBR      TO PV-DISP-RCVR             03144945
031450         MOVE PC086-ORD-LNE-NBR       TO PV-DISP-LINE             03145045
031451         MOVE PC086-SHFT-NBR          TO PV-DISP-SHIFT            03145145
031452         MOVE PC086-OPER-UNT-ID       TO PV-DISP-OPER             03145245
031453         IF PV-DISP-CONTROL >  99                                 03145350
031454             EXEC SQL                                             03145436
031455                 SELECT CURRENT TIME                              03145536
031456                 INTO :PV-TIME                                    03145636
031457                 FROM SYSIBM.SYSDUMMY1                            03145736
031458             END-EXEC                                             03145836
031459             MOVE PV-READ-COUNT       TO PV-DISP-CNT              03145939
031460             DISPLAY PV-TIME                                      03146036
031461             ' PROCESSING REC # ' PV-DISP-CNT                     03146139
031462             ' / '     PV-DISP-OPER                               03146246
031464             '-'       PV-DISP-PO                                 03146445
031465             '-'       PV-DISP-RCVR                               03146545
031466             '-'       PV-DISP-LINE                               03146645
031467             '  ACTN:' PC086-ACTN-CDE                             03146745
031468             '  DATE:' PC086-BUS-DTE                              03146845
031469             '  SHFT:' PV-DISP-SHIFT                              03146945
031470             '  AREA:' PC086-PRCG-AREA-CDE                        03147045
031471             MOVE ZERO                TO PV-DISP-CONTROL          03147136
031472         END-IF                                                   03147236
031473     END-IF.                                                      03147336
031474*                                                                 03147436
031475*** CHECKPOINT END                                                03147536
031476*                                                                 03147636
031480                                                                  03148036
031500                                                                  03150001
031600                                                                  03160018
032600*-----------------------------------------------------------------03260002
032700*                                                                 03270002
032800*-----------------------------------------------------------------03280002
032900 9900-DB2-ABEND.                                                  03290002
033000                                                                  03300002
033100     MOVE SQLCODE TO PV-SQLCODE.                                  03310002
033200     DISPLAY '*** DB2 ERROR '.                                    03320002
033300     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       03330002
033400     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 03340002
033500     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               03350002
033600     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               03360002
033700     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       03370002
033800     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       03380002
033900     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       03390002
034000     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             03400002
034100                                                                  03410002
034200                                                                  03420002
034300     COPY DPPD004.                                                03430002
034400                                                                  03440002
034500     MOVE +4013                  TO PV-ABEND-CODE.                03450002
034600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03460002
034700                                                                  03470002
034710*-----------------------------------------------------------------03471036
034720* CHECKPOINT PROCEDURE DIVISION                                   03472036
034730*-----------------------------------------------------------------03473036
034800     COPY DPPD001.                                                03480036
