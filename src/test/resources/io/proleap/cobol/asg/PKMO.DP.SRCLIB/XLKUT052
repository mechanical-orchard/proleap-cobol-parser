000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    XLKUT052.                                         00040000
000500 AUTHOR.        DAN HINTZ.                                        00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   MAY 2003.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM WILL REFORMAT THE DOMAIN PACK DATA EXTRACT INTO * 00100000
001100*  THE PACK DATA ITEM LAYOUT (XLRD027).                         * 00110000
001200***************************************************************** 00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400 INPUT-OUTPUT SECTION.                                            00140000
001500                                                                  00150000
001600 FILE-CONTROL.                                                    00160000
001700                                                                  00170000
001800     SELECT DOMAIN-PACK-DATA-FILE                                 00180000
001900         ASSIGN TO INP01.                                         00190000
002000                                                                  00200000
002100     SELECT PACK-DATA-FILE                                        00210000
002200         ASSIGN TO OUT01.                                         00220000
002300                                                                  00230000
002400***************************************************************** 00240000
002500 DATA DIVISION.                                                   00250000
002600***************************************************************** 00260000
002700 FILE SECTION.                                                    00270000
002800                                                                  00280000
002900 FD  DOMAIN-PACK-DATA-FILE                                        00290000
003000     RECORDING MODE IS F                                          00300000
003100     BLOCK CONTAINS 0 RECORDS                                     00310000
003200     LABEL RECORDS ARE STANDARD.                                  00320000
003300                                                                  00330000
003400 01  DOMAIN-PACK-DATA-RECORD      PIC X(58).                      00340000
003500                                                                  00350000
003600 FD  PACK-DATA-FILE                                               00360000
003700     RECORDING MODE IS F                                          00370000
003800     BLOCK CONTAINS 0 RECORDS                                     00380000
003900     LABEL RECORDS ARE STANDARD.                                  00390000
004000                                                                  00400000
004100 01  PACK-DATA-RECORD             PIC X(144).                     00410000
004200                                                                  00420000
004300                                                                  00430000
004400***************************************************************** 00440000
004500 WORKING-STORAGE SECTION.                                         00450000
004600                                                                  00460000
004700 01  PS-PROGRAM-SWITCHES.                                         00470000
004800     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00480000
004900         88  PS-EOF-INPUT-YES                    VALUE 'Y'.       00490000
005000         88  PS-EOF-INPUT-NO                     VALUE 'N'.       00500000
005100                                                                  00510000
005200 01  PC-PROGRAM-CONSTANTS.                                        00520000
005300     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT052'.00530000
005400                                                                  00540000
005500 01  PV-PROGRAM-VARIABLES.                                        00550000
005600     05  PV-RECORDS-READ              PIC  9(09) VALUE  0.        00560000
005700     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.        00570000
006100                                                                  00610000
007300 01  PV-INPUT-RECORD.                                             00730000
009010     05 PV-PK-SKU-NBR                 PIC  S9(8)V COMP-3.         00901000
009020     05 PV-PK-DESC                    PIC   X(40).                00902000
009030     05 PV-DEPT-NBR                   PIC  S9(4)V COMP-3.         00903000
009040     05 PV-MAJ-CL-NBR                 PIC  S9(4)V COMP-3.         00904000
009050     05 PV-SUB-CL-NBR                 PIC  S9(4)V COMP-3.         00905000
009060     05 PV-DC-ORD-MULT-QTY            PIC  S9(9) COMP.            00906000
009100                                                                  00910000
009200***********************************************************       00920000
009300*  COPYBOOK USED FOR THE LOGISTIC SKU OUTPUT FILE         *       00930000
009400***********************************************************       00940000
009500 01  PV-PACK-DATA-OUTPUT.                                         00950000
009600     COPY XLRD027.                                                00960000
009700                                                                  00970000
009800***************************************************************** 00980000
009900 PROCEDURE DIVISION.                                              00990000
010000***************************************************************** 01000000
010100     DISPLAY '**** BEGINNING XLKUT052 ****'.                      01010000
010200     DISPLAY ' '.                                                 01020000
010300                                                                  01030000
010400     OPEN INPUT  DOMAIN-PACK-DATA-FILE                            01040000
010500          OUTPUT PACK-DATA-FILE.                                  01050000
010600                                                                  01060000
010700     PERFORM 1000-READ-INPUT-FILE.                                01070000
010800                                                                  01080000
010900     PERFORM 2000-PROCESS-INPUT-FILE                              01090000
011000       UNTIL PS-EOF-INPUT-YES.                                    01100000
011100                                                                  01110000
011200     CLOSE DOMAIN-PACK-DATA-FILE                                  01120000
011300           PACK-DATA-FILE.                                        01130000
011400                                                                  01140000
011500     DISPLAY '  INPUT DOMAIN PACK DATA = ' PV-RECORDS-READ.       01150000
011600     DISPLAY ' OUTPUT DOMAIN PACK DATA = ' PV-RECORDS-WRITTEN.    01160000
011700     DISPLAY ' '.                                                 01170000
011800     DISPLAY '****  END OF  XLKUT052  ****'.                      01180000
011900                                                                  01190000
012000     GOBACK.                                                      01200000
012100                                                                  01210000
012200                                                                  01220000
012300***************************************************************** 01230000
012400*  READ A VSM SKU RECORD                                          01240000
012500***************************************************************** 01250000
012600 1000-READ-INPUT-FILE.                                            01260000
013000     INITIALIZE PV-INPUT-RECORD.                                  01300000
013100                                                                  01310000
013200     READ DOMAIN-PACK-DATA-FILE                                   01320000
013300          INTO PV-INPUT-RECORD                                    01330000
013400            AT END                                                01340000
013500               SET PS-EOF-INPUT-YES TO TRUE                       01350000
013600     END-READ.                                                    01360000
013700                                                                  01370000
013800     IF PS-EOF-INPUT-YES                                          01380000
013900        CONTINUE                                                  01390000
014000     ELSE                                                         01400000
014100        ADD +1 TO PV-RECORDS-READ                                 01410000
014200     END-IF.                                                      01420000
014300                                                                  01430000
014400***************************************************************** 01440000
014500*  REFORMAT THE VSM SKU EXTRACT FILE                            * 01450000
014600***************************************************************** 01460000
014700 2000-PROCESS-INPUT-FILE.                                         01470000
016770     MOVE PV-PK-SKU-NBR             TO XL027-PACK-PK-SKU-NBR.     01677000
016780     MOVE PV-PK-DESC                TO XL027-PACK-PK-DESC.        01678000
016790     MOVE PV-DEPT-NBR               TO XL027-PACK-DEPT-NBR.       01679000
016791     MOVE PV-MAJ-CL-NBR             TO XL027-PACK-MAJ-CL-NBR.     01679100
016792     MOVE PV-SUB-CL-NBR             TO XL027-PACK-SUB-CL-NBR.     01679200
016793     MOVE PV-DC-ORD-MULT-QTY        TO XL027-PACK-DC-ORD-MULT-QTY.01679300
015200     MOVE SPACES                    TO XL027-PACK-ERROR-MESSAGE.  01679400
016800                                                                  01680000
016900     PERFORM 2100-WRITE-OUTPUT.                                   01690000
017000                                                                  01700000
017100     PERFORM 1000-READ-INPUT-FILE.                                01710000
017200                                                                  01720000
017300                                                                  01730000
017400***************************************************************** 01740000
017500*  WRITE A RECORDS TO THE LOGISTICS SKU OUTPUT FILE             * 01750000
017600***************************************************************** 01760000
017700 2100-WRITE-OUTPUT.                                               01770000
018000     WRITE PACK-DATA-RECORD FROM                                  01800000
018100         PV-PACK-DATA-OUTPUT                                      01810000
018200     END-WRITE.                                                   01820000
018300     ADD +1                 TO PV-RECORDS-WRITTEN.                01830000
018400                                                                  01840000
