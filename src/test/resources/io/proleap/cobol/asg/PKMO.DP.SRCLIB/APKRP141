000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.     APKRP141.                                        00040000
000500 AUTHOR.         DAVE COLOMBO  COMPUWARE.                         00050000
000600 DATE-WRITTEN.   JANUARY 1999.                                    00060000
000700 DATE-COMPILED.                                                   00070000
000800*--------------------------------------------------------------- *00080004
000900*    ADJUSTMENT JOURNAL MONTH-TO-DATE REPORT                     *00090004
001000*       FOR INVENTORY CONTROL                                    *00100004
001100*    COBOL 2 WITH SQL                                            *00110004
001200*                                                                *00120004
001300* THE PURPOSE OF THIS PROGRAM IS TO CREATE THE ADJUSTMENT        *00130004
001400* JOURNAL REPORT. THE REPORT WILL BE IN DIVISION, DEPARTMENT     *00140004
001500* AND MAJOR CLASS SEQUENCE, WITH TOTALS FOR CURRENT PERIOD AND   *00150004
001600* MONTH-TO-DATE AT EACH CONTROL BREAK ON ANY OF THESE FIELDS.    *00160004
001700* THE CURRENT PERIOD TOTALS WILL BE SUBTOTALED BY TRANSACTION    *00170004
001800* TYPE.                                                          *00180004
001900*                                                                *00190004
002000* THE REPORT CAN BE RUN ON A WEEKLY OR MONTHLY BASIS, INDICATED  *00200004
002100* BY A CONTROL CARD. WHEN RUN ON A WEEKLY BASIS, ONLY THE        *00210004
002200* PERIOD WILL BE REPORTED IN DETAIL. WHEN RUN ON A MONTHLY       *00220004
002300* BASIS, ALL TRANSACTIONS WILL BE REPORTED IN DETAIL.            *00230004
002400* ADDITIONALLY, THERE WILL BE TOTALS BY STORE FOR CURRENT        *00240004
002500* PERIOD AND MTD FOR EACH CONTROL BREAK LEVEL.                   *00250004
002600*--------------------------------------------------------------- *00260004
002700*                                                                *00270004
002800* DB2 TABLES:                                                    *00280004
002900*  1. AP-PAYMENT CONTROL TABLE             (TAPCNTL)             *00290004
003000*  2. MERCHANDISE AREA TABLE               (TMDSEAR)             *00300004
003100*  3. RESPONSIBLITY AREA TABLE             (TRSPBAR)             *00310004
003200*  4. LOCATION TABLE                       (XFT00017)            *00320005
003210*  5. AP TRANCODE TABLE                    (TTRNCDE)             *00321004
003220*                                                                *00322004
003230* INPUT:                                                         *00323004
003240*                                                                *00324004
003250*  1. ADJUSTMENT JOURNAL EXTRACT DATA      (APRD046)             *00325004
003260*  2. CONTROL CARD                                               *00326004
003270*                                                                *00327004
003280* OUTPUT:                                                        *00328004
003290*                                                                *00329004
003300*  1. ADJUSTMENT JOURNAL REPORT                                  *00330004
003400*                                                                *00340004
003500*--------------------------------------------------------------- *00350004
003600* CHANGE LOG:                                                    *00360004
003700* 01/26/99   INITIAL VERSION.                                    *00370004
003800*                                                                *00380004
003900* 09/02/1999 INCLUDING THE TRANSACTION CODE NUMBER NEXT TO THE   *00390004
004000*        TRANSACTION DESCRIPTION                                 *00400004
004100*        BY: JILL JUEL                              WR 05998     *00410004
004200*                                                                *00420004
004300* 10/11/1999 CHANGE DATE-INVALID TO WARNING-ERROR IN DATE        *00430004
004400*        ROUTINE CHECKING                                        *00440004
004500*        BY: L SCHALLHORN                           WR 06041     *00450004
004600*                                                                *00460004
004700* 01/11/2000 ADDED CC-FROM-DATE AND CC-THRU-DATE TO THE CONTROL  *00470004
004800*        CARD TO BE ABLE TO CHANGE THE REPORT DATE WHEN WE NEED  *00480004
004900*        TO RERUN.                                               *00490004
005000*        BY: JILL JUEL                                           *00500004
005100*                                                                *00510004
005200* 05/16/2002                                                     *00520004
005300*   CHANGE MADE:  NI-SKU CHANGES.  RECOMPILE FROM PRODUCTION     *00530004
005400*   TO INCORPORATE CHANGES TO COPYBOOK APRD046.                  *00540004
005500* MADE BY:  KEVIN CATLIN                   WR/IR #: 21278        *00550004
005600*                                                                *00560004
005700* 04/01/2004                                                     *00570004
005800*   CHANGE MADE:  REPLACED TSTR000 WITH XFT00003 (FI_XFT_LOC).   *00580004
005900*   INCREASED PC-STR-MAX FROM +999 TO +9999.  THIS EXACT SAME    *00590004
006000*   INCREASE WAS DONE TO THE OCCURS OF THE FOLLOWING TABLES:     *00600004
006100*   PV-STORE-TABLE, PV-STORE-CLASS-TABLE, PV-STORE-DEPT-TABLE,   *00610004
006200*   PV-STORE-DMA-TABLE AND PV-STORE-TOTALS-TABLE.  THE VARIOUS   *00620004
006300*   LOCATION FIELDS ON THE PRINT LINES WERE INCREASED FROM 3 TO  *00630004
006400*   4 CHARACTERS.                                                *00640004
006500* MADE BY:  MIKE BESKE                     WR/IR #: 25805        *00650004
006600*                                                                *00660004
006700* 09/29/2004                                                     *00670004
006800*   CHANGE MADE:  ADDED COMMIT STATEMENT AFTER THE X110-CLOSE-   *00680004
006900*   STORE-CSR.  THIS WILL CLOSE THE DB3P THREAD WITHOUT CAUSING  *00690004
007000*   AN ABEND WHEN THE PROGRAM TRIES TO END NORMALLY.             *00700004
007100* MADE BY:  MARK BURNSIDE                  WR/IR #: 690867       *00710004
007200*                                                                *00720004
007300* 02/25/2005                                                     *00730004
007400*   CHANGE MADE:  ADDED TRANCODE TABLE AND LOGIC TO FETCH ALL    *00740004
007410*   THE MERCHANDISE TRANCODES IN SEQUENCE AND LOAD THEM INTO     *00741004
007420*   AN ARRAY WITH A SEQUENCE NUMBER.  THIS SEQUENCE NUMBER WILL  *00742004
007430*   BECOME THE SUBSCRIPT FOR ALL OF THE TRANCODE TOTAL TABLES.   *00743004
007440*   ALSO ADDED THE TRANCODE TO EACH OF THE 'TOTAL' TABLES TO     *00744004
007450*   USE FOR PRINTING ON THE REPORT.  THESE CHANGES ARE TO FIX    *00745004
007451*   A PROBLEM WHERE USING THE TRANCODE AS A SUBSCRIPT NO LONGER  *00745104
007452*   WORKS CORRECTLY ONCE TRANCODES STARTED HAVING ALPHA VALUES.  *00745204
007453* MADE BY:  NANCY EILBES                   WR/IR #: P000740708   *00745304
007454*                                                                *00745404
007455* 03/08/2005                                                     *00745504
007456*   CHANGE MADE:  IN PARAGRAPH S200, ADDED BATCH PROCESS DATE    *00745604
007457*   TO THE SELECT LIST FOR TAPCNTL.  THIS CORRECTS A PROBLEM     *00745704
007458*   WHERE THE TRANCODE CURSOR WAS GETTING AN INVALID DATE/TIME   *00745804
007459*   FOR A MONTHLY RUN, BECAUSE THE BATCH DATE WAS NOT BEING      *00745904
007460*   SELECTED WHEN CONTROL CARD INDICATED MONTHLY.                *00746004
007461* MADE BY:  NANCY EILBES                   WR/IR #: P000742986   *00746104
007462*                                                                *00746204
007463* DATE  03/27/2007                                               *00746304
007464*     CHANGE MADE: RECOMPILE FROM PRODUCTION TO INCORPORATE      *00746404
007465*     CHANGES TO PS_XFT_LOC TABLE FOR STORE DEMOGRAPHICS.        *00746504
007466*     MADE BY: KEVIN CATLIN            WR/IR #: WR31452          *00746604
007467*                                                                *00746704
007468* 05/01/2007                                                     *00746804
007469*   CHANGE MADE:  IN PARAGRAPH S100, ADDED WITH TEST AFTER TO    *00746904
007470*   THE PERFORM VARYING, SO THAT THE FIRST TRNCDE WOULD BE       *00747004
007471*   PICKED UP AND PROCESSED CORRECTLY.                           *00747104
007472* MADE BY:  GREG WISIALOWSKI               WR/IR #: P001014386   *00747204
007473*                                                                *00747304
007474* 03/10/2008                                                     *00747404
007475*   CHANGE MADE:  EXPANDED TRANCODE TABLE FROM 99 TO 999 TO      *00747504
007476*   ACCOMODATE NEW TRANCODES                                     *00747604
007477* MADE BY:  GREG WISIALOWSKI           WR/IR #: INC000000288673  *00747704
007478*                                                                *00747804
007479* 03/10/2008                                                     *00747904
007480*   CHANGE MADE:  CORRECTED TABLE LIMIT OCCURS                   *00748004
007481* MADE BY:  GREG WISIALOWSKI           WR/IR #: INC000000290710  *00748104
007482*                                                                *00748204
007483* 03/10/2008                                                     *00748304
007484*   CHANGE MADE:  EXPANDED CLASS, DEPT, DM AND TOTAL TABLES      *00748404
007485*   FROM 99 TO 999 OCCURENCES.                                   *00748504
007486* MADE BY:  NANCY EILBES               WR/IR #: INC000000290710  *00748604
007487*                                                                *00748704
007488* 03/29/2010                                                     *00748804
007489*   CHANGE MADE:  EXPANDED REPORT TO 200X80 TO MAKE ROOM FOR NEW *00748904
007490*   COLUMNS, DOC DATE AND INV CUTOFF DATE.                       *00749004
007491* MADE BY:  NANCY EILBES               WR/IR #: PKE000000003021  *00749104
007492*                                                                *00749204
007493* DATE  09/01/2011                                               *00749305
007494*   CHANGE MADE: PROGRAM WAS MODIFIED FOR DB2 RE-PLATFORM        *00749405
007495*   TO ORACLE AS PART OF THE PEOPLESOFT FINANCIAL UPGRADE TO     *00749505
007496*   VERSION 9.1.                                                 *00749605
007497*   - DB2 TABLE NAME WILL BE CHANGED FROM FI_XFT_LOC TO          *00749705
007498*     XFT_LOC.                                                   *00749805
007499*     ITS DCLGEN CHANGED FROM XFT00003 TO XFT00017.              *00749905
007500*   - CHANGES DONE IN PARA B100-, T200-,X100- AND X110-          *00750005
007501*     MADE BY: GURUNANAK               WR/IR #: WR37038          *00750105
007502*                                                                *00750205
007503*--------------------------------------------------------------- *00750304
007504                                                                  00750404
007505 ENVIRONMENT DIVISION.                                            00750504
007506 CONFIGURATION SECTION.                                           00750604
007507 SOURCE-COMPUTER.    IBM-3090.                                    00750704
007508 OBJECT-COMPUTER.    IBM-3090.                                    00750804
007509                                                                  00750904
007510 INPUT-OUTPUT SECTION.                                            00751004
007511 FILE-CONTROL.                                                    00751104
007512                                                                  00751204
007513     SELECT ADJ-EXTRACT-FILE     ASSIGN TO UT-S-INP01.            00751304
007514     SELECT REPORT-FILE          ASSIGN TO UT-S-RPT01.            00751404
007515                                                                  00751504
007516                                                                  00751604
007517 DATA DIVISION.                                                   00751704
007518 FILE SECTION.                                                    00751804
007519                                                                  00751904
007520 FD  ADJ-EXTRACT-FILE                                             00752000
007600     RECORDING MODE IS F                                          00760000
007700     LABEL RECORDS ARE STANDARD                                   00770000
007800     BLOCK CONTAINS 0 RECORDS                                     00780000
007900     DATA RECORD IS ADJ-EXTRACT-REC.                              00790000
008000 01  ADJ-EXTRACT-REC             PIC  X(250).                     00800000
008100                                                                  00810000
008200 FD  REPORT-FILE                                                  00820000
008300     RECORDING MODE IS F                                          00830000
008400     LABEL RECORDS ARE STANDARD                                   00840000
008500     BLOCK CONTAINS 0 RECORDS                                     00850000
008600     DATA RECORD IS REPORT-REC.                                   00860000
008700 01  REPORT-REC                  PIC  X(200).                     00870001
008800                                                                  00880000
008900                                                                  00890000
009000 WORKING-STORAGE SECTION.                                         00900000
009100                                                                  00910000
009200 01  PROGRAM-CONSTANTS.                                           00920000
009300     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKRP141'. 00930000
009400     05  PC-SUB-LITERALS.                                         00940000
009500         10  TRN-SUB             PIC S9999      VALUE ZEROES.     00950000
009600         10  PC-TRN-MAX          PIC S9999      VALUE +999.       00960000
009700         10  STR-SUB             PIC S9(5)      VALUE ZEROES.     00970000
009800         10  PC-STR-MAX          PIC S9(5)      VALUE +9999.      00980000
009900     05  PC-FOR-CLASS            PIC  X(11)     VALUE             00990000
010000         ' FOR CLASS:'.                                           01000000
010100     05  PC-FOR-DEPT             PIC  X(11)     VALUE             01010000
010200         ' FOR DEPT: '.                                           01020000
010300     05  PC-FOR-DMA              PIC  X(11)     VALUE             01030000
010400         ' FOR DMM:  '.                                           01040000
010500     05  PC-TOTAL-CUR-PERIOD     PIC  X(25)     VALUE             01050000
010600         'TOTAL FOR CURRENT PERIOD '.                             01060000
010700     05  PC-TOTAL-MTD            PIC  X(25)     VALUE             01070000
010800         'TOTAL MONTH-TO-DATE      '.                             01080000
010900     05  PC-UNKNOWN              PIC  X(05)     VALUE 'UNKWN'.    01090000
011000                                                                  01100000
011100 01  PV-PROCESS-COUNTERS.                                         01110000
011200     05  PV-POS                  PIC 9(02)      VALUE ZEROS.      01120000
011300     05  PV-RETRY-COUNTER        PIC S9(4) COMP VALUE ZEROS.      01130000
011400     05  PV-READ-COUNT           PIC  9(08)     VALUE ZEROES.     01140000
011500     05  PV-STORE-READ-COUNT     PIC  9(08)     VALUE ZEROES.     01150000
011600     05  PV-TRCODE-COUNT         PIC S999       VALUE ZEROES.     01160000
011700                                                                  01170000
011800 01  PV-REPORT-CONTROLS.                                          01180000
011900     05  PV-REPORT-REC           PIC  X(200)    VALUE SPACES.     01190001
012000     05  PV-LINE-SKIP            PIC S999       VALUE ZEROES.     01200000
012100     05  PV-LINES-PER-PAGE       PIC S999       VALUE +0.         01210000
012200     05  PC-LINES-PER-PAGE-MAX   PIC S999       VALUE +80.        01220001
012300     05  PV-PAGE-COUNT           PIC S9(05)     VALUE ZEROES.     01230000
012400                                                                  01240000
012500 01  PROGRAM-SWITCHES.                                            01250000
012600     05  PS-ADJ-EOF-SW           PIC  X         VALUE 'N'.        01260000
012700         88  PS-ADJ-NOT-EOF                     VALUE 'N'.        01270000
012800         88  PS-ADJ-EOF                         VALUE 'Y'.        01280000
012900     05  PS-TRNCDE-CSR-SW        PIC  X         VALUE 'N'.        01290000
013000         88  PV-TRNCDE-CSR-NOT-AT-END           VALUE 'N'.        01300000
013100         88  PV-TRNCDE-CSR-AT-END               VALUE 'Y'.        01310000
013200     05  PS-NEED-VNDR-HEADNG-SW  PIC  X         VALUE 'N'.        01320000
013300         88  PS-NEED-VNDR-HEADNG                VALUE 'Y'.        01330000
013400         88  PS-HAVE-VNDR-HEADNG                VALUE 'N'.        01340000
013500     05  PS-CL-TOTALS-SW         PIC  X         VALUE 'N'.        01350000
013600         88  PS-CL-TOTALS                       VALUE 'Y'.        01360000
013700         88  PS-CL-NO-TOTALS                    VALUE 'N'.        01370000
013800     05  PS-DP-TOTALS-SW         PIC  X         VALUE 'N'.        01380000
013900         88  PS-DP-TOTALS                       VALUE 'Y'.        01390000
014000         88  PS-DP-NO-TOTALS                    VALUE 'N'.        01400000
014100     05  PS-DN-TOTALS-SW         PIC  X         VALUE 'N'.        01410000
014200         88  PS-DM-TOTALS                       VALUE 'Y'.        01420000
014300         88  PS-DM-NO-TOTALS                    VALUE 'N'.        01430000
014400     05  PS-TL-TOTALS-SW         PIC  X         VALUE 'N'.        01440000
014500         88  PS-TL-TOTALS                       VALUE 'Y'.        01450000
014600         88  PS-TL-NO-TOTALS                    VALUE 'N'.        01460000
014700     05  PS-TOTALS-SW            PIC  X         VALUE 'N'.        01470000
014800         88  PS-TOTALS                          VALUE 'Y'.        01480000
014900         88  PS-NO-TOTALS                       VALUE 'N'.        01490000
015000     05  PS-DMA-SW               PIC  X         VALUE 'N'.        01500000
015100         88  PS-DMA-TOTALS                      VALUE 'Y'.        01510000
015200         88  PS-NO-DMA-TOTALS                   VALUE 'N'.        01520000
015300     05  PS-DEPT-SW              PIC  X         VALUE 'N'.        01530000
015400         88  PS-DEPT-TOTALS                     VALUE 'Y'.        01540000
015500         88  PS-NO-DEPT-TOTALS                  VALUE 'N'.        01550000
015600     05  PS-STORE-TOTALS-SW      PIC  X         VALUE 'N'.        01560000
015700         88  PS-STORE-TOTALS                    VALUE 'Y'.        01570000
015800         88  PS-STORE-TOTALS-DONE               VALUE 'N'.        01580000
015900     05  PS-HAVE-1ST-SET-SW      PIC  X         VALUE 'N'.        01590000
016000         88  PS-HAVE-1ST-SET                    VALUE 'Y'.        01600000
016100         88  PS-NEED-1ST-SET                    VALUE 'N'.        01610000
016200     05  PS-HAVE-2ND-SET-SW      PIC  X         VALUE 'N'.        01620000
016300         88  PS-HAVE-2ND-SET                    VALUE 'Y'.        01630000
016400         88  PS-NEED-2ND-SET                    VALUE 'N'.        01640000
016500     05  PS-END-OF-STORES-SW     PIC  X(03)     VALUE 'N'.        01650000
016600         88  PS-END-OF-STORES                   VALUE 'Y'.        01660000
016700                                                                  01670000
016800 01  PROGRAM-VARIABLES.                                           01680000
016900     05  PV-CURRENT-DATE.                                         01690000
017000         10  PV-CURRENT-YEAR     PIC  9(02)     VALUE ZEROS.      01700000
017100         10  PV-CURRENT-MONTH    PIC  9(02)     VALUE ZEROS.      01710000
017200         10  PV-CURRENT-DAY      PIC  9(02)     VALUE ZEROS.      01720000
017300     05  PV-CURRENT-TIME.                                         01730000
017400         10  PV-CURRENT-HOUR     PIC  9(02)     VALUE ZEROES.     01740000
017500         10  PV-CURRENT-MINUTE   PIC  9(02)     VALUE ZEROES.     01750000
017600         10  FILLER              PIC  9(02)     VALUE ZEROES.     01760000
017700                                                                  01770000
017800* USED FOR AJUSTMENT PROCESSING                                   01780000
017900     05  PV-HLD-FWK-NBR          PIC  X(02)     VALUE SPACES.     01790000
018000     05  PV-HLD-DMA-NBR          PIC  X(02)     VALUE SPACES.     01800000
018100     05  PV-HLD-DEPT-NBR         PIC  X(03)     VALUE SPACES.     01810000
018200     05  PV-HLD-MAJ-CL-NBR       PIC  X(02)     VALUE SPACES.     01820000
018300     05  PV-HLD-VND-NBR          PIC  X(09)     VALUE SPACES.     01830000
018400                                                                  01840000
018500 01 PV-HLD-AMOUNTS               COMP-3.                          01850000
018600    05  PV-HLD-RETL-AMT          PIC S9(11)V99  VALUE ZEROS.      01860000
018700    05  PV-HLD-GRO-AMT           PIC S9(11)V99  VALUE ZEROS.      01870000
018800    05  PV-HLD-FRGT-AMT          PIC S9(11)V99  VALUE ZEROS.      01880000
018900    05  PV-HLD-MISC-AMT          PIC S9(11)V99  VALUE ZEROS.      01890000
019000    05  PV-HLD-NET-AMT           PIC S9(11)V99  VALUE ZEROS.      01900000
019100    05  PV-HLD-DISC-AMT          PIC S9(11)V99  VALUE ZEROS.      01910000
019200                                                                  01920000
019300 01 PV-HLD-STORE-1.                                               01930000
019400    05  PV-HLD-STR-NBR-1             PIC 9(05)      VALUE ZEROS.  01940000
019500    05  PV-HLD-STR-NME-1             PIC X(05)      VALUE ZEROS.  01950000
019600    05  PV-HLD-STR-AMOUNTS-1         COMP-3.                      01960000
019700        10  PV-HLD-STR-CUR-RETL-1    PIC S9(11)V99  VALUE ZEROS.  01970000
019800        10  PV-HLD-STR-CUR-NET-1     PIC S9(11)V99  VALUE ZEROS.  01980000
019900        10  PV-HLD-STR-MTD-RETL-1    PIC S9(11)V99  VALUE ZEROS.  01990000
020000        10  PV-HLD-STR-MTD-NET-1     PIC S9(11)V99  VALUE ZEROS.  02000000
020100                                                                  02010000
020200 01 PV-HLD-STORE-2.                                               02020000
020300    05  PV-HLD-STR-NBR-2             PIC 9(05)      VALUE ZEROS.  02030000
020400    05  PV-HLD-STR-NME-2             PIC X(05)      VALUE ZEROS.  02040000
020500    05 PV-HLD-STR-AMOUNTS-2          COMP-3.                      02050000
020600        10  PV-HLD-STR-CUR-RETL-2    PIC S9(11)V99  VALUE ZEROS.  02060000
020700        10  PV-HLD-STR-CUR-NET-2     PIC S9(11)V99  VALUE ZEROS.  02070000
020800        10  PV-HLD-STR-MTD-RETL-2    PIC S9(11)V99  VALUE ZEROS.  02080000
020900        10  PV-HLD-STR-MTD-NET-2     PIC S9(11)V99  VALUE ZEROS.  02090000
021000                                                                  02100000
021100                                                                  02110000
021200 01  PV-TRANCODE-TABLE.                                           02120000
021300     05  PV-TRANCODE  OCCURS 999 TIMES INDEXED BY TRN-IDX.        02130000
021400         10  PV-TR-TRANCODE          PIC X(2)     VALUE SPACES.   02140000
021500         10  PV-TR-SUBSCRIPT         PIC S9999     VALUE ZEROES.  02150000
021600                                                                  02160000
021700 01  PV-CLASS-TABLE.                                              02170000
021800     05  PV-CLASS-OCCURS             OCCURS 999 TIMES.            02180000
021900         10  PV-CL-TRANCODE          PIC X(2)      VALUE SPACES.  02190000
021910         10  PV-CL-DESC              PIC X(18)     VALUE SPACES.  02191000
021920         10  PV-CLASS-TRNCDE-AMTS    COMP-3.                      02192000
021930             15  PV-CL-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02193000
021940             15  PV-CL-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02194000
021950             15  PV-CL-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02195000
021960             15  PV-CL-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02196000
021970             15  PV-CL-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02197000
021980             15  PV-CL-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02198000
021990     05  PV-CLASS-CUR-PERIOD         COMP-3.                      02199000
022000         10  PV-CL-CUR-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02200000
022100         10  PV-CL-CUR-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02210000
022200         10  PV-CL-CUR-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02220000
022300         10  PV-CL-CUR-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02230000
022400         10  PV-CL-CUR-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02240000
022500         10  PV-CL-CUR-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02250000
022600     05  PV-CLASS-MTD                COMP-3.                      02260000
022700         10  PV-CL-MTD-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02270000
022800         10  PV-CL-MTD-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02280000
022900         10  PV-CL-MTD-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02290000
023000         10  PV-CL-MTD-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02300000
023100         10  PV-CL-MTD-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02310000
023200         10  PV-CL-MTD-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02320000
023300                                                                  02330000
023400 01  PV-DEPT-TABLE.                                               02340000
023500     05  PV-DEPT-OCCURS              OCCURS 999 TIMES.            02350000
023600         10  PV-DP-TRANCODE          PIC X(2)      VALUE SPACES.  02360000
023700         10  PV-DP-DESC              PIC X(18)     VALUE SPACES.  02370000
023800         10  PV-DEPT-TRNCDE-AMTS     COMP-3.                      02380000
023900             15  PV-DP-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02390000
024000             15  PV-DP-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02400000
024100             15  PV-DP-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02410000
024200             15  PV-DP-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02420000
024300             15  PV-DP-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02430000
024400             15  PV-DP-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02440000
024500     05  PV-DEPT-CUR-PERIOD          COMP-3.                      02450000
024600         10  PV-DP-CUR-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02460000
024700         10  PV-DP-CUR-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02470000
024800         10  PV-DP-CUR-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02480000
024900         10  PV-DP-CUR-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02490000
025000         10  PV-DP-CUR-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02500000
025100         10  PV-DP-CUR-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02510000
025200     05  PV-DEPT-MTD                 COMP-3.                      02520000
025300         10  PV-DP-MTD-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02530000
025400         10  PV-DP-MTD-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02540000
025500         10  PV-DP-MTD-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02550000
025600         10  PV-DP-MTD-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02560000
025700         10  PV-DP-MTD-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02570000
025800         10  PV-DP-MTD-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02580000
025900                                                                  02590000
026000 01  PV-DMA-TABLE.                                                02600000
026100     05  PV-DMA-OCCURS               OCCURS 999 TIMES.            02610000
026200         10  PV-DM-TRANCODE          PIC X(2)      VALUE SPACES.  02620000
026300         10  PV-DM-DESC              PIC X(18)     VALUE SPACES.  02630000
026400         10  PV-DMA-TRNCDE-AMTS      COMP-3.                      02640000
026500             15  PV-DM-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02650000
026600             15  PV-DM-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02660000
026700             15  PV-DM-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02670000
026800             15  PV-DM-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02680000
026900             15  PV-DM-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02690000
027000             15  PV-DM-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02700000
027100     05  PV-DMA-CUR-PERIOD           COMP-3.                      02710000
027200         10  PV-DM-CUR-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02720000
027300         10  PV-DM-CUR-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02730000
027400         10  PV-DM-CUR-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02740000
027500         10  PV-DM-CUR-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02750000
027600         10  PV-DM-CUR-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02760000
027700         10  PV-DM-CUR-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02770000
027800     05  PV-DMA-MTD                  COMP-3.                      02780000
027900         10  PV-DM-MTD-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02790000
028000         10  PV-DM-MTD-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02800000
028100         10  PV-DM-MTD-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02810000
028200         10  PV-DM-MTD-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02820000
028300         10  PV-DM-MTD-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02830000
028400         10  PV-DM-MTD-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02840000
028500                                                                  02850000
028600 01  PV-TOTALS-TABLE.                                             02860000
028700     05  PV-TOTALS-OCCURS            OCCURS 999 TIMES.            02870000
028800         10  PV-TL-TRANCODE          PIC X(2)      VALUE SPACES.  02880000
028900         10  PV-TL-DESC              PIC X(18)     VALUE SPACES.  02890000
029000         10  PV-TOTALS-TRNCDE-AMTS   COMP-3.                      02900000
029100             15  PV-TL-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02910000
029200             15  PV-TL-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02920000
029300             15  PV-TL-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   02930000
029400             15  PV-TL-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02940000
029500             15  PV-TL-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   02950000
029600             15  PV-TL-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   02960000
029700     05  PV-TOTALS-CUR-PERIOD        COMP-3.                      02970000
029800         10  PV-TL-CUR-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   02980000
029900         10  PV-TL-CUR-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   02990000
030000         10  PV-TL-CUR-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   03000000
030100         10  PV-TL-CUR-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   03010000
030200         10  PV-TL-CUR-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   03020000
030300         10  PV-TL-CUR-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   03030000
030400     05  PV-TOTALS-MTD               COMP-3.                      03040000
030500         10  PV-TL-MTD-RETL-AMT      PIC S9(11)V99 VALUE ZEROS.   03050000
030600         10  PV-TL-MTD-GRO-AMT       PIC S9(11)V99 VALUE ZEROS.   03060000
030700         10  PV-TL-MTD-FRGT-AMT      PIC S9(11)V99 VALUE ZEROS.   03070000
030800         10  PV-TL-MTD-MISC-AMT      PIC S9(11)V99 VALUE ZEROS.   03080000
030900         10  PV-TL-MTD-NET-AMT       PIC S9(11)V99 VALUE ZEROS.   03090000
031000         10  PV-TL-MTD-DISC-AMT      PIC S9(11)V99 VALUE ZEROS.   03100000
031100                                                                  03110000
031200                                                                  03120000
031300 01  PV-STORE-TABLE.                                              03130000
031400     05  PV-STORE-OCCURS             OCCURS 9999 TIMES.           03140000
031500         10  PV-STORE-NME            PIC X(05)     VALUE SPACES.  03150000
031600 01  PV-STORE-CLASS-TABLE.                                        03160000
031700     05  PV-STORE-CLASS-OCCURS         OCCURS 9999 TIMES.         03170000
031800         10  PV-ST-CL-CUR-MTD-AMTS     COMP-3.                    03180000
031900             15  PV-ST-CL-CUR-RETL-AMT PIC S9(11)V99 VALUE ZEROS. 03190000
032000             15  PV-ST-CL-CUR-NET-AMT  PIC S9(11)V99 VALUE ZEROS. 03200000
032100             15  PV-ST-CL-MTD-RETL-AMT PIC S9(11)V99 VALUE ZEROS. 03210000
032200             15  PV-ST-CL-MTD-NET-AMT  PIC S9(11)V99 VALUE ZEROS. 03220000
032300 01  PV-STORE-DEPT-TABLE.                                         03230000
032400     05  PV-STORE-DEPT-OCCURS          OCCURS 9999 TIMES.         03240000
032500         10  PV-ST-DP-CUR-MTD-AMTS     COMP-3.                    03250000
032600             15  PV-ST-DP-CUR-RETL-AMT PIC S9(11)V99 VALUE ZEROS. 03260000
032700             15  PV-ST-DP-CUR-NET-AMT  PIC S9(11)V99 VALUE ZEROS. 03270000
032800             15  PV-ST-DP-MTD-RETL-AMT PIC S9(11)V99 VALUE ZEROS. 03280000
032900             15  PV-ST-DP-MTD-NET-AMT  PIC S9(11)V99 VALUE ZEROS. 03290000
033000 01  PV-STORE-DMA-TABLE.                                          03300000
033100     05  PV-STORE-DMA-OCCURS           OCCURS 9999 TIMES.         03310000
033200         10  PV-ST-DM-CUR-MTD-AMTS     COMP-3.                    03320000
033300             15  PV-ST-DM-CUR-RETL-AMT PIC S9(11)V99 VALUE ZEROS. 03330000
033400             15  PV-ST-DM-CUR-NET-AMT  PIC S9(11)V99 VALUE ZEROS. 03340000
033500             15  PV-ST-DM-MTD-RETL-AMT PIC S9(11)V99 VALUE ZEROS. 03350000
033600             15  PV-ST-DM-MTD-NET-AMT  PIC S9(11)V99 VALUE ZEROS. 03360000
033700 01  PV-STORE-TOTALS-TABLE.                                       03370000
033800     05  PV-STORE-TOTALS-OCCURS        OCCURS 9999 TIMES.         03380000
033900         10  PV-ST-TL-CUR-MTD-AMTS     COMP-3.                    03390000
034000             15  PV-ST-TL-CUR-RETL-AMT PIC S9(11)V99 VALUE ZEROS. 03400000
034100             15  PV-ST-TL-CUR-NET-AMT  PIC S9(11)V99 VALUE ZEROS. 03410000
034200             15  PV-ST-TL-MTD-RETL-AMT PIC S9(11)V99 VALUE ZEROS. 03420000
034300             15  PV-ST-TL-MTD-NET-AMT  PIC S9(11)V99 VALUE ZEROS. 03430000
034400                                                                  03440000
034500*----------------------------------------------------------------*03450000
034600*  CONTROL CARD RECORD LAYOUT                                     03460000
034700*----------------------------------------------------------------*03470000
034800 01  CONTROL-CARD-DATE.                                           03480000
034900     05  CC-PROCESSING-PERIOD    PIC  X(01).                      03490000
035000         88  CC-PROCESS-WEEK                 VALUE 'W'.           03500000
035100         88  CC-PROCESS-MONTH                VALUE 'M'.           03510000
035200     05  FILLER                  PIC  X(05).                      03520000
035300     05  CC-FROM-DATE            PIC  X(08).                      03530000
035400     05  FILLER                  PIC  X(02).                      03540000
035500     05  CC-THRU-DATE            PIC  X(08).                      03550000
035600     05  FILLER                  PIC  X(56).                      03560000
035700                                                                  03570000
035800*----------------------------------------------------------------*03580000
035900*  INPUT RECORD LAYOUT                                            03590000
036000*----------------------------------------------------------------*03600000
036100     COPY APRD046.                                                03610000
036200                                                                  03620000
036300*----------------------------------------------------------------*03630000
036400* WORKING STORAGE NAME FORMATTING ROUTINE                         03640000
036500*----------------------------------------------------------------*03650000
036600     COPY DPWS024.                                                03660000
036700                                                                  03670000
036800*----------------------------------------------------------------*03680000
036900* WORKING STORAGE FOR DATE ROUTINE                                03690000
037000*----------------------------------------------------------------*03700000
037100     COPY DPWS500.                                                03710000
037200                                                                  03720000
037300*----------------------------------------------------------------*03730000
037400*  STANDARD HEADER LAYOUT                                         03740000
037500*----------------------------------------------------------------*03750000
037600     COPY DPWS200O.                                               03760001
037700                                                                  03770000
037800*----------------------------------------------------------------*03780000
037900*  REPORT LAYOUT                                                  03790000
038000*----------------------------------------------------------------*03800000
038100                                                                  03810000
038200 01  H2-HEADER2.                                                  03820000
038300     05  FILLER                  PIC  X(76)     VALUE SPACES.     03830001
038400     05  H2-TITLE                PIC  X(50)     VALUE             03840000
038500         'MERCHANDISE ADJUSTMENT JOURNAL - INVENTORY CONTROL'.    03850000
038600     05  FILLER                  PIC  X(74)     VALUE SPACES.     03860001
038700                                                                  03870000
038800 01  H3-HEADER3.                                                  03880000
038900     05  FILLER                  PIC  X(90)     VALUE SPACES.     03890001
039000     05  H3-FROM-DATE            PIC  X(08)     VALUE SPACES.     03900000
039100     05  FILLER                  PIC  X(06)     VALUE ' THRU '.   03910000
039200     05  H3-THRU-DATE            PIC  X(08)     VALUE SPACES.     03920000
039300     05  FILLER                  PIC  X(88)     VALUE SPACES.     03930001
039400                                                                  03940000
039500 01 H4-HEADER4.                                                   03950000
039600     05  FILLER                  PIC  X(06)     VALUE 'DMM:  '.   03960000
039700     05  FILLER                  PIC  X(02)     VALUE SPACES.     03970000
039800     05  H4-DMA-NBR              PIC  X(02)     VALUE SPACES.     03980000
039900     05  FILLER                  PIC  X(02)     VALUE SPACES.     03990000
040000     05  H4-DMA-NAME             PIC  X(45)     VALUE SPACES.     04000000
040100     05  FILLER                  PIC  X(143)    VALUE SPACES.     04010001
040200                                                                  04020000
040300 01 H5-HEADER5.                                                   04030000
040400     05  FILLER                  PIC  X(06)     VALUE 'DEPT: '.   04040000
040500     05  FILLER                  PIC  X(01)     VALUE SPACES.     04050000
040600     05  H5-DEPT-NBR             PIC  X(03)     VALUE SPACES.     04060000
040700     05  FILLER                  PIC  X(02)     VALUE SPACES.     04070000
040800     05  H5-DEPT-DESC            PIC  X(40)     VALUE SPACES.     04080000
040900     05  FILLER                  PIC  X(148)    VALUE SPACES.     04090001
041000                                                                  04100000
041100 01 H6-HEADER6.                                                   04110000
041200     05  FILLER                  PIC  X(06)     VALUE 'CLASS:'.   04120000
041300     05  FILLER                  PIC  X(02)     VALUE SPACES.     04130000
041400     05  H6-MAJ-CL-NBR           PIC  X(02)     VALUE SPACES.     04140000
041500     05  FILLER                  PIC  X(02)     VALUE SPACES.     04150000
041600     05  H6-CL-DESC              PIC  X(45)     VALUE SPACES.     04160000
041700     05  FILLER                  PIC  X(143)    VALUE SPACES.     04170001
041800                                                                  04180000
041900 01 H7-HEADER7.                                                   04190000
042000     05  FILLER                  PIC  X(06)     VALUE 'BUYER:'.   04200000
042100     05  FILLER                  PIC  X(01)     VALUE SPACES.     04210000
042200     05  H7-BYR-NBR              PIC  X(03)     VALUE SPACES.     04220000
042300     05  FILLER                  PIC  X(02)     VALUE SPACES.     04230000
042400     05  H7-BYR-NAME             PIC  X(45)     VALUE SPACES.     04240000
042500     05  FILLER                  PIC  X(143)    VALUE SPACES.     04250001
042600                                                                  04260000
042700 01  H8-HEADER8.                                                  04270000
042800     05  FILLER                  PIC  X(09)     VALUE 'PO NUMBER'.04280000
042900     05  FILLER                  PIC  X(03)     VALUE SPACES.     04290000
043000     05  FILLER                  PIC  X(15)     VALUE             04300000
043100         'DOCUMENT NUMBER'.                                       04310000
043200     05  FILLER                  PIC  X(02)     VALUE SPACES.     04320000
043300     05  FILLER                  PIC  X(07)     VALUE 'ENTERED'.  04330000
043400     05  FILLER                  PIC  X(02)     VALUE SPACES.     04340000
043500     05  FILLER                  PIC  X(10)     VALUE             04350000
043600         'TRANS TYPE'.                                            04360000
043700     05  FILLER                  PIC  X(10)     VALUE SPACES.     04370000
043800     05  FILLER                  PIC  X(03)     VALUE 'LOC'.      04380000
043900     05  FILLER                  PIC  X(05)     VALUE SPACES.     04390000
044000     05  FILLER                  PIC  X(10)     VALUE             04400000
044100         'GROSS COST'.                                            04410000
044200     05  FILLER                  PIC  X(07)     VALUE SPACES.     04420000
044300     05  FILLER                  PIC  X(07)     VALUE 'FREIGHT'.  04430000
044400     05  FILLER                  PIC  X(06)     VALUE SPACES.     04440000
044500     05  FILLER                  PIC  X(08)     VALUE 'DISCOUNT'. 04450000
044600     05  FILLER                  PIC  X(05)     VALUE SPACES.     04460000
044700     05  FILLER                  PIC  X(09)     VALUE 'MISC COST'.04470000
044800     05  FILLER                  PIC  X(08)     VALUE SPACES.     04480000
044900     05  FILLER                  PIC  X(08)     VALUE 'NET COST'. 04490000
045000     05  FILLER                  PIC  X(09)     VALUE SPACES.     04500000
045100     05  FILLER                  PIC  X(06)     VALUE 'RETAIL'.   04510000
045200     05  FILLER                  PIC  X(06)     VALUE SPACES.     04520003
045210     05  FILLER                  PIC  X(08)     VALUE 'DOC DATE'. 04521001
045220     05  FILLER                  PIC  X(05)     VALUE SPACES.     04522003
045230     05  FILLER                  PIC  X(10)     VALUE             04523001
045231         'INV CUTOFF'.                                            04523101
045240     05  FILLER                  PIC  X(23)     VALUE SPACES.     04524003
045300                                                                  04530000
045400 01  D1-DETAIL1.                                                  04540000
045500     05  FILLER                  PIC  X(08)     VALUE 'VENDOR: '. 04550000
045600     05  D1-VND-NME              PIC  X(30)     VALUE SPACES.     04560000
045700     05  FILLER                  PIC  X(01)     VALUE SPACES.     04570000
045800     05  D1-VND-NBR              PIC  X(09)     VALUE SPACES.     04580000
045900     05  FILLER                  PIC  X(07)     VALUE SPACES.     04590000
046000     05  FILLER                  PIC  X(95)     VALUE SPACES.     04600000
046100                                                                  04610000
046200 01 D2-DETAIL2.                                                   04620000
046300     05  D2-PO-NBR               PIC  ZZZ999999.                  04630000
046400     05  FILLER                  PIC  X(03)     VALUE SPACES.     04640000
046500     05  D2-DOC-NBR              PIC  X(16)     VALUE SPACES.     04650000
046600     05  FILLER                  PIC  X(01)     VALUE SPACES.     04660000
046700     05  D2-ENTERED-DTE.                                          04670000
046800         10  D2-ENTR-DTE-MM      PIC  X(02)     VALUE SPACES.     04680000
046900         10  FILLER              PIC  X(01)     VALUE '/'.        04690000
047000         10  D2-ENTR-DTE-DD      PIC  X(02)     VALUE SPACES.     04700000
047100         10  FILLER              PIC  X(01)     VALUE '/'.        04710000
047200         10  D2-ENTR-DTE-YY      PIC  X(02)     VALUE SPACES.     04720000
047300     05  FILLER                  PIC  X(01)     VALUE SPACES.     04730000
047600     05  D2-TRN-CDE              PIC  X(02)     VALUE SPACES.     04760000
047700     05  FILLER                  PIC  X(01)     VALUE SPACES.     04770000
047800     05  D2-TRN-SHRT-DESC        PIC  X(16)     VALUE SPACES.     04780000
047900     05  FILLER                  PIC  X(01)     VALUE SPACES.     04790000
048000     05  D2-LOCATION             PIC  9(04)     VALUE ZEROS.      04800000
048100     05  FILLER                  PIC  X(01)     VALUE SPACES.     04810000
048200     05  D2-GRO-AMT              PIC  ZZZZZZZZZZ.ZZ               04820000
048300                                                VALUE ZEROES.     04830000
048400     05  D2-GRO-NEG-IND-R        PIC  X(01)     VALUE SPACES.     04840000
048500     05  FILLER                  PIC  X(02)     VALUE SPACES.     04850000
048600     05  D2-FRGT-AMT             PIC  ZZZZZZZZ.ZZ                 04860000
048700                                                VALUE ZEROES.     04870000
048800     05  D2-FRGT-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04880000
048900     05  FILLER                  PIC  X(02)     VALUE SPACES.     04890000
049000     05  D2-DISC-AMT             PIC  ZZZZZZZZ.ZZ                 04900000
049100                                                VALUE ZEROS.      04910000
049200     05  D2-DISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04920000
049300     05  FILLER                  PIC  X(02)     VALUE SPACES.     04930000
049400     05  D2-MISC-AMT             PIC  ZZZZZZZZ.ZZ                 04940000
049500                                                VALUE ZEROS.      04950000
049600     05  D2-MISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     04960000
049700     05  FILLER                  PIC  X(02)     VALUE SPACES.     04970000
049800     05  D2-NET-AMT              PIC  ZZZZZZZZZZ.ZZ               04980000
049900                                                VALUE ZEROS.      04990000
050000     05  D2-NET-NEG-IND-R        PIC  X(01)     VALUE SPACES.     05000000
050100     05  FILLER                  PIC  X(01)     VALUE SPACES.     05010000
050200     05  D2-RETL-AMT             PIC  ZZZZZZZZZZ.ZZ               05020000
050300                                                VALUE ZEROS.      05030000
050400     05  D2-RETL-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05040000
050410     05  FILLER                  PIC  X(04)     VALUE SPACES.     05041001
050420     05  D2-DOC-DTE              PIC  X(10)     VALUE SPACES.     05042002
050430     05  FILLER                  PIC  X(04)     VALUE SPACES.     05043001
050440     05  D2-INV-CUTOFF-DTE       PIC  X(10)     VALUE SPACES.     05044001
050450     05  FILLER                  PIC  X(22)     VALUE SPACES.     05045001
050500                                                                  05050000
050600                                                                  05060000
050700*     TOTAL LINES.                                                05070000
050800 01 T1-HEADER1.                                                   05080000
050900     05  FILLER                  PIC  X(18)     VALUE             05090000
051000         'TRANSACTION TOTALS'.                                    05100000
051100     05  T1-TEXT                 PIC  X(11)     VALUE SPACES.     05110000
051200     05  FILLER                  PIC  X(01)     VALUE SPACES.     05120000
051300     05  T1-DESC                 PIC  X(03)     VALUE SPACES.     05130000
051400     05  FILLER                  PIC  X(116)    VALUE SPACES.     05140000
051500                                                                  05150000
051600 01 T2-DETAIL2.                                                   05160000
051700*    05  FILLER                  PIC  X(32)     VALUE SPACES.     05170000
051800     05  FILLER                  PIC  X(29)     VALUE SPACES.     05180000
051900     05  T2-TRN-CDE              PIC  X(02)     VALUE SPACES.     05190000
052000     05  FILLER                  PIC  X(01)     VALUE SPACES.     05200000
052100     05  T2-TRANS-TYP            PIC  X(18)     VALUE SPACES.     05210000
052200     05  FILLER                  PIC  X(13)     VALUE SPACES.     05220000
052300     05  T2-GRO-AMT              PIC  ZZZZZZZZZZ.ZZ               05230000
052400                                                VALUE ZEROES.     05240000
052500     05  T2-GRO-NEG-IND-R        PIC  X(01)     VALUE SPACES.     05250000
052600     05  FILLER                  PIC  X(02)     VALUE SPACES.     05260000
052700     05  T2-FRGT-AMT             PIC  ZZZZZZZZ.ZZ                 05270000
052800                                                VALUE ZEROES.     05280000
052900     05  T2-FRGT-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05290000
053000     05  FILLER                  PIC  X(02)     VALUE SPACES.     05300000
053100     05  T2-DISC-AMT             PIC  ZZZZZZZZ.ZZ                 05310000
053200                                                VALUE ZEROS.      05320000
053300     05  T2-DISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05330000
053400     05  FILLER                  PIC  X(02)     VALUE SPACES.     05340000
053500     05  T2-MISC-AMT             PIC  ZZZZZZZZ.ZZ                 05350000
053600                                                VALUE ZEROS.      05360000
053700     05  T2-MISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05370000
053800     05  FILLER                  PIC  X(02)     VALUE SPACES.     05380000
053900     05  T2-NET-AMT              PIC  ZZZZZZZZZZ.ZZ               05390000
054000                                                VALUE ZEROS.      05400000
054100     05  T2-NET-NEG-IND-R        PIC  X(01)     VALUE SPACES.     05410000
054200     05  FILLER                  PIC  X(01)     VALUE SPACES.     05420000
054300     05  T2-RETL-AMT             PIC  ZZZZZZZZZZ.ZZ               05430000
054400                                                VALUE ZEROS.      05440000
054500     05  T2-RETL-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05450000
054600                                                                  05460000
054700 01 T3-DETAIL3.                                                   05470000
054800     05  FILLER                  PIC  X(24)     VALUE SPACES.     05480000
054900     05  T3-TEXT                 PIC  X(25)     VALUE SPACES.     05490000
055000     05  FILLER                  PIC  X(14)     VALUE SPACES.     05500000
055100     05  T3-GRO-AMT              PIC  ZZZZZZZZZZ.ZZ               05510000
055200                                                VALUE ZEROES.     05520000
055300     05  T3-GRO-NEG-IND-R        PIC  X(01)     VALUE SPACES.     05530000
055400     05  FILLER                  PIC  X(02)     VALUE SPACES.     05540000
055500     05  T3-FRGT-AMT             PIC  ZZZZZZZZ.ZZ                 05550000
055600                                                VALUE ZEROES.     05560000
055700     05  T3-FRGT-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05570000
055800     05  FILLER                  PIC  X(02)     VALUE SPACES.     05580000
055900     05  T3-DISC-AMT             PIC  ZZZZZZZZ.ZZ                 05590000
056000                                                VALUE ZEROS.      05600000
056100     05  T3-DISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05610000
056200     05  FILLER                  PIC  X(02)     VALUE SPACES.     05620000
056300     05  T3-MISC-AMT             PIC  ZZZZZZZZ.ZZ                 05630000
056400                                                VALUE ZEROS.      05640000
056500     05  T3-MISC-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05650000
056600     05  FILLER                  PIC  X(02)     VALUE SPACES.     05660000
056700     05  T3-NET-AMT              PIC  ZZZZZZZZZZ.ZZ               05670000
056800                                                VALUE ZEROS.      05680000
056900     05  T3-NET-NEG-IND-R        PIC  X(01)     VALUE SPACES.     05690000
057000     05  FILLER                  PIC  X(01)     VALUE SPACES.     05700000
057100     05  T3-RETL-AMT             PIC  ZZZZZZZZZZ.ZZ               05710000
057200                                                VALUE ZEROS.      05720000
057300     05  T3-RETL-NEG-IND-R       PIC  X(01)     VALUE SPACES.     05730000
057400                                                                  05740000
057500 01 T4-HEADER4.                                                   05750000
057600     05  FILLER                  PIC  X(29)     VALUE             05760000
057700         'ADJUSTMENT TOTALS BY LOCATION'.                         05770000
057800     05  FILLER                  PIC  X(121)    VALUE SPACES.     05780000
057900                                                                  05790000
058000 01 T5-HEADER5.                                                   05800000
058100     05  FILLER                  PIC  X(22)     VALUE SPACES.     05810000
058200     05  FILLER                  PIC  X(14)     VALUE             05820000
058300         'CURRENT PERIOD'.                                        05830000
058400     05  FILLER                  PIC  X(19)     VALUE SPACES.     05840000
058500     05  FILLER                  PIC  X(13)     VALUE             05850000
058600         'MONTH-TO-DATE'.                                         05860000
058700     05  FILLER                  PIC  X(31)     VALUE SPACES.     05870000
058800     05  FILLER                  PIC  X(14)     VALUE             05880000
058900         'CURRENT PERIOD'.                                        05890000
059000     05  FILLER                  PIC  X(15)     VALUE SPACES.     05900000
059100     05  FILLER                  PIC  X(13)     VALUE             05910000
059200         'MONTH-TO-DATE'.                                         05920000
059300     05  FILLER                  PIC  X(09)     VALUE SPACES.     05930000
059400                                                                  05940000
059500 01 T6-HEADER6.                                                   05950000
059600     05  FILLER                  PIC  X(08)     VALUE             05960000
059700         'LOCATION'.                                              05970000
059800     05  FILLER                  PIC  X(12)     VALUE SPACES.     05980000
059900     05  FILLER                  PIC  X(04)     VALUE             05990000
060000         'COST'.                                                  06000000
060100     05  FILLER                  PIC  X(10)     VALUE SPACES.     06010000
060200     05  FILLER                  PIC  X(06)     VALUE             06020000
060300         'RETAIL'.                                                06030000
060400     05  FILLER                  PIC  X(13)     VALUE SPACES.     06040000
060500     05  FILLER                  PIC  X(04)     VALUE             06050000
060600         'COST'.                                                  06060000
060700     05  FILLER                  PIC  X(10)     VALUE SPACES.     06070000
060800     05  FILLER                  PIC  X(06)     VALUE             06080000
060900         'RETAIL'.                                                06090000
061000     05  FILLER                  PIC  X(04)     VALUE SPACES.     06100000
061100     05  FILLER                  PIC  X(08)     VALUE             06110000
061200         'LOCATION'.                                              06120000
061300     05  FILLER                  PIC  X(12)     VALUE SPACES.     06130000
061400     05  FILLER                  PIC  X(04)     VALUE             06140000
061500         'COST'.                                                  06150000
061600     05  FILLER                  PIC  X(10)     VALUE SPACES.     06160000
061700     05  FILLER                  PIC  X(06)     VALUE             06170000
061800         'RETAIL'.                                                06180000
061900     05  FILLER                  PIC  X(09)     VALUE SPACES.     06190000
062000     05  FILLER                  PIC  X(04)     VALUE             06200000
062100         'COST'.                                                  06210000
062200     05  FILLER                  PIC  X(10)     VALUE SPACES.     06220000
062300     05  FILLER                  PIC  X(06)     VALUE             06230000
062400         'RETAIL'.                                                06240000
062500     05  FILLER                  PIC  X(04)     VALUE SPACES.     06250000
062600                                                                  06260000
062700 01 T7-DETAIL7.                                                   06270000
062800     05  T7-LOCATION-1           PIC  9(04).                      06280000
062900     05  T7-DASH-1               PIC  X(01)     VALUE SPACES.     06290000
063000     05  T7-LOCATION-NME-1       PIC  X(05)     VALUE SPACES.     06300000
063100     05  FILLER                  PIC  X(01)     VALUE SPACES.     06310000
063200     05  T7-CUR-NET-AMT-1        PIC  ZZZZZZZZZZ.ZZ               06320000
063300                                                VALUE ZEROS.      06330000
063400     05  T7-CUR-NET-NEG-IND-R-1  PIC  X(01)     VALUE SPACES.     06340000
063500     05  FILLER                  PIC  X(02)     VALUE SPACES.     06350000
063600     05  T7-CUR-RETL-AMT-1       PIC  ZZZZZZZZZZ.ZZ               06360000
063700                                                VALUE ZEROS.      06370000
063800     05  T7-CUR-RETL-NEG-IND-R-1 PIC  X(01)     VALUE SPACES.     06380000
063900     05  FILLER                  PIC  X(03)     VALUE SPACES.     06390000
064000     05  T7-MTD-NET-AMT-1        PIC  ZZZZZZZZZZ.ZZ               06400000
064100                                                VALUE ZEROS.      06410000
064200     05  T7-MTD-NET-NEG-IND-R-1  PIC  X(01)     VALUE SPACES.     06420000
064300     05  FILLER                  PIC  X(02)     VALUE SPACES.     06430000
064400     05  T7-MTD-RETL-AMT-1       PIC  ZZZZZZZZZZ.ZZ               06440000
064500                                                VALUE ZEROS.      06450000
064600     05  T7-MTD-RETL-NEG-IND-R-1 PIC  X(01)     VALUE SPACES.     06460000
064700     05  FILLER                  PIC  X(03)     VALUE SPACES.     06470000
064800     05  T7-LOCATION-2           PIC  9(04).                      06480000
064900     05  T7-DASH-2               PIC  X(01)     VALUE SPACES.     06490000
065000     05  T7-LOCATION-NME-2       PIC  X(05)     VALUE SPACES.     06500000
065100     05  FILLER                  PIC  X(01)     VALUE SPACES.     06510000
065200     05  T7-CUR-NET-AMT-2        PIC  ZZZZZZZZZZ.ZZ               06520000
065300                                                VALUE ZEROS.      06530000
065400     05  T7-CUR-NET-NEG-IND-R-2  PIC  X(01)     VALUE SPACES.     06540000
065500     05  FILLER                  PIC  X(02)     VALUE SPACES.     06550000
065600     05  T7-CUR-RETL-AMT-2       PIC  ZZZZZZZZZZ.ZZ               06560000
065700                                                VALUE ZEROS.      06570000
065800     05  T7-CUR-RETL-NEG-IND-R-2 PIC  X(01)     VALUE SPACES.     06580000
065900     05  FILLER                  PIC  X(02)     VALUE SPACES.     06590000
066000     05  T7-MTD-NET-AMT-2        PIC  ZZZZZZZZZZ.ZZ               06600000
066100                                                VALUE ZEROS.      06610000
066200     05  T7-MTD-NET-NEG-IND-R-2  PIC  X(01)     VALUE SPACES.     06620000
066300     05  FILLER                  PIC  X(02)     VALUE SPACES.     06630000
066400     05  T7-MTD-RETL-AMT-2       PIC  ZZZZZZZZZZ.ZZ               06640000
066500                                                VALUE ZEROS.      06650000
066600     05  T7-MTD-RETL-NEG-IND-R-2 PIC  X(01)     VALUE SPACES.     06660000
066700                                                                  06670000
066800 01 PC-DASH-LINE.                                                 06680000
066900     05  FILLER                  PIC  X(58)     VALUE SPACES.     06690000
067000     05  FILLER                  PIC  X(92)     VALUE ALL '_'.    06700000
067100                                                                  06710000
067200                                                                  06720000
067300 01  END-OF-REPORT.                                               06730000
067400     05  FILLER                  PIC  X(56)     VALUE SPACES.     06740000
067500     05  FILLER                  PIC  X(37)     VALUE             06750000
067600         '**********  END OF REPORT  **********'.                 06760000
067700     05  FILLER                  PIC  X(57)     VALUE SPACES.     06770000
067800                                                                  06780000
067900*----------------------------------------------------------------*06790000
068000*    SQL COMMUNICATIONS AREA DCLGEN                               06800000
068100*----------------------------------------------------------------*06810000
068200     EXEC SQL                                                     06820000
068300         INCLUDE SQLCA                                            06830000
068400     END-EXEC.                                                    06840000
068500                                                                  06850000
068600*----------------------------------------------------------------*06860000
068700*    AP PAYMENT CONTROL TABLE                                     06870000
068800*----------------------------------------------------------------*06880000
068900     EXEC SQL                                                     06890000
069000         INCLUDE TAPCNTL                                          06900000
069100     END-EXEC.                                                    06910000
069200                                                                  06920000
069300*----------------------------------------------------------------*06930000
069400*    MERCHANDISE AREA TABLE                                       06940000
069500*----------------------------------------------------------------*06950000
069600     EXEC SQL                                                     06960000
069700         INCLUDE TMDSEAR                                          06970000
069800     END-EXEC.                                                    06980000
069900                                                                  06990000
070000*----------------------------------------------------------------*07000000
070100*    RESPONSIBLITY AREA TABLE                                     07010000
070200*----------------------------------------------------------------*07020000
070300     EXEC SQL                                                     07030000
070400         INCLUDE TRSPBAR                                          07040000
070500     END-EXEC.                                                    07050000
070600                                                                  07060000
070700*----------------------------------------------------------------*07070000
070800*    LOCATION TABLE                                               07080000
070900*----------------------------------------------------------------*07090000
071000     EXEC SQL                                                     07100000
071100         INCLUDE XFT00017                                         07110005
071200     END-EXEC.                                                    07120000
071300                                                                  07130000
071400     EXEC SQL                                                     07140000
071500       DECLARE STORE_CSR CURSOR FOR                               07150000
071600         SELECT LOC_NBR                                           07160000
071700               ,LOC_5_ABBR_NM                                     07170000
071800          FROM  XFT_LOC                                           07180005
071900         WHERE  LOC_TYP_CDE   IN ('DC','DS','CS','RV','DA')       07190000
072000           AND  FINCL_CLO_DTE  > CURRENT DATE                     07200000
072100         ORDER  BY LOC_NBR                                        07210000
072200     END-EXEC.                                                    07220000
072300                                                                  07230000
072400*----------------------------------------------------------------*07240000
072500*    AP TRANCODE TABLE                                            07250000
072600*----------------------------------------------------------------*07260000
072700     EXEC SQL                                                     07270000
072800         INCLUDE TTRNCDE                                          07280000
072900     END-EXEC.                                                    07290000
073000                                                                  07300000
073100*----------------------------------------------------------------*07310000
073200* TRANCODE_CSR GETS ALL MERCHANDISE LEDGER TRANCODES             *07320000
073300*----------------------------------------------------------------*07330000
073400     EXEC SQL                                                     07340000
073500       DECLARE TRANCODE_CSR CURSOR FOR                            07350000
073510        SELECT AP_TRN_CDE                                         07351000
073520          FROM TTRNCDE                                            07352000
073530         WHERE ML_PSTG_IND  = 'Y'                                 07353000
073540           AND TRN_TYP_CDE = 'MDS'                                07354000
073550           AND :APCNTL-BTCH-PRC-DTE BETWEEN EFF_STRT_DTE          07355000
073560                                        AND EFF_END_DTE           07356000
073570      ORDER BY AP_TRN_CDE                                         07357000
073580     END-EXEC.                                                    07358000
073590*----------------------------------------------------------------*07359000
073591*  ABEND DATA AREAS                                               07359100
073592*----------------------------------------------------------------*07359200
073593 01  ABEND-CODE                  PIC S9(4)      VALUE ZEROES      07359300
073594                                 COMP           SYNC.             07359400
073595                                                                  07359500
073596     88  AC-ANY-ERROR                           VALUE +4001       07359600
073597                                                THRU  +4019.      07359700
073598     88  AC-INVALID-KEY-WRITE                   VALUE +4001.      07359800
073599     88  AC-INVALID-KEY-READ                    VALUE +4002.      07359900
073600     88  AC-INVALID-CONTROL-CARD                VALUE +4003.      07360000
073700     88  AC-TABLE-OVERFLOW                      VALUE +4004.      07370000
073800     88  AC-OPEN-FILE-ERROR                     VALUE +4005.      07380000
073900     88  AC-CLOSE-FILE-ERROR                    VALUE +4006.      07390000
074000     88  AC-SEQUENCE-ERROR                      VALUE +4007.      07400000
074100     88  AC-INVALID-DATA                        VALUE +4008.      07410000
074200     88  AC-INVALID-KEYPUNCH                    VALUE +4009.      07420000
074300     88  AC-INTERNAL-SORT-ERROR                 VALUE +4012.      07430000
074400     88  AC-DB2-ERROR                           VALUE +4013.      07440000
074500     88  AC-DPWS500-DATE-ERROR                  VALUE +4019.      07450000
074600                                                                  07460000
074700                                                                  07470000
074800 01  ABEND-AREAS.                                                 07480000
074900     05  AA-ABEND-LIT            PIC  X(40)     VALUE             07490000
075000             '*****       ABEND'.                                 07500000
075100     05  AA-PROGRAM-LIT          PIC  X(40)     VALUE             07510000
075200             '*****   PROGRAM: APKRP141'.                         07520000
075300     05  AA-PARAGRAPH-LIT.                                        07530000
075400         10  FILLER              PIC  X(17)     VALUE             07540000
075500             '***** PARAGRAPH: '.                                 07550000
075600         10  AA-PARAGRAPH-NAME   PIC  X(35)     VALUE SPACES.     07560000
075700     05  AA-MESSAGE-LINE-1.                                       07570000
075800         10  FILLER              PIC  X(06)     VALUE '*****'.    07580000
075900         10  AA-MESSAGE-1        PIC  X(80)     VALUE SPACES.     07590000
076000     05  AA-MESSAGE-LINE-2.                                       07600000
076100         10  FILLER              PIC  X(06)     VALUE '*****'.    07610000
076200         10  AA-MESSAGE-2        PIC  X(80)     VALUE SPACES.     07620000
076300     05  AA-DB2-ERROR-LIT        PIC  X(40)     VALUE             07630000
076400             '*****    DB2 ERROR'.                                07640000
076500     05  AA-DB2-OPERATION-LIT.                                    07650000
076600         10  FILLER              PIC  X(17)     VALUE             07660000
076700             '***** OPERATION: '.                                 07670000
076800         10  AA-DB2-OPERATION.                                    07680000
076900             15  AA-DB2-OP-1     PIC  X(25)     VALUE SPACES.     07690000
077000             15  AA-DB2-OP-2     PIC  X(25)     VALUE SPACES.     07700000
077100     05  AA-DB2-TABLE-1          PIC  X(08)     VALUE SPACES.     07710000
077200     05  AA-DB2-TABLE-2          PIC  X(08)     VALUE SPACES.     07720000
077300     05  AA-DB2-TABLE-3          PIC  X(08)     VALUE SPACES.     07730000
077400                                                                  07740000
077500*----------------------------------------------------------------*07750000
077600*  SQLCA FORMATTED MESSAGE AREA                                   07760000
077700*----------------------------------------------------------------*07770000
077800     COPY DPWS004.                                                07780000
077900                                                                  07790000
078000 01  FILLER                      PIC  X(25)     VALUE             07800000
078100     '** END OF APKRP141 W/S **'.                                 07810000
078200                                                                  07820000
078300 PROCEDURE DIVISION.                                              07830000
078400 A100-MAIN.                                                       07840000
078500                                                                  07850000
078600     PERFORM B100-INITIALIZE.                                     07860000
078700                                                                  07870000
078800     PERFORM B200-PROCESS-ADJ-EXTRACT-FILE                        07880000
078900         UNTIL PS-ADJ-EOF.                                        07890000
079000                                                                  07900000
079100     PERFORM B300-END-OF-PROGRAM.                                 07910000
079200                                                                  07920000
079300     GOBACK.                                                      07930000
079400                                                                  07940000
079500                                                                  07950000
079600 B100-INITIALIZE.                                                 07960000
079700*----------------------------------------------------------------*07970000
079800*    INITIALIZATION PROCESSING                                   *07980000
079900*                                                                *07990000
080000*    - INTIALIZE LAYOUTS.                                        *08000000
080100*    - OPEN FILES.                                               *08010000
080200*    - FORMAT PAGE HEADINGS.                                     *08020000
080300*    - READ INPUT FILE.                                          *08030000
080400*    - PROCESS HEADER RECORD DATA.                               *08040000
080500*----------------------------------------------------------------*08050000
080600                                                                  08060000
080700     DISPLAY '**  APKRP141  (PROCESSING MSGS)  **'.               08070000
080800                                                                  08080000
080900     OPEN INPUT  ADJ-EXTRACT-FILE                                 08090000
081000          OUTPUT REPORT-FILE.                                     08100000
081100                                                                  08110000
081200     INITIALIZE DCLTAPCNTL                                        08120000
081300                DCLTMDSEAR                                        08130000
081400                DCLTRSPBAR                                        08140000
081500                DCLTTRNCDE                                        08150000
081600*               DCLXFT00003                                       08160005
081610                DCLXFT00017                                       08161005
081700                PV-DMA-TABLE                                      08170000
081800                PV-DEPT-TABLE                                     08180000
081900                PV-CLASS-TABLE                                    08190000
082000                PV-TOTALS-TABLE.                                  08200000
082100                                                                  08210000
082200*    EDIT AND PROCESS CONTROL CARD                                08220000
082300     ACCEPT CONTROL-CARD-DATE.                                    08230000
082400     IF CC-PROCESS-WEEK OR CC-PROCESS-MONTH                       08240000
082500         NEXT SENTENCE                                            08250000
082600     ELSE                                                         08260000
082700         MOVE 'B100-INITIALIZE'  TO AA-PARAGRAPH-NAME             08270000
082800         MOVE 'INVALID PROCESSING PERIOD'                         08280000
082900                                 TO AA-MESSAGE-1                  08290000
083000         MOVE SPACES             TO AA-MESSAGE-2                  08300000
083100         SET AC-INVALID-CONTROL-CARD TO TRUE                      08310000
083200         PERFORM Z998-ABEND                                       08320000
083300     END-IF.                                                      08330000
083400                                                                  08340000
083500*    DISPLAY CONTROL CARD INFO                                    08350000
083600     DISPLAY '** CONTROL CARD = ' CONTROL-CARD-DATE.              08360000
083700                                                                  08370000
083800     IF CC-PROCESS-WEEK                                           08380000
083900         PERFORM B110-RETRIEVE-WEEK-INFO                          08390000
084000     ELSE                                                         08400000
084100         PERFORM B120-RETRIEVE-MONTH-INFO                         08410000
084200     END-IF.                                                      08420000
084300                                                                  08430000
084400     IF CC-PROCESS-WEEK                                           08440000
084500         DISPLAY '** POSTING WK # =    ' APCNTL-CURR-PSTG-FWK-NBR 08450000
084600         DISPLAY '** POSTING WK DATE = ' APCNTL-BTCH-PRC-DTE      08460000
084700     ELSE                                                         08470000
084800         DISPLAY '** POSTING YR # = ' APCNTL-PREV-PSTG-FYR-NBR    08480000
084900         DISPLAY '** POSTING MN # = ' APCNTL-PREV-PSTG-FMN-NBR    08490000
085000     END-IF.                                                      08500000
085100                                                                  08510000
085200     IF CC-FROM-DATE = SPACES AND                                 08520000
085300        CC-THRU-DATE = SPACES                                     08530000
085400         CONTINUE                                                 08540000
085500     ELSE                                                         08550000
085600         MOVE CC-FROM-DATE TO H3-FROM-DATE                        08560000
085700         MOVE CC-THRU-DATE TO H3-THRU-DATE                        08570000
085800         DISPLAY '!! TAPCNTL DATE OVERRIDDEN !!'                  08580000
085900         DISPLAY '!! FROM DATE ' H3-FROM-DATE                     08590000
086000         DISPLAY '!! THRU DATE ' H3-THRU-DATE                     08600000
086100     END-IF.                                                      08610000
086200                                                                  08620000
086300*    LOAD STORE TABLE                                             08630000
086400     PERFORM T100-LOAD-STORE-TABLE.                               08640000
086500                                                                  08650000
086600*    FORMAT HEADING DATA                                          08660000
086700     ACCEPT PV-CURRENT-DATE FROM DATE.                            08670000
086800     MOVE PV-CURRENT-MONTH       TO DP200O-RUN-MONTH.             08680001
086900     MOVE PV-CURRENT-DAY         TO DP200O-RUN-DAY.               08690001
087000     MOVE PV-CURRENT-YEAR        TO DP200O-RUN-YEAR.              08700001
087100                                                                  08710000
087200     ACCEPT PV-CURRENT-TIME FROM TIME.                            08720000
087300     MOVE PV-CURRENT-HOUR        TO DP200O-RUN-HOUR.              08730001
087400     MOVE PV-CURRENT-MINUTE      TO DP200O-RUN-MINUTE.            08740001
087500     MOVE PC-PROGRAM-NAME        TO DP200O-PROGRAM-NAME.          08750001
087600     MOVE 1                      TO DP200O-REPORT-NUMBER.         08760001
087700                                                                  08770000
087800     PERFORM W100-WRITE-HEADINGS.                                 08780000
087900                                                                  08790000
088000*    PERFORM INITIAL READ OF INPUT FILE                           08800000
088100     PERFORM R100-READ-INPUT.                                     08810000
088200     IF PS-ADJ-EOF                                                08820000
088300         DISPLAY ' NO RECORDS TO PROCESS. EMPTY INPUT DATASET'    08830000
088400     END-IF.                                                      08840000
088500                                                                  08850000
088600*    PROCESS HEADER RECORD DATA                                   08860000
088700     IF PS-ADJ-NOT-EOF                                            08870000
088800         PERFORM C100-PROCESS-HEADER                              08880000
088900         PERFORM W200-WRITE-DETAIL-HEADINGS                       08890000
089000         PERFORM Y100-OPEN-TRANCODE-CURSOR                        08900000
089100         PERFORM S700-FETCH-TRANCODE                              08910000
089200         PERFORM VARYING TRN-IDX FROM 1 BY 1                      08920000
089300           UNTIL PV-TRNCDE-CSR-AT-END                             08930000
089400              OR TRN-IDX > 999                                    08940000
089500            IF TRN-IDX > 999                                      08950000
089600               MOVE 'B100-INITIALIZE' TO AA-PARAGRAPH-NAME        08960000
089700               MOVE 'TRANCODE TABLE EXCEEDS 999 ENTRIES'          08970000
089800                                      TO AA-MESSAGE-1             08980000
089810               SET AC-TABLE-OVERFLOW  TO TRUE                     08981000
089820               PERFORM Z998-ABEND                                 08982000
089830            ELSE                                                  08983000
089840               MOVE TRNCDE-AP-TRN-CDE TO PV-TR-TRANCODE(TRN-IDX)  08984000
089850               ADD +1 TO PV-TRCODE-COUNT                          08985000
089860               MOVE PV-TRCODE-COUNT  TO PV-TR-SUBSCRIPT(TRN-IDX)  08986000
089870               PERFORM S700-FETCH-TRANCODE                        08987000
089880            END-IF                                                08988000
089890         END-PERFORM                                              08989000
089891         PERFORM Y200-CLOSE-TRNCODE-CURSOR                        08989100
089892     END-IF.                                                      08989200
089893                                                                  08989300
089894*    PROCESS HEADER RECORD DATA                                   08989400
089895                                                                  08989500
089896                                                                  08989600
089897 B110-RETRIEVE-WEEK-INFO.                                         08989700
089898                                                                  08989800
089899     PERFORM S100-GET-CURRENT-PSTG-PERIOD.                        08989900
089900     MOVE APCNTL-CURR-PSTG-FWK-NBR     TO PV-HLD-FWK-NBR.         08990000
090000                                                                  09000000
090100     INITIALIZE DPG51                                             09010000
090200                DPG52                                             09020000
090300                DPG53                                             09030000
090400                DPG54                                             09040000
090500                DPG55                                             09050000
090600                DPG56.                                            09060000
090700                                                                  09070000
090800     SET DPG51-FISCAL-454-CALENDAR     TO TRUE.                   09080000
090900     SET DPG52-LK-DTE-ISO-FMT          TO TRUE.                   09090000
091000     MOVE APCNTL-BTCH-PRC-DTE          TO DPG52-DB2-ISO-DATE-FMT. 09100000
091100                                                                  09110000
091200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    09120000
091300                                             DPG54 DPG55 DPG56.   09130000
091400                                                                  09140000
091500     IF DPG54-SEVERE-ERROR OR DPG54-WARNING-ERROR                 09150000
091600         MOVE 'B110-RETRIEVE-WEEK-INFO'                           09160000
091700                                       TO AA-PARAGRAPH-NAME       09170000
091800         MOVE DPG54-ERROR-MESSAGE                                 09180000
091900                                       TO AA-MESSAGE-1            09190000
092000         MOVE DPG52-DB2-ISO-DATE-FMT   TO AA-MESSAGE-2            09200000
092100         SET AC-DPWS500-DATE-ERROR     TO TRUE                    09210000
092200         PERFORM Z998-ABEND                                       09220000
092300     END-IF.                                                      09230000
092400                                                                  09240000
092500     MOVE DPG55-1ST-WKDY-GREG-FMT      TO H3-FROM-DATE.           09250000
092600     MOVE DPG55-LAST-WKDY-GREG-FMT     TO H3-THRU-DATE.           09260000
092700                                                                  09270000
092800                                                                  09280000
092900 B120-RETRIEVE-MONTH-INFO.                                        09290000
093000                                                                  09300000
093100     PERFORM S200-GET-PREVIOUS-PSTG-PERIOD.                       09310000
093200                                                                  09320000
093300     INITIALIZE DPG51                                             09330000
093400                DPG52                                             09340000
093500                DPG53                                             09350000
093600                DPG54                                             09360000
093700                DPG55                                             09370000
093800                DPG56.                                            09380000
093900                                                                  09390000
094000     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       09400000
094100     SET DPG52-LK-DTE-FISC-PRD-CC  TO TRUE.                       09410000
094200     MOVE APCNTL-PREV-PSTG-FYR-NBR                                09420000
094300                                 TO DPG52-FISCAL-CC-PRD-YR.       09430000
094400     MOVE APCNTL-PREV-PSTG-FMN-NBR                                09440000
094500                                 TO DPG52-FISCAL-CC-PRD-PP.       09450000
094600                                                                  09460000
094700     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    09470000
094800                                             DPG54 DPG55 DPG56.   09480000
094900                                                                  09490000
095000     IF DPG54-SEVERE-ERROR OR DPG54-WARNING-ERROR                 09500000
095100         MOVE 'B120-RETRIEVE-MONTH-INFO'                          09510000
095200                                 TO AA-PARAGRAPH-NAME             09520000
095300         MOVE DPG54-ERROR-MESSAGE                                 09530000
095400                                 TO AA-MESSAGE-1                  09540000
095500         MOVE SPACES             TO AA-MESSAGE-2                  09550000
095600         SET AC-DPWS500-DATE-ERROR TO TRUE                        09560000
095700         PERFORM Z998-ABEND                                       09570000
095800     END-IF.                                                      09580000
095900                                                                  09590000
096000     MOVE DPG56-FIRST-FP-GREG-FMT      TO H3-FROM-DATE.           09600000
096100     MOVE DPG56-LAST-FP-GREG-FMT       TO H3-THRU-DATE.           09610000
096200                                                                  09620000
096300                                                                  09630000
096400*----------------------------------------------------------------*09640000
096500*    PROCESS ADJUSTMENT EXTRACT FILE.                            *09650000
096600*                                                                *09660000
096700*    - CHECK FOR CONTROL BREAKS.                                 *09670000
096800*    - PROCESS AND ACCUMULATE DETAIL DATA.                       *09680000
096900*    - READ THE ADJUSTMENT EXTRACT FILE.                         *09690000
097000*----------------------------------------------------------------*09700000
097100 B200-PROCESS-ADJ-EXTRACT-FILE.                                   09710000
097200                                                                  09720000
097300     IF AP046-DMA-NBR NOT = PV-HLD-DMA-NBR                        09730000
097400         PERFORM D100-MAJOR-CLASS-BREAK                           09740000
097500         PERFORM D200-DEPT-BREAK                                  09750000
097600         PERFORM D300-DMA-BREAK                                   09760000
097700         PERFORM C100-PROCESS-HEADER                              09770000
097800         PERFORM W100-WRITE-HEADINGS                              09780000
097900         PERFORM W200-WRITE-DETAIL-HEADINGS                       09790000
098000     END-IF.                                                      09800000
098100                                                                  09810000
098200                                                                  09820000
098300     IF AP046-DEPT-NBR NOT = PV-HLD-DEPT-NBR                      09830000
098400         PERFORM D100-MAJOR-CLASS-BREAK                           09840000
098500         PERFORM D200-DEPT-BREAK                                  09850000
098600         PERFORM C100-PROCESS-HEADER                              09860000
098700         PERFORM W100-WRITE-HEADINGS                              09870000
098800         PERFORM W200-WRITE-DETAIL-HEADINGS                       09880000
098900     END-IF.                                                      09890000
099000                                                                  09900000
099100     IF AP046-MAJ-CL-NBR NOT = PV-HLD-MAJ-CL-NBR                  09910000
099200         PERFORM D100-MAJOR-CLASS-BREAK                           09920000
099300         PERFORM C100-PROCESS-HEADER                              09930000
099400         PERFORM W100-WRITE-HEADINGS                              09940000
099500         PERFORM W200-WRITE-DETAIL-HEADINGS                       09950000
099600     END-IF.                                                      09960000
099700                                                                  09970000
099800     IF AP046-VND-NBR NOT = PV-HLD-VND-NBR                        09980000
099900         MOVE AP046-ENT-NME-DESC     TO D1-VND-NME                09990000
100000         MOVE AP046-VND-NBR          TO D1-VND-NBR                10000000
100100                                        PV-HLD-VND-NBR            10010000
100200         SET PS-NEED-VNDR-HEADNG     TO TRUE                      10020000
100300     END-IF.                                                      10030000
100400                                                                  10040000
100500*    PROCESS THE DETAIL RECORD                                    10050000
100600                                                                  10060000
100700*    SETUP STORE TABLE                                            10070000
100800     MOVE AP046-STR-NBR            TO STR-SUB.                    10080000
100900     IF STR-SUB > PC-STR-MAX                                      10090000
101000         MOVE 'B200-PROCESS-ADJ-EXTRACT-FILE'                     10100000
101100                                   TO AA-PARAGRAPH-NAME           10110000
101200         MOVE 'STORE NBR TO LARGE FOR STORE TABLE'                10120000
101300                                   TO AA-MESSAGE-1                10130000
101400         MOVE AP046-STR-NBR        TO AA-MESSAGE-2                10140000
101500         SET AC-TABLE-OVERFLOW     TO TRUE                        10150000
101600         PERFORM Z998-ABEND                                       10160000
101700     END-IF.                                                      10170000
101800     IF PV-STORE-NME (STR-SUB) = SPACES                           10180000
101900         MOVE PC-UNKNOWN           TO PV-STORE-NME (STR-SUB)      10190000
102000     END-IF.                                                      10200000
102100                                                                  10210000
102200*    PRINT & ACCUMULATE DETAIL                                    10220000
102300     IF (CC-PROCESS-WEEK AND AP046-PSTG-FWK-NBR = PV-HLD-FWK-NBR) 10230000
102400       OR CC-PROCESS-MONTH                                        10240000
102500         PERFORM L500-FORMAT-DETAIL                               10250000
102600         PERFORM P100-ACCUMULATE-TRN-TOTALS                       10260000
102700         PERFORM P200-ACCUMULATE-CUR-TOTALS                       10270000
102800     END-IF.                                                      10280000
102900                                                                  10290000
103000     PERFORM P300-ACCUMULATE-MTD-TOTALS                           10300000
103100                                                                  10310000
103200*    READ THE ADJUSTMENT EXTRACT FILE                             10320000
103300     PERFORM R100-READ-INPUT.                                     10330000
103400                                                                  10340000
103500                                                                  10350000
103600 B300-END-OF-PROGRAM.                                             10360000
103700*----------------------------------------------------------------*10370000
103800*    END OF PROGRAM                                              *10380000
103900*                                                                *10390000
104000*    - PROCESS THE FINAL REPORT TOTALS.                          *10400000
104100*    - CLOSE THE FILES.                                          *10410000
104200*----------------------------------------------------------------*10420000
104300                                                                  10430000
104400     IF PV-READ-COUNT > ZEROES                                    10440000
104500         PERFORM D100-MAJOR-CLASS-BREAK                           10450000
104600         PERFORM D200-DEPT-BREAK                                  10460000
104700         PERFORM D300-DMA-BREAK                                   10470000
104800         PERFORM D400-GRAND-TOTALS                                10480000
104900     END-IF.                                                      10490000
105000                                                                  10500000
105100     WRITE REPORT-REC FROM END-OF-REPORT AFTER 2.                 10510000
105200                                                                  10520000
105300     DISPLAY '** END OF APKRP141 PROCESSING **'.                  10530000
105400     DISPLAY '** TOTAL RECORDS READ    = ' PV-READ-COUNT.         10540000
105500     DISPLAY ' ' .                                                10550000
105600                                                                  10560000
105700     CLOSE ADJ-EXTRACT-FILE                                       10570000
105800           REPORT-FILE.                                           10580000
105900                                                                  10590000
106000                                                                  10600000
106100 C100-PROCESS-HEADER.                                             10610000
106200*----------------------------------------------------------------*10620000
106300*    PROCESS HEADER RECORD.                                      *10630000
106400*                                                                *10640000
106500*    - SET UP SAVED FIELDS.                                      *10650000
106600*    - GET DB2 DATA FOR REPORT.                                  *10660000
106700*----------------------------------------------------------------*10670000
106800                                                                  10680000
106900*    - GET DB2 DATA FOR REPORT                                    10690000
107000     IF AP046-DMA-NBR NOT = PV-HLD-DMA-NBR                        10700000
107100         MOVE AP046-DMA-NBR             TO MDSEAR-DMA-NBR         10710000
107200         PERFORM S300-GET-DMA-NAME                                10720000
107300         MOVE 45                        TO DP024-FLNAME-LENGTH    10730000
107400         MOVE RSPBAR-WORKER-FIR-NAME    TO DP024-FNAME            10740000
107500         MOVE RSPBAR-WORKER-LAST-NAME   TO DP024-LNAME            10750000
107600         PERFORM DP024-0000-FORMAT-NAME                           10760000
107700         MOVE AP046-DMA-NBR             TO H4-DMA-NBR             10770000
107800         MOVE DP024-FLNAME              TO H4-DMA-NAME            10780000
107900     END-IF.                                                      10790000
108000                                                                  10800000
108100     IF AP046-DEPT-NBR NOT = PV-HLD-DEPT-NBR                      10810000
108200         MOVE AP046-DEPT-NBR            TO MDSEAR-DEPT-NBR        10820000
108300         PERFORM S400-GET-DEPT-NAME                               10830000
108400         PERFORM S600-GET-BUYER-NAME                              10840000
108500         MOVE 45                        TO DP024-FLNAME-LENGTH    10850000
108600         MOVE RSPBAR-WORKER-FIR-NAME    TO DP024-FNAME            10860000
108700         MOVE RSPBAR-WORKER-LAST-NAME   TO DP024-LNAME            10870000
108800         PERFORM DP024-0000-FORMAT-NAME                           10880000
108900         MOVE AP046-DEPT-NBR            TO H5-DEPT-NBR            10890000
109000         MOVE MDSEAR-DESC               TO H5-DEPT-DESC           10900000
109100         MOVE MDSEAR-BYR-NBR            TO H7-BYR-NBR             10910000
109200         MOVE DP024-FLNAME              TO H7-BYR-NAME            10920000
109300     END-IF.                                                      10930000
109400                                                                  10940000
109500     IF AP046-MAJ-CL-NBR NOT = PV-HLD-MAJ-CL-NBR                  10950000
109600         MOVE AP046-DEPT-NBR            TO MDSEAR-DEPT-NBR        10960000
109700         MOVE AP046-MAJ-CL-NBR          TO MDSEAR-MAJ-CL-NBR      10970000
109800         PERFORM S500-GET-MAJOR-CLASS-DESC                        10980000
109900         MOVE AP046-MAJ-CL-NBR          TO H6-MAJ-CL-NBR          10990000
110000         MOVE MDSEAR-DESC               TO H6-CL-DESC             11000000
110100     END-IF.                                                      11010000
110200                                                                  11020000
110300     MOVE AP046-DMA-NBR                 TO PV-HLD-DMA-NBR.        11030000
110400     MOVE AP046-DEPT-NBR                TO PV-HLD-DEPT-NBR.       11040000
110500     MOVE AP046-MAJ-CL-NBR              TO PV-HLD-MAJ-CL-NBR.     11050000
110600                                                                  11060000
110700                                                                  11070000
110800 D100-MAJOR-CLASS-BREAK.                                          11080000
110900                                                                  11090000
111000     MOVE PC-FOR-CLASS                 TO T1-TEXT.                11100000
111100     MOVE PV-HLD-MAJ-CL-NBR            TO T1-DESC.                11110000
111200                                                                  11120000
111300     IF (PV-LINES-PER-PAGE + 8) > PC-LINES-PER-PAGE-MAX           11130000
111400         PERFORM W100-WRITE-HEADINGS                              11140000
111500         PERFORM W200-WRITE-DETAIL-HEADINGS                       11150000
111600         MOVE +2                       TO PV-LINE-SKIP            11160000
111700     ELSE                                                         11170000
111800         MOVE +3                       TO PV-LINE-SKIP            11180000
111900     END-IF.                                                      11190000
112000                                                                  11200000
112100     MOVE  T1-HEADER1                  TO PV-REPORT-REC.          11210000
112200     PERFORM W300-PRINT-DETAIL.                                   11220000
112300                                                                  11230000
112400     MOVE SPACES                       TO PV-REPORT-REC.          11240000
112500     MOVE +1                           TO PV-LINE-SKIP.           11250000
112600     PERFORM W300-PRINT-DETAIL.                                   11260000
112700                                                                  11270000
112800     IF CC-PROCESS-WEEK                                           11280000
112900         IF PS-CL-TOTALS                                          11290000
113000             PERFORM F100-PRINT-CLASS-TRAN-CODES                  11300000
113100             PERFORM G100-PRINT-CLASS-CUR-TOTALS                  11310000
113200             PERFORM H100-PRINT-CLASS-MTD-TOTALS                  11320000
113300         ELSE                                                     11330000
113400             PERFORM H100-PRINT-CLASS-MTD-TOTALS                  11340000
113500         END-IF                                                   11350000
113600     ELSE                                                         11360000
113700         PERFORM F100-PRINT-CLASS-TRAN-CODES                      11370000
113800         PERFORM G100-PRINT-CLASS-CUR-TOTALS                      11380000
113900     END-IF.                                                      11390000
114000                                                                  11400000
114100*    PRINT THE STORE TOTALS                                       11410000
114200     IF (PV-LINES-PER-PAGE + 8) > PC-LINES-PER-PAGE-MAX           11420000
114300         PERFORM W100-WRITE-HEADINGS                              11430000
114400         PERFORM W200-WRITE-DETAIL-HEADINGS                       11440000
114500     END-IF.                                                      11450000
114600     PERFORM W400-WRITE-STORE-HEADERS.                            11460000
114700     PERFORM F500-PRINT-CLASS-STORE-TOTALS.                       11470000
114800                                                                  11480000
114900     SET PS-CL-NO-TOTALS                                          11490000
115000         PS-NEED-VNDR-HEADNG           TO TRUE.                   11500000
115100     INITIALIZE PV-CLASS-TABLE                                    11510000
115200                PV-STORE-CLASS-TABLE.                             11520000
115300                                                                  11530000
115400                                                                  11540000
115500 D200-DEPT-BREAK.                                                 11550000
115600                                                                  11560000
115700     SET PS-DEPT-TOTALS                TO TRUE.                   11570000
115800                                                                  11580000
115900     MOVE PC-FOR-DEPT                  TO T1-TEXT.                11590000
116000     MOVE PV-HLD-DEPT-NBR              TO T1-DESC.                11600000
116100                                                                  11610000
116200     PERFORM W100-WRITE-HEADINGS.                                 11620000
116300     PERFORM W200-WRITE-DETAIL-HEADINGS.                          11630000
116400     MOVE +2                           TO PV-LINE-SKIP.           11640000
116500                                                                  11650000
116600     MOVE  T1-HEADER1                  TO PV-REPORT-REC.          11660000
116700     PERFORM W300-PRINT-DETAIL.                                   11670000
116800                                                                  11680000
116900     MOVE SPACES                       TO PV-REPORT-REC.          11690000
117000     MOVE +1                           TO PV-LINE-SKIP.           11700000
117100     PERFORM W300-PRINT-DETAIL.                                   11710000
117200                                                                  11720000
117300     IF CC-PROCESS-WEEK                                           11730000
117400         IF PS-DP-TOTALS                                          11740000
117500             PERFORM F200-PRINT-DEPT-TRAN-CODES                   11750000
117600             PERFORM G200-PRINT-DEPT-CUR-TOTALS                   11760000
117700             PERFORM H200-PRINT-DEPT-MTD-TOTALS                   11770000
117800         ELSE                                                     11780000
117900             PERFORM H200-PRINT-DEPT-MTD-TOTALS                   11790000
118000         END-IF                                                   11800000
118100     ELSE                                                         11810000
118200         PERFORM F200-PRINT-DEPT-TRAN-CODES                       11820000
118300         PERFORM G200-PRINT-DEPT-CUR-TOTALS                       11830000
118400     END-IF.                                                      11840000
118500                                                                  11850000
118600*    PRINT THE STORE TOTALS                                       11860000
118700     IF (PV-LINES-PER-PAGE + 8) > PC-LINES-PER-PAGE-MAX           11870000
118800         PERFORM W100-WRITE-HEADINGS                              11880000
118900         PERFORM W200-WRITE-DETAIL-HEADINGS                       11890000
119000     END-IF.                                                      11900000
119100     PERFORM W400-WRITE-STORE-HEADERS.                            11910000
119200     PERFORM F600-PRINT-DEPT-STORE-TOTALS.                        11920000
119300                                                                  11930000
119400     SET PS-DP-NO-TOTALS                                          11940000
119500         PS-NO-DEPT-TOTALS                                        11950000
119600         PS-NEED-VNDR-HEADNG           TO TRUE.                   11960000
119700     INITIALIZE PV-DEPT-TABLE                                     11970000
119800                PV-DEPT-TABLE                                     11980000
119900                PV-STORE-DEPT-TABLE.                              11990000
120000                                                                  12000000
120100                                                                  12010000
120200 D300-DMA-BREAK.                                                  12020000
120300                                                                  12030000
120400     SET PS-DMA-TOTALS                 TO TRUE.                   12040000
120500                                                                  12050000
120600     PERFORM W100-WRITE-HEADINGS.                                 12060000
120700     PERFORM W200-WRITE-DETAIL-HEADINGS.                          12070000
120800                                                                  12080000
120900     MOVE PC-FOR-DMA                   TO T1-TEXT.                12090000
121000     MOVE PV-HLD-DMA-NBR               TO T1-DESC.                12100000
121100     MOVE  T1-HEADER1                  TO PV-REPORT-REC.          12110000
121200     MOVE +2                           TO PV-LINE-SKIP.           12120000
121300     PERFORM W300-PRINT-DETAIL.                                   12130000
121400     MOVE SPACES                       TO PV-REPORT-REC.          12140000
121500     MOVE +1                           TO PV-LINE-SKIP.           12150000
121600     PERFORM W300-PRINT-DETAIL.                                   12160000
121700                                                                  12170000
121800     IF CC-PROCESS-WEEK                                           12180000
121900         IF PS-DM-TOTALS                                          12190000
122000             PERFORM F300-PRINT-DMA-TRAN-CODES                    12200000
122100             PERFORM G300-PRINT-DMA-CUR-TOTALS                    12210000
122200             PERFORM H300-PRINT-DMA-MTD-TOTALS                    12220000
122300         ELSE                                                     12230000
122400             PERFORM H300-PRINT-DMA-MTD-TOTALS                    12240000
122500         END-IF                                                   12250000
122600     ELSE                                                         12260000
122700         PERFORM F300-PRINT-DMA-TRAN-CODES                        12270000
122800         PERFORM G300-PRINT-DMA-CUR-TOTALS                        12280000
122900     END-IF.                                                      12290000
123000                                                                  12300000
123100*    PRINT THE STORE TOTALS                                       12310000
123200     IF (PV-LINES-PER-PAGE + 8) > PC-LINES-PER-PAGE-MAX           12320000
123300         PERFORM W100-WRITE-HEADINGS                              12330000
123400         PERFORM W200-WRITE-DETAIL-HEADINGS                       12340000
123500     END-IF.                                                      12350000
123600     PERFORM W400-WRITE-STORE-HEADERS.                            12360000
123700     PERFORM F700-PRINT-DMA-STORE-TOTALS.                         12370000
123800                                                                  12380000
123900     SET PS-DM-NO-TOTALS                                          12390000
124000         PS-NO-DMA-TOTALS                                         12400000
124100         PS-NEED-VNDR-HEADNG           TO TRUE.                   12410000
124200                                                                  12420000
124300     INITIALIZE PV-DMA-TABLE                                      12430000
124400                PV-DMA-TABLE                                      12440000
124500                PV-STORE-DMA-TABLE.                               12450000
124600                                                                  12460000
124700                                                                  12470000
124800 D400-GRAND-TOTALS.                                               12480000
124900                                                                  12490000
125000     SET PS-TOTALS                     TO TRUE.                   12500000
125100                                                                  12510000
125200     PERFORM W100-WRITE-HEADINGS.                                 12520000
125300     PERFORM W200-WRITE-DETAIL-HEADINGS.                          12530000
125400                                                                  12540000
125500     MOVE SPACES                       TO T1-TEXT                 12550000
125600                                          T1-DESC.                12560000
125700     MOVE  T1-HEADER1                  TO PV-REPORT-REC.          12570000
125800     MOVE +2                           TO PV-LINE-SKIP.           12580000
125900     PERFORM W300-PRINT-DETAIL.                                   12590000
126000     MOVE SPACES                       TO PV-REPORT-REC.          12600000
126100     MOVE +1                           TO PV-LINE-SKIP.           12610000
126200     PERFORM W300-PRINT-DETAIL.                                   12620000
126300                                                                  12630000
126400     IF CC-PROCESS-WEEK                                           12640000
126500         IF PS-TL-TOTALS                                          12650000
126600             PERFORM F400-PRINT-TOTALS-TRAN-CODES                 12660000
126700             PERFORM G400-PRINT-TOTALS-CUR-TOTALS                 12670000
126800             PERFORM H400-PRINT-TOTALS-MTD-TOTALS                 12680000
126900         ELSE                                                     12690000
127000             PERFORM H400-PRINT-TOTALS-MTD-TOTALS                 12700000
127100         END-IF                                                   12710000
127200     ELSE                                                         12720000
127300         PERFORM F400-PRINT-TOTALS-TRAN-CODES                     12730000
127400         PERFORM G400-PRINT-TOTALS-CUR-TOTALS                     12740000
127500     END-IF.                                                      12750000
127600                                                                  12760000
127700*    PRINT THE STORE TOTALS                                       12770000
127800     IF (PV-LINES-PER-PAGE + 8) > PC-LINES-PER-PAGE-MAX           12780000
127900         PERFORM W100-WRITE-HEADINGS                              12790000
128000         PERFORM W200-WRITE-DETAIL-HEADINGS                       12800000
128100     END-IF.                                                      12810000
128200     PERFORM W400-WRITE-STORE-HEADERS.                            12820000
128300     PERFORM F800-PRINT-GRAND-STORE-TOTALS.                       12830000
128400                                                                  12840000
128500     SET PS-TL-NO-TOTALS                                          12850000
128600         PS-NO-TOTALS                                             12860000
128700         PS-NEED-VNDR-HEADNG           TO TRUE.                   12870000
128800                                                                  12880000
128900     INITIALIZE PV-TOTALS-TABLE                                   12890000
129000                PV-TOTALS-TABLE                                   12900000
129100                PV-STORE-TOTALS-TABLE.                            12910000
129200                                                                  12920000
129300                                                                  12930000
129400 F100-PRINT-CLASS-TRAN-CODES.                                     12940000
129500                                                                  12950000
129600     PERFORM                                                      12960000
129700       VARYING TRN-SUB FROM 1 BY 1                                12970000
129800       UNTIL   TRN-SUB > PC-TRN-MAX                               12980000
129900         IF PV-CL-RETL-AMT    (TRN-SUB)   = ZEROS                 12990000
130000           AND PV-CL-GRO-AMT  (TRN-SUB)   = ZEROS                 13000000
130100           AND PV-CL-FRGT-AMT (TRN-SUB)   = ZEROS                 13010000
130200           AND PV-CL-MISC-AMT (TRN-SUB)   = ZEROS                 13020000
130300           AND PV-CL-NET-AMT  (TRN-SUB)   = ZEROS                 13030000
130400           AND PV-CL-DISC-AMT (TRN-SUB)   = ZEROS                 13040000
130500             CONTINUE                                             13050000
130600         ELSE                                                     13060000
130700             MOVE PV-CLASS-TRNCDE-AMTS (TRN-SUB)                  13070000
130800                                       TO PV-HLD-AMOUNTS          13080000
130900             MOVE PV-CL-TRANCODE (TRN-SUB) TO T2-TRN-CDE          13090000
131000             MOVE PV-CL-DESC (TRN-SUB) TO T2-TRANS-TYP            13100000
131100             PERFORM L100-FORMAT-TRANSACTION-TOTALS               13110000
131200         END-IF                                                   13120000
131300     END-PERFORM.                                                 13130000
131400                                                                  13140000
131500     MOVE  PC-DASH-LINE                TO PV-REPORT-REC.          13150000
131600     MOVE +1                           TO PV-LINE-SKIP.           13160000
131700     PERFORM W300-PRINT-DETAIL.                                   13170000
131800                                                                  13180000
131900                                                                  13190000
132000 F200-PRINT-DEPT-TRAN-CODES.                                      13200000
132100                                                                  13210000
132200     PERFORM                                                      13220000
132300       VARYING TRN-SUB FROM 1 BY 1                                13230000
132400       UNTIL   TRN-SUB > PC-TRN-MAX                               13240000
132500         IF PV-DP-RETL-AMT    (TRN-SUB)   = ZEROS                 13250000
132600           AND PV-DP-GRO-AMT  (TRN-SUB)   = ZEROS                 13260000
132700           AND PV-DP-FRGT-AMT (TRN-SUB)   = ZEROS                 13270000
132800           AND PV-DP-MISC-AMT (TRN-SUB)   = ZEROS                 13280000
132900           AND PV-DP-NET-AMT  (TRN-SUB)   = ZEROS                 13290000
133000           AND PV-DP-DISC-AMT (TRN-SUB)   = ZEROS                 13300000
133100             CONTINUE                                             13310000
133200         ELSE                                                     13320000
133300             MOVE PV-DEPT-TRNCDE-AMTS (TRN-SUB)                   13330000
133400                                       TO PV-HLD-AMOUNTS          13340000
133500             MOVE PV-DP-TRANCODE (TRN-SUB) TO T2-TRN-CDE          13350000
133600             MOVE PV-DP-DESC (TRN-SUB) TO T2-TRANS-TYP            13360000
133700             PERFORM L100-FORMAT-TRANSACTION-TOTALS               13370000
133800         END-IF                                                   13380000
133900     END-PERFORM.                                                 13390000
134000                                                                  13400000
134100     MOVE  PC-DASH-LINE                TO PV-REPORT-REC.          13410000
134200     MOVE +1                           TO PV-LINE-SKIP.           13420000
134300     PERFORM W300-PRINT-DETAIL.                                   13430000
134400                                                                  13440000
134500                                                                  13450000
134600 F300-PRINT-DMA-TRAN-CODES.                                       13460000
134700                                                                  13470000
134800     PERFORM                                                      13480000
134900       VARYING TRN-SUB FROM 1 BY 1                                13490000
135000       UNTIL   TRN-SUB > PC-TRN-MAX                               13500000
135100         IF PV-DM-RETL-AMT    (TRN-SUB)   = ZEROS                 13510000
135200           AND PV-DM-GRO-AMT  (TRN-SUB)   = ZEROS                 13520000
135300           AND PV-DM-FRGT-AMT (TRN-SUB)   = ZEROS                 13530000
135400           AND PV-DM-MISC-AMT (TRN-SUB)   = ZEROS                 13540000
135500           AND PV-DM-NET-AMT  (TRN-SUB)   = ZEROS                 13550000
135600           AND PV-DM-DISC-AMT (TRN-SUB)   = ZEROS                 13560000
135700             CONTINUE                                             13570000
135800         ELSE                                                     13580000
135900             MOVE PV-DMA-TRNCDE-AMTS (TRN-SUB)                    13590000
136000                                       TO PV-HLD-AMOUNTS          13600000
136100             MOVE PV-DM-TRANCODE (TRN-SUB) TO T2-TRN-CDE          13610000
136200             MOVE PV-DM-DESC (TRN-SUB) TO T2-TRANS-TYP            13620000
136300             PERFORM L100-FORMAT-TRANSACTION-TOTALS               13630000
136400         END-IF                                                   13640000
136500     END-PERFORM.                                                 13650000
136600                                                                  13660000
136700     MOVE  PC-DASH-LINE                TO PV-REPORT-REC.          13670000
136800     MOVE +1                           TO PV-LINE-SKIP.           13680000
136900     PERFORM W300-PRINT-DETAIL.                                   13690000
137000                                                                  13700000
137100                                                                  13710000
137200 F400-PRINT-TOTALS-TRAN-CODES.                                    13720000
137300                                                                  13730000
137400     PERFORM                                                      13740000
137500       VARYING TRN-SUB FROM 1 BY 1                                13750000
137600       UNTIL   TRN-SUB > PC-TRN-MAX                               13760000
137700         IF PV-TL-RETL-AMT    (TRN-SUB)   = ZEROS                 13770000
137800           AND PV-TL-GRO-AMT  (TRN-SUB)   = ZEROS                 13780000
137900           AND PV-TL-FRGT-AMT (TRN-SUB)   = ZEROS                 13790000
138000           AND PV-TL-MISC-AMT (TRN-SUB)   = ZEROS                 13800000
138100           AND PV-TL-NET-AMT  (TRN-SUB)   = ZEROS                 13810000
138200           AND PV-TL-DISC-AMT (TRN-SUB)   = ZEROS                 13820000
138300             CONTINUE                                             13830000
138400         ELSE                                                     13840000
138500             MOVE PV-TOTALS-TRNCDE-AMTS (TRN-SUB)                 13850000
138600                                       TO PV-HLD-AMOUNTS          13860000
138700             MOVE PV-TL-TRANCODE (TRN-SUB) TO T2-TRN-CDE          13870000
138800             MOVE PV-TL-DESC (TRN-SUB) TO T2-TRANS-TYP            13880000
138900             PERFORM L100-FORMAT-TRANSACTION-TOTALS               13890000
139000         END-IF                                                   13900000
139100     END-PERFORM.                                                 13910000
139200                                                                  13920000
139300     MOVE  PC-DASH-LINE                TO PV-REPORT-REC.          13930000
139400     MOVE +1                           TO PV-LINE-SKIP.           13940000
139500     PERFORM W300-PRINT-DETAIL.                                   13950000
139600                                                                  13960000
139700                                                                  13970000
139800 F500-PRINT-CLASS-STORE-TOTALS.                                   13980000
139900                                                                  13990000
140000     SET PS-STORE-TOTALS TO TRUE.                                 14000000
140100                                                                  14010000
140200     PERFORM                                                      14020000
140300       VARYING STR-SUB FROM 1 BY 1                                14030000
140400       UNTIL   STR-SUB > PC-STR-MAX                               14040000
140500         IF PV-ST-CL-CUR-RETL-AMT    (STR-SUB)   = ZEROS          14050000
140600           AND PV-ST-CL-CUR-NET-AMT  (STR-SUB)   = ZEROS          14060000
140700           AND PV-ST-CL-MTD-RETL-AMT (STR-SUB)   = ZEROS          14070000
140800           AND PV-ST-CL-MTD-NET-AMT  (STR-SUB)   = ZEROS          14080000
140900             CONTINUE                                             14090000
141000         ELSE                                                     14100000
141100             IF PS-NEED-1ST-SET                                   14110000
141200                 MOVE STR-SUB          TO PV-HLD-STR-NBR-1        14120000
141300                 MOVE PV-STORE-NME (STR-SUB)                      14130000
141400                                       TO PV-HLD-STR-NME-1        14140000
141500                 MOVE PV-ST-CL-CUR-MTD-AMTS (STR-SUB)             14150000
141600                                       TO PV-HLD-STR-AMOUNTS-1    14160000
141700                 SET PS-HAVE-1ST-SET   TO TRUE                    14170000
141800             ELSE                                                 14180000
141900                 MOVE STR-SUB          TO PV-HLD-STR-NBR-2        14190000
142000                 MOVE PV-STORE-NME (STR-SUB)                      14200000
142100                                       TO PV-HLD-STR-NME-2        14210000
142200                 MOVE PV-ST-CL-CUR-MTD-AMTS (STR-SUB)             14220000
142300                                       TO PV-HLD-STR-AMOUNTS-2    14230000
142400                 SET PS-HAVE-2ND-SET   TO TRUE                    14240000
142500                 PERFORM L600-FORMAT-STORE-TOTALS                 14250000
142600             END-IF                                               14260000
142700         END-IF                                                   14270000
142800     END-PERFORM.                                                 14280000
142900                                                                  14290000
143000     IF PS-HAVE-1ST-SET                                           14300000
143100         PERFORM L600-FORMAT-STORE-TOTALS                         14310000
143200     END-IF.                                                      14320000
143300                                                                  14330000
143400     INITIALIZE PV-HLD-STORE-1                                    14340000
143500                PV-HLD-STORE-2.                                   14350000
143600                                                                  14360000
143700     SET PS-STORE-TOTALS-DONE TO TRUE.                            14370000
143800                                                                  14380000
143900                                                                  14390000
144000 F600-PRINT-DEPT-STORE-TOTALS.                                    14400000
144100                                                                  14410000
144200     SET PS-STORE-TOTALS TO TRUE.                                 14420000
144300                                                                  14430000
144400     PERFORM                                                      14440000
144500       VARYING STR-SUB FROM 1 BY 1                                14450000
144600       UNTIL   STR-SUB > PC-STR-MAX                               14460000
144700         IF PV-ST-DP-CUR-RETL-AMT    (STR-SUB)   = ZEROS          14470000
144800           AND PV-ST-DP-CUR-NET-AMT  (STR-SUB)   = ZEROS          14480000
144900           AND PV-ST-DP-MTD-RETL-AMT (STR-SUB)   = ZEROS          14490000
145000           AND PV-ST-DP-MTD-NET-AMT  (STR-SUB)   = ZEROS          14500000
145100             CONTINUE                                             14510000
145200         ELSE                                                     14520000
145300             IF PS-NEED-1ST-SET                                   14530000
145400                 MOVE STR-SUB          TO PV-HLD-STR-NBR-1        14540000
145500                 MOVE PV-STORE-NME (STR-SUB)                      14550000
145600                                       TO PV-HLD-STR-NME-1        14560000
145700                 MOVE PV-ST-DP-CUR-MTD-AMTS (STR-SUB)             14570000
145800                                       TO PV-HLD-STR-AMOUNTS-1    14580000
145900                 SET PS-HAVE-1ST-SET   TO TRUE                    14590000
146000             ELSE                                                 14600000
146100                 MOVE STR-SUB          TO PV-HLD-STR-NBR-2        14610000
146200                 MOVE PV-STORE-NME (STR-SUB)                      14620000
146300                                       TO PV-HLD-STR-NME-2        14630000
146400                 MOVE PV-ST-DP-CUR-MTD-AMTS (STR-SUB)             14640000
146500                                       TO PV-HLD-STR-AMOUNTS-2    14650000
146600                 SET PS-HAVE-2ND-SET   TO TRUE                    14660000
146700                 PERFORM L600-FORMAT-STORE-TOTALS                 14670000
146800             END-IF                                               14680000
146900         END-IF                                                   14690000
147000     END-PERFORM.                                                 14700000
147100                                                                  14710000
147200     IF PS-HAVE-1ST-SET                                           14720000
147300         PERFORM L600-FORMAT-STORE-TOTALS                         14730000
147400     END-IF.                                                      14740000
147500                                                                  14750000
147600     INITIALIZE PV-HLD-STORE-1                                    14760000
147700                PV-HLD-STORE-2.                                   14770000
147800                                                                  14780000
147900     SET PS-STORE-TOTALS-DONE TO TRUE.                            14790000
148000                                                                  14800000
148100                                                                  14810000
148200 F700-PRINT-DMA-STORE-TOTALS.                                     14820000
148300                                                                  14830000
148400     SET PS-STORE-TOTALS TO TRUE.                                 14840000
148500                                                                  14850000
148600     PERFORM                                                      14860000
148700       VARYING STR-SUB FROM 1 BY 1                                14870000
148800       UNTIL   STR-SUB > PC-STR-MAX                               14880000
148900         IF PV-ST-DM-CUR-RETL-AMT    (STR-SUB)   = ZEROS          14890000
149000           AND PV-ST-DM-CUR-NET-AMT  (STR-SUB)   = ZEROS          14900000
149100           AND PV-ST-DM-MTD-RETL-AMT (STR-SUB)   = ZEROS          14910000
149200           AND PV-ST-DM-MTD-NET-AMT  (STR-SUB)   = ZEROS          14920000
149300             CONTINUE                                             14930000
149400         ELSE                                                     14940000
149500             IF PS-NEED-1ST-SET                                   14950000
149600                 MOVE STR-SUB          TO PV-HLD-STR-NBR-1        14960000
149700                 MOVE PV-STORE-NME (STR-SUB)                      14970000
149800                                       TO PV-HLD-STR-NME-1        14980000
149900                 MOVE PV-ST-DM-CUR-MTD-AMTS (STR-SUB)             14990000
150000                                       TO PV-HLD-STR-AMOUNTS-1    15000000
150100                 SET PS-HAVE-1ST-SET   TO TRUE                    15010000
150200             ELSE                                                 15020000
150300                 MOVE STR-SUB          TO PV-HLD-STR-NBR-2        15030000
150400                 MOVE PV-STORE-NME (STR-SUB)                      15040000
150500                                       TO PV-HLD-STR-NME-2        15050000
150600                 MOVE PV-ST-DM-CUR-MTD-AMTS (STR-SUB)             15060000
150700                                       TO PV-HLD-STR-AMOUNTS-2    15070000
150800                 SET PS-HAVE-2ND-SET   TO TRUE                    15080000
150900                 PERFORM L600-FORMAT-STORE-TOTALS                 15090000
151000             END-IF                                               15100000
151100         END-IF                                                   15110000
151200     END-PERFORM.                                                 15120000
151300                                                                  15130000
151400     IF PS-HAVE-1ST-SET                                           15140000
151500         PERFORM L600-FORMAT-STORE-TOTALS                         15150000
151600     END-IF.                                                      15160000
151700                                                                  15170000
151800     INITIALIZE PV-HLD-STORE-1                                    15180000
151900                PV-HLD-STORE-2.                                   15190000
152000                                                                  15200000
152100     SET PS-STORE-TOTALS-DONE TO TRUE.                            15210000
152200                                                                  15220000
152300                                                                  15230000
152400 F800-PRINT-GRAND-STORE-TOTALS.                                   15240000
152500                                                                  15250000
152600     SET PS-STORE-TOTALS TO TRUE.                                 15260000
152700                                                                  15270000
152800     PERFORM                                                      15280000
152900       VARYING STR-SUB FROM 1 BY 1                                15290000
153000       UNTIL   STR-SUB > PC-STR-MAX                               15300000
153100         IF PV-ST-TL-CUR-RETL-AMT    (STR-SUB)   = ZEROS          15310000
153200           AND PV-ST-TL-CUR-NET-AMT  (STR-SUB)   = ZEROS          15320000
153300           AND PV-ST-TL-MTD-RETL-AMT (STR-SUB)   = ZEROS          15330000
153400           AND PV-ST-TL-MTD-NET-AMT  (STR-SUB)   = ZEROS          15340000
153500             CONTINUE                                             15350000
153600         ELSE                                                     15360000
153700             IF PS-NEED-1ST-SET                                   15370000
153800                 MOVE STR-SUB          TO PV-HLD-STR-NBR-1        15380000
153900                 MOVE PV-STORE-NME (STR-SUB)                      15390000
154000                                       TO PV-HLD-STR-NME-1        15400000
154100                 MOVE PV-ST-TL-CUR-MTD-AMTS (STR-SUB)             15410000
154200                                       TO PV-HLD-STR-AMOUNTS-1    15420000
154300                 SET PS-HAVE-1ST-SET   TO TRUE                    15430000
154400             ELSE                                                 15440000
154500                 MOVE STR-SUB          TO PV-HLD-STR-NBR-2        15450000
154600                 MOVE PV-STORE-NME (STR-SUB)                      15460000
154700                                       TO PV-HLD-STR-NME-2        15470000
154800                 MOVE PV-ST-TL-CUR-MTD-AMTS (STR-SUB)             15480000
154900                                       TO PV-HLD-STR-AMOUNTS-2    15490000
155000                 SET PS-HAVE-2ND-SET   TO TRUE                    15500000
155100                 PERFORM L600-FORMAT-STORE-TOTALS                 15510000
155200             END-IF                                               15520000
155300         END-IF                                                   15530000
155400     END-PERFORM.                                                 15540000
155500                                                                  15550000
155600     IF PS-HAVE-1ST-SET                                           15560000
155700         PERFORM L600-FORMAT-STORE-TOTALS                         15570000
155800     END-IF.                                                      15580000
155900                                                                  15590000
156000     INITIALIZE PV-HLD-STORE-1                                    15600000
156100                PV-HLD-STORE-2.                                   15610000
156200                                                                  15620000
156300     SET PS-STORE-TOTALS-DONE TO TRUE.                            15630000
156400                                                                  15640000
156500                                                                  15650000
156600 G100-PRINT-CLASS-CUR-TOTALS.                                     15660000
156700                                                                  15670000
156800     MOVE PC-TOTAL-CUR-PERIOD          TO T3-TEXT.                15680000
156900     MOVE PV-CLASS-CUR-PERIOD          TO PV-HLD-AMOUNTS.         15690000
157000     PERFORM L200-FORMAT-TOTALS.                                  15700000
157100                                                                  15710000
157200                                                                  15720000
157300 G200-PRINT-DEPT-CUR-TOTALS.                                      15730000
157400                                                                  15740000
157500     MOVE PC-TOTAL-CUR-PERIOD          TO T3-TEXT.                15750000
157600     MOVE PV-DEPT-CUR-PERIOD           TO PV-HLD-AMOUNTS.         15760000
157700     PERFORM L200-FORMAT-TOTALS.                                  15770000
157800                                                                  15780000
157900                                                                  15790000
158000 G300-PRINT-DMA-CUR-TOTALS.                                       15800000
158100                                                                  15810000
158200     MOVE PC-TOTAL-CUR-PERIOD          TO T3-TEXT.                15820000
158300     MOVE PV-DMA-CUR-PERIOD            TO PV-HLD-AMOUNTS.         15830000
158400     PERFORM L200-FORMAT-TOTALS.                                  15840000
158500                                                                  15850000
158600                                                                  15860000
158700 G400-PRINT-TOTALS-CUR-TOTALS.                                    15870000
158800                                                                  15880000
158900     MOVE PC-TOTAL-CUR-PERIOD          TO T3-TEXT.                15890000
159000     MOVE PV-TOTALS-CUR-PERIOD         TO PV-HLD-AMOUNTS.         15900000
159100     PERFORM L200-FORMAT-TOTALS.                                  15910000
159200                                                                  15920000
159300                                                                  15930000
159400 H100-PRINT-CLASS-MTD-TOTALS.                                     15940000
159500                                                                  15950000
159600     MOVE PC-TOTAL-MTD                 TO T3-TEXT.                15960000
159700     MOVE PV-CLASS-MTD                 TO PV-HLD-AMOUNTS.         15970000
159800     PERFORM L200-FORMAT-TOTALS.                                  15980000
159900                                                                  15990000
160000                                                                  16000000
160100 H200-PRINT-DEPT-MTD-TOTALS.                                      16010000
160200                                                                  16020000
160300     MOVE PC-TOTAL-MTD                 TO T3-TEXT.                16030000
160400     MOVE PV-DEPT-MTD                  TO PV-HLD-AMOUNTS.         16040000
160500     PERFORM L200-FORMAT-TOTALS.                                  16050000
160600                                                                  16060000
160700                                                                  16070000
160800 H300-PRINT-DMA-MTD-TOTALS.                                       16080000
160900                                                                  16090000
161000     MOVE PC-TOTAL-MTD                 TO T3-TEXT.                16100000
161100     MOVE PV-DMA-MTD                   TO PV-HLD-AMOUNTS.         16110000
161200     PERFORM L200-FORMAT-TOTALS.                                  16120000
161300                                                                  16130000
161400                                                                  16140000
161500 H400-PRINT-TOTALS-MTD-TOTALS.                                    16150000
161600                                                                  16160000
161700     MOVE PC-TOTAL-MTD                 TO T3-TEXT.                16170000
161800     MOVE PV-TOTALS-MTD                TO PV-HLD-AMOUNTS.         16180000
161900     PERFORM L200-FORMAT-TOTALS.                                  16190000
162000                                                                  16200000
162100                                                                  16210000
162200 L100-FORMAT-TRANSACTION-TOTALS.                                  16220000
162300                                                                  16230000
162400     MOVE PV-HLD-RETL-AMT         TO T2-RETL-AMT.                 16240000
162500     IF PV-HLD-RETL-AMT < ZEROS                                   16250000
162600         MOVE ZEROS               TO PV-POS                       16260000
162700         INSPECT T2-RETL-AMT TALLYING PV-POS FOR LEADING SPACE    16270000
162800         MOVE '('                 TO T2-RETL-AMT (PV-POS:1)       16280000
162900         MOVE ')'                 TO T2-RETL-NEG-IND-R            16290000
163000     ELSE                                                         16300000
163100         MOVE SPACES              TO T2-RETL-NEG-IND-R            16310000
163200     END-IF.                                                      16320000
163300                                                                  16330000
163400     MOVE PV-HLD-GRO-AMT          TO T2-GRO-AMT.                  16340000
163500     IF PV-HLD-GRO-AMT < ZEROS                                    16350000
163600         MOVE ZEROS               TO PV-POS                       16360000
163700         INSPECT T2-GRO-AMT TALLYING PV-POS FOR LEADING SPACE     16370000
163800         MOVE '('                 TO T2-GRO-AMT (PV-POS:1)        16380000
163900         MOVE ')'                 TO T2-GRO-NEG-IND-R             16390000
164000     ELSE                                                         16400000
164100         MOVE SPACES              TO T2-GRO-NEG-IND-R             16410000
164200     END-IF.                                                      16420000
164300                                                                  16430000
164400     MOVE PV-HLD-FRGT-AMT         TO T2-FRGT-AMT.                 16440000
164500     IF PV-HLD-FRGT-AMT < ZEROS                                   16450000
164600         MOVE ZEROS               TO PV-POS                       16460000
164700         INSPECT T2-FRGT-AMT TALLYING PV-POS FOR LEADING SPACE    16470000
164800         MOVE '('                 TO T2-FRGT-AMT (PV-POS:1)       16480000
164900         MOVE ')'                 TO T2-FRGT-NEG-IND-R            16490000
165000     ELSE                                                         16500000
165100         MOVE SPACES              TO T2-FRGT-NEG-IND-R            16510000
165200     END-IF.                                                      16520000
165300                                                                  16530000
165400     MOVE PV-HLD-MISC-AMT         TO T2-MISC-AMT.                 16540000
165500     IF PV-HLD-MISC-AMT < ZEROS                                   16550000
165600         MOVE ZEROS               TO PV-POS                       16560000
165700         INSPECT T2-MISC-AMT TALLYING PV-POS FOR LEADING SPACE    16570000
165800         MOVE '('                 TO T2-MISC-AMT (PV-POS:1)       16580000
165900         MOVE ')'                 TO T2-MISC-NEG-IND-R            16590000
166000     ELSE                                                         16600000
166100         MOVE SPACES              TO T2-MISC-NEG-IND-R            16610000
166200     END-IF.                                                      16620000
166300                                                                  16630000
166400     MOVE PV-HLD-NET-AMT          TO T2-NET-AMT.                  16640000
166500     IF PV-HLD-NET-AMT < ZEROS                                    16650000
166600         MOVE ZEROS               TO PV-POS                       16660000
166700         INSPECT T2-NET-AMT TALLYING PV-POS FOR LEADING SPACE     16670000
166800         MOVE '('                 TO T2-NET-AMT (PV-POS:1)        16680000
166900         MOVE ')'                 TO T2-NET-NEG-IND-R             16690000
167000     ELSE                                                         16700000
167100         MOVE SPACES              TO T2-NET-NEG-IND-R             16710000
167200     END-IF.                                                      16720000
167300                                                                  16730000
167400     MOVE PV-HLD-DISC-AMT         TO T2-DISC-AMT.                 16740000
167500     IF PV-HLD-DISC-AMT < ZEROS                                   16750000
167600         MOVE ZEROS               TO PV-POS                       16760000
167700         INSPECT T2-DISC-AMT TALLYING PV-POS FOR LEADING SPACE    16770000
167800         MOVE '('                 TO T2-DISC-AMT (PV-POS:1)       16780000
167900         MOVE ')'                 TO T2-DISC-NEG-IND-R            16790000
168000     ELSE                                                         16800000
168100         MOVE SPACES              TO T2-DISC-NEG-IND-R            16810000
168200     END-IF.                                                      16820000
168300                                                                  16830000
168400     IF (PV-LINES-PER-PAGE + 4) > PC-LINES-PER-PAGE-MAX           16840000
168500         PERFORM W100-WRITE-HEADINGS                              16850000
168600         PERFORM W200-WRITE-DETAIL-HEADINGS                       16860000
168700         MOVE  T1-HEADER1         TO PV-REPORT-REC                16870000
168800         MOVE +2                  TO PV-LINE-SKIP                 16880000
168900         PERFORM W300-PRINT-DETAIL                                16890000
169000         MOVE SPACES              TO PV-REPORT-REC                16900000
169100         MOVE +1                  TO PV-LINE-SKIP                 16910000
169200         PERFORM W300-PRINT-DETAIL                                16920000
169300     END-IF.                                                      16930000
169400                                                                  16940000
169500     MOVE  T2-DETAIL2             TO PV-REPORT-REC.               16950000
169600     MOVE +1                      TO PV-LINE-SKIP.                16960000
169700     PERFORM W300-PRINT-DETAIL.                                   16970000
169800                                                                  16980000
169900                                                                  16990000
170000 L200-FORMAT-TOTALS.                                              17000000
170100                                                                  17010000
170200     MOVE PV-HLD-RETL-AMT              TO T3-RETL-AMT.            17020000
170300     IF PV-HLD-RETL-AMT < ZEROS                                   17030000
170400         MOVE ZEROS                    TO PV-POS                  17040000
170500         INSPECT T3-RETL-AMT TALLYING PV-POS FOR LEADING SPACE    17050000
170600         MOVE '('                      TO T3-RETL-AMT (PV-POS:1)  17060000
170700         MOVE ')'                      TO T3-RETL-NEG-IND-R       17070000
170800     ELSE                                                         17080000
170900         MOVE SPACES                   TO T3-RETL-NEG-IND-R       17090000
171000     END-IF.                                                      17100000
171100                                                                  17110000
171200     MOVE PV-HLD-GRO-AMT               TO T3-GRO-AMT.             17120000
171300     IF PV-HLD-GRO-AMT < ZEROS                                    17130000
171400         MOVE ZEROS                    TO PV-POS                  17140000
171500         INSPECT T3-GRO-AMT TALLYING PV-POS FOR LEADING SPACE     17150000
171600         MOVE '('                      TO T3-GRO-AMT (PV-POS:1)   17160000
171700         MOVE ')'                      TO T3-GRO-NEG-IND-R        17170000
171800     ELSE                                                         17180000
171900         MOVE SPACES                   TO T3-GRO-NEG-IND-R        17190000
172000     END-IF.                                                      17200000
172100                                                                  17210000
172200     MOVE PV-HLD-FRGT-AMT              TO T3-FRGT-AMT.            17220000
172300     IF PV-HLD-FRGT-AMT < ZEROS                                   17230000
172400         MOVE ZEROS                    TO PV-POS                  17240000
172500         INSPECT T3-FRGT-AMT TALLYING PV-POS FOR LEADING SPACE    17250000
172600         MOVE '('                      TO T3-FRGT-AMT (PV-POS:1)  17260000
172700         MOVE ')'                      TO T3-FRGT-NEG-IND-R       17270000
172800     ELSE                                                         17280000
172900         MOVE SPACES                   TO T3-FRGT-NEG-IND-R       17290000
173000     END-IF.                                                      17300000
173100                                                                  17310000
173200     MOVE PV-HLD-MISC-AMT              TO T3-MISC-AMT.            17320000
173300     IF PV-HLD-MISC-AMT < ZEROS                                   17330000
173400         MOVE ZEROS                    TO PV-POS                  17340000
173500         INSPECT T3-MISC-AMT TALLYING PV-POS FOR LEADING SPACE    17350000
173600         MOVE '('                      TO T3-MISC-AMT (PV-POS:1)  17360000
173700         MOVE ')'                      TO T3-MISC-NEG-IND-R       17370000
173800     ELSE                                                         17380000
173900         MOVE SPACES                   TO T3-MISC-NEG-IND-R       17390000
174000     END-IF.                                                      17400000
174100                                                                  17410000
174200     MOVE PV-HLD-NET-AMT               TO T3-NET-AMT.             17420000
174300     IF PV-HLD-NET-AMT < ZEROS                                    17430000
174400         MOVE ZEROS                    TO PV-POS                  17440000
174500         INSPECT T3-NET-AMT TALLYING PV-POS FOR LEADING SPACE     17450000
174600         MOVE '('                      TO T3-NET-AMT (PV-POS:1)   17460000
174700         MOVE ')'                      TO T3-NET-NEG-IND-R        17470000
174800     ELSE                                                         17480000
174900         MOVE SPACES                   TO T3-NET-NEG-IND-R        17490000
175000     END-IF.                                                      17500000
175100                                                                  17510000
175200     MOVE PV-HLD-DISC-AMT              TO T3-DISC-AMT.            17520000
175300     IF PV-HLD-DISC-AMT < ZEROS                                   17530000
175400         MOVE ZEROS                    TO PV-POS                  17540000
175500         INSPECT T3-DISC-AMT TALLYING PV-POS FOR LEADING SPACE    17550000
175600         MOVE '('                      TO T3-DISC-AMT (PV-POS:1)  17560000
175700         MOVE ')'                      TO T3-DISC-NEG-IND-R       17570000
175800     ELSE                                                         17580000
175900         MOVE SPACES                   TO T3-DISC-NEG-IND-R       17590000
176000     END-IF.                                                      17600000
176100                                                                  17610000
176200     MOVE  T3-DETAIL3                  TO PV-REPORT-REC.          17620000
176300     MOVE +1                           TO PV-LINE-SKIP.           17630000
176400     PERFORM W300-PRINT-DETAIL.                                   17640000
176500                                                                  17650000
176600                                                                  17660000
176700 L500-FORMAT-DETAIL.                                              17670000
176800                                                                  17680000
176900     MOVE AP046-PO-NBR                 TO D2-PO-NBR.              17690000
177000     MOVE AP046-DOC-NBR                TO D2-DOC-NBR.             17700000
177100     MOVE AP046-INV-CUTOFF-DTE         TO D2-INV-CUTOFF-DTE.      17710001
177101     MOVE AP046-DOC-DTE                TO D2-DOC-DTE.             17710101
177110     MOVE AP046-ENTR-MM                TO D2-ENTR-DTE-MM.         17711001
177200     MOVE AP046-ENTR-DD                TO D2-ENTR-DTE-DD.         17720001
177300     MOVE AP046-ENTR-YY                TO D2-ENTR-DTE-YY.         17730001
177400     MOVE AP046-AP-TRN-CDE             TO D2-TRN-CDE.             17740000
177500     MOVE AP046-TRN-SHRT-DESC          TO D2-TRN-SHRT-DESC.       17750000
177600     MOVE AP046-STR-NBR                TO D2-LOCATION.            17760000
177700                                                                  17770000
177800     MOVE AP046-RETL-AMT               TO D2-RETL-AMT.            17780000
177900     IF AP046-RETL-AMT < ZEROS                                    17790000
178000         MOVE ZEROS                    TO PV-POS                  17800000
178100         INSPECT D2-RETL-AMT TALLYING PV-POS FOR LEADING SPACE    17810000
178200         MOVE '('                      TO D2-RETL-AMT (PV-POS:1)  17820000
178300         MOVE ')'                      TO D2-RETL-NEG-IND-R       17830000
178400     ELSE                                                         17840000
178500         MOVE SPACES                   TO D2-RETL-NEG-IND-R       17850000
178600     END-IF.                                                      17860000
178700                                                                  17870000
178800     MOVE AP046-GRO-COST-AMT           TO D2-GRO-AMT.             17880000
178900     IF AP046-GRO-COST-AMT < ZEROS                                17890000
179000         MOVE ZEROS                    TO PV-POS                  17900000
179100         INSPECT D2-GRO-AMT TALLYING PV-POS FOR LEADING SPACE     17910000
179200         MOVE '('                      TO D2-GRO-AMT (PV-POS:1)   17920000
179300         MOVE ')'                      TO D2-GRO-NEG-IND-R        17930000
179400     ELSE                                                         17940000
179500         MOVE SPACES                   TO D2-GRO-NEG-IND-R        17950000
179600     END-IF.                                                      17960000
179700                                                                  17970000
179800     MOVE AP046-FRGT-AMT               TO D2-FRGT-AMT.            17980000
179900     IF AP046-FRGT-AMT < ZEROS                                    17990000
180000         MOVE ZEROS                    TO PV-POS                  18000000
180100         INSPECT D2-FRGT-AMT TALLYING PV-POS FOR LEADING SPACE    18010000
180200         MOVE '('                      TO D2-FRGT-AMT (PV-POS:1)  18020000
180300         MOVE ')'                      TO D2-FRGT-NEG-IND-R       18030000
180400     ELSE                                                         18040000
180500         MOVE SPACES                   TO D2-FRGT-NEG-IND-R       18050000
180600     END-IF.                                                      18060000
180700                                                                  18070000
180800     MOVE AP046-MISC-CHRG-AMT          TO D2-MISC-AMT.            18080000
180900     IF AP046-MISC-CHRG-AMT < ZEROS                               18090000
181000         MOVE ZEROS                    TO PV-POS                  18100000
181100         INSPECT D2-MISC-AMT TALLYING PV-POS FOR LEADING SPACE    18110000
181200         MOVE '('                      TO D2-MISC-AMT (PV-POS:1)  18120000
181300         MOVE ')'                      TO D2-MISC-NEG-IND-R       18130000
181400     ELSE                                                         18140000
181500         MOVE SPACES                   TO D2-MISC-NEG-IND-R       18150000
181600     END-IF.                                                      18160000
181700                                                                  18170000
181800     MOVE AP046-NET-COST-AMT          TO D2-NET-AMT.              18180000
181900     IF AP046-NET-COST-AMT < ZEROS                                18190000
182000         MOVE ZEROS                    TO PV-POS                  18200000
182100         INSPECT D2-NET-AMT TALLYING PV-POS FOR LEADING SPACE     18210000
182200         MOVE '('                      TO D2-NET-AMT (PV-POS:1)   18220000
182300         MOVE ')'                      TO D2-NET-NEG-IND-R        18230000
182400     ELSE                                                         18240000
182500         MOVE SPACES                   TO D2-NET-NEG-IND-R        18250000
182600     END-IF.                                                      18260000
182700                                                                  18270000
182800     MOVE AP046-DISC-AMT               TO D2-DISC-AMT.            18280000
182900     IF AP046-DISC-AMT  < ZEROS                                   18290000
183000         MOVE ZEROS                    TO PV-POS                  18300000
183100         INSPECT D2-DISC-AMT TALLYING PV-POS FOR LEADING SPACE    18310000
183200         MOVE '('                      TO D2-DISC-AMT (PV-POS:1)  18320000
183300         MOVE ')'                      TO D2-DISC-NEG-IND-R       18330000
183400     ELSE                                                         18340000
183500         MOVE SPACES                   TO D2-DISC-NEG-IND-R       18350000
183600     END-IF.                                                      18360000
183700                                                                  18370000
183800     IF PS-NEED-VNDR-HEADNG                                       18380000
183900         IF (PV-LINES-PER-PAGE + 2) > PC-LINES-PER-PAGE-MAX       18390000
184000             PERFORM W100-WRITE-HEADINGS                          18400000
184100             PERFORM W200-WRITE-DETAIL-HEADINGS                   18410000
184200         END-IF                                                   18420000
184300         MOVE  D1-DETAIL1            TO PV-REPORT-REC             18430000
184400         MOVE +2                     TO PV-LINE-SKIP              18440000
184500         PERFORM W300-PRINT-DETAIL                                18450000
184600         SET PS-HAVE-VNDR-HEADNG     TO TRUE                      18460000
184700     END-IF.                                                      18470000
184800                                                                  18480000
184900     IF (PV-LINES-PER-PAGE + 1) > PC-LINES-PER-PAGE-MAX           18490000
185000         PERFORM W100-WRITE-HEADINGS                              18500000
185100         PERFORM W200-WRITE-DETAIL-HEADINGS                       18510000
185200         MOVE  D1-DETAIL1              TO PV-REPORT-REC           18520000
185300         MOVE +2                       TO PV-LINE-SKIP            18530000
185400         PERFORM W300-PRINT-DETAIL                                18540000
185500     END-IF.                                                      18550000
185600     MOVE  D2-DETAIL2                  TO PV-REPORT-REC.          18560000
185700     MOVE +1                           TO PV-LINE-SKIP.           18570000
185800     PERFORM W300-PRINT-DETAIL.                                   18580000
185900                                                                  18590000
186000                                                                  18600000
186100 L600-FORMAT-STORE-TOTALS.                                        18610000
186200                                                                  18620000
186300     MOVE SPACES                  TO T7-DETAIL7.                  18630000
186400                                                                  18640000
186500     MOVE PV-HLD-STR-NBR-1        TO T7-LOCATION-1.               18650000
186600     MOVE '-'                     TO T7-DASH-1.                   18660000
186700     MOVE PV-HLD-STR-NME-1        TO T7-LOCATION-NME-1.           18670000
186800                                                                  18680000
186900     MOVE PV-HLD-STR-CUR-NET-1    TO T7-CUR-NET-AMT-1.            18690000
187000     IF PV-HLD-STR-CUR-NET-1 < ZEROS                              18700000
187100         MOVE ZEROS               TO PV-POS                       18710000
187200         INSPECT T7-CUR-NET-AMT-1 TALLYING PV-POS                 18720000
187300             FOR LEADING SPACE                                    18730000
187400         MOVE '('                 TO T7-CUR-NET-AMT-1 (PV-POS:1)  18740000
187500         MOVE ')'                 TO T7-CUR-NET-NEG-IND-R-1       18750000
187600     ELSE                                                         18760000
187700         MOVE SPACES              TO T7-CUR-NET-NEG-IND-R-1       18770000
187800     END-IF.                                                      18780000
187900                                                                  18790000
188000     MOVE PV-HLD-STR-CUR-RETL-1   TO T7-CUR-RETL-AMT-1.           18800000
188100     IF PV-HLD-STR-CUR-RETL-1 < ZEROS                             18810000
188200         MOVE ZEROS               TO PV-POS                       18820000
188300         INSPECT T7-CUR-RETL-AMT-1 TALLYING PV-POS                18830000
188400             FOR LEADING SPACE                                    18840000
188500         MOVE '('                 TO T7-CUR-RETL-AMT-1 (PV-POS:1) 18850000
188600         MOVE ')'                 TO T7-CUR-RETL-NEG-IND-R-1      18860000
188700     ELSE                                                         18870000
188800         MOVE SPACES              TO T7-CUR-RETL-NEG-IND-R-1      18880000
188900     END-IF.                                                      18890000
189000                                                                  18900000
189100     MOVE PV-HLD-STR-MTD-NET-1    TO T7-MTD-NET-AMT-1.            18910000
189200     IF PV-HLD-STR-MTD-NET-1 < ZEROS                              18920000
189300         MOVE ZEROS               TO PV-POS                       18930000
189400         INSPECT T7-MTD-NET-AMT-1 TALLYING PV-POS                 18940000
189500             FOR LEADING SPACE                                    18950000
189600         MOVE '('                 TO T7-MTD-NET-AMT-1 (PV-POS:1)  18960000
189700         MOVE ')'                 TO T7-MTD-NET-NEG-IND-R-1       18970000
189800     ELSE                                                         18980000
189900         MOVE SPACES              TO T7-MTD-NET-NEG-IND-R-1       18990000
190000     END-IF.                                                      19000000
190100                                                                  19010000
190200     MOVE PV-HLD-STR-MTD-RETL-1   TO T7-MTD-RETL-AMT-1.           19020000
190300     IF PV-HLD-STR-MTD-RETL-1 < ZEROS                             19030000
190400         MOVE ZEROS               TO PV-POS                       19040000
190500         INSPECT T7-MTD-RETL-AMT-1 TALLYING PV-POS                19050000
190600             FOR LEADING SPACE                                    19060000
190700         MOVE '('                 TO T7-MTD-RETL-AMT-1 (PV-POS:1) 19070000
190800         MOVE ')'                 TO T7-MTD-RETL-NEG-IND-R-1      19080000
190900     ELSE                                                         19090000
191000         MOVE SPACES              TO T7-MTD-RETL-NEG-IND-R-1      19100000
191100     END-IF.                                                      19110000
191200                                                                  19120000
191300     IF PS-HAVE-2ND-SET                                           19130000
191400         MOVE PV-HLD-STR-NBR-2    TO T7-LOCATION-2                19140000
191500         MOVE '-'                 TO T7-DASH-2                    19150000
191600         MOVE PV-HLD-STR-NME-2    TO T7-LOCATION-NME-2            19160000
191700         MOVE PV-HLD-STR-CUR-NET-2                                19170000
191800                                  TO T7-CUR-NET-AMT-2             19180000
191900         IF PV-HLD-STR-CUR-NET-2 < ZEROS                          19190000
192000             MOVE ZEROS           TO PV-POS                       19200000
192100             INSPECT T7-CUR-NET-AMT-2 TALLYING PV-POS             19210000
192200                 FOR LEADING SPACE                                19220000
192300             MOVE '('             TO T7-CUR-NET-AMT-2 (PV-POS:1)  19230000
192400             MOVE ')'             TO T7-CUR-NET-NEG-IND-R-2       19240000
192500         ELSE                                                     19250000
192600             MOVE SPACES          TO T7-CUR-NET-NEG-IND-R-2       19260000
192700         END-IF                                                   19270000
192800                                                                  19280000
192900         MOVE PV-HLD-STR-CUR-RETL-2                               19290000
193000                                  TO T7-CUR-RETL-AMT-2            19300000
193100         IF PV-HLD-STR-CUR-RETL-2 < ZEROS                         19310000
193200             MOVE ZEROS           TO PV-POS                       19320000
193300             INSPECT T7-CUR-RETL-AMT-2 TALLYING PV-POS            19330000
193400                 FOR LEADING SPACE                                19340000
193500             MOVE '('             TO T7-CUR-RETL-AMT-2 (PV-POS:1) 19350000
193600             MOVE ')'             TO T7-CUR-RETL-NEG-IND-R-2      19360000
193700         ELSE                                                     19370000
193800             MOVE SPACES          TO T7-CUR-RETL-NEG-IND-R-2      19380000
193900         END-IF                                                   19390000
194000                                                                  19400000
194100         MOVE PV-HLD-STR-MTD-NET-2                                19410000
194200                                  TO T7-MTD-NET-AMT-2             19420000
194300         IF PV-HLD-STR-MTD-NET-2 < ZEROS                          19430000
194400             MOVE ZEROS           TO PV-POS                       19440000
194500             INSPECT T7-MTD-NET-AMT-2 TALLYING PV-POS             19450000
194600                 FOR LEADING SPACE                                19460000
194700             MOVE '('             TO T7-MTD-NET-AMT-2 (PV-POS:1)  19470000
194800             MOVE ')'             TO T7-MTD-NET-NEG-IND-R-2       19480000
194900         ELSE                                                     19490000
195000             MOVE SPACES          TO T7-MTD-NET-NEG-IND-R-2       19500000
195100         END-IF                                                   19510000
195200                                                                  19520000
195300         MOVE PV-HLD-STR-MTD-RETL-2                               19530000
195400                                  TO T7-MTD-RETL-AMT-2            19540000
195500         IF PV-HLD-STR-MTD-RETL-2 < ZEROS                         19550000
195600             MOVE ZEROS           TO PV-POS                       19560000
195700             INSPECT T7-MTD-RETL-AMT-2 TALLYING PV-POS            19570000
195800                 FOR LEADING SPACE                                19580000
195900             MOVE '('             TO T7-MTD-RETL-AMT-2 (PV-POS:1) 19590000
196000             MOVE ')'             TO T7-MTD-RETL-NEG-IND-R-2      19600000
196100         ELSE                                                     19610000
196200             MOVE SPACES          TO T7-MTD-RETL-NEG-IND-R-2      19620000
196300         END-IF                                                   19630000
196400     END-IF.                                                      19640000
196500                                                                  19650000
196600     MOVE  T7-DETAIL7                  TO PV-REPORT-REC.          19660000
196700     MOVE +1                           TO PV-LINE-SKIP.           19670000
196800     PERFORM W300-PRINT-DETAIL.                                   19680000
196900                                                                  19690000
197000     INITIALIZE PV-HLD-STORE-1.                                   19700000
197100     INITIALIZE PV-HLD-STORE-2.                                   19710000
197200     SET PS-NEED-1ST-SET                                          19720000
197300         PS-NEED-2ND-SET TO TRUE.                                 19730000
197400                                                                  19740000
197500                                                                  19750000
197600 P100-ACCUMULATE-TRN-TOTALS.                                      19760000
197700                                                                  19770000
197800     SET PS-CL-TOTALS                                             19780000
197900         PS-DP-TOTALS                                             19790000
198000         PS-DM-TOTALS                                             19800000
198100         PS-TL-TOTALS              TO TRUE.                       19810000
198200                                                                  19820000
198300     PERFORM WITH TEST AFTER VARYING TRN-IDX FROM 1 BY 1          19830000
198400       UNTIL AP046-AP-TRN-CDE = PV-TR-TRANCODE (TRN-IDX)          19840000
198500          OR PV-TR-TRANCODE (TRN-IDX) = SPACES                    19850000
198600          OR TRN-IDX > 999                                        19860000
198700       IF PV-TR-TRANCODE (TRN-IDX) = SPACES                       19870000
198800       OR TRN-IDX > 999                                           19880000
198900          MOVE 'P100-ACCUMULATE-TRN-TOTALS'                       19890000
199000                                      TO AA-PARAGRAPH-NAME        19900000
199100          MOVE 'TRANCODE NOT FOUND IN TABLE'                      19910000
199200                                      TO AA-MESSAGE-1             19920000
199300          DISPLAY 'TRANCODE = ' AP046-AP-TRN-CDE                  19930000
199400          SET AC-INVALID-DATA    TO TRUE                          19940000
199410          PERFORM Z998-ABEND                                      19941000
199420       ELSE                                                       19942000
199430          MOVE PV-TR-SUBSCRIPT (TRN-IDX) TO TRN-SUB               19943000
199440       END-IF                                                     19944000
199450     END-PERFORM.                                                 19945000
199460                                                                  19946000
199470**** MOVE AP046-AP-TRN-CDE         TO TRN-SUB.                    19947000
199480     IF PV-CL-DESC (TRN-SUB) = SPACES                             19948000
199490         MOVE AP046-AP-TRN-CDE     TO PV-CL-TRANCODE (TRN-SUB)    19949000
199491                                      PV-DP-TRANCODE (TRN-SUB)    19949100
199492                                      PV-DM-TRANCODE (TRN-SUB)    19949200
199493                                      PV-TL-TRANCODE (TRN-SUB)    19949300
199494                                                                  19949400
199495         MOVE AP046-TRN-SHRT-DESC  TO PV-CL-DESC (TRN-SUB)        19949500
199496                                      PV-DP-DESC (TRN-SUB)        19949600
199497                                      PV-DM-DESC (TRN-SUB)        19949700
199498                                      PV-TL-DESC (TRN-SUB)        19949800
199499     END-IF.                                                      19949900
199500                                                                  19950000
199600     ADD AP046-RETL-AMT            TO PV-CL-RETL-AMT (TRN-SUB)    19960000
199610                                      PV-DP-RETL-AMT (TRN-SUB)    19961000
199620                                      PV-DM-RETL-AMT (TRN-SUB)    19962000
199630                                      PV-TL-RETL-AMT (TRN-SUB).   19963000
199640                                                                  19964000
199650     ADD AP046-GRO-COST-AMT        TO PV-CL-GRO-AMT (TRN-SUB)     19965000
199660                                      PV-DP-GRO-AMT (TRN-SUB)     19966000
199670                                      PV-DM-GRO-AMT (TRN-SUB)     19967000
199680                                      PV-TL-GRO-AMT (TRN-SUB).    19968000
199690                                                                  19969000
199700     ADD AP046-FRGT-AMT            TO PV-CL-FRGT-AMT (TRN-SUB)    19970000
199800                                      PV-DP-FRGT-AMT (TRN-SUB)    19980000
199900                                      PV-DM-FRGT-AMT (TRN-SUB)    19990000
200000                                      PV-TL-FRGT-AMT (TRN-SUB).   20000000
200100                                                                  20010000
200200     ADD AP046-MISC-CHRG-AMT       TO PV-CL-MISC-AMT (TRN-SUB)    20020000
200300                                      PV-DP-MISC-AMT (TRN-SUB)    20030000
200400                                      PV-DM-MISC-AMT (TRN-SUB)    20040000
200500                                      PV-TL-MISC-AMT (TRN-SUB).   20050000
200600                                                                  20060000
200700     ADD AP046-NET-COST-AMT         TO PV-CL-NET-AMT (TRN-SUB)    20070000
200800                                       PV-DP-NET-AMT (TRN-SUB)    20080000
200900                                       PV-DM-NET-AMT (TRN-SUB)    20090000
201000                                       PV-TL-NET-AMT (TRN-SUB).   20100000
201100                                                                  20110000
201200     ADD AP046-DISC-AMT             TO PV-CL-DISC-AMT (TRN-SUB)   20120000
201300                                       PV-DP-DISC-AMT (TRN-SUB)   20130000
201400                                       PV-DM-DISC-AMT (TRN-SUB)   20140000
201500                                       PV-TL-DISC-AMT (TRN-SUB).  20150000
201600                                                                  20160000
201700                                                                  20170000
201800 P200-ACCUMULATE-CUR-TOTALS.                                      20180000
201900                                                                  20190000
202000     ADD AP046-RETL-AMT      TO PV-CL-CUR-RETL-AMT                20200000
202100                                PV-DP-CUR-RETL-AMT                20210000
202200                                PV-DM-CUR-RETL-AMT                20220000
202300                                PV-TL-CUR-RETL-AMT                20230000
202400                                PV-ST-CL-CUR-RETL-AMT (STR-SUB)   20240000
202500                                PV-ST-DP-CUR-RETL-AMT (STR-SUB)   20250000
202600                                PV-ST-DM-CUR-RETL-AMT (STR-SUB)   20260000
202700                                PV-ST-TL-CUR-RETL-AMT (STR-SUB).  20270000
202800                                                                  20280000
202900     ADD AP046-GRO-COST-AMT  TO PV-CL-CUR-GRO-AMT                 20290000
203000                                PV-DP-CUR-GRO-AMT                 20300000
203100                                PV-DM-CUR-GRO-AMT                 20310000
203200                                PV-TL-CUR-GRO-AMT.                20320000
203300                                                                  20330000
203400     ADD AP046-FRGT-AMT      TO PV-CL-CUR-FRGT-AMT                20340000
203500                                PV-DP-CUR-FRGT-AMT                20350000
203600                                PV-DM-CUR-FRGT-AMT                20360000
203700                                PV-TL-CUR-FRGT-AMT.               20370000
203800                                                                  20380000
203900     ADD AP046-MISC-CHRG-AMT TO PV-CL-CUR-MISC-AMT                20390000
204000                                PV-DP-CUR-MISC-AMT                20400000
204100                                PV-DM-CUR-MISC-AMT                20410000
204200                                PV-TL-CUR-MISC-AMT.               20420000
204300                                                                  20430000
204400     ADD AP046-NET-COST-AMT  TO PV-CL-CUR-NET-AMT                 20440000
204500                                PV-DP-CUR-NET-AMT                 20450000
204600                                PV-DM-CUR-NET-AMT                 20460000
204700                                PV-TL-CUR-NET-AMT                 20470000
204800                                PV-ST-CL-CUR-NET-AMT (STR-SUB)    20480000
204900                                PV-ST-DP-CUR-NET-AMT (STR-SUB)    20490000
205000                                PV-ST-DM-CUR-NET-AMT (STR-SUB)    20500000
205100                                PV-ST-TL-CUR-NET-AMT (STR-SUB).   20510000
205200                                                                  20520000
205300     ADD AP046-DISC-AMT      TO PV-CL-CUR-DISC-AMT                20530000
205400                                PV-DP-CUR-DISC-AMT                20540000
205500                                PV-DM-CUR-DISC-AMT                20550000
205600                                PV-TL-CUR-DISC-AMT.               20560000
205700                                                                  20570000
205800                                                                  20580000
205900 P300-ACCUMULATE-MTD-TOTALS.                                      20590000
206000                                                                  20600000
206100     ADD AP046-RETL-AMT      TO PV-CL-MTD-RETL-AMT                20610000
206200                                PV-DP-MTD-RETL-AMT                20620000
206300                                PV-DM-MTD-RETL-AMT                20630000
206400                                PV-TL-MTD-RETL-AMT                20640000
206500                                PV-ST-CL-MTD-RETL-AMT (STR-SUB)   20650000
206600                                PV-ST-DP-MTD-RETL-AMT (STR-SUB)   20660000
206700                                PV-ST-DM-MTD-RETL-AMT (STR-SUB)   20670000
206800                                PV-ST-TL-MTD-RETL-AMT (STR-SUB).  20680000
206900                                                                  20690000
207000     ADD AP046-GRO-COST-AMT  TO PV-CL-MTD-GRO-AMT                 20700000
207100                                PV-DP-MTD-GRO-AMT                 20710000
207200                                PV-DM-MTD-GRO-AMT                 20720000
207300                                PV-TL-MTD-GRO-AMT.                20730000
207400                                                                  20740000
207500     ADD AP046-FRGT-AMT      TO PV-CL-MTD-FRGT-AMT                20750000
207600                                PV-DP-MTD-FRGT-AMT                20760000
207700                                PV-DM-MTD-FRGT-AMT                20770000
207800                                PV-TL-MTD-FRGT-AMT.               20780000
207900                                                                  20790000
208000     ADD AP046-MISC-CHRG-AMT TO PV-CL-MTD-MISC-AMT                20800000
208100                                PV-DP-MTD-MISC-AMT                20810000
208200                                PV-DM-MTD-MISC-AMT                20820000
208300                                PV-TL-MTD-MISC-AMT.               20830000
208400                                                                  20840000
208500     ADD AP046-NET-COST-AMT  TO PV-CL-MTD-NET-AMT                 20850000
208600                                PV-DP-MTD-NET-AMT                 20860000
208700                                PV-DM-MTD-NET-AMT                 20870000
208800                                PV-TL-MTD-NET-AMT                 20880000
208900                                PV-ST-CL-MTD-NET-AMT (STR-SUB)    20890000
209000                                PV-ST-DP-MTD-NET-AMT (STR-SUB)    20900000
209100                                PV-ST-DM-MTD-NET-AMT (STR-SUB)    20910000
209200                                PV-ST-TL-MTD-NET-AMT (STR-SUB).   20920000
209300                                                                  20930000
209400     ADD AP046-DISC-AMT       TO PV-CL-MTD-DISC-AMT               20940000
209500                                 PV-DP-MTD-DISC-AMT               20950000
209600                                 PV-DM-MTD-DISC-AMT               20960000
209700                                 PV-TL-MTD-DISC-AMT.              20970000
209800                                                                  20980000
209900                                                                  20990000
210000 R100-READ-INPUT.                                                 21000000
210100*----------------------------------------------------------------*21010000
210200*    READ ADJUSTMENT EXTRACT FILE.                               *21020000
210300*----------------------------------------------------------------*21030000
210400                                                                  21040000
210500     READ ADJ-EXTRACT-FILE INTO AP046-EXTRACT-FILE                21050000
210600         AT END                                                   21060000
210700             SET PS-ADJ-EOF TO TRUE.                              21070000
210800                                                                  21080000
210900     IF PS-ADJ-NOT-EOF                                            21090000
211000         ADD 1                   TO PV-READ-COUNT                 21100000
211100     END-IF.                                                      21110000
211200                                                                  21120000
211300                                                                  21130000
211400 S100-GET-CURRENT-PSTG-PERIOD.                                    21140000
211500*----------------------------------------------------------------*21150000
211600*   RETRIEVES THE CURRENT POSTING PERIOD.                        *21160000
211700*----------------------------------------------------------------*21170000
211800                                                                  21180000
211900     PERFORM WITH TEST AFTER                                      21190000
212000             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 21200000
212100             UNTIL   PV-RETRY-COUNTER > 3  OR                     21210000
212200                     SQLCODE = ZERO OR                            21220000
212300                     SQLCODE = +100                               21230000
212400                                                                  21240000
212500         EXEC SQL                                                 21250000
212600             SELECT  BTCH_PRC_DTE                                 21260000
212700                    ,CURR_PSTG_FWK_NBR                            21270000
212800               INTO :APCNTL-BTCH-PRC-DTE                          21280000
212900                   ,:APCNTL-CURR-PSTG-FWK-NBR                     21290000
213000               FROM  TAPCNTL                                      21300000
213100         END-EXEC                                                 21310000
213200                                                                  21320000
213300         EVALUATE TRUE                                            21330000
213400           WHEN SQLCODE = ZERO                                    21340000
213500             CONTINUE                                             21350000
213600           WHEN SQLWARN0 NOT = SPACES                             21360000
213700           WHEN SQLCODE NOT  = ZERO                               21370000
213800             MOVE 'S100-GET-CURRENT-PSTG-PERIOD'                  21380000
213900                                 TO AA-PARAGRAPH-NAME             21390000
214000             MOVE 'UNSUCCESSFUL SELECT'                           21400000
214100                                 TO AA-DB2-OPERATION              21410000
214200             MOVE 'TAPCNTL'      TO AA-DB2-TABLE-1                21420000
214300             MOVE SPACES         TO AA-DB2-TABLE-2                21430000
214400                                    AA-DB2-TABLE-3                21440000
214500             PERFORM Z999-DB2-ABEND                               21450000
214600         END-EVALUATE                                             21460000
214700     END-PERFORM.                                                 21470000
214800                                                                  21480000
214900     IF PV-RETRY-COUNTER > 3                                      21490000
215000         MOVE 'S100-GET-CURRENT-PSTG-PERIOD'                      21500000
215100                                 TO AA-PARAGRAPH-NAME             21510000
215200         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    21520000
215300                                 TO AA-DB2-OPERATION              21530000
215400         MOVE 'TAPCNTL'          TO AA-DB2-TABLE-1                21540000
215500         MOVE SPACES             TO AA-DB2-TABLE-2                21550000
215600                                    AA-DB2-TABLE-3                21560000
215700         PERFORM Z999-DB2-ABEND                                   21570000
215800     END-IF.                                                      21580000
215900                                                                  21590000
216000                                                                  21600000
216100 S200-GET-PREVIOUS-PSTG-PERIOD.                                   21610000
216200*----------------------------------------------------------------*21620000
216300*   RETRIEVES THE PREVIOUS POSTING PERIOD.                       *21630000
216400*----------------------------------------------------------------*21640000
216500                                                                  21650000
216600     PERFORM WITH TEST AFTER                                      21660000
216700             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 21670000
216800             UNTIL   PV-RETRY-COUNTER > 3  OR                     21680000
216900                     SQLCODE = ZERO OR                            21690000
217000                     SQLCODE = +100                               21700000
217100                                                                  21710000
217200         EXEC SQL                                                 21720000
217300             SELECT BTCH_PRC_DTE                                  21730000
217400                  , PREV_PSTG_FYR_NBR                             21740000
217500                  , PREV_PSTG_FMN_NBR                             21750000
217600               INTO :APCNTL-BTCH-PRC-DTE                          21760000
217700                  , :APCNTL-PREV-PSTG-FYR-NBR                     21770000
217800                  , :APCNTL-PREV-PSTG-FMN-NBR                     21780000
217900               FROM TAPCNTL                                       21790000
218000         END-EXEC                                                 21800000
218100                                                                  21810000
218200         EVALUATE TRUE                                            21820000
218300           WHEN SQLCODE = ZERO                                    21830000
218400             CONTINUE                                             21840000
218500           WHEN SQLWARN0 NOT = SPACES                             21850000
218600           WHEN SQLCODE NOT  = ZERO                               21860000
218700             MOVE 'S200-GET-PREVIOUS-PSTG-PERIOD'                 21870000
218800                                 TO AA-PARAGRAPH-NAME             21880000
218900             MOVE 'UNSUCCESSFUL SELECT'                           21890000
219000                                 TO AA-DB2-OPERATION              21900000
219100             MOVE 'TAPCNTL'      TO AA-DB2-TABLE-1                21910000
219200             MOVE SPACES         TO AA-DB2-TABLE-2                21920000
219300                                    AA-DB2-TABLE-3                21930000
219400             PERFORM Z999-DB2-ABEND                               21940000
219500         END-EVALUATE                                             21950000
219600     END-PERFORM.                                                 21960000
219700                                                                  21970000
219800     IF PV-RETRY-COUNTER > 3                                      21980000
219900         MOVE 'S200-GET-PREVIOUS-PSTG-PERIOD'                     21990000
220000                                 TO AA-PARAGRAPH-NAME             22000000
220100         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    22010000
220200                                 TO AA-DB2-OPERATION              22020000
220300         MOVE 'TAPCNTL'          TO AA-DB2-TABLE-1                22030000
220400         MOVE SPACES             TO AA-DB2-TABLE-2                22040000
220500                                    AA-DB2-TABLE-3                22050000
220600         PERFORM Z999-DB2-ABEND                                   22060000
220700     END-IF.                                                      22070000
220800                                                                  22080000
220900                                                                  22090000
221000 S300-GET-DMA-NAME.                                               22100000
221100*----------------------------------------------------------------*22110000
221200*   RETRIEVES THE DMA NAME.                                      *22120000
221300*----------------------------------------------------------------*22130000
221400                                                                  22140000
221500                                                                  22150000
221600     PERFORM WITH TEST AFTER                                      22160000
221700             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 22170000
221800             UNTIL   PV-RETRY-COUNTER > 3  OR                     22180000
221900                     SQLCODE = ZERO OR                            22190000
222000                     SQLCODE = +100                               22200000
222100         EXEC SQL                                                 22210000
222200             SELECT  B.WORKER_LAST_NAME                           22220000
222300                    ,B.WORKER_FIR_NAME                            22230000
222400               INTO  :RSPBAR-WORKER-LAST-NAME                     22240000
222500                    ,:RSPBAR-WORKER-FIR-NAME                      22250000
222600               FROM  TMDSEAR A                                    22260000
222700                    ,TRSPBAR B                                    22270000
222800              WHERE  A.MDSEAR_DKEY        = B.MDSEAR_DKEY         22280000
222900                AND  A.OPERCO_NBR         = '03'                  22290000
223000                AND  A.DMA_NBR            = :MDSEAR-DMA-NBR       22300000
223100                AND  B.RSPLVL_CDE         = 'DMM'                 22310000
223200                AND  A.MDSELV_CDE         = 'DMA'                 22320000
223300                AND  CURRENT DATE BETWEEN A.STRT_DTE AND A.END_DTE22330000
223400                AND  CURRENT DATE BETWEEN B.WORKER_STRT_DTE       22340000
223500                                      AND B.WORKER_END_DTE        22350000
223600         END-EXEC                                                 22360000
223700                                                                  22370000
223800         EVALUATE TRUE                                            22380000
223900           WHEN SQLCODE = ZERO                                    22390000
224000             CONTINUE                                             22400000
224100           WHEN SQLWARN0 NOT = SPACES                             22410000
224200           WHEN SQLCODE NOT  = ZERO                               22420000
224300             MOVE 'S300-GET-DMA-NAME'                             22430000
224400                                 TO AA-PARAGRAPH-NAME             22440000
224500             MOVE 'UNSUCCESSFUL SELECT'                           22450000
224600                                 TO AA-DB2-OPERATION              22460000
224700             MOVE 'DMA NBR'      TO AA-MESSAGE-1                  22470000
224800             MOVE MDSEAR-DMA-NBR TO AA-MESSAGE-2                  22480000
224900             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                22490000
225000             MOVE 'TRSPBAR'      TO AA-DB2-TABLE-2                22500000
225100             MOVE SPACES         TO AA-DB2-TABLE-3                22510000
225200             PERFORM Z999-DB2-ABEND                               22520000
225300         END-EVALUATE                                             22530000
225400     END-PERFORM.                                                 22540000
225500                                                                  22550000
225600     IF PV-RETRY-COUNTER > 3                                      22560000
225700         MOVE 'S300-GET-DMA-NAME'                                 22570000
225800                                 TO AA-PARAGRAPH-NAME             22580000
225900         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    22590000
226000                                 TO AA-DB2-OPERATION              22600000
226100         MOVE 'TMDSEAR'          TO AA-DB2-TABLE-1                22610000
226200         MOVE 'TRSPBAR'          TO AA-DB2-TABLE-2                22620000
226300         MOVE SPACES             TO AA-DB2-TABLE-3                22630000
226400         PERFORM Z999-DB2-ABEND                                   22640000
226500     END-IF.                                                      22650000
226600                                                                  22660000
226700                                                                  22670000
226800 S400-GET-DEPT-NAME.                                              22680000
226900*----------------------------------------------------------------*22690000
227000*   RETRIEVES THE DEPARTMENT NAME.                               *22700000
227100*----------------------------------------------------------------*22710000
227200                                                                  22720000
227300     PERFORM WITH TEST AFTER                                      22730000
227400             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 22740000
227500             UNTIL   PV-RETRY-COUNTER > 3  OR                     22750000
227600                     SQLCODE = ZERO OR                            22760000
227700                     SQLCODE = +100                               22770000
227800                                                                  22780000
227900         EXEC SQL                                                 22790000
228000             SELECT  MDSEAR_DESC                                  22800000
228100               INTO :MDSEAR-DESC                                  22810000
228200               FROM  TMDSEAR                                      22820000
228300              WHERE  OPERCO_NBR           = '03'                  22830000
228400                AND  DEPT_NBR             = :MDSEAR-DEPT-NBR      22840000
228500                AND  MDSELV_CDE           = 'DPT'                 22850000
228600                AND  CURRENT DATE   BETWEEN STRT_DTE              22860000
228700                                        AND END_DTE               22870000
228800         END-EXEC                                                 22880000
228900                                                                  22890000
229000         EVALUATE TRUE                                            22900000
229100           WHEN SQLCODE = ZERO                                    22910000
229200             CONTINUE                                             22920000
229300           WHEN SQLWARN0 NOT = SPACES                             22930000
229400           WHEN SQLCODE NOT  = ZERO                               22940000
229500             MOVE 'S400-GET-DEPT-NAME'                            22950000
229600                                 TO AA-PARAGRAPH-NAME             22960000
229700             MOVE 'UNSUCCESSFUL SELECT'                           22970000
229800                                 TO AA-DB2-OPERATION              22980000
229900             MOVE 'DEPT NBR'     TO AA-MESSAGE-1                  22990000
230000             MOVE MDSEAR-DEPT-NBR                                 23000000
230100                                 TO AA-MESSAGE-2                  23010000
230200             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                23020000
230300             MOVE SPACES         TO AA-DB2-TABLE-2                23030000
230400                                    AA-DB2-TABLE-3                23040000
230500             PERFORM Z999-DB2-ABEND                               23050000
230600         END-EVALUATE                                             23060000
230700     END-PERFORM.                                                 23070000
230800                                                                  23080000
230900     IF PV-RETRY-COUNTER > 3                                      23090000
231000         MOVE 'S400-GET-DEPT-NAME'                                23100000
231100                                 TO AA-PARAGRAPH-NAME             23110000
231200         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    23120000
231300                                 TO AA-DB2-OPERATION              23130000
231400         MOVE 'TMDSEAR'          TO AA-DB2-TABLE-1                23140000
231500         MOVE SPACES             TO AA-DB2-TABLE-2                23150000
231600                                    AA-DB2-TABLE-3                23160000
231700         PERFORM Z999-DB2-ABEND                                   23170000
231800     END-IF.                                                      23180000
231900                                                                  23190000
232000                                                                  23200000
232100 S500-GET-MAJOR-CLASS-DESC.                                       23210000
232200*----------------------------------------------------------------*23220000
232300*   RETRIEVES THE MAJOR CLASS DESCRIPTION                        *23230000
232400*----------------------------------------------------------------*23240000
232500                                                                  23250000
232600     PERFORM WITH TEST AFTER                                      23260000
232700             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 23270000
232800             UNTIL   PV-RETRY-COUNTER > 3  OR                     23280000
232900                     SQLCODE = ZERO OR                            23290000
233000                     SQLCODE = +100                               23300000
233100                                                                  23310000
233200         EXEC SQL                                                 23320000
233300             SELECT  MDSEAR_DESC                                  23330000
233400               INTO :MDSEAR-DESC                                  23340000
233500               FROM  TMDSEAR                                      23350000
233600              WHERE  OPERCO_NBR           = '03'                  23360000
233700                AND  DEPT_NBR             = :MDSEAR-DEPT-NBR      23370000
233800                AND  MAJ_CL_NBR           = :MDSEAR-MAJ-CL-NBR    23380000
233900                AND  MDSELV_CDE           = 'MCL'                 23390000
234000                AND  CURRENT DATE   BETWEEN STRT_DTE              23400000
234100                                        AND END_DTE               23410000
234200         END-EXEC                                                 23420000
234300                                                                  23430000
234400         EVALUATE TRUE                                            23440000
234500           WHEN SQLCODE = ZERO                                    23450000
234600             CONTINUE                                             23460000
234700           WHEN SQLWARN0 NOT = SPACES                             23470000
234800           WHEN SQLCODE NOT  = ZERO                               23480000
234900             MOVE 'S500-GET-MAJOR-CLASS-DESC'                     23490000
235000                                 TO AA-PARAGRAPH-NAME             23500000
235100             MOVE 'UNSUCCESSFUL SELECT'                           23510000
235200                                 TO AA-DB2-OPERATION              23520000
235300             MOVE 'MAJOR CLASS'  TO AA-MESSAGE-1                  23530000
235400             MOVE MDSEAR-MAJ-CL-NBR                               23540000
235500                                 TO AA-MESSAGE-2                  23550000
235600             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                23560000
235700             MOVE SPACES         TO AA-DB2-TABLE-2                23570000
235800                                    AA-DB2-TABLE-3                23580000
235900             PERFORM Z999-DB2-ABEND                               23590000
236000         END-EVALUATE                                             23600000
236100     END-PERFORM.                                                 23610000
236200                                                                  23620000
236300     IF PV-RETRY-COUNTER > 3                                      23630000
236400         MOVE 'S500-GET-MAJOR-CLASS-DESC'                         23640000
236500                                 TO AA-PARAGRAPH-NAME             23650000
236600         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    23660000
236700                                 TO AA-DB2-OPERATION              23670000
236800         MOVE 'TMDSEAR'          TO AA-DB2-TABLE-1                23680000
236900         MOVE SPACES             TO AA-DB2-TABLE-2                23690000
237000                                    AA-DB2-TABLE-3                23700000
237100         PERFORM Z999-DB2-ABEND                                   23710000
237200     END-IF.                                                      23720000
237300                                                                  23730000
237400                                                                  23740000
237500 S600-GET-BUYER-NAME.                                             23750000
237600*----------------------------------------------------------------*23760000
237700*   RETRIEVES THE BUYER NUMBER AND NAME                          *23770000
237800*----------------------------------------------------------------*23780000
237900                                                                  23790000
238000     PERFORM WITH TEST AFTER                                      23800000
238100             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 23810000
238200             UNTIL   PV-RETRY-COUNTER > 3  OR                     23820000
238300                     SQLCODE = ZERO OR                            23830000
238400                     SQLCODE = +100                               23840000
238500                                                                  23850000
238600         EXEC SQL                                                 23860000
238700             SELECT  B.WORKER_LAST_NAME                           23870000
238800                    ,B.WORKER_FIR_NAME                            23880000
238900                    ,A.BYR_NBR                                    23890000
239000               INTO  :RSPBAR-WORKER-LAST-NAME                     23900000
239100                    ,:RSPBAR-WORKER-FIR-NAME                      23910000
239200                    ,:MDSEAR-BYR-NBR                              23920000
239300               FROM  TMDSEAR A                                    23930000
239400                    ,TRSPBAR B                                    23940000
239500              WHERE  A.MDSEAR_DKEY        = B.MDSEAR_DKEY         23950000
239600                AND  A.OPERCO_NBR         = '03'                  23960000
239700                AND  A.DEPT_NBR           = :MDSEAR-DEPT-NBR      23970000
239800                AND  B.RSPLVL_CDE         = 'BYR'                 23980000
239900                AND  A.MDSELV_CDE         = 'DPT'                 23990000
240000                AND  CURRENT DATE BETWEEN A.STRT_DTE AND A.END_DTE24000000
240100                AND  CURRENT DATE BETWEEN B.WORKER_STRT_DTE       24010000
240200                                      AND B.WORKER_END_DTE        24020000
240300         END-EXEC                                                 24030000
240400                                                                  24040000
240500         EVALUATE TRUE                                            24050000
240600           WHEN SQLCODE = ZERO                                    24060000
240700             CONTINUE                                             24070000
183500           WHEN SQLCODE = +100                                    24071006
                   DISPLAY 'DEPT NBR ' MDSEAR-DEPT-NBR                  24072006
183600             CONTINUE                                             24073006
240800           WHEN SQLWARN0 NOT = SPACES                             24080000
240900           WHEN SQLCODE NOT  = ZERO                               24090000
241000             MOVE 'S600-GET-BUYER-NAME'                           24100000
241100                                 TO AA-PARAGRAPH-NAME             24110000
241200             MOVE 'UNSUCCESSFUL SELECT'                           24120000
241300                                 TO AA-DB2-OPERATION              24130000
241400             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                24140000
241500             MOVE 'TRSPBAR'      TO AA-DB2-TABLE-2                24150000
241600             MOVE SPACES         TO AA-DB2-TABLE-3                24160000
241700             PERFORM Z999-DB2-ABEND                               24170000
241800         END-EVALUATE                                             24180000
241900     END-PERFORM.                                                 24190000
242000                                                                  24200000
242100     IF PV-RETRY-COUNTER > 3                                      24210000
242200         MOVE 'S600-GET-BUYER-NAME'                               24220000
242300                                 TO AA-PARAGRAPH-NAME             24230000
242400         MOVE 'MAX RETRIES EXCEEDED ON SELECT'                    24240000
242500                                 TO AA-DB2-OPERATION              24250000
242600         MOVE 'TMDSEAR'          TO AA-DB2-TABLE-1                24260000
242700         MOVE 'TRSPBAR'          TO AA-DB2-TABLE-2                24270000
242800         MOVE SPACES             TO AA-DB2-TABLE-3                24280000
242900         PERFORM Z999-DB2-ABEND                                   24290000
243000     END-IF.                                                      24300000
243100                                                                  24310000
243200 S700-FETCH-TRANCODE.                                             24320000
243300*----------------------------------------------------------------*24330000
243400*   FETCHES FROM THE TRANCODE CURSOR.                            *24340000
243500*----------------------------------------------------------------*24350000
243600                                                                  24360000
243700     EXEC SQL                                                     24370000
243800       FETCH TRANCODE_CSR                                         24380000
243900        INTO :TRNCDE-AP-TRN-CDE                                   24390000
244000     END-EXEC.                                                    24400000
244100                                                                  24410000
244200     EVALUATE TRUE                                                24420000
244300       WHEN SQLCODE = ZERO                                        24430000
244400         CONTINUE                                                 24440000
244500       WHEN SQLCODE = +100                                        24450000
244510         SET PV-TRNCDE-CSR-AT-END TO TRUE                         24451000
244520       WHEN SQLWARN0 NOT = SPACES                                 24452000
244530       WHEN SQLCODE NOT  = ZERO                                   24453000
244540         MOVE 'S700-FETCH-TRANCODE'                               24454000
244550                             TO AA-PARAGRAPH-NAME                 24455000
244560         MOVE 'UNSUCCESSFUL FETCH '                               24456000
244570                             TO AA-DB2-OPERATION                  24457000
244580         MOVE 'TTRNCDE'      TO AA-DB2-TABLE-1                    24458000
244590         PERFORM Z999-DB2-ABEND                                   24459000
244591     END-EVALUATE.                                                24459100
244592                                                                  24459200
244593                                                                  24459300
244594 T100-LOAD-STORE-TABLE.                                           24459400
244595                                                                  24459500
244596     PERFORM X100-OPEN-STORE-CSR.                                 24459600
244597                                                                  24459700
244598     PERFORM T200-FETCH-STORE-CSR                                 24459800
244599         UNTIL PS-END-OF-STORES.                                  24459900
244600                                                                  24460000
244700     PERFORM X110-CLOSE-STORE-CSR.                                24470000
244800                                                                  24480000
244900     PERFORM X200-PERFORM-COMMIT.                                 24490000
245000                                                                  24500000
245100 T200-FETCH-STORE-CSR.                                            24510000
245200                                                                  24520000
245300     EXEC SQL                                                     24530000
245400         FETCH   STORE_CSR                                        24540000
245500          INTO  :XFT00017-LOC-NBR                                 24550005
245600               ,:XFT00017-LOC-5-ABBR-NM                           24560005
245700     END-EXEC.                                                    24570000
245800                                                                  24580000
245900     EVALUATE TRUE                                                24590000
246000         WHEN SQLCODE = ZERO                                      24600000
246100             ADD 1 TO PV-STORE-READ-COUNT                         24610000
246200             MOVE XFT00017-LOC-NBR      TO STR-SUB                24620005
246300             MOVE XFT00017-LOC-5-ABBR-NM                          24630005
246400                                        TO PV-STORE-NME (STR-SUB) 24640000
246500                                                                  24650000
246600         WHEN SQLCODE = +100                                      24660000
246700             SET PS-END-OF-STORES TO TRUE                         24670000
246800                                                                  24680000
246900         WHEN SQLWARN0 NOT = SPACES                               24690000
247000         WHEN SQLCODE  NOT = ZERO                                 24700000
247100             MOVE 'T200-FETCH-STORE-CSR'                          24710000
247200                                        TO AA-PARAGRAPH-NAME      24720000
247300             MOVE 'UNSUCCESSFUL FETCH FROM STORE_CSR'             24730000
247400                                        TO AA-DB2-OPERATION       24740000
247500             MOVE 'XFT00017'            TO AA-DB2-TABLE-1         24750005
247600             MOVE SPACES                TO AA-DB2-TABLE-2         24760000
247700                                           AA-DB2-TABLE-3         24770000
247800             PERFORM Z999-DB2-ABEND                               24780000
247900     END-EVALUATE.                                                24790000
248000                                                                  24800000
248100                                                                  24810000
248200 W100-WRITE-HEADINGS.                                             24820000
248300*----------------------------------------------------------------*24830000
248400*    WRITE PAGE HEADING LINES.                                   *24840000
248500*----------------------------------------------------------------*24850000
248600                                                                  24860000
248700     ADD +1                      TO PV-PAGE-COUNT.                24870000
248800     MOVE PV-PAGE-COUNT          TO DP200O-PAGE-NUMBER.           24880001
248900                                                                  24890000
249000* HEADING LINE 1 (STANDARD)                                       24900000
249100     WRITE REPORT-REC FROM DP200O-STANDRD-HEADER-200-COLS         24910001
249200       AFTER ADVANCING PAGE.                                      24920000
249300                                                                  24930000
249400     WRITE REPORT-REC FROM H2-HEADER2                             24940000
249500       AFTER ADVANCING +1 LINES.                                  24950000
249600                                                                  24960000
249700     WRITE REPORT-REC FROM H3-HEADER3                             24970000
249800       AFTER ADVANCING +1 LINES.                                  24980000
249900                                                                  24990000
250000     MOVE +3                     TO PV-LINES-PER-PAGE.            25000000
250100                                                                  25010000
250200                                                                  25020000
250300 W200-WRITE-DETAIL-HEADINGS.                                      25030000
250400*----------------------------------------------------------------*25040000
250500*    WRITE DETAIL HEADINGS                                       *25050000
250600*    - PRINT ALL DETAIL HEADERS UNLESS ONE OF THE FOLLOWING      *25060000
250700*      CONDITIONS IS TRUE                                        *25070000
250800*    - WHEN PRINTING FINAL TOTALS DO NOT SHOW DETAIL HEADERS     *25080000
250900*    - WHEN PRINTING DMA TOTALS SHOW DMA HEADER                  *25090000
251000*    - WHEN PRINTING DEPT TOTALS SHOW DMA & DEPT HEADER          *25100000
251100*    - WHEN PRINTING CLASS TOTALS SHOW DMA, DEPT, CLASS, BUYER   *25110000
251200*      DETAIL HEADERS                                            *25120000
251300*----------------------------------------------------------------*25130000
251400                                                                  25140000
251500     IF NOT PS-TOTALS                                             25150000
251600         WRITE REPORT-REC FROM H4-HEADER4                         25160000
251700           AFTER ADVANCING +1 LINES                               25170000
251800         ADD +1                    TO PV-LINES-PER-PAGE           25180000
251900         IF NOT PS-DMA-TOTALS                                     25190000
252000             WRITE REPORT-REC FROM H5-HEADER5                     25200000
252100               AFTER ADVANCING +1 LINES                           25210000
252200             ADD +1                TO PV-LINES-PER-PAGE           25220000
252300             IF NOT PS-DEPT-TOTALS                                25230000
252400                 WRITE REPORT-REC FROM H6-HEADER6                 25240000
252500                   AFTER ADVANCING +1 LINES                       25250000
252600                 WRITE REPORT-REC FROM H7-HEADER7                 25260000
252700                   AFTER ADVANCING +1 LINES                       25270000
252800                 ADD +2            TO PV-LINES-PER-PAGE           25280000
252900             END-IF                                               25290000
253000         END-IF                                                   25300000
253100     END-IF.                                                      25310000
253200                                                                  25320000
253300     WRITE REPORT-REC FROM H8-HEADER8                             25330000
253400       AFTER ADVANCING +2 LINES.                                  25340000
253500     ADD +2                        TO PV-LINES-PER-PAGE.          25350000
253600                                                                  25360000
253700     IF PS-STORE-TOTALS                                           25370000
253800         PERFORM W400-WRITE-STORE-HEADERS                         25380000
253900     END-IF.                                                      25390000
254000                                                                  25400000
254100                                                                  25410000
254200 W300-PRINT-DETAIL.                                               25420000
254300*----------------------------------------------------------------*25430000
254400*    PRINTS DETAIL LINES.                                        *25440000
254500*----------------------------------------------------------------*25450000
254600                                                                  25460000
254700     IF PV-LINES-PER-PAGE > PC-LINES-PER-PAGE-MAX                 25470000
254800         PERFORM W100-WRITE-HEADINGS                              25480000
254900         PERFORM W200-WRITE-DETAIL-HEADINGS                       25490000
255000     END-IF.                                                      25500000
255100                                                                  25510000
255200     WRITE REPORT-REC FROM PV-REPORT-REC                          25520000
255300       AFTER ADVANCING PV-LINE-SKIP LINES.                        25530000
255400                                                                  25540000
255500     INITIALIZE REPORT-REC.                                       25550000
255600                                                                  25560000
255700     ADD PV-LINE-SKIP            TO PV-LINES-PER-PAGE.            25570000
255800                                                                  25580000
255900                                                                  25590000
256000 W400-WRITE-STORE-HEADERS.                                        25600000
256100                                                                  25610000
256200     WRITE REPORT-REC FROM T4-HEADER4                             25620000
256300       AFTER ADVANCING +3.                                        25630000
256400                                                                  25640000
256500     WRITE REPORT-REC FROM T5-HEADER5                             25650000
256600       AFTER ADVANCING +2.                                        25660000
256700                                                                  25670000
256800     WRITE REPORT-REC FROM T6-HEADER6                             25680000
256900       AFTER ADVANCING +1.                                        25690000
257000                                                                  25700000
257100     MOVE SPACES                       TO REPORT-REC.             25710000
257200     WRITE REPORT-REC                                             25720000
257300       AFTER ADVANCING +1.                                        25730000
257400                                                                  25740000
257500     ADD +7                      TO PV-LINES-PER-PAGE.            25750000
257600                                                                  25760000
257700                                                                  25770000
257800 X100-OPEN-STORE-CSR.                                             25780000
257900*---------------------------------------------------------------- 25790000
258000*    OPEN STORE_CSR CURSOR.                                       25800000
258100*---------------------------------------------------------------- 25810000
258200                                                                  25820000
258300     EXEC SQL                                                     25830000
258400         OPEN STORE_CSR                                           25840000
258500     END-EXEC.                                                    25850000
258600                                                                  25860000
258700     EVALUATE TRUE                                                25870000
258800         WHEN SQLCODE = ZERO                                      25880000
258900             CONTINUE                                             25890000
259000         WHEN SQLWARN0 NOT = SPACES                               25900000
259100         WHEN SQLCODE  NOT = ZERO                                 25910000
259200             MOVE 'X100-OPEN-STORE-CSR'                           25920000
259300                                 TO AA-PARAGRAPH-NAME             25930000
259400             MOVE 'UNSUCCESSFUL OPEN ON STORE_CSR'                25940000
259500                                 TO AA-DB2-OPERATION              25950000
259600             MOVE 'XFT00017'     TO AA-DB2-TABLE-1                25960005
259700             MOVE SPACES         TO AA-DB2-TABLE-2                25970000
259800                                    AA-DB2-TABLE-3                25980000
259900             PERFORM Z999-DB2-ABEND                               25990000
260000     END-EVALUATE.                                                26000000
260100                                                                  26010000
260200                                                                  26020000
260300 X110-CLOSE-STORE-CSR.                                            26030000
260400*---------------------------------------------------------------- 26040000
260500*    CLOSE THE STORE_CSR CURSOR.                                  26050000
260600*---------------------------------------------------------------- 26060000
260700                                                                  26070000
260800     EXEC SQL                                                     26080000
260900         CLOSE STORE_CSR                                          26090000
261000     END-EXEC.                                                    26100000
261100                                                                  26110000
261200     EVALUATE TRUE                                                26120000
261300         WHEN SQLCODE = ZERO                                      26130000
261400             CONTINUE                                             26140000
261500                                                                  26150000
261600         WHEN SQLWARN0 NOT = SPACES                               26160000
261700         WHEN SQLCODE  NOT = ZERO                                 26170000
261800             MOVE 'X110-CLOSE-STORE-CSR'                          26180000
261900                                 TO AA-PARAGRAPH-NAME             26190000
262000             MOVE 'UNSUCCESSFUL CLOSE ON STORE_CSR'               26200000
262100                                 TO AA-DB2-OPERATION              26210000
262200             MOVE 'XFT00017'     TO AA-DB2-TABLE-1                26220005
262300             MOVE SPACES         TO AA-DB2-TABLE-2                26230000
262400                                    AA-DB2-TABLE-3                26240000
262500             PERFORM Z999-DB2-ABEND                               26250000
262600       END-EVALUATE.                                              26260000
262700                                                                  26270000
262800 X200-PERFORM-COMMIT.                                             26280000
262900*----------------------------------------------------------------*26290000
263000*    COMMITS DB2 UPDATES AFTER EACH SELECT FROM XFT TABLE.        26300000
263100*----------------------------------------------------------------*26310000
263200                                                                  26320000
263300     EXEC SQL                                                     26330000
263400         COMMIT                                                   26340000
263500     END-EXEC.                                                    26350000
263600                                                                  26360000
263700     EVALUATE TRUE                                                26370000
263800         WHEN SQLCODE = ZEROS                                     26380000
263810              CONTINUE                                            26381000
263820         WHEN OTHER                                               26382000
263830             MOVE 'X200-COMMIT'  TO AA-PARAGRAPH-NAME             26383000
263840             MOVE 'UNSUCCESSFUL COMMIT'                           26384000
263850                                 TO AA-DB2-OPERATION              26385000
263860             MOVE SPACES         TO AA-DB2-TABLE-1                26386000
263870                                    AA-DB2-TABLE-2                26387000
263880                                    AA-DB2-TABLE-3                26388000
263890             PERFORM Z999-DB2-ABEND                               26389000
263891     END-EVALUATE.                                                26389100
263892                                                                  26389200
263893 Y100-OPEN-TRANCODE-CURSOR.                                       26389300
263894*----------------------------------------------------------------*26389400
263895*   OPENS THE TRANCODE CURSOR.                                   *26389500
263896*----------------------------------------------------------------*26389600
263897                                                                  26389700
263898     EXEC SQL                                                     26389800
263899       OPEN TRANCODE_CSR                                          26389900
263900     END-EXEC.                                                    26390000
263901                                                                  26390100
263902     EVALUATE TRUE                                                26390200
263903       WHEN SQLCODE = ZERO                                        26390300
263904         CONTINUE                                                 26390400
263905       WHEN SQLWARN0 NOT = SPACES                                 26390500
263906       WHEN SQLCODE NOT  = ZERO                                   26390600
263907         MOVE 'Y100-OPEN-TRANCODE-CURSOR'                         26390700
263908                             TO AA-PARAGRAPH-NAME                 26390800
263909         MOVE 'UNSUCCESSFUL OPEN  '                               26390900
263910                             TO AA-DB2-OPERATION                  26391000
263911         MOVE 'TTRNCDE'      TO AA-DB2-TABLE-1                    26391100
263912         PERFORM Z999-DB2-ABEND                                   26391200
263913     END-EVALUATE.                                                26391300
263914                                                                  26391400
263915                                                                  26391500
263916 Y200-CLOSE-TRNCODE-CURSOR.                                       26391600
263917*----------------------------------------------------------------*26391700
263918*   CLOSE THE TRANCODE CURSOR.                                   *26391800
263919*----------------------------------------------------------------*26391900
263920                                                                  26392000
263921     EXEC SQL                                                     26392100
263922       CLOSE TRANCODE_CSR                                         26392200
263923     END-EXEC.                                                    26392300
263924                                                                  26392400
263925     EVALUATE TRUE                                                26392500
263926       WHEN SQLCODE = ZERO                                        26392600
263927         CONTINUE                                                 26392700
263928       WHEN SQLWARN0 NOT = SPACES                                 26392800
263929       WHEN SQLCODE NOT  = ZERO                                   26392900
263930         MOVE 'Y100-CLOSE-TRANCODE-CURSOR'                        26393000
263931                             TO AA-PARAGRAPH-NAME                 26393100
263932         MOVE 'UNSUCCESSFUL CLOSE  '                              26393200
263933                             TO AA-DB2-OPERATION                  26393300
263934         MOVE 'TTRNCDE'      TO AA-DB2-TABLE-1                    26393400
263935         PERFORM Z999-DB2-ABEND                                   26393500
263936     END-EVALUATE.                                                26393600
263937                                                                  26393700
263938 Z998-ABEND.                                                      26393800
263939*----------------------------------------------------------------*26393900
263940*    ABEND ROUTINE                                               *26394000
263941*----------------------------------------------------------------*26394100
263942                                                                  26394200
263943     CLOSE ADJ-EXTRACT-FILE                                       26394300
263944           REPORT-FILE.                                           26394400
263945                                                                  26394500
263946     DISPLAY AA-ABEND-LIT.                                        26394600
263947     DISPLAY AA-PROGRAM-LIT.                                      26394700
263948     DISPLAY AA-PARAGRAPH-LIT.                                    26394800
263949     DISPLAY AA-MESSAGE-LINE-1.                                   26394900
263950     DISPLAY AA-MESSAGE-LINE-2.                                   26395000
263960                                                                  26396000
263970     CALL 'ILBOABN0' USING ABEND-CODE.                            26397000
263980                                                                  26398000
263990                                                                  26399000
264000 Z999-DB2-ABEND.                                                  26400000
264100*----------------------------------------------------------------*26410000
264200*    DB2 ABEND ROUTINE                                           *26420000
264300*----------------------------------------------------------------*26430000
264400                                                                  26440000
264500     CLOSE ADJ-EXTRACT-FILE                                       26450000
264600           REPORT-FILE.                                           26460000
264700                                                                  26470000
264800     DISPLAY AA-ABEND-LIT.                                        26480000
264900     DISPLAY AA-DB2-ERROR-LIT.                                    26490000
265000     DISPLAY AA-PROGRAM-LIT.                                      26500000
265100     DISPLAY AA-PARAGRAPH-LIT.                                    26510000
265200     DISPLAY AA-DB2-OPERATION-LIT.                                26520000
265300     DISPLAY AA-MESSAGE-LINE-1.                                   26530000
265400     DISPLAY AA-MESSAGE-LINE-2.                                   26540000
265500     DISPLAY AA-DB2-TABLE-1.                                      26550000
265600     DISPLAY AA-DB2-TABLE-2.                                      26560000
265700     DISPLAY AA-DB2-TABLE-3.                                      26570000
265800     SET AC-DB2-ERROR TO TRUE.                                    26580000
265900                                                                  26590000
266000     COPY DPPD004.                                                26600000
266100                                                                  26610000
266200     CALL 'ILBOABN0' USING ABEND-CODE.                            26620000
266300                                                                  26630000
266400*----------------------------------------------------------------*26640000
266500*    NAME FORMATTING ROUTINE                                     *26650000
266600*----------------------------------------------------------------*26660000
266700     COPY DPPD024.                                                26670000
266800                                                                  26680000
