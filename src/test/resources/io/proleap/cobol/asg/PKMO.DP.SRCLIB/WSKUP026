000100 IDENTIFICATION DIVISION.                                         00010099
000200 PROGRAM-ID.         WSKUP026.                                    00020099
000300 AUTHOR.             RICHARD WOJTCZAK.                            00030099
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040099
000500 DATE-WRITTEN.       MARCH 2007.                                  00050099
000600                                                                  00060099
000700****************************************************************  00070099
000800* I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE MQ SERIES 00081000
000900* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.        00082000
001000* THIS PROGRAM USES MQSERIES.                                     00083000
001100****************************************************************  00085000
001200*             XML DB2 BOL REPOSITORY LOAD                         00086099
001300*             ---------------------------                         00087099
001400*                                                                 00172404
001500* THIS PROGRAM WILL GET MESSAGES FROM THE BOL MQ MESSAGE QUEUE    00172599
001600* (WS.OUTBOUND.WMOS.BOL.TO.REPOSITORY.Q) AND FORMAT/LOAD          00172604
001700* THE INCOMING XML DATA TO THE DB2 TABLES WST_OTBND_DAT_XFER      00172704
001800* AND WST_OTBND_DAT_CNTL.                                         00172804
001900*                                                                 00172904
002000* RECORDS TYPES THAT ARE BEING LOADED TO THE BOL REPOSITIORY      00173004
002100* ARE;                                                            00173104
002200*                                                                 00173204
002300*              'PH' - PICKTICKET HEADER                           00173304
002400*              'PD' - PICKTICKET DETAIL                           00173404
002500*              'CH' - CARTON HEADER                               00173504
002600*              'CD' - CARTON DETAIL                               00173604
002700*              'GC' - GIFT CARD                                   00173704
002800*                                                                 00173804
002900* THE PROGRAM WILL BREAK DURING PARSING OF THE XML DATA TO        00173904
003000* CREATE THE APPROPRIATE ROWS IN THE DB2 TABLES.                  00174004
003100*                                                                 00175004
003200****************************************************************  00176004
003300 ENVIRONMENT DIVISION.                                            00180000
003400****************************************************************  00181000
003500 CONFIGURATION SECTION.                                           00190000
003600 SOURCE-COMPUTER.        IBM-3090.                                00191000
003700 OBJECT-COMPUTER.        IBM-3090.                                00192000
003800 INPUT-OUTPUT SECTION.                                            00193000
003900                                                                  00200000
004000 FILE-CONTROL.                                                    00210000
004100****************************************************************  00251900
004200 DATA DIVISION.                                                   00270000
004300****************************************************************  00271000
004400 FILE SECTION.                                                    00280000
004500                                                                  00290000
004600 WORKING-STORAGE SECTION.                                         00350000
004700******************************************************************00361000
004800  01  PV-ABEND-CODE                  PIC S9(04) VALUE ZERO        00364400
004900                                                COMP SYNC.        00364500
005000******************************************************************00364800
005100*    PROGRAM CONSTANTS                                            00364900
005200******************************************************************00365000
005300 01  PC-PROGRAM-CONSTANTS.                                        00365100
005400     05  PC-PGM-NAME                 PIC X(08) VALUE 'WSKUP026'.  00365202
005500     05  PC-MAX-RETRIES              PIC S9(3) VALUE +5 COMP-3.   00366400
005600     05  PC-MQPUT-RETRY-COUNTER      PIC 9(3)  VALUE ZERO.        00366800
005700     05  PC-BOL                      PIC X(03) VALUE 'BOL'.       00366999
005800     05  PC-READY                    PIC X(06) VALUE 'READY '.    00367002
005900     05  PC-N                        PIC X(01) VALUE 'N'.         00367102
006000     05  PC-C                        PIC X(01) VALUE 'C'.         00367202
006100     05  PC-END-RUN-MSG              PIC  X(18) VALUE             00460099
006200                                    'END RUN OF PROGRAM'.         00470099
006300                                                                  00367300
006400******************************************************************00367400
006500*    PROGRAM VARIABLES                                            00367500
006600******************************************************************00368000
006700 01  PV-PROGRAM-VARIABLES.                                        00370000
006800     05  PV-CURRENT-TMST          PIC X(26)       VALUE SPACE.    00410000
006900     05  PV-CURRENT-DATE          PIC X(10)       VALUE SPACE.    00410199
007000     05  PV-CURRENT-TMST2         PIC X(26)       VALUE SPACE.    00410200
007100     05  PV-CURRENT-DATE2         PIC X(10)       VALUE SPACE.    00410300
007200     05  PV-CURRENT-ELEMENT       PIC X(30)       VALUE SPACES.   00420000
007300     05  PV-CURRENT-ATTRIBUTE     PIC X(30)       VALUE SPACES.   00420100
007400     05  PV-DEC4-CONVERT          PIC X(14)  JUST RIGHT.          00440000
007500     05  PV-DEC4                  REDEFINES PV-DEC4-CONVERT       00450000
007600                                  PIC 9(09).9(04).                00460100
007700     05  PV-DEC4-CONVRTD          PIC 9(09)V9(04)  VALUE  0.      00460200
007800     05  PV-DEC2-CONVERT          PIC X(12)  JUST RIGHT.          00460399
007900     05  PV-DEC2                  REDEFINES PV-DEC2-CONVERT       00460400
008000                                  PIC 9(09).9(02).                00460500
008100     05  PV-DEC2-CONVRTD          PIC 9(09)V9(02)  VALUE  0.      00460600
008200     05  PV-DEC5-CONVERT          PIC X(15)  JUST RIGHT.          00460700
008300     05  PV-DEC5                  REDEFINES PV-DEC5-CONVERT       00460800
008400                                  PIC 9(09).9(05).                00460900
008500     05  PV-DEC5-CONVRTD          PIC 9(09)V9(05)  VALUE  0.      00461000
008600     05  PV-DATE-FORMAT           PIC X(19).                      00461709
008700     05  PV-RETRY-COUNTER         PIC S9(04) VALUE +0 COMP SYNC.  00467100
008800     05  PV-HOLD-COMPLETION-CODE  PIC S9(9) BINARY.               00467200
008900     05  PV-HOLD-REASON           PIC S9(9) BINARY.               00467300
009000     05  PV-PARAGRAPH             PIC X(30) VALUE SPACE.          00471300
009100     05  PV-TABLE-NAME            PIC X(30) VALUE SPACE.          00471499
009200     05  PV-SQLCODE               PIC -999.                       00471599
009300     05  PV-REC-SEQ-NBR           PIC S9(09) VALUE +1 COMP.       00471600
009400     05  PV-DISP-NBR              PIC ZZZ,ZZZ,ZZ9.                00471600
009500                                                                  00472000
009600******************************************************************00480300
009700*    PROGRAM ACCUMULATORS                                         00480400
009800******************************************************************00480500
009900 01  PA-PROGRAM-ACCUMULATORS.                                     00480600
010000     05  PA-MQ-BOL-MSGS-READ       PIC  S9(09)  VALUE +0 COMP-3.  00481800
010100     05  PA-MQ-ERROR-MSGS-SENT     PIC  S9(09)  VALUE +0 COMP-3.  00482200
010200     05  PA-ERRORS-PROCESSED       PIC  S9(09)  VALUE +0 COMP-3.  00482300
010300     05  PA-BOL-CNTL-INS           PIC  S9(09)  VALUE +0 COMP-3.  00482502
010400     05  PA-BOL-XFER-INS           PIC  S9(09)  VALUE +0 COMP-3.  00482699
010500     05  PA-BOL-TOT-INS            PIC  S9(09)  VALUE +0 COMP-3.  00482702
010600     05  PA-MQ-COMMITS             PIC  S9(09)  VALUE +0 COMP-3.  00482802
010700     05  PA-XML-PARSED             PIC  S9(09)  VALUE +0 COMP-3.  00482902
010800     05  PA-TOTAL-DB2-COMMITS      PIC  S9(09)  VALUE +0 COMP-3.  00790099
010900     05  PA-TOTAL-DB2-ROLLBACKS    PIC  S9(09)  VALUE +0 COMP-3.  00790099
011000     05  PA-END-PGM-MSGS           PIC  S9(03)  VALUE +0 COMP-3.  00790099
011100******************************************************************00484300
011200*    PROGRAM VARIABLES FOR QUEUE MANAGER AND QUEUE NAMES.         00484400
011300******************************************************************00484500
011400 01  PV-Q-MANAGER-VARIABLES.                                      00484600
011500     05  PV-QMGR-NAME-BOL             PIC X(48).                  00484700
011600     05  PV-QUE-NAME-BOL              PIC X(48).                  00484800
011700     05  PV-HANDLE-BOL           PIC S9(9) BINARY VALUE 0.        00484905
011800     05  PV-QMGR-NAME-ERROR           PIC X(48).                  00485100
011900     05  PV-QUE-NAME-ERROR            PIC X(48).                  00485200
012000     05  PV-HANDLE-ERROR         PIC S9(9) BINARY VALUE 0.        00485305
012100******************************************************************00486000
012200*    PROGRAM VARIABLES FOR MQ SERIES                              00490000
012300******************************************************************00500000
012400 01  PV-MQ-PROGRAM-VARIABLES.                                     00571000
012500     05  PV-QM-NAME              PIC X(48).                       00571100
012600     05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        00571200
012700     05  PV-OPEN-OPTIONS         PIC S9(9) BINARY.                00571300
012800*    05  PV-HANDLE               PIC S9(9) BINARY VALUE 0.        00571405
012900     05  PV-COMPLETION-CODE      PIC S9(9) BINARY.                00571500
013000     05  PV-REASON               PIC S9(9) BINARY.                00571600
013100     05  PV-ERROR-MESSAGE        PIC X(48) VALUE SPACES.          00571700
013200     05  PV-CON-REASON           PIC S9(9) BINARY.                00571800
013300     05  PV-MSGBUFFER            PIC X(2048000) VALUE SPACES.     00571905
013400     05  PV-ERRMSGBUFFER         PIC X(32432) VALUE SPACES.       00572005
013500     05  PV-MSG-LENGTH           PIC S9(9) BINARY VALUE 1000.     00572100
013600     05  PV-DATA-LENGTH          PIC S9(9) BINARY.                00572200
013700     05  PV-ACTION               PIC X(60) VALUE SPACES.          00572308
013800     05  PV-MQCHECK              PIC X(8)  VALUE 'MQR2C'.         00572408
013900     05  PV-MQ-REASON-TEXT       PIC X(30) VALUE SPACES.          00572508
014000     05  PV-TEST-NUM             PIC 9(09)V9999.                  00572699
014100                                                                  00572700
014200*PV-MSG IS THE INPUT MESSAGE                                      00572805
014300 01  PV-MSG                      PIC X(2048000) VALUE SPACES.     00572905
014400 01  XML-LENGTH                  PIC 9(7)     VALUE ZEROS.        00610000
014500                                                                  00610199
014600 01  PC-MQCONN                   PIC X(8)  VALUE 'CSQBCONN'.      00610205
014700 01  PC-MQOPEN                   PIC X(8)  VALUE 'CSQBOPEN'.      00610305
014800 01  PC-MQINQ                    PIC X(8)  VALUE 'CSQBINQ'.       00610405
014900 01  PC-MQGET                    PIC X(8)  VALUE 'CSQBGET'.       00610505
015000 01  PC-MQPUT                    PIC X(8)  VALUE 'CSQBPUT'.       00610605
015100 01  PC-MQCMIT                   PIC X(8)  VALUE 'CSQBCOMM'.      00610705
015200 01  PC-MQCLOSE                  PIC X(8)  VALUE 'CSQBCLOS'.      00610805
015300 01  PC-MQDISC                   PIC X(8)  VALUE 'CSQBDISC'.      00610905
015400 01  PC-MQBACK                   PIC X(8)  VALUE 'CSQBBACK'.      00611005
015500                                                                  00611105
015600* API CONTROL BLOCKS                                              00611205
015700 01  MQM-OBJECT-DESCRIPTOR.                                       00611305
015800     COPY CMQODV.                                                 00611405
015900 01  MQM-MESSAGE-DESCRIPTOR.                                      00611505
016000     COPY CMQMDV.                                                 00611605
016100 01  MQM-PUT-MESSAGE-OPTIONS.                                     00611705
016200     COPY CMQPMOV.                                                00611805
016300 01  MQM-GET-MESSAGE-OPTIONS.                                     00611905
016400     COPY CMQGMOV.                                                00612005
016500                                                                  00612105
016600* MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)      00612205
016700* AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)             00612305
016800 01  MQM-CONSTANTS.                                               00612405
016900     COPY CMQV.                                                   00612505
017000                                                                  00612605
017100 01  PS-PROGRAM-SWITCHES.                                         00612700
017200     05  PS-ERROR-REC-WRITTEN-SW        PIC X(01)  VALUE 'N'.     00612800
017300         88  PS-ERROR-REC-WRITTEN-YES              VALUE 'Y'.     00612900
017400         88  PS-ERROR-REC-WRITTEN-NO               VALUE 'N'.     00613000
017500     05  PS-MQ-ERROR-SW                 PIC X(01)  VALUE 'N'.     00613100
017600         88  PS-MQ-ERROR-YES                       VALUE 'Y'.     00613200
017700         88  PS-MQ-ERROR-NO                        VALUE 'N'.     00613300
017800     05  PS-TIME-TO-END-PROGRAM-SW      PIC X(01)  VALUE 'N'.     01430099
017900         88  PS-TIME-TO-END-PROGRAM-YES            VALUE 'Y'.     01440099
018000         88  PS-TIME-TO-END-PROGRAM-NO             VALUE 'N'.     01450099
018100     05  PS-ROLLBACK-DB2-SW             PIC X(01)  VALUE 'N'.             
018200         88  PS-ROLLBACK-DB2-YES                   VALUE 'Y'.             
018300         88  PS-ROLLBACK-DB2-NO                    VALUE 'N'.             
018400                                                                  01460099
018500                                                                  00613400
018600***************************************************************** 00821000
018700* MQ SERIES COMPLETION CODES.                                     00822000
018800***************************************************************** 00823000
018900     COPY ISWS002.                                                00840000
019000                                                                  00840100
019100***************************************************************** 00840200
019200* XMAL CODE DESCRIPTIONS, AND DISPLAYING FORMATTED XML MESSAGES   00840300
019300***************************************************************** 00840400
019400     COPY ISWS007.                                                00841000
019500     COPY ISWS008.                                                00842000
019600     COPY ISWS009.                                                00843000
019700                                                                  00850000
019800***************************************************************** 00855700
019900* InvoiceBridge - Input XML BOL - Bill of Lading/Invoice          00855899
020000***************************************************************** 00855900
020100     COPY WSRD034.                                                00856000
020200                                                                  00856100
020300***************************************************************** 00856200
020400* WS037-INVOICE-BRIDGE - Output record                            00856300
020500***************************************************************** 00856400
020600     COPY WSRD037.                                                00856500
020700                                                                  00856600
020800***************************************************************** 00856700
020900* OUTPUT ERROR MESSAGE COPYBOOK - FOR ERROR QUEUE.                00856800
021000***************************************************************** 00856900
021100     COPY WSRD027.                                                00857000
021200                                                                  00857100
021300******************************************************************00857200
021400* COMMUNICATIONS AREA FOR DB2                                     00857300
021500******************************************************************00857400
021600     EXEC SQL                                                     00857500
021700         INCLUDE SQLCA                                            00857600
021800     END-EXEC.                                                    00857700
021900                                                                  00857800
022000******************************************************************00857902
022100*  DB2 TABLE DECLARATION - WST_OTBND_DAT_CNTL                     00858002
022200******************************************************************00858202
022300     EXEC SQL                                                     00858302
022400         INCLUDE WST00005                                         00858402
022500     END-EXEC.                                                    00858502
022600                                                                  00858602
022700******************************************************************00858799
022800*  DB2 TABLE DECLARATION - WST_OTBND_DAT_XFER                     00858802
022900******************************************************************00858902
023000     EXEC SQL                                                     00859002
023100         INCLUDE WST00006                                         00859102
023200     END-EXEC.                                                    00859202
023300                                                                  00859302
023400******************************************************************00864000
023500*  DB2 VIEW DECLARATION - WSV_PRVDR_QUE                           00865000
023600******************************************************************00865200
023700     EXEC SQL                                                     00865300
023800         INCLUDE WSV00005                                         00865400
023900     END-EXEC.                                                    00865500
024000                                                                  00865600
024100******************************************************************00865700
024200*  DB2 VIEW DECLARATION - WSV_CNSMR_QUE                           00865800
024300******************************************************************00866000
024400     EXEC SQL                                                     00866100
024500         INCLUDE WSV00006                                         00866200
024600     END-EXEC.                                                    00866300
024700                                                                  00866400
024800***************************************************************** 00867000
024900 PROCEDURE DIVISION.                                              00870000
025000***************************************************************** 00871000
025100                                                                  00872099
025200******************************************************************00900000
025300*    MAIN PROCESSING.                                             00901000
025400******************************************************************00902000
025500 0000-MAIN-MODULE.                                                00903099
025600*    DISPLAY 'WSKUP026 - 0000-MAIN-MODULE.             '.         00903199
025700     DISPLAY '**********************************'.                00903200
025800     DISPLAY '* START OF WSKUP026               '.                00903302
025900     DISPLAY '**********************************'.                00903400
026000                                                                  00903500
026100     PERFORM 1000-INITIALIZATION.                                 00910000
026200     PERFORM 1200-MQSERIES-CONNECT.                               00910200
026300     PERFORM 1300-MQSERIES-OPEN-BOL.                              00911008
026400     PERFORM 1340-MQSERIES-OPEN-ERROR.                            00911300
026500     PERFORM 1400-GET-MQ-MESSAGE.                                 00911400
026600     PERFORM 2000-PROCESS-XML                                     00920000
026700             UNTIL PV-REASON = MQRC-NO-MSG-AVAILABLE              00930100
026800              OR PS-TIME-TO-END-PROGRAM-YES.                      02190099
026900     PERFORM 9300-EOJ.                                            00932100
027000     GOBACK.                                                      00940000
027100                                                                  00960000
027200***************************************************************** 00960100
027300* INITIALIZATION                                                  00960200
027400*     OPENS FILES                                                 00960300
027500*     INITIALIZES VARIABLES                                       00960400
027600*     GETS MQ QUEUE & QUEUE MANAGER INFORMATION                   00960500
027700***************************************************************** 00960600
027800 1000-INITIALIZATION.                                             00960700
027900*    DISPLAY 'WSKUP026 - 1000-INITIALIZATION.          '.         00960899
028000                                                                  00962900
028100     INITIALIZE   DCLWST00005                                     00963099
028200                  DCLWST00006                                     00964002
028300                  WS037-INVOICE-BRIDGE.                           02470906
028400                                                                  02471099
028500     SET PS-ROLLBACK-DB2-NO           TO TRUE                             
028600     PERFORM 1050-GET-DB2-TIMESTAMP.                              02471100
028700     PERFORM 1100-GET-MQ-INFO-BOL.                                02471200
028800     PERFORM 1160-GET-MQ-INFO-ERROR.                              02471300
028900                                                                  02471400
029000 1050-GET-DB2-TIMESTAMP.                                          02471500
029100*    DISPLAY 'WSKUP026 - 1050-GET-DB2-TIMESTAMP        '.         02471699
029200                                                                  02471700
029300     EXEC SQL                                                     02471800
029400         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 02471900
029500     END-EXEC                                                     02472000
029600                                                                  02472100
029700     EVALUATE TRUE                                                02472200
029800         WHEN SQLCODE = ZERO                                      02472300
029900              CONTINUE                                            02472400
030000         WHEN OTHER                                               02472599
030100              INITIALIZE WS027-RECEIPT-PIX-ERROR-REC              02472699
030200              MOVE 'C'                TO WS027-ERROR-TYPE-CDE     02472799
030300              MOVE 'WSRD037 '         TO WS027-ERROR-COPYBOOK     02472899
030400              MOVE PC-PGM-NAME        TO WS027-ERROR-PGM-NAME     02472999
030500              MOVE '1050-'            TO WS027-ERROR-PARA-NBR     02473099
030600              MOVE SQLCODE            TO WS027-SQLCODE            02474099
030700              MOVE 'SET CURR TIMESTAMP '                          02475099
030800                                      TO WS027-ERROR-DESC-TXT     02475199
030900              PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                02475206
031000              MOVE '1050-GET-DB2-TIMESTAMP' TO PV-PARAGRAPH       02475399
031100              MOVE 'SET TIMESTAMP      '    TO PV-TABLE-NAME      02475499
031200              PERFORM 9500-ABEND                                  02475599
031300     END-EVALUATE.                                                02475600
031400                                                                  02475700
031500     MOVE PV-CURRENT-TMST       TO PV-CURRENT-DATE.               02475800
031600                                                                  02475900
031700 1075-GET-DB2-TIMESTAMP2.                                         02476000
031800*    DISPLAY 'WSKUP026 - 1075-GET-DB2-TIMESTAMP2       '.         02476199
031900                                                                  02476200
032000     EXEC SQL                                                     02476300
032100         SET :PV-CURRENT-TMST2 = CURRENT TIMESTAMP                02476400
032200     END-EXEC                                                     02476500
032300                                                                  02476600
032400     EVALUATE TRUE                                                02476700
032500         WHEN SQLCODE = ZERO                                      02476800
032600              CONTINUE                                            02476900
032700         WHEN OTHER                                               02477099
032800              INITIALIZE WS027-RECEIPT-PIX-ERROR-REC              02478099
032900              MOVE 'C'                TO WS027-ERROR-TYPE-CDE     02479099
033000              MOVE 'WSRD037 '         TO WS027-ERROR-COPYBOOK     02480099
033100              MOVE PC-PGM-NAME        TO WS027-ERROR-PGM-NAME     02490099
033200              MOVE '1075-'            TO WS027-ERROR-PARA-NBR     02500099
033300              MOVE SQLCODE            TO WS027-SQLCODE            02510099
033400              MOVE 'SET CURR TIMESTAMP2'                          02520099
033500                                      TO WS027-ERROR-DESC-TXT     02520199
033600              PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                02520206
033700              MOVE '1075-GET-DB2-TIMESTAMP2' TO PV-PARAGRAPH      02520399
033800              MOVE 'SET TIMESTAMP2     '     TO PV-TABLE-NAME     02520499
033900              PERFORM 9500-ABEND                                  02520599
034000     END-EVALUATE.                                                02520600
034100                                                                  02520700
034200******************************************************************02520800
034300* GETS MQ INFO FROM WSV_CNSMR_QUE (GET/READ) - TRANSACTIONS.      02520900
034400******************************************************************02521000
034500 1100-GET-MQ-INFO-BOL.                                            02522000
034600*    DISPLAY 'WSKUP026 - 1100-GET-MQ-INFO-BOL.         '.         02522199
034700                                                                  02522200
034800     PERFORM WITH TEST AFTER                                      02522300
034900             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 02522400
035000             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         02522500
035100                     SQLCODE = ZERO                               02522600
035200                                                                  02522700
035300       EXEC SQL                                                   02522800
035400        SELECT QUE_MGR,                                           02522900
035500               QUE_NM                                             02523000
035600         INTO :WSV00006-QUE-MGR                                   02523106
035700             ,:WSV00006-QUE-NM                                    02523200
035800         FROM WSV_CNSMR_QUE                                       02523300
035900        WHERE APPL_FUNC_DESC  = 'BOLQ'                            02523400
036000          AND INTGRTN_TYP_CDE = 'BOLREPSTRY'                      02523502
036100       END-EXEC                                                   02523600
036200                                                                  02523706
036300       DISPLAY 'WSV00006-QUE-MGR =' WSV00006-QUE-MGR-TEXT         02523806
036400       DISPLAY 'WSV00006-QUE-NM  =' WSV00006-QUE-NM-TEXT          02523906
036500                                                                  02524006
036600       EVALUATE TRUE                                              02524106
036700           WHEN SQLCODE = 0                                       02524206
036800             INITIALIZE PV-QMGR-NAME-BOL                          02524306
036900             MOVE WSV00006-QUE-MGR-TEXT TO                        02524406
037000                PV-QMGR-NAME-BOL                                  02524506
037100             INITIALIZE PV-QUE-NAME-BOL                           02524606
037200             MOVE WSV00006-QUE-NM-TEXT TO                         02524706
037300                PV-QUE-NAME-BOL                                   02524806
037400           WHEN OTHER                                             02524906
037500             DISPLAY PC-PGM-NAME                                  02525006
037600                ' - Q OR QMGR ERROR IN QUEUE          '           02525106
037700             MOVE 'Q OR QMGR ERROR IN QUEUE           ' TO        02525206
037800                PV-ERROR-MESSAGE                                  02525306
037900             ADD +1 TO PA-ERRORS-PROCESSED                        02525406
038000*        BOMB                                                             
038100             PERFORM 9001-MQSERIES-ERROR                          02525506
038200       END-EVALUATE                                               02525606
038300     END-PERFORM.                                                 02525706
038400                                                                  02525800
038500******************************************************************02525900
038600* GETS MQ INFO FROM WSV_PRVDR_QUE (PUT/WRITE) - ERROR QUEUE       02526000
038700******************************************************************02526100
038800 1160-GET-MQ-INFO-ERROR.                                          02526200
038900*    DISPLAY 'WSKUP026 - 1160-GET-MQ-INFO-ERROR.       '.         02526399
039000                                                                  02526400
039100     PERFORM WITH TEST AFTER                                      02526500
039200             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 02526600
039300             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         02526700
039400                     SQLCODE = ZERO                               02526800
039500                                                                  02526900
039600       EXEC SQL                                                   02527000
039700        SELECT LCL_QUE_MGR,                                       02527100
039800               QUE_NM                                             02527200
039900         INTO :WSV00005-LCL-QUE-MGR                               02527306
040000             ,:WSV00005-QUE-NM                                    02527400
040100         FROM WSV_PRVDR_QUE                                       02527500
040200        WHERE APPL_FUNC_DESC  = 'PIXLEGACYQ'                      02527600
040300          AND INTGRTN_TYP_CDE = 'PIXFRWDERR'                      02527700
040400       END-EXEC                                                   02527800
040500                                                                  02527900
040600       DISPLAY 'WSV00005-QUE-MGR =' WSV00005-LCL-QUE-MGR-TEXT     02528006
040700       DISPLAY 'WSV00005-QUE-NM  =' WSV00005-QUE-NM-TEXT          02528106
040800                                                                  02528206
040900       EVALUATE TRUE                                              02528300
041000           WHEN SQLCODE = 0                                       02528400
041100              INITIALIZE PV-QMGR-NAME-ERROR                       02528506
041200              MOVE WSV00005-LCL-QUE-MGR-TEXT TO                   02528606
041300                 PV-QMGR-NAME-ERROR                               02528706
041400              INITIALIZE PV-QUE-NAME-ERROR                        02528806
041500              MOVE WSV00005-QUE-NM-TEXT TO                        02528906
041600                 PV-QUE-NAME-ERROR                                02529006
041700           WHEN OTHER                                             02529100
041800             DISPLAY PC-PGM-NAME                                  02529200
041900                ' - Q OR QMGR ERROR IN PIXLEGACYQ/PIXFRWDERR'     02529300
042000             MOVE 'Q OR QMGR ERROR IN PIXLEGACYQ/PIXFRWDERR' TO   02529400
042100                PV-ERROR-MESSAGE                                  02529500
042200             ADD +1 TO PA-ERRORS-PROCESSED                        02529606
042300*        BOMB                                                             
042400             PERFORM 9001-MQSERIES-ERROR                          02529700
042500       END-EVALUATE                                               02529800
042600     END-PERFORM.                                                 02529900
042700                                                                  02530000
042800******************************************************************02530100
042900* CONNECT TO QUEUE MANAGER.                                       02530200
043000******************************************************************02530300
043100 1200-MQSERIES-CONNECT.                                           02530400
043200*    DISPLAY 'WSKUP026 - 1200-MQSERIES-CONNECT.        '.         02530599
043300                                                                  02530600
043400     CALL PC-MQCONN USING PV-QMGR-NAME-BOL                        02530700
043500                          PV-HCONN                                02530800
043600                          PV-COMPLETION-CODE                      02530900
043700                          PV-REASON.                              02531000
043800                                                                  02531100
043900     MOVE PV-REASON TO PV-CON-REASON.                             02531200
044000     IF PV-COMPLETION-CODE = MQCC-OK THEN                         02531300
044100         CONTINUE                                                 02531400
044200     ELSE                                                         02531500
044300         STRING 'CONNECT - ' PV-QMGR-NAME-BOL                     02531600
044400           DELIMITED BY SIZE INTO PV-ACTION                       02531700
044500         ADD +1 TO PA-ERRORS-PROCESSED                            02531806
044600*        BOMB                                                             
044700         PERFORM 9001-MQSERIES-ERROR.                             02531900
044800                                                                  02532000
044900***************************************************************** 02532100
045000*   OPEN THE ITEM QUEUE FOR GETS (TRANSACTIONS).                  02532200
045100***************************************************************** 02532300
045200 1300-MQSERIES-OPEN-BOL.                                          02532400
045300*    DISPLAY 'WSKUP026 - 1300-MQSERIES-OPEN-BOL.       '.         02532599
045400                                                                  02532600
045500     MOVE '1300-MQSERIES-OPEN-BOL'     TO PV-PARAGRAPH.           02532706
045600                                                                  02532806
045700     COMPUTE PV-OPEN-OPTIONS        = MQOO-INPUT-SHARED           02532906
045800                                    + MQOO-OUTPUT                 02533006
045900                                    + MQOO-SET-IDENTITY-CONTEXT   02533106
046000                                    + MQOO-FAIL-IF-QUIESCING.     02533206
046100     MOVE MQOT-Q                   TO MQOD-OBJECTTYPE.            02533306
046200     MOVE PV-QMGR-NAME-BOL         TO MQOD-OBJECTQMGRNAME.        02533406
046300     MOVE PV-QUE-NAME-BOL          TO MQOD-OBJECTNAME.            02533506
046400                                                                  02533606
046500     CALL PC-MQOPEN USING PV-HCONN                                02533706
046600                          MQM-OBJECT-DESCRIPTOR                   02533806
046700                          PV-OPEN-OPTIONS                         02533906
046800                          PV-HANDLE-BOL                           02534006
046900                          PV-COMPLETION-CODE                      02534106
047000                          PV-REASON.                              02534206
047100                                                                  02534306
047200     IF PV-COMPLETION-CODE = MQCC-OK THEN                         02534406
047300         CONTINUE                                                 02534506
047400     ELSE                                                         02534606
047500         STRING 'OPEN - ' PV-QUE-NAME-BOL                         02534706
047600           DELIMITED BY SIZE INTO PV-ACTION                       02534806
047700         ADD +1 TO PA-ERRORS-PROCESSED                            02534906
047800*        BOMB                                                             
047900         PERFORM 9001-MQSERIES-ERROR.                             02535006
048000                                                                  02535106
048100***************************************************************** 02535200
048200*   OPEN THE ITEM QUEUE FOR PUTS (ERROR TRANSACTIONS).            02535300
048300***************************************************************** 02535400
048400 1340-MQSERIES-OPEN-ERROR.                                        02535500
048500*    DISPLAY 'WSKUP026 - 1340-MQSERIES-OPEN-ERROR.     '.         02535699
048600                                                                  02535706
048700     MOVE PV-QMGR-NAME-ERROR       TO MQOD-OBJECTQMGRNAME.        02535806
048800     MOVE PV-QUE-NAME-ERROR        TO MQOD-OBJECTNAME.            02535906
048900                                                                  02536006
049000     COMPUTE PV-OPEN-OPTIONS       = MQOO-OUTPUT                  02536106
049100                                   + MQOO-SET-IDENTITY-CONTEXT    02536206
049200                                   + MQOO-FAIL-IF-QUIESCING.      02536306
049300                                                                  02536406
049400     CALL PC-MQOPEN USING PV-HCONN                                02536506
049500                          MQM-OBJECT-DESCRIPTOR                   02536606
049600                          PV-OPEN-OPTIONS                         02536706
049700                          PV-HANDLE-ERROR                         02536806
049800                          PV-COMPLETION-CODE                      02536906
049900                          PV-REASON.                              02537006
050000                                                                  02537106
050100     IF PV-COMPLETION-CODE = MQCC-OK THEN                         02537206
050200         CONTINUE                                                 02537306
050300     ELSE                                                         02537406
050400         STRING 'OPEN - ' PV-QUE-NAME-ERROR                       02537506
050500           DELIMITED BY SIZE INTO PV-ACTION                       02537606
050600         ADD +1 TO PA-ERRORS-PROCESSED                            02537706
050700*        BOMB                                                             
050800         PERFORM 9001-MQSERIES-ERROR                              02537806
050900     END-IF.                                                      02537906
051000                                                                  02538006
051100****************************************************************  02538106
051200** GET THE MESSAGE (TRANSACTION) FROM THE QUEUE.                  02538206
051300****************************************************************  02538306
051400 1400-GET-MQ-MESSAGE.                                             02538406
051500*    DISPLAY 'WSKUP026 - 1400-GET-MQ-MESSAGE.          '.         02538599
051600                                                                  02538606
051700     INITIALIZE PV-MSGBUFFER                                      02538706
051800                PV-MSG.                                           02538806
051900                                                                  02538906
052000     MOVE MQMI-NONE         TO MQMD-MSGID.                        02539006
052100     MOVE MQCI-NONE         TO MQMD-CORRELID.                     02539106
052200                                                                  02539206
052300     MOVE MQFMT-STRING      TO MQMD-FORMAT.                       02539306
052400     MOVE +2048000          TO PV-MSG-LENGTH.                     02539406
052500                                                                  02539506
052600*** THE UNLIMITED WAIT INTERVAL MEANS THAT PROCESSING WILL                
052700*** CONTINUE UNTIL A END-OF-RUN MESSAGE APPEARS ON THE Q.                 
052800     MOVE MQWI-UNLIMITED       TO MQGMO-WAITINTERVAL.                     
052900                                                                          
053000     COMPUTE MQGMO-OPTIONS  =  MQGMO-SYNCPOINT +                  02539606
053100                               MQGMO-CONVERT   +                  02539706
053200                               MQGMO-ACCEPT-TRUNCATED-MSG +       02539806
053300                               MQGMO-WAIT.                        02539906
053400                                                                  02540006
053500     CALL PC-MQGET USING PV-HCONN                                 02540106
053600                         PV-HANDLE-BOL                            02540206
053700                         MQM-MESSAGE-DESCRIPTOR                   02540306
053800                         MQM-GET-MESSAGE-OPTIONS                  02540406
053900                         PV-MSG-LENGTH                            02540506
054000                         PV-MSGBUFFER(1:PV-MSG-LENGTH)            02540606
054100                         PV-DATA-LENGTH                           02540706
054200                         PV-COMPLETION-CODE                       02540806
054300                         PV-REASON.                               02540906
054400                                                                  02541006
054500     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        02541106
054600         IF ((PV-REASON NOT = MQRC-NO-MSG-AVAILABLE)              02541206
054700          AND (PV-REASON NOT = MQRC-TRUNCATED-MSG-ACCEPTED))      02541306
054800            INITIALIZE WS027-RECEIPT-PIX-ERROR-REC                02541499
054900            MOVE 'D'                TO WS027-ERROR-TYPE-CDE       02541599
055000            MOVE 'WSRD037 '         TO WS027-ERROR-COPYBOOK       02541699
055100            MOVE PC-PGM-NAME        TO WS027-ERROR-PGM-NAME       02541799
055200            MOVE '1400-'            TO WS027-ERROR-PARA-NBR       02541899
055300            MOVE SQLCODE            TO WS027-SQLCODE              02541999
055400            MOVE 'GET MQ 1       '                                02542099
055500                                    TO WS027-ERROR-DESC-TXT       02542199
055600            PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                  02542206
055700            DISPLAY 'PV-MSGBUFF1:' PV-MSGBUFFER(1:PV-DATA-LENGTH) 02542306
055800            DISPLAY 'PV-MSGLNGT1:' PV-MSG-LENGTH                  02542406
055900            DISPLAY 'PV-DATLNGT1:' PV-DATA-LENGTH                 02542506
056000            DISPLAY 'PV-COMPLCD1:' PV-COMPLETION-CODE             02542606
056100            DISPLAY 'PV-REASON1 :' PV-REASON                      02542706
056200            MOVE 'MQGET ERROR'          TO PV-ERROR-MESSAGE       02542806
056300            MOVE '1400-GET-MQ-MSG'      TO PV-PARAGRAPH           02542906
056400            MOVE PV-COMPLETION-CODE     TO IS-COMPLETION          02543006
056500            MOVE PV-REASON              TO IS-REASON-TEXT         02543106
056600            STRING 'GET - ' PV-QMGR-NAME-BOL                      02543206
056700            DELIMITED BY SIZE INTO PV-ACTION                      02543306
056800            ADD +1 TO PA-ERRORS-PROCESSED                         02543406
056900*        BOMB                                                             
057000            PERFORM 9001-MQSERIES-ERROR                           02543506
057100         ELSE                                                     02543606
057200*THIS MEANS A MSG WAS TRUNCATED                                   02543706
057300            IF PV-COMPLETION-CODE = +1                            02543806
057400             AND PV-REASON = +2079                                02543906
057500               INITIALIZE WS027-RECEIPT-PIX-ERROR-REC             02544099
057600               MOVE 'D'                TO WS027-ERROR-TYPE-CDE    02545099
057700               MOVE 'WSRD037 '         TO WS027-ERROR-COPYBOOK    02546099
057800               MOVE PC-PGM-NAME        TO WS027-ERROR-PGM-NAME    02547099
057900               MOVE '1400-'            TO WS027-ERROR-PARA-NBR    02548099
058000               MOVE SQLCODE            TO WS027-SQLCODE           02549099
058100               MOVE 'GET MQ 2       '                             02550099
058200                                       TO WS027-ERROR-DESC-TXT    02550199
058300               PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT               02550206
058400               DISPLAY 'PV-MSGBUFF2:' PV-MSGBUFFER                02550399
058500                                      (1:PV-DATA-LENGTH)          02550499
058600               DISPLAY 'PV-MSGLNGT2:' PV-MSG-LENGTH               02550506
058700               DISPLAY 'PV-DATLNGT2:' PV-DATA-LENGTH              02550606
058800               DISPLAY 'PV-COMPLCD2:' PV-COMPLETION-CODE          02550706
058900               DISPLAY 'PV-REASON2 :' PV-REASON                   02550806
059000               MOVE PV-COMPLETION-CODE     TO IS-COMPLETION       02550906
059100               MOVE PV-REASON              TO IS-REASON-TEXT      02551006
059200               ADD +1          TO PA-MQ-BOL-MSGS-READ             02551106
059300               STRING 'GET - ' PV-QMGR-NAME-BOL 'MSG TRUNCATED'   02551206
059400               DELIMITED BY SIZE INTO PV-ACTION                   02551306
059500               ADD +1 TO PA-ERRORS-PROCESSED                      02551406
059600*        BOMB                                                             
059700               PERFORM 9001-MQSERIES-ERROR                        02551506
059800            ELSE                                                  02551606
059900               IF (PV-REASON = MQRC-NO-MSG-AVAILABLE)             02551706
060000                  CONTINUE                                        02551806
060100*                 DISPLAY 'PV-MSGBUFF4:' PV-MSGBUFFER             02551906
060200*                                        (1:PV-DATA-LENGTH)       02552099
060300*                 DISPLAY 'PV-MSGLNGT4:' PV-MSG-LENGTH            02552106
060400*                 DISPLAY 'PV-DATLNGT4:' PV-DATA-LENGTH           02552206
060500*                 DISPLAY 'PV-COMPLCD4:' PV-COMPLETION-CODE       02552306
060600*                 DISPLAY 'PV-REASON4 :' PV-REASON                02552406
060700*                 DISPLAY 'REC:' PV-MSG(1:PV-DATA-LENGTH)         02552506
060800               END-IF                                             02552606
060900            END-IF                                                02552706
061000         END-IF                                                   02552806
061100     ELSE                                                         02552906
061200         MOVE PV-MSGBUFFER  TO PV-MSG                             02553006
061300         ADD +1             TO PA-MQ-BOL-MSGS-READ                02553106
061400*        DISPLAY 'PV-MSGBUFF3:' PV-MSGBUFFER(1:PV-DATA-LENGTH)    02553206
061500*        DISPLAY 'PV-MSGLNGT3:' PV-MSG-LENGTH                     02553306
061600*        DISPLAY 'PV-DATLNGT3:' PV-DATA-LENGTH                    02553406
061700*        DISPLAY 'PV-COMPLCD3:' PV-COMPLETION-CODE                02553506
061800*        DISPLAY 'PV-REASON3 :' PV-REASON                         02553606
061900*        DISPLAY '300 REC:' PV-MSG(1:PV-DATA-LENGTH)              02553706
062000*        DISPLAY 'IN 1400-   :' PV-REASON                         02553806
062100     END-IF.                                                      02553906
062200                                                                  02554006
062300******************************************************************02554106
062400* PROCESS/PARSE THE XML DATA                                      02554206
062500******************************************************************02554306
062600 2000-PROCESS-XML.                                                02554400
062700*    DISPLAY 'WSKUP026 - 2000-PROCESS-XML.             '.         02554599
062800                                                                  02554600
062900*    DISPLAY " ".                                                 02554700
063000*    DISPLAY "PROCESSING XML...".                                 02554800
063100     INITIALIZE WS037-INVOICE-BRIDGE.                             02554900
063200                                                                  02555000
063300     IF PV-MSG (1:18) = PC-END-RUN-MSG                            05470099
063400        SET PS-TIME-TO-END-PROGRAM-YES TO TRUE                    05480099
063500        ADD 1                         TO PA-END-PGM-MSGS                  
063600     ELSE                                                         05490099
063700         XML PARSE PV-MSG                                         02555102
063800             PROCESSING PROCEDURE                                 02555200
063900                 2100-HANDLE-XML                                  02555300
064000             ON EXCEPTION                                         02555400
064100                 PERFORM 3000-XML-ERROR                           02555500
064200             NOT ON EXCEPTION                                     02555600
064300                 PERFORM 3100-XML-SUCCESS                         02555700
064400         END-XML                                                  02555800
064500                                                                          
064600         IF PS-ROLLBACK-DB2-YES                                           
064700             PERFORM 6600-ROLLBACK-DB2                                    
064800         ELSE                                                             
064900             PERFORM 6500-COMMIT                                          
065000             PERFORM 8500-MQ-COMMIT                               03343406
065100         END-IF                                                           
065200                                                                          
065300         SET PS-ROLLBACK-DB2-NO           TO TRUE                         
065400         PERFORM 1400-GET-MQ-MESSAGE                              02556000
065500     END-IF.                                                              
065600                                                                  02556100
065700******************************************************************02556200
065800* PREP THE DB2 FIELDS WITH THE XML DATA                           02556300
065900* BREAK ON SELECTIVE XML FIELDS AND CREATE THE DB2 ROWS           02556400
066000******************************************************************02556500
066100 2100-HANDLE-XML.                                                 02556600
066200*    DISPLAY 'WSKUP026 - 2100-HANDLE-XML.              '.         02556799
066300                                                                  02556800
066400     COMPUTE XML-LENGTH = FUNCTION LENGTH(XML-TEXT).              02556900
066500                                                                  02557000
066600*    DISPLAY ' '                                                  02557100
066700*    DISPLAY 'PV-CURRENT-ELEMENT=' PV-CURRENT-ELEMENT             02557200
066800*            ' XML-LENGTH=' XML-LENGTH                            02557300
066900*    DISPLAY 'XML-TEXT(1:XML-LENGTH)=' XML-TEXT(1:XML-LENGTH).    02557400
067000*    DISPLAY 'XML-EVENT=' XML-EVENT                               02557500
067100                                                                  02557600
067200     EVALUATE XML-EVENT                                           02557700
067300       WHEN 'START-OF-ELEMENT'                                    02557800
067400         MOVE XML-TEXT(1:XML-LENGTH) TO PV-CURRENT-ELEMENT        02557900
067500                                                                  02558000
067600*      WHEN 'END-OF-ELEMENT'                                      02558100
067700*        DISPLAY 'end-of-element: ' XML-TEXT(1:XML-LENGTH)        02558200
067800                                                                  02558300
067900       EVALUATE XML-TEXT(1:XML-LENGTH)                            02558400
068000         WHEN 'InvoiceBridge'                                     02558500
068100               MOVE +1               TO PV-REC-SEQ-NBR            02558600
068200         WHEN OTHER                                               02558700
068300               CONTINUE                                           02558800
068400       END-EVALUATE                                               02558900
068500                                                                  02559000
068600       WHEN 'ATTRIBUTE-NAME'                                      02559100
068700         MOVE XML-TEXT(1:XML-LENGTH) TO PV-CURRENT-ATTRIBUTE      02559200
068800                                                                  02559300
068900       WHEN 'ATTRIBUTE-CHARACTERS'                                02559400
069000       WHEN 'ATTRIBUTE-CHARACTER'                                 02559500
069100       WHEN 'CONTENT-CHARACTERS'                                  02559600
069200       WHEN 'CONTENT-CHARACTER'                                   02559700
069300        EVALUATE PV-CURRENT-ELEMENT                               02559800
069400                                                                  02559900
069500         WHEN 'BatchCtlNbr'                                       02560003
069600          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-BATCHCTLNBR        02560103
069700                                                                  02560200
069800         WHEN 'Company'                                           02560303
069900          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-COMPANY            02560403
070000                                                                  02560500
070100         WHEN 'Divisio1'                                          02560603
070200          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-DIVISION           02560703
070300                                                                  02560800
070400         WHEN 'PickticketCtlNbr'                                  02560903
070500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02561003
070600                                      WS037-PICKTICKETCTLNBR      02561103
070700                                                                  02561200
070800         WHEN 'Warehouse'                                         02561303
070900          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-WAREHOUSE          02561403
071000                                                                  02561500
071100         WHEN 'PickticketNbr'                                     02561603
071200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02561703
071300                                      WS037-PICKTICKETNBR         02561803
071400                                                                  02561900
071500         WHEN 'PickticketSuffix'                                  02562003
071600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02562103
071700                                      WS037-PICKTICKETSUFFIX      02562203
071800                                                                  02562300
071900         WHEN 'OrderNbr'                                          02562403
072000          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-ORDERNBR           02562503
072100                                                                  02562600
072200         WHEN 'OrderSfx'                                          02562703
072300          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-ORDERSFX           02562803
072400                                                                  02562900
072500         WHEN 'OrderType'                                         02563003
072600          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-ORDERTYPE          02563103
072700                                                                  02563200
072800         WHEN 'RunType'                                           02563303
072900          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-RUNTYPE            02563403
073000                                                                  02563500
073100         WHEN 'DateCreated'                                       02563603
073200          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-DateCreated     02563703
073300                                                                  02563800
073400         WHEN 'ShipTo'                                            02563903
073500          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-ShipTo          02564003
073600                                                                  02564100
073700         WHEN 'SoldTo'                                            02564203
073800          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-SoldTo          02564303
073900                                                                  02564400
074000         WHEN 'StoreNbr'                                          02564503
074100          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-StoreNbr        02564603
074200                                                                  02564700
074300         WHEN 'DCCenterNbr'                                       02564803
074400          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-DCCenterNbr     02564903
074500                                                                  02565000
074600         WHEN 'MerchClass'                                        02565103
074700          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-MerchClass      02565203
074800                                                                  02565300
074900         WHEN 'MerchDiv'                                          02565403
075000          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-MerchDiv        02565503
075100                                                                  02565600
075200         WHEN 'OriginalShipVia'                                   02565703
075300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02565803
075400                                      WS037-PH-OriginalShipVia    02565903
075500                                                                  02566000
075600         WHEN 'ShipVia'                                           02566103
075700          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-ShipVia         02566203
075800                                                                  02566300
075900         WHEN 'PktGernerationDate'                                02566403
076000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02566503
076100                                    WS037-PH-PktGernerationDate   02566603
076200                                                                  02566700
076300         WHEN 'ShipDate'                                          02566803
076400          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-ShipDate        02566903
076500                                                                  02567000
076600         WHEN 'CustomerPONbr'                                     02567103
076700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02567203
076800                                      WS037-PH-CustomerPONbr      02567303
076900                                                                  02567400
077000         WHEN 'ProNbr'                                            02567503
077100          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-ProNbr          02567603
077200                                                                  02567700
077300         WHEN 'AppointmentNbr'                                    02567803
077400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02567903
077500                                      WS037-PH-AppointmentNbr     02568003
077600                                                                  02568100
077700         WHEN 'ARAccountNumber'                                   02568203
077800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02568303
077900                                      WS037-PH-ARAccountNumber    02568403
078000                                                                  02568500
078100         WHEN 'AddressCode'                                       02568603
078200          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-AddressCode     02568703
078300                                                                  02568800
078400         WHEN 'TotalWeight'                                       02568903
078500          INITIALIZE PV-DEC4-CONVERT                              02569003
078600          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC4-CONVERT          02569103
078700          INSPECT PV-DEC4 REPLACING   LEADING ' ' BY '0'          02569203
078800          MOVE PV-DEC4                TO PV-DEC4-CONVRTD          02569303
078900          MOVE PV-DEC4-CONVRTD        TO WS037-PH-TOTALWEIGHT     02569403
079000                                                                  02569503
079100         WHEN 'TotNbrOfCartons'                                   02569603
079200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02569703
079300                                      WS037-PH-TotNbrOfCartons    02569803
079400                                                                  02569900
079500         WHEN 'BillOfLading'                                      02570003
079600          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-BillOfLading    02570103
079700                                                                  02570200
079800         WHEN 'ManifestNbr'                                       02570303
079900          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-ManifestNbr     02570403
080000                                                                  02570500
080100         WHEN 'ShipWithCtlNbr'                                    02570603
080200          MOVE XML-TEXT(1:XML-LENGTH) TO WS037-PH-ShipWithCtlNbr  02570703
080300                                                                  02570800
080400         WHEN 'ProductValue'                                      02570903
080500          INITIALIZE PV-DEC2-CONVERT                              02571003
080600          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02571103
080700          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02571203
080800          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02571303
080900          MOVE PV-DEC2-CONVRTD        TO WS037-PH-ProductValue    02571403
081000                                                                  02571500
081100         WHEN 'ShippingCharges'                                   02571603
081200          INITIALIZE PV-DEC2-CONVERT                              02571703
081300          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02571803
081400          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02571903
081500          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02572003
081600          MOVE PV-DEC2-CONVRTD        TO                          02572103
081700                                      WS037-PH-ShippingCharges    02572203
081800                                                                  02572300
081900         WHEN 'HandlingCharges'                                   02572403
082000          INITIALIZE PV-DEC2-CONVERT                              02572503
082100          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02572603
082200          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02572703
082300          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02572803
082400          MOVE PV-DEC2-CONVRTD        TO                          02572903
082500                                      WS037-PH-HandlingCharges    02573003
082600                                                                  02573100
082700         WHEN 'TaxCharges'                                        02573203
082800          INITIALIZE PV-DEC2-CONVERT                              02573303
082900          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02573403
083000          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02573503
083100          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02573603
083200          MOVE PV-DEC2-CONVRTD        TO WS037-PH-TaxCharges      02573703
083300                                                                  02573800
083400         WHEN 'MiscCharges'                                       02573903
083500          INITIALIZE PV-DEC2-CONVERT                              02574003
083600          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02574103
083700          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02574203
083800          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02574303
083900          MOVE PV-DEC2-CONVRTD        TO WS037-PH-MiscCharges     02574403
084000                                                                  02574500
084100         WHEN 'SpeclInstrCode1'                                   02574603
084200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02574703
084300                                      WS037-PH-SpeclInstrCode1    02574803
084400                                                                  02574900
084500         WHEN 'SpeclInstrCode2'                                   02575003
084600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02575103
084700                                      WS037-PH-SpeclInstrCode2    02575203
084800                                                                  02575300
084900         WHEN 'SpeclInstrCode3'                                   02575403
085000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02575503
085100                                      WS037-PH-SpeclInstrCode3    02575603
085200                                                                  02575700
085300         WHEN 'SpeclInstrCode4'                                   02575803
085400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02575903
085500                                      WS037-PH-SpeclInstrCode4    02576003
085600                                                                  02576100
085700         WHEN 'SpeclInstrCode5'                                   02576203
085800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02576303
085900                                      WS037-PH-SpeclInstrCode5    02576403
086000                                                                  02576500
086100         WHEN 'SpeclInstrCode6'                                   02576603
086200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02576703
086300                                      WS037-PH-SpeclInstrCode6    02576803
086400                                                                  02576900
086500         WHEN 'SpeclInstrCode7'                                   02577003
086600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02577103
086700                                      WS037-PH-SpeclInstrCode7    02577203
086800                                                                  02577300
086900         WHEN 'SpeclInstrCode8'                                   02577403
087000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02577503
087100                                      WS037-PH-SpeclInstrCode8    02577603
087200                                                                  02577700
087300         WHEN 'SpeclInstrCode9'                                   02577803
087400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02577903
087500                                      WS037-PH-SpeclInstrCode9    02578003
087600                                                                  02578100
087700         WHEN 'SpeclInstrCode10'                                  02578203
087800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02578303
087900                                      WS037-PH-SpeclInstrCode10   02578403
088000                                                                  02578500
088100         WHEN 'SpeclInstrCode5'                                   02578603
088200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02578703
088300                                      WS037-PH-SpeclInstrCode5    02578803
088400                                                                  02578900
088500         WHEN 'CollectFreight'                                    02579003
088600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02579103
088700                                      WS037-PH-CollectFreight     02579203
088800                                                                  02579300
088900         WHEN 'RecordExpansionField'                              02579403
089000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02579503
089100                                  WS037-PH-RecordExpansionField   02579603
089200                                                                  02579700
089300         WHEN 'CheckerId'                                         02579803
089400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02579903
089500                                      WS037-PH-CheckerId          02580003
089600                                                                  02580100
089700         WHEN 'ShipmentNumber'                                    02580203
089800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02580303
089900                                      WS037-PH-ShipmentNumber     02580403
090000                                                                  02580500
090100         WHEN 'PackandHoldControlNumber'                          02580603
090200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02580703
090300                            WS037-PH-PackandHoldControlNbr        02580803
090400                                                                  02580900
090500         WHEN 'ApptMadeById'                                      02581003
090600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02581103
090700                                      WS037-PH-ApptMadeById       02581203
090800                                                                  02581300
090900         WHEN 'AppointmentDate'                                   02581403
091000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02581503
091100                                      WS037-PH-AppointmentDate    02581603
091200                                                                  02581700
091300         WHEN 'CustomerRouting'                                   02581803
091400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02581903
091500                                      WS037-PH-CustomerRouting    02582003
091600                                                                  02582100
091700         WHEN 'DescriptionDate'                                   02582203
091800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02582303
091900                                      WS037-PH-DescriptionDate    02582403
092000                                                                  02582500
092100         WHEN 'CustomerDepartment'                                02582603
092200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02582703
092300                                   WS037-PH-CustomerDepartment    02582803
092400                                                                  02582900
092500         WHEN 'ManagingTerritory'                                 02583003
092600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02583103
092700                                   WS037-PH-ManagingTerritory     02583203
092800                                                                  02583300
092900         WHEN 'MerchandiseCode'                                   02583403
093000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02583503
093100                                      WS037-PH-MerchandiseCode    02583603
093200                                                                  02583700
093300         WHEN 'NumberOfHangers'                                   02583803
093400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02583903
093500                                  WS037-PH-NumberOfHangers        02584003
093600                                                                  02584100
093700         WHEN 'NbrTimesApptChanged'                               02584203
093800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02584303
093900                                  WS037-PH-NbrTimesApptChanged    02584403
094000                                                                  02584500
094100         WHEN 'OrderDate'                                         02584603
094200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02584703
094300                                  WS037-PH-OrderDate              02584803
094400                                                                  02584900
094500         WHEN 'PickticketStatusCode'                              02585003
094600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02585103
094700                                  WS037-PH-PickticketStatusCode   02585203
094800                                                                  02585300
094900         WHEN 'PickticketType'                                    02585403
095000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02585503
095100                                  WS037-PH-PickticketType         02585603
095200                                                                  02585700
095300         WHEN 'PriorityCode'                                      02585803
095400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02585903
095500                                  WS037-PH-PriorityCode           02586003
095600                                                                  02586100
095700         WHEN 'PrioritySuffix'                                    02586203
095800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02586303
095900                                  WS037-PH-PrioritySuffix         02586403
096000                                                                  02586500
096100         WHEN 'ShipToWarehouse'                                   02586603
096200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02586703
096300                                  WS037-PH-ShipToWarehouse        02586803
096400                                                                  02586900
096500         WHEN 'SalespersonNumber'                                 02587003
096600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02587103
096700                                  WS037-PH-SalespersonNumber      02587203
096800                                                                  02587300
096900         WHEN 'StartShipDate'                                     02587403
097000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02587503
097100                                  WS037-PH-StartShipDate          02587603
097200                                                                  02587700
097300         WHEN 'StopShipDate'                                      02587803
097400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02587903
097500                                  WS037-PH-StopShipDate           02588003
097600                                                                  02588100
097700         WHEN 'TotalNumberofPallets'                              02588203
097800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02588303
097900                                  WS037-PH-TotalNumberofPallets   02588403
098000                                                                  02588500
098100         WHEN 'TotalNumberofUnits'                                02588603
098200          INITIALIZE PV-DEC2-CONVERT                              02588703
098300          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02588803
098400          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02588903
098500          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02589003
098600          MOVE PV-DEC2-CONVRTD        TO                          02589103
098700                                   WS037-PH-TotalNumberofUnits    02589203
098800                                                                  02589300
098900         WHEN 'TrailerStopSequenceNumber'                         02589403
099000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02589503
099100                             WS037-PH-TrailerStopSequencNbr       02589603
099200                                                                  02589700
099300         WHEN 'VendorNumber'                                      02589803
099400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02589903
099500                                  WS037-PH-VendorNumber           02590003
099600                                                                  02590100
099700         WHEN 'WarehouseTransferFlag'                             02590203
099800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02590303
099900                                  WS037-PH-WarehouseTransferFlag  02590403
100000                                                                  02590500
100100         WHEN 'PlannedLoadNbr'                                    02590603
100200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02590703
100300                                  WS037-PH-PlannedLoadNbr         02590803
100400                                                                  02590900
100500         WHEN 'InsuranceCharge'                                   02591003
100600          INITIALIZE PV-DEC2-CONVERT                              02591103
100700          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02591203
100800          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02591303
100900          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02591403
101000          MOVE PV-DEC2-CONVRTD        TO                          02591503
101100                                      WS037-PH-InsuranceCharge    02591603
101200                                                                  02591700
101300         WHEN 'PlannedBOL'                                        02591803
101400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02591903
101500                                  WS037-PH-PlannedBOL             02592003
101600                                                                  02592100
101700         WHEN 'PlannedMasterBol'                                  02592203
101800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02592303
101900                                  WS037-PH-PlannedMasterBol       02592403
102000                                                                  02592500
102100         WHEN 'Route'                                             02592603
102200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02592703
102300                                  WS037-PH-Route                  02592803
102400                                                                  02592900
102500         WHEN 'RouteSequence'                                     02593003
102600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02593103
102700                                  WS037-PH-RouteSequence          02593203
102800                                                                  02593300
102900         WHEN 'BOLBreakAttribute'                                 02593403
103000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02593503
103100                                  WS037-PH-BOLBreakAttribute      02593603
103200                                                                  02593700
103300         WHEN 'GlobalLocnNbr'                                     02593803
103400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02593903
103500                                  WS037-PH-GlobalLocnNbr          02594003
103600                                                                  02594100
103700         WHEN 'AddrOnlyPkt'                                       02594203
103800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02594303
103900                                  WS037-PH-AddrOnlyPkt            02594403
104000                                                                  02594500
104100         WHEN 'ZoneSkip'                                          02594603
104200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02594703
104300                                  WS037-PH-ZoneSkip               02594803
104400                                                                  02594900
104500         WHEN 'InitShipVia'                                       02595003
104600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02595103
104700                                  WS037-PH-InitShipVia            02595203
104800                                                                  02595300
104900         WHEN 'PrePackFlag'                                       02595403
105000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02595503
105100                                  WS037-PH-PrePackFlag            02595603
105200                                                                  02595700
105300*                                                                 02595800
105400*  CREATE PICKTICKET HEADER RECORD                                02595900
105500* 'PrePackFlag' XML TAG SIGNALS END OF 'PH' RECORD TYPE           02596000
105600*                                                                 02596100
105700         MOVE 'PH'                    TO WS037-REC-TYPE           02596200
105800         PERFORM 2300-PREP-DB2-ELEMENTS                           02596300
105900                                                                  02596400
106000         WHEN 'PickticketLineNbr'                                 02596503
106100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02596603
106200                                  WS037-PD-PickticketLineNbr      02596703
106300                                                                  02596800
106400         WHEN 'Compan2'                                           02596903
106500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02597003
106600                                  WS037-PD-Company                02597103
106700                                                                  02597200
106800         WHEN 'Divisio2'                                          02597303
106900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02597403
107000                                  WS037-PD-Division               02597503
107100                                                                  02597600
107200         WHEN 'StyleSuffix'                                       02597703
107300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02597803
107400                                  WS037-PD-StyleSuffix            02597903
107500                                                                  02598000
107600         WHEN 'SkuID'                                             02598103
107700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02598203
107800                                  WS037-PD-SkuID                  02598303
107900                                                                  02598400
108000         WHEN 'InventoryType'                                     02598503
108100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02598603
108200                                  WS037-PD-InventoryType          02598703
108300                                                                  02598800
108400         WHEN 'ProductStatus'                                     02598903
108500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02599003
108600                                  WS037-PD-ProductStatus          02599103
108700                                                                  02599200
108800         WHEN 'BatchNumber'                                       02599303
108900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02599403
109000                                  WS037-PD-BatchNumber            02599503
109100                                                                  02599600
109200         WHEN 'SKUAttribute1'                                     02599703
109300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02599803
109400                                  WS037-PD-SKUAttribute1          02599903
109500                                                                  02600000
109600         WHEN 'SKUAttribute2'                                     02600103
109700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02600203
109800                                  WS037-PD-SKUAttribute2          02600303
109900                                                                  02600400
110000         WHEN 'SKUAttribute3'                                     02600503
110100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02600603
110200                                  WS037-PD-SKUAttribute3          02600703
110300                                                                  02600800
110400         WHEN 'SKUAttribute4'                                     02600903
110500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02601003
110600                                  WS037-PD-SKUAttribute4          02601103
110700                                                                  02601200
110800         WHEN 'SKUAttribute5'                                     02601303
110900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02601403
111000                                  WS037-PD-SKUAttribute5          02601503
111100                                                                  02601600
111200         WHEN 'CountryOfOrigin'                                   02601703
111300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02601803
111400                                  WS037-PD-CountryOfOrigin        02601903
111500                                                                  02602000
111600         WHEN 'Are2'                                              02602103
111700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02602203
111800                                  WS037-PD-Area                   02602303
111900                                                                  02602400
112000         WHEN 'Zone'                                              02602503
112100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02602603
112200                                  WS037-PD-Zone                   02602703
112300                                                                  02602800
112400         WHEN 'Aisle'                                             02602903
112500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02603003
112600                                  WS037-PD-Aisle                  02603103
112700                                                                  02603200
112800         WHEN 'Bay'                                               02603303
112900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02603403
113000                                  WS037-PD-Bay                    02603503
113100                                                                  02603600
113200         WHEN 'Level'                                             02603703
113300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02603803
113400                                  WS037-PD-Level                  02603903
113500                                                                  02604000
113600         WHEN 'Positio2'                                          02604103
113700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02604203
113800                                  WS037-PD-Position               02604303
113900                                                                  02604400
114000         WHEN 'DateCreate2'                                       02604503
114100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02604603
114200                                  WS037-PD-DateCreated            02604703
114300                                                                  02604800
114400         WHEN 'ReasonCode'                                        02604903
114500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02605003
114600                                  WS037-PD-ReasonCode             02605103
114700                                                                  02605200
114800         WHEN 'AssortmentNbr'                                     02605303
114900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02605403
115000                                  WS037-PD-AssortmentNbr          02605503
115100                                                                  02605600
115200         WHEN 'NbrUnitsInPrepack'                                 02605703
115300          INITIALIZE PV-DEC2-CONVERT                              02605803
115400          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02605903
115500          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02606003
115600          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02606103
115700          MOVE PV-DEC2-CONVRTD        TO                          02606203
115800                                  WS037-PD-NbrUnitsInPrepack      02606303
115900                                                                  02606400
116000         WHEN 'DistroType'                                        02606503
116100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02606603
116200                                  WS037-PD-DistroType             02606703
116300                                                                  02606800
116400         WHEN 'SpeclInstrCod21'                                   02606903
116500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02607003
116600                                  WS037-PD-SpeclInstrCode1        02607103
116700                                                                  02607200
116800         WHEN 'SpeclInstrCod22'                                   02607303
116900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02607403
117000                                  WS037-PD-SpeclInstrCode2        02607503
117100                                                                  02607600
117200         WHEN 'SpeclInstrCod23'                                   02607703
117300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02607803
117400                                  WS037-PD-SpeclInstrCode3        02607903
117500                                                                  02608000
117600         WHEN 'SpeclInstrCod24'                                   02608103
117700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02608203
117800                                  WS037-PD-SpeclInstrCode4        02608303
117900                                                                  02608400
118000         WHEN 'SpeclInstrCod25'                                   02608503
118100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02608603
118200                                  WS037-PD-SpeclInstrCode5        02608703
118300                                                                  02608800
118400         WHEN 'MiscIns10Byte1'                                    02608903
118500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02609003
118600                                  WS037-PD-MiscIns10Byte1         02609103
118700                                                                  02609200
118800         WHEN 'MiscIns20Byte1'                                    02609303
118900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02609403
119000                                  WS037-PD-MiscIns20Byte1         02609503
119100                                                                  02609600
119200         WHEN 'RecordExpansionFiel2'                              02609703
119300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02609803
119400                                  WS037-PD-RecordExpansionField   02609903
119500                                                                  02610000
119600         WHEN 'CancelQuantity'                                    02610103
119700          INITIALIZE PV-DEC2-CONVERT                              02610203
119800          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02610303
119900          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02610403
120000          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02610503
120100          MOVE PV-DEC2-CONVRTD        TO                          02610603
120200                                      WS037-PD-CancelQuantity     02610703
120300                                                                  02610800
120400         WHEN 'LineType'                                          02610903
120500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02611003
120600                                  WS037-PD-LineType               02611103
120700                                                                  02611200
120800         WHEN 'OriginalOrderLineNumber'                           02611303
120900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02611403
121000                              WS037-PD-OriginalOrderLineNbr       02611503
121100                                                                  02611600
121200         WHEN 'OriginalPktLineNumber'                             02611703
121300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02611803
121400                              WS037-PD-OriginalPktLineNumber      02611903
121500                                                                  02612000
121600         WHEN 'OriginalOrderQuantity'                             02612103
121700          INITIALIZE PV-DEC2-CONVERT                              02612203
121800          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02612303
121900          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02612403
122000          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02612503
122100          MOVE PV-DEC2-CONVRTD        TO                          02612603
122200                              WS037-PD-OriginalOrderQuantity      02612703
122300                                                                  02612800
122400         WHEN 'OriginalPickticketQty'                             02612903
122500          INITIALIZE PV-DEC2-CONVERT                              02613003
122600          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02613103
122700          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02613203
122800          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02613303
122900          MOVE PV-DEC2-CONVRTD        TO                          02613403
123000                               WS037-PD-OriginalPickticketQty     02613503
123100                                                                  02613600
123200         WHEN 'Price'                                             02613703
123300          INITIALIZE PV-DEC2-CONVERT                              02613803
123400          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02613903
123500          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02614003
123600          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02614103
123700          MOVE PV-DEC2-CONVRTD        TO                          02614203
123800                                      WS037-PD-Price              02614303
123900                                                                  02614400
124000         WHEN 'RetailPrice'                                       02614503
124100          INITIALIZE PV-DEC2-CONVERT                              02614603
124200          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02614703
124300          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02614803
124400          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02614903
124500          MOVE PV-DEC2-CONVRTD        TO                          02615003
124600                                      WS037-PD-RetailPrice        02615103
124700                                                                  02615200
124800         WHEN 'UnitWeight'                                        02615303
124900          INITIALIZE PV-DEC4-CONVERT                              02615403
125000          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC4-CONVERT          02615503
125100          INSPECT PV-DEC4 REPLACING   LEADING ' ' BY '0'          02615603
125200          MOVE PV-DEC4                TO PV-DEC4-CONVRTD          02615703
125300          MOVE PV-DEC4-CONVRTD        TO                          02615803
125400                                      WS037-PD-UnitWeight         02615903
125500                                                                  02616000
125600         WHEN 'UnitVolume'                                        02616103
125700          INITIALIZE PV-DEC4-CONVERT                              02616203
125800          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC4-CONVERT          02616303
125900          INSPECT PV-DEC4 REPLACING   LEADING ' ' BY '0'          02616403
126000          MOVE PV-DEC4                TO PV-DEC4-CONVRTD          02616503
126100          MOVE PV-DEC4-CONVRTD        TO                          02616603
126200                                      WS037-PD-UnitVolume         02616703
126300                                                                  02616800
126400         WHEN 'BackOrderQuantity'                                 02616903
126500          INITIALIZE PV-DEC2-CONVERT                              02617003
126600          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02617103
126700          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02617203
126800          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02617303
126900          MOVE PV-DEC2-CONVRTD        TO                          02617403
127000                                  WS037-PD-BackOrderQuantity      02617503
127100                                                                  02617600
127200         WHEN 'ShelfDays'                                         02617703
127300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02617803
127400                                  WS037-PD-ShelfDays              02617903
127500                                                                  02618000
127600         WHEN 'OrigSeason'                                        02618103
127700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02618203
127800                                  WS037-PD-OrigSeason             02618303
127900                                                                  02618400
128000         WHEN 'OrigSeasonYear'                                    02618503
128100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02618603
128200                                  WS037-PD-OrigSeasonYear         02618703
128300                                                                  02618800
128400         WHEN 'OrigStyle'                                         02618903
128500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02619003
128600                                  WS037-PD-OrigStyle              02619103
128700                                                                  02619200
128800         WHEN 'OrigStyleSuffix'                                   02619303
128900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02619403
129000                                  WS037-PD-OrigStyleSuffix        02619503
129100                                                                  02619600
129200         WHEN 'OrigColor'                                         02619703
129300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02619803
129400                                  WS037-PD-OrigColor              02619903
129500                                                                  02620000
129600         WHEN 'OrigColorSuffix'                                   02620103
129700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02620203
129800                                  WS037-PD-OrigColorSuffix        02620303
129900                                                                  02620400
130000         WHEN 'OrigSecDimension'                                  02620503
130100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02620603
130200                                  WS037-PD-OrigSecDimension       02620703
130300                                                                  02620800
130400         WHEN 'OrigQuantity'                                      02620903
130500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02621003
130600                                  WS037-PD-OrigQuantity           02621103
130700                                                                  02621200
130800         WHEN 'OrigSizeDesc'                                      02621303
130900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02621403
131000                                  WS037-PD-OrigQuantity           02621503
131100                                                                  02621600
131200         WHEN 'OrigSkuID'                                         02621703
131300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02621803
131400                                  WS037-PD-OrigSkuID              02621903
131500                                                                  02622000
131600         WHEN 'DistroSeqNumber'                                   02622103
131700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02622203
131800                                  WS037-PD-DistroSeqNumber        02622303
131900                                                                  02622400
132000         WHEN 'PONbr'                                             02622503
132100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02622603
132200                                  WS037-PD-PONbr                  02622703
132300                                                                  02622800
132400         WHEN 'ExportIdCode'                                      02622903
132500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02623003
132600                                  WS037-PD-ExportIdCode           02623103
132700                                                                  02623200
132800         WHEN 'TpePOPkt'                                          02623303
132900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02623403
133000                                  WS037-PD-TpePOPkt               02623503
133100                                                                  02623600
133200         WHEN 'CustomerPOLineNbr'                                 02623703
133300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02623803
133400                                  WS037-PD-CustomerPOLineNbr      02623903
133500                                                                  02624000
133600*                                                                 02624100
133700*  CREATE PICKTICKET DETAIL RECORD                                02624200
133800* 'PrePackFlag' XML TAG SIGNALS END OF 'PD' RECORD TYPE           02624300
133900*                                                                 02624400
134000         MOVE 'PD'                    TO WS037-REC-TYPE           02624500
134100         PERFORM 2350-PREP-DB2-ELEMENTS                           02624699
134200                                                                  02624700
134300         WHEN 'CartonNbr'                                         02624803
134400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02624903
134500                                  WS037-CH-CartonNbr              02625003
134600                                                                  02625100
134700         WHEN 'DateCreate3'                                       02625203
134800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02625303
134900                                  WS037-CH-DateCreated            02625403
135000                                                                  02625500
135100         WHEN 'SoldT2'                                            02625603
135200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02625703
135300                                  WS037-CH-SoldTo                 02625803
135400                                                                  02625900
135500         WHEN 'ShipT2'                                            02626003
135600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02626103
135700                                  WS037-CH-ShipTo                 02626203
135800                                                                  02626300
135900         WHEN 'CustomerPONb2'                                     02626403
136000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02626503
136100                                  WS037-CH-CustomerPONbr          02626603
136200                                                                  02626700
136300         WHEN 'TrackingNbr'                                       02626803
136400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02626903
136500                                  WS037-CH-TrackingNbr            02627003
136600                                                                  02627100
136700         WHEN 'CartonType'                                        02627203
136800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02627303
136900                                  WS037-CH-CartonType             02627403
137000                                                                  02627500
137100         WHEN 'CartonVolume'                                      02627603
137200          INITIALIZE PV-DEC4-CONVERT                              02627703
137300          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC4-CONVERT          02627803
137400          INSPECT PV-DEC4 REPLACING   LEADING ' ' BY '0'          02627903
137500          MOVE PV-DEC4                TO PV-DEC4-CONVRTD          02628003
137600          MOVE PV-DEC4-CONVRTD        TO                          02628103
137700                                  WS037-CH-CartonVolume           02628203
137800                                                                  02628300
137900         WHEN 'EstimatedWeight'                                   02628403
138000          INITIALIZE PV-DEC4-CONVERT                              02628503
138100          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC4-CONVERT          02628603
138200          INSPECT PV-DEC4 REPLACING   LEADING ' ' BY '0'          02628703
138300          MOVE PV-DEC4                TO PV-DEC4-CONVRTD          02628803
138400          MOVE PV-DEC4-CONVRTD        TO                          02628903
138500                                  WS037-CH-EstimatedWeight        02629003
138600                                                                  02629100
138700         WHEN 'ActualWeight'                                      02629203
138800          INITIALIZE PV-DEC4-CONVERT                              02629303
138900          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC4-CONVERT          02629403
139000          INSPECT PV-DEC4 REPLACING   LEADING ' ' BY '0'          02629503
139100          MOVE PV-DEC4                TO PV-DEC4-CONVRTD          02629603
139200          MOVE PV-DEC4-CONVRTD        TO                          02629703
139300                                  WS037-CH-ActualWeight           02629803
139400                                                                  02629900
139500         WHEN 'FreightCharges'                                    02630003
139600          INITIALIZE PV-DEC2-CONVERT                              02630103
139700          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02630203
139800          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02630303
139900          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02630403
140000          MOVE PV-DEC2-CONVRTD        TO                          02630503
140100                                      WS037-CH-FreightCharges     02630603
140200                                                                  02630700
140300         WHEN 'CartonNbrXofY'                                     02630803
140400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02630903
140500                                  WS037-CH-CartonNbrXofY          02631003
140600                                                                  02631100
140700         WHEN 'PalletID'                                          02631203
140800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02631303
140900                                  WS037-CH-PalletID               02631403
141000                                                                  02631500
141100         WHEN 'LoadNbr'                                           02631603
141200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02631703
141300                                  WS037-CH-LoadNbr                02631803
141400                                                                  02631900
141500         WHEN 'BillOfLadin2'                                      02632003
141600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02632103
141700                                  WS037-CH-BillOfLading           02632203
141800                                                                  02632300
141900         WHEN 'ManifestNb2'                                       02632403
142000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02632503
142100                                  WS037-CH-ManifestNbr            02632603
142200                                                                  02632700
142300         WHEN 'TrailerNbr'                                        02632803
142400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02632903
142500                                  WS037-CH-TrailerNbr             02633003
142600                                                                  02633100
142700         WHEN 'ShipVi2'                                           02633203
142800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02633303
142900                                  WS037-CH-ShipVia                02633403
143000                                                                  02633500
143100         WHEN 'AppointmentNb2'                                    02633603
143200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02633703
143300                                  WS037-CH-AppointmentNbr         02633803
143400                                                                  02633900
143500         WHEN 'NbrTimesApptChange2'                               02634003
143600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02634103
143700                                  WS037-CH-NbrTimesApptChanged    02634203
143800                                                                  02634300
143900         WHEN 'AppointmentDat2'                                   02634403
144000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02634503
144100                                  WS037-CH-AppointmentDate        02634603
144200                                                                  02634700
144300         WHEN 'ApptMadeByI2'                                      02634803
144400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02634903
144500                                  WS037-CH-ApptMadeByID           02635003
144600                                                                  02635100
144700         WHEN 'LoadSequenceNbr'                                   02635203
144800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02635303
144900                                  WS037-CH-LoadSequenceNbr        02635403
145000                                                                  02635500
145100         WHEN 'CheckerI2'                                         02635603
145200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02635703
145300                                  WS037-CH-CheckerId              02635803
145400                                                                  02635900
145500         WHEN 'PickerID'                                          02636003
145600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02636103
145700                                  WS037-CH-PickerID               02636203
145800                                                                  02636300
145900         WHEN 'PackerID'                                          02636403
146000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02636503
146100                                  WS037-CH-PackerID               02636603
146200                                                                  02636700
146300         WHEN 'MiscNum1'                                          02636803
146400          INITIALIZE PV-DEC5-CONVERT                              02636903
146500          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC5-CONVERT          02637003
146600          INSPECT PV-DEC5 REPLACING   LEADING ' ' BY '0'          02637103
146700          MOVE PV-DEC5                TO PV-DEC5-CONVRTD          02637203
146800          MOVE PV-DEC5-CONVRTD        TO                          02637303
146900                                      WS037-CH-MiscNum1           02637403
147000                                                                  02637500
147100         WHEN 'MiscNum2'                                          02637603
147200          INITIALIZE PV-DEC5-CONVERT                              02637703
147300          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC5-CONVERT          02637803
147400          INSPECT PV-DEC5 REPLACING   LEADING ' ' BY '0'          02637903
147500          MOVE PV-DEC5                TO PV-DEC5-CONVRTD          02638003
147600          MOVE PV-DEC5-CONVRTD        TO                          02638103
147700                                      WS037-CH-MiscNum2           02638203
147800                                                                  02638300
147900         WHEN 'Warehous2'                                         02638403
148000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02638503
148100                                  WS037-CH-Warehouse              02638603
148200                                                                  02638700
148300         WHEN 'ShipmentNumbe2'                                    02638803
148400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02638903
148500                                  WS037-CH-ShipmentNumber         02639003
148600                                                                  02639100
148700         WHEN 'MiscInstructionCode1'                              02639203
148800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02639303
148900                                  WS037-CH-MiscInstructionCode1   02639403
149000                                                                  02639500
149100         WHEN 'MiscInstructionCode2'                              02639603
149200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02639703
149300                                  WS037-CH-MiscInstructionCode2   02639803
149400                                                                  02639900
149500         WHEN 'MiscInstructionCode3'                              02640003
149600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02640103
149700                                  WS037-CH-MiscInstructionCode3   02640203
149800                                                                  02640300
149900         WHEN 'MiscInstructionCode4'                              02640403
150000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02640503
150100                                  WS037-CH-MiscInstructionCode4   02640603
150200                                                                  02640700
150300         WHEN 'MiscInstructionCode5'                              02640803
150400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02640903
150500                                  WS037-CH-MiscInstructionCode5   02641003
150600                                                                  02641100
150700         WHEN 'BaseCharge'                                        02641203
150800          INITIALIZE PV-DEC2-CONVERT                              02641303
150900          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02641403
151000          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02641503
151100          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02641603
151200          MOVE PV-DEC2-CONVRTD        TO                          02641703
151300                                      WS037-CH-BaseCharge         02641803
151400                                                                  02641900
151500         WHEN 'InsuranceCharg2'                                   02642003
151600          INITIALIZE PV-DEC2-CONVERT                              02642103
151700          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02642203
151800          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02642303
151900          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02642403
152000          MOVE PV-DEC2-CONVRTD        TO                          02642503
152100                                      WS037-CH-InsuranceCharge    02642603
152200                                                                  02642700
152300         WHEN 'MasterBOL'                                         02642803
152400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02642903
152500                                  WS037-CH-MasterBOL              02643003
152600                                                                  02643100
152700         WHEN 'LoadDateTime'                                      02643203
152800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02643303
152900                                  WS037-CH-LoadDateTime           02643403
153000                                                                  02643500
153100         WHEN 'ParcelShpmtNbr'                                    02643603
153200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02643703
153300                                  WS037-CH-ParcelShpmtNbr         02643803
153400                                                                  02643900
153500         WHEN 'AddlOptionCharge'                                  02644003
153600          INITIALIZE PV-DEC2-CONVERT                              02644103
153700          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02644203
153800          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02644303
153900          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02644403
154000          MOVE PV-DEC2-CONVRTD        TO                          02644503
154100                                      WS037-CH-AddlOptionCharge   02644603
154200                                                                  02644700
154300         WHEN 'ActualCharge'                                      02644803
154400          INITIALIZE PV-DEC2-CONVERT                              02644903
154500          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02645003
154600          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02645103
154700          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02645203
154800          MOVE PV-DEC2-CONVRTD        TO                          02645303
154900                                      WS037-CH-ActualCharge       02645403
155000                                                                  02645500
155100         WHEN 'PreBulkBaseCharge'                                 02645603
155200          INITIALIZE PV-DEC2-CONVERT                              02645703
155300          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02645803
155400          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02645903
155500          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02646003
155600          MOVE PV-DEC2-CONVRTD        TO                          02646103
155700                                  WS037-CH-PreBulkBaseCharge      02646203
155800                                                                  02646300
155900         WHEN 'PreBulkAddlOptionCharge'                           02646403
156000          INITIALIZE PV-DEC2-CONVERT                              02646503
156100          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC2-CONVERT          02646603
156200          INSPECT PV-DEC2 REPLACING   LEADING ' ' BY '0'          02646703
156300          MOVE PV-DEC2                TO PV-DEC2-CONVRTD          02646803
156400          MOVE PV-DEC2-CONVRTD        TO                          02646903
156500                               WS037-CH-PreBulkAddlOptionChg      02647003
156600                                                                  02647100
156700         WHEN 'MiscCarton'                                        02647203
156800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02647303
156900                                  WS037-CH-MiscCarton             02647403
157000                                                                  02647500
157100         WHEN 'PalletType'                                        02647603
157200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02647703
157300                                  WS037-CH-PalletType             02647803
157400                                                                  02647900
157500         WHEN 'PalletSize'                                        02648003
157600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02648103
157700                                  WS037-CH-PalletSize             02648203
157800                                                                  02648300
157900         WHEN 'CartonEPC'                                         02648403
158000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02648503
158100                                  WS037-CH-CartonEPC              02648603
158200                                                                  02648700
158300         WHEN 'PalletEPC'                                         02648803
158400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02648903
158500                                  WS037-CH-PalletEPC              02649003
158600                                                                  02649100
158700         WHEN 'ShipDat2'                                          02649203
158800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02649303
158900                                  WS037-CH-ShipDate               02649403
159000                                                                  02649500
159100         WHEN 'EPCMatchFlag'                                      02649603
159200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02649703
159300                                  WS037-CH-EPCMatchFlag           02649803
159400                                                                  02649900
159500         WHEN 'CartonSize'                                        02650003
159600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02650103
159700                                  WS037-CH-CartonSize             02650203
159800                                                                  02650300
159900         WHEN 'LoadedPosition'                                    02650403
160000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02650503
160100                                  WS037-CH-LoadedPosition         02650603
160200                                                                  02650700
160300         WHEN 'PltMasterCartonFlag'                               02650803
160400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02650903
160500                               WS037-CH-PltMasterCartonFlag       02651003
160600                                                                  02651100
160700*                                                                 02651200
160800*  CREATE CARTON HEADER RECORD                                    02651300
160900* 'PltMasterCartonFlag' XML TAG SIGNALS END OF 'CH' RECORD TYPE   02651400
161000*                                                                 02651500
161100         MOVE 'CH'                    TO WS037-REC-TYPE           02651600
161200         PERFORM 2350-PREP-DB2-ELEMENTS                           02651799
161300                                                                  02651800
161400         WHEN 'CartonLineNbr'                                     02651903
161500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02652003
161600                                  WS037-CD-CartonLineNbr          02652103
161700                                                                  02652200
161800         WHEN 'Compan3'                                           02652303
161900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02652403
162000                                  WS037-CD-Company                02652503
162100                                                                  02652600
162200         WHEN 'Divisio3'                                          02652703
162300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02652803
162400                                  WS037-CD-Division               02652903
162500                                                                  02653000
162600         WHEN 'StyleSuffi2'                                       02653103
162700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02653203
162800                                  WS037-CD-StyleSuffix            02653303
162900                                                                  02653400
163000         WHEN 'SkuI2'                                             02653503
163100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02653603
163200                                  WS037-CD-SkuID                  02653703
163300                                                                  02653800
163400         WHEN 'InventoryTyp2'                                     02653903
163500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02654003
163600                                  WS037-CD-InventoryType          02654103
163700                                                                  02654200
163800         WHEN 'ProductStatu2'                                     02654303
163900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02654403
164000                                  WS037-CD-ProductStatus          02654503
164100                                                                  02654600
164200         WHEN 'BatchNumbe2'                                       02654703
164300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02654803
164400                                  WS037-CD-BatchNumber            02654903
164500                                                                  02655000
164600         WHEN 'SKUAttribut21'                                     02655103
164700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02655203
164800                                  WS037-CD-SKUAttribute1          02655303
164900                                                                  02655400
165000         WHEN 'SKUAttribut22'                                     02655503
165100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02655603
165200                                  WS037-CD-SKUAttribute2          02655703
165300                                                                  02655800
165400         WHEN 'SKUAttribut23'                                     02655903
165500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02656003
165600                                  WS037-CD-SKUAttribute3          02656103
165700                                                                  02656200
165800         WHEN 'SKUAttribut24'                                     02656303
165900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02656403
166000                                  WS037-CD-SKUAttribute4          02656503
166100                                                                  02656600
166200         WHEN 'SKUAttribut25'                                     02656703
166300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02656803
166400                                  WS037-CD-SKUAttribute5          02656903
166500                                                                  02657000
166600         WHEN 'CountryOfOrigi2'                                   02657103
166700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02657203
166800                                  WS037-CD-CountryOfOrigin        02657303
166900                                                                  02657400
167000         WHEN 'DateCreate4'                                       02657503
167100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02657603
167200                                  WS037-CD-DateCreated            02657703
167300                                                                  02657800
167400         WHEN 'PickticketLineNb2'                                 02657903
167500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02658003
167600                                  WS037-CD-PickticketLineNbr      02658103
167700                                                                  02658200
167800         WHEN 'CustomerSKU'                                       02658303
167900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02658403
168000                                  WS037-CD-CustomerSKU            02658503
168100                                                                  02658600
168200         WHEN 'AssortmentNb2'                                     02658703
168300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02658803
168400                                  WS037-CD-AssortmentNbr          02658903
168500                                                                  02659000
168600         WHEN 'VendorID'                                          02659103
168700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02659203
168800                                  WS037-CD-VendorID               02659303
168900                                                                  02659400
169000         WHEN 'VendorItemNumber'                                  02659503
169100          MOVE XML-TEXT(1:XML-LENGTH) TO                          02659603
169200                                  WS037-CD-VendorItemNumber       02659703
169300                                                                  02659800
169400         WHEN 'ConsumerPriorityDate'                              02659903
169500          MOVE XML-TEXT(1:XML-LENGTH) TO                          02660003
169600                                  WS037-CD-ConsumerPriorityDate   02660103
169700                                                                  02660200
169800         WHEN 'InStoreDate'                                       02660303
169900          MOVE XML-TEXT(1:XML-LENGTH) TO                          02660403
170000                                  WS037-CD-InStoreDate            02660503
170100                                                                  02660600
170200         WHEN 'MinorPickticketCntlNbr'                            02660703
170300          MOVE XML-TEXT(1:XML-LENGTH) TO                          02660803
170400                                WS037-CD-MinorPickticktCntlNbr    02660903
170500                                                                  02661000
170600         WHEN 'MinorPONbr'                                        02661103
170700          MOVE XML-TEXT(1:XML-LENGTH) TO                          02661203
170800                                  WS037-CD-MinorPONbr             02661303
170900                                                                  02661400
171000*                                                                 02661500
171100*  CREATE CARTON DETAIL RECORD                                    02661600
171200* 'PltMasterCartonFlag' XML TAG SIGNALS END OF 'CD' RECORD TYPE   02661700
171300*                                                                 02661800
171400         MOVE 'CD'                    TO WS037-REC-TYPE           02661900
171500         PERFORM 2350-PREP-DB2-ELEMENTS                           02662099
171600                                                                  02662100
171700         WHEN 'SerialSeqNbr'                                      02662203
171800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02662303
171900                                  WS037-GC-SerialSeqNbr           02662403
172000                                                                  02662500
172100         WHEN 'SerialNbr'                                         02662603
172200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02662703
172300                                  WS037-GC-SerialNbr              02662803
172400                                                                  02662900
172500         WHEN 'UnitsPacked'                                       02663003
172600          MOVE XML-TEXT(1:XML-LENGTH) TO                          02663103
172700                                  WS037-GC-UnitsPacked            02663203
172800                                                                  02663300
172900         WHEN 'MinorSeqNbr'                                       02663403
173000          MOVE XML-TEXT(1:XML-LENGTH) TO                          02663503
173100                                  WS037-GC-MinorSeqNbr            02663603
173200                                                                  02663700
173300         WHEN 'MinorSerialNbr'                                    02663803
173400          MOVE XML-TEXT(1:XML-LENGTH) TO                          02663903
173500                                  WS037-GC-MinorSerialNbr         02664003
173600                                                                  02664100
173700         WHEN 'CatchWtSeqNbr'                                     02664203
173800          MOVE XML-TEXT(1:XML-LENGTH) TO                          02664303
173900                                  WS037-GC-CatchWtSeqNbr          02664403
174000                                                                  02664500
174100         WHEN 'CartonSeqNbr'                                      02664603
174200          MOVE XML-TEXT(1:XML-LENGTH) TO                          02664703
174300                                  WS037-GC-CartonSeqNbr           02664803
174400                                                                  02664900
174500         WHEN 'CatchWeight'                                       02665003
174600          INITIALIZE PV-DEC4-CONVERT                              02665103
174700          MOVE XML-TEXT(1:XML-LENGTH) TO PV-DEC4-CONVERT          02665203
174800          INSPECT PV-DEC4 REPLACING   LEADING ' ' BY '0'          02665303
174900          MOVE PV-DEC4                TO PV-DEC4-CONVRTD          02665403
175000          MOVE PV-DEC4-CONVRTD        TO WS037-GC-CatchWeight     02665503
175100                                                                  02665600
175200*                                                                 02665700
175300*  CREATE GIFT CARD RECORD                                        02665800
175400* 'CatchWeight' XML TAG SIGNALS END OF 'GC' RECORD TYPE           02665900
175500*                                                                 02666000
175600         MOVE 'GC'                    TO WS037-REC-TYPE           02666100
175700         PERFORM 2350-PREP-DB2-ELEMENTS                           02666299
175800                                                                  02666300
175900         WHEN OTHER                                               02666400
176000           CONTINUE                                               02666500
176100        END-EVALUATE                                              02666600
176200                                                                  02666700
176300       WHEN 'EXCEPTION'                                           02666800
176400         DISPLAY 'Exception Caught at ' XML-TEXT(1:XML-LENGTH)    02666900
176500         IF PS-MQ-ERROR-YES                                       02667099
176600            CONTINUE                                              02668099
176700         ELSE                                                     02669099
176800            INITIALIZE WS027-RECEIPT-PIX-ERROR-REC                02670099
176900            MOVE 'D'                TO WS027-ERROR-TYPE-CDE       02680099
177000            MOVE 'WSRD037 '         TO WS027-ERROR-COPYBOOK       02690099
177100            MOVE PC-PGM-NAME        TO WS027-ERROR-PGM-NAME       02700099
177200            MOVE '2100-'            TO WS027-ERROR-PARA-NBR       02710099
177300            MOVE SQLCODE            TO WS027-SQLCODE              02720099
177400            MOVE 'HANDLE XML EXCEPTION  '                         02730099
177500                                    TO WS027-ERROR-DESC-TXT       02730199
176400            MOVE XML-TEXT(1:XML-LENGTH) TO WS027-FORMAT-RECORD    02666900
177600            PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                  02730206
177700         END-IF                                                   02730300
177800     END-EVALUATE.                                                02730400
177900                                                                  02730500
178000***************************************************************** 02730600
178100* PREPARE THE DATA FOR DB2 - CNTL & XFER TABLE                    02730799
178200***************************************************************** 02730800
178300 2300-PREP-DB2-ELEMENTS.                                          02730999
178400*    DISPLAY '2300-PREP-DB2-ELEMENTS         '.                   02731099
178500                                                                  02731100
178600     INITIALIZE DCLWST00005                                       02731200
178700                DCLWST00006.                                      02731300
178800                                                                  02731400
178900*                                                                 02731500
179000* NOTE; PRIMARY KEY FOR THE CNTL AND XFER TABLE ARE               02731600
179100*       PRC_CNTL_TMST AND TRN_TYP_CDE                             02731700
179200*                                                                 02731800
179300     PERFORM 1075-GET-DB2-TIMESTAMP2.                             02731900
179400     MOVE PV-CURRENT-TMST2     TO WST00005-PRC-CNTL-TMST          02732000
179500                                  WST00006-PRC-CNTL-TMST.         02732100
179600                                                                  02732200
179700     MOVE PV-CURRENT-TMST      TO WST00005-INIT-PRCG-BEG-TMST     02732300
179800                                  WST00005-END-TMST               02732400
179900                                  WST00005-FTP-LOD-TMST.          02732500
180000                                                                  02732600
180100     MOVE ZEROS                TO WST00005-RSTRT-CNT.             02732700
180200                                                                  02732800
180300     MOVE PV-REC-SEQ-NBR       TO WST00005-LAST-CNTL-SEQ-ID       02732900
180400                                  WST00006-BTCH-LOAD-SEQ-ID.      02733000
180500                                                                  02733100
180600     MOVE WS037-BATCHCTLNBR    TO WST00005-BTCH-ID                02733200
180700                                  WST00006-BTCH-ID.               02733300
180800                                                                  02733400
180900     MOVE PC-BOL               TO WST00005-TRN-TYP-CDE            02733500
181000                                  WST00006-TRN-TYP-CDE.           02733600
181100                                                                  02733700
181200     MOVE PC-READY             TO WST00005-STAT-CDE.              02733800
181300                                                                  02733900
181400     MOVE PC-N                 TO WST00005-ARCH-DAT-IND.          02734000
181500     MOVE +00.00               TO WST00005-DAT-LOD-VER-NBR.       02734100
181600                                                                  02734200
181700     MOVE +911                 TO WST00006-LOAD-DAT-TXT-LEN.      02734300
181800     MOVE WS037-INVOICE-BRIDGE TO WST00006-LOAD-DAT-TXT-TEXT.     02734400
181900                                                                  02734500
182000     PERFORM 2500-INSERT-BOL-CNTL.                                02734600
182100     PERFORM 2600-INSERT-BOL-XFER.                                02734700
182200     ADD +1                    TO PV-REC-SEQ-NBR.                 02734800
182300                                                                  02734900
182400***************************************************************** 02735099
182500* PREPARE THE DATA FOR DB2 -  XFER TABLE ONLY                     02735199
182600***************************************************************** 02735299
182700 2350-PREP-DB2-ELEMENTS.                                          02735399
182800*    DISPLAY '2350-PREP-DB2-ELEMENTS         '.                   02735499
182900                                                                  02735599
183000     INITIALIZE DCLWST00006.                                      02735799
183100                                                                  02735899
183200*                                                                 02735999
183300* NOTE; PRIMARY KEY FOR THE CNTL AND XFER TABLE ARE               02736099
183400*       PRC_CNTL_TMST AND TRN_TYP_CDE                             02736199
183500*                                                                 02736299
183600     MOVE PV-CURRENT-TMST2     TO WST00006-PRC-CNTL-TMST.         02736499
183700     MOVE PV-REC-SEQ-NBR       TO WST00006-BTCH-LOAD-SEQ-ID.      02737499
183800     MOVE WS037-BATCHCTLNBR    TO WST00006-BTCH-ID.               02737699
183900     MOVE PC-BOL               TO WST00006-TRN-TYP-CDE            02737999
184000     MOVE +911                 TO WST00006-LOAD-DAT-TXT-LEN.      02738799
184100     MOVE WS037-INVOICE-BRIDGE TO WST00006-LOAD-DAT-TXT-TEXT.     02738899
184200                                                                  02738999
184300     PERFORM 2600-INSERT-BOL-XFER.                                02739199
184400     ADD +1                    TO PV-REC-SEQ-NBR.                 02739299
184500                                                                  02739399
184600***************************************************************** 02739400
184700* INSERT WST_OTBND_DAT_CNTL                                       02739500
184800***************************************************************** 02739600
184900 2500-INSERT-BOL-CNTL.                                            02739799
185000*    DISPLAY '2500-INSERT-BOL-CNTL           '.                   02739899
185100                                                                  02739999
185200     EXEC SQL                                                     02740099
185300       INSERT INTO WST_OTBND_DAT_CNTL                             02740199
185400             (PRC_CNTL_TMST                                       02740299
185500             ,TRN_TYP_CDE                                         02740399
185600             ,BTCH_ID                                             02740499
185700             ,STAT_CDE                                            02740599
185800             ,INIT_PRCG_BEG_TMST                                  02740699
185900             ,LAST_CNTL_SEQ_ID                                    02740799
186000             ,END_TMST                                            02741099
186100             ,RSTRT_CNT                                           02750099
186200             ,ARCH_DAT_IND                                        02760099
186300             ,FTP_LOD_TMST                                        02770099
186400             ,DAT_LOD_VER_NBR                                     02780099
186500             )                                                    02790099
186600       VALUES                                                     02800099
186700             (:WST00005-PRC-CNTL-TMST                             02810099
186800             ,:WST00005-TRN-TYP-CDE                               02820099
186900             ,:WST00005-BTCH-ID                                   02830099
187000             ,:WST00005-STAT-CDE                                  02840099
187100             ,:WST00005-INIT-PRCG-BEG-TMST                        02850099
187200             ,:WST00005-LAST-CNTL-SEQ-ID                          02860099
187300             ,:WST00005-END-TMST                                  02870099
187400             ,:WST00005-RSTRT-CNT                                 02880099
187500             ,:WST00005-ARCH-DAT-IND                              02890099
187600             ,:WST00005-FTP-LOD-TMST                              02900099
187700             ,:WST00005-DAT-LOD-VER-NBR                           02910099
187800             )                                                    02920099
187900     END-EXEC                                                     02930099
188000                                                                  02940099
188100     EVALUATE TRUE                                                02950099
188200         WHEN SQLCODE = ZERO                                      02960099
188300              ADD +1                  TO PA-BOL-CNTL-INS          02970099
188400                                         PA-BOL-TOT-INS           02980099
188500         WHEN OTHER                                               02990099
188600              INITIALIZE WS027-RECEIPT-PIX-ERROR-REC              03000099
188700              MOVE 'C'                TO WS027-ERROR-TYPE-CDE     03010099
188800              MOVE 'WST00005'         TO WS027-ERROR-COPYBOOK     03020099
188900              MOVE PC-PGM-NAME        TO WS027-ERROR-PGM-NAME     03030099
189000              MOVE '2500-'            TO WS027-ERROR-PARA-NBR     03040099
189100              MOVE SQLCODE            TO WS027-SQLCODE            03050099
189200              MOVE 'INSERT WST_OTBND_DAT_CNTL '                   03060099
189300                                      TO WS027-ERROR-DESC-TXT     03060199
189400              PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                03060206
189500              SET PS-ROLLBACK-DB2-YES  TO TRUE                            
189600              PERFORM 9300-EOJ                                    03060306
189700              MOVE '2500-INSERT-BOL-CNTL' TO PV-PARAGRAPH         03060499
189800              MOVE 'WST_OTBND_DAT_CNTL  ' TO PV-TABLE-NAME        03060599
189900              PERFORM 9500-ABEND                                  03060699
190000     END-EVALUATE.                                                03060799
190100                                                                  03060899
190200***************************************************************** 03060900
190300* INSERT WST_OTBND_DAT_XFER                                       03061000
190400***************************************************************** 03062000
190500 2600-INSERT-BOL-XFER.                                            03063099
190600*    DISPLAY '2600-INSERT-BOL-XFER           '.                   03064099
190700                                                                  03065099
190800     EXEC SQL                                                     03066099
190900       INSERT INTO WST_OTBND_DAT_XFER                             03067099
191000             (PRC_CNTL_TMST                                       03068099
191100             ,TRN_TYP_CDE                                         03069099
191200             ,BTCH_LOAD_SEQ_ID                                    03070099
191300             ,BTCH_ID                                             03080099
191400             ,LOAD_DAT_TXT                                        03090099
191500             )                                                    03100099
191600       VALUES                                                     03110099
191700             (:WST00006-PRC-CNTL-TMST                             03120099
191800             ,:WST00006-TRN-TYP-CDE                               03130099
191900             ,:WST00006-BTCH-LOAD-SEQ-ID                          03140099
192000             ,:WST00006-BTCH-ID                                   03150099
192100             ,:WST00006-LOAD-DAT-TXT                              03160099
192200             )                                                    03170099
192300     END-EXEC                                                     03180099
192400                                                                  03190099
192500     EVALUATE TRUE                                                03200099
192600         WHEN SQLCODE = ZERO                                      03210099
192700              ADD +1                  TO PA-BOL-XFER-INS          03220099
192800                                         PA-BOL-TOT-INS           03230099
192900              INITIALIZE WS037-INVOICE-FIELDS                     03231099
193000         WHEN OTHER                                               03240099
193100              INITIALIZE WS027-RECEIPT-PIX-ERROR-REC              03250099
193200              MOVE 'C'                TO WS027-ERROR-TYPE-CDE     03260099
193300              MOVE 'WST00006'         TO WS027-ERROR-COPYBOOK     03270099
193400              MOVE PC-PGM-NAME        TO WS027-ERROR-PGM-NAME     03280099
193500              MOVE '2600-'            TO WS027-ERROR-PARA-NBR     03290099
193600              MOVE SQLCODE            TO WS027-SQLCODE            03300099
193700              MOVE 'INSERT WST_OTBND_DAT_XFER'                    03310099
193800                                      TO WS027-ERROR-DESC-TXT     03310199
193900              PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                03310206
194000             SET PS-ROLLBACK-DB2-YES  TO TRUE                             
194100              PERFORM 9300-EOJ                                    03310306
194200              MOVE '2600-INSERT-BOL-XFER' TO PV-PARAGRAPH         03310499
194300              MOVE 'WST_OTBND_DAT_XFER  ' TO PV-TABLE-NAME        03310599
194400              PERFORM 9500-ABEND                                  03310699
194500     END-EVALUATE.                                                03310799
194600                                                                  03310899
194700***************************************************************** 03310900
194800* XML ERROR                                                       03311000
194900***************************************************************** 03311100
195000 3000-XML-ERROR.                                                  03311200
195100*    DISPLAY 'WSKUP026 - 3000-XML-ERROR.               '.         03311399
195200                                                                  03311400
195300     PERFORM 9000-EXPLAIN-XML-RESPONSE                            03311500
195400     PERFORM  VARYING XML-LINE-IDX FROM 1 BY 1                    03311600
195500                UNTIL XML-LINE-IDX > XML-RESPONSE-LINES           03311700
195600         DISPLAY XML-MSG(XML-LINE-IDX)                            03311800
195700     END-PERFORM.                                                 03311900
195800     IF PS-MQ-ERROR-YES                                           03312099
195900        CONTINUE                                                  03313099
196000     ELSE                                                         03314099
196100        INITIALIZE WS027-RECEIPT-PIX-ERROR-REC                    03315099
196200        MOVE 'D'                TO WS027-ERROR-TYPE-CDE           03316099
196300        MOVE 'WSRD037 '         TO WS027-ERROR-COPYBOOK           03317099
196400        MOVE PC-PGM-NAME        TO WS027-ERROR-PGM-NAME           03318099
196500        MOVE '3000-'            TO WS027-ERROR-PARA-NBR           03319099
196600        MOVE SQLCODE            TO WS027-SQLCODE                  03320099
196700        MOVE 'XML ERROR             '                             03330099
196800                                TO WS027-ERROR-DESC-TXT           03330199
196900        PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                      03330206
197000     END-IF.                                                      03330306
197100                                                                  03330406
197200     MOVE +4018         TO PV-ABEND-CODE.                         03330500
197300     MOVE '3000-XML-ERROR' TO PV-PARAGRAPH.                       03330606
197400     PERFORM 9500-ABEND.                                          03330706
197500                                                                  03330800
197600******************************************************************03330900
197700* SUCCESSFUL XML PARSE                                            03331000
197800******************************************************************03331100
197900 3100-XML-SUCCESS.                                                03331200
198000                                                                  03331300
198100     ADD +1 TO PA-XML-PARSED.                                     03331400
198200                                                                  03331500
198300*    DISPLAY 'WSKUP026 - 3100-XML-SUCCESS.             '.         03331699
198400*                                                                 03331700
198500*    DISPLAY " ".                                                 03331800
198600*    DISPLAY "XML DOCUMENT SUCCESSFULLY PARSED".                  03331900
198700                                                                  03332000
198800***************************************************************** 03332100
198900* MQ SERIES CLOSE QUEUE FOR THE TRANSACTIONS.                     03332200
199000***************************************************************** 03332300
199100 4100-MQ-CLOSE-BOL-QUEUE.                                         03332400
199200*    DISPLAY 'WSKUP026 - 4100-MQ-CLOSE-BOL-QUEUE.      '.         03332599
199300                                                                  03332600
199400     MOVE '4100-MQ-CLOSE-BOL-QUEUE' TO PV-PARAGRAPH.              03332700
199500                                                                  03332800
199600     MOVE PV-QUE-NAME-BOL           TO MQOD-OBJECTNAME.           03332900
199700     MOVE PV-QMGR-NAME-BOL          TO MQOD-OBJECTQMGRNAME.       03333000
199800                                                                  03333100
199900     CALL PC-MQCLOSE USING PV-HCONN                               03333200
200000                           PV-HANDLE-BOL                          03333306
200100                           MQCO-NONE                              03333400
200200                           PV-COMPLETION-CODE                     03333500
200300                           PV-REASON.                             03333600
200400                                                                  03333700
200500     IF PV-COMPLETION-CODE = MQCC-OK THEN                         03333800
200600         CONTINUE                                                 03333900
200700     ELSE                                                         03334000
200800         STRING 'CLOSE - ' PV-QUE-NAME-ERROR                      03334100
200900           DELIMITED BY SIZE INTO PV-ACTION                       03334200
201000         ADD +1 TO PA-ERRORS-PROCESSED                            03334306
201100*        BOMB                                                             
201200         PERFORM 9001-MQSERIES-ERROR                              03334400
201300     END-IF.                                                      03334500
201400                                                                  03334600
201500***************************************************************** 03334700
201600* MQ SERIES CLOSE QUEUE FOR THE ERROR MESSAGE FILE.               03334800
201700***************************************************************** 03334900
201800 4300-MQ-CLOSE-ERROR-QUEUE.                                       03335000
201900*    DISPLAY 'WSKUP026 - 4300-MQ-CLOSE-ERROR-QUEUE.    '.         03335199
202000                                                                  03335200
202100     MOVE '4300-MQ-CLOSE-ERROR-QUEUE' TO PV-PARAGRAPH.            03335300
202200                                                                  03335400
202300     MOVE PV-QUE-NAME-ERROR         TO MQOD-OBJECTNAME.           03335500
202400     MOVE PV-QMGR-NAME-ERROR        TO MQOD-OBJECTQMGRNAME.       03335600
202500                                                                  03335700
202600     CALL PC-MQCLOSE USING PV-HCONN                               03335800
202700                           PV-HANDLE-ERROR                        03335906
202800                           MQCO-NONE                              03336000
202900                           PV-COMPLETION-CODE                     03336100
203000                           PV-REASON.                             03336200
203100                                                                  03336300
203200                                                                  03336400
203300     IF PV-COMPLETION-CODE = MQCC-OK THEN                         03336500
203400         CONTINUE                                                 03336600
203500     ELSE                                                         03336700
203600         STRING 'CLOSE - ' PV-QUE-NAME-ERROR                      03336800
203700           DELIMITED BY SIZE INTO PV-ACTION                       03336900
203800         ADD +1 TO PA-ERRORS-PROCESSED                            03337006
203900*        BOMB                                                             
204000         PERFORM 9001-MQSERIES-ERROR                              03337100
204100     END-IF.                                                      03337200
204200                                                                  03337300
204300***************************************************************** 03337400
204400* DISCONNECT FROM QUEUE MANAGER.                                  03337500
204500***************************************************************** 03337600
204600 4500-MQ-DISCONNECT.                                              03337700
204700*    DISPLAY 'WSKUP026 - 4500-MQ-DISCONNECT.           '.         03337899
204800                                                                  03337900
204900     MOVE '4500-MQ-DISCONNECT'    TO PV-PARAGRAPH.                03338000
205000                                                                  03338100
205100     IF PV-CON-REASON NOT = MQRC-ALREADY-CONNECTED                03338200
205200         CALL PC-MQDISC USING PV-HCONN                            03338300
205300                              PV-COMPLETION-CODE                  03338400
205400                              PV-REASON                           03338500
205500                                                                  03338600
205600     IF PV-COMPLETION-CODE = MQCC-OK THEN                         03338700
205700         CONTINUE                                                 03338800
205800     ELSE                                                         03338900
205900         STRING 'DISCONNECT - ' PV-QMGR-NAME-BOL                  03339000
206000           DELIMITED BY SIZE INTO PV-ACTION                       03339100
206100         ADD +1 TO PA-ERRORS-PROCESSED                            03339206
206200*        BOMB                                                             
206300         PERFORM 9001-MQSERIES-ERROR                              03339300
206400     END-IF.                                                      03339400
206500                                                                  03339500
206600                                                                  10980099
206700 6500-COMMIT.                                                             
206800                                                                          
206900     EXEC SQL                                                             
207000         COMMIT                                                           
207100     END-EXEC.                                                            
207200                                                                          
207300     EVALUATE TRUE                                                        
207400         WHEN SQLCODE EQUAL ZERO                                          
207500             ADD +1 TO PA-TOTAL-DB2-COMMITS                               
207600         WHEN SQLWARN0 NOT EQUAL SPACE                                    
207700         WHEN SQLCODE NOT EQUAL ZERO                                      
207800             INITIALIZE WS027-RECEIPT-PIX-ERROR-REC               03250099
207900             MOVE 'C'                 TO WS027-ERROR-TYPE-CDE     03260099
208000             MOVE 'WST00006'          TO WS027-ERROR-COPYBOOK     03270099
208100             MOVE PC-PGM-NAME         TO WS027-ERROR-PGM-NAME     03280099
208200             MOVE '6500-'             TO WS027-ERROR-PARA-NBR     03290099
208300             MOVE SQLCODE             TO WS027-SQLCODE            03300099
208400             MOVE 'DB2 COMMIT'        TO WS027-ERROR-DESC-TXT     03310199
208500             PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                 03310206
208600     END-EVALUATE.                                                        
208700                                                                          
208800 6600-ROLLBACK-DB2.                                                       
208900                                                                          
209000     EXEC SQL                                                             
209100         ROLLBACK                                                         
209200     END-EXEC.                                                            
209300                                                                          
209400     EVALUATE TRUE                                                        
209500         WHEN SQLCODE EQUAL ZERO                                          
209600             ADD +1 TO PA-TOTAL-DB2-ROLLBACKS                             
209700         WHEN SQLWARN0 NOT EQUAL SPACE                                    
209800         WHEN SQLCODE NOT EQUAL ZERO                                      
209900             INITIALIZE WS027-RECEIPT-PIX-ERROR-REC               03250099
210000             MOVE 'C'                 TO WS027-ERROR-TYPE-CDE     03260099
210100             MOVE 'WST00006'          TO WS027-ERROR-COPYBOOK     03270099
210200             MOVE PC-PGM-NAME         TO WS027-ERROR-PGM-NAME     03280099
210300             MOVE '6600-'             TO WS027-ERROR-PARA-NBR     03290099
210400             MOVE SQLCODE             TO WS027-SQLCODE            03300099
210500             MOVE 'DB2 ROLLBACK FAILURE'                          03310099
210600                                      TO WS027-ERROR-DESC-TXT     03310199
210700             PERFORM 8000-WRITE-MQ-ERROR-MESG-OUT                 03310206
210800     END-EVALUATE.                                                        
210900                                                                          
211000***************************************************************** 03339606
211100* WRITE OUTGOING ERROR MQ MESSAGE.                                03339706
211200***************************************************************** 03339806
211300 8000-WRITE-MQ-ERROR-MESG-OUT.                                    03339906
211400*    DISPLAY 'WSKUP026 - 8000-WRITE-MQ-ERROR-MESG-OUT. '.         03340099
211500     INITIALIZE DCLWST00005                                       03340106
211600                PV-ERRMSGBUFFER.                                  03340206
211700                                                                  03340300
211800     MOVE MQMI-NONE            TO MQMD-MSGID.                     03340406
211900     MOVE MQCI-NONE            TO MQMD-CORRELID.                  03340506
212000                                                                  03340606
212100     MOVE WS037-INVOICE-BRIDGE        TO WS027-FORMAT-RECORD.     03340706
212200     MOVE LENGTH OF WS027-RECEIPT-PIX-ERROR-REC                   03340806
212300                                      TO PV-MSG-LENGTH.           03340906
212400     MOVE WS027-RECEIPT-PIX-ERROR-REC TO PV-ERRMSGBUFFER.         03341006
212500                                                                  03341106
212600     MOVE MQFMT-STRING     TO MQMD-FORMAT.                        03341206
212700     MOVE MQPER-PERSISTENT TO MQMD-PERSISTENCE.                   03341306
212800     COMPUTE MQPMO-OPTIONS  =  MQPMO-SYNCPOINT +                  03341406
212900                               MQPMO-SET-IDENTITY-CONTEXT.        03341506
213000                                                                  03341606
213100     CALL PC-MQPUT USING PV-HCONN                                 03341706
213200                         PV-HANDLE-ERROR                          03341806
213300                         MQM-MESSAGE-DESCRIPTOR                   03341906
213400                         MQM-PUT-MESSAGE-OPTIONS                  03342006
213500                         PV-MSG-LENGTH                            03342106
213600                         PV-ERRMSGBUFFER(1:PV-MSG-LENGTH)         03342206
213700                         PV-COMPLETION-CODE                       03342306
213800                         PV-REASON.                               03342406
213900                                                                  03342506
214000     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        03342606
214100         DISPLAY 'MQ MESSAGE = ', PV-ERRMSGBUFFER                 03342706
214200         MOVE '8000-PUT-MQ-MESG-ON-QUEUE' TO PV-PARAGRAPH         03342806
214300         MOVE 'MQPUT FAILED'          TO PV-ERROR-MESSAGE         03342906
214400         ADD +1 TO PA-ERRORS-PROCESSED                            03343006
214500*        BOMB                                                             
214600         PERFORM 9001-MQSERIES-ERROR                              03343106
214700     ELSE                                                         03343206
214800         ADD 1 TO PA-MQ-ERROR-MSGS-SENT                           03343306
214900         PERFORM 8500-MQ-COMMIT                                   03343406
215000     END-IF.                                                      03343506
215100                                                                  03343606
215200******************************************************************03343799
215300*  COMMIT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT        03343899
215400******************************************************************03343999
215500 8500-MQ-COMMIT.                                                  03344099
215600*    DISPLAY '8500-MQ-COMMIT.   '                                 03345099
215700                                                                  03346099
215800     CALL PC-MQCMIT USING PV-HCONN                                03347099
215900                          PV-COMPLETION-CODE                      03348099
216000                          PV-REASON.                              03349099
216100                                                                  03350099
216200     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        03360099
216300        MOVE '8500-COMMIT-MQ'   TO PV-PARAGRAPH                   03370099
216400        MOVE 'MQCMIT ERROR'     TO PV-ERROR-MESSAGE               03380099
216500        MOVE PV-COMPLETION-CODE TO PV-HOLD-COMPLETION-CODE        03390099
216600        MOVE PV-REASON          TO PV-HOLD-REASON                 03400099
216700        MOVE PV-HOLD-COMPLETION-CODE TO PV-COMPLETION-CODE        03410099
216800        MOVE PV-HOLD-REASON     TO PV-REASON                      03410199
216900*        BOMB                                                             
217000        PERFORM 9001-MQSERIES-ERROR                               03410206
217100     ELSE                                                         03410399
217200        ADD 1 TO PA-MQ-COMMITS                                    03410499
217300     END-IF.                                                      03410599
217400                                                                  03410699
217500***************************************************************** 03410706
217600* EOJ AND DISPLAY SUMMARY TOTALS.                                 03410806
217700***************************************************************** 03410906
217800 9300-EOJ.                                                        03411006
217900*    DISPLAY 'WSKUP026 - 9300-EOJ.                     '.         03412099
218000                                                                  03412199
218100     PERFORM 4100-MQ-CLOSE-BOL-QUEUE.                             03412200
218200     PERFORM 4300-MQ-CLOSE-ERROR-QUEUE.                           03412300
218300     PERFORM 4500-MQ-DISCONNECT.                                  03412400
218400                                                                  03412500
218500     DISPLAY ' '.                                                 03412606
218600     DISPLAY '        WSKUP026 SUMMARY STATISTICS             '   03412706
218700     DISPLAY '************************************************'.  03412806
218800                                                                          
218900     MOVE PA-MQ-BOL-MSGS-READ         TO PV-DISP-NBR              03412906
219000     DISPLAY '  MQ BOL MESSAGES READ   =' PV-DISP-NBR             03412906
219100                                                                          
219200     MOVE PA-XML-PARSED               TO PV-DISP-NBR              03412906
219300     DISPLAY '  MQ MESSAGES PARSED     =' PV-DISP-NBR             03413006
219400                                                                          
219500     MOVE PA-END-PGM-MSGS             TO PV-DISP-NBR              03412906
219600     DISPLAY '  MQ STOP RUN MSGS       =' PV-DISP-NBR             03413806
219700                                                                          
219800     DISPLAY SPACES.                                              03413106
219900                                                                          
220000     MOVE PA-BOL-CNTL-INS             TO PV-DISP-NBR              03412906
220100     DISPLAY '  BOL CNTL INSERTS       =' PV-DISP-NBR             03413206
220200                                                                          
220300     MOVE PA-BOL-XFER-INS             TO PV-DISP-NBR              03412906
220400     DISPLAY '  BOL XFER INSERTS       =' PV-DISP-NBR             03413306
220500                                                                          
220600     MOVE PA-BOL-TOT-INS              TO PV-DISP-NBR              03412906
220700     DISPLAY '  TOTAL INSERTS          =' PV-DISP-NBR             03413406
220800                                                                          
220900     DISPLAY SPACES.                                              03413506
221000                                                                          
221100     MOVE PA-MQ-ERROR-MSGS-SENT       TO PV-DISP-NBR              03412906
221200     DISPLAY '  MQ ERROR MESSAGES SENT =' PV-DISP-NBR             03413606
221300                                                                          
221400     MOVE PA-ERRORS-PROCESSED         TO PV-DISP-NBR              03412906
221500     DISPLAY '  MQ ERRORS PROCESSED    =' PV-DISP-NBR             03413706
221600                                                                          
221700     MOVE PA-MQ-COMMITS               TO PV-DISP-NBR              03412906
221800     DISPLAY '  MQ ERROR COMMITS       =' PV-DISP-NBR             03413806
221900                                                                          
222000     MOVE PA-TOTAL-DB2-COMMITS        TO PV-DISP-NBR              03412906
222100     DISPLAY '  DB2 COMMITS            =' PV-DISP-NBR             03413806
222200                                                                          
222300     MOVE PA-TOTAL-DB2-ROLLBACKS      TO PV-DISP-NBR              03412906
222400     DISPLAY '  DB2 ROLLBACKS          =' PV-DISP-NBR             03413806
222500                                                                          
222600     DISPLAY '************************************************'.  03413906
222700     DISPLAY SPACES.                                              03414006
222800                                                                  03414106
222900******************************************************************03414200
223000* ABEND PROGRAM - CALL ABEND MODULE                               03414300
223100******************************************************************03414400
223200 9500-ABEND.                                                      03414506
223300     DISPLAY 'WSKUP026 - 9500-ABEND.                   '.         03414699
223400                                                                  03414706
223500     MOVE SQLCODE               TO PV-SQLCODE.                    03414806
223600     DISPLAY ' '.                                                 03414906
223700     DISPLAY '** ABEND INFO  '.                                   03415006
223800     DISPLAY ' '.                                                 03415106
223900     DISPLAY '** PROGRAM       = ' PC-PGM-NAME.                   03415206
224000     DISPLAY '** PARAGRAPH     = ' PV-PARAGRAPH.                  03415306
224100     DISPLAY '** TABLE         = ' PV-TABLE-NAME.                 03415406
224200     DISPLAY ' '.                                                 03415506
224300     DISPLAY '** SQLCODE       = ' PV-SQLCODE.                    03415606
224400     DISPLAY '** SQLWARN       = ' SQLWARN                        03415706
224500     DISPLAY '** SQLEXT        = ' SQLEXT                         03415806
224600     DISPLAY ' '.                                                 03415906
224700                                                                  03416006
224800     CALL 'ILBOABN0'  USING PV-ABEND-CODE.                        03416106
224900                                                                  03416206
225000     COPY ISPD002.                                                03416306
225100     COPY ISPD007.                                                03416406
225200     COPY ISPD008.                                                03416506
225300     COPY ISPD009.                                                03416606
225400******************************************************************03416700
225500* END WSKUP026                                                    03416800
225600******************************************************************03416900
