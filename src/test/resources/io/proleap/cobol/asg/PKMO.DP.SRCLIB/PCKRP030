000100***************************************************************** 00010065
000200 IDENTIFICATION DIVISION.                                         00020065
000300***************************************************************** 00030065
000400                                                                  00040065
000500 PROGRAM-ID.             PCKRP030.                                00050065
000600 AUTHOR.                 RANDY DELAURA.                           00060065
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070065
000800 DATE-WRITTEN            JUNE, 2009.                              00080065
000900 DATE-COMPILED.                                                   00090065
001000                                                                  00100065
001100***************************************************************** 00110065
001200*                                                               * 00120065
001300*  THIS PROGRAM WILL PRINT THE STORE EXPECTED ADJUSTMENTS FROM  * 00130065
001400*  WMOS CASE ERRORS REPORT.                                     * 00140065
001900***************************************************************** 00150065
W38216******************************************************************00160065
W38216*  CHANGE LOG                                                     00170065
W38216*  DATE       CHANGED BY    DESC                                  00180065
W38216*  ---------- ------------- --------------------------------------00190065
W38216*  07-06-2010 B. GRAHAM - KFORCE                                  00190165
W38216*                           WR 38216 EFC2 CHANGES                 00190265
W38216*                           SHOW ORIGINAL STORE NUMBER ON REPORT  00190365
W38216*                           ALL CHANGES TO THE PROGRAM CAN BE     00190465
W38216*                           FOUND BY DOING A FIND FOR 'W38216'    00190565
W38216*                           IN COLUMNS 1 THRU 6.                  00190665
W38216*                                                                 00190765
W38216*  12-15-2010 CHRISTINE TWIEHAUS                                  00190865
W38216*                           WR 38972 MLOF                         00190965
W38216*                           REMOVE ORIGINAL STORE NUMBER          00191065
001100******************************************************************00191165
001910/                                                                 00191265
002000***************************************************************** 00191365
002100 ENVIRONMENT DIVISION.                                            00192065
002200***************************************************************** 00193065
002300                                                                  00194065
002400 CONFIGURATION SECTION.                                           00195065
002600 SOURCE-COMPUTER.        IBM-3090.                                00196065
002700 OBJECT-COMPUTER.        IBM-3090.                                00197065
002800                                                                  00198065
002900 INPUT-OUTPUT SECTION.                                            00199065
003000                                                                  00200065
003100 FILE-CONTROL.                                                    00210065
003200                                                                  00220065
003300     SELECT INPUT01-FILE       ASSIGN TO INP01.                   00230065
003600     SELECT REPORT-FILE        ASSIGN TO RPT01.                   00240065
003800                                                                  00250065
003900***************************************************************** 00260065
004000 DATA DIVISION.                                                   00270065
004100***************************************************************** 00280065
004200                                                                  00290065
004300 FILE SECTION.                                                    00300065
004400                                                                  00310065
004500 FD  INPUT01-FILE                                                 00320065
004600     LABEL RECORDS ARE STANDARD                                   00330065
004700     RECORDING MODE IS F                                          00340065
004800     BLOCK CONTAINS 0 RECORDS                                     00350065
004900     RECORD CONTAINS 200 CHARACTERS.                              00360065
005000 01  INPUT01-RECORD                  PIC X(200).                  00370065
005100                                                                  00380065
005200 FD  REPORT-FILE                                                  00390065
005300     RECORDING MODE IS F                                          00400065
005400     BLOCK CONTAINS 0  RECORDS.                                   00410065
005500 01  REPORT-RECORD                   PIC  X(150).                 00420065
005600/                                                                 00430065
005800 WORKING-STORAGE SECTION.                                         00440065
005900                                                                  00450065
006000 01  PROGRAM-SWITCHES.                                            00460065
006100     05  PS-END-OF-INPUT-SW          PIC  X(01)    VALUE 'N'.     00470065
006200         88  PS-END-OF-INPUT                       VALUE 'Y'.     00480065
006400     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00490065
006500         88  PS-FIRST-TIME                         VALUE 'Y'.     00500065
007500                                                                  00510065
007600 01  PC-CONSTANTS.                                                00520065
008700     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00530065
008800                           'PCKRP030'.                            00540065
008900     05  PC-REPORT-NBR               PIC  X(02)    VALUE          00550065
009000                           '-1'.                                  00560065
009300                                                                  00570065
009400 01  PV-MISC-FIELDS.                                              00580065
009700     05  PV-LINE-CNT               PIC S9(05)    COMP-3 VALUE +0. 00590065
010500     05  PV-LINE-LIMIT             PIC S9(03)    COMP-3 VALUE +57.00600065
010600     05  PV-PAGE-CNT               PIC S9(05)    COMP-3 VALUE +0. 00610065
010610     05  PV-UNIT-RETAIL            PIC S9(07)V99 COMP-3 VALUE +0. 00620065
010620     05  PV-ADJ-RETAIL             PIC S9(07)V99 COMP-3 VALUE +0. 00630065
010700     05  PV-USER-NAME                PIC X(14)     VALUE SPACES.  00640065
012300     05  PV-TODAYS-DATE.                                          00650065
012400         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    00660065
012500         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    00670065
012600         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    00680065
012700     05  PV-TODAYS-TIME.                                          00690065
012800         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    00700065
012900         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    00710065
013000         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    00720065
013100         10  FILLER                  PIC  9(02)    VALUE ZERO.    00730065
013200     05  PV-FORMAT-DATE.                                          00740065
013300         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  00750065
013400         10  FILLER                  PIC  X(01)    VALUE '/'.     00760065
013500         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  00770065
013600         10  FILLER                  PIC  X(01)    VALUE '/'.     00780065
013700         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  00790065
014292     05  PV-DC-LOCATION              PIC 9(04)         VALUE 0.   00800065
014300/                                                                 00810065
014310****************************************************              00820065
014320* INPUT01 COPYBOOK                                 *              00830065
014330****************************************************              00840065
014500     COPY PCRD066.                                                00850065
014600/                                                                 00860065
015700****************************************************              00870065
015800* STANDARD 132 BYTE REPORT HEADER                  *              00880065
015900****************************************************              00890065
W38216     COPY DPWS150O.                                               00900065
016100/                                                                 00910065
016300 01  HDR-LINES.                                                   00920065
016400     05  HDR01-LINE.                                              00930065
W38216         10  FILLER                  PIC  X(49)    VALUE SPACES.  00940065
016700         10  FILLER                  PIC  X(53)    VALUE          00950065
017100       'STORE EXPECTED ADJUSTMENTS FROM WMOS CASE ERRORS FILE'.   00960065
W38216         10  FILLER                  PIC  X(48)    VALUE SPACES.  00970065
017500     05  HDR02-LINE.                                              00980065
017600         10  FILLER                  PIC  X(17)    VALUE          00990065
017610             'DC.............: '.                                 01000065
017700         10  HDR02-DC                PIC  ZZZZ9.                  01010065
017900         10  FILLER                  PIC  X(02)    VALUE SPACES.  01020065
017903         10  HDR02-DC-DESCRIPTION    PIC  X(40)    VALUE SPACES.  01030065
W38216         10  FILLER                  PIC  X(30)    VALUE SPACES.  01040065
017905         10  FILLER                  PIC  X(04)    VALUE          01050065
017906             'LAST'.                                              01060065
W38216         10  FILLER                  PIC  X(52)    VALUE SPACES.  01070065
017910     05  HDR03-LINE.                                              01080065
017920         10  FILLER                  PIC  X(83)    VALUE SPACES.  01090065
017930         10  FILLER                  PIC  X(04)    VALUE          01100065
017940             'CURR'.                                              01110065
017950         10  FILLER                  PIC  X(08)    VALUE SPACES.  01120065
017960         10  FILLER                  PIC  X(02)    VALUE          01130065
017961             'SE'.                                                01140065
W38216         10  FILLER                  PIC  X(53)    VALUE SPACES.  01150065
018000     05  HDR04-LINE.                                              01160065
W38216         10  FILLER                  PIC  X(04)    VALUE          01170065
      * CT 12/15/2010 38972 START                                       01171065
W38216             '    '.                                              01180065
W38216*            'ORIG'.                                              01180165
      * CT 12/15/2010 38972 END    R                                    01181065
W38216         10  FILLER                  PIC  X(03)    VALUE SPACES.  01190065
018100         10  FILLER                  PIC  X(03)    VALUE          01200065
018200             'PKG'.                                               01210065
018300         10  FILLER                  PIC  X(32)    VALUE SPACES.  01220065
019000         10  FILLER                  PIC  X(04)    VALUE          01230065
019100             'RCVR'.                                              01240065
019200         10  FILLER                  PIC  X(30)    VALUE SPACES.  01250065
019600         10  FILLER                  PIC  X(22)    VALUE          01260065
019700             ' CASE   SE    ADJ TRAN'.                            01270065
W38216         10  FILLER                  PIC  X(43)    VALUE SPACES.  01280065
W38216         10  FILLER                  PIC  X(09)    VALUE SPACES.  01290065
020960     05  HDR05-LINE.                                              01300065
W38216         10  FILLER                  PIC  X(05)    VALUE          01310065
      * CT 12/15/2010 38972 START                                       01311065
W38216             '     '.                                             01320065
W38216*            'STORE'.                                             01321065
      * CT 12/15/2010 38972 END                                         01322066
W38216         10  FILLER                  PIC  X(02)    VALUE SPACES.  01330065
020970         10  FILLER                  PIC  X(03)    VALUE          01340065
020980             'CDE'.                                               01350065
020990         10  FILLER                  PIC  X(02)    VALUE SPACES.  01360065
021000         10  FILLER                  PIC  X(12)    VALUE          01370065
021100             'PO/RECEIVER'.                                       01380065
021200         10  FILLER                  PIC  X(02)    VALUE SPACES.  01390065
021210         10  FILLER                  PIC  X(08)    VALUE          01400065
021211             ' SKU NBR'.                                          01410065
021212         10  FILLER                  PIC  X(02)    VALUE SPACES.  01420065
021213         10  FILLER                  PIC  X(17)    VALUE          01430065
021214             ' LINE STAT  STORE'.                                 01440065
021215         10  FILLER                  PIC  X(02)    VALUE SPACES.  01450065
021216         10  FILLER                  PIC  X(20)    VALUE          01460065
021217             'CASE NUMBER         '.                              01470065
021218         10  FILLER                  PIC  X(01)    VALUE SPACES.  01480065
021219         10  FILLER                  PIC  X(22)    VALUE          01490065
021220             '  QTY   QTY   QTY TYPE'.                            01500065
021221         10  FILLER                  PIC  X(01)    VALUE SPACES.  01510065
021222         10  FILLER                  PIC  X(14)    VALUE          01520065
021223             'USER NAME     '.                                    01530065
021224         10  FILLER                  PIC  X(01)    VALUE SPACES.  01540065
021225         10  FILLER                  PIC  X(12)    VALUE          01550065
021226             ' UNIT RETAIL'.                                      01560065
021228         10  FILLER                  PIC  X(01)    VALUE SPACES.  01570065
021229         10  FILLER                  PIC  X(12)    VALUE          01580065
021230             '  ADJ RETAIL'.                                      01590065
W38216         10  FILLER                  PIC  X(02)    VALUE SPACES.  01600065
W38216         10  FILLER                  PIC  X(09)    VALUE SPACES.  01610065
021300     05  HDR06-LINE.                                              01620065
W38216         10  FILLER                  PIC  X(05)    VALUE          01630065
      * CT 12/15/2010 38972 START                                       01631065
W38216             '     '.                                             01640065
W38216*            '-----'.                                             01641065
      * CT 12/15/2010 38972 END                                         01642065
W38216         10  FILLER                  PIC  X(02)    VALUE SPACES.  01650065
021400         10  FILLER                  PIC  X(03)    VALUE          01660065
021500             '---'.                                               01670065
021510         10  FILLER                  PIC  X(02)    VALUE SPACES.  01680065
021520         10  FILLER                  PIC  X(12)    VALUE          01690065
021530             '-----------'.                                       01700065
021540         10  FILLER                  PIC  X(02)    VALUE SPACES.  01710065
021600         10  FILLER                  PIC  X(08)    VALUE          01720065
021700             '--------'.                                          01730065
021710         10  FILLER                  PIC  X(02)    VALUE SPACES.  01740065
021720         10  FILLER                  PIC  X(17)    VALUE          01750065
021730             '----- ----  -----'.                                 01760065
021740         10  FILLER                  PIC  X(02)    VALUE SPACES.  01770065
021750         10  FILLER                  PIC  X(20)    VALUE          01780065
021760             '--------------------'.                              01790065
021770         10  FILLER                  PIC  X(01)    VALUE SPACES.  01800065
021780         10  FILLER                  PIC  X(22)    VALUE          01810065
021790             '----- ----- ----- ----'.                            01820065
021800         10  FILLER                  PIC  X(01)    VALUE SPACES.  01830065
021900         10  FILLER                  PIC  X(14)    VALUE          01840065
022000             '--------------'.                                    01850065
022100         10  FILLER                  PIC  X(01)    VALUE SPACES.  01860065
022200         10  FILLER                  PIC  X(12)    VALUE          01870065
022300             '------------'.                                      01880065
022320         10  FILLER                  PIC  X(01)    VALUE SPACES.  01890065
022330         10  FILLER                  PIC  X(12)    VALUE          01900065
022340             '------------'.                                      01910065
W38216         10  FILLER                  PIC  X(11)    VALUE SPACES.  01920065
W38216     05  BLANK-LINE                  PIC X(150)    VALUE SPACES.  01930065
022410     05  END-OF-REPORT-LINE.                                      01940065
022500         10  FILLER                  PIC  X(44)    VALUE SPACES.  01950065
022600         10  FILLER                  PIC  X(45)    VALUE          01960065
022700             '*******   E N D   O F   R E P O R T   *******'.     01970065
W38216         10  FILLER                  PIC  X(61)    VALUE SPACES.  01980065
022900     05  NO-DATA-TO-REPORT-LINE.                                  01990065
023000         10  FILLER                  PIC  X(40)    VALUE SPACES.  02000065
023100         10  FILLER                  PIC  X(52)    VALUE          02010065
023200         '*******  N O   D A T A   T O   R E P O R T   *******'.  02020065
W38216         10  FILLER                  PIC  X(58)    VALUE SPACES.  02030065
023400/                                                                 02040065
023500 01  DETAIL-LINES.                                                02050065
023600     05  DTL01-LINE.                                              02060065
W38216         10  FILLER                  PIC  X(05)    VALUE SPACES.  02070065
      * CT 12/15/2010 38972 START                                       02071065
W38216*        10  FILLER                  PIC  X(04)    VALUE SPACES.  02080068
W38216*        10  DTL01-ORIG-STORE        PIC  ZZZZ.                   02080165
      * CT 12/15/2010 38972 END                                         02081065
W38216         10  FILLER                  PIC  X(03)    VALUE SPACES.  02090065
023611         10  DTL01-PKGNG-CDE         PIC  X(01)    VALUE SPACES.  02100065
W38216         10  FILLER                  PIC  X(02)    VALUE SPACES.  02110065
023700         10  DTL01-PO-NUMBER         PIC  ZZZZZZ99.               02120065
023710         10  FILLER                  PIC  X(01)    VALUE '-'.     02130065
023720         10  DTL01-REC-SEQ-NUMBER    PIC  999.                    02140065
023900         10  FILLER                  PIC  X(03)    VALUE SPACES.  02150065
024000         10  DTL01-SKU-NUMBER        PIC  9(08)    VALUE ZEROS.   02160065
024100         10  FILLER                  PIC  X(03)    VALUE SPACES.  02170065
024200         10  DTL01-PO-LINE-NUMBER    PIC  ZZZ9.                   02180065
024300         10  FILLER                  PIC  X(02)    VALUE SPACES.  02190065
024400         10  DTL01-STATUS-CDE        PIC  X(02)    VALUE SPACES.  02200065
024500         10  FILLER                  PIC  X(04)    VALUE SPACES.  02210065
024600         10  DTL01-STORE-NUMBER      PIC  9999.                   02220065
024700         10  FILLER                  PIC  X(02)    VALUE SPACES.  02230065
024800         10  DTL01-CASE-NUMBER       PIC  X(20)    VALUE SPACES.  02240065
024900         10  FILLER                  PIC  X(01)    VALUE SPACES.  02250065
025000         10  DTL01-CASE-SKU-QTY      PIC  ZZZZ9.                  02260065
025100         10  FILLER                  PIC  X(01)    VALUE SPACES.  02270065
025110         10  DTL01-CURR-SE-QTY       PIC  ZZZZ9.                  02280065
025120         10  FILLER                  PIC  X(01)    VALUE SPACES.  02290065
025130         10  DTL01-ADJUST-QTY        PIC  ZZZZ9.                  02300065
025300         10  FILLER                  PIC  X(02)    VALUE SPACES.  02310065
025310         10  DTL01-TRANS-TYPE-CDE    PIC  X(02)    VALUE SPACES.  02320065
025311         10  FILLER                  PIC  X(02)    VALUE SPACES.  02330065
025312         10  DTL01-USER-NAME         PIC  X(14)    VALUE SPACES.  02340065
025320         10  FILLER                  PIC  X(01)    VALUE SPACES.  02350065
025400         10  DTL01-UNIT-RETAIL       PIC  Z,ZZZ,ZZ9.99.           02360065
025500         10  FILLER                  PIC  X(01)    VALUE SPACES.  02370065
025510         10  DTL01-ADJ-RETAIL        PIC  Z,ZZZ,ZZ9.99.           02380065
W38216         10  FILLER                  PIC  X(11)    VALUE SPACES.  02390065
026000/                                                                 02400065
026002 01  TOTAL-LINES.                                                 02410065
026003     05  TTL01-LINE.                                              02420065
026004         10  FILLER                  PIC  X(95)    VALUE SPACES.  02430065
026005         10  FILLER                  PIC  X(07)    VALUE          02440065
026006             'TOTALS:'.                                           02450065
026007         10  FILLER                  PIC  X(05)    VALUE SPACES.  02460065
026031         10  TTL01-UNIT-RETAIL       PIC  Z,ZZZ,ZZ9.99.           02470065
026032         10  FILLER                  PIC  X(01)    VALUE SPACES.  02480065
026033         10  TTL01-ADJ-RETAIL        PIC  Z,ZZZ,ZZ9.99.           02490065
W38216         10  FILLER                  PIC  X(18)    VALUE SPACES.  02500065
026034/                                                                 02510065
026035******************************************************            02520065
026036*  XLWS067  - USER ID/NAME MODULE                    *            02530065
026037******************************************************            02540065
026038     COPY XLWS067.                                                02550065
026040/                                                                 02560065
026100******************************************************            02570065
026110*  XLT00010 - DC LOCATION TABLE                      *            02580065
026120******************************************************            02590065
026130     EXEC SQL                                                     02600065
026140          INCLUDE XLT00010                                        02610065
026150     END-EXEC.                                                    02611065
026200/                                                                 02612065
026300******************************************************            02613065
026400*  DB2 AREA FOR COMMUNICATIONS                       *            02614065
026500******************************************************            02615065
026600     EXEC SQL                                                     02616065
026700          INCLUDE SQLCA                                           02617065
026800     END-EXEC.                                                    02618065
026810                                                                  02619065
026820     COPY SQLCA2.                                                 02620065
026900/                                                                 02630065
029200 PROCEDURE DIVISION.                                              02640065
029300                                                                  02650065
029310******************************************************            02660065
029320* 0000-MAINLINE.                                     *            02670065
029330******************************************************            02680065
029400 0000-MAINLINE.                                                   02690065
029500                                                                  02700065
029600     PERFORM 0010-INITIALIZATION.                                 02710065
029700                                                                  02720065
030500     PERFORM 1000-PROCESS-INPUT                                   02730065
030510        THRU 1000-PROCESS-INPUT-EXIT                              02740065
030600         UNTIL ( PS-END-OF-INPUT ).                               02750065
030700                                                                  02760065
030800     PERFORM 0020-END-PROGRAM.                                    02770065
032200     GOBACK.                                                      02780065
032300/                                                                 02790065
032310******************************************************            02800065
032410* 0010-INITIALIZATION.                               *            02810065
032411******************************************************            02820065
032500 0010-INITIALIZATION.                                             02830065
032900                                                                  02840065
032910     OPEN INPUT  INPUT01-FILE                                     02850065
032920          OUTPUT REPORT-FILE.                                     02860065
032930                                                                  02870065
033000     ACCEPT PV-TODAYS-DATE   FROM DATE.                           02880065
033300     ACCEPT PV-TODAYS-TIME   FROM TIME.                           02890065
033500                                                                  02900065
W38216     MOVE PV-TODAYS-DATE-MM      TO DP150O-RUN-MONTH.             02910065
W38216     MOVE PV-TODAYS-DATE-DD      TO DP150O-RUN-DAY.               02920065
W38216     MOVE PV-TODAYS-DATE-YY      TO DP150O-RUN-YEAR.              02930065
W38216     MOVE PV-TODAYS-TIME-HH      TO DP150O-RUN-HOUR.              02940065
W38216     MOVE PV-TODAYS-TIME-MM      TO DP150O-RUN-MINUTE.            02950065
W38216     MOVE PC-PROGRAM-NAME        TO DP150O-PROGRAM-NAME.          02960065
W38216     MOVE PC-REPORT-NBR          TO DP150O-REPORT-NUMBER.         02970065
034400                                                                  02980065
034500     PERFORM 9050-REPORT-HEADERS.                                 02990065
036200/                                                                 03000065
036310******************************************************            03010065
036320* 0020-END-PROGRAM.                                  *            03020065
036330******************************************************            03030065
036340 0020-END-PROGRAM.                                                03040065
036350                                                                  03050065
036351     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03060065
036352         PERFORM 9050-REPORT-HEADERS                              03070065
036353     END-IF.                                                      03080065
036354                                                                  03090065
036355     IF ( PS-FIRST-TIME )                                         03100065
036356         WRITE REPORT-RECORD FROM NO-DATA-TO-REPORT-LINE          03110065
036357              AFTER ADVANCING 2 LINES                             03120065
036358     ELSE                                                         03130065
036359         MOVE PV-UNIT-RETAIL TO TTL01-UNIT-RETAIL                 03140065
036360         MOVE PV-ADJ-RETAIL  TO TTL01-ADJ-RETAIL                  03150065
036361         WRITE REPORT-RECORD FROM TTL01-LINE                      03160065
036362              AFTER ADVANCING 2 LINES                             03170065
036363     END-IF.                                                      03180065
036364                                                                  03190065
036370     WRITE REPORT-RECORD FROM END-OF-REPORT-LINE                  03200065
036380          AFTER ADVANCING 3 LINES.                                03210065
036390                                                                  03220065
036391     CLOSE INPUT01-FILE                                           03230065
036392           REPORT-FILE.                                           03240065
036393/                                                                 03250065
036394******************************************************            03260065
036395* 1000-PROCESS-INPUT.                                *            03270065
036396******************************************************            03280065
036397 1000-PROCESS-INPUT.                                              03290065
036398                                                                  03300065
036399     READ INPUT01-FILE INTO PC066-SE-ADJ-TRAN-RECORD              03310065
036400         AT END MOVE 'Y' TO PS-END-OF-INPUT-SW                    03320065
036401                GO TO 1000-PROCESS-INPUT-EXIT.                    03330065
036402                                                                  03340065
036403     IF ( PS-FIRST-TIME )                                         03350065
036404         MOVE 'N' TO PS-FIRST-TIME-SW                             03360065
036405         MOVE PC066-DC-LOCATION TO PV-DC-LOCATION                 03370065
036406                                   HDR02-DC                       03380065
036407         PERFORM 2000-VALIDATE-DC                                 03390065
036408         PERFORM 9040-PAGE-HEADERS                                03400065
036409     END-IF.                                                      03410065
036410                                                                  03420065
036411     IF ( PC066-DC-LOCATION NOT = PV-DC-LOCATION )                03430065
036413         MOVE PC066-DC-LOCATION TO PV-DC-LOCATION                 03440065
036414                                   HDR02-DC                       03450065
036415         PERFORM 2000-VALIDATE-DC                                 03460065
036416         PERFORM 9050-REPORT-HEADERS                              03470065
036417         PERFORM 9040-PAGE-HEADERS                                03480065
036418     END-IF.                                                      03490065
036419                                                                  03500065
036420     PERFORM 9000-REPORT-DETAIL.                                  03510065
036421                                                                  03520065
036422 1000-PROCESS-INPUT-EXIT.                                         03530065
036423     EXIT.                                                        03540065
036424/                                                                 03550065
036425******************************************************            03560065
036426* 2000-VALIDATE-DC.                                  *            03570065
036427******************************************************            03580065
036428 2000-VALIDATE-DC.                                                03590065
036429                                                                  03600065
036430     MOVE PV-DC-LOCATION TO XLT00010-LOC-NBR.                     03610065
036440                                                                  03620065
036441     EXEC SQL                                                     03630065
036442         SELECT A.LOC_NM                                          03640065
036443           INTO :XLT00010-LOC-NM                                  03641065
036444           FROM XLT_LOC A                                         03642065
036445          WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 03643065
036447     END-EXEC.                                                    03644065
036448                                                                  03644165
036449     EVALUATE TRUE                                                03644265
036450       WHEN SQLCODE = ZERO                                        03644365
036451           MOVE XLT00010-LOC-NM TO HDR02-DC-DESCRIPTION           03644465
036452       WHEN OTHER                                                 03644565
036453           MOVE SPACES          TO HDR02-DC-DESCRIPTION           03644665
036467     END-EVALUATE.                                                03644765
036473/                                                                 03644865
036474******************************************************            03644965
036475* 9000-REPORT-DETAIL.                                *            03645065
036476******************************************************            03646065
036477 9000-REPORT-DETAIL.                                              03647065
036478                                                                  03647165
036479     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03647265
036480         PERFORM 9050-REPORT-HEADERS                              03647365
036481         PERFORM 9040-PAGE-HEADERS                                03647465
036482     END-IF.                                                      03647565
036483                                                                  03647665
036484     PERFORM 9005-USER-NAME.                                      03647765
036485                                                                  03647865
036486     MOVE PC066-PKGNG-CDE      TO DTL01-PKGNG-CDE.                03647965
036487     MOVE PC066-PO-NUMBER      TO DTL01-PO-NUMBER.                03648065
036488     MOVE PC066-REC-SEQ-NUMBER TO DTL01-REC-SEQ-NUMBER.           03648165
036489     MOVE PC066-SKU-NUMBER     TO DTL01-SKU-NUMBER.               03648265
036490     MOVE PC066-PO-LINE-NUMBER TO DTL01-PO-LINE-NUMBER.           03648365
036491     MOVE PC066-STATUS-CDE     TO DTL01-STATUS-CDE.               03648465
036502     MOVE PC066-STORE-NUMBER   TO DTL01-STORE-NUMBER.             03648565
036503     MOVE PC066-CASE-NUMBER    TO DTL01-CASE-NUMBER.              03648665
036504     MOVE PC066-CASE-SKU-QTY   TO DTL01-CASE-SKU-QTY.             03648765
036505     MOVE PC066-CURR-SE-QTY    TO DTL01-CURR-SE-QTY.              03648865
036506                                                                  03648965
036507     IF ( PC066-APPLY-ADJUST )                                    03649065
036508         MOVE PC066-CASE-SKU-QTY   TO DTL01-ADJUST-QTY            03650065
036509     ELSE                                                         03650165
036510         MOVE ZEROS                TO DTL01-ADJUST-QTY            03650265
036511     END-IF.                                                      03650365
036512                                                                  03650465
036513     EVALUATE TRUE                                                03650565
036514       WHEN PC066-TRAN-TYPE-CDE = 'AR'                            03650665
036515            MOVE 'VR'          TO DTL01-TRANS-TYPE-CDE            03650765
036516       WHEN PC066-TRAN-TYPE-CDE = 'UN'                            03650865
036517            MOVE 'PX'          TO DTL01-TRANS-TYPE-CDE            03650965
036518       WHEN OTHER                                                 03651065
036519            MOVE PC066-TRAN-TYPE-CDE TO DTL01-TRANS-TYPE-CDE      03651165
036520     END-EVALUATE                                                 03651265
036521                                                                  03651365
036522     MOVE PV-USER-NAME         TO DTL01-USER-NAME.                03651465
036523     MOVE PC066-UNIT-RETAIL    TO DTL01-UNIT-RETAIL.              03651565
036524     MOVE PC066-ADJ-RETAIL     TO DTL01-ADJ-RETAIL.               03651665
      * CT 12/15/2010 38972 START                                       03651765
W38216*    MOVE PC066-ORIG-STORE-NUMBER                                 03651865
W38216*                              TO DTL01-ORIG-STORE.               03651965
      * CT 12/15/2010 38972 END                                         03652065
036525                                                                  03652165
036526     WRITE REPORT-RECORD FROM DTL01-LINE                          03652265
036527            AFTER ADVANCING 1 LINE.                               03652365
036528                                                                  03652465
036529     ADD  +1 TO PV-LINE-CNT.                                      03652565
036530                                                                  03652665
036531     COMPUTE PV-UNIT-RETAIL = PV-UNIT-RETAIL + PC066-UNIT-RETAIL. 03652765
036532     COMPUTE PV-ADJ-RETAIL  = PV-ADJ-RETAIL  + PC066-ADJ-RETAIL.  03652865
036533/                                                                 03652965
036534******************************************************            03653065
036535* 9005-USER-NAME.                                    *            03653165
036536******************************************************            03653265
036537 9005-USER-NAME.                                                  03653365
036540                                                                  03653465
036948     INITIALIZE XL067-USER-COMMAREA.                              03653565
036950     MOVE PC066-CRE-USER-ID      TO XL067-KEY-USER-ID.            03653665
036951     SET XL067-BY-USER-ID        TO TRUE.                         03653765
036952     SET XL067-SELECT-KOHLS-USER TO TRUE.                         03653865
036953     MOVE 'PCKRP030'             TO XL067-ORIG-CALLING-PGM-NM.    03653965
036954                                                                  03654065
036955     CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               03654165
036956                                                                  03654265
036957     EVALUATE TRUE                                                03655065
036958         WHEN XL067-SUCCESSFUL                                    03656065
036959             IF ( XL067-USER-NOT-FOUND )                          03657065
036960                 MOVE PC066-CRE-USER-ID     TO PV-USER-NAME       03658065
036961             ELSE                                                 03659065
036962                 MOVE XL067-COMBINED-NAME-3 TO PV-USER-NAME       03660065
036963             END-IF                                               03670065
036966         WHEN OTHER                                               03680065
036967             MOVE PC066-CRE-USER-ID         TO PV-USER-NAME       03690065
036976     END-EVALUATE.                                                03700065
037033/                                                                 03701065
037034******************************************************            03702065
037035* 9040-PAGE-HEADERS.                                 *            03703065
037036******************************************************            03703165
037037 9040-PAGE-HEADERS.                                               03703265
037038                                                                  03703365
037039     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03703465
037040         PERFORM 9050-REPORT-HEADERS                              03703565
037041     END-IF.                                                      03703665
037042                                                                  03703765
037043     WRITE REPORT-RECORD FROM HDR02-LINE                          03703865
037044            AFTER ADVANCING 2 LINES.                              03703965
037045     WRITE REPORT-RECORD FROM HDR03-LINE                          03704065
037046            AFTER ADVANCING 1 LINE.                               03704165
037047     WRITE REPORT-RECORD FROM HDR04-LINE                          03704265
037048            AFTER ADVANCING 1 LINE.                               03704365
037049     WRITE REPORT-RECORD FROM HDR05-LINE                          03704465
037050            AFTER ADVANCING 1 LINES.                              03704565
037051     WRITE REPORT-RECORD FROM HDR06-LINE                          03704665
037052            AFTER ADVANCING 1 LINES.                              03704765
037053     WRITE REPORT-RECORD FROM BLANK-LINE                          03704865
037054            AFTER ADVANCING 1 LINE.                               03704965
037055                                                                  03705065
037056     ADD  +7 TO PV-LINE-CNT.                                      03705165
037057/                                                                 03705265
037058******************************************************            03705365
037059* 9050-REPORT-HEADERS.                               *            03705465
037060******************************************************            03705565
037061 9050-REPORT-HEADERS.                                             03705665
037062                                                                  03705765
037063     ADD +1           TO PV-PAGE-CNT.                             03705865
037064     MOVE PV-PAGE-CNT TO DP150O-PAGE-NUMBER.                      03705965
037065                                                                  03706065
W38216     WRITE REPORT-RECORD FROM DP150O-STANDRD-HEADER-150-COLS      03706165
037067            AFTER ADVANCING PAGE.                                 03706265
037068     WRITE REPORT-RECORD FROM HDR01-LINE                          03706365
037069            AFTER ADVANCING 1 LINE.                               03706465
037070     WRITE REPORT-RECORD FROM BLANK-LINE                          03706565
037071            AFTER ADVANCING 1 LINE.                               03706665
037072                                                                  03706765
037080     MOVE +3 TO PV-LINE-CNT.                                      03706865
037100/                                                                 03706965
