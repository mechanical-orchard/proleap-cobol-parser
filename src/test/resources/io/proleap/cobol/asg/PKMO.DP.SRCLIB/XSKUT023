000100*----------------------------------------------------------       00000304
000200 IDENTIFICATION DIVISION.                                         00000404
000300*----------------------------------------------------------       00000504
000400 PROGRAM-ID.    XSKUT023.                                         00000604
000500 AUTHOR.        JOSEPH MENYAH.                                    00000704
000600 DATE-WRITTEN.  OCTOBER , 2002.                                   00000804
000700                                                                  00000904
000800*----------------------------------------------------------       00001004
000900*            BUSINESS AD EVENT EXTRACT                            00002004
001000*----------------------------------------------------------       00003004
001010* THIS PROGRAM WILL PERFORM THE NECESSARY BUSINESS EVENT          00004004
001020* EXTRACT FOR THE ADEVENT BUSINESS EVENT.                         00005004
001124*                                                                 00370004
001125*----------------------------------------------------------       00380004
001126* HISTORY LOG:                                                    00390004
001127*                                                                 00400004
001128*----------------------------------------------------------       00410004
001129* DATE:                                                           00420004
001130* WR/IR#:                                                         00430004
001131* PROGRAMMER:                                                     00440004
001140* DESCRIPTION:                                                    00450004
001150*                                                                 00460004
001160*----------------------------------------------------------       00470004
001170 ENVIRONMENT DIVISION.                                            00480004
001180*----------------------------------------------------------       00490004
001190 CONFIGURATION SECTION.                                           00500004
001200 SOURCE-COMPUTER. IBM-3090.                                       00510004
001300 OBJECT-COMPUTER. IBM-3090.                                       00520004
001400                                                                  00530004
001500 INPUT-OUTPUT SECTION.                                            00540004
001600                                                                  00550004
001700 FILE-CONTROL.                                                    00560004
001800                                                                  00570004
004900     SELECT DATE-RANGE-FILE                                       00571021
005000         ASSIGN TO INP01.                                         00572011
                                                                        00572111
           SELECT TMST-FILE                                             00572221
               ASSIGN  TO INP02.                                        00572321
                                                                        00572421
004900     SELECT EXTRACT-FILE                                          00573011
005000         ASSIGN TO OUT01.                                         00574011
001900*----------------------------------------------------------       00580004
002000 DATA DIVISION.                                                   00590004
002100*----------------------------------------------------------       00600004
002200 FILE SECTION.                                                    00610004
002300                                                                  00620004
008000 FD  EXTRACT-FILE                                                 00621005
008100     RECORDING MODE IS F                                          00622005
008200     LABEL RECORDS ARE OMITTED                                    00623005
008300     RECORD CONTAINS 174 CHARACTERS                               00624005
008400     DATA RECORD IS AD-EVNT-RECORD.                               00625005
008500 01  AD-EVNT-RECORD              PIC X(174).                      00626005
008600                                                                  00627005
005800 FD  DATE-RANGE-FILE                                              00628021
005900     RECORDING MODE IS F                                          00629010
006000     LABEL RECORDS ARE STANDARD                                   00629110
006100     RECORD CONTAINS 80 CHARACTERS                                00629210
006200     BLOCK CONTAINS 0 RECORDS                                     00629310
006300     DATA RECORD IS DATE-RECORD.                                  00629410
006400 01  DATE-RECORD                 PIC X(80).                       00629510
006500                                                                  00629610
       FD  TMST-FILE                                                    00629721
           RECORDING MODE F                                             00629821
           BLOCK CONTAINS 0 RECORDS                                     00629921
           LABEL RECORDS ARE OMITTED.                                   00630021
       01  TMST-LINE                        PIC  X(80).                 00631021
002500*---------------------------------------------------------        00640004
002600                                                                  00650004
002700 WORKING-STORAGE SECTION.                                         00660004
002800*---------------------------------------------------------        00670004
003500* PC- PROGRAM CONSTANTS                                           00680004
003600*----------------------------------------------------------       00690004
003700 01  PC-PROGRAM-CONSTANTS.                                        00700004
003800     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XSKUT023'. 00710004
003900     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00720004
004000                                                                  00730004
004100*----------------------------------------------------------       00740004
004200* PS- PROGRAM SWITCHES                                            00750004
004300*----------------------------------------------------------       00760004
004400 01  PS-PROGRAM-SWITCHES.                                         00770004
004500     05  PS-EOF-EXTRACT-SW           PIC X(01)  VALUE SPACE.      00780007
004600         88  PS-EOF-EXTRACT                      VALUE 'Y'.       00790007
004600         88  PS-NOT-EOF-EXTRACT                  VALUE 'N'.       00800015
           05  PS-DATE-RANGE-FILE-SW        PIC  X(01)  VALUE 'N'.      00802021
               88  PS-DATE-RANGE-FILE-END               VALUE 'Y'.      00803021
               88  PS-DATE-RANGE-FILE-START             VALUE 'N'.      00804021
           05  PS-TMST-FILE-SW              PIC  X(01)  VALUE 'N'.      00805021
               88  PS-TMST-FILE-END                     VALUE 'Y'.      00806021
               88  PS-TMST-FILE-START                   VALUE 'N'.      00807021
004800                                                                  00810004
004900*----------------------------------------------------------       00820004
005000* PV- PROGRAM VARIABLES                                           00830004
005100*----------------------------------------------------------       00840004
       01  CC-DATE-RANGE-FILE.                                          00841021
           05  CC-START-DATE                PIC X(10).                  00842021
           05  FILLER                       PIC X(01).                  00843021
           05  CC-END-DATE                  PIC X(10).                  00844021
                                                                        00845021
       01  CC-TMST-FILE.                                                00846021
           05  CC-LAST-UPD-TMST             PIC X(19).                  00847021
                                                                        00848021
005200 01 PV-PROGRAM-VARIABLES.                                         00850004
013800    05  ABEND-CODE              PIC S9(4)  VALUE ZEROS COMP SYNC. 00851007
005500    05  PV-SQL-SUB                    PIC S9(4)  VALUE +0 COMP.   00860004
005600    05  PV-MAX-OFFSET-DTE             PIC 9(08)  VALUE 0.         00870004
005710    05  PV-AD-EVNT-ID                 PIC S9(09) VALUE +0.        00890004
005800    05  PV-ACTION-CODE                PIC X(01).                  00900004
005810        88  PV-INSERT-DATA                       VALUE 'I'.       00910004
005820        88  PV-UPDATE-DATA                       VALUE 'U'.       00920004
                                                                        00921014
006000    05  PV-RECORD-COUNT               PIC 9(05) VALUE ZEROS.      00930015
006000    05  PV-LD-STATUS-CDE              PIC X(02).                  00931015
006100        88  PV-NO-ERROR                          VALUE '00'.      00940004
006200        88  PV-CRITICAL-ERROR                    VALUE '01'.      00950004
006300        88  PV-NOT-CRITICAL-ERROR                VALUE '02'.      00960004
007000                                                                  01040004
007100    05  PV-STRT-PARM.                                             01050010
007200        10  PV-STRT-DTE-CC            PIC X(02).                  01050111
007200        10  PV-STRT-DTE-YY            PIC X(02).                  01050211
007400        10  PV-STRT-DTE-MM            PIC X(02).                  01050311
007600        10  PV-STRT-DTE-DD            PIC X(02).                  01050411
007400        10  FILLER                    PIC X.                      01050511
007400        10  PV-DECREMENT              PIC X(03).                  01050620
007400        10  FILLER                    PIC X(68).                  01050720
007700                                                                  01050811
007100    05  PV-AD-EVNT-STRT-DTE           PIC X(10).                  01051012
                                                                        01052012
           05  PV-OPERATION-MSG             PIC  X(60)  VALUE SPACES.   01053021
           05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACES.   01054021
008500                                                                  01180004
008600    05  PV-AD-EVNT-END-DTE-TM.                                    01190004
008700        10  PV-AD-EVNT-END-DTE.                                   01200004
008800            15  PV-AD-EVNT-DTE-TM2-CCYY   PIC X(04).              01210004
008900            15  FILLER                    PIC X(01).              01220004
009000            15  PV-AD-EVNT-DTE-TM2-MM     PIC X(02).              01230004
009100            15  FILLER                    PIC X(01).              01240004
009200            15  PV-AD-EVNT-DTE-TM2-DD     PIC X(02).              01250004
009300        10  PV-AD-EVNT-END-TM             PIC X(16).              01260004
009400                                                                  01270004
009400                                                                  01271026
       01  PV-TOTAL-RECORD.                                             01271124
           05 PV-BUSINESS-EVNT-ID              PIC 9(03) VALUE ZERO.    01272024
           05 PV-ACTION-CDE                    PIC X(01) VALUE 'T'.     01273024
           05 PV-TOTAL-NBR-OF-RECS             PIC 9(11) VALUE ZERO.    01274024
010900*----------------------------------------------------------       01280004
011000* AD EVENT BUSINESS EVENT RECORD LAYOUT                           01290004
011100*----------------------------------------------------------       01300004
011200     COPY XSRD015.                                                01310032
011300                                                                  01320004
011400*----------------------------------------------------------       01330004
011500* DATE ROUTINE COPY MEMBERS                                       01340004
011600*----------------------------------------------------------       01350004
011700     COPY DPWS500.                                                01360004
011800                                                                  01370004
011900*----------------------------------------------------------       01380004
012000* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         01390004
012100*----------------------------------------------------------       01400004
012200     COPY DPWS004.                                                01410004
012300                                                                  01420004
030160*---------------------------------------------                    01430004
030170*  DB2 COMMUNICATION AREA.                                        01440004
030180*---------------------------------------------                    01450004
030190     EXEC SQL                                                     01460004
030191          INCLUDE SQLCA                                           01470004
030192     END-EXEC.                                                    01480004
030193                                                                  01490004
023000     COPY SQLCA2.                                                 01491007
030194*---------------------------------------------                    01500004
030195*  DB2 TABLE XST00027(XST_AD_EVNT) - AD EVENT TABLE               01510004
030196*---------------------------------------------                    01520004
030197     EXEC SQL                                                     01530004
030198          INCLUDE XST00027                                        01540004
030199     END-EXEC.                                                    01550004
030200                                                                  01560004
030194*---------------------------------------------                    01560104
023300*   EXTRACT CURSOR  DB2 SELECT                                    01561004
030194*---------------------------------------------                    01561104
023400     EXEC SQL                                                     01562004
023500       DECLARE EXTRACT CURSOR FOR                                 01563004
039800        SELECT AD_EVNT_ID,                                        01563104
039810               AD_EVNT_NM,                                        01563204
039820               AD_EVNT_NBR_TXT,                                   01563304
039821               STAT_CDE,                                          01563404
039830               STRT_DTE,                                          01563504
039840               END_DTE,                                           01563604
039860               SOR_LAST_UPD_TMST                                  01563830
024100        FROM XST_AD_EVNT                                          01569008
024200*       WHERE STRT_DTE >  :PV-AD-EVNT-STRT-DTE                    01569221
              WHERE END_DTE >=                                          01569321
                           :CC-START-DATE                               01569421
              AND STRT_DTE <=                                           01569521
                           :CC-END-DATE                                 01569621
              AND SOR_LAST_UPD_TMST <=                                  01569730
                           :CC-LAST-UPD-TMST                            01569821
  4300*       ORDER BY STR_NBR, DEPT_NBR, KY_DTE                        01569909
014610        WITH UR                                                   01570021
024400     END-EXEC.                                                    01571004
030310                                                                  01580004
031400*----------------------------------------------------------       01700004
031500 PROCEDURE DIVISION.                                              01710004
032100*----------------------------------------------------------       01720004
032200 0000-MAINLINE.                                                   01730004
032300                                                                  01740004
032400     PERFORM 1000-INITIALIZATION.                                 01750004
032500                                                                  01760004
032600     PERFORM 2000-EXTRACT-DATA                                    01770004
032700             UNTIL PS-EOF-EXTRACT.                                01780007
035000                                                                  01790004
035100     PERFORM 9990-WRITE-RECORD-CNT.                               01800015
                                                                        01800115
035100     PERFORM 9999-WRAPUP.                                         01801015
035200                                                                  01810004
035500     GOBACK.                                                      01820004
035700                                                                  01830004
035701*0000-EXIT.                                                       01840004
035702 EJECT.                                                           01850004
035703                                                                  01860004
035800*----------------------------------------------------------       01870004
035900* 1000-INITIALIZATION.                                            01880004
036000*     INTIALIZES OR MOVES ANY VARIABLES BEFORE IT WILL            01890004
036100*     UPDATE OR INSERT A RECORD.                                  01900004
036200*----------------------------------------------------------       01910004
036300 1000-INITIALIZATION.                                             01920004
           SET PS-NOT-EOF-EXTRACT TO TRUE.                              01920115
                                                                        01920215
026600     OPEN INPUT DATE-RANGE-FILE                                   01921021
                      TMST-FILE                                         01921121
026600          OUTPUT EXTRACT-FILE.                                    01922012
                                                                        01922114
051100     PERFORM 2010-COMPUTE-STRT-DTE                                01923014
051200        THRU 2010-EXIT.                                           01924014
038000                                                                  01925014
027900     EXEC SQL                                                     01926014
028000         OPEN EXTRACT                                             01927014
028100     END-EXEC.                                                    01928014
                                                                        01929014
055500     IF SQLCODE < 0                                               01929114
055600         DISPLAY 'OPEN  UNSUCCESSFUL FOR TABLE XST_AD_EVNT'       01929214
055700         PERFORM U9980-SQL-ERROR                                  01929314
055800            THRU U9980-EXIT.                                      01929414
055900                                                                  01929514
056000     IF (SQLCODE > 0 AND SQLCODE NOT EQUAL +100) OR               01929614
056100           SQLWARN0 = 'W'                                         01929714
056200         DISPLAY 'FETCH WARNING FOR TABLE XST_AD_EVNT'            01929814
056300         PERFORM U9990-SQL-WARNING                                01929914
056400            THRU U9990-EXIT.                                      01930014
056500                                                                  01930114
036400                                                                  01931004
                                                                        01935005
036410     INITIALIZE DCLXST00027.                                      01940004
036515                                                                  02100004
037240*1100-EXIT.                                                       02310004
037250 EJECT.                                                           02320004
037251                                                                  02330004
037260*----------------------------------------------------------       02340004
037300* 2000-EXTRACT-DATA.                                              02350007
037400*     THIS CHECKS THE ACTION TO SEE WHETHER THE RECORD            02360004
037500*     SHOULD BE INSERTED INTO THE AD EVENT TABLE OR UPDATED.      02370004
037600*     IF SOMETHING IS WRONG WITH THE ACTION CODE IT WILL          02380004
037700*     PROCESS AN ERROR AND EXIT THE PROGRAM.                      02390004
037800*----------------------------------------------------------       02400004
037900 2000-EXTRACT-DATA.                                               02410007
                                                                        02410105
                                                                        02421612
051100     PERFORM 2100-FETCH-EXTRACT                                   02422012
051200        THRU 2100-EXIT.                                           02423012
038000                                                                  02424012
           IF PS-NOT-EOF-EXTRACT                                        02425015
051100         PERFORM 2200-FORMAT-EXTRACT-FILE                         02430015
051200            THRU 2200-EXIT                                        02440015
                                                                        02440107
051100         PERFORM 3000-WRITE-AD-EVNT-EXTRACT                       02441015
051200            THRU 3000-EXIT                                        02442015
           END-IF.                                                      02443015
038000                                                                  02450007
038110*2000-EXIT.                                                       02540004
038200 EJECT.                                                           02550004
                                                                        02550115
030000 2010-COMPUTE-STRT-DTE.                                           02550210
                                                                        02550321
           READ DATE-RANGE-FILE INTO CC-DATE-RANGE-FILE                 02550421
              AT END                                                    02550521
                 SET PS-DATE-RANGE-FILE-END TO TRUE                     02550621
           END-READ.                                                    02550721
                                                                        02550821
           IF PS-DATE-RANGE-FILE-END                                    02550921
               MOVE 'NO DATE RANGE FILE TO PROCESS'                     02551021
                                                 TO PV-OPERATION-MSG-1  02551121
               PERFORM Z910-ABEND                                       02551321
           ELSE                                                         02551421
               DISPLAY 'CC-START-DATE = ' CC-START-DATE                 02551521
               DISPLAY 'CC-END-DATE   = ' CC-END-DATE                   02551621
           END-IF.                                                      02551721
030100                                                                  02551810
           READ TMST-FILE INTO CC-TMST-FILE                             02551921
              AT END                                                    02552021
                 SET PS-TMST-FILE-END TO TRUE                           02552121
           END-READ.                                                    02552221
                                                                        02552321
           IF PS-TMST-FILE-END                                          02552421
               MOVE 'NO TMST FILE TO PROCESS'                           02552521
                                                 TO PV-OPERATION-MSG-1  02552621
               PERFORM Z910-ABEND                                       02552821
           ELSE                                                         02552921
               DISPLAY 'CC-LAST-UPD-TMST = ' CC-LAST-UPD-TMST           02553021
           END-IF.                                                      02553121
                                                                        02556221
 35100                                                                  02557421
038110 2010-EXIT.                                                       02557521
           EXIT.                                                        02557621
038200 EJECT.                                                           02557721
038300*------------------------------------------------------           02557821
038400* 2100-FETCH-EXTRACT                                              02557921
038500*     EXTRACTS THE AD EVENT RECORD.                               02558021
038600*------------------------------------------------------           02559004
038210                                                                  02560004
054400 2100-FETCH-EXTRACT.                                              02561004
054500                                                                  02562004
054600     EXEC SQL                                                     02563004
054700         FETCH EXTRACT                                            02564004
039800             INTO :XST00027-AD-EVNT-ID,                           02564105
039810                  :XST00027-AD-EVNT-NM,                           02564205
039820                  :XST00027-AD-EVNT-NBR-TXT,                      02564305
039821                  :XST00027-STAT-CDE,                             02564405
039830                  :XST00027-STRT-DTE,                             02564505
039840                  :XST00027-END-DTE,                              02564605
039860                  :XST00027-SOR-LAST-UPD-TMST                     02564830
055300     END-EXEC.                                                    02569104
055400                                                                  02569204
055500     IF SQLCODE < 0                                               02569304
055600         DISPLAY 'FETCH UNSUCCESSFUL FOR TABLE XST_AD_EVNT'       02569404
055700         PERFORM U9980-SQL-ERROR                                  02569504
055800            THRU U9980-EXIT.                                      02569604
055900                                                                  02569704
056000     IF (SQLCODE > 0 AND SQLCODE NOT EQUAL +100) OR               02569804
056100           SQLWARN0 = 'W'                                         02569904
056200         DISPLAY 'FETCH WARNING FOR TABLE XST_AD_EVNT'            02570004
056300         PERFORM U9990-SQL-WARNING                                02570104
056400            THRU U9990-EXIT.                                      02570204
056500                                                                  02570304
056600     IF SQLCODE = +100                                            02570404
056700         MOVE 'Y' TO PS-EOF-EXTRACT-SW.                           02570507
056800                                                                  02570604
056900 2100-EXIT.                                                       02570704
057000     EXIT.                                                        02570804
038300*------------------------------------------------------           02571004
038400* 2200-FORMAT-EXTRACT-FILE                                        02580004
038500*     FORMATS THE AD EVENT COPY BOOK.                             02590004
038600*------------------------------------------------------           02600004
038700 2200-FORMAT-EXTRACT-FILE.                                        02610004
036600     MOVE 010                      TO XS015-BUSINESS-EVNT-ID.     02611023
036600     MOVE 'U'                      TO XS015-ACTION-CDE.           02611134
036700     MOVE XST00027-AD-EVNT-NBR-TXT TO XS015-AD-EVNT-NBR-TXT.      02612007
036800     MOVE XST00027-AD-EVNT-ID      TO XS015-AD-EVNT-ID.           02613023
036800     MOVE XST00027-AD-EVNT-NM      TO XS015-CPLT-NM.              02613123
036900     MOVE XST00027-STRT-DTE        TO XS015-STRT-DTE.             02614007
037000     MOVE XST00027-END-DTE         TO XS015-END-DTE.              02615007
037100     MOVE XST00027-STAT-CDE        TO XS015-STAT-CDE.             02616007
037200     MOVE XST00027-SOR-LAST-UPD-TMST   TO XS015-LAST-UPD-TMST.    02616133
038800                                                                  02620004
043510 2200-EXIT.                                                       03120007
           EXIT.                                                        03121007
043600 EJECT.                                                           03130004
043610                                                                  03140004
043700*------------------------------------------------------           03150004
043800* 3000-WRITE-AD-EVNT-EXTRACT.                                     03160004
043900*     WRITE EXTRACT FILE.                                         03170004
044000*------------------------------------------------------           03180004
044100 3000-WRITE-AD-EVNT-EXTRACT.                                      03190004
           ADD 1 TO PV-RECORD-COUNT.                                    03190115
062300     WRITE AD-EVNT-RECORD FROM XS015-ADEVENT-RECORD.              03191004
                                                                        03192004
047710 3000-EXIT.                                                       03570007
           EXIT.                                                        03571007
047800 EJECT.                                                           03580004
047810                                                                  03590004
056020                                                                  04710004
059800*----------------------------------------------------------       04720004
059900* 9999-WRAPUP.                                                    04730004
059910*     MOVES ALL ERROR CODES TO THE LINKAGE VARIABLES TO           04740004
059920*     BE PASSED BACK TO THE CALLING PROGRAM.  EXITS THE           04750004
059930*     PROGRAM.                                                    04760004
060000*----------------------------------------------------------       04770004
*                                                                       04770107
059800*----------------------------------------------------------       04770207
073900 U9980-SQL-ERROR.                                                 04771007
059800*----------------------------------------------------------       04771107
074000                                                                  04772007
074100     MOVE SQLCODE    TO SQLCODE2.                                 04773007
074200     MOVE SQLERRD(3) TO SQLERRD3.                                 04774007
074300     DISPLAY '** ABEND **       ** = SQLWARNING'.                 04775007
074400     DISPLAY '** PROGRAM        ** = XSKUT023'.                   04776007
074500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  04777007
074600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  04778007
074700     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   04779007
074800     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  04779107
074900                                                                  04779207
075000     MOVE 4013 TO ABEND-CODE.                                     04779307
075100     CALL 'ILBOABN0' USING ABEND-CODE.                            04779407
075200                                                                  04779507
075300 U9980-EXIT.                                                      04779607
075400     EXIT.                                                        04779707
                                                                        04779807
059800*----------------------------------------------------------       04779907
075600 U9990-SQL-WARNING.                                               04780007
059800*----------------------------------------------------------       04780107
075700                                                                  04780207
075800     MOVE SQLCODE    TO SQLCODE2.                                 04780307
075900     MOVE SQLERRD(3) TO SQLERRD3.                                 04780407
076000     DISPLAY '** ABEND **       ** = SQLWARNING'.                 04780507
076100     DISPLAY '** PROGRAM        ** = XSKUT023'.                   04780607
077200                                                                  04781707
077300     MOVE 4013 TO ABEND-CODE.                                     04781807
077400     CALL 'ILBOABN0' USING ABEND-CODE.                            04781907
077500                                                                  04782007
077600 U9990-EXIT.                                                      04782107
077700     EXIT.                                                        04782207
                                                                        04782315
060100 9990-WRITE-RECORD-CNT.                                           04782415
           INITIALIZE XS015-ADEVENT-RECORD.                             04782518
           MOVE 010 TO PV-BUSINESS-EVNT-ID.                             04782629
           MOVE PV-RECORD-COUNT TO PV-TOTAL-NBR-OF-RECS.                04782724
           MOVE 'T' TO PV-ACTION-CDE.                                   04782924
062300     WRITE AD-EVNT-RECORD FROM PV-TOTAL-RECORD.                   04783124
060710*9990-EXIT.                                                       04783315
                                                                        04783415
060100 9999-WRAPUP.                                                     04783515
           CLOSE DATE-RANGE-FILE                                        04783621
                 TMST-FILE                                              04783721
                 EXTRACT-FILE.                                          04783815
                                                                        04783915
072200     EXEC SQL                                                     04784015
072300         CLOSE EXTRACT                                            04784115
072400     END-EXEC.                                                    04785005
060200                                                                  04790004
060500                                                                  04830004
060710*9999-EXIT.                                                       04840004
060800 EJECT.                                                           04850004
060900                                                                  04860004
      ******************************************************************04870021
      * Z910-ABEND - PERFORMS A NON-SQL-ABEND                          *04880021
      ******************************************************************04890021
       Z910-ABEND.                                                      04900021
                                                                        04910021
           DISPLAY '** ABEND           **'.                             04920021
      *    DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  04930021
      *    DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        04940021
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         04950021
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-1.       04960021
                                                                        04970021
           CALL 'ILBOABN0' USING ABEND-CODE.                            04980021
