000010******************************************************************00001001
000020 IDENTIFICATION DIVISION.                                         00002001
000030******************************************************************00003001
000040*                                                                *00004001
000050*  I M P O R T A N T --- COMPILE AS BOTH CICS AND BATCH          *00005001
000060*                                                                *00006001
000070******************************************************************00007001
000080                                                                  00008001
000090 PROGRAM-ID.             RCKUT128.                                00009001
000100 AUTHOR.                 DENISE HAHN.                             00010001
000110 INSTALLATION.           KOHLS.                                   00011001
000120 DATE-WRITTEN            DECEMBER, 2003.                          00012001
000130 DATE-COMPILED.                                                   00013001
000140                                                                  00014001
000150******************************************************************00015001
000160* THIS MODULE WILL BE USED TO ACQUIRE EXPECTED/ACTUAL/VERIFIED    00016001
000170* UNIT QUANTITIES AND CARTON COUNTS                               00017001
000180*                                                                 00018001
000190*   PO/RCVR                                                       00019001
000200*   PO/RCVR/LINE                                                  00020001
000210*   PO/RCVR/LINE/STORE                                            00021001
000220*   PO/RCVR/PREPACK                                               00022001
000230*   PO/RCVR/PREPACK/STORE                                         00023001
000240*   SML                                                           00024001
000250*                                                                 00025001
000260*   COMMUNICATION AREA: RCWS074                                   00026001
000270*                                                                 00027001
000280*                                                                 00028001
000290* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00029001
000300******************************************************************00030001
000310                                                                  00031001
000320******************************************************************00032001
000330 ENVIRONMENT DIVISION.                                            00033001
000340******************************************************************00034001
000350                                                                  00035001
000360******************************************************************00036001
000370 DATA DIVISION.                                                   00037001
000380******************************************************************00038001
000390                                                                  00039001
000400******************************************************************00040001
000410 WORKING-STORAGE SECTION.                                         00041001
000420******************************************************************00042001
000430*----------------------------------------------------------------*00043001
000440**  SECURITY SUBROUTINE PARAMETERS                                00044001
000450*----------------------------------------------------------------*00045001
000460*    COPY DPWS008.                                                00046001
000470                                                                  00047001
000480******************************************************************00048001
000490*    PREPACK VERIFICATION                                         00049001
000500******************************************************************00050001
000510     COPY RCWS806.                                                00051001
000520                                                                  00052001
000530 01  DK-DB2-KEYS.                                                 00053001
000540     05  DK-OPER-UNT-ID            PIC S9(04)  COMP.              00054001
000550     05  DK-FCLTY-ID               PIC S9(04)  COMP.              00055001
000560     05  DK-PO-NBR                 PIC S9(09)  COMP.              00056001
000570     05  DK-RCVR-SEQ-NBR           PIC S9(09)  COMP.              00057001
000580     05  DK-LINE-NBR               PIC S9(04)  COMP.              00058001
000590     05  DK-PACK-ID                PIC S9(04)  COMP.              00059001
000600     05  DK-STR-NBR                PIC S9(04)  COMP.              00060001
000610     05  DK-SHIPT-UNT-ID           PIC S9(18)V COMP-3.            00061001
000620     05  DK-PO-DRIVER-LNE          PIC S9(09)  COMP SYNC.         00062001
000630                                                                  00063001
000640 01  PC-PROGRAM-CONSTANTS.                                        00064001
000650     05  PC-RCKCS806                  PIC X(8)  VALUE  'RCKCS806'.00065001
000660     05  PC-DB2-DEFAULT-TIMESTAMP     PIC  X(26)  VALUE           00066001
000670         '9999-09-09-09.09.09.999999'.                            00067001
000680                                                                  00068001
000690 01  PS-PROGRAM-SWITCHES.                                         00069001
000700     05  PS-P2L-LINE-SW                 PIC  X(01)  VALUE ' '.    00070001
000710         88  PS-P2L-LINE                            VALUE 'Y'.    00071001
000720         88  PS-NOT-P2L-LINE                        VALUE 'N'.    00072001
000730     05  PS-TDISTHD-FOUND-SW            PIC  X(01)  VALUE ' '.    00073001
000740         88  PS-TDISTHD-FOUND                       VALUE 'Y'.    00074001
000750         88  PS-NO-TDISTHD-FOUND                    VALUE 'N'.    00075001
000760     05  PS-RECDVS-SW                   PIC  X(01)  VALUE ' '.    00076001
000770         88  PS-MORE-RECDVS                         VALUE 'Y'.    00077001
000780         88  PS-NO-MORE-RECDVS                      VALUE 'N'.    00078001
000790     05  PS-ERROR-SW                    PIC  X(01)  VALUE ' '.    00079001
000800         88  PS-ERROR-YES                           VALUE 'Y'.    00080001
000810         88  PS-ERROR-NO                            VALUE 'N'.    00081001
000820     05  PS-EOF-LINE-CSR-SW             PIC  X(01)  VALUE ' '.    00082001
000830         88  PS-EOF-LINE-CSR-YES                    VALUE 'Y'.    00083001
000840         88  PS-EOF-LINE-CSR-NO                     VALUE 'N'.    00084001
000850     05  PS-SELECTION-CRITERIA-SW       PIC  X(01)  VALUE ' '.    00085001
000860         88  PS-BY-PO-RCVR-LINE-STR                 VALUE 'A'.    00086001
000870         88  PS-BY-PO-RCVR-LINE                     VALUE 'B'.    00087001
000880         88  PS-BY-PO-RCVR                          VALUE 'C'.    00088001
000890         88  PS-BY-PO-RCVR-PACK                     VALUE 'D'.    00089001
000900         88  PS-BY-PO-RCVR-PACK-STR                 VALUE 'E'.    00090001
000910         88  PS-BY-PO-RCVR-PACK-STR-LNE             VALUE 'F'.    00091001
000920         88  PS-BY-PO-RCVR-PACK-LNE                 VALUE 'M'.    00092001
000930         88  PS-BY-SML                              VALUE 'G'.    00093001
000940         88  PS-BY-SML-PO-RCVR                      VALUE 'H'.    00094001
000950         88  PS-BY-SML-PO-RCVR-LINE                 VALUE 'I'.    00095001
000960         88  PS-BY-SML-PO-RCVR-LINE-STR             VALUE 'J'.    00096001
000970         88  PS-BY-SML-PO-RCVR-PACK                 VALUE 'K'.    00097001
000980         88  PS-BY-SML-PO-RCVR-PACK-STR             VALUE 'L'.    00098001
000990         88  PS-UNKNOWN                             VALUE ' '.    00099001
001000     05  PS-PO-RCVR-LINE-CSR-END-SW     PIC  X(01)  VALUE 'N'.    00100001
001010         88  PS-PO-RCVR-LINE-CSR-END                VALUE 'Y'.    00101001
001020         88  PS-PO-RCVR-LINE-CSR-END-NO             VALUE 'N'.    00102001
001030     05  PS-PACK-CSR-END-SW             PIC  X(01)  VALUE 'N'.    00103001
001040         88  PS-PACK-CSR-END-YES                    VALUE 'Y'.    00104001
001050         88  PS-PACK-CSR-END-NO                     VALUE 'N'.    00105001
001060     05  PS-PO-RCVR-CSR-END-SW          PIC  X(01)  VALUE 'N'.    00106001
001070         88  PS-PO-RCVR-CSR-END-YES                 VALUE 'Y'.    00107001
001080         88  PS-PO-RCVR-CSR-END-NO                  VALUE 'N'.    00108001
001090     05  PS-PACK-STR-CSR-END-SW         PIC  X(01)  VALUE 'N'.    00109001
001100         88  PS-PACK-STR-CSR-END-YES                VALUE 'Y'.    00110001
001110         88  PS-PACK-STR-CSR-END-NO                 VALUE 'N'.    00111001
001120     05  PS-PACK-LNE-CSR-END-SW         PIC  X(01)  VALUE 'N'.    00112001
001130         88  PS-PACK-LNE-CSR-END-YES                VALUE 'Y'.    00113001
001140         88  PS-PACK-LNE-CSR-END-NO                 VALUE 'N'.    00114001
001150     05  PS-PACK-STR-LNE-CSR-END-SW     PIC  X(01)  VALUE 'N'.    00115001
001160         88  PS-PACK-STR-LNE-CSR-END-YES            VALUE 'Y'.    00116001
001170         88  PS-PACK-STR-LNE-CSR-END-NO             VALUE 'N'.    00117001
001180     05  PS-NO-DRIVER-INFO-SW           PIC  X(01)  VALUE 'Y'.    00118001
001190         88  PS-NO-DRIVER-INFO                      VALUE 'N'.    00119001
001200         88  PS-DRIVER-INFO                         VALUE 'Y'.    00120001
001210                                                                  00121001
001220 01  PV-PROGRAM-VARIABLES.                                        00122001
001230     05  PV-CASE-PKSLP                  PIC S9(09)  VALUE ZERO    00123001
001240                                                    COMP-3.       00124001
001250     05  PV-PKSLIP-PACKS                PIC  9(06).               00125001
001260     05  PV-ACTUAL-PACKS                PIC  9(06).               00126001
001270     05  PV-VERFYD-PACKS                PIC  9(06).               00127001
001280     05  PV-RECDVS-COUNT                PIC S9(09)  VALUE ZERO    00128001
001290                                                    COMP-3.       00129001
001300     05  PV-RCVR-STATUS                 PIC  X(02)  VALUE SPACE.  00130001
001310         88  PV-RCVR-VERIFIED                       VALUE 'VE'.   00131001
001320     05  PV-LINE-STATUS                 PIC  X(02)  VALUE SPACE.  00132001
001330         88  PV-LINE-VERIFIED                       VALUE 'VE'.   00133001
001340     05  PV-PKGNG-CDE                   PIC  X(01)  VALUE SPACE.  00134001
001350         88  PV-PREPK                               VALUE 'M' 'I'.00135001
001360         88  PB-BULK-CASE                           VALUE 'B' 'C'.00136001
001370     05  PV-PACK-BY-STR-IND             PIC  X(01)  VALUE SPACE.  00137001
001380         88  PV-PBS                                 VALUE 'Y'.    00138001
001390                                                                  00139001
001400     05  PV-VERIFY-ITM-QTY              PIC S9(09)  COMP.         00140001
001410     05  PV-INVCED-ITM-QTY              PIC S9(09)  COMP.         00141004
001420     05  PV-EXPTED-ITM-QTY              PIC S9(09)  COMP.         00142004
001430     05  PV-FCSE-ACTL-ITM-QTY           PIC S9(09)  COMP.         00143001
001440     05  PV-P2L-ACTL-ITM-QTY            PIC S9(09)  COMP.         00144001
001450     05  PV-TOTAL-ACTL-ITM-QTY          PIC S9(09)  COMP.         00145001
001460                                                                  00146001
001470     05  PV-EXPTED-PACK-QTY             PIC S9(09)  COMP.         00147001
001480     05  PV-FCSE-ACTL-PACK-QTY          PIC S9(09)  COMP.         00148001
001490     05  PV-P2L-ACTL-PACK-QTY           PIC S9(09)  COMP.         00149001
001500     05  PV-TOTAL-ACTL-PACK-QTY         PIC S9(09)  COMP.         00150001
001510     05  PV-VERIFY-PACK-QTY             PIC S9(09)  COMP.         00151001
001520                                                                  00152001
001530     05  PV-EXPTED-ODD-QTY              PIC S9(09)  COMP.         00153001
001540     05  PV-FCSE-ACTL-ODD-QTY           PIC S9(09)  COMP.         00154001
001550     05  PV-P2L-ACTL-ODD-QTY            PIC S9(09)  COMP.         00155001
001560     05  PV-TOTAL-ACTL-ODD-QTY          PIC S9(09)  COMP.         00156001
001570     05  PV-VERIFY-ODD-QTY              PIC S9(09)  COMP.         00157001
001580                                                                  00158001
001590     05  PV-P2L-ACTL-LNE-ITM-QTY        PIC S9(09)  COMP.         00159001
001600                                                                  00160001
001610     05  PV-ORIG-EXPTED-ITM-QTY         PIC S9(09)  COMP.         00161001
001620     05  PV-SHIPT-UNT-ID                PIC S9(18)V COMP-3.       00162001
001630     05  PV-SUM-SHPD-UNT-QTY            PIC S9(09)  COMP.         00163001
001640     05  PV-TOTAL-PACKS                 PIC S9(09)  COMP.         00164001
001650     05  PV-ODD-UNITS                   PIC S9(09)  COMP.         00165001
001660     05  PV-CARTON-ODD-UNITS            PIC S9(09)  COMP.         00166001
001670     05  PV-TOTAL-ODD-UNITS             PIC S9(09)  COMP.         00167001
001680     05  PV-NUMBER-OF-LINES             PIC S9(05)  COMP-3.       00168001
001690     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      00169001
001700                                                    COMP SYNC.    00170001
001710     05  PV-ODD-UNT-IND                 PIC  X(01).               00171001
001720                                                                  00172001
001730     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      00173001
001740                                                    COMP SYNC.    00174001
001750     05  PV-DRIVER-RATIO                PIC  9(06).               00175001
001760     05  PV-ODD-UNT-CRTN-COUNT          PIC S9(04)  VALUE +0      00176001
001770                                                    COMP SYNC.    00177001
001780     05  PV-LNE-VERIFY-ITM-QTY          PIC S9(09)  VALUE +0      00178001
001790                                                    COMP SYNC.    00179001
001800     05  PV-LNE-FCSE-ACTL-ITM-QTY       PIC S9(09)  VALUE +0      00180001
001810                                                    COMP SYNC.    00181001
001820     05  PV-LNE-P2L-ACTL-ITM-QTY        PIC S9(09)  VALUE +0      00182001
001830                                                    COMP SYNC.    00183001
001840     05  PV-LNE-INVCED-ITM-QTY          PIC S9(09)  VALUE +0      00184004
001850                                                    COMP SYNC.    00185001
001860     05  PV-LNE-EXPTED-ITM-QTY          PIC S9(09)  VALUE +0      00186004
001870                                                    COMP SYNC.    00187001
001880     05  PV-LNE-EXPTED-ORIG-ITM-QTY     PIC S9(09)  VALUE +0      00188001
001890                                                    COMP SYNC.    00189001
001900     05  PV-LNE-AP-VERIFY-ITM-QTY       PIC S9(09)  VALUE +0      00190001
001910                                                    COMP SYNC.    00191001
001920     05  PV-ODD-DC-VERIFY-ODU-PK-QTY    PIC S9(09)  VALUE +0      00192001
001930                                                    COMP SYNC.    00193001
001940     05  PV-ODD-AP-VERIFY-ODU-PK-QTY    PIC S9(09)  VALUE +0      00194001
001950                                                    COMP SYNC.    00195001
001960 01  PV-PACK-TABLE.                                               00196001
001970     05  PV-PACK-ITEM OCCURS 500 TIMES INDEXED BY LINE-IDX.       00197001
001980         10  PACK-LINE                   PIC  S9(9) COMP.         00198001
001990         10  PACK-RATIO                  PIC  S9(4) COMP.         00199001
002000         10  PACK-VERIFY-ITM-QTY         PIC  S9(09) COMP-3.      00200001
002010                                                                  00201001
002020******************************************************************00202001
002030*    DB2 DCLGEN FOR TRECDVS TABLE                                 00203001
002040******************************************************************00204001
002050     EXEC SQL                                                     00205001
002060          INCLUDE TRECDVS                                         00206001
002070     END-EXEC.                                                    00207001
002080                                                                  00208001
002090*----------------------------------------------------------------*00209001
002100*    TPKSKIP (RC-PACK SLIP)                                       00210001
002110*----------------------------------------------------------------*00211001
002120     EXEC SQL                                                     00212001
002130          INCLUDE TPKSLIP                                         00213001
002140     END-EXEC.                                                    00214001
002150                                                                  00215001
002160*---------------------------------------------------------------* 00216001
002170*    DB2 AREA FOR RECEIPT VERIFIED ODD UNITS TABLE              * 00217001
002180*    (RCT_VRFD_ODD_UNT)                                         * 00218001
002190*---------------------------------------------------------------* 00219001
002200     EXEC SQL                                                     00220001
002210          INCLUDE RCT00009                                        00221001
002220     END-EXEC.                                                    00222001
002230                                                                  00223001
002240*---------------------------------------------------------------* 00224001
002250*    DB2 AREA FOR ORIGINAL EXPECTED TRECDIS QUANTITY TABLE      * 00225001
002260*    (RCT_RECDIS_ORIG)                                          * 00226001
002270*---------------------------------------------------------------* 00227001
002280     EXEC SQL                                                     00228001
002290          INCLUDE RCT00013                                        00229001
002300     END-EXEC.                                                    00230001
002310                                                                  00231001
002320*---------------------------------------------------------------* 00232001
002330*    DB2 AREA FOR PURCHASE ORDER PRE PACK TABLE                 * 00233001
002340*---------------------------------------------------------------* 00234001
002350     EXEC SQL                                                     00235001
002360          INCLUDE TPOPRPK                                         00236001
002370     END-EXEC.                                                    00237001
002380                                                                  00238001
002390*---------------------------------------------------------------* 00239001
002400*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 00240001
002410*---------------------------------------------------------------* 00241001
002420     EXEC SQL                                                     00242001
002430          INCLUDE TPURITM                                         00243001
002440     END-EXEC.                                                    00244001
002450*----------------------------------------------------------------*00245001
002460*     TRECDIS (RC-RECEIPT DISTRIBUTION)                           00246001
002470*----------------------------------------------------------------*00247001
002480     EXEC SQL                                                     00248001
002490          INCLUDE TRECDIS                                         00249001
002500     END-EXEC.                                                    00250001
002510                                                                  00251001
002520*----------------------------------------------------------------*00252001
002530*     TRECITM (RC-RECEIPT ITEM)                                   00253001
002540*----------------------------------------------------------------*00254001
002550     EXEC SQL                                                     00255001
002560          INCLUDE TRECITM                                         00256001
002570     END-EXEC.                                                    00257001
002580                                                                  00258001
002590*----------------------------------------------------------------*00259001
002600*     TRECEIV (RC-RECEIVER)                                       00260001
002610*----------------------------------------------------------------*00261001
002620     EXEC SQL                                                     00262001
002630          INCLUDE TRECEIV                                         00263001
002640     END-EXEC.                                                    00264001
002650                                                                  00265001
002660*---------------------------------------------------------------* 00266001
002670*    DB2 AREA FOR DIST HEADER                                   * 00267001
002680*---------------------------------------------------------------* 00268001
002690     EXEC SQL                                                     00269001
002700          INCLUDE TDISTHD                                         00270001
002710     END-EXEC.                                                    00271001
002720                                                                  00272001
002730*----------------------------------------------------------------*00273001
002740*     TDISTDT (DC-DISTRIBUTION TRANSACTION DETAIL)                00274001
002750*----------------------------------------------------------------*00275001
002760     EXEC SQL                                                     00276001
002770          INCLUDE TDISTDT                                         00277001
002780     END-EXEC.                                                    00278001
002790                                                                  00279001
002800*----------------------------------------------------------------*00280001
002810*     SUT_OTBND_UPC (SU-SHIPMENT UNIT/UPC ASSOCIATION) (SUT00028) 00281001
002820*----------------------------------------------------------------*00282001
002830     EXEC SQL                                                     00283001
002840          INCLUDE SUT00028                                        00284001
002850     END-EXEC.                                                    00285001
002860                                                                  00286001
002870*----------------------------------------------------------------*00287001
002880*     SUT_OTBND_PK  (SU-SHIPMENT UNIT/PACK) (SUT00041)            00288001
002890*----------------------------------------------------------------*00289001
002900     EXEC SQL                                                     00290001
002910          INCLUDE SUT00041                                        00291001
002920     END-EXEC.                                                    00292001
002930                                                                  00293001
002940*----------------------------------------------------------------*00294001
002950*     SUT_OTBND_CART (SU-OUTBOUND SHIPMENT CARTON)     (SUT00024) 00295001
002960*----------------------------------------------------------------*00296001
002970     EXEC SQL                                                     00297001
002980          INCLUDE SUT00024                                        00298001
002990     END-EXEC.                                                    00299001
003000                                                                  00300001
003010******************************************************************00301001
003020*  COMMUNICATIONS AREA FOR DB2                                    00302001
003030******************************************************************00303001
003040     EXEC SQL                                                     00304001
003050         INCLUDE SQLCA                                            00305001
003060     END-EXEC.                                                    00306001
003070                                                                  00307001
003080*---------------------------------------------------------------* 00308001
003090*   PO-RCVR-LINE CURSOR                                         * 00309001
003100*---------------------------------------------------------------* 00310001
003110     EXEC SQL                                                     00311001
003120          DECLARE PO_RCVR_LINE_CSR CURSOR FOR                     00312001
003130           SELECT ORD_LNE_NBR                                     00313001
003140                , STATUS_CDE                                      00314001
003150             FROM TRECITM                                         00315001
003160            WHERE ORD_NBR         =  :DK-PO-NBR                   00316001
003170              AND REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR             00317001
003180              AND VER_STATUS_CDE  =  'A'                          00318001
003190          ORDER BY                                                00319001
003200                ORD_LNE_NBR                                       00320001
003210     END-EXEC.                                                    00321001
003220                                                                  00322001
003230     EXEC SQL                                                     00323001
003240          DECLARE PO_RCVR_PACK_CSR CURSOR FOR                     00324001
003250           SELECT PREPK_ID                                        00325001
003260             FROM TRECITM                                         00326001
003270            WHERE ORD_NBR         =  :DK-PO-NBR                   00327001
003280              AND REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR             00328001
003290              AND VER_STATUS_CDE  =  'A'                          00329001
003300          ORDER BY                                                00330001
003310                PREPK_ID                                          00331001
003320     END-EXEC.                                                    00332001
003330                                                                  00333001
003340     EXEC SQL                                                     00334001
003350          DECLARE PACK_CSR CURSOR FOR                             00335001
003360           SELECT A.SHIPT_UNT_ID                                  00336001
003370              ,   A.TRN_LNE_NBR                                   00337001
003380              ,   B.ODD_UNT_IND                                   00338001
003390              ,   C.PREPK_RATO_QTY                                00339001
003400              ,   SUM(A.SHPD_UNT_QTY)                             00340001
003410            FROM SUT_OTBND_UPC A                                  00341001
003420              ,  SUT_OTBND_CART B                                 00342001
003430              ,  TRECITM  C                                       00343001
003440          WHERE                                                   00344001
003450                A.TRN_NBR        =  :DK-PO-NBR                    00345001
003460           AND  A.TRN_NBR        =   C.ORD_NBR                    00346001
003470           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              00347001
003480           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                00348001
003490           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               00349001
003500           AND  B.ACTV_IND       =  'Y'                           00350001
003510           AND  B.ODD_UNT_IND    =  'Y'                           00351001
003520           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              00352001
003530           AND  A.TRN_LNE_NBR      =  C.ORD_LNE_NBR               00353001
003540           AND  C.VER_STATUS_CDE   =  'A'                         00354001
003550           AND  C.PREPK_ID         = :DK-PACK-ID                  00355001
003560         GROUP BY A.SHIPT_UNT_ID                                  00356001
003570              ,   A.TRN_LNE_NBR                                   00357001
003580              ,   B.ODD_UNT_IND                                   00358001
003590              ,   C.PREPK_RATO_QTY                                00359001
003600         ORDER BY A.SHIPT_UNT_ID                                  00360001
003610              ,   A.TRN_LNE_NBR                                   00361001
003620     END-EXEC.                                                    00362001
003630                                                                  00363001
003640     EXEC SQL                                                     00364001
003650          DECLARE PACK_STR_CSR CURSOR FOR                         00365001
003660           SELECT A.SHIPT_UNT_ID                                  00366001
003670              ,   A.TRN_LNE_NBR                                   00367001
003680              ,   B.ODD_UNT_IND                                   00368001
003690              ,   C.PREPK_RATO_QTY                                00369001
003700              ,   SUM(A.SHPD_UNT_QTY)                             00370001
003710            FROM SUT_OTBND_UPC A                                  00371001
003720              ,  SUT_OTBND_CART B                                 00372001
003730              ,  TRECITM  C                                       00373001
003740          WHERE                                                   00374001
003750                A.TRN_NBR        =  :DK-PO-NBR                    00375001
003760           AND  A.TRN_NBR        =   C.ORD_NBR                    00376001
003770           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              00377001
003780           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                00378001
003790           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               00379001
003800           AND  B.DEST_LOC_NBR   =  :DK-STR-NBR                   00380001
003810           AND  B.ACTV_IND       =  'Y'                           00381001
003820           AND  B.ODD_UNT_IND    =  'Y'                           00382001
003830           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              00383001
003840           AND  A.TRN_LNE_NBR      =  C.ORD_LNE_NBR               00384001
003850           AND  C.VER_STATUS_CDE   =  'A'                         00385001
003860           AND  C.PREPK_ID         = :DK-PACK-ID                  00386001
003870         GROUP BY A.SHIPT_UNT_ID                                  00387001
003880              ,   A.TRN_LNE_NBR                                   00388001
003890              ,   B.ODD_UNT_IND                                   00389001
003900              ,   C.PREPK_RATO_QTY                                00390001
003910         ORDER BY                                                 00391001
003920                  A.TRN_LNE_NBR                                   00392001
003930     END-EXEC.                                                    00393001
003940                                                                  00394001
003950     EXEC SQL                                                     00395001
003960          DECLARE PACK_STR_LNE_CSR CURSOR FOR                     00396001
003970           SELECT A.SHIPT_UNT_ID                                  00397001
003980              ,   A.TRN_LNE_NBR                                   00398001
003990              ,   B.ODD_UNT_IND                                   00399001
004000              ,   C.PREPK_RATO_QTY                                00400001
004010              ,   SUM(A.SHPD_UNT_QTY)                             00401001
004020            FROM SUT_OTBND_UPC A                                  00402001
004030              ,  SUT_OTBND_CART B                                 00403001
004040              ,  TRECITM  C                                       00404001
004050          WHERE                                                   00405001
004060                A.TRN_NBR        =  :DK-PO-NBR                    00406001
004070           AND  A.TRN_NBR        =   C.ORD_NBR                    00407001
004080           AND  A.TRN_LNE_NBR    =  :DK-LINE-NBR                  00408001
004090           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              00409001
004100           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                00410001
004110           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               00411001
004120           AND  B.DEST_LOC_NBR   =  :DK-STR-NBR                   00412001
004130           AND  B.ACTV_IND       =  'Y'                           00413001
004140           AND  B.ODD_UNT_IND    =  'Y'                           00414001
004150           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              00415001
004160           AND  A.TRN_LNE_NBR      =  C.ORD_LNE_NBR               00416001
004170           AND  C.VER_STATUS_CDE   =  'A'                         00417001
004180           AND  C.PREPK_ID         = :DK-PACK-ID                  00418001
004190         GROUP BY A.SHIPT_UNT_ID                                  00419001
004200              ,   A.TRN_LNE_NBR                                   00420001
004210              ,   B.ODD_UNT_IND                                   00421001
004220              ,   C.PREPK_RATO_QTY                                00422001
004230         ORDER BY                                                 00423001
004240                  A.TRN_LNE_NBR                                   00424001
004250     END-EXEC.                                                    00425001
004260                                                                  00426001
004270     EXEC SQL                                                     00427001
004280          DECLARE PACK_LNE_CSR CURSOR FOR                         00428001
004290           SELECT A.SHIPT_UNT_ID                                  00429001
004300              ,   A.TRN_LNE_NBR                                   00430001
004310              ,   B.ODD_UNT_IND                                   00431001
004320              ,   C.PREPK_RATO_QTY                                00432001
004330              ,   SUM(A.SHPD_UNT_QTY)                             00433001
004340            FROM SUT_OTBND_UPC A                                  00434001
004350              ,  SUT_OTBND_CART B                                 00435001
004360              ,  TRECITM  C                                       00436001
004370          WHERE                                                   00437001
004380                A.TRN_NBR        =  :DK-PO-NBR                    00438001
004390           AND  A.TRN_NBR        =   C.ORD_NBR                    00439001
004400           AND  A.TRN_LNE_NBR    =  :DK-LINE-NBR                  00440001
004410           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              00441001
004420           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                00442001
004430           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               00443001
004440           AND  B.ACTV_IND       =  'Y'                           00444001
004450           AND  B.ODD_UNT_IND    =  'Y'                           00445001
004460           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              00446001
004470           AND  A.TRN_LNE_NBR      =  C.ORD_LNE_NBR               00447001
004480           AND  C.VER_STATUS_CDE   =  'A'                         00448001
004490           AND  C.PREPK_ID         = :DK-PACK-ID                  00449001
004500         GROUP BY A.SHIPT_UNT_ID                                  00450001
004510              ,   A.TRN_LNE_NBR                                   00451001
004520              ,   B.ODD_UNT_IND                                   00452001
004530              ,   C.PREPK_RATO_QTY                                00453001
004540         ORDER BY                                                 00454001
004550                  A.TRN_LNE_NBR                                   00455001
004560     END-EXEC.                                                    00456001
004570                                                                  00457001
004580     EXEC SQL                                                     00458001
004590          DECLARE RECDVS-CURSOR CURSOR FOR                        00459001
004600          SELECT                                                  00460001
004610                  VRFY_SRC_CDE                                    00461001
004620                , EXPTED_ITM_QTY                                  00462001
004630                , VRFY_ITM_QTY                                    00463001
004640            FROM                                                  00464001
004650                  TRECDVS                                         00465001
004660            WHERE                                                 00466001
004670                  ORD_NBR          = :DK-PO-NBR                   00467001
004680              AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR             00468001
004690              AND ORD_LNE_NBR      = :DK-PO-DRIVER-LNE            00469001
004700              AND STR_NBR          = :DK-STR-NBR                  00470001
004710              AND VER_STAT_CDE     = 'A'                          00471001
004720              AND VRFY_SRC_CDE     IN ('P2','CP')                 00472001
004730     END-EXEC.                                                    00473001
004740                                                                  00474001
004750     EXEC SQL                                                     00475001
004760          DECLARE RECDVS-PACK-CURSOR CURSOR FOR                   00476001
004770          SELECT                                                  00477001
004780                  VRFY_SRC_CDE                                    00478001
004790                , SUM(EXPTED_ITM_QTY)                             00479001
004800                , SUM(VRFY_ITM_QTY)                               00480001
004810            FROM                                                  00481001
004820                  TRECDVS                                         00482001
004830            WHERE                                                 00483001
004840                  ORD_NBR          = :DK-PO-NBR                   00484001
004850              AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR             00485001
004860              AND ORD_LNE_NBR      = :DK-PO-DRIVER-LNE            00486001
004870              AND VER_STAT_CDE     = 'A'                          00487001
004880              AND VRFY_SRC_CDE     IN ('P2','CP')                 00488001
004890           GROUP BY VRFY_SRC_CDE                                  00489001
004900     END-EXEC.                                                    00490001
004910                                                                  00491001
004920******************************************************************00492001
004930 LINKAGE SECTION.                                                 00493001
004940     COPY RCWS074.                                                00494001
004950******************************************************************00495001
004960                                                                  00496001
004970******************************************************************00497001
004980 PROCEDURE DIVISION USING RC074-FIELDS.                           00498001
004990     SET RC074-SUCCESSFUL        TO TRUE                          00499001
005000     INITIALIZE DCLTPKSLIP                                        00500001
005010                DCLTRECDIS                                        00501001
005020                DCLTRECITM                                        00502001
005030                DCLTRECEIV                                        00503001
005040                DCLTDISTDT                                        00504001
005050                DCLSUT00028.                                      00505001
005060                                                                  00506001
005070******************************************************************00507001
005080 0000-PROGRAM-MAINLINE.                                           00508001
005090     INITIALIZE PV-PROGRAM-VARIABLES.                             00509001
005100     MOVE 'N'                   TO  PS-ERROR-SW                   00510001
005110                                    RC074-ERROR-SW.               00511001
005120                                                                  00512001
005130     PERFORM 1000-DETERMINE-CRITERIA.                             00513001
005140                                                                  00514001
005150     IF  PS-BY-PO-RCVR-LINE-STR      OR                           00515001
005160         PS-BY-PO-RCVR-LINE          OR                           00516001
005170         PS-BY-PO-RCVR               OR                           00517001
005180         PS-BY-PO-RCVR-PACK          OR                           00518001
005190         PS-BY-PO-RCVR-PACK-STR      OR                           00519001
005200         PS-BY-PO-RCVR-PACK-STR-LNE  OR                           00520001
005210         PS-BY-PO-RCVR-PACK-LNE      OR                           00521001
005220         PS-BY-SML-PO-RCVR           OR                           00522001
005230         PS-BY-SML-PO-RCVR-LINE      OR                           00523001
005240         PS-BY-SML-PO-RCVR-LINE-STR  OR                           00524001
005250         PS-BY-SML-PO-RCVR-PACK      OR                           00525001
005260         PS-BY-SML-PO-RCVR-PACK-STR                               00526001
005270         PERFORM 1010-GET-RCVR-STATUS                             00527001
005280     END-IF.                                                      00528001
005290                                                                  00529001
005300     IF  PS-BY-PO-RCVR-LINE-STR      OR                           00530001
005310         PS-BY-PO-RCVR-LINE          OR                           00531001
005320         PS-BY-SML-PO-RCVR-LINE      OR                           00532001
005330         PS-BY-SML-PO-RCVR-LINE-STR  OR                           00533001
005340         PS-BY-PO-RCVR-PACK-STR-LNE  OR                           00534001
005350         PS-BY-PO-RCVR-PACK-LNE                                   00535001
005360         PERFORM 1020-GET-LINE-STATUS                             00536001
005370     END-IF.                                                      00537001
005380                                                                  00538001
005390     IF  PS-BY-PO-RCVR-PACK          OR                           00539001
005400         PS-BY-PO-RCVR-PACK-STR      OR                           00540001
005410         PS-BY-SML-PO-RCVR-PACK      OR                           00541001
005420         PS-BY-SML-PO-RCVR-PACK-STR                               00542001
005430         PERFORM 1030-GET-PACK-STATUS                             00543001
005440     END-IF.                                                      00544001
005450                                                                  00545001
005460     IF  RC074-UNIT-QTY-YES                                       00546001
005470         PERFORM 2000-UNIT-QTY-PROCESS                            00547001
005480     END-IF.                                                      00548001
005490                                                                  00549001
005500     IF  RC074-PACK-QTY-YES                                       00550001
005510         PERFORM 4000-PACK-QTY-PROCESS                            00551001
005520     END-IF.                                                      00552001
005530                                                                  00553001
005540     IF  RC074-CARTON-COUNT-YES                                   00554001
005550         PERFORM 7000-CARTON-COUNT-PROCESS                        00555001
005560     END-IF.                                                      00556001
005570                                                                  00557001
005580     PERFORM 9998-RETURN.                                         00558001
005590                                                                  00559001
005600******************************************************************00560001
005610*  DETERMINE CRITERIA FOR SELECTIONS BASED ON DATA RECEIVED IN   *00561001
005620*  THE COMMUNICATION AREA.                                       *00562001
005630******************************************************************00563001
005640 1000-DETERMINE-CRITERIA.                                         00564001
005650                                                                  00565001
005660     EVALUATE TRUE                                                00566001
005670         WHEN  RC074-PO-NBR        >  0  AND                      00567001
005680               RC074-RCVR-SEQ-NBR  >  0  AND                      00568001
005690               RC074-LINE-NBR      >  0  AND                      00569001
005700               RC074-PACK-ID       =  0  AND                      00570001
005710               RC074-STR-NBR       >  0  AND                      00571001
005720               RC074-SHIPT-UNT-ID  =  0                           00572001
005730               SET  PS-BY-PO-RCVR-LINE-STR  TO  TRUE              00573001
005740                                                                  00574001
005750         WHEN  RC074-PO-NBR        >  0  AND                      00575001
005760               RC074-RCVR-SEQ-NBR  >  0  AND                      00576001
005770               RC074-LINE-NBR      >  0  AND                      00577001
005780               RC074-PACK-ID       =  0  AND                      00578001
005790               RC074-STR-NBR       =  0  AND                      00579001
005800               RC074-SHIPT-UNT-ID  =  0                           00580001
005810               SET  PS-BY-PO-RCVR-LINE      TO  TRUE              00581001
005820                                                                  00582001
005830         WHEN  RC074-PO-NBR        >  0  AND                      00583001
005840               RC074-RCVR-SEQ-NBR  >  0  AND                      00584001
005850               RC074-LINE-NBR      =  0  AND                      00585001
005860               RC074-PACK-ID       =  0  AND                      00586001
005870               RC074-STR-NBR       =  0  AND                      00587001
005880               RC074-SHIPT-UNT-ID  =  0                           00588001
005890               SET  PS-BY-PO-RCVR           TO  TRUE              00589001
005900                                                                  00590001
005910         WHEN  RC074-PO-NBR        >  0  AND                      00591001
005920               RC074-RCVR-SEQ-NBR  >  0  AND                      00592001
005930               RC074-LINE-NBR      =  0  AND                      00593001
005940               RC074-PACK-ID       >  0  AND                      00594001
005950               RC074-STR-NBR       =  0  AND                      00595001
005960               RC074-SHIPT-UNT-ID  =  0                           00596001
005970               SET  PS-BY-PO-RCVR-PACK      TO  TRUE              00597001
005980                                                                  00598001
005990         WHEN  RC074-PO-NBR        >  0  AND                      00599001
006000               RC074-RCVR-SEQ-NBR  >  0  AND                      00600001
006010               RC074-LINE-NBR      =  0  AND                      00601001
006020               RC074-PACK-ID       >  0  AND                      00602001
006030               RC074-STR-NBR       >  0  AND                      00603001
006040               RC074-SHIPT-UNT-ID  =  0                           00604001
006050               SET  PS-BY-PO-RCVR-PACK-STR  TO  TRUE              00605001
006060                                                                  00606001
006070         WHEN  RC074-PO-NBR        >  0  AND                      00607001
006080               RC074-RCVR-SEQ-NBR  >  0  AND                      00608001
006090               RC074-LINE-NBR      >  0  AND                      00609001
006100               RC074-PACK-ID       >  0  AND                      00610001
006110               RC074-STR-NBR       >  0  AND                      00611001
006120               RC074-SHIPT-UNT-ID  =  0                           00612001
006130               SET  PS-BY-PO-RCVR-PACK-STR-LNE TO TRUE            00613001
006140                                                                  00614001
006150         WHEN  RC074-PO-NBR        >  0  AND                      00615001
006160               RC074-RCVR-SEQ-NBR  >  0  AND                      00616001
006170               RC074-LINE-NBR      >  0  AND                      00617001
006180               RC074-PACK-ID       >  0  AND                      00618001
006190               RC074-STR-NBR       =  0  AND                      00619001
006200               RC074-SHIPT-UNT-ID  =  0                           00620001
006210               SET  PS-BY-PO-RCVR-PACK-LNE     TO TRUE            00621001
006220                                                                  00622001
006230         WHEN  RC074-PO-NBR        =  0  AND                      00623001
006240               RC074-RCVR-SEQ-NBR  =  0  AND                      00624001
006250               RC074-LINE-NBR      =  0  AND                      00625001
006260               RC074-PACK-ID       =  0  AND                      00626001
006270               RC074-STR-NBR       =  0  AND                      00627001
006280               RC074-SHIPT-UNT-ID  >  0                           00628001
006290               SET  PS-BY-SML               TO  TRUE              00629001
006300                                                                  00630001
006310         WHEN  RC074-PO-NBR        >  0  AND                      00631001
006320               RC074-RCVR-SEQ-NBR  >  0  AND                      00632001
006330               RC074-LINE-NBR      =  0  AND                      00633001
006340               RC074-PACK-ID       =  0  AND                      00634001
006350               RC074-STR-NBR       =  0  AND                      00635001
006360               RC074-SHIPT-UNT-ID  >  0                           00636001
006370               SET  PS-BY-SML-PO-RCVR       TO  TRUE              00637001
006380                                                                  00638001
006390         WHEN  RC074-PO-NBR        >  0  AND                      00639001
006400               RC074-RCVR-SEQ-NBR  >  0  AND                      00640001
006410               RC074-LINE-NBR      >  0  AND                      00641001
006420               RC074-PACK-ID       =  0  AND                      00642001
006430               RC074-STR-NBR       =  0  AND                      00643001
006440               RC074-SHIPT-UNT-ID  >  0                           00644001
006450               SET  PS-BY-SML-PO-RCVR-LINE  TO  TRUE              00645001
006460                                                                  00646001
006470         WHEN  RC074-PO-NBR        >  0  AND                      00647001
006480               RC074-RCVR-SEQ-NBR  >  0  AND                      00648001
006490               RC074-LINE-NBR      >  0  AND                      00649001
006500               RC074-PACK-ID       =  0  AND                      00650001
006510               RC074-STR-NBR       >  0  AND                      00651001
006520               RC074-SHIPT-UNT-ID  >  0                           00652001
006530               SET  PS-BY-SML-PO-RCVR-LINE-STR  TO  TRUE          00653001
006540                                                                  00654001
006550         WHEN  RC074-PO-NBR        >  0  AND                      00655001
006560               RC074-RCVR-SEQ-NBR  >  0  AND                      00656001
006570               RC074-LINE-NBR      =  0  AND                      00657001
006580               RC074-PACK-ID       >  0  AND                      00658001
006590               RC074-STR-NBR       =  0  AND                      00659001
006600               RC074-SHIPT-UNT-ID  >  0                           00660001
006610               SET  PS-BY-SML-PO-RCVR-PACK      TO  TRUE          00661001
006620                                                                  00662001
006630         WHEN  RC074-PO-NBR        >  0  AND                      00663001
006640               RC074-RCVR-SEQ-NBR  >  0  AND                      00664001
006650               RC074-LINE-NBR      =  0  AND                      00665001
006660               RC074-PACK-ID       >  0  AND                      00666001
006670               RC074-STR-NBR       >  0  AND                      00667001
006680               RC074-SHIPT-UNT-ID  >  0                           00668001
006690               SET  PS-BY-SML-PO-RCVR-PACK-STR  TO  TRUE          00669001
006700                                                                  00670001
006710         WHEN  OTHER                                              00671001
006720               SET  PS-UNKNOWN           TO TRUE                  00672001
006730               SET  RC074-NOT-SUCCESSFUL                          00673001
006740                    RC074-ERROR-YES                               00674001
006750                    PS-ERROR-YES         TO TRUE                  00675001
006760               MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO     00676001
006770               MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR   00677001
006780               MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE   00678001
006790               MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK   00679001
006800               MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR    00680001
006810               MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC   00681001
006820               STRING   ' RCKUT128-1000-'                         00682001
006830                        ' INVALID SELECTION CRITERIA'             00683001
006840                                           DELIMITED BY SIZE      00684001
006850                                      INTO RC074-CRA-RET-MSG      00685001
006860               STRING   ' RCKUT128-1000-'                         00686001
006870                        ' INVALID SELECTION CRITERIA'             00687001
006880                                           DELIMITED BY SIZE      00688001
006890                                      INTO RC074-ABEND-TEXT       00689001
006900               MOVE '1000-'             TO RC074-CRA-REQ-ID       00690001
006910                                           RC074-ABEND-PARAGRAPH  00691001
006920             PERFORM 9998-RETURN                                  00692001
006930                                                                  00693001
006940     END-EVALUATE.                                                00694001
006950                                                                  00695001
006960                                                                  00696001
006970******************************************************************00697001
006980*  IF PO-RECEIVER PASSED IN COMMUNICATION AREA - DETERMINE       *00698001
006990*  RECEIVER STATUS AND PACKAGING TYPE.                           *00699001
007000******************************************************************00700001
007010 1010-GET-RCVR-STATUS.                                            00701001
007020                                                                  00702001
007030     EXEC SQL                                                     00703001
007040          SELECT   STATUS_CDE                                     00704001
007050               ,   PACK_BY_ST_IND                                 00705001
007060               ,   PKGNG_CDE                                      00706001
007070            INTO  :PV-RCVR-STATUS                                 00707001
007080               ,  :PV-PACK-BY-STR-IND                             00708001
007090               ,  :PV-PKGNG-CDE                                   00709001
007100            FROM                                                  00710001
007110                  TRECEIV                                         00711001
007120            WHERE                                                 00712001
007130                  ORD_NBR         = :RC074-PO-NBR                 00713001
007140              AND REC_SEQ_NBR     = :RC074-RCVR-SEQ-NBR           00714001
007150              AND VER_STATUS_CDE  =  'A'                          00715001
007160     END-EXEC.                                                    00716001
007170                                                                  00717001
007180     EVALUATE TRUE                                                00718001
007190         WHEN SQLCODE = ZERO                                      00719001
007200             CONTINUE                                             00720001
007210         WHEN SQLCODE = -904                                      00721001
007220         WHEN SQLCODE = -911                                      00722001
007230         WHEN SQLCODE = -913                                      00723001
007240              SET  RC074-DATABASE-BUSY                            00724001
007250                   RC074-ERROR-YES                                00725001
007260                   PS-ERROR-YES         TO  TRUE                  00726001
007270              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 00727001
007280              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      00728001
007290              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    00729001
007300              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    00730001
007310              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    00731001
007320              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     00732001
007330              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    00733001
007340             STRING   ' RCKUT128-1010-'                           00734001
007350                      ' CALLED BY-'                               00735001
007360                      RC074-CALLING-PROGRAM                       00736001
007370                      ' PO='                                      00737001
007380                      RC074-DISPLAY-PO                            00738001
007390                      ' RCVR='                                    00739001
007400                      RC074-DISPLAY-RCVR                          00740001
007410                      ' SQLCODE='                                 00741001
007420                      RC074-DISPLAY-SQLCODE                       00742001
007430                      DELIMITED BY SIZE                           00743001
007440                                      INTO RC074-CRA-RET-MSG      00744001
007450             STRING   ' RCKUT128-1010-'                           00745001
007460                      ' CALLED BY-'                               00746001
007470                      RC074-CALLING-PROGRAM                       00747001
007480                      DELIMITED BY SIZE                           00748001
007490                                      INTO RC074-ABEND-TEXT       00749001
007500             MOVE '1010-'               TO RC074-CRA-REQ-ID       00750001
007510                                           RC074-ABEND-PARAGRAPH  00751001
007520             PERFORM 9998-RETURN                                  00752001
007530                                                                  00753001
007540         WHEN SQLWARN0 NOT = SPACES                               00754001
007550         WHEN SQLCODE  NOT = ZERO                                 00755001
007560              SET  RC074-INVALID-SQL                              00756001
007570                   RC074-ERROR-YES                                00757001
007580                   PS-ERROR-YES         TO  TRUE                  00758001
007590              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 00759001
007600              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      00760001
007610              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    00761001
007620              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    00762001
007630              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    00763001
007640              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     00764001
007650              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    00765001
007660             STRING   ' RCKUT128-1010-'                           00766001
007670                      ' CALLED BY-'                               00767001
007680                      RC074-CALLING-PROGRAM                       00768001
007690                      ' PO='                                      00769001
007700                      RC074-DISPLAY-PO                            00770001
007710                      ' RCVR='                                    00771001
007720                      RC074-DISPLAY-RCVR                          00772001
007730                      ' SQLCODE='                                 00773001
007740                      RC074-DISPLAY-SQLCODE                       00774001
007750                      DELIMITED BY SIZE                           00775001
007760                                      INTO RC074-CRA-RET-MSG      00776001
007770             STRING   ' RCKUT128-1010-'                           00777001
007780                      ' CALLED BY-'                               00778001
007790                      RC074-CALLING-PROGRAM                       00779001
007800                      DELIMITED BY SIZE                           00780001
007810                                      INTO RC074-ABEND-TEXT       00781001
007820             MOVE '1010-'               TO RC074-CRA-REQ-ID       00782001
007830                                           RC074-ABEND-PARAGRAPH  00783001
007840             PERFORM 9998-RETURN                                  00784001
007850     END-EVALUATE.                                                00785001
007860                                                                  00786001
007870                                                                  00787001
007880******************************************************************00788001
007890*  IF PO-RCVR-LINE PASSED IN COMMUNICATION AREA - DETERMINE      *00789001
007900*  LINE STATUS                                                   *00790001
007910******************************************************************00791001
007920 1020-GET-LINE-STATUS.                                            00792001
007930                                                                  00793001
007940     EXEC SQL                                                     00794001
007950          SELECT   STATUS_CDE                                     00795001
007960            INTO  :PV-LINE-STATUS                                 00796001
007970            FROM                                                  00797001
007980                  TRECITM                                         00798001
007990            WHERE                                                 00799001
008000                  ORD_NBR         = :RC074-PO-NBR                 00800001
008010              AND REC_SEQ_NBR     = :RC074-RCVR-SEQ-NBR           00801001
008020              AND ORD_LNE_NBR     = :RC074-LINE-NBR               00802001
008030              AND VER_STATUS_CDE  =  'A'                          00803001
008040     END-EXEC.                                                    00804001
008050                                                                  00805001
008060     EVALUATE TRUE                                                00806001
008070         WHEN SQLCODE = ZERO                                      00807001
008080             CONTINUE                                             00808001
008090         WHEN SQLCODE = -904                                      00809001
008100         WHEN SQLCODE = -911                                      00810001
008110         WHEN SQLCODE = -913                                      00811001
008120              SET  RC074-DATABASE-BUSY                            00812001
008130                   RC074-ERROR-YES                                00813001
008140                   PS-ERROR-YES         TO  TRUE                  00814001
008150              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 00815001
008160              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      00816001
008170              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    00817001
008180              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    00818001
008190              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    00819001
008200              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     00820001
008210              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    00821001
008220             STRING   ' RCKUT128-1020-'                           00822001
008230                      ' CALLED BY-'                               00823001
008240                      RC074-CALLING-PROGRAM                       00824001
008250                      ' PO='                                      00825001
008260                      RC074-DISPLAY-PO                            00826001
008270                      ' RCVR='                                    00827001
008280                      RC074-DISPLAY-RCVR                          00828001
008290                      ' LINE='                                    00829001
008300                      RC074-DISPLAY-LINE                          00830001
008310                      ' SQLCODE='                                 00831001
008320                      RC074-DISPLAY-SQLCODE                       00832001
008330                      DELIMITED BY SIZE                           00833001
008340                                      INTO RC074-CRA-RET-MSG      00834001
008350             STRING   ' RCKUT128-1020-'                           00835001
008360                      ' CALLED BY-'                               00836001
008370                      RC074-CALLING-PROGRAM                       00837001
008380                      DELIMITED BY SIZE                           00838001
008390                                      INTO RC074-ABEND-TEXT       00839001
008400             MOVE '1020-'               TO RC074-CRA-REQ-ID       00840001
008410                                           RC074-ABEND-PARAGRAPH  00841001
008420             PERFORM 9998-RETURN                                  00842001
008430                                                                  00843001
008440         WHEN SQLWARN0 NOT = SPACES                               00844001
008450         WHEN SQLCODE  NOT = ZERO                                 00845001
008460              SET  RC074-INVALID-SQL                              00846001
008470                   RC074-ERROR-YES                                00847001
008480                   PS-ERROR-YES         TO  TRUE                  00848001
008490              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 00849001
008500              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      00850001
008510              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    00851001
008520              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    00852001
008530              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    00853001
008540              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     00854001
008550              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    00855001
008560             STRING   ' RCKUT128-1020-'                           00856001
008570                      ' CALLED BY-'                               00857001
008580                      RC074-CALLING-PROGRAM                       00858001
008590                      ' PO='                                      00859001
008600                      RC074-DISPLAY-PO                            00860001
008610                      ' RCVR='                                    00861001
008620                      RC074-DISPLAY-RCVR                          00862001
008630                      ' LINE='                                    00863001
008640                      RC074-DISPLAY-LINE                          00864001
008650                      ' SQLCODE='                                 00865001
008660                      RC074-DISPLAY-SQLCODE                       00866001
008670                      DELIMITED BY SIZE                           00867001
008680                                      INTO RC074-CRA-RET-MSG      00868001
008690             STRING   ' RCKUT128-1020-'                           00869001
008700                      ' CALLED BY-'                               00870001
008710                      RC074-CALLING-PROGRAM                       00871001
008720                      DELIMITED BY SIZE                           00872001
008730                                      INTO RC074-ABEND-TEXT       00873001
008740             MOVE '1020-'               TO RC074-CRA-REQ-ID       00874001
008750                                           RC074-ABEND-PARAGRAPH  00875001
008760             PERFORM 9998-RETURN                                  00876001
008770     END-EVALUATE.                                                00877001
008780                                                                  00878001
008790                                                                  00879001
008800******************************************************************00880001
008810*  IF PO-RCVR-PACK PASSED IN COMMUNICATION AREA - DETERMINE      *00881001
008820*  LINE STATUS - FOR A GIVEN PACK                                *00882001
008830******************************************************************00883001
008840 1030-GET-PACK-STATUS.                                            00884001
008850                                                                  00885001
008860     EXEC SQL                                                     00886001
008870          SELECT   DISTINCT(STATUS_CDE)                           00887001
008880            INTO  :PV-LINE-STATUS                                 00888001
008890            FROM                                                  00889001
008900                  TRECITM                                         00890001
008910            WHERE                                                 00891001
008920                  ORD_NBR         = :RC074-PO-NBR                 00892001
008930              AND REC_SEQ_NBR     = :RC074-RCVR-SEQ-NBR           00893001
008940              AND PREPK_ID        = :RC074-PACK-ID                00894001
008950              AND VER_STATUS_CDE  =  'A'                          00895001
008960     END-EXEC.                                                    00896001
008970                                                                  00897001
008980     EVALUATE TRUE                                                00898001
008990         WHEN SQLCODE = ZERO                                      00899001
009000         WHEN SQLCODE = -811                                      00900001
009010             CONTINUE                                             00901001
009020         WHEN SQLCODE = -904                                      00902001
009030         WHEN SQLCODE = -911                                      00903001
009040         WHEN SQLCODE = -913                                      00904001
009050              SET  RC074-DATABASE-BUSY                            00905001
009060                   RC074-ERROR-YES                                00906001
009070                   PS-ERROR-YES         TO  TRUE                  00907001
009080              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 00908001
009090              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      00909001
009100              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    00910001
009110              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    00911001
009120              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    00912001
009130              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     00913001
009140              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    00914001
009150             STRING   ' RCKUT128-1030-'                           00915001
009160                      ' CALLED BY-'                               00916001
009170                      RC074-CALLING-PROGRAM                       00917001
009180                      ' PO='                                      00918001
009190                      RC074-DISPLAY-PO                            00919001
009200                      ' RCVR='                                    00920001
009210                      RC074-DISPLAY-RCVR                          00921001
009220                      ' PACK='                                    00922001
009230                      RC074-DISPLAY-PACK                          00923001
009240                      ' SQLCODE='                                 00924001
009250                      RC074-DISPLAY-SQLCODE                       00925001
009260                      DELIMITED BY SIZE                           00926001
009270                                      INTO RC074-CRA-RET-MSG      00927001
009280             STRING   ' RCKUT128-1030-'                           00928001
009290                      ' CALLED BY-'                               00929001
009300                      RC074-CALLING-PROGRAM                       00930001
009310                      DELIMITED BY SIZE                           00931001
009320                                      INTO RC074-ABEND-TEXT       00932001
009330             MOVE '1030-'               TO RC074-CRA-REQ-ID       00933001
009340                                           RC074-ABEND-PARAGRAPH  00934001
009350             PERFORM 9998-RETURN                                  00935001
009360                                                                  00936001
009370         WHEN SQLWARN0 NOT = SPACES                               00937001
009380         WHEN SQLCODE  NOT = ZERO                                 00938001
009390              SET  RC074-INVALID-SQL                              00939001
009400                   RC074-ERROR-YES                                00940001
009410                   PS-ERROR-YES         TO  TRUE                  00941001
009420              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 00942001
009430              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      00943001
009440              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    00944001
009450              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    00945001
009460              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    00946001
009470              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     00947001
009480              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    00948001
009490             STRING   ' RCKUT128-1030-'                           00949001
009500                      ' CALLED BY-'                               00950001
009510                      RC074-CALLING-PROGRAM                       00951001
009520                      ' PO='                                      00952001
009530                      RC074-DISPLAY-PO                            00953001
009540                      ' RCVR='                                    00954001
009550                      RC074-DISPLAY-RCVR                          00955001
009560                      ' PACK='                                    00956001
009570                      RC074-DISPLAY-PACK                          00957001
009580                      ' SQLCODE='                                 00958001
009590                      RC074-DISPLAY-SQLCODE                       00959001
009600                      DELIMITED BY SIZE                           00960001
009610                                      INTO RC074-CRA-RET-MSG      00961001
009620             STRING   ' RCKUT128-1030-'                           00962001
009630                      ' CALLED BY-'                               00963001
009640                      RC074-CALLING-PROGRAM                       00964001
009650                      DELIMITED BY SIZE                           00965001
009660                                      INTO RC074-ABEND-TEXT       00966001
009670             MOVE '1030-'               TO RC074-CRA-REQ-ID       00967001
009680                                           RC074-ABEND-PARAGRAPH  00968001
009690             PERFORM 9998-RETURN                                  00969001
009700     END-EVALUATE.                                                00970001
009710                                                                  00971001
009720                                                                  00972001
009730******************************************************************00973001
009740*  THIS PROCESS WILL BE USED TO DETERINE UNIT QUANTITIES         *00974001
009750*  EXPECTED/ACTUAL/VERIFIED                                      *00975001
009760******************************************************************00976001
009770 2000-UNIT-QTY-PROCESS.                                           00977001
009780                                                                  00978001
009790     MOVE RC074-OPER-UNT-ID    TO  DK-OPER-UNT-ID.                00979001
009800     MOVE RC074-FCLTY-ID       TO  DK-FCLTY-ID.                   00980001
009810     MOVE RC074-PO-NBR         TO  DK-PO-NBR.                     00981001
009820     MOVE RC074-RCVR-SEQ-NBR   TO  DK-RCVR-SEQ-NBR.               00982001
009830     MOVE RC074-LINE-NBR       TO  DK-LINE-NBR.                   00983001
009840     MOVE RC074-PACK-ID        TO  DK-PACK-ID.                    00984001
009850     MOVE RC074-STR-NBR        TO  DK-STR-NBR.                    00985001
009860     MOVE RC074-SHIPT-UNT-ID   TO  DK-SHIPT-UNT-ID.               00986001
009870                                                                  00987001
009880     MOVE ZEROES               TO  RC074-INVCED-ITM-QTY           00988004
009890                                   RC074-EXPTED-ITM-QTY           00989004
009900                                   RC074-FCSE-ACTL-ITM-QTY        00990001
009910                                   RC074-P2L-ACTL-ITM-QTY         00991001
009920                                   RC074-TOTAL-ACTL-ITM-QTY       00992001
009930                                   RC074-VERIFY-ITM-QTY           00993001
009940                                   RC074-FCSE-INVC-PACK-QTY       00994004
009950                                   RC074-FCSE-EXPT-PACK-QTY       00995004
009960                                   RC074-P2L-INVC-PACK-QTY        00996004
009970                                   RC074-P2L-EXPT-PACK-QTY        00997004
009980                                   RC074-TOTAL-INVC-PACK-QTY      00998004
009990                                   RC074-TOTAL-EXPT-PACK-QTY      00999004
010000                                   RC074-FCSE-ACTL-PACK-QTY       01000001
010010                                   RC074-P2L-ACTL-PACK-QTY        01001001
010020                                   RC074-TOTAL-ACTL-PACK-QTY      01002001
010030                                   RC074-VERIFY-PACK-QTY          01003001
010040                                   RC074-ACTUAL-ODD-QTY           01004001
010050                                   RC074-VERIFY-ODD-QTY.          01005001
010060                                                                  01006001
010070     EVALUATE TRUE                                                01007001
010080         WHEN  PS-BY-PO-RCVR-LINE-STR                             01008001
010090               IF  PV-RCVR-VERIFIED  OR                           01009001
010100                   PV-LINE-VERIFIED                               01010001
010110                   PERFORM 8015-VERIFIED-LINE-STR-QTY             01011001
010120                   PERFORM 8016-VERIFIED-LINE-STR-QTY             01012001
010130                   PERFORM 8018-VERIFIED-LNE-STR-QTY-ORIG         01013001
010140                   MOVE RC074-INVCED-ITM-QTY                      01014004
010150                                  TO RC074-EXPTED-ITM-QTY         01015004
010160                   ADD PV-ORIG-EXPTED-ITM-QTY                     01016001
010170                                        TO RC074-INVCED-ITM-QTY   01017004
010180               ELSE                                               01018001
010190                   PERFORM 8030-LINE-STR-EXPTD-VRFD-QTY           01019001
010200                   PERFORM 8035-LINE-STR-EXPTD-VRFD-QTY           01020001
010210                   PERFORM 8038-LINE-STR-EXPTD-QTY-ORIG           01021001
010220                   MOVE RC074-INVCED-ITM-QTY                      01022004
010230                                  TO RC074-EXPTED-ITM-QTY         01023004
010240                   ADD PV-ORIG-EXPTED-ITM-QTY                     01024001
010250                                        TO RC074-INVCED-ITM-QTY   01025004
010260                   PERFORM 8055-SUM-LINE-STR-OTBND-UPC            01026001
010270                   PERFORM 8075-SUM-LINE-STR-P2L-ACTL             01027001
010280                   ADD    RC074-FCSE-ACTL-ITM-QTY                 01028001
010290                          RC074-P2L-ACTL-ITM-QTY                  01029001
010300                   GIVING RC074-TOTAL-ACTL-ITM-QTY                01030001
010310               END-IF                                             01031001
010320                                                                  01032001
010330         WHEN  PS-BY-PO-RCVR-LINE                                 01033001
010340               IF  PV-RCVR-VERIFIED  OR                           01034001
010350                   PV-LINE-VERIFIED                               01035001
010360                   PERFORM 8010-VERIFIED-LINE-QTY                 01036001
010370                   PERFORM 8012-VERIFIED-LINE-QTY                 01037001
010380                   PERFORM 8014-VERIFIED-LINE-QTY-ORIG            01038001
010390                   MOVE RC074-INVCED-ITM-QTY                      01039004
010400                                  TO RC074-EXPTED-ITM-QTY         01040004
010410                   ADD PV-ORIG-EXPTED-ITM-QTY                     01041001
010420                                        TO RC074-INVCED-ITM-QTY   01042004
010430               ELSE                                               01043001
010440                   PERFORM 8020-LINE-EXPTD-VRFD-QTY               01044001
010450                   PERFORM 8025-LINE-EXPTD-VRFD-QTY               01045001
010460                   PERFORM 8028-LINE-EXPTD-VRFD-QTY-ORIG          01046001
010470                   MOVE RC074-INVCED-ITM-QTY                      01047004
010480                                  TO RC074-EXPTED-ITM-QTY         01048004
010490                   ADD PV-ORIG-EXPTED-ITM-QTY                     01049001
010500                                        TO RC074-INVCED-ITM-QTY   01050004
010510                   PERFORM 8050-SUM-LINE-OTBND-UPC                01051001
010520                   PERFORM 8070-SUM-LINE-P2L-ACTL                 01052001
010530                   ADD    RC074-FCSE-ACTL-ITM-QTY                 01053001
010540                          RC074-P2L-ACTL-ITM-QTY                  01054001
010550                   GIVING RC074-TOTAL-ACTL-ITM-QTY                01055001
010560               END-IF                                             01056001
010570                                                                  01057001
010580         WHEN  PS-BY-PO-RCVR                                      01058001
010590               IF  PV-RCVR-VERIFIED  OR                           01059001
010600                   PV-LINE-VERIFIED                               01060001
010610                   PERFORM 8000-VERIFIED-RCVR-QTY                 01061001
010620                   PERFORM 8005-VERIFIED-RCVR-QTY                 01062001
010630                   PERFORM 8008-VERIFIED-RCVR-QTY-ORIG            01063001
010640                   MOVE RC074-INVCED-ITM-QTY                      01064004
010650                                  TO RC074-EXPTED-ITM-QTY         01065004
010660                   ADD PV-ORIG-EXPTED-ITM-QTY                     01066001
010670                                        TO RC074-INVCED-ITM-QTY   01067004
010680               ELSE                                               01068001
010690                   PERFORM 3000-PROCESS-LINE-CURSOR               01069001
010700               END-IF                                             01070001
010710                                                                  01071001
010720*??      WHEN  PS-BY-SML                                          01072001
010730*??      WHEN  PS-BY-SML-PO-RCVR                                  01073001
010740*??      WHEN  PS-BY-SML-PO-RCVR-LINE                             01074001
010750*??      WHEN  PS-BY-SML-PO-RCVR-LINE-STR                         01075001
010760*??      WHEN  PS-BY-SML-PO-RCVR-PACK                             01076001
010770*??      WHEN  PS-BY-SML-PO-RCVR-PACK-STR                         01077001
010780                                                                  01078001
010790     END-EVALUATE.                                                01079001
010800                                                                  01080001
010810                                                                  01081001
010820*----------------------------------------------------------------*01082001
010830*    OPEN  RECEIVER LINE CURSOR                                  *01083001
010840*----------------------------------------------------------------*01084001
010850 3000-PROCESS-LINE-CURSOR.                                        01085001
010860                                                                  01086001
010870      PERFORM 3010-OPEN-RCVR-LNE-CSR.                             01087001
010880      PERFORM 3020-FETCH-RCVR-LNE-CSR.                            01088001
010890      PERFORM 3100-PROCESS-LINES                                  01089001
010900        UNTIL PS-PO-RCVR-LINE-CSR-END                             01090001
010910           OR PS-ERROR-YES                                        01091001
010920           OR RC074-ERROR-YES.                                    01092001
010930      PERFORM 3030-CLOSE-RCVR-LNE-CSR.                            01093001
010940                                                                  01094001
010950     MOVE  PV-VERIFY-ITM-QTY                                      01095001
010960       TO  RC074-VERIFY-ITM-QTY.                                  01096001
010970     MOVE  PV-INVCED-ITM-QTY                                      01097004
010980       TO  RC074-INVCED-ITM-QTY.                                  01098004
010990     MOVE  PV-EXPTED-ITM-QTY                                      01099004
011000       TO  RC074-EXPTED-ITM-QTY.                                  01100004
011010     MOVE  PV-FCSE-ACTL-ITM-QTY                                   01101001
011020       TO  RC074-FCSE-ACTL-ITM-QTY.                               01102001
011030     MOVE  PV-P2L-ACTL-ITM-QTY                                    01103001
011040       TO  RC074-P2L-ACTL-ITM-QTY.                                01104001
011050     MOVE  PV-TOTAL-ACTL-ITM-QTY                                  01105001
011060       TO  RC074-TOTAL-ACTL-ITM-QTY.                              01106001
011070     MOVE  ZEROES                                                 01107001
011080       TO  RC074-LINE-NBR.                                        01108001
011090                                                                  01109001
011100*----------------------------------------------------------------*01110001
011110*    OPEN  RECEIVER LINE CURSOR                                  *01111001
011120*----------------------------------------------------------------*01112001
011130 3010-OPEN-RCVR-LNE-CSR.                                          01113001
011140                                                                  01114001
011150     SET  PS-PO-RCVR-LINE-CSR-END-NO  TO  TRUE.                   01115001
011160                                                                  01116001
011170     EXEC SQL                                                     01117001
011180          OPEN PO_RCVR_LINE_CSR                                   01118001
011190     END-EXEC.                                                    01119001
011200                                                                  01120001
011210     EVALUATE TRUE                                                01121001
011220         WHEN SQLCODE = ZERO                                      01122001
011230             CONTINUE                                             01123001
011240         WHEN SQLCODE = -904                                      01124001
011250         WHEN SQLCODE = -911                                      01125001
011260         WHEN SQLCODE = -913                                      01126001
011270              SET  RC074-DATABASE-BUSY                            01127001
011280                   RC074-ERROR-YES                                01128001
011290                   PS-ERROR-YES         TO  TRUE                  01129001
011300              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01130001
011310              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01131001
011320              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01132001
011330              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01133001
011340              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01134001
011350              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01135001
011360              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01136001
011370             STRING   ' RCKUT128-3010-'                           01137001
011380                      ' CALLED BY-'                               01138001
011390                      RC074-CALLING-PROGRAM                       01139001
011400                      ' PO='                                      01140001
011410                      RC074-DISPLAY-PO                            01141001
011420                      ' RCVR='                                    01142001
011430                      RC074-DISPLAY-RCVR                          01143001
011440                      ' SQLCODE='                                 01144001
011450                      RC074-DISPLAY-SQLCODE                       01145001
011460                      DELIMITED BY SIZE                           01146001
011470                                      INTO RC074-CRA-RET-MSG      01147001
011480             STRING   ' RCKUT128-3010-'                           01148001
011490                      ' CALLED BY-'                               01149001
011500                      RC074-CALLING-PROGRAM                       01150001
011510                      DELIMITED BY SIZE                           01151001
011520                                      INTO RC074-ABEND-TEXT       01152001
011530             MOVE '3010-'               TO RC074-CRA-REQ-ID       01153001
011540                                           RC074-ABEND-PARAGRAPH  01154001
011550             PERFORM 9998-RETURN                                  01155001
011560                                                                  01156001
011570         WHEN SQLWARN0 NOT = SPACES                               01157001
011580         WHEN SQLCODE < ZERO                                      01158001
011590         WHEN SQLCODE > ZERO                                      01159001
011600              SET  RC074-INVALID-SQL                              01160001
011610                   RC074-ERROR-YES                                01161001
011620                   PS-ERROR-YES         TO  TRUE                  01162001
011630              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01163001
011640              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01164001
011650              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01165001
011660              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01166001
011670              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01167001
011680              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01168001
011690              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01169001
011700             STRING   ' RCKUT128-3010-'                           01170001
011710                      ' CALLED BY-'                               01171001
011720                      RC074-CALLING-PROGRAM                       01172001
011730                      ' PO='                                      01173001
011740                      RC074-DISPLAY-PO                            01174001
011750                      ' RCVR='                                    01175001
011760                      RC074-DISPLAY-RCVR                          01176001
011770                      ' SQLCODE='                                 01177001
011780                      RC074-DISPLAY-SQLCODE                       01178001
011790                      DELIMITED BY SIZE                           01179001
011800                                      INTO RC074-CRA-RET-MSG      01180001
011810             STRING   ' RCKUT128-3010-'                           01181001
011820                      ' CALLED BY-'                               01182001
011830                      RC074-CALLING-PROGRAM                       01183001
011840                      DELIMITED BY SIZE                           01184001
011850                                      INTO RC074-ABEND-TEXT       01185001
011860             MOVE '3010-'               TO RC074-CRA-REQ-ID       01186001
011870                                           RC074-ABEND-PARAGRAPH  01187001
011880             PERFORM 9998-RETURN                                  01188001
011890                                                                  01189001
011900     END-EVALUATE.                                                01190001
011910                                                                  01191001
011920                                                                  01192001
011930*----------------------------------------------------------------*01193001
011940*    FETCH RECEIVER LINE CURSOR                                  *01194001
011950*----------------------------------------------------------------*01195001
011960 3020-FETCH-RCVR-LNE-CSR.                                         01196001
011970                                                                  01197001
011980     EXEC SQL                                                     01198001
011990          FETCH PO_RCVR_LINE_CSR                                  01199001
012000           INTO :RECITM-ORD-LNE-NBR                               01200001
012010               ,:RECITM-STATUS-CDE                                01201001
012020     END-EXEC.                                                    01202001
012030                                                                  01203001
012040     EVALUATE TRUE                                                01204001
012050         WHEN SQLCODE = ZERO                                      01205001
012060              MOVE  RECITM-ORD-LNE-NBR  TO  DK-LINE-NBR           01206001
012070                                            RC074-LINE-NBR        01207001
012080              MOVE  RECITM-STATUS-CDE   TO  PV-LINE-STATUS        01208001
012090                                                                  01209001
012100         WHEN SQLCODE = +100                                      01210001
012110              SET  PS-PO-RCVR-LINE-CSR-END  TO  TRUE              01211001
012120                                                                  01212001
012130         WHEN SQLCODE = -904                                      01213001
012140         WHEN SQLCODE = -911                                      01214001
012150         WHEN SQLCODE = -913                                      01215001
012160              SET  RC074-DATABASE-BUSY                            01216001
012170                   RC074-ERROR-YES                                01217001
012180                   PS-ERROR-YES         TO  TRUE                  01218001
012190              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01219001
012200              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01220001
012210              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01221001
012220              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01222001
012230              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01223001
012240              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01224001
012250              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01225001
012260             STRING   ' RCKUT128-3020-'                           01226001
012270                      ' CALLED BY-'                               01227001
012280                      RC074-CALLING-PROGRAM                       01228001
012290                      ' PO='                                      01229001
012300                      RC074-DISPLAY-PO                            01230001
012310                      ' RCVR='                                    01231001
012320                      RC074-DISPLAY-RCVR                          01232001
012330                      ' SQLCODE='                                 01233001
012340                      RC074-DISPLAY-SQLCODE                       01234001
012350                      DELIMITED BY SIZE                           01235001
012360                                      INTO RC074-CRA-RET-MSG      01236001
012370             STRING   ' RCKUT128-3020-'                           01237001
012380                      ' CALLED BY-'                               01238001
012390                      RC074-CALLING-PROGRAM                       01239001
012400                      DELIMITED BY SIZE                           01240001
012410                                      INTO RC074-ABEND-TEXT       01241001
012420             MOVE '3020-'               TO RC074-CRA-REQ-ID       01242001
012430                                           RC074-ABEND-PARAGRAPH  01243001
012440             PERFORM 9998-RETURN                                  01244001
012450                                                                  01245001
012460         WHEN SQLWARN0 NOT = SPACE                                01246001
012470         WHEN SQLCODE NOT = ZERO                                  01247001
012480              SET  RC074-INVALID-SQL                              01248001
012490                   RC074-ERROR-YES                                01249001
012500                   PS-ERROR-YES         TO  TRUE                  01250001
012510              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01251001
012520              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01252001
012530              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01253001
012540              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01254001
012550              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01255001
012560              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01256001
012570              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01257001
012580             STRING   ' RCKUT128-3020-'                           01258001
012590                      ' CALLED BY-'                               01259001
012600                      RC074-CALLING-PROGRAM                       01260001
012610                      ' PO='                                      01261001
012620                      RC074-DISPLAY-PO                            01262001
012630                      ' RCVR='                                    01263001
012640                      RC074-DISPLAY-RCVR                          01264001
012650                      ' SQLCODE='                                 01265001
012660                      RC074-DISPLAY-SQLCODE                       01266001
012670                      DELIMITED BY SIZE                           01267001
012680                                      INTO RC074-CRA-RET-MSG      01268001
012690             STRING   ' RCKUT128-3020-'                           01269001
012700                      ' CALLED BY-'                               01270001
012710                      RC074-CALLING-PROGRAM                       01271001
012720                      DELIMITED BY SIZE                           01272001
012730                                      INTO RC074-ABEND-TEXT       01273001
012740             MOVE '3020-'               TO RC074-CRA-REQ-ID       01274001
012750                                           RC074-ABEND-PARAGRAPH  01275001
012760             PERFORM 9998-RETURN                                  01276001
012770                                                                  01277001
012780     END-EVALUATE.                                                01278001
012790                                                                  01279001
012800*----------------------------------------------------------------*01280001
012810* CLOSE RECEIVER LINE CURSOR                                     *01281001
012820*----------------------------------------------------------------*01282001
012830 3030-CLOSE-RCVR-LNE-CSR.                                         01283001
012840                                                                  01284001
012850     EXEC SQL                                                     01285001
012860          CLOSE PO_RCVR_LINE_CSR                                  01286001
012870     END-EXEC.                                                    01287001
012880                                                                  01288001
012890     EVALUATE TRUE                                                01289001
012900         WHEN SQLCODE = ZERO                                      01290001
012910             CONTINUE                                             01291001
012920         WHEN SQLCODE = -904                                      01292001
012930         WHEN SQLCODE = -911                                      01293001
012940         WHEN SQLCODE = -913                                      01294001
012950              SET  RC074-DATABASE-BUSY                            01295001
012960                   RC074-ERROR-YES                                01296001
012970                   PS-ERROR-YES         TO  TRUE                  01297001
012980              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01298001
012990              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01299001
013000              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01300001
013010              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01301001
013020              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01302001
013030              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01303001
013040              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01304001
013050             STRING   ' RCKUT128-3030-'                           01305001
013060                      ' CALLED BY-'                               01306001
013070                      RC074-CALLING-PROGRAM                       01307001
013080                      ' PO='                                      01308001
013090                      RC074-DISPLAY-PO                            01309001
013100                      ' RCVR='                                    01310001
013110                      RC074-DISPLAY-RCVR                          01311001
013120                      ' SQLCODE='                                 01312001
013130                      RC074-DISPLAY-SQLCODE                       01313001
013140                      DELIMITED BY SIZE                           01314001
013150                                      INTO RC074-CRA-RET-MSG      01315001
013160             STRING   ' RCKUT128-3030-'                           01316001
013170                      ' CALLED BY-'                               01317001
013180                      RC074-CALLING-PROGRAM                       01318001
013190                      DELIMITED BY SIZE                           01319001
013200                                      INTO RC074-ABEND-TEXT       01320001
013210             MOVE '3030-'               TO RC074-CRA-REQ-ID       01321001
013220                                           RC074-ABEND-PARAGRAPH  01322001
013230             PERFORM 9998-RETURN                                  01323001
013240                                                                  01324001
013250         WHEN SQLWARN0 NOT = SPACES                               01325001
013260         WHEN SQLCODE < ZERO                                      01326001
013270         WHEN SQLCODE > ZERO                                      01327001
013280              SET  RC074-INVALID-SQL                              01328001
013290                   RC074-ERROR-YES                                01329001
013300                   PS-ERROR-YES         TO  TRUE                  01330001
013310              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01331001
013320              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01332001
013330              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01333001
013340              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01334001
013350              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01335001
013360              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01336001
013370              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01337001
013380             STRING   ' RCKUT128-3030-'                           01338001
013390                      ' CALLED BY-'                               01339001
013400                      RC074-CALLING-PROGRAM                       01340001
013410                      ' PO='                                      01341001
013420                      RC074-DISPLAY-PO                            01342001
013430                      ' RCVR='                                    01343001
013440                      RC074-DISPLAY-RCVR                          01344001
013450                      ' SQLCODE='                                 01345001
013460                      RC074-DISPLAY-SQLCODE                       01346001
013470                      DELIMITED BY SIZE                           01347001
013480                                      INTO RC074-CRA-RET-MSG      01348001
013490             STRING   ' RCKUT128-3030-'                           01349001
013500                      ' CALLED BY-'                               01350001
013510                      RC074-CALLING-PROGRAM                       01351001
013520                      DELIMITED BY SIZE                           01352001
013530                                      INTO RC074-ABEND-TEXT       01353001
013540             MOVE '3030-'               TO RC074-CRA-REQ-ID       01354001
013550                                           RC074-ABEND-PARAGRAPH  01355001
013560             PERFORM 9998-RETURN                                  01356001
013570                                                                  01357001
013580     END-EVALUATE.                                                01358001
013590                                                                  01359001
013600                                                                  01360001
013610*----------------------------------------------------------------*01361001
013620* PROCESS EACH LINE RETRIEVED FROM CURSOR                        *01362001
013630*----------------------------------------------------------------*01363001
013640 3100-PROCESS-LINES.                                              01364001
013650                                                                  01365001
013660     IF  PV-LINE-VERIFIED                                         01366001
013670         MOVE RECITM-ORD-LNE-NBR  TO DK-LINE-NBR                  01367001
013680         PERFORM 8010-VERIFIED-LINE-QTY                           01368001
013690         PERFORM 8012-VERIFIED-LINE-QTY                           01369001
013700         PERFORM 8014-VERIFIED-LINE-QTY-ORIG                      01370001
013710         MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY        01371004
013720         ADD PV-ORIG-EXPTED-ITM-QTY    TO RC074-INVCED-ITM-QTY    01372004
013730         ADD  RC074-VERIFY-ITM-QTY                                01373001
013740          TO  PV-VERIFY-ITM-QTY                                   01374001
013750         ADD  RC074-FCSE-ACTL-ITM-QTY                             01375001
013760          TO  PV-FCSE-ACTL-ITM-QTY                                01376001
013770         ADD  RC074-INVCED-ITM-QTY                                01377004
013780          TO  PV-INVCED-ITM-QTY                                   01378004
013790         ADD  RC074-EXPTED-ITM-QTY                                01379004
013800          TO  PV-EXPTED-ITM-QTY                                   01380004
013810         ADD  RC074-P2L-ACTL-ITM-QTY                              01381001
013820          TO  PV-P2L-ACTL-ITM-QTY                                 01382001
013830         ADD  RC074-FCSE-ACTL-ITM-QTY                             01383001
013840              RC074-P2L-ACTL-ITM-QTY                              01384001
013850          TO  PV-TOTAL-ACTL-ITM-QTY                               01385001
013860     ELSE                                                         01386001
013870         MOVE RECITM-ORD-LNE-NBR  TO DK-LINE-NBR                  01387001
013880         PERFORM 8020-LINE-EXPTD-VRFD-QTY                         01388001
013890         PERFORM 8025-LINE-EXPTD-VRFD-QTY                         01389001
013900         PERFORM 8028-LINE-EXPTD-VRFD-QTY-ORIG                    01390001
013910         MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY        01391004
013920         ADD PV-ORIG-EXPTED-ITM-QTY     TO RC074-INVCED-ITM-QTY   01392004
013930         IF  PS-ERROR-NO                                          01393001
013940             PERFORM 8050-SUM-LINE-OTBND-UPC                      01394001
013950         END-IF                                                   01395001
013960         IF  PS-ERROR-NO                                          01396001
013970             PERFORM 8070-SUM-LINE-P2L-ACTL                       01397001
013980         END-IF                                                   01398001
013990         ADD  RC074-FCSE-ACTL-ITM-QTY                             01399001
014000          TO  PV-FCSE-ACTL-ITM-QTY                                01400001
014010         ADD  RC074-INVCED-ITM-QTY                                01401004
014020          TO  PV-INVCED-ITM-QTY                                   01402004
014030         ADD  RC074-EXPTED-ITM-QTY                                01403004
014040          TO  PV-EXPTED-ITM-QTY                                   01404004
014050         ADD  RC074-VERIFY-ITM-QTY                                01405001
014060          TO  PV-VERIFY-ITM-QTY                                   01406001
014070         ADD  RC074-P2L-ACTL-ITM-QTY                              01407001
014080          TO  PV-P2L-ACTL-ITM-QTY                                 01408001
014090         ADD  RC074-FCSE-ACTL-ITM-QTY                             01409001
014100              RC074-P2L-ACTL-ITM-QTY                              01410001
014110          TO  PV-TOTAL-ACTL-ITM-QTY                               01411001
014120     END-IF.                                                      01412001
014130                                                                  01413001
014140     PERFORM 3020-FETCH-RCVR-LNE-CSR.                             01414001
014150                                                                  01415001
014160*----------------------------------------------------------------*01416001
014170*                                                                *01417001
014180*----------------------------------------------------------------*01418001
014190 4000-PACK-QTY-PROCESS.                                           01419001
014200                                                                  01420001
014210     MOVE RC074-OPER-UNT-ID    TO  DK-OPER-UNT-ID.                01421001
014220     MOVE RC074-FCLTY-ID       TO  DK-FCLTY-ID.                   01422001
014230     MOVE RC074-PO-NBR         TO  DK-PO-NBR.                     01423001
014240     MOVE RC074-RCVR-SEQ-NBR   TO  DK-RCVR-SEQ-NBR.               01424001
014250     MOVE RC074-LINE-NBR       TO  DK-LINE-NBR.                   01425001
014260     MOVE RC074-PACK-ID        TO  DK-PACK-ID.                    01426001
014270     MOVE RC074-STR-NBR        TO  DK-STR-NBR.                    01427001
014280     MOVE RC074-SHIPT-UNT-ID   TO  DK-SHIPT-UNT-ID.               01428001
014290                                                                  01429001
014300     MOVE ZEROES               TO  RC074-INVCED-ITM-QTY           01430004
014310                                   RC074-EXPTED-ITM-QTY           01431004
014320                                   RC074-FCSE-ACTL-ITM-QTY        01432001
014330                                   RC074-P2L-ACTL-ITM-QTY         01433001
014340                                   RC074-TOTAL-ACTL-ITM-QTY       01434001
014350                                   RC074-VERIFY-ITM-QTY           01435001
014360                                   RC074-FCSE-INVC-PACK-QTY       01436004
014370                                   RC074-FCSE-EXPT-PACK-QTY       01437004
014380                                   RC074-P2L-INVC-PACK-QTY        01438004
014390                                   RC074-P2L-EXPT-PACK-QTY        01439004
014400                                   RC074-TOTAL-INVC-PACK-QTY      01440004
014410                                   RC074-TOTAL-EXPT-PACK-QTY      01441004
014420                                   RC074-FCSE-ACTL-PACK-QTY       01442001
014430                                   RC074-P2L-ACTL-PACK-QTY        01443001
014440                                   RC074-TOTAL-ACTL-PACK-QTY      01444001
014450                                   RC074-VERIFY-PACK-QTY          01445001
014460                                   RC074-ACTUAL-ODD-QTY           01446001
014470                                   RC074-VERIFY-ODD-QTY.          01447001
014480                                                                  01448001
014490     EVALUATE TRUE                                                01449001
014500         WHEN  PS-BY-PO-RCVR-PACK                                 01450001
014510               IF  PV-RCVR-VERIFIED  OR                           01451001
014520                   PV-LINE-VERIFIED                               01452001
014530                   PERFORM 4100-CALCULATE-PACK-COUNTS-VE          01453001
014540               ELSE                                               01454001
014550                   PERFORM 4200-CALCULATE-PACK-COUNTS             01455001
014560               END-IF                                             01456001
014570                                                                  01457001
014580         WHEN  PS-BY-PO-RCVR-PACK-STR                             01458001
014590               IF  PV-RCVR-VERIFIED  OR                           01459001
014600                   PV-LINE-VERIFIED                               01460001
014610                   PERFORM 4300-CALC-PACK-STORE-COUNTS-VE         01461001
014620               ELSE                                               01462001
014630                   PERFORM 4400-CALC-PACK-STORE-COUNTS            01463001
014640               END-IF                                             01464001
014650                                                                  01465001
014660         WHEN  PS-BY-PO-RCVR-PACK-STR-LNE                         01466001
014670               IF  PV-RCVR-VERIFIED  OR                           01467001
014680                   PV-LINE-VERIFIED                               01468001
014690                   PERFORM 4500-CALC-PACK-LIN-STR-CNTS-VE         01469001
014700               ELSE                                               01470001
014710                   PERFORM 4600-CALC-PACK-LINE-STR-COUNTS         01471001
014720               END-IF                                             01472001
014730                                                                  01473001
014740         WHEN  PS-BY-PO-RCVR-PACK-LNE                             01474001
014750               IF  PV-RCVR-VERIFIED  OR                           01475001
014760                   PV-LINE-VERIFIED                               01476001
014770                   PERFORM 4700-CALC-PACK-LIN-CNTS-VE             01477001
014780               ELSE                                               01478001
014790                   PERFORM 4800-CALC-PACK-STR-COUNTS              01479001
014800               END-IF                                             01480001
014810                                                                  01481001
014820                                                                  01482001
014830         WHEN  PS-BY-PO-RCVR                                      01483001
014840               PERFORM 4900-CALCULATE-PO-RCVR                     01484001
014850                                                                  01485001
014860     END-EVALUATE.                                                01486001
014870                                                                  01487001
014880                                                                  01488001
014890 4100-CALCULATE-PACK-COUNTS-VE.                                   01489001
014900     PERFORM 4110-SUM-TRECDIS.                                    01490001
014910     PERFORM 4115-SUM-TRECDIS.                                    01491001
014920     PERFORM 4118-SUM-TRECDIS-ORIG.                               01492001
014930     MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY.           01493004
014940     ADD PV-ORIG-EXPTED-ITM-QTY TO RC074-INVCED-ITM-QTY.          01494004
014950     PERFORM 4120-SELECT-DRIVER-RATIO.                            01495001
014960     MOVE RECITM-ORD-LNE-NBR TO DK-PO-DRIVER-LNE.                 01496001
014970     PERFORM 4130-SUM-TRECDIS-DRIVER.                             01497001
014980     PERFORM 4135-SUM-TRECDIS-DRIVER.                             01498001
014990     PERFORM 4138-SUM-TRECDIS-DRIVER-ORIG.                        01499001
015000     MOVE PV-LNE-INVCED-ITM-QTY  TO PV-LNE-EXPTED-ITM-QTY.        01500004
015010     ADD PV-LNE-EXPTED-ORIG-ITM-QTY TO PV-LNE-INVCED-ITM-QTY.     01501004
015020     PERFORM 4140-SELECT-ODD-UNITS.                               01502001
015030                                                                  01503001
015040     PERFORM 4150-SELECT-ODD-UNITS-PACK.                          01504001
015050                                                                  01505001
015060     IF RECITM-VRFD-USR-ID = 'P2L/CASE'                           01506001
015070         PERFORM 4160-PROCESS-TRECDVS                             01507001
015080     ELSE                                                         01508001
015090         IF RECITM-PREPK-RATO-QTY > 0                             01509001
015100             IF RECITM-VRFD-USR-ID = 'P2L'                        01510001
015110                 COMPUTE RC074-P2L-INVC-PACK-QTY =                01511004
015120                   PV-LNE-INVCED-ITM-QTY  / RECITM-PREPK-RATO-QTY 01512004
015130                 ADD RC074-P2L-INVC-PACK-QTY TO                   01513004
015140                            RC074-TOTAL-INVC-PACK-QTY             01514004
015150                 COMPUTE RC074-P2L-EXPT-PACK-QTY =                01515004
015160                  PV-LNE-EXPTED-ITM-QTY /    RECITM-PREPK-RATO-QTY01516004
015170                 ADD RC074-P2L-EXPT-PACK-QTY     TO               01517004
015180                            RC074-TOTAL-EXPT-PACK-QTY             01518004
015190                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                01519001
015200                    (PV-LNE-VERIFY-ITM-QTY                        01520001
015210                           - PV-ODD-DC-VERIFY-ODU-PK-QTY)         01521001
015220                                          / RECITM-PREPK-RATO-QTY 01522001
015230                 ADD RC074-P2L-ACTL-PACK-QTY TO                   01523001
015240                            RC074-TOTAL-ACTL-PACK-QTY             01524001
015250             ELSE                                                 01525001
015260                                                                  01526001
015270                 COMPUTE RC074-FCSE-INVC-PACK-QTY =               01527004
015280                     PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY01528004
015290                 MOVE RC074-FCSE-INVC-PACK-QTY TO                 01529004
015300                      RC074-TOTAL-INVC-PACK-QTY                   01530004
015310                 COMPUTE RC074-FCSE-EXPT-PACK-QTY =               01531004
015320                     PV-LNE-EXPTED-ITM-QTY                        01532004
015330                                           / RECITM-PREPK-RATO-QTY01533001
015340                 MOVE RC074-FCSE-EXPT-PACK-QTY TO                 01534004
015350                      RC074-TOTAL-EXPT-PACK-QTY                   01535004
015360                 COMPUTE RC074-FCSE-ACTL-PACK-QTY =               01536001
015370                    (PV-LNE-VERIFY-ITM-QTY                        01537001
015380                             - PV-ODD-DC-VERIFY-ODU-PK-QTY)       01538001
015390                                           / RECITM-PREPK-RATO-QTY01539001
015400                 MOVE RC074-FCSE-ACTL-PACK-QTY                    01540001
015410                                TO RC074-TOTAL-ACTL-PACK-QTY      01541001
015420             END-IF                                               01542001
015430                                                                  01543001
015440             IF PV-LNE-AP-VERIFY-ITM-QTY > 0                      01544001
015450                 COMPUTE RC074-VERIFY-PACK-QTY =                  01545001
015460                    (PV-LNE-AP-VERIFY-ITM-QTY                     01546001
015470                           - PV-ODD-AP-VERIFY-ODU-PK-QTY)         01547001
015480                                         / RECITM-PREPK-RATO-QTY  01548001
015490             ELSE                                                 01549001
015500                 MOVE 0                TO RC074-VERIFY-PACK-QTY   01550001
015510             END-IF                                               01551001
015520     END-IF.                                                      01552001
015530                                                                  01553001
015540                                                                  01554001
015550 4110-SUM-TRECDIS.                                                01555001
015560                                                                  01556001
015570     MOVE ZERO                 TO RC074-VERIFY-ITM-QTY            01557001
015580                                  RC074-FCSE-ACTL-ITM-QTY         01558001
015590                                  RC074-TOTAL-ACTL-ITM-QTY.       01559001
015600                                                                  01560001
015610     EXEC SQL                                                     01561001
015620          SELECT SUM(A.VERIFY_ITM_QTY)                            01562001
015630              ,  SUM(A.AP_VERIFY_ITM_QTY)                         01563001
015640          INTO  :RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          01564001
015650              , :RC074-VERIFY-ITM-QTY    :RC074-NULL-IND          01565001
015660          FROM                                                    01566001
015670                 TRECDIS A                                        01567001
015680              ,  TRECITM  B                                       01568001
015690          WHERE                                                   01569001
015700                A.ORD_NBR          =  :DK-PO-NBR                  01570001
015710           AND  A.ORD_NBR          =  B.ORD_NBR                   01571001
015720           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            01572001
015730           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               01573001
015740           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               01574001
015760           AND  B.VER_STATUS_CDE   =  'A'                         01576001
015770           AND  B.PREPK_ID         = :DK-PACK-ID                  01577001
015780                                                                  01578001
015790     END-EXEC.                                                    01579001
015800                                                                  01580001
015810     EVALUATE TRUE                                                01581001
015820         WHEN SQLCODE = ZERO                                      01582001
015830              MOVE  RC074-FCSE-ACTL-ITM-QTY                       01583001
015840                TO  RC074-TOTAL-ACTL-ITM-QTY                      01584001
015850         WHEN SQLCODE = +100                                      01585001
015860         WHEN SQLCODE = -305                                      01586001
015870              CONTINUE                                            01587001
015880         WHEN SQLWARN0 NOT = SPACE                                01588001
015890         WHEN SQLCODE NOT = ZERO                                  01589001
015900                                                                  01590001
015910              SET  RC074-INVALID-SQL                              01591001
015920                   RC074-ERROR-YES                                01592001
015930                   PS-ERROR-YES         TO  TRUE                  01593001
015940              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01594001
015950              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01595001
015960              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01596001
015970              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01597001
015980              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01598001
015990              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01599001
016000              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01600001
016010              STRING  ' RCKUT128-4110-'                           01601001
016020                      ' CALLED BY-'                               01602001
016030                      RC074-CALLING-PROGRAM                       01603001
016040                      ' PO='                                      01604001
016050                      RC074-DISPLAY-PO                            01605001
016060                      ' RCVR='                                    01606001
016070                      RC074-DISPLAY-RCVR                          01607001
016080                      ' SQLCODE='                                 01608001
016090                      RC074-DISPLAY-SQLCODE                       01609001
016100                      DELIMITED BY SIZE                           01610001
016110                                      INTO RC074-CRA-RET-MSG      01611001
016120              STRING  ' RCKUT128-4110-'                           01612001
016130                      ' CALLED BY-'                               01613001
016140                      RC074-CALLING-PROGRAM                       01614001
016150                      DELIMITED BY SIZE                           01615001
016160                                      INTO RC074-ABEND-TEXT       01616001
016170              MOVE '4110-'              TO RC074-CRA-REQ-ID       01617001
016180                                           RC074-ABEND-PARAGRAPH  01618001
016190              PERFORM 9998-RETURN                                 01619001
016200     END-EVALUATE.                                                01620001
016210                                                                  01621001
016220 4115-SUM-TRECDIS.                                                01622001
016230                                                                  01623001
016240     MOVE ZERO                 TO RC074-INVCED-ITM-QTY.           01624004
016250                                                                  01625001
016260     EXEC SQL                                                     01626001
016270          SELECT SUM(A.EXPTED_ITM_QTY)                            01627001
016280          INTO  :RC074-INVCED-ITM-QTY    :RC074-NULL-IND          01628004
016290          FROM                                                    01629001
016300                 TRECDIS A                                        01630001
016310              ,  TRECITM  B                                       01631001
016320          WHERE                                                   01632001
016330                A.ORD_NBR          =  :DK-PO-NBR                  01633001
016340           AND  A.ORD_NBR          =  B.ORD_NBR                   01634001
016350           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            01635001
016360           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               01636001
016370           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               01637001
016390           AND  B.VER_STATUS_CDE   =  'A'                         01639001
016400           AND  B.PREPK_ID         = :DK-PACK-ID                  01640001
016410           AND NOT EXISTS                                         01641001
016420               (SELECT *                                          01642001
016430                FROM RCT_RECDIS_ORIG C                            01643001
016440         WHERE  A.ORD_NBR          = C.ORD_NBR                    01644001
016450           AND  A.REC_SEQ_NBR      = C.REC_SEQ_NBR                01645001
016460           AND  A.ORD_LNE_NBR      = C.ORD_LNE_NBR                01646001
016470           AND  A.STR_NBR          = C.STR_NBR)                   01647001
016480     END-EXEC.                                                    01648001
016490                                                                  01649001
016500     EVALUATE TRUE                                                01650001
016510         WHEN SQLCODE = ZERO                                      01651001
016520              CONTINUE                                            01652001
016530         WHEN SQLCODE = +100                                      01653001
016540         WHEN SQLCODE = -305                                      01654001
016550              CONTINUE                                            01655001
016560         WHEN SQLWARN0 NOT = SPACE                                01656001
016570         WHEN SQLCODE NOT = ZERO                                  01657001
016580                                                                  01658001
016590              SET  RC074-INVALID-SQL                              01659001
016600                   RC074-ERROR-YES                                01660001
016610                   PS-ERROR-YES         TO  TRUE                  01661001
016620              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01662001
016630              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01663001
016640              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01664001
016650              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01665001
016660              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01666001
016670              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01667001
016680              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01668001
016690              STRING  ' RCKUT128-4115-'                           01669001
016700                      ' CALLED BY-'                               01670001
016710                      RC074-CALLING-PROGRAM                       01671001
016720                      ' PO='                                      01672001
016730                      RC074-DISPLAY-PO                            01673001
016740                      ' RCVR='                                    01674001
016750                      RC074-DISPLAY-RCVR                          01675001
016760                      ' SQLCODE='                                 01676001
016770                      RC074-DISPLAY-SQLCODE                       01677001
016780                      DELIMITED BY SIZE                           01678001
016790                                      INTO RC074-CRA-RET-MSG      01679001
016800              STRING  ' RCKUT128-4115-'                           01680001
016810                      ' CALLED BY-'                               01681001
016820                      RC074-CALLING-PROGRAM                       01682001
016830                      DELIMITED BY SIZE                           01683001
016840                                      INTO RC074-ABEND-TEXT       01684001
016850              MOVE '4115-'              TO RC074-CRA-REQ-ID       01685001
016860                                           RC074-ABEND-PARAGRAPH  01686001
016870              PERFORM 9998-RETURN                                 01687001
016880     END-EVALUATE.                                                01688001
016890                                                                  01689001
016900 4118-SUM-TRECDIS-ORIG.                                           01690001
016910                                                                  01691001
016920     MOVE ZERO                 TO PV-ORIG-EXPTED-ITM-QTY.         01692001
016930                                                                  01693001
016940     EXEC SQL                                                     01694001
016950          SELECT SUM(A.ORIG_EXPTED_QTY)                           01695001
016960          INTO  :PV-ORIG-EXPTED-ITM-QTY    :RC074-NULL-IND        01696001
016970          FROM                                                    01697001
016980                 RCT_RECDIS_ORIG A                                01698001
016990              ,  TRECITM  B                                       01699001
017000          WHERE                                                   01700001
017010                A.ORD_NBR          =  :DK-PO-NBR                  01701001
017020           AND  A.ORD_NBR          =  B.ORD_NBR                   01702001
017030           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            01703001
017040           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               01704001
017050           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               01705001
017060           AND  B.PREPK_ID         = :DK-PACK-ID                  01706001
017070     END-EXEC.                                                    01707001
017080                                                                  01708001
017090     EVALUATE TRUE                                                01709001
017100         WHEN SQLCODE = ZERO                                      01710001
017110              CONTINUE                                            01711001
017120         WHEN SQLCODE = +100                                      01712001
017130         WHEN SQLCODE = -305                                      01713001
017140              CONTINUE                                            01714001
017150         WHEN SQLWARN0 NOT = SPACE                                01715001
017160         WHEN SQLCODE NOT = ZERO                                  01716001
017170                                                                  01717001
017180              SET  RC074-INVALID-SQL                              01718001
017190                   RC074-ERROR-YES                                01719001
017200                   PS-ERROR-YES         TO  TRUE                  01720001
017210              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01721001
017220              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01722001
017230              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01723001
017240              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01724001
017250              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01725001
017260              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01726001
017270              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01727001
017280              STRING  ' RCKUT128-4118-'                           01728001
017290                      ' CALLED BY-'                               01729001
017300                      RC074-CALLING-PROGRAM                       01730001
017310                      ' PO='                                      01731001
017320                      RC074-DISPLAY-PO                            01732001
017330                      ' RCVR='                                    01733001
017340                      RC074-DISPLAY-RCVR                          01734001
017350                      ' SQLCODE='                                 01735001
017360                      RC074-DISPLAY-SQLCODE                       01736001
017370                      DELIMITED BY SIZE                           01737001
017380                                      INTO RC074-CRA-RET-MSG      01738001
017390              STRING  ' RCKUT128-4118-'                           01739001
017400                      ' CALLED BY-'                               01740001
017410                      RC074-CALLING-PROGRAM                       01741001
017420                      DELIMITED BY SIZE                           01742001
017430                                      INTO RC074-ABEND-TEXT       01743001
017440              MOVE '4118-'              TO RC074-CRA-REQ-ID       01744001
017450                                           RC074-ABEND-PARAGRAPH  01745001
017460              PERFORM 9998-RETURN                                 01746001
017470     END-EVALUATE.                                                01747001
017480                                                                  01748001
017490 4120-SELECT-DRIVER-RATIO.                                        01749001
017500                                                                  01750001
017510     EXEC SQL                                                     01751001
017520          SELECT                                                  01752001
017530                B.ORD_LNE_NBR                                     01753001
017540             ,  B.PREPK_RATO_QTY                                  01754001
017550             ,  B.VRFD_USR_ID                                     01755001
017560             ,  D.PK_SKU_NBR                                      01756001
017570             ,  C.CL_NBR                                          01757001
017580          INTO                                                    01758001
017590                :RECITM-ORD-LNE-NBR                               01759001
017600             ,  :RECITM-PREPK-RATO-QTY                            01760001
017610             ,  :RECITM-VRFD-USR-ID                               01761001
017620             ,  :POPRPK-PK-SKU-NBR                                01762001
017630             ,  :PURITM-CL-NBR                                    01763001
017640          FROM    TRECEIV  A                                      01764001
017650              ,   TRECITM  B                                      01765001
017660              ,   TPURITM  C                                      01766001
017670              ,   TPOPRPK  D                                      01767001
017680          WHERE A.ORD_NBR          =  :DK-PO-NBR                  01768001
017690           AND  A.ORD_NBR          =  B.ORD_NBR                   01769001
017700           AND  A.ORD_NBR          =  C.PO_NBR                    01770001
017710           AND  A.ORD_NBR          =  D.PO_NBR                    01771001
017720           AND  A.VER_STATUS_CDE   =  'A'                         01772001
017730           AND  B.VER_STATUS_CDE   =  'A'                         01773001
017740           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               01774001
017750           AND  A.FCLTY_ID         =  B.FCLTY_ID                  01775001
017760           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            01776001
017770           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               01777001
017780           AND  B.ORD_LNE_NBR      =  C.APP_PO_LNE_NBR            01778001
017790           AND  B.PO_VER_NBR       =  C.VER_NBR                   01779001
017800           AND  B.PREPK_DRV_LNE_CDE = 'A'                         01780001
017810           AND  B.PREPK_ID         = :DK-PACK-ID                  01781001
017820           AND  B.PREPK_ID         =  D.PO_PREPK_ID               01782001
017830     END-EXEC.                                                    01783001
017840                                                                  01784001
017850     EVALUATE TRUE                                                01785001
017860         WHEN SQLCODE = ZERO                                      01786001
017870             CONTINUE                                             01787001
017880         WHEN SQLCODE = +100                                      01788001
017890             SET PS-NO-DRIVER-INFO TO TRUE                        01789001
017900         WHEN SQLWARN0 NOT = SPACES                               01790001
017910         WHEN SQLCODE < ZERO                                      01791001
017920         WHEN SQLCODE > ZERO                                      01792001
017930              SET  RC074-INVALID-SQL                              01793001
017940                   RC074-ERROR-YES                                01794001
017950                   PS-ERROR-YES         TO  TRUE                  01795001
017960              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01796001
017970              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01797001
017980              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01798001
017990              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01799001
018000              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01800001
018010              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01801001
018020              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01802001
018030              STRING  ' RCKUT128-4120-'                           01803001
018040                      ' CALLED BY-'                               01804001
018050                      RC074-CALLING-PROGRAM                       01805001
018060                      ' PO='                                      01806001
018070                      RC074-DISPLAY-PO                            01807001
018080                      ' RCVR='                                    01808001
018090                      RC074-DISPLAY-RCVR                          01809001
018100                      ' SQLCODE='                                 01810001
018110                      RC074-DISPLAY-SQLCODE                       01811001
018120                      DELIMITED BY SIZE                           01812001
018130                                      INTO RC074-CRA-RET-MSG      01813001
018140              STRING  ' RCKUT128-4120-'                           01814001
018150                      ' CALLED BY-'                               01815001
018160                      RC074-CALLING-PROGRAM                       01816001
018170                      DELIMITED BY SIZE                           01817001
018180                                      INTO RC074-ABEND-TEXT       01818001
018190              MOVE '4120-'              TO RC074-CRA-REQ-ID       01819001
018200                                           RC074-ABEND-PARAGRAPH  01820001
018210              PERFORM 9998-RETURN                                 01821001
018220     END-EVALUATE.                                                01822001
018230                                                                  01823001
018240 4130-SUM-TRECDIS-DRIVER.                                         01824001
018250                                                                  01825001
018260     MOVE ZERO                 TO  PV-LNE-AP-VERIFY-ITM-QTY.      01826001
018270     MOVE ZERO                 TO  PV-LNE-VERIFY-ITM-QTY.         01827001
018280                                                                  01828001
018290     EXEC SQL                                                     01829001
018300          SELECT                                                  01830001
018310                 SUM(AP_VERIFY_ITM_QTY)                           01831001
018320                ,SUM(VERIFY_ITM_QTY)                              01832001
018330          INTO                                                    01833001
018340                :PV-LNE-AP-VERIFY-ITM-QTY :PV-NULL-IND            01834001
018350               ,:PV-LNE-VERIFY-ITM-QTY :PV-NULL-IND               01835001
018360          FROM                                                    01836001
018370                 TRECDIS                                          01837001
018380          WHERE                                                   01838001
018390                ORD_NBR          =  :DK-PO-NBR                    01839001
018400           AND  ORD_LNE_NBR      =  :RECITM-ORD-LNE-NBR           01840001
018410           AND  REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR              01841001
018430     END-EXEC.                                                    01843001
018440                                                                  01844001
018450     EVALUATE TRUE                                                01845001
018460         WHEN SQLCODE = ZERO                                      01846001
018470         WHEN SQLCODE = +100                                      01847001
018480         WHEN SQLCODE = -305                                      01848001
018490              CONTINUE                                            01849001
018500         WHEN SQLWARN0 NOT = SPACE                                01850001
018510         WHEN SQLCODE NOT = ZERO                                  01851001
018520              SET  RC074-INVALID-SQL                              01852001
018530                   RC074-ERROR-YES                                01853001
018540                   PS-ERROR-YES         TO  TRUE                  01854001
018550              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01855001
018560              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01856001
018570              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01857001
018580              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01858001
018590              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01859001
018600              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01860001
018610              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01861001
018620              STRING  ' RCKUT128-4130-'                           01862001
018630                      ' CALLED BY-'                               01863001
018640                      RC074-CALLING-PROGRAM                       01864001
018650                      ' PO='                                      01865001
018660                      RC074-DISPLAY-PO                            01866001
018670                      ' RCVR='                                    01867001
018680                      RC074-DISPLAY-RCVR                          01868001
018690                      ' SQLCODE='                                 01869001
018700                      RC074-DISPLAY-SQLCODE                       01870001
018710                      DELIMITED BY SIZE                           01871001
018720                                      INTO RC074-CRA-RET-MSG      01872001
018730              STRING  ' RCKUT128-4130-'                           01873001
018740                      ' CALLED BY-'                               01874001
018750                      RC074-CALLING-PROGRAM                       01875001
018760                      DELIMITED BY SIZE                           01876001
018770                                      INTO RC074-ABEND-TEXT       01877001
018780              MOVE '4130-'              TO RC074-CRA-REQ-ID       01878001
018790                                           RC074-ABEND-PARAGRAPH  01879001
018800              PERFORM 9998-RETURN                                 01880001
018810     END-EVALUATE.                                                01881001
018820                                                                  01882001
018830 4135-SUM-TRECDIS-DRIVER.                                         01883001
018840                                                                  01884001
018850     MOVE ZERO                 TO  PV-LNE-INVCED-ITM-QTY.         01885004
018860                                                                  01886001
018870     EXEC SQL                                                     01887001
018880          SELECT SUM(A.EXPTED_ITM_QTY)                            01888001
018890          INTO  :PV-LNE-INVCED-ITM-QTY :PV-NULL-IND               01889004
018900          FROM                                                    01890001
018910                 TRECDIS  A                                       01891001
018920          WHERE                                                   01892001
018930                A.ORD_NBR          =  :DK-PO-NBR                  01893001
018940           AND  A.ORD_LNE_NBR      =  :RECITM-ORD-LNE-NBR         01894001
018950           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            01895001
018970           AND NOT EXISTS                                         01897001
018980               (SELECT *                                          01898001
018990                FROM RCT_RECDIS_ORIG B                            01899001
019000         WHERE  A.ORD_NBR          = B.ORD_NBR                    01900001
019010           AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR                01901001
019020           AND  A.ORD_LNE_NBR      = B.ORD_LNE_NBR                01902001
019030           AND  A.STR_NBR          = B.STR_NBR)                   01903001
019040     END-EXEC.                                                    01904001
019050                                                                  01905001
019060     EVALUATE TRUE                                                01906001
019070         WHEN SQLCODE = ZERO                                      01907001
019080         WHEN SQLCODE = +100                                      01908001
019090         WHEN SQLCODE = -305                                      01909001
019100              CONTINUE                                            01910001
019110         WHEN SQLWARN0 NOT = SPACE                                01911001
019120         WHEN SQLCODE NOT = ZERO                                  01912001
019130              SET  RC074-INVALID-SQL                              01913001
019140                   RC074-ERROR-YES                                01914001
019150                   PS-ERROR-YES         TO  TRUE                  01915001
019160              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01916001
019170              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01917001
019180              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01918001
019190              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01919001
019200              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01920001
019210              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01921001
019220              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01922001
019230              STRING  ' RCKUT128-4135-'                           01923001
019240                      ' CALLED BY-'                               01924001
019250                      RC074-CALLING-PROGRAM                       01925001
019260                      ' PO='                                      01926001
019270                      RC074-DISPLAY-PO                            01927001
019280                      ' RCVR='                                    01928001
019290                      RC074-DISPLAY-RCVR                          01929001
019300                      ' SQLCODE='                                 01930001
019310                      RC074-DISPLAY-SQLCODE                       01931001
019320                      DELIMITED BY SIZE                           01932001
019330                                      INTO RC074-CRA-RET-MSG      01933001
019340              STRING  ' RCKUT128-4135-'                           01934001
019350                      ' CALLED BY-'                               01935001
019360                      RC074-CALLING-PROGRAM                       01936001
019370                      DELIMITED BY SIZE                           01937001
019380                                      INTO RC074-ABEND-TEXT       01938001
019390              MOVE '4135-'              TO RC074-CRA-REQ-ID       01939001
019400                                           RC074-ABEND-PARAGRAPH  01940001
019410              PERFORM 9998-RETURN                                 01941001
019420     END-EVALUATE.                                                01942001
019430                                                                  01943001
019440 4138-SUM-TRECDIS-DRIVER-ORIG.                                    01944001
019450                                                                  01945001
019460     MOVE ZERO                 TO  PV-LNE-EXPTED-ORIG-ITM-QTY.    01946001
019470                                                                  01947001
019480     EXEC SQL                                                     01948001
019490          SELECT SUM(ORIG_EXPTED_QTY)                             01949001
019500          INTO  :PV-LNE-EXPTED-ORIG-ITM-QTY :PV-NULL-IND          01950001
019510          FROM                                                    01951001
019520                 RCT_RECDIS_ORIG                                  01952001
019530          WHERE                                                   01953001
019540                ORD_NBR          =  :DK-PO-NBR                    01954001
019550           AND  ORD_LNE_NBR      =  :RECITM-ORD-LNE-NBR           01955001
019560           AND  REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR              01956001
019570     END-EXEC.                                                    01957001
019580                                                                  01958001
019590     EVALUATE TRUE                                                01959001
019600         WHEN SQLCODE = ZERO                                      01960001
019610         WHEN SQLCODE = +100                                      01961001
019620         WHEN SQLCODE = -305                                      01962001
019630              CONTINUE                                            01963001
019640         WHEN SQLWARN0 NOT = SPACE                                01964001
019650         WHEN SQLCODE NOT = ZERO                                  01965001
019660              SET  RC074-INVALID-SQL                              01966001
019670                   RC074-ERROR-YES                                01967001
019680                   PS-ERROR-YES         TO  TRUE                  01968001
019690              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 01969001
019700              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      01970001
019710              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    01971001
019720              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    01972001
019730              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    01973001
019740              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     01974001
019750              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    01975001
019760              STRING  ' RCKUT128-4138-'                           01976001
019770                      ' CALLED BY-'                               01977001
019780                      RC074-CALLING-PROGRAM                       01978001
019790                      ' PO='                                      01979001
019800                      RC074-DISPLAY-PO                            01980001
019810                      ' RCVR='                                    01981001
019820                      RC074-DISPLAY-RCVR                          01982001
019830                      ' SQLCODE='                                 01983001
019840                      RC074-DISPLAY-SQLCODE                       01984001
019850                      DELIMITED BY SIZE                           01985001
019860                                      INTO RC074-CRA-RET-MSG      01986001
019870              STRING  ' RCKUT128-4138-'                           01987001
019880                      ' CALLED BY-'                               01988001
019890                      RC074-CALLING-PROGRAM                       01989001
019900                      DELIMITED BY SIZE                           01990001
019910                                      INTO RC074-ABEND-TEXT       01991001
019920              MOVE '4138-'              TO RC074-CRA-REQ-ID       01992001
019930                                           RC074-ABEND-PARAGRAPH  01993001
019940              PERFORM 9998-RETURN                                 01994001
019950     END-EVALUATE.                                                01995001
019960                                                                  01996001
019970 4140-SELECT-ODD-UNITS.                                           01997001
019980                                                                  01998001
019990     EXEC SQL                                                     01999001
020000          SELECT                                                  02000001
020010                 SUM(A.DC_VRFY_ODU_QTY)                           02001001
020020             ,   SUM(A.AP_VRFY_ODU_QTY)                           02002001
020030          INTO                                                    02003001
020040                :RC074-ACTUAL-ODD-QTY :PV-NULL-IND                02004001
020050             ,  :RC074-VERIFY-ODD-QTY :PV-NULL-IND                02005001
020060          FROM                                                    02006001
020070                 RCT_VRFD_ODD_UNT A                               02007001
020080              ,  TRECITM  B                                       02008001
020090          WHERE                                                   02009001
020100                A.PO_NBR           =  :DK-PO-NBR                  02010001
020110           AND  A.PO_LNE_NBR       =  B.ORD_LNE_NBR               02011001
020120           AND  A.RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR            02012001
020130           AND  A.PO_NBR           =  B.ORD_NBR                   02013001
020140           AND  B.VER_STATUS_CDE   =  'A'                         02014001
020150           AND  A.RCVR_SEQ_NBR     =  B.REC_SEQ_NBR               02015001
020160           AND  B.PREPK_ID         = :DK-PACK-ID                  02016001
020170     END-EXEC.                                                    02017001
020180                                                                  02018001
020190     EVALUATE TRUE                                                02019001
020200         WHEN SQLCODE = ZERO                                      02020001
020210         WHEN SQLCODE = +100                                      02021001
020220         WHEN SQLCODE = -305                                      02022001
020230              CONTINUE                                            02023001
020240         WHEN SQLWARN0 NOT = SPACE                                02024001
020250         WHEN SQLCODE NOT = ZERO                                  02025001
020260              SET  RC074-INVALID-SQL                              02026001
020270                   RC074-ERROR-YES                                02027001
020280                   PS-ERROR-YES         TO  TRUE                  02028001
020290              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02029001
020300              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02030001
020310              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02031001
020320              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02032001
020330              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02033001
020340              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02034001
020350              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02035001
020360              STRING  ' RCKUT128-4140-'                           02036001
020370                      ' CALLED BY-'                               02037001
020380                      RC074-CALLING-PROGRAM                       02038001
020390                      ' PO='                                      02039001
020400                      RC074-DISPLAY-PO                            02040001
020410                      ' RCVR='                                    02041001
020420                      RC074-DISPLAY-RCVR                          02042001
020430                      ' SQLCODE='                                 02043001
020440                      RC074-DISPLAY-SQLCODE                       02044001
020450                      DELIMITED BY SIZE                           02045001
020460                                      INTO RC074-CRA-RET-MSG      02046001
020470              STRING  ' RCKUT128-4140-'                           02047001
020480                      ' CALLED BY-'                               02048001
020490                      RC074-CALLING-PROGRAM                       02049001
020500                      DELIMITED BY SIZE                           02050001
020510                                      INTO RC074-ABEND-TEXT       02051001
020520              MOVE '4140-'              TO RC074-CRA-REQ-ID       02052001
020530                                           RC074-ABEND-PARAGRAPH  02053001
020540              PERFORM 9998-RETURN                                 02054001
020550     END-EVALUATE.                                                02055001
020560                                                                  02056001
020570 4150-SELECT-ODD-UNITS-PACK.                                      02057001
020580                                                                  02058001
020590     EXEC SQL                                                     02059001
020600          SELECT                                                  02060001
020610                 SUM(A.DC_VRFY_ODU_QTY)                           02061001
020620             ,   SUM(A.AP_VRFY_ODU_QTY)                           02062001
020630          INTO                                                    02063001
020640                :PV-ODD-DC-VERIFY-ODU-PK-QTY :PV-NULL-IND         02064001
020650             ,  :PV-ODD-AP-VERIFY-ODU-PK-QTY :PV-NULL-IND         02065001
020660          FROM                                                    02066001
020670                 RCT_VRFD_ODD_UNT A                               02067001
020680              ,  TRECITM  B                                       02068001
020690          WHERE                                                   02069001
020700                A.PO_NBR           =  :DK-PO-NBR                  02070001
020710           AND  A.PO_LNE_NBR       =  :DK-PO-DRIVER-LNE           02071001
020720           AND  A.PO_LNE_NBR       =  B.ORD_LNE_NBR               02072001
020730           AND  A.RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR            02073001
020740           AND  A.PO_NBR           =  B.ORD_NBR                   02074001
020750           AND  B.VER_STATUS_CDE   =  'A'                         02075001
020760           AND  A.RCVR_SEQ_NBR     =  B.REC_SEQ_NBR               02076001
020770           AND  B.PREPK_ID         = :DK-PACK-ID                  02077001
020780     END-EXEC.                                                    02078001
020790                                                                  02079001
020800     EVALUATE TRUE                                                02080001
020810         WHEN SQLCODE = ZERO                                      02081001
020820         WHEN SQLCODE = +100                                      02082001
020830         WHEN SQLCODE = -305                                      02083001
020840              CONTINUE                                            02084001
020850         WHEN SQLWARN0 NOT = SPACE                                02085001
020860         WHEN SQLCODE NOT = ZERO                                  02086001
020870              SET  RC074-INVALID-SQL                              02087001
020880                   RC074-ERROR-YES                                02088001
020890                   PS-ERROR-YES         TO  TRUE                  02089001
020900              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02090001
020910              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02091001
020920              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02092001
020930              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02093001
020940              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02094001
020950              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02095001
020960              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02096001
020970              STRING  ' RCKUT128-4150-'                           02097001
020980                      ' CALLED BY-'                               02098001
020990                      RC074-CALLING-PROGRAM                       02099001
021000                      ' PO='                                      02100001
021010                      RC074-DISPLAY-PO                            02101001
021020                      ' RCVR='                                    02102001
021030                      RC074-DISPLAY-RCVR                          02103001
021040                      ' SQLCODE='                                 02104001
021050                      RC074-DISPLAY-SQLCODE                       02105001
021060                      DELIMITED BY SIZE                           02106001
021070                                      INTO RC074-CRA-RET-MSG      02107001
021080              STRING  ' RCKUT128-4150-'                           02108001
021090                      ' CALLED BY-'                               02109001
021100                      RC074-CALLING-PROGRAM                       02110001
021110                      DELIMITED BY SIZE                           02111001
021120                                      INTO RC074-ABEND-TEXT       02112001
021130              MOVE '4150-'              TO RC074-CRA-REQ-ID       02113001
021140                                           RC074-ABEND-PARAGRAPH  02114001
021150              PERFORM 9998-RETURN                                 02115001
021160     END-EVALUATE.                                                02116001
021170                                                                  02117001
021180 4160-PROCESS-TRECDVS.                                            02118001
021190                                                                  02119001
021200     SET PS-MORE-RECDVS TO TRUE.                                  02120001
021210     PERFORM 4170-OPEN-TRECDVS.                                   02121001
021220     PERFORM 4180-PROCESS-TRECDVS                                 02122001
021230        UNTIL PS-NO-MORE-RECDVS.                                  02123001
021240     PERFORM 4190-CLOSE-TRECDVS.                                  02124001
021250                                                                  02125001
021260 4170-OPEN-TRECDVS.                                               02126001
021270                                                                  02127001
021280     EXEC SQL                                                     02128001
021290          OPEN RECDVS-PACK-CURSOR                                 02129001
021300     END-EXEC                                                     02130001
021310                                                                  02131001
021320     EVALUATE TRUE                                                02132001
021330         WHEN SQLCODE = ZERO                                      02133001
021340              CONTINUE                                            02134001
021350         WHEN SQLWARN0 NOT = SPACE                                02135001
021360         WHEN SQLCODE NOT = ZERO                                  02136001
021370              SET  RC074-INVALID-SQL                              02137001
021380                   RC074-ERROR-YES                                02138001
021390                   PS-ERROR-YES         TO  TRUE                  02139001
021400              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02140001
021410              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02141001
021420              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02142001
021430              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02143001
021440              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02144001
021450              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02145001
021460              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02146001
021470              STRING  ' RCKUT128-4170-'                           02147001
021480                      ' CALLED BY-'                               02148001
021490                      RC074-CALLING-PROGRAM                       02149001
021500                      ' PO='                                      02150001
021510                      RC074-DISPLAY-PO                            02151001
021520                      ' RCVR='                                    02152001
021530                      RC074-DISPLAY-RCVR                          02153001
021540                      ' SQLCODE='                                 02154001
021550                      RC074-DISPLAY-SQLCODE                       02155001
021560                      DELIMITED BY SIZE                           02156001
021570                                      INTO RC074-CRA-RET-MSG      02157001
021580              STRING  ' RCKUT128-4170-'                           02158001
021590                      ' CALLED BY-'                               02159001
021600                      RC074-CALLING-PROGRAM                       02160001
021610                      DELIMITED BY SIZE                           02161001
021620                                      INTO RC074-ABEND-TEXT       02162001
021630              MOVE '4170-'              TO RC074-CRA-REQ-ID       02163001
021640                                           RC074-ABEND-PARAGRAPH  02164001
021650              PERFORM 9998-RETURN                                 02165001
021660     END-EVALUATE.                                                02166001
021670                                                                  02167001
021680                                                                  02168001
021690 4180-PROCESS-TRECDVS.                                            02169001
021700                                                                  02170001
021710     PERFORM 4185-FETCH-RECDVS.                                   02171001
021720                                                                  02172001
021730     IF PS-MORE-RECDVS                                            02173001
021740         IF RECITM-PREPK-RATO-QTY > 0                             02174001
021750             COMPUTE PV-PKSLIP-PACKS =                            02175001
021760                  RECDVS-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY   02176001
021770             COMPUTE PV-ACTUAL-PACKS =                            02177001
021780                  RECDVS-VRFY-ITM-QTY / RECITM-PREPK-RATO-QTY     02178001
021790         ELSE                                                     02179001
021800             MOVE 0      TO PV-PKSLIP-PACKS                       02180001
021810             MOVE 0      TO PV-ACTUAL-PACKS                       02181001
021820         END-IF                                                   02182001
021830         IF RECDVS-VRFY-SRC-CDE = 'CP'                            02183001
021840             MOVE PV-PKSLIP-PACKS TO RC074-FCSE-ACTL-PACK-QTY     02184001
021850             ADD PV-PKSLIP-PACKS TO RC074-TOTAL-ACTL-PACK-QTY     02185001
021860         ELSE                                                     02186001
021870             MOVE PV-PKSLIP-PACKS TO RC074-P2L-ACTL-PACK-QTY      02187001
021880             ADD PV-PKSLIP-PACKS TO RC074-TOTAL-ACTL-PACK-QTY     02188001
021890         END-IF                                                   02189001
021900         ADD PV-ACTUAL-PACKS TO RC074-VERIFY-PACK-QTY             02190001
021910     END-IF.                                                      02191001
021920                                                                  02192001
021930 4185-FETCH-RECDVS.                                               02193001
021940                                                                  02194001
021950     EXEC SQL                                                     02195001
021960           FETCH RECDVS-PACK-CURSOR                               02196001
021970            INTO :RECDVS-VRFY-SRC-CDE                             02197001
021980                ,:RECDVS-EXPTED-ITM-QTY                           02198001
021990                ,:RECDVS-VRFY-ITM-QTY                             02199001
022000     END-EXEC.                                                    02200001
022010                                                                  02201001
022020     EVALUATE TRUE                                                02202001
022030         WHEN SQLCODE = ZERO                                      02203001
022040             ADD 1 TO PV-RECDVS-COUNT                             02204001
022050         WHEN SQLCODE = +100                                      02205001
022060             SET PS-NO-MORE-RECDVS   TO TRUE                      02206001
022070         WHEN SQLWARN0 NOT = SPACE                                02207001
022080         WHEN SQLCODE NOT = ZERO                                  02208001
022090              SET  RC074-INVALID-SQL                              02209001
022100                   RC074-ERROR-YES                                02210001
022110                   PS-ERROR-YES         TO  TRUE                  02211001
022120              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02212001
022130              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02213001
022140              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02214001
022150              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02215001
022160              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02216001
022170              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02217001
022180              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02218001
022190              STRING  ' RCKUT128-4185-'                           02219001
022200                      ' CALLED BY-'                               02220001
022210                      RC074-CALLING-PROGRAM                       02221001
022220                      ' PO='                                      02222001
022230                      RC074-DISPLAY-PO                            02223001
022240                      ' RCVR='                                    02224001
022250                      RC074-DISPLAY-RCVR                          02225001
022260                      ' SQLCODE='                                 02226001
022270                      RC074-DISPLAY-SQLCODE                       02227001
022280                      DELIMITED BY SIZE                           02228001
022290                                      INTO RC074-CRA-RET-MSG      02229001
022300              STRING  ' RCKUT128-4185-'                           02230001
022310                      ' CALLED BY-'                               02231001
022320                      RC074-CALLING-PROGRAM                       02232001
022330                      DELIMITED BY SIZE                           02233001
022340                                      INTO RC074-ABEND-TEXT       02234001
022350              MOVE '4185-'              TO RC074-CRA-REQ-ID       02235001
022360                                           RC074-ABEND-PARAGRAPH  02236001
022370              PERFORM 9998-RETURN                                 02237001
022380     END-EVALUATE.                                                02238001
022390/                                                                 02239001
022400 4190-CLOSE-TRECDVS.                                              02240001
022410                                                                  02241001
022420     EXEC SQL                                                     02242001
022430          CLOSE RECDVS-PACK-CURSOR                                02243001
022440     END-EXEC.                                                    02244001
022450                                                                  02245001
022460     EVALUATE TRUE                                                02246001
022470         WHEN SQLCODE = ZERO                                      02247001
022480              CONTINUE                                            02248001
022490         WHEN SQLWARN0 NOT = SPACE                                02249001
022500         WHEN SQLCODE NOT = ZERO                                  02250001
022510              SET  RC074-INVALID-SQL                              02251001
022520                   RC074-ERROR-YES                                02252001
022530                   PS-ERROR-YES         TO  TRUE                  02253001
022540              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02254001
022550              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02255001
022560              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02256001
022570              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02257001
022580              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02258001
022590              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02259001
022600              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02260001
022610              STRING  ' RCKUT128-4190-'                           02261001
022620                      ' CALLED BY-'                               02262001
022630                      RC074-CALLING-PROGRAM                       02263001
022640                      ' PO='                                      02264001
022650                      RC074-DISPLAY-PO                            02265001
022660                      ' RCVR='                                    02266001
022670                      RC074-DISPLAY-RCVR                          02267001
022680                      ' SQLCODE='                                 02268001
022690                      RC074-DISPLAY-SQLCODE                       02269001
022700                      DELIMITED BY SIZE                           02270001
022710                                      INTO RC074-CRA-RET-MSG      02271001
022720              STRING  ' RCKUT128-4190-'                           02272001
022730                      ' CALLED BY-'                               02273001
022740                      RC074-CALLING-PROGRAM                       02274001
022750                      DELIMITED BY SIZE                           02275001
022760                                      INTO RC074-ABEND-TEXT       02276001
022770              MOVE '4190-'              TO RC074-CRA-REQ-ID       02277001
022780                                           RC074-ABEND-PARAGRAPH  02278001
022790              PERFORM 9998-RETURN                                 02279001
022800     END-EVALUATE.                                                02280001
022810                                                                  02281001
022820 4200-CALCULATE-PACK-COUNTS.                                      02282001
022830     PERFORM 4110-SUM-TRECDIS.                                    02283001
022840     PERFORM 4115-SUM-TRECDIS.                                    02284001
022850     PERFORM 4118-SUM-TRECDIS-ORIG.                               02285001
022860     MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY.           02286004
022870     ADD PV-ORIG-EXPTED-ITM-QTY TO RC074-INVCED-ITM-QTY.          02287004
022880     PERFORM 4120-SELECT-DRIVER-RATIO.                            02288001
022890     MOVE RECITM-ORD-LNE-NBR TO DK-PO-DRIVER-LNE.                 02289001
022900     PERFORM 4240-SELECT-TDISTHD.                                 02290001
022910     IF RC074-AUTO-VE-NO                                          02291001
022920         MOVE ZERO             TO RC074-VERIFY-ITM-QTY            02292001
022930     ELSE                                                         02293001
022940         MOVE ZERO             TO RC074-VERIFY-ITM-QTY            02294001
022950                                  RC074-FCSE-ACTL-ITM-QTY         02295001
022960                                  RC074-P2L-ACTL-ITM-QTY          02296001
022970                                  RC074-TOTAL-ACTL-ITM-QTY        02297001
022980         PERFORM 4210-SUM-LINE-STR-OTBND-UPC                      02298001
022990         IF DISTHD-RSLTS-RCVD-TMST = PC-DB2-DEFAULT-TIMESTAMP     02299001
023000             MOVE 0           TO RC074-P2L-ACTL-ITM-QTY           02300001
023010         ELSE                                                     02301001
023020             PERFORM 4220-SUM-LINE-STR-P2L-ACTL                   02302001
023030         END-IF                                                   02303001
023040     END-IF.                                                      02304001
023050     COMPUTE RC074-TOTAL-ACTL-ITM-QTY =                           02305001
023060           RC074-FCSE-ACTL-ITM-QTY +                              02306001
023070           RC074-P2L-ACTL-ITM-QTY.                                02307001
023080                                                                  02308001
023090     PERFORM 4130-SUM-TRECDIS-DRIVER.                             02309001
023100     PERFORM 4135-SUM-TRECDIS-DRIVER.                             02310001
023110     PERFORM 4138-SUM-TRECDIS-DRIVER-ORIG.                        02311001
023120     MOVE PV-LNE-INVCED-ITM-QTY  TO PV-LNE-EXPTED-ITM-QTY.        02312004
023130     ADD PV-LNE-EXPTED-ORIG-ITM-QTY TO PV-LNE-INVCED-ITM-QTY.     02313004
023140     PERFORM 4150-SELECT-ODD-UNITS-PACK.                          02314001
023150     IF RECITM-PREPK-RATO-QTY > 0                                 02315001
023160         COMPUTE RC074-FCSE-INVC-PACK-QTY =                       02316004
023170             PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY        02317004
023180         COMPUTE RC074-FCSE-EXPT-PACK-QTY =                       02318004
023190             PV-LNE-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY        02319004
023200         IF RC074-AUTO-VE-NO                                      02320001
023210             COMPUTE RC074-FCSE-ACTL-PACK-QTY =                   02321001
023220                (PV-LNE-VERIFY-ITM-QTY                            02322001
023230                               - PV-ODD-DC-VERIFY-ODU-PK-QTY)     02323001
023240                                       / RECITM-PREPK-RATO-QTY    02324001
023250         ELSE                                                     02325001
023260             PERFORM 4230-SUM-PO-RCVR-PACKS                       02326001
023270             IF RC074-P2L-ACTL-ITM-QTY > 0                        02327001
023280                 PERFORM 4225-SUM-LINE-STR-P2L-ACTL-LNE           02328001
023290                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                02329001
023300                      PV-P2L-ACTL-LNE-ITM-QTY                     02330001
023310                                       / RECITM-PREPK-RATO-QTY    02331001
023320             END-IF                                               02332001
023330         END-IF                                                   02333001
023340     END-IF.                                                      02334001
023350     COMPUTE RC074-TOTAL-INVC-PACK-QTY =                          02335004
023360             RC074-FCSE-INVC-PACK-QTY + RC074-P2L-INVC-PACK-QTY.  02336004
023370     COMPUTE RC074-TOTAL-EXPT-PACK-QTY =                          02337004
023380        RC074-FCSE-EXPT-PACK-QTY + RC074-P2L-EXPT-PACK-QTY.       02338004
023390     COMPUTE RC074-TOTAL-ACTL-PACK-QTY =                          02339001
023400             RC074-FCSE-ACTL-PACK-QTY + RC074-P2L-ACTL-PACK-QTY.  02340001
023410     IF RC074-AUTO-VE-NO                                          02341001
023420         PERFORM 4140-SELECT-ODD-UNITS                            02342001
023430     ELSE                                                         02343001
023440         PERFORM 8200-SELECT-OTBND-CART                           02344001
023450         IF PV-ODD-UNT-CRTN-COUNT > 0                             02345001
023460             PERFORM 5000-PROCESS-PACK-CSR                        02346001
023470             MOVE 0       TO RC074-VERIFY-ODD-QTY                 02347001
023480         ELSE                                                     02348001
023490             MOVE 0       TO RC074-ACTUAL-ODD-QTY                 02349001
023500                             RC074-VERIFY-ODD-QTY                 02350001
023510         END-IF                                                   02351001
023520     END-IF.                                                      02352001
023530                                                                  02353001
023540 4210-SUM-LINE-STR-OTBND-UPC.                                     02354001
023550                                                                  02355001
023560     EXEC SQL                                                     02356001
023570          SELECT                                                  02357001
023580                 SUM(A.SHPD_UNT_QTY)                              02358001
023590          INTO                                                    02359001
023600                :RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          02360001
023610          FROM                                                    02361001
023620                 SUT_OTBND_UPC A                                  02362001
023630              ,  SUT_OTBND_CART B                                 02363001
023640              ,  TRECITM  C                                       02364001
023650          WHERE                                                   02365001
023660                A.TRN_NBR        =  :DK-PO-NBR                    02366001
023670           AND  A.TRN_NBR        =   C.ORD_NBR                    02367001
023680           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              02368001
023690           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                02369001
023700           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               02370001
023710           AND  B.ACTV_IND       =  'Y'                           02371001
023720           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              02372001
023730           AND  A.TRN_LNE_NBR      =  C.ORD_LNE_NBR               02373001
023740           AND  C.VER_STATUS_CDE   =  'A'                         02374001
023750           AND  C.PREPK_ID         = :DK-PACK-ID                  02375001
023760     END-EXEC.                                                    02376001
023770                                                                  02377001
023780     EVALUATE TRUE                                                02378001
023790         WHEN SQLCODE = ZERO                                      02379001
023800         WHEN SQLCODE = +100                                      02380001
023810         WHEN SQLCODE = -305                                      02381001
023820              CONTINUE                                            02382001
023830         WHEN SQLCODE = -904                                      02383001
023840         WHEN SQLCODE = -911                                      02384001
023850         WHEN SQLCODE = -913                                      02385001
023860              SET  RC074-DATABASE-BUSY                            02386001
023870                   RC074-ERROR-YES                                02387001
023880                   PS-ERROR-YES         TO  TRUE                  02388001
023890              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02389001
023900              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02390001
023910              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02391001
023920              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02392001
023930              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02393001
023940              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02394001
023950              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02395001
023960             STRING   ' RCKUT128-4210-'                           02396001
023970                      ' CALLED BY-'                               02397001
023980                      RC074-CALLING-PROGRAM                       02398001
023990                      ' PO='                                      02399001
024000                      RC074-DISPLAY-PO                            02400001
024010                      ' RCVR='                                    02401001
024020                      RC074-DISPLAY-RCVR                          02402001
024030                      ' LINE='                                    02403001
024040                      RC074-DISPLAY-LINE                          02404001
024050                      ' STR='                                     02405001
024060                      RC074-DISPLAY-STR                           02406001
024070                      ' SQLCODE='                                 02407001
024080                      RC074-DISPLAY-SQLCODE                       02408001
024090                      DELIMITED BY SIZE                           02409001
024100                                      INTO RC074-CRA-RET-MSG      02410001
024110             STRING   ' RCKUT128-4210-'                           02411001
024120                      ' CALLED BY-'                               02412001
024130                      RC074-CALLING-PROGRAM                       02413001
024140                      DELIMITED BY SIZE                           02414001
024150                                      INTO RC074-ABEND-TEXT       02415001
024160             MOVE '4210-'               TO RC074-CRA-REQ-ID       02416001
024170                                           RC074-ABEND-PARAGRAPH  02417001
024180             PERFORM 9998-RETURN                                  02418001
024190                                                                  02419001
024200         WHEN SQLWARN0 NOT = SPACE                                02420001
024210         WHEN SQLCODE NOT = ZERO                                  02421001
024220              SET  RC074-INVALID-SQL                              02422001
024230                   RC074-ERROR-YES                                02423001
024240                   PS-ERROR-YES         TO  TRUE                  02424001
024250              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02425001
024260              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02426001
024270              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02427001
024280              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02428001
024290              MOVE DK-PACK-ID           TO  RC074-DISPLAY-PACK    02429001
024300              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02430001
024310              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02431001
024320             STRING   ' RCKUT128-4210-'                           02432001
024330                      ' CALLED BY-'                               02433001
024340                      RC074-CALLING-PROGRAM                       02434001
024350                      ' PO='                                      02435001
024360                      RC074-DISPLAY-PO                            02436001
024370                      ' RCVR='                                    02437001
024380                      RC074-DISPLAY-RCVR                          02438001
024390                      ' LINE='                                    02439001
024400                      RC074-DISPLAY-LINE                          02440001
024410                      ' STR='                                     02441001
024420                      RC074-DISPLAY-STR                           02442001
024430                      ' SQLCODE='                                 02443001
024440                      RC074-DISPLAY-SQLCODE                       02444001
024450                      DELIMITED BY SIZE                           02445001
024460                                      INTO RC074-CRA-RET-MSG      02446001
024470             STRING   ' RCKUT128-4210-'                           02447001
024480                      ' CALLED BY-'                               02448001
024490                      RC074-CALLING-PROGRAM                       02449001
024500                      DELIMITED BY SIZE                           02450001
024510                                      INTO RC074-ABEND-TEXT       02451001
024520             MOVE '4210-'               TO RC074-CRA-REQ-ID       02452001
024530                                           RC074-ABEND-PARAGRAPH  02453001
024540             PERFORM 9998-RETURN                                  02454001
024550                                                                  02455001
024560     END-EVALUATE.                                                02456001
024570                                                                  02457001
024580 4220-SUM-LINE-STR-P2L-ACTL.                                      02458001
024590                                                                  02459001
024600                                                                  02460001
024610     EXEC SQL                                                     02461001
024620          SELECT                                                  02462001
024630                 SUM(A.P2L_SPLT_UNT_QTY)                          02463001
024640          INTO                                                    02464001
024650                :RC074-P2L-ACTL-ITM-QTY   :RC074-NULL-IND         02465001
024660          FROM                                                    02466001
024670                 TDISTDT A                                        02467001
024680                ,TRECITM B                                        02468001
024690          WHERE                                                   02469001
024700                A.ORD_NBR         =  :DK-PO-NBR                   02470001
024710           AND  A.RCVR_SEQ_NBR    =  :DK-RCVR-SEQ-NBR             02471001
024720           AND  A.ORD_NBR         =  B.ORD_NBR                    02472001
024730           AND  A.RCVR_SEQ_NBR    =  B.REC_SEQ_NBR                02473001
024740           AND  A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                02474001
024750           AND  B.STATUS_CDE     <>  'VE'                         02475001
024760           AND  B.VER_STATUS_CDE  =  'A'                          02476001
024770           AND  B.PREPK_ID         = :DK-PACK-ID                  02477001
024780     END-EXEC.                                                    02478001
024790                                                                  02479001
024800     EVALUATE TRUE                                                02480001
024810         WHEN SQLCODE = ZERO                                      02481001
024820         WHEN SQLCODE = +100                                      02482001
024830         WHEN SQLCODE = -305                                      02483001
024840              CONTINUE                                            02484001
024850         WHEN SQLCODE = -904                                      02485001
024860         WHEN SQLCODE = -911                                      02486001
024870         WHEN SQLCODE = -913                                      02487001
024880              SET  RC074-DATABASE-BUSY                            02488001
024890                   RC074-ERROR-YES                                02489001
024900                   PS-ERROR-YES         TO  TRUE                  02490001
024910              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02491001
024920              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02492001
024930              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02493001
024940              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02494001
024950              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02495001
024960              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02496001
024970              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02497001
024980             STRING   ' RCKUT128-4220-'                           02498001
024990                      ' CALLED BY-'                               02499001
025000                      RC074-CALLING-PROGRAM                       02500001
025010                      ' PO='                                      02501001
025020                      RC074-DISPLAY-PO                            02502001
025030                      ' RCVR='                                    02503001
025040                      RC074-DISPLAY-RCVR                          02504001
025050                      ' LINE='                                    02505001
025060                      RC074-DISPLAY-LINE                          02506001
025070                      ' STR='                                     02507001
025080                      RC074-DISPLAY-STR                           02508001
025090                      ' SQLCODE='                                 02509001
025100                      RC074-DISPLAY-SQLCODE                       02510001
025110                      DELIMITED BY SIZE                           02511001
025120                                      INTO RC074-CRA-RET-MSG      02512001
025130             STRING   ' RCKUT128-4220-'                           02513001
025140                      ' CALLED BY-'                               02514001
025150                      RC074-CALLING-PROGRAM                       02515001
025160                      DELIMITED BY SIZE                           02516001
025170                                      INTO RC074-ABEND-TEXT       02517001
025180             MOVE '4220-'               TO RC074-CRA-REQ-ID       02518001
025190                                           RC074-ABEND-PARAGRAPH  02519001
025200             PERFORM 9998-RETURN                                  02520001
025210                                                                  02521001
025220         WHEN SQLWARN0 NOT = SPACE                                02522001
025230         WHEN SQLCODE NOT = ZERO                                  02523001
025240              SET  RC074-INVALID-SQL                              02524001
025250                   RC074-ERROR-YES                                02525001
025260                   PS-ERROR-YES         TO  TRUE                  02526001
025270              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02527001
025280              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02528001
025290              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02529001
025300              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02530001
025310              MOVE DK-PACK-ID           TO  RC074-DISPLAY-PACK    02531001
025320              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02532001
025330              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02533001
025340             STRING   ' RCKUT128-4220-'                           02534001
025350                      ' CALLED BY-'                               02535001
025360                      RC074-CALLING-PROGRAM                       02536001
025370                      ' PO='                                      02537001
025380                      RC074-DISPLAY-PO                            02538001
025390                      ' RCVR='                                    02539001
025400                      RC074-DISPLAY-RCVR                          02540001
025410                      ' LINE='                                    02541001
025420                      RC074-DISPLAY-LINE                          02542001
025430                      ' STR='                                     02543001
025440                      RC074-DISPLAY-STR                           02544001
025450                      ' SQLCODE='                                 02545001
025460                      RC074-DISPLAY-SQLCODE                       02546001
025470                      DELIMITED BY SIZE                           02547001
025480                                      INTO RC074-CRA-RET-MSG      02548001
025490             STRING   ' RCKUT128-4220-'                           02549001
025500                      ' CALLED BY-'                               02550001
025510                      RC074-CALLING-PROGRAM                       02551001
025520                      DELIMITED BY SIZE                           02552001
025530                                      INTO RC074-ABEND-TEXT       02553001
025540             MOVE '4220-'               TO RC074-CRA-REQ-ID       02554001
025550                                           RC074-ABEND-PARAGRAPH  02555001
025560             PERFORM 9998-RETURN                                  02556001
025570                                                                  02557001
025580     END-EVALUATE.                                                02558001
025590                                                                  02559001
025600 4225-SUM-LINE-STR-P2L-ACTL-LNE.                                  02560001
025610                                                                  02561001
025620                                                                  02562001
025630     EXEC SQL                                                     02563001
025640          SELECT                                                  02564001
025650                 SUM(A.P2L_SPLT_UNT_QTY)                          02565001
025660          INTO                                                    02566001
025670                :PV-P2L-ACTL-LNE-ITM-QTY   :RC074-NULL-IND        02567001
025680          FROM                                                    02568001
025690                 TDISTDT A                                        02569001
025700                ,TRECITM B                                        02570001
025710          WHERE                                                   02571001
025720                A.ORD_NBR         =  :DK-PO-NBR                   02572001
025730           AND  A.RCVR_SEQ_NBR    =  :DK-RCVR-SEQ-NBR             02573001
025740           AND  A.ORD_NBR         =  B.ORD_NBR                    02574001
025750           AND  A.RCVR_SEQ_NBR    =  B.REC_SEQ_NBR                02575001
025760           AND  A.ORD_LNE_NBR     =  :DK-PO-DRIVER-LNE            02576001
025770           AND  A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                02577001
025780           AND  B.STATUS_CDE     <>  'VE'                         02578001
025790           AND  B.VER_STATUS_CDE  =  'A'                          02579001
025800           AND  B.PREPK_ID         = :DK-PACK-ID                  02580001
025810     END-EXEC.                                                    02581001
025820                                                                  02582001
025830     EVALUATE TRUE                                                02583001
025840         WHEN SQLCODE = ZERO                                      02584001
025850         WHEN SQLCODE = +100                                      02585001
025860         WHEN SQLCODE = -305                                      02586001
025870              CONTINUE                                            02587001
025880         WHEN SQLCODE = -904                                      02588001
025890         WHEN SQLCODE = -911                                      02589001
025900         WHEN SQLCODE = -913                                      02590001
025910              SET  RC074-DATABASE-BUSY                            02591001
025920                   RC074-ERROR-YES                                02592001
025930                   PS-ERROR-YES         TO  TRUE                  02593001
025940              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02594001
025950              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02595001
025960              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02596001
025970              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02597001
025980              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02598001
025990              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02599001
026000              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02600001
026010             STRING   ' RCKUT128-4225-'                           02601001
026020                      ' CALLED BY-'                               02602001
026030                      RC074-CALLING-PROGRAM                       02603001
026040                      ' PO='                                      02604001
026050                      RC074-DISPLAY-PO                            02605001
026060                      ' RCVR='                                    02606001
026070                      RC074-DISPLAY-RCVR                          02607001
026080                      ' LINE='                                    02608001
026090                      RC074-DISPLAY-LINE                          02609001
026100                      ' STR='                                     02610001
026110                      RC074-DISPLAY-STR                           02611001
026120                      ' SQLCODE='                                 02612001
026130                      RC074-DISPLAY-SQLCODE                       02613001
026140                      DELIMITED BY SIZE                           02614001
026150                                      INTO RC074-CRA-RET-MSG      02615001
026160             STRING   ' RCKUT128-4225-'                           02616001
026170                      ' CALLED BY-'                               02617001
026180                      RC074-CALLING-PROGRAM                       02618001
026190                      DELIMITED BY SIZE                           02619001
026200                                      INTO RC074-ABEND-TEXT       02620001
026210             MOVE '4225-'               TO RC074-CRA-REQ-ID       02621001
026220                                           RC074-ABEND-PARAGRAPH  02622001
026230             PERFORM 9998-RETURN                                  02623001
026240                                                                  02624001
026250         WHEN SQLWARN0 NOT = SPACE                                02625001
026260         WHEN SQLCODE NOT = ZERO                                  02626001
026270              SET  RC074-INVALID-SQL                              02627001
026280                   RC074-ERROR-YES                                02628001
026290                   PS-ERROR-YES         TO  TRUE                  02629001
026300              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02630001
026310              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02631001
026320              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02632001
026330              MOVE DK-PO-DRIVER-LNE     TO  RC074-DISPLAY-LINE    02633001
026340              MOVE DK-PACK-ID           TO  RC074-DISPLAY-PACK    02634001
026350              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02635001
026360              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02636001
026370             STRING   ' RCKUT128-4225-'                           02637001
026380                      ' CALLED BY-'                               02638001
026390                      RC074-CALLING-PROGRAM                       02639001
026400                      ' PO='                                      02640001
026410                      RC074-DISPLAY-PO                            02641001
026420                      ' RCVR='                                    02642001
026430                      RC074-DISPLAY-RCVR                          02643001
026440                      ' LINE='                                    02644001
026450                      RC074-DISPLAY-LINE                          02645001
026460                      ' STR='                                     02646001
026470                      RC074-DISPLAY-STR                           02647001
026480                      ' SQLCODE='                                 02648001
026490                      RC074-DISPLAY-SQLCODE                       02649001
026500                      DELIMITED BY SIZE                           02650001
026510                                      INTO RC074-CRA-RET-MSG      02651001
026520             STRING   ' RCKUT128-4225-'                           02652001
026530                      ' CALLED BY-'                               02653001
026540                      RC074-CALLING-PROGRAM                       02654001
026550                      DELIMITED BY SIZE                           02655001
026560                                      INTO RC074-ABEND-TEXT       02656001
026570             MOVE '4225-'               TO RC074-CRA-REQ-ID       02657001
026580                                           RC074-ABEND-PARAGRAPH  02658001
026590             PERFORM 9998-RETURN                                  02659001
026600                                                                  02660001
026610     END-EVALUATE.                                                02661001
026620                                                                  02662001
026630 4230-SUM-PO-RCVR-PACKS.                                          02663001
026640     EXEC SQL                                                     02664001
026650           SELECT SUM(A.SHPD_PK_QTY)                              02665001
026660            INTO :PV-TOTAL-PACKS :PV-NULL-IND                     02666001
026670            FROM SUT_OTBND_PK  A                                  02667001
026680              ,  SUT_OTBND_CART B                                 02668001
026690              ,  TPOPRPK  C                                       02669001
026700          WHERE                                                   02670001
026710                A.TRN_NBR        =  :DK-PO-NBR                    02671001
026720           AND  A.TRN_NBR        =   C.PO_NBR                     02672001
026730           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              02673001
026740           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               02674001
026750           AND  B.ACTV_IND       =  'Y'                           02675001
026760           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              02676001
026770           AND  A.PK_SKU_NBR       =  C.PK_SKU_NBR                02677001
026780           AND  C.PO_PREPK_ID      = :DK-PACK-ID                  02678001
026790     END-EXEC.                                                    02679001
026800                                                                  02680001
026810                                                                  02681001
026820     EVALUATE TRUE                                                02682001
026830         WHEN SQLCODE = ZERO                                      02683001
026840             IF PV-NULL-IND = -1                                  02684001
026850                 MOVE 0    TO PV-TOTAL-PACKS                      02685001
026860             END-IF                                               02686001
026870             MOVE PV-TOTAL-PACKS     TO RC074-FCSE-ACTL-PACK-QTY  02687001
026880         WHEN SQLCODE = -904                                      02688001
026890         WHEN SQLCODE = -911                                      02689001
026900         WHEN SQLCODE = -913                                      02690001
026910              SET  RC074-DATABASE-BUSY                            02691001
026920                   RC074-ERROR-YES                                02692001
026930                   PS-ERROR-YES         TO  TRUE                  02693001
026940              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02694001
026950              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02695001
026960              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02696001
026970              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02697001
026980              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02698001
026990              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02699001
027000              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02700001
027010             STRING   ' RCKUT128-4230-'                           02701001
027020                      ' CALLED BY-'                               02702001
027030                      RC074-CALLING-PROGRAM                       02703001
027040                      ' PO='                                      02704001
027050                      RC074-DISPLAY-PO                            02705001
027060                      ' RCVR='                                    02706001
027070                      RC074-DISPLAY-RCVR                          02707001
027080                      ' SQLCODE='                                 02708001
027090                      RC074-DISPLAY-SQLCODE                       02709001
027100                      DELIMITED BY SIZE                           02710001
027110                                      INTO RC074-CRA-RET-MSG      02711001
027120             STRING   ' RCKUT128-4230-'                           02712001
027130                      ' CALLED BY-'                               02713001
027140                      RC074-CALLING-PROGRAM                       02714001
027150                      DELIMITED BY SIZE                           02715001
027160                                      INTO RC074-ABEND-TEXT       02716001
027170             MOVE '4230-'               TO RC074-CRA-REQ-ID       02717001
027180                                           RC074-ABEND-PARAGRAPH  02718001
027190             PERFORM 9998-RETURN                                  02719001
027200                                                                  02720001
027210         WHEN SQLWARN0 NOT = SPACES                               02721001
027220         WHEN SQLCODE < ZERO                                      02722001
027230         WHEN SQLCODE > ZERO                                      02723001
027240              SET  RC074-INVALID-SQL                              02724001
027250                   RC074-ERROR-YES                                02725001
027260                   PS-ERROR-YES         TO  TRUE                  02726001
027270              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02727001
027280              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02728001
027290              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02729001
027300              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02730001
027310              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02731001
027320              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02732001
027330              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02733001
027340             STRING   ' RCKUT128-4230-'                           02734001
027350                      ' CALLED BY-'                               02735001
027360                      RC074-CALLING-PROGRAM                       02736001
027370                      ' PO='                                      02737001
027380                      RC074-DISPLAY-PO                            02738001
027390                      ' RCVR='                                    02739001
027400                      RC074-DISPLAY-RCVR                          02740001
027410                      ' SQLCODE='                                 02741001
027420                      RC074-DISPLAY-SQLCODE                       02742001
027430                      DELIMITED BY SIZE                           02743001
027440                                      INTO RC074-CRA-RET-MSG      02744001
027450             STRING   ' RCKUT128-4230-'                           02745001
027460                      ' CALLED BY-'                               02746001
027470                      RC074-CALLING-PROGRAM                       02747001
027480                      DELIMITED BY SIZE                           02748001
027490                                      INTO RC074-ABEND-TEXT       02749001
027500             MOVE '4230-'               TO RC074-CRA-REQ-ID       02750001
027510                                           RC074-ABEND-PARAGRAPH  02751001
027520             PERFORM 9998-RETURN                                  02752001
027530                                                                  02753001
027540     END-EVALUATE.                                                02754001
027550                                                                  02755001
027560 4240-SELECT-TDISTHD.                                             02756001
027570                                                                  02757001
027580     SET PS-TDISTHD-FOUND      TO TRUE.                           02758001
027590                                                                  02759001
027600     EXEC SQL                                                     02760001
027610          SELECT                                                  02761001
027620                RSLTS_RCVD_TMST                                   02762001
027630             ,  FCSE_CNFRMN_TMST                                  02763001
027640             ,  TOT_CART_CNT                                      02764001
027650             ,  FCSE_CART_CNT                                     02765001
027660             ,  P2L_CART_CNT                                      02766001
027670             ,  INPK_CART_CNT                                     02767001
027680          INTO                                                    02768001
027690                :DISTHD-RSLTS-RCVD-TMST                           02769001
027700             ,  :DISTHD-FCSE-CNFRMN-TMST                          02770001
027710             ,  :DISTHD-TOT-CART-CNT                              02771001
027720             ,  :DISTHD-FCSE-CART-CNT                             02772001
027730             ,  :DISTHD-P2L-CART-CNT                              02773001
027740             ,  :DISTHD-INPK-CART-CNT                             02774001
027750          FROM                                                    02775001
027760                TDISTHD                                           02776001
027770          WHERE                                                   02777001
027780                ORD_NBR          =  :DK-PO-NBR                    02778001
027790          AND   ORD_LNE_NBR      =  :DK-PO-DRIVER-LNE             02779001
027800          AND   RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              02780001
027801          WITH UR                                                 02780105
027810     END-EXEC.                                                    02781001
027820                                                                  02782001
027830     EVALUATE TRUE                                                02783001
027840         WHEN SQLCODE = ZERO                                      02784001
027850              CONTINUE                                            02785001
027860         WHEN SQLCODE = +100                                      02786001
027870             MOVE PC-DB2-DEFAULT-TIMESTAMP                        02787001
027880                                   TO DISTHD-RSLTS-RCVD-TMST      02788001
027890             SET PS-NO-TDISTHD-FOUND   TO TRUE                    02789001
027900         WHEN SQLWARN0 NOT = SPACES                               02790001
027910         WHEN SQLCODE < ZERO                                      02791001
027920         WHEN SQLCODE > ZERO                                      02792001
027930              SET  RC074-INVALID-SQL                              02793001
027940                   RC074-ERROR-YES                                02794001
027950                   PS-ERROR-YES         TO  TRUE                  02795001
027960              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02796001
027970              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02797001
027980              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02798001
027990              MOVE DK-PO-DRIVER-LNE     TO  RC074-DISPLAY-LINE    02799001
028000              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02800001
028010             STRING   ' RCKUT128-4240-'                           02801001
028020                      ' CALLED BY-'                               02802001
028030                      RC074-CALLING-PROGRAM                       02803001
028040                      ' PO='                                      02804001
028050                      RC074-DISPLAY-PO                            02805001
028060                      ' RCVR='                                    02806001
028070                      RC074-DISPLAY-RCVR                          02807001
028080                      ' LINE='                                    02808001
028090                      RC074-DISPLAY-LINE                          02809001
028100                      ' PACK='                                    02810001
028110                      RC074-DISPLAY-PACK                          02811001
028120                      ' SQLCODE='                                 02812001
028130                      RC074-DISPLAY-SQLCODE                       02813001
028140                      DELIMITED BY SIZE                           02814001
028150                                      INTO RC074-CRA-RET-MSG      02815001
028160             STRING   ' RCKUT128-4240-'                           02816001
028170                      ' CALLED BY-'                               02817001
028180                      RC074-CALLING-PROGRAM                       02818001
028190                      DELIMITED BY SIZE                           02819001
028200                                      INTO RC074-ABEND-TEXT       02820001
028210             MOVE '4240-'               TO RC074-CRA-REQ-ID       02821001
028220                                           RC074-ABEND-PARAGRAPH  02822001
028230             PERFORM 9998-RETURN                                  02823001
028240     END-EVALUATE.                                                02824001
028250                                                                  02825001
028260 4300-CALC-PACK-STORE-COUNTS-VE.                                  02826001
028270     PERFORM 4310-SUM-TRECDIS.                                    02827001
028280     PERFORM 4315-SUM-TRECDIS.                                    02828001
028290     PERFORM 4318-SUM-TRECDIS-ORIG.                               02829001
028300     MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY.           02830004
028310     ADD PV-ORIG-EXPTED-ITM-QTY TO RC074-INVCED-ITM-QTY.          02831004
028320     PERFORM 4120-SELECT-DRIVER-RATIO.                            02832001
028330     MOVE RECITM-ORD-LNE-NBR TO DK-PO-DRIVER-LNE.                 02833001
028340     PERFORM 7060-GET-TDISTDT.                                    02834001
028350     PERFORM 4320-SUM-TRECDIS-DRIVE.                              02835001
028360     PERFORM 4325-SUM-TRECDIS-DRIVE.                              02836001
028370     PERFORM 4328-SUM-TRECDIS-DRIVE-ORIG.                         02837001
028380     MOVE PV-LNE-INVCED-ITM-QTY  TO PV-LNE-EXPTED-ITM-QTY.        02838004
028390     ADD PV-LNE-EXPTED-ORIG-ITM-QTY TO PV-LNE-INVCED-ITM-QTY.     02839004
028400     PERFORM 4329-SELECT-ODD-UNITS.                               02840001
028410     PERFORM 4330-SELECT-ODD-UNITS-DRIVER.                        02841001
028420                                                                  02842001
028430     IF RECITM-VRFD-USR-ID = 'P2L/CASE'                           02843001
028440         PERFORM 4340-PROCESS-TRECDVS                             02844001
028450     ELSE                                                         02845001
028460         IF RECITM-PREPK-RATO-QTY > 0                             02846001
028470             IF RECITM-VRFD-USR-ID = 'P2L'                        02847001
028480                 COMPUTE RC074-P2L-INVC-PACK-QTY =                02848004
028490                   PV-LNE-INVCED-ITM-QTY  / RECITM-PREPK-RATO-QTY 02849004
028500                 ADD RC074-P2L-INVC-PACK-QTY TO                   02850004
028510                            RC074-TOTAL-INVC-PACK-QTY             02851004
028520                 COMPUTE RC074-P2L-EXPT-PACK-QTY =                02852004
028530                  PV-LNE-EXPTED-ITM-QTY /    RECITM-PREPK-RATO-QTY02853004
028540                 ADD RC074-P2L-EXPT-PACK-QTY TO                   02854004
028550                            RC074-TOTAL-EXPT-PACK-QTY             02855004
028560                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                02856001
028570                    (PV-LNE-VERIFY-ITM-QTY                        02857001
028580                           - PV-ODD-DC-VERIFY-ODU-PK-QTY)         02858001
028590                                          / RECITM-PREPK-RATO-QTY 02859001
028600                 ADD RC074-P2L-ACTL-PACK-QTY TO                   02860001
028610                            RC074-TOTAL-ACTL-PACK-QTY             02861001
028620             ELSE                                                 02862001
028630                 COMPUTE RC074-FCSE-INVC-PACK-QTY =               02863004
028640                    PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY 02864004
028650                 ADD RC074-FCSE-INVC-PACK-QTY TO                  02865004
028660                            RC074-TOTAL-INVC-PACK-QTY             02866004
028670                 COMPUTE RC074-FCSE-EXPT-PACK-QTY =               02867004
028680                    PV-LNE-EXPTED-ITM-QTY                         02868004
028690                                          / RECITM-PREPK-RATO-QTY 02869001
028700                 ADD RC074-FCSE-EXPT-PACK-QTY TO                  02870004
028710                            RC074-TOTAL-EXPT-PACK-QTY             02871004
028720                 COMPUTE RC074-FCSE-ACTL-PACK-QTY =               02872001
028730                    (PV-LNE-VERIFY-ITM-QTY                        02873001
028740                           - PV-ODD-DC-VERIFY-ODU-PK-QTY)         02874001
028750                                           / RECITM-PREPK-RATO-QTY02875001
028760                 ADD RC074-FCSE-ACTL-PACK-QTY TO                  02876001
028770                            RC074-TOTAL-ACTL-PACK-QTY             02877001
028780             END-IF                                               02878001
028790             IF PV-LNE-AP-VERIFY-ITM-QTY > 0                      02879001
028800                 COMPUTE RC074-VERIFY-PACK-QTY =                  02880001
028810                    (PV-LNE-AP-VERIFY-ITM-QTY                     02881001
028820                                 - PV-ODD-AP-VERIFY-ODU-PK-QTY)   02882001
028830                                           / RECITM-PREPK-RATO-QTY02883001
028840             ELSE                                                 02884001
028850                 MOVE 0                TO RC074-VERIFY-PACK-QTY   02885001
028860             END-IF                                               02886001
028870         END-IF                                                   02887001
028880     END-IF.                                                      02888001
028890                                                                  02889001
028900                                                                  02890001
028910 4310-SUM-TRECDIS.                                                02891001
028920                                                                  02892001
028930     MOVE ZERO                 TO RC074-VERIFY-ITM-QTY            02893001
028940                                  RC074-FCSE-ACTL-ITM-QTY         02894001
028950                                  RC074-TOTAL-ACTL-ITM-QTY.       02895001
028960                                                                  02896001
028970     EXEC SQL                                                     02897001
028980          SELECT SUM(A.VERIFY_ITM_QTY)                            02898001
028990              ,  SUM(A.AP_VERIFY_ITM_QTY)                         02899001
029000          INTO  :RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          02900001
029010              , :RC074-VERIFY-ITM-QTY    :RC074-NULL-IND          02901001
029020          FROM                                                    02902001
029030                 TRECDIS A                                        02903001
029040              ,  TRECITM  B                                       02904001
029050          WHERE                                                   02905001
029060                A.ORD_NBR          =  :DK-PO-NBR                  02906001
029070           AND  A.ORD_NBR          =  B.ORD_NBR                   02907001
029080           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            02908001
029090           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               02909001
029100           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               02910001
029120           AND  B.VER_STATUS_CDE   =  'A'                         02912001
029130           AND  B.PREPK_ID         =  :DK-PACK-ID                 02913001
029140           AND  A.STR_NBR          =  :DK-STR-NBR                 02914001
029150                                                                  02915001
029160     END-EXEC.                                                    02916001
029170                                                                  02917001
029180     EVALUATE TRUE                                                02918001
029190         WHEN SQLCODE = ZERO                                      02919001
029200              MOVE  RC074-FCSE-ACTL-ITM-QTY                       02920001
029210                TO  RC074-TOTAL-ACTL-ITM-QTY                      02921001
029220         WHEN SQLCODE = +100                                      02922001
029230         WHEN SQLCODE = -305                                      02923001
029240              CONTINUE                                            02924001
029250         WHEN SQLWARN0 NOT = SPACE                                02925001
029260         WHEN SQLCODE NOT = ZERO                                  02926001
029270                                                                  02927001
029280              SET  RC074-INVALID-SQL                              02928001
029290                   RC074-ERROR-YES                                02929001
029300                   PS-ERROR-YES         TO  TRUE                  02930001
029310              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 02931001
029320              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      02932001
029330              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    02933001
029340              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    02934001
029350              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    02935001
029360              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     02936001
029370              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    02937001
029380              STRING  ' RCKUT128-4310-'                           02938001
029390                      ' CALLED BY-'                               02939001
029400                      RC074-CALLING-PROGRAM                       02940001
029410                      ' PO='                                      02941001
029420                      RC074-DISPLAY-PO                            02942001
029430                      ' RCVR='                                    02943001
029440                      RC074-DISPLAY-RCVR                          02944001
029450                      ' SQLCODE='                                 02945001
029460                      RC074-DISPLAY-SQLCODE                       02946001
029470                      DELIMITED BY SIZE                           02947001
029480                                      INTO RC074-CRA-RET-MSG      02948001
029490              STRING  ' RCKUT128-4310-'                           02949001
029500                      ' CALLED BY-'                               02950001
029510                      RC074-CALLING-PROGRAM                       02951001
029520                      DELIMITED BY SIZE                           02952001
029530                                      INTO RC074-ABEND-TEXT       02953001
029540              MOVE '4310-'              TO RC074-CRA-REQ-ID       02954001
029550                                           RC074-ABEND-PARAGRAPH  02955001
029560              PERFORM 9998-RETURN                                 02956001
029570     END-EVALUATE.                                                02957001
029580                                                                  02958001
029590 4315-SUM-TRECDIS.                                                02959001
029600                                                                  02960001
029610     MOVE ZERO                 TO RC074-INVCED-ITM-QTY.           02961004
029620                                                                  02962001
029630     EXEC SQL                                                     02963001
029640          SELECT SUM(A.EXPTED_ITM_QTY)                            02964001
029650          INTO  :RC074-INVCED-ITM-QTY    :RC074-NULL-IND          02965004
029660          FROM                                                    02966001
029670                 TRECDIS A                                        02967001
029680              ,  TRECITM  B                                       02968001
029690          WHERE                                                   02969001
029700                A.ORD_NBR          =  :DK-PO-NBR                  02970001
029710           AND  A.ORD_NBR          =  B.ORD_NBR                   02971001
029720           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            02972001
029730           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               02973001
029740           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               02974001
029760           AND  B.VER_STATUS_CDE   =  'A'                         02976001
029770           AND  B.PREPK_ID         =  :DK-PACK-ID                 02977001
029780           AND  A.STR_NBR          =  :DK-STR-NBR                 02978001
029790           AND NOT EXISTS                                         02979001
029800               (SELECT *                                          02980001
029810                FROM RCT_RECDIS_ORIG C                            02981001
029820         WHERE  A.ORD_NBR          = C.ORD_NBR                    02982001
029830           AND  A.REC_SEQ_NBR      = C.REC_SEQ_NBR                02983001
029840           AND  A.ORD_LNE_NBR      = C.ORD_LNE_NBR                02984001
029850           AND  A.STR_NBR          = C.STR_NBR)                   02985001
029860                                                                  02986001
029870     END-EXEC.                                                    02987001
029880                                                                  02988001
029890     EVALUATE TRUE                                                02989001
029900         WHEN SQLCODE = ZERO                                      02990001
029910              CONTINUE                                            02991001
029920         WHEN SQLCODE = +100                                      02992001
029930         WHEN SQLCODE = -305                                      02993001
029940              CONTINUE                                            02994001
029950         WHEN SQLWARN0 NOT = SPACE                                02995001
029960         WHEN SQLCODE NOT = ZERO                                  02996001
029970                                                                  02997001
029980              SET  RC074-INVALID-SQL                              02998001
029990                   RC074-ERROR-YES                                02999001
030000                   PS-ERROR-YES         TO  TRUE                  03000001
030010              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03001001
030020              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03002001
030030              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03003001
030040              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03004001
030050              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03005001
030060              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03006001
030070              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03007001
030080              STRING  ' RCKUT128-4315-'                           03008001
030090                      ' CALLED BY-'                               03009001
030100                      RC074-CALLING-PROGRAM                       03010001
030110                      ' PO='                                      03011001
030120                      RC074-DISPLAY-PO                            03012001
030130                      ' RCVR='                                    03013001
030140                      RC074-DISPLAY-RCVR                          03014001
030150                      ' SQLCODE='                                 03015001
030160                      RC074-DISPLAY-SQLCODE                       03016001
030170                      DELIMITED BY SIZE                           03017001
030180                                      INTO RC074-CRA-RET-MSG      03018001
030190              STRING  ' RCKUT128-4315-'                           03019001
030200                      ' CALLED BY-'                               03020001
030210                      RC074-CALLING-PROGRAM                       03021001
030220                      DELIMITED BY SIZE                           03022001
030230                                      INTO RC074-ABEND-TEXT       03023001
030240              MOVE '4315-'              TO RC074-CRA-REQ-ID       03024001
030250                                           RC074-ABEND-PARAGRAPH  03025001
030260              PERFORM 9998-RETURN                                 03026001
030270     END-EVALUATE.                                                03027001
030280                                                                  03028001
030290 4318-SUM-TRECDIS-ORIG.                                           03029001
030300                                                                  03030001
030310     MOVE ZERO                 TO PV-ORIG-EXPTED-ITM-QTY.         03031001
030320                                                                  03032001
030330     EXEC SQL                                                     03033001
030340          SELECT SUM(A.ORIG_EXPTED_QTY)                           03034001
030350          INTO  :PV-ORIG-EXPTED-ITM-QTY  :RC074-NULL-IND          03035001
030360          FROM                                                    03036001
030370                 RCT_RECDIS_ORIG A                                03037001
030380              ,  TRECITM  B                                       03038001
030390          WHERE                                                   03039001
030400                A.ORD_NBR          =  :DK-PO-NBR                  03040001
030410           AND  A.ORD_NBR          =  B.ORD_NBR                   03041001
030420           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            03042001
030430           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               03043001
030440           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               03044001
030450           AND  B.PREPK_ID         =  :DK-PACK-ID                 03045001
030460           AND  A.STR_NBR          =  :DK-STR-NBR                 03046001
030470                                                                  03047001
030480     END-EXEC.                                                    03048001
030490                                                                  03049001
030500     EVALUATE TRUE                                                03050001
030510         WHEN SQLCODE = ZERO                                      03051001
030520              CONTINUE                                            03052001
030530         WHEN SQLCODE = +100                                      03053001
030540         WHEN SQLCODE = -305                                      03054001
030550              CONTINUE                                            03055001
030560         WHEN SQLWARN0 NOT = SPACE                                03056001
030570         WHEN SQLCODE NOT = ZERO                                  03057001
030580                                                                  03058001
030590              SET  RC074-INVALID-SQL                              03059001
030600                   RC074-ERROR-YES                                03060001
030610                   PS-ERROR-YES         TO  TRUE                  03061001
030620              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03062001
030630              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03063001
030640              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03064001
030650              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03065001
030660              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03066001
030670              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03067001
030680              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03068001
030690              STRING  ' RCKUT128-4318-'                           03069001
030700                      ' CALLED BY-'                               03070001
030710                      RC074-CALLING-PROGRAM                       03071001
030720                      ' PO='                                      03072001
030730                      RC074-DISPLAY-PO                            03073001
030740                      ' RCVR='                                    03074001
030750                      RC074-DISPLAY-RCVR                          03075001
030760                      ' SQLCODE='                                 03076001
030770                      RC074-DISPLAY-SQLCODE                       03077001
030780                      DELIMITED BY SIZE                           03078001
030790                                      INTO RC074-CRA-RET-MSG      03079001
030800              STRING  ' RCKUT128-4318-'                           03080001
030810                      ' CALLED BY-'                               03081001
030820                      RC074-CALLING-PROGRAM                       03082001
030830                      DELIMITED BY SIZE                           03083001
030840                                      INTO RC074-ABEND-TEXT       03084001
030850              MOVE '4318-'              TO RC074-CRA-REQ-ID       03085001
030860                                           RC074-ABEND-PARAGRAPH  03086001
030870              PERFORM 9998-RETURN                                 03087001
030880     END-EVALUATE.                                                03088001
030890                                                                  03089001
030900 4320-SUM-TRECDIS-DRIVE.                                          03090001
030910                                                                  03091001
030920     MOVE ZERO                 TO  PV-LNE-AP-VERIFY-ITM-QTY.      03092001
030930     MOVE ZERO                 TO  PV-LNE-VERIFY-ITM-QTY.         03093001
030940                                                                  03094001
030950     EXEC SQL                                                     03095001
030960          SELECT                                                  03096001
030970                 SUM(AP_VERIFY_ITM_QTY)                           03097001
030980                ,SUM(VERIFY_ITM_QTY)                              03098001
030990          INTO                                                    03099001
031000                :PV-LNE-AP-VERIFY-ITM-QTY :PV-NULL-IND            03100001
031010               ,:PV-LNE-VERIFY-ITM-QTY :PV-NULL-IND               03101001
031020          FROM                                                    03102001
031030                 TRECDIS                                          03103001
031040          WHERE                                                   03104001
031050                ORD_NBR          =  :DK-PO-NBR                    03105001
031060           AND  ORD_LNE_NBR      =  :DK-PO-DRIVER-LNE             03106001
031070           AND  REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR              03107001
031090           AND  STR_NBR          =  :DK-STR-NBR                   03109001
031100     END-EXEC.                                                    03110001
031110                                                                  03111001
031120     EVALUATE TRUE                                                03112001
031130         WHEN SQLCODE = ZERO                                      03113001
031140         WHEN SQLCODE = +100                                      03114001
031150         WHEN SQLCODE = -305                                      03115001
031160              CONTINUE                                            03116001
031170         WHEN SQLWARN0 NOT = SPACE                                03117001
031180         WHEN SQLCODE NOT = ZERO                                  03118001
031190              SET  RC074-INVALID-SQL                              03119001
031200                   RC074-ERROR-YES                                03120001
031210                   PS-ERROR-YES         TO  TRUE                  03121001
031220              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03122001
031230              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03123001
031240              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03124001
031250              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03125001
031260              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03126001
031270              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03127001
031280              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03128001
031290              STRING  ' RCKUT128-4320-'                           03129001
031300                      ' CALLED BY-'                               03130001
031310                      RC074-CALLING-PROGRAM                       03131001
031320                      ' PO='                                      03132001
031330                      RC074-DISPLAY-PO                            03133001
031340                      ' RCVR='                                    03134001
031350                      RC074-DISPLAY-RCVR                          03135001
031360                      ' SQLCODE='                                 03136001
031370                      RC074-DISPLAY-SQLCODE                       03137001
031380                      DELIMITED BY SIZE                           03138001
031390                                      INTO RC074-CRA-RET-MSG      03139001
031400              STRING  ' RCKUT128-4320-'                           03140001
031410                      ' CALLED BY-'                               03141001
031420                      RC074-CALLING-PROGRAM                       03142001
031430                      DELIMITED BY SIZE                           03143001
031440                                      INTO RC074-ABEND-TEXT       03144001
031450              MOVE '4320-'              TO RC074-CRA-REQ-ID       03145001
031460                                           RC074-ABEND-PARAGRAPH  03146001
031470              PERFORM 9998-RETURN                                 03147001
031480     END-EVALUATE.                                                03148001
031490                                                                  03149001
031500 4325-SUM-TRECDIS-DRIVE.                                          03150001
031510                                                                  03151001
031520     MOVE ZERO                 TO  PV-LNE-INVCED-ITM-QTY.         03152004
031530                                                                  03153001
031540     EXEC SQL                                                     03154001
031550          SELECT SUM(EXPTED_ITM_QTY)                              03155001
031560          INTO  :PV-LNE-INVCED-ITM-QTY :PV-NULL-IND               03156004
031570          FROM                                                    03157001
031580                 TRECDIS  A                                       03158001
031590          WHERE                                                   03159001
031600                A.ORD_NBR        =  :DK-PO-NBR                    03160001
031610           AND  A.ORD_LNE_NBR    =  :DK-PO-DRIVER-LNE             03161001
031620           AND  A.REC_SEQ_NBR    =  :DK-RCVR-SEQ-NBR              03162001
031640           AND  A.STR_NBR        =  :DK-STR-NBR                   03164001
031650           AND NOT EXISTS                                         03165001
031660               (SELECT *                                          03166001
031670                FROM RCT_RECDIS_ORIG B                            03167001
031680         WHERE  A.ORD_NBR          = B.ORD_NBR                    03168001
031690           AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR                03169001
031700           AND  A.ORD_LNE_NBR      = B.ORD_LNE_NBR                03170001
031710           AND  A.STR_NBR          = B.STR_NBR)                   03171001
031720     END-EXEC.                                                    03172001
031730                                                                  03173001
031740     EVALUATE TRUE                                                03174001
031750         WHEN SQLCODE = ZERO                                      03175001
031760         WHEN SQLCODE = +100                                      03176001
031770         WHEN SQLCODE = -305                                      03177001
031780              CONTINUE                                            03178001
031790         WHEN SQLWARN0 NOT = SPACE                                03179001
031800         WHEN SQLCODE NOT = ZERO                                  03180001
031810              SET  RC074-INVALID-SQL                              03181001
031820                   RC074-ERROR-YES                                03182001
031830                   PS-ERROR-YES         TO  TRUE                  03183001
031840              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03184001
031850              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03185001
031860              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03186001
031870              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03187001
031880              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03188001
031890              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03189001
031900              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03190001
031910              STRING  ' RCKUT128-4325-'                           03191001
031920                      ' CALLED BY-'                               03192001
031930                      RC074-CALLING-PROGRAM                       03193001
031940                      ' PO='                                      03194001
031950                      RC074-DISPLAY-PO                            03195001
031960                      ' RCVR='                                    03196001
031970                      RC074-DISPLAY-RCVR                          03197001
031980                      ' SQLCODE='                                 03198001
031990                      RC074-DISPLAY-SQLCODE                       03199001
032000                      DELIMITED BY SIZE                           03200001
032010                                      INTO RC074-CRA-RET-MSG      03201001
032020              STRING  ' RCKUT128-4325-'                           03202001
032030                      ' CALLED BY-'                               03203001
032040                      RC074-CALLING-PROGRAM                       03204001
032050                      DELIMITED BY SIZE                           03205001
032060                                      INTO RC074-ABEND-TEXT       03206001
032070              MOVE '4325-'              TO RC074-CRA-REQ-ID       03207001
032080                                           RC074-ABEND-PARAGRAPH  03208001
032090              PERFORM 9998-RETURN                                 03209001
032100     END-EVALUATE.                                                03210001
032110                                                                  03211001
032120 4328-SUM-TRECDIS-DRIVE-ORIG.                                     03212001
032130                                                                  03213001
032140     MOVE ZERO                 TO  PV-LNE-EXPTED-ORIG-ITM-QTY.    03214001
032150                                                                  03215001
032160     EXEC SQL                                                     03216001
032170          SELECT SUM(ORIG_EXPTED_QTY)                             03217001
032180          INTO  :PV-LNE-EXPTED-ORIG-ITM-QTY :PV-NULL-IND          03218001
032190          FROM                                                    03219001
032200                 RCT_RECDIS_ORIG                                  03220001
032210          WHERE                                                   03221001
032220                ORD_NBR          =  :DK-PO-NBR                    03222001
032230           AND  ORD_LNE_NBR      =  :DK-PO-DRIVER-LNE             03223001
032240           AND  REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR              03224001
032250           AND  STR_NBR          =  :DK-STR-NBR                   03225001
032260     END-EXEC.                                                    03226001
032270                                                                  03227001
032280     EVALUATE TRUE                                                03228001
032290         WHEN SQLCODE = ZERO                                      03229001
032300         WHEN SQLCODE = +100                                      03230001
032310         WHEN SQLCODE = -305                                      03231001
032320              CONTINUE                                            03232001
032330         WHEN SQLWARN0 NOT = SPACE                                03233001
032340         WHEN SQLCODE NOT = ZERO                                  03234001
032350              SET  RC074-INVALID-SQL                              03235001
032360                   RC074-ERROR-YES                                03236001
032370                   PS-ERROR-YES         TO  TRUE                  03237001
032380              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03238001
032390              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03239001
032400              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03240001
032410              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03241001
032420              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03242001
032430              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03243001
032440              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03244001
032450              STRING  ' RCKUT128-4328-'                           03245001
032460                      ' CALLED BY-'                               03246001
032470                      RC074-CALLING-PROGRAM                       03247001
032480                      ' PO='                                      03248001
032490                      RC074-DISPLAY-PO                            03249001
032500                      ' RCVR='                                    03250001
032510                      RC074-DISPLAY-RCVR                          03251001
032520                      ' SQLCODE='                                 03252001
032530                      RC074-DISPLAY-SQLCODE                       03253001
032540                      DELIMITED BY SIZE                           03254001
032550                                      INTO RC074-CRA-RET-MSG      03255001
032560              STRING  ' RCKUT128-4328-'                           03256001
032570                      ' CALLED BY-'                               03257001
032580                      RC074-CALLING-PROGRAM                       03258001
032590                      DELIMITED BY SIZE                           03259001
032600                                      INTO RC074-ABEND-TEXT       03260001
032610              MOVE '4328-'              TO RC074-CRA-REQ-ID       03261001
032620                                           RC074-ABEND-PARAGRAPH  03262001
032630              PERFORM 9998-RETURN                                 03263001
032640     END-EVALUATE.                                                03264001
032650                                                                  03265001
032660 4329-SELECT-ODD-UNITS.                                           03266001
032670                                                                  03267001
032680     EXEC SQL                                                     03268001
032690          SELECT                                                  03269001
032700                 SUM(A.DC_VRFY_ODU_QTY)                           03270001
032710             ,   SUM(A.AP_VRFY_ODU_QTY)                           03271001
032720          INTO                                                    03272001
032730                :RC074-ACTUAL-ODD-QTY :PV-NULL-IND                03273001
032740             ,  :RC074-VERIFY-ODD-QTY :PV-NULL-IND                03274001
032750          FROM                                                    03275001
032760                 RCT_VRFD_ODD_UNT A                               03276001
032770              ,  TRECITM  B                                       03277001
032780          WHERE                                                   03278001
032790                PO_NBR           =  :DK-PO-NBR                    03279001
032800           AND  A.PO_LNE_NBR     =  B.ORD_LNE_NBR                 03280001
032810           AND  RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              03281001
032820           AND  STR_NBR          =  :DK-STR-NBR                   03282001
032830           AND  A.PO_NBR         =  B.ORD_NBR                     03283001
032840           AND  B.VER_STATUS_CDE =  'A'                           03284001
032850           AND  A.RCVR_SEQ_NBR   =  B.REC_SEQ_NBR                 03285001
032860           AND  B.PREPK_ID       = :DK-PACK-ID                    03286001
032870     END-EXEC.                                                    03287001
032880                                                                  03288001
032890     EVALUATE TRUE                                                03289001
032900         WHEN SQLCODE = ZERO                                      03290001
032910         WHEN SQLCODE = +100                                      03291001
032920         WHEN SQLCODE = -305                                      03292001
032930              CONTINUE                                            03293001
032940         WHEN SQLWARN0 NOT = SPACE                                03294001
032950         WHEN SQLCODE NOT = ZERO                                  03295001
032960              SET  RC074-INVALID-SQL                              03296001
032970                   RC074-ERROR-YES                                03297001
032980                   PS-ERROR-YES         TO  TRUE                  03298001
032990              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03299001
033000              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03300001
033010              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03301001
033020              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03302001
033030              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03303001
033040              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03304001
033050              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03305001
033060              STRING  ' RCKUT128-4329-'                           03306001
033070                      ' CALLED BY-'                               03307001
033080                      RC074-CALLING-PROGRAM                       03308001
033090                      ' PO='                                      03309001
033100                      RC074-DISPLAY-PO                            03310001
033110                      ' RCVR='                                    03311001
033120                      RC074-DISPLAY-RCVR                          03312001
033130                      ' SQLCODE='                                 03313001
033140                      RC074-DISPLAY-SQLCODE                       03314001
033150                      DELIMITED BY SIZE                           03315001
033160                                      INTO RC074-CRA-RET-MSG      03316001
033170              STRING  ' RCKUT128-4329-'                           03317001
033180                      ' CALLED BY-'                               03318001
033190                      RC074-CALLING-PROGRAM                       03319001
033200                      DELIMITED BY SIZE                           03320001
033210                                      INTO RC074-ABEND-TEXT       03321001
033220              MOVE '4329-'              TO RC074-CRA-REQ-ID       03322001
033230                                           RC074-ABEND-PARAGRAPH  03323001
033240              PERFORM 9998-RETURN                                 03324001
033250     END-EVALUATE.                                                03325001
033260                                                                  03326001
033270 4330-SELECT-ODD-UNITS-DRIVER.                                    03327001
033280                                                                  03328001
033290     EXEC SQL                                                     03329001
033300          SELECT                                                  03330001
033310                 SUM(A.DC_VRFY_ODU_QTY)                           03331001
033320             ,   SUM(A.AP_VRFY_ODU_QTY)                           03332001
033330          INTO                                                    03333001
033340                :PV-ODD-DC-VERIFY-ODU-PK-QTY :PV-NULL-IND         03334001
033350             ,  :PV-ODD-AP-VERIFY-ODU-PK-QTY :PV-NULL-IND         03335001
033360          FROM                                                    03336001
033370                 RCT_VRFD_ODD_UNT A                               03337001
033380              ,  TRECITM  B                                       03338001
033390          WHERE                                                   03339001
033400                PO_NBR           =  :DK-PO-NBR                    03340001
033410           AND  PO_LNE_NBR       =  :DK-PO-DRIVER-LNE             03341001
033420           AND  A.PO_LNE_NBR     =  B.ORD_LNE_NBR                 03342001
033430           AND  RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              03343001
033440           AND  STR_NBR          =  :DK-STR-NBR                   03344001
033450           AND  A.PO_NBR         =  B.ORD_NBR                     03345001
033460           AND  B.VER_STATUS_CDE =  'A'                           03346001
033470           AND  A.RCVR_SEQ_NBR   =  B.REC_SEQ_NBR                 03347001
033480           AND  B.PREPK_ID       = :DK-PACK-ID                    03348001
033490     END-EXEC.                                                    03349001
033500                                                                  03350001
033510     EVALUATE TRUE                                                03351001
033520         WHEN SQLCODE = ZERO                                      03352001
033530         WHEN SQLCODE = +100                                      03353001
033540         WHEN SQLCODE = -305                                      03354001
033550              CONTINUE                                            03355001
033560         WHEN SQLWARN0 NOT = SPACE                                03356001
033570         WHEN SQLCODE NOT = ZERO                                  03357001
033580              SET  RC074-INVALID-SQL                              03358001
033590                   RC074-ERROR-YES                                03359001
033600                   PS-ERROR-YES         TO  TRUE                  03360001
033610              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03361001
033620              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03362001
033630              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03363001
033640              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03364001
033650              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03365001
033660              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03366001
033670              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03367001
033680              STRING  ' RCKUT128-4330-'                           03368001
033690                      ' CALLED BY-'                               03369001
033700                      RC074-CALLING-PROGRAM                       03370001
033710                      ' PO='                                      03371001
033720                      RC074-DISPLAY-PO                            03372001
033730                      ' RCVR='                                    03373001
033740                      RC074-DISPLAY-RCVR                          03374001
033750                      ' SQLCODE='                                 03375001
033760                      RC074-DISPLAY-SQLCODE                       03376001
033770                      DELIMITED BY SIZE                           03377001
033780                                      INTO RC074-CRA-RET-MSG      03378001
033790              STRING  ' RCKUT128-4330-'                           03379001
033800                      ' CALLED BY-'                               03380001
033810                      RC074-CALLING-PROGRAM                       03381001
033820                      DELIMITED BY SIZE                           03382001
033830                                      INTO RC074-ABEND-TEXT       03383001
033840              MOVE '4330-'              TO RC074-CRA-REQ-ID       03384001
033850                                           RC074-ABEND-PARAGRAPH  03385001
033860              PERFORM 9998-RETURN                                 03386001
033870     END-EVALUATE.                                                03387001
033880                                                                  03388001
033890 4340-PROCESS-TRECDVS.                                            03389001
033900                                                                  03390001
033910     SET PS-MORE-RECDVS TO TRUE.                                  03391001
033920     PERFORM 4350-OPEN-TRECDVS.                                   03392001
033930     PERFORM 4360-PROCESS-TRECDVS                                 03393001
033940        UNTIL PS-NO-MORE-RECDVS.                                  03394001
033950     PERFORM 4380-CLOSE-TRECDVS.                                  03395001
033960                                                                  03396001
033970                                                                  03397001
033980 4350-OPEN-TRECDVS.                                               03398001
033990                                                                  03399001
034000     EXEC SQL                                                     03400001
034010          OPEN RECDVS-CURSOR                                      03401001
034020     END-EXEC                                                     03402001
034030                                                                  03403001
034040     EVALUATE TRUE                                                03404001
034050         WHEN SQLCODE = ZERO                                      03405001
034060              CONTINUE                                            03406001
034070         WHEN SQLWARN0 NOT = SPACE                                03407001
034080         WHEN SQLCODE NOT = ZERO                                  03408001
034090              SET  RC074-INVALID-SQL                              03409001
034100                   RC074-ERROR-YES                                03410001
034110                   PS-ERROR-YES         TO  TRUE                  03411001
034120              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03412001
034130              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03413001
034140              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03414001
034150              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03415001
034160              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03416001
034170              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03417001
034180              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03418001
034190              STRING  ' RCKUT128-4350-'                           03419001
034200                      ' CALLED BY-'                               03420001
034210                      RC074-CALLING-PROGRAM                       03421001
034220                      ' PO='                                      03422001
034230                      RC074-DISPLAY-PO                            03423001
034240                      ' RCVR='                                    03424001
034250                      RC074-DISPLAY-RCVR                          03425001
034260                      ' SQLCODE='                                 03426001
034270                      RC074-DISPLAY-SQLCODE                       03427001
034280                      DELIMITED BY SIZE                           03428001
034290                                      INTO RC074-CRA-RET-MSG      03429001
034300              STRING  ' RCKUT128-4350-'                           03430001
034310                      ' CALLED BY-'                               03431001
034320                      RC074-CALLING-PROGRAM                       03432001
034330                      DELIMITED BY SIZE                           03433001
034340                                      INTO RC074-ABEND-TEXT       03434001
034350              MOVE '4350-'              TO RC074-CRA-REQ-ID       03435001
034360                                           RC074-ABEND-PARAGRAPH  03436001
034370              PERFORM 9998-RETURN                                 03437001
034380     END-EVALUATE.                                                03438001
034390                                                                  03439001
034400                                                                  03440001
034410 4360-PROCESS-TRECDVS.                                            03441001
034420                                                                  03442001
034430     PERFORM 4370-FETCH-RECDVS.                                   03443001
034440                                                                  03444001
034450     IF PS-MORE-RECDVS                                            03445001
034460         IF RECITM-PREPK-RATO-QTY > 0                             03446001
034470             COMPUTE PV-PKSLIP-PACKS =                            03447001
034480                  RECDVS-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY   03448001
034490             COMPUTE PV-ACTUAL-PACKS =                            03449001
034500                  RECDVS-VRFY-ITM-QTY / RECITM-PREPK-RATO-QTY     03450001
034510         ELSE                                                     03451001
034520             MOVE 0      TO PV-PKSLIP-PACKS                       03452001
034530             MOVE 0      TO PV-ACTUAL-PACKS                       03453001
034540         END-IF                                                   03454001
034550         IF RECDVS-VRFY-SRC-CDE = 'CP'                            03455001
034560             MOVE PV-PKSLIP-PACKS TO RC074-FCSE-ACTL-PACK-QTY     03456001
034570             ADD PV-PKSLIP-PACKS TO RC074-TOTAL-ACTL-PACK-QTY     03457001
034580         ELSE                                                     03458001
034590             MOVE PV-PKSLIP-PACKS TO RC074-P2L-ACTL-PACK-QTY      03459001
034600             ADD PV-PKSLIP-PACKS TO RC074-TOTAL-ACTL-PACK-QTY     03460001
034610         END-IF                                                   03461001
034620         ADD PV-ACTUAL-PACKS TO RC074-VERIFY-PACK-QTY             03462001
034630     END-IF.                                                      03463001
034640                                                                  03464001
034650 4370-FETCH-RECDVS.                                               03465001
034660                                                                  03466001
034670     EXEC SQL                                                     03467001
034680           FETCH RECDVS-CURSOR                                    03468001
034690            INTO :RECDVS-VRFY-SRC-CDE                             03469001
034700                ,:RECDVS-EXPTED-ITM-QTY                           03470001
034710                ,:RECDVS-VRFY-ITM-QTY                             03471001
034720     END-EXEC.                                                    03472001
034730                                                                  03473001
034740     EVALUATE TRUE                                                03474001
034750         WHEN SQLCODE = ZERO                                      03475001
034760             ADD 1 TO PV-RECDVS-COUNT                             03476001
034770         WHEN SQLCODE = +100                                      03477001
034780             SET PS-NO-MORE-RECDVS   TO TRUE                      03478001
034790         WHEN SQLWARN0 NOT = SPACE                                03479001
034800         WHEN SQLCODE NOT = ZERO                                  03480001
034810              SET  RC074-INVALID-SQL                              03481001
034820                   RC074-ERROR-YES                                03482001
034830                   PS-ERROR-YES         TO  TRUE                  03483001
034840              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03484001
034850              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03485001
034860              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03486001
034870              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03487001
034880              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03488001
034890              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03489001
034900              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03490001
034910              STRING  ' RCKUT128-4370-'                           03491001
034920                      ' CALLED BY-'                               03492001
034930                      RC074-CALLING-PROGRAM                       03493001
034940                      ' PO='                                      03494001
034950                      RC074-DISPLAY-PO                            03495001
034960                      ' RCVR='                                    03496001
034970                      RC074-DISPLAY-RCVR                          03497001
034980                      ' SQLCODE='                                 03498001
034990                      RC074-DISPLAY-SQLCODE                       03499001
035000                      DELIMITED BY SIZE                           03500001
035010                                      INTO RC074-CRA-RET-MSG      03501001
035020              STRING  ' RCKUT128-4370-'                           03502001
035030                      ' CALLED BY-'                               03503001
035040                      RC074-CALLING-PROGRAM                       03504001
035050                      DELIMITED BY SIZE                           03505001
035060                                      INTO RC074-ABEND-TEXT       03506001
035070              MOVE '4370-'              TO RC074-CRA-REQ-ID       03507001
035080                                           RC074-ABEND-PARAGRAPH  03508001
035090              PERFORM 9998-RETURN                                 03509001
035100     END-EVALUATE.                                                03510001
035110/                                                                 03511001
035120 4380-CLOSE-TRECDVS.                                              03512001
035130                                                                  03513001
035140     EXEC SQL                                                     03514001
035150          CLOSE RECDVS-CURSOR                                     03515001
035160     END-EXEC.                                                    03516001
035170                                                                  03517001
035180     EVALUATE TRUE                                                03518001
035190         WHEN SQLCODE = ZERO                                      03519001
035200              CONTINUE                                            03520001
035210         WHEN SQLWARN0 NOT = SPACE                                03521001
035220         WHEN SQLCODE NOT = ZERO                                  03522001
035230              SET  RC074-INVALID-SQL                              03523001
035240                   RC074-ERROR-YES                                03524001
035250                   PS-ERROR-YES         TO  TRUE                  03525001
035260              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03526001
035270              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      03527001
035280              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    03528001
035290              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03529001
035300              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03530001
035310              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03531001
035320              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03532001
035330              STRING  ' RCKUT128-4380-'                           03533001
035340                      ' CALLED BY-'                               03534001
035350                      RC074-CALLING-PROGRAM                       03535001
035360                      ' PO='                                      03536001
035370                      RC074-DISPLAY-PO                            03537001
035380                      ' RCVR='                                    03538001
035390                      RC074-DISPLAY-RCVR                          03539001
035400                      ' SQLCODE='                                 03540001
035410                      RC074-DISPLAY-SQLCODE                       03541001
035420                      DELIMITED BY SIZE                           03542001
035430                                      INTO RC074-CRA-RET-MSG      03543001
035440              STRING  ' RCKUT128-4380-'                           03544001
035450                      ' CALLED BY-'                               03545001
035460                      RC074-CALLING-PROGRAM                       03546001
035470                      DELIMITED BY SIZE                           03547001
035480                                      INTO RC074-ABEND-TEXT       03548001
035490              MOVE '4380-'              TO RC074-CRA-REQ-ID       03549001
035500                                           RC074-ABEND-PARAGRAPH  03550001
035510              PERFORM 9998-RETURN                                 03551001
035520     END-EVALUATE.                                                03552001
035530                                                                  03553001
035540 4400-CALC-PACK-STORE-COUNTS.                                     03554001
035550     PERFORM 4310-SUM-TRECDIS.                                    03555001
035560     PERFORM 4315-SUM-TRECDIS.                                    03556001
035570     PERFORM 4318-SUM-TRECDIS-ORIG.                               03557001
035580     MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY.           03558004
035590     ADD PV-ORIG-EXPTED-ITM-QTY TO RC074-INVCED-ITM-QTY.          03559004
035600     PERFORM 4120-SELECT-DRIVER-RATIO.                            03560001
035610     MOVE RECITM-ORD-LNE-NBR TO DK-PO-DRIVER-LNE.                 03561001
035620     PERFORM 7060-GET-TDISTDT.                                    03562001
035630     PERFORM 4240-SELECT-TDISTHD.                                 03563001
035640     IF RC074-AUTO-VE-NO                                          03564001
035650         MOVE ZERO             TO RC074-VERIFY-ITM-QTY            03565001
035660     ELSE                                                         03566001
035670         MOVE ZERO             TO RC074-VERIFY-ITM-QTY            03567001
035680                                  RC074-FCSE-ACTL-ITM-QTY         03568001
035690                                  RC074-P2L-ACTL-ITM-QTY          03569001
035700                                  RC074-TOTAL-ACTL-ITM-QTY        03570001
035710         PERFORM 4410-SUM-LINE-STR-OTBND-UPC                      03571001
035720         IF DISTHD-RSLTS-RCVD-TMST = PC-DB2-DEFAULT-TIMESTAMP     03572001
035730             MOVE 0           TO RC074-P2L-ACTL-ITM-QTY           03573001
035740         ELSE                                                     03574001
035750             PERFORM 4420-SUM-LINE-STR-P2L-ACTL                   03575001
035760         END-IF                                                   03576001
035770     END-IF.                                                      03577001
035780     COMPUTE RC074-TOTAL-ACTL-ITM-QTY =                           03578001
035790           RC074-FCSE-ACTL-ITM-QTY +                              03579001
035800           RC074-P2L-ACTL-ITM-QTY.                                03580001
035810     PERFORM 4320-SUM-TRECDIS-DRIVE.                              03581001
035820     PERFORM 4325-SUM-TRECDIS-DRIVE.                              03582001
035830     PERFORM 4328-SUM-TRECDIS-DRIVE-ORIG.                         03583001
035840     MOVE PV-LNE-INVCED-ITM-QTY  TO PV-LNE-EXPTED-ITM-QTY.        03584004
035850     ADD PV-LNE-EXPTED-ORIG-ITM-QTY TO PV-LNE-INVCED-ITM-QTY.     03585004
035860     PERFORM 4329-SELECT-ODD-UNITS.                               03586001
035870     IF DISTDT-P2L-SPLT-UNT-QTY > 0 AND                           03587001
035880        DISTDT-FCSE-SPLT-UNT-QTY = 0 AND                          03588001
035890        DISTDT-INPK-SPLT-UNT-QTY = 0                              03589001
035900         SET PS-P2L-LINE  TO TRUE                                 03590001
035910     ELSE                                                         03591001
035920         SET PS-NOT-P2L-LINE  TO TRUE                             03592001
035930     END-IF.                                                      03593001
035940     IF RECITM-PREPK-RATO-QTY > 0                                 03594001
035950         IF PS-P2L-LINE                                           03595001
035960             COMPUTE RC074-P2L-INVC-PACK-QTY =                    03596004
035970                 PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY    03597004
035980             COMPUTE RC074-P2L-EXPT-PACK-QTY =                    03598004
035990                 PV-LNE-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY    03599004
036000         ELSE                                                     03600001
036010             COMPUTE RC074-FCSE-INVC-PACK-QTY =                   03601004
036020                 PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY    03602004
036030             COMPUTE RC074-FCSE-EXPT-PACK-QTY =                   03603004
036040                 PV-LNE-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY    03604004
036050         END-IF                                                   03605001
036060         IF RC074-AUTO-VE-NO                                      03606001
036070             IF PS-P2L-LINE                                       03607001
036080                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                03608001
036090                    (PV-LNE-VERIFY-ITM-QTY                        03609001
036100                               - PV-ODD-DC-VERIFY-ODU-PK-QTY)     03610001
036110                                       / RECITM-PREPK-RATO-QTY    03611001
036120             ELSE                                                 03612001
036130                 COMPUTE RC074-FCSE-ACTL-PACK-QTY =               03613001
036140                    (PV-LNE-VERIFY-ITM-QTY                        03614001
036150                               - PV-ODD-DC-VERIFY-ODU-PK-QTY)     03615001
036160                                       / RECITM-PREPK-RATO-QTY    03616001
036170             END-IF                                               03617001
036180         ELSE                                                     03618001
036190             PERFORM 4450-SUM-PO-RCVR-STORE-PACKS                 03619001
036200             IF RC074-P2L-ACTL-ITM-QTY > 0                        03620001
036210                 MOVE DK-PO-DRIVER-LNE    TO DK-LINE-NBR          03621001
036220                 PERFORM 8075-SUM-LINE-STR-P2L-ACTL               03622001
036230                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                03623001
036240                      PV-P2L-ACTL-ITM-QTY                         03624001
036250                                       / RECITM-PREPK-RATO-QTY    03625001
036260             END-IF                                               03626001
036270         END-IF                                                   03627001
036280     END-IF.                                                      03628001
036290     COMPUTE RC074-TOTAL-INVC-PACK-QTY =                          03629004
036300             RC074-FCSE-INVC-PACK-QTY + RC074-P2L-INVC-PACK-QTY.  03630004
036310     COMPUTE RC074-TOTAL-EXPT-PACK-QTY =                          03631004
036320        RC074-FCSE-EXPT-PACK-QTY + RC074-P2L-EXPT-PACK-QTY.       03632004
036330     COMPUTE RC074-TOTAL-ACTL-PACK-QTY =                          03633001
036340             RC074-FCSE-ACTL-PACK-QTY + RC074-P2L-ACTL-PACK-QTY.  03634001
036350     IF RC074-AUTO-VE-NO                                          03635001
036360         PERFORM 4329-SELECT-ODD-UNITS                            03636001
036370     ELSE                                                         03637001
036380         PERFORM 8210-SELECT-OTBND-CART                           03638001
036390         IF PV-ODD-UNT-CRTN-COUNT > 0                             03639001
036400             PERFORM 5100-PROCESS-PACK-STR-CSR                    03640001
036410             MOVE 0       TO RC074-VERIFY-ODD-QTY                 03641001
036420         ELSE                                                     03642001
036430             MOVE 0       TO RC074-ACTUAL-ODD-QTY                 03643001
036440                             RC074-VERIFY-ODD-QTY                 03644001
036450         END-IF                                                   03645001
036460     END-IF.                                                      03646001
036470                                                                  03647001
036480***  PERFORM 4120-SELECT-DRIVER-RATIO.                            03648001
036490***  MOVE RECITM-ORD-LNE-NBR TO DK-PO-DRIVER-LNE.                 03649001
036500***  PERFORM 4410-SUM-LINE-STR-OTBND-UPC.                         03650001
036510***  PERFORM 4430-SUM-LINE-OTBND-UPC.                             03651001
036520***  PERFORM 4330-SELECT-ODD-UNITS-DRIVER.                        03652001
036530***  PERFORM 4440-SUM-LINE-P2L-ACTL.                              03653001
036540***  PERFORM 4450-SUM-PO-RCVR-STORE-PACKS.                        03654001
036550***  PERFORM 4240-SELECT-TDISTHD.                                 03655001
036560***  IF PS-TDISTHD-FOUND                                          03656001
036570***      PERFORM 7060-GET-TDISTDT                                 03657001
036580***  END-IF.                                                      03658001
036590***  PERFORM 8210-SELECT-OTBND-CART.                              03659001
036600***  IF PV-ODD-UNT-CRTN-COUNT > 0                                 03660001
036610***      PERFORM 5100-PROCESS-PACK-STR-CSR                        03661001
036620***      MOVE 0       TO RC074-VERIFY-ODD-QTY                     03662001
036630***  ELSE                                                         03663001
036640***      MOVE 0       TO RC074-ACTUAL-ODD-QTY                     03664001
036650***                      RC074-VERIFY-ODD-QTY                     03665001
036660***  END-IF.                                                      03666001
036670***                                                               03667001
036680***  IF PS-TDISTHD-FOUND                                          03668001
036690***      IF (DISTHD-P2L-CART-CNT > 0                              03669001
036700***          AND (DISTHD-FCSE-CART-CNT > 0                        03670001
036710***          OR DISTHD-INPK-CART-CNT > 0))                        03671001
036720***          ADD DISTDT-FCSE-SPLT-UNT-QTY                         03672001
036730***             TO DISTDT-INPK-SPLT-UNT-QTY                       03673001
036740***                GIVING PV-CASE-PKSLP                           03674001
036750***          IF RECITM-PREPK-RATO-QTY > 0                         03675001
036760***              COMPUTE RC074-P2L-INVC-PACK-QTY =                03676004
036770***               DISTDT-P2L-SPLT-UNT-QTY                         03677001
036780***                             / RECITM-PREPK-RATO-QTY           03678001
036790***              COMPUTE RC074-FCSE-INVC-PACK-QTY =               03679004
036800***               PV-CASE-PKSLP / RECITM-PREPK-RATO-QTY           03680001
036810***              COMPUTE RC074-P2L-ACTL-PACK-QTY =                03681001
036820***               DISTDT-ACTL-ALLOC-QTY                           03682001
036830***                           / RECITM-PREPK-RATO-QTY             03683001
036840***              IF DISTHD-FCSE-CNFRMN-TMST =                     03684001
036850***                                       PC-DB2-DEFAULT-TIMESTAMP03685001
036860***                  IF RECITM-PREPK-RATO-QTY > 0                 03686001
036870***                      COMPUTE RC074-FCSE-ACTL-PACK-QTY =       03687001
036880***                       DISTDT-FCSE-ACTL-UNT-QTY                03688001
036890***                                     / RECITM-PREPK-RATO-QTY   03689001
036900***                  END-IF                                       03690001
036910***              END-IF                                           03691001
036920***          END-IF                                               03692001
036930***      ELSE                                                     03693001
036940***          IF (DISTHD-P2L-CART-CNT > 0                          03694001
036950***             AND (DISTHD-FCSE-CART-CNT = 0                     03695001
036960***             AND DISTHD-INPK-CART-CNT = 0))                    03696001
036970***              IF RECITM-PREPK-RATO-QTY > 0                     03697001
036980***                  COMPUTE RC074-P2L-INVC-PACK-QTY =            03698004
036990***                   DISTDT-P2L-SPLT-UNT-QTY                     03699001
037000***                                 / RECITM-PREPK-RATO-QTY       03700001
037010***                  COMPUTE RC074-P2L-ACTL-PACK-QTY =            03701001
037020***                   DISTDT-ACTL-ALLOC-QTY                       03702001
037030***                               / RECITM-PREPK-RATO-QTY         03703001
037040***              END-IF                                           03704001
037050***          ELSE                                                 03705001
037060***              IF DISTDT-P2L-SPLT-UNT-QTY = 0 AND               03706001
037070***                 (DISTDT-FCSE-SPLT-UNT-QTY > 0 OR              03707001
037080***                  DISTDT-INPK-SPLT-UNT-QTY > 0)                03708001
037090***                  IF RECITM-PREPK-RATO-QTY > 0                 03709001
037100***                      ADD DISTDT-FCSE-SPLT-UNT-QTY             03710001
037110***                         TO DISTDT-INPK-SPLT-UNT-QTY           03711001
037120***                            GIVING PV-CASE-PKSLP               03712001
037130***                      COMPUTE RC074-FCSE-INVC-PACK-QTY =       03713004
037140***                       PV-CASE-PKSLP / RECITM-PREPK-RATO-QTY   03714001
037150***                  END-IF                                       03715001
037160***                                                               03716001
037170***                  IF DISTHD-FCSE-CNFRMN-TMST =                 03717001
037180***                                       PC-DB2-DEFAULT-TIMESTAMP03718001
037190***                      IF RECITM-PREPK-RATO-QTY > 0             03719001
037200***                          COMPUTE RC074-FCSE-ACTL-PACK-QTY =   03720001
037210***                           DISTDT-FCSE-ACTL-UNT-QTY            03721001
037220***                                     / RECITM-PREPK-RATO-QTY   03722001
037230***                      END-IF                                   03723001
037240***                  END-IF                                       03724001
037250***              ELSE                                             03725001
037260***                  COMPUTE RC074-FCSE-INVC-PACK-QTY =           03726004
037270***                  PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY03727004
037280***                  COMPUTE RC074-FCSE-ACTL-PACK-QTY =           03728001
037290***                     (PV-LNE-VERIFY-ITM-QTY                    03729001
037300***                        - PV-ODD-DC-VERIFY-ODU-PK-QTY)         03730001
037310***                                      / RECITM-PREPK-RATO-QTY  03731001
037320***                                                               03732001
037330***                  COMPUTE RC074-TOTAL-INVC-PACK-QTY =          03733004
037340***                      PV-LNE-INVCED-ITM-QTY                    03734004
037350***                                        / RECITM-PREPK-RATO-QTY03735001
037360***                  COMPUTE RC074-TOTAL-ACTL-PACK-QTY =          03736001
037370***                     (PV-LNE-VERIFY-ITM-QTY                    03737001
037380***                             - PV-ODD-DC-VERIFY-ODU-PK-QTY)    03738001
037390***                                      / RECITM-PREPK-RATO-QTY  03739001
037400***                                                               03740001
037410***                                                               03741001
037420***              END-IF                                           03742001
037430***          END-IF                                               03743001
037440***      END-IF                                                   03744001
037450***  ELSE                                                         03745001
037460***      COMPUTE RC074-FCSE-INVC-PACK-QTY =                       03746004
037470***          PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY        03747004
037480***      COMPUTE RC074-FCSE-ACTL-PACK-QTY =                       03748001
037490***         (PV-LNE-VERIFY-ITM-QTY                                03749001
037500***            - PV-ODD-DC-VERIFY-ODU-PK-QTY)                     03750001
037510***                          / RECITM-PREPK-RATO-QTY              03751001
037520***  END-IF.                                                      03752001
037530***                                                               03753001
037540***  COMPUTE RC074-TOTAL-INVC-PACK-QTY =                          03754004
037550***       RC074-P2L-INVC-PACK-QTY +                               03755004
037560***       RC074-FCSE-INVC-PACK-QTY.                               03756004
037570***  COMPUTE RC074-TOTAL-ACTL-PACK-QTY =                          03757001
037580***       RC074-P2L-ACTL-PACK-QTY +                               03758001
037590***       RC074-FCSE-ACTL-PACK-QTY.                               03759001
037600                                                                  03760001
037610                                                                  03761001
037620 4410-SUM-LINE-STR-OTBND-UPC.                                     03762001
037630                                                                  03763001
037640     MOVE ZERO                 TO  RC074-FCSE-ACTL-ITM-QTY.       03764001
037650                                                                  03765001
037660     EXEC SQL                                                     03766001
037670          SELECT                                                  03767001
037680                 SUM(A.SHPD_UNT_QTY)                              03768001
037690          INTO                                                    03769001
037700                :RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          03770001
037710          FROM                                                    03771001
037720                 SUT_OTBND_UPC A                                  03772001
037730              ,  SUT_OTBND_CART B                                 03773001
037740              ,  TRECITM  C                                       03774001
037750          WHERE                                                   03775001
037760                A.TRN_NBR        =  :RC074-PO-NBR                 03776001
037770           AND  A.TRN_NBR        =   C.ORD_NBR                    03777001
037780           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           03778001
037790           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                03779001
037800           AND  B.DEST_LOC_NBR   =  :RC074-STR-NBR                03780001
037810           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               03781001
037820           AND  B.ACTV_IND       =  'Y'                           03782001
037830           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              03783001
037840           AND  A.TRN_LNE_NBR      =  C.ORD_LNE_NBR               03784001
037850           AND  C.VER_STATUS_CDE   =  'A'                         03785001
037860           AND  C.PREPK_ID         = :DK-PACK-ID                  03786001
037870     END-EXEC.                                                    03787001
037880                                                                  03788001
037890     EVALUATE TRUE                                                03789001
037900         WHEN SQLCODE = ZERO                                      03790001
037910         WHEN SQLCODE = +100                                      03791001
037920         WHEN SQLCODE = -305                                      03792001
037930              CONTINUE                                            03793001
037940         WHEN SQLCODE = -904                                      03794001
037950         WHEN SQLCODE = -911                                      03795001
037960         WHEN SQLCODE = -913                                      03796001
037970              SET  RC074-DATABASE-BUSY                            03797001
037980                   RC074-ERROR-YES                                03798001
037990                   PS-ERROR-YES         TO  TRUE                  03799001
038000              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03800001
038010              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      03801001
038020              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    03802001
038030              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03803001
038040              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03804001
038050              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03805001
038060              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03806001
038070             STRING   ' RCKUT128-4410-'                           03807001
038080                      ' CALLED BY-'                               03808001
038090                      RC074-CALLING-PROGRAM                       03809001
038100                      ' PO='                                      03810001
038110                      RC074-DISPLAY-PO                            03811001
038120                      ' RCVR='                                    03812001
038130                      RC074-DISPLAY-RCVR                          03813001
038140                      ' LINE='                                    03814001
038150                      RC074-DISPLAY-LINE                          03815001
038160                      ' STR='                                     03816001
038170                      RC074-DISPLAY-STR                           03817001
038180                      ' SQLCODE='                                 03818001
038190                      RC074-DISPLAY-SQLCODE                       03819001
038200                      DELIMITED BY SIZE                           03820001
038210                                      INTO RC074-CRA-RET-MSG      03821001
038220             STRING   ' RCKUT128-4410-'                           03822001
038230                      ' CALLED BY-'                               03823001
038240                      RC074-CALLING-PROGRAM                       03824001
038250                      DELIMITED BY SIZE                           03825001
038260                                      INTO RC074-ABEND-TEXT       03826001
038270             MOVE '4410-'               TO RC074-CRA-REQ-ID       03827001
038280                                           RC074-ABEND-PARAGRAPH  03828001
038290             PERFORM 9998-RETURN                                  03829001
038300                                                                  03830001
038310         WHEN SQLWARN0 NOT = SPACE                                03831001
038320         WHEN SQLCODE NOT = ZERO                                  03832001
038330              SET  RC074-INVALID-SQL                              03833001
038340                   RC074-ERROR-YES                                03834001
038350                   PS-ERROR-YES         TO  TRUE                  03835001
038360              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03836001
038370              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      03837001
038380              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    03838001
038390              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03839001
038400              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03840001
038410              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03841001
038420              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03842001
038430             STRING   ' RCKUT128-4410-'                           03843001
038440                      ' CALLED BY-'                               03844001
038450                      RC074-CALLING-PROGRAM                       03845001
038460                      ' PO='                                      03846001
038470                      RC074-DISPLAY-PO                            03847001
038480                      ' RCVR='                                    03848001
038490                      RC074-DISPLAY-RCVR                          03849001
038500                      ' LINE='                                    03850001
038510                      RC074-DISPLAY-LINE                          03851001
038520                      ' STR='                                     03852001
038530                      RC074-DISPLAY-STR                           03853001
038540                      ' SQLCODE='                                 03854001
038550                      RC074-DISPLAY-SQLCODE                       03855001
038560                      DELIMITED BY SIZE                           03856001
038570                                      INTO RC074-CRA-RET-MSG      03857001
038580             STRING   ' RCKUT128-4410-'                           03858001
038590                      ' CALLED BY-'                               03859001
038600                      RC074-CALLING-PROGRAM                       03860001
038610                      DELIMITED BY SIZE                           03861001
038620                                      INTO RC074-ABEND-TEXT       03862001
038630             MOVE '4410-'               TO RC074-CRA-REQ-ID       03863001
038640                                           RC074-ABEND-PARAGRAPH  03864001
038650             PERFORM 9998-RETURN                                  03865001
038660                                                                  03866001
038670     END-EVALUATE.                                                03867001
038680                                                                  03868001
038690                                                                  03869001
038700 4420-SUM-LINE-STR-P2L-ACTL.                                      03870001
038710                                                                  03871001
038720     MOVE ZERO                 TO  RC074-P2L-ACTL-ITM-QTY.        03872001
038730                                                                  03873001
038740     EXEC SQL                                                     03874001
038750          SELECT                                                  03875001
038760                 SUM(A.ACTL_ALLOC_QTY)                            03876001
038770          INTO                                                    03877001
038780                :RC074-P2L-ACTL-ITM-QTY   :RC074-NULL-IND         03878001
038790          FROM                                                    03879001
038800                 TDISTDT A                                        03880001
038810                ,TRECITM B                                        03881001
038820          WHERE                                                   03882001
038830                A.ORD_NBR         =  :RC074-PO-NBR                03883001
038840           AND  A.RCVR_SEQ_NBR    =  :RC074-RCVR-SEQ-NBR          03884001
038850           AND  A.STR_NBR         =  :RC074-STR-NBR               03885001
038860           AND  A.ORD_NBR         =  B.ORD_NBR                    03886001
038870           AND  A.RCVR_SEQ_NBR    =  B.REC_SEQ_NBR                03887001
038880           AND  A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                03888001
038890           AND  B.STATUS_CDE     <>  'VE'                         03889001
038900           AND  B.VER_STATUS_CDE  =  'A'                          03890001
038910           AND  B.PREPK_ID         = :DK-PACK-ID                  03891001
038920     END-EXEC.                                                    03892001
038930                                                                  03893001
038940     EVALUATE TRUE                                                03894001
038950         WHEN SQLCODE = ZERO                                      03895001
038960         WHEN SQLCODE = +100                                      03896001
038970         WHEN SQLCODE = -305                                      03897001
038980              CONTINUE                                            03898001
038990         WHEN SQLCODE = -904                                      03899001
039000         WHEN SQLCODE = -911                                      03900001
039010         WHEN SQLCODE = -913                                      03901001
039020              SET  RC074-DATABASE-BUSY                            03902001
039030                   RC074-ERROR-YES                                03903001
039040                   PS-ERROR-YES         TO  TRUE                  03904001
039050              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03905001
039060              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      03906001
039070              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    03907001
039080              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03908001
039090              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03909001
039100              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03910001
039110              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03911001
039120             STRING   ' RCKUT128-4420-'                           03912001
039130                      ' CALLED BY-'                               03913001
039140                      RC074-CALLING-PROGRAM                       03914001
039150                      ' PO='                                      03915001
039160                      RC074-DISPLAY-PO                            03916001
039170                      ' RCVR='                                    03917001
039180                      RC074-DISPLAY-RCVR                          03918001
039190                      ' LINE='                                    03919001
039200                      RC074-DISPLAY-LINE                          03920001
039210                      ' STR='                                     03921001
039220                      RC074-DISPLAY-STR                           03922001
039230                      ' SQLCODE='                                 03923001
039240                      RC074-DISPLAY-SQLCODE                       03924001
039250                      DELIMITED BY SIZE                           03925001
039260                                      INTO RC074-CRA-RET-MSG      03926001
039270             STRING   ' RCKUT128-4420-'                           03927001
039280                      ' CALLED BY-'                               03928001
039290                      RC074-CALLING-PROGRAM                       03929001
039300                      DELIMITED BY SIZE                           03930001
039310                                      INTO RC074-ABEND-TEXT       03931001
039320             MOVE '4420-'               TO RC074-CRA-REQ-ID       03932001
039330                                           RC074-ABEND-PARAGRAPH  03933001
039340             PERFORM 9998-RETURN                                  03934001
039350                                                                  03935001
039360         WHEN SQLWARN0 NOT = SPACE                                03936001
039370         WHEN SQLCODE NOT = ZERO                                  03937001
039380              SET  RC074-INVALID-SQL                              03938001
039390                   RC074-ERROR-YES                                03939001
039400                   PS-ERROR-YES         TO  TRUE                  03940001
039410              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 03941001
039420              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      03942001
039430              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    03943001
039440              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    03944001
039450              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    03945001
039460              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     03946001
039470              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    03947001
039480             STRING   ' RCKUT128-4420-'                           03948001
039490                      ' CALLED BY-'                               03949001
039500                      RC074-CALLING-PROGRAM                       03950001
039510                      ' PO='                                      03951001
039520                      RC074-DISPLAY-PO                            03952001
039530                      ' RCVR='                                    03953001
039540                      RC074-DISPLAY-RCVR                          03954001
039550                      ' LINE='                                    03955001
039560                      RC074-DISPLAY-LINE                          03956001
039570                      ' STR='                                     03957001
039580                      RC074-DISPLAY-STR                           03958001
039590                      ' SQLCODE='                                 03959001
039600                      RC074-DISPLAY-SQLCODE                       03960001
039610                      DELIMITED BY SIZE                           03961001
039620                                      INTO RC074-CRA-RET-MSG      03962001
039630             STRING   ' RCKUT128-4420-'                           03963001
039640                      ' CALLED BY-'                               03964001
039650                      RC074-CALLING-PROGRAM                       03965001
039660                      DELIMITED BY SIZE                           03966001
039670                                      INTO RC074-ABEND-TEXT       03967001
039680             MOVE '4420-'               TO RC074-CRA-REQ-ID       03968001
039690                                           RC074-ABEND-PARAGRAPH  03969001
039700             PERFORM 9998-RETURN                                  03970001
039710                                                                  03971001
039720     END-EVALUATE.                                                03972001
039730                                                                  03973001
039740 4430-SUM-LINE-OTBND-UPC.                                         03974001
039750                                                                  03975001
039760     MOVE ZERO                 TO  PV-LNE-FCSE-ACTL-ITM-QTY.      03976001
039770                                                                  03977001
039780     EXEC SQL                                                     03978001
039790          SELECT                                                  03979001
039800                 SUM(A.SHPD_UNT_QTY)                              03980001
039810          INTO                                                    03981001
039820                :PV-LNE-FCSE-ACTL-ITM-QTY :RC074-NULL-IND         03982001
039830          FROM                                                    03983001
039840                 SUT_OTBND_UPC A                                  03984001
039850                ,SUT_OTBND_CART B                                 03985001
039860          WHERE                                                   03986001
039870                A.TRN_NBR        =  :DK-PO-NBR                    03987001
039880           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              03988001
039890           AND  A.TRN_LNE_NBR    =  :RECITM-ORD-LNE-NBR           03989001
039900           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               03990001
039910           AND  B.ACTV_IND       =  'Y'                           03991001
039920           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              03992001
039930           AND  B.DEST_LOC_NBR   =  :DK-STR-NBR                   03993001
039940     END-EXEC.                                                    03994001
039950                                                                  03995001
039960     EVALUATE TRUE                                                03996001
039970         WHEN SQLCODE = ZERO                                      03997001
039980         WHEN SQLCODE = +100                                      03998001
039990         WHEN SQLCODE = -305                                      03999001
040000              CONTINUE                                            04000001
040010         WHEN SQLCODE = -904                                      04001001
040020         WHEN SQLCODE = -911                                      04002001
040030         WHEN SQLCODE = -913                                      04003001
040040              SET  RC074-DATABASE-BUSY                            04004001
040050                   RC074-ERROR-YES                                04005001
040060                   PS-ERROR-YES         TO  TRUE                  04006001
040070              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04007001
040080              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04008001
040090              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04009001
040100              MOVE RECITM-ORD-LNE-NBR   TO  RC074-DISPLAY-LINE    04010001
040110              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04011001
040120              MOVE DK-STR-NBR           TO  RC074-DISPLAY-STR     04012001
040130              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04013001
040140             STRING   ' RCKUT128-4430-'                           04014001
040150                      ' CALLED BY-'                               04015001
040160                      RC074-CALLING-PROGRAM                       04016001
040170                      ' PO='                                      04017001
040180                      RC074-DISPLAY-PO                            04018001
040190                      ' RCVR='                                    04019001
040200                      RC074-DISPLAY-RCVR                          04020001
040210                      ' LINE='                                    04021001
040220                      RC074-DISPLAY-LINE                          04022001
040230                      ' SQLCODE'                                  04023001
040240                      RC074-DISPLAY-SQLCODE                       04024001
040250                      DELIMITED BY SIZE                           04025001
040260                                      INTO RC074-CRA-RET-MSG      04026001
040270             STRING   ' RCKUT128-4430-'                           04027001
040280                      ' CALLED BY-'                               04028001
040290                      RC074-CALLING-PROGRAM                       04029001
040300                      DELIMITED BY SIZE                           04030001
040310                                      INTO RC074-ABEND-TEXT       04031001
040320             MOVE '4430-'               TO RC074-CRA-REQ-ID       04032001
040330                                           RC074-ABEND-PARAGRAPH  04033001
040340             PERFORM 9998-RETURN                                  04034001
040350                                                                  04035001
040360         WHEN SQLWARN0 NOT = SPACE                                04036001
040370         WHEN SQLCODE NOT = ZERO                                  04037001
040380              SET  RC074-INVALID-SQL                              04038001
040390                   RC074-ERROR-YES                                04039001
040400                   PS-ERROR-YES         TO  TRUE                  04040001
040410              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04041001
040420              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04042001
040430              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04043001
040440              MOVE RECITM-ORD-LNE-NBR   TO  RC074-DISPLAY-LINE    04044001
040450              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04045001
040460              MOVE DK-STR-NBR           TO  RC074-DISPLAY-STR     04046001
040470              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04047001
040480             STRING   ' RCKUT128-4430-'                           04048001
040490                      ' CALLED BY-'                               04049001
040500                      RC074-CALLING-PROGRAM                       04050001
040510                      ' PO='                                      04051001
040520                      RC074-DISPLAY-PO                            04052001
040530                      ' RCVR='                                    04053001
040540                      RC074-DISPLAY-RCVR                          04054001
040550                      ' LINE='                                    04055001
040560                      RC074-DISPLAY-LINE                          04056001
040570                      ' SQLCODE'                                  04057001
040580                      RC074-DISPLAY-SQLCODE                       04058001
040590                      DELIMITED BY SIZE                           04059001
040600                                      INTO RC074-CRA-RET-MSG      04060001
040610             STRING   ' RCKUT128-4430-'                           04061001
040620                      ' CALLED BY-'                               04062001
040630                      RC074-CALLING-PROGRAM                       04063001
040640                      DELIMITED BY SIZE                           04064001
040650                                      INTO RC074-ABEND-TEXT       04065001
040660             MOVE '4430-'               TO RC074-CRA-REQ-ID       04066001
040670                                           RC074-ABEND-PARAGRAPH  04067001
040680             PERFORM 9998-RETURN                                  04068001
040690                                                                  04069001
040700     END-EVALUATE.                                                04070001
040710                                                                  04071001
040720                                                                  04072001
040730 4440-SUM-LINE-P2L-ACTL.                                          04073001
040740                                                                  04074001
040750     MOVE ZERO                 TO  PV-LNE-P2L-ACTL-ITM-QTY.       04075001
040760                                                                  04076001
040770     EXEC SQL                                                     04077001
040780          SELECT                                                  04078001
040790                 SUM(A.ACTL_ALLOC_QTY)                            04079001
040800          INTO                                                    04080001
040810                :PV-LNE-P2L-ACTL-ITM-QTY  :RC074-NULL-IND         04081001
040820          FROM                                                    04082001
040830                 TDISTDT A                                        04083001
040840                ,TRECITM B                                        04084001
040850          WHERE                                                   04085001
040860                A.ORD_NBR         =  :DK-PO-NBR                   04086001
040870           AND  A.RCVR_SEQ_NBR    =  :DK-RCVR-SEQ-NBR             04087001
040880           AND  A.ORD_LNE_NBR     =  :RECITM-ORD-LNE-NBR          04088001
040890           AND  A.ORD_NBR         =  B.ORD_NBR                    04089001
040900           AND  A.RCVR_SEQ_NBR    =  B.REC_SEQ_NBR                04090001
040910           AND  A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                04091001
040920           AND  B.STATUS_CDE     <>  'VE'                         04092001
040930           AND  B.VER_STATUS_CDE  =  'A'                          04093001
040940     END-EXEC.                                                    04094001
040950                                                                  04095001
040960     EVALUATE TRUE                                                04096001
040970         WHEN SQLCODE = ZERO                                      04097001
040980         WHEN SQLCODE = +100                                      04098001
040990         WHEN SQLCODE = -305                                      04099001
041000              CONTINUE                                            04100001
041010         WHEN SQLCODE = -904                                      04101001
041020         WHEN SQLCODE = -911                                      04102001
041030         WHEN SQLCODE = -913                                      04103001
041040              SET  RC074-DATABASE-BUSY                            04104001
041050                   RC074-ERROR-YES                                04105001
041060                   PS-ERROR-YES         TO  TRUE                  04106001
041070              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04107001
041080              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04108001
041090              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04109001
041100              MOVE RECITM-ORD-LNE-NBR   TO  RC074-DISPLAY-LINE    04110001
041110              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04111001
041120              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04112001
041130              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04113001
041140             STRING   ' RCKUT128-4440-'                           04114001
041150                      ' CALLED BY-'                               04115001
041160                      RC074-CALLING-PROGRAM                       04116001
041170                      ' PO='                                      04117001
041180                      RC074-DISPLAY-PO                            04118001
041190                      ' RCVR='                                    04119001
041200                      RC074-DISPLAY-RCVR                          04120001
041210                      ' LINE='                                    04121001
041220                      RC074-DISPLAY-LINE                          04122001
041230                      ' SQLCODE='                                 04123001
041240                      RC074-DISPLAY-SQLCODE                       04124001
041250                      DELIMITED BY SIZE                           04125001
041260                                      INTO RC074-CRA-RET-MSG      04126001
041270             STRING   ' RCKUT128-4440-'                           04127001
041280                      ' CALLED BY-'                               04128001
041290                      RC074-CALLING-PROGRAM                       04129001
041300                      DELIMITED BY SIZE                           04130001
041310                                      INTO RC074-ABEND-TEXT       04131001
041320             MOVE '4440-'               TO RC074-CRA-REQ-ID       04132001
041330                                           RC074-ABEND-PARAGRAPH  04133001
041340             PERFORM 9998-RETURN                                  04134001
041350                                                                  04135001
041360         WHEN SQLWARN0 NOT = SPACE                                04136001
041370         WHEN SQLCODE NOT = ZERO                                  04137001
041380              SET  RC074-INVALID-SQL                              04138001
041390                   RC074-ERROR-YES                                04139001
041400                   PS-ERROR-YES         TO  TRUE                  04140001
041410              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04141001
041420              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04142001
041430              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04143001
041440              MOVE RECITM-ORD-LNE-NBR   TO  RC074-DISPLAY-LINE    04144001
041450              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04145001
041460              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04146001
041470              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04147001
041480             STRING   ' RCKUT128-4440-'                           04148001
041490                      ' CALLED BY-'                               04149001
041500                      RC074-CALLING-PROGRAM                       04150001
041510                      ' PO='                                      04151001
041520                      RC074-DISPLAY-PO                            04152001
041530                      ' RCVR='                                    04153001
041540                      RC074-DISPLAY-RCVR                          04154001
041550                      ' LINE='                                    04155001
041560                      RC074-DISPLAY-LINE                          04156001
041570                      ' SQLCODE='                                 04157001
041580                      RC074-DISPLAY-SQLCODE                       04158001
041590                      DELIMITED BY SIZE                           04159001
041600                                      INTO RC074-CRA-RET-MSG      04160001
041610             STRING   ' RCKUT128-4440-'                           04161001
041620                      ' CALLED BY-'                               04162001
041630                      RC074-CALLING-PROGRAM                       04163001
041640                      DELIMITED BY SIZE                           04164001
041650                                      INTO RC074-ABEND-TEXT       04165001
041660             MOVE '4440-'               TO RC074-CRA-REQ-ID       04166001
041670                                           RC074-ABEND-PARAGRAPH  04167001
041680             PERFORM 9998-RETURN                                  04168001
041690                                                                  04169001
041700     END-EVALUATE.                                                04170001
041710                                                                  04171001
041720 4450-SUM-PO-RCVR-STORE-PACKS.                                    04172001
041730     EXEC SQL                                                     04173001
041740           SELECT SUM(A.SHPD_PK_QTY)                              04174001
041750            INTO :PV-TOTAL-PACKS :PV-NULL-IND                     04175001
041760            FROM SUT_OTBND_PK  A                                  04176001
041770              ,  SUT_OTBND_CART B                                 04177001
041780              ,  TPOPRPK  C                                       04178001
041790          WHERE                                                   04179001
041800                A.TRN_NBR        =  :DK-PO-NBR                    04180001
041810           AND  A.TRN_NBR        =   C.PO_NBR                     04181001
041820           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              04182001
041830           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               04183001
041840           AND  B.ACTV_IND       =  'Y'                           04184001
041850           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              04185001
041860           AND  B.DEST_LOC_NBR   =  :DK-STR-NBR                   04186001
041870           AND  A.PK_SKU_NBR       =  C.PK_SKU_NBR                04187001
041880           AND  C.PO_PREPK_ID      = :DK-PACK-ID                  04188001
041890     END-EXEC.                                                    04189001
041900                                                                  04190001
041910                                                                  04191001
041920     EVALUATE TRUE                                                04192001
041930         WHEN SQLCODE = ZERO                                      04193001
041940             IF PV-NULL-IND = -1                                  04194001
041950                 MOVE 0    TO PV-TOTAL-PACKS                      04195001
041960             END-IF                                               04196001
041970             MOVE PV-TOTAL-PACKS     TO RC074-FCSE-ACTL-PACK-QTY  04197001
041980         WHEN SQLCODE = -904                                      04198001
041990         WHEN SQLCODE = -911                                      04199001
042000         WHEN SQLCODE = -913                                      04200001
042010              SET  RC074-DATABASE-BUSY                            04201001
042020                   RC074-ERROR-YES                                04202001
042030                   PS-ERROR-YES         TO  TRUE                  04203001
042040              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04204001
042050              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04205001
042060              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04206001
042070              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04207001
042080              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04208001
042090              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04209001
042100              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04210001
042110             STRING   ' RCKUT128-4450-'                           04211001
042120                      ' CALLED BY-'                               04212001
042130                      RC074-CALLING-PROGRAM                       04213001
042140                      ' PO='                                      04214001
042150                      RC074-DISPLAY-PO                            04215001
042160                      ' RCVR='                                    04216001
042170                      RC074-DISPLAY-RCVR                          04217001
042180                      ' SQLCODE='                                 04218001
042190                      RC074-DISPLAY-SQLCODE                       04219001
042200                      DELIMITED BY SIZE                           04220001
042210                                      INTO RC074-CRA-RET-MSG      04221001
042220             STRING   ' RCKUT128-4450-'                           04222001
042230                      ' CALLED BY-'                               04223001
042240                      RC074-CALLING-PROGRAM                       04224001
042250                      DELIMITED BY SIZE                           04225001
042260                                      INTO RC074-ABEND-TEXT       04226001
042270             MOVE '4450-'               TO RC074-CRA-REQ-ID       04227001
042280                                           RC074-ABEND-PARAGRAPH  04228001
042290             PERFORM 9998-RETURN                                  04229001
042300                                                                  04230001
042310         WHEN SQLWARN0 NOT = SPACES                               04231001
042320         WHEN SQLCODE < ZERO                                      04232001
042330         WHEN SQLCODE > ZERO                                      04233001
042340              SET  RC074-INVALID-SQL                              04234001
042350                   RC074-ERROR-YES                                04235001
042360                   PS-ERROR-YES         TO  TRUE                  04236001
042370              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04237001
042380              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04238001
042390              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04239001
042400              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04240001
042410              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04241001
042420              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04242001
042430              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04243001
042440             STRING   ' RCKUT128-4450-'                           04244001
042450                      ' CALLED BY-'                               04245001
042460                      RC074-CALLING-PROGRAM                       04246001
042470                      ' PO='                                      04247001
042480                      RC074-DISPLAY-PO                            04248001
042490                      ' RCVR='                                    04249001
042500                      RC074-DISPLAY-RCVR                          04250001
042510                      ' SQLCODE='                                 04251001
042520                      RC074-DISPLAY-SQLCODE                       04252001
042530                      DELIMITED BY SIZE                           04253001
042540                                      INTO RC074-CRA-RET-MSG      04254001
042550             STRING   ' RCKUT128-4450-'                           04255001
042560                      ' CALLED BY-'                               04256001
042570                      RC074-CALLING-PROGRAM                       04257001
042580                      DELIMITED BY SIZE                           04258001
042590                                      INTO RC074-ABEND-TEXT       04259001
042600             MOVE '4450-'               TO RC074-CRA-REQ-ID       04260001
042610                                           RC074-ABEND-PARAGRAPH  04261001
042620             PERFORM 9998-RETURN                                  04262001
042630                                                                  04263001
042640     END-EVALUATE.                                                04264001
042650                                                                  04265001
042660                                                                  04266001
042670 4500-CALC-PACK-LIN-STR-CNTS-VE.                                  04267001
042680     PERFORM 8015-VERIFIED-LINE-STR-QTY.                          04268001
042690     PERFORM 8016-VERIFIED-LINE-STR-QTY.                          04269001
042700     PERFORM 8018-VERIFIED-LNE-STR-QTY-ORIG.                      04270001
042710     MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY.           04271004
042720     ADD PV-ORIG-EXPTED-ITM-QTY                                   04272001
042730                          TO RC074-INVCED-ITM-QTY.                04273004
042740     MOVE RC074-LINE-NBR     TO DK-PO-DRIVER-LNE                  04274001
042750                                DK-LINE-NBR.                      04275001
042760     PERFORM 4620-SELECT-RATIO.                                   04276001
042770     PERFORM 4320-SUM-TRECDIS-DRIVE.                              04277001
042780     PERFORM 4325-SUM-TRECDIS-DRIVE.                              04278001
042790     PERFORM 4328-SUM-TRECDIS-DRIVE-ORIG.                         04279001
042800     MOVE PV-LNE-INVCED-ITM-QTY  TO PV-LNE-EXPTED-ITM-QTY.        04280004
042810     ADD PV-LNE-EXPTED-ORIG-ITM-QTY TO PV-LNE-INVCED-ITM-QTY.     04281004
042820     PERFORM 4510-SELECT-ODD-UNITS.                               04282001
042830                                                                  04283001
042840     IF RECITM-PREPK-RATO-QTY > 0                                 04284001
042850         MOVE PV-LNE-INVCED-ITM-QTY  TO RC074-FCSE-INVC-PACK-QTY  04285004
042860         MOVE RC074-FCSE-INVC-PACK-QTY TO                         04286004
042870                  RC074-TOTAL-INVC-PACK-QTY                       04287004
042880         MOVE PV-LNE-EXPTED-ITM-QTY                               04288004
042890                              TO RC074-FCSE-EXPT-PACK-QTY         04289004
042900         MOVE RC074-FCSE-EXPT-PACK-QTY TO                         04290004
042910                  RC074-TOTAL-EXPT-PACK-QTY                       04291004
042920         COMPUTE RC074-FCSE-ACTL-PACK-QTY =                       04292001
042930            (PV-LNE-VERIFY-ITM-QTY                                04293001
042940                       - RC074-ACTUAL-ODD-QTY)                    04294001
042950                                        / RECITM-PREPK-RATO-QTY   04295001
042960         MOVE RC074-FCSE-ACTL-PACK-QTY TO                         04296001
042970                  RC074-TOTAL-ACTL-PACK-QTY                       04297001
042980         IF PV-LNE-AP-VERIFY-ITM-QTY > 0                          04298001
042990             COMPUTE RC074-VERIFY-PACK-QTY =                      04299001
043000                (PV-LNE-AP-VERIFY-ITM-QTY                         04300001
043010                             - RC074-VERIFY-ODD-QTY)              04301001
043020                                        / RECITM-PREPK-RATO-QTY   04302001
043030         ELSE                                                     04303001
043040             MOVE 0                TO RC074-VERIFY-PACK-QTY       04304001
043050         END-IF                                                   04305001
043060     END-IF.                                                      04306001
043070                                                                  04307001
043080 4510-SELECT-ODD-UNITS.                                           04308001
043090                                                                  04309001
043100     EXEC SQL                                                     04310001
043110          SELECT                                                  04311001
043120                 SUM(DC_VRFY_ODU_QTY)                             04312001
043130             ,   SUM(AP_VRFY_ODU_QTY)                             04313001
043140          INTO                                                    04314001
043150                :RC074-ACTUAL-ODD-QTY :PV-NULL-IND                04315001
043160             ,  :RC074-VERIFY-ODD-QTY :PV-NULL-IND                04316001
043170          FROM                                                    04317001
043180                 RCT_VRFD_ODD_UNT                                 04318001
043190          WHERE                                                   04319001
043200                PO_NBR           =  :DK-PO-NBR                    04320001
043210           AND  PO_LNE_NBR       =  :DK-PO-DRIVER-LNE             04321001
043220           AND  RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              04322001
043230           AND  STR_NBR          =  :DK-STR-NBR                   04323001
043240     END-EXEC.                                                    04324001
043250                                                                  04325001
043260     EVALUATE TRUE                                                04326001
043270         WHEN SQLCODE = ZERO                                      04327001
043280         WHEN SQLCODE = +100                                      04328001
043290         WHEN SQLCODE = -305                                      04329001
043300              CONTINUE                                            04330001
043310         WHEN SQLWARN0 NOT = SPACE                                04331001
043320         WHEN SQLCODE NOT = ZERO                                  04332001
043330              SET  RC074-INVALID-SQL                              04333001
043340                   RC074-ERROR-YES                                04334001
043350                   PS-ERROR-YES         TO  TRUE                  04335001
043360              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04336001
043370              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04337001
043380              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04338001
043390              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04339001
043400              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04340001
043410              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04341001
043420              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04342001
043430              STRING  ' RCKUT128-4520-'                           04343001
043440                      ' CALLED BY-'                               04344001
043450                      RC074-CALLING-PROGRAM                       04345001
043460                      ' PO='                                      04346001
043470                      RC074-DISPLAY-PO                            04347001
043480                      ' RCVR='                                    04348001
043490                      RC074-DISPLAY-RCVR                          04349001
043500                      ' SQLCODE='                                 04350001
043510                      RC074-DISPLAY-SQLCODE                       04351001
043520                      DELIMITED BY SIZE                           04352001
043530                                      INTO RC074-CRA-RET-MSG      04353001
043540              STRING  ' RCKUT128-4520-'                           04354001
043550                      ' CALLED BY-'                               04355001
043560                      RC074-CALLING-PROGRAM                       04356001
043570                      DELIMITED BY SIZE                           04357001
043580                                      INTO RC074-ABEND-TEXT       04358001
043590              MOVE '4520-'              TO RC074-CRA-REQ-ID       04359001
043600                                           RC074-ABEND-PARAGRAPH  04360001
043610              PERFORM 9998-RETURN                                 04361001
043620     END-EVALUATE.                                                04362001
043630                                                                  04363001
043640 4600-CALC-PACK-LINE-STR-COUNTS.                                  04364001
043650     PERFORM 8015-VERIFIED-LINE-STR-QTY.                          04365001
043660     PERFORM 8016-VERIFIED-LINE-STR-QTY.                          04366001
043670     PERFORM 8018-VERIFIED-LNE-STR-QTY-ORIG.                      04367001
043680     MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY.           04368004
043690     ADD PV-ORIG-EXPTED-ITM-QTY TO RC074-INVCED-ITM-QTY.          04369004
043700     MOVE DK-LINE-NBR     TO DK-PO-DRIVER-LNE.                    04370001
043710     PERFORM 7060-GET-TDISTDT.                                    04371001
043720     PERFORM 4240-SELECT-TDISTHD.                                 04372001
043730     IF RC074-AUTO-VE-NO                                          04373001
043740         MOVE ZERO             TO RC074-VERIFY-ITM-QTY            04374001
043750     ELSE                                                         04375001
043760         MOVE ZERO             TO RC074-VERIFY-ITM-QTY            04376001
043770                                  RC074-FCSE-ACTL-ITM-QTY         04377001
043780                                  RC074-P2L-ACTL-ITM-QTY          04378001
043790                                  RC074-TOTAL-ACTL-ITM-QTY        04379001
043800         PERFORM 8055-SUM-LINE-STR-OTBND-UPC                      04380001
043810         IF DISTHD-RSLTS-RCVD-TMST = PC-DB2-DEFAULT-TIMESTAMP     04381001
043820             MOVE 0           TO RC074-P2L-ACTL-ITM-QTY           04382001
043830         ELSE                                                     04383001
043840             MOVE DK-PO-DRIVER-LNE    TO DK-LINE-NBR              04384001
043850             PERFORM 8075-SUM-LINE-STR-P2L-ACTL                   04385001
043860         END-IF                                                   04386001
043870     END-IF.                                                      04387001
043880     COMPUTE RC074-TOTAL-ACTL-ITM-QTY =                           04388001
043890           RC074-FCSE-ACTL-ITM-QTY +                              04389001
043900           RC074-P2L-ACTL-ITM-QTY.                                04390001
043910     PERFORM 4320-SUM-TRECDIS-DRIVE.                              04391001
043920     PERFORM 4325-SUM-TRECDIS-DRIVE.                              04392001
043930     PERFORM 4328-SUM-TRECDIS-DRIVE-ORIG.                         04393001
043940     MOVE PV-LNE-INVCED-ITM-QTY  TO PV-LNE-EXPTED-ITM-QTY.        04394004
043950     ADD PV-LNE-EXPTED-ORIG-ITM-QTY TO PV-LNE-INVCED-ITM-QTY.     04395004
043960     PERFORM 4330-SELECT-ODD-UNITS-DRIVER.                        04396001
043970     IF DISTDT-P2L-SPLT-UNT-QTY > 0 AND                           04397001
043980        DISTDT-FCSE-SPLT-UNT-QTY = 0 AND                          04398001
043990        DISTDT-INPK-SPLT-UNT-QTY = 0                              04399001
044000         SET PS-P2L-LINE  TO TRUE                                 04400001
044010     ELSE                                                         04401001
044020         SET PS-NOT-P2L-LINE  TO TRUE                             04402001
044030     END-IF.                                                      04403001
044040     MOVE DK-PO-DRIVER-LNE    TO DK-LINE-NBR.                     04404001
044050     PERFORM 4620-SELECT-RATIO.                                   04405001
044060     IF RECITM-PREPK-RATO-QTY > 0                                 04406001
044070         IF PS-P2L-LINE                                           04407001
044080             COMPUTE RC074-P2L-INVC-PACK-QTY =                    04408004
044090                 PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY    04409004
044100             COMPUTE RC074-P2L-EXPT-PACK-QTY =                    04410004
044110                 PV-LNE-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY    04411004
044120         ELSE                                                     04412001
044130             COMPUTE RC074-FCSE-INVC-PACK-QTY =                   04413004
044140                 PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY    04414004
044150             COMPUTE RC074-FCSE-EXPT-PACK-QTY =                   04415004
044160                 PV-LNE-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY    04416004
044170         END-IF                                                   04417001
044180         IF RC074-AUTO-VE-NO                                      04418001
044190             IF PS-P2L-LINE                                       04419001
044200                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                04420001
044210                    (PV-LNE-VERIFY-ITM-QTY                        04421001
044220                               - PV-ODD-DC-VERIFY-ODU-PK-QTY)     04422001
044230                                       / RECITM-PREPK-RATO-QTY    04423001
044240             ELSE                                                 04424001
044250                 COMPUTE RC074-FCSE-ACTL-PACK-QTY =               04425001
044260                    (PV-LNE-VERIFY-ITM-QTY                        04426001
044270                               - PV-ODD-DC-VERIFY-ODU-PK-QTY)     04427001
044280                                       / RECITM-PREPK-RATO-QTY    04428001
044290             END-IF                                               04429001
044300         ELSE                                                     04430001
044310             PERFORM 4450-SUM-PO-RCVR-STORE-PACKS                 04431001
044320             IF RC074-P2L-ACTL-ITM-QTY > 0                        04432001
044330                 MOVE DK-PO-DRIVER-LNE    TO DK-LINE-NBR          04433001
044340                 PERFORM 8075-SUM-LINE-STR-P2L-ACTL               04434001
044350                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                04435001
044360                      PV-P2L-ACTL-ITM-QTY                         04436001
044370                                       / RECITM-PREPK-RATO-QTY    04437001
044380             END-IF                                               04438001
044390         END-IF                                                   04439001
044400     END-IF.                                                      04440001
044410     COMPUTE RC074-TOTAL-INVC-PACK-QTY =                          04441004
044420             RC074-FCSE-INVC-PACK-QTY + RC074-P2L-INVC-PACK-QTY.  04442004
044430     COMPUTE RC074-TOTAL-EXPT-PACK-QTY =                          04443004
044440       RC074-FCSE-EXPT-PACK-QTY + RC074-P2L-EXPT-PACK-QTY.        04444004
044450     COMPUTE RC074-TOTAL-ACTL-PACK-QTY =                          04445001
044460             RC074-FCSE-ACTL-PACK-QTY + RC074-P2L-ACTL-PACK-QTY.  04446001
044470     IF RC074-AUTO-VE-NO                                          04447001
044480         PERFORM 4510-SELECT-ODD-UNITS                            04448001
044490     ELSE                                                         04449001
044500         PERFORM 8220-SELECT-OTBND-CART                           04450001
044510         IF PV-ODD-UNT-CRTN-COUNT > 0                             04451001
044520             PERFORM 5200-PROCESS-PACK-STR-LNE-CSR                04452001
044530             MOVE 0       TO RC074-VERIFY-ODD-QTY                 04453001
044540         ELSE                                                     04454001
044550             MOVE 0       TO RC074-ACTUAL-ODD-QTY                 04455001
044560                             RC074-VERIFY-ODD-QTY                 04456001
044570         END-IF                                                   04457001
044580     END-IF.                                                      04458001
044590                                                                  04459001
044600 4620-SELECT-RATIO.                                               04460001
044610                                                                  04461001
044620     EXEC SQL                                                     04462001
044630          SELECT                                                  04463001
044640                B.PREPK_RATO_QTY                                  04464001
044650          INTO                                                    04465001
044660                :RECITM-PREPK-RATO-QTY                            04466001
044670          FROM    TRECEIV  A                                      04467001
044680              ,   TRECITM  B                                      04468001
044690          WHERE A.ORD_NBR          =  :DK-PO-NBR                  04469001
044700           AND  A.ORD_NBR          =  B.ORD_NBR                   04470001
044710           AND  A.VER_STATUS_CDE   =  'A'                         04471001
044720           AND  B.VER_STATUS_CDE   =  'A'                         04472001
044730           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               04473001
044740           AND  A.FCLTY_ID         =  B.FCLTY_ID                  04474001
044750           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            04475001
044760           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               04476001
044770           AND  B.ORD_LNE_NBR      =  :DK-LINE-NBR                04477001
044780           AND  B.PREPK_ID         = :DK-PACK-ID                  04478001
044790     END-EXEC.                                                    04479001
044800                                                                  04480001
044810     EVALUATE TRUE                                                04481001
044820         WHEN SQLCODE = ZERO                                      04482001
044830             CONTINUE                                             04483001
044840         WHEN SQLCODE = +100                                      04484001
044850             SET PS-NO-DRIVER-INFO TO TRUE                        04485001
044860         WHEN SQLWARN0 NOT = SPACES                               04486001
044870         WHEN SQLCODE < ZERO                                      04487001
044880         WHEN SQLCODE > ZERO                                      04488001
044890              SET  RC074-INVALID-SQL                              04489001
044900                   RC074-ERROR-YES                                04490001
044910                   PS-ERROR-YES         TO  TRUE                  04491001
044920              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04492001
044930              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04493001
044940              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04494001
044950              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04495001
044960              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04496001
044970              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04497001
044980              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04498001
044990              STRING  ' RCKUT128-4620-'                           04499001
045000                      ' CALLED BY-'                               04500001
045010                      RC074-CALLING-PROGRAM                       04501001
045020                      ' PO='                                      04502001
045030                      RC074-DISPLAY-PO                            04503001
045040                      ' RCVR='                                    04504001
045050                      RC074-DISPLAY-RCVR                          04505001
045060                      ' SQLCODE='                                 04506001
045070                      RC074-DISPLAY-SQLCODE                       04507001
045080                      DELIMITED BY SIZE                           04508001
045090                                      INTO RC074-CRA-RET-MSG      04509001
045100              STRING  ' RCKUT128-4620-'                           04510001
045110                      ' CALLED BY-'                               04511001
045120                      RC074-CALLING-PROGRAM                       04512001
045130                      DELIMITED BY SIZE                           04513001
045140                                      INTO RC074-ABEND-TEXT       04514001
045150              MOVE '4620-'              TO RC074-CRA-REQ-ID       04515001
045160                                           RC074-ABEND-PARAGRAPH  04516001
045170              PERFORM 9998-RETURN                                 04517001
045180     END-EVALUATE.                                                04518001
045190                                                                  04519001
045200 4700-CALC-PACK-LIN-CNTS-VE.                                      04520001
045210                                                                  04521001
045220     PERFORM 8010-VERIFIED-LINE-QTY.                              04522001
045230     PERFORM 8012-VERIFIED-LINE-QTY.                              04523001
045240     PERFORM 8014-VERIFIED-LINE-QTY-ORIG.                         04524001
045250     MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY.           04525004
045260     ADD PV-ORIG-EXPTED-ITM-QTY                                   04526001
045270                          TO RC074-INVCED-ITM-QTY.                04527004
045280                                                                  04528001
045290     MOVE RC074-LINE-NBR     TO DK-PO-DRIVER-LNE                  04529001
045300                                DK-LINE-NBR.                      04530001
045310     PERFORM 4620-SELECT-RATIO.                                   04531001
045320     PERFORM 4720-SUM-TRECDIS-DRIVE.                              04532001
045330     PERFORM 4725-SUM-TRECDIS-DRIVE.                              04533001
045340     PERFORM 4728-SUM-TRECDIS-DRIVE-ORIG.                         04534001
045350     MOVE PV-LNE-INVCED-ITM-QTY  TO PV-LNE-EXPTED-ITM-QTY.        04535004
045360     ADD PV-LNE-EXPTED-ORIG-ITM-QTY TO PV-LNE-INVCED-ITM-QTY.     04536004
045370     PERFORM 4729-SELECT-ODD-UNITS.                               04537001
045380                                                                  04538001
045390     IF RECITM-PREPK-RATO-QTY > 0                                 04539001
045400         MOVE PV-LNE-INVCED-ITM-QTY  TO RC074-FCSE-INVC-PACK-QTY  04540004
045410         MOVE RC074-FCSE-INVC-PACK-QTY TO                         04541004
045420                  RC074-TOTAL-INVC-PACK-QTY                       04542004
045430         MOVE PV-LNE-EXPTED-ITM-QTY                               04543004
045440                                TO RC074-FCSE-EXPT-PACK-QTY       04544004
045450         MOVE RC074-FCSE-EXPT-PACK-QTY TO                         04545004
045460                  RC074-TOTAL-EXPT-PACK-QTY                       04546004
045470         COMPUTE RC074-FCSE-ACTL-PACK-QTY =                       04547001
045480            (PV-LNE-VERIFY-ITM-QTY                                04548001
045490                       - RC074-ACTUAL-ODD-QTY)                    04549001
045500         MOVE RC074-FCSE-ACTL-PACK-QTY TO                         04550001
045510                  RC074-TOTAL-ACTL-PACK-QTY                       04551001
045520         IF PV-LNE-AP-VERIFY-ITM-QTY > 0                          04552001
045530             COMPUTE RC074-VERIFY-PACK-QTY =                      04553001
045540                (PV-LNE-AP-VERIFY-ITM-QTY                         04554001
045550                             - RC074-VERIFY-ODD-QTY)              04555001
045560         ELSE                                                     04556001
045570             MOVE 0                TO RC074-VERIFY-PACK-QTY       04557001
045580         END-IF                                                   04558001
045590     END-IF.                                                      04559001
045600                                                                  04560001
045610 4720-SUM-TRECDIS-DRIVE.                                          04561001
045620                                                                  04562001
045630     MOVE ZERO                 TO  PV-LNE-AP-VERIFY-ITM-QTY.      04563001
045640     MOVE ZERO                 TO  PV-LNE-VERIFY-ITM-QTY.         04564001
045650                                                                  04565001
045660     EXEC SQL                                                     04566001
045670          SELECT                                                  04567001
045680                 SUM(AP_VERIFY_ITM_QTY)                           04568001
045690                ,SUM(VERIFY_ITM_QTY)                              04569001
045700          INTO                                                    04570001
045710                :PV-LNE-AP-VERIFY-ITM-QTY :PV-NULL-IND            04571001
045720               ,:PV-LNE-VERIFY-ITM-QTY :PV-NULL-IND               04572001
045730          FROM                                                    04573001
045740                 TRECDIS                                          04574001
045750          WHERE                                                   04575001
045760                ORD_NBR          =  :DK-PO-NBR                    04576001
045770           AND  ORD_LNE_NBR      =  :DK-PO-DRIVER-LNE             04577001
045780           AND  REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR              04578001
045800     END-EXEC.                                                    04580001
045810                                                                  04581001
045820     EVALUATE TRUE                                                04582001
045830         WHEN SQLCODE = ZERO                                      04583001
045840         WHEN SQLCODE = +100                                      04584001
045850         WHEN SQLCODE = -305                                      04585001
045860              CONTINUE                                            04586001
045870         WHEN SQLWARN0 NOT = SPACE                                04587001
045880         WHEN SQLCODE NOT = ZERO                                  04588001
045890              SET  RC074-INVALID-SQL                              04589001
045900                   RC074-ERROR-YES                                04590001
045910                   PS-ERROR-YES         TO  TRUE                  04591001
045920              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04592001
045930              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04593001
045940              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04594001
045950              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04595001
045960              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04596001
045970              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04597001
045980              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04598001
045990              STRING  ' RCKUT128-4720-'                           04599001
046000                      ' CALLED BY-'                               04600001
046010                      RC074-CALLING-PROGRAM                       04601001
046020                      ' PO='                                      04602001
046030                      RC074-DISPLAY-PO                            04603001
046040                      ' RCVR='                                    04604001
046050                      RC074-DISPLAY-RCVR                          04605001
046060                      ' SQLCODE='                                 04606001
046070                      RC074-DISPLAY-SQLCODE                       04607001
046080                      DELIMITED BY SIZE                           04608001
046090                                      INTO RC074-CRA-RET-MSG      04609001
046100              STRING  ' RCKUT128-4720-'                           04610001
046110                      ' CALLED BY-'                               04611001
046120                      RC074-CALLING-PROGRAM                       04612001
046130                      DELIMITED BY SIZE                           04613001
046140                                      INTO RC074-ABEND-TEXT       04614001
046150              MOVE '4720-'              TO RC074-CRA-REQ-ID       04615001
046160                                           RC074-ABEND-PARAGRAPH  04616001
046170              PERFORM 9998-RETURN                                 04617001
046180     END-EVALUATE.                                                04618001
046190                                                                  04619001
046200 4725-SUM-TRECDIS-DRIVE.                                          04620001
046210                                                                  04621001
046220     MOVE ZERO                 TO  PV-LNE-INVCED-ITM-QTY.         04622004
046230                                                                  04623001
046240     EXEC SQL                                                     04624001
046250          SELECT SUM(EXPTED_ITM_QTY)                              04625001
046260          INTO  :PV-LNE-INVCED-ITM-QTY :PV-NULL-IND               04626004
046270          FROM                                                    04627001
046280                 TRECDIS  A                                       04628001
046290          WHERE                                                   04629001
046300                A.ORD_NBR        =  :DK-PO-NBR                    04630001
046310           AND  A.ORD_LNE_NBR    =  :DK-PO-DRIVER-LNE             04631001
046320           AND  A.REC_SEQ_NBR    =  :DK-RCVR-SEQ-NBR              04632001
046340           AND NOT EXISTS                                         04634001
046350               (SELECT *                                          04635001
046360                FROM RCT_RECDIS_ORIG B                            04636001
046370         WHERE  A.ORD_NBR          = B.ORD_NBR                    04637001
046380           AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR                04638001
046390           AND  A.ORD_LNE_NBR      = B.ORD_LNE_NBR)               04639001
046400     END-EXEC.                                                    04640001
046410                                                                  04641001
046420     EVALUATE TRUE                                                04642001
046430         WHEN SQLCODE = ZERO                                      04643001
046440         WHEN SQLCODE = +100                                      04644001
046450         WHEN SQLCODE = -305                                      04645001
046460              CONTINUE                                            04646001
046470         WHEN SQLWARN0 NOT = SPACE                                04647001
046480         WHEN SQLCODE NOT = ZERO                                  04648001
046490              SET  RC074-INVALID-SQL                              04649001
046500                   RC074-ERROR-YES                                04650001
046510                   PS-ERROR-YES         TO  TRUE                  04651001
046520              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04652001
046530              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04653001
046540              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04654001
046550              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04655001
046560              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04656001
046570              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04657001
046580              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04658001
046590              STRING  ' RCKUT128-4725-'                           04659001
046600                      ' CALLED BY-'                               04660001
046610                      RC074-CALLING-PROGRAM                       04661001
046620                      ' PO='                                      04662001
046630                      RC074-DISPLAY-PO                            04663001
046640                      ' RCVR='                                    04664001
046650                      RC074-DISPLAY-RCVR                          04665001
046660                      ' SQLCODE='                                 04666001
046670                      RC074-DISPLAY-SQLCODE                       04667001
046680                      DELIMITED BY SIZE                           04668001
046690                                      INTO RC074-CRA-RET-MSG      04669001
046700              STRING  ' RCKUT128-4725-'                           04670001
046710                      ' CALLED BY-'                               04671001
046720                      RC074-CALLING-PROGRAM                       04672001
046730                      DELIMITED BY SIZE                           04673001
046740                                      INTO RC074-ABEND-TEXT       04674001
046750              MOVE '4725-'              TO RC074-CRA-REQ-ID       04675001
046760                                           RC074-ABEND-PARAGRAPH  04676001
046770              PERFORM 9998-RETURN                                 04677001
046780     END-EVALUATE.                                                04678001
046790                                                                  04679001
046800 4728-SUM-TRECDIS-DRIVE-ORIG.                                     04680001
046810                                                                  04681001
046820     MOVE ZERO                 TO  PV-LNE-EXPTED-ORIG-ITM-QTY.    04682001
046830                                                                  04683001
046840     EXEC SQL                                                     04684001
046850          SELECT SUM(ORIG_EXPTED_QTY)                             04685001
046860          INTO  :PV-LNE-EXPTED-ORIG-ITM-QTY :PV-NULL-IND          04686001
046870          FROM                                                    04687001
046880                 RCT_RECDIS_ORIG                                  04688001
046890          WHERE                                                   04689001
046900                ORD_NBR          =  :DK-PO-NBR                    04690001
046910           AND  ORD_LNE_NBR      =  :DK-PO-DRIVER-LNE             04691001
046920           AND  REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR              04692001
046930     END-EXEC.                                                    04693001
046940                                                                  04694001
046950     EVALUATE TRUE                                                04695001
046960         WHEN SQLCODE = ZERO                                      04696001
046970         WHEN SQLCODE = +100                                      04697001
046980         WHEN SQLCODE = -305                                      04698001
046990              CONTINUE                                            04699001
047000         WHEN SQLWARN0 NOT = SPACE                                04700001
047010         WHEN SQLCODE NOT = ZERO                                  04701001
047020              SET  RC074-INVALID-SQL                              04702001
047030                   RC074-ERROR-YES                                04703001
047040                   PS-ERROR-YES         TO  TRUE                  04704001
047050              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04705001
047060              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04706001
047070              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04707001
047080              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04708001
047090              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04709001
047100              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04710001
047110              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04711001
047120              STRING  ' RCKUT128-4728-'                           04712001
047130                      ' CALLED BY-'                               04713001
047140                      RC074-CALLING-PROGRAM                       04714001
047150                      ' PO='                                      04715001
047160                      RC074-DISPLAY-PO                            04716001
047170                      ' RCVR='                                    04717001
047180                      RC074-DISPLAY-RCVR                          04718001
047190                      ' SQLCODE='                                 04719001
047200                      RC074-DISPLAY-SQLCODE                       04720001
047210                      DELIMITED BY SIZE                           04721001
047220                                      INTO RC074-CRA-RET-MSG      04722001
047230              STRING  ' RCKUT128-4728-'                           04723001
047240                      ' CALLED BY-'                               04724001
047250                      RC074-CALLING-PROGRAM                       04725001
047260                      DELIMITED BY SIZE                           04726001
047270                                      INTO RC074-ABEND-TEXT       04727001
047280              MOVE '4728-'              TO RC074-CRA-REQ-ID       04728001
047290                                           RC074-ABEND-PARAGRAPH  04729001
047300              PERFORM 9998-RETURN                                 04730001
047310     END-EVALUATE.                                                04731001
047320                                                                  04732001
047330 4729-SELECT-ODD-UNITS.                                           04733001
047340                                                                  04734001
047350     EXEC SQL                                                     04735001
047360          SELECT                                                  04736001
047370                 SUM(A.DC_VRFY_ODU_QTY)                           04737001
047380             ,   SUM(A.AP_VRFY_ODU_QTY)                           04738001
047390          INTO                                                    04739001
047400                :RC074-ACTUAL-ODD-QTY :PV-NULL-IND                04740001
047410             ,  :RC074-VERIFY-ODD-QTY :PV-NULL-IND                04741001
047420          FROM                                                    04742001
047430                 RCT_VRFD_ODD_UNT A                               04743001
047440              ,  TRECITM  B                                       04744001
047450          WHERE                                                   04745001
047460                PO_NBR           =  :DK-PO-NBR                    04746001
047470           AND  A.PO_LNE_NBR     =  :DK-PO-DRIVER-LNE             04747001
047480           AND  A.PO_LNE_NBR     =  B.ORD_LNE_NBR                 04748001
047490           AND  RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              04749001
047500           AND  A.PO_NBR         =  B.ORD_NBR                     04750001
047510           AND  B.VER_STATUS_CDE =  'A'                           04751001
047520           AND  A.RCVR_SEQ_NBR   =  B.REC_SEQ_NBR                 04752001
047530           AND  B.PREPK_ID       = :DK-PACK-ID                    04753001
047540     END-EXEC.                                                    04754001
047550                                                                  04755001
047560     EVALUATE TRUE                                                04756001
047570         WHEN SQLCODE = ZERO                                      04757001
047580         WHEN SQLCODE = +100                                      04758001
047590         WHEN SQLCODE = -305                                      04759001
047600              CONTINUE                                            04760001
047610         WHEN SQLWARN0 NOT = SPACE                                04761001
047620         WHEN SQLCODE NOT = ZERO                                  04762001
047630              SET  RC074-INVALID-SQL                              04763001
047640                   RC074-ERROR-YES                                04764001
047650                   PS-ERROR-YES         TO  TRUE                  04765001
047660              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04766001
047670              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04767001
047680              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04768001
047690              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04769001
047700              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04770001
047710              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04771001
047720              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04772001
047730              STRING  ' RCKUT128-4729-'                           04773001
047740                      ' CALLED BY-'                               04774001
047750                      RC074-CALLING-PROGRAM                       04775001
047760                      ' PO='                                      04776001
047770                      RC074-DISPLAY-PO                            04777001
047780                      ' RCVR='                                    04778001
047790                      RC074-DISPLAY-RCVR                          04779001
047800                      ' SQLCODE='                                 04780001
047810                      RC074-DISPLAY-SQLCODE                       04781001
047820                      DELIMITED BY SIZE                           04782001
047830                                      INTO RC074-CRA-RET-MSG      04783001
047840              STRING  ' RCKUT128-4729-'                           04784001
047850                      ' CALLED BY-'                               04785001
047860                      RC074-CALLING-PROGRAM                       04786001
047870                      DELIMITED BY SIZE                           04787001
047880                                      INTO RC074-ABEND-TEXT       04788001
047890              MOVE '4729-'              TO RC074-CRA-REQ-ID       04789001
047900                                           RC074-ABEND-PARAGRAPH  04790001
047910              PERFORM 9998-RETURN                                 04791001
047920     END-EVALUATE.                                                04792001
047930                                                                  04793001
047940 4800-CALC-PACK-STR-COUNTS.                                       04794001
047950     PERFORM 4810-SUM-TRECDIS.                                    04795001
047960     PERFORM 4815-SUM-TRECDIS-ORIG.                               04796001
047970     MOVE RC074-INVCED-ITM-QTY TO RC074-EXPTED-ITM-QTY.           04797004
047980     ADD PV-ORIG-EXPTED-ITM-QTY TO RC074-INVCED-ITM-QTY.          04798004
047990     MOVE RC074-LINE-NBR  TO DK-PO-DRIVER-LNE.                    04799001
048000     PERFORM 7070-GET-TDISTDT.                                    04800001
048010     PERFORM 4240-SELECT-TDISTHD.                                 04801001
048020     IF RC074-AUTO-VE-NO                                          04802001
048030         MOVE ZERO             TO RC074-VERIFY-ITM-QTY            04803001
048040     ELSE                                                         04804001
048050         MOVE ZERO             TO RC074-VERIFY-ITM-QTY            04805001
048060                                  RC074-FCSE-ACTL-ITM-QTY         04806001
048070                                  RC074-P2L-ACTL-ITM-QTY          04807001
048080                                  RC074-TOTAL-ACTL-ITM-QTY        04808001
048090         PERFORM 8050-SUM-LINE-OTBND-UPC                          04809001
048100         IF DISTHD-RSLTS-RCVD-TMST = PC-DB2-DEFAULT-TIMESTAMP     04810001
048110             MOVE 0           TO RC074-P2L-ACTL-ITM-QTY           04811001
048120         ELSE                                                     04812001
048130             MOVE DK-PO-DRIVER-LNE    TO DK-LINE-NBR              04813001
048140             PERFORM 8070-SUM-LINE-P2L-ACTL                       04814001
048150         END-IF                                                   04815001
048160     COMPUTE RC074-TOTAL-ACTL-ITM-QTY =                           04816001
048170           RC074-FCSE-ACTL-ITM-QTY +                              04817001
048180           RC074-P2L-ACTL-ITM-QTY.                                04818001
048190     PERFORM 4720-SUM-TRECDIS-DRIVE.                              04819001
048200     PERFORM 4725-SUM-TRECDIS-DRIVE.                              04820001
048210     PERFORM 4728-SUM-TRECDIS-DRIVE-ORIG.                         04821001
048220     MOVE PV-LNE-INVCED-ITM-QTY  TO PV-LNE-EXPTED-ITM-QTY.        04822004
048230     ADD PV-LNE-EXPTED-ORIG-ITM-QTY TO PV-LNE-INVCED-ITM-QTY.     04823004
048240     PERFORM 4830-SELECT-ODD-UNITS-DRIVER.                        04824001
048250     IF DISTDT-P2L-SPLT-UNT-QTY > 0 AND                           04825001
048260        DISTDT-FCSE-SPLT-UNT-QTY = 0 AND                          04826001
048270        DISTDT-INPK-SPLT-UNT-QTY = 0                              04827001
048280         SET PS-P2L-LINE  TO TRUE                                 04828001
048290     ELSE                                                         04829001
048300         SET PS-NOT-P2L-LINE  TO TRUE                             04830001
048310     END-IF.                                                      04831001
048320     MOVE DK-PO-DRIVER-LNE    TO DK-LINE-NBR.                     04832001
048330     PERFORM 4620-SELECT-RATIO.                                   04833001
048340     IF RECITM-PREPK-RATO-QTY > 0                                 04834001
048350         IF PS-P2L-LINE                                           04835001
048360             COMPUTE RC074-P2L-INVC-PACK-QTY =                    04836004
048370                 PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY    04837004
048380             COMPUTE RC074-P2L-EXPT-PACK-QTY =                    04838004
048390                 PV-LNE-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY    04839004
048400         ELSE                                                     04840001
048410             COMPUTE RC074-FCSE-INVC-PACK-QTY =                   04841004
048420                 PV-LNE-INVCED-ITM-QTY / RECITM-PREPK-RATO-QTY    04842004
048430             COMPUTE RC074-FCSE-EXPT-PACK-QTY =                   04843004
048440                 PV-LNE-EXPTED-ITM-QTY / RECITM-PREPK-RATO-QTY    04844004
048450         END-IF                                                   04845001
048460         IF RC074-AUTO-VE-NO                                      04846001
048470             IF PS-P2L-LINE                                       04847001
048480                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                04848001
048490                    (PV-LNE-VERIFY-ITM-QTY                        04849001
048500                               - PV-ODD-DC-VERIFY-ODU-PK-QTY)     04850001
048510                                       / RECITM-PREPK-RATO-QTY    04851001
048520             ELSE                                                 04852001
048530                 COMPUTE RC074-FCSE-ACTL-PACK-QTY =               04853001
048540                    (PV-LNE-VERIFY-ITM-QTY                        04854001
048550                               - PV-ODD-DC-VERIFY-ODU-PK-QTY)     04855001
048560                                       / RECITM-PREPK-RATO-QTY    04856001
048570             END-IF                                               04857001
048580         ELSE                                                     04858001
048590             PERFORM 4850-SUM-PO-RCVR-PACKS                       04859001
048600             IF RC074-P2L-ACTL-ITM-QTY > 0                        04860001
048610                 MOVE DK-PO-DRIVER-LNE    TO DK-LINE-NBR          04861001
048620                 PERFORM 8070-SUM-LINE-P2L-ACTL                   04862001
048630                 COMPUTE RC074-P2L-ACTL-PACK-QTY =                04863001
048640                      PV-P2L-ACTL-ITM-QTY                         04864001
048650                                       / RECITM-PREPK-RATO-QTY    04865001
048660             END-IF                                               04866001
048670         END-IF                                                   04867001
048680     END-IF.                                                      04868001
048690     COMPUTE RC074-TOTAL-INVC-PACK-QTY =                          04869004
048700             RC074-FCSE-INVC-PACK-QTY + RC074-P2L-INVC-PACK-QTY.  04870004
048710     COMPUTE RC074-TOTAL-EXPT-PACK-QTY =                          04871004
048720       RC074-FCSE-EXPT-PACK-QTY + RC074-P2L-EXPT-PACK-QTY.        04872004
048730     COMPUTE RC074-TOTAL-ACTL-PACK-QTY =                          04873001
048740             RC074-FCSE-ACTL-PACK-QTY + RC074-P2L-ACTL-PACK-QTY.  04874001
048750     IF RC074-AUTO-VE-NO                                          04875001
048760         PERFORM 4729-SELECT-ODD-UNITS                            04876001
048770     ELSE                                                         04877001
048780         PERFORM 8230-SELECT-OTBND-CART                           04878001
048790         IF PV-ODD-UNT-CRTN-COUNT > 0                             04879001
048800             PERFORM 5300-PROCESS-PACK-LNE-CSR                    04880001
048810             MOVE 0       TO RC074-VERIFY-ODD-QTY                 04881001
048820         ELSE                                                     04882001
048830             MOVE 0       TO RC074-ACTUAL-ODD-QTY                 04883001
048840                             RC074-VERIFY-ODD-QTY                 04884001
048850         END-IF                                                   04885001
048860     END-IF.                                                      04886001
048870                                                                  04887001
048880 4810-SUM-TRECDIS.                                                04888001
048890                                                                  04889001
048900     MOVE ZERO                 TO RC074-INVCED-ITM-QTY.           04890004
048910                                                                  04891001
048920     EXEC SQL                                                     04892001
048930          SELECT SUM(A.EXPTED_ITM_QTY)                            04893001
048940          INTO  :RC074-INVCED-ITM-QTY    :RC074-NULL-IND          04894004
048950          FROM                                                    04895001
048960                 TRECDIS A                                        04896001
048970              ,  TRECITM  B                                       04897001
048980          WHERE                                                   04898001
048990                A.ORD_NBR          =  :DK-PO-NBR                  04899001
049000           AND  A.ORD_NBR          =  B.ORD_NBR                   04900001
049010           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            04901001
049020           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               04902001
049030           AND  A.ORD_LNE_NBR      =  :DK-LINE-NBR                04903001
049040           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               04904001
049060           AND  B.VER_STATUS_CDE   =  'A'                         04906001
049070           AND  B.PREPK_ID         =  :DK-PACK-ID                 04907001
049080           AND NOT EXISTS                                         04908001
049090               (SELECT *                                          04909001
049100                FROM RCT_RECDIS_ORIG C                            04910001
049110         WHERE  A.ORD_NBR          = C.ORD_NBR                    04911001
049120           AND  A.REC_SEQ_NBR      = C.REC_SEQ_NBR                04912001
049130           AND  A.ORD_LNE_NBR      = C.ORD_LNE_NBR)               04913001
049140                                                                  04914001
049150     END-EXEC.                                                    04915001
049160                                                                  04916001
049170     EVALUATE TRUE                                                04917001
049180         WHEN SQLCODE = ZERO                                      04918001
049190              CONTINUE                                            04919001
049200         WHEN SQLCODE = +100                                      04920001
049210         WHEN SQLCODE = -305                                      04921001
049220              CONTINUE                                            04922001
049230         WHEN SQLWARN0 NOT = SPACE                                04923001
049240         WHEN SQLCODE NOT = ZERO                                  04924001
049250                                                                  04925001
049260              SET  RC074-INVALID-SQL                              04926001
049270                   RC074-ERROR-YES                                04927001
049280                   PS-ERROR-YES         TO  TRUE                  04928001
049290              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04929001
049300              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04930001
049310              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04931001
049320              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04932001
049330              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04933001
049340              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04934001
049350              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04935001
049360              STRING  ' RCKUT128-4810-'                           04936001
049370                      ' CALLED BY-'                               04937001
049380                      RC074-CALLING-PROGRAM                       04938001
049390                      ' PO='                                      04939001
049400                      RC074-DISPLAY-PO                            04940001
049410                      ' RCVR='                                    04941001
049420                      RC074-DISPLAY-RCVR                          04942001
049430                      ' SQLCODE='                                 04943001
049440                      RC074-DISPLAY-SQLCODE                       04944001
049450                      DELIMITED BY SIZE                           04945001
049460                                      INTO RC074-CRA-RET-MSG      04946001
049470              STRING  ' RCKUT128-4810-'                           04947001
049480                      ' CALLED BY-'                               04948001
049490                      RC074-CALLING-PROGRAM                       04949001
049500                      DELIMITED BY SIZE                           04950001
049510                                      INTO RC074-ABEND-TEXT       04951001
049520              MOVE '4810-'              TO RC074-CRA-REQ-ID       04952001
049530                                           RC074-ABEND-PARAGRAPH  04953001
049540              PERFORM 9998-RETURN                                 04954001
049550     END-EVALUATE.                                                04955001
049560                                                                  04956001
049570 4815-SUM-TRECDIS-ORIG.                                           04957001
049580                                                                  04958001
049590     MOVE ZERO                 TO PV-ORIG-EXPTED-ITM-QTY.         04959001
049600                                                                  04960001
049610     EXEC SQL                                                     04961001
049620          SELECT SUM(A.ORIG_EXPTED_QTY)                           04962001
049630          INTO  :PV-ORIG-EXPTED-ITM-QTY  :RC074-NULL-IND          04963001
049640          FROM                                                    04964001
049650                 RCT_RECDIS_ORIG A                                04965001
049660              ,  TRECITM  B                                       04966001
049670          WHERE                                                   04967001
049680                A.ORD_NBR          =  :DK-PO-NBR                  04968001
049690           AND  A.ORD_NBR          =  B.ORD_NBR                   04969001
049700           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            04970001
049710           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               04971001
049720           AND  A.ORD_LNE_NBR      =  :DK-LINE-NBR                04972001
049730           AND  A.ORD_LNE_NBR      =  B.ORD_LNE_NBR               04973001
049740           AND  B.PREPK_ID         =  :DK-PACK-ID                 04974001
049750                                                                  04975001
049760     END-EXEC.                                                    04976001
049770                                                                  04977001
049780     EVALUATE TRUE                                                04978001
049790         WHEN SQLCODE = ZERO                                      04979001
049800              CONTINUE                                            04980001
049810         WHEN SQLCODE = +100                                      04981001
049820         WHEN SQLCODE = -305                                      04982001
049830              CONTINUE                                            04983001
049840         WHEN SQLWARN0 NOT = SPACE                                04984001
049850         WHEN SQLCODE NOT = ZERO                                  04985001
049860                                                                  04986001
049870              SET  RC074-INVALID-SQL                              04987001
049880                   RC074-ERROR-YES                                04988001
049890                   PS-ERROR-YES         TO  TRUE                  04989001
049900              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 04990001
049910              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      04991001
049920              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    04992001
049930              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    04993001
049940              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    04994001
049950              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     04995001
049960              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    04996001
049970              STRING  ' RCKUT128-4815-'                           04997001
049980                      ' CALLED BY-'                               04998001
049990                      RC074-CALLING-PROGRAM                       04999001
050000                      ' PO='                                      05000001
050010                      RC074-DISPLAY-PO                            05001001
050020                      ' RCVR='                                    05002001
050030                      RC074-DISPLAY-RCVR                          05003001
050040                      ' SQLCODE='                                 05004001
050050                      RC074-DISPLAY-SQLCODE                       05005001
050060                      DELIMITED BY SIZE                           05006001
050070                                      INTO RC074-CRA-RET-MSG      05007001
050080              STRING  ' RCKUT128-4815-'                           05008001
050090                      ' CALLED BY-'                               05009001
050100                      RC074-CALLING-PROGRAM                       05010001
050110                      DELIMITED BY SIZE                           05011001
050120                                      INTO RC074-ABEND-TEXT       05012001
050130              MOVE '4815-'              TO RC074-CRA-REQ-ID       05013001
050140                                           RC074-ABEND-PARAGRAPH  05014001
050150              PERFORM 9998-RETURN                                 05015001
050160     END-EVALUATE.                                                05016001
050170                                                                  05017001
050180                                                                  05018001
050190 4830-SELECT-ODD-UNITS-DRIVER.                                    05019001
050200                                                                  05020001
050210     EXEC SQL                                                     05021001
050220          SELECT                                                  05022001
050230                 SUM(A.DC_VRFY_ODU_QTY)                           05023001
050240             ,   SUM(A.AP_VRFY_ODU_QTY)                           05024001
050250          INTO                                                    05025001
050260                :PV-ODD-DC-VERIFY-ODU-PK-QTY :PV-NULL-IND         05026001
050270             ,  :PV-ODD-AP-VERIFY-ODU-PK-QTY :PV-NULL-IND         05027001
050280          FROM                                                    05028001
050290                 RCT_VRFD_ODD_UNT A                               05029001
050300              ,  TRECITM  B                                       05030001
050310          WHERE                                                   05031001
050320                PO_NBR           =  :DK-PO-NBR                    05032001
050330           AND  PO_LNE_NBR       =  :DK-PO-DRIVER-LNE             05033001
050340           AND  A.PO_LNE_NBR     =  B.ORD_LNE_NBR                 05034001
050350           AND  RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              05035001
050360           AND  A.PO_NBR         =  B.ORD_NBR                     05036001
050370           AND  B.VER_STATUS_CDE =  'A'                           05037001
050380           AND  A.RCVR_SEQ_NBR   =  B.REC_SEQ_NBR                 05038001
050390           AND  B.PREPK_ID       = :DK-PACK-ID                    05039001
050400     END-EXEC.                                                    05040001
050410                                                                  05041001
050420     EVALUATE TRUE                                                05042001
050430         WHEN SQLCODE = ZERO                                      05043001
050440         WHEN SQLCODE = +100                                      05044001
050450         WHEN SQLCODE = -305                                      05045001
050460              CONTINUE                                            05046001
050470         WHEN SQLWARN0 NOT = SPACE                                05047001
050480         WHEN SQLCODE NOT = ZERO                                  05048001
050490              SET  RC074-INVALID-SQL                              05049001
050500                   RC074-ERROR-YES                                05050001
050510                   PS-ERROR-YES         TO  TRUE                  05051001
050520              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05052001
050530              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05053001
050540              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05054001
050550              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05055001
050560              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05056001
050570              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05057001
050580              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05058001
050590              STRING  ' RCKUT128-4830-'                           05059001
050600                      ' CALLED BY-'                               05060001
050610                      RC074-CALLING-PROGRAM                       05061001
050620                      ' PO='                                      05062001
050630                      RC074-DISPLAY-PO                            05063001
050640                      ' RCVR='                                    05064001
050650                      RC074-DISPLAY-RCVR                          05065001
050660                      ' SQLCODE='                                 05066001
050670                      RC074-DISPLAY-SQLCODE                       05067001
050680                      DELIMITED BY SIZE                           05068001
050690                                      INTO RC074-CRA-RET-MSG      05069001
050700              STRING  ' RCKUT128-4830-'                           05070001
050710                      ' CALLED BY-'                               05071001
050720                      RC074-CALLING-PROGRAM                       05072001
050730                      DELIMITED BY SIZE                           05073001
050740                                      INTO RC074-ABEND-TEXT       05074001
050750              MOVE '4830-'              TO RC074-CRA-REQ-ID       05075001
050760                                           RC074-ABEND-PARAGRAPH  05076001
050770              PERFORM 9998-RETURN                                 05077001
050780     END-EVALUATE.                                                05078001
050790                                                                  05079001
050800 4850-SUM-PO-RCVR-PACKS.                                          05080001
050810     EXEC SQL                                                     05081001
050820           SELECT SUM(A.SHPD_PK_QTY)                              05082001
050830            INTO :PV-TOTAL-PACKS :PV-NULL-IND                     05083001
050840            FROM SUT_OTBND_PK  A                                  05084001
050850              ,  SUT_OTBND_CART B                                 05085001
050860              ,  TPOPRPK  C                                       05086001
050870          WHERE                                                   05087001
050880                A.TRN_NBR        =  :DK-PO-NBR                    05088001
050890           AND  A.TRN_NBR        =   C.PO_NBR                     05089001
050900           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              05090001
050910           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               05091001
050920           AND  B.ACTV_IND       =  'Y'                           05092001
050930           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              05093001
050940           AND  A.PK_SKU_NBR       =  C.PK_SKU_NBR                05094001
050950           AND  C.PO_PREPK_ID      = :DK-PACK-ID                  05095001
050960     END-EXEC.                                                    05096001
050970                                                                  05097001
050980                                                                  05098001
050990     EVALUATE TRUE                                                05099001
051000         WHEN SQLCODE = ZERO                                      05100001
051010             IF PV-NULL-IND = -1                                  05101001
051020                 MOVE 0    TO PV-TOTAL-PACKS                      05102001
051030             END-IF                                               05103001
051040             MOVE PV-TOTAL-PACKS     TO RC074-FCSE-ACTL-PACK-QTY  05104001
051050         WHEN SQLCODE = -904                                      05105001
051060         WHEN SQLCODE = -911                                      05106001
051070         WHEN SQLCODE = -913                                      05107001
051080              SET  RC074-DATABASE-BUSY                            05108001
051090                   RC074-ERROR-YES                                05109001
051100                   PS-ERROR-YES         TO  TRUE                  05110001
051110              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05111001
051120              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05112001
051130              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05113001
051140              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05114001
051150              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05115001
051160              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05116001
051170              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05117001
051180             STRING   ' RCKUT128-4850-'                           05118001
051190                      ' CALLED BY-'                               05119001
051200                      RC074-CALLING-PROGRAM                       05120001
051210                      ' PO='                                      05121001
051220                      RC074-DISPLAY-PO                            05122001
051230                      ' RCVR='                                    05123001
051240                      RC074-DISPLAY-RCVR                          05124001
051250                      ' SQLCODE='                                 05125001
051260                      RC074-DISPLAY-SQLCODE                       05126001
051270                      DELIMITED BY SIZE                           05127001
051280                                      INTO RC074-CRA-RET-MSG      05128001
051290             STRING   ' RCKUT128-4850-'                           05129001
051300                      ' CALLED BY-'                               05130001
051310                      RC074-CALLING-PROGRAM                       05131001
051320                      DELIMITED BY SIZE                           05132001
051330                                      INTO RC074-ABEND-TEXT       05133001
051340             MOVE '4850-'               TO RC074-CRA-REQ-ID       05134001
051350                                           RC074-ABEND-PARAGRAPH  05135001
051360             PERFORM 9998-RETURN                                  05136001
051370                                                                  05137001
051380         WHEN SQLWARN0 NOT = SPACES                               05138001
051390         WHEN SQLCODE < ZERO                                      05139001
051400         WHEN SQLCODE > ZERO                                      05140001
051410              SET  RC074-INVALID-SQL                              05141001
051420                   RC074-ERROR-YES                                05142001
051430                   PS-ERROR-YES         TO  TRUE                  05143001
051440              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05144001
051450              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05145001
051460              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05146001
051470              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05147001
051480              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05148001
051490              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05149001
051500              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05150001
051510             STRING   ' RCKUT128-4850-'                           05151001
051520                      ' CALLED BY-'                               05152001
051530                      RC074-CALLING-PROGRAM                       05153001
051540                      ' PO='                                      05154001
051550                      RC074-DISPLAY-PO                            05155001
051560                      ' RCVR='                                    05156001
051570                      RC074-DISPLAY-RCVR                          05157001
051580                      ' SQLCODE='                                 05158001
051590                      RC074-DISPLAY-SQLCODE                       05159001
051600                      DELIMITED BY SIZE                           05160001
051610                                      INTO RC074-CRA-RET-MSG      05161001
051620             STRING   ' RCKUT128-4850-'                           05162001
051630                      ' CALLED BY-'                               05163001
051640                      RC074-CALLING-PROGRAM                       05164001
051650                      DELIMITED BY SIZE                           05165001
051660                                      INTO RC074-ABEND-TEXT       05166001
051670             MOVE '4850-'               TO RC074-CRA-REQ-ID       05167001
051680                                           RC074-ABEND-PARAGRAPH  05168001
051690             PERFORM 9998-RETURN                                  05169001
051700                                                                  05170001
051710     END-EVALUATE.                                                05171001
051720                                                                  05172001
051730                                                                  05173001
051740 4900-CALCULATE-PO-RCVR.                                          05174001
051750      PERFORM 4910-OPEN-PO-RCVR-CSR.                              05175001
051760      PERFORM 4920-FETCH-PO-RCVR-CSR.                             05176001
051770      PERFORM 4930-PROCESS-PACKS                                  05177001
051780        UNTIL PS-PO-RCVR-CSR-END-YES                              05178001
051790           OR PS-ERROR-YES                                        05179001
051800           OR RC074-ERROR-YES.                                    05180001
051810      PERFORM 4940-CLOSE-RCVR-LNE-CSR.                            05181001
051820                                                                  05182001
051830     MOVE  PV-VERIFY-ITM-QTY                                      05183001
051840       TO  RC074-VERIFY-ITM-QTY.                                  05184001
051850     MOVE  PV-INVCED-ITM-QTY                                      05185004
051860       TO  RC074-INVCED-ITM-QTY.                                  05186004
051870     MOVE  PV-EXPTED-ITM-QTY                                      05187004
051880       TO  RC074-EXPTED-ITM-QTY.                                  05188004
051890     MOVE  PV-FCSE-ACTL-ITM-QTY                                   05189001
051900       TO  RC074-FCSE-ACTL-ITM-QTY.                               05190001
051910     MOVE  PV-P2L-ACTL-ITM-QTY                                    05191001
051920       TO  RC074-P2L-ACTL-ITM-QTY.                                05192001
051930     MOVE  PV-TOTAL-ACTL-ITM-QTY                                  05193001
051940       TO  RC074-TOTAL-ACTL-ITM-QTY.                              05194001
051950                                                                  05195001
051960 4910-OPEN-PO-RCVR-CSR.                                           05196001
051970                                                                  05197001
051980     SET  PS-PO-RCVR-CSR-END-NO  TO  TRUE.                        05198001
051990                                                                  05199001
052000     EXEC SQL                                                     05200001
052010          OPEN PO_RCVR_PACK_CSR                                   05201001
052020     END-EXEC.                                                    05202001
052030                                                                  05203001
052040     EVALUATE TRUE                                                05204001
052050         WHEN SQLCODE = ZERO                                      05205001
052060             CONTINUE                                             05206001
052070         WHEN SQLCODE = -904                                      05207001
052080         WHEN SQLCODE = -911                                      05208001
052090         WHEN SQLCODE = -913                                      05209001
052100              SET  RC074-DATABASE-BUSY                            05210001
052110                   RC074-ERROR-YES                                05211001
052120                   PS-ERROR-YES         TO  TRUE                  05212001
052130              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05213001
052140              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05214001
052150              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05215001
052160              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05216001
052170              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05217001
052180              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05218001
052190              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05219001
052200             STRING   ' RCKUT128-4810-'                           05220001
052210                      ' CALLED BY-'                               05221001
052220                      RC074-CALLING-PROGRAM                       05222001
052230                      ' PO='                                      05223001
052240                      RC074-DISPLAY-PO                            05224001
052250                      ' RCVR='                                    05225001
052260                      RC074-DISPLAY-RCVR                          05226001
052270                      ' SQLCODE='                                 05227001
052280                      RC074-DISPLAY-SQLCODE                       05228001
052290                      DELIMITED BY SIZE                           05229001
052300                                      INTO RC074-CRA-RET-MSG      05230001
052310             STRING   ' RCKUT128-4810-'                           05231001
052320                      ' CALLED BY-'                               05232001
052330                      RC074-CALLING-PROGRAM                       05233001
052340                      DELIMITED BY SIZE                           05234001
052350                                      INTO RC074-ABEND-TEXT       05235001
052360             MOVE '4810-'               TO RC074-CRA-REQ-ID       05236001
052370                                           RC074-ABEND-PARAGRAPH  05237001
052380             PERFORM 9998-RETURN                                  05238001
052390                                                                  05239001
052400         WHEN SQLWARN0 NOT = SPACES                               05240001
052410         WHEN SQLCODE < ZERO                                      05241001
052420         WHEN SQLCODE > ZERO                                      05242001
052430              SET  RC074-INVALID-SQL                              05243001
052440                   RC074-ERROR-YES                                05244001
052450                   PS-ERROR-YES         TO  TRUE                  05245001
052460              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05246001
052470              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05247001
052480              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05248001
052490              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05249001
052500              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05250001
052510              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05251001
052520              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05252001
052530             STRING   ' RCKUT128-4810-'                           05253001
052540                      ' CALLED BY-'                               05254001
052550                      RC074-CALLING-PROGRAM                       05255001
052560                      ' PO='                                      05256001
052570                      RC074-DISPLAY-PO                            05257001
052580                      ' RCVR='                                    05258001
052590                      RC074-DISPLAY-RCVR                          05259001
052600                      ' SQLCODE='                                 05260001
052610                      RC074-DISPLAY-SQLCODE                       05261001
052620                      DELIMITED BY SIZE                           05262001
052630                                      INTO RC074-CRA-RET-MSG      05263001
052640             STRING   ' RCKUT128-4810-'                           05264001
052650                      ' CALLED BY-'                               05265001
052660                      RC074-CALLING-PROGRAM                       05266001
052670                      DELIMITED BY SIZE                           05267001
052680                                      INTO RC074-ABEND-TEXT       05268001
052690             MOVE '4810-'               TO RC074-CRA-REQ-ID       05269001
052700                                           RC074-ABEND-PARAGRAPH  05270001
052710             PERFORM 9998-RETURN                                  05271001
052720                                                                  05272001
052730     END-EVALUATE.                                                05273001
052740                                                                  05274001
052750 4920-FETCH-PO-RCVR-CSR.                                          05275001
052760                                                                  05276001
052770     EXEC SQL                                                     05277001
052780          FETCH PO_RCVR_PACK_CSR                                  05278001
052790           INTO :RECITM-PREPK-ID                                  05279001
052800     END-EXEC.                                                    05280001
052810                                                                  05281001
052820     EVALUATE TRUE                                                05282001
052830         WHEN SQLCODE = ZERO                                      05283001
052840              MOVE  RECITM-PREPK-ID     TO  DK-PACK-ID            05284001
052850                                                                  05285001
052860         WHEN SQLCODE = +100                                      05286001
052870              SET  PS-PO-RCVR-CSR-END-YES   TO  TRUE              05287001
052880                                                                  05288001
052890         WHEN SQLCODE = -904                                      05289001
052900         WHEN SQLCODE = -911                                      05290001
052910         WHEN SQLCODE = -913                                      05291001
052920              SET  RC074-DATABASE-BUSY                            05292001
052930                   RC074-ERROR-YES                                05293001
052940                   PS-ERROR-YES         TO  TRUE                  05294001
052950              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05295001
052960              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05296001
052970              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05297001
052980              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05298001
052990              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05299001
053000              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05300001
053010              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05301001
053020             STRING   ' RCKUT128-4920-'                           05302001
053030                      ' CALLED BY-'                               05303001
053040                      RC074-CALLING-PROGRAM                       05304001
053050                      ' PO='                                      05305001
053060                      RC074-DISPLAY-PO                            05306001
053070                      ' RCVR='                                    05307001
053080                      RC074-DISPLAY-RCVR                          05308001
053090                      ' SQLCODE='                                 05309001
053100                      RC074-DISPLAY-SQLCODE                       05310001
053110                      DELIMITED BY SIZE                           05311001
053120                                      INTO RC074-CRA-RET-MSG      05312001
053130             STRING   ' RCKUT128-4920-'                           05313001
053140                      ' CALLED BY-'                               05314001
053150                      RC074-CALLING-PROGRAM                       05315001
053160                      DELIMITED BY SIZE                           05316001
053170                                      INTO RC074-ABEND-TEXT       05317001
053180             MOVE '4920-'               TO RC074-CRA-REQ-ID       05318001
053190                                           RC074-ABEND-PARAGRAPH  05319001
053200             PERFORM 9998-RETURN                                  05320001
053210                                                                  05321001
053220         WHEN SQLWARN0 NOT = SPACE                                05322001
053230         WHEN SQLCODE NOT = ZERO                                  05323001
053240              SET  RC074-INVALID-SQL                              05324001
053250                   RC074-ERROR-YES                                05325001
053260                   PS-ERROR-YES         TO  TRUE                  05326001
053270              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05327001
053280              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05328001
053290              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05329001
053300              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05330001
053310              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05331001
053320              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05332001
053330              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05333001
053340             STRING   ' RCKUT128-4920-'                           05334001
053350                      ' CALLED BY-'                               05335001
053360                      RC074-CALLING-PROGRAM                       05336001
053370                      ' PO='                                      05337001
053380                      RC074-DISPLAY-PO                            05338001
053390                      ' RCVR='                                    05339001
053400                      RC074-DISPLAY-RCVR                          05340001
053410                      ' SQLCODE='                                 05341001
053420                      RC074-DISPLAY-SQLCODE                       05342001
053430                      DELIMITED BY SIZE                           05343001
053440                                      INTO RC074-CRA-RET-MSG      05344001
053450             STRING   ' RCKUT128-4920-'                           05345001
053460                      ' CALLED BY-'                               05346001
053470                      RC074-CALLING-PROGRAM                       05347001
053480                      DELIMITED BY SIZE                           05348001
053490                                      INTO RC074-ABEND-TEXT       05349001
053500             MOVE '4920-'               TO RC074-CRA-REQ-ID       05350001
053510                                           RC074-ABEND-PARAGRAPH  05351001
053520             PERFORM 9998-RETURN                                  05352001
053530                                                                  05353001
053540     END-EVALUATE.                                                05354001
053550                                                                  05355001
053560 4930-PROCESS-PACKS.                                              05356001
053570     IF  PV-RCVR-VERIFIED                                         05357001
053580         PERFORM 4100-CALCULATE-PACK-COUNTS-VE                    05358001
053590     ELSE                                                         05359001
053600         PERFORM 4200-CALCULATE-PACK-COUNTS                       05360001
053610     END-IF.                                                      05361001
053620     ADD   RC074-VERIFY-ITM-QTY                                   05362001
053630       TO  PV-VERIFY-ITM-QTY.                                     05363001
053640     ADD   RC074-INVCED-ITM-QTY                                   05364004
053650       TO  PV-INVCED-ITM-QTY.                                     05365004
053660     ADD   RC074-INVCED-ITM-QTY                                   05366004
053670       TO  PV-EXPTED-ITM-QTY.                                     05367004
053680     ADD   RC074-FCSE-ACTL-ITM-QTY                                05368001
053690       TO  PV-FCSE-ACTL-ITM-QTY.                                  05369001
053700     ADD   RC074-P2L-ACTL-ITM-QTY                                 05370001
053710       TO  PV-P2L-ACTL-ITM-QTY.                                   05371001
053720     ADD   RC074-TOTAL-ACTL-ITM-QTY                               05372001
053730       TO  PV-TOTAL-ACTL-ITM-QTY.                                 05373001
053740     PERFORM 4920-FETCH-PO-RCVR-CSR.                              05374001
053750                                                                  05375001
053760 4940-CLOSE-RCVR-LNE-CSR.                                         05376001
053770                                                                  05377001
053780     EXEC SQL                                                     05378001
053790          CLOSE PO_RCVR_PACK_CSR                                  05379001
053800     END-EXEC.                                                    05380001
053810                                                                  05381001
053820     EVALUATE TRUE                                                05382001
053830         WHEN SQLCODE = ZERO                                      05383001
053840             CONTINUE                                             05384001
053850         WHEN SQLCODE = -904                                      05385001
053860         WHEN SQLCODE = -911                                      05386001
053870         WHEN SQLCODE = -913                                      05387001
053880              SET  RC074-DATABASE-BUSY                            05388001
053890                   RC074-ERROR-YES                                05389001
053900                   PS-ERROR-YES         TO  TRUE                  05390001
053910              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05391001
053920              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05392001
053930              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05393001
053940              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05394001
053950              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05395001
053960              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05396001
053970              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05397001
053980             STRING   ' RCKUT128-4840-'                           05398001
053990                      ' CALLED BY-'                               05399001
054000                      RC074-CALLING-PROGRAM                       05400001
054010                      ' PO='                                      05401001
054020                      RC074-DISPLAY-PO                            05402001
054030                      ' RCVR='                                    05403001
054040                      RC074-DISPLAY-RCVR                          05404001
054050                      ' SQLCODE='                                 05405001
054060                      RC074-DISPLAY-SQLCODE                       05406001
054070                      DELIMITED BY SIZE                           05407001
054080                                      INTO RC074-CRA-RET-MSG      05408001
054090             STRING   ' RCKUT128-4840-'                           05409001
054100                      ' CALLED BY-'                               05410001
054110                      RC074-CALLING-PROGRAM                       05411001
054120                      DELIMITED BY SIZE                           05412001
054130                                      INTO RC074-ABEND-TEXT       05413001
054140             MOVE '4840-'               TO RC074-CRA-REQ-ID       05414001
054150                                           RC074-ABEND-PARAGRAPH  05415001
054160             PERFORM 9998-RETURN                                  05416001
054170                                                                  05417001
054180         WHEN SQLWARN0 NOT = SPACES                               05418001
054190         WHEN SQLCODE < ZERO                                      05419001
054200         WHEN SQLCODE > ZERO                                      05420001
054210              SET  RC074-INVALID-SQL                              05421001
054220                   RC074-ERROR-YES                                05422001
054230                   PS-ERROR-YES         TO  TRUE                  05423001
054240              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05424001
054250              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05425001
054260              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05426001
054270              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05427001
054280              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05428001
054290              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05429001
054300              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05430001
054310             STRING   ' RCKUT128-4840-'                           05431001
054320                      ' CALLED BY-'                               05432001
054330                      RC074-CALLING-PROGRAM                       05433001
054340                      ' PO='                                      05434001
054350                      RC074-DISPLAY-PO                            05435001
054360                      ' RCVR='                                    05436001
054370                      RC074-DISPLAY-RCVR                          05437001
054380                      ' SQLCODE='                                 05438001
054390                      RC074-DISPLAY-SQLCODE                       05439001
054400                      DELIMITED BY SIZE                           05440001
054410                                      INTO RC074-CRA-RET-MSG      05441001
054420             STRING   ' RCKUT128-4840-'                           05442001
054430                      ' CALLED BY-'                               05443001
054440                      RC074-CALLING-PROGRAM                       05444001
054450                      DELIMITED BY SIZE                           05445001
054460                                      INTO RC074-ABEND-TEXT       05446001
054470             MOVE '4840-'               TO RC074-CRA-REQ-ID       05447001
054480                                           RC074-ABEND-PARAGRAPH  05448001
054490             PERFORM 9998-RETURN                                  05449001
054500                                                                  05450001
054510     END-EVALUATE.                                                05451001
054520                                                                  05452001
054530                                                                  05453001
054540                                                                  05454001
054550/                                                                 05455001
054560 5000-PROCESS-PACK-CSR.                                           05456001
054570     MOVE 0                           TO PV-NUMBER-OF-LINES       05457001
054580                                         PV-SHIPT-UNT-ID.         05458001
054590                                                                  05459001
054600     PERFORM 5010-OPEN-PACK-CSR.                                  05460001
054610     SET LINE-IDX   TO 1.                                         05461001
054620     PERFORM 5020-FETCH-PACK-CSR                                  05462001
054630              UNTIL PS-PACK-CSR-END-YES.                          05463001
054640     PERFORM 5030-CLOSE-PACK-CSR.                                 05464001
054650     MOVE PV-TOTAL-ODD-UNITS    TO  RC074-ACTUAL-ODD-QTY.         05465001
054660                                                                  05466001
054670*----------------------------------------------------------------*05467001
054680*    OPEN  RECEIVER LINE CURSOR                                  *05468001
054690*----------------------------------------------------------------*05469001
054700 5010-OPEN-PACK-CSR.                                              05470001
054710                                                                  05471001
054720     SET  PS-PACK-CSR-END-NO  TO  TRUE.                           05472001
054730                                                                  05473001
054740     EXEC SQL                                                     05474001
054750          OPEN PACK_CSR                                           05475001
054760     END-EXEC.                                                    05476001
054770                                                                  05477001
054780     EVALUATE TRUE                                                05478001
054790         WHEN SQLCODE = ZERO                                      05479001
054800             CONTINUE                                             05480001
054810         WHEN SQLCODE = -904                                      05481001
054820         WHEN SQLCODE = -911                                      05482001
054830         WHEN SQLCODE = -913                                      05483001
054840              SET  RC074-DATABASE-BUSY                            05484001
054850                   RC074-ERROR-YES                                05485001
054860                   PS-ERROR-YES         TO  TRUE                  05486001
054870              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05487001
054880              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05488001
054890              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05489001
054900              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05490001
054910              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05491001
054920              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05492001
054930              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05493001
054940             STRING   ' RCKUT128-5010-'                           05494001
054950                      ' CALLED BY-'                               05495001
054960                      RC074-CALLING-PROGRAM                       05496001
054970                      ' PO='                                      05497001
054980                      RC074-DISPLAY-PO                            05498001
054990                      ' RCVR='                                    05499001
055000                      RC074-DISPLAY-RCVR                          05500001
055010                      ' SQLCODE='                                 05501001
055020                      RC074-DISPLAY-SQLCODE                       05502001
055030                      DELIMITED BY SIZE                           05503001
055040                                      INTO RC074-CRA-RET-MSG      05504001
055050             STRING   ' RCKUT128-5010-'                           05505001
055060                      ' CALLED BY-'                               05506001
055070                      RC074-CALLING-PROGRAM                       05507001
055080                      DELIMITED BY SIZE                           05508001
055090                                      INTO RC074-ABEND-TEXT       05509001
055100             MOVE '5010-'               TO RC074-CRA-REQ-ID       05510001
055110                                           RC074-ABEND-PARAGRAPH  05511001
055120             PERFORM 9998-RETURN                                  05512001
055130                                                                  05513001
055140         WHEN SQLWARN0 NOT = SPACES                               05514001
055150         WHEN SQLCODE < ZERO                                      05515001
055160         WHEN SQLCODE > ZERO                                      05516001
055170              SET  RC074-INVALID-SQL                              05517001
055180                   RC074-ERROR-YES                                05518001
055190                   PS-ERROR-YES         TO  TRUE                  05519001
055200              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05520001
055210              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05521001
055220              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05522001
055230              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05523001
055240              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05524001
055250              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05525001
055260              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05526001
055270             STRING   ' RCKUT128-5010-'                           05527001
055280                      ' CALLED BY-'                               05528001
055290                      RC074-CALLING-PROGRAM                       05529001
055300                      ' PO='                                      05530001
055310                      RC074-DISPLAY-PO                            05531001
055320                      ' RCVR='                                    05532001
055330                      RC074-DISPLAY-RCVR                          05533001
055340                      ' SQLCODE='                                 05534001
055350                      RC074-DISPLAY-SQLCODE                       05535001
055360                      DELIMITED BY SIZE                           05536001
055370                                      INTO RC074-CRA-RET-MSG      05537001
055380             STRING   ' RCKUT128-5010-'                           05538001
055390                      ' CALLED BY-'                               05539001
055400                      RC074-CALLING-PROGRAM                       05540001
055410                      DELIMITED BY SIZE                           05541001
055420                                      INTO RC074-ABEND-TEXT       05542001
055430             MOVE '5010-'               TO RC074-CRA-REQ-ID       05543001
055440                                           RC074-ABEND-PARAGRAPH  05544001
055450             PERFORM 9998-RETURN                                  05545001
055460                                                                  05546001
055470     END-EVALUATE.                                                05547001
055480                                                                  05548001
055490                                                                  05549001
055500*----------------------------------------------------------------*05550001
055510*    FETCH RECEIVER LINE CURSOR                                  *05551001
055520*----------------------------------------------------------------*05552001
055530 5020-FETCH-PACK-CSR.                                             05553001
055540                                                                  05554001
055550     EXEC SQL                                                     05555001
055560          FETCH PACK_CSR                                          05556001
055570           INTO :SUT00028-SHIPT-UNT-ID                            05557001
055580             ,  :SUT00028-TRN-LNE-NBR                             05558001
055590             ,  :SUT00024-ODD-UNT-IND                             05559001
055600             ,  :RECITM-PREPK-RATO-QTY                            05560001
055610             ,  :PV-SUM-SHPD-UNT-QTY                              05561001
055620     END-EXEC.                                                    05562001
055630                                                                  05563001
055640     EVALUATE TRUE                                                05564001
055650         WHEN SQLCODE = ZERO                                      05565001
055660                                                                  05566001
055670             IF SUT00028-SHIPT-UNT-ID NOT = PV-SHIPT-UNT-ID       05567001
055680                 IF PV-SHIPT-UNT-ID = 0                           05568001
055690                     MOVE SUT00028-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID05569001
055700                 ELSE                                             05570001
055710                     MOVE PV-SHIPT-UNT-ID   TO DK-SHIPT-UNT-ID    05571001
055720                     MOVE 0     TO PV-CARTON-ODD-UNITS            05572001
055730                     PERFORM 5040-COUNT-ODD-UNITS                 05573001
055740                     ADD PV-CARTON-ODD-UNITS                      05574001
055750                                             TO PV-TOTAL-ODD-UNITS05575001
055760                     INITIALIZE PV-PACK-TABLE                     05576001
055770                     SET LINE-IDX   TO 1                          05577001
055780                     MOVE 0        TO PV-NUMBER-OF-LINES          05578001
055790                     MOVE SUT00028-SHIPT-UNT-ID                   05579001
055800                                                TO PV-SHIPT-UNT-ID05580001
055810                 END-IF                                           05581001
055820             END-IF                                               05582001
055830             ADD 1            TO PV-NUMBER-OF-LINES               05583001
055840             MOVE  SUT00028-TRN-LNE-NBR                           05584001
055850                              TO PACK-LINE (LINE-IDX)             05585001
055860             MOVE  RECITM-PREPK-RATO-QTY                          05586001
055870                              TO PACK-RATIO (LINE-IDX)            05587001
055880             MOVE  PV-SUM-SHPD-UNT-QTY                            05588001
055890                              TO PACK-VERIFY-ITM-QTY (LINE-IDX)   05589001
055900             SET LINE-IDX UP BY 1                                 05590001
055910                                                                  05591001
055920         WHEN SQLCODE = +100                                      05592001
055930             IF PV-NUMBER-OF-LINES > 0                            05593001
055940                 MOVE PV-SHIPT-UNT-ID       TO DK-SHIPT-UNT-ID    05594001
055950                 MOVE 0         TO PV-CARTON-ODD-UNITS            05595001
055960                 PERFORM 5040-COUNT-ODD-UNITS                     05596001
055970                 ADD PV-CARTON-ODD-UNITS TO PV-TOTAL-ODD-UNITS    05597001
055980             END-IF                                               05598001
055990             SET  PS-PACK-CSR-END-YES  TO  TRUE                   05599001
056000                                                                  05600001
056010         WHEN SQLCODE = -904                                      05601001
056020         WHEN SQLCODE = -911                                      05602001
056030         WHEN SQLCODE = -913                                      05603001
056040              SET  RC074-DATABASE-BUSY                            05604001
056050                   RC074-ERROR-YES                                05605001
056060                   PS-ERROR-YES         TO  TRUE                  05606001
056070              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05607001
056080              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05608001
056090              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05609001
056100              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05610001
056110              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05611001
056120              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05612001
056130              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05613001
056140             STRING   ' RCKUT128-5020-'                           05614001
056150                      ' CALLED BY-'                               05615001
056160                      RC074-CALLING-PROGRAM                       05616001
056170                      ' PO='                                      05617001
056180                      RC074-DISPLAY-PO                            05618001
056190                      ' RCVR='                                    05619001
056200                      RC074-DISPLAY-RCVR                          05620001
056210                      ' SQLCODE='                                 05621001
056220                      RC074-DISPLAY-SQLCODE                       05622001
056230                      DELIMITED BY SIZE                           05623001
056240                                      INTO RC074-CRA-RET-MSG      05624001
056250             STRING   ' RCKUT128-5020-'                           05625001
056260                      ' CALLED BY-'                               05626001
056270                      RC074-CALLING-PROGRAM                       05627001
056280                      DELIMITED BY SIZE                           05628001
056290                                      INTO RC074-ABEND-TEXT       05629001
056300             MOVE '5020-'               TO RC074-CRA-REQ-ID       05630001
056310                                           RC074-ABEND-PARAGRAPH  05631001
056320             PERFORM 9998-RETURN                                  05632001
056330                                                                  05633001
056340         WHEN SQLWARN0 NOT = SPACE                                05634001
056350         WHEN SQLCODE NOT = ZERO                                  05635001
056360              SET  RC074-INVALID-SQL                              05636001
056370                   RC074-ERROR-YES                                05637001
056380                   PS-ERROR-YES         TO  TRUE                  05638001
056390              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05639001
056400              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05640001
056410              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05641001
056420              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05642001
056430              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05643001
056440              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05644001
056450              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05645001
056460             STRING   ' RCKUT128-5020-'                           05646001
056470                      ' CALLED BY-'                               05647001
056480                      RC074-CALLING-PROGRAM                       05648001
056490                      ' PO='                                      05649001
056500                      RC074-DISPLAY-PO                            05650001
056510                      ' RCVR='                                    05651001
056520                      RC074-DISPLAY-RCVR                          05652001
056530                      ' SQLCODE='                                 05653001
056540                      RC074-DISPLAY-SQLCODE                       05654001
056550                      DELIMITED BY SIZE                           05655001
056560                                      INTO RC074-CRA-RET-MSG      05656001
056570             STRING   ' RCKUT128-5020-'                           05657001
056580                      ' CALLED BY-'                               05658001
056590                      RC074-CALLING-PROGRAM                       05659001
056600                      DELIMITED BY SIZE                           05660001
056610                                      INTO RC074-ABEND-TEXT       05661001
056620             MOVE '5020-'               TO RC074-CRA-REQ-ID       05662001
056630                                           RC074-ABEND-PARAGRAPH  05663001
056640             PERFORM 9998-RETURN                                  05664001
056650                                                                  05665001
056660     END-EVALUATE.                                                05666001
056670                                                                  05667001
056680*----------------------------------------------------------------*05668001
056690* CLOSE RECEIVER LINE CURSOR                                     *05669001
056700*----------------------------------------------------------------*05670001
056710 5030-CLOSE-PACK-CSR.                                             05671001
056720                                                                  05672001
056730     EXEC SQL                                                     05673001
056740          CLOSE PACK_CSR                                          05674001
056750     END-EXEC.                                                    05675001
056760                                                                  05676001
056770     EVALUATE TRUE                                                05677001
056780         WHEN SQLCODE = ZERO                                      05678001
056790             CONTINUE                                             05679001
056800         WHEN SQLCODE = -904                                      05680001
056810         WHEN SQLCODE = -911                                      05681001
056820         WHEN SQLCODE = -913                                      05682001
056830              SET  RC074-DATABASE-BUSY                            05683001
056840                   RC074-ERROR-YES                                05684001
056850                   PS-ERROR-YES         TO  TRUE                  05685001
056860              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05686001
056870              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05687001
056880              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05688001
056890              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05689001
056900              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05690001
056910              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05691001
056920              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05692001
056930             STRING   ' RCKUT128-5030-'                           05693001
056940                      ' CALLED BY-'                               05694001
056950                      RC074-CALLING-PROGRAM                       05695001
056960                      ' PO='                                      05696001
056970                      RC074-DISPLAY-PO                            05697001
056980                      ' RCVR='                                    05698001
056990                      RC074-DISPLAY-RCVR                          05699001
057000                      ' SQLCODE='                                 05700001
057010                      RC074-DISPLAY-SQLCODE                       05701001
057020                      DELIMITED BY SIZE                           05702001
057030                                      INTO RC074-CRA-RET-MSG      05703001
057040             STRING   ' RCKUT128-5030-'                           05704001
057050                      ' CALLED BY-'                               05705001
057060                      RC074-CALLING-PROGRAM                       05706001
057070                      DELIMITED BY SIZE                           05707001
057080                                      INTO RC074-ABEND-TEXT       05708001
057090             MOVE '5030-'               TO RC074-CRA-REQ-ID       05709001
057100                                           RC074-ABEND-PARAGRAPH  05710001
057110             PERFORM 9998-RETURN                                  05711001
057120                                                                  05712001
057130         WHEN SQLWARN0 NOT = SPACES                               05713001
057140         WHEN SQLCODE < ZERO                                      05714001
057150         WHEN SQLCODE > ZERO                                      05715001
057160              SET  RC074-INVALID-SQL                              05716001
057170                   RC074-ERROR-YES                                05717001
057180                   PS-ERROR-YES         TO  TRUE                  05718001
057190              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05719001
057200              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05720001
057210              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05721001
057220              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05722001
057230              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05723001
057240              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05724001
057250              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05725001
057260             STRING   ' RCKUT128-5030-'                           05726001
057270                      ' CALLED BY-'                               05727001
057280                      RC074-CALLING-PROGRAM                       05728001
057290                      ' PO='                                      05729001
057300                      RC074-DISPLAY-PO                            05730001
057310                      ' RCVR='                                    05731001
057320                      RC074-DISPLAY-RCVR                          05732001
057330                      ' SQLCODE='                                 05733001
057340                      RC074-DISPLAY-SQLCODE                       05734001
057350                      DELIMITED BY SIZE                           05735001
057360                                      INTO RC074-CRA-RET-MSG      05736001
057370             STRING   ' RCKUT128-5030-'                           05737001
057380                      ' CALLED BY-'                               05738001
057390                      RC074-CALLING-PROGRAM                       05739001
057400                      DELIMITED BY SIZE                           05740001
057410                                      INTO RC074-ABEND-TEXT       05741001
057420             MOVE '5030-'               TO RC074-CRA-REQ-ID       05742001
057430                                           RC074-ABEND-PARAGRAPH  05743001
057440             PERFORM 9998-RETURN                                  05744001
057450                                                                  05745001
057460     END-EVALUATE.                                                05746001
057470                                                                  05747001
057480 5040-COUNT-ODD-UNITS.                                            05748001
057490     PERFORM 5050-COUNT-PACKS.                                    05749001
057500     IF PV-TOTAL-PACKS > 0                                        05750001
057510         PERFORM VARYING LINE-IDX FROM 1 BY 1                     05751001
057520              UNTIL LINE-IDX > PV-NUMBER-OF-LINES                 05752001
057530              COMPUTE PV-ODD-UNITS =                              05753001
057540                  PACK-VERIFY-ITM-QTY (LINE-IDX) -                05754001
057550                  (PV-TOTAL-PACKS * PACK-RATIO (LINE-IDX))        05755001
057560              ADD PV-ODD-UNITS TO PV-CARTON-ODD-UNITS             05756001
057570         END-PERFORM                                              05757001
057580     ELSE                                                         05758001
057590         PERFORM VARYING LINE-IDX FROM 1 BY 1                     05759001
057600              UNTIL LINE-IDX > PV-NUMBER-OF-LINES                 05760001
057610              MOVE PACK-VERIFY-ITM-QTY (LINE-IDX) TO PV-ODD-UNITS 05761001
057620              ADD PV-ODD-UNITS TO PV-CARTON-ODD-UNITS             05762001
057630         END-PERFORM                                              05763001
057640     END-IF.                                                      05764001
057650                                                                  05765001
057660 5050-COUNT-PACKS.                                                05766001
057670     EXEC SQL                                                     05767001
057680           SELECT SUM(A.SHPD_PK_QTY)                              05768001
057690            INTO :PV-TOTAL-PACKS :PV-NULL-IND                     05769001
057700            FROM SUT_OTBND_PK  A                                  05770001
057710              ,  SUT_OTBND_CART B                                 05771001
057720              ,  TPOPRPK  C                                       05772001
057730          WHERE                                                   05773001
057740                A.TRN_NBR        =  :DK-PO-NBR                    05774001
057750           AND  A.TRN_NBR        =   C.PO_NBR                     05775001
057760           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              05776001
057770           AND  A.SHIPT_UNT_ID   =  :DK-SHIPT-UNT-ID              05777001
057780           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               05778001
057790           AND  B.ACTV_IND       =  'Y'                           05779001
057800           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              05780001
057810           AND  A.PK_SKU_NBR       =  C.PK_SKU_NBR                05781001
057820           AND  C.PO_PREPK_ID      = :DK-PACK-ID                  05782001
057830     END-EXEC.                                                    05783001
057840                                                                  05784001
057850                                                                  05785001
057860     EVALUATE TRUE                                                05786001
057870         WHEN SQLCODE = ZERO                                      05787001
057880             IF PV-NULL-IND = -1                                  05788001
057890                 MOVE 0    TO PV-TOTAL-PACKS                      05789001
057900             END-IF                                               05790001
057910         WHEN SQLCODE = -904                                      05791001
057920         WHEN SQLCODE = -911                                      05792001
057930         WHEN SQLCODE = -913                                      05793001
057940              SET  RC074-DATABASE-BUSY                            05794001
057950                   RC074-ERROR-YES                                05795001
057960                   PS-ERROR-YES         TO  TRUE                  05796001
057970              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05797001
057980              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05798001
057990              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05799001
058000              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05800001
058010              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05801001
058020              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05802001
058030              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05803001
058040             STRING   ' RCKUT128-5050-'                           05804001
058050                      ' CALLED BY-'                               05805001
058060                      RC074-CALLING-PROGRAM                       05806001
058070                      ' PO='                                      05807001
058080                      RC074-DISPLAY-PO                            05808001
058090                      ' RCVR='                                    05809001
058100                      RC074-DISPLAY-RCVR                          05810001
058110                      ' SQLCODE='                                 05811001
058120                      RC074-DISPLAY-SQLCODE                       05812001
058130                      DELIMITED BY SIZE                           05813001
058140                                      INTO RC074-CRA-RET-MSG      05814001
058150             STRING   ' RCKUT128-5050-'                           05815001
058160                      ' CALLED BY-'                               05816001
058170                      RC074-CALLING-PROGRAM                       05817001
058180                      DELIMITED BY SIZE                           05818001
058190                                      INTO RC074-ABEND-TEXT       05819001
058200             MOVE '5050-'               TO RC074-CRA-REQ-ID       05820001
058210                                           RC074-ABEND-PARAGRAPH  05821001
058220             PERFORM 9998-RETURN                                  05822001
058230                                                                  05823001
058240         WHEN SQLWARN0 NOT = SPACES                               05824001
058250         WHEN SQLCODE < ZERO                                      05825001
058260         WHEN SQLCODE > ZERO                                      05826001
058270              SET  RC074-INVALID-SQL                              05827001
058280                   RC074-ERROR-YES                                05828001
058290                   PS-ERROR-YES         TO  TRUE                  05829001
058300              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05830001
058310              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05831001
058320              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05832001
058330              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05833001
058340              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05834001
058350              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05835001
058360              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05836001
058370             STRING   ' RCKUT128-5050-'                           05837001
058380                      ' CALLED BY-'                               05838001
058390                      RC074-CALLING-PROGRAM                       05839001
058400                      ' PO='                                      05840001
058410                      RC074-DISPLAY-PO                            05841001
058420                      ' RCVR='                                    05842001
058430                      RC074-DISPLAY-RCVR                          05843001
058440                      ' SQLCODE='                                 05844001
058450                      RC074-DISPLAY-SQLCODE                       05845001
058460                      DELIMITED BY SIZE                           05846001
058470                                      INTO RC074-CRA-RET-MSG      05847001
058480             STRING   ' RCKUT128-5050-'                           05848001
058490                      ' CALLED BY-'                               05849001
058500                      RC074-CALLING-PROGRAM                       05850001
058510                      DELIMITED BY SIZE                           05851001
058520                                      INTO RC074-ABEND-TEXT       05852001
058530             MOVE '5050-'               TO RC074-CRA-REQ-ID       05853001
058540                                           RC074-ABEND-PARAGRAPH  05854001
058550             PERFORM 9998-RETURN                                  05855001
058560                                                                  05856001
058570     END-EVALUATE.                                                05857001
058580                                                                  05858001
058590                                                                  05859001
058600 5100-PROCESS-PACK-STR-CSR.                                       05860001
058610     MOVE 0                           TO PV-NUMBER-OF-LINES       05861001
058620                                         PV-SHIPT-UNT-ID.         05862001
058630                                                                  05863001
058640     PERFORM 5110-OPEN-PACK-STR-CSR.                              05864001
058650     SET LINE-IDX   TO 1.                                         05865001
058660     PERFORM 5120-FETCH-PACK-STR-CSR                              05866001
058670              UNTIL PS-PACK-STR-CSR-END-YES.                      05867001
058680     PERFORM 5130-CLOSE-PACK-STR-CSR.                             05868001
058690     MOVE PV-TOTAL-ODD-UNITS    TO  RC074-ACTUAL-ODD-QTY.         05869001
058700                                                                  05870001
058710*----------------------------------------------------------------*05871001
058720 5110-OPEN-PACK-STR-CSR.                                          05872001
058730                                                                  05873001
058740     SET  PS-PACK-STR-CSR-END-NO  TO  TRUE.                       05874001
058750                                                                  05875001
058760     EXEC SQL                                                     05876001
058770          OPEN PACK_STR_CSR                                       05877001
058780     END-EXEC.                                                    05878001
058790                                                                  05879001
058800     EVALUATE TRUE                                                05880001
058810         WHEN SQLCODE = ZERO                                      05881001
058820             CONTINUE                                             05882001
058830         WHEN SQLCODE = -904                                      05883001
058840         WHEN SQLCODE = -911                                      05884001
058850         WHEN SQLCODE = -913                                      05885001
058860              SET  RC074-DATABASE-BUSY                            05886001
058870                   RC074-ERROR-YES                                05887001
058880                   PS-ERROR-YES         TO  TRUE                  05888001
058890              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05889001
058900              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05890001
058910              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05891001
058920              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05892001
058930              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05893001
058940              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05894001
058950              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05895001
058960             STRING   ' RCKUT128-5110-'                           05896001
058970                      ' CALLED BY-'                               05897001
058980                      RC074-CALLING-PROGRAM                       05898001
058990                      ' PO='                                      05899001
059000                      RC074-DISPLAY-PO                            05900001
059010                      ' RCVR='                                    05901001
059020                      RC074-DISPLAY-RCVR                          05902001
059030                      ' SQLCODE='                                 05903001
059040                      RC074-DISPLAY-SQLCODE                       05904001
059050                      DELIMITED BY SIZE                           05905001
059060                                      INTO RC074-CRA-RET-MSG      05906001
059070             STRING   ' RCKUT128-5110-'                           05907001
059080                      ' CALLED BY-'                               05908001
059090                      RC074-CALLING-PROGRAM                       05909001
059100                      DELIMITED BY SIZE                           05910001
059110                                      INTO RC074-ABEND-TEXT       05911001
059120             MOVE '5110-'               TO RC074-CRA-REQ-ID       05912001
059130                                           RC074-ABEND-PARAGRAPH  05913001
059140             PERFORM 9998-RETURN                                  05914001
059150                                                                  05915001
059160         WHEN SQLWARN0 NOT = SPACES                               05916001
059170         WHEN SQLCODE < ZERO                                      05917001
059180         WHEN SQLCODE > ZERO                                      05918001
059190              SET  RC074-INVALID-SQL                              05919001
059200                   RC074-ERROR-YES                                05920001
059210                   PS-ERROR-YES         TO  TRUE                  05921001
059220              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 05922001
059230              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      05923001
059240              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    05924001
059250              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    05925001
059260              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    05926001
059270              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     05927001
059280              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    05928001
059290             STRING   ' RCKUT128-5110-'                           05929001
059300                      ' CALLED BY-'                               05930001
059310                      RC074-CALLING-PROGRAM                       05931001
059320                      ' PO='                                      05932001
059330                      RC074-DISPLAY-PO                            05933001
059340                      ' RCVR='                                    05934001
059350                      RC074-DISPLAY-RCVR                          05935001
059360                      ' SQLCODE='                                 05936001
059370                      RC074-DISPLAY-SQLCODE                       05937001
059380                      DELIMITED BY SIZE                           05938001
059390                                      INTO RC074-CRA-RET-MSG      05939001
059400             STRING   ' RCKUT128-5110-'                           05940001
059410                      ' CALLED BY-'                               05941001
059420                      RC074-CALLING-PROGRAM                       05942001
059430                      DELIMITED BY SIZE                           05943001
059440                                      INTO RC074-ABEND-TEXT       05944001
059450             MOVE '5110-'               TO RC074-CRA-REQ-ID       05945001
059460                                           RC074-ABEND-PARAGRAPH  05946001
059470             PERFORM 9998-RETURN                                  05947001
059480                                                                  05948001
059490     END-EVALUATE.                                                05949001
059500                                                                  05950001
059510                                                                  05951001
059520*----------------------------------------------------------------*05952001
059530 5120-FETCH-PACK-STR-CSR.                                         05953001
059540                                                                  05954001
059550     EXEC SQL                                                     05955001
059560          FETCH PACK_STR_CSR                                      05956001
059570           INTO :SUT00028-SHIPT-UNT-ID                            05957001
059580             ,  :SUT00028-TRN-LNE-NBR                             05958001
059590             ,  :SUT00024-ODD-UNT-IND                             05959001
059600             ,  :RECITM-PREPK-RATO-QTY                            05960001
059610             ,  :PV-SUM-SHPD-UNT-QTY                              05961001
059620     END-EXEC.                                                    05962001
059630                                                                  05963001
059640     EVALUATE TRUE                                                05964001
059650         WHEN SQLCODE = ZERO                                      05965001
059660             IF SUT00028-SHIPT-UNT-ID NOT = PV-SHIPT-UNT-ID       05966001
059670                 IF PV-SHIPT-UNT-ID = 0                           05967001
059680                     MOVE SUT00028-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID05968001
059690                 ELSE                                             05969001
059700                     MOVE PV-SHIPT-UNT-ID   TO DK-SHIPT-UNT-ID    05970001
059710                     MOVE 0     TO PV-CARTON-ODD-UNITS            05971001
059720                     PERFORM 5140-COUNT-ODD-UNITS                 05972001
059730                     ADD PV-CARTON-ODD-UNITS                      05973001
059740                                             TO PV-TOTAL-ODD-UNITS05974001
059750                     INITIALIZE PV-PACK-TABLE                     05975001
059760                     SET LINE-IDX   TO 1                          05976001
059770                     MOVE 0        TO PV-NUMBER-OF-LINES          05977001
059780                     MOVE SUT00028-SHIPT-UNT-ID                   05978001
059790                                                TO PV-SHIPT-UNT-ID05979001
059800                 END-IF                                           05980001
059810             END-IF                                               05981001
059820             ADD 1            TO PV-NUMBER-OF-LINES               05982001
059830             MOVE  SUT00028-TRN-LNE-NBR                           05983001
059840                              TO PACK-LINE (LINE-IDX)             05984001
059850             MOVE  RECITM-PREPK-RATO-QTY                          05985001
059860                              TO PACK-RATIO (LINE-IDX)            05986001
059870             MOVE  PV-SUM-SHPD-UNT-QTY                            05987001
059880                              TO PACK-VERIFY-ITM-QTY (LINE-IDX)   05988001
059890             SET LINE-IDX UP BY 1                                 05989001
059900                                                                  05990001
059910         WHEN SQLCODE = +100                                      05991001
059920             IF PV-NUMBER-OF-LINES > 0                            05992001
059930                 MOVE PV-SHIPT-UNT-ID       TO DK-SHIPT-UNT-ID    05993001
059940                 MOVE 0         TO PV-CARTON-ODD-UNITS            05994001
059950                 PERFORM 5140-COUNT-ODD-UNITS                     05995001
059960                 ADD PV-CARTON-ODD-UNITS TO PV-TOTAL-ODD-UNITS    05996001
059970             END-IF                                               05997001
059980             SET  PS-PACK-STR-CSR-END-YES  TO  TRUE               05998001
059990                                                                  05999001
060000         WHEN SQLCODE = -904                                      06000001
060010         WHEN SQLCODE = -911                                      06001001
060020         WHEN SQLCODE = -913                                      06002001
060030              SET  RC074-DATABASE-BUSY                            06003001
060040                   RC074-ERROR-YES                                06004001
060050                   PS-ERROR-YES         TO  TRUE                  06005001
060060              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06006001
060070              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06007001
060080              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06008001
060090              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06009001
060100              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06010001
060110              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06011001
060120              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06012001
060130             STRING   ' RCKUT128-5120-'                           06013001
060140                      ' CALLED BY-'                               06014001
060150                      RC074-CALLING-PROGRAM                       06015001
060160                      ' PO='                                      06016001
060170                      RC074-DISPLAY-PO                            06017001
060180                      ' RCVR='                                    06018001
060190                      RC074-DISPLAY-RCVR                          06019001
060200                      ' SQLCODE='                                 06020001
060210                      RC074-DISPLAY-SQLCODE                       06021001
060220                      DELIMITED BY SIZE                           06022001
060230                                      INTO RC074-CRA-RET-MSG      06023001
060240             STRING   ' RCKUT128-5120-'                           06024001
060250                      ' CALLED BY-'                               06025001
060260                      RC074-CALLING-PROGRAM                       06026001
060270                      DELIMITED BY SIZE                           06027001
060280                                      INTO RC074-ABEND-TEXT       06028001
060290             MOVE '5120-'               TO RC074-CRA-REQ-ID       06029001
060300                                           RC074-ABEND-PARAGRAPH  06030001
060310             PERFORM 9998-RETURN                                  06031001
060320                                                                  06032001
060330         WHEN SQLWARN0 NOT = SPACE                                06033001
060340         WHEN SQLCODE NOT = ZERO                                  06034001
060350              SET  RC074-INVALID-SQL                              06035001
060360                   RC074-ERROR-YES                                06036001
060370                   PS-ERROR-YES         TO  TRUE                  06037001
060380              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06038001
060390              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06039001
060400              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06040001
060410              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06041001
060420              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06042001
060430              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06043001
060440              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06044001
060450             STRING   ' RCKUT128-5120-'                           06045001
060460                      ' CALLED BY-'                               06046001
060470                      RC074-CALLING-PROGRAM                       06047001
060480                      ' PO='                                      06048001
060490                      RC074-DISPLAY-PO                            06049001
060500                      ' RCVR='                                    06050001
060510                      RC074-DISPLAY-RCVR                          06051001
060520                      ' SQLCODE='                                 06052001
060530                      RC074-DISPLAY-SQLCODE                       06053001
060540                      DELIMITED BY SIZE                           06054001
060550                                      INTO RC074-CRA-RET-MSG      06055001
060560             STRING   ' RCKUT128-5120-'                           06056001
060570                      ' CALLED BY-'                               06057001
060580                      RC074-CALLING-PROGRAM                       06058001
060590                      DELIMITED BY SIZE                           06059001
060600                                      INTO RC074-ABEND-TEXT       06060001
060610             MOVE '5120-'               TO RC074-CRA-REQ-ID       06061001
060620                                           RC074-ABEND-PARAGRAPH  06062001
060630             PERFORM 9998-RETURN                                  06063001
060640                                                                  06064001
060650     END-EVALUATE.                                                06065001
060660                                                                  06066001
060670*----------------------------------------------------------------*06067001
060680 5130-CLOSE-PACK-STR-CSR.                                         06068001
060690                                                                  06069001
060700     EXEC SQL                                                     06070001
060710          CLOSE PACK_STR_CSR                                      06071001
060720     END-EXEC.                                                    06072001
060730                                                                  06073001
060740     EVALUATE TRUE                                                06074001
060750         WHEN SQLCODE = ZERO                                      06075001
060760             CONTINUE                                             06076001
060770         WHEN SQLCODE = -904                                      06077001
060780         WHEN SQLCODE = -911                                      06078001
060790         WHEN SQLCODE = -913                                      06079001
060800              SET  RC074-DATABASE-BUSY                            06080001
060810                   RC074-ERROR-YES                                06081001
060820                   PS-ERROR-YES         TO  TRUE                  06082001
060830              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06083001
060840              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06084001
060850              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06085001
060860              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06086001
060870              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06087001
060880              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06088001
060890              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06089001
060900             STRING   ' RCKUT128-5130-'                           06090001
060910                      ' CALLED BY-'                               06091001
060920                      RC074-CALLING-PROGRAM                       06092001
060930                      ' PO='                                      06093001
060940                      RC074-DISPLAY-PO                            06094001
060950                      ' RCVR='                                    06095001
060960                      RC074-DISPLAY-RCVR                          06096001
060970                      ' SQLCODE='                                 06097001
060980                      RC074-DISPLAY-SQLCODE                       06098001
060990                      DELIMITED BY SIZE                           06099001
061000                                      INTO RC074-CRA-RET-MSG      06100001
061010             STRING   ' RCKUT128-5130-'                           06101001
061020                      ' CALLED BY-'                               06102001
061030                      RC074-CALLING-PROGRAM                       06103001
061040                      DELIMITED BY SIZE                           06104001
061050                                      INTO RC074-ABEND-TEXT       06105001
061060             MOVE '5130-'               TO RC074-CRA-REQ-ID       06106001
061070                                           RC074-ABEND-PARAGRAPH  06107001
061080             PERFORM 9998-RETURN                                  06108001
061090                                                                  06109001
061100         WHEN SQLWARN0 NOT = SPACES                               06110001
061110         WHEN SQLCODE < ZERO                                      06111001
061120         WHEN SQLCODE > ZERO                                      06112001
061130              SET  RC074-INVALID-SQL                              06113001
061140                   RC074-ERROR-YES                                06114001
061150                   PS-ERROR-YES         TO  TRUE                  06115001
061160              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06116001
061170              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06117001
061180              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06118001
061190              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06119001
061200              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06120001
061210              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06121001
061220              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06122001
061230             STRING   ' RCKUT128-5130-'                           06123001
061240                      ' CALLED BY-'                               06124001
061250                      RC074-CALLING-PROGRAM                       06125001
061260                      ' PO='                                      06126001
061270                      RC074-DISPLAY-PO                            06127001
061280                      ' RCVR='                                    06128001
061290                      RC074-DISPLAY-RCVR                          06129001
061300                      ' SQLCODE='                                 06130001
061310                      RC074-DISPLAY-SQLCODE                       06131001
061320                      DELIMITED BY SIZE                           06132001
061330                                      INTO RC074-CRA-RET-MSG      06133001
061340             STRING   ' RCKUT128-5130-'                           06134001
061350                      ' CALLED BY-'                               06135001
061360                      RC074-CALLING-PROGRAM                       06136001
061370                      DELIMITED BY SIZE                           06137001
061380                                      INTO RC074-ABEND-TEXT       06138001
061390             MOVE '5130-'               TO RC074-CRA-REQ-ID       06139001
061400                                           RC074-ABEND-PARAGRAPH  06140001
061410             PERFORM 9998-RETURN                                  06141001
061420                                                                  06142001
061430     END-EVALUATE.                                                06143001
061440                                                                  06144001
061450 5140-COUNT-ODD-UNITS.                                            06145001
061460     PERFORM 5150-COUNT-PACKS.                                    06146001
061470     IF PV-TOTAL-PACKS > 0                                        06147001
061480         PERFORM VARYING LINE-IDX FROM 1 BY 1                     06148001
061490              UNTIL LINE-IDX > PV-NUMBER-OF-LINES                 06149001
061500              COMPUTE PV-ODD-UNITS =                              06150001
061510                  PACK-VERIFY-ITM-QTY (LINE-IDX) -                06151001
061520                  (PV-TOTAL-PACKS * PACK-RATIO (LINE-IDX))        06152001
061530              ADD PV-ODD-UNITS TO PV-CARTON-ODD-UNITS             06153001
061540         END-PERFORM                                              06154001
061550     ELSE                                                         06155001
061560         PERFORM VARYING LINE-IDX FROM 1 BY 1                     06156001
061570              UNTIL LINE-IDX > PV-NUMBER-OF-LINES                 06157001
061580              MOVE PACK-VERIFY-ITM-QTY (LINE-IDX) TO PV-ODD-UNITS 06158001
061590              ADD PV-ODD-UNITS TO PV-CARTON-ODD-UNITS             06159001
061600         END-PERFORM                                              06160001
061610     END-IF.                                                      06161001
061620                                                                  06162001
061630 5150-COUNT-PACKS.                                                06163001
061640     EXEC SQL                                                     06164001
061650           SELECT SUM(A.SHPD_PK_QTY)                              06165001
061660            INTO :PV-TOTAL-PACKS :PV-NULL-IND                     06166001
061670            FROM SUT_OTBND_PK  A                                  06167001
061680              ,  SUT_OTBND_CART B                                 06168001
061690              ,  TPOPRPK  C                                       06169001
061700          WHERE                                                   06170001
061710                A.TRN_NBR        =  :DK-PO-NBR                    06171001
061720           AND  A.TRN_NBR        =   C.PO_NBR                     06172001
061730           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              06173001
061740           AND  A.SHIPT_UNT_ID   =  :DK-SHIPT-UNT-ID              06174001
061750           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               06175001
061760           AND  B.DEST_LOC_NBR   =  :DK-STR-NBR                   06176001
061770           AND  B.ACTV_IND       =  'Y'                           06177001
061780           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              06178001
061790           AND  A.PK_SKU_NBR       =  C.PK_SKU_NBR                06179001
061800           AND  C.PO_PREPK_ID      = :DK-PACK-ID                  06180001
061810     END-EXEC.                                                    06181001
061820                                                                  06182001
061830                                                                  06183001
061840     EVALUATE TRUE                                                06184001
061850         WHEN SQLCODE = ZERO                                      06185001
061860             IF PV-NULL-IND = -1                                  06186001
061870                 MOVE 0    TO PV-TOTAL-PACKS                      06187001
061880             END-IF                                               06188001
061890         WHEN SQLCODE = -904                                      06189001
061900         WHEN SQLCODE = -911                                      06190001
061910         WHEN SQLCODE = -913                                      06191001
061920              SET  RC074-DATABASE-BUSY                            06192001
061930                   RC074-ERROR-YES                                06193001
061940                   PS-ERROR-YES         TO  TRUE                  06194001
061950              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06195001
061960              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06196001
061970              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06197001
061980              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06198001
061990              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06199001
062000              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06200001
062010              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06201001
062020             STRING   ' RCKUT128-5150-'                           06202001
062030                      ' CALLED BY-'                               06203001
062040                      RC074-CALLING-PROGRAM                       06204001
062050                      ' PO='                                      06205001
062060                      RC074-DISPLAY-PO                            06206001
062070                      ' RCVR='                                    06207001
062080                      RC074-DISPLAY-RCVR                          06208001
062090                      ' SQLCODE='                                 06209001
062100                      RC074-DISPLAY-SQLCODE                       06210001
062110                      DELIMITED BY SIZE                           06211001
062120                                      INTO RC074-CRA-RET-MSG      06212001
062130             STRING   ' RCKUT128-5150-'                           06213001
062140                      ' CALLED BY-'                               06214001
062150                      RC074-CALLING-PROGRAM                       06215001
062160                      DELIMITED BY SIZE                           06216001
062170                                      INTO RC074-ABEND-TEXT       06217001
062180             MOVE '5150-'               TO RC074-CRA-REQ-ID       06218001
062190                                           RC074-ABEND-PARAGRAPH  06219001
062200             PERFORM 9998-RETURN                                  06220001
062210                                                                  06221001
062220         WHEN SQLWARN0 NOT = SPACES                               06222001
062230         WHEN SQLCODE < ZERO                                      06223001
062240         WHEN SQLCODE > ZERO                                      06224001
062250              SET  RC074-INVALID-SQL                              06225001
062260                   RC074-ERROR-YES                                06226001
062270                   PS-ERROR-YES         TO  TRUE                  06227001
062280              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06228001
062290              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06229001
062300              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06230001
062310              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06231001
062320              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06232001
062330              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06233001
062340              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06234001
062350             STRING   ' RCKUT128-5150-'                           06235001
062360                      ' CALLED BY-'                               06236001
062370                      RC074-CALLING-PROGRAM                       06237001
062380                      ' PO='                                      06238001
062390                      RC074-DISPLAY-PO                            06239001
062400                      ' RCVR='                                    06240001
062410                      RC074-DISPLAY-RCVR                          06241001
062420                      ' SQLCODE='                                 06242001
062430                      RC074-DISPLAY-SQLCODE                       06243001
062440                      DELIMITED BY SIZE                           06244001
062450                                      INTO RC074-CRA-RET-MSG      06245001
062460             STRING   ' RCKUT128-5150-'                           06246001
062470                      ' CALLED BY-'                               06247001
062480                      RC074-CALLING-PROGRAM                       06248001
062490                      DELIMITED BY SIZE                           06249001
062500                                      INTO RC074-ABEND-TEXT       06250001
062510             MOVE '5150-'               TO RC074-CRA-REQ-ID       06251001
062520                                           RC074-ABEND-PARAGRAPH  06252001
062530             PERFORM 9998-RETURN                                  06253001
062540                                                                  06254001
062550     END-EVALUATE.                                                06255001
062560                                                                  06256001
062570 5200-PROCESS-PACK-STR-LNE-CSR.                                   06257001
062580     MOVE 0                           TO PV-NUMBER-OF-LINES       06258001
062590                                         PV-SHIPT-UNT-ID.         06259001
062600                                                                  06260001
062610     PERFORM 5210-OPEN-PACK-STR-LNE-CSR.                          06261001
062620     SET LINE-IDX   TO 1.                                         06262001
062630     PERFORM 5220-FETCH-PACK-STR-LNE-CSR                          06263001
062640              UNTIL PS-PACK-STR-LNE-CSR-END-YES.                  06264001
062650     PERFORM 5230-CLOSE-PACK-STR-LNE-CSR.                         06265001
062660     MOVE PV-TOTAL-ODD-UNITS    TO  RC074-ACTUAL-ODD-QTY.         06266001
062670                                                                  06267001
062680*----------------------------------------------------------------*06268001
062690 5210-OPEN-PACK-STR-LNE-CSR.                                      06269001
062700                                                                  06270001
062710     SET  PS-PACK-STR-LNE-CSR-END-NO  TO  TRUE.                   06271001
062720                                                                  06272001
062730     EXEC SQL                                                     06273001
062740          OPEN PACK_STR_LNE_CSR                                   06274001
062750     END-EXEC.                                                    06275001
062760                                                                  06276001
062770     EVALUATE TRUE                                                06277001
062780         WHEN SQLCODE = ZERO                                      06278001
062790             CONTINUE                                             06279001
062800         WHEN SQLCODE = -904                                      06280001
062810         WHEN SQLCODE = -911                                      06281001
062820         WHEN SQLCODE = -913                                      06282001
062830              SET  RC074-DATABASE-BUSY                            06283001
062840                   RC074-ERROR-YES                                06284001
062850                   PS-ERROR-YES         TO  TRUE                  06285001
062860              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06286001
062870              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06287001
062880              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06288001
062890              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06289001
062900              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06290001
062910              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06291001
062920              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06292001
062930             STRING   ' RCKUT128-5210-'                           06293001
062940                      ' CALLED BY-'                               06294001
062950                      RC074-CALLING-PROGRAM                       06295001
062960                      ' PO='                                      06296001
062970                      RC074-DISPLAY-PO                            06297001
062980                      ' RCVR='                                    06298001
062990                      RC074-DISPLAY-RCVR                          06299001
063000                      ' SQLCODE='                                 06300001
063010                      RC074-DISPLAY-SQLCODE                       06301001
063020                      DELIMITED BY SIZE                           06302001
063030                                      INTO RC074-CRA-RET-MSG      06303001
063040             STRING   ' RCKUT128-5210-'                           06304001
063050                      ' CALLED BY-'                               06305001
063060                      RC074-CALLING-PROGRAM                       06306001
063070                      DELIMITED BY SIZE                           06307001
063080                                      INTO RC074-ABEND-TEXT       06308001
063090             MOVE '5210-'               TO RC074-CRA-REQ-ID       06309001
063100                                           RC074-ABEND-PARAGRAPH  06310001
063110             PERFORM 9998-RETURN                                  06311001
063120                                                                  06312001
063130         WHEN SQLWARN0 NOT = SPACES                               06313001
063140         WHEN SQLCODE < ZERO                                      06314001
063150         WHEN SQLCODE > ZERO                                      06315001
063160              SET  RC074-INVALID-SQL                              06316001
063170                   RC074-ERROR-YES                                06317001
063180                   PS-ERROR-YES         TO  TRUE                  06318001
063190              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06319001
063200              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06320001
063210              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06321001
063220              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06322001
063230              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06323001
063240              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06324001
063250              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06325001
063260             STRING   ' RCKUT128-5210-'                           06326001
063270                      ' CALLED BY-'                               06327001
063280                      RC074-CALLING-PROGRAM                       06328001
063290                      ' PO='                                      06329001
063300                      RC074-DISPLAY-PO                            06330001
063310                      ' RCVR='                                    06331001
063320                      RC074-DISPLAY-RCVR                          06332001
063330                      ' SQLCODE='                                 06333001
063340                      RC074-DISPLAY-SQLCODE                       06334001
063350                      DELIMITED BY SIZE                           06335001
063360                                      INTO RC074-CRA-RET-MSG      06336001
063370             STRING   ' RCKUT128-5210-'                           06337001
063380                      ' CALLED BY-'                               06338001
063390                      RC074-CALLING-PROGRAM                       06339001
063400                      DELIMITED BY SIZE                           06340001
063410                                      INTO RC074-ABEND-TEXT       06341001
063420             MOVE '5210-'               TO RC074-CRA-REQ-ID       06342001
063430                                           RC074-ABEND-PARAGRAPH  06343001
063440             PERFORM 9998-RETURN                                  06344001
063450                                                                  06345001
063460     END-EVALUATE.                                                06346001
063470                                                                  06347001
063480*----------------------------------------------------------------*06348001
063490 5220-FETCH-PACK-STR-LNE-CSR.                                     06349001
063500                                                                  06350001
063510     EXEC SQL                                                     06351001
063520          FETCH PACK_STR_LNE_CSR                                  06352001
063530           INTO :SUT00028-SHIPT-UNT-ID                            06353001
063540             ,  :SUT00028-TRN-LNE-NBR                             06354001
063550             ,  :SUT00024-ODD-UNT-IND                             06355001
063560             ,  :RECITM-PREPK-RATO-QTY                            06356001
063570             ,  :PV-SUM-SHPD-UNT-QTY                              06357001
063580     END-EXEC.                                                    06358001
063590                                                                  06359001
063600     EVALUATE TRUE                                                06360001
063610         WHEN SQLCODE = ZERO                                      06361001
063620             IF SUT00028-SHIPT-UNT-ID NOT = PV-SHIPT-UNT-ID       06362001
063630                 IF PV-SHIPT-UNT-ID = 0                           06363001
063640                     MOVE SUT00028-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID06364001
063650                 ELSE                                             06365001
063660                     MOVE PV-SHIPT-UNT-ID   TO DK-SHIPT-UNT-ID    06366001
063670                     MOVE 0     TO PV-CARTON-ODD-UNITS            06367001
063680                     PERFORM 5240-COUNT-ODD-UNITS                 06368001
063690                     ADD PV-CARTON-ODD-UNITS                      06369001
063700                                             TO PV-TOTAL-ODD-UNITS06370001
063710                     INITIALIZE PV-PACK-TABLE                     06371001
063720                     SET LINE-IDX TO 1                            06372001
063730                     MOVE 0       TO PV-NUMBER-OF-LINES           06373001
063740                     MOVE SUT00028-SHIPT-UNT-ID                   06374001
063750                                                TO PV-SHIPT-UNT-ID06375001
063760                 END-IF                                           06376001
063770             END-IF                                               06377001
063780             ADD 1            TO PV-NUMBER-OF-LINES               06378001
063790             MOVE  SUT00028-TRN-LNE-NBR                           06379001
063800                              TO PACK-LINE (LINE-IDX)             06380001
063810             MOVE  RECITM-PREPK-RATO-QTY                          06381001
063820                              TO PACK-RATIO (LINE-IDX)            06382001
063830             MOVE  PV-SUM-SHPD-UNT-QTY                            06383001
063840                              TO PACK-VERIFY-ITM-QTY (LINE-IDX)   06384001
063850             SET LINE-IDX UP BY 1                                 06385001
063860                                                                  06386001
063870         WHEN SQLCODE = +100                                      06387001
063880             IF PV-NUMBER-OF-LINES > 0                            06388001
063890                 MOVE PV-SHIPT-UNT-ID       TO DK-SHIPT-UNT-ID    06389001
063900                 MOVE 0         TO PV-CARTON-ODD-UNITS            06390001
063910                 PERFORM 5240-COUNT-ODD-UNITS                     06391001
063920                 ADD PV-CARTON-ODD-UNITS TO PV-TOTAL-ODD-UNITS    06392001
063930             END-IF                                               06393001
063940             SET  PS-PACK-STR-LNE-CSR-END-YES TO TRUE             06394001
063950                                                                  06395001
063960         WHEN SQLCODE = -904                                      06396001
063970         WHEN SQLCODE = -911                                      06397001
063980         WHEN SQLCODE = -913                                      06398001
063990              SET  RC074-DATABASE-BUSY                            06399001
064000                   RC074-ERROR-YES                                06400001
064010                   PS-ERROR-YES         TO  TRUE                  06401001
064020              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06402001
064030              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06403001
064040              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06404001
064050              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06405001
064060              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06406001
064070              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06407001
064080              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06408001
064090             STRING   ' RCKUT128-5220-'                           06409001
064100                      ' CALLED BY-'                               06410001
064110                      RC074-CALLING-PROGRAM                       06411001
064120                      ' PO='                                      06412001
064130                      RC074-DISPLAY-PO                            06413001
064140                      ' RCVR='                                    06414001
064150                      RC074-DISPLAY-RCVR                          06415001
064160                      ' SQLCODE='                                 06416001
064170                      RC074-DISPLAY-SQLCODE                       06417001
064180                      DELIMITED BY SIZE                           06418001
064190                                      INTO RC074-CRA-RET-MSG      06419001
064200             STRING   ' RCKUT128-5220-'                           06420001
064210                      ' CALLED BY-'                               06421001
064220                      RC074-CALLING-PROGRAM                       06422001
064230                      DELIMITED BY SIZE                           06423001
064240                                      INTO RC074-ABEND-TEXT       06424001
064250             MOVE '5220-'               TO RC074-CRA-REQ-ID       06425001
064260                                           RC074-ABEND-PARAGRAPH  06426001
064270             PERFORM 9998-RETURN                                  06427001
064280                                                                  06428001
064290         WHEN SQLWARN0 NOT = SPACE                                06429001
064300         WHEN SQLCODE NOT = ZERO                                  06430001
064310              SET  RC074-INVALID-SQL                              06431001
064320                   RC074-ERROR-YES                                06432001
064330                   PS-ERROR-YES         TO  TRUE                  06433001
064340              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06434001
064350              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06435001
064360              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06436001
064370              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06437001
064380              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06438001
064390              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06439001
064400              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06440001
064410             STRING   ' RCKUT128-5220-'                           06441001
064420                      ' CALLED BY-'                               06442001
064430                      RC074-CALLING-PROGRAM                       06443001
064440                      ' PO='                                      06444001
064450                      RC074-DISPLAY-PO                            06445001
064460                      ' RCVR='                                    06446001
064470                      RC074-DISPLAY-RCVR                          06447001
064480                      ' SQLCODE='                                 06448001
064490                      RC074-DISPLAY-SQLCODE                       06449001
064500                      DELIMITED BY SIZE                           06450001
064510                                      INTO RC074-CRA-RET-MSG      06451001
064520             STRING   ' RCKUT128-5220-'                           06452001
064530                      ' CALLED BY-'                               06453001
064540                      RC074-CALLING-PROGRAM                       06454001
064550                      DELIMITED BY SIZE                           06455001
064560                                      INTO RC074-ABEND-TEXT       06456001
064570             MOVE '5220-'               TO RC074-CRA-REQ-ID       06457001
064580                                           RC074-ABEND-PARAGRAPH  06458001
064590             PERFORM 9998-RETURN                                  06459001
064600                                                                  06460001
064610     END-EVALUATE.                                                06461001
064620                                                                  06462001
064630*----------------------------------------------------------------*06463001
064640 5230-CLOSE-PACK-STR-LNE-CSR.                                     06464001
064650                                                                  06465001
064660     EXEC SQL                                                     06466001
064670          CLOSE PACK_STR_LNE_CSR                                  06467001
064680     END-EXEC.                                                    06468001
064690                                                                  06469001
064700     EVALUATE TRUE                                                06470001
064710         WHEN SQLCODE = ZERO                                      06471001
064720             CONTINUE                                             06472001
064730         WHEN SQLCODE = -904                                      06473001
064740         WHEN SQLCODE = -911                                      06474001
064750         WHEN SQLCODE = -913                                      06475001
064760              SET  RC074-DATABASE-BUSY                            06476001
064770                   RC074-ERROR-YES                                06477001
064780                   PS-ERROR-YES         TO  TRUE                  06478001
064790              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06479001
064800              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06480001
064810              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06481001
064820              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06482001
064830              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06483001
064840              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06484001
064850              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06485001
064860             STRING   ' RCKUT128-5230-'                           06486001
064870                      ' CALLED BY-'                               06487001
064880                      RC074-CALLING-PROGRAM                       06488001
064890                      ' PO='                                      06489001
064900                      RC074-DISPLAY-PO                            06490001
064910                      ' RCVR='                                    06491001
064920                      RC074-DISPLAY-RCVR                          06492001
064930                      ' SQLCODE='                                 06493001
064940                      RC074-DISPLAY-SQLCODE                       06494001
064950                      DELIMITED BY SIZE                           06495001
064960                                      INTO RC074-CRA-RET-MSG      06496001
064970             STRING   ' RCKUT128-5230-'                           06497001
064980                      ' CALLED BY-'                               06498001
064990                      RC074-CALLING-PROGRAM                       06499001
065000                      DELIMITED BY SIZE                           06500001
065010                                      INTO RC074-ABEND-TEXT       06501001
065020             MOVE '5230-'               TO RC074-CRA-REQ-ID       06502001
065030                                           RC074-ABEND-PARAGRAPH  06503001
065040             PERFORM 9998-RETURN                                  06504001
065050                                                                  06505001
065060         WHEN SQLWARN0 NOT = SPACES                               06506001
065070         WHEN SQLCODE < ZERO                                      06507001
065080         WHEN SQLCODE > ZERO                                      06508001
065090              SET  RC074-INVALID-SQL                              06509001
065100                   RC074-ERROR-YES                                06510001
065110                   PS-ERROR-YES         TO  TRUE                  06511001
065120              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06512001
065130              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06513001
065140              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06514001
065150              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06515001
065160              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06516001
065170              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06517001
065180              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06518001
065190             STRING   ' RCKUT128-5230-'                           06519001
065200                      ' CALLED BY-'                               06520001
065210                      RC074-CALLING-PROGRAM                       06521001
065220                      ' PO='                                      06522001
065230                      RC074-DISPLAY-PO                            06523001
065240                      ' RCVR='                                    06524001
065250                      RC074-DISPLAY-RCVR                          06525001
065260                      ' SQLCODE='                                 06526001
065270                      RC074-DISPLAY-SQLCODE                       06527001
065280                      DELIMITED BY SIZE                           06528001
065290                                      INTO RC074-CRA-RET-MSG      06529001
065300             STRING   ' RCKUT128-5230-'                           06530001
065310                      ' CALLED BY-'                               06531001
065320                      RC074-CALLING-PROGRAM                       06532001
065330                      DELIMITED BY SIZE                           06533001
065340                                      INTO RC074-ABEND-TEXT       06534001
065350             MOVE '5230-'               TO RC074-CRA-REQ-ID       06535001
065360                                           RC074-ABEND-PARAGRAPH  06536001
065370             PERFORM 9998-RETURN                                  06537001
065380                                                                  06538001
065390     END-EVALUATE.                                                06539001
065400                                                                  06540001
065410 5240-COUNT-ODD-UNITS.                                            06541001
065420     PERFORM 5150-COUNT-PACKS.                                    06542001
065430     IF PV-TOTAL-PACKS > 0                                        06543001
065440         PERFORM VARYING LINE-IDX FROM 1 BY 1                     06544001
065450              UNTIL LINE-IDX > PV-NUMBER-OF-LINES                 06545001
065460              IF PACK-LINE (LINE-IDX) = DK-LINE-NBR               06546001
065470                  COMPUTE PV-ODD-UNITS =                          06547001
065480                      PACK-VERIFY-ITM-QTY (LINE-IDX) -            06548001
065490                      (PV-TOTAL-PACKS * PACK-RATIO (LINE-IDX))    06549001
065500                  ADD PV-ODD-UNITS TO PV-CARTON-ODD-UNITS         06550001
065510              END-IF                                              06551001
065520         END-PERFORM                                              06552001
065530     ELSE                                                         06553001
065540         PERFORM VARYING LINE-IDX FROM 1 BY 1                     06554001
065550              UNTIL LINE-IDX > PV-NUMBER-OF-LINES                 06555001
065560              MOVE PACK-VERIFY-ITM-QTY (LINE-IDX) TO PV-ODD-UNITS 06556001
065570              ADD PV-ODD-UNITS TO PV-CARTON-ODD-UNITS             06557001
065580         END-PERFORM                                              06558001
065590     END-IF.                                                      06559001
065600                                                                  06560001
065610 5300-PROCESS-PACK-LNE-CSR.                                       06561001
065620     MOVE 0                           TO PV-NUMBER-OF-LINES       06562001
065630                                         PV-SHIPT-UNT-ID.         06563001
065640                                                                  06564001
065650     PERFORM 5310-OPEN-PACK-LNE-CSR.                              06565001
065660     SET LINE-IDX   TO 1.                                         06566001
065670     PERFORM 5320-FETCH-PACK-LNE-CSR                              06567001
065680              UNTIL PS-PACK-LNE-CSR-END-YES.                      06568001
065690     PERFORM 5330-CLOSE-PACK-LNE-CSR.                             06569001
065700     MOVE PV-TOTAL-ODD-UNITS    TO  RC074-ACTUAL-ODD-QTY.         06570001
065710                                                                  06571001
065720*----------------------------------------------------------------*06572001
065730 5310-OPEN-PACK-LNE-CSR.                                          06573001
065740                                                                  06574001
065750     SET  PS-PACK-LNE-CSR-END-NO  TO  TRUE.                       06575001
065760                                                                  06576001
065770     EXEC SQL                                                     06577001
065780          OPEN PACK_LNE_CSR                                       06578001
065790     END-EXEC.                                                    06579001
065800                                                                  06580001
065810     EVALUATE TRUE                                                06581001
065820         WHEN SQLCODE = ZERO                                      06582001
065830             CONTINUE                                             06583001
065840         WHEN SQLCODE = -904                                      06584001
065850         WHEN SQLCODE = -911                                      06585001
065860         WHEN SQLCODE = -913                                      06586001
065870              SET  RC074-DATABASE-BUSY                            06587001
065880                   RC074-ERROR-YES                                06588001
065890                   PS-ERROR-YES         TO  TRUE                  06589001
065900              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06590001
065910              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06591001
065920              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06592001
065930              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06593001
065940              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06594001
065950              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06595001
065960             STRING   ' RCKUT128-5310-'                           06596001
065970                      ' CALLED BY-'                               06597001
065980                      RC074-CALLING-PROGRAM                       06598001
065990                      ' PO='                                      06599001
066000                      RC074-DISPLAY-PO                            06600001
066010                      ' RCVR='                                    06601001
066020                      RC074-DISPLAY-RCVR                          06602001
066030                      ' SQLCODE='                                 06603001
066040                      RC074-DISPLAY-SQLCODE                       06604001
066050                      DELIMITED BY SIZE                           06605001
066060                                      INTO RC074-CRA-RET-MSG      06606001
066070             STRING   ' RCKUT128-5310-'                           06607001
066080                      ' CALLED BY-'                               06608001
066090                      RC074-CALLING-PROGRAM                       06609001
066100                      DELIMITED BY SIZE                           06610001
066110                                      INTO RC074-ABEND-TEXT       06611001
066120             MOVE '5310-'               TO RC074-CRA-REQ-ID       06612001
066130                                           RC074-ABEND-PARAGRAPH  06613001
066140             PERFORM 9998-RETURN                                  06614001
066150                                                                  06615001
066160         WHEN SQLWARN0 NOT = SPACES                               06616001
066170         WHEN SQLCODE < ZERO                                      06617001
066180         WHEN SQLCODE > ZERO                                      06618001
066190              SET  RC074-INVALID-SQL                              06619001
066200                   RC074-ERROR-YES                                06620001
066210                   PS-ERROR-YES         TO  TRUE                  06621001
066220              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06622001
066230              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06623001
066240              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06624001
066250              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06625001
066260              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06626001
066270              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06627001
066280             STRING   ' RCKUT128-5310-'                           06628001
066290                      ' CALLED BY-'                               06629001
066300                      RC074-CALLING-PROGRAM                       06630001
066310                      ' PO='                                      06631001
066320                      RC074-DISPLAY-PO                            06632001
066330                      ' RCVR='                                    06633001
066340                      RC074-DISPLAY-RCVR                          06634001
066350                      ' SQLCODE='                                 06635001
066360                      RC074-DISPLAY-SQLCODE                       06636001
066370                      DELIMITED BY SIZE                           06637001
066380                                      INTO RC074-CRA-RET-MSG      06638001
066390             STRING   ' RCKUT128-5310-'                           06639001
066400                      ' CALLED BY-'                               06640001
066410                      RC074-CALLING-PROGRAM                       06641001
066420                      DELIMITED BY SIZE                           06642001
066430                                      INTO RC074-ABEND-TEXT       06643001
066440             MOVE '5310-'               TO RC074-CRA-REQ-ID       06644001
066450                                           RC074-ABEND-PARAGRAPH  06645001
066460             PERFORM 9998-RETURN                                  06646001
066470                                                                  06647001
066480     END-EVALUATE.                                                06648001
066490                                                                  06649001
066500*----------------------------------------------------------------*06650001
066510 5320-FETCH-PACK-LNE-CSR.                                         06651001
066520                                                                  06652001
066530     EXEC SQL                                                     06653001
066540          FETCH PACK_LNE_CSR                                      06654001
066550           INTO :SUT00028-SHIPT-UNT-ID                            06655001
066560             ,  :SUT00028-TRN-LNE-NBR                             06656001
066570             ,  :SUT00024-ODD-UNT-IND                             06657001
066580             ,  :RECITM-PREPK-RATO-QTY                            06658001
066590             ,  :PV-SUM-SHPD-UNT-QTY                              06659001
066600     END-EXEC.                                                    06660001
066610                                                                  06661001
066620     EVALUATE TRUE                                                06662001
066630         WHEN SQLCODE = ZERO                                      06663001
066640             IF SUT00028-SHIPT-UNT-ID NOT = PV-SHIPT-UNT-ID       06664001
066650                 IF PV-SHIPT-UNT-ID = 0                           06665001
066660                     MOVE SUT00028-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID06666001
066670                 ELSE                                             06667001
066680                     MOVE PV-SHIPT-UNT-ID   TO DK-SHIPT-UNT-ID    06668001
066690                     MOVE 0     TO PV-CARTON-ODD-UNITS            06669001
066700                     PERFORM 5340-COUNT-ODD-UNITS                 06670001
066710                     ADD PV-CARTON-ODD-UNITS                      06671001
066720                                             TO PV-TOTAL-ODD-UNITS06672001
066730                     INITIALIZE PV-PACK-TABLE                     06673001
066740                     SET LINE-IDX TO 1                            06674001
066750                     MOVE 0       TO PV-NUMBER-OF-LINES           06675001
066760                     MOVE SUT00028-SHIPT-UNT-ID                   06676001
066770                                                TO PV-SHIPT-UNT-ID06677001
066780                 END-IF                                           06678001
066790             END-IF                                               06679001
066800             ADD 1            TO PV-NUMBER-OF-LINES               06680001
066810             MOVE  SUT00028-TRN-LNE-NBR                           06681001
066820                              TO PACK-LINE (LINE-IDX)             06682001
066830             MOVE  RECITM-PREPK-RATO-QTY                          06683001
066840                              TO PACK-RATIO (LINE-IDX)            06684001
066850             MOVE  PV-SUM-SHPD-UNT-QTY                            06685001
066860                              TO PACK-VERIFY-ITM-QTY (LINE-IDX)   06686001
066870             SET LINE-IDX UP BY 1                                 06687001
066880                                                                  06688001
066890         WHEN SQLCODE = +100                                      06689001
066900             IF PV-NUMBER-OF-LINES > 0                            06690001
066910                 MOVE PV-SHIPT-UNT-ID       TO DK-SHIPT-UNT-ID    06691001
066920                 MOVE 0         TO PV-CARTON-ODD-UNITS            06692001
066930                 PERFORM 5340-COUNT-ODD-UNITS                     06693001
066940                 ADD PV-CARTON-ODD-UNITS TO PV-TOTAL-ODD-UNITS    06694001
066950             END-IF                                               06695001
066960             SET  PS-PACK-LNE-CSR-END-YES     TO TRUE             06696001
066970                                                                  06697001
066980         WHEN SQLCODE = -904                                      06698001
066990         WHEN SQLCODE = -911                                      06699001
067000         WHEN SQLCODE = -913                                      06700001
067010              SET  RC074-DATABASE-BUSY                            06701001
067020                   RC074-ERROR-YES                                06702001
067030                   PS-ERROR-YES         TO  TRUE                  06703001
067040              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06704001
067050              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06705001
067060              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06706001
067070              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06707001
067080              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06708001
067090              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06709001
067100              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06710001
067110             STRING   ' RCKUT128-5320-'                           06711001
067120                      ' CALLED BY-'                               06712001
067130                      RC074-CALLING-PROGRAM                       06713001
067140                      ' PO='                                      06714001
067150                      RC074-DISPLAY-PO                            06715001
067160                      ' RCVR='                                    06716001
067170                      RC074-DISPLAY-RCVR                          06717001
067180                      ' SQLCODE='                                 06718001
067190                      RC074-DISPLAY-SQLCODE                       06719001
067200                      DELIMITED BY SIZE                           06720001
067210                                      INTO RC074-CRA-RET-MSG      06721001
067220             STRING   ' RCKUT128-5320-'                           06722001
067230                      ' CALLED BY-'                               06723001
067240                      RC074-CALLING-PROGRAM                       06724001
067250                      DELIMITED BY SIZE                           06725001
067260                                      INTO RC074-ABEND-TEXT       06726001
067270             MOVE '5320-'               TO RC074-CRA-REQ-ID       06727001
067280                                           RC074-ABEND-PARAGRAPH  06728001
067290             PERFORM 9998-RETURN                                  06729001
067300                                                                  06730001
067310         WHEN SQLWARN0 NOT = SPACE                                06731001
067320         WHEN SQLCODE NOT = ZERO                                  06732001
067330              SET  RC074-INVALID-SQL                              06733001
067340                   RC074-ERROR-YES                                06734001
067350                   PS-ERROR-YES         TO  TRUE                  06735001
067360              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06736001
067370              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06737001
067380              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06738001
067390              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06739001
067400              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06740001
067410              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06741001
067420              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06742001
067430             STRING   ' RCKUT128-5320-'                           06743001
067440                      ' CALLED BY-'                               06744001
067450                      RC074-CALLING-PROGRAM                       06745001
067460                      ' PO='                                      06746001
067470                      RC074-DISPLAY-PO                            06747001
067480                      ' RCVR='                                    06748001
067490                      RC074-DISPLAY-RCVR                          06749001
067500                      ' SQLCODE='                                 06750001
067510                      RC074-DISPLAY-SQLCODE                       06751001
067520                      DELIMITED BY SIZE                           06752001
067530                                      INTO RC074-CRA-RET-MSG      06753001
067540             STRING   ' RCKUT128-5320-'                           06754001
067550                      ' CALLED BY-'                               06755001
067560                      RC074-CALLING-PROGRAM                       06756001
067570                      DELIMITED BY SIZE                           06757001
067580                                      INTO RC074-ABEND-TEXT       06758001
067590             MOVE '5320-'               TO RC074-CRA-REQ-ID       06759001
067600                                           RC074-ABEND-PARAGRAPH  06760001
067610             PERFORM 9998-RETURN                                  06761001
067620                                                                  06762001
067630     END-EVALUATE.                                                06763001
067640                                                                  06764001
067650*----------------------------------------------------------------*06765001
067660 5330-CLOSE-PACK-LNE-CSR.                                         06766001
067670                                                                  06767001
067680     EXEC SQL                                                     06768001
067690          CLOSE PACK_LNE_CSR                                      06769001
067700     END-EXEC.                                                    06770001
067710                                                                  06771001
067720     EVALUATE TRUE                                                06772001
067730         WHEN SQLCODE = ZERO                                      06773001
067740             CONTINUE                                             06774001
067750         WHEN SQLCODE = -904                                      06775001
067760         WHEN SQLCODE = -911                                      06776001
067770         WHEN SQLCODE = -913                                      06777001
067780              SET  RC074-DATABASE-BUSY                            06778001
067790                   RC074-ERROR-YES                                06779001
067800                   PS-ERROR-YES         TO  TRUE                  06780001
067810              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06781001
067820              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06782001
067830              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06783001
067840              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06784001
067850              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06785001
067860              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06786001
067870             STRING   ' RCKUT128-5330-'                           06787001
067880                      ' CALLED BY-'                               06788001
067890                      RC074-CALLING-PROGRAM                       06789001
067900                      ' PO='                                      06790001
067910                      RC074-DISPLAY-PO                            06791001
067920                      ' RCVR='                                    06792001
067930                      RC074-DISPLAY-RCVR                          06793001
067940                      ' SQLCODE='                                 06794001
067950                      RC074-DISPLAY-SQLCODE                       06795001
067960                      DELIMITED BY SIZE                           06796001
067970                                      INTO RC074-CRA-RET-MSG      06797001
067980             STRING   ' RCKUT128-5330-'                           06798001
067990                      ' CALLED BY-'                               06799001
068000                      RC074-CALLING-PROGRAM                       06800001
068010                      DELIMITED BY SIZE                           06801001
068020                                      INTO RC074-ABEND-TEXT       06802001
068030             MOVE '5330-'               TO RC074-CRA-REQ-ID       06803001
068040                                           RC074-ABEND-PARAGRAPH  06804001
068050             PERFORM 9998-RETURN                                  06805001
068060                                                                  06806001
068070         WHEN SQLWARN0 NOT = SPACES                               06807001
068080         WHEN SQLCODE < ZERO                                      06808001
068090         WHEN SQLCODE > ZERO                                      06809001
068100              SET  RC074-INVALID-SQL                              06810001
068110                   RC074-ERROR-YES                                06811001
068120                   PS-ERROR-YES         TO  TRUE                  06812001
068130              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06813001
068140              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06814001
068150              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06815001
068160              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06816001
068170              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06817001
068180              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06818001
068190             STRING   ' RCKUT128-5330-'                           06819001
068200                      ' CALLED BY-'                               06820001
068210                      RC074-CALLING-PROGRAM                       06821001
068220                      ' PO='                                      06822001
068230                      RC074-DISPLAY-PO                            06823001
068240                      ' RCVR='                                    06824001
068250                      RC074-DISPLAY-RCVR                          06825001
068260                      ' SQLCODE='                                 06826001
068270                      RC074-DISPLAY-SQLCODE                       06827001
068280                      DELIMITED BY SIZE                           06828001
068290                                      INTO RC074-CRA-RET-MSG      06829001
068300             STRING   ' RCKUT128-5330-'                           06830001
068310                      ' CALLED BY-'                               06831001
068320                      RC074-CALLING-PROGRAM                       06832001
068330                      DELIMITED BY SIZE                           06833001
068340                                      INTO RC074-ABEND-TEXT       06834001
068350             MOVE '5330-'               TO RC074-CRA-REQ-ID       06835001
068360                                           RC074-ABEND-PARAGRAPH  06836001
068370             PERFORM 9998-RETURN                                  06837001
068380                                                                  06838001
068390     END-EVALUATE.                                                06839001
068400                                                                  06840001
068410 5340-COUNT-ODD-UNITS.                                            06841001
068420     PERFORM 5050-COUNT-PACKS.                                    06842001
068430     IF PV-TOTAL-PACKS > 0                                        06843001
068440         PERFORM VARYING LINE-IDX FROM 1 BY 1                     06844001
068450              UNTIL LINE-IDX > PV-NUMBER-OF-LINES                 06845001
068460              IF PACK-LINE (LINE-IDX) = DK-LINE-NBR               06846001
068470                  COMPUTE PV-ODD-UNITS =                          06847001
068480                      PACK-VERIFY-ITM-QTY (LINE-IDX) -            06848001
068490                      (PV-TOTAL-PACKS * PACK-RATIO (LINE-IDX))    06849001
068500                  ADD PV-ODD-UNITS TO PV-CARTON-ODD-UNITS         06850001
068510              END-IF                                              06851001
068520         END-PERFORM                                              06852001
068530     ELSE                                                         06853001
068540         PERFORM VARYING LINE-IDX FROM 1 BY 1                     06854001
068550              UNTIL LINE-IDX > PV-NUMBER-OF-LINES                 06855001
068560              MOVE PACK-VERIFY-ITM-QTY (LINE-IDX) TO PV-ODD-UNITS 06856001
068570              ADD PV-ODD-UNITS TO PV-CARTON-ODD-UNITS             06857001
068580         END-PERFORM                                              06858001
068590     END-IF.                                                      06859001
068600                                                                  06860001
068610******************************************************************06861001
068620*  COUNTS THE NUMBER OF CARTONS                                  *06862001
068630*                                                                *06863001
068640******************************************************************06864001
068650 7000-CARTON-COUNT-PROCESS.                                       06865001
068660                                                                  06866001
068670     MOVE RC074-OPER-UNT-ID    TO  DK-OPER-UNT-ID.                06867001
068680     MOVE RC074-FCLTY-ID       TO  DK-FCLTY-ID.                   06868001
068690     MOVE RC074-PO-NBR         TO  DK-PO-NBR.                     06869001
068700     MOVE RC074-RCVR-SEQ-NBR   TO  DK-RCVR-SEQ-NBR.               06870001
068710     MOVE RC074-LINE-NBR       TO  DK-LINE-NBR.                   06871001
068720     MOVE RC074-PACK-ID        TO  DK-PACK-ID.                    06872001
068730     MOVE RC074-STR-NBR        TO  DK-STR-NBR.                    06873001
068740     MOVE RC074-SHIPT-UNT-ID   TO  DK-SHIPT-UNT-ID.               06874001
068750                                                                  06875001
068760     MOVE ZEROES               TO  RC074-FCSE-ACTL-OTBND-CNT      06876001
068770                                   RC074-P2L-ACTL-OTBND-CNT       06877001
068780                                   RC074-TOTAL-ACTL-OTBND-CNT.    06878001
068790                                                                  06879001
068800     EVALUATE TRUE                                                06880001
068810         WHEN  PS-BY-PO-RCVR-LINE-STR OR                          06881001
068820               PS-BY-PO-RCVR-PACK-STR-LNE                         06882001
068830               PERFORM 8120-CNT-LNE-STR-OTB-FCSE                  06883001
068840               PERFORM 8130-CNT-LNE-STR-OTBD-P2L                  06884001
068850               ADD  RC074-FCSE-ACTL-OTBND-CNT                     06885001
068860                    RC074-P2L-ACTL-OTBND-CNT                      06886001
068870               GIVING RC074-TOTAL-ACTL-OTBND-CNT                  06887001
068880                                                                  06888001
068890         WHEN  PS-BY-PO-RCVR-LINE OR                              06889001
068900               PS-BY-PO-RCVR-PACK-LNE                             06890001
068910               PERFORM 8100-CNT-LNE-OTBND-FCSE                    06891001
068920               PERFORM 8110-CNT-LNE-OTBND-P2L                     06892001
068930               ADD  RC074-FCSE-ACTL-OTBND-CNT                     06893001
068940                    RC074-P2L-ACTL-OTBND-CNT                      06894001
068950               GIVING RC074-TOTAL-ACTL-OTBND-CNT                  06895001
068960                                                                  06896001
068970         WHEN  PS-BY-PO-RCVR                                      06897001
068980               PERFORM 8140-CNT-RCVR-OTBND-FCSE                   06898001
068990               PERFORM 8150-CNT-RCVR-OTBND-P2L                    06899001
069000               ADD  RC074-FCSE-ACTL-OTBND-CNT                     06900001
069010                    RC074-P2L-ACTL-OTBND-CNT                      06901001
069020               GIVING RC074-TOTAL-ACTL-OTBND-CNT                  06902001
069030                                                                  06903001
069040         WHEN  PS-BY-PO-RCVR-PACK                                 06904001
069050               PERFORM 8160-CNT-LNE-OTBND-FCSE                    06905001
069060               PERFORM 8170-CNT-LNE-OTBND-P2L                     06906001
069070               ADD  RC074-FCSE-ACTL-OTBND-CNT                     06907001
069080                    RC074-P2L-ACTL-OTBND-CNT                      06908001
069090               GIVING RC074-TOTAL-ACTL-OTBND-CNT                  06909001
069100                                                                  06910001
069110         WHEN  PS-BY-PO-RCVR-PACK-STR                             06911001
069120               PERFORM 8180-CNT-LNE-OTBND-FCSE                    06912001
069130               PERFORM 8190-CNT-LNE-OTBND-P2L                     06913001
069140               ADD  RC074-FCSE-ACTL-OTBND-CNT                     06914001
069150                    RC074-P2L-ACTL-OTBND-CNT                      06915001
069160               GIVING RC074-TOTAL-ACTL-OTBND-CNT                  06916001
069170                                                                  06917001
069180                                                                  06918001
069190     END-EVALUATE.                                                06919001
069200                                                                  06920001
069210 7060-GET-TDISTDT.                                                06921001
069220                                                                  06922001
069230     EXEC SQL                                                     06923001
069240          SELECT                                                  06924001
069250                  ACTL_ALLOC_QTY                                  06925001
069260                , P2L_SPLT_UNT_QTY                                06926001
069270                , FCSE_SPLT_UNT_QTY                               06927001
069280                , INPK_SPLT_UNT_QTY                               06928001
069290                , FCSE_ACTL_UNT_QTY                               06929001
069300            INTO                                                  06930001
069310                  :DISTDT-ACTL-ALLOC-QTY                          06931001
069320                , :DISTDT-P2L-SPLT-UNT-QTY                        06932001
069330                , :DISTDT-FCSE-SPLT-UNT-QTY                       06933001
069340                , :DISTDT-INPK-SPLT-UNT-QTY                       06934001
069350                , :DISTDT-FCSE-ACTL-UNT-QTY                       06935001
069360            FROM                                                  06936001
069370                  TDISTDT                                         06937001
069380            WHERE                                                 06938001
069390                  ORD_NBR          = :DK-PO-NBR                   06939001
069400              AND RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR             06940001
069410              AND ORD_LNE_NBR      = :DK-PO-DRIVER-LNE            06941001
069420              AND STR_NBR          = :DK-STR-NBR                  06942001
069430     END-EXEC.                                                    06943001
069440                                                                  06944001
069450     EVALUATE TRUE                                                06945001
069460         WHEN SQLCODE = ZERO                                      06946001
069470         WHEN SQLCODE = +100                                      06947001
069480              CONTINUE                                            06948001
069490         WHEN SQLCODE = -904                                      06949001
069500         WHEN SQLCODE = -911                                      06950001
069510         WHEN SQLCODE = -913                                      06951001
069520              SET  RC074-DATABASE-BUSY                            06952001
069530                   RC074-ERROR-YES                                06953001
069540                   PS-ERROR-YES         TO  TRUE                  06954001
069550              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06955001
069560              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06956001
069570              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06957001
069580              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    06958001
069590              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06959001
069600              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     06960001
069610              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06961001
069620             STRING   ' RCKUT128-7060-'                           06962001
069630                      ' CALLED BY-'                               06963001
069640                      RC074-CALLING-PROGRAM                       06964001
069650                      ' PO='                                      06965001
069660                      RC074-DISPLAY-PO                            06966001
069670                      ' RCVR='                                    06967001
069680                      RC074-DISPLAY-RCVR                          06968001
069690                      ' SQLCODE='                                 06969001
069700                      RC074-DISPLAY-SQLCODE                       06970001
069710                      DELIMITED BY SIZE                           06971001
069720                                      INTO RC074-CRA-RET-MSG      06972001
069730             STRING   ' RCKUT128-7060-'                           06973001
069740                      ' CALLED BY-'                               06974001
069750                      RC074-CALLING-PROGRAM                       06975001
069760                      DELIMITED BY SIZE                           06976001
069770                                      INTO RC074-ABEND-TEXT       06977001
069780             MOVE '7060-'               TO RC074-CRA-REQ-ID       06978001
069790                                           RC074-ABEND-PARAGRAPH  06979001
069800             PERFORM 9998-RETURN                                  06980001
069810                                                                  06981001
069820         WHEN SQLWARN0 NOT = SPACE                                06982001
069830         WHEN SQLCODE NOT = ZERO                                  06983001
069840              SET  RC074-INVALID-SQL                              06984001
069850                   RC074-ERROR-YES                                06985001
069860                   PS-ERROR-YES         TO  TRUE                  06986001
069870              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 06987001
069880              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      06988001
069890              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    06989001
069900              MOVE DK-PO-DRIVER-LNE     TO  RC074-DISPLAY-LINE    06990001
069910              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    06991001
069920              MOVE DK-STR-NBR           TO  RC074-DISPLAY-STR     06992001
069930              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    06993001
069940             STRING   ' RCKUT128-7060-'                           06994001
069950                      ' CALLED BY-'                               06995001
069960                      RC074-CALLING-PROGRAM                       06996001
069970                      ' PO='                                      06997001
069980                      RC074-DISPLAY-PO                            06998001
069990                      ' RCVR='                                    06999001
070000                      RC074-DISPLAY-RCVR                          07000001
070010                      ' SQLCODE='                                 07001001
070020                      RC074-DISPLAY-SQLCODE                       07002001
070030                      DELIMITED BY SIZE                           07003001
070040                                      INTO RC074-CRA-RET-MSG      07004001
070050             STRING   ' RCKUT128-7060-'                           07005001
070060                      ' CALLED BY-'                               07006001
070070                      RC074-CALLING-PROGRAM                       07007001
070080                      DELIMITED BY SIZE                           07008001
070090                                      INTO RC074-ABEND-TEXT       07009001
070100             MOVE '7060-'               TO RC074-CRA-REQ-ID       07010001
070110                                           RC074-ABEND-PARAGRAPH  07011001
070120             PERFORM 9998-RETURN                                  07012001
070130     END-EVALUATE.                                                07013001
070140                                                                  07014001
070150 7070-GET-TDISTDT.                                                07015001
070160                                                                  07016001
070170     EXEC SQL                                                     07017001
070180          SELECT                                                  07018001
070190                  SUM(ACTL_ALLOC_QTY)                             07019001
070200                , SUM(P2L_SPLT_UNT_QTY)                           07020001
070210                , SUM(FCSE_SPLT_UNT_QTY)                          07021001
070220                , SUM(INPK_SPLT_UNT_QTY)                          07022001
070230                , SUM(FCSE_ACTL_UNT_QTY)                          07023001
070240            INTO                                                  07024001
070250                  :DISTDT-ACTL-ALLOC-QTY                          07025001
070260                , :DISTDT-P2L-SPLT-UNT-QTY                        07026001
070270                , :DISTDT-FCSE-SPLT-UNT-QTY                       07027001
070280                , :DISTDT-INPK-SPLT-UNT-QTY                       07028001
070290                , :DISTDT-FCSE-ACTL-UNT-QTY                       07029001
070300            FROM                                                  07030001
070310                  TDISTDT                                         07031001
070320            WHERE                                                 07032001
070330                  ORD_NBR          = :DK-PO-NBR                   07033001
070340              AND RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR             07034001
070350              AND ORD_LNE_NBR      = :DK-PO-DRIVER-LNE            07035001
070360     END-EXEC.                                                    07036001
070370                                                                  07037001
070380     EVALUATE TRUE                                                07038001
070390         WHEN SQLCODE = ZERO                                      07039001
070400         WHEN SQLCODE = +100                                      07040001
070410              CONTINUE                                            07041001
070420         WHEN SQLCODE = -904                                      07042001
070430         WHEN SQLCODE = -911                                      07043001
070440         WHEN SQLCODE = -913                                      07044001
070450              SET  RC074-DATABASE-BUSY                            07045001
070460                   RC074-ERROR-YES                                07046001
070470                   PS-ERROR-YES         TO  TRUE                  07047001
070480              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07048001
070490              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      07049001
070500              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    07050001
070510              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07051001
070520              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07052001
070530              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07053001
070540             STRING   ' RCKUT128-7070-'                           07054001
070550                      ' CALLED BY-'                               07055001
070560                      RC074-CALLING-PROGRAM                       07056001
070570                      ' PO='                                      07057001
070580                      RC074-DISPLAY-PO                            07058001
070590                      ' RCVR='                                    07059001
070600                      RC074-DISPLAY-RCVR                          07060001
070610                      ' SQLCODE='                                 07061001
070620                      RC074-DISPLAY-SQLCODE                       07062001
070630                      DELIMITED BY SIZE                           07063001
070640                                      INTO RC074-CRA-RET-MSG      07064001
070650             STRING   ' RCKUT128-7070-'                           07065001
070660                      ' CALLED BY-'                               07066001
070670                      RC074-CALLING-PROGRAM                       07067001
070680                      DELIMITED BY SIZE                           07068001
070690                                      INTO RC074-ABEND-TEXT       07069001
070700             MOVE '7070-'               TO RC074-CRA-REQ-ID       07070001
070710                                           RC074-ABEND-PARAGRAPH  07071001
070720             PERFORM 9998-RETURN                                  07072001
070730                                                                  07073001
070740         WHEN SQLWARN0 NOT = SPACE                                07074001
070750         WHEN SQLCODE NOT = ZERO                                  07075001
070760              SET  RC074-INVALID-SQL                              07076001
070770                   RC074-ERROR-YES                                07077001
070780                   PS-ERROR-YES         TO  TRUE                  07078001
070790              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07079001
070800              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      07080001
070810              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    07081001
070820              MOVE DK-PO-DRIVER-LNE     TO  RC074-DISPLAY-LINE    07082001
070830              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07083001
070840              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07084001
070850             STRING   ' RCKUT128-7070-'                           07085001
070860                      ' CALLED BY-'                               07086001
070870                      RC074-CALLING-PROGRAM                       07087001
070880                      ' PO='                                      07088001
070890                      RC074-DISPLAY-PO                            07089001
070900                      ' RCVR='                                    07090001
070910                      RC074-DISPLAY-RCVR                          07091001
070920                      ' SQLCODE='                                 07092001
070930                      RC074-DISPLAY-SQLCODE                       07093001
070940                      DELIMITED BY SIZE                           07094001
070950                                      INTO RC074-CRA-RET-MSG      07095001
070960             STRING   ' RCKUT128-7070-'                           07096001
070970                      ' CALLED BY-'                               07097001
070980                      RC074-CALLING-PROGRAM                       07098001
070990                      DELIMITED BY SIZE                           07099001
071000                                      INTO RC074-ABEND-TEXT       07100001
071010             MOVE '7070-'               TO RC074-CRA-REQ-ID       07101001
071020                                           RC074-ABEND-PARAGRAPH  07102001
071030             PERFORM 9998-RETURN                                  07103001
071040     END-EVALUATE.                                                07104001
071050                                                                  07105001
071060                                                                  07106001
071070******************************************************************07107001
071080*                                                                *07108001
071090*  VERIFIED RECEIVER - THIS SQL WILL BRING BACK THE QUANTITIES   *07109001
071100*  FOR A VERIFIED RECEIVER.                                      *07110001
071110*                                                                *07111001
071120*  VERIFIED - PO-RCVR                                            *07112001
071130*      PACKSLIP QUANTITY                                         *07113001
071140*      ACTUAL QUANTITY                                           *07114001
071150*      VERIFIED QUANTITY                                         *07115001
071160*                                                                *07116001
071170******************************************************************07117001
071180 8000-VERIFIED-RCVR-QTY.                                          07118001
071190                                                                  07119001
071200     MOVE ZERO                 TO  RC074-VERIFY-ITM-QTY           07120001
071210                                   RC074-FCSE-ACTL-ITM-QTY        07121001
071220                                   RC074-TOTAL-ACTL-ITM-QTY.      07122001
071230                                                                  07123001
071240     EXEC SQL                                                     07124001
071250          SELECT                                                  07125001
071260                 SUM(AP_VERIFY_ITM_QTY)                           07126001
071270                ,SUM(VERIFY_ITM_QTY)                              07127001
071280          INTO                                                    07128001
071290                :RC074-VERIFY-ITM-QTY    :RC074-NULL-IND          07129001
071300               ,:RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          07130001
071310          FROM                                                    07131001
071320                 TRECDIS                                          07132001
071330          WHERE                                                   07133001
071340                ORD_NBR          =  :RC074-PO-NBR                 07134001
071350           AND  REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR           07135001
071370     END-EXEC.                                                    07137001
071380                                                                  07138001
071390     EVALUATE TRUE                                                07139001
071400         WHEN SQLCODE = ZERO                                      07140001
071410              MOVE RC074-FCSE-ACTL-ITM-QTY                        07141001
071420                TO RC074-TOTAL-ACTL-ITM-QTY                       07142001
071430                                                                  07143001
071440         WHEN SQLCODE = +100                                      07144001
071450         WHEN SQLCODE = -305                                      07145001
071460              CONTINUE                                            07146001
071470         WHEN SQLCODE = -904                                      07147001
071480         WHEN SQLCODE = -911                                      07148001
071490         WHEN SQLCODE = -913                                      07149001
071500              SET  RC074-DATABASE-BUSY                            07150001
071510                   RC074-ERROR-YES                                07151001
071520                   PS-ERROR-YES         TO  TRUE                  07152001
071530              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07153001
071540              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07154001
071550              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07155001
071560              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07156001
071570              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07157001
071580              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07158001
071590              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07159001
071600             STRING   ' RCKUT128-8000-'                           07160001
071610                      ' CALLED BY-'                               07161001
071620                      RC074-CALLING-PROGRAM                       07162001
071630                      ' PO='                                      07163001
071640                      RC074-DISPLAY-PO                            07164001
071650                      ' RCVR='                                    07165001
071660                      RC074-DISPLAY-RCVR                          07166001
071670                      ' SQLCODE='                                 07167001
071680                      RC074-DISPLAY-SQLCODE                       07168001
071690                      DELIMITED BY SIZE                           07169001
071700                                      INTO RC074-CRA-RET-MSG      07170001
071710             STRING   ' RCKUT128-8000-'                           07171001
071720                      ' CALLED BY-'                               07172001
071730                      RC074-CALLING-PROGRAM                       07173001
071740                      DELIMITED BY SIZE                           07174001
071750                                      INTO RC074-ABEND-TEXT       07175001
071760             MOVE '8000-'               TO RC074-CRA-REQ-ID       07176001
071770                                           RC074-ABEND-PARAGRAPH  07177001
071780             PERFORM 9998-RETURN                                  07178001
071790                                                                  07179001
071800         WHEN SQLWARN0 NOT = SPACE                                07180001
071810         WHEN SQLCODE NOT = ZERO                                  07181001
071820              SET  RC074-INVALID-SQL                              07182001
071830                   RC074-ERROR-YES                                07183001
071840                   PS-ERROR-YES         TO  TRUE                  07184001
071850              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07185001
071860              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07186001
071870              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07187001
071880              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07188001
071890              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07189001
071900              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07190001
071910              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07191001
071920             STRING   ' RCKUT128-8000-'                           07192001
071930                      ' CALLED BY-'                               07193001
071940                      RC074-CALLING-PROGRAM                       07194001
071950                      ' PO='                                      07195001
071960                      RC074-DISPLAY-PO                            07196001
071970                      ' RCVR='                                    07197001
071980                      RC074-DISPLAY-RCVR                          07198001
071990                      ' SQLCODE='                                 07199001
072000                      RC074-DISPLAY-SQLCODE                       07200001
072010                      DELIMITED BY SIZE                           07201001
072020                                      INTO RC074-CRA-RET-MSG      07202001
072030             STRING   ' RCKUT128-8000-'                           07203001
072040                      ' CALLED BY-'                               07204001
072050                      RC074-CALLING-PROGRAM                       07205001
072060                      DELIMITED BY SIZE                           07206001
072070                                      INTO RC074-ABEND-TEXT       07207001
072080             MOVE '8000-'               TO RC074-CRA-REQ-ID       07208001
072090                                           RC074-ABEND-PARAGRAPH  07209001
072100             PERFORM 9998-RETURN                                  07210001
072110     END-EVALUATE.                                                07211001
072120                                                                  07212001
072130 8005-VERIFIED-RCVR-QTY.                                          07213001
072140                                                                  07214001
072150     MOVE ZERO                 TO  RC074-INVCED-ITM-QTY.          07215004
072160                                                                  07216001
072170     EXEC SQL                                                     07217001
072180          SELECT SUM(A.EXPTED_ITM_QTY)                            07218001
072190          INTO  :RC074-INVCED-ITM-QTY    :RC074-NULL-IND          07219004
072200          FROM                                                    07220001
072210                 TRECDIS  A                                       07221001
072220          WHERE                                                   07222001
072230                A.ORD_NBR          =  :RC074-PO-NBR               07223001
072240           AND  A.REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR         07224001
072260           AND NOT EXISTS                                         07226001
072270               (SELECT *                                          07227001
072280                FROM RCT_RECDIS_ORIG B                            07228001
072290         WHERE  A.ORD_NBR          = B.ORD_NBR                    07229001
072300           AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR                07230001
072310           AND  A.ORD_LNE_NBR      = B.ORD_LNE_NBR                07231001
072320           AND  A.STR_NBR          = B.STR_NBR)                   07232001
072330     END-EXEC.                                                    07233001
072340                                                                  07234001
072350     EVALUATE TRUE                                                07235001
072360         WHEN SQLCODE = ZERO                                      07236001
072370              CONTINUE                                            07237001
072380                                                                  07238001
072390         WHEN SQLCODE = +100                                      07239001
072400         WHEN SQLCODE = -305                                      07240001
072410              CONTINUE                                            07241001
072420         WHEN SQLCODE = -904                                      07242001
072430         WHEN SQLCODE = -911                                      07243001
072440         WHEN SQLCODE = -913                                      07244001
072450              SET  RC074-DATABASE-BUSY                            07245001
072460                   RC074-ERROR-YES                                07246001
072470                   PS-ERROR-YES         TO  TRUE                  07247001
072480              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07248001
072490              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07249001
072500              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07250001
072510              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07251001
072520              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07252001
072530              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07253001
072540              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07254001
072550             STRING   ' RCKUT128-8005-'                           07255001
072560                      ' CALLED BY-'                               07256001
072570                      RC074-CALLING-PROGRAM                       07257001
072580                      ' PO='                                      07258001
072590                      RC074-DISPLAY-PO                            07259001
072600                      ' RCVR='                                    07260001
072610                      RC074-DISPLAY-RCVR                          07261001
072620                      ' SQLCODE='                                 07262001
072630                      RC074-DISPLAY-SQLCODE                       07263001
072640                      DELIMITED BY SIZE                           07264001
072650                                      INTO RC074-CRA-RET-MSG      07265001
072660             STRING   ' RCKUT128-8005-'                           07266001
072670                      ' CALLED BY-'                               07267001
072680                      RC074-CALLING-PROGRAM                       07268001
072690                      DELIMITED BY SIZE                           07269001
072700                                      INTO RC074-ABEND-TEXT       07270001
072710             MOVE '8005-'               TO RC074-CRA-REQ-ID       07271001
072720                                           RC074-ABEND-PARAGRAPH  07272001
072730             PERFORM 9998-RETURN                                  07273001
072740                                                                  07274001
072750         WHEN SQLWARN0 NOT = SPACE                                07275001
072760         WHEN SQLCODE NOT = ZERO                                  07276001
072770              SET  RC074-INVALID-SQL                              07277001
072780                   RC074-ERROR-YES                                07278001
072790                   PS-ERROR-YES         TO  TRUE                  07279001
072800              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07280001
072810              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07281001
072820              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07282001
072830              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07283001
072840              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07284001
072850              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07285001
072860              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07286001
072870             STRING   ' RCKUT128-8005-'                           07287001
072880                      ' CALLED BY-'                               07288001
072890                      RC074-CALLING-PROGRAM                       07289001
072900                      ' PO='                                      07290001
072910                      RC074-DISPLAY-PO                            07291001
072920                      ' RCVR='                                    07292001
072930                      RC074-DISPLAY-RCVR                          07293001
072940                      ' SQLCODE='                                 07294001
072950                      RC074-DISPLAY-SQLCODE                       07295001
072960                      DELIMITED BY SIZE                           07296001
072970                                      INTO RC074-CRA-RET-MSG      07297001
072980             STRING   ' RCKUT128-8005-'                           07298001
072990                      ' CALLED BY-'                               07299001
073000                      RC074-CALLING-PROGRAM                       07300001
073010                      DELIMITED BY SIZE                           07301001
073020                                      INTO RC074-ABEND-TEXT       07302001
073030             MOVE '8005-'               TO RC074-CRA-REQ-ID       07303001
073040                                           RC074-ABEND-PARAGRAPH  07304001
073050             PERFORM 9998-RETURN                                  07305001
073060     END-EVALUATE.                                                07306001
073070                                                                  07307001
073080 8008-VERIFIED-RCVR-QTY-ORIG.                                     07308001
073090                                                                  07309001
073100     MOVE ZERO                 TO  PV-ORIG-EXPTED-ITM-QTY.        07310001
073110                                                                  07311001
073120     EXEC SQL                                                     07312001
073130          SELECT SUM(A.ORIG_EXPTED_QTY)                           07313001
073140          INTO  :PV-ORIG-EXPTED-ITM-QTY  :RC074-NULL-IND          07314001
073150          FROM                                                    07315001
073160                 RCT_RECDIS_ORIG A                                07316001
073170          WHERE                                                   07317001
073180                A.ORD_NBR          =  :RC074-PO-NBR               07318001
073190           AND  A.REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR         07319001
073200     END-EXEC.                                                    07320001
073210                                                                  07321001
073220     EVALUATE TRUE                                                07322001
073230         WHEN SQLCODE = ZERO                                      07323001
073240              CONTINUE                                            07324001
073250                                                                  07325001
073260         WHEN SQLCODE = +100                                      07326001
073270         WHEN SQLCODE = -305                                      07327001
073280              CONTINUE                                            07328001
073290         WHEN SQLCODE = -904                                      07329001
073300         WHEN SQLCODE = -911                                      07330001
073310         WHEN SQLCODE = -913                                      07331001
073320              SET  RC074-DATABASE-BUSY                            07332001
073330                   RC074-ERROR-YES                                07333001
073340                   PS-ERROR-YES         TO  TRUE                  07334001
073350              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07335001
073360              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07336001
073370              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07337001
073380              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07338001
073390              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07339001
073400              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07340001
073410              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07341001
073420             STRING   ' RCKUT128-8008-'                           07342001
073430                      ' CALLED BY-'                               07343001
073440                      RC074-CALLING-PROGRAM                       07344001
073450                      ' PO='                                      07345001
073460                      RC074-DISPLAY-PO                            07346001
073470                      ' RCVR='                                    07347001
073480                      RC074-DISPLAY-RCVR                          07348001
073490                      ' SQLCODE='                                 07349001
073500                      RC074-DISPLAY-SQLCODE                       07350001
073510                      DELIMITED BY SIZE                           07351001
073520                                      INTO RC074-CRA-RET-MSG      07352001
073530             STRING   ' RCKUT128-8008-'                           07353001
073540                      ' CALLED BY-'                               07354001
073550                      RC074-CALLING-PROGRAM                       07355001
073560                      DELIMITED BY SIZE                           07356001
073570                                      INTO RC074-ABEND-TEXT       07357001
073580             MOVE '8008-'               TO RC074-CRA-REQ-ID       07358001
073590                                           RC074-ABEND-PARAGRAPH  07359001
073600             PERFORM 9998-RETURN                                  07360001
073610                                                                  07361001
073620         WHEN SQLWARN0 NOT = SPACE                                07362001
073630         WHEN SQLCODE NOT = ZERO                                  07363001
073640              SET  RC074-INVALID-SQL                              07364001
073650                   RC074-ERROR-YES                                07365001
073660                   PS-ERROR-YES         TO  TRUE                  07366001
073670              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07367001
073680              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07368001
073690              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07369001
073700              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07370001
073710              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07371001
073720              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07372001
073730              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07373001
073740             STRING   ' RCKUT128-8008-'                           07374001
073750                      ' CALLED BY-'                               07375001
073760                      RC074-CALLING-PROGRAM                       07376001
073770                      ' PO='                                      07377001
073780                      RC074-DISPLAY-PO                            07378001
073790                      ' RCVR='                                    07379001
073800                      RC074-DISPLAY-RCVR                          07380001
073810                      ' SQLCODE='                                 07381001
073820                      RC074-DISPLAY-SQLCODE                       07382001
073830                      DELIMITED BY SIZE                           07383001
073840                                      INTO RC074-CRA-RET-MSG      07384001
073850             STRING   ' RCKUT128-8008-'                           07385001
073860                      ' CALLED BY-'                               07386001
073870                      RC074-CALLING-PROGRAM                       07387001
073880                      DELIMITED BY SIZE                           07388001
073890                                      INTO RC074-ABEND-TEXT       07389001
073900             MOVE '8008-'               TO RC074-CRA-REQ-ID       07390001
073910                                           RC074-ABEND-PARAGRAPH  07391001
073920             PERFORM 9998-RETURN                                  07392001
073930     END-EVALUATE.                                                07393001
073940                                                                  07394001
073950******************************************************************07395001
073960*                                                                *07396001
073970*  VERIFIED LINE - THIS SQL WILL BRING BACK THE QUANTITIES FOR A *07397001
073980*  VERIFIED LINE.                                                *07398001
073990*                                                                *07399001
074000*  VERIFIED LINE - PO-RCVR-LINE                                  *07400001
074010*      PACKSLIP QUANTITY                                         *07401001
074020*      ACTUAL QUANTITY                                           *07402001
074030*      VERIFIED QUANTITY                                         *07403001
074040*                                                                *07404001
074050******************************************************************07405001
074060 8010-VERIFIED-LINE-QTY.                                          07406001
074070                                                                  07407001
074080     MOVE ZERO                 TO  RC074-VERIFY-ITM-QTY           07408001
074090                                   RC074-FCSE-ACTL-ITM-QTY        07409001
074100                                   RC074-TOTAL-ACTL-ITM-QTY.      07410001
074110                                                                  07411001
074120     EXEC SQL                                                     07412001
074130          SELECT                                                  07413001
074140                 SUM(AP_VERIFY_ITM_QTY)                           07414001
074150                ,SUM(VERIFY_ITM_QTY)                              07415001
074160          INTO                                                    07416001
074170                :RC074-VERIFY-ITM-QTY    :RC074-NULL-IND          07417001
074180               ,:RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          07418001
074190          FROM                                                    07419001
074200                 TRECDIS                                          07420001
074210          WHERE                                                   07421001
074220                ORD_NBR            =  :DK-PO-NBR                  07422001
074230           AND  REC_SEQ_NBR        =  :DK-RCVR-SEQ-NBR            07423001
074240           AND  ORD_LNE_NBR        =  :DK-LINE-NBR                07424001
074260     END-EXEC.                                                    07426001
074270                                                                  07427001
074280     EVALUATE TRUE                                                07428001
074290         WHEN SQLCODE = ZERO                                      07429001
074300              MOVE  RC074-FCSE-ACTL-ITM-QTY                       07430001
074310                TO  RC074-TOTAL-ACTL-ITM-QTY                      07431001
074320                                                                  07432001
074330         WHEN SQLCODE = +100                                      07433001
074340         WHEN SQLCODE = -305                                      07434001
074350              CONTINUE                                            07435001
074360         WHEN SQLCODE = -904                                      07436001
074370         WHEN SQLCODE = -911                                      07437001
074380         WHEN SQLCODE = -913                                      07438001
074390              SET  RC074-DATABASE-BUSY                            07439001
074400                   RC074-ERROR-YES                                07440001
074410                   PS-ERROR-YES         TO  TRUE                  07441001
074420              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07442001
074430              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      07443001
074440              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    07444001
074450              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    07445001
074460              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07446001
074470              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07447001
074480              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07448001
074490             STRING   ' RCKUT128-8010-'                           07449001
074500                      ' CALLED BY-'                               07450001
074510                      RC074-CALLING-PROGRAM                       07451001
074520                      ' PO='                                      07452001
074530                      RC074-DISPLAY-PO                            07453001
074540                      ' RCVR='                                    07454001
074550                      RC074-DISPLAY-RCVR                          07455001
074560                      ' LINE='                                    07456001
074570                      RC074-DISPLAY-LINE                          07457001
074580                      ' SQLCODE='                                 07458001
074590                      RC074-DISPLAY-SQLCODE                       07459001
074600                      DELIMITED BY SIZE                           07460001
074610                                      INTO RC074-CRA-RET-MSG      07461001
074620             STRING   ' RCKUT128-8010-'                           07462001
074630                      ' CALLED BY-'                               07463001
074640                      RC074-CALLING-PROGRAM                       07464001
074650                      DELIMITED BY SIZE                           07465001
074660                                      INTO RC074-ABEND-TEXT       07466001
074670             MOVE '8010-'               TO RC074-CRA-REQ-ID       07467001
074680                                           RC074-ABEND-PARAGRAPH  07468001
074690             PERFORM 9998-RETURN                                  07469001
074700                                                                  07470001
074710         WHEN SQLWARN0 NOT = SPACE                                07471001
074720         WHEN SQLCODE NOT = ZERO                                  07472001
074730              SET  RC074-INVALID-SQL                              07473001
074740                   RC074-ERROR-YES                                07474001
074750                   PS-ERROR-YES         TO  TRUE                  07475001
074760              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07476001
074770              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      07477001
074780              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    07478001
074790              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    07479001
074800              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07480001
074810              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07481001
074820              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07482001
074830             STRING   ' RCKUT128-8010-'                           07483001
074840                      ' CALLED BY-'                               07484001
074850                      RC074-CALLING-PROGRAM                       07485001
074860                      ' PO='                                      07486001
074870                      RC074-DISPLAY-PO                            07487001
074880                      ' RCVR='                                    07488001
074890                      RC074-DISPLAY-RCVR                          07489001
074900                      ' LINE='                                    07490001
074910                      RC074-DISPLAY-LINE                          07491001
074920                      ' SQLCODE='                                 07492001
074930                      RC074-DISPLAY-SQLCODE                       07493001
074940                      DELIMITED BY SIZE                           07494001
074950                                      INTO RC074-CRA-RET-MSG      07495001
074960             STRING   ' RCKUT128-8010-'                           07496001
074970                      ' CALLED BY-'                               07497001
074980                      RC074-CALLING-PROGRAM                       07498001
074990                      DELIMITED BY SIZE                           07499001
075000                                      INTO RC074-ABEND-TEXT       07500001
075010             MOVE '8010-'               TO RC074-CRA-REQ-ID       07501001
075020                                           RC074-ABEND-PARAGRAPH  07502001
075030             PERFORM 9998-RETURN                                  07503001
075040                                                                  07504001
075050     END-EVALUATE.                                                07505001
075060                                                                  07506001
075070 8012-VERIFIED-LINE-QTY.                                          07507001
075080                                                                  07508001
075090     MOVE ZERO                 TO  RC074-INVCED-ITM-QTY.          07509004
075100                                                                  07510001
075110     EXEC SQL                                                     07511001
075120          SELECT SUM(EXPTED_ITM_QTY)                              07512001
075130          INTO  :RC074-INVCED-ITM-QTY    :RC074-NULL-IND          07513004
075140          FROM                                                    07514001
075150                 TRECDIS A                                        07515001
075160          WHERE                                                   07516001
075170                A.ORD_NBR          =  :DK-PO-NBR                  07517001
075180           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            07518001
075190           AND  A.ORD_LNE_NBR      =  :DK-LINE-NBR                07519001
075210           AND NOT EXISTS                                         07521001
075220               (SELECT *                                          07522001
075230                FROM RCT_RECDIS_ORIG B                            07523001
075240         WHERE  A.ORD_NBR          = B.ORD_NBR                    07524001
075250           AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR                07525001
075260           AND  A.ORD_LNE_NBR      = B.ORD_LNE_NBR                07526001
075270           AND  A.STR_NBR          = B.STR_NBR)                   07527001
075280     END-EXEC.                                                    07528001
075290                                                                  07529001
075300     EVALUATE TRUE                                                07530001
075310         WHEN SQLCODE = ZERO                                      07531001
075320              CONTINUE                                            07532001
075330                                                                  07533001
075340         WHEN SQLCODE = +100                                      07534001
075350         WHEN SQLCODE = -305                                      07535001
075360              CONTINUE                                            07536001
075370         WHEN SQLCODE = -904                                      07537001
075380         WHEN SQLCODE = -911                                      07538001
075390         WHEN SQLCODE = -913                                      07539001
075400              SET  RC074-DATABASE-BUSY                            07540001
075410                   RC074-ERROR-YES                                07541001
075420                   PS-ERROR-YES         TO  TRUE                  07542001
075430              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07543001
075440              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      07544001
075450              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    07545001
075460              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    07546001
075470              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07547001
075480              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07548001
075490              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07549001
075500             STRING   ' RCKUT128-8012-'                           07550001
075510                      ' CALLED BY-'                               07551001
075520                      RC074-CALLING-PROGRAM                       07552001
075530                      ' PO='                                      07553001
075540                      RC074-DISPLAY-PO                            07554001
075550                      ' RCVR='                                    07555001
075560                      RC074-DISPLAY-RCVR                          07556001
075570                      ' LINE='                                    07557001
075580                      RC074-DISPLAY-LINE                          07558001
075590                      ' SQLCODE='                                 07559001
075600                      RC074-DISPLAY-SQLCODE                       07560001
075610                      DELIMITED BY SIZE                           07561001
075620                                      INTO RC074-CRA-RET-MSG      07562001
075630             STRING   ' RCKUT128-8012-'                           07563001
075640                      ' CALLED BY-'                               07564001
075650                      RC074-CALLING-PROGRAM                       07565001
075660                      DELIMITED BY SIZE                           07566001
075670                                      INTO RC074-ABEND-TEXT       07567001
075680             MOVE '8012-'               TO RC074-CRA-REQ-ID       07568001
075690                                           RC074-ABEND-PARAGRAPH  07569001
075700             PERFORM 9998-RETURN                                  07570001
075710                                                                  07571001
075720         WHEN SQLWARN0 NOT = SPACE                                07572001
075730         WHEN SQLCODE NOT = ZERO                                  07573001
075740              SET  RC074-INVALID-SQL                              07574001
075750                   RC074-ERROR-YES                                07575001
075760                   PS-ERROR-YES         TO  TRUE                  07576001
075770              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07577001
075780              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      07578001
075790              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    07579001
075800              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    07580001
075810              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07581001
075820              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07582001
075830              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07583001
075840             STRING   ' RCKUT128-8012-'                           07584001
075850                      ' CALLED BY-'                               07585001
075860                      RC074-CALLING-PROGRAM                       07586001
075870                      ' PO='                                      07587001
075880                      RC074-DISPLAY-PO                            07588001
075890                      ' RCVR='                                    07589001
075900                      RC074-DISPLAY-RCVR                          07590001
075910                      ' LINE='                                    07591001
075920                      RC074-DISPLAY-LINE                          07592001
075930                      ' SQLCODE='                                 07593001
075940                      RC074-DISPLAY-SQLCODE                       07594001
075950                      DELIMITED BY SIZE                           07595001
075960                                      INTO RC074-CRA-RET-MSG      07596001
075970             STRING   ' RCKUT128-8012-'                           07597001
075980                      ' CALLED BY-'                               07598001
075990                      RC074-CALLING-PROGRAM                       07599001
076000                      DELIMITED BY SIZE                           07600001
076010                                      INTO RC074-ABEND-TEXT       07601001
076020             MOVE '8012-'               TO RC074-CRA-REQ-ID       07602001
076030                                           RC074-ABEND-PARAGRAPH  07603001
076040             PERFORM 9998-RETURN                                  07604001
076050                                                                  07605001
076060     END-EVALUATE.                                                07606001
076070                                                                  07607001
076080 8014-VERIFIED-LINE-QTY-ORIG.                                     07608001
076090                                                                  07609001
076100     MOVE ZERO                 TO  PV-ORIG-EXPTED-ITM-QTY.        07610001
076110                                                                  07611001
076120     EXEC SQL                                                     07612001
076130          SELECT SUM(ORIG_EXPTED_QTY)                             07613001
076140          INTO  :PV-ORIG-EXPTED-ITM-QTY  :RC074-NULL-IND          07614001
076150          FROM                                                    07615001
076160                 RCT_RECDIS_ORIG                                  07616001
076170          WHERE                                                   07617001
076180                ORD_NBR            =  :DK-PO-NBR                  07618001
076190           AND  REC_SEQ_NBR        =  :DK-RCVR-SEQ-NBR            07619001
076200           AND  ORD_LNE_NBR        =  :DK-LINE-NBR                07620001
076210     END-EXEC.                                                    07621001
076220                                                                  07622001
076230     EVALUATE TRUE                                                07623001
076240         WHEN SQLCODE = ZERO                                      07624001
076250              CONTINUE                                            07625001
076260                                                                  07626001
076270         WHEN SQLCODE = +100                                      07627001
076280         WHEN SQLCODE = -305                                      07628001
076290              CONTINUE                                            07629001
076300         WHEN SQLCODE = -904                                      07630001
076310         WHEN SQLCODE = -911                                      07631001
076320         WHEN SQLCODE = -913                                      07632001
076330              SET  RC074-DATABASE-BUSY                            07633001
076340                   RC074-ERROR-YES                                07634001
076350                   PS-ERROR-YES         TO  TRUE                  07635001
076360              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07636001
076370              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      07637001
076380              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    07638001
076390              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    07639001
076400              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07640001
076410              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07641001
076420              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07642001
076430             STRING   ' RCKUT128-8014-'                           07643001
076440                      ' CALLED BY-'                               07644001
076450                      RC074-CALLING-PROGRAM                       07645001
076460                      ' PO='                                      07646001
076470                      RC074-DISPLAY-PO                            07647001
076480                      ' RCVR='                                    07648001
076490                      RC074-DISPLAY-RCVR                          07649001
076500                      ' LINE='                                    07650001
076510                      RC074-DISPLAY-LINE                          07651001
076520                      ' SQLCODE='                                 07652001
076530                      RC074-DISPLAY-SQLCODE                       07653001
076540                      DELIMITED BY SIZE                           07654001
076550                                      INTO RC074-CRA-RET-MSG      07655001
076560             STRING   ' RCKUT128-8014-'                           07656001
076570                      ' CALLED BY-'                               07657001
076580                      RC074-CALLING-PROGRAM                       07658001
076590                      DELIMITED BY SIZE                           07659001
076600                                      INTO RC074-ABEND-TEXT       07660001
076610             MOVE '8014-'               TO RC074-CRA-REQ-ID       07661001
076620                                           RC074-ABEND-PARAGRAPH  07662001
076630             PERFORM 9998-RETURN                                  07663001
076640                                                                  07664001
076650         WHEN SQLWARN0 NOT = SPACE                                07665001
076660         WHEN SQLCODE NOT = ZERO                                  07666001
076670              SET  RC074-INVALID-SQL                              07667001
076680                   RC074-ERROR-YES                                07668001
076690                   PS-ERROR-YES         TO  TRUE                  07669001
076700              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07670001
076710              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      07671001
076720              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    07672001
076730              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    07673001
076740              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07674001
076750              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07675001
076760              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07676001
076770             STRING   ' RCKUT128-8014-'                           07677001
076780                      ' CALLED BY-'                               07678001
076790                      RC074-CALLING-PROGRAM                       07679001
076800                      ' PO='                                      07680001
076810                      RC074-DISPLAY-PO                            07681001
076820                      ' RCVR='                                    07682001
076830                      RC074-DISPLAY-RCVR                          07683001
076840                      ' LINE='                                    07684001
076850                      RC074-DISPLAY-LINE                          07685001
076860                      ' SQLCODE='                                 07686001
076870                      RC074-DISPLAY-SQLCODE                       07687001
076880                      DELIMITED BY SIZE                           07688001
076890                                      INTO RC074-CRA-RET-MSG      07689001
076900             STRING   ' RCKUT128-8014-'                           07690001
076910                      ' CALLED BY-'                               07691001
076920                      RC074-CALLING-PROGRAM                       07692001
076930                      DELIMITED BY SIZE                           07693001
076940                                      INTO RC074-ABEND-TEXT       07694001
076950             MOVE '8014-'               TO RC074-CRA-REQ-ID       07695001
076960                                           RC074-ABEND-PARAGRAPH  07696001
076970             PERFORM 9998-RETURN                                  07697001
076980                                                                  07698001
076990     END-EVALUATE.                                                07699001
077000                                                                  07700001
077010******************************************************************07701001
077020*                                                                *07702001
077030*  VERIFIED LINE - THIS SQL WILL BRING BACK THE QUANTITIES FOR A *07703001
077040*  STORE FOR A VERIFIED LINE                                     *07704001
077050*                                                                *07705001
077060*  VERIFIED LINE - PO-RCVR-LINE-STORE                            *07706001
077070*      PACKSLIP QUANTITY                                         *07707001
077080*      ACTUAL QUANTITY                                           *07708001
077090*      VERIFIED QUANTITY                                         *07709001
077100*                                                                *07710001
077110******************************************************************07711001
077120 8015-VERIFIED-LINE-STR-QTY.                                      07712001
077130                                                                  07713001
077140     MOVE ZERO                 TO  RC074-VERIFY-ITM-QTY           07714001
077150                                   RC074-FCSE-ACTL-ITM-QTY        07715001
077160                                   RC074-TOTAL-ACTL-ITM-QTY.      07716001
077170                                                                  07717001
077180     EXEC SQL                                                     07718001
077190          SELECT                                                  07719001
077200                 SUM(AP_VERIFY_ITM_QTY)                           07720001
077210                ,SUM(VERIFY_ITM_QTY)                              07721001
077220          INTO                                                    07722001
077230                :RC074-VERIFY-ITM-QTY    :RC074-NULL-IND          07723001
077240               ,:RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          07724001
077250          FROM                                                    07725001
077260                 TRECDIS                                          07726001
077270          WHERE                                                   07727001
077280                ORD_NBR            =  :RC074-PO-NBR               07728001
077290           AND  REC_SEQ_NBR        =  :RC074-RCVR-SEQ-NBR         07729001
077300           AND  ORD_LNE_NBR        =  :RC074-LINE-NBR             07730001
077310           AND  STR_NBR            =  :RC074-STR-NBR              07731001
077330     END-EXEC.                                                    07733001
077340                                                                  07734001
077350     EVALUATE TRUE                                                07735001
077360         WHEN SQLCODE = ZERO                                      07736001
077370              MOVE  RC074-FCSE-ACTL-ITM-QTY                       07737001
077380                TO  RC074-TOTAL-ACTL-ITM-QTY                      07738001
077390                                                                  07739001
077400         WHEN SQLCODE = +100                                      07740001
077410         WHEN SQLCODE = -305                                      07741001
077420              CONTINUE                                            07742001
077430         WHEN SQLCODE = -904                                      07743001
077440         WHEN SQLCODE = -911                                      07744001
077450         WHEN SQLCODE = -913                                      07745001
077460              SET  RC074-DATABASE-BUSY                            07746001
077470                   RC074-ERROR-YES                                07747001
077480                   PS-ERROR-YES         TO  TRUE                  07748001
077490              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07749001
077500              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07750001
077510              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07751001
077520              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07752001
077530              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07753001
077540              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07754001
077550              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07755001
077560             STRING   ' RCKUT128-8015-'                           07756001
077570                      ' CALLED BY-'                               07757001
077580                      RC074-CALLING-PROGRAM                       07758001
077590                      ' PO='                                      07759001
077600                      RC074-DISPLAY-PO                            07760001
077610                      ' RCVR='                                    07761001
077620                      RC074-DISPLAY-RCVR                          07762001
077630                      ' LINE='                                    07763001
077640                      RC074-DISPLAY-LINE                          07764001
077650                      ' STR='                                     07765001
077660                      RC074-DISPLAY-STR                           07766001
077670                      ' SQLCODE='                                 07767001
077680                      RC074-DISPLAY-SQLCODE                       07768001
077690                      DELIMITED BY SIZE                           07769001
077700                                      INTO RC074-CRA-RET-MSG      07770001
077710             STRING   ' RCKUT128-8015-'                           07771001
077720                      ' CALLED BY-'                               07772001
077730                      RC074-CALLING-PROGRAM                       07773001
077740                      DELIMITED BY SIZE                           07774001
077750                                      INTO RC074-ABEND-TEXT       07775001
077760             MOVE '8015-'               TO RC074-CRA-REQ-ID       07776001
077770                                           RC074-ABEND-PARAGRAPH  07777001
077780             PERFORM 9998-RETURN                                  07778001
077790                                                                  07779001
077800         WHEN SQLWARN0 NOT = SPACE                                07780001
077810         WHEN SQLCODE NOT = ZERO                                  07781001
077820              SET  RC074-INVALID-SQL                              07782001
077830                   RC074-ERROR-YES                                07783001
077840                   PS-ERROR-YES         TO  TRUE                  07784001
077850              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07785001
077860              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07786001
077870              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07787001
077880              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07788001
077890              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07789001
077900              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07790001
077910              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07791001
077920             STRING   ' RCKUT128-8015-'                           07792001
077930                      ' CALLED BY-'                               07793001
077940                      RC074-CALLING-PROGRAM                       07794001
077950                      ' PO='                                      07795001
077960                      RC074-DISPLAY-PO                            07796001
077970                      ' RCVR='                                    07797001
077980                      RC074-DISPLAY-RCVR                          07798001
077990                      ' LINE='                                    07799001
078000                      RC074-DISPLAY-LINE                          07800001
078010                      ' STR='                                     07801001
078020                      RC074-DISPLAY-STR                           07802001
078030                      ' SQLCODE='                                 07803001
078040                      RC074-DISPLAY-SQLCODE                       07804001
078050                      DELIMITED BY SIZE                           07805001
078060                                      INTO RC074-CRA-RET-MSG      07806001
078070             STRING   ' RCKUT128-8015-'                           07807001
078080                      ' CALLED BY-'                               07808001
078090                      RC074-CALLING-PROGRAM                       07809001
078100                      DELIMITED BY SIZE                           07810001
078110                                      INTO RC074-ABEND-TEXT       07811001
078120             MOVE '8015-'               TO RC074-CRA-REQ-ID       07812001
078130                                           RC074-ABEND-PARAGRAPH  07813001
078140             PERFORM 9998-RETURN                                  07814001
078150                                                                  07815001
078160     END-EVALUATE.                                                07816001
078170                                                                  07817001
078180 8016-VERIFIED-LINE-STR-QTY.                                      07818001
078190                                                                  07819001
078200     MOVE ZERO                 TO  RC074-INVCED-ITM-QTY.          07820004
078210                                                                  07821001
078220     EXEC SQL                                                     07822001
078230          SELECT SUM(EXPTED_ITM_QTY)                              07823001
078240          INTO  :RC074-INVCED-ITM-QTY    :RC074-NULL-IND          07824004
078250          FROM                                                    07825001
078260                 TRECDIS  A                                       07826001
078270          WHERE                                                   07827001
078280                A.ORD_NBR          =  :RC074-PO-NBR               07828001
078290           AND  A.REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR         07829001
078300           AND  A.ORD_LNE_NBR      =  :RC074-LINE-NBR             07830001
078310           AND  A.STR_NBR          =  :RC074-STR-NBR              07831001
078330           AND NOT EXISTS                                         07833001
078340               (SELECT *                                          07834001
078350                FROM RCT_RECDIS_ORIG B                            07835001
078360         WHERE  A.ORD_NBR          = B.ORD_NBR                    07836001
078370           AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR                07837001
078380           AND  A.ORD_LNE_NBR      = B.ORD_LNE_NBR                07838001
078390           AND  A.STR_NBR          = B.STR_NBR)                   07839001
078400     END-EXEC.                                                    07840001
078410                                                                  07841001
078420     EVALUATE TRUE                                                07842001
078430         WHEN SQLCODE = ZERO                                      07843001
078440              CONTINUE                                            07844001
078450                                                                  07845001
078460         WHEN SQLCODE = +100                                      07846001
078470         WHEN SQLCODE = -305                                      07847001
078480              CONTINUE                                            07848001
078490         WHEN SQLCODE = -904                                      07849001
078500         WHEN SQLCODE = -911                                      07850001
078510         WHEN SQLCODE = -913                                      07851001
078520              SET  RC074-DATABASE-BUSY                            07852001
078530                   RC074-ERROR-YES                                07853001
078540                   PS-ERROR-YES         TO  TRUE                  07854001
078550              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07855001
078560              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07856001
078570              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07857001
078580              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07858001
078590              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07859001
078600              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07860001
078610              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07861001
078620             STRING   ' RCKUT128-8016-'                           07862001
078630                      ' CALLED BY-'                               07863001
078640                      RC074-CALLING-PROGRAM                       07864001
078650                      ' PO='                                      07865001
078660                      RC074-DISPLAY-PO                            07866001
078670                      ' RCVR='                                    07867001
078680                      RC074-DISPLAY-RCVR                          07868001
078690                      ' LINE='                                    07869001
078700                      RC074-DISPLAY-LINE                          07870001
078710                      ' STR='                                     07871001
078720                      RC074-DISPLAY-STR                           07872001
078730                      ' SQLCODE='                                 07873001
078740                      RC074-DISPLAY-SQLCODE                       07874001
078750                      DELIMITED BY SIZE                           07875001
078760                                      INTO RC074-CRA-RET-MSG      07876001
078770             STRING   ' RCKUT128-8016-'                           07877001
078780                      ' CALLED BY-'                               07878001
078790                      RC074-CALLING-PROGRAM                       07879001
078800                      DELIMITED BY SIZE                           07880001
078810                                      INTO RC074-ABEND-TEXT       07881001
078820             MOVE '8016-'               TO RC074-CRA-REQ-ID       07882001
078830                                           RC074-ABEND-PARAGRAPH  07883001
078840             PERFORM 9998-RETURN                                  07884001
078850                                                                  07885001
078860         WHEN SQLWARN0 NOT = SPACE                                07886001
078870         WHEN SQLCODE NOT = ZERO                                  07887001
078880              SET  RC074-INVALID-SQL                              07888001
078890                   RC074-ERROR-YES                                07889001
078900                   PS-ERROR-YES         TO  TRUE                  07890001
078910              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07891001
078920              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07892001
078930              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07893001
078940              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07894001
078950              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07895001
078960              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07896001
078970              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07897001
078980             STRING   ' RCKUT128-8016-'                           07898001
078990                      ' CALLED BY-'                               07899001
079000                      RC074-CALLING-PROGRAM                       07900001
079010                      ' PO='                                      07901001
079020                      RC074-DISPLAY-PO                            07902001
079030                      ' RCVR='                                    07903001
079040                      RC074-DISPLAY-RCVR                          07904001
079050                      ' LINE='                                    07905001
079060                      RC074-DISPLAY-LINE                          07906001
079070                      ' STR='                                     07907001
079080                      RC074-DISPLAY-STR                           07908001
079090                      ' SQLCODE='                                 07909001
079100                      RC074-DISPLAY-SQLCODE                       07910001
079110                      DELIMITED BY SIZE                           07911001
079120                                      INTO RC074-CRA-RET-MSG      07912001
079130             STRING   ' RCKUT128-8016-'                           07913001
079140                      ' CALLED BY-'                               07914001
079150                      RC074-CALLING-PROGRAM                       07915001
079160                      DELIMITED BY SIZE                           07916001
079170                                      INTO RC074-ABEND-TEXT       07917001
079180             MOVE '8016-'               TO RC074-CRA-REQ-ID       07918001
079190                                           RC074-ABEND-PARAGRAPH  07919001
079200             PERFORM 9998-RETURN                                  07920001
079210                                                                  07921001
079220     END-EVALUATE.                                                07922001
079230                                                                  07923001
079240 8018-VERIFIED-LNE-STR-QTY-ORIG.                                  07924001
079250                                                                  07925001
079260     MOVE ZERO                 TO PV-ORIG-EXPTED-ITM-QTY.         07926001
079270                                                                  07927001
079280     EXEC SQL                                                     07928001
079290          SELECT SUM(ORIG_EXPTED_QTY)                             07929001
079300          INTO  :PV-ORIG-EXPTED-ITM-QTY  :RC074-NULL-IND          07930001
079310          FROM                                                    07931001
079320                 RCT_RECDIS_ORIG                                  07932001
079330          WHERE                                                   07933001
079340                ORD_NBR            =  :RC074-PO-NBR               07934001
079350           AND  REC_SEQ_NBR        =  :RC074-RCVR-SEQ-NBR         07935001
079360           AND  ORD_LNE_NBR        =  :RC074-LINE-NBR             07936001
079370           AND  STR_NBR            =  :RC074-STR-NBR              07937001
079380     END-EXEC.                                                    07938001
079390                                                                  07939001
079400     EVALUATE TRUE                                                07940001
079410         WHEN SQLCODE = ZERO                                      07941001
079420              CONTINUE                                            07942001
079430                                                                  07943001
079440         WHEN SQLCODE = +100                                      07944001
079450         WHEN SQLCODE = -305                                      07945001
079460              CONTINUE                                            07946001
079470         WHEN SQLCODE = -904                                      07947001
079480         WHEN SQLCODE = -911                                      07948001
079490         WHEN SQLCODE = -913                                      07949001
079500              SET  RC074-DATABASE-BUSY                            07950001
079510                   RC074-ERROR-YES                                07951001
079520                   PS-ERROR-YES         TO  TRUE                  07952001
079530              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07953001
079540              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07954001
079550              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07955001
079560              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07956001
079570              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07957001
079580              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07958001
079590              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07959001
079600             STRING   ' RCKUT128-8018-'                           07960001
079610                      ' CALLED BY-'                               07961001
079620                      RC074-CALLING-PROGRAM                       07962001
079630                      ' PO='                                      07963001
079640                      RC074-DISPLAY-PO                            07964001
079650                      ' RCVR='                                    07965001
079660                      RC074-DISPLAY-RCVR                          07966001
079670                      ' LINE='                                    07967001
079680                      RC074-DISPLAY-LINE                          07968001
079690                      ' STR='                                     07969001
079700                      RC074-DISPLAY-STR                           07970001
079710                      ' SQLCODE='                                 07971001
079720                      RC074-DISPLAY-SQLCODE                       07972001
079730                      DELIMITED BY SIZE                           07973001
079740                                      INTO RC074-CRA-RET-MSG      07974001
079750             STRING   ' RCKUT128-8018-'                           07975001
079760                      ' CALLED BY-'                               07976001
079770                      RC074-CALLING-PROGRAM                       07977001
079780                      DELIMITED BY SIZE                           07978001
079790                                      INTO RC074-ABEND-TEXT       07979001
079800             MOVE '8018-'               TO RC074-CRA-REQ-ID       07980001
079810                                           RC074-ABEND-PARAGRAPH  07981001
079820             PERFORM 9998-RETURN                                  07982001
079830                                                                  07983001
079840         WHEN SQLWARN0 NOT = SPACE                                07984001
079850         WHEN SQLCODE NOT = ZERO                                  07985001
079860              SET  RC074-INVALID-SQL                              07986001
079870                   RC074-ERROR-YES                                07987001
079880                   PS-ERROR-YES         TO  TRUE                  07988001
079890              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 07989001
079900              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      07990001
079910              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    07991001
079920              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    07992001
079930              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    07993001
079940              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     07994001
079950              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    07995001
079960             STRING   ' RCKUT128-8018-'                           07996001
079970                      ' CALLED BY-'                               07997001
079980                      RC074-CALLING-PROGRAM                       07998001
079990                      ' PO='                                      07999001
080000                      RC074-DISPLAY-PO                            08000001
080010                      ' RCVR='                                    08001001
080020                      RC074-DISPLAY-RCVR                          08002001
080030                      ' LINE='                                    08003001
080040                      RC074-DISPLAY-LINE                          08004001
080050                      ' STR='                                     08005001
080060                      RC074-DISPLAY-STR                           08006001
080070                      ' SQLCODE='                                 08007001
080080                      RC074-DISPLAY-SQLCODE                       08008001
080090                      DELIMITED BY SIZE                           08009001
080100                                      INTO RC074-CRA-RET-MSG      08010001
080110             STRING   ' RCKUT128-8018-'                           08011001
080120                      ' CALLED BY-'                               08012001
080130                      RC074-CALLING-PROGRAM                       08013001
080140                      DELIMITED BY SIZE                           08014001
080150                                      INTO RC074-ABEND-TEXT       08015001
080160             MOVE '8018-'               TO RC074-CRA-REQ-ID       08016001
080170                                           RC074-ABEND-PARAGRAPH  08017001
080180             PERFORM 9998-RETURN                                  08018001
080190                                                                  08019001
080200     END-EVALUATE.                                                08020001
080210                                                                  08021001
080220                                                                  08022001
080230******************************************************************08023001
080240*                                                                *08024001
080250*  PACKSLIP AND VERIFIED QUANTITY - RECEIVER                     *08025001
080260*                                                                *08026001
080270*  NOT VERIFIED - PO-RCVR-LINE                                   *08027001
080280*      PACKSLIP QUANTITY                                         *08028001
080290*      VERIFIED QUANTITY                                         *08029001
080300*                                                                *08030001
080310******************************************************************08031001
080320 8020-LINE-EXPTD-VRFD-QTY.                                        08032001
080330                                                                  08033001
080340     MOVE ZERO                 TO  RC074-VERIFY-ITM-QTY.          08034001
080350                                                                  08035001
080360     EXEC SQL                                                     08036001
080370          SELECT                                                  08037001
080380                 SUM(AP_VERIFY_ITM_QTY)                           08038001
080390          INTO                                                    08039001
080400                :RC074-VERIFY-ITM-QTY    :RC074-NULL-IND          08040001
080410          FROM                                                    08041001
080420                 TRECDIS                                          08042001
080430          WHERE                                                   08043001
080440                ORD_NBR          =  :DK-PO-NBR                    08044001
080450           AND  REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR              08045001
080460           AND  ORD_LNE_NBR      =  :DK-LINE-NBR                  08046001
080480     END-EXEC.                                                    08048001
080490                                                                  08049001
080500     EVALUATE TRUE                                                08050001
080510         WHEN SQLCODE = ZERO                                      08051001
080520         WHEN SQLCODE = +100                                      08052001
080530         WHEN SQLCODE = -305                                      08053001
080540              CONTINUE                                            08054001
080550         WHEN SQLCODE = -904                                      08055001
080560         WHEN SQLCODE = -911                                      08056001
080570         WHEN SQLCODE = -913                                      08057001
080580              SET  RC074-DATABASE-BUSY                            08058001
080590                   RC074-ERROR-YES                                08059001
080600                   PS-ERROR-YES         TO  TRUE                  08060001
080610              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08061001
080620              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      08062001
080630              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    08063001
080640              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    08064001
080650              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08065001
080660              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08066001
080670              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08067001
080680             STRING   ' RCKUT128-8020-'                           08068001
080690                      ' CALLED BY-'                               08069001
080700                      RC074-CALLING-PROGRAM                       08070001
080710                      ' PO='                                      08071001
080720                      RC074-DISPLAY-PO                            08072001
080730                      ' RCVR='                                    08073001
080740                      RC074-DISPLAY-RCVR                          08074001
080750                      ' LINE='                                    08075001
080760                      RC074-DISPLAY-LINE                          08076001
080770                      ' SQLCODE='                                 08077001
080780                      RC074-DISPLAY-SQLCODE                       08078001
080790                      DELIMITED BY SIZE                           08079001
080800                                      INTO RC074-CRA-RET-MSG      08080001
080810             STRING   ' RCKUT128-8020-'                           08081001
080820                      ' CALLED BY-'                               08082001
080830                      RC074-CALLING-PROGRAM                       08083001
080840                      DELIMITED BY SIZE                           08084001
080850                                      INTO RC074-ABEND-TEXT       08085001
080860             MOVE '8020-'               TO RC074-CRA-REQ-ID       08086001
080870                                           RC074-ABEND-PARAGRAPH  08087001
080880             PERFORM 9998-RETURN                                  08088001
080890                                                                  08089001
080900         WHEN SQLWARN0 NOT = SPACE                                08090001
080910         WHEN SQLCODE NOT = ZERO                                  08091001
080920              SET  RC074-INVALID-SQL                              08092001
080930                   RC074-ERROR-YES                                08093001
080940                   PS-ERROR-YES         TO  TRUE                  08094001
080950              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08095001
080960              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      08096001
080970              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    08097001
080980              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    08098001
080990              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08099001
081000              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08100001
081010              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08101001
081020             STRING   ' RCKUT128-8020-'                           08102001
081030                      ' CALLED BY-'                               08103001
081040                      RC074-CALLING-PROGRAM                       08104001
081050                      ' PO='                                      08105001
081060                      RC074-DISPLAY-PO                            08106001
081070                      ' RCVR='                                    08107001
081080                      RC074-DISPLAY-RCVR                          08108001
081090                      ' LINE='                                    08109001
081100                      RC074-DISPLAY-LINE                          08110001
081110                      ' SQLCODE='                                 08111001
081120                      RC074-DISPLAY-SQLCODE                       08112001
081130                      DELIMITED BY SIZE                           08113001
081140                                      INTO RC074-CRA-RET-MSG      08114001
081150             STRING   ' RCKUT128-8020-'                           08115001
081160                      ' CALLED BY-'                               08116001
081170                      RC074-CALLING-PROGRAM                       08117001
081180                      DELIMITED BY SIZE                           08118001
081190                                      INTO RC074-ABEND-TEXT       08119001
081200             MOVE '8020-'               TO RC074-CRA-REQ-ID       08120001
081210                                           RC074-ABEND-PARAGRAPH  08121001
081220             PERFORM 9998-RETURN                                  08122001
081230                                                                  08123001
081240     END-EVALUATE.                                                08124001
081250                                                                  08125001
081260 8025-LINE-EXPTD-VRFD-QTY.                                        08126001
081270                                                                  08127001
081280     MOVE ZERO                 TO  RC074-INVCED-ITM-QTY.          08128004
081290                                                                  08129001
081300     EXEC SQL                                                     08130001
081310          SELECT SUM(EXPTED_ITM_QTY)                              08131001
081320          INTO  :RC074-INVCED-ITM-QTY    :RC074-NULL-IND          08132004
081330          FROM                                                    08133001
081340                 TRECDIS A                                        08134001
081350          WHERE                                                   08135001
081360                A.ORD_NBR          =  :DK-PO-NBR                  08136001
081370           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            08137001
081380           AND  A.ORD_LNE_NBR      =  :DK-LINE-NBR                08138001
081400           AND NOT EXISTS                                         08140001
081410               (SELECT *                                          08141001
081420                FROM RCT_RECDIS_ORIG B                            08142001
081430         WHERE  A.ORD_NBR          = B.ORD_NBR                    08143001
081440           AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR                08144001
081450           AND  A.ORD_LNE_NBR      = B.ORD_LNE_NBR                08145001
081460           AND  A.STR_NBR          = B.STR_NBR)                   08146001
081470     END-EXEC.                                                    08147001
081480                                                                  08148001
081490     EVALUATE TRUE                                                08149001
081500         WHEN SQLCODE = ZERO                                      08150001
081510         WHEN SQLCODE = +100                                      08151001
081520         WHEN SQLCODE = -305                                      08152001
081530              CONTINUE                                            08153001
081540         WHEN SQLCODE = -904                                      08154001
081550         WHEN SQLCODE = -911                                      08155001
081560         WHEN SQLCODE = -913                                      08156001
081570              SET  RC074-DATABASE-BUSY                            08157001
081580                   RC074-ERROR-YES                                08158001
081590                   PS-ERROR-YES         TO  TRUE                  08159001
081600              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08160001
081610              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      08161001
081620              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    08162001
081630              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    08163001
081640              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08164001
081650              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08165001
081660              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08166001
081670             STRING   ' RCKUT128-8025-'                           08167001
081680                      ' CALLED BY-'                               08168001
081690                      RC074-CALLING-PROGRAM                       08169001
081700                      ' PO='                                      08170001
081710                      RC074-DISPLAY-PO                            08171001
081720                      ' RCVR='                                    08172001
081730                      RC074-DISPLAY-RCVR                          08173001
081740                      ' LINE='                                    08174001
081750                      RC074-DISPLAY-LINE                          08175001
081760                      ' SQLCODE='                                 08176001
081770                      RC074-DISPLAY-SQLCODE                       08177001
081780                      DELIMITED BY SIZE                           08178001
081790                                      INTO RC074-CRA-RET-MSG      08179001
081800             STRING   ' RCKUT128-8025-'                           08180001
081810                      ' CALLED BY-'                               08181001
081820                      RC074-CALLING-PROGRAM                       08182001
081830                      DELIMITED BY SIZE                           08183001
081840                                      INTO RC074-ABEND-TEXT       08184001
081850             MOVE '8025-'               TO RC074-CRA-REQ-ID       08185001
081860                                           RC074-ABEND-PARAGRAPH  08186001
081870             PERFORM 9998-RETURN                                  08187001
081880                                                                  08188001
081890         WHEN SQLWARN0 NOT = SPACE                                08189001
081900         WHEN SQLCODE NOT = ZERO                                  08190001
081910              SET  RC074-INVALID-SQL                              08191001
081920                   RC074-ERROR-YES                                08192001
081930                   PS-ERROR-YES         TO  TRUE                  08193001
081940              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08194001
081950              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      08195001
081960              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    08196001
081970              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    08197001
081980              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08198001
081990              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08199001
082000              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08200001
082010             STRING   ' RCKUT128-8025-'                           08201001
082020                      ' CALLED BY-'                               08202001
082030                      RC074-CALLING-PROGRAM                       08203001
082040                      ' PO='                                      08204001
082050                      RC074-DISPLAY-PO                            08205001
082060                      ' RCVR='                                    08206001
082070                      RC074-DISPLAY-RCVR                          08207001
082080                      ' LINE='                                    08208001
082090                      RC074-DISPLAY-LINE                          08209001
082100                      ' SQLCODE='                                 08210001
082110                      RC074-DISPLAY-SQLCODE                       08211001
082120                      DELIMITED BY SIZE                           08212001
082130                                      INTO RC074-CRA-RET-MSG      08213001
082140             STRING   ' RCKUT128-8025-'                           08214001
082150                      ' CALLED BY-'                               08215001
082160                      RC074-CALLING-PROGRAM                       08216001
082170                      DELIMITED BY SIZE                           08217001
082180                                      INTO RC074-ABEND-TEXT       08218001
082190             MOVE '8025-'               TO RC074-CRA-REQ-ID       08219001
082200                                           RC074-ABEND-PARAGRAPH  08220001
082210             PERFORM 9998-RETURN                                  08221001
082220                                                                  08222001
082230     END-EVALUATE.                                                08223001
082240                                                                  08224001
082250 8028-LINE-EXPTD-VRFD-QTY-ORIG.                                   08225001
082260                                                                  08226001
082270     MOVE ZERO                 TO  PV-ORIG-EXPTED-ITM-QTY.        08227001
082280                                                                  08228001
082290     EXEC SQL                                                     08229001
082300          SELECT SUM(ORIG_EXPTED_QTY)                             08230001
082310          INTO  :PV-ORIG-EXPTED-ITM-QTY  :RC074-NULL-IND          08231001
082320          FROM                                                    08232001
082330                 RCT_RECDIS_ORIG A                                08233001
082340          WHERE                                                   08234001
082350                A.ORD_NBR          =  :DK-PO-NBR                  08235001
082360           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            08236001
082370           AND  A.ORD_LNE_NBR      =  :DK-LINE-NBR                08237001
082380     END-EXEC.                                                    08238001
082390                                                                  08239001
082400     EVALUATE TRUE                                                08240001
082410         WHEN SQLCODE = ZERO                                      08241001
082420         WHEN SQLCODE = +100                                      08242001
082430         WHEN SQLCODE = -305                                      08243001
082440              CONTINUE                                            08244001
082450         WHEN SQLCODE = -904                                      08245001
082460         WHEN SQLCODE = -911                                      08246001
082470         WHEN SQLCODE = -913                                      08247001
082480              SET  RC074-DATABASE-BUSY                            08248001
082490                   RC074-ERROR-YES                                08249001
082500                   PS-ERROR-YES         TO  TRUE                  08250001
082510              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08251001
082520              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      08252001
082530              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    08253001
082540              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    08254001
082550              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08255001
082560              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08256001
082570              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08257001
082580             STRING   ' RCKUT128-8028-'                           08258001
082590                      ' CALLED BY-'                               08259001
082600                      RC074-CALLING-PROGRAM                       08260001
082610                      ' PO='                                      08261001
082620                      RC074-DISPLAY-PO                            08262001
082630                      ' RCVR='                                    08263001
082640                      RC074-DISPLAY-RCVR                          08264001
082650                      ' LINE='                                    08265001
082660                      RC074-DISPLAY-LINE                          08266001
082670                      ' SQLCODE='                                 08267001
082680                      RC074-DISPLAY-SQLCODE                       08268001
082690                      DELIMITED BY SIZE                           08269001
082700                                      INTO RC074-CRA-RET-MSG      08270001
082710             STRING   ' RCKUT128-8028-'                           08271001
082720                      ' CALLED BY-'                               08272001
082730                      RC074-CALLING-PROGRAM                       08273001
082740                      DELIMITED BY SIZE                           08274001
082750                                      INTO RC074-ABEND-TEXT       08275001
082760             MOVE '8028-'               TO RC074-CRA-REQ-ID       08276001
082770                                           RC074-ABEND-PARAGRAPH  08277001
082780             PERFORM 9998-RETURN                                  08278001
082790                                                                  08279001
082800         WHEN SQLWARN0 NOT = SPACE                                08280001
082810         WHEN SQLCODE NOT = ZERO                                  08281001
082820              SET  RC074-INVALID-SQL                              08282001
082830                   RC074-ERROR-YES                                08283001
082840                   PS-ERROR-YES         TO  TRUE                  08284001
082850              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08285001
082860              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      08286001
082870              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    08287001
082880              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    08288001
082890              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08289001
082900              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08290001
082910              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08291001
082920             STRING   ' RCKUT128-8028-'                           08292001
082930                      ' CALLED BY-'                               08293001
082940                      RC074-CALLING-PROGRAM                       08294001
082950                      ' PO='                                      08295001
082960                      RC074-DISPLAY-PO                            08296001
082970                      ' RCVR='                                    08297001
082980                      RC074-DISPLAY-RCVR                          08298001
082990                      ' LINE='                                    08299001
083000                      RC074-DISPLAY-LINE                          08300001
083010                      ' SQLCODE='                                 08301001
083020                      RC074-DISPLAY-SQLCODE                       08302001
083030                      DELIMITED BY SIZE                           08303001
083040                                      INTO RC074-CRA-RET-MSG      08304001
083050             STRING   ' RCKUT128-8028-'                           08305001
083060                      ' CALLED BY-'                               08306001
083070                      RC074-CALLING-PROGRAM                       08307001
083080                      DELIMITED BY SIZE                           08308001
083090                                      INTO RC074-ABEND-TEXT       08309001
083100             MOVE '8028-'               TO RC074-CRA-REQ-ID       08310001
083110                                           RC074-ABEND-PARAGRAPH  08311001
083120             PERFORM 9998-RETURN                                  08312001
083130                                                                  08313001
083140     END-EVALUATE.                                                08314001
083150                                                                  08315001
083160******************************************************************08316001
083170*                                                                *08317001
083180*  PACKSLIP AND VERIFIED QUANTITY - RECEIVER                     *08318001
083190*                                                                *08319001
083200*  NOT VERIFIED - PO-RCVR-LINE-STORE                             *08320001
083210*      PACKSLIP QUANTITY (EXPECTED)                              *08321001
083220*      VERIFIED QUANTITY                                         *08322001
083230*                                                                *08323001
083240******************************************************************08324001
083250 8030-LINE-STR-EXPTD-VRFD-QTY.                                    08325001
083260                                                                  08326001
083270     MOVE ZERO                 TO  RC074-VERIFY-ITM-QTY.          08327001
083280                                                                  08328001
083290     EXEC SQL                                                     08329001
083300          SELECT                                                  08330001
083310                 SUM(AP_VERIFY_ITM_QTY)                           08331001
083320          INTO                                                    08332001
083330                :RC074-VERIFY-ITM-QTY    :RC074-NULL-IND          08333001
083340          FROM                                                    08334001
083350                 TRECDIS                                          08335001
083360          WHERE                                                   08336001
083370                ORD_NBR          =  :RC074-PO-NBR                 08337001
083380           AND  REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR           08338001
083390           AND  ORD_LNE_NBR      =  :RC074-LINE-NBR               08339001
083400           AND  STR_NBR          =  :RC074-STR-NBR                08340001
083420     END-EXEC.                                                    08342001
083430                                                                  08343001
083440     EVALUATE TRUE                                                08344001
083450         WHEN SQLCODE = ZERO                                      08345001
083460         WHEN SQLCODE = +100                                      08346001
083470         WHEN SQLCODE = -305                                      08347001
083480              CONTINUE                                            08348001
083490         WHEN SQLCODE = -904                                      08349001
083500         WHEN SQLCODE = -911                                      08350001
083510         WHEN SQLCODE = -913                                      08351001
083520              SET  RC074-DATABASE-BUSY                            08352001
083530                   RC074-ERROR-YES                                08353001
083540                   PS-ERROR-YES         TO  TRUE                  08354001
083550              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08355001
083560              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08356001
083570              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08357001
083580              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08358001
083590              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08359001
083600              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08360001
083610              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08361001
083620             STRING   ' RCKUT128-8030-'                           08362001
083630                      ' CALLED BY-'                               08363001
083640                      RC074-CALLING-PROGRAM                       08364001
083650                      ' PO='                                      08365001
083660                      RC074-DISPLAY-PO                            08366001
083670                      ' RCVR='                                    08367001
083680                      RC074-DISPLAY-RCVR                          08368001
083690                      ' LINE='                                    08369001
083700                      RC074-DISPLAY-LINE                          08370001
083710                      ' STR='                                     08371001
083720                      RC074-DISPLAY-STR                           08372001
083730                      ' SQLCODE='                                 08373001
083740                      RC074-DISPLAY-SQLCODE                       08374001
083750                      DELIMITED BY SIZE                           08375001
083760                                      INTO RC074-CRA-RET-MSG      08376001
083770             STRING   ' RCKUT128-8030-'                           08377001
083780                      ' CALLED BY-'                               08378001
083790                      RC074-CALLING-PROGRAM                       08379001
083800                      DELIMITED BY SIZE                           08380001
083810                                      INTO RC074-ABEND-TEXT       08381001
083820             MOVE '8030-'               TO RC074-CRA-REQ-ID       08382001
083830                                           RC074-ABEND-PARAGRAPH  08383001
083840             PERFORM 9998-RETURN                                  08384001
083850                                                                  08385001
083860         WHEN SQLWARN0 NOT = SPACE                                08386001
083870         WHEN SQLCODE NOT = ZERO                                  08387001
083880              SET  RC074-INVALID-SQL                              08388001
083890                   RC074-ERROR-YES                                08389001
083900                   PS-ERROR-YES         TO  TRUE                  08390001
083910              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08391001
083920              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08392001
083930              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08393001
083940              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08394001
083950              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08395001
083960              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08396001
083970              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08397001
083980             STRING   ' RCKUT128-8030-'                           08398001
083990                      ' CALLED BY-'                               08399001
084000                      RC074-CALLING-PROGRAM                       08400001
084010                      ' PO='                                      08401001
084020                      RC074-DISPLAY-PO                            08402001
084030                      ' RCVR='                                    08403001
084040                      RC074-DISPLAY-RCVR                          08404001
084050                      ' LINE='                                    08405001
084060                      RC074-DISPLAY-LINE                          08406001
084070                      ' STR='                                     08407001
084080                      RC074-DISPLAY-STR                           08408001
084090                      ' SQLCODE='                                 08409001
084100                      RC074-DISPLAY-SQLCODE                       08410001
084110                      DELIMITED BY SIZE                           08411001
084120                                      INTO RC074-CRA-RET-MSG      08412001
084130             STRING   ' RCKUT128-8030-'                           08413001
084140                      ' CALLED BY-'                               08414001
084150                      RC074-CALLING-PROGRAM                       08415001
084160                      DELIMITED BY SIZE                           08416001
084170                                      INTO RC074-ABEND-TEXT       08417001
084180             MOVE '8030-'               TO RC074-CRA-REQ-ID       08418001
084190                                           RC074-ABEND-PARAGRAPH  08419001
084200             PERFORM 9998-RETURN                                  08420001
084210                                                                  08421001
084220     END-EVALUATE.                                                08422001
084230                                                                  08423001
084240 8035-LINE-STR-EXPTD-VRFD-QTY.                                    08424001
084250                                                                  08425001
084260     MOVE ZERO                 TO  RC074-INVCED-ITM-QTY.          08426004
084270                                                                  08427001
084280     EXEC SQL                                                     08428001
084290          SELECT SUM(EXPTED_ITM_QTY)                              08429001
084300          INTO  :RC074-INVCED-ITM-QTY    :RC074-NULL-IND          08430004
084310          FROM                                                    08431001
084320                 TRECDIS  A                                       08432001
084330          WHERE                                                   08433001
084340                A.ORD_NBR          =  :RC074-PO-NBR               08434001
084350           AND  A.REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR         08435001
084360           AND  A.ORD_LNE_NBR      =  :RC074-LINE-NBR             08436001
084370           AND  A.STR_NBR          =  :RC074-STR-NBR              08437001
084390           AND NOT EXISTS                                         08439001
084400               (SELECT *                                          08440001
084410                FROM RCT_RECDIS_ORIG B                            08441001
084420         WHERE  A.ORD_NBR          = B.ORD_NBR                    08442001
084430           AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR                08443001
084440           AND  A.ORD_LNE_NBR      = B.ORD_LNE_NBR                08444001
084450           AND  A.STR_NBR          = B.STR_NBR)                   08445001
084460     END-EXEC.                                                    08446001
084470                                                                  08447001
084480     EVALUATE TRUE                                                08448001
084490         WHEN SQLCODE = ZERO                                      08449001
084500         WHEN SQLCODE = +100                                      08450001
084510         WHEN SQLCODE = -305                                      08451001
084520              CONTINUE                                            08452001
084530         WHEN SQLCODE = -904                                      08453001
084540         WHEN SQLCODE = -911                                      08454001
084550         WHEN SQLCODE = -913                                      08455001
084560              SET  RC074-DATABASE-BUSY                            08456001
084570                   RC074-ERROR-YES                                08457001
084580                   PS-ERROR-YES         TO  TRUE                  08458001
084590              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08459001
084600              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08460001
084610              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08461001
084620              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08462001
084630              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08463001
084640              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08464001
084650              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08465001
084660             STRING   ' RCKUT128-8035-'                           08466001
084670                      ' CALLED BY-'                               08467001
084680                      RC074-CALLING-PROGRAM                       08468001
084690                      ' PO='                                      08469001
084700                      RC074-DISPLAY-PO                            08470001
084710                      ' RCVR='                                    08471001
084720                      RC074-DISPLAY-RCVR                          08472001
084730                      ' LINE='                                    08473001
084740                      RC074-DISPLAY-LINE                          08474001
084750                      ' STR='                                     08475001
084760                      RC074-DISPLAY-STR                           08476001
084770                      ' SQLCODE='                                 08477001
084780                      RC074-DISPLAY-SQLCODE                       08478001
084790                      DELIMITED BY SIZE                           08479001
084800                                      INTO RC074-CRA-RET-MSG      08480001
084810             STRING   ' RCKUT128-8035-'                           08481001
084820                      ' CALLED BY-'                               08482001
084830                      RC074-CALLING-PROGRAM                       08483001
084840                      DELIMITED BY SIZE                           08484001
084850                                      INTO RC074-ABEND-TEXT       08485001
084860             MOVE '8035-'               TO RC074-CRA-REQ-ID       08486001
084870                                           RC074-ABEND-PARAGRAPH  08487001
084880             PERFORM 9998-RETURN                                  08488001
084890                                                                  08489001
084900         WHEN SQLWARN0 NOT = SPACE                                08490001
084910         WHEN SQLCODE NOT = ZERO                                  08491001
084920              SET  RC074-INVALID-SQL                              08492001
084930                   RC074-ERROR-YES                                08493001
084940                   PS-ERROR-YES         TO  TRUE                  08494001
084950              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08495001
084960              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08496001
084970              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08497001
084980              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08498001
084990              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08499001
085000              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08500001
085010              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08501001
085020             STRING   ' RCKUT128-8035-'                           08502001
085030                      ' CALLED BY-'                               08503001
085040                      RC074-CALLING-PROGRAM                       08504001
085050                      ' PO='                                      08505001
085060                      RC074-DISPLAY-PO                            08506001
085070                      ' RCVR='                                    08507001
085080                      RC074-DISPLAY-RCVR                          08508001
085090                      ' LINE='                                    08509001
085100                      RC074-DISPLAY-LINE                          08510001
085110                      ' STR='                                     08511001
085120                      RC074-DISPLAY-STR                           08512001
085130                      ' SQLCODE='                                 08513001
085140                      RC074-DISPLAY-SQLCODE                       08514001
085150                      DELIMITED BY SIZE                           08515001
085160                                      INTO RC074-CRA-RET-MSG      08516001
085170             STRING   ' RCKUT128-8035-'                           08517001
085180                      ' CALLED BY-'                               08518001
085190                      RC074-CALLING-PROGRAM                       08519001
085200                      DELIMITED BY SIZE                           08520001
085210                                      INTO RC074-ABEND-TEXT       08521001
085220             MOVE '8035-'               TO RC074-CRA-REQ-ID       08522001
085230                                           RC074-ABEND-PARAGRAPH  08523001
085240             PERFORM 9998-RETURN                                  08524001
085250                                                                  08525001
085260     END-EVALUATE.                                                08526001
085270                                                                  08527001
085280 8038-LINE-STR-EXPTD-QTY-ORIG.                                    08528001
085290                                                                  08529001
085300     MOVE ZERO                 TO  PV-ORIG-EXPTED-ITM-QTY.        08530001
085310                                                                  08531001
085320     EXEC SQL                                                     08532001
085330          SELECT SUM(ORIG_EXPTED_QTY)                             08533001
085340          INTO  :PV-ORIG-EXPTED-ITM-QTY  :RC074-NULL-IND          08534001
085350          FROM                                                    08535001
085360                 RCT_RECDIS_ORIG                                  08536001
085370          WHERE                                                   08537001
085380                ORD_NBR          =  :RC074-PO-NBR                 08538001
085390           AND  REC_SEQ_NBR      =  :RC074-RCVR-SEQ-NBR           08539001
085400           AND  ORD_LNE_NBR      =  :RC074-LINE-NBR               08540001
085410           AND  STR_NBR          =  :RC074-STR-NBR                08541001
085420     END-EXEC.                                                    08542001
085430                                                                  08543001
085440     EVALUATE TRUE                                                08544001
085450         WHEN SQLCODE = ZERO                                      08545001
085460         WHEN SQLCODE = +100                                      08546001
085470         WHEN SQLCODE = -305                                      08547001
085480              CONTINUE                                            08548001
085490         WHEN SQLCODE = -904                                      08549001
085500         WHEN SQLCODE = -911                                      08550001
085510         WHEN SQLCODE = -913                                      08551001
085520              SET  RC074-DATABASE-BUSY                            08552001
085530                   RC074-ERROR-YES                                08553001
085540                   PS-ERROR-YES         TO  TRUE                  08554001
085550              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08555001
085560              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08556001
085570              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08557001
085580              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08558001
085590              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08559001
085600              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08560001
085610              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08561001
085620             STRING   ' RCKUT128-8038-'                           08562001
085630                      ' CALLED BY-'                               08563001
085640                      RC074-CALLING-PROGRAM                       08564001
085650                      ' PO='                                      08565001
085660                      RC074-DISPLAY-PO                            08566001
085670                      ' RCVR='                                    08567001
085680                      RC074-DISPLAY-RCVR                          08568001
085690                      ' LINE='                                    08569001
085700                      RC074-DISPLAY-LINE                          08570001
085710                      ' STR='                                     08571001
085720                      RC074-DISPLAY-STR                           08572001
085730                      ' SQLCODE='                                 08573001
085740                      RC074-DISPLAY-SQLCODE                       08574001
085750                      DELIMITED BY SIZE                           08575001
085760                                      INTO RC074-CRA-RET-MSG      08576001
085770             STRING   ' RCKUT128-8038-'                           08577001
085780                      ' CALLED BY-'                               08578001
085790                      RC074-CALLING-PROGRAM                       08579001
085800                      DELIMITED BY SIZE                           08580001
085810                                      INTO RC074-ABEND-TEXT       08581001
085820             MOVE '8038-'               TO RC074-CRA-REQ-ID       08582001
085830                                           RC074-ABEND-PARAGRAPH  08583001
085840             PERFORM 9998-RETURN                                  08584001
085850                                                                  08585001
085860         WHEN SQLWARN0 NOT = SPACE                                08586001
085870         WHEN SQLCODE NOT = ZERO                                  08587001
085880              SET  RC074-INVALID-SQL                              08588001
085890                   RC074-ERROR-YES                                08589001
085900                   PS-ERROR-YES         TO  TRUE                  08590001
085910              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08591001
085920              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08592001
085930              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08593001
085940              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08594001
085950              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08595001
085960              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08596001
085970              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08597001
085980             STRING   ' RCKUT128-8038-'                           08598001
085990                      ' CALLED BY-'                               08599001
086000                      RC074-CALLING-PROGRAM                       08600001
086010                      ' PO='                                      08601001
086020                      RC074-DISPLAY-PO                            08602001
086030                      ' RCVR='                                    08603001
086040                      RC074-DISPLAY-RCVR                          08604001
086050                      ' LINE='                                    08605001
086060                      RC074-DISPLAY-LINE                          08606001
086070                      ' STR='                                     08607001
086080                      RC074-DISPLAY-STR                           08608001
086090                      ' SQLCODE='                                 08609001
086100                      RC074-DISPLAY-SQLCODE                       08610001
086110                      DELIMITED BY SIZE                           08611001
086120                                      INTO RC074-CRA-RET-MSG      08612001
086130             STRING   ' RCKUT128-8038-'                           08613001
086140                      ' CALLED BY-'                               08614001
086150                      RC074-CALLING-PROGRAM                       08615001
086160                      DELIMITED BY SIZE                           08616001
086170                                      INTO RC074-ABEND-TEXT       08617001
086180             MOVE '8038-'               TO RC074-CRA-REQ-ID       08618001
086190                                           RC074-ABEND-PARAGRAPH  08619001
086200             PERFORM 9998-RETURN                                  08620001
086210                                                                  08621001
086220     END-EVALUATE.                                                08622001
086230                                                                  08623001
086240******************************************************************08624001
086250*                                                                *08625001
086260*  SUM UNIT QUANTITIES FOR ORDER FROM OUTBOUND DATABASE - RCVR   *08626001
086270*                                                                *08627001
086280*  NOT VERIFIED - PO-RCVR                                        *08628001
086290*      ACTUAL QUANTITY                                           *08629001
086300*                                                                *08630001
086310******************************************************************08631001
086320 8040-SUM-RCVR-OTBND-UPC.                                         08632001
086330                                                                  08633001
086340     MOVE ZERO                 TO  RC074-FCSE-ACTL-ITM-QTY.       08634001
086350                                                                  08635001
086360     EXEC SQL                                                     08636001
086370          SELECT                                                  08637001
086380                 SUM(A.SHPD_UNT_QTY)                              08638001
086390          INTO                                                    08639001
086400                :RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          08640001
086410          FROM                                                    08641001
086420                 SUT_OTBND_UPC A                                  08642001
086430               , SUT_OTBND_CART B                                 08643001
086440          WHERE                                                   08644001
086450                A.TRN_NBR        =  :RC074-PO-NBR                 08645001
086460           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           08646001
086470           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               08647001
086480           AND  B.ACTV_IND       =  'Y'                           08648001
086490           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              08649001
086500     END-EXEC.                                                    08650001
086510                                                                  08651001
086520     EVALUATE TRUE                                                08652001
086530         WHEN SQLCODE = ZERO                                      08653001
086540         WHEN SQLCODE = +100                                      08654001
086550         WHEN SQLCODE = -305                                      08655001
086560              CONTINUE                                            08656001
086570         WHEN SQLCODE = -904                                      08657001
086580         WHEN SQLCODE = -911                                      08658001
086590         WHEN SQLCODE = -913                                      08659001
086600              SET  RC074-DATABASE-BUSY                            08660001
086610                   RC074-ERROR-YES                                08661001
086620                   PS-ERROR-YES         TO  TRUE                  08662001
086630              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08663001
086640              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08664001
086650              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08665001
086660              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08666001
086670              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08667001
086680              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08668001
086690              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08669001
086700             STRING   ' RCKUT128-8040-'                           08670001
086710                      ' CALLED BY-'                               08671001
086720                      RC074-CALLING-PROGRAM                       08672001
086730                      ' PO='                                      08673001
086740                      RC074-DISPLAY-PO                            08674001
086750                      ' RCVR='                                    08675001
086760                      RC074-DISPLAY-RCVR                          08676001
086770                      ' SQLCODE='                                 08677001
086780                      RC074-DISPLAY-SQLCODE                       08678001
086790                      DELIMITED BY SIZE                           08679001
086800                                      INTO RC074-CRA-RET-MSG      08680001
086810             STRING   ' RCKUT128-8040-'                           08681001
086820                      ' CALLED BY-'                               08682001
086830                      RC074-CALLING-PROGRAM                       08683001
086840                      DELIMITED BY SIZE                           08684001
086850                                      INTO RC074-ABEND-TEXT       08685001
086860             MOVE '8040-'               TO RC074-CRA-REQ-ID       08686001
086870                                           RC074-ABEND-PARAGRAPH  08687001
086880             PERFORM 9998-RETURN                                  08688001
086890                                                                  08689001
086900         WHEN SQLWARN0 NOT = SPACE                                08690001
086910         WHEN SQLCODE NOT = ZERO                                  08691001
086920              SET  RC074-INVALID-SQL                              08692001
086930                   RC074-ERROR-YES                                08693001
086940                   PS-ERROR-YES         TO  TRUE                  08694001
086950              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08695001
086960              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08696001
086970              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08697001
086980              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08698001
086990              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08699001
087000              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08700001
087010              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08701001
087020             STRING   ' RCKUT128-8040-'                           08702001
087030                      ' CALLED BY-'                               08703001
087040                      RC074-CALLING-PROGRAM                       08704001
087050                      ' PO='                                      08705001
087060                      RC074-DISPLAY-PO                            08706001
087070                      ' RCVR='                                    08707001
087080                      RC074-DISPLAY-RCVR                          08708001
087090                      ' SQLCODE='                                 08709001
087100                      RC074-DISPLAY-SQLCODE                       08710001
087110                      DELIMITED BY SIZE                           08711001
087120                                      INTO RC074-CRA-RET-MSG      08712001
087130             STRING   ' RCKUT128-8040-'                           08713001
087140                      ' CALLED BY-'                               08714001
087150                      RC074-CALLING-PROGRAM                       08715001
087160                      DELIMITED BY SIZE                           08716001
087170                                      INTO RC074-ABEND-TEXT       08717001
087180             MOVE '8040-'               TO RC074-CRA-REQ-ID       08718001
087190                                           RC074-ABEND-PARAGRAPH  08719001
087200             PERFORM 9998-RETURN                                  08720001
087210                                                                  08721001
087220     END-EVALUATE.                                                08722001
087230                                                                  08723001
087240                                                                  08724001
087250******************************************************************08725001
087260*                                                                *08726001
087270*  SUM UNIT QUANTITIES FOR ORDER FROM OUTBOUND DATABASE - LINE   *08727001
087280*                                                                *08728001
087290*  NOT VERIFIED - PO-RCVR-LINE                                   *08729001
087300*      ACTUAL QUANTITY                                           *08730001
087310*                                                                *08731001
087320******************************************************************08732001
087330 8050-SUM-LINE-OTBND-UPC.                                         08733001
087340                                                                  08734001
087350     MOVE ZERO                 TO  RC074-FCSE-ACTL-ITM-QTY.       08735001
087360                                                                  08736001
087370     EXEC SQL                                                     08737001
087380          SELECT                                                  08738001
087390                 SUM(A.SHPD_UNT_QTY)                              08739001
087400          INTO                                                    08740001
087410                :RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          08741001
087420          FROM                                                    08742001
087430                 SUT_OTBND_UPC A                                  08743001
087440                ,SUT_OTBND_CART B                                 08744001
087450          WHERE                                                   08745001
087460                A.TRN_NBR        =  :DK-PO-NBR                    08746001
087470           AND  A.RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR              08747001
087480           AND  A.TRN_LNE_NBR    =  :DK-LINE-NBR                  08748001
087490           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               08749001
087500           AND  B.ACTV_IND       =  'Y'                           08750001
087510           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              08751001
087520     END-EXEC.                                                    08752001
087530                                                                  08753001
087540     EVALUATE TRUE                                                08754001
087550         WHEN SQLCODE = ZERO                                      08755001
087560         WHEN SQLCODE = +100                                      08756001
087570         WHEN SQLCODE = -305                                      08757001
087580              CONTINUE                                            08758001
087590         WHEN SQLCODE = -904                                      08759001
087600         WHEN SQLCODE = -911                                      08760001
087610         WHEN SQLCODE = -913                                      08761001
087620              SET  RC074-DATABASE-BUSY                            08762001
087630                   RC074-ERROR-YES                                08763001
087640                   PS-ERROR-YES         TO  TRUE                  08764001
087650              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08765001
087660              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      08766001
087670              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    08767001
087680              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    08768001
087690              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08769001
087700              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08770001
087710              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08771001
087720             STRING   ' RCKUT128-8050-'                           08772001
087730                      ' CALLED BY-'                               08773001
087740                      RC074-CALLING-PROGRAM                       08774001
087750                      ' PO='                                      08775001
087760                      RC074-DISPLAY-PO                            08776001
087770                      ' RCVR='                                    08777001
087780                      RC074-DISPLAY-RCVR                          08778001
087790                      ' LINE='                                    08779001
087800                      RC074-DISPLAY-LINE                          08780001
087810                      ' SQLCODE'                                  08781001
087820                      RC074-DISPLAY-SQLCODE                       08782001
087830                      DELIMITED BY SIZE                           08783001
087840                                      INTO RC074-CRA-RET-MSG      08784001
087850             STRING   ' RCKUT128-8050-'                           08785001
087860                      ' CALLED BY-'                               08786001
087870                      RC074-CALLING-PROGRAM                       08787001
087880                      DELIMITED BY SIZE                           08788001
087890                                      INTO RC074-ABEND-TEXT       08789001
087900             MOVE '8050-'               TO RC074-CRA-REQ-ID       08790001
087910                                           RC074-ABEND-PARAGRAPH  08791001
087920             PERFORM 9998-RETURN                                  08792001
087930                                                                  08793001
087940         WHEN SQLWARN0 NOT = SPACE                                08794001
087950         WHEN SQLCODE NOT = ZERO                                  08795001
087960              SET  RC074-INVALID-SQL                              08796001
087970                   RC074-ERROR-YES                                08797001
087980                   PS-ERROR-YES         TO  TRUE                  08798001
087990              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08799001
088000              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      08800001
088010              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    08801001
088020              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    08802001
088030              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08803001
088040              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08804001
088050              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08805001
088060             STRING   ' RCKUT128-8050-'                           08806001
088070                      ' CALLED BY-'                               08807001
088080                      RC074-CALLING-PROGRAM                       08808001
088090                      ' PO='                                      08809001
088100                      RC074-DISPLAY-PO                            08810001
088110                      ' RCVR='                                    08811001
088120                      RC074-DISPLAY-RCVR                          08812001
088130                      ' LINE='                                    08813001
088140                      RC074-DISPLAY-LINE                          08814001
088150                      ' SQLCODE'                                  08815001
088160                      RC074-DISPLAY-SQLCODE                       08816001
088170                      DELIMITED BY SIZE                           08817001
088180                                      INTO RC074-CRA-RET-MSG      08818001
088190             STRING   ' RCKUT128-8050-'                           08819001
088200                      ' CALLED BY-'                               08820001
088210                      RC074-CALLING-PROGRAM                       08821001
088220                      DELIMITED BY SIZE                           08822001
088230                                      INTO RC074-ABEND-TEXT       08823001
088240             MOVE '8050-'               TO RC074-CRA-REQ-ID       08824001
088250                                           RC074-ABEND-PARAGRAPH  08825001
088260             PERFORM 9998-RETURN                                  08826001
088270                                                                  08827001
088280     END-EVALUATE.                                                08828001
088290                                                                  08829001
088300******************************************************************08830001
088310*                                                                *08831001
088320*  SUM UNIT QUANTITIES FOR ORDER FROM OUTBOUND DATABASE          *08832001
088330*                                                                *08833001
088340*  NOT VERIFIED - PO-RCVR-LINE-STORE                 NOT P2L/JWL *08834001
088350*            ACTUAL QTY                                          *08835001
088360*                                                                *08836001
088370******************************************************************08837001
088380 8055-SUM-LINE-STR-OTBND-UPC.                                     08838001
088390                                                                  08839001
088400     MOVE ZERO                 TO  RC074-FCSE-ACTL-ITM-QTY.       08840001
088410                                                                  08841001
088420     EXEC SQL                                                     08842001
088430          SELECT                                                  08843001
088440                 SUM(A.SHPD_UNT_QTY)                              08844001
088450          INTO                                                    08845001
088460                :RC074-FCSE-ACTL-ITM-QTY :RC074-NULL-IND          08846001
088470          FROM                                                    08847001
088480                 SUT_OTBND_UPC A                                  08848001
088490                ,SUT_OTBND_CART B                                 08849001
088500          WHERE                                                   08850001
088510                A.TRN_NBR        =  :RC074-PO-NBR                 08851001
088520           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           08852001
088530           AND  A.TRN_LNE_NBR    =  :RC074-LINE-NBR               08853001
088540           AND  B.DEST_LOC_NBR   =  :RC074-STR-NBR                08854001
088550           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               08855001
088560           AND  B.ACTV_IND       =  'Y'                           08856001
088570           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              08857001
088580     END-EXEC.                                                    08858001
088590                                                                  08859001
088600     EVALUATE TRUE                                                08860001
088610         WHEN SQLCODE = ZERO                                      08861001
088620         WHEN SQLCODE = +100                                      08862001
088630         WHEN SQLCODE = -305                                      08863001
088640              CONTINUE                                            08864001
088650         WHEN SQLCODE = -904                                      08865001
088660         WHEN SQLCODE = -911                                      08866001
088670         WHEN SQLCODE = -913                                      08867001
088680              SET  RC074-DATABASE-BUSY                            08868001
088690                   RC074-ERROR-YES                                08869001
088700                   PS-ERROR-YES         TO  TRUE                  08870001
088710              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08871001
088720              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08872001
088730              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08873001
088740              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08874001
088750              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08875001
088760              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08876001
088770              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08877001
088780             STRING   ' RCKUT128-8055-'                           08878001
088790                      ' CALLED BY-'                               08879001
088800                      RC074-CALLING-PROGRAM                       08880001
088810                      ' PO='                                      08881001
088820                      RC074-DISPLAY-PO                            08882001
088830                      ' RCVR='                                    08883001
088840                      RC074-DISPLAY-RCVR                          08884001
088850                      ' LINE='                                    08885001
088860                      RC074-DISPLAY-LINE                          08886001
088870                      ' STR='                                     08887001
088880                      RC074-DISPLAY-STR                           08888001
088890                      ' SQLCODE='                                 08889001
088900                      RC074-DISPLAY-SQLCODE                       08890001
088910                      DELIMITED BY SIZE                           08891001
088920                                      INTO RC074-CRA-RET-MSG      08892001
088930             STRING   ' RCKUT128-8055-'                           08893001
088940                      ' CALLED BY-'                               08894001
088950                      RC074-CALLING-PROGRAM                       08895001
088960                      DELIMITED BY SIZE                           08896001
088970                                      INTO RC074-ABEND-TEXT       08897001
088980             MOVE '8055-'               TO RC074-CRA-REQ-ID       08898001
088990                                           RC074-ABEND-PARAGRAPH  08899001
089000             PERFORM 9998-RETURN                                  08900001
089010                                                                  08901001
089020         WHEN SQLWARN0 NOT = SPACE                                08902001
089030         WHEN SQLCODE NOT = ZERO                                  08903001
089040              SET  RC074-INVALID-SQL                              08904001
089050                   RC074-ERROR-YES                                08905001
089060                   PS-ERROR-YES         TO  TRUE                  08906001
089070              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08907001
089080              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08908001
089090              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08909001
089100              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08910001
089110              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08911001
089120              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08912001
089130              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08913001
089140             STRING   ' RCKUT128-8055-'                           08914001
089150                      ' CALLED BY-'                               08915001
089160                      RC074-CALLING-PROGRAM                       08916001
089170                      ' PO='                                      08917001
089180                      RC074-DISPLAY-PO                            08918001
089190                      ' RCVR='                                    08919001
089200                      RC074-DISPLAY-RCVR                          08920001
089210                      ' LINE='                                    08921001
089220                      RC074-DISPLAY-LINE                          08922001
089230                      ' STR='                                     08923001
089240                      RC074-DISPLAY-STR                           08924001
089250                      ' SQLCODE='                                 08925001
089260                      RC074-DISPLAY-SQLCODE                       08926001
089270                      DELIMITED BY SIZE                           08927001
089280                                      INTO RC074-CRA-RET-MSG      08928001
089290             STRING   ' RCKUT128-8055-'                           08929001
089300                      ' CALLED BY-'                               08930001
089310                      RC074-CALLING-PROGRAM                       08931001
089320                      DELIMITED BY SIZE                           08932001
089330                                      INTO RC074-ABEND-TEXT       08933001
089340             MOVE '8055-'               TO RC074-CRA-REQ-ID       08934001
089350                                           RC074-ABEND-PARAGRAPH  08935001
089360             PERFORM 9998-RETURN                                  08936001
089370                                                                  08937001
089380     END-EVALUATE.                                                08938001
089390                                                                  08939001
089400                                                                  08940001
089410******************************************************************08941001
089420*                                                                *08942001
089430*  SUM P2L ACTUAL UNIT QUANTITIES FROM THE DISTRIBTION DETAIL    *08943001
089440*  DATABASE FOR LINES NOT VERIFIED - RECEIVER LEVEL              *08944001
089450*                                                                *08945001
089460*  NOT VERIFIED - PO-RCVR                                        *08946001
089470*      PACK-TO-LIGHT ACTUAL QUANTITY                             *08947001
089480*                                                                *08948001
089490******************************************************************08949001
089500 8060-SUM-RCVR-P2L-ACTL.                                          08950001
089510                                                                  08951001
089520     MOVE ZERO                 TO  RC074-P2L-ACTL-ITM-QTY.        08952001
089530                                                                  08953001
089540     EXEC SQL                                                     08954001
089550          SELECT                                                  08955001
089560                 SUM(A.ACTL_ALLOC_QTY)                            08956001
089570          INTO                                                    08957001
089580                :RC074-P2L-ACTL-ITM-QTY   :RC074-NULL-IND         08958001
089590          FROM                                                    08959001
089600                 TDISTDT A                                        08960001
089610                ,TRECITM B                                        08961001
089620          WHERE                                                   08962001
089630                A.ORD_NBR         =  :RC074-PO-NBR                08963001
089640           AND  A.RCVR_SEQ_NBR    =  :RC074-RCVR-SEQ-NBR          08964001
089650           AND  A.ORD_NBR         =  B.ORD_NBR                    08965001
089660           AND  A.RCVR_SEQ_NBR    =  B.REC_SEQ_NBR                08966001
089670           AND  A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                08967001
089680           AND  B.STATUS_CDE     <>  'VE'                         08968001
089690           AND  B.VER_STATUS_CDE  =  'A'                          08969001
089700     END-EXEC.                                                    08970001
089710                                                                  08971001
089720     EVALUATE TRUE                                                08972001
089730         WHEN SQLCODE = ZERO                                      08973001
089740         WHEN SQLCODE = +100                                      08974001
089750         WHEN SQLCODE = -305                                      08975001
089760              CONTINUE                                            08976001
089770         WHEN SQLCODE = -904                                      08977001
089780         WHEN SQLCODE = -911                                      08978001
089790         WHEN SQLCODE = -913                                      08979001
089800              SET  RC074-DATABASE-BUSY                            08980001
089810                   RC074-ERROR-YES                                08981001
089820                   PS-ERROR-YES         TO  TRUE                  08982001
089830              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 08983001
089840              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      08984001
089850              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    08985001
089860              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    08986001
089870              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    08987001
089880              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     08988001
089890              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    08989001
089900             STRING   ' RCKUT128-8060-'                           08990001
089910                      ' CALLED BY-'                               08991001
089920                      RC074-CALLING-PROGRAM                       08992001
089930                      ' PO='                                      08993001
089940                      RC074-DISPLAY-PO                            08994001
089950                      ' RCVR='                                    08995001
089960                      RC074-DISPLAY-RCVR                          08996001
089970                      ' SQLCODE='                                 08997001
089980                      RC074-DISPLAY-SQLCODE                       08998001
089990                      DELIMITED BY SIZE                           08999001
090000                                      INTO RC074-CRA-RET-MSG      09000001
090010             STRING   ' RCKUT128-8060-'                           09001001
090020                      ' CALLED BY-'                               09002001
090030                      RC074-CALLING-PROGRAM                       09003001
090040                      DELIMITED BY SIZE                           09004001
090050                                      INTO RC074-ABEND-TEXT       09005001
090060             MOVE '8060-'               TO RC074-CRA-REQ-ID       09006001
090070                                           RC074-ABEND-PARAGRAPH  09007001
090080             PERFORM 9998-RETURN                                  09008001
090090                                                                  09009001
090100         WHEN SQLWARN0 NOT = SPACE                                09010001
090110         WHEN SQLCODE NOT = ZERO                                  09011001
090120              SET  RC074-INVALID-SQL                              09012001
090130                   RC074-ERROR-YES                                09013001
090140                   PS-ERROR-YES         TO  TRUE                  09014001
090150              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09015001
090160              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09016001
090170              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09017001
090180              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09018001
090190              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09019001
090200              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09020001
090210              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09021001
090220             STRING   ' RCKUT128-8060-'                           09022001
090230                      ' CALLED BY-'                               09023001
090240                      RC074-CALLING-PROGRAM                       09024001
090250                      ' PO='                                      09025001
090260                      RC074-DISPLAY-PO                            09026001
090270                      ' RCVR='                                    09027001
090280                      RC074-DISPLAY-RCVR                          09028001
090290                      ' SQLCODE='                                 09029001
090300                      RC074-DISPLAY-SQLCODE                       09030001
090310                      DELIMITED BY SIZE                           09031001
090320                                      INTO RC074-CRA-RET-MSG      09032001
090330             STRING   ' RCKUT128-8060-'                           09033001
090340                      ' CALLED BY-'                               09034001
090350                      RC074-CALLING-PROGRAM                       09035001
090360                      DELIMITED BY SIZE                           09036001
090370                                      INTO RC074-ABEND-TEXT       09037001
090380             MOVE '8060-'               TO RC074-CRA-REQ-ID       09038001
090390                                           RC074-ABEND-PARAGRAPH  09039001
090400             PERFORM 9998-RETURN                                  09040001
090410                                                                  09041001
090420     END-EVALUATE.                                                09042001
090430                                                                  09043001
090440                                                                  09044001
090450******************************************************************09045001
090460*                                                                *09046001
090470*  SUM P2L ACTUAL UNIT QUANTITIES FROM THE DISTRIBTION DETAIL    *09047001
090480*  DATABASE FOR LINES NOT VERIFIED - LINE LEVEL                  *09048001
090490*                                                                *09049001
090500*  NOT VERIFIED - PO-RCVR-LINE                                   *09050001
090510*      PACK-TO-LIGHT ACTUAL QUANTITY                             *09051001
090520*                                                                *09052001
090530******************************************************************09053001
090540 8070-SUM-LINE-P2L-ACTL.                                          09054001
090550                                                                  09055001
090560     MOVE ZERO                 TO  RC074-P2L-ACTL-ITM-QTY.        09056001
090570                                                                  09057001
090580     EXEC SQL                                                     09058001
090590          SELECT                                                  09059001
090600                 SUM(A.ACTL_ALLOC_QTY)                            09060001
090610          INTO                                                    09061001
090620                :RC074-P2L-ACTL-ITM-QTY   :RC074-NULL-IND         09062001
090630          FROM                                                    09063001
090640                 TDISTDT A                                        09064001
090650                ,TRECITM B                                        09065001
090660          WHERE                                                   09066001
090670                A.ORD_NBR         =  :DK-PO-NBR                   09067001
090680           AND  A.RCVR_SEQ_NBR    =  :DK-RCVR-SEQ-NBR             09068001
090690           AND  A.ORD_LNE_NBR     =  :DK-LINE-NBR                 09069001
090700           AND  A.ORD_NBR         =  B.ORD_NBR                    09070001
090710           AND  A.RCVR_SEQ_NBR    =  B.REC_SEQ_NBR                09071001
090720           AND  A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                09072001
090730           AND  B.STATUS_CDE     <>  'VE'                         09073001
090740           AND  B.VER_STATUS_CDE  =  'A'                          09074001
090750     END-EXEC.                                                    09075001
090760                                                                  09076001
090770     EVALUATE TRUE                                                09077001
090780         WHEN SQLCODE = ZERO                                      09078001
090790         WHEN SQLCODE = +100                                      09079001
090800         WHEN SQLCODE = -305                                      09080001
090810              CONTINUE                                            09081001
090820         WHEN SQLCODE = -904                                      09082001
090830         WHEN SQLCODE = -911                                      09083001
090840         WHEN SQLCODE = -913                                      09084001
090850              SET  RC074-DATABASE-BUSY                            09085001
090860                   RC074-ERROR-YES                                09086001
090870                   PS-ERROR-YES         TO  TRUE                  09087001
090880              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09088001
090890              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      09089001
090900              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    09090001
090910              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    09091001
090920              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09092001
090930              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09093001
090940              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09094001
090950             STRING   ' RCKUT128-8070-'                           09095001
090960                      ' CALLED BY-'                               09096001
090970                      RC074-CALLING-PROGRAM                       09097001
090980                      ' PO='                                      09098001
090990                      RC074-DISPLAY-PO                            09099001
091000                      ' RCVR='                                    09100001
091010                      RC074-DISPLAY-RCVR                          09101001
091020                      ' LINE='                                    09102001
091030                      RC074-DISPLAY-LINE                          09103001
091040                      ' SQLCODE='                                 09104001
091050                      RC074-DISPLAY-SQLCODE                       09105001
091060                      DELIMITED BY SIZE                           09106001
091070                                      INTO RC074-CRA-RET-MSG      09107001
091080             STRING   ' RCKUT128-8070-'                           09108001
091090                      ' CALLED BY-'                               09109001
091100                      RC074-CALLING-PROGRAM                       09110001
091110                      DELIMITED BY SIZE                           09111001
091120                                      INTO RC074-ABEND-TEXT       09112001
091130             MOVE '8070-'               TO RC074-CRA-REQ-ID       09113001
091140                                           RC074-ABEND-PARAGRAPH  09114001
091150             PERFORM 9998-RETURN                                  09115001
091160                                                                  09116001
091170         WHEN SQLWARN0 NOT = SPACE                                09117001
091180         WHEN SQLCODE NOT = ZERO                                  09118001
091190              SET  RC074-INVALID-SQL                              09119001
091200                   RC074-ERROR-YES                                09120001
091210                   PS-ERROR-YES         TO  TRUE                  09121001
091220              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09122001
091230              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      09123001
091240              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    09124001
091250              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    09125001
091260              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09126001
091270              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09127001
091280              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09128001
091290             STRING   ' RCKUT128-8070-'                           09129001
091300                      ' CALLED BY-'                               09130001
091310                      RC074-CALLING-PROGRAM                       09131001
091320                      ' PO='                                      09132001
091330                      RC074-DISPLAY-PO                            09133001
091340                      ' RCVR='                                    09134001
091350                      RC074-DISPLAY-RCVR                          09135001
091360                      ' LINE='                                    09136001
091370                      RC074-DISPLAY-LINE                          09137001
091380                      ' SQLCODE='                                 09138001
091390                      RC074-DISPLAY-SQLCODE                       09139001
091400                      DELIMITED BY SIZE                           09140001
091410                                      INTO RC074-CRA-RET-MSG      09141001
091420             STRING   ' RCKUT128-8070-'                           09142001
091430                      ' CALLED BY-'                               09143001
091440                      RC074-CALLING-PROGRAM                       09144001
091450                      DELIMITED BY SIZE                           09145001
091460                                      INTO RC074-ABEND-TEXT       09146001
091470             MOVE '8070-'               TO RC074-CRA-REQ-ID       09147001
091480                                           RC074-ABEND-PARAGRAPH  09148001
091490             PERFORM 9998-RETURN                                  09149001
091500                                                                  09150001
091510     END-EVALUATE.                                                09151001
091520                                                                  09152001
091530******************************************************************09153001
091540*                                                                *09154001
091550*  SUM P2L ACTUAL UNIT QUANTITIES FROM THE DISTRIBTION DETAIL    *09155001
091560*  DATABASE FOR LINES NOT VERIFIED - PO-RCVR-LINE-STR LEVEL      *09156001
091570*                                                                *09157001
091580*  NOT VERIFIED - PO-RCVR-LINE-STORE                             *09158001
091590*      PACK-TO-LIGHT ACTUAL QUANTITY                             *09159001
091600*                                                                *09160001
091610******************************************************************09161001
091620 8075-SUM-LINE-STR-P2L-ACTL.                                      09162001
091630                                                                  09163001
091640     MOVE ZERO                 TO  RC074-P2L-ACTL-ITM-QTY.        09164001
091650                                                                  09165001
091660     EXEC SQL                                                     09166001
091670          SELECT                                                  09167001
091680                 SUM(A.ACTL_ALLOC_QTY)                            09168001
091690          INTO                                                    09169001
091700                :RC074-P2L-ACTL-ITM-QTY   :RC074-NULL-IND         09170001
091710          FROM                                                    09171001
091720                 TDISTDT A                                        09172001
091730                ,TRECITM B                                        09173001
091740          WHERE                                                   09174001
091750                A.ORD_NBR         =  :DK-PO-NBR                   09175001
091760           AND  A.RCVR_SEQ_NBR    =  :DK-RCVR-SEQ-NBR             09176001
091770           AND  A.ORD_LNE_NBR     =  :DK-LINE-NBR                 09177001
091780           AND  A.STR_NBR         =  :DK-STR-NBR                  09178001
091790           AND  A.ORD_NBR         =  B.ORD_NBR                    09179001
091800           AND  A.RCVR_SEQ_NBR    =  B.REC_SEQ_NBR                09180001
091810           AND  A.ORD_LNE_NBR     =  B.ORD_LNE_NBR                09181001
091820           AND  B.STATUS_CDE     <>  'VE'                         09182001
091830           AND  B.VER_STATUS_CDE  =  'A'                          09183001
091840     END-EXEC.                                                    09184001
091850                                                                  09185001
091860     EVALUATE TRUE                                                09186001
091870         WHEN SQLCODE = ZERO                                      09187001
091880         WHEN SQLCODE = +100                                      09188001
091890         WHEN SQLCODE = -305                                      09189001
091900              CONTINUE                                            09190001
091910         WHEN SQLCODE = -904                                      09191001
091920         WHEN SQLCODE = -911                                      09192001
091930         WHEN SQLCODE = -913                                      09193001
091940              SET  RC074-DATABASE-BUSY                            09194001
091950                   RC074-ERROR-YES                                09195001
091960                   PS-ERROR-YES         TO  TRUE                  09196001
091970              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09197001
091980              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      09198001
091990              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    09199001
092000              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    09200001
092010              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09201001
092020              MOVE DK-STR-NBR           TO  RC074-DISPLAY-STR     09202001
092030              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09203001
092040             STRING   ' RCKUT128-8075-'                           09204001
092050                      ' CALLED BY-'                               09205001
092060                      RC074-CALLING-PROGRAM                       09206001
092070                      ' PO='                                      09207001
092080                      RC074-DISPLAY-PO                            09208001
092090                      ' RCVR='                                    09209001
092100                      RC074-DISPLAY-RCVR                          09210001
092110                      ' LINE='                                    09211001
092120                      RC074-DISPLAY-LINE                          09212001
092130                      ' STR='                                     09213001
092140                      RC074-DISPLAY-STR                           09214001
092150                      ' SQLCODE='                                 09215001
092160                      RC074-DISPLAY-SQLCODE                       09216001
092170                      DELIMITED BY SIZE                           09217001
092180                                      INTO RC074-CRA-RET-MSG      09218001
092190             STRING   ' RCKUT128-8075-'                           09219001
092200                      ' CALLED BY-'                               09220001
092210                      RC074-CALLING-PROGRAM                       09221001
092220                      DELIMITED BY SIZE                           09222001
092230                                      INTO RC074-ABEND-TEXT       09223001
092240             MOVE '8075-'               TO RC074-CRA-REQ-ID       09224001
092250                                           RC074-ABEND-PARAGRAPH  09225001
092260             PERFORM 9998-RETURN                                  09226001
092270                                                                  09227001
092280         WHEN SQLWARN0 NOT = SPACE                                09228001
092290         WHEN SQLCODE NOT = ZERO                                  09229001
092300              SET  RC074-INVALID-SQL                              09230001
092310                   RC074-ERROR-YES                                09231001
092320                   PS-ERROR-YES         TO  TRUE                  09232001
092330              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09233001
092340              MOVE DK-PO-NBR            TO  RC074-DISPLAY-PO      09234001
092350              MOVE DK-RCVR-SEQ-NBR      TO  RC074-DISPLAY-RCVR    09235001
092360              MOVE DK-LINE-NBR          TO  RC074-DISPLAY-LINE    09236001
092370              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09237001
092380              MOVE DK-STR-NBR           TO  RC074-DISPLAY-STR     09238001
092390              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09239001
092400             STRING   ' RCKUT128-8075-'                           09240001
092410                      ' CALLED BY-'                               09241001
092420                      RC074-CALLING-PROGRAM                       09242001
092430                      ' PO='                                      09243001
092440                      RC074-DISPLAY-PO                            09244001
092450                      ' RCVR='                                    09245001
092460                      RC074-DISPLAY-RCVR                          09246001
092470                      ' LINE='                                    09247001
092480                      RC074-DISPLAY-LINE                          09248001
092490                      ' STR='                                     09249001
092500                      RC074-DISPLAY-STR                           09250001
092510                      ' SQLCODE='                                 09251001
092520                      RC074-DISPLAY-SQLCODE                       09252001
092530                      DELIMITED BY SIZE                           09253001
092540                                      INTO RC074-CRA-RET-MSG      09254001
092550             STRING   ' RCKUT128-8075-'                           09255001
092560                      ' CALLED BY-'                               09256001
092570                      RC074-CALLING-PROGRAM                       09257001
092580                      DELIMITED BY SIZE                           09258001
092590                                      INTO RC074-ABEND-TEXT       09259001
092600             MOVE '8075-'               TO RC074-CRA-REQ-ID       09260001
092610                                           RC074-ABEND-PARAGRAPH  09261001
092620             PERFORM 9998-RETURN                                  09262001
092630                                                                  09263001
092640     END-EVALUATE.                                                09264001
092650                                                                  09265001
092660                                                                  09266001
092670******************************************************************09267001
092680*                                                                *09268001
092690*  COUNT OUTBOUND CARTON FOR A SPECIFIC PO-RCVR-LINE - NOT P2L   *09269001
092700*                                                                *09270001
092710******************************************************************09271001
092720 8100-CNT-LNE-OTBND-FCSE.                                         09272001
092730                                                                  09273001
092740     MOVE ZERO                 TO  RC074-FCSE-ACTL-OTBND-CNT.     09274001
092750                                                                  09275001
092760     EXEC SQL                                                     09276001
092770          SELECT                                                  09277001
092780                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  09278001
092790          INTO                                                    09279001
092800                :RC074-FCSE-ACTL-OTBND-CNT                        09280001
092810          FROM                                                    09281001
092820                 SUT_OTBND_UPC A                                  09282001
092830                ,SUT_OTBND_CART B                                 09283001
092840          WHERE                                                   09284001
092850                A.TRN_NBR        =  :RC074-PO-NBR                 09285001
092860           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           09286001
092870           AND  A.TRN_LNE_NBR    =  :RC074-LINE-NBR               09287001
092880           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               09288001
092890           AND  B.ACTV_IND       =  'Y'                           09289001
092900           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              09290001
092910     END-EXEC.                                                    09291001
092920                                                                  09292001
092930     EVALUATE TRUE                                                09293001
092940         WHEN SQLCODE = ZERO                                      09294001
092950         WHEN SQLCODE = +100                                      09295001
092960         WHEN SQLCODE = -305                                      09296001
092970              CONTINUE                                            09297001
092980         WHEN SQLCODE = -904                                      09298001
092990         WHEN SQLCODE = -911                                      09299001
093000         WHEN SQLCODE = -913                                      09300001
093010              SET  RC074-DATABASE-BUSY                            09301001
093020                   RC074-ERROR-YES                                09302001
093030                   PS-ERROR-YES         TO  TRUE                  09303001
093040              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09304001
093050              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09305001
093060              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09306001
093070              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09307001
093080              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09308001
093090              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09309001
093100              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09310001
093110             STRING   ' RCKUT128-8100-'                           09311001
093120                      ' CALLED BY-'                               09312001
093130                      RC074-CALLING-PROGRAM                       09313001
093140                      ' PO='                                      09314001
093150                      RC074-DISPLAY-PO                            09315001
093160                      ' RCVR='                                    09316001
093170                      RC074-DISPLAY-RCVR                          09317001
093180                      ' LINE='                                    09318001
093190                      RC074-DISPLAY-LINE                          09319001
093200                      ' SQLCODE='                                 09320001
093210                      RC074-DISPLAY-SQLCODE                       09321001
093220                      DELIMITED BY SIZE                           09322001
093230                                      INTO RC074-CRA-RET-MSG      09323001
093240             STRING   ' RCKUT128-8100-'                           09324001
093250                      ' CALLED BY-'                               09325001
093260                      RC074-CALLING-PROGRAM                       09326001
093270                      DELIMITED BY SIZE                           09327001
093280                                      INTO RC074-ABEND-TEXT       09328001
093290             MOVE '8100-'               TO RC074-CRA-REQ-ID       09329001
093300                                           RC074-ABEND-PARAGRAPH  09330001
093310             PERFORM 9998-RETURN                                  09331001
093320                                                                  09332001
093330         WHEN SQLWARN0 NOT = SPACE                                09333001
093340         WHEN SQLCODE NOT = ZERO                                  09334001
093350              SET  RC074-INVALID-SQL                              09335001
093360                   RC074-ERROR-YES                                09336001
093370                   PS-ERROR-YES         TO  TRUE                  09337001
093380              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09338001
093390              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09339001
093400              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09340001
093410              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09341001
093420              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09342001
093430              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09343001
093440              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09344001
093450             STRING   ' RCKUT128-8100-'                           09345001
093460                      ' CALLED BY-'                               09346001
093470                      RC074-CALLING-PROGRAM                       09347001
093480                      ' PO='                                      09348001
093490                      RC074-DISPLAY-PO                            09349001
093500                      ' RCVR='                                    09350001
093510                      RC074-DISPLAY-RCVR                          09351001
093520                      ' LINE='                                    09352001
093530                      RC074-DISPLAY-LINE                          09353001
093540                      ' SQLCODE='                                 09354001
093550                      RC074-DISPLAY-SQLCODE                       09355001
093560                      DELIMITED BY SIZE                           09356001
093570                                      INTO RC074-CRA-RET-MSG      09357001
093580             STRING   ' RCKUT128-8100-'                           09358001
093590                      ' CALLED BY-'                               09359001
093600                      RC074-CALLING-PROGRAM                       09360001
093610                      DELIMITED BY SIZE                           09361001
093620                                      INTO RC074-ABEND-TEXT       09362001
093630             MOVE '8100-'               TO RC074-CRA-REQ-ID       09363001
093640                                           RC074-ABEND-PARAGRAPH  09364001
093650             PERFORM 9998-RETURN                                  09365001
093660                                                                  09366001
093670     END-EVALUATE.                                                09367001
093680                                                                  09368001
093690                                                                  09369001
093700******************************************************************09370001
093710*                                                                *09371001
093720*  COUNT OUTBOUND P2L CARTONS FOR SPECIFIC PO-RCVR-LINE          *09372001
093730*                                                                *09373001
093740******************************************************************09374001
093750 8110-CNT-LNE-OTBND-P2L.                                          09375001
093760                                                                  09376001
093770     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      09377001
093780                                                                  09378001
093790     EXEC SQL                                                     09379001
093800          SELECT                                                  09380001
093810                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  09381001
093820          INTO                                                    09382001
093830                :RC074-P2L-ACTL-OTBND-CNT                         09383001
093840          FROM                                                    09384001
093850                 SUT_OTBND_UPC A                                  09385001
093860                ,SUT_OTBND_CART B                                 09386001
093870          WHERE                                                   09387001
093880                A.TRN_NBR        =  :RC074-PO-NBR                 09388001
093890           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           09389001
093900           AND  A.TRN_LNE_NBR    =  :RC074-LINE-NBR               09390001
093910           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               09391001
093920           AND  B.ACTV_IND       =  'Y'                           09392001
093930           AND  B.CART_SRC_CDE  IN ('P2L','JWL')                  09393001
093940     END-EXEC.                                                    09394001
093950                                                                  09395001
093960     EVALUATE TRUE                                                09396001
093970         WHEN SQLCODE = ZERO                                      09397001
093980         WHEN SQLCODE = +100                                      09398001
093990         WHEN SQLCODE = -305                                      09399001
094000              CONTINUE                                            09400001
094010         WHEN SQLCODE = -904                                      09401001
094020         WHEN SQLCODE = -911                                      09402001
094030         WHEN SQLCODE = -913                                      09403001
094040              SET  RC074-DATABASE-BUSY                            09404001
094050                   RC074-ERROR-YES                                09405001
094060                   PS-ERROR-YES         TO  TRUE                  09406001
094070              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09407001
094080              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09408001
094090              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09409001
094100              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09410001
094110              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09411001
094120              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09412001
094130              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09413001
094140             STRING   ' RCKUT128-8110-'                           09414001
094150                      ' CALLED BY-'                               09415001
094160                      RC074-CALLING-PROGRAM                       09416001
094170                      ' PO='                                      09417001
094180                      RC074-DISPLAY-PO                            09418001
094190                      ' RCVR='                                    09419001
094200                      RC074-DISPLAY-RCVR                          09420001
094210                      ' LINE='                                    09421001
094220                      RC074-DISPLAY-LINE                          09422001
094230                      ' SQLCODE='                                 09423001
094240                      RC074-DISPLAY-SQLCODE                       09424001
094250                      DELIMITED BY SIZE                           09425001
094260                                      INTO RC074-CRA-RET-MSG      09426001
094270             STRING   ' RCKUT128-8110-'                           09427001
094280                      ' CALLED BY-'                               09428001
094290                      RC074-CALLING-PROGRAM                       09429001
094300                      DELIMITED BY SIZE                           09430001
094310                                      INTO RC074-ABEND-TEXT       09431001
094320             MOVE '8110-'               TO RC074-CRA-REQ-ID       09432001
094330                                           RC074-ABEND-PARAGRAPH  09433001
094340             PERFORM 9998-RETURN                                  09434001
094350                                                                  09435001
094360         WHEN SQLWARN0 NOT = SPACE                                09436001
094370         WHEN SQLCODE NOT = ZERO                                  09437001
094380              SET  RC074-INVALID-SQL                              09438001
094390                   RC074-ERROR-YES                                09439001
094400                   PS-ERROR-YES         TO  TRUE                  09440001
094410              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09441001
094420              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09442001
094430              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09443001
094440              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09444001
094450              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09445001
094460              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09446001
094470              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09447001
094480             STRING   ' RCKUT128-8110-'                           09448001
094490                      ' CALLED BY-'                               09449001
094500                      RC074-CALLING-PROGRAM                       09450001
094510                      ' PO='                                      09451001
094520                      RC074-DISPLAY-PO                            09452001
094530                      ' RCVR='                                    09453001
094540                      RC074-DISPLAY-RCVR                          09454001
094550                      ' LINE='                                    09455001
094560                      RC074-DISPLAY-LINE                          09456001
094570                      ' SQLCODE='                                 09457001
094580                      RC074-DISPLAY-SQLCODE                       09458001
094590                      DELIMITED BY SIZE                           09459001
094600                                      INTO RC074-CRA-RET-MSG      09460001
094610             STRING   ' RCKUT128-8110-'                           09461001
094620                      ' CALLED BY-'                               09462001
094630                      RC074-CALLING-PROGRAM                       09463001
094640                      DELIMITED BY SIZE                           09464001
094650                                      INTO RC074-ABEND-TEXT       09465001
094660             MOVE '8110-'               TO RC074-CRA-REQ-ID       09466001
094670                                           RC074-ABEND-PARAGRAPH  09467001
094680             PERFORM 9998-RETURN                                  09468001
094690                                                                  09469001
094700     END-EVALUATE.                                                09470001
094710                                                                  09471001
094720                                                                  09472001
094730******************************************************************09473001
094740*                                                                *09474001
094750*  COUNT OUTBOUND CARTON FOR A SPECIFIC PO-RCVR-LINE-STORE       *09475001
094760*  NOT P2L                                                       *09476001
094770******************************************************************09477001
094780 8120-CNT-LNE-STR-OTB-FCSE.                                       09478001
094790                                                                  09479001
094800     MOVE ZERO                 TO  RC074-FCSE-ACTL-OTBND-CNT.     09480001
094810                                                                  09481001
094820     EXEC SQL                                                     09482001
094830          SELECT                                                  09483001
094840                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  09484001
094850          INTO                                                    09485001
094860                :RC074-FCSE-ACTL-OTBND-CNT                        09486001
094870          FROM                                                    09487001
094880                 SUT_OTBND_UPC A                                  09488001
094890                ,SUT_OTBND_CART B                                 09489001
094900          WHERE                                                   09490001
094910                A.TRN_NBR        =  :RC074-PO-NBR                 09491001
094920           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           09492001
094930           AND  A.TRN_LNE_NBR    =  :RC074-LINE-NBR               09493001
094940           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               09494001
094950           AND  B.DEST_LOC_NBR   =  :RC074-STR-NBR                09495001
094960           AND  B.ACTV_IND       =  'Y'                           09496001
094970           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              09497001
094980     END-EXEC.                                                    09498001
094990                                                                  09499001
095000     EVALUATE TRUE                                                09500001
095010         WHEN SQLCODE = ZERO                                      09501001
095020         WHEN SQLCODE = +100                                      09502001
095030         WHEN SQLCODE = -305                                      09503001
095040              CONTINUE                                            09504001
095050         WHEN SQLCODE = -904                                      09505001
095060         WHEN SQLCODE = -911                                      09506001
095070         WHEN SQLCODE = -913                                      09507001
095080              SET  RC074-DATABASE-BUSY                            09508001
095090                   RC074-ERROR-YES                                09509001
095100                   PS-ERROR-YES         TO  TRUE                  09510001
095110              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09511001
095120              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09512001
095130              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09513001
095140              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09514001
095150              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09515001
095160              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09516001
095170              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09517001
095180             STRING   ' RCKUT128-8120-'                           09518001
095190                      ' CALLED BY-'                               09519001
095200                      RC074-CALLING-PROGRAM                       09520001
095210                      ' PO='                                      09521001
095220                      RC074-DISPLAY-PO                            09522001
095230                      ' RCVR='                                    09523001
095240                      RC074-DISPLAY-RCVR                          09524001
095250                      ' LINE='                                    09525001
095260                      RC074-DISPLAY-LINE                          09526001
095270                      ' STR='                                     09527001
095280                      RC074-DISPLAY-STR                           09528001
095290                      ' SQLCODE='                                 09529001
095300                      RC074-DISPLAY-SQLCODE                       09530001
095310                      DELIMITED BY SIZE                           09531001
095320                                      INTO RC074-CRA-RET-MSG      09532001
095330             STRING   ' RCKUT128-8120-'                           09533001
095340                      ' CALLED BY-'                               09534001
095350                      RC074-CALLING-PROGRAM                       09535001
095360                      DELIMITED BY SIZE                           09536001
095370                                      INTO RC074-ABEND-TEXT       09537001
095380             MOVE '8120-'               TO RC074-CRA-REQ-ID       09538001
095390                                           RC074-ABEND-PARAGRAPH  09539001
095400             PERFORM 9998-RETURN                                  09540001
095410                                                                  09541001
095420         WHEN SQLWARN0 NOT = SPACE                                09542001
095430         WHEN SQLCODE NOT = ZERO                                  09543001
095440              SET  RC074-INVALID-SQL                              09544001
095450                   RC074-ERROR-YES                                09545001
095460                   PS-ERROR-YES         TO  TRUE                  09546001
095470              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09547001
095480              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09548001
095490              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09549001
095500              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09550001
095510              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09551001
095520              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09552001
095530              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09553001
095540             STRING   ' RCKUT128-8120-'                           09554001
095550                      ' CALLED BY-'                               09555001
095560                      RC074-CALLING-PROGRAM                       09556001
095570                      ' PO='                                      09557001
095580                      RC074-DISPLAY-PO                            09558001
095590                      ' RCVR='                                    09559001
095600                      RC074-DISPLAY-RCVR                          09560001
095610                      ' LINE='                                    09561001
095620                      RC074-DISPLAY-LINE                          09562001
095630                      ' STR='                                     09563001
095640                      RC074-DISPLAY-STR                           09564001
095650                      ' SQLCODE='                                 09565001
095660                      RC074-DISPLAY-SQLCODE                       09566001
095670                      DELIMITED BY SIZE                           09567001
095680                                      INTO RC074-CRA-RET-MSG      09568001
095690             STRING   ' RCKUT128-8120-'                           09569001
095700                      ' CALLED BY-'                               09570001
095710                      RC074-CALLING-PROGRAM                       09571001
095720                      DELIMITED BY SIZE                           09572001
095730                                      INTO RC074-ABEND-TEXT       09573001
095740             MOVE '8120-'               TO RC074-CRA-REQ-ID       09574001
095750                                           RC074-ABEND-PARAGRAPH  09575001
095760             PERFORM 9998-RETURN                                  09576001
095770                                                                  09577001
095780     END-EVALUATE.                                                09578001
095790                                                                  09579001
095800                                                                  09580001
095810******************************************************************09581001
095820*                                                                *09582001
095830*  COUNT OUTBOUND P2L CARTONS FOR SPECIFIC PO-RCVR-LINE-STR      *09583001
095840*                                                                *09584001
095850******************************************************************09585001
095860 8130-CNT-LNE-STR-OTBD-P2L.                                       09586001
095870                                                                  09587001
095880     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      09588001
095890                                                                  09589001
095900     EXEC SQL                                                     09590001
095910          SELECT                                                  09591001
095920                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  09592001
095930          INTO                                                    09593001
095940                :RC074-P2L-ACTL-OTBND-CNT                         09594001
095950          FROM                                                    09595001
095960                 SUT_OTBND_UPC A                                  09596001
095970                ,SUT_OTBND_CART B                                 09597001
095980          WHERE                                                   09598001
095990                A.TRN_NBR        =  :RC074-PO-NBR                 09599001
096000           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           09600001
096010           AND  A.TRN_LNE_NBR    =  :RC074-LINE-NBR               09601001
096020           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               09602001
096030           AND  B.DEST_LOC_NBR   =  :RC074-STR-NBR                09603001
096040           AND  B.ACTV_IND       =  'Y'                           09604001
096050           AND  B.CART_SRC_CDE  IN ('P2L','JWL')                  09605001
096060     END-EXEC.                                                    09606001
096070                                                                  09607001
096080     EVALUATE TRUE                                                09608001
096090         WHEN SQLCODE = ZERO                                      09609001
096100         WHEN SQLCODE = +100                                      09610001
096110         WHEN SQLCODE = -305                                      09611001
096120              CONTINUE                                            09612001
096130         WHEN SQLCODE = -904                                      09613001
096140         WHEN SQLCODE = -911                                      09614001
096150         WHEN SQLCODE = -913                                      09615001
096160              SET  RC074-DATABASE-BUSY                            09616001
096170                   RC074-ERROR-YES                                09617001
096180                   PS-ERROR-YES         TO  TRUE                  09618001
096190              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09619001
096200              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09620001
096210              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09621001
096220              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09622001
096230              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09623001
096240              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09624001
096250              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09625001
096260             STRING   ' RCKUT128-8130-'                           09626001
096270                      ' CALLED BY-'                               09627001
096280                      RC074-CALLING-PROGRAM                       09628001
096290                      ' PO='                                      09629001
096300                      RC074-DISPLAY-PO                            09630001
096310                      ' RCVR='                                    09631001
096320                      RC074-DISPLAY-RCVR                          09632001
096330                      ' LINE='                                    09633001
096340                      RC074-DISPLAY-LINE                          09634001
096350                      ' STR='                                     09635001
096360                      RC074-DISPLAY-STR                           09636001
096370                      ' SQLCODE='                                 09637001
096380                      RC074-DISPLAY-SQLCODE                       09638001
096390                      DELIMITED BY SIZE                           09639001
096400                                      INTO RC074-CRA-RET-MSG      09640001
096410             STRING   ' RCKUT128-8130-'                           09641001
096420                      ' CALLED BY-'                               09642001
096430                      RC074-CALLING-PROGRAM                       09643001
096440                      DELIMITED BY SIZE                           09644001
096450                                      INTO RC074-ABEND-TEXT       09645001
096460             MOVE '8130-'               TO RC074-CRA-REQ-ID       09646001
096470                                           RC074-ABEND-PARAGRAPH  09647001
096480             PERFORM 9998-RETURN                                  09648001
096490                                                                  09649001
096500         WHEN SQLWARN0 NOT = SPACE                                09650001
096510         WHEN SQLCODE NOT = ZERO                                  09651001
096520              SET  RC074-INVALID-SQL                              09652001
096530                   RC074-ERROR-YES                                09653001
096540                   PS-ERROR-YES         TO  TRUE                  09654001
096550              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09655001
096560              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09656001
096570              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09657001
096580              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09658001
096590              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09659001
096600              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09660001
096610              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09661001
096620             STRING   ' RCKUT128-8130-'                           09662001
096630                      ' CALLED BY-'                               09663001
096640                      RC074-CALLING-PROGRAM                       09664001
096650                      ' PO='                                      09665001
096660                      RC074-DISPLAY-PO                            09666001
096670                      ' RCVR='                                    09667001
096680                      RC074-DISPLAY-RCVR                          09668001
096690                      ' LINE='                                    09669001
096700                      RC074-DISPLAY-LINE                          09670001
096710                      ' STR='                                     09671001
096720                      RC074-DISPLAY-STR                           09672001
096730                      ' SQLCODE='                                 09673001
096740                      RC074-DISPLAY-SQLCODE                       09674001
096750                      DELIMITED BY SIZE                           09675001
096760                                      INTO RC074-CRA-RET-MSG      09676001
096770             STRING   ' RCKUT128-8130-'                           09677001
096780                      ' CALLED BY-'                               09678001
096790                      RC074-CALLING-PROGRAM                       09679001
096800                      DELIMITED BY SIZE                           09680001
096810                                      INTO RC074-ABEND-TEXT       09681001
096820             MOVE '8130-'               TO RC074-CRA-REQ-ID       09682001
096830                                           RC074-ABEND-PARAGRAPH  09683001
096840             PERFORM 9998-RETURN                                  09684001
096850                                                                  09685001
096860     END-EVALUATE.                                                09686001
096870                                                                  09687001
096880                                                                  09688001
096890******************************************************************09689001
096900*                                                                *09690001
096910*  COUNT OUTBOUND CARTON FOR A SPECIFIC PO-RCVR                  *09691001
096920*                                                                *09692001
096930******************************************************************09693001
096940 8140-CNT-RCVR-OTBND-FCSE.                                        09694001
096950                                                                  09695001
096960     MOVE ZERO                 TO  RC074-FCSE-ACTL-OTBND-CNT.     09696001
096970                                                                  09697001
096980     EXEC SQL                                                     09698001
096990          SELECT                                                  09699001
097000                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  09700001
097010          INTO                                                    09701001
097020                :RC074-FCSE-ACTL-OTBND-CNT                        09702001
097030          FROM                                                    09703001
097040                 SUT_OTBND_UPC A                                  09704001
097050                ,SUT_OTBND_CART B                                 09705001
097060          WHERE                                                   09706001
097070                A.TRN_NBR        =  :RC074-PO-NBR                 09707001
097080           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           09708001
097090           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               09709001
097100           AND  B.ACTV_IND       =  'Y'                           09710001
097110           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              09711001
097120     END-EXEC.                                                    09712001
097130                                                                  09713001
097140     EVALUATE TRUE                                                09714001
097150         WHEN SQLCODE = ZERO                                      09715001
097160         WHEN SQLCODE = +100                                      09716001
097170         WHEN SQLCODE = -305                                      09717001
097180              CONTINUE                                            09718001
097190         WHEN SQLCODE = -904                                      09719001
097200         WHEN SQLCODE = -911                                      09720001
097210         WHEN SQLCODE = -913                                      09721001
097220              SET  RC074-DATABASE-BUSY                            09722001
097230                   RC074-ERROR-YES                                09723001
097240                   PS-ERROR-YES         TO  TRUE                  09724001
097250              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09725001
097260              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09726001
097270              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09727001
097280             STRING   ' RCKUT128-8140-'                           09728001
097290                      ' CALLED BY-'                               09729001
097300                      RC074-CALLING-PROGRAM                       09730001
097310                      ' PO='                                      09731001
097320                      RC074-DISPLAY-PO                            09732001
097330                      ' RCVR='                                    09733001
097340                      RC074-DISPLAY-RCVR                          09734001
097350                      ' SQLCODE='                                 09735001
097360                      RC074-DISPLAY-SQLCODE                       09736001
097370                      DELIMITED BY SIZE                           09737001
097380                                      INTO RC074-CRA-RET-MSG      09738001
097390             STRING   ' RCKUT128-8140-'                           09739001
097400                      ' CALLED BY-'                               09740001
097410                      RC074-CALLING-PROGRAM                       09741001
097420                      DELIMITED BY SIZE                           09742001
097430                                      INTO RC074-ABEND-TEXT       09743001
097440             MOVE '8140-'               TO RC074-CRA-REQ-ID       09744001
097450                                           RC074-ABEND-PARAGRAPH  09745001
097460             PERFORM 9998-RETURN                                  09746001
097470                                                                  09747001
097480         WHEN SQLWARN0 NOT = SPACE                                09748001
097490         WHEN SQLCODE NOT = ZERO                                  09749001
097500              SET  RC074-INVALID-SQL                              09750001
097510                   RC074-ERROR-YES                                09751001
097520                   PS-ERROR-YES         TO  TRUE                  09752001
097530              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09753001
097540              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09754001
097550              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09755001
097560             STRING   ' RCKUT128-8140-'                           09756001
097570                      ' CALLED BY-'                               09757001
097580                      RC074-CALLING-PROGRAM                       09758001
097590                      ' PO='                                      09759001
097600                      RC074-DISPLAY-PO                            09760001
097610                      ' RCVR='                                    09761001
097620                      RC074-DISPLAY-RCVR                          09762001
097630                      ' SQLCODE='                                 09763001
097640                      RC074-DISPLAY-SQLCODE                       09764001
097650                      DELIMITED BY SIZE                           09765001
097660                                      INTO RC074-CRA-RET-MSG      09766001
097670             STRING   ' RCKUT128-8140-'                           09767001
097680                      ' CALLED BY-'                               09768001
097690                      RC074-CALLING-PROGRAM                       09769001
097700                      DELIMITED BY SIZE                           09770001
097710                                      INTO RC074-ABEND-TEXT       09771001
097720             MOVE '8140-'               TO RC074-CRA-REQ-ID       09772001
097730                                           RC074-ABEND-PARAGRAPH  09773001
097740             PERFORM 9998-RETURN                                  09774001
097750                                                                  09775001
097760     END-EVALUATE.                                                09776001
097770                                                                  09777001
097780                                                                  09778001
097790                                                                  09779001
097800                                                                  09780001
097810******************************************************************09781001
097820*                                                                *09782001
097830*  COUNT OUTBOUND P2L CARTONS FOR SPECIFIC PO-RCVR               *09783001
097840*                                                                *09784001
097850******************************************************************09785001
097860 8150-CNT-RCVR-OTBND-P2L.                                         09786001
097870                                                                  09787001
097880     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      09788001
097890                                                                  09789001
097900     EXEC SQL                                                     09790001
097910          SELECT                                                  09791001
097920                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  09792001
097930          INTO                                                    09793001
097940                :RC074-P2L-ACTL-OTBND-CNT                         09794001
097950          FROM                                                    09795001
097960                 SUT_OTBND_UPC A                                  09796001
097970                ,SUT_OTBND_CART B                                 09797001
097980          WHERE                                                   09798001
097990                A.TRN_NBR        =  :RC074-PO-NBR                 09799001
098000           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           09800001
098010           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               09801001
098020           AND  B.ACTV_IND       =  'Y'                           09802001
098030           AND  B.CART_SRC_CDE  IN ('P2L','JWL')                  09803001
098040     END-EXEC.                                                    09804001
098050                                                                  09805001
098060     EVALUATE TRUE                                                09806001
098070         WHEN SQLCODE = ZERO                                      09807001
098080         WHEN SQLCODE = +100                                      09808001
098090         WHEN SQLCODE = -305                                      09809001
098100              CONTINUE                                            09810001
098110         WHEN SQLCODE = -904                                      09811001
098120         WHEN SQLCODE = -911                                      09812001
098130         WHEN SQLCODE = -913                                      09813001
098140              SET  RC074-DATABASE-BUSY                            09814001
098150                   RC074-ERROR-YES                                09815001
098160                   PS-ERROR-YES         TO  TRUE                  09816001
098170              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09817001
098180              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09818001
098190              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09819001
098200             STRING   ' RCKUT128-8150-'                           09820001
098210                      ' CALLED BY-'                               09821001
098220                      RC074-CALLING-PROGRAM                       09822001
098230                      ' PO='                                      09823001
098240                      RC074-DISPLAY-PO                            09824001
098250                      ' RCVR='                                    09825001
098260                      RC074-DISPLAY-RCVR                          09826001
098270                      ' SQLCODE='                                 09827001
098280                      RC074-DISPLAY-SQLCODE                       09828001
098290                      DELIMITED BY SIZE                           09829001
098300                                      INTO RC074-CRA-RET-MSG      09830001
098310             STRING   ' RCKUT128-8150-'                           09831001
098320                      ' CALLED BY-'                               09832001
098330                      RC074-CALLING-PROGRAM                       09833001
098340                      DELIMITED BY SIZE                           09834001
098350                                      INTO RC074-ABEND-TEXT       09835001
098360             MOVE '8150-'               TO RC074-CRA-REQ-ID       09836001
098370                                           RC074-ABEND-PARAGRAPH  09837001
098380             PERFORM 9998-RETURN                                  09838001
098390                                                                  09839001
098400         WHEN SQLWARN0 NOT = SPACE                                09840001
098410         WHEN SQLCODE NOT = ZERO                                  09841001
098420              SET  RC074-INVALID-SQL                              09842001
098430                   RC074-ERROR-YES                                09843001
098440                   PS-ERROR-YES         TO  TRUE                  09844001
098450              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09845001
098460              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09846001
098470              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09847001
098480             STRING   ' RCKUT128-8150-'                           09848001
098490                      ' CALLED BY-'                               09849001
098500                      RC074-CALLING-PROGRAM                       09850001
098510                      ' PO='                                      09851001
098520                      RC074-DISPLAY-PO                            09852001
098530                      ' RCVR='                                    09853001
098540                      RC074-DISPLAY-RCVR                          09854001
098550                      ' SQLCODE='                                 09855001
098560                      RC074-DISPLAY-SQLCODE                       09856001
098570                      DELIMITED BY SIZE                           09857001
098580                                      INTO RC074-CRA-RET-MSG      09858001
098590             STRING   ' RCKUT128-8150-'                           09859001
098600                      ' CALLED BY-'                               09860001
098610                      RC074-CALLING-PROGRAM                       09861001
098620                      DELIMITED BY SIZE                           09862001
098630                                      INTO RC074-ABEND-TEXT       09863001
098640             MOVE '8150-'               TO RC074-CRA-REQ-ID       09864001
098650                                           RC074-ABEND-PARAGRAPH  09865001
098660             PERFORM 9998-RETURN                                  09866001
098670                                                                  09867001
098680     END-EVALUATE.                                                09868001
098690                                                                  09869001
098700 8160-CNT-LNE-OTBND-FCSE.                                         09870001
098710                                                                  09871001
098720     MOVE ZERO                 TO  RC074-FCSE-ACTL-OTBND-CNT.     09872001
098730                                                                  09873001
098740     EXEC SQL                                                     09874001
098750          SELECT                                                  09875001
098760                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  09876001
098770          INTO                                                    09877001
098780                :RC074-FCSE-ACTL-OTBND-CNT                        09878001
098790          FROM                                                    09879001
098800                 SUT_OTBND_UPC A                                  09880001
098810              ,  SUT_OTBND_CART B                                 09881001
098820              ,  TRECITM  C                                       09882001
098830          WHERE                                                   09883001
098840                A.TRN_NBR        =  :RC074-PO-NBR                 09884001
098850           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           09885001
098860           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               09886001
098870           AND  B.ACTV_IND       =  'Y'                           09887001
098880           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              09888001
098890           AND  A.TRN_NBR        =   C.ORD_NBR                    09889001
098900           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                09890001
098910           AND  A.TRN_LNE_NBR    =   C.ORD_LNE_NBR                09891001
098920           AND  C.VER_STATUS_CDE =  'A'                           09892001
098930           AND  C.PREPK_ID       =  :RC074-PACK-ID                09893001
098940     END-EXEC.                                                    09894001
098950                                                                  09895001
098960     EVALUATE TRUE                                                09896001
098970         WHEN SQLCODE = ZERO                                      09897001
098980         WHEN SQLCODE = +100                                      09898001
098990         WHEN SQLCODE = -305                                      09899001
099000              CONTINUE                                            09900001
099010         WHEN SQLCODE = -904                                      09901001
099020         WHEN SQLCODE = -911                                      09902001
099030         WHEN SQLCODE = -913                                      09903001
099040              SET  RC074-DATABASE-BUSY                            09904001
099050                   RC074-ERROR-YES                                09905001
099060                   PS-ERROR-YES         TO  TRUE                  09906001
099070              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09907001
099080              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09908001
099090              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09909001
099100              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09910001
099110              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09911001
099120              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09912001
099130              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09913001
099140             STRING   ' RCKUT128-8160-'                           09914001
099150                      ' CALLED BY-'                               09915001
099160                      RC074-CALLING-PROGRAM                       09916001
099170                      ' PO='                                      09917001
099180                      RC074-DISPLAY-PO                            09918001
099190                      ' RCVR='                                    09919001
099200                      RC074-DISPLAY-RCVR                          09920001
099210                      ' PACK='                                    09921001
099220                      RC074-DISPLAY-PACK                          09922001
099230                      ' SQLCODE='                                 09923001
099240                      RC074-DISPLAY-SQLCODE                       09924001
099250                      DELIMITED BY SIZE                           09925001
099260                                      INTO RC074-CRA-RET-MSG      09926001
099270             STRING   ' RCKUT128-8160-'                           09927001
099280                      ' CALLED BY-'                               09928001
099290                      RC074-CALLING-PROGRAM                       09929001
099300                      DELIMITED BY SIZE                           09930001
099310                                      INTO RC074-ABEND-TEXT       09931001
099320             MOVE '8160-'               TO RC074-CRA-REQ-ID       09932001
099330                                           RC074-ABEND-PARAGRAPH  09933001
099340             PERFORM 9998-RETURN                                  09934001
099350                                                                  09935001
099360         WHEN SQLWARN0 NOT = SPACE                                09936001
099370         WHEN SQLCODE NOT = ZERO                                  09937001
099380              SET  RC074-INVALID-SQL                              09938001
099390                   RC074-ERROR-YES                                09939001
099400                   PS-ERROR-YES         TO  TRUE                  09940001
099410              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 09941001
099420              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      09942001
099430              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    09943001
099440              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    09944001
099450              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    09945001
099460              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     09946001
099470              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    09947001
099480             STRING   ' RCKUT128-8160-'                           09948001
099490                      ' CALLED BY-'                               09949001
099500                      RC074-CALLING-PROGRAM                       09950001
099510                      ' PO='                                      09951001
099520                      RC074-DISPLAY-PO                            09952001
099530                      ' RCVR='                                    09953001
099540                      RC074-DISPLAY-RCVR                          09954001
099550                      ' PACK='                                    09955001
099560                      RC074-DISPLAY-PACK                          09956001
099570                      ' SQLCODE='                                 09957001
099580                      RC074-DISPLAY-SQLCODE                       09958001
099590                      DELIMITED BY SIZE                           09959001
099600                                      INTO RC074-CRA-RET-MSG      09960001
099610             STRING   ' RCKUT128-8160-'                           09961001
099620                      ' CALLED BY-'                               09962001
099630                      RC074-CALLING-PROGRAM                       09963001
099640                      DELIMITED BY SIZE                           09964001
099650                                      INTO RC074-ABEND-TEXT       09965001
099660             MOVE '8160-'               TO RC074-CRA-REQ-ID       09966001
099670                                           RC074-ABEND-PARAGRAPH  09967001
099680             PERFORM 9998-RETURN                                  09968001
099690                                                                  09969001
099700     END-EVALUATE.                                                09970001
099710                                                                  09971001
099720 8170-CNT-LNE-OTBND-P2L.                                          09972001
099730                                                                  09973001
099740     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      09974001
099750                                                                  09975001
099760     EXEC SQL                                                     09976001
099770          SELECT                                                  09977001
099780                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  09978001
099790          INTO                                                    09979001
099800                :RC074-P2L-ACTL-OTBND-CNT                         09980001
099810          FROM                                                    09981001
099820                 SUT_OTBND_UPC A                                  09982001
099830                ,SUT_OTBND_CART B                                 09983001
099840              ,  TRECITM  C                                       09984001
099850          WHERE                                                   09985001
099860                A.TRN_NBR        =  :RC074-PO-NBR                 09986001
099870           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           09987001
099880           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               09988001
099890           AND  B.ACTV_IND       =  'Y'                           09989001
099900           AND  B.CART_SRC_CDE  IN ('P2L','JWL')                  09990001
099910           AND  A.TRN_NBR        =   C.ORD_NBR                    09991001
099920           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                09992001
099930           AND  A.TRN_LNE_NBR    =   C.ORD_LNE_NBR                09993001
099940           AND  C.VER_STATUS_CDE =  'A'                           09994001
099950           AND  C.PREPK_ID       =  :RC074-PACK-ID                09995001
099960     END-EXEC.                                                    09996001
099970                                                                  09997001
099980     EVALUATE TRUE                                                09998001
099990         WHEN SQLCODE = ZERO                                      09999001
100000         WHEN SQLCODE = +100                                      10000001
100010         WHEN SQLCODE = -305                                      10001001
100020              CONTINUE                                            10002001
100030         WHEN SQLCODE = -904                                      10003001
100040         WHEN SQLCODE = -911                                      10004001
100050         WHEN SQLCODE = -913                                      10005001
100060              SET  RC074-DATABASE-BUSY                            10006001
100070                   RC074-ERROR-YES                                10007001
100080                   PS-ERROR-YES         TO  TRUE                  10008001
100090              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10009001
100100              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10010001
100110              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10011001
100120              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    10012001
100130              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10013001
100140              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10014001
100150              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    10015001
100160             STRING   ' RCKUT128-8170-'                           10016001
100170                      ' CALLED BY-'                               10017001
100180                      RC074-CALLING-PROGRAM                       10018001
100190                      ' PO='                                      10019001
100200                      RC074-DISPLAY-PO                            10020001
100210                      ' RCVR='                                    10021001
100220                      RC074-DISPLAY-RCVR                          10022001
100230                      ' LINE='                                    10023001
100240                      RC074-DISPLAY-LINE                          10024001
100250                      ' SQLCODE='                                 10025001
100260                      RC074-DISPLAY-SQLCODE                       10026001
100270                      DELIMITED BY SIZE                           10027001
100280                                      INTO RC074-CRA-RET-MSG      10028001
100290             STRING   ' RCKUT128-8170-'                           10029001
100300                      ' CALLED BY-'                               10030001
100310                      RC074-CALLING-PROGRAM                       10031001
100320                      DELIMITED BY SIZE                           10032001
100330                                      INTO RC074-ABEND-TEXT       10033001
100340             MOVE '8170-'               TO RC074-CRA-REQ-ID       10034001
100350                                           RC074-ABEND-PARAGRAPH  10035001
100360             PERFORM 9998-RETURN                                  10036001
100370                                                                  10037001
100380         WHEN SQLWARN0 NOT = SPACE                                10038001
100390         WHEN SQLCODE NOT = ZERO                                  10039001
100400              SET  RC074-INVALID-SQL                              10040001
100410                   RC074-ERROR-YES                                10041001
100420                   PS-ERROR-YES         TO  TRUE                  10042001
100430              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10043001
100440              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10044001
100450              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10045001
100460              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    10046001
100470              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10047001
100480              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10048001
100490              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    10049001
100500             STRING   ' RCKUT128-8170-'                           10050001
100510                      ' CALLED BY-'                               10051001
100520                      RC074-CALLING-PROGRAM                       10052001
100530                      ' PO='                                      10053001
100540                      RC074-DISPLAY-PO                            10054001
100550                      ' RCVR='                                    10055001
100560                      RC074-DISPLAY-RCVR                          10056001
100570                      ' LINE='                                    10057001
100580                      RC074-DISPLAY-LINE                          10058001
100590                      ' SQLCODE='                                 10059001
100600                      RC074-DISPLAY-SQLCODE                       10060001
100610                      DELIMITED BY SIZE                           10061001
100620                                      INTO RC074-CRA-RET-MSG      10062001
100630             STRING   ' RCKUT128-8170-'                           10063001
100640                      ' CALLED BY-'                               10064001
100650                      RC074-CALLING-PROGRAM                       10065001
100660                      DELIMITED BY SIZE                           10066001
100670                                      INTO RC074-ABEND-TEXT       10067001
100680             MOVE '8170-'               TO RC074-CRA-REQ-ID       10068001
100690                                           RC074-ABEND-PARAGRAPH  10069001
100700             PERFORM 9998-RETURN                                  10070001
100710                                                                  10071001
100720     END-EVALUATE.                                                10072001
100730                                                                  10073001
100740 8180-CNT-LNE-OTBND-FCSE.                                         10074001
100750                                                                  10075001
100760     MOVE ZERO                 TO  RC074-FCSE-ACTL-OTBND-CNT.     10076001
100770                                                                  10077001
100780     EXEC SQL                                                     10078001
100790          SELECT                                                  10079001
100800                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  10080001
100810          INTO                                                    10081001
100820                :RC074-FCSE-ACTL-OTBND-CNT                        10082001
100830          FROM                                                    10083001
100840                 SUT_OTBND_UPC A                                  10084001
100850              ,  SUT_OTBND_CART B                                 10085001
100860              ,  TRECITM  C                                       10086001
100870          WHERE                                                   10087001
100880                A.TRN_NBR        =  :RC074-PO-NBR                 10088001
100890           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           10089001
100900           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               10090001
100910           AND  B.DEST_LOC_NBR   =  :RC074-STR-NBR                10091001
100920           AND  B.ACTV_IND       =  'Y'                           10092001
100930           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              10093001
100940           AND  A.TRN_NBR        =   C.ORD_NBR                    10094001
100950           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                10095001
100960           AND  A.TRN_LNE_NBR    =   C.ORD_LNE_NBR                10096001
100970           AND  C.VER_STATUS_CDE =  'A'                           10097001
100980           AND  C.PREPK_ID       =  :RC074-PACK-ID                10098001
100990     END-EXEC.                                                    10099001
101000                                                                  10100001
101010     EVALUATE TRUE                                                10101001
101020         WHEN SQLCODE = ZERO                                      10102001
101030         WHEN SQLCODE = +100                                      10103001
101040         WHEN SQLCODE = -305                                      10104001
101050              CONTINUE                                            10105001
101060         WHEN SQLCODE = -904                                      10106001
101070         WHEN SQLCODE = -911                                      10107001
101080         WHEN SQLCODE = -913                                      10108001
101090              SET  RC074-DATABASE-BUSY                            10109001
101100                   RC074-ERROR-YES                                10110001
101110                   PS-ERROR-YES         TO  TRUE                  10111001
101120              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10112001
101130              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10113001
101140              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10114001
101150              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    10115001
101160              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10116001
101170              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10117001
101180              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    10118001
101190             STRING   ' RCKUT128-8180-'                           10119001
101200                      ' CALLED BY-'                               10120001
101210                      RC074-CALLING-PROGRAM                       10121001
101220                      ' PO='                                      10122001
101230                      RC074-DISPLAY-PO                            10123001
101240                      ' RCVR='                                    10124001
101250                      RC074-DISPLAY-RCVR                          10125001
101260                      ' PACK='                                    10126001
101270                      RC074-DISPLAY-PACK                          10127001
101280                      ' SQLCODE='                                 10128001
101290                      RC074-DISPLAY-SQLCODE                       10129001
101300                      DELIMITED BY SIZE                           10130001
101310                                      INTO RC074-CRA-RET-MSG      10131001
101320             STRING   ' RCKUT128-8180-'                           10132001
101330                      ' CALLED BY-'                               10133001
101340                      RC074-CALLING-PROGRAM                       10134001
101350                      DELIMITED BY SIZE                           10135001
101360                                      INTO RC074-ABEND-TEXT       10136001
101370             MOVE '8180-'               TO RC074-CRA-REQ-ID       10137001
101380                                           RC074-ABEND-PARAGRAPH  10138001
101390             PERFORM 9998-RETURN                                  10139001
101400                                                                  10140001
101410         WHEN SQLWARN0 NOT = SPACE                                10141001
101420         WHEN SQLCODE NOT = ZERO                                  10142001
101430              SET  RC074-INVALID-SQL                              10143001
101440                   RC074-ERROR-YES                                10144001
101450                   PS-ERROR-YES         TO  TRUE                  10145001
101460              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10146001
101470              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10147001
101480              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10148001
101490              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    10149001
101500              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10150001
101510              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10151001
101520              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    10152001
101530             STRING   ' RCKUT128-8180-'                           10153001
101540                      ' CALLED BY-'                               10154001
101550                      RC074-CALLING-PROGRAM                       10155001
101560                      ' PO='                                      10156001
101570                      RC074-DISPLAY-PO                            10157001
101580                      ' RCVR='                                    10158001
101590                      RC074-DISPLAY-RCVR                          10159001
101600                      ' PACK='                                    10160001
101610                      RC074-DISPLAY-PACK                          10161001
101620                      ' SQLCODE='                                 10162001
101630                      RC074-DISPLAY-SQLCODE                       10163001
101640                      DELIMITED BY SIZE                           10164001
101650                                      INTO RC074-CRA-RET-MSG      10165001
101660             STRING   ' RCKUT128-8180-'                           10166001
101670                      ' CALLED BY-'                               10167001
101680                      RC074-CALLING-PROGRAM                       10168001
101690                      DELIMITED BY SIZE                           10169001
101700                                      INTO RC074-ABEND-TEXT       10170001
101710             MOVE '8180-'               TO RC074-CRA-REQ-ID       10171001
101720                                           RC074-ABEND-PARAGRAPH  10172001
101730             PERFORM 9998-RETURN                                  10173001
101740                                                                  10174001
101750     END-EVALUATE.                                                10175001
101760                                                                  10176001
101770 8190-CNT-LNE-OTBND-P2L.                                          10177001
101780                                                                  10178001
101790     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      10179001
101800                                                                  10180001
101810     EXEC SQL                                                     10181001
101820          SELECT                                                  10182001
101830                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  10183001
101840          INTO                                                    10184001
101850                :RC074-P2L-ACTL-OTBND-CNT                         10185001
101860          FROM                                                    10186001
101870                 SUT_OTBND_UPC A                                  10187001
101880                ,SUT_OTBND_CART B                                 10188001
101890              ,  TRECITM  C                                       10189001
101900          WHERE                                                   10190001
101910                A.TRN_NBR        =  :RC074-PO-NBR                 10191001
101920           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           10192001
101930           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               10193001
101940           AND  B.DEST_LOC_NBR   =  :RC074-STR-NBR                10194001
101950           AND  B.ACTV_IND       =  'Y'                           10195001
101960           AND  B.CART_SRC_CDE  IN ('P2L','JWL')                  10196001
101970           AND  A.TRN_NBR        =   C.ORD_NBR                    10197001
101980           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                10198001
101990           AND  A.TRN_LNE_NBR    =   C.ORD_LNE_NBR                10199001
102000           AND  C.VER_STATUS_CDE =  'A'                           10200001
102010           AND  C.PREPK_ID       =  :RC074-PACK-ID                10201001
102020     END-EXEC.                                                    10202001
102030                                                                  10203001
102040     EVALUATE TRUE                                                10204001
102050         WHEN SQLCODE = ZERO                                      10205001
102060         WHEN SQLCODE = +100                                      10206001
102070         WHEN SQLCODE = -305                                      10207001
102080              CONTINUE                                            10208001
102090         WHEN SQLCODE = -904                                      10209001
102100         WHEN SQLCODE = -911                                      10210001
102110         WHEN SQLCODE = -913                                      10211001
102120              SET  RC074-DATABASE-BUSY                            10212001
102130                   RC074-ERROR-YES                                10213001
102140                   PS-ERROR-YES         TO  TRUE                  10214001
102150              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10215001
102160              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10216001
102170              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10217001
102180              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    10218001
102190              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10219001
102200              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10220001
102210              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    10221001
102220             STRING   ' RCKUT128-8190-'                           10222001
102230                      ' CALLED BY-'                               10223001
102240                      RC074-CALLING-PROGRAM                       10224001
102250                      ' PO='                                      10225001
102260                      RC074-DISPLAY-PO                            10226001
102270                      ' RCVR='                                    10227001
102280                      RC074-DISPLAY-RCVR                          10228001
102290                      ' LINE='                                    10229001
102300                      RC074-DISPLAY-LINE                          10230001
102310                      ' SQLCODE='                                 10231001
102320                      RC074-DISPLAY-SQLCODE                       10232001
102330                      DELIMITED BY SIZE                           10233001
102340                                      INTO RC074-CRA-RET-MSG      10234001
102350             STRING   ' RCKUT128-8190-'                           10235001
102360                      ' CALLED BY-'                               10236001
102370                      RC074-CALLING-PROGRAM                       10237001
102380                      DELIMITED BY SIZE                           10238001
102390                                      INTO RC074-ABEND-TEXT       10239001
102400             MOVE '8190-'               TO RC074-CRA-REQ-ID       10240001
102410                                           RC074-ABEND-PARAGRAPH  10241001
102420             PERFORM 9998-RETURN                                  10242001
102430                                                                  10243001
102440         WHEN SQLWARN0 NOT = SPACE                                10244001
102450         WHEN SQLCODE NOT = ZERO                                  10245001
102460              SET  RC074-INVALID-SQL                              10246001
102470                   RC074-ERROR-YES                                10247001
102480                   PS-ERROR-YES         TO  TRUE                  10248001
102490              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10249001
102500              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10250001
102510              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10251001
102520              MOVE RC074-LINE-NBR       TO  RC074-DISPLAY-LINE    10252001
102530              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10253001
102540              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10254001
102550              MOVE RC074-SHIPT-UNT-ID   TO  RC074-DISPLAY-SSCC    10255001
102560             STRING   ' RCKUT128-8190-'                           10256001
102570                      ' CALLED BY-'                               10257001
102580                      RC074-CALLING-PROGRAM                       10258001
102590                      ' PO='                                      10259001
102600                      RC074-DISPLAY-PO                            10260001
102610                      ' RCVR='                                    10261001
102620                      RC074-DISPLAY-RCVR                          10262001
102630                      ' LINE='                                    10263001
102640                      RC074-DISPLAY-LINE                          10264001
102650                      ' SQLCODE='                                 10265001
102660                      RC074-DISPLAY-SQLCODE                       10266001
102670                      DELIMITED BY SIZE                           10267001
102680                                      INTO RC074-CRA-RET-MSG      10268001
102690             STRING   ' RCKUT128-8190-'                           10269001
102700                      ' CALLED BY-'                               10270001
102710                      RC074-CALLING-PROGRAM                       10271001
102720                      DELIMITED BY SIZE                           10272001
102730                                      INTO RC074-ABEND-TEXT       10273001
102740             MOVE '8190-'               TO RC074-CRA-REQ-ID       10274001
102750                                           RC074-ABEND-PARAGRAPH  10275001
102760             PERFORM 9998-RETURN                                  10276001
102770                                                                  10277001
102780     END-EVALUATE.                                                10278001
102790                                                                  10279001
102800                                                                  10280001
102810 8200-SELECT-OTBND-CART.                                          10281001
102820                                                                  10282001
102830     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      10283001
102840                                                                  10284001
102850     EXEC SQL                                                     10285001
102860          SELECT                                                  10286001
102870                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  10287001
102880          INTO                                                    10288001
102890                :PV-ODD-UNT-CRTN-COUNT                            10289001
102900          FROM                                                    10290001
102910                 SUT_OTBND_UPC A                                  10291001
102920                ,SUT_OTBND_CART B                                 10292001
102930                ,TRECITM        C                                 10293001
102940          WHERE                                                   10294001
102950                A.TRN_NBR        =  :RC074-PO-NBR                 10295001
102960           AND  A.TRN_NBR        =   C.ORD_NBR                    10296001
102970           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           10297001
102980           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                10298001
102990           AND  A.TRN_LNE_NBR    =   C.ORD_LNE_NBR                10299001
103000           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               10300001
103010           AND  B.ACTV_IND       =  'Y'                           10301001
103020           AND  B.ODD_UNT_IND    =  'Y'                           10302001
103030           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              10303001
103040           AND  C.VER_STATUS_CDE =  'A'                           10304001
103050           AND  C.PREPK_ID       =  :RC074-PACK-ID                10305001
103060     END-EXEC.                                                    10306001
103070                                                                  10307001
103080     EVALUATE TRUE                                                10308001
103090         WHEN SQLCODE = ZERO                                      10309001
103100         WHEN SQLCODE = +100                                      10310001
103110         WHEN SQLCODE = -305                                      10311001
103120              CONTINUE                                            10312001
103130         WHEN SQLCODE = -904                                      10313001
103140         WHEN SQLCODE = -911                                      10314001
103150         WHEN SQLCODE = -913                                      10315001
103160              SET  RC074-DATABASE-BUSY                            10316001
103170                   RC074-ERROR-YES                                10317001
103180                   PS-ERROR-YES         TO  TRUE                  10318001
103190              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10319001
103200              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10320001
103210              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10321001
103220              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10322001
103230             STRING   ' RCKUT128-8200-'                           10323001
103240                      ' CALLED BY-'                               10324001
103250                      RC074-CALLING-PROGRAM                       10325001
103260                      ' PO='                                      10326001
103270                      RC074-DISPLAY-PO                            10327001
103280                      ' RCVR='                                    10328001
103290                      RC074-DISPLAY-RCVR                          10329001
103300                      ' PACK='                                    10330001
103310                      RC074-DISPLAY-PACK                          10331001
103320                      ' SQLCODE='                                 10332001
103330                      RC074-DISPLAY-SQLCODE                       10333001
103340                      DELIMITED BY SIZE                           10334001
103350                                      INTO RC074-CRA-RET-MSG      10335001
103360             STRING   ' RCKUT128-8200-'                           10336001
103370                      ' CALLED BY-'                               10337001
103380                      RC074-CALLING-PROGRAM                       10338001
103390                      DELIMITED BY SIZE                           10339001
103400                                      INTO RC074-ABEND-TEXT       10340001
103410             MOVE '8200-'               TO RC074-CRA-REQ-ID       10341001
103420                                           RC074-ABEND-PARAGRAPH  10342001
103430             PERFORM 9998-RETURN                                  10343001
103440                                                                  10344001
103450         WHEN SQLWARN0 NOT = SPACE                                10345001
103460         WHEN SQLCODE NOT = ZERO                                  10346001
103470              SET  RC074-INVALID-SQL                              10347001
103480                   RC074-ERROR-YES                                10348001
103490                   PS-ERROR-YES         TO  TRUE                  10349001
103500              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10350001
103510              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10351001
103520              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10352001
103530              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10353001
103540             STRING   ' RCKUT128-8200-'                           10354001
103550                      ' CALLED BY-'                               10355001
103560                      RC074-CALLING-PROGRAM                       10356001
103570                      ' PO='                                      10357001
103580                      RC074-DISPLAY-PO                            10358001
103590                      ' RCVR='                                    10359001
103600                      RC074-DISPLAY-RCVR                          10360001
103610                      ' PACK='                                    10361001
103620                      RC074-DISPLAY-PACK                          10362001
103630                      ' SQLCODE='                                 10363001
103640                      RC074-DISPLAY-SQLCODE                       10364001
103650                      DELIMITED BY SIZE                           10365001
103660                                      INTO RC074-CRA-RET-MSG      10366001
103670             STRING   ' RCKUT128-8200-'                           10367001
103680                      ' CALLED BY-'                               10368001
103690                      RC074-CALLING-PROGRAM                       10369001
103700                      DELIMITED BY SIZE                           10370001
103710                                      INTO RC074-ABEND-TEXT       10371001
103720             MOVE '8200-'               TO RC074-CRA-REQ-ID       10372001
103730                                           RC074-ABEND-PARAGRAPH  10373001
103740             PERFORM 9998-RETURN                                  10374001
103750                                                                  10375001
103760     END-EVALUATE.                                                10376001
103770                                                                  10377001
103780 8210-SELECT-OTBND-CART.                                          10378001
103790                                                                  10379001
103800     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      10380001
103810                                                                  10381001
103820     EXEC SQL                                                     10382001
103830          SELECT                                                  10383001
103840                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  10384001
103850          INTO                                                    10385001
103860                :PV-ODD-UNT-CRTN-COUNT                            10386001
103870          FROM                                                    10387001
103880                 SUT_OTBND_UPC A                                  10388001
103890                ,SUT_OTBND_CART B                                 10389001
103900                ,TRECITM        C                                 10390001
103910          WHERE                                                   10391001
103920                A.TRN_NBR        =  :RC074-PO-NBR                 10392001
103930           AND  A.TRN_NBR        =   C.ORD_NBR                    10393001
103940           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           10394001
103950           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                10395001
103960           AND  A.TRN_LNE_NBR    =   C.ORD_LNE_NBR                10396001
103970           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               10397001
103980           AND  B.DEST_LOC_NBR   =  :RC074-STR-NBR                10398001
103990           AND  B.ACTV_IND       =  'Y'                           10399001
104000           AND  B.ODD_UNT_IND    =  'Y'                           10400001
104010           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              10401001
104020           AND  C.VER_STATUS_CDE =  'A'                           10402001
104030           AND  C.PREPK_ID       =  :RC074-PACK-ID                10403001
104040     END-EXEC.                                                    10404001
104050                                                                  10405001
104060     EVALUATE TRUE                                                10406001
104070         WHEN SQLCODE = ZERO                                      10407001
104080         WHEN SQLCODE = +100                                      10408001
104090         WHEN SQLCODE = -305                                      10409001
104100              CONTINUE                                            10410001
104110         WHEN SQLCODE = -904                                      10411001
104120         WHEN SQLCODE = -911                                      10412001
104130         WHEN SQLCODE = -913                                      10413001
104140              SET  RC074-DATABASE-BUSY                            10414001
104150                   RC074-ERROR-YES                                10415001
104160                   PS-ERROR-YES         TO  TRUE                  10416001
104170              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10417001
104180              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10418001
104190              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10419001
104200              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10420001
104210              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10421001
104220             STRING   ' RCKUT128-8210-'                           10422001
104230                      ' CALLED BY-'                               10423001
104240                      RC074-CALLING-PROGRAM                       10424001
104250                      ' PO='                                      10425001
104260                      RC074-DISPLAY-PO                            10426001
104270                      ' RCVR='                                    10427001
104280                      RC074-DISPLAY-RCVR                          10428001
104290                      ' STR='                                     10429001
104300                      RC074-DISPLAY-STR                           10430001
104310                      ' PCK='                                     10431001
104320                      RC074-DISPLAY-PACK                          10432001
104330                      ' SQLCODE='                                 10433001
104340                      RC074-DISPLAY-SQLCODE                       10434001
104350                      DELIMITED BY SIZE                           10435001
104360                                      INTO RC074-CRA-RET-MSG      10436001
104370             STRING   ' RCKUT128-8210-'                           10437001
104380                      ' CALLED BY-'                               10438001
104390                      RC074-CALLING-PROGRAM                       10439001
104400                      DELIMITED BY SIZE                           10440001
104410                                      INTO RC074-ABEND-TEXT       10441001
104420             MOVE '8210-'               TO RC074-CRA-REQ-ID       10442001
104430                                           RC074-ABEND-PARAGRAPH  10443001
104440             PERFORM 9998-RETURN                                  10444001
104450                                                                  10445001
104460         WHEN SQLWARN0 NOT = SPACE                                10446001
104470         WHEN SQLCODE NOT = ZERO                                  10447001
104480              SET  RC074-INVALID-SQL                              10448001
104490                   RC074-ERROR-YES                                10449001
104500                   PS-ERROR-YES         TO  TRUE                  10450001
104510              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10451001
104520              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10452001
104530              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10453001
104540             STRING   ' RCKUT128-8210-'                           10454001
104550                      ' CALLED BY-'                               10455001
104560                      RC074-CALLING-PROGRAM                       10456001
104570                      ' PO='                                      10457001
104580                      RC074-DISPLAY-PO                            10458001
104590                      ' RCVR='                                    10459001
104600                      RC074-DISPLAY-RCVR                          10460001
104610                      ' SQLCODE='                                 10461001
104620                      RC074-DISPLAY-SQLCODE                       10462001
104630                      DELIMITED BY SIZE                           10463001
104640                                      INTO RC074-CRA-RET-MSG      10464001
104650             STRING   ' RCKUT128-8210-'                           10465001
104660                      ' CALLED BY-'                               10466001
104670                      RC074-CALLING-PROGRAM                       10467001
104680                      DELIMITED BY SIZE                           10468001
104690                                      INTO RC074-ABEND-TEXT       10469001
104700             MOVE '8210-'               TO RC074-CRA-REQ-ID       10470001
104710                                           RC074-ABEND-PARAGRAPH  10471001
104720             PERFORM 9998-RETURN                                  10472001
104730                                                                  10473001
104740     END-EVALUATE.                                                10474001
104750                                                                  10475001
104760 8220-SELECT-OTBND-CART.                                          10476001
104770                                                                  10477001
104780     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      10478001
104790                                                                  10479001
104800     EXEC SQL                                                     10480001
104810          SELECT                                                  10481001
104820                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  10482001
104830          INTO                                                    10483001
104840                :PV-ODD-UNT-CRTN-COUNT                            10484001
104850          FROM                                                    10485001
104860                 SUT_OTBND_UPC A                                  10486001
104870                ,SUT_OTBND_CART B                                 10487001
104880                ,TRECITM        C                                 10488001
104890          WHERE                                                   10489001
104900                A.TRN_NBR        =  :RC074-PO-NBR                 10490001
104910           AND  A.TRN_NBR        =   C.ORD_NBR                    10491001
104920           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           10492001
104930           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                10493001
104940           AND  A.TRN_LNE_NBR    =  :RC074-LINE-NBR               10494001
104950           AND  A.TRN_LNE_NBR    =   C.ORD_LNE_NBR                10495001
104960           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               10496001
104970           AND  B.DEST_LOC_NBR   =  :RC074-STR-NBR                10497001
104980           AND  B.ACTV_IND       =  'Y'                           10498001
104990           AND  B.ODD_UNT_IND    =  'Y'                           10499001
105000           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              10500001
105010           AND  C.VER_STATUS_CDE =  'A'                           10501001
105020           AND  C.PREPK_ID       =  :RC074-PACK-ID                10502001
105030     END-EXEC.                                                    10503001
105040                                                                  10504001
105050     EVALUATE TRUE                                                10505001
105060         WHEN SQLCODE = ZERO                                      10506001
105070         WHEN SQLCODE = +100                                      10507001
105080         WHEN SQLCODE = -305                                      10508001
105090              CONTINUE                                            10509001
105100         WHEN SQLCODE = -904                                      10510001
105110         WHEN SQLCODE = -911                                      10511001
105120         WHEN SQLCODE = -913                                      10512001
105130              SET  RC074-DATABASE-BUSY                            10513001
105140                   RC074-ERROR-YES                                10514001
105150                   PS-ERROR-YES         TO  TRUE                  10515001
105160              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10516001
105170              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10517001
105180              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10518001
105190              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10519001
105200              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10520001
105210             STRING   ' RCKUT128-8220-'                           10521001
105220                      ' CALLED BY-'                               10522001
105230                      RC074-CALLING-PROGRAM                       10523001
105240                      ' PO='                                      10524001
105250                      RC074-DISPLAY-PO                            10525001
105260                      ' RCVR='                                    10526001
105270                      RC074-DISPLAY-RCVR                          10527001
105280                      ' STR='                                     10528001
105290                      RC074-DISPLAY-STR                           10529001
105300                      ' PCK='                                     10530001
105310                      RC074-DISPLAY-PACK                          10531001
105320                      ' SQLCODE='                                 10532001
105330                      RC074-DISPLAY-SQLCODE                       10533001
105340                      DELIMITED BY SIZE                           10534001
105350                                      INTO RC074-CRA-RET-MSG      10535001
105360             STRING   ' RCKUT128-8220-'                           10536001
105370                      ' CALLED BY-'                               10537001
105380                      RC074-CALLING-PROGRAM                       10538001
105390                      DELIMITED BY SIZE                           10539001
105400                                      INTO RC074-ABEND-TEXT       10540001
105410             MOVE '8220-'               TO RC074-CRA-REQ-ID       10541001
105420                                           RC074-ABEND-PARAGRAPH  10542001
105430             PERFORM 9998-RETURN                                  10543001
105440                                                                  10544001
105450         WHEN SQLWARN0 NOT = SPACE                                10545001
105460         WHEN SQLCODE NOT = ZERO                                  10546001
105470              SET  RC074-INVALID-SQL                              10547001
105480                   RC074-ERROR-YES                                10548001
105490                   PS-ERROR-YES         TO  TRUE                  10549001
105500              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10550001
105510              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10551001
105520              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10552001
105530             STRING   ' RCKUT128-8220-'                           10553001
105540                      ' CALLED BY-'                               10554001
105550                      RC074-CALLING-PROGRAM                       10555001
105560                      ' PO='                                      10556001
105570                      RC074-DISPLAY-PO                            10557001
105580                      ' RCVR='                                    10558001
105590                      RC074-DISPLAY-RCVR                          10559001
105600                      ' SQLCODE='                                 10560001
105610                      RC074-DISPLAY-SQLCODE                       10561001
105620                      DELIMITED BY SIZE                           10562001
105630                                      INTO RC074-CRA-RET-MSG      10563001
105640             STRING   ' RCKUT128-8220-'                           10564001
105650                      ' CALLED BY-'                               10565001
105660                      RC074-CALLING-PROGRAM                       10566001
105670                      DELIMITED BY SIZE                           10567001
105680                                      INTO RC074-ABEND-TEXT       10568001
105690             MOVE '8220-'               TO RC074-CRA-REQ-ID       10569001
105700                                           RC074-ABEND-PARAGRAPH  10570001
105710             PERFORM 9998-RETURN                                  10571001
105720                                                                  10572001
105730     END-EVALUATE.                                                10573001
105740                                                                  10574001
105750 8230-SELECT-OTBND-CART.                                          10575001
105760                                                                  10576001
105770     MOVE ZERO                 TO  RC074-P2L-ACTL-OTBND-CNT.      10577001
105780                                                                  10578001
105790     EXEC SQL                                                     10579001
105800          SELECT                                                  10580001
105810                 COUNT(DISTINCT(B.SHIPT_UNT_ID))                  10581001
105820          INTO                                                    10582001
105830                :PV-ODD-UNT-CRTN-COUNT                            10583001
105840          FROM                                                    10584001
105850                 SUT_OTBND_UPC A                                  10585001
105860                ,SUT_OTBND_CART B                                 10586001
105870                ,TRECITM        C                                 10587001
105880          WHERE                                                   10588001
105890                A.TRN_NBR        =  :RC074-PO-NBR                 10589001
105900           AND  A.TRN_NBR        =   C.ORD_NBR                    10590001
105910           AND  A.RCVR_SEQ_NBR   =  :RC074-RCVR-SEQ-NBR           10591001
105920           AND  A.RCVR_SEQ_NBR   =   C.REC_SEQ_NBR                10592001
105930           AND  A.TRN_LNE_NBR    =  :RC074-LINE-NBR               10593001
105940           AND  A.TRN_LNE_NBR    =   C.ORD_LNE_NBR                10594001
105950           AND  A.SHIPT_UNT_ID   =   B.SHIPT_UNT_ID               10595001
105960           AND  B.ACTV_IND       =  'Y'                           10596001
105970           AND  B.ODD_UNT_IND    =  'Y'                           10597001
105980           AND  B.CART_SRC_CDE  NOT IN ('P2L','JWL')              10598001
105990           AND  C.VER_STATUS_CDE =  'A'                           10599001
106000           AND  C.PREPK_ID       =  :RC074-PACK-ID                10600001
106010     END-EXEC.                                                    10601001
106020                                                                  10602001
106030     EVALUATE TRUE                                                10603001
106040         WHEN SQLCODE = ZERO                                      10604001
106050         WHEN SQLCODE = +100                                      10605001
106060         WHEN SQLCODE = -305                                      10606001
106070              CONTINUE                                            10607001
106080         WHEN SQLCODE = -904                                      10608001
106090         WHEN SQLCODE = -911                                      10609001
106100         WHEN SQLCODE = -913                                      10610001
106110              SET  RC074-DATABASE-BUSY                            10611001
106120                   RC074-ERROR-YES                                10612001
106130                   PS-ERROR-YES         TO  TRUE                  10613001
106140              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10614001
106150              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10615001
106160              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10616001
106170              MOVE RC074-PACK-ID        TO  RC074-DISPLAY-PACK    10617001
106180              MOVE RC074-STR-NBR        TO  RC074-DISPLAY-STR     10618001
106190             STRING   ' RCKUT128-8230-'                           10619001
106200                      ' CALLED BY-'                               10620001
106210                      RC074-CALLING-PROGRAM                       10621001
106220                      ' PO='                                      10622001
106230                      RC074-DISPLAY-PO                            10623001
106240                      ' RCVR='                                    10624001
106250                      RC074-DISPLAY-RCVR                          10625001
106260                      ' STR='                                     10626001
106270                      RC074-DISPLAY-STR                           10627001
106280                      ' PCK='                                     10628001
106290                      RC074-DISPLAY-PACK                          10629001
106300                      ' SQLCODE='                                 10630001
106310                      RC074-DISPLAY-SQLCODE                       10631001
106320                      DELIMITED BY SIZE                           10632001
106330                                      INTO RC074-CRA-RET-MSG      10633001
106340             STRING   ' RCKUT128-8230-'                           10634001
106350                      ' CALLED BY-'                               10635001
106360                      RC074-CALLING-PROGRAM                       10636001
106370                      DELIMITED BY SIZE                           10637001
106380                                      INTO RC074-ABEND-TEXT       10638001
106390             MOVE '8230-'               TO RC074-CRA-REQ-ID       10639001
106400                                           RC074-ABEND-PARAGRAPH  10640001
106410             PERFORM 9998-RETURN                                  10641001
106420                                                                  10642001
106430         WHEN SQLWARN0 NOT = SPACE                                10643001
106440         WHEN SQLCODE NOT = ZERO                                  10644001
106450              SET  RC074-INVALID-SQL                              10645001
106460                   RC074-ERROR-YES                                10646001
106470                   PS-ERROR-YES         TO  TRUE                  10647001
106480              MOVE SQLCODE              TO  RC074-DISPLAY-SQLCODE 10648001
106490              MOVE RC074-PO-NBR         TO  RC074-DISPLAY-PO      10649001
106500              MOVE RC074-RCVR-SEQ-NBR   TO  RC074-DISPLAY-RCVR    10650001
106510             STRING   ' RCKUT128-8230-'                           10651001
106520                      ' CALLED BY-'                               10652001
106530                      RC074-CALLING-PROGRAM                       10653001
106540                      ' PO='                                      10654001
106550                      RC074-DISPLAY-PO                            10655001
106560                      ' RCVR='                                    10656001
106570                      RC074-DISPLAY-RCVR                          10657001
106580                      ' SQLCODE='                                 10658001
106590                      RC074-DISPLAY-SQLCODE                       10659001
106600                      DELIMITED BY SIZE                           10660001
106610                                      INTO RC074-CRA-RET-MSG      10661001
106620             STRING   ' RCKUT128-8230-'                           10662001
106630                      ' CALLED BY-'                               10663001
106640                      RC074-CALLING-PROGRAM                       10664001
106650                      DELIMITED BY SIZE                           10665001
106660                                      INTO RC074-ABEND-TEXT       10666001
106670             MOVE '8230-'               TO RC074-CRA-REQ-ID       10667001
106680                                           RC074-ABEND-PARAGRAPH  10668001
106690             PERFORM 9998-RETURN                                  10669001
106700                                                                  10670001
106710     END-EVALUATE.                                                10671001
106720                                                                  10672001
106730                                                                  10673001
106740*-----------------------------------------------------------------10674001
106750*  RETURN TO CALLING PROGRAM                                      10675001
106760*-----------------------------------------------------------------10676001
106770 9998-RETURN.                                                     10677001
106780                                                                  10678001
106790     MOVE SQLCA                         TO RC074-SQLCA.           10679001
106800     GOBACK.                                                      10680001
106810******************************************************************10681001
106820*  END OF MEMBER                                                 *10682001
106830******************************************************************10683001
