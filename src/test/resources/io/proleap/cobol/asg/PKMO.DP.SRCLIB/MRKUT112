000100*************************                                                 
000200 IDENTIFICATION DIVISION.                                                 
000300*************************                                                 
000400 PROGRAM-ID.      MRKUT112.                                               
000500 AUTHOR.          ANNE KINTOPF.                                           
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                                
000700 DATE-WRITTEN.    07/19/00.                                               
000800 DATE-COMPILED.                                                           
000900****************************************************************          
001000* THIS PROGRAM CHECKS IF THE ROH FILE IS EMPTY.  IF IT IS, THEN           
001000* A RETURN CODE OF 4002 IS SET.                                           
001100****************************************************************          
001200*                                                                         
001300 ENVIRONMENT DIVISION.                                                    
001500*                                                                         
001600 CONFIGURATION SECTION.                                                   
001700 SOURCE-COMPUTER. IBM-3090.                                               
001800 OBJECT-COMPUTER. IBM-3090.                                               
002000*                                                                         
002100 INPUT-OUTPUT SECTION.                                                    
002200 FILE-CONTROL.                                                            
002300     SELECT HEADER-FILE                                                   
002400         ASSIGN                       TO ICROH                            
002703         ACCESS MODE IS SEQUENTIAL                                        
002704         ORGANIZATION IS INDEXED                                          
002705         RECORD KEY IS H-ORDER-HEADER-KEY                                 
002706         FILE STATUS IS SC-HEADER-STATUS.                                 
002707                                                                          
002708***************                                                           
003200 DATA DIVISION.                                                           
003300***************                                                           
003400*                                                                         
003500 FILE SECTION.                                                            
003600                                                                          
003700 FD  HEADER-FILE                                                          
003800     DATA RECORD IS HEADER-RECORD.                                        
003900*                                                                         
004000 01  HEADER-RECORD.                                                       
004100     COPY ICI085C.                                                        
004200     COPY ICI055C.                                                        
004300     COPY ICI056C.                                                        
004400     COPY ICI100C.                                                        
004500     COPY ICI090C.                                                        
004900*                                                                         
004901 WORKING-STORAGE SECTION.                                                 
004902*                                                                         
021000 01  PV-MISC-FIELDS.                                                      
021100     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO             
021200                                                   COMP SYNC.             
021201*                                                                         
021202 01  PS-PROGRAM-SWITCHES.                                                 
021203     05  PS-EMPTY-FILE-SW             PIC X(01)      VALUE 'N'.           
021204         88  EMPTY-FILE                              VALUE 'Y'.           
021205*                                                                         
021206 01  ABEND-CODE                  PIC S9(4) COMP SYNC VALUE ZERO.          
021207     88  ABEND-4002-READ-ERROR                       VALUE +4002.         
021208     88  ABEND-4005-OPEN-ERROR                       VALUE +4005.         
021209     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006.         
021210*                                                                         
021211 01  SC-STATUS-CODES.                                                     
021212     05  SC-HEADER-STATUS             PIC X(02).                          
021213         88  SC-HEADER-STATUS-OK                     VALUE '00'.          
021214         88  SC-HEADER-STATUS-NOT-FOUND              VALUE '23'.          
021215         88  SC-HEADER-EMPTY-FILE                    VALUE '10'.          
021216*                                                                         
021217****************************************************************          
021218 PROCEDURE DIVISION.                                                      
021219****************************************************************          
021220                                                                          
021221****************************************************************          
021222* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *          
021223* PROGRAM.                                                     *          
021224****************************************************************          
021225                                                                          
021226 0000-PROGRAM-MAINLINE.                                                   
021227                                                                          
021228     PERFORM 1000-INITIALIZE.                                             
021229                                                                          
021230     PERFORM 2000-PROCESS-ROH-FILE.                                       
021231                                                                          
021232     PERFORM 9000-CLOSE-FILES.                                            
021233                                                                          
021234     STOP RUN.                                                            
021235                                                                          
021236****************************************************************          
021237* 1000- OPENS ALL FILES ASSOCIATED WITH THE JOB.               *          
021238****************************************************************          
021239 1000-INITIALIZE.                                                         
021240                                                                          
021241     OPEN INPUT HEADER-FILE.                                              
021242                                                                          
021243     IF NOT SC-HEADER-STATUS-OK                                           
021244         DISPLAY '**  ABEND  **'                                          
021245         DISPLAY 'MRKUT112'                                               
021246         DISPLAY 'INPUT HEADER FILE OPEN ERROR'                           
021247         DISPLAY 'FILE STATUS CODE = ' SC-HEADER-STATUS                   
021248         SET ABEND-4005-OPEN-ERROR TO TRUE                                
021249         CALL 'ILBOABN0' USING ABEND-CODE                                 
021250     END-IF.                                                              
021251                                                                          
021252****************************************************************          
021253* 2000- PROCESS ROH FILE                                       *          
021254****************************************************************          
021255 2000-PROCESS-ROH-FILE.                                                   
021256                                                                          
021257     PERFORM 2100-READ-ROH-FILE.                                          
021258                                                                          
021259****************************************************************          
021260* 2100- READ ROH FILE                                          *          
021261****************************************************************          
021262 2100-READ-ROH-FILE.                                                      
021263                                                                          
021264     READ HEADER-FILE.                                                    
021265                                                                          
021266     IF NOT SC-HEADER-STATUS-OK                                           
021267         IF SC-HEADER-EMPTY-FILE                                          
021273             MOVE 4002              TO RETURN-CODE                        
021275         ELSE                                                             
021277             DISPLAY '**  ABEND  **'                                      
021278             DISPLAY 'MRKUT112'                                           
021279             DISPLAY 'INPUT HEADER FILE READ ERROR'                       
021280             DISPLAY 'FILE STATUS CODE = ' SC-HEADER-STATUS               
021281             SET ABEND-4002-READ-ERROR TO TRUE                            
021282             CALL 'ILBOABN0' USING ABEND-CODE                             
021283         END-IF                                                           
021284     END-IF.                                                              
021285                                                                          
021286****************************************************************          
021287* 9000- CLOSE FILES                                            *          
021288****************************************************************          
021289 9000-CLOSE-FILES.                                                        
021290                                                                          
021291     CLOSE HEADER-FILE.                                                   
021292                                                                          
021293     IF NOT SC-HEADER-STATUS-OK                                           
021294         DISPLAY '**  ABEND  **'                                          
021295         DISPLAY 'MRKUT058'                                               
021296         DISPLAY 'INPUT HEADER FILE CLOSE ERROR'                          
021297         DISPLAY 'FILE STATUS CODE = ' SC-HEADER-STATUS                   
021298         SET ABEND-4006-CLOSE-ERROR TO TRUE                               
021299         CALL 'ILBOABN0' USING ABEND-CODE                                 
021300     END-IF.                                                              
021310                                                                          
421292     EJECT                                                                
421300                                                                          
431116******************************************************************        
431117******************END OF PROGRAM   *******************************        
431118******************************************************************        
