       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.             MLKUT225.                                        
       AUTHOR.                 INFOSYS.                                         
       INSTALLATION.           KOHLS.                                           
       DATE-WRITTEN.           10-14-08.                                        
       DATE-COMPILED.                                                           
      ******************************************************************        
      *           PROGRAM TO PRORATE UNKNOWN BRAND/VENDOR AMOUNTS      *        
      ******************************************************************        
      * THIS PROGRAM PRORATES UNKNOWN BRAND/UNKNOWN VENDOR AMOUNTS     *        
      * BASED ON EIR% CONTRIBUTION TO TOTAL EIR FOR PREVIOUS WEEK.THE  *        
      * 10 BYTE DATE STARTING FROM THE 3RD POSITION OF DATE CONTROL    *        
      * FILE (MLCC015) IS TAKEN AS INPUT.                              *        
      *                                                                *        
      * WR/PROJ DATE       PROGAMMER    DESCRIPTION OF CHANGES         *        
      * ------- ---------- ------------ -------------------------------*        
      * W34517  10-14-2008 INFOSYS      NEW PROGRAM                    *        
W37965* W37965  02-16-2010 SURENDAR B  BRAND VENDOR TRANSACTION AND             
W37965*                                EXCEPTION MANAGEMENT                     
W37965*                                PROGRAM CHANGED TO WRITE DETAIL          
W37965*                                AUDIT FILE FOR PURCHASE                  
W37965*                                ADJUSTMENTS, SALES AND PRICE             
W37965*                                CHANGES.                                 
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
      *                                                                         
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT UU-KU-AMNTS-FILE           ASSIGN TO INP01.                   
           SELECT CNTL-DATE-FILE             ASSIGN TO INP02.                   
           SELECT CNTL-JOB-FILE              ASSIGN TO INP03.                   
           SELECT UU-NO-PRORATE-FILE         ASSIGN TO OUT01.                   
           SELECT UU-REV-AMNTS-FILE          ASSIGN TO OUT02.                   
           SELECT BV-PRORATE-FILE            ASSIGN TO OUT03.                   
W37965     SELECT DTL-AUDIT-FILE             ASSIGN TO OUT04.                   
           SELECT PRORATE-RPT-FILE           ASSIGN TO RPT01.                   
      *                                                                         
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
      *                                                                         
       FD  UU-KU-AMNTS-FILE                                                     
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
           COPY MLRD254 REPLACING ML254 BY UKAMT.                               
      *                                                                         
       FD  CNTL-DATE-FILE                                                       
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CNTL-DATE-REC.                                                       
           05  FILLER                  PIC X(03).                               
           05  CC-PROC-DATE-ISO        PIC X(10).                               
           05  CC-PROC-DATE-RDF  REDEFINES                                      
               CC-PROC-DATE-ISO.                                                
               10  CC-PROC-DATE-CC     PIC X(02).                               
               10  CC-PROC-DATE-YY     PIC X(02).                               
               10  FILLER              PIC X(01).                               
               10  CC-PROC-DATE-MM     PIC X(02).                               
               10  FILLER              PIC X(01).                               
               10  CC-PROC-DATE-DD     PIC X(02).                               
           05  FILLER                  PIC X(67).                               
      *                                                                         
       FD  UU-NO-PRORATE-FILE                                                   
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
           COPY MLRD254 REPLACING ML254 BY NOPRFL.                              
      *                                                                         
       FD  UU-REV-AMNTS-FILE                                                    
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
           COPY MLRD254 REPLACING ML254 BY REVAMT.                              
      *                                                                         
       FD  BV-PRORATE-FILE                                                      
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
           COPY MLRD254 REPLACING ML254 BY BVPRFL.                              
      *                                                                         
W37965 FD  DTL-AUDIT-FILE                                                       
W37965     RECORDING MODE IS F                                                  
W37965     LABEL RECORDS ARE STANDARD                                           
W37965     BLOCK CONTAINS 0 RECORDS                                             
W37965     RECORD CONTAINS 200 CHARACTERS                                       
W37965     DATA RECORD IS DTL-AUDIT-RECORD.                                     
W37965 01  DTL-AUDIT-RECORD           PIC X(200).                               
      *                                                                         
       FD  PRORATE-RPT-FILE                                                     
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS                                             
           RECORD CONTAINS 350 CHARACTERS                                       
           DATA RECORD IS PRORATE-RPT-RECORD.                                   
       01  PRORATE-RPT-RECORD         PIC X(350).                               
      *                                                                         
       FD  CNTL-JOB-FILE                                                        
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  CNTL-JOB-REC.                                                        
           05  CC-JOB-NAME             PIC X(06) VALUE SPACES.                  
               88  CC-JOB-MLK321                 VALUE 'MLK321'.                
               88  CC-JOB-MLK322                 VALUE 'MLK322'.                
               88  CC-JOB-MLK323                 VALUE 'MLK323'.                
           05  FILLER                  PIC X(74).                               
      *                                                                         
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
      *    INTERNAL TABLE                                              *        
      ******************************************************************        
      ******************************************************************        
      *    VARIABLES ARE DECLARED HERE                                 *        
      ******************************************************************        
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-INTERNAL-VALUES OCCURS 99999 TIMES.                           
               10  PV-IT-DEPT            PIC S9(4) COMP-3.                      
               10  PV-IT-BRND            PIC S9(4) COMP.                        
               10  PV-IT-ENT-ID          PIC S9(9) COMP.                        
               10  PV-IT-DKEY            PIC S9(11)V9(2) COMP-3.                
               10  PV-IT-EIR             PIC S9(11)V9(2) COMP-3.                
               10  PV-IT-PERCENT         PIC S9(3)V9(7) VALUE +0.               
           05  PV-DEPT-NBR             PIC S9(04)V COMP-3                       
                                                  VALUE ZEROES.                 
           05  PV-MAJ-CL-NBR           PIC S9(04)V COMP-3                       
                                                  VALUE ZEROES.                 
           05  PV-SUB-CL-NBR           PIC S9(04)V COMP-3                       
                                                  VALUE ZEROES.                 
           05  PV-VND-NBR              PIC S9(09)  COMP                         
                                                  VALUE ZEROES.                 
           05  PV-ENT-ID               PIC S9(09)  COMP                         
                                                  VALUE ZEROES.                 
           05  PV-LBL-SEQ-NBR          PIC S9(09)  COMP                         
                                                  VALUE ZEROES.                 
           05  PV-EIR-DMS              PIC S9(11)V9(02) COMP-3                  
                                                  VALUE ZEROES.                 
           05  PV-SQL-EIR-DMS          PIC S9(11)V9(02) COMP-3                  
                                                  VALUE ZEROES.                 
           05  PV-TOT-EIR-DMS          PIC S9(13)V9(02) COMP-3                  
                                                  VALUE ZEROES.                 
           05  PV-PCT                  PIC S9(03)V9(07)                         
                                                  VALUE ZEROES.                 
           05  PSUM-VARIABLES.                                                  
               10 PV-PROC-DATE-ISO     PIC X(10).                               
               10 PV-PCT               PIC S9(03)V9(07).                        
               10 PV-CUM-PCT-HOLD      PIC S9(03)V9(07).                        
               10 PV-SQL-DKEY          PIC  S9(9) COMP.                         
               10 PV-SQL-DEPT          PIC  S9(4)V COMP-3.                      
               10 PV-SQL-LBL-SEQ-NBR   PIC  S9(9) COMP.                         
               10 PV-SQL-ENT-ID        PIC  S9(9) COMP.                         
               10 PV-INDX              PIC 9(05)  VALUE ZEROS.                  
               10 PV-H-INDX            PIC 9(05)  VALUE ZEROS.                  
               10 PV-HOLD-INDX         PIC 9(05)  VALUE ZEROS.                  
               10 PV-EIR               PIC S9(15)V9(2) COMP-3.                  
               10 PV-HIGHEST-EIR       PIC S9(15)V9(2) COMP-3.                  
               10 PV-CUM-EIR           PIC S9(15)V9(2) COMP-3.                  
               10 CUM-SLS-REG-RTL-AMT  PIC S9(17)V9(2) COMP-3.                  
               10 CUM-SLS-PROMO-RTL-AMT PIC S9(17)V9(2) COMP-3.                 
               10 CUM-SLS-PROCLR-RTL-AMT PIC S9(17)V9(2) COMP-3.                
               10 CUM-SLS-CLR-RTL-AMT  PIC S9(17)V9(2) COMP-3.                  
               10 CUM-SLS-OTH-RTL-AMT  PIC S9(17)V9(2) COMP-3.                  
               10 CUM-MKDN-PLU-RTL-AMT PIC S9(17)V9(2) COMP-3.                  
               10 CUM-MKDN-PROMO-RTL-AMT PIC S9(17)V9(2) COMP-3.                
               10 CUM-MKDN-RGST-RTL-AMT PIC S9(17)V9(2) COMP-3.                 
               10 CUM-MKDN-GLDST-RTL-AMT PIC S9(17)V9(2) COMP-3.                
               10 CUM-MKDN-UMTCH-RTL-AMT PIC S9(17)V9(2) COMP-3.                
               10 CUM-MKDN-BYR-RTL-AMT PIC S9(17)V9(2) COMP-3.                  
               10 CUM-MKDN-STR-RTL-AMT PIC S9(17)V9(2) COMP-3.                  
               10 CUM-MKDN-PRPT-RTL-AMT PIC S9(17)V9(2) COMP-3.                 
               10 CUM-MKDN-OTH-RTL-AMT  PIC S9(17)V9(2) COMP-3.                 
               10 CUM-MKDN-RTL-AMT      PIC S9(17)V9(2) COMP-3.                 
               10 CUM-MKUP-RTL-AMT      PIC S9(17)V9(2) COMP-3.                 
               10 CUM-XFER-IN-RTL-AMT   PIC S9(17)V9(2) COMP-3.                 
               10 CUM-XFER-OUT-RTL-AMT  PIC S9(17)V9(2) COMP-3.                 
               10 CUM-RCPT-RTL-AMT      PIC S9(17)V9(2) COMP-3.                 
               10 CUM-RCPT-NET-COST-AMT PIC S9(17)V9(2) COMP-3.                 
               10 CUM-RCPT-GRO-COST-AMT PIC S9(17)V9(2) COMP-3.                 
               10 CUM-RCPT-FRGT-COST-AMT PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-RTL-AMT      PIC S9(17)V9(2) COMP-3.                 
               10 CUM-PADJ-FRGT-COST-AMT PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-DISC-COST-AMT PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-RTV-COST-AMT  PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-RTV-RTL-AMT   PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-DA-COST-AMT   PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-DA-RTL-AMT    PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-NET-COST-AMT  PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-OTH-COST-AMT  PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-OTH-RTL-AMT   PIC S9(17)V9(2) COMP-3.                
               10 CUM-PADJ-GRO-COST-AMT  PIC S9(17)V9(2) COMP-3.                
               10 CUM-DR-ALW-RTL-AMT     PIC S9(17)V9(2) COMP-3.                
               10 CUM-RTV-RTL-AMT        PIC S9(17)V9(2) COMP-3.                
               10 CUM-MKUP-INIT-AMT      PIC S9(17)V9(2) COMP-3.                
               10 CUM-MKUP-NET-AMT       PIC S9(17)V9(2) COMP-3.                
               10 CUM-INV-ADJ-RTL-AMT    PIC S9(17)V9(2) COMP-3.                
               10 CUM-ONORD-RTL-AMT      PIC S9(17)V9(2) COMP-3.                
               10 CUM-ONORD-COST-AMT     PIC S9(17)V9(2) COMP-3.                
               10 CUM-SHNK-RTL-AMT       PIC S9(17)V9(2) COMP-3.                
               10 CUM-END-INV-RTL-AMT    PIC S9(17)V9(2) COMP-3.                
               10 CUM-END-INV-COST-AMT   PIC S9(17)V9(2) COMP-3.                
               10 CUM-GRO-MRGN-AMT       PIC S9(17)V9(2) COMP-3.                
               10 CUM-IN-TRNST-RTL-AMT   PIC S9(17)V9(2) COMP-3.                
               10 CUM-RCPT-DISC-COST-AMT PIC S9(17)V9(2) COMP-3.                
               10 CUM-STR-EXPTED-RTL-AMT PIC S9(17)V9(2) COMP-3.                
           05  PV-OPER-ATTEMPTED       PIC  X(25) VALUE SPACES.                 
           05  PV-PARAGRAPH-NAME       PIC  X(30) VALUE SPACES.                 
           05  PC-PROGRAM-NAME         PIC  X(08) VALUE 'MLKUT225'.             
           05  PC-MAX-LINES            PIC 9(02)   VALUE 70.                    
                                                                                
           05  PC-REPORT-SELECTION-PURCHASE  PIC X(06) VALUE 'MLK321'.          
           05  PC-REPORT-SELECTION-SALES     PIC X(06) VALUE 'MLK322'.          
           05  PC-REPORT-SELECTION-PRICE-CHG PIC X(06) VALUE 'MLK323'.          
      *                                                                         
       01  PV-PROGRAM-REPT-VARS.                                                
                                                                                
           05 PV-LINE-COUNTER          PIC S9(15) COMP-3 VALUE 76.              
           05 PV-PAGE-COUNTER          PIC S9(05) COMP-3 VALUE ZEROS.           
           05 PV-REPORT-SELECTION      PIC X(06)  VALUE SPACES.                 
                                                                                
           05  PV-FISC-DATE-ISO.                                                
               10  PV-FISC-DATE-MM     PIC X(02) VALUE SPACES.                  
               10  FILLER              PIC X(01) VALUE '/'.                     
               10  PV-FISC-DATE-DD     PIC X(02) VALUE SPACES.                  
               10  FILLER              PIC X(01) VALUE '/'.                     
               10  PV-FISC-DATE-CC     PIC X(02) VALUE SPACES.                  
               10  PV-FISC-DATE-YY     PIC X(02) VALUE SPACES.                  
                                                                                
W37965     05 PV-WORK-AMOUNT           PIC S9(11)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-REG-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-PROMO-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-PROCLR-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-CLR-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-OTH-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-MKDN-PLU-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-PROMO-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-RGST-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-GLDST-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-UMTCH-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-BYR-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-STR-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-PRPT-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-OTH-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-INIT-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-NET-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-XFER-IN-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-XFER-OUT-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-NET-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-GRO-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-FRGT-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-FRGT-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DISC-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-RTV-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-RTV-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DA-COST-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DA-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-NET-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-OTH-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-OTH-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-GRO-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-DR-ALW-RTL-AMT        PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RTV-RTL-AMT           PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-SLS-REG-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-PROMO-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-PROCLR-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-SLS-CLR-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-SLS-OTH-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-MKDN-PLU-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-PROMO-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-MKDN-RGST-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-GLDST-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-MKDN-UMTCH-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-MKDN-BYR-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-STR-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-PRPT-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-OTH-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKDN-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-INIT-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-MKUP-NET-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 PV-XFER-IN-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-XFER-OUT-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-GRO-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RCPT-FRGT-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-PADJ-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-FRGT-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-PADJ-DISC-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 PV-PADJ-RTV-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-RTV-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DA-COST-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-DA-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-OTH-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-OTH-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-PADJ-GRO-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-DR-ALW-RTL-AMT-PRO    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 PV-RTV-RTL-AMT-PRO       PIC S9(13)V99 COMP-3 VALUE ZERO.         
W37965     05 PV-SKU-NBR               PIC 9(08) VALUE ZERO.                    
                                                                                
           05 TV-SLS-REG-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-PROMO-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-PROCLR-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-CLR-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-OTH-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-MKDN-PLU-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-PROMO-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-RGST-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-GLDST-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-UMTCH-RTL-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-BYR-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-STR-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-PRPT-RTL-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-OTH-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-INIT-AMT         PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-NET-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-XFER-IN-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-XFER-OUT-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-NET-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-GRO-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-FRGT-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-RTL-AMT          PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-FRGT-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DISC-COST-AMT    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-RTV-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-RTV-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DA-COST-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DA-RTL-AMT       PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-NET-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-OTH-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-OTH-RTL-AMT      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-GRO-COST-AMT     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-DR-ALW-RTL-AMT        PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RTV-RTL-AMT           PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-SLS-REG-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-PROMO-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-PROCLR-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-SLS-CLR-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-SLS-OTH-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-MKDN-PLU-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-PROMO-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-MKDN-RGST-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-GLDST-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-MKDN-UMTCH-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-MKDN-BYR-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-STR-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-PRPT-RTL-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-OTH-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKDN-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-INIT-AMT-PRO     PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-MKUP-NET-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
                                                                                
           05 TV-XFER-IN-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-XFER-OUT-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-GRO-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RCPT-FRGT-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-PADJ-RTL-AMT-PRO      PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-FRGT-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-PADJ-DISC-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.        
           05 TV-PADJ-RTV-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-RTV-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DA-COST-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-DA-RTL-AMT-PRO   PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-NET-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-OTH-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-OTH-RTL-AMT-PRO  PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-PADJ-GRO-COST-AMT-PRO PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-DR-ALW-RTL-AMT-PRO    PIC S9(13)V99 COMP-3 VALUE ZERO.         
           05 TV-RTV-RTL-AMT-PRO       PIC S9(13)V99 COMP-3 VALUE ZERO.         
      *                                                                         
      ******************************************************************        
      *    PROGRAM SWITCHES ARE DECLARED HERE                          *        
      ******************************************************************        
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-UU-KU-INP-EOF-SW         PIC X(01)     VALUE 'N'.             
               88  PS-UU-KU-INP-EOF-YES                  VALUE 'Y'.             
               88  PS-UU-KU-INP-EOF-NO                   VALUE 'N'.             
           05  PS-CNTL-DATE-EOF-SW         PIC X(01)     VALUE 'N'.             
               88  PS-CNTL-DATE-EOF-YES                  VALUE 'Y'.             
               88  PS-CNTL-DATE-EOF-NO                   VALUE 'N'.             
           05  PS-END-OF-B-V-CSR           PIC X(01)     VALUE 'N'.             
               88  PS-END-OF-B-V-CSR-NO                  VALUE 'N'.             
               88  PS-END-OF-B-V-CSR-YES                 VALUE 'Y'.             
           05  PS-END-OF-BRND-CSR          PIC X(01)     VALUE 'N'.             
               88  PS-END-OF-BRND-CSR-NO                 VALUE 'N'.             
               88  PS-END-OF-BRND-CSR-YES                VALUE 'Y'.             
           05  PS-ALL-MONEY-AMT-ZERO-SW    PIC X(01)     VALUE 'N'.             
               88  PS-ALL-MONEY-AMT-ZERO-YES             VALUE 'Y'.             
               88  PS-ALL-MONEY-AMT-ZERO-NO              VALUE 'N'.             
           05  PS-CNTL-JOB-EOF-SW          PIC X(01)     VALUE 'N'.             
               88  PS-CNTL-JOB-EOF-YES                   VALUE 'Y'.             
               88  PS-CNTL-JOB-EOF-NO                    VALUE 'N'.             
      *****************************************************************         
      * COPYBOOKS ARE DECLARED HERE                                             
      *****************************************************************         
           COPY MLRD225.                                                        
W37965     COPY MLRD090.                                                        
      *                                                                         
      ******************************************************************        
      *    ACCUMULATORS ARE DECLARED HERE                              *        
      ******************************************************************        
       01  PA-PROGRAM-ACCUMULATORS.                                             
           05  PA-INP-RECS-READ            PIC 9(09)     VALUE ZEROES.          
           05  PA-NO-PRORATE-RECS          PIC 9(09)     VALUE ZEROES.          
           05  PA-REV-AMNT-RECS            PIC 9(09)     VALUE ZEROES.          
           05  PA-OUT-PRORATE-RECS         PIC 9(09)     VALUE ZEROES.          
W37965     05  PA-OUT-AUDIT-RECS           PIC 9(09)     VALUE ZEROES.          
      ******************************************************************        
      *    ABEND CODE DECLARATION                                      *        
      ******************************************************************        
       01  ABEND-CODE                      PIC S9(04)    VALUE +0               
                                                         COMP SYNC.             
      ******************************************************************        
      *    DCLGEN FOR TDTATTR                                          *        
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE TDTATTR                                                  
           END-EXEC.                                                            
      ******************************************************************        
      *    DCLGEN FOR MLV_BRND_VND                                     *        
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE MLV00000                                                 
           END-EXEC.                                                            
      ******************************************************************        
      *    DCLGEN FOR MLT_WKLY_SUM                                     *        
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE MLT00005                                                 
           END-EXEC.                                                            
      ******************************************************************        
      *    DCLGEN FOR MLT_PARTN_CNTL                                   *        
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE MLT00003                                                 
           END-EXEC.                                                            
      ******************************************************************        
      *    USED FOR SQL COMMUNICATION AREA.                            *        
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
      ******************************************************************        
      *  DB2 ERROR MESSAGES FORMAT AREA.                               *        
      ******************************************************************        
           COPY DPWS004.                                                        
      ******************************************************************        
      *    CURSOR TO SELECT LIST OF KNOWN BRAND VENDORS FROM           *        
      *    MLT_WKLY_SUM TABLE                                          *        
      ******************************************************************        
           EXEC SQL                                                             
               DECLARE BRND_VND_CSR CURSOR WITH HOLD FOR                        
                   SELECT                                                       
                    DEPT_NBR,                                                   
                    LBL_SEQ_NBR,                                                
                    ENT_ID,                                                     
                    ML_LO_MDSE_LVL_ID                                           
                   FROM                                                         
                    MLV_BRND_VND                                                
                   WHERE                                                        
                    DEPT_NBR= :PV-DEPT-NBR                                      
                    AND EFF_BEG_DTE <= :DTATTR-FSCL-WK-END-DTE                  
                    AND (EFF_END_DTE >= :DTATTR-FSCL-WK-END-DTE OR              
                         EFF_END_DTE IS NULL)                                   
                    AND ENT_ID <> 5161                                          
                    AND LBL_SEQ_NBR <> 2230                                     
                   WITH UR                                                      
           END-EXEC.                                                            
      ******************************************************************        
      *    CURSOR TO SELECT LIST OF KNOWN BRAND VENDORS FOR A VENDOR   *        
      ******************************************************************        
           EXEC SQL                                                             
               DECLARE BRND_CSR CURSOR WITH HOLD FOR                            
                   SELECT                                                       
                    DEPT_NBR,                                                   
                    LBL_SEQ_NBR,                                                
                    ENT_ID,                                                     
                    ML_LO_MDSE_LVL_ID                                           
                   FROM                                                         
                    MLV_BRND_VND                                                
                   WHERE                                                        
                    DEPT_NBR= :PV-DEPT-NBR                                      
                    AND EFF_BEG_DTE <= :DTATTR-FSCL-WK-END-DTE                  
                    AND (EFF_END_DTE >= :DTATTR-FSCL-WK-END-DTE OR              
                         EFF_END_DTE IS NULL)                                   
                    AND ENT_ID = :PV-ENT-ID                                     
                   WITH UR                                                      
           END-EXEC.                                                            
      ******************************************************************        
      *  PROGRAM PROCESSING STARTS HERE                                *        
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      *                                                                         
       0000-MAINLINE.                                                           
           PERFORM 1000-INITIALIZATIONS                                         
           PERFORM 7000-READ-UU-KU-FILE                                         
           PERFORM 2000-PROCESS-PARA                                            
             UNTIL PS-UU-KU-INP-EOF-YES.                                        
           PERFORM 8999-END-OF-JOB.                                             
           STOP RUN.                                                            
                                                                                
      ******************************************************************        
      *   INITIALIZATION PARA                                          *        
      ******************************************************************        
       1000-INITIALIZATIONS.                                                    
           OPEN INPUT  UU-KU-AMNTS-FILE                                         
                       CNTL-DATE-FILE                                           
                       CNTL-JOB-FILE                                            
                OUTPUT UU-NO-PRORATE-FILE                                       
                       UU-REV-AMNTS-FILE                                        
                       BV-PRORATE-FILE                                          
W37965                 DTL-AUDIT-FILE                                           
                       PRORATE-RPT-FILE.                                        
           INITIALIZE  UKAMT-UPDATE-REC                                         
                       CNTL-DATE-REC                                            
                       NOPRFL-UPDATE-REC                                        
                       REVAMT-UPDATE-REC                                        
                       BVPRFL-UPDATE-REC.                                       
           SET PS-UU-KU-INP-EOF-NO     TO   TRUE.                               
           SET PS-CNTL-DATE-EOF-NO     TO   TRUE.                               
           SET PS-CNTL-JOB-EOF-NO      TO   TRUE.                               
                                                                                
           PERFORM 7500-READ-CNTL-JOB.                                          
           IF  (PS-CNTL-JOB-EOF-NO                                              
           AND (CC-JOB-MLK321                                                   
           OR   CC-JOB-MLK322                                                   
           OR   CC-JOB-MLK323))                                                 
               MOVE CC-JOB-NAME TO PV-REPORT-SELECTION                          
           ELSE                                                                 
               DISPLAY '** CHECK JOB CONTROL FILE INP03 **'                     
               DISPLAY '**  PROGRAM   **  = '  PC-PROGRAM-NAME                  
               PERFORM 9999-ABEND                                               
           END-IF.                                                              
                                                                                
           PERFORM 5400-SELECT-HEADER-DTL.                                      
                                                                                
           PERFORM 1100-GET-PREV-DATE.                                          
                                                                                
      ******************************************************************        
      *   GET THE PREVIOUS WEEK'S DATE                                 *        
      ******************************************************************        
       1100-GET-PREV-DATE.                                                      
           PERFORM 7300-READ-CNTL-DATE                                          
           IF  PS-CNTL-DATE-EOF-NO                                              
           AND CNTL-DATE-REC           NOT = SPACES                             
               DISPLAY 'DATE READ FROM CONTROL FILE : ' CC-PROC-DATE-ISO        
               MOVE CC-PROC-DATE-ISO TO PV-PROC-DATE-ISO                        
               MOVE CC-PROC-DATE-MM  TO PV-FISC-DATE-MM                         
               MOVE CC-PROC-DATE-DD  TO PV-FISC-DATE-DD                         
               MOVE CC-PROC-DATE-CC  TO PV-FISC-DATE-CC                         
               MOVE CC-PROC-DATE-YY  TO PV-FISC-DATE-YY                         
               MOVE PV-FISC-DATE-ISO TO RPT-FISCAL-DATE-PURCHASE                
                                        RPT-FISCAL-DATE-PRC-CHG                 
                                        RPT-FISCAL-DATE-SALES                   
               PERFORM 3600-GET-PREV-CNTL-DATE                                  
           ELSE                                                                 
               DISPLAY '** EMPTY DATE CONTROL FILE **'                          
               DISPLAY '**  PROGRAM   **  = '  PC-PROGRAM-NAME                  
               PERFORM 9999-ABEND                                               
           END-IF.                                                              
           DISPLAY 'FSCL WK END DTE FOR EIR : ' DTATTR-FSCL-WK-END-DTE.         
                                                                                
      ******************************************************************        
      *   MAIN PROCESSING PARA                                         *        
      ******************************************************************        
       2000-PROCESS-PARA.                                                       
           INITIALIZE                       PSUM-VARIABLES                      
           SET PS-END-OF-B-V-CSR-NO  TO TRUE                                    
           SET PS-END-OF-BRND-CSR-NO TO TRUE                                    
           SET PS-ALL-MONEY-AMT-ZERO-NO TO TRUE                                 
           PERFORM 4000-CHECK-INP-MONEY-AMTS                                    
           IF PS-ALL-MONEY-AMT-ZERO-YES                                         
              PERFORM 7100-WRITE-NO-PRORT-FILE                                  
           ELSE                                                                 
              COMPUTE PV-DEPT-NBR         =    UKAMT-DEPT-NBR                   
              COMPUTE PV-ENT-ID           =    UKAMT-ENT-ID                     
              IF  UKAMT-ENT-ID            =    5161                             
              AND UKAMT-LBL-SEQ-NBR       =    2230                             
                  PERFORM 2100-UU-PROCESSING                                    
              ELSE                                                              
                  IF  UKAMT-ENT-ID  NOT EQUAL  5161                             
                  AND UKAMT-LBL-SEQ-NBR = 2230                                  
                      PERFORM 2200-KU-PROCESSING                                
                  END-IF                                                        
              END-IF                                                            
           END-IF                                                               
                                                                                
           PERFORM 7000-READ-UU-KU-FILE.                                        
                                                                                
      ******************************************************************        
      *   PROCESSING FOR UNKNOWN BRAND/VENDOR                          *        
      ******************************************************************        
       2100-UU-PROCESSING.                                                      
           PERFORM 3000-OPEN-BRND-VND-CSR                                       
           PERFORM 3100-FETCH-BRND-VND-CSR                                      
             UNTIL PS-END-OF-B-V-CSR-YES                                        
           PERFORM 3200-CLOSE-BRND-VND-CSR.                                     
                                                                                
      ******************************************************************        
      *   PROCESSING FOR KNOWN VENDOR/UNKNOWN BRAND                    *        
      ******************************************************************        
       2200-KU-PROCESSING.                                                      
           PERFORM 3300-OPEN-BRND-CSR                                           
           PERFORM 3400-FETCH-BRND-CSR                                          
             UNTIL PS-END-OF-BRND-CSR-YES                                       
           PERFORM 3500-CLOSE-BRND-CSR.                                         
                                                                                
      ******************************************************************        
      *   PRORATE AND WRITE TO OUTPUT FILE                             *        
      ******************************************************************        
       2300-PRORATE-PROCESSING.                                                 
           IF PV-INDX = PV-H-INDX                                               
              CONTINUE                                                          
           ELSE                                                                 
           MOVE UKAMT-UPDATE-REC       TO BVPRFL-UPDATE-REC                     
           MOVE PV-IT-DKEY(PV-INDX)    TO BVPRFL-ML-LWST-ID                     
           MOVE PV-IT-BRND(PV-INDX)    TO BVPRFL-LBL-SEQ-NBR                    
           MOVE PV-IT-ENT-ID(PV-INDX)  TO BVPRFL-ENT-ID                         
           COMPUTE BVPRFL-SLS-REG-RTL-AMT =                                     
             UKAMT-SLS-REG-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)             
           ADD BVPRFL-SLS-REG-RTL-AMT TO CUM-SLS-REG-RTL-AMT                    
           COMPUTE BVPRFL-SLS-PROMO-RTL-AMT =                                   
             UKAMT-SLS-PROMO-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-SLS-PROMO-RTL-AMT TO CUM-SLS-PROMO-RTL-AMT                
           COMPUTE BVPRFL-SLS-PROCLR-RTL-AMT =                                  
             UKAMT-SLS-PROCLR-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-SLS-PROCLR-RTL-AMT TO CUM-SLS-PROCLR-RTL-AMT              
           COMPUTE BVPRFL-SLS-CLR-RTL-AMT =                                     
             UKAMT-SLS-CLR-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)             
           ADD BVPRFL-SLS-CLR-RTL-AMT    TO CUM-SLS-CLR-RTL-AMT                 
           COMPUTE BVPRFL-SLS-OTH-RTL-AMT =                                     
             UKAMT-SLS-OTH-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)             
           ADD BVPRFL-SLS-OTH-RTL-AMT    TO CUM-SLS-OTH-RTL-AMT                 
           COMPUTE BVPRFL-MKDN-PLU-RTL-AMT =                                    
             UKAMT-MKDN-PLU-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-MKDN-PLU-RTL-AMT   TO CUM-MKDN-PLU-RTL-AMT                
           COMPUTE BVPRFL-MKDN-PROMO-RTL-AMT =                                  
             UKAMT-MKDN-PROMO-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-MKDN-PROMO-RTL-AMT TO CUM-MKDN-PROMO-RTL-AMT              
           COMPUTE BVPRFL-MKDN-RGST-RTL-AMT =                                   
             UKAMT-MKDN-RGST-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-MKDN-RGST-RTL-AMT  TO CUM-MKDN-RGST-RTL-AMT               
           COMPUTE BVPRFL-MKDN-GLDST-RTL-AMT =                                  
             UKAMT-MKDN-GLDST-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-MKDN-GLDST-RTL-AMT TO CUM-MKDN-GLDST-RTL-AMT              
           COMPUTE BVPRFL-MKDN-UMTCH-RTL-AMT =                                  
             UKAMT-MKDN-UMTCH-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-MKDN-UMTCH-RTL-AMT TO CUM-MKDN-UMTCH-RTL-AMT              
           COMPUTE BVPRFL-MKDN-BYR-RTL-AMT =                                    
             UKAMT-MKDN-BYR-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-MKDN-BYR-RTL-AMT   TO CUM-MKDN-BYR-RTL-AMT                
           COMPUTE BVPRFL-MKDN-STR-RTL-AMT =                                    
             UKAMT-MKDN-STR-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-MKDN-STR-RTL-AMT   TO CUM-MKDN-STR-RTL-AMT                
           COMPUTE BVPRFL-MKDN-PRPT-RTL-AMT =                                   
             UKAMT-MKDN-PRPT-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-MKDN-PRPT-RTL-AMT  TO CUM-MKDN-PRPT-RTL-AMT               
           COMPUTE BVPRFL-MKDN-OTH-RTL-AMT =                                    
             UKAMT-MKDN-OTH-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-MKDN-OTH-RTL-AMT  TO CUM-MKDN-OTH-RTL-AMT                 
           COMPUTE BVPRFL-MKDN-RTL-AMT =                                        
             UKAMT-MKDN-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)                
           ADD BVPRFL-MKDN-RTL-AMT      TO CUM-MKDN-RTL-AMT                     
           COMPUTE BVPRFL-MKUP-RTL-AMT =                                        
             UKAMT-MKUP-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)                
           ADD BVPRFL-MKUP-RTL-AMT      TO CUM-MKUP-RTL-AMT                     
           COMPUTE BVPRFL-XFER-IN-RTL-AMT =                                     
             UKAMT-XFER-IN-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)             
           ADD BVPRFL-XFER-IN-RTL-AMT   TO CUM-XFER-IN-RTL-AMT                  
           COMPUTE BVPRFL-XFER-OUT-RTL-AMT =                                    
             UKAMT-XFER-OUT-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-XFER-OUT-RTL-AMT  TO CUM-XFER-OUT-RTL-AMT                 
           COMPUTE BVPRFL-RCPT-RTL-AMT =                                        
             UKAMT-RCPT-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)                
           ADD BVPRFL-RCPT-RTL-AMT      TO CUM-RCPT-RTL-AMT                     
           COMPUTE BVPRFL-RCPT-NET-COST-AMT =                                   
             UKAMT-RCPT-NET-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-RCPT-NET-COST-AMT TO CUM-RCPT-NET-COST-AMT                
           COMPUTE BVPRFL-RCPT-GRO-COST-AMT =                                   
             UKAMT-RCPT-GRO-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-RCPT-GRO-COST-AMT TO CUM-RCPT-GRO-COST-AMT                
           COMPUTE BVPRFL-RCPT-FRGT-COST-AMT =                                  
             UKAMT-RCPT-FRGT-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-RCPT-FRGT-COST-AMT TO CUM-RCPT-FRGT-COST-AMT              
           COMPUTE BVPRFL-PADJ-RTL-AMT =                                        
             UKAMT-PADJ-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)                
           ADD BVPRFL-PADJ-RTL-AMT       TO CUM-PADJ-RTL-AMT                    
           COMPUTE BVPRFL-PADJ-FRGT-COST-AMT =                                  
             UKAMT-PADJ-FRGT-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-PADJ-FRGT-COST-AMT TO CUM-PADJ-FRGT-COST-AMT              
           COMPUTE BVPRFL-PADJ-DISC-COST-AMT =                                  
             UKAMT-PADJ-DISC-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-PADJ-DISC-COST-AMT TO CUM-PADJ-DISC-COST-AMT              
           COMPUTE BVPRFL-PADJ-RTV-COST-AMT =                                   
             UKAMT-PADJ-RTV-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-PADJ-RTV-COST-AMT  TO CUM-PADJ-RTV-COST-AMT               
           COMPUTE BVPRFL-PADJ-RTV-RTL-AMT =                                    
             UKAMT-PADJ-RTV-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-PADJ-RTV-RTL-AMT   TO CUM-PADJ-RTV-RTL-AMT                
           COMPUTE BVPRFL-PADJ-DA-COST-AMT =                                    
             UKAMT-PADJ-DA-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-PADJ-DA-COST-AMT   TO CUM-PADJ-DA-COST-AMT                
           COMPUTE BVPRFL-PADJ-DA-RTL-AMT =                                     
             UKAMT-PADJ-DA-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)             
           ADD BVPRFL-PADJ-DA-RTL-AMT    TO CUM-PADJ-DA-RTL-AMT                 
           COMPUTE BVPRFL-PADJ-NET-COST-AMT =                                   
             UKAMT-PADJ-NET-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-PADJ-NET-COST-AMT  TO CUM-PADJ-NET-COST-AMT               
           COMPUTE BVPRFL-PADJ-OTH-COST-AMT =                                   
             UKAMT-PADJ-OTH-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-PADJ-OTH-COST-AMT  TO CUM-PADJ-OTH-COST-AMT               
           COMPUTE BVPRFL-PADJ-OTH-RTL-AMT =                                    
             UKAMT-PADJ-OTH-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-PADJ-OTH-RTL-AMT   TO CUM-PADJ-OTH-RTL-AMT                
           COMPUTE BVPRFL-PADJ-GRO-COST-AMT =                                   
             UKAMT-PADJ-GRO-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)           
           ADD BVPRFL-PADJ-GRO-COST-AMT  TO CUM-PADJ-GRO-COST-AMT               
           COMPUTE BVPRFL-DR-ALW-RTL-AMT =                                      
             UKAMT-DR-ALW-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)              
           ADD BVPRFL-DR-ALW-RTL-AMT     TO CUM-DR-ALW-RTL-AMT                  
           COMPUTE BVPRFL-RTV-RTL-AMT =                                         
             UKAMT-RTV-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)                 
           ADD BVPRFL-RTV-RTL-AMT        TO CUM-RTV-RTL-AMT                     
           COMPUTE BVPRFL-MKUP-INIT-AMT =                                       
             UKAMT-MKUP-INIT-AMT * (PV-IT-PERCENT(PV-INDX) / 100)               
           ADD BVPRFL-MKUP-INIT-AMT      TO CUM-MKUP-INIT-AMT                   
           COMPUTE BVPRFL-MKUP-NET-AMT =                                        
             UKAMT-MKUP-NET-AMT * (PV-IT-PERCENT(PV-INDX) / 100)                
           ADD BVPRFL-MKUP-NET-AMT       TO CUM-MKUP-NET-AMT                    
           COMPUTE BVPRFL-INV-ADJ-RTL-AMT =                                     
             UKAMT-INV-ADJ-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)             
           ADD BVPRFL-INV-ADJ-RTL-AMT    TO CUM-INV-ADJ-RTL-AMT                 
           COMPUTE BVPRFL-ONORD-RTL-AMT =                                       
             UKAMT-ONORD-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)               
           ADD BVPRFL-ONORD-RTL-AMT      TO CUM-ONORD-RTL-AMT                   
           COMPUTE BVPRFL-ONORD-COST-AMT =                                      
             UKAMT-ONORD-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)              
           ADD BVPRFL-ONORD-COST-AMT     TO CUM-ONORD-COST-AMT                  
           COMPUTE BVPRFL-SHNK-RTL-AMT =                                        
             UKAMT-SHNK-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)                
           ADD BVPRFL-SHNK-RTL-AMT       TO CUM-SHNK-RTL-AMT                    
           COMPUTE BVPRFL-END-INV-RTL-AMT =                                     
             UKAMT-END-INV-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)             
           ADD BVPRFL-END-INV-RTL-AMT    TO CUM-END-INV-RTL-AMT                 
           COMPUTE BVPRFL-END-INV-COST-AMT =                                    
             UKAMT-END-INV-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-END-INV-COST-AMT   TO CUM-END-INV-COST-AMT                
           COMPUTE BVPRFL-GRO-MRGN-AMT =                                        
             UKAMT-GRO-MRGN-AMT * (PV-IT-PERCENT(PV-INDX) / 100)                
           ADD BVPRFL-GRO-MRGN-AMT       TO CUM-GRO-MRGN-AMT                    
           COMPUTE BVPRFL-IN-TRNST-RTL-AMT =                                    
             UKAMT-IN-TRNST-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)            
           ADD BVPRFL-IN-TRNST-RTL-AMT   TO CUM-IN-TRNST-RTL-AMT                
           COMPUTE BVPRFL-RCPT-DISC-COST-AMT =                                  
             UKAMT-RCPT-DISC-COST-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-RCPT-DISC-COST-AMT TO CUM-RCPT-DISC-COST-AMT              
           COMPUTE BVPRFL-STR-EXPTED-RTL-AMT =                                  
             UKAMT-STR-EXPTED-RTL-AMT * (PV-IT-PERCENT(PV-INDX) / 100)          
           ADD BVPRFL-STR-EXPTED-RTL-AMT TO CUM-STR-EXPTED-RTL-AMT              
W37965     PERFORM 7410-WRITE-AUDIT-DTL                                         
           PERFORM 4200-BUILD-REPORT-PRORTED                                    
           PERFORM 7400-WRITE-BV-PRORT-FILE                                     
           END-IF.                                                              
                                                                                
W37965******************************************************************        
W37965*   7410-WRITE-AUDIT-DTL                                         *        
W37965******************************************************************        
W37965 7410-WRITE-AUDIT-DTL.                                                    
W37965     INITIALIZE ML090-AUDIT-REC                                           
W37965     MOVE CC-PROC-DATE-ISO           TO ML090-FSCL-WK-END-DTE             
W37965     MOVE CC-PROC-DATE-ISO           TO ML090-PRCG-DTE                    
W37965     MOVE 'BVUEIR'                   TO ML090-FINCL-PRC-GP-CDE            
W37965     MOVE '9'                        TO ML090-SRC-SYS-ID                  
W37965     MOVE BVPRFL-DEPT-NBR            TO ML090-DEPT-NBR                    
W37965     MOVE BVPRFL-MAJ-CL-NBR          TO ML090-MAJ-CL-NBR                  
W37965     MOVE BVPRFL-SUB-CL-NBR          TO ML090-SUB-CL-NBR                  
W37965     MOVE BVPRFL-LOC-NBR             TO ML090-LOC-NBR                     
W37965     MOVE BVPRFL-ML-LWST-ID          TO ML090-ML-LO-MDSE-LVL-ID           
W37965     MOVE BVPRFL-ENT-ID              TO ML090-ORIG-ENT-ID                 
W37965     MOVE BVPRFL-LBL-SEQ-NBR         TO ML090-ORIG-LBL-SEQ-NBR            
W37965     MOVE BVPRFL-ENT-ID              TO ML090-ENT-ID                      
W37965     MOVE BVPRFL-LBL-SEQ-NBR         TO ML090-LBL-SEQ-NBR                 
W37965     MOVE BVPRFL-PADJ-NET-COST-AMT   TO ML090-PADJ-NET-COST-AMT           
W37965     MOVE BVPRFL-PADJ-GRO-COST-AMT   TO ML090-PADJ-GRO-COST-AMT           
W37965     MOVE BVPRFL-PADJ-DISC-COST-AMT  TO ML090-PADJ-DISC-COST-AMT          
W37965     MOVE BVPRFL-PADJ-RTL-AMT        TO ML090-PADJ-RTL-AMT                
W37965     MOVE 0                          TO ML090-TRN-TYP-CDE(1:1)            
W37965     MOVE BVPRFL-TRN-TYP-CDE         TO ML090-TRN-TYP-CDE(2:2)            
W37965     MOVE BVPRFL-AP-TRANS-CDE        TO ML090-AP-TRN-CDE                  
W37965     MOVE '01'                       TO ML090-DR-CR-CDE                   
W37965     MOVE BVPRFL-SLS-TYP-CDE         TO ML090-SLS-TYP-CDE                 
W37965     IF BVPRFL-PADJ-NET-COST-AMT NOT = ZERO OR                            
W37965        BVPRFL-PADJ-GRO-COST-AMT NOT = ZERO OR                            
W37965        BVPRFL-PADJ-RTL-AMT      NOT = ZERO                               
W37965            MOVE '15'                TO ML090-TRN-TYP-CDE(2:2)            
W37965     END-IF                                                               
W37965     MOVE BVPRFL-PRCHG-RSN-CDE       TO ML090-PRCHG-RSN-CDE               
W37965     MOVE BVPRFL-PRCHG-CTG-CDE       TO ML090-PRCHG-CTG-CDE               
W37965     MOVE BVPRFL-SKU-NBR             TO PV-SKU-NBR                        
W37965     IF PV-SKU-NBR = ZEROES OR                                            
W37965        PV-SKU-NBR = SPACES OR                                            
W37965        PV-SKU-NBR (6:3) = 000 OR                                         
W37965        PV-SKU-NBR (6:3) = 999                                            
W37965             MOVE 'Y'   TO ML090-DUMMY-SKU-IND                            
W37965     ELSE                                                                 
W37965             MOVE 'N'   TO ML090-DUMMY-SKU-IND                            
W37965     END-IF                                                               
W37965     COMPUTE PV-WORK-AMOUNT =  BVPRFL-SLS-REG-RTL-AMT                     
W37965                                +  BVPRFL-SLS-PROMO-RTL-AMT               
W37965                                +  BVPRFL-SLS-PROCLR-RTL-AMT              
W37965                                +  BVPRFL-SLS-CLR-RTL-AMT                 
W37965                                +  BVPRFL-SLS-OTH-RTL-AMT.                
W37965     MOVE PV-WORK-AMOUNT             TO ML090-SLS-RTL-AMT                 
W37965*    IF BVPRFL-MKDN-RTL-AMT NOT = ZERO                                    
W37965*           MOVE BVPRFL-MKDN-RTL-AMT TO ML090-PRCHG-RTL-AMT               
W37965*    ELSE                                                                 
W37965*           MOVE BVPRFL-MKUP-RTL-AMT TO ML090-PRCHG-RTL-AMT               
W37965*    END-IF                                                               
W37965*    WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                          
W37965*    ADD 1                  TO PA-OUT-AUDIT-RECS.                         
W37965     IF BVPRFL-SLS-REG-RTL-AMT    NOT = ZERO                              
W37965         MOVE BVPRFL-SLS-REG-RTL-AMT      TO ML090-SLS-RTL-AMT            
W37965         MOVE 'R'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF BVPRFL-SLS-PROMO-RTL-AMT NOT = ZERO                               
W37965         MOVE BVPRFL-SLS-PROMO-RTL-AMT    TO ML090-SLS-RTL-AMT            
W37965         MOVE 'P'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF BVPRFL-SLS-PROCLR-RTL-AMT NOT = ZERO                              
W37965         MOVE BVPRFL-SLS-PROCLR-RTL-AMT   TO ML090-SLS-RTL-AMT            
W37965         MOVE 'G'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF BVPRFL-SLS-CLR-RTL-AMT NOT = ZERO                                 
W37965         MOVE BVPRFL-SLS-CLR-RTL-AMT      TO ML090-SLS-RTL-AMT            
W37965         MOVE 'C'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF BVPRFL-SLS-OTH-RTL-AMT NOT = ZERO                                 
W37965         MOVE BVPRFL-SLS-OTH-RTL-AMT      TO ML090-SLS-RTL-AMT            
W37965         MOVE 'N'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF BVPRFL-MKDN-RTL-AMT NOT = ZERO                            02026900
W37965         MOVE BVPRFL-MKDN-RTL-AMT         TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC              02027300
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS              02027400
W37965     END-IF.                                                      02027500
W37965     IF BVPRFL-MKUP-RTL-AMT NOT = ZERO                            02026900
W37965         MOVE BVPRFL-MKUP-RTL-AMT         TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC              02027300
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS              02027400
W37965     END-IF.                                                      02027500
W37965     IF BVPRFL-SLS-REG-RTL-AMT    = ZERO AND                              
W37965        BVPRFL-SLS-PROMO-RTL-AMT  = ZERO AND                              
W37965        BVPRFL-SLS-PROCLR-RTL-AMT = ZERO AND                              
W37965        BVPRFL-SLS-CLR-RTL-AMT    = ZERO AND                              
W37965        BVPRFL-SLS-OTH-RTL-AMT    = ZERO AND                              
W37965        BVPRFL-MKDN-RTL-AMT       = ZERO AND                              
W37965        BVPRFL-MKUP-RTL-AMT       = ZERO                                  
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965                                                                          
      ******************************************************************        
      *   PRORATE AND WRITE HIGHEST AMOUTS RECORD                      *        
      ******************************************************************        
       2400-CALC-HIGHEST-AMT.                                                   
           MOVE UKAMT-UPDATE-REC        TO BVPRFL-UPDATE-REC                    
           MOVE PV-IT-DKEY(PV-H-INDX)   TO BVPRFL-ML-LWST-ID                    
           MOVE PV-IT-BRND(PV-H-INDX)   TO BVPRFL-LBL-SEQ-NBR                   
           MOVE PV-IT-ENT-ID(PV-H-INDX) TO BVPRFL-ENT-ID                        
           COMPUTE BVPRFL-SLS-REG-RTL-AMT =                                     
               UKAMT-SLS-REG-RTL-AMT - CUM-SLS-REG-RTL-AMT                      
           COMPUTE BVPRFL-SLS-PROMO-RTL-AMT =                                   
               UKAMT-SLS-PROMO-RTL-AMT - CUM-SLS-PROMO-RTL-AMT                  
           COMPUTE BVPRFL-SLS-PROCLR-RTL-AMT =                                  
               UKAMT-SLS-PROCLR-RTL-AMT - CUM-SLS-PROCLR-RTL-AMT                
           COMPUTE BVPRFL-SLS-CLR-RTL-AMT =                                     
               UKAMT-SLS-CLR-RTL-AMT - CUM-SLS-CLR-RTL-AMT                      
           COMPUTE BVPRFL-SLS-OTH-RTL-AMT =                                     
               UKAMT-SLS-OTH-RTL-AMT - CUM-SLS-OTH-RTL-AMT                      
           COMPUTE BVPRFL-MKDN-PLU-RTL-AMT =                                    
               UKAMT-MKDN-PLU-RTL-AMT - CUM-MKDN-PLU-RTL-AMT                    
           COMPUTE BVPRFL-MKDN-PROMO-RTL-AMT =                                  
               UKAMT-MKDN-PROMO-RTL-AMT - CUM-MKDN-PROMO-RTL-AMT                
           COMPUTE BVPRFL-MKDN-RGST-RTL-AMT =                                   
               UKAMT-MKDN-RGST-RTL-AMT - CUM-MKDN-RGST-RTL-AMT                  
           COMPUTE BVPRFL-MKDN-GLDST-RTL-AMT =                                  
               UKAMT-MKDN-GLDST-RTL-AMT - CUM-MKDN-GLDST-RTL-AMT                
           COMPUTE BVPRFL-MKDN-UMTCH-RTL-AMT =                                  
               UKAMT-MKDN-UMTCH-RTL-AMT - CUM-MKDN-UMTCH-RTL-AMT                
           COMPUTE BVPRFL-MKDN-BYR-RTL-AMT =                                    
               UKAMT-MKDN-BYR-RTL-AMT - CUM-MKDN-BYR-RTL-AMT                    
           COMPUTE BVPRFL-MKDN-STR-RTL-AMT =                                    
               UKAMT-MKDN-STR-RTL-AMT - CUM-MKDN-STR-RTL-AMT                    
           COMPUTE BVPRFL-MKDN-PRPT-RTL-AMT =                                   
               UKAMT-MKDN-PRPT-RTL-AMT - CUM-MKDN-PRPT-RTL-AMT                  
           COMPUTE BVPRFL-MKDN-OTH-RTL-AMT =                                    
               UKAMT-MKDN-OTH-RTL-AMT - CUM-MKDN-OTH-RTL-AMT                    
           COMPUTE BVPRFL-MKDN-RTL-AMT =                                        
               UKAMT-MKDN-RTL-AMT - CUM-MKDN-RTL-AMT                            
           COMPUTE BVPRFL-MKUP-RTL-AMT =                                        
               UKAMT-MKUP-RTL-AMT - CUM-MKUP-RTL-AMT                            
           COMPUTE BVPRFL-XFER-IN-RTL-AMT =                                     
               UKAMT-XFER-IN-RTL-AMT - CUM-XFER-IN-RTL-AMT                      
           COMPUTE BVPRFL-XFER-OUT-RTL-AMT =                                    
               UKAMT-XFER-OUT-RTL-AMT - CUM-XFER-OUT-RTL-AMT                    
           COMPUTE BVPRFL-RCPT-RTL-AMT =                                        
               UKAMT-RCPT-RTL-AMT - CUM-RCPT-RTL-AMT                            
           COMPUTE BVPRFL-RCPT-NET-COST-AMT =                                   
               UKAMT-RCPT-NET-COST-AMT - CUM-RCPT-NET-COST-AMT                  
           COMPUTE BVPRFL-RCPT-GRO-COST-AMT =                                   
               UKAMT-RCPT-GRO-COST-AMT - CUM-RCPT-GRO-COST-AMT                  
           COMPUTE BVPRFL-RCPT-FRGT-COST-AMT =                                  
               UKAMT-RCPT-FRGT-COST-AMT - CUM-RCPT-FRGT-COST-AMT                
           COMPUTE BVPRFL-PADJ-RTL-AMT =                                        
               UKAMT-PADJ-RTL-AMT - CUM-PADJ-RTL-AMT                            
           COMPUTE BVPRFL-PADJ-FRGT-COST-AMT =                                  
               UKAMT-PADJ-FRGT-COST-AMT - CUM-PADJ-FRGT-COST-AMT                
           COMPUTE BVPRFL-PADJ-DISC-COST-AMT =                                  
               UKAMT-PADJ-DISC-COST-AMT - CUM-PADJ-DISC-COST-AMT                
           COMPUTE BVPRFL-PADJ-RTV-COST-AMT =                                   
               UKAMT-PADJ-RTV-COST-AMT - CUM-PADJ-RTV-COST-AMT                  
           COMPUTE BVPRFL-PADJ-RTV-RTL-AMT =                                    
               UKAMT-PADJ-RTV-RTL-AMT - CUM-PADJ-RTV-RTL-AMT                    
           COMPUTE BVPRFL-PADJ-DA-COST-AMT =                                    
               UKAMT-PADJ-DA-COST-AMT - CUM-PADJ-DA-COST-AMT                    
           COMPUTE BVPRFL-PADJ-DA-RTL-AMT =                                     
               UKAMT-PADJ-DA-RTL-AMT - CUM-PADJ-DA-RTL-AMT                      
           COMPUTE BVPRFL-PADJ-NET-COST-AMT =                                   
               UKAMT-PADJ-NET-COST-AMT - CUM-PADJ-NET-COST-AMT                  
           COMPUTE BVPRFL-PADJ-OTH-COST-AMT =                                   
               UKAMT-PADJ-OTH-COST-AMT - CUM-PADJ-OTH-COST-AMT                  
           COMPUTE BVPRFL-PADJ-OTH-RTL-AMT =                                    
               UKAMT-PADJ-OTH-RTL-AMT - CUM-PADJ-OTH-RTL-AMT                    
           COMPUTE BVPRFL-PADJ-GRO-COST-AMT =                                   
               UKAMT-PADJ-GRO-COST-AMT - CUM-PADJ-GRO-COST-AMT                  
           COMPUTE BVPRFL-DR-ALW-RTL-AMT =                                      
               UKAMT-DR-ALW-RTL-AMT - CUM-DR-ALW-RTL-AMT                        
           COMPUTE BVPRFL-RTV-RTL-AMT =                                         
               UKAMT-RTV-RTL-AMT - CUM-RTV-RTL-AMT                              
           COMPUTE BVPRFL-MKUP-INIT-AMT =                                       
               UKAMT-MKUP-INIT-AMT - CUM-MKUP-INIT-AMT                          
           COMPUTE BVPRFL-MKUP-NET-AMT =                                        
               UKAMT-MKUP-NET-AMT - CUM-MKUP-NET-AMT                            
           COMPUTE BVPRFL-INV-ADJ-RTL-AMT =                                     
               UKAMT-INV-ADJ-RTL-AMT - CUM-INV-ADJ-RTL-AMT                      
           COMPUTE BVPRFL-ONORD-RTL-AMT =                                       
               UKAMT-ONORD-RTL-AMT - CUM-ONORD-RTL-AMT                          
           COMPUTE BVPRFL-ONORD-COST-AMT =                                      
               UKAMT-ONORD-COST-AMT - CUM-ONORD-COST-AMT                        
           COMPUTE BVPRFL-SHNK-RTL-AMT =                                        
               UKAMT-SHNK-RTL-AMT - CUM-SHNK-RTL-AMT                            
           COMPUTE BVPRFL-END-INV-RTL-AMT =                                     
               UKAMT-END-INV-RTL-AMT - CUM-END-INV-RTL-AMT                      
           COMPUTE BVPRFL-END-INV-COST-AMT =                                    
               UKAMT-END-INV-COST-AMT - CUM-END-INV-COST-AMT                    
           COMPUTE BVPRFL-GRO-MRGN-AMT =                                        
               UKAMT-GRO-MRGN-AMT - CUM-GRO-MRGN-AMT                            
           COMPUTE BVPRFL-IN-TRNST-RTL-AMT =                                    
               UKAMT-IN-TRNST-RTL-AMT - CUM-IN-TRNST-RTL-AMT                    
           COMPUTE BVPRFL-RCPT-DISC-COST-AMT =                                  
               UKAMT-RCPT-DISC-COST-AMT - CUM-RCPT-DISC-COST-AMT                
           COMPUTE BVPRFL-STR-EXPTED-RTL-AMT =                                  
               UKAMT-STR-EXPTED-RTL-AMT - CUM-STR-EXPTED-RTL-AMT                
W37965     PERFORM 7410-WRITE-AUDIT-DTL                                         
           PERFORM 4200-BUILD-REPORT-PRORTED                                    
           PERFORM 7400-WRITE-BV-PRORT-FILE.                                    
                                                                                
      ******************************************************************        
      *   REVERSE THE AMOUNTS TO WRITE TO OUTPUT FILE                  *        
      ******************************************************************        
       2500-REV-AMNT-FILE.                                                      
           MOVE UKAMT-UPDATE-REC       TO   REVAMT-UPDATE-REC                   
           COMPUTE REVAMT-SLS-REG-RTL-AMT                                       
               =   REVAMT-SLS-REG-RTL-AMT * -1                                  
           COMPUTE REVAMT-SLS-PROMO-RTL-AMT                                     
               =   REVAMT-SLS-PROMO-RTL-AMT * -1                                
           COMPUTE REVAMT-SLS-PROCLR-RTL-AMT                                    
               =   REVAMT-SLS-PROCLR-RTL-AMT * -1                               
           COMPUTE REVAMT-SLS-CLR-RTL-AMT                                       
               =   REVAMT-SLS-CLR-RTL-AMT * -1                                  
           COMPUTE REVAMT-SLS-OTH-RTL-AMT                                       
               =   REVAMT-SLS-OTH-RTL-AMT * -1                                  
           COMPUTE REVAMT-MKDN-PLU-RTL-AMT                                      
               =   REVAMT-MKDN-PLU-RTL-AMT * -1                                 
           COMPUTE REVAMT-MKDN-PROMO-RTL-AMT                                    
               =   REVAMT-MKDN-PROMO-RTL-AMT * -1                               
           COMPUTE REVAMT-MKDN-RGST-RTL-AMT                                     
               =   REVAMT-MKDN-RGST-RTL-AMT * -1                                
           COMPUTE REVAMT-MKDN-GLDST-RTL-AMT                                    
               =   REVAMT-MKDN-GLDST-RTL-AMT * -1                               
           COMPUTE REVAMT-MKDN-UMTCH-RTL-AMT                                    
               =   REVAMT-MKDN-UMTCH-RTL-AMT * -1                               
           COMPUTE REVAMT-MKDN-BYR-RTL-AMT                                      
               =   REVAMT-MKDN-BYR-RTL-AMT * -1                                 
           COMPUTE REVAMT-MKDN-STR-RTL-AMT                                      
               =   REVAMT-MKDN-STR-RTL-AMT * -1                                 
           COMPUTE REVAMT-MKDN-PRPT-RTL-AMT                                     
               =   REVAMT-MKDN-PRPT-RTL-AMT * -1                                
           COMPUTE REVAMT-MKDN-OTH-RTL-AMT                                      
               =   REVAMT-MKDN-OTH-RTL-AMT * -1                                 
           COMPUTE REVAMT-MKDN-RTL-AMT                                          
               =   REVAMT-MKDN-RTL-AMT * -1                                     
           COMPUTE REVAMT-MKUP-RTL-AMT                                          
               =   REVAMT-MKUP-RTL-AMT * -1                                     
           COMPUTE REVAMT-XFER-IN-RTL-AMT                                       
               =   REVAMT-XFER-IN-RTL-AMT * -1                                  
           COMPUTE REVAMT-XFER-OUT-RTL-AMT                                      
               =   REVAMT-XFER-OUT-RTL-AMT * -1                                 
           COMPUTE REVAMT-RCPT-RTL-AMT                                          
               =   REVAMT-RCPT-RTL-AMT * -1                                     
           COMPUTE REVAMT-RCPT-NET-COST-AMT                                     
               =   REVAMT-RCPT-NET-COST-AMT * -1                                
           COMPUTE REVAMT-RCPT-GRO-COST-AMT                                     
               =   REVAMT-RCPT-GRO-COST-AMT * -1                                
           COMPUTE REVAMT-RCPT-FRGT-COST-AMT                                    
               =   REVAMT-RCPT-FRGT-COST-AMT * -1                               
           COMPUTE REVAMT-PADJ-RTL-AMT                                          
               =   REVAMT-PADJ-RTL-AMT * -1                                     
           COMPUTE REVAMT-PADJ-FRGT-COST-AMT                                    
               =   REVAMT-PADJ-FRGT-COST-AMT * -1                               
           COMPUTE REVAMT-PADJ-DISC-COST-AMT                                    
               =   REVAMT-PADJ-DISC-COST-AMT * -1                               
           COMPUTE REVAMT-PADJ-RTV-COST-AMT                                     
               =   REVAMT-PADJ-RTV-COST-AMT * -1                                
           COMPUTE REVAMT-PADJ-RTV-RTL-AMT                                      
               =   REVAMT-PADJ-RTV-RTL-AMT * -1                                 
           COMPUTE REVAMT-PADJ-DA-COST-AMT                                      
               =   REVAMT-PADJ-DA-COST-AMT * -1                                 
           COMPUTE REVAMT-PADJ-DA-RTL-AMT                                       
               =   REVAMT-PADJ-DA-RTL-AMT * -1                                  
           COMPUTE REVAMT-PADJ-NET-COST-AMT                                     
               =   REVAMT-PADJ-NET-COST-AMT * -1                                
           COMPUTE REVAMT-PADJ-OTH-COST-AMT                                     
               =   REVAMT-PADJ-OTH-COST-AMT * -1                                
           COMPUTE REVAMT-PADJ-OTH-RTL-AMT                                      
               =   REVAMT-PADJ-OTH-RTL-AMT * -1                                 
           COMPUTE REVAMT-PADJ-GRO-COST-AMT                                     
               =   REVAMT-PADJ-GRO-COST-AMT * -1                                
           COMPUTE REVAMT-DR-ALW-RTL-AMT                                        
               =   REVAMT-DR-ALW-RTL-AMT * -1                                   
           COMPUTE REVAMT-RTV-RTL-AMT                                           
               =   REVAMT-RTV-RTL-AMT * -1                                      
           COMPUTE REVAMT-MKUP-INIT-AMT                                         
               =   REVAMT-MKUP-INIT-AMT * -1                                    
           COMPUTE REVAMT-MKUP-NET-AMT                                          
               =   REVAMT-MKUP-NET-AMT * -1                                     
           COMPUTE REVAMT-INV-ADJ-RTL-AMT                                       
               =   REVAMT-INV-ADJ-RTL-AMT * -1                                  
           COMPUTE REVAMT-ONORD-RTL-AMT                                         
               =   REVAMT-ONORD-RTL-AMT * -1                                    
           COMPUTE REVAMT-ONORD-COST-AMT                                        
               =   REVAMT-ONORD-COST-AMT * -1                                   
           COMPUTE REVAMT-SHNK-RTL-AMT                                          
               =   REVAMT-SHNK-RTL-AMT * -1                                     
           COMPUTE REVAMT-END-INV-RTL-AMT                                       
               =   REVAMT-END-INV-RTL-AMT * -1                                  
           COMPUTE REVAMT-END-INV-COST-AMT                                      
               =   REVAMT-END-INV-COST-AMT * -1                                 
           COMPUTE REVAMT-GRO-MRGN-AMT                                          
               =   REVAMT-GRO-MRGN-AMT * -1                                     
           COMPUTE REVAMT-IN-TRNST-RTL-AMT                                      
               =   REVAMT-IN-TRNST-RTL-AMT * -1                                 
           COMPUTE REVAMT-RCPT-DISC-COST-AMT                                    
               =   REVAMT-RCPT-DISC-COST-AMT * -1                               
           COMPUTE REVAMT-STR-EXPTED-RTL-AMT                                    
               =   REVAMT-STR-EXPTED-RTL-AMT * -1                               
W37965     PERFORM 7210-WRITE-AUDIT-DTL                                         
           PERFORM 7200-WRITE-REV-AMNT-FILE                                     
           .                                                                    
                                                                                
W37965******************************************************************        
W37965*   7210-WRITE-AUDIT-DTL                                         *        
W37965******************************************************************        
W37965 7210-WRITE-AUDIT-DTL.                                                    
W37965     INITIALIZE ML090-AUDIT-REC                                           
W37965     MOVE CC-PROC-DATE-ISO          TO ML090-FSCL-WK-END-DTE              
W37965     MOVE CC-PROC-DATE-ISO          TO ML090-PRCG-DTE                     
W37965     MOVE 'BVUEIR'                  TO ML090-FINCL-PRC-GP-CDE             
W37965     MOVE '9'                       TO ML090-SRC-SYS-ID                   
W37965     MOVE REVAMT-DEPT-NBR           TO ML090-DEPT-NBR                     
W37965     MOVE REVAMT-MAJ-CL-NBR         TO ML090-MAJ-CL-NBR                   
W37965     MOVE REVAMT-SUB-CL-NBR         TO ML090-SUB-CL-NBR                   
W37965     MOVE REVAMT-LOC-NBR            TO ML090-LOC-NBR                      
W37965     MOVE REVAMT-ML-LWST-ID         TO ML090-ML-LO-MDSE-LVL-ID            
W37965     MOVE REVAMT-ENT-ID             TO ML090-ORIG-ENT-ID                  
W37965     MOVE REVAMT-LBL-SEQ-NBR        TO ML090-ORIG-LBL-SEQ-NBR             
W37965     MOVE REVAMT-ENT-ID             TO ML090-ENT-ID                       
W37965     MOVE REVAMT-LBL-SEQ-NBR        TO ML090-LBL-SEQ-NBR                  
W37965     MOVE REVAMT-ENT-ID             TO ML090-ENT-ID                       
W37965     MOVE REVAMT-LBL-SEQ-NBR        TO ML090-LBL-SEQ-NBR                  
W37965     MOVE REVAMT-PADJ-NET-COST-AMT  TO ML090-PADJ-NET-COST-AMT            
W37965     MOVE REVAMT-PADJ-GRO-COST-AMT  TO ML090-PADJ-GRO-COST-AMT            
W37965     MOVE REVAMT-PADJ-DISC-COST-AMT TO ML090-PADJ-DISC-COST-AMT           
W37965     MOVE REVAMT-PADJ-RTL-AMT       TO ML090-PADJ-RTL-AMT                 
W37965     MOVE 0                         TO ML090-TRN-TYP-CDE(1:1)             
W37965     MOVE REVAMT-TRN-TYP-CDE        TO ML090-TRN-TYP-CDE(2:2)             
W37965     MOVE REVAMT-AP-TRANS-CDE       TO ML090-AP-TRN-CDE                   
W37965     MOVE '02'                      TO ML090-DR-CR-CDE                    
W37965     MOVE REVAMT-SLS-TYP-CDE        TO ML090-SLS-TYP-CDE                  
W37965     IF REVAMT-PADJ-NET-COST-AMT NOT = ZERO OR                            
W37965        REVAMT-PADJ-GRO-COST-AMT NOT = ZERO OR                            
W37965        REVAMT-PADJ-RTL-AMT      NOT = ZERO                               
W37965            MOVE '15'               TO ML090-TRN-TYP-CDE(2:2)             
W37965     END-IF                                                               
W37965     MOVE REVAMT-PRCHG-RSN-CDE      TO ML090-PRCHG-RSN-CDE                
W37965     MOVE REVAMT-PRCHG-CTG-CDE      TO ML090-PRCHG-CTG-CDE                
W37965     MOVE REVAMT-SKU-NBR            TO PV-SKU-NBR                         
W37965     IF PV-SKU-NBR = ZEROES OR                                            
W37965        PV-SKU-NBR = SPACES OR                                            
W37965        PV-SKU-NBR (6:3) = 000 OR                                         
W37965        PV-SKU-NBR (6:3) = 999                                            
W37965             MOVE 'Y'   TO ML090-DUMMY-SKU-IND                            
W37965     ELSE                                                                 
W37965             MOVE 'N'   TO ML090-DUMMY-SKU-IND                            
W37965     END-IF                                                               
W37965     COMPUTE PV-WORK-AMOUNT =  REVAMT-SLS-REG-RTL-AMT                     
W37965                               +  REVAMT-SLS-PROMO-RTL-AMT                
W37965                               +  REVAMT-SLS-PROCLR-RTL-AMT               
W37965                               +  REVAMT-SLS-CLR-RTL-AMT                  
W37965                               +  REVAMT-SLS-OTH-RTL-AMT                  
W37965     MOVE PV-WORK-AMOUNT            TO ML090-SLS-RTL-AMT                  
W37965*    IF REVAMT-MKDN-RTL-AMT NOT = ZERO                                    
W37965*         MOVE REVAMT-MKDN-RTL-AMT  TO ML090-PRCHG-RTL-AMT                
W37965*    ELSE                                                                 
W37965*         MOVE REVAMT-MKUP-RTL-AMT  TO ML090-PRCHG-RTL-AMT                
W37965*    END-IF                                                               
W37965*    WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                          
W37965*    ADD 1                  TO PA-OUT-AUDIT-RECS.                         
W37965     IF REVAMT-SLS-REG-RTL-AMT    NOT = ZERO                              
W37965         MOVE REVAMT-SLS-REG-RTL-AMT      TO ML090-SLS-RTL-AMT            
W37965         MOVE 'R'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF REVAMT-SLS-PROMO-RTL-AMT NOT = ZERO                               
W37965         MOVE REVAMT-SLS-PROMO-RTL-AMT    TO ML090-SLS-RTL-AMT            
W37965         MOVE 'P'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF REVAMT-SLS-PROCLR-RTL-AMT NOT = ZERO                              
W37965         MOVE REVAMT-SLS-PROCLR-RTL-AMT   TO ML090-SLS-RTL-AMT            
W37965         MOVE 'G'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF REVAMT-SLS-CLR-RTL-AMT NOT = ZERO                                 
W37965         MOVE REVAMT-SLS-CLR-RTL-AMT      TO ML090-SLS-RTL-AMT            
W37965         MOVE 'C'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF REVAMT-SLS-OTH-RTL-AMT NOT = ZERO                                 
W37965         MOVE REVAMT-SLS-OTH-RTL-AMT      TO ML090-SLS-RTL-AMT            
W37965         MOVE 'N'                         TO ML090-SLS-TYP-CDE            
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965     IF REVAMT-MKDN-RTL-AMT NOT = ZERO                            02026900
W37965         MOVE REVAMT-MKDN-RTL-AMT         TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC              02027300
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS              02027400
W37965     END-IF.                                                      02027500
W37965     IF REVAMT-MKUP-RTL-AMT NOT = ZERO                            02026900
W37965         MOVE REVAMT-MKUP-RTL-AMT         TO ML090-PRCHG-RTL-AMT  02027000
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC              02027300
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS              02027400
W37965     END-IF.                                                      02027500
W37965     IF REVAMT-SLS-REG-RTL-AMT    = ZERO AND                              
W37965        REVAMT-SLS-PROMO-RTL-AMT  = ZERO AND                              
W37965        REVAMT-SLS-PROCLR-RTL-AMT = ZERO AND                              
W37965        REVAMT-SLS-CLR-RTL-AMT    = ZERO AND                              
W37965        REVAMT-SLS-OTH-RTL-AMT    = ZERO AND                              
W37965        REVAMT-MKDN-RTL-AMT       = ZERO AND                              
W37965        REVAMT-MKUP-RTL-AMT       = ZERO                                  
W37965         WRITE DTL-AUDIT-RECORD FROM ML090-AUDIT-REC                      
W37965         ADD 1                  TO PA-OUT-AUDIT-RECS                      
W37965     END-IF.                                                              
W37965                                                                          
      ******************************************************************        
      *   OPENS THE BRAND VENDOR CURSOR                                *        
      ******************************************************************        
       3000-OPEN-BRND-VND-CSR.                                                  
           EXEC SQL                                                             
               OPEN BRND_VND_CSR                                                
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLCODE NOT EQUAL ZERO                                      
                   MOVE '3000-OPEN-BRND-VND-CSR'                                
                                       TO PV-PARAGRAPH-NAME                     
                   MOVE 'ERROR IN OPEN - BRND_VND_CSR'                          
                                       TO PV-OPER-ATTEMPTED                     
                   PERFORM 9000-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   FETCHES FROM THE BRAND VENDOR CURSOR                         *        
      ******************************************************************        
       3100-FETCH-BRND-VND-CSR.                                                 
           EXEC SQL                                                             
               FETCH BRND_VND_CSR                                               
               INTO  :PV-SQL-DEPT,                                              
                     :PV-SQL-LBL-SEQ-NBR,                                       
                     :PV-SQL-ENT-ID,                                            
                     :PV-SQL-DKEY                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                    PERFORM 3110-LOAD-INT-TABLE                                 
               WHEN SQLCODE = 100                                               
                    MOVE PV-INDX                                                
                      TO PV-HOLD-INDX                                           
                    MOVE ZEROS TO PV-INDX                                       
                    IF PV-CUM-EIR EQUAL ZERO                                    
                       PERFORM 7100-WRITE-NO-PRORT-FILE                         
                    ELSE                                                        
                       PERFORM 4100-BUILD-REPORT-BEFORE                         
                       PERFORM 3120-CALC-PCT PV-HOLD-INDX TIMES                 
                       COMPUTE PV-IT-PERCENT(PV-H-INDX)                         
                                               = 100 - PV-CUM-PCT-HOLD          
                       PERFORM 2400-CALC-HIGHEST-AMT                            
                       PERFORM 2500-REV-AMNT-FILE                               
                       PERFORM 4300-BUILD-REPORT-TOTALS                         
                    END-IF                                                      
                    SET PS-END-OF-B-V-CSR-YES                                   
                     TO TRUE                                                    
               WHEN OTHER                                                       
                   MOVE '3100-FETCH-BRND-VND-CSR'                               
                                       TO PV-PARAGRAPH-NAME                     
                   MOVE 'ERROR IN FETCH - BRND_VND_CSR'                         
                                       TO PV-OPER-ATTEMPTED                     
                   PERFORM 9000-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   LOADS THE INTERNAL TABLE                                     *        
      ******************************************************************        
       3110-LOAD-INT-TABLE.                                                     
           EXEC SQL                                                             
               SELECT SUM(END_INV_RTL_AMT)                                      
                 INTO :PV-EIR                                                   
                 FROM MLT_WKLY_SUM                                              
                WHERE PARTN_NBR IN (                                            
                              SELECT PARTN_NBR                                  
                                FROM MLT_PARTN_CNTL                             
                               WHERE TBL_TM_LVL_CDE = 'W'                       
                                 AND FSCL_DTE = :DTATTR-FSCL-WK-END-DTE         
                                   )                                            
                AND DEPT_NBR = :PV-SQL-DEPT                                     
                AND ML_LO_MDSE_LVL_ID= :PV-SQL-DKEY                             
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   ADD +1 TO PV-INDX                                            
                   MOVE PV-SQL-DEPT                                             
                     TO PV-IT-DEPT(PV-INDX)                                     
                   MOVE PV-SQL-LBL-SEQ-NBR                                      
                     TO PV-IT-BRND(PV-INDX)                                     
                   MOVE PV-SQL-ENT-ID                                           
                     TO PV-IT-ENT-ID(PV-INDX)                                   
                   MOVE PV-SQL-DKEY                                             
                     TO PV-IT-DKEY(PV-INDX)                                     
                   MOVE PV-EIR                                                  
                     TO PV-IT-EIR(PV-INDX)                                      
                   ADD PV-EIR TO PV-CUM-EIR                                     
                   IF PV-IT-EIR(PV-INDX) NOT EQUAL ZERO                         
                      IF PV-HIGHEST-EIR EQUAL ZERO                              
                         MOVE PV-IT-EIR(PV-INDX) TO PV-HIGHEST-EIR              
                         MOVE PV-INDX TO PV-H-INDX                              
                      ELSE                                                      
                         IF PV-IT-EIR(PV-INDX) > PV-HIGHEST-EIR                 
                            MOVE PV-IT-EIR(PV-INDX) TO PV-HIGHEST-EIR           
                            MOVE PV-INDX TO PV-H-INDX                           
                         END-IF                                                 
                      END-IF                                                    
                   END-IF                                                       
               WHEN OTHER                                                       
                   MOVE ZEROS TO PV-EIR                                         
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   CALC THE PERCENTAGES FOR PRORATION                                    
      ******************************************************************        
       3120-CALC-PCT.                                                           
           ADD +1 TO PV-INDX.                                                   
           IF PV-INDX EQUAL PV-H-INDX                                           
              CONTINUE                                                          
           ELSE                                                                 
              COMPUTE PV-IT-PERCENT(PV-INDX)=                                   
                      (PV-IT-EIR(PV-INDX) / PV-CUM-EIR) * 100                   
           END-IF.                                                              
           ADD PV-IT-PERCENT(PV-INDX)                                           
            TO PV-CUM-PCT-HOLD.                                                 
           IF PV-IT-PERCENT(PV-INDX) EQUAL ZERO                                 
              CONTINUE                                                          
           ELSE                                                                 
              PERFORM 2300-PRORATE-PROCESSING                                   
           END-IF.                                                              
                                                                                
      ******************************************************************        
      *   CLOSES THE BRAND VENDOR CURSOR                               *        
      ******************************************************************        
       3200-CLOSE-BRND-VND-CSR.                                                 
           EXEC SQL                                                             
               CLOSE BRND_VND_CSR                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLCODE NOT EQUAL ZERO                                      
                   MOVE '3200-CLOSE-BRND-VND-CSR'                               
                                       TO PV-PARAGRAPH-NAME                     
                   MOVE 'ERROR IN CLOSE - BRND_VND_CSR'                         
                                       TO PV-OPER-ATTEMPTED                     
                   PERFORM 9000-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   OPENS THE BRAND CURSOR                                       *        
      ******************************************************************        
       3300-OPEN-BRND-CSR.                                                      
           EXEC SQL                                                             
               OPEN BRND_CSR                                                    
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLCODE NOT EQUAL ZERO                                      
                   MOVE '3300-OPEN-BRND-CSR'                                    
                                       TO PV-PARAGRAPH-NAME                     
                   MOVE 'ERROR IN OPEN - BRND_CSR'                              
                                       TO PV-OPER-ATTEMPTED                     
                   PERFORM 9000-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   FETCHES FROM THE BRAND CURSOR                                *        
      ******************************************************************        
       3400-FETCH-BRND-CSR.                                                     
           EXEC SQL                                                             
               FETCH BRND_CSR                                                   
               INTO  :PV-SQL-DEPT,                                              
                     :PV-SQL-LBL-SEQ-NBR,                                       
                     :PV-SQL-ENT-ID,                                            
                     :PV-SQL-DKEY                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                    PERFORM 3110-LOAD-INT-TABLE                                 
               WHEN SQLCODE = 100                                               
                    MOVE PV-INDX                                                
                      TO PV-HOLD-INDX                                           
                    MOVE ZEROS TO PV-INDX                                       
                    IF PV-CUM-EIR EQUAL ZERO                                    
                       PERFORM 7100-WRITE-NO-PRORT-FILE                         
                    ELSE                                                        
                       PERFORM 4100-BUILD-REPORT-BEFORE                         
                       PERFORM 3120-CALC-PCT PV-HOLD-INDX TIMES                 
                       COMPUTE PV-IT-PERCENT(PV-H-INDX)                         
                                               = 100 - PV-CUM-PCT-HOLD          
                       PERFORM 2400-CALC-HIGHEST-AMT                            
                       PERFORM 2500-REV-AMNT-FILE                               
                       PERFORM 4300-BUILD-REPORT-TOTALS                         
                    END-IF                                                      
                   SET PS-END-OF-BRND-CSR-YES                                   
                                       TO TRUE                                  
               WHEN OTHER                                                       
                   MOVE '3400-FETCH-BRND-CSR'                                   
                                       TO PV-PARAGRAPH-NAME                     
                   MOVE 'ERROR IN FETCH - BRND_CSR'                             
                                       TO PV-OPER-ATTEMPTED                     
                   PERFORM 9000-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   CLOSES THE BRAND CURSOR                                      *        
      ******************************************************************        
       3500-CLOSE-BRND-CSR.                                                     
           EXEC SQL                                                             
               CLOSE BRND_CSR                                                   
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLCODE NOT EQUAL ZERO                                      
                   MOVE '3500-CLOSE-BRND-CSR'                                   
                                       TO PV-PARAGRAPH-NAME                     
                   MOVE 'ERROR IN CLOSE - BRND_CSR'                             
                                       TO PV-OPER-ATTEMPTED                     
                   PERFORM 9000-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   GETS THE FISCAL WEEK ENDING DATE                             *        
      ******************************************************************        
       3600-GET-PREV-CNTL-DATE.                                                 
           EXEC SQL                                                             
               SELECT  FSCL_WK_END_DTE                                          
               INTO    :DTATTR-FSCL-WK-END-DTE                                  
               FROM    TDTATTR                                                  
               WHERE   KY_DTE = (DATE(:PV-PROC-DATE-ISO) - 7 DAYS)              
               WITH UR                                                          
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLCODE NOT EQUAL ZERO                                      
                   MOVE '3600-GET-PREV-CNTL-DATE'                               
                                       TO PV-PARAGRAPH-NAME                     
                   MOVE 'ERROR IN SELECT - TDTATTR'                             
                                       TO PV-OPER-ATTEMPTED                     
                   PERFORM 9000-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   CHECK ALL THE MONEY AMTS ON THE INPUT FILE                   *        
      ******************************************************************        
       4000-CHECK-INP-MONEY-AMTS.                                               
           IF  (UKAMT-SLS-REG-RTL-AMT    EQUAL ZERO AND                         
                UKAMT-SLS-PROMO-RTL-AMT  EQUAL ZERO AND                         
                UKAMT-SLS-PROCLR-RTL-AMT EQUAL ZERO AND                         
                UKAMT-SLS-CLR-RTL-AMT    EQUAL ZERO AND                         
                UKAMT-SLS-OTH-RTL-AMT    EQUAL ZERO AND                         
                UKAMT-MKDN-PLU-RTL-AMT   EQUAL ZERO AND                         
                UKAMT-MKDN-PROMO-RTL-AMT EQUAL ZERO AND                         
                UKAMT-MKDN-RGST-RTL-AMT  EQUAL ZERO AND                         
                UKAMT-MKDN-GLDST-RTL-AMT EQUAL ZERO AND                         
                UKAMT-MKDN-UMTCH-RTL-AMT EQUAL ZERO AND                         
                UKAMT-MKDN-BYR-RTL-AMT   EQUAL ZERO AND                         
                UKAMT-MKDN-STR-RTL-AMT   EQUAL ZERO AND                         
                UKAMT-MKDN-PRPT-RTL-AMT  EQUAL ZERO AND                         
                UKAMT-MKDN-OTH-RTL-AMT   EQUAL ZERO AND                         
                UKAMT-MKDN-RTL-AMT       EQUAL ZERO AND                         
                UKAMT-MKUP-RTL-AMT       EQUAL ZERO AND                         
                UKAMT-XFER-IN-RTL-AMT    EQUAL ZERO AND                         
                UKAMT-XFER-OUT-RTL-AMT   EQUAL ZERO AND                         
                UKAMT-RCPT-RTL-AMT       EQUAL ZERO AND                         
                UKAMT-RCPT-NET-COST-AMT  EQUAL ZERO AND                         
                UKAMT-RCPT-GRO-COST-AMT  EQUAL ZERO AND                         
                UKAMT-RCPT-FRGT-COST-AMT EQUAL ZERO AND                         
                UKAMT-PADJ-RTL-AMT       EQUAL ZERO AND                         
                UKAMT-PADJ-FRGT-COST-AMT EQUAL ZERO AND                         
                UKAMT-PADJ-DISC-COST-AMT EQUAL ZERO AND                         
                UKAMT-PADJ-RTV-COST-AMT  EQUAL ZERO AND                         
                UKAMT-PADJ-RTV-RTL-AMT   EQUAL ZERO AND                         
                UKAMT-PADJ-DA-COST-AMT   EQUAL ZERO AND                         
                UKAMT-PADJ-DA-RTL-AMT    EQUAL ZERO AND                         
                UKAMT-PADJ-NET-COST-AMT  EQUAL ZERO AND                         
                UKAMT-PADJ-OTH-COST-AMT  EQUAL ZERO AND                         
                UKAMT-PADJ-OTH-RTL-AMT   EQUAL ZERO AND                         
                UKAMT-PADJ-GRO-COST-AMT  EQUAL ZERO AND                         
                UKAMT-DR-ALW-RTL-AMT     EQUAL ZERO AND                         
                UKAMT-RTV-RTL-AMT        EQUAL ZERO AND                         
                UKAMT-MKUP-INIT-AMT      EQUAL ZERO AND                         
                UKAMT-MKUP-NET-AMT       EQUAL ZERO AND                         
                UKAMT-INV-ADJ-RTL-AMT    EQUAL ZERO AND                         
                UKAMT-ONORD-RTL-AMT      EQUAL ZERO AND                         
                UKAMT-ONORD-COST-AMT     EQUAL ZERO AND                         
                UKAMT-SHNK-RTL-AMT       EQUAL ZERO AND                         
                UKAMT-END-INV-RTL-AMT    EQUAL ZERO AND                         
                UKAMT-END-INV-COST-AMT   EQUAL ZERO AND                         
                UKAMT-GRO-MRGN-AMT       EQUAL ZERO AND                         
                UKAMT-IN-TRNST-RTL-AMT   EQUAL ZERO AND                         
                UKAMT-RCPT-DISC-COST-AMT EQUAL ZERO AND                         
                UKAMT-STR-EXPTED-RTL-AMT EQUAL ZERO)                            
              SET PS-ALL-MONEY-AMT-ZERO-YES TO TRUE                             
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * BUILD THE BEFORE PRORATION REPORT COLUMNS AT A KEY LEVEL.               
      ******************************************************************        
       4100-BUILD-REPORT-BEFORE.                                                
           INITIALIZE DL-KEY.                                                   
           INITIALIZE DL-VERBIAGE.                                              
                                                                                
           MOVE UKAMT-DEPT-NBR      TO DL-DEPT-NBR.                             
           MOVE UKAMT-SUB-CL-NBR    TO DL-SUB-CL-NBR.                           
           MOVE UKAMT-LOC-NBR       TO DL-LOC-NBR.                              
           MOVE UKAMT-TRN-TYP-CDE   TO DL-TRN-TYP-CDE.                          
           MOVE UKAMT-ENT-ID        TO DL-ENT-ID-PURCHASE                       
                                       DL-ENT-ID-PRC-CHG                        
                                       DL-ENT-ID-SALES.                         
           MOVE UKAMT-LBL-SEQ-NBR   TO DL-LBL-SEQ-NBR-PURCHASE                  
                                       DL-LBL-SEQ-NBR-PRC-CHG                   
                                       DL-LBL-SEQ-NBR-SALES.                    
           MOVE UKAMT-ML-LWST-ID    TO DL-DKEY-PURCHASE                         
                                       DL-DKEY-PRC-CHG                          
                                       DL-DKEY-SALES.                           
           MOVE DL-KEY              TO DL-KEY-PURCHASE                          
                                       DL-KEY-PRC-CHG                           
                                       DL-KEY-SALES.                            
                                                                                
           MOVE UKAMT-SLS-REG-RTL-AMT    TO DL-SLS-REG-RTL-AMT.                 
           MOVE UKAMT-SLS-PROMO-RTL-AMT  TO DL-SLS-PROMO-RTL-AMT.               
           MOVE UKAMT-SLS-PROCLR-RTL-AMT TO DL-SLS-PROCLR-RTL-AMT.              
           MOVE UKAMT-SLS-CLR-RTL-AMT    TO DL-SLS-CLR-RTL-AMT.                 
           MOVE UKAMT-SLS-OTH-RTL-AMT    TO DL-SLS-OTH-RTL-AMT.                 
           MOVE UKAMT-MKDN-PLU-RTL-AMT   TO DL-MKDN-PLU-RTL-AMT.                
           MOVE UKAMT-MKDN-PROMO-RTL-AMT TO DL-MKDN-PROMO-RTL-AMT.              
           MOVE UKAMT-MKDN-RGST-RTL-AMT  TO DL-MKDN-RGST-RTL-AMT.               
           MOVE UKAMT-MKDN-GLDST-RTL-AMT TO DL-MKDN-GLDST-RTL-AMT.              
           MOVE UKAMT-MKDN-UMTCH-RTL-AMT TO DL-MKDN-UMTCH-RTL-AMT.              
           MOVE UKAMT-MKDN-BYR-RTL-AMT   TO DL-MKDN-BYR-RTL-AMT.                
           MOVE UKAMT-MKDN-STR-RTL-AMT   TO DL-MKDN-STR-RTL-AMT.                
           MOVE UKAMT-MKDN-PRPT-RTL-AMT  TO DL-MKDN-PRPT-RTL-AMT.               
           MOVE UKAMT-MKDN-OTH-RTL-AMT   TO DL-MKDN-OTH-RTL-AMT.                
           MOVE UKAMT-MKDN-RTL-AMT       TO DL-MKDN-RTL-AMT.                    
           MOVE UKAMT-MKUP-RTL-AMT       TO DL-MKUP-RTL-AMT.                    
           MOVE UKAMT-MKUP-INIT-AMT      TO DL-MKUP-INIT-AMT.                   
           MOVE UKAMT-MKUP-NET-AMT       TO DL-MKUP-NET-AMT.                    
           MOVE UKAMT-XFER-IN-RTL-AMT    TO DL-XFER-IN-RTL-AMT.                 
           MOVE UKAMT-XFER-OUT-RTL-AMT   TO DL-XFER-OUT-RTL-AMT.                
           MOVE UKAMT-RCPT-RTL-AMT       TO DL-RCPT-RTL-AMT.                    
           MOVE UKAMT-RCPT-NET-COST-AMT  TO DL-RCPT-NET-COST-AMT.               
           MOVE UKAMT-RCPT-GRO-COST-AMT  TO DL-RCPT-GRO-COST-AMT.               
           MOVE UKAMT-RCPT-FRGT-COST-AMT TO DL-RCPT-FRGT-COST-AMT.              
           MOVE UKAMT-PADJ-RTL-AMT       TO DL-PADJ-RTL-AMT.                    
           MOVE UKAMT-PADJ-FRGT-COST-AMT TO DL-PADJ-FRGT-COST-AMT.              
           MOVE UKAMT-PADJ-DISC-COST-AMT TO DL-PADJ-DISC-COST-AMT.              
           MOVE UKAMT-PADJ-RTV-COST-AMT  TO DL-PADJ-RTV-COST-AMT.               
           MOVE UKAMT-PADJ-RTV-RTL-AMT   TO DL-PADJ-RTV-RTL-AMT.                
           MOVE UKAMT-PADJ-DA-COST-AMT   TO DL-PADJ-DA-COST-AMT.                
           MOVE UKAMT-PADJ-DA-RTL-AMT    TO DL-PADJ-DA-RTL-AMT.                 
           MOVE UKAMT-PADJ-NET-COST-AMT  TO DL-PADJ-NET-COST-AMT.               
           MOVE UKAMT-PADJ-OTH-COST-AMT  TO DL-PADJ-OTH-COST-AMT.               
           MOVE UKAMT-PADJ-OTH-RTL-AMT   TO DL-PADJ-OTH-RTL-AMT.                
           MOVE UKAMT-PADJ-GRO-COST-AMT  TO DL-PADJ-GRO-COST-AMT.               
           MOVE UKAMT-DR-ALW-RTL-AMT     TO DL-DR-ALW-RTL-AMT.                  
           MOVE UKAMT-RTV-RTL-AMT        TO DL-RTV-RTL-AMT.                     
                                                                                
           PERFORM 5000-PRINT-DETAIL-LINE.                                      
                                                                                
           ADD UKAMT-SLS-REG-RTL-AMT    TO PV-SLS-REG-RTL-AMT.                  
           ADD UKAMT-SLS-PROMO-RTL-AMT  TO PV-SLS-PROMO-RTL-AMT.                
           ADD UKAMT-SLS-PROCLR-RTL-AMT TO PV-SLS-PROCLR-RTL-AMT.               
           ADD UKAMT-SLS-CLR-RTL-AMT    TO PV-SLS-CLR-RTL-AMT.                  
           ADD UKAMT-SLS-OTH-RTL-AMT    TO PV-SLS-OTH-RTL-AMT.                  
           ADD UKAMT-MKDN-PLU-RTL-AMT   TO PV-MKDN-PLU-RTL-AMT.                 
           ADD UKAMT-MKDN-PROMO-RTL-AMT TO PV-MKDN-PROMO-RTL-AMT.               
           ADD UKAMT-MKDN-RGST-RTL-AMT  TO PV-MKDN-RGST-RTL-AMT.                
           ADD UKAMT-MKDN-GLDST-RTL-AMT TO PV-MKDN-GLDST-RTL-AMT.               
           ADD UKAMT-MKDN-UMTCH-RTL-AMT TO PV-MKDN-UMTCH-RTL-AMT.               
           ADD UKAMT-MKDN-BYR-RTL-AMT   TO PV-MKDN-BYR-RTL-AMT.                 
           ADD UKAMT-MKDN-STR-RTL-AMT   TO PV-MKDN-STR-RTL-AMT.                 
           ADD UKAMT-MKDN-PRPT-RTL-AMT  TO PV-MKDN-PRPT-RTL-AMT.                
           ADD UKAMT-MKDN-OTH-RTL-AMT   TO PV-MKDN-OTH-RTL-AMT.                 
           ADD UKAMT-MKDN-RTL-AMT       TO PV-MKDN-RTL-AMT.                     
           ADD UKAMT-MKUP-RTL-AMT       TO PV-MKUP-RTL-AMT.                     
           ADD UKAMT-MKUP-INIT-AMT      TO PV-MKUP-INIT-AMT.                    
           ADD UKAMT-MKUP-NET-AMT       TO PV-MKUP-NET-AMT.                     
           ADD UKAMT-XFER-IN-RTL-AMT    TO PV-XFER-IN-RTL-AMT.                  
           ADD UKAMT-XFER-OUT-RTL-AMT   TO PV-XFER-OUT-RTL-AMT.                 
           ADD UKAMT-RCPT-RTL-AMT       TO PV-RCPT-RTL-AMT.                     
           ADD UKAMT-RCPT-NET-COST-AMT  TO PV-RCPT-NET-COST-AMT.                
           ADD UKAMT-RCPT-GRO-COST-AMT  TO PV-RCPT-GRO-COST-AMT.                
           ADD UKAMT-RCPT-FRGT-COST-AMT TO PV-RCPT-FRGT-COST-AMT.               
           ADD UKAMT-PADJ-RTL-AMT       TO PV-PADJ-RTL-AMT.                     
           ADD UKAMT-PADJ-FRGT-COST-AMT TO PV-PADJ-FRGT-COST-AMT.               
           ADD UKAMT-PADJ-DISC-COST-AMT TO PV-PADJ-DISC-COST-AMT.               
           ADD UKAMT-PADJ-RTV-COST-AMT  TO PV-PADJ-RTV-COST-AMT.                
           ADD UKAMT-PADJ-RTV-RTL-AMT   TO PV-PADJ-RTV-RTL-AMT.                 
           ADD UKAMT-PADJ-DA-COST-AMT   TO PV-PADJ-DA-COST-AMT.                 
           ADD UKAMT-PADJ-DA-RTL-AMT    TO PV-PADJ-DA-RTL-AMT.                  
           ADD UKAMT-PADJ-NET-COST-AMT  TO PV-PADJ-NET-COST-AMT.                
           ADD UKAMT-PADJ-OTH-COST-AMT  TO PV-PADJ-OTH-COST-AMT.                
           ADD UKAMT-PADJ-OTH-RTL-AMT   TO PV-PADJ-OTH-RTL-AMT.                 
           ADD UKAMT-PADJ-GRO-COST-AMT  TO PV-PADJ-GRO-COST-AMT.                
           ADD UKAMT-DR-ALW-RTL-AMT     TO PV-DR-ALW-RTL-AMT.                   
           ADD UKAMT-RTV-RTL-AMT        TO PV-RTV-RTL-AMT.                      
                                                                                
           ADD UKAMT-SLS-REG-RTL-AMT    TO TV-SLS-REG-RTL-AMT.                  
           ADD UKAMT-SLS-PROMO-RTL-AMT  TO TV-SLS-PROMO-RTL-AMT.                
           ADD UKAMT-SLS-PROCLR-RTL-AMT TO TV-SLS-PROCLR-RTL-AMT.               
           ADD UKAMT-SLS-CLR-RTL-AMT    TO TV-SLS-CLR-RTL-AMT.                  
           ADD UKAMT-SLS-OTH-RTL-AMT    TO TV-SLS-OTH-RTL-AMT.                  
           ADD UKAMT-MKDN-PLU-RTL-AMT   TO TV-MKDN-PLU-RTL-AMT.                 
           ADD UKAMT-MKDN-PROMO-RTL-AMT TO TV-MKDN-PROMO-RTL-AMT.               
           ADD UKAMT-MKDN-RGST-RTL-AMT  TO TV-MKDN-RGST-RTL-AMT.                
           ADD UKAMT-MKDN-GLDST-RTL-AMT TO TV-MKDN-GLDST-RTL-AMT.               
           ADD UKAMT-MKDN-UMTCH-RTL-AMT TO TV-MKDN-UMTCH-RTL-AMT.               
           ADD UKAMT-MKDN-BYR-RTL-AMT   TO TV-MKDN-BYR-RTL-AMT.                 
           ADD UKAMT-MKDN-STR-RTL-AMT   TO TV-MKDN-STR-RTL-AMT.                 
           ADD UKAMT-MKDN-PRPT-RTL-AMT  TO TV-MKDN-PRPT-RTL-AMT.                
           ADD UKAMT-MKDN-OTH-RTL-AMT   TO TV-MKDN-OTH-RTL-AMT.                 
           ADD UKAMT-MKDN-RTL-AMT       TO TV-MKDN-RTL-AMT.                     
           ADD UKAMT-MKUP-RTL-AMT       TO TV-MKUP-RTL-AMT.                     
           ADD UKAMT-MKUP-INIT-AMT      TO TV-MKUP-INIT-AMT.                    
           ADD UKAMT-MKUP-NET-AMT       TO TV-MKUP-NET-AMT.                     
           ADD UKAMT-XFER-IN-RTL-AMT    TO TV-XFER-IN-RTL-AMT.                  
           ADD UKAMT-XFER-OUT-RTL-AMT   TO TV-XFER-OUT-RTL-AMT.                 
           ADD UKAMT-RCPT-RTL-AMT       TO TV-RCPT-RTL-AMT.                     
           ADD UKAMT-RCPT-NET-COST-AMT  TO TV-RCPT-NET-COST-AMT.                
           ADD UKAMT-RCPT-GRO-COST-AMT  TO TV-RCPT-GRO-COST-AMT.                
           ADD UKAMT-RCPT-FRGT-COST-AMT TO TV-RCPT-FRGT-COST-AMT.               
           ADD UKAMT-PADJ-RTL-AMT       TO TV-PADJ-RTL-AMT.                     
           ADD UKAMT-PADJ-FRGT-COST-AMT TO TV-PADJ-FRGT-COST-AMT.               
           ADD UKAMT-PADJ-DISC-COST-AMT TO TV-PADJ-DISC-COST-AMT.               
           ADD UKAMT-PADJ-RTV-COST-AMT  TO TV-PADJ-RTV-COST-AMT.                
           ADD UKAMT-PADJ-RTV-RTL-AMT   TO TV-PADJ-RTV-RTL-AMT.                 
           ADD UKAMT-PADJ-DA-COST-AMT   TO TV-PADJ-DA-COST-AMT.                 
           ADD UKAMT-PADJ-DA-RTL-AMT    TO TV-PADJ-DA-RTL-AMT.                  
           ADD UKAMT-PADJ-NET-COST-AMT  TO TV-PADJ-NET-COST-AMT.                
           ADD UKAMT-PADJ-OTH-COST-AMT  TO TV-PADJ-OTH-COST-AMT.                
           ADD UKAMT-PADJ-OTH-RTL-AMT   TO TV-PADJ-OTH-RTL-AMT.                 
           ADD UKAMT-PADJ-GRO-COST-AMT  TO TV-PADJ-GRO-COST-AMT.                
           ADD UKAMT-DR-ALW-RTL-AMT     TO TV-DR-ALW-RTL-AMT.                   
           ADD UKAMT-RTV-RTL-AMT        TO TV-RTV-RTL-AMT.                      
                                                                                
      ******************************************************************        
      * BUILD THE PRORATED REPORT COLUMNS AT A KEY LEVEL.                       
      ******************************************************************        
       4200-BUILD-REPORT-PRORTED.                                               
           INITIALIZE DL-KEY                                                    
           INITIALIZE DL-VERBIAGE                                               
           MOVE '  >>PRORATED:'         TO DL-PRO-VERBIAGE                      
           MOVE BVPRFL-ENT-ID           TO DL-ENT-ID-PURCHASE                   
                                           DL-ENT-ID-PRC-CHG                    
                                           DL-ENT-ID-SALES.                     
           MOVE BVPRFL-LBL-SEQ-NBR      TO DL-LBL-SEQ-NBR-PURCHASE              
                                           DL-LBL-SEQ-NBR-PRC-CHG               
                                           DL-LBL-SEQ-NBR-SALES.                
           MOVE BVPRFL-ML-LWST-ID       TO DL-DKEY-PURCHASE                     
                                           DL-DKEY-PRC-CHG                      
                                           DL-DKEY-SALES.                       
           MOVE DL-VERBIAGE             TO DL-VERBIAGE-PURCHASE                 
                                           DL-VERBIAGE-PRC-CHG                  
                                           DL-VERBIAGE-SALES.                   
                                                                                
           MOVE BVPRFL-SLS-REG-RTL-AMT   TO DL-SLS-REG-RTL-AMT.                 
           MOVE BVPRFL-SLS-PROMO-RTL-AMT TO DL-SLS-PROMO-RTL-AMT.               
           MOVE BVPRFL-SLS-PROCLR-RTL-AMT TO DL-SLS-PROCLR-RTL-AMT.             
           MOVE BVPRFL-SLS-CLR-RTL-AMT   TO DL-SLS-CLR-RTL-AMT.                 
           MOVE BVPRFL-SLS-OTH-RTL-AMT   TO DL-SLS-OTH-RTL-AMT.                 
           MOVE BVPRFL-MKDN-PLU-RTL-AMT  TO DL-MKDN-PLU-RTL-AMT.                
           MOVE BVPRFL-MKDN-PROMO-RTL-AMT TO DL-MKDN-PROMO-RTL-AMT.             
           MOVE BVPRFL-MKDN-RGST-RTL-AMT TO DL-MKDN-RGST-RTL-AMT.               
           MOVE BVPRFL-MKDN-GLDST-RTL-AMT TO DL-MKDN-GLDST-RTL-AMT.             
           MOVE BVPRFL-MKDN-UMTCH-RTL-AMT TO DL-MKDN-UMTCH-RTL-AMT.             
           MOVE BVPRFL-MKDN-BYR-RTL-AMT  TO DL-MKDN-BYR-RTL-AMT.                
           MOVE BVPRFL-MKDN-STR-RTL-AMT  TO DL-MKDN-STR-RTL-AMT.                
           MOVE BVPRFL-MKDN-PRPT-RTL-AMT TO DL-MKDN-PRPT-RTL-AMT.               
           MOVE BVPRFL-MKDN-OTH-RTL-AMT  TO DL-MKDN-OTH-RTL-AMT.                
           MOVE BVPRFL-MKDN-RTL-AMT      TO DL-MKDN-RTL-AMT.                    
           MOVE BVPRFL-MKUP-RTL-AMT      TO DL-MKUP-RTL-AMT.                    
           MOVE BVPRFL-MKUP-INIT-AMT     TO DL-MKUP-INIT-AMT.                   
           MOVE BVPRFL-MKUP-NET-AMT      TO DL-MKUP-NET-AMT.                    
           MOVE BVPRFL-XFER-IN-RTL-AMT   TO DL-XFER-IN-RTL-AMT.                 
           MOVE BVPRFL-XFER-OUT-RTL-AMT  TO DL-XFER-OUT-RTL-AMT.                
           MOVE BVPRFL-RCPT-RTL-AMT      TO DL-RCPT-RTL-AMT.                    
           MOVE BVPRFL-RCPT-NET-COST-AMT TO DL-RCPT-NET-COST-AMT.               
           MOVE BVPRFL-RCPT-GRO-COST-AMT TO DL-RCPT-GRO-COST-AMT.               
           MOVE BVPRFL-RCPT-FRGT-COST-AMT TO DL-RCPT-FRGT-COST-AMT.             
           MOVE BVPRFL-PADJ-RTL-AMT      TO DL-PADJ-RTL-AMT.                    
           MOVE BVPRFL-PADJ-FRGT-COST-AMT TO DL-PADJ-FRGT-COST-AMT.             
           MOVE BVPRFL-PADJ-DISC-COST-AMT TO DL-PADJ-DISC-COST-AMT.             
           MOVE BVPRFL-PADJ-RTV-COST-AMT TO DL-PADJ-RTV-COST-AMT.               
           MOVE BVPRFL-PADJ-RTV-RTL-AMT  TO DL-PADJ-RTV-RTL-AMT.                
           MOVE BVPRFL-PADJ-DA-COST-AMT  TO DL-PADJ-DA-COST-AMT.                
           MOVE BVPRFL-PADJ-DA-RTL-AMT   TO DL-PADJ-DA-RTL-AMT.                 
           MOVE BVPRFL-PADJ-NET-COST-AMT TO DL-PADJ-NET-COST-AMT.               
           MOVE BVPRFL-PADJ-OTH-COST-AMT TO DL-PADJ-OTH-COST-AMT.               
           MOVE BVPRFL-PADJ-OTH-RTL-AMT  TO DL-PADJ-OTH-RTL-AMT.                
           MOVE BVPRFL-PADJ-GRO-COST-AMT TO DL-PADJ-GRO-COST-AMT.               
           MOVE BVPRFL-DR-ALW-RTL-AMT    TO DL-DR-ALW-RTL-AMT.                  
           MOVE BVPRFL-RTV-RTL-AMT       TO DL-RTV-RTL-AMT.                     
                                                                                
           PERFORM 5000-PRINT-DETAIL-LINE.                                      
                                                                                
           ADD BVPRFL-SLS-REG-RTL-AMT   TO PV-SLS-REG-RTL-AMT-PRO.              
           ADD BVPRFL-SLS-PROMO-RTL-AMT TO PV-SLS-PROMO-RTL-AMT-PRO.            
           ADD BVPRFL-SLS-PROCLR-RTL-AMT TO PV-SLS-PROCLR-RTL-AMT-PRO.          
           ADD BVPRFL-SLS-CLR-RTL-AMT   TO PV-SLS-CLR-RTL-AMT-PRO.              
           ADD BVPRFL-SLS-OTH-RTL-AMT   TO PV-SLS-OTH-RTL-AMT-PRO.              
           ADD BVPRFL-MKDN-PLU-RTL-AMT  TO PV-MKDN-PLU-RTL-AMT-PRO.             
           ADD BVPRFL-MKDN-PROMO-RTL-AMT TO PV-MKDN-PROMO-RTL-AMT-PRO.          
           ADD BVPRFL-MKDN-RGST-RTL-AMT TO PV-MKDN-RGST-RTL-AMT-PRO.            
           ADD BVPRFL-MKDN-GLDST-RTL-AMT TO PV-MKDN-GLDST-RTL-AMT-PRO.          
           ADD BVPRFL-MKDN-UMTCH-RTL-AMT TO PV-MKDN-UMTCH-RTL-AMT-PRO.          
           ADD BVPRFL-MKDN-BYR-RTL-AMT  TO PV-MKDN-BYR-RTL-AMT-PRO.             
           ADD BVPRFL-MKDN-STR-RTL-AMT  TO PV-MKDN-STR-RTL-AMT-PRO.             
           ADD BVPRFL-MKDN-PRPT-RTL-AMT TO PV-MKDN-PRPT-RTL-AMT-PRO.            
           ADD BVPRFL-MKDN-OTH-RTL-AMT  TO PV-MKDN-OTH-RTL-AMT-PRO.             
           ADD BVPRFL-MKDN-RTL-AMT      TO PV-MKDN-RTL-AMT-PRO.                 
           ADD BVPRFL-MKUP-RTL-AMT      TO PV-MKUP-RTL-AMT-PRO.                 
           ADD BVPRFL-MKUP-INIT-AMT     TO PV-MKUP-INIT-AMT-PRO.                
           ADD BVPRFL-MKUP-NET-AMT      TO PV-MKUP-NET-AMT-PRO.                 
           ADD BVPRFL-XFER-IN-RTL-AMT   TO PV-XFER-IN-RTL-AMT-PRO.              
           ADD BVPRFL-XFER-OUT-RTL-AMT  TO PV-XFER-OUT-RTL-AMT-PRO.             
           ADD BVPRFL-RCPT-RTL-AMT      TO PV-RCPT-RTL-AMT-PRO.                 
           ADD BVPRFL-RCPT-NET-COST-AMT TO PV-RCPT-NET-COST-AMT-PRO.            
           ADD BVPRFL-RCPT-GRO-COST-AMT TO PV-RCPT-GRO-COST-AMT-PRO.            
           ADD BVPRFL-RCPT-FRGT-COST-AMT TO PV-RCPT-FRGT-COST-AMT-PRO.          
           ADD BVPRFL-PADJ-RTL-AMT      TO PV-PADJ-RTL-AMT-PRO.                 
           ADD BVPRFL-PADJ-FRGT-COST-AMT TO PV-PADJ-FRGT-COST-AMT-PRO.          
           ADD BVPRFL-PADJ-DISC-COST-AMT TO PV-PADJ-DISC-COST-AMT-PRO.          
           ADD BVPRFL-PADJ-RTV-COST-AMT TO PV-PADJ-RTV-COST-AMT-PRO.            
           ADD BVPRFL-PADJ-RTV-RTL-AMT  TO PV-PADJ-RTV-RTL-AMT-PRO.             
           ADD BVPRFL-PADJ-DA-COST-AMT  TO PV-PADJ-DA-COST-AMT-PRO.             
           ADD BVPRFL-PADJ-DA-RTL-AMT   TO PV-PADJ-DA-RTL-AMT-PRO.              
           ADD BVPRFL-PADJ-NET-COST-AMT TO PV-PADJ-NET-COST-AMT-PRO.            
           ADD BVPRFL-PADJ-OTH-COST-AMT TO PV-PADJ-OTH-COST-AMT-PRO.            
           ADD BVPRFL-PADJ-OTH-RTL-AMT  TO PV-PADJ-OTH-RTL-AMT-PRO.             
           ADD BVPRFL-PADJ-GRO-COST-AMT TO PV-PADJ-GRO-COST-AMT-PRO.            
           ADD BVPRFL-DR-ALW-RTL-AMT    TO PV-DR-ALW-RTL-AMT-PRO.               
           ADD BVPRFL-RTV-RTL-AMT       TO PV-RTV-RTL-AMT-PRO.                  
                                                                                
           ADD BVPRFL-SLS-REG-RTL-AMT   TO TV-SLS-REG-RTL-AMT-PRO.              
           ADD BVPRFL-SLS-PROMO-RTL-AMT TO TV-SLS-PROMO-RTL-AMT-PRO.            
           ADD BVPRFL-SLS-PROCLR-RTL-AMT TO TV-SLS-PROCLR-RTL-AMT-PRO.          
           ADD BVPRFL-SLS-CLR-RTL-AMT   TO TV-SLS-CLR-RTL-AMT-PRO.              
           ADD BVPRFL-SLS-OTH-RTL-AMT   TO TV-SLS-OTH-RTL-AMT-PRO.              
           ADD BVPRFL-MKDN-PLU-RTL-AMT  TO TV-MKDN-PLU-RTL-AMT-PRO.             
           ADD BVPRFL-MKDN-PROMO-RTL-AMT TO TV-MKDN-PROMO-RTL-AMT-PRO.          
           ADD BVPRFL-MKDN-RGST-RTL-AMT TO TV-MKDN-RGST-RTL-AMT-PRO.            
           ADD BVPRFL-MKDN-GLDST-RTL-AMT TO TV-MKDN-GLDST-RTL-AMT-PRO.          
           ADD BVPRFL-MKDN-UMTCH-RTL-AMT TO TV-MKDN-UMTCH-RTL-AMT-PRO.          
           ADD BVPRFL-MKDN-BYR-RTL-AMT  TO TV-MKDN-BYR-RTL-AMT-PRO.             
           ADD BVPRFL-MKDN-STR-RTL-AMT  TO TV-MKDN-STR-RTL-AMT-PRO.             
           ADD BVPRFL-MKDN-PRPT-RTL-AMT TO TV-MKDN-PRPT-RTL-AMT-PRO.            
           ADD BVPRFL-MKDN-OTH-RTL-AMT  TO TV-MKDN-OTH-RTL-AMT-PRO.             
           ADD BVPRFL-MKDN-RTL-AMT      TO TV-MKDN-RTL-AMT-PRO.                 
           ADD BVPRFL-MKUP-RTL-AMT      TO TV-MKUP-RTL-AMT-PRO.                 
           ADD BVPRFL-MKUP-INIT-AMT     TO TV-MKUP-INIT-AMT-PRO.                
           ADD BVPRFL-MKUP-NET-AMT      TO TV-MKUP-NET-AMT-PRO.                 
           ADD BVPRFL-XFER-IN-RTL-AMT   TO TV-XFER-IN-RTL-AMT-PRO.              
           ADD BVPRFL-XFER-OUT-RTL-AMT  TO TV-XFER-OUT-RTL-AMT-PRO.             
           ADD BVPRFL-RCPT-RTL-AMT      TO TV-RCPT-RTL-AMT-PRO.                 
           ADD BVPRFL-RCPT-NET-COST-AMT TO TV-RCPT-NET-COST-AMT-PRO.            
           ADD BVPRFL-RCPT-GRO-COST-AMT TO TV-RCPT-GRO-COST-AMT-PRO.            
           ADD BVPRFL-RCPT-FRGT-COST-AMT TO TV-RCPT-FRGT-COST-AMT-PRO.          
           ADD BVPRFL-PADJ-RTL-AMT      TO TV-PADJ-RTL-AMT-PRO.                 
           ADD BVPRFL-PADJ-FRGT-COST-AMT TO TV-PADJ-FRGT-COST-AMT-PRO.          
           ADD BVPRFL-PADJ-DISC-COST-AMT TO TV-PADJ-DISC-COST-AMT-PRO.          
           ADD BVPRFL-PADJ-RTV-COST-AMT TO TV-PADJ-RTV-COST-AMT-PRO.            
           ADD BVPRFL-PADJ-RTV-RTL-AMT  TO TV-PADJ-RTV-RTL-AMT-PRO.             
           ADD BVPRFL-PADJ-DA-COST-AMT  TO TV-PADJ-DA-COST-AMT-PRO.             
           ADD BVPRFL-PADJ-DA-RTL-AMT   TO TV-PADJ-DA-RTL-AMT-PRO.              
           ADD BVPRFL-PADJ-NET-COST-AMT TO TV-PADJ-NET-COST-AMT-PRO.            
           ADD BVPRFL-PADJ-OTH-COST-AMT TO TV-PADJ-OTH-COST-AMT-PRO.            
           ADD BVPRFL-PADJ-OTH-RTL-AMT  TO TV-PADJ-OTH-RTL-AMT-PRO.             
           ADD BVPRFL-PADJ-GRO-COST-AMT TO TV-PADJ-GRO-COST-AMT-PRO.            
           ADD BVPRFL-DR-ALW-RTL-AMT    TO TV-DR-ALW-RTL-AMT-PRO.               
           ADD BVPRFL-RTV-RTL-AMT       TO TV-RTV-RTL-AMT-PRO.                  
                                                                                
      ******************************************************************        
      * BUILD THE TOTAL PRORATED REPORT COLUMNS AT A KEY LEVEL.                 
      ******************************************************************        
       4300-BUILD-REPORT-TOTALS.                                                
           IF PV-LINE-COUNTER > (PC-MAX-LINES + 4)                              
               PERFORM 5100-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           PERFORM 5300-PRINT-UL-LINE.                                          
                                                                                
           MOVE ' BEFORE TOTAL      ' TO TL-VERBIAGE-PURCHASE                   
                                         TL-VERBIAGE-PRC-CHG                    
                                         TL-VERBIAGE-SALES.                     
           MOVE PV-SLS-REG-RTL-AMT    TO TL-SLS-REG-RTL-AMT.                    
           MOVE PV-SLS-PROMO-RTL-AMT  TO TL-SLS-PROMO-RTL-AMT.                  
           MOVE PV-SLS-PROCLR-RTL-AMT TO TL-SLS-PROCLR-RTL-AMT.                 
           MOVE PV-SLS-CLR-RTL-AMT    TO TL-SLS-CLR-RTL-AMT.                    
           MOVE PV-SLS-OTH-RTL-AMT    TO TL-SLS-OTH-RTL-AMT.                    
           MOVE PV-MKDN-PLU-RTL-AMT   TO TL-MKDN-PLU-RTL-AMT.                   
           MOVE PV-MKDN-PROMO-RTL-AMT TO TL-MKDN-PROMO-RTL-AMT.                 
           MOVE PV-MKDN-RGST-RTL-AMT  TO TL-MKDN-RGST-RTL-AMT.                  
           MOVE PV-MKDN-GLDST-RTL-AMT TO TL-MKDN-GLDST-RTL-AMT.                 
           MOVE PV-MKDN-UMTCH-RTL-AMT TO TL-MKDN-UMTCH-RTL-AMT.                 
           MOVE PV-MKDN-BYR-RTL-AMT   TO TL-MKDN-BYR-RTL-AMT.                   
           MOVE PV-MKDN-STR-RTL-AMT   TO TL-MKDN-STR-RTL-AMT.                   
           MOVE PV-MKDN-PRPT-RTL-AMT  TO TL-MKDN-PRPT-RTL-AMT.                  
           MOVE PV-MKDN-OTH-RTL-AMT   TO TL-MKDN-OTH-RTL-AMT.                   
           MOVE PV-MKDN-RTL-AMT       TO TL-MKDN-RTL-AMT.                       
           MOVE PV-MKUP-RTL-AMT       TO TL-MKUP-RTL-AMT.                       
           MOVE PV-MKUP-INIT-AMT      TO TL-MKUP-INIT-AMT.                      
           MOVE PV-MKUP-NET-AMT       TO TL-MKUP-NET-AMT.                       
           MOVE PV-XFER-IN-RTL-AMT    TO TL-XFER-IN-RTL-AMT.                    
           MOVE PV-XFER-OUT-RTL-AMT   TO TL-XFER-OUT-RTL-AMT.                   
           MOVE PV-RCPT-RTL-AMT       TO TL-RCPT-RTL-AMT.                       
           MOVE PV-RCPT-NET-COST-AMT  TO TL-RCPT-NET-COST-AMT.                  
           MOVE PV-RCPT-GRO-COST-AMT  TO TL-RCPT-GRO-COST-AMT.                  
           MOVE PV-RCPT-FRGT-COST-AMT TO TL-RCPT-FRGT-COST-AMT.                 
           MOVE PV-PADJ-RTL-AMT       TO TL-PADJ-RTL-AMT.                       
           MOVE PV-PADJ-FRGT-COST-AMT TO TL-PADJ-FRGT-COST-AMT.                 
           MOVE PV-PADJ-DISC-COST-AMT TO TL-PADJ-DISC-COST-AMT.                 
           MOVE PV-PADJ-RTV-COST-AMT  TO TL-PADJ-RTV-COST-AMT.                  
           MOVE PV-PADJ-RTV-RTL-AMT   TO TL-PADJ-RTV-RTL-AMT.                   
           MOVE PV-PADJ-DA-COST-AMT   TO TL-PADJ-DA-COST-AMT.                   
           MOVE PV-PADJ-DA-RTL-AMT    TO TL-PADJ-DA-RTL-AMT.                    
           MOVE PV-PADJ-NET-COST-AMT  TO TL-PADJ-NET-COST-AMT.                  
           MOVE PV-PADJ-OTH-COST-AMT  TO TL-PADJ-OTH-COST-AMT.                  
           MOVE PV-PADJ-OTH-RTL-AMT   TO TL-PADJ-OTH-RTL-AMT.                   
           MOVE PV-PADJ-GRO-COST-AMT  TO TL-PADJ-GRO-COST-AMT.                  
           MOVE PV-DR-ALW-RTL-AMT     TO TL-DR-ALW-RTL-AMT.                     
           MOVE PV-RTV-RTL-AMT        TO TL-RTV-RTL-AMT.                        
                                                                                
           PERFORM 5200-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE '    PRORATED TOTAL:'     TO TL-VERBIAGE-PURCHASE               
                                             TL-VERBIAGE-PRC-CHG                
                                             TL-VERBIAGE-SALES.                 
           MOVE PV-SLS-REG-RTL-AMT-PRO    TO TL-SLS-REG-RTL-AMT.                
           MOVE PV-SLS-PROMO-RTL-AMT-PRO  TO TL-SLS-PROMO-RTL-AMT.              
           MOVE PV-SLS-PROCLR-RTL-AMT-PRO TO TL-SLS-PROCLR-RTL-AMT.             
           MOVE PV-SLS-CLR-RTL-AMT-PRO    TO TL-SLS-CLR-RTL-AMT.                
           MOVE PV-SLS-OTH-RTL-AMT-PRO    TO TL-SLS-OTH-RTL-AMT.                
           MOVE PV-MKDN-PLU-RTL-AMT-PRO   TO TL-MKDN-PLU-RTL-AMT.               
           MOVE PV-MKDN-PROMO-RTL-AMT-PRO TO TL-MKDN-PROMO-RTL-AMT.             
           MOVE PV-MKDN-RGST-RTL-AMT-PRO  TO TL-MKDN-RGST-RTL-AMT.              
           MOVE PV-MKDN-GLDST-RTL-AMT-PRO TO TL-MKDN-GLDST-RTL-AMT.             
           MOVE PV-MKDN-UMTCH-RTL-AMT-PRO TO TL-MKDN-UMTCH-RTL-AMT.             
           MOVE PV-MKDN-BYR-RTL-AMT-PRO   TO TL-MKDN-BYR-RTL-AMT.               
           MOVE PV-MKDN-STR-RTL-AMT-PRO   TO TL-MKDN-STR-RTL-AMT.               
           MOVE PV-MKDN-PRPT-RTL-AMT-PRO  TO TL-MKDN-PRPT-RTL-AMT.              
           MOVE PV-MKDN-OTH-RTL-AMT-PRO   TO TL-MKDN-OTH-RTL-AMT.               
           MOVE PV-MKDN-RTL-AMT-PRO       TO TL-MKDN-RTL-AMT.                   
           MOVE PV-MKUP-RTL-AMT-PRO       TO TL-MKUP-RTL-AMT.                   
           MOVE PV-MKUP-INIT-AMT-PRO      TO TL-MKUP-INIT-AMT.                  
           MOVE PV-MKUP-NET-AMT-PRO       TO TL-MKUP-NET-AMT.                   
           MOVE PV-XFER-IN-RTL-AMT-PRO    TO TL-XFER-IN-RTL-AMT.                
           MOVE PV-XFER-OUT-RTL-AMT-PRO   TO TL-XFER-OUT-RTL-AMT.               
           MOVE PV-RCPT-RTL-AMT-PRO       TO TL-RCPT-RTL-AMT.                   
           MOVE PV-RCPT-NET-COST-AMT-PRO  TO TL-RCPT-NET-COST-AMT.              
           MOVE PV-RCPT-GRO-COST-AMT-PRO  TO TL-RCPT-GRO-COST-AMT.              
           MOVE PV-RCPT-FRGT-COST-AMT-PRO TO TL-RCPT-FRGT-COST-AMT.             
           MOVE PV-PADJ-RTL-AMT-PRO       TO TL-PADJ-RTL-AMT.                   
           MOVE PV-PADJ-FRGT-COST-AMT-PRO TO TL-PADJ-FRGT-COST-AMT.             
           MOVE PV-PADJ-DISC-COST-AMT-PRO TO TL-PADJ-DISC-COST-AMT.             
           MOVE PV-PADJ-RTV-COST-AMT-PRO  TO TL-PADJ-RTV-COST-AMT.              
           MOVE PV-PADJ-RTV-RTL-AMT-PRO   TO TL-PADJ-RTV-RTL-AMT.               
           MOVE PV-PADJ-DA-COST-AMT-PRO   TO TL-PADJ-DA-COST-AMT.               
           MOVE PV-PADJ-DA-RTL-AMT-PRO    TO TL-PADJ-DA-RTL-AMT.                
           MOVE PV-PADJ-NET-COST-AMT-PRO  TO TL-PADJ-NET-COST-AMT.              
           MOVE PV-PADJ-OTH-COST-AMT-PRO  TO TL-PADJ-OTH-COST-AMT.              
           MOVE PV-PADJ-OTH-RTL-AMT-PRO   TO TL-PADJ-OTH-RTL-AMT.               
           MOVE PV-PADJ-GRO-COST-AMT-PRO  TO TL-PADJ-GRO-COST-AMT.              
           MOVE PV-DR-ALW-RTL-AMT-PRO     TO TL-DR-ALW-RTL-AMT.                 
           MOVE PV-RTV-RTL-AMT-PRO        TO TL-RTV-RTL-AMT.                    
                                                                                
           PERFORM 5200-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE SPACES                   TO PRORATE-RPT-RECORD.                 
           WRITE PRORATE-RPT-RECORD      AFTER ADVANCING 1 LINES.               
                                                                                
           ADD 4                        TO PV-LINE-COUNTER.                     
                                                                                
           MOVE ZEROS                   TO PV-SLS-REG-RTL-AMT.                  
           MOVE ZEROS                   TO PV-SLS-PROMO-RTL-AMT.                
           MOVE ZEROS                   TO PV-SLS-PROCLR-RTL-AMT.               
           MOVE ZEROS                   TO PV-SLS-CLR-RTL-AMT.                  
           MOVE ZEROS                   TO PV-SLS-OTH-RTL-AMT.                  
           MOVE ZEROS                   TO PV-MKDN-PLU-RTL-AMT.                 
           MOVE ZEROS                   TO PV-MKDN-PROMO-RTL-AMT.               
           MOVE ZEROS                   TO PV-MKDN-RGST-RTL-AMT.                
           MOVE ZEROS                   TO PV-MKDN-GLDST-RTL-AMT.               
           MOVE ZEROS                   TO PV-MKDN-UMTCH-RTL-AMT.               
           MOVE ZEROS                   TO PV-MKDN-BYR-RTL-AMT.                 
           MOVE ZEROS                   TO PV-MKDN-STR-RTL-AMT.                 
           MOVE ZEROS                   TO PV-MKDN-PRPT-RTL-AMT.                
           MOVE ZEROS                   TO PV-MKDN-OTH-RTL-AMT.                 
           MOVE ZEROS                   TO PV-MKDN-RTL-AMT.                     
           MOVE ZEROS                   TO PV-MKUP-RTL-AMT.                     
           MOVE ZEROS                   TO PV-MKUP-INIT-AMT.                    
           MOVE ZEROS                   TO PV-MKUP-NET-AMT.                     
           MOVE ZEROS                   TO PV-XFER-IN-RTL-AMT.                  
           MOVE ZEROS                   TO PV-XFER-OUT-RTL-AMT.                 
           MOVE ZEROS                   TO PV-RCPT-RTL-AMT.                     
           MOVE ZEROS                   TO PV-RCPT-NET-COST-AMT.                
           MOVE ZEROS                   TO PV-RCPT-GRO-COST-AMT.                
           MOVE ZEROS                   TO PV-RCPT-FRGT-COST-AMT.               
           MOVE ZEROS                   TO PV-PADJ-RTL-AMT.                     
           MOVE ZEROS                   TO PV-PADJ-FRGT-COST-AMT.               
           MOVE ZEROS                   TO PV-PADJ-DISC-COST-AMT.               
           MOVE ZEROS                   TO PV-PADJ-RTV-COST-AMT.                
           MOVE ZEROS                   TO PV-PADJ-RTV-RTL-AMT.                 
           MOVE ZEROS                   TO PV-PADJ-DA-COST-AMT.                 
           MOVE ZEROS                   TO PV-PADJ-DA-RTL-AMT.                  
           MOVE ZEROS                   TO PV-PADJ-NET-COST-AMT.                
           MOVE ZEROS                   TO PV-PADJ-OTH-COST-AMT.                
           MOVE ZEROS                   TO PV-PADJ-OTH-RTL-AMT.                 
           MOVE ZEROS                   TO PV-PADJ-GRO-COST-AMT.                
           MOVE ZEROS                   TO PV-DR-ALW-RTL-AMT.                   
           MOVE ZEROS                   TO PV-RTV-RTL-AMT.                      
                                                                                
           MOVE ZEROS                   TO PV-SLS-REG-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-SLS-PROMO-RTL-AMT-PRO.            
           MOVE ZEROS                   TO PV-SLS-PROCLR-RTL-AMT-PRO.           
           MOVE ZEROS                   TO PV-SLS-CLR-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-SLS-OTH-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-MKDN-PLU-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-MKDN-PROMO-RTL-AMT-PRO.           
           MOVE ZEROS                   TO PV-MKDN-RGST-RTL-AMT-PRO.            
           MOVE ZEROS                   TO PV-MKDN-GLDST-RTL-AMT-PRO.           
           MOVE ZEROS                   TO PV-MKDN-UMTCH-RTL-AMT-PRO.           
           MOVE ZEROS                   TO PV-MKDN-BYR-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-MKDN-STR-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-MKDN-PRPT-RTL-AMT-PRO.            
           MOVE ZEROS                   TO PV-MKDN-OTH-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-MKDN-RTL-AMT-PRO.                 
           MOVE ZEROS                   TO PV-MKUP-RTL-AMT-PRO.                 
           MOVE ZEROS                   TO PV-MKUP-INIT-AMT-PRO.                
           MOVE ZEROS                   TO PV-MKUP-NET-AMT-PRO.                 
           MOVE ZEROS                   TO PV-XFER-IN-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-XFER-OUT-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-RCPT-RTL-AMT-PRO.                 
           MOVE ZEROS                   TO PV-RCPT-NET-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-RCPT-GRO-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-RCPT-FRGT-COST-AMT-PRO.           
           MOVE ZEROS                   TO PV-PADJ-RTL-AMT-PRO.                 
           MOVE ZEROS                   TO PV-PADJ-FRGT-COST-AMT-PRO.           
           MOVE ZEROS                   TO PV-PADJ-DISC-COST-AMT-PRO.           
           MOVE ZEROS                   TO PV-PADJ-RTV-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-PADJ-RTV-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-PADJ-DA-COST-AMT-PRO.             
           MOVE ZEROS                   TO PV-PADJ-DA-RTL-AMT-PRO.              
           MOVE ZEROS                   TO PV-PADJ-NET-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-PADJ-OTH-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-PADJ-OTH-RTL-AMT-PRO.             
           MOVE ZEROS                   TO PV-PADJ-GRO-COST-AMT-PRO.            
           MOVE ZEROS                   TO PV-DR-ALW-RTL-AMT-PRO.               
           MOVE ZEROS                   TO PV-RTV-RTL-AMT-PRO.                  
                                                                                
      ******************************************************************        
      * BUILD THE GRAND TOTAL PRORATED REPORT COLUMNS AT A KEY LEVEL.           
      ******************************************************************        
       4400-BUILD-GRAND-TOTALS.                                                 
                                                                                
           IF PV-LINE-COUNTER > (PC-MAX-LINES + 4)                              
               PERFORM 5100-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           PERFORM 5300-PRINT-UL-LINE.                                          
                                                                                
           MOVE ' BEFORE GR TOTAL   ' TO TL-VERBIAGE-PURCHASE                   
                                         TL-VERBIAGE-PRC-CHG                    
                                         TL-VERBIAGE-SALES.                     
           MOVE TV-SLS-REG-RTL-AMT    TO TL-SLS-REG-RTL-AMT.                    
           MOVE TV-SLS-PROMO-RTL-AMT  TO TL-SLS-PROMO-RTL-AMT.                  
           MOVE TV-SLS-PROCLR-RTL-AMT TO TL-SLS-PROCLR-RTL-AMT.                 
           MOVE TV-SLS-CLR-RTL-AMT    TO TL-SLS-CLR-RTL-AMT.                    
           MOVE TV-SLS-OTH-RTL-AMT    TO TL-SLS-OTH-RTL-AMT.                    
           MOVE TV-MKDN-PLU-RTL-AMT   TO TL-MKDN-PLU-RTL-AMT.                   
           MOVE TV-MKDN-PROMO-RTL-AMT TO TL-MKDN-PROMO-RTL-AMT.                 
           MOVE TV-MKDN-RGST-RTL-AMT  TO TL-MKDN-RGST-RTL-AMT.                  
           MOVE TV-MKDN-GLDST-RTL-AMT TO TL-MKDN-GLDST-RTL-AMT.                 
           MOVE TV-MKDN-UMTCH-RTL-AMT TO TL-MKDN-UMTCH-RTL-AMT.                 
           MOVE TV-MKDN-BYR-RTL-AMT   TO TL-MKDN-BYR-RTL-AMT.                   
           MOVE TV-MKDN-STR-RTL-AMT   TO TL-MKDN-STR-RTL-AMT.                   
           MOVE TV-MKDN-PRPT-RTL-AMT  TO TL-MKDN-PRPT-RTL-AMT.                  
           MOVE TV-MKDN-OTH-RTL-AMT   TO TL-MKDN-OTH-RTL-AMT.                   
           MOVE TV-MKDN-RTL-AMT       TO TL-MKDN-RTL-AMT.                       
           MOVE TV-MKUP-RTL-AMT       TO TL-MKUP-RTL-AMT.                       
           MOVE TV-MKUP-INIT-AMT      TO TL-MKUP-INIT-AMT.                      
           MOVE TV-MKUP-NET-AMT       TO TL-MKUP-NET-AMT.                       
           MOVE TV-XFER-IN-RTL-AMT    TO TL-XFER-IN-RTL-AMT.                    
           MOVE TV-XFER-OUT-RTL-AMT   TO TL-XFER-OUT-RTL-AMT.                   
           MOVE TV-RCPT-RTL-AMT       TO TL-RCPT-RTL-AMT.                       
           MOVE TV-RCPT-NET-COST-AMT  TO TL-RCPT-NET-COST-AMT.                  
           MOVE TV-RCPT-GRO-COST-AMT  TO TL-RCPT-GRO-COST-AMT.                  
           MOVE TV-RCPT-FRGT-COST-AMT TO TL-RCPT-FRGT-COST-AMT.                 
           MOVE TV-PADJ-RTL-AMT       TO TL-PADJ-RTL-AMT.                       
           MOVE TV-PADJ-FRGT-COST-AMT TO TL-PADJ-FRGT-COST-AMT.                 
           MOVE TV-PADJ-DISC-COST-AMT TO TL-PADJ-DISC-COST-AMT.                 
           MOVE TV-PADJ-RTV-COST-AMT  TO TL-PADJ-RTV-COST-AMT.                  
           MOVE TV-PADJ-RTV-RTL-AMT   TO TL-PADJ-RTV-RTL-AMT.                   
           MOVE TV-PADJ-DA-COST-AMT   TO TL-PADJ-DA-COST-AMT.                   
           MOVE TV-PADJ-DA-RTL-AMT    TO TL-PADJ-DA-RTL-AMT.                    
           MOVE TV-PADJ-NET-COST-AMT  TO TL-PADJ-NET-COST-AMT.                  
           MOVE TV-PADJ-OTH-COST-AMT  TO TL-PADJ-OTH-COST-AMT.                  
           MOVE TV-PADJ-OTH-RTL-AMT   TO TL-PADJ-OTH-RTL-AMT.                   
           MOVE TV-PADJ-GRO-COST-AMT  TO TL-PADJ-GRO-COST-AMT.                  
           MOVE TV-DR-ALW-RTL-AMT     TO TL-DR-ALW-RTL-AMT.                     
           MOVE TV-RTV-RTL-AMT        TO TL-RTV-RTL-AMT.                        
                                                                                
           PERFORM 5200-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE '    PRORTED GR TOT:'    TO TL-VERBIAGE-PURCHASE                
                                            TL-VERBIAGE-PRC-CHG                 
                                            TL-VERBIAGE-SALES.                  
           MOVE TV-SLS-REG-RTL-AMT-PRO    TO TL-SLS-REG-RTL-AMT.                
           MOVE TV-SLS-PROMO-RTL-AMT-PRO  TO TL-SLS-PROMO-RTL-AMT.              
           MOVE TV-SLS-PROCLR-RTL-AMT-PRO TO TL-SLS-PROCLR-RTL-AMT.             
           MOVE TV-SLS-CLR-RTL-AMT-PRO    TO TL-SLS-CLR-RTL-AMT.                
           MOVE TV-SLS-OTH-RTL-AMT-PRO    TO TL-SLS-OTH-RTL-AMT.                
           MOVE TV-MKDN-PLU-RTL-AMT-PRO   TO TL-MKDN-PLU-RTL-AMT.               
           MOVE TV-MKDN-PROMO-RTL-AMT-PRO TO TL-MKDN-PROMO-RTL-AMT.             
           MOVE TV-MKDN-RGST-RTL-AMT-PRO  TO TL-MKDN-RGST-RTL-AMT.              
           MOVE TV-MKDN-GLDST-RTL-AMT-PRO TO TL-MKDN-GLDST-RTL-AMT.             
           MOVE TV-MKDN-UMTCH-RTL-AMT-PRO TO TL-MKDN-UMTCH-RTL-AMT.             
           MOVE TV-MKDN-BYR-RTL-AMT-PRO   TO TL-MKDN-BYR-RTL-AMT.               
           MOVE TV-MKDN-STR-RTL-AMT-PRO   TO TL-MKDN-STR-RTL-AMT.               
           MOVE TV-MKDN-PRPT-RTL-AMT-PRO  TO TL-MKDN-PRPT-RTL-AMT.              
           MOVE TV-MKDN-OTH-RTL-AMT-PRO   TO TL-MKDN-OTH-RTL-AMT.               
           MOVE TV-MKDN-RTL-AMT-PRO       TO TL-MKDN-RTL-AMT.                   
           MOVE TV-MKUP-RTL-AMT-PRO       TO TL-MKUP-RTL-AMT.                   
           MOVE TV-MKUP-INIT-AMT-PRO      TO TL-MKUP-INIT-AMT.                  
           MOVE TV-MKUP-NET-AMT-PRO       TO TL-MKUP-NET-AMT.                   
           MOVE TV-XFER-IN-RTL-AMT-PRO    TO TL-XFER-IN-RTL-AMT.                
           MOVE TV-XFER-OUT-RTL-AMT-PRO   TO TL-XFER-OUT-RTL-AMT.               
           MOVE TV-RCPT-RTL-AMT-PRO       TO TL-RCPT-RTL-AMT.                   
           MOVE TV-RCPT-NET-COST-AMT-PRO  TO TL-RCPT-NET-COST-AMT.              
           MOVE TV-RCPT-GRO-COST-AMT-PRO  TO TL-RCPT-GRO-COST-AMT.              
           MOVE TV-RCPT-FRGT-COST-AMT-PRO TO TL-RCPT-FRGT-COST-AMT.             
           MOVE TV-PADJ-RTL-AMT-PRO       TO TL-PADJ-RTL-AMT.                   
           MOVE TV-PADJ-FRGT-COST-AMT-PRO TO TL-PADJ-FRGT-COST-AMT.             
           MOVE TV-PADJ-DISC-COST-AMT-PRO TO TL-PADJ-DISC-COST-AMT.             
           MOVE TV-PADJ-RTV-COST-AMT-PRO  TO TL-PADJ-RTV-COST-AMT.              
           MOVE TV-PADJ-RTV-RTL-AMT-PRO   TO TL-PADJ-RTV-RTL-AMT.               
           MOVE TV-PADJ-DA-COST-AMT-PRO   TO TL-PADJ-DA-COST-AMT.               
           MOVE TV-PADJ-DA-RTL-AMT-PRO    TO TL-PADJ-DA-RTL-AMT.                
           MOVE TV-PADJ-NET-COST-AMT-PRO  TO TL-PADJ-NET-COST-AMT.              
           MOVE TV-PADJ-OTH-COST-AMT-PRO  TO TL-PADJ-OTH-COST-AMT.              
           MOVE TV-PADJ-OTH-RTL-AMT-PRO   TO TL-PADJ-OTH-RTL-AMT.               
           MOVE TV-PADJ-GRO-COST-AMT-PRO  TO TL-PADJ-GRO-COST-AMT.              
           MOVE TV-DR-ALW-RTL-AMT-PRO     TO TL-DR-ALW-RTL-AMT.                 
           MOVE TV-RTV-RTL-AMT-PRO        TO TL-RTV-RTL-AMT.                    
                                                                                
           PERFORM 5200-PRINT-TOTAL-LINE.                                       
                                                                                
           MOVE SPACES                   TO PRORATE-RPT-RECORD.                 
           WRITE PRORATE-RPT-RECORD      AFTER ADVANCING 1 LINES.               
                                                                                
           ADD 4                         TO PV-LINE-COUNTER.                    
                                                                                
      ******************************************************************        
      * 5000-PRINT-DETAIL-LINE.                                                 
      ******************************************************************        
       5000-PRINT-DETAIL-LINE.                                                  
                                                                                
           IF PV-LINE-COUNTER > PC-MAX-LINES                                    
               PERFORM 5100-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               WRITE PRORATE-RPT-RECORD                                         
                FROM REPORT-DETAIL-LINE-PURCHASE AFTER ADVANCING 1 LINES        
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               WRITE PRORATE-RPT-RECORD                                         
                FROM REPORT-DETAIL-LINE-PRC-CHG  AFTER ADVANCING 1 LINES        
             WHEN PC-REPORT-SELECTION-SALES                                     
               WRITE PRORATE-RPT-RECORD                                         
                FROM REPORT-DETAIL-LINE-SALES    AFTER ADVANCING 1 LINES        
           END-EVALUATE.                                                        
                                                                                
           ADD 1                         TO PV-LINE-COUNTER.                    
                                                                                
      ******************************************************************        
      * 5100-PRINT-HEADINGS.                                                    
      ******************************************************************        
       5100-PRINT-HEADINGS.                                                     
                                                                                
           ADD 1                     TO PV-PAGE-COUNTER.                        
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               MOVE PV-PAGE-COUNTER      TO HD350O-PAGE-NUMBER                  
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM HD350O-STANDRD-HEADER-350-COLS                            
                                     AFTER ADVANCING PAGE                       
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TITLE-LINE-PURCHASE AFTER ADVANCING 1 LINE         
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-PURCHASE1                             
                 AFTER ADVANCING 2 LINES                                        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-PURCHASE2                             
                 AFTER ADVANCING 1 LINES                                        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-PURCHASE                                   
                                     AFTER ADVANCING 2 LINES                    
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               MOVE PV-PAGE-COUNTER      TO HD254O-PAGE-NUMBER                  
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM HD254O-STANDRD-HEADER-254-COLS                            
                                     AFTER ADVANCING PAGE                       
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TITLE-LINE-PRC-CHG AFTER ADVANCING 1 LINE          
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-PRC-CHG1                              
                 AFTER ADVANCING 2 LINES                                        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-PRC-CHG2                              
                 AFTER ADVANCING 1 LINES                                        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-PRC-CHG                                    
                                     AFTER ADVANCING 2 LINES                    
             WHEN PC-REPORT-SELECTION-SALES                                     
               MOVE PV-PAGE-COUNTER      TO HD126O-PAGE-NUMBER                  
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM HD126O-STANDRD-HEADER-126-COLS                            
                                     AFTER ADVANCING PAGE                       
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TITLE-LINE-SALES AFTER ADVANCING 1 LINE            
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-SALES1 AFTER ADVANCING 2 LINES        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-HEADING-LINE-SALES2 AFTER ADVANCING 1 LINES        
                                                                                
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-SALES                                      
                                     AFTER ADVANCING 2 LINES                    
           END-EVALUATE.                                                        
                                                                                
           MOVE 7                    TO PV-LINE-COUNTER.                        
                                                                                
      ******************************************************************        
      * 5200-PRINT-TOTAL-LINE.                                                  
      ******************************************************************        
       5200-PRINT-TOTAL-LINE.                                                   
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TOTAL-LINE-PURCHASE AFTER ADVANCING 1 LINES        
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TOTAL-LINE-PRC-CHG  AFTER ADVANCING 1 LINES        
             WHEN PC-REPORT-SELECTION-SALES                                     
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-TOTAL-LINE-SALES    AFTER ADVANCING 1 LINES        
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * 5300-PRINT-UL-LINE.                                                     
      ******************************************************************        
       5300-PRINT-UL-LINE.                                                      
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-PURCHASE   AFTER ADVANCING 1 LINES         
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-PRC-CHG    AFTER ADVANCING 1 LINES         
             WHEN PC-REPORT-SELECTION-SALES                                     
               WRITE PRORATE-RPT-RECORD                                         
                 FROM REPORT-UL-LINE-SALES      AFTER ADVANCING 1 LINES         
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * 5400-SELECT-HEADER-DTL.                                                 
      ******************************************************************        
       5400-SELECT-HEADER-DTL.                                                  
                                                                                
           EVALUATE PV-REPORT-SELECTION                                         
             WHEN PC-REPORT-SELECTION-PURCHASE                                  
               MOVE FUNCTION CURRENT-DATE (3:2)  TO HD350O-RUN-YEAR             
               MOVE FUNCTION CURRENT-DATE (5:2)  TO HD350O-RUN-MONTH            
               MOVE FUNCTION CURRENT-DATE (7:2)  TO HD350O-RUN-DAY              
               MOVE FUNCTION CURRENT-DATE (9:2)  TO HD350O-RUN-HOUR             
               MOVE FUNCTION CURRENT-DATE (11:2) TO HD350O-RUN-MINUTE           
               MOVE PC-PROGRAM-NAME              TO HD350O-PROGRAM-NAME         
               MOVE 'DETAIL LEDGER DETAILED U/U PRORATE RPT-PURCHASE '          
                                            TO RTL-DESCRIPTION-PURCHASE         
               MOVE 1                       TO HD350O-REPORT-NUMBER             
             WHEN PC-REPORT-SELECTION-PRICE-CHG                                 
               MOVE FUNCTION CURRENT-DATE (3:2)  TO HD254O-RUN-YEAR             
               MOVE FUNCTION CURRENT-DATE (5:2)  TO HD254O-RUN-MONTH            
               MOVE FUNCTION CURRENT-DATE (7:2)  TO HD254O-RUN-DAY              
               MOVE FUNCTION CURRENT-DATE (9:2)  TO HD254O-RUN-HOUR             
               MOVE FUNCTION CURRENT-DATE (11:2) TO HD254O-RUN-MINUTE           
               MOVE PC-PROGRAM-NAME              TO HD254O-PROGRAM-NAME         
               MOVE 'DETAIL LEDGER DETAILED U/U PRORATE RPT-PRICE CHG'          
                                            TO RTL-DESCRIPTION-PRC-CHG          
               MOVE 3                       TO HD254O-REPORT-NUMBER             
             WHEN PC-REPORT-SELECTION-SALES                                     
               MOVE FUNCTION CURRENT-DATE (3:2)  TO HD126O-RUN-YEAR             
               MOVE FUNCTION CURRENT-DATE (5:2)  TO HD126O-RUN-MONTH            
               MOVE FUNCTION CURRENT-DATE (7:2)  TO HD126O-RUN-DAY              
               MOVE FUNCTION CURRENT-DATE (9:2)  TO HD126O-RUN-HOUR             
               MOVE FUNCTION CURRENT-DATE (11:2) TO HD126O-RUN-MINUTE           
               MOVE PC-PROGRAM-NAME              TO HD126O-PROGRAM-NAME         
               MOVE 'DETAIL LEDGER DETAILED U/U PRORATE RPT-SALES    '          
                                            TO RTL-DESCRIPTION-SALES            
               MOVE 2                       TO HD126O-REPORT-NUMBER             
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      *   READS THE UNKNOWN INPUT FILE                                 *        
      ******************************************************************        
       7000-READ-UU-KU-FILE.                                                    
           READ UU-KU-AMNTS-FILE                                                
               AT END                                                           
               SET PS-UU-KU-INP-EOF-YES TO  TRUE                                
               NOT AT END                                                       
               ADD 1                    TO  PA-INP-RECS-READ                    
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *   WRITES INTO THE NO PRORATE FILE                              *        
      ******************************************************************        
       7100-WRITE-NO-PRORT-FILE.                                                
           WRITE NOPRFL-UPDATE-REC     FROM UKAMT-UPDATE-REC.                   
           ADD 1                       TO   PA-NO-PRORATE-RECS.                 
                                                                                
      ******************************************************************        
      *   REVERSE AMOUNTS IN INPUT FILE AND WRITE TO OUTPUT            *        
      ******************************************************************        
       7200-WRITE-REV-AMNT-FILE.                                                
           WRITE REVAMT-UPDATE-REC.                                             
           ADD 1                       TO   PA-REV-AMNT-RECS.                   
                                                                                
      ******************************************************************        
      *   READS THE DATE FROM CONTROL CARD                             *        
      ******************************************************************        
       7300-READ-CNTL-DATE.                                                     
           READ CNTL-DATE-FILE                                                  
               AT END                                                           
               SET PS-CNTL-DATE-EOF-YES TO  TRUE                                
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *   WRITES INTO THE NO PRORATE FILE                              *        
      ******************************************************************        
       7400-WRITE-BV-PRORT-FILE.                                                
           WRITE BVPRFL-UPDATE-REC.                                             
           ADD 1                       TO   PA-OUT-PRORATE-RECS.                
                                                                                
      ******************************************************************        
      *   READS THE JOB NAME FROM THE JOB CONTROL CARD                 *        
      ******************************************************************        
       7500-READ-CNTL-JOB.                                                      
           READ CNTL-JOB-FILE                                                   
               AT END                                                           
               SET PS-CNTL-JOB-EOF-YES TO  TRUE                                 
           END-READ.                                                            
                                                                                
      ******************************************************************        
      *   END OF JOB PROCESSING                                        *        
      ******************************************************************        
       8999-END-OF-JOB.                                                         
           PERFORM 4400-BUILD-GRAND-TOTALS.                                     
                                                                                
           DISPLAY 'NUMBER OF RECORDS READ FROM INPUT FILE    : '               
                   PA-INP-RECS-READ                                             
           DISPLAY 'NUMBER OF RECORDS WHICH WERE NOT PRORATED : '               
                   PA-NO-PRORATE-RECS                                           
           DISPLAY 'NUMBER OF RECORDS WHICH WERE PRORATED     : '               
                   PA-REV-AMNT-RECS                                             
           DISPLAY 'NUMBER OF RECORDS WRITTEN TO PRORATED FILE: '               
                   PA-OUT-PRORATE-RECS                                          
           DISPLAY 'NUMBER OF RECORDS WRITTEN TO AUDIT FILE   : '               
                   PA-OUT-AUDIT-RECS                                            
                                                                                
           CLOSE                       UU-KU-AMNTS-FILE                         
                                       CNTL-DATE-FILE                           
                                       CNTL-JOB-FILE                            
                                       UU-NO-PRORATE-FILE                       
                                       UU-REV-AMNTS-FILE                        
                                       BV-PRORATE-FILE                          
W37965                                 DTL-AUDIT-FILE                           
                                       PRORATE-RPT-FILE.                        
                                                                                
      ******************************************************************        
      *    SQL ERROR - ABEND                                           *        
      ******************************************************************        
       9000-SQL-ABEND.                                                          
                                                                                
           DISPLAY '**  ABEND     **'.                                          
           DISPLAY '**  PROGRAM   **  = '  PC-PROGRAM-NAME                      
           DISPLAY '**  OPERATION **  = '  PV-OPER-ATTEMPTED                    
           DISPLAY '**  PARAGRAPH **  = '  PV-PARAGRAPH-NAME                    
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
           COPY DPPD004.                                                        
           PERFORM 9999-ABEND.                                                  
                                                                                
      ******************************************************************        
      *    ABEND CALL                                                  *        
      ******************************************************************        
       9999-ABEND.                                                              
                                                                                
           MOVE +4013                 TO ABEND-CODE.                            
           CALL 'ILBOABN0'  USING ABEND-CODE.                                   
                                                                                
      ******************************************************************        
      *                 END OF PROGRAM MLKUT225                        *        
      ******************************************************************        
