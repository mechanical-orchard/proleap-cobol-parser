000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             ARKUT052.                                00050000
000600 AUTHOR.                 TAMARA KOLTUN.                           00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            6-05-95.                                 00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*-----------------------------------------------------------------00110000
001200* THIS PROGRAM IS USED TO PRODUCE THE DAILY POSITIVE PAY FILE FOR 00120000
001300* BANK ONE.  IT PULLS OUT ALL NON-VOIDED CHECKS FROM THE TCRRFND  00130000
001400* TABLE USING THE CURRENT BILLING DATE.                           00140000
001500*                                                                 00150000
001600* 11/28/95 AJR: MODIFIED THE PROGRAM TO INCLUDE AN INPUT FILE     00160000
001700*               WHICH HAS THE CURRENT DATE MINUS 15 DAYS. THIS    00170000
001800*               DATE WILL BE USED TO CALCULATE THE MONTH DATE RANG00180000
001900*               WHICH THE INFORMATION SHOULD BE EXTRACTED FOR.    00190000
002000*                                                                 00200000
002100* 10/07/96 DEB: ADDED CHECK OF SQLCODE=0 TO PURGE PARAGRPH        00210000
002200*                                                                 00220000
002300* 08/29/01 LAS: ADDED CREATION OF NEW POSITIVE PAY FILE FOR       00230000
002400*               BANK ONE.  THIS PROGRAM NO LONGER USES THE        00240000
002500*               CURRENT DATE MINUS 15 DAYS BECAUSE IT NOW RUNS    00250000
002600*               DAILY INSTEAD OF MONTHLY.                         00260000
002700*                                                                 00270000
002800* 03/26/02 LAS: CHANGED TO DELETE ALL TCRRFND RECORDS THAT        00280000
002900*               ARE MORE THAN 399 DAYS OLD INSTEAD OF USING       00290000
003000*               A ONE MONTH DATE RANGE.                           00300000
003010* 01/09/07 BDH: CHANGED TO DELETE ALL TCRRFND RECORDS THAT        00301000
003020*               ARE MORE THAN 2200 DAYS OLD INSTEAD OF 399.       00302000
003201*                                                                 00303000
003210* 09/06/13 CTS: CHANGED THE PROGRAM TO REMOVE THE HEADER TO       00304000
003220*               PREVENT IT FROM GETTING DISPLAYED IN THE          00305000
003230*               POSITIVE PAY OUTPUT FILE.                         00306000
003100*-----------------------------------------------------------------00310000
003200                                                                  00320000
003300******************************************************************00330000
003400 ENVIRONMENT DIVISION.                                            00340000
003500******************************************************************00350000
003600                                                                  00360000
003700 CONFIGURATION SECTION.                                           00370000
003800                                                                  00380000
003900 SOURCE-COMPUTER.        IBM-3090.                                00390000
004000 OBJECT-COMPUTER.        IBM-3090.                                00400000
004100                                                                  00410000
004200 INPUT-OUTPUT SECTION.                                            00420000
004300                                                                  00430000
004400 FILE-CONTROL.                                                    00440000
004500                                                                  00450000
004600      SELECT FIRST-CHECK-CARD-FILE  ASSIGN TO UPD01.              00460000
004700      SELECT POSITIVE-PAY-FILE      ASSIGN TO OUT01.              00470000
004800                                                                  00480000
004900******************************************************************00490000
005000 DATA DIVISION.                                                   00500000
005100******************************************************************00510000
005200                                                                  00520000
005300 FILE SECTION.                                                    00530000
005400                                                                  00540000
005500 FD  POSITIVE-PAY-FILE                                            00550000
005600     LABEL RECORDS ARE STANDARD                                   00560000
005700     BLOCK CONTAINS 0 RECORDS                                     00570000
005800     RECORDING MODE IS F                                          00580000
005900     RECORD CONTAINS 150 CHARACTERS                               00590000
006000     DATA RECORD IS POSITIVE-PAY-RECORD.                          00600000
006100                                                                  00610000
006200 01  POSITIVE-PAY-RECORD             PIC X(150).                  00620000
006300                                                                  00630000
006400 FD  FIRST-CHECK-CARD-FILE                                        00640000
006500     LABEL RECORDS ARE STANDARD                                   00650000
006600     BLOCK CONTAINS 0 RECORDS                                     00660000
006700     RECORDING MODE IS F                                          00670000
006800     RECORD CONTAINS 80 CHARACTERS                                00680000
006900     DATA RECORD IS FIRST-CHECK-CARD-RECORD.                      00690000
007000                                                                  00700000
007100 01  FIRST-CHECK-CARD-RECORD         PIC X(80).                   00710000
007200*------------------------------------------------------*          00720000
007300 WORKING-STORAGE SECTION.                                         00730000
007400*------------------------------------------------------*          00740000
007500 01 PC-PROGRAM-CONSTANTS.                                         00750000
007600    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'ARKUT052'.  00760000
007700    05 PC-DAYS-TO-KEEP               PIC 9(05) VALUE 2200.        00770000
007800    05 PC-FIRST-DAY-OF-MONTH         PIC 9(02) VALUE 01.          00780000
007900    05 PC-DATE-MODULE                PIC X(08) VALUE 'DPKUT500'.  00790000
008000    05 PC-BANK-ACCT-NBR              PIC X(10) VALUE ZEROS.       00800000
008100                                                                  00810000
008200 01 DK-DATABASE-KEYS.                                             00820000
008300    05 DK-PURGE-DTE                  PIC X(10) VALUE SPACE.       00830000
008400    05 DK-PURGE-COUNT                PIC S9(9) COMP VALUE ZEROES. 00840000
008500                                                                  00850000
008600 01 PV-PROGRAM-VARIABLES.                                         00860000
008700     05  PV-CURR-DATE-DETAIL.                                     00870000
008800         10  PV-CURR-DATE-CC          PIC  X(02).                 00880000
008900         10  PV-CURR-DATE-YY          PIC  X(02).                 00890000
009000         10  FILLER                   PIC  X(01).                 00900000
009100         10  PV-CURR-DATE-MM          PIC  X(02).                 00910000
009200         10  FILLER                   PIC  X(01).                 00920000
009300         10  PV-CURR-DATE-DD          PIC  X(02).                 00930000
009400     05  PV-CURR-DATE  REDEFINES PV-CURR-DATE-DETAIL              00940000
009500                                      PIC  X(10).                 00950000
009600    05 PV-PURGE-FORMAT-DATE.                                      00960000
009700       10 PV-PURGE-YYYY              PIC  9(04)    VALUE 0.       00970000
009800       10 FILLER                     PIC  X(01)    VALUE '-'.     00980000
009900       10 PV-PURGE-MM                PIC  9(02)    VALUE 0.       00990000
010000       10 FILLER                     PIC  X(01)    VALUE '-'.     01000000
010100       10 PV-PURGE-DD                PIC  9(02)    VALUE 0.       01010000
010200                                                                  01020000
010300    05 PV-ABEND-CODE                 PIC S9(04)    VALUE +0.      01030000
010400    05 PV-ABEND-PARA-NAME            PIC X(30)     VALUE SPACE.   01040000
010500    05 PV-DB2-OPERATION-MSG-1        PIC X(40)     VALUE SPACE.   01050000
010600    05 PV-DB2-TABLE-NAME             PIC X(12)     VALUE SPACE.   01060000
010700    05 PV-SQLCODE                    PIC Z(8)9-.                  01070000
010800    05 PV-PARAGRAPH-NAME             PIC X(30)     VALUE SPACE.   01080000
010900    05 PV-DATE-AREA                  PIC X(10)     VALUE SPACE.   01090000
011000    05 PV-START-CHECK-NUMBER         PIC S9(9) COMP VALUE ZEROES. 01100000
011100                                                                  01110000
011200 01 PS-PROGRAM-SWITCHES.                                          01120000
011300    05 PS-END-OF-TCRRFND-SW          PIC X(01)     VALUE 'N'.     01130000
011400       88 PS-END-OF-TCRRFND                        VALUE 'Y'.     01140000
012000                                                                  01200000
012100 01 ARP-STANDARD-RECORD-LAYOUT.                                   01210000
012200    05 ARP-RECORD-TYPE         PIC X(1)           VALUE 'O'.      01220000
012300    05 FILLER                  PIC X(1)           VALUE ','.      01230000
012400    05 FILLER                  PIC 9(2)           VALUE ZEROES.   01240000
012500    05 ARP-BANK-ONE-ACCT-NBR   PIC 9(18)          VALUE 20968707. 01250000
012600    05 FILLER                  PIC X(1)           VALUE ','.      01260000
012700    05 ARP-CHECK-NBR           PIC 9(18)          VALUE ZEROES.   01270000
012800    05 FILLER                  PIC X(1)           VALUE ','.      01280000
012900    05 ARP-CHECK-AMT           PIC 9(16)V99       VALUE ZEROES.   01290000
013000    05 FILLER                  PIC X(1)           VALUE ','.      01300000
013100    05 ARP-CHECK-DATE.                                            01310000
013200       10  ARP-CHECK-CC        PIC X(2)           VALUE SPACES.   01320000
013300       10  ARP-CHECK-YY        PIC X(2)           VALUE SPACES.   01330000
013400       10  ARP-CHECK-MM        PIC X(2)           VALUE SPACES.   01340000
013500       10  ARP-CHECK-DD        PIC X(2)           VALUE SPACES.   01350000
013600    05 FILLER                  PIC X(1)           VALUE ','.      01360000
013700    05 ARP-PAID-DATE           PIC X(8)           VALUE SPACES.   01370000
013800    05 FILLER                  PIC X(1)           VALUE ','.      01380000
013900    05 ARP-ADDITIONAL-DATA     PIC X(15)          VALUE SPACES.   01390000
014000    05 FILLER                  PIC X(56)          VALUE ','.      01400000
014100                                                                  01410000
014200 01 FIRST-CHECK-CARD-LAYOUT.                                      01420000
014300    05  FIRST-CARD-CHECK-NBR         PIC 9(09)  VALUE ZEROES.     01430000
014400                                                                  01440000
014500******* DB2 MESSAGE AREAS ********                                01450000
014600     COPY DPWS004.                                                01460000
014700                                                                  01470000
014800     COPY DPWS500.                                                01480000
014900                                                                  01490000
015000     EXEC SQL                                                     01500000
015100          INCLUDE SQLCA                                           01510000
015200     END-EXEC.                                                    01520000
015300                                                                  01530000
015400     EXEC SQL                                                     01540000
015500          INCLUDE TCRRFND                                         01550000
015600     END-EXEC.                                                    01560000
015700                                                                  01570000
015800     EXEC SQL                                                     01580000
015900          DECLARE TCRRFND-READ-CRS CURSOR FOR                     01590000
016000               SELECT  CK_NBR                                     01600000
016100                      ,CK_DTE                                     01610000
016200                      ,VOID_IND                                   01620000
016300                      ,ACCT_NBR                                   01630000
016400                      ,RFND_AMT                                   01640000
016500                FROM TCRRFND                                      01650000
016600                WHERE CK_NBR  >= :CRRFND-CK-NBR                   01660000
016700                ORDER BY CK_NBR                                   01670000
016800                FOR FETCH ONLY                                    01680000
016900     END-EXEC.                                                    01690000
017000                                                                  01700000
017100********************************************************          01710000
017200 PROCEDURE DIVISION.                                              01720000
017300********************************************************          01730000
017400 0000-MAIN.                                                       01740000
017500                                                                  01750000
017600     PERFORM 1000-OPEN.                                           01760000
017700                                                                  01770000
017800     PERFORM 2000-INITIALIZATION.                                 01780000
017900                                                                  01790000
018000     PERFORM 3000-CREATE-POSITIVE-PAY-FILE.                       01800000
018100                                                                  01810000
018200     PERFORM 4000-DELETE-OLD-ROWS.                                01820000
018300                                                                  01830000
018400     PERFORM 5000-CLOSE.                                          01840000
018500                                                                  01850000
018600     STOP RUN.                                                    01860000
018700                                                                  01870000
018800********************************************************          01880000
018900 1000-OPEN.                                                       01890000
019000********************************************************          01900000
019100                                                                  01910000
019200     OPEN INPUT FIRST-CHECK-CARD-FILE.                            01920000
019300     OPEN OUTPUT POSITIVE-PAY-FILE.                               01930000
019400                                                                  01940000
019500********************************************************          01950000
019600 2000-INITIALIZATION.                                             01960000
019700********************************************************          01970000
019800                                                                  01980000
019900     READ FIRST-CHECK-CARD-FILE                                   01990000
020000        INTO FIRST-CHECK-CARD-LAYOUT.                             02000000
020100                                                                  02010000
020200     DISPLAY '----------------------------------'.                02020000
020300     DISPLAY '       ARKUT052 CNTL CARD         '.                02030000
020400     DISPLAY '----------------------------------'.                02040000
020500     DISPLAY 'FIRST CK CNTL CARD: ' FIRST-CHECK-CARD-LAYOUT       02050000
020600             '(BEFORE UPDATE)'.                                   02060000
020700     MOVE FIRST-CARD-CHECK-NBR TO CRRFND-CK-NBR.                  02070000
020800                                                                  02080000
021000                                                                  02100000
021100********************************************************          02110000
021200 3000-CREATE-POSITIVE-PAY-FILE.                                   02120000
021300********************************************************          02130000
021400                                                                  02140000
021500     PERFORM 7000-OPEN-TCRRFND-CRSR.                              02150000
021600     PERFORM 7100-FETCH-TCRRFND-CRSR.                             02160000
021700                                                                  02170000
021800     PERFORM 3100-WRITE-POSITIVE-PAY                              02180000
021900        UNTIL PS-END-OF-TCRRFND.                                  02190000
022000                                                                  02200000
022100     PERFORM 7200-CLOSE-TCRRFND-CRSR.                             02210000
022200                                                                  02220000
022300     PERFORM 3200-UPDATE-FIRST-CARD-FILE.                         02230000
022400                                                                  02240000
022500********************************************************          02250000
022600 3100-WRITE-POSITIVE-PAY.                                         02260000
022700********************************************************          02270000
022800                                                                  02280000
022900     IF CRRFND-VOID-IND = SPACES                                  02290000
023000        MOVE 'O'             TO ARP-RECORD-TYPE                   02300000
023100     ELSE                                                         02310000
023200        MOVE 'V'             TO ARP-RECORD-TYPE                   02320000
023300     END-IF.                                                      02330000
023400                                                                  02340000
023500     MOVE CRRFND-CK-NBR      TO ARP-CHECK-NBR.                    02350000
023600                                                                  02360000
023700     MOVE CRRFND-CK-DTE      TO PV-CURR-DATE-DETAIL.              02370000
023800     MOVE PV-CURR-DATE-CC    TO ARP-CHECK-CC.                     02380000
023900     MOVE PV-CURR-DATE-YY    TO ARP-CHECK-YY.                     02390000
024000     MOVE PV-CURR-DATE-MM    TO ARP-CHECK-MM.                     02400000
024100     MOVE PV-CURR-DATE-DD    TO ARP-CHECK-DD.                     02410000
024200                                                                  02420000
024300     MOVE CRRFND-RFND-AMT    TO ARP-CHECK-AMT.                    02430000
024400     IF ARP-CHECK-AMT < 0                                         02440000
024500        COMPUTE ARP-CHECK-AMT = ARP-CHECK-AMT * (-1)              02450000
024600            ON SIZE ERROR                                         02460000
024700               DISPLAY 'CHECK AMT SIZE ERROR'                     02470000
024800               MOVE +4008 TO PV-ABEND-CODE                        02480000
024900               CALL 'ILBOABN0' USING PV-ABEND-CODE                02490042
025000        END-COMPUTE                                               02500000
025100     END-IF.                                                      02510000
025200                                                                  02520000
025300     WRITE POSITIVE-PAY-RECORD                                    02530000
025400         FROM ARP-STANDARD-RECORD-LAYOUT.                         02540000
025500                                                                  02550000
025600     PERFORM 7100-FETCH-TCRRFND-CRSR.                             02560000
025700                                                                  02570000
025800********************************************************          02580000
025900 3200-UPDATE-FIRST-CARD-FILE.                                     02590000
026000********************************************************          02600000
026100                                                                  02610000
026200     CLOSE FIRST-CHECK-CARD-FILE.                                 02620000
026300     OPEN OUTPUT FIRST-CHECK-CARD-FILE.                           02630000
026400                                                                  02640000
026500     MOVE CRRFND-CK-NBR TO FIRST-CARD-CHECK-NBR.                  02650000
026600     ADD 1              TO FIRST-CARD-CHECK-NBR.                  02660000
026700                                                                  02670000
026800     WRITE FIRST-CHECK-CARD-RECORD                                02680000
026900        FROM FIRST-CHECK-CARD-LAYOUT.                             02690000
027000                                                                  02700000
027100     DISPLAY 'FIRST CK CNTL CARD: ' FIRST-CHECK-CARD-LAYOUT       02710000
027200             '(AFTER UPDATE)'.                                    02720000
027300     DISPLAY '----------------------------------'.                02730000
027400                                                                  02740000
027500********************************************************          02750000
027600 4000-DELETE-OLD-ROWS.                                            02760000
027700********************************************************          02770000
027800                                                                  02780000
027900       PERFORM 4100-GET-PURGE-DATE-RANGE                          02790000
028000       EXEC SQL                                                   02800000
028100          SELECT COUNT(*)                                         02810000
028200          INTO :DK-PURGE-COUNT                                    02820000
028300          FROM TCRRFND                                            02830000
028400          WHERE CK_DTE <= :DK-PURGE-DTE                           02840000
028500       END-EXEC.                                                  02850000
028600                                                                  02860000
028700       EXEC SQL                                                   02870000
028800          DELETE FROM TCRRFND                                     02880000
028900               WHERE  CK_DTE <= :DK-PURGE-DTE                     02890000
029000       END-EXEC.                                                  02900000
029100                                                                  02910000
029200       EVALUATE TRUE                                              02920000
029300          WHEN SQLCODE < 0                                        02930000
029400          WHEN SQLCODE = ZERO                                     02940000
029500          WHEN SQLCODE = +100                                     02950000
029600               DISPLAY '----------------------------------'       02960000
029700               DISPLAY 'PURGE DATE:  ' DK-PURGE-DTE               02970000
029800               DISPLAY 'ROWS PURGED: ' DK-PURGE-COUNT             02980000
029900               DISPLAY '----------------------------------'       02990000
030000          WHEN OTHER                                              03000000
030100               MOVE '2000-PURGE'        TO PV-ABEND-PARA-NAME     03010000
030200               MOVE 'DELETE'            TO PV-DB2-OPERATION-MSG-1 03020000
030300               MOVE 'TCRRFND'           TO PV-DB2-TABLE-NAME      03030000
030400               PERFORM 9998-SQL-ABEND                             03040000
030500       END-EVALUATE.                                              03050000
030600                                                                  03060000
030700********************************************************          03070000
030800 4100-GET-PURGE-DATE-RANGE.                                       03080000
030900********************************************************          03090000
031000                                                                  03100000
031100     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         03110000
031200     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     03120000
031300     SET DPG51-DECREMENT-DATE        TO TRUE.                     03130000
031400     SET DPG52-LK-DTE-ISO            TO TRUE.                     03140000
031500     MOVE FUNCTION CURRENT-DATE      TO DPG52-LK-DATE-INPUT.      03150000
031600     MOVE PC-DAYS-TO-KEEP            TO DPG51-INCR-DECR-DAYS-9.   03160000
031700                                                                  03170000
031800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    03180000
031900                                             DPG54 DPG55 DPG56.   03190000
032000     IF (DPG54-NO-ERROR       OR                                  03200000
032100         DPG54-WARNING-ERROR) AND                                 03210000
032200         DPG54-DATE-VALID                                         03220000
032300         CONTINUE                                                 03230000
032400     ELSE                                                         03240000
032500        IF DPG54-DATE-INVALID                                     03250000
032600           DISPLAY '*** ABEND ***'                                03260000
032700           DISPLAY '*** PROGRAM = ' PC-PROGRAM-NAME               03270000
032800           DISPLAY '*** PARA = 0001-INITIALIZATION'               03280000
032900           DISPLAY '*** BAD RESPONSE FROM DATE ROUTINE ***'       03290000
033000           DISPLAY DPG54-ERROR-MESSAGE                            03300000
033100           MOVE +4019  TO   PV-ABEND-CODE                         03310000
033200           CALL 'ILBOABN0' USING PV-ABEND-CODE                    03320041
033300          END-IF                                                  03330000
033400       END-IF.                                                    03340000
033500                                                                  03350000
033600       MOVE DPG55-GREG-CC-DATE-FMT-YR TO PV-PURGE-YYYY.           03360000
033700       MOVE DPG55-GREG-CC-DATE-FMT-MO TO PV-PURGE-MM.             03370000
033800       MOVE DPG55-GREG-CC-DATE-FMT-DY TO PV-PURGE-DD.             03380000
033900                                                                  03390000
034000       MOVE PV-PURGE-FORMAT-DATE      TO DK-PURGE-DTE.            03400000
034100                                                                  03410000
034200********************************************************          03420000
034300 5000-CLOSE.                                                      03430000
034400********************************************************          03440000
034500                                                                  03450000
034600       CLOSE FIRST-CHECK-CARD-FILE                                03460000
034700             POSITIVE-PAY-FILE.                                   03470000
034800********************************************************          03480000
034900 7000-OPEN-TCRRFND-CRSR.                                          03490000
035000********************************************************          03500000
035100       EXEC SQL                                                   03510000
035200            OPEN TCRRFND-READ-CRS                                 03520000
035300       END-EXEC.                                                  03530000
035400                                                                  03540000
035500       EVALUATE TRUE                                              03550000
035600          WHEN SQLCODE = ZERO                                     03560000
035700               CONTINUE                                           03570000
035800          WHEN OTHER                                              03580000
035900               MOVE '7000-OPEN-TCRRFND-CRSR' TO PV-ABEND-PARA-NAME03590000
036000               MOVE 'OPEN CURSOR'        TO PV-DB2-OPERATION-MSG-103600000
036100               MOVE 'TCRRFND'                TO PV-DB2-TABLE-NAME 03610000
036200               PERFORM 9998-SQL-ABEND                             03620000
036300       END-EVALUATE.                                              03630000
036400                                                                  03640000
036500********************************************************          03650000
036600 7100-FETCH-TCRRFND-CRSR.                                         03660000
036700********************************************************          03670000
036800       EXEC SQL                                                   03680000
036900           FETCH TCRRFND-READ-CRS                                 03690000
037000           INTO  :CRRFND-CK-NBR                                   03700000
037100                ,:CRRFND-CK-DTE                                   03710000
037200                ,:CRRFND-VOID-IND                                 03720000
037300                ,:CRRFND-ACCT-NBR                                 03730000
037400                ,:CRRFND-RFND-AMT                                 03740000
037500       END-EXEC.                                                  03750000
037600                                                                  03760000
037700       EVALUATE TRUE                                              03770000
037800           WHEN SQLCODE = ZERO                                    03780000
037900               CONTINUE                                           03790000
038000           WHEN SQLCODE = +100                                    03800000
038100               SET  PS-END-OF-TCRRFND TO TRUE                     03810000
038200           WHEN OTHER                                             03820000
038300               MOVE '7100-FETCH-PROCESS-ROW' TO PV-ABEND-PARA-NAME03830000
038400               MOVE 'FETCH CRRFND-CRS'  TO PV-DB2-OPERATION-MSG-1 03840000
038500               MOVE 'TCRRFND'           TO PV-DB2-TABLE-NAME      03850000
038600               PERFORM 9998-SQL-ABEND                             03860000
038700       END-EVALUATE.                                              03870000
038800                                                                  03880000
038900********************************************************          03890000
039000 7200-CLOSE-TCRRFND-CRSR.                                         03900000
039100********************************************************          03910000
039200       EXEC SQL                                                   03920000
039300           CLOSE TCRRFND-READ-CRS                                 03930000
039400       END-EXEC.                                                  03940000
039500                                                                  03950000
039600********************************************************          03960000
039700 9998-SQL-ABEND.                                                  03970000
039800********************************************************          03980000
039900     MOVE SQLCODE     TO PV-SQLCODE.                              03990000
040000     DISPLAY '** ABEND           ** = SQLABEND'.                  04000000
040100     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          04010000
040200     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        04020000
040300     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        04030000
040400     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   04040000
040500     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               04050000
040600     COPY DPPD004.                                                04060000
040700                                                                  04070000
040800     EXEC SQL                                                     04080000
040900          ROLLBACK                                                04090000
041000     END-EXEC.                                                    04100000
041100                                                                  04110000
041200     MOVE +4013                  TO PV-ABEND-CODE.                04120000
041300     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       04130041
