000100 IDENTIFICATION DIVISION.                                         00010053
000200 TITLE 'INVENTORY SUSPENSE REPORT'.                               00020053
000300                                                                  00030053
000400 PROGRAM-ID.             PCKRP022.                                00040053
000500 AUTHOR.                 PATRICK BURKE.                           00050053
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060053
000700 DATE-WRITTEN.           MARCH 2004.                              00070053
000800 DATE-COMPILED.                                                   00080053
000900                                                                  00090053
001000 ENVIRONMENT DIVISION.                                            00100053
001100 CONFIGURATION SECTION.                                           00110053
001200 SOURCE-COMPUTER.                        IBM-3090.                00120053
001300 OBJECT-COMPUTER.                        IBM-3090.                00130053
001400 INPUT-OUTPUT SECTION.                                            00140053
001500 FILE-CONTROL.                                                    00150053
001600                                                                  00160053
001700     SELECT EXTRACT-FILE                                          00170053
001800         ASSIGN TO INP01.                                         00180053
001900                                                                  00190053
002000     SELECT  REPORT-FILE                                          00200053
002100         ASSIGN TO RPT01.                                         00210053
002200                                                                  00220053
002300                                                                  00230053
002400 DATA DIVISION.                                                   00240053
002500 FILE SECTION.                                                    00250053
002600                                                                  00260053
002700 FD  EXTRACT-FILE                                                 00270053
002800     RECORDING MODE IS F                                          00280053
002900     LABEL RECORDS ARE STANDARD                                   00290053
003000     BLOCK CONTAINS 0 RECORDS.                                    00300053
003100 01  ERROR-RECORD                     PIC X(150).                 00310053
003200                                                                  00320053
003300 FD  REPORT-FILE                                                  00330053
003400     RECORDING MODE IS F                                          00340053
003500     LABEL RECORDS ARE STANDARD                                   00350053
003600     BLOCK CONTAINS 0 RECORDS.                                    00360053
003700 01  REPORT-RECORD                    PIC X(132).                 00370053
003800/                                                                 00380053
003900 WORKING-STORAGE SECTION.                                         00390053
004000 01  PS-SWITCHES.                                                 00400053
004100     05  PS-EOF-ERROR-SWITCH          PIC X(01) VALUE 'N'.        00410053
004200         88  PS-EOF-ERROR-FILE                  VALUE 'Y'.        00420053
004300                                                                  00430053
004400     05  PS-BLANK-LINE-SWITCH         PIC X(01) VALUE 'N'.        00440053
004500         88  PS-BLANK-LINE                      VALUE 'Y'.        00450053
004600         88  PS-BLANK-LINE-NO                   VALUE 'N'.        00460053
004700     05  PS-DEPT-LINE-SWITCH          PIC X(01) VALUE 'N'.        00470053
004800         88  PS-DEPT-LINE                       VALUE 'Y'.        00480053
004900         88  PS-DEPT-LINE-NO                    VALUE 'N'.        00490053
005000     05  PS-STORE-LINE-SWITCH         PIC X(01) VALUE 'N'.        00500053
005100         88  PS-STORE-LINE                      VALUE 'Y'.        00510053
005200         88  PS-STORE-LINE-NO                   VALUE 'N'.        00520053
005300     05  PS-DC-LINE-SWITCH            PIC X(01) VALUE 'N'.        00530053
005400         88  PS-DC-LINE                         VALUE 'Y'.        00540053
005500         88  PS-DC-LINE-NO                      VALUE 'N'.        00550053
005600                                                                  00560053
005700                                                                  00570053
005800 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00580053
005900                                                 COMP SYNC.       00590053
006000     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00600053
006100                                                                  00610053
006200 01  SD-SYSTEM-DATE.                                              00620053
006300     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00630053
006400     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00640053
006500     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00650053
006600                                                                  00660053
006700 01  ST-SYSTEM-TIME.                                              00670053
006800     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00680053
006900     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00690053
007000     05  FILLER                     PIC  9(04)   VALUE ZERO.      00700053
007100                                                                  00710053
007200 01  PV-VARIABLES.                                                00720053
007300     05  PV-TMST                      PIC X(26) VALUE SPACES.     00730053
007400     05  PV-READ-COUNT                PIC S9(7) COMP-3            00740053
007500                                                VALUE ZERO.       00750053
007600     05  PV-BOSS-COUNT                PIC S9(7) COMP-3            00760053
007700                                                VALUE ZERO.       00770053
007800     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00780053
007900                                                VALUE ZERO.       00790053
008000     05  PV-PAGE-COUNT                PIC S9(7) COMP-3            00800053
008100                                                VALUE ZERO.       00810053
008200     05  PV-LINES-USED                PIC S9(4) COMP-3            00820053
008300                                                VALUE ZERO.       00830053
008400     05  PV-RETRY-COUNTER             PIC S9(04) VALUE ZERO       00840053
008500                                                 COMP SYNC.       00850053
008600     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     00860053
008700     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     00870053
008800     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              00880053
008900     05  PV-DISP-COUNT                PIC Z,ZZZ,ZZZ,ZZ9.          00890053
009000     05  PV-PREV-DEPT-NBR             PIC 9(05).                  00900053
009100     05  PV-PREV-DC                   PIC 9(05).                  00910053
009200     05  PV-PREV-STORE                PIC 9(05).                  00920053
009300     05  PV-PREV-DEPT                 PIC 9(05).                  00930053
009400     05  PV-PREV-PO                   PIC S9(09) COMP.            00940053
009500     05  PV-PREV-RCVR                 PIC S9(09) COMP.            00950053
009600     05  PV-OTBND-TRIP                PIC S9(09) COMP.            00960053
009700     05  PV-DEPT-EXP-TOTAL            PIC S9(09) COMP.            00970053
009800     05  PV-STORE-EXP-TOTAL           PIC S9(09) COMP.            00980053
009900     05  PV-GRAND-EXP-TOTAL           PIC S9(09) COMP.            00990053
010000                                                                  01000053
010100     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01010053
010200     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01020053
010300     05  PV-DB2-DATE.                                             01030053
010400         10  PV-DB2-CC                  PIC X(02).                01040053
010500         10  PV-DB2-YY                  PIC X(02).                01050053
010600         10  FILLER                     PIC X(01).                01060053
010700         10  PV-DB2-MM                  PIC X(02).                01070053
010800         10  FILLER                     PIC X(01).                01080053
010900         10  PV-DB2-DD                  PIC X(02).                01090053
011000         10  FILLER                     PIC X(01).                01100053
011100         10  PV-DB2-HH                  PIC X(02).                01110053
011200         10  FILLER                     PIC X(01).                01120053
011300         10  PV-DB2-MN                  PIC X(02).                01130053
011400         10  FILLER                     PIC X(01).                01140053
011500         10  PV-DB2-SS                  PIC X(09).                01150053
011600     05  PV-KEY-DATE.                                             01160053
011700         10  PV-KEY-MM               PIC X(02).                   01170053
011800         10  FILLER                  PIC X(01) VALUE '/'.         01180053
011900         10  PV-KEY-DD               PIC X(02).                   01190053
012000         10  FILLER                  PIC X(01) VALUE '/'.         01200053
012100         10  PV-KEY-YY               PIC X(02).                   01210053
012200     05  PV-BOSS-PARM-RECV           PIC S9(09) COMP.             01220053
012300     05  PV-BOSS-PARM-DISP           PIC -9(04).                  01230053
012400                                                                  01240053
012500                                                                  01250053
012600 01  PC-CONSTANTS.                                                01260053
012700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRP022'. 01270053
012800     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 01280053
012900     05  PC-MAX-RETRIES               PIC S9(04)    VALUE  +3     01290053
013000                                                   COMP.          01300053
013100/                                                                 01310053
013200***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 01320053
013300     COPY DPWS132O.                                               01330053
013400                                                                  01340053
013500*    ERROR EXTRACT                                                01350053
013600     COPY PCRD038.                                                01360053
013700                                                                  01370053
013800 01  HL-HEADING-LINE-1.                                           01380053
013900     05  FILLER                      PIC  X(54)  VALUE SPACES.    01390053
014000     05  FILLER                      PIC  X(41)  VALUE            01400053
014100      'INVENTORY SUSPENSE REPORT                '.                01410053
014200     05  FILLER                      PIC  X(37)  VALUE SPACES.    01420053
014300                                                                  01430053
014400 01  HL-HEADING-LINE-1A.                                          01440053
014500     05  FILLER                      PIC  X(42)  VALUE SPACES.    01450053
014600     05  FILLER                      PIC  X(47)  VALUE            01460053
014700      'INVENTORY STORES WITH UNBALANCED STORE EXPECTED'.          01470053
014800     05  FILLER                      PIC  X(43)  VALUE SPACES.    01480056
014900                                                                  01490053
015000 01  HL-HEADING-LINE-2A.                                          01500053
015100     05  FILLER                      PIC  X(07) VALUE  SPACES.    01510053
015200     05  FILLER                      PIC  X(04) VALUE             01520053
015300         'DEPT'.                                                  01530053
015400     05  FILLER                      PIC  X(06) VALUE  SPACES.    01540055
015500     05  FILLER                      PIC  X(04) VALUE             01550053
015600         'SUB '.                                                  01560053
015700     05  FILLER                      PIC  X(11) VALUE  SPACES.    01570053
015800     05  FILLER                      PIC  X(04) VALUE             01580053
015900         'LINE'.                                                  01590053
016000     05  FILLER                      PIC  X(32) VALUE  SPACES.    01600055
016100     05  FILLER                      PIC  X(03) VALUE             01610053
016200         'REC'.                                                   01620053
016300     05  FILLER                      PIC  X(02) VALUE  SPACES.    01630053
016400     05  FILLER                      PIC  X(09) VALUE             01640053
016500         'STORE EXP'.                                             01650053
016600     05  FILLER                      PIC  X(46) VALUE  SPACES.    01660055
016700     05  FILLER                      PIC  X(04) VALUE             01670053
016800         ' >3 '.                                                  01680053
016900                                                                  01690053
017000 01  HL-HEADING-LINE-2.                                           01700053
017100     05  FILLER                      PIC  X(05) VALUE             01710053
017200         'STORE'.                                                 01720053
017300     05  FILLER                      PIC  X(02) VALUE  SPACES.    01730053
017400     05  FILLER                      PIC  X(03) VALUE             01740053
017500         'NBR'.                                                   01750053
017510     05  FILLER                      PIC  X(02) VALUE  SPACES.    01751055
017520     05  FILLER                      PIC  X(04) VALUE             01752055
017530         'SEPH'.                                                  01753055
017600     05  FILLER                      PIC  X(01) VALUE  SPACES.    01760055
017700     05  FILLER                      PIC  X(03) VALUE             01770053
017800         'CLS'.                                                   01780053
017900     05  FILLER                      PIC  X(04) VALUE  SPACES.    01790053
018000     05  FILLER                      PIC  X(03) VALUE             01800053
018100         'SKU'.                                                   01810053
018200     05  FILLER                      PIC  X(05) VALUE  SPACES.    01820053
018300     05  FILLER                      PIC  X(03) VALUE             01830053
018400         'NBR'.                                                   01840053
018500     05  FILLER                      PIC  X(04) VALUE  SPACES.    01850053
018600     05  FILLER                      PIC  X(02) VALUE             01860055
018700         'DC'.                                                    01870055
018800     05  FILLER                      PIC  X(03) VALUE  SPACES.    01880055
018900     05  FILLER                      PIC  X(11) VALUE             01890053
019000         'PO/RECEIVER'.                                           01900053
019100     05  FILLER                      PIC  X(03) VALUE  SPACES.    01910053
019200     05  FILLER                      PIC  X(08) VALUE             01920053
019300         'VRFD DTE'.                                              01930053
019400     05  FILLER                      PIC  X(02) VALUE  SPACES.    01940053
019500     05  FILLER                      PIC  X(03) VALUE             01950053
019600         'TYP'.                                                   01960053
019700     05  FILLER                      PIC  X(04) VALUE  SPACES.    01970053
019800     05  FILLER                      PIC  X(05) VALUE             01980053
019900         'UNITS'.                                                 01990053
020000     05  FILLER                      PIC  X(03) VALUE  SPACES.    02000056
020100     05  FILLER                      PIC  X(21) VALUE             02010053
020200         'OUTBOUND TRIPS/STATUS'.                                 02020053
020300     05  FILLER                      PIC  X(23) VALUE  SPACES.    02030055
020400     05  FILLER                      PIC  X(05) VALUE             02040053
020500         'TRIPS'.                                                 02050053
020600                                                                  02060053
020700 01  HL-HEADING-LINE-3.                                           02070053
020800     05  FILLER                      PIC  X(05) VALUE             02080053
020900         '-----'.                                                 02090053
021000     05  FILLER                      PIC  X(02) VALUE  SPACES.    02100053
021100     05  FILLER                      PIC  X(04) VALUE             02110053
021200         '----'.                                                  02120053
021300     05  FILLER                      PIC  X(01) VALUE  SPACES.    02130055
021310     05  FILLER                      PIC  X(04) VALUE             02131055
021320         '----'.                                                  02132055
021330     05  FILLER                      PIC  X(01) VALUE  SPACES.    02133055
021400     05  FILLER                      PIC  X(03) VALUE             02140053
021500         '---'.                                                   02150053
021600     05  FILLER                      PIC  X(02) VALUE  SPACES.    02160053
021700     05  FILLER                      PIC  X(08) VALUE             02170053
021800         '--------'.                                              02180053
021900     05  FILLER                      PIC  X(02) VALUE  SPACES.    02190053
022000     05  FILLER                      PIC  X(04) VALUE             02200053
022100         '----'.                                                  02210053
022200     05  FILLER                      PIC  X(02) VALUE  SPACES.    02220053
022300     05  FILLER                      PIC  X(04) VALUE             02230055
022400         '----'.                                                  02240055
022500     05  FILLER                      PIC  X(02) VALUE  SPACES.    02250053
022600     05  FILLER                      PIC  X(12) VALUE             02260053
022700         '------------'.                                          02270053
022800     05  FILLER                      PIC  X(02) VALUE  SPACES.    02280053
022900     05  FILLER                      PIC  X(08) VALUE             02290053
023000         '--------'.                                              02300053
023100     05  FILLER                      PIC  X(02) VALUE  SPACES.    02310053
023200     05  FILLER                      PIC  X(03) VALUE             02320053
023300         '---'.                                                   02330053
023400     05  FILLER                      PIC  X(02) VALUE  SPACES.    02340053
023500     05  FILLER                      PIC  X(09) VALUE             02350053
023600         '---------'.                                             02360053
023700     05  FILLER                      PIC  X(01) VALUE  SPACES.    02370055
023800     05  FILLER                      PIC  X(43) VALUE             02380055
023900         '-------------------------------------------'.           02390055
024000     05  FILLER                      PIC  X(01) VALUE  SPACES.    02400053
024100     05  FILLER                      PIC  X(05) VALUE             02410053
024200         '-----'.                                                 02420053
024300                                                                  02430053
024400 01  DL-DETAIL-LINE-1.                                            02440053
024500     05  DL-STORE                    PIC  ZZZZ9 VALUE ZERO.       02450053
024600     05  FILLER                      PIC  X(02) VALUE  SPACES.    02460053
024700     05  DL-DEPT-NBR                 PIC  9(03) VALUE ZERO.       02470053
024800     05  FILLER                      PIC  X(03) VALUE  SPACES.    02480055
024810     05  DL-SEPHORA-ORDER            PIC  X(01) VALUE ZERO.       02481055
024820     05  FILLER                      PIC  X(02) VALUE  SPACES.    02482055
024900     05  DL-SUB-CLASS                PIC  ZZZ9  VALUE ZERO.       02490053
025000     05  FILLER                      PIC  X(02) VALUE  SPACES.    02500053
025100     05  DL-SKU-NBR                  PIC  9(08) VALUE  ZEROES.    02510053
025200     05  FILLER                      PIC  X(02) VALUE  SPACES.    02520053
025300     05  DL-APP-PO-LNE-NBR           PIC  ZZZ9.                   02530053
025400     05  DL-APP-PO-LNE-NBR-X REDEFINES DL-APP-PO-LNE-NBR          02540053
025500                                     PIC  X(04).                  02550053
025600     05  FILLER                      PIC  X(02) VALUE  SPACES.    02560053
025700     05  DL-DC                       PIC  ZZZ9  VALUE ZERO.       02570055
025800     05  FILLER                      PIC  X(01) VALUE  SPACES.    02580053
025900     05  DL-PO-RCVR.                                              02590053
026000         10  DL-PO                   PIC  ZZZZZZZZ9  VALUE ZERO.  02600053
026100         10  DL-DASH                 PIC  X(01) VALUE  '-'.       02610053
026200         10  DL-RCVR                 PIC  9(03) VALUE  ZEROES.    02620053
026300         10  DL-RCVR-X  REDEFINES    DL-RCVR                      02630053
026400                                     PIC  X(03).                  02640053
026500     05  FILLER                      PIC  X(02) VALUE SPACES.     02650053
026600     05  DL-VRFD-DATE                PIC  X(08) VALUE SPACES.     02660053
026700     05  FILLER                      PIC  X(02) VALUE  SPACES.    02670053
026800     05  DL-REC-TYP                  PIC  X(03) VALUE  SPACES.    02680053
026900     05  FILLER                      PIC  X(04) VALUE  SPACES.    02690053
027000     05  DL-STORE-EXP-UNITS          PIC  ZZZZ9-.                 02700053
027100     05  FILLER                      PIC  X(02) VALUE  SPACES.    02710055
027200     05  DL-OTBND-TRIP-1             PIC  X(09) VALUE  SPACES.    02720053
027300     05  FILLER                      PIC  X(02) VALUE  SPACES.    02730053
027400     05  DL-TRIP-STATUS-1            PIC  X(02) VALUE  SPACES.    02740053
027500     05  FILLER                      PIC  X(02) VALUE  SPACES.    02750053
027600     05  DL-OTBND-TRIP-2             PIC  X(09) VALUE  SPACES.    02760053
027700     05  FILLER                      PIC  X(02) VALUE  SPACES.    02770053
027800     05  DL-TRIP-STATUS-2            PIC  X(02) VALUE  SPACES.    02780053
027900     05  FILLER                      PIC  X(02) VALUE  SPACES.    02790053
028000     05  DL-OTBND-TRIP-3             PIC  X(09) VALUE  SPACES.    02800053
028100     05  FILLER                      PIC  X(02) VALUE  SPACES.    02810053
028200     05  DL-TRIP-STATUS-3            PIC  X(02) VALUE  SPACES.    02820053
028300     05  FILLER                      PIC  X(03) VALUE  SPACES.    02830055
028400     05  DL-MULT-TRIP-IND            PIC  X(01) VALUE  SPACES.    02840053
028410     05  FILLER                      PIC  X(02) VALUE  SPACES.    02841055
028500                                                                  02850053
028600 01 TOTAL-LINE-1.                                                 02860053
028700     05  FILLER                  PIC  X(38)    VALUE SPACES.      02870053
028800     05  FILLER                  PIC  X(24)    VALUE              02880053
028900              '*** DEPT EXP TOTAL:     '.                         02890053
029000     05  TL1-DEPT-EXP-TOTAL      PIC  ZZZZZZ9-.                   02900053
029100                                                                  02910053
029200 01 TOTAL-LINE-2.                                                 02920053
029300     05  FILLER                  PIC  X(37)    VALUE SPACES.      02930053
029400     05  FILLER                  PIC  X(22)    VALUE              02940053
029500              '*** STORE EXP TOTAL: '.                            02950053
029600     05  TL2-STORE-EXP-TOTAL     PIC  ZZZZZZZZZ9-.                02960053
029700                                                                  02970053
029800 01 TOTAL-LINE-3.                                                 02980053
029900     05  FILLER                  PIC  X(37)    VALUE SPACES.      02990053
030000     05  FILLER                  PIC  X(21)    VALUE              03000053
030100              '*** GRAND EXP TOTAL: '.                            03010053
030200     05  TL3-GRAND-EXP-TOTAL     PIC ZZZZZZZZZZ9-.                03020053
030300                                                                  03030053
030400 01  EP-EMPTY-REPORT-LINE.                                        03040053
030500     05  FILLER                       PIC X(54)  VALUE SPACES.    03050053
030600     05  FILLER                       PIC X(25)  VALUE            03060053
030700         '******* NO DATA *********'.                             03070053
030800     05  FILLER                       PIC X(54)  VALUE SPACES.    03080053
030900                                                                  03090053
031000 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    03100053
031100                                                                  03110053
031200 01  END-OF-REPORT-LINE.                                          03120053
031300     05  FILLER                  PIC  X(44)    VALUE SPACES.      03130053
031400     05  FILLER                  PIC  X(45)    VALUE              03140053
031500          '*******   E N D   O F   R E P O R T   *******'.        03150053
031600     05  FILLER                  PIC  X(43)    VALUE SPACES.      03160053
031700/                                                                 03170053
031800*---------------------------------------------------------------* 03180053
031900*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 03190053
032000*---------------------------------------------------------------* 03200053
032100     EXEC SQL                                                     03210053
032200          INCLUDE TSUOBTS                                         03220053
032300     END-EXEC.                                                    03230053
032400                                                                  03240053
032500*---------------------------------------------------------------* 03250053
032600*    TRECEIV - RECEIVING TABLE                                    03260053
032700*---------------------------------------------------------------* 03270053
032800     EXEC SQL                                                     03280053
032900          INCLUDE TRECEIV                                         03290053
033000     END-EXEC.                                                    03300053
033100                                                                  03310053
033200*---------------------------------------------------------------* 03320053
033300*    TKRPRPM - PARM TABLE                                         03330053
033400*---------------------------------------------------------------* 03340053
033500     EXEC SQL                                                     03350053
033600          INCLUDE TKRPRPM                                         03360053
033700     END-EXEC.                                                    03370053
033800                                                                  03380053
033900*---------------------------------------------------------------* 03390053
034000/                                                                 03400053
034100     EXEC SQL                                                     03410053
034200         INCLUDE SQLCA                                            03420053
034300     END-EXEC.                                                    03430053
034400                                                                  03440053
034500     COPY SQLCA2.                                                 03450053
034600/                                                                 03460053
034700 PROCEDURE DIVISION.                                              03470053
034800                                                                  03480053
034900 0000-MAINLINE.                                                   03490053
035000                                                                  03500053
035100     PERFORM 1000-INITIALIZE.                                     03510053
035200                                                                  03520053
035300     PERFORM 2000-PROCESS UNTIL PS-EOF-ERROR-FILE.                03530053
035400                                                                  03540053
035500     PERFORM 9000-EOJ.                                            03550053
035600                                                                  03560053
035700 THE-DUMPER.                                                      03570053
035800     GOBACK.                                                      03580053
035900                                                                  03590053
036000 1000-INITIALIZE.                                                 03600053
036100                                                                  03610053
036200     DISPLAY ' PCKRP022 STARTED'                                  03620053
036300     EXEC SQL SET :PV-TMST = CURRENT TIMESTAMP END-EXEC           03630053
036400                                                                  03640053
036500     OPEN OUTPUT REPORT-FILE                                      03650053
036600* LOAD SYSTEM DATE INTO HEADINGS                                  03660053
036700     ACCEPT SD-SYSTEM-DATE FROM DATE.                             03670053
036800     ACCEPT ST-SYSTEM-TIME FROM TIME.                             03680053
036900                                                                  03690053
037000     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              03700053
037100     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             03710053
037200     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               03720053
037300     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              03730053
037400     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            03740053
037500                                                                  03750053
037600     MOVE PC-CURRENT-PROGRAM-NAME                                 03760053
037700                                 TO DP132O-PROGRAM-NAME.          03770053
037800     MOVE 1                      TO DP132O-REPORT-NUMBER          03780053
037900                                    DP132O-PAGE-NUMBER            03790053
038000                                                                  03800053
038100     PERFORM 8100-WRITE-MAIN-HEADINGS                             03810053
038200                                                                  03820053
038300     OPEN INPUT EXTRACT-FILE                                      03830053
038400     PERFORM 8000-READ-EXTRACT                                    03840053
038500     MOVE PC038-DEPT-NBR          TO PV-PREV-DEPT                 03850053
038600     MOVE PC038-LOC-NBR           TO PV-PREV-STORE                03860053
038700     IF PS-EOF-ERROR-FILE                                         03870053
038800         DISPLAY ' -- NO UNBALANCED STR EXP -- '                  03880053
038900         WRITE REPORT-RECORD FROM EP-EMPTY-REPORT-LINE            03890053
039000             AFTER ADVANCING 3 LINES                              03900053
039100     END-IF.                                                      03910053
039200                                                                  03920053
039300     PERFORM 2500-GET-BOSS-PARM-RCVR.                             03930053
039400/                                                                 03940053
039500 2000-PROCESS.                                                    03950053
039600                                                                  03960053
039700     PERFORM 2200-BUILD-LINE.                                     03970053
039800     IF PS-BLANK-LINE                                             03980053
039900        WRITE REPORT-RECORD FROM DL-BLANK-LINE                    03990053
040000           AFTER ADVANCING 1 LINES                                04000053
040100        ADD 1                   TO PV-LINES-USED                  04010053
040200        SET PS-BLANK-LINE-NO    TO TRUE                           04020053
040300     END-IF                                                       04030053
040400                                                                  04040053
040500     IF PS-DEPT-LINE                                              04050053
040600        PERFORM 8500-DEPT-TOTAL                                   04060053
040700        SET PS-DEPT-LINE-NO    TO TRUE                            04070053
040800     END-IF.                                                      04080053
040900                                                                  04090053
041000     IF PS-STORE-LINE                                             04100053
041100        PERFORM 8600-STORE-TOTAL                                  04110053
041200        SET PS-STORE-LINE-NO    TO TRUE                           04120053
041300     END-IF.                                                      04130053
041400                                                                  04140053
041500     MOVE PC038-STR-EXPECTED-UNITS    TO DL-STORE-EXP-UNITS.      04150053
041600     ADD  PC038-STR-EXPECTED-UNITS    TO PV-DEPT-EXP-TOTAL        04160053
041700                                         PV-STORE-EXP-TOTAL       04170053
041800                                         PV-GRAND-EXP-TOTAL.      04180053
041900                                                                  04190053
042000     WRITE REPORT-RECORD FROM DL-DETAIL-LINE-1                    04200053
042100            AFTER ADVANCING 1 LINES                               04210053
042200     ADD 1                        TO PV-LINES-USED                04220053
042300                                                                  04230053
042400     IF PV-LINES-USED > PC-END-OF-PAGE                            04240053
042500         PERFORM 8100-WRITE-MAIN-HEADINGS                         04250053
042600     END-IF                                                       04260053
042700                                                                  04270053
042800     INITIALIZE DL-TRIP-STATUS-1                                  04280053
042900                DL-TRIP-STATUS-2                                  04290053
043000                DL-TRIP-STATUS-3                                  04300053
043100                DL-MULT-TRIP-IND.                                 04310053
043200                                                                  04320053
043300     PERFORM 8000-READ-EXTRACT.                                   04330053
043400/                                                                 04340053
043500 2200-BUILD-LINE.                                                 04350053
043600     IF   PC038-DEPT-NBR       =         PV-PREV-DEPT             04360053
043700         MOVE PC038-DEPT-NBR          TO DL-DEPT-NBR              04370053
043800      ELSE                                                        04380053
043900         SET PS-DEPT-LINE             TO TRUE                     04390053
044000         MOVE PC038-DEPT-NBR          TO DL-DEPT-NBR              04400053
044100         MOVE PC038-DEPT-NBR          TO PV-PREV-DEPT             04410053
044200     END-IF.                                                      04420053
044330                                                                  04433055
044400     IF   PC038-LOC-NBR       =         PV-PREV-STORE             04440053
044500         MOVE PC038-LOC-NBR           TO DL-STORE                 04450053
044600      ELSE                                                        04460053
044700         SET PS-STORE-LINE            TO TRUE                     04470053
044800         MOVE PC038-LOC-NBR           TO DL-STORE                 04480053
044900         MOVE PC038-LOC-NBR           TO PV-PREV-STORE            04490053
045000     END-IF.                                                      04500053
045100                                                                  04510053
045200     IF   PC038-PO-NBR            =     PV-PREV-PO                04520053
045300         IF   PC038-RCVR-SEQ-NBR  =     PV-PREV-RCVR              04530053
045400             MOVE PV-KEY-DATE TO DL-VRFD-DATE                     04540053
045500          ELSE                                                    04550053
045600             PERFORM 2400-GET-TRECEIV-VFYD-DATE                   04560053
045700             MOVE PC038-RCVR-SEQ-NBR  TO PV-PREV-RCVR             04570053
045800         END-IF                                                   04580053
045900      ELSE                                                        04590053
046000         PERFORM 2400-GET-TRECEIV-VFYD-DATE                       04600053
046100         MOVE PC038-PO-NBR           TO PV-PREV-PO                04610053
046200     END-IF.                                                      04620053
046300                                                                  04630053
046400                                                                  04640053
046500     MOVE PC038-OPER-UNT-ID           TO DL-DC.                   04650053
046600     MOVE PC038-SUB-CL-NBR            TO DL-SUB-CLASS.            04660053
046700     MOVE PC038-PO-NBR                TO DL-PO.                   04670053
046800     MOVE '-'                         TO DL-DASH.                 04680053
046900                                                                  04690053
047000     IF PC038-RCVR-SEQ-NBR = PV-BOSS-PARM-RECV                    04700053
047100        MOVE 'BSS'                    TO DL-RCVR-X                04710053
047200        ADD 1                         TO PV-BOSS-COUNT            04720053
047300     ELSE                                                         04730053
047400        MOVE PC038-RCVR-SEQ-NBR       TO DL-RCVR                  04740053
047500     END-IF.                                                      04750053
047600                                                                  04760053
047601     MOVE PC038-SEPHORA-IND           TO DL-SEPHORA-ORDER.        04760155
047610                                                                  04761055
047700     MOVE PC038-REC-TYP-CDE           TO DL-REC-TYP.              04770053
047800     MOVE PC038-SKU-9                 TO DL-SKU-NBR.              04780053
047900     IF PC038-APP-PO-LNE-NBR-X NUMERIC                            04790053
048000          MOVE PC038-APP-PO-LNE-NBR   TO DL-APP-PO-LNE-NBR        04800053
048100     ELSE                                                         04810053
048200          MOVE PC038-APP-PO-LNE-NBR-X TO DL-APP-PO-LNE-NBR-X      04820053
048300     END-IF.                                                      04830053
048400                                                                  04840053
048500     MOVE PC038-OTBND-TRIP-1          TO DL-OTBND-TRIP-1          04850053
048600                                         PV-OTBND-TRIP.           04860053
048700     IF PC038-OTBND-TRIP-1    > ZEROS                             04870053
048800         PERFORM 2300-OTBND-TRIP-STATUS                           04880053
048900         MOVE SUOBTS-TRIP-STAT-CDE    TO DL-TRIP-STATUS-1         04890053
049000     ELSE                                                         04900053
049100         MOVE SPACES                  TO DL-OTBND-TRIP-1          04910053
049200     END-IF.                                                      04920053
049300     IF PC038-OTBND-TRIP-2    > ZEROS                             04930053
049400         MOVE PC038-OTBND-TRIP-2      TO DL-OTBND-TRIP-2          04940053
049500                                         PV-OTBND-TRIP            04950053
049600         PERFORM 2300-OTBND-TRIP-STATUS                           04960053
049700         MOVE SUOBTS-TRIP-STAT-CDE    TO DL-TRIP-STATUS-2         04970053
049800     ELSE                                                         04980053
049900         MOVE SPACES                  TO DL-OTBND-TRIP-2          04990053
050000     END-IF.                                                      05000053
050100     IF PC038-OTBND-TRIP-3    > ZEROS                             05010053
050200         MOVE PC038-OTBND-TRIP-3      TO DL-OTBND-TRIP-3          05020053
050300                                         PV-OTBND-TRIP            05030053
050400         PERFORM 2300-OTBND-TRIP-STATUS                           05040053
050500         MOVE SUOBTS-TRIP-STAT-CDE    TO DL-TRIP-STATUS-3         05050053
050600     ELSE                                                         05060053
050700         MOVE SPACES                  TO DL-OTBND-TRIP-3          05070053
050800     END-IF.                                                      05080053
050900     MOVE PC038-MULTIPLE-TRIP-IND     TO DL-MULT-TRIP-IND.        05090053
051000/                                                                 05100053
051100 2300-OTBND-TRIP-STATUS.                                          05110053
051200                                                                  05120053
051300     MOVE '2300-OTBND-TRIP-STATUS'    TO PV-PARAGRAPH.            05130053
051400                                                                  05140053
051500     INITIALIZE SUOBTS-TRIP-STAT-CDE.                             05150053
051600                                                                  05160053
051700     PERFORM                                                      05170053
051800         WITH TEST AFTER                                          05180053
051900         VARYING PV-RETRY-COUNTER                                 05190053
052000         FROM 1 BY 1                                              05200053
052100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               05210053
052200            OR  (SQLCODE = +100)                                  05220053
052300            OR  (SQLCODE = +0))                                   05230053
052400                                                                  05240053
052500         EXEC SQL                                                 05250053
052600             SELECT A.TRIP_STAT_CDE                               05260053
052700              INTO :SUOBTS-TRIP-STAT-CDE                          05270053
052800              FROM  TSUOBTS  A                                    05280053
052900             WHERE  A.OTBND_TRIP_ID  = :PV-OTBND-TRIP             05290053
053000               AND A.OTBND_STAT_TMST =                            05300053
053100                    (SELECT MAX(A.OTBND_STAT_TMST)                05310053
053200                       FROM TSUOBTS  A                            05320053
053300                     WHERE A.OTBND_TRIP_ID  = :PV-OTBND-TRIP)     05330053
053400         WITH UR                                                  05340053
053500         END-EXEC                                                 05350053
053600                                                                  05360053
053700         EVALUATE TRUE                                            05370053
053800             WHEN SQLCODE = ZERO                                  05380053
053900             WHEN SQLCODE = +100                                  05390053
054000                 CONTINUE                                         05400053
054100             WHEN SQLCODE = -904                                  05410053
054200             WHEN SQLCODE = -911                                  05420053
054300             WHEN SQLCODE = -913                                  05430053
054400                  CONTINUE                                        05440053
054500                                                                  05450053
054600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              05460053
054700                 DISPLAY '**************************************' 05470053
054800                 DISPLAY 'WARNING ISSUED '                        05480053
054900                 DISPLAY 'SELECT TSUOBTS                        ' 05490053
055000                 DISPLAY '**************************************' 05500053
055100                 PERFORM 9300-SQL-WARNING                         05510053
055200                                                                  05520053
055300             WHEN SQLCODE < ZERO                                  05530053
055400                 DISPLAY '**************************************' 05540053
055500                 DISPLAY 'ERROR ISSUED ON                       ' 05550053
055600                 DISPLAY 'SELECT TSUOBTS                        ' 05560053
055700                 DISPLAY '**************************************' 05570053
055800                 PERFORM 9200-SQL-ERROR                           05580053
055900                                                                  05590053
056000         END-EVALUATE                                             05600053
056100     END-PERFORM.                                                 05610053
056200                                                                  05620053
056300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05630053
056400         SQLCODE NOT = ZERO                                       05640053
056500         DISPLAY '**************************************'         05650053
056600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         05660053
056700         DISPLAY 'SELECT TSUOBTS         '                        05670053
056800         DISPLAY '**************************************'         05680053
056900         PERFORM 9200-SQL-ERROR                                   05690053
057000     END-IF.                                                      05700053
057100                                                                  05710053
057200 2400-GET-TRECEIV-VFYD-DATE.                                      05720053
057300                                                                  05730053
057400     MOVE '2400-GET-TRECEIV-VFYD-DATE'    TO PV-PARAGRAPH.        05740053
057500                                                                  05750053
057600     INITIALIZE RECEIV-VERFYD-TMST.                               05760053
057700                                                                  05770053
057800     PERFORM                                                      05780053
057900         WITH TEST AFTER                                          05790053
058000         VARYING PV-RETRY-COUNTER                                 05800053
058100         FROM 1 BY 1                                              05810053
058200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               05820053
058300            OR  (SQLCODE = +100)                                  05830053
058400            OR  (SQLCODE = +0))                                   05840053
058500                                                                  05850053
058600         EXEC SQL                                                 05860053
058700             SELECT VERFYD_TMST                                   05870053
058800              INTO :RECEIV-VERFYD-TMST                            05880053
058900              FROM  TRECEIV                                       05890053
059000             WHERE  ORD_NBR     = :PC038-PO-NBR                   05900053
059100               AND  REC_SEQ_NBR = :PC038-RCVR-SEQ-NBR             05910053
059200         WITH UR                                                  05920053
059300         END-EXEC                                                 05930053
059400                                                                  05940053
059500         EVALUATE TRUE                                            05950053
059600             WHEN SQLCODE = ZERO                                  05960053
059700                 IF RECEIV-VERFYD-TMST NOT =                      05970053
059800                                     '9999-09-09-09.09.09.999999' 05980053
059900                     MOVE RECEIV-VERFYD-TMST TO PV-DB2-DATE       05990053
060000                     MOVE PV-DB2-YY   TO PV-KEY-YY                06000053
060100                     MOVE PV-DB2-MM   TO PV-KEY-MM                06010053
060200                     MOVE PV-DB2-DD   TO PV-KEY-DD                06020053
060300                     MOVE PV-KEY-DATE TO DL-VRFD-DATE             06030053
060400                 ELSE                                             06040053
060500                     MOVE SPACES TO   DL-VRFD-DATE                06050053
060600                 END-IF                                           06060053
060700             WHEN SQLCODE = +100                                  06070053
060800                 MOVE SPACES TO   DL-VRFD-DATE                    06080053
060900             WHEN SQLCODE = -904                                  06090053
061000             WHEN SQLCODE = -911                                  06100053
061100             WHEN SQLCODE = -913                                  06110053
061200                  CONTINUE                                        06120053
061300                                                                  06130053
061400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              06140053
061500                 DISPLAY '**************************************' 06150053
061600                 DISPLAY 'WARNING ISSUED '                        06160053
061700                 DISPLAY 'SELECT TRECEIV                        ' 06170053
061800                 DISPLAY '**************************************' 06180053
061900                 PERFORM 9300-SQL-WARNING                         06190053
062000                                                                  06200053
062100             WHEN SQLCODE < ZERO                                  06210053
062200                 DISPLAY '**************************************' 06220053
062300                 DISPLAY 'ERROR ISSUED ON                       ' 06230053
062400                 DISPLAY 'SELECT TRECEIV                        ' 06240053
062500                 DISPLAY '**************************************' 06250053
062600                 PERFORM 9200-SQL-ERROR                           06260053
062700                                                                  06270053
062800         END-EVALUATE                                             06280053
062900     END-PERFORM.                                                 06290053
063000                                                                  06300053
063100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    06310053
063200         SQLCODE NOT = ZERO                                       06320053
063300         DISPLAY '**************************************'         06330053
063400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         06340053
063500         DISPLAY 'SELECT TRECEIV         '                        06350053
063600         DISPLAY '**************************************'         06360053
063700         PERFORM 9200-SQL-ERROR                                   06370053
063800     END-IF.                                                      06380053
063900                                                                  06390053
064000******************************************************************06400053
064100*- READ TKRPRPM TO RETRIEVE THE BOSS RECEIVER PARM                06410053
064200******************************************************************06420053
064300 2500-GET-BOSS-PARM-RCVR.                                         06430053
064400                                                                  06440053
064500     EXEC SQL                                                     06450053
064600         SELECT FUNC_QTY                                          06460053
064700           INTO :PV-BOSS-PARM-RECV                                06470053
064800           FROM TKRPRPM                                           06480053
064900          WHERE LOC_ID            = 90                            06490053
065000            AND INTFC_SYS_CDE     = 'GIV'                         06500053
065100            AND SYS_PRC_FUNC_CDE  = 'BSSRCV'                      06510053
065200            AND FUNC_PRC_STAT_CDE = 'AC'                          06520053
065300          WITH UR                                                 06530053
065400     END-EXEC.                                                    06540053
065500                                                                  06550053
065600     EVALUATE TRUE                                                06560053
065700          WHEN SQLCODE = +0                                       06570053
065800              MOVE PV-BOSS-PARM-RECV     TO PV-BOSS-PARM-DISP     06580053
065900              DISPLAY ' BOSS PARM RECEIVER  = '                   06590053
066000                                            PV-BOSS-PARM-DISP     06600053
066100                                                                  06610053
066200          WHEN SQLCODE = +100                                     06620053
066300              MOVE ZEROES                TO PV-BOSS-PARM-RECV     06630053
066400                                                                  06640053
066500          WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                 06650053
066600              DISPLAY '**************************************'    06660053
066700              DISPLAY '2500-GET-BOSS-PARM-RCVR               '    06670053
066800              DISPLAY 'SELECT TKRPRPM - BOSS RECEIVER        '    06680053
066900              DISPLAY '**************************************'    06690053
067000              PERFORM 9300-SQL-WARNING                            06700053
067100                                                                  06710053
067200          WHEN SQLCODE < ZERO                                     06720053
067300              DISPLAY '**************************************'    06730053
067400              DISPLAY '2500-GET-BOSS-PARM-RCVR               '    06740053
067500              DISPLAY 'ERROR ISSUED ON                       '    06750053
067600              DISPLAY 'SELECT TKRPRPM - BOSS RECEIVER        '    06760053
067700              DISPLAY '**************************************'    06770053
067800              PERFORM 9200-SQL-ERROR                              06780053
067900                                                                  06790053
068000      END-EVALUATE.                                               06800053
068100/                                                                 06810053
068200******************************************************************06820053
068300 8000-READ-EXTRACT.                                               06830053
068400     READ EXTRACT-FILE                                            06840053
068500         INTO PC038-SE-UNBALANCED-RPT-REC                         06850053
068600     AT END                                                       06860053
068700         SET PS-EOF-ERROR-FILE        TO TRUE                     06870053
068800     NOT AT END                                                   06880053
068900         ADD 1                        TO PV-READ-COUNT            06890053
069000     END-READ.                                                    06900053
069100                                                                  06910053
069200 8100-WRITE-MAIN-HEADINGS.                                        06920053
069300                                                                  06930053
069400     ADD 1                            TO PV-PAGE-COUNT.           06940053
069500     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      06950053
069600     MOVE ZERO                        TO PV-LINES-USED            06960053
069700                                                                  06970053
069800     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      06980053
069900                 AFTER ADVANCING PAGE                             06990053
070000                                                                  07000053
070100     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1                   07010053
070200        AFTER ADVANCING 2 LINES.                                  07020053
070300     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1A                  07030053
070400        AFTER ADVANCING 1 LINES.                                  07040053
070500     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       07050053
070600        AFTER ADVANCING 1 LINES.                                  07060053
070700     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2A                  07070053
070800        AFTER ADVANCING 1 LINES.                                  07080053
070900     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2                   07090053
071000        AFTER ADVANCING 1 LINES.                                  07100053
071100                                                                  07110053
071200     ADD 6                            TO PV-LINES-USED.           07120053
071300                                                                  07130053
071400     WRITE REPORT-RECORD FROM HL-HEADING-LINE-3                   07140053
071500        AFTER ADVANCING 1 LINES.                                  07150053
071600                                                                  07160053
071700                                                                  07170053
071800     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   07180053
071900     ADD  2                           TO PV-LINES-USED.           07190053
072000/                                                                 07200053
072100******************************************************************07210053
072200*     WRITES THE DEPARTMENT TOTAL STORE EXPECTED UNIT LINE       *07220053
072300******************************************************************07230053
072400 8500-DEPT-TOTAL.                                                 07240053
072500                                                                  07250053
072600     MOVE PV-DEPT-EXP-TOTAL     TO TL1-DEPT-EXP-TOTAL.            07260053
072700                                                                  07270053
072800     WRITE REPORT-RECORD                                          07280053
072900       FROM TOTAL-LINE-1                                          07290053
073000         AFTER ADVANCING 1 LINES.                                 07300053
073100                                                                  07310053
073200     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       07320053
073300        AFTER ADVANCING 1 LINES.                                  07330053
073400                                                                  07340053
073500     ADD  2                      TO PV-LINES-USED.                07350053
073600     MOVE ZERO                   TO PV-DEPT-EXP-TOTAL.            07360053
073700/                                                                 07370053
073800******************************************************************07380053
073900*     WRITES THE STORE TOTAL STORE EXPECTED UNIT LINE            *07390053
074000******************************************************************07400053
074100 8600-STORE-TOTAL.                                                07410053
074200                                                                  07420053
074300     MOVE PV-STORE-EXP-TOTAL      TO TL2-STORE-EXP-TOTAL.         07430053
074400                                                                  07440053
074500     WRITE REPORT-RECORD                                          07450053
074600       FROM TOTAL-LINE-2                                          07460053
074700         AFTER ADVANCING 1 LINES.                                 07470053
074800                                                                  07480053
074900     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       07490053
075000        AFTER ADVANCING 1 LINES.                                  07500053
075100                                                                  07510053
075200     ADD  2                      TO PV-LINES-USED.                07520053
075300     MOVE ZERO                   TO PV-STORE-EXP-TOTAL.           07530053
075400/                                                                 07540053
075500******************************************************************07550053
075600*     WRITES THE GRAND TOTAL STORE EXPECTED UNIT LINE            *07560053
075700******************************************************************07570053
075800 8700-GRAND-TOTAL.                                                07580053
075900                                                                  07590053
076000     MOVE PV-GRAND-EXP-TOTAL      TO TL3-GRAND-EXP-TOTAL.         07600053
076100                                                                  07610053
076200     WRITE REPORT-RECORD                                          07620053
076300       FROM TOTAL-LINE-3                                          07630053
076400         AFTER ADVANCING 1 LINES.                                 07640053
076500                                                                  07650053
076600     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       07660053
076700        AFTER ADVANCING 1 LINES.                                  07670053
076800                                                                  07680053
076900     ADD  2                      TO PV-LINES-USED.                07690053
077000     MOVE ZERO                   TO PV-GRAND-EXP-TOTAL.           07700053
077100/                                                                 07710053
077200******************************************************************07720053
077300 9000-EOJ.                                                        07730053
077400                                                                  07740053
077500     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       07750053
077600        AFTER ADVANCING 1 LINES.                                  07760053
077700                                                                  07770053
077800     PERFORM 8500-DEPT-TOTAL.                                     07780053
077900     PERFORM 8600-STORE-TOTAL.                                    07790053
078000     PERFORM 8700-GRAND-TOTAL.                                    07800053
078100                                                                  07810053
078200     WRITE REPORT-RECORD                                          07820053
078300       FROM END-OF-REPORT-LINE                                    07830053
078400         AFTER ADVANCING 2 LINES.                                 07840053
078500                                                                  07850053
078600     CLOSE REPORT-FILE                                            07860053
078700           EXTRACT-FILE.                                          07870053
078800     MOVE PV-READ-COUNT               TO PV-DISP-COUNT            07880053
078900     DISPLAY ' RECORDS READ       = ' PV-DISP-COUNT.              07890053
079000     MOVE PV-BOSS-COUNT               TO PV-DISP-COUNT            07900053
079100     DISPLAY ' BOSS RECORDS READ  = ' PV-DISP-COUNT.              07910053
079200/                                                                 07920053
079300 9100-ABEND.                                                      07930053
079400                                                                  07940053
079500     CLOSE EXTRACT-FILE                                           07950053
079600           REPORT-FILE                                            07960053
079700                                                                  07970053
079800     MOVE +4013                       TO ABEND-CODE.              07980053
079900     CALL 'ILBOABN0' USING ABEND-CODE.                            07990053
080000                                                                  08000053
080100 9200-SQL-ERROR.                                                  08010053
080200                                                                  08020053
080300     MOVE SQLCODE                     TO SQLCODE2.                08030053
080400     MOVE SQLERRD(3)                  TO SQLERRD3.                08040053
080500                                                                  08050053
080600     DISPLAY '** ABEND **         ** = SQLERROR'.                 08060053
080700     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08070053
080800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   08080053
080900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                08090053
081000                                                                  08100053
081100     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                08110053
081200     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                08120053
081300     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 08130053
081400     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                08140053
081500                                                                  08150053
081600                                                                  08160053
081700     MOVE +4013                       TO ABEND-CODE.              08170053
081800     CALL 'ILBOABN0' USING ABEND-CODE.                            08180053
081900                                                                  08190053
082000 9300-SQL-WARNING.                                                08200053
082100                                                                  08210053
082200     DISPLAY '9300-SQL-WARNING'.                                  08220053
082300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08230053
082400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   08240053
082500     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                08250053
082600                                                                  08260053
082700     MOVE SQLCODE                     TO SQLCODE2.                08270053
082800     MOVE SQLERRD(3)                  TO SQLERRD3.                08280053
082900     DISPLAY '** ABEND **       ** = SQLWARNING'.                 08290053
083000     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  08300053
083100     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  08310053
083200     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  08320053
083300     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  08330053
083400     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  08340053
083500     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  08350053
083600     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  08360053
083700     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  08370053
083800     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  08380053
083900     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  08390053
084000                                                                  08400053
084100     MOVE +4013                       TO ABEND-CODE.              08410053
084200     CALL 'ILBOABN0' USING ABEND-CODE.                            08420053
084300                                                                  08430053
