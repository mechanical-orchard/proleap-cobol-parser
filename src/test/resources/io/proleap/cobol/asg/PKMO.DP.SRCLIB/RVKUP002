000100******************************************************************00010037
000200 IDENTIFICATION DIVISION.                                         00020037
000300******************************************************************00030037
000400                                                                  00040037
000500 PROGRAM-ID.   RVKUP002.                                          00050037
000600 AUTHOR.       THERESE RAMSEYER.                                  00060037
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070037
000800 DATE-WRITTEN. NOVEMBER 2006.                                     00080037
000900 DATE-COMPILED.                                                   00090037
001000                                                                  00100037
001100******************************************************************00110037
001200*  RTV - INTERFACE GENCO HEADERS & DETAILS TO TDFCTOR & TDFMEIT   00120037
001300******************************************************************00130037
001400* !!! IMPORTANT !!! THE LOGIC IN THIS PROGRAM CRITICALLY DEPENDS  00140037
001500* UPON THE 2 INPUT FILES BEING SORTED AS FOLLOWS:                 00150037
001600*                                                                 00160037
001700* HDR FILE: SORT FIELDS=(01,06,CH,A)    DFCT ORD ID               00170037
001800*                                                                 00180037
001900* DTL FILE: SORT FIELDS=(1,6,CH,A,             DFCT ORD ID        00190037
002000*                      81,10,CH,A,             DEPT               00200037
002100*                      91,10,CH,A,             CLASS/SUBCLASS     00210038
002200*                      16,10,CH,A,             SKU                00220037
002300*                      51,9,CH,A)              RETAIL COST        00230037
002400*-----------------------------------------------------------------00240037
002500*  THIS PROGRAM COMPILES WITH A RET CODE OF 4 BECAUSE THE UPDATE  00250037
002600*  TO TDFORCR UPDATES THE ENTIRE TABLE (OF 1 ROW)                 00260037
002700*-----------------------------------------------------------------00270037
002800*    THIS PROGRAM HAS CHECKPOINT RESTART                          00280037
002900*-----------------------------------------------------------------00290037
003000* HIGH LEVEL DOC: THIS PROGRAM READS AN INPUT HDR AND AN INPUT DTL00300037
003100* FILE TO LOAD THE RTV TABLES. THE TABLES ARE LOADED IN PAIRS.    00310037
003200* TDFCTOR MUST BE LOADED FIRST ALONG WITH A ROW TO RVT_DFCT_STAT. 00320037
003300* TDFMEIT, ITM TBL IS LOADED ALONG WITH A ROW TO RVT_DFCT_ITM_STAT00330037
003400* SOMETIMES RVT_DFCT_SHIPT IS LOADED ALONG WITH ITS CHILD ROW IN  00340037
003500* RVT_SHIPT_STAT. THE TBL TDFORCR IS ACCESSED TO CALCULATE        00350037
003600* MKOUT-ORD-ID'S BY INCREMENTING THE CURRENT MKOUT-ORD-ID, AND    00360037
003700* UPDATING THE TABLE WITH THE LAST MKOUT-ORD-ID USED.             00370037
003800* THERE ARE WARNINGS AND CRITICAL ERRORS WRITTEN TO THE WORK TBL  00380037
003900* RVTW_DFCTOR_ERR. THESE GET DUMPED AND SORTED FOR A REPORT.      00390037
004000* THERE ARE ACCUMULATED TOTALS OF THE NBR OF DTL RECS RECEIVED,   00400037
004100* THE RTL_COST_AMT & THE UNT_COST_AMT RECEIVED FOR EACH OF THE    00410037
004200* RETURN-TYPES OR 'R' (RTV), 'M' (MARK-OUT-OF-STOCK) AND          00420037
004300* 'D' (DEBIT&DISPOSE). THE TOTALS ARE ROLLED UP INTO ONE ROW      00430037
004400*  THAT GETS INSERTED TO THE RVTW_DFCTOR_ERR WORK TABLE. THIS     00440037
004500* WILL BE SORTED OUT OF THE FILE TO BE USED FOR A GENCO LOAD      00450037
004600* SUMMARY REPORT THAT COMPARES WHAT WAS RECEIVED AND WHAT         00460037
004700* WAS ACTUALLY APPLIED TO THE RTV TABLES.                         00470037
004800* THE RCVD SUM IS A LITTLE TRICKY BECAUSE THE RETURN TYPE IS      00480037
004900* ON THE HDR AND THE DOLLAR AMTS ARE ON THE DETAIL AND THE        00490037
005000* PROCESSING SITS ON THE 'NEXT CSR DTL REC' BEFORE INSERTS ARE    00500037
005100* DONE - SO THE RETURN-TYP MUST BE HELD IN A HOLD FIELD WHEN      00510037
005200* THE HDR & DTL DFCT-ORD-IDS ARE IN SYNC WHICH SHOULD BE AFTER    00520037
005300* THE EXEC OF PARA- 2100-CHECK-ORD-IDS.                           00530037
005400*-----------------------------------------------------------------00540037
005500* DATE:        10/30/2011                                         00550037
005600* PROJ#:       3219  GENCO/RTV UPGRADE PROJECT                    00560037
005700* WR/IR#:      WR40134                                            00570037
005800* PROGRAMMER:  JOHN HUTCHINSON / CHRIS STRODTHOFF                 00580037
005900* DESCRIPTION: ADD NEW PS-ERROR-TEXT 'INVALID LOCATION FOUND'.    00590037
006000*              IN PARAGRAPH 2200-EDIT-HDR-REC, REMOVE UNNEEDED    00600037
006100*              CODE. USING RV050-OPER-UNT-ID, SELECT FROM XLT-LOC 00610037
006200*              WHERE RV050-OPER-UNT-ID IS EQUAL TO XLT_LOC AND    00620037
006300*              LOC_TYP_CDE = 'RV' TO SELECT LOC_10_ABBR_NM        00630037
006400*              ADD NEW FIELDS RV018-RTV-LOC AND RV018-LOC-NAME    00640037
006500*              TO COPYBOOK RVWS018.                               00650037
006600*              ADD NEW FIELDS RV019-RTV-LOC AND RV019-LOC-NAME    00660037
006700*              TO COPYBOOK RVWS019.                               00670037
006800*              ADD NEW FIELDS RV020-RTV-LOC AND RV020-LOC-NAME    00680037
006900*              TO COPYBOOK RVWS020.                               00690037
007000*                                                                 00700037
007100* ----------------------------------------------------------------00710037
007200*  THERE ARE 4 RETURN TYPES 'C' - CALLBACKS ARE NOT PROCESSED AND 00720037
007300*  COMPLETELY BYPASSED. 'M' RETURN TYPES ARE MARK-OUT-OF-STOCK,   00730037
007400*  'R' ARE RETURN TO VENDOR & 'D' CAN EITHER BE DEBIT-AND-DAMAGED 00740037
007500*   OR DEBIT-AND-DESTROY. THE 'D' RETURN TYPES ARE DIFFERENTIATED 00750037
007600*   BY WHETHER THERE ARE SHIPPING ROWS GENERATED - THE DEBIT AND  00760037
007700*   DAMAGED WILL REQUIRE A CARR_TRKG_ID & SHIPPING ROWS WILL      00770037
007800*   BE CREATED - FOR DEBIT & DESTROY - THERE SHOULD NOT BE A      00780037
007900*   CARR_TRKG_ID AND NO SHIPPING ROWS WILL BE GENERATED.          00790037
008000*   EITHER WAY6 FOR 'D', THEY ARE REFERRED TO AS 'DEBIT&DISPOSE'  00800037
008100*   ON THE BUSINESS SIDE.                                         00810037
008200*                                                                 00820037
008300*   >>>>> BELOW IS A MATRIX OF EDITS AND SPECIAL CONDITIONS <<<<< 00830037
008400*-----------------------------------------------------------------00840037
008500* INPUT FILE FLD | 'R' RET TYP    | 'M' RET TYP   | 'D' RET TYP   00850037
008600*                |                |               |               00860037
008700*________________|________________|_______________|_______________00870037
008800*DFCT-ORD-ID     |MUST BE NUMERIC                                 00880037
008900*________________|________________________________________________00890037
009000*VENDOR-DUNS-NBR |   REQRD        |  NOT REQRD    |      REQRD    00900037
009100*________________|________________|_______________|_______________00910037
009200*VEND-NAME       |VALIDATE WITH   |IF BLANK & NO  |VALIDATE WITH  00920037
009300*                |DUNS OR WARN    |DUNS, USE MSG  |DUNS OR WARN   00930037
009400*________________|________________|_______________|_______________00940037
009500*RETURN-TYPE     |MUST BE POPULATED WITH 'C', 'D', 'M' OR 'R'     00950037
009600*________________|________________________________________________00960037
009700*ORD-DTE         |S/B VALID OR BYPASS THE ENTIRE LISTING(DFCT-ORD)00970037
009800*________________|________________________________________________00980037
009900*OPER-UNT-ID     |THIS SHOULD BE 0810 FROM GENCO OR WE MOVE 0810  00990037
010000*________________|________________________________________________01000037
010100*LOC-ID          |NO EDITS - IF NULLS, MOVE SPACES.               01010037
010200*________________|________________________________________________01020037
010300*STATUS-CHG-DTE  |VALID OR BYPASS ENTIRE LISTING (DFCT-ORD-ID)    01030037
010400*________________|________________________________________________01040037
010500*DFCT-ORD-STAT-  |                                                01050037
010600*            CDE |MUST BE 'S' OR 'D' OTHERWISE BYPASS LISTING     01060037
010700*                |THIS SHOULD BE 'S' 'SHIPPED' FOR  RETURNS,      01070037
010800*                |MOS OR DEBIT&DAMAGED - THIS SHOULD BE 'D' FOR   01080037
010900*                |DEBIT&DISPOSED - THIS    IS    NOT  ENFORCED    01090037
011000*                |IN THE CODE - IT IS JUST ASSUMED GENCO GETS IT !01100037
011100*________________|________________________________________________01110037
011200*DFCT-SHIPT-ID   | THIS IS NEVER USED FROM THE INPUT, EITHER IT IS01120037
011300*                | USED FROM RVT_DFCT_SHIPT IF THE CARR-TRKG-ID & 01130037
011400*                | SCAC ARE A HIT -OR- A NEW SHIPPING ROW IS ADDED01140037
011500*                | WITH THE DFCT-SHIPT-ID A RANDOM GENERATED NBR  01150037
011600*________________|________________________________________________01160037
011700*SHIPT-DTE       |IF IT IS NOT VALID, BYPASS ENTIRE LISTING       01170037
011800*________________|________________________________________________01180037
011900*SHIPT-STAT-CDE  |WE DON'T EDIT - JUST HARD CODE AN 'S'           01190037
012000*________________|________________________________________________01200037
012100*CART-QTY        |IF NOT NUMERIC, MOVE ZERO                       01210037
012200*________________|________________________________________________01220037
012300*VND-AUTH-NBR    |'R' = MUST BE   |'M' = CAN BE   |'D' = MUST BE  01230037
012400*                | SENT & COUPLED | SPACES FROM   | SENT & COUPLED01240037
012500*                | WITH VALID     | GENCO         | WITH VALID    01250037
012600*                | VND-AUTH-DTE   |               | VND-AUTH-DTE  01260037
012700*                | OR BYPASS THE  |               | OR BYPASS THE 01270037
012800*                | ENTIRE LISTING |               | ENTIRE LISTING01280037
012900*________________|________________|_______________|_______________01290037
013000*VND-AUTH-DTE    | 'R' = MUST BE  |NO NEED TO EDIT| 'D' = MUST BE 01300037
013100*                |  VALID AND     |AS NULLS ARE   |  VALID AND    01310037
013200*                |COUPLED WITH A  |ALWAYS MOVED   |COUPLED WITH A 01320037
013300*                |VND-AUTH-NBR OR |FOR 'M'        |VND-AUTH-NBR OR01330037
013400*                |BYPASS LISTING  |               |BYPASS LISTING 01340037
013500*________________|________________________________________________01350037
013600* _SIGN  FIELDS  |(-) MEANS NEXT FIELD IS NEGATIVE, ANYTHING      01360037
013700*                | ELSE IS INTERPRETTED AS A POSITIVE             01370037
013800*________________|________________________________________________01380037
013900* _AMT  FIELDS   | EDITED FOR NUMERIC, IF NOT LOAD ZEROS          01390037
014000*________________|________________________________________________01400037
014100* WEIGHT         | EDITED FOR NUMERIC, IF NOT LOAD ZEROS          01410037
014200*________________|________________________________________________01420037
014300*RET-RSN-CDE     |MUST BE VALUE 1-9, IF NOT MOVE 9                01430037
014400*________________|________________________________________________01440037
014500*PAYT-TYP-CDE    | SHOULD BE 'P' OR 'C' FOR A RETURN-TYPE 'R', 'M'01450037
014600*                | OR ('D'  WHERE CARR_TRKG_ID IS NOT SPACES).    01460037
014700*                | SHOULD BE SPACE WHERE (RETURN-TYPE IS 'D' AND  01470037
014800*                | CARR_TRKG_ID SPACES)                           01480037
014900*                | 06/06/07 SIMPLIFY EDIT - IF ANYTHING           01490037
015000*                | 06/06/07 OTHER THAN 'P'OR'C' REPLACE WITH A 'P'01500037
015100*                | 06/06/07 NO ERROR WILL BE ISSUED TO ERR TABLE  01510037
015200*________________|________________________________________________01520037
015300*CARR-TRKG-ID    | MUST BE SENT OR|MUST BE SENT OR|DEBIT&DESTROY =01530037
015400*                | BYPASS LISTING |BYPASS LISTING |NO CARR_TRKG_ID01540037
015500*                |                |               |NO SHIPPING    01550037
015600*                |                |               |ROWS CREATED   01560037
015700*                |                |               | -----------   01570037
015800*                |                |               |DEBIT&DAMAGED =01580037
015900*                |                |               |CARR_TRKG_ID IS01590037
016000*                |                |               |REQUIRED AND   01600037
016100*                |                |               |SHIPPING ROWS  01610037
016200*                |                |               |ARE CREATED    01620037
016300*________________|________________|_______________|_______________01630037
016400*USR-ID          | IF SPACE MOVE DEFAULT 'RLOG'                   01640037
016500*________________|________________________________________________01650037
016600*TRLR-ID         |IF NULLS, MOVE SPACES                           01660037
016700*________________|________________________________________________01670037
016800*SCAC-CDE        | MUST BE VALID  | MUST BE VALID |DEBIT&DISPOSE =01680037
016900*                |KOHL'S CARRIER  |KOHL'S CARRIER |CARR_TRKG_ID,  01690037
017000*                |                |               |TRLR_ID &      01700037
017100*                |                |               |DFCT_SHIPT_ID  01710037
017200*                |                |               |SHOULD BE SPACE01720037
017300*                |                |               |FROM GENCO.THIS01730037
017400*                |                |               |IS NOT ENFORCED01740037
017500*                |                |               |IN THE CODE.   01750037
017600*________________|________________|_______________|_______________01760037
017700*VEND-ATTN-NAME  | NO EDITS.                                      01770037
017800*VEND-ADDR-DESC  |                                                01780037
017900*CITY            |                                                01790037
018000*STATE-CDE       |                                                01800037
018100*VND-EMAIL-ADDR  |                                                01810037
018200*________________|________________________________________________01820037
018300*ZIPCODE         | IF NOT NUMERIC, MOVE ZEROS.                    01830037
018400*PHN-AREA-CDE    |                                                01840037
018500*PHN-EXCH-NBR    |                                                01850037
018600*PHN-NBR         |                                                01860037
018700*FAX-PHN-AREA-CDE|                                                01870037
018800*FAX-EXCH-NBR    |                                                01880037
018900*FAX-PHN-NBR     |                                                01890037
019000*________________|________________________________________________01900037
019100*SEQ-NBR         | MUST BE NUMERIC.                               01910037
019200*________________|________________________________________________01920037
019300*SKU             |INPUT FORMAT IS FIRST 8 BYTES ARE SKU AND LAST  01930037
019400*                |2 BYTES ARE SPACES. THE ITEM NBR IS RETRIEVED   01940037
019500*                |USING KOHL'S BLACK BOX ROUTINE.                 01950037
019600*________________|________________________________________________01960037
019700*UPC             |THIS IS SENT AND ABSOLUTLY NOTHING IS EDITED OR 01970037
019800*                |DONE WITH THIS - IT IS NOT LOADED ANYWHERE      01980037
019900*                |ON THE RTV TABLES.                              01990037
020000*________________|________________________________________________02000037
020100*DFCT-RET-DTE    |EDIT FOR VALID DATE OR MOVE DEFAULT 0001-01-01. 02010037
020200*________________|________________________________________________02020037
020300*RTL-COST-AMT    | EDIT FOR NUMERIC & CANNOT BE ZERO OR BYPASS    02030037
020400*                | THE ENTIRE LISTING.                            02040037
020500*________________|________________________________________________02050037
020600*UNIT-COST-AMT   | EDIT FOR NUMERIC, IF NOT MOVE ZERO.            02060037
020700*________________|________________________________________________02070037
020800*MKOUT-ORD-ID    |SHOULD BE ZEROES FROM GENCO. THIS IS CALCULATED 02080037
020900*                |IN THE PROGRAM AND ONLY NEEDED FOR 'M' RETURNS. 02090037
021000*________________|________________________________________________02100037
021100*DEPT-NBR        | CANNOT BE BLANK FOR REGULAR OR DUMMY SKUS -    02110037
021200*                | MUST BE VALIDATED BY BLACK BOX ROUTINE OR      02120037
021300*                | IN THE CASE OF DUMMY'S - BUMPED AGAINST        02130037
021400*                | XLT_SUB_CL.                                    02140037
021500*________________|________________________________________________02150037
021600*SUB-CLASS-NBR   | CANNOT BE BLANK FOR REGULAR OR DUMMY SKUS -    02160037
021700*                | MUST BE VALIDATED BY BLACK BOX ROUTINE OR      02170037
021800*                | IN THE CASE OF DUMMY'S - BUMPED AGAINST        02180037
021900*                | XLT_SUB_CL.                                    02190037
022000*________________|________________________________________________02200037
022100*LOC-NBR         |NO EDIT CAN BE NULL. GENCO SEND THE LOC-NBR IN  02210037
022200*                |THE FIRST 4 BYTES OF A 5CHAR FIELD - THE LAST   02220037
022300*                |BYTE IS A SPACE - THIS IS DUE TO THE WAY WE SEND02230037
022400*                |IT TO THEM.                                     02240037
022500******************************************************************02250037
022600******************************************************************02260037
022700 ENVIRONMENT DIVISION.                                            02270037
022800******************************************************************02280037
022900                                                                  02290037
023000 CONFIGURATION SECTION.                                           02300037
023100                                                                  02310037
023200 SOURCE-COMPUTER.        IBM-3090.                                02320037
023300 OBJECT-COMPUTER.        IBM-3090.                                02330037
023400                                                                  02340037
023500 INPUT-OUTPUT SECTION.                                            02350037
023600                                                                  02360037
023700 FILE-CONTROL.                                                    02370037
023800                                                                  02380037
023900     SELECT RTV-HEADER-FILE                                       02390037
024000         ASSIGN TO INP01.                                         02400037
024100                                                                  02410037
024200     SELECT RTV-DETAIL-FILE                                       02420037
024300         ASSIGN TO INP02.                                         02430037
024400                                                                  02440037
024500******************************************************************02450037
024600 DATA DIVISION.                                                   02460037
024700******************************************************************02470037
024800                                                                  02480037
024900 FILE SECTION.                                                    02490037
025000                                                                  02500037
025100 FD  RTV-HEADER-FILE                                              02510037
025200     RECORDING MODE IS F                                          02520037
025300     LABEL RECORDS ARE STANDARD                                   02530037
025400     BLOCK CONTAINS 0 RECORDS.                                    02540037
025500                                                                  02550037
025600 01  RTV-HEADER-RECORD               PIC X(550).                  02560037
025700                                                                  02570037
025800 FD  RTV-DETAIL-FILE                                              02580037
025900     RECORDING MODE IS F                                          02590037
026000     LABEL RECORDS ARE STANDARD                                   02600037
026100     BLOCK CONTAINS 0 RECORDS.                                    02610037
026200                                                                  02620037
026300 01  RTV-DETAIL-RECORD               PIC X(200).                  02630037
026400******************************************************************02640037
026500 WORKING-STORAGE SECTION.                                         02650037
026600******************************************************************02660037
026700                                                                  02670037
026800******************************************************************02680037
026900*  COMMUNICATIONS AREA FOR DB2                                    02690037
027000******************************************************************02700037
027100     EXEC SQL                                                     02710037
027200          INCLUDE SQLCA                                           02720037
027300     END-EXEC.                                                    02730037
027400                                                                  02740037
027500******************************************************************02750037
027600*  DB2 TABLE DECLARATION - CHECKPOINT RESTART INFO TBL(TCKRSTINF) 02760037
027700*  THIS TABLE IS USED TO STORE WORKING STORAGE INFORMATION FOR    02770037
027800*  CHECKPOINT RESTARTS.                                           02780037
027900******************************************************************02790037
028000     EXEC SQL                                                     02800037
028100         INCLUDE TCKRSTIN                                         02810037
028200     END-EXEC.                                                    02820037
028300                                                                  02830037
028400******************************************************************02840037
028500*  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)02850037
028600*  THIS TABLE IS USED FOR CHECKPOINT RESTARTS.                    02860037
028700******************************************************************02870037
028800     EXEC SQL                                                     02880037
028900         INCLUDE TCKRSTCN                                         02890037
029000     END-EXEC.                                                    02900037
029100                                                                  02910037
029200******************************************************************02920037
029300*  DB2 TABLE DECLARATION - ENTITY NAME.                           02930037
029400*      (TENTNME)                                                  02940037
029500******************************************************************02950037
029600     EXEC SQL                                                     02960037
029700          INCLUDE TENTNME                                         02970037
029800     END-EXEC.                                                    02980037
029900                                                                  02990037
030000******************************************************************03000037
030100*  DB2 TABLE DECLARATION - EXTERNAL ENTERPRISE                    03010037
030200*      (TEXTENT)                                                  03020037
030300******************************************************************03030037
030400     EXEC SQL                                                     03040037
030500          INCLUDE TEXTENT                                         03050037
030600     END-EXEC.                                                    03060037
030700                                                                  03070037
030800******************************************************************03080037
030900*  DB2 TABLE DECLARATION - RTV DEFECT ORDER.                      03090037
031000*      (TDFCTOR)                                                  03100037
031100******************************************************************03110037
031200     EXEC SQL                                                     03120037
031300          INCLUDE TDFCTOR                                         03130037
031400     END-EXEC.                                                    03140037
031500                                                                  03150037
031600******************************************************************03160037
031700*  DB2 TABLE DECLARATION -  RTV DEFECT MERCHANDISE ITEM.          03170037
031800*      (TDFMEIT)                                                  03180037
031900******************************************************************03190037
032000     EXEC SQL                                                     03200037
032100          INCLUDE TDFMEIT                                         03210037
032200     END-EXEC.                                                    03220037
032300                                                                  03230037
032400******************************************************************03240037
032500*  DB2 TABLE DECLARATION -  RTV DEFECT ORDER CONTROL.             03250037
032600*      (TDFORCR)                                                  03260037
032700******************************************************************03270037
032800     EXEC SQL                                                     03280037
032900          INCLUDE TDFORCR                                         03290037
033000     END-EXEC.                                                    03300037
033100                                                                  03310037
033200******************************************************************03320037
033300*  DB2 TABLE DECLARATION -  RETURN TO VENDOR - DEFECTIVE SHIPMENT 03330037
033400*      (RVT_DFCT_SHIPT)                                           03340037
033500******************************************************************03350037
033600     EXEC SQL                                                     03360037
033700          INCLUDE RVT00000                                        03370037
033800     END-EXEC.                                                    03380037
033900                                                                  03390037
034000******************************************************************03400037
034100*  DB2 TABLE DECLARATION -  RETURN TO VENDOR - SHIPMENT STATUS    03410037
034200*      (RVT_SHIPT_STAT)                                           03420037
034300******************************************************************03430037
034400     EXEC SQL                                                     03440037
034500          INCLUDE RVT00001                                        03450037
034600     END-EXEC.                                                    03460037
034700                                                                  03470037
034800******************************************************************03480037
034900*  DB2 TABLE DECLARATION -  RTV DEFECT ORDER STATUS.              03490037
035000*      (RVT_DFCT_STAT)                                            03500037
035100******************************************************************03510037
035200     EXEC SQL                                                     03520037
035300          INCLUDE RVT00003                                        03530037
035400     END-EXEC.                                                    03540037
035500                                                                  03550037
035600******************************************************************03560037
035700*  DB2 TABLE DECLARATION -  RTVW 3RD PARTY ERROR.                 03570037
035800*      (RVTW_DFCTOR_ERR)                                          03580037
035900******************************************************************03590037
036000     EXEC SQL                                                     03600037
036100          INCLUDE RVT00006                                        03610037
036200     END-EXEC.                                                    03620037
036300                                                                  03630037
036400******************************************************************03640037
036500*  DB2 TABLE DECLARATION -  RTV DEFECT ORDER ITEM STATUS.         03650037
036600*      (RVT_DFCT_ITM_STAT)                                        03660037
036700******************************************************************03670037
036800     EXEC SQL                                                     03680037
036900          INCLUDE RVT00002                                        03690037
037000     END-EXEC.                                                    03700037
037100                                                                  03710037
037200******************************************************************03720037
037300*  DB2 TABLE DECLARATION - LOGISTICS - SKU.                       03730037
037400*      (XLT_SKU)                                                  03740037
037500******************************************************************03750037
037600     EXEC SQL                                                     03760037
037700          INCLUDE XLT00003                                        03770037
037800     END-EXEC.                                                    03780037
037900                                                                  03790037
038000******************************************************************03800037
038100*  DB2 TABLE DECLARATION - LOGISTICS - VENDOR SUB CLASS.          03810037
038200*      (XLT_SUB_CL).                                              03820037
038300******************************************************************03830037
038400     EXEC SQL                                                     03840037
038500          INCLUDE XLT00023                                        03850037
038600     END-EXEC.                                                    03860037
038700                                                                  03870037
038800******************************************************************03880037
038900*  DB2 TABLE DECLARATION - LOGISTICS - UPC.                       03890037
039000*      (XLT_UPC).                                                 03900037
039100******************************************************************03910037
039200     EXEC SQL                                                     03920037
039300          INCLUDE XLT00006                                        03930037
039400     END-EXEC.                                                    03940037
039500                                                                  03950037
039600**  JH  10/30/2011  BEG                                           03960037
039700******************************************************************03970037
039800*  DB2 TABLE DECLARATION - LOGISTICS - DC LOCATION.               03980037
039900*      (XLT_LOC).                                                 03990037
040000******************************************************************04000037
040100     EXEC SQL                                                     04010037
040200          INCLUDE XLT00010                                        04020037
040300     END-EXEC.                                                    04030037
040400**  JH  10/30/2011  END                                           04040037
040500                                                                  04050037
040600******************************************************************04060037
040700*  DB2 TABLE DECLARATION - LOGISTICS - DC LOCATION ASSIGNMENT.    04070037
040800*      (XLT_DC_LOC_ASGMT).                                        04080037
040900******************************************************************04090037
041000     EXEC SQL                                                     04100037
041100          INCLUDE XLT00014                                        04110037
041200     END-EXEC.                                                    04120037
041300                                                                  04130037
041400******************************************************************04140037
041500* INPUT LAYOUT - RV050-GENCO-RTV-HEADER-RECORD.                   04150037
041600******************************************************************04160037
041700     COPY RVRD050.                                                04170037
041800                                                                  04180037
041900******************************************************************04190037
042000* INPUT LAYOUT - RV050-GENCO-RTV-DETAIL-RECORD.                   04200037
042100******************************************************************04210037
042200     COPY RVRD051.                                                04220037
042300                                                                  04230037
042400******************************************************************04240037
042500* ERROR TABLE LAYOUT FOR HDRS - RV018-HDR-ERROR-RECORD.           04250037
042600******************************************************************04260037
042700     COPY RVWS018.                                                04270037
042800                                                                  04280037
042900******************************************************************04290037
043000* ERROR TABLE LAYOUT FOR DTLS - RV019-DTL-ERROR-RECORD.           04300037
043100******************************************************************04310037
043200     COPY RVWS019.                                                04320037
043300                                                                  04330037
043400******************************************************************04340037
043500* ERROR TABLE LAYOUT FOR DTL SUMMARY - RV020-DTL-SUMMARY-RECORD.  04350037
043600******************************************************************04360037
043700     COPY RVWS020.                                                04370037
043800                                                                  04380037
043900******************************************************************04390037
044000*  DB2 FORMATTED MESSAGE AREA                                     04400037
044100******************************************************************04410037
044200     COPY DPWS004.                                                04420037
044300                                                                  04430037
044400******************************************************************04440037
044500*  RANDOM NUMBER AREA.                                            04450037
044600******************************************************************04460037
044700     COPY DPWS902.                                                04470037
044800                                                                  04480037
044900******************************************************************04490037
045000*  WORK AREA FOR THE KOHLS CALENDAR ROUTINE                       04500037
045100******************************************************************04510037
045200     COPY DPWS500.                                                04520037
045300                                                                  04530037
045400******************************************************************04540037
045500*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               04550037
045600******************************************************************04560037
045700     COPY XLWS001.                                                04570037
045800                                                                  04580037
045900 01  ABEND-CODE                      PIC S9(04)    VALUE +0       04590037
046000                                                   COMP SYNC.     04600037
046100                                                                  04610037
046200 01  CC-CONTROL-CARD.                                             04620037
046300     05  CC-JOB-NAME                 PIC  X(06).                  04630037
046400     05  CC-FILLER                   PIC  X(74).                  04640037
046500                                                                  04650037
046600 01  PA-PROGRAM-ACCUMULATORS.                                     04660037
046700     05  PA-TOTALS.                                               04670037
046800         10 PA-TOT-RECS-READ          PIC S9(09) VALUE +0 COMP-3. 04680037
046900         10 PA-TOT-HDR-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 04690037
047000         10 PA-TOT-DTL-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 04700037
047100         10 PA-TOT-HDR-INS            PIC S9(09) VALUE +0 COMP-3. 04710037
047200         10 PA-TOT-DTL-INS            PIC S9(09) VALUE +0 COMP-3. 04720037
047300         10 PA-TOT-SHIPT-INS          PIC S9(09) VALUE +0 COMP-3. 04730037
047400         10 PA-TOT-HDRSTAT-INS        PIC S9(09) VALUE +0 COMP-3. 04740037
047500         10 PA-TOT-DTLSTAT-INS        PIC S9(09) VALUE +0 COMP-3. 04750037
047600         10 PA-TOT-SHIPTSTAT-INS      PIC S9(09) VALUE +0 COMP-3. 04760037
047700         10 PA-TOT-MKOUT-ORD-ID-UPD   PIC S9(09) VALUE +0 COMP-3. 04770037
047800         10 PA-TOT-COMMITS-TAKEN      PIC S9(09) VALUE +0 COMP-3. 04780037
047900         10 PA-DTLS-IN-INT-TBL        PIC S9(09) VALUE +0 COMP-3. 04790037
048000         10 PA-TOT-ERR-TBL-INS        PIC S9(09) VALUE +0 COMP-3. 04800037
048100         10 PA-TOT-HDRS-BYPASSED      PIC S9(09) VALUE +0 COMP-3. 04810037
048200         10 PA-TOT-DTLS-BYPASSED      PIC S9(09) VALUE +0 COMP-3. 04820037
048300         10 PA-TOT-CALLBACKS          PIC S9(09) VALUE +0 COMP-3. 04830037
048400         10 PA-TOT-RTV-COUNT-RCVD  PIC S9(09)    VALUE +0 COMP-3. 04840037
048500         10 PA-TOT-RTV-COUNT-ERR   PIC S9(09)    VALUE +0 COMP-3. 04850037
048600         10 PA-TOT-RTV-COUNT-GOOD  PIC S9(09)    VALUE +0 COMP-3. 04860037
048700         10 PA-TOT-UNK-COUNT-UNK   PIC S9(09)    VALUE +0 COMP-3. 04870037
048800         10 PA-TOT-UNK-COUNT-GOOD  PIC S9(09)    VALUE +0 COMP-3. 04880037
048900         10 PA-TOT-MOS-COUNT-RCVD  PIC S9(09)    VALUE +0 COMP-3. 04890037
049000         10 PA-TOT-MOS-COUNT-ERR   PIC S9(09)    VALUE +0 COMP-3. 04900037
049100         10 PA-TOT-MOS-COUNT-GOOD  PIC S9(09)    VALUE +0 COMP-3. 04910037
049200         10 PA-TOT-DD-COUNT-RCVD   PIC S9(09)    VALUE +0 COMP-3. 04920037
049300         10 PA-TOT-DD-COUNT-ERR    PIC S9(09)    VALUE +0 COMP-3. 04930037
049400         10 PA-TOT-DD-COUNT-GOOD   PIC S9(09)    VALUE +0 COMP-3. 04940037
049500         10 PA-TOT-RTV-RTL-RCVD    PIC S9(09)V99 VALUE +0 COMP-3. 04950037
049600         10 PA-TOT-RTV-RTL-ERR     PIC S9(09)V99 VALUE +0 COMP-3. 04960037
049700         10 PA-TOT-RTV-RTL-GOOD    PIC S9(09)V99 VALUE +0 COMP-3. 04970037
049800         10 PA-TOT-UNK-RTL-UNK     PIC S9(09)V99 VALUE +0 COMP-3. 04980037
049900         10 PA-TOT-UNK-RTL-GOOD    PIC S9(09)V99 VALUE +0 COMP-3. 04990037
050000         10 PA-TOT-MOS-RTL-RCVD    PIC S9(09)V99 VALUE +0 COMP-3. 05000037
050100         10 PA-TOT-MOS-RTL-ERR     PIC S9(09)V99 VALUE +0 COMP-3. 05010037
050200         10 PA-TOT-MOS-RTL-GOOD    PIC S9(09)V99 VALUE +0 COMP-3. 05020037
050300         10 PA-TOT-DD-RTL-RCVD     PIC S9(09)V99 VALUE +0 COMP-3. 05030037
050400         10 PA-TOT-DD-RTL-ERR      PIC S9(09)V99 VALUE +0 COMP-3. 05040037
050500         10 PA-TOT-DD-RTL-GOOD     PIC S9(09)V99 VALUE +0 COMP-3. 05050037
050600         10 PA-TOT-RTV-UNT-RCVD    PIC S9(09)V99 VALUE +0 COMP-3. 05060037
050700         10 PA-TOT-RTV-UNT-ERR     PIC S9(09)V99 VALUE +0 COMP-3. 05070037
050800         10 PA-TOT-RTV-UNT-GOOD    PIC S9(09)V99 VALUE +0 COMP-3. 05080037
050900         10 PA-TOT-UNK-UNT-UNK     PIC S9(09)V99 VALUE +0 COMP-3. 05090037
051000         10 PA-TOT-UNK-UNT-GOOD    PIC S9(09)V99 VALUE +0 COMP-3. 05100037
051100         10 PA-TOT-MOS-UNT-RCVD    PIC S9(09)V99 VALUE +0 COMP-3. 05110037
051200         10 PA-TOT-MOS-UNT-ERR     PIC S9(09)V99 VALUE +0 COMP-3. 05120037
051300         10 PA-TOT-MOS-UNT-GOOD    PIC S9(09)V99 VALUE +0 COMP-3. 05130037
051400         10 PA-TOT-DD-UNT-RCVD     PIC S9(09)V99 VALUE +0 COMP-3. 05140037
051500         10 PA-TOT-DD-UNT-ERR      PIC S9(09)V99 VALUE +0 COMP-3. 05150037
051600         10 PA-TOT-DD-UNT-GOOD     PIC S9(09)V99 VALUE +0 COMP-3. 05160037
051700         10 PA-TOT-DD-COUNT-APPLID  PIC S9(09)   VALUE +0 COMP-3. 05170037
051800         10 PA-TOT-RTV-COUNT-APPLID PIC S9(09)   VALUE +0 COMP-3. 05180037
051900         10 PA-TOT-MOS-COUNT-APPLID PIC S9(09)   VALUE +0 COMP-3. 05190037
052000*        10 PA-TOT-UNK-COUNT-APPLID PIC S9(09)V99 VALUE +0 COMP-3.05200037
052100*                                                                 05210037
052200         10 PA-TOT-DD-RTL-APPLID   PIC S9(09)V99 VALUE +0 COMP-3. 05220037
052300         10 PA-TOT-RTV-RTL-APPLID  PIC S9(09)V99 VALUE +0 COMP-3. 05230037
052400         10 PA-TOT-MOS-RTL-APPLID  PIC S9(09)V99 VALUE +0 COMP-3. 05240037
052500*        10 PA-TOT-UNK-RTL-APPLID  PIC S9(09)V99 VALUE +0 COMP-3. 05250037
052600*                                                                 05260037
052700         10 PA-TOT-DD-UNT-APPLID   PIC S9(09)V99 VALUE +0 COMP-3. 05270037
052800         10 PA-TOT-RTV-UNT-APPLID  PIC S9(09)V99 VALUE +0 COMP-3. 05280037
052900         10 PA-TOT-MOS-UNT-APPLID  PIC S9(09)V99 VALUE +0 COMP-3. 05290037
053000*        10 PA-TOT-UNK-UNT-APPLID  PIC S9(09)V99 VALUE +0 COMP-3. 05300037
053100                                                                  05310037
053200                                                                  05320037
053300 01  PS-PROGRAM-SWITCHES.                                         05330037
053400     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   05340037
053500         88  PS-NORMAL-RUN                           VALUE '0'.   05350037
053600         88  PS-RESTART-RUN                          VALUE '9'.   05360037
053700     05  PS-END-OF-HDR-INPUT-SW        PIC  X(01)    VALUE 'N'.   05370037
053800         88  PS-END-OF-HDR-INPUT-YES                 VALUE 'Y'.   05380037
053900         88  PS-END-OF-HDR-INPUT-NO                  VALUE 'N'.   05390037
054000     05  PS-END-OF-DTL-INPUT-SW        PIC  X(01)    VALUE 'N'.   05400037
054100         88  PS-END-OF-DTL-INPUT-YES                 VALUE 'Y'.   05410037
054200         88  PS-END-OF-DTL-INPUT-NO                  VALUE 'N'.   05420037
054300     05  PS-CONTINUE-THIS-REC-SW       PIC  X(01)    VALUE 'N'.   05430037
054400         88  PS-CONTINUE-THIS-REC-YES                VALUE 'Y'.   05440037
054500         88  PS-CONTINUE-THIS-REC-NO                 VALUE 'N'.   05450037
054600     05  PS-DATE-IS-VALID-SW           PIC  X(01)    VALUE 'N'.   05460037
054700         88  PS-DATE-IS-VALID-YES                    VALUE 'Y'.   05470037
054800         88  PS-DATE-IS-VALID-NO                     VALUE 'N'.   05480037
054900     05  PS-HDR-EXISTS-SW              PIC  X(01)    VALUE 'N'.   05490037
055000         88  PS-HDR-EXISTS-YES                       VALUE 'Y'.   05500037
055100         88  PS-HDR-EXISTS-NO                        VALUE 'N'.   05510037
055200     05  PS-BYPASS-HDR-SW              PIC  X(01)    VALUE 'Y'.   05520037
055300         88  PS-BYPASS-HDR-YES                       VALUE 'Y'.   05530037
055400         88  PS-BYPASS-HDR-NO                        VALUE 'N'.   05540037
055500     05  PS-INSERT-RVT-DFCT-SHIPT-SW   PIC  X(01)    VALUE 'N'.   05550037
055600         88  PS-INSERT-RVT-DFCT-SHIPT-YES            VALUE 'Y'.   05560037
055700         88  PS-INSERT-RVT-DFCT-SHIPT-NO             VALUE 'N'.   05570037
055800     05  PS-UNIT-OF-WORK-COMPLETE-SW   PIC  X(01)    VALUE 'N'.   05580037
055900         88  PS-UNIT-OF-WORK-COMPLETE-YES            VALUE 'Y'.   05590037
056000         88  PS-UNIT-OF-WORK-COMPLETE-NO             VALUE 'N'.   05600037
056100     05  PS-DUNS-VALID-SW              PIC  X(01)    VALUE 'N'.   05610037
056200         88  PS-DUNS-VALID-YES                       VALUE 'Y'.   05620037
056300         88  PS-DUNS-VALID-NO                        VALUE 'N'.   05630037
056400     05  PS-SCAC-VALID-SW              PIC  X(01)    VALUE 'N'.   05640037
056500         88  PS-SCAC-VALID-YES                       VALUE 'Y'.   05650037
056600         88  PS-SCAC-VALID-NO                        VALUE 'N'.   05660037
056700     05  PS-OPER-UNT-ID-VALID-SW       PIC  X(01)    VALUE 'N'.   05670037
056800         88  PS-OPER-UNT-ID-VALID-YES                VALUE 'Y'.   05680037
056900         88  PS-OPER-UNT-ID-VALID-NO                 VALUE 'N'.   05690037
057000     05  PS-CALC-NEW-MKOUT-ORD-ID-SW   PIC  X(01)    VALUE 'N'.   05700037
057100         88  PS-CALC-NEW-MKOUT-ORD-ID-YES            VALUE 'Y'.   05710037
057200         88  PS-CALC-NEW-MKOUT-ORD-ID-NO             VALUE 'N'.   05720037
057300     05  PS-A-MOS-IN-COMMIT-CYCLE-SW   PIC  X(01)    VALUE 'N'.   05730037
057400         88  PS-A-MOS-IN-COMMIT-CYCLE-YES            VALUE 'Y'.   05740037
057500         88  PS-A-MOS-IN-COMMIT-CYCLE-NO             VALUE 'N'.   05750037
057600     05  PS-RETURN-TYPE-SW             PIC  X(01)    VALUE ' '.   05760037
057700         88  PS-RETURN-TYPE-RETURN                   VALUE 'R'.   05770037
057800         88  PS-RETURN-TYPE-DEBIT-DISPOSE            VALUE 'D'.   05780037
057900         88  PS-RETURN-TYPE-MARK-OUT                 VALUE 'M'.   05790037
058000     05  PS-DEPT-CLS-VALID-SW          PIC  X(01)    VALUE 'N'.   05800037
058100         88  PS-DEPT-CLS-VALID-YES                   VALUE 'Y'.   05810037
058200         88  PS-DEPT-CLS-VALID-NO                    VALUE 'N'.   05820037
058300     05  PS-HDR-CRITICAL-ERR-SW        PIC  X(01)    VALUE 'N'.   05830037
058400         88  PS-HDR-CRITICAL-ERR-YES                 VALUE 'Y'.   05840037
058500         88  PS-HDR-CRITICAL-ERR-NO                  VALUE 'N'.   05850037
058600     05  PS-DTL-CRITICAL-ERR-SW        PIC  X(01)    VALUE 'N'.   05860037
058700         88  PS-DTL-CRITICAL-ERR-YES                 VALUE 'Y'.   05870037
058800         88  PS-DTL-CRITICAL-ERR-NO                  VALUE 'N'.   05880037
058900     05  PS-TDFMEIT-INSERT-SW          PIC  X(01)    VALUE 'N'.   05890037
059000         88  PS-TDFMEIT-INSERT-YES                   VALUE 'Y'.   05900037
059100         88  PS-TDFMEIT-INSERT-NO                    VALUE 'N'.   05910037
059200                                                                  05920037
059300 01  PS-ERROR-SWITCHES.                                           05930037
059400     05  PS-ERROR-TEXT                 PIC  X(35)    VALUE SPACE. 05940037
059500         88  PS-HDR-IS-CALLBACK-TYPE                 VALUE        05950037
059600             'C-HDR IS A CALLBACK - NOT PROCESSED'.               05960037
059700         88  PS-HDR-ALREADY-EXISTS                   VALUE        05970037
059800             'C-HDR DFCT ORD ID ALREADY EXISTS   '.               05980037
059900         88  PS-HDR-REC-MISSING-FOR-DTL              VALUE        05990037
060000             'C-HDR REC MISSING FOR DETL REC     '.               06000037
060100         88  PS-DTL-REC-MISSING-FOR-HDR              VALUE        06010037
060200             'C-DTL REC MISSING FOR HDR REC      '.               06020037
060300         88  PS-HDR-DFCT-ORD-ID-ZERO                 VALUE        06030037
060400             'C-HDR DFCT ORD IS ZERO             '.               06040037
060500         88  PS-HDR-DFCT-ORD-ID-NON-NUM              VALUE        06050037
060600             'C-HDR DFCT ORD IS NOT NUMERIC      '.               06060037
060700         88  PS-VENDOR-DUNS-NBR-INVALID              VALUE        06070037
060800             'C-INVALID VENDOR DUNS NBR          '.               06080037
060900         88  PS-VENDOR-DUNS-NBR-BLANK                VALUE        06090037
061000             'C-BLANK VENDOR DUNS NBR            '.               06100037
061100         88  PS-VENDOR-NAME-BLANK                    VALUE        06110037
061200             'W-BLANK VENDOR NAME                '.               06120037
061300         88  PS-RETURN-TYPE-UNK                      VALUE        06130037
061400             'C-UNKNOWN RETURN TYPE              '.               06140037
061500         88  PS-OPER-UNT-ID-ZERO                     VALUE        06150037
061600             'C-OPER. UNT ID IS ZERO             '.               06160037
061700         88  PS-STATUS-CHG-DTE-INVALID               VALUE        06170037
061800             'C-INVALID STATUS CHANGE DATE       '.               06180037
061900         88  PS-DFCT-ORD-STAT-CDE-UNK                VALUE        06190037
062000             'C-UNKNOWN DFCT ORDER STAT CDE      '.               06200037
062100         88  PS-ORD-DTE-INVALID                      VALUE        06210037
062200             'C-INVALID ORDER DTE                '.               06220037
062300         88  PS-DFCT-SHIPT-ID-ZERO                   VALUE        06230037
062400             'W-DFCT SHIP IS ZERO                '.               06240037
062500         88  PS-SHIPT-DTE-INVALID                    VALUE        06250037
062600             'C-INVALID SHIP DTE                 '.               06260037
062700         88  PS-CART-QTY-NON-NUM                     VALUE        06270037
062800             'W-CARTON QTY NOT NUMERIC           '.               06280037
062900         88  PS-VND-AUTH-DTE-INVALID                 VALUE        06290037
063000             'W-INVALID VEND AUTH.DTE            '.               06300037
063100         88  PS-MISSING-VND-AUTH-NBR                 VALUE        06310037
063200             'C-MISSING DFCT VENDOR AUTH. NUMBER '.               06320037
063300         88  PS-INBD-RET-FRGT-SIGN-UNK               VALUE        06330037
063400             'W-UNKNOWN INBND FRGT SIGN          '.               06340037
063500         88  PS-INBD-RET-FRGT-AMT-NON-NUM            VALUE        06350037
063600             'W-INBND FRGT AMT NOT NUMERIC       '.               06360037
063700         88  PS-OTBND-RET-FRGT-SIGN-UNK              VALUE        06370037
063800             'W-UNKNOWN OUTBND FRGT SIGN         '.               06380037
063900         88  PS-OTBND-RET-FRGT-AMT-NON-NUM           VALUE        06390037
064000             'W-OUTBND FRGT AMT NOT NUMERIC      '.               06400037
064100         88  PS-DED-CHRG-SIGN-UNK                    VALUE        06410037
064200             'W-UNKNOWN DED. CHRG SIGN           '.               06420037
064300         88  PS-DED-CHRG-AMT-NON-NUM                 VALUE        06430037
064400             'W-DED. CHRG AMT NOT NUMERIC        '.               06440037
064500         88  PS-DISC-PCT-SIGN-UNK                    VALUE        06450037
064600             'W-UNKNOWN DISC. PCT SIGN           '.               06460037
064700         88  PS-DISC-PCT-NON-NUM                     VALUE        06470037
064800             'W-DISC PCT NOT NUMERIC             '.               06480037
064900         88  PS-DISC-AMT-SIGN-UNK                    VALUE        06490037
065000             'W-UNKNOWN DISC. AMT SIGN           '.               06500037
065100         88  PS-DISC-AMT-NON-NUM                     VALUE        06510037
065200             'W-DISC. AMT NOT NUMERIC            '.               06520037
065300         88  PS-WEIGHT-NON-NUM                       VALUE        06530037
065400             'W-WEIGHT NOT NUMERIC               '.               06540037
065500         88  PS-RET-RSN-CDE-UNK                      VALUE        06550037
065600             'W-UNKNOWN RETURN REASON CDE        '.               06560037
065700*060607  88  PS-PAYT-TYP-INV-NON-DESTROY             VALUE        06570037
065800*060607      'W-PAYT INVALID: RTV, MOS OR DAMAGED'.               06580037
065900*060607  88  PS-PAYT-TYP-INV-DESTROY                 VALUE        06590037
066000*060607      'W-PAYT INVALID: DESTROYED          '.               06600037
066100*060607  88  PS-PAYT-TYP-CDE-UNK                     VALUE        06610037
066200*060607      'W-UNKNOWN PAYMENT TYPE CDE         '.               06620037
066300         88  PS-CARR-TRKG-ID-BLANK                   VALUE        06630037
066400             'C-PRO NBR IS BLANK IN CARR-TRKG-ID '.               06640037
066500         88  PS-SCAC-INVALID                         VALUE        06650037
066600             'C-INVALID SCAC                     '.               06660037
066700         88  PS-DTL-DFCT-ORD-ID-ZERO                 VALUE        06670037
066800             'C-DTL DFCT ORDER ID IS ZERO        '.               06680037
066900         88  PS-DTL-DFCT-ORD-ID-NON-NUM              VALUE        06690037
067000             'C-DTL DFCT ORD IS NOT NUMERIC      '.               06700037
067100         88  PS-SEQ-NBR-ZERO                         VALUE        06710037
067200             'C-SEQUENCE NBR IS ZERO             '.               06720037
067300         88  PS-SEQ-NBR-NOT-NUM                      VALUE        06730037
067400             'C-SEQUENCE NBR IS NOT NUMERIC      '.               06740037
067500         88  PS-SKU-BLANK                            VALUE        06750037
067600             'C-BLANK SKU                        '.               06760037
067700         88  PS-DFCT-RET-DTE-INVALID                 VALUE        06770037
067800             'C-INVALID DEFECT RETURN DATE       '.               06780037
067900         88  PS-RTL-COST-AMT-ZERO                    VALUE        06790037
068000             'C-RETAIL COST AMT IS ZERO          '.               06800037
068100         88  PS-RTL-COST-AMT-NON-NUM                 VALUE        06810037
068200             'C-RETAIL COST AMT NOT NUMERIC      '.               06820037
068300         88  PS-UNIT-COST-AMT-NOT-NUM                VALUE        06830037
068400             'W-UNIT COST AMT NOT NUMERIC        '.               06840037
068500         88  PS-MKOUT-ORD-ID-NOT-ZERO                VALUE        06850037
068600             'W-MOS ORDER ID NOT ZERO            '.               06860037
068700         88  PS-MKOUT-ORD-STAT-CDE-MISSING           VALUE        06870037
068800             'W-MISSING MOS STATUS CDE           '.               06880037
068900         88  PS-DEPT-NBR-BLANK                       VALUE        06890037
069000             'C-BLANK DEPT NBR                   '.               06900037
069100         88  PS-INVALID-INPUT-DEPT                   VALUE        06910037
069200             'C-INVALID DEPT NBR                 '.               06920037
069300         88  PS-SUB-CLASS-NBR-BLANK                  VALUE        06930037
069400             'C-BLANK SUB CLASS NBR              '.               06940037
069500         88  PS-INVALID-INPUT-SUB-CLASS              VALUE        06950037
069600             'C-INVALID SUB CLASS NBR            '.               06960037
069700         88  PS-LOC-NBR-NON-NUM                      VALUE        06970037
069800             'W-LOC. NBR NOT NUMERIC             '.               06980037
069900         88  PS-SKU-CANNOT-BE-VALIDATED              VALUE        06990037
070000             'C-INVALID SKU                      '.               07000037
070100         88  PS-INVALID-DEPT-SUBCLASS                VALUE        07010037
070200             'C-INVALID DEPT/CLASS               '.               07020037
070300**  JH  10/30/2011 BEG                                            07030037
070400         88  PS-INVALID-LOCATION-FOUND               VALUE        07040037
070500             'INVALID LOCATION FOUND             '.               07050037
070600**  JH  10/30/2011 END                                            07060037
070700                                                                  07070037
070800 01  PV-DTL-TABLE.                                                07080037
070900     05  PV-DTL-TABLE-ENTRIES OCCURS  250000 TIMES                07090037
071000                              INDEXED BY DTL-INDEX.               07100037
071100         10 PV-TBL-DTL-ROW.                                       07110037
071200            15 TBL-DFCT-ORD-ID            PIC  S9(12)V COMP-3.    07120045
071300            15 TBL-SEQ-NBR                PIC  S9(5)V COMP-3.     07130037
071400            15 TBL-DFCT-ITEM-NBR          PIC  S9(15)V COMP-3.    07140037
071500            15 TBL-DFCT-RET-DTE           PIC   X(10).            07150037
071600            15 TBL-RTL-COST-AMT           PIC  S9(5)V9(2) COMP-3. 07160037
071700            15 TBL-UNIT-COST-AMT          PIC  S9(5)V9(2) COMP-3. 07170037
071800            15 TBL-MKOUT-ORD-ID           PIC  S9(11)V COMP-3.    07180037
071900            15 TBL-MKOUT-ORD-STAT-CDE     PIC   X(1).             07190037
072000            15 TBL-MDSE-DEPT-NBR          PIC   X(3).             07200037
072100            15 TBL-MDSE-CLASS-NBR         PIC   X(2).             07210037
072200            15 TBL-LOC-NBR                PIC  S9(4) COMP.        07220037
072300            15 TBL-DTL-RETURN-TYPE        PIC   X(1).             07230037
072400                                                                  07240037
072500 01  PC-PROGRAM-CONSTANTS.                                        07250037
072600     05  PC-MAX-RETRIES              PIC S9(03) VALUE +5 COMP-3.  07260037
072700     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'RVKUP002'. 07270037
072800     05  PC-RANDOM-NBR-GENERATOR    PIC X(08) VALUE 'DPKUT902'.   07280037
072900     05  PC-VNDR-NAME-NOT-FOUND      PIC X(25)  VALUE             07290037
073000                               'NO VNDR NAME FOUND       '.       07300037
073100     05  PC-DEFAULT-TIME-2400        PIC X(16)  VALUE             07310037
073200                                           '-24.00.00.000000'.    07320037
073300     05  PC-DEFAULT-DATE             PIC X(10)  VALUE             07330037
073400                                           '0001-01-01'.          07340037
073500     05  PC-RUN-IN-PROGRESS-CODE     PIC X(01)  VALUE '9'.        07350037
073600     05  PC-RUN-COMPLETE-CODE        PIC X(01)  VALUE '0'.        07360037
073700     05  PC-DEFAULT-USR-ID           PIC X(10) VALUE 'RLOG      '.07370037
073800     05  PC-DUMMY-SKU-IND            PIC X(03) VALUE '000'.       07380037
073900     05  PC-NEG                      PIC X(01) VALUE '-'.         07390037
074000     05  PC-OPER-UNT-ID              PIC 9(04) VALUE 810.         07400037
074100     05  PC-1                        PIC X(01)  VALUE '1'.        07410037
074200     05  PC-2                        PIC X(01)  VALUE '2'.        07420037
074300     05  PC-3                        PIC X(01)  VALUE '3'.        07430037
074400     05  PC-4                        PIC X(01)  VALUE '4'.        07440037
074500     05  PC-5                        PIC X(01)  VALUE '5'.        07450037
074600     05  PC-6                        PIC X(01)  VALUE '6'.        07460037
074700     05  PC-7                        PIC X(01)  VALUE '7'.        07470037
074800     05  PC-8                        PIC X(01)  VALUE '8'.        07480037
074900     05  PC-D                        PIC X(01)  VALUE 'D'.        07490037
075000     05  PC-P                        PIC X(01)  VALUE 'P'.        07500037
075100     05  PC-C                        PIC X(01)  VALUE 'C'.        07510037
075200     05  PC-9                        PIC X(01)  VALUE '9'.        07520037
075300     05  PC-R                        PIC X(01)  VALUE 'R'.        07530037
075400     05  PC-S                        PIC X(01)  VALUE 'S'.        07540037
075500     05  PC-T                        PIC X(01)  VALUE 'T'.        07550037
075600     05  PC-01                       PIC X(02)  VALUE '01'.       07560037
075700     05  PC-M                        PIC X(01)  VALUE 'M'.        07570037
075800     05  PC-Y                        PIC X(01)  VALUE 'Y'.        07580037
075900     05  PC-SPACE                    PIC X(01)  VALUE ' '.        07590037
076000     05  PC-DASH                     PIC X(01)  VALUE '-'.        07600037
076100     05  PC-MOS-DTL-LIMIT            PIC 9(02)  VALUE 60.         07610037
076200     05  PC-EMAIL-ADDR-LENGTH        PIC S9(4) COMP VALUE +100.   07620037
076300     05  PC-INVALID-DATE-RTN-MSG     PIC X(19)  VALUE             07630037
076400                                     'INVALID INPUT DATE '.       07640037
076500                                                                  07650037
076600 01  NI-NULL-INDICATORS.                                          07660037
076700       05  NI-DFCT-SHIPT-ID           PIC S9(04) COMP VALUE +0.   07670037
076800       05  NI-VND-AUTH-DTE            PIC S9(04) COMP VALUE +0.   07680037
076900                                                                  07690037
077000 01  PV-PROGRAM-VARIABLES.                                        07700037
077100       05  PV-CKPT-STAT-CODE             PIC X(01)  VALUE SPACE.  07710037
077200       05  PV-TMST                       PIC X(26)  VALUE SPACE.  07720037
077300       05  PV-HOLD-TMST                  PIC X(26)  VALUE SPACE.  07730037
077400       05  PV-HOLD-RETURN-TYPE           PIC X(01)  VALUE SPACE.  07740037
077500       05  PV-LAST-HDR-RETURN-TYPE       PIC X(01)  VALUE SPACE.  07750037
077600       05  PV-HOLD-DTL-DFCT-ORD-ID       PIC X(12)  VALUE SPACE.  07760045
077700       05  PV-HOLD-CURRENT-DEPT          PIC X(03)  VALUE SPACE.  07770037
077800       05  PV-HOLD-DFORCR-DFCT-ORD-ID PIC S9(12)V COMP-3 VALUE +0.07780045
077900       05  PV-MOS-LINE-COUNT             PIC 9(02)  VALUE ZERO.   07790037
078000       05  PV-HOLD-LAST-MOS-DFCT-ORD-ID  PIC 9(12)  VALUE ZERO.   07800045
078100       05  PV-HOLD-HDR-ORD-ID-TALLY      PIC 9(06)  VALUE ZERO.   07810037
078200       05  PV-HOLD-DTL-ORD-ID-TALLY      PIC 9(06)  VALUE ZERO.   07820037
078300       05  PV-DTL-INSERT-INDEX           PIC 9(05)  VALUE ZERO.   07830037
078400       05  PV-DFCT-SHIPT-ID              PIC 9(10)  VALUE ZERO.   07840037
078500       05  PV-NBR-DTLS-TO-PASS           PIC 9(10)  VALUE ZERO.   07850037
078600       05  PV-CKPT-FRQNCY-QTY            PIC S9(05) VALUE +0 COMP.07860037
078700       05  PV-RETRY-COUNTER              PIC S9(04) VALUE +0 COMP 07870037
078800                                                             SYNC.07880037
078900       05  PV-REC-SEQ-NBR                PIC S9(09) VALUE +0 COMP.07890037
079000       05  PV-DISPLAY-RECORD             PIC ZZ,ZZZ,ZZ9-.         07900037
079100       05  PV-ERROR-MSG-TEXT             PIC X(50)  VALUE SPACE.  07910037
079200       05  PV-FIRST-MKOUT-ORD-ID         PIC  S9(11)V COMP-3.     07920037
079300       05  PV-CURRENT-MKOUT-ORD-ID       PIC  S9(11)V COMP-3.     07930037
079400       05  PV-RANDOM-NBR                 PIC S9(09) VALUE +0 COMP.07940037
079500       05  PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.  07950037
079600       05  PV-ABEND-MESSAGE              PIC  X(30) VALUE SPACE.  07960037
079700       05  PV-SQLCODE                    PIC  S9(9) VALUE ZEROES. 07970037
079800       05  PV-DB2-VIEW-NAME              PIC X(10) VALUE SPACES.  07980037
079900       05  PV-CCYYMMDD-CHECK             PIC X(10) VALUE SPACE.   07990037
080000       05  PV-SKU-REDEFINE.                                       08000037
080100           10 PV-INPUT-SKU-DEPT          PIC X(03) VALUE SPACE.   08010037
080200           10 PV-INPUT-SKU-CLASS         PIC X(02) VALUE SPACE.   08020037
080300           10 PV-INPUT-SKU-SEQ           PIC X(03) VALUE SPACE.   08030037
080400           10 PV-INPUT-SKU-FILLER        PIC X(02) VALUE SPACE.   08040037
080500       05  PV-SUBCLASS-REDEFINE.                                  08050037
080600           10 PV-INPUT-SUBCLASS-PADDING  PIC X(02) VALUE SPACE.   08060037
080700           10 PV-INPUT-SUBCLASS          PIC X(02) VALUE SPACE.   08070037
080800           10 PV-INPUT-SUBCLASS-FILLER   PIC X(06) VALUE SPACE.   08080037
080900       05  PV-DEPT-REDEFINE.                                      08090037
081000           10 PV-INPUT-DEPT-PADDING      PIC X(01) VALUE SPACE.   08100037
081100           10 PV-INPUT-DEPT              PIC X(03) VALUE SPACE.   08110037
081200           10 PV-INPUT-DEPT-FILLER       PIC X(06) VALUE SPACE.   08120037
081300       05  PV-INPUT-DEPT-9               PIC 9(03) VALUE ZERO.    08130037
081400       05  PV-INPUT-SUBCLASS-9           PIC 9(02) VALUE ZERO.    08140037
081500       05  PV-INPUT-DEPT-COMP3        PIC S9(04) COMP-3 VALUE +0. 08150037
081600       05  PV-INPUT-SUBCLASS-COMP3    PIC S9(04) COMP-3 VALUE +0. 08160037
081700**  JH  10/30/2011 BEG                                            08170037
081800       05  PV-LOC-NBR                 PIC  S9(04) VALUE +0 COMP.  08180037
081900       05  PV-LOC-NAME                PIC  X(10)  VALUE SPACES.   08190037
082000**  JH  10/30/2011 END                                            08200037
082100                                                                  08210039
082200**  RPK 12/16/2022  BEG                                           08220039
082300       05  PV-RTL-CHNG-COUNT             PIC 9(7)      VALUE ZERO.08230043
082400       05  PV-RTL-CHNG-COUNT-DISP        PIC Z,ZZZ,ZZ9 VALUE ZERO.08240043
082500       05  PV-RTL-CHNG-AMT               PIC 9(7)V99   VALUE ZERO.08250040
082600       05  PV-DOLLAR-DISP                PIC ZZ,ZZZ.99 VALUE ZERO.08260040
082700       05  PV-DOLLAR-DISP2               PIC ZZ,ZZZ.99 VALUE ZERO.08270041
082800**  RPK 12/16/2022  END                                           08280039
082900                                                                  08290037
083000 01  PV-ABEND-VARIABLES.                                          08300037
083100     05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.08310037
083200                                                                  08320037
083300 01  CKPT-RESTART-INFO.                                           08330037
083400     05 CR-TOT-RECS-READ               PIC  S9(09)  VALUE +0.     08340037
083500     05 CR-TOT-HDR-RECS-READ           PIC  S9(09)  VALUE +0.     08350037
083600     05 CR-TOT-HDR-INS                 PIC  S9(09)  VALUE +0.     08360037
083700     05 CR-TOT-HDRSTAT-INS             PIC  S9(09)  VALUE +0.     08370037
083800     05 CR-TOT-DTL-RECS-READ           PIC  S9(09)  VALUE +0.     08380037
083900     05 CR-TOT-DTL-INS                 PIC  S9(09)  VALUE +0.     08390037
084000     05 CR-TOT-DTLSTAT-INS             PIC  S9(09)  VALUE +0.     08400037
084100     05 CR-TOT-SHIPT-INS               PIC  S9(09)  VALUE +0.     08410037
084200     05 CR-TOT-SHIPTSTAT-INS           PIC  S9(09)  VALUE +0.     08420037
084300     05 CR-TOT-MKOUT-ORD-ID-UPD        PIC  S9(09)  VALUE +0.     08430037
084400     05 CR-TOT-HDRS-BYPASSED           PIC  S9(09)  VALUE +0.     08440037
084500     05 CR-TOT-DTLS-BYPASSED           PIC  S9(09)  VALUE +0.     08450037
084600     05 CR-TOT-CALLBACKS               PIC  S9(09)  VALUE +0.     08460037
084700     05 CR-CURRENT-MKOUT-ORD-ID        PIC  S9(09)  VALUE +0.     08470037
084800     05 CR-TOT-COMMITS-TAKEN           PIC  S9(09)  VALUE +0.     08480037
084900     05 CR-TOT-RTV-COUNT-RCVD          PIC  S9(09)  VALUE +0.     08490037
085000     05 CR-TOT-MOS-COUNT-RCVD          PIC  S9(09)  VALUE +0.     08500037
085100     05 CR-TOT-DD-COUNT-RCVD           PIC  S9(09)  VALUE +0.     08510037
085200     05 CR-TOT-RTV-RTL-RCVD            PIC  S9(09)V99 VALUE +0.   08520037
085300     05 CR-TOT-MOS-RTL-RCVD            PIC  S9(09)V99 VALUE +0.   08530037
085400     05 CR-TOT-DD-RTL-RCVD             PIC  S9(09)V99 VALUE +0.   08540037
085500     05 CR-TOT-RTV-UNT-RCVD            PIC  S9(09)V99 VALUE +0.   08550037
085600     05 CR-TOT-MOS-UNT-RCVD            PIC  S9(09)V99 VALUE +0.   08560037
085700     05 CR-TOT-DD-UNT-RCVD             PIC  S9(09)V99 VALUE +0.   08570037
085800     05 CR-TOT-RTV-COUNT-ERR           PIC  S9(09)  VALUE +0.     08580037
085900     05 CR-TOT-MOS-COUNT-ERR           PIC  S9(09)  VALUE +0.     08590037
086000     05 CR-TOT-DD-COUNT-ERR            PIC  S9(09)  VALUE +0.     08600037
086100     05 CR-TOT-RTV-RTL-ERR             PIC  S9(09)V99 VALUE +0.   08610037
086200     05 CR-TOT-MOS-RTL-ERR             PIC  S9(09)V99 VALUE +0.   08620037
086300     05 CR-TOT-DD-RTL-ERR              PIC  S9(09)V99 VALUE +0.   08630037
086400     05 CR-TOT-RTV-UNT-ERR             PIC  S9(09)V99 VALUE +0.   08640037
086500     05 CR-TOT-MOS-UNT-ERR             PIC  S9(09)V99 VALUE +0.   08650037
086600     05 CR-TOT-DD-UNT-ERR              PIC  S9(09)V99 VALUE +0.   08660037
086700     05 CR-TOT-UNK-COUNT-UNK           PIC  S9(09)  VALUE +0.     08670037
086800     05 CR-TOT-UNK-RTL-UNK             PIC  S9(09)V99 VALUE +0.   08680037
086900     05 CR-TOT-UNK-UNT-UNK             PIC  S9(09)V99 VALUE +0.   08690037
087000     05 CR-TOT-RTV-COUNT-GOOD          PIC  S9(09)  VALUE +0.     08700037
087100     05 CR-TOT-MOS-COUNT-GOOD          PIC  S9(09)  VALUE +0.     08710037
087200     05 CR-TOT-DD-COUNT-GOOD           PIC  S9(09)  VALUE +0.     08720037
087300     05 CR-TOT-RTV-RTL-GOOD            PIC  S9(09)V99 VALUE +0.   08730037
087400     05 CR-TOT-MOS-RTL-GOOD            PIC  S9(09)V99 VALUE +0.   08740037
087500     05 CR-TOT-DD-RTL-GOOD             PIC  S9(09)V99 VALUE +0.   08750037
087600     05 CR-TOT-RTV-UNT-GOOD            PIC  S9(09)V99 VALUE +0.   08760037
087700     05 CR-TOT-MOS-UNT-GOOD            PIC  S9(09)V99 VALUE +0.   08770037
087800     05 CR-TOT-DD-UNT-GOOD             PIC  S9(09)V99 VALUE +0.   08780037
087900     05 CR-TOT-UNK-COUNT-GOOD          PIC  S9(09)  VALUE +0.     08790037
088000     05 CR-TOT-UNK-RTL-GOOD            PIC  S9(09)V99 VALUE +0.   08800037
088100     05 CR-TOT-UNK-UNT-GOOD            PIC  S9(09)V99 VALUE +0.   08810037
088200     05 CR-TOT-RTV-COUNT-APPLID        PIC  S9(09)  VALUE +0.     08820037
088300     05 CR-TOT-RTV-RTL-APPLID          PIC  S9(09)V99 VALUE +0.   08830037
088400     05 CR-TOT-RTV-UNT-APPLID          PIC  S9(09)V99 VALUE +0.   08840037
088500     05 CR-TOT-MOS-COUNT-APPLID        PIC  S9(09)  VALUE +0.     08850037
088600     05 CR-TOT-MOS-RTL-APPLID          PIC  S9(09)V99 VALUE +0.   08860037
088700     05 CR-TOT-MOS-UNT-APPLID          PIC  S9(09)V99 VALUE +0.   08870037
088800     05 CR-TOT-DD-COUNT-APPLID         PIC  S9(09)  VALUE +0.     08880037
088900     05 CR-TOT-DD-RTL-APPLID           PIC  S9(09)V99 VALUE +0.   08890037
089000     05 CR-TOT-DD-UNT-APPLID           PIC  S9(09)V99 VALUE +0.   08900037
089100                                                                  08910037
089200******************************************************************08920037
089300 LINKAGE SECTION.                                                 08930037
089400******************************************************************08940037
089500                                                                  08950037
089600******************************************************************08960037
089700 PROCEDURE DIVISION.                                              08970037
089800******************************************************************08980037
089900******************************************************************08990037
090000*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *09000037
090100******************************************************************09010037
090200 0000-PROGRAM-MAINLINE.                                           09020037
090300                                                                  09030037
090400     DISPLAY '************ START OF RVKUP002 ***************'     09040037
090500     PERFORM 1000-INITIALIZE.                                     09050037
090600                                                                  09060037
090700*USE THIS SWITCH TO DETERMINE IF A UNIT OF WORK IS COMPLETE.      09070037
090800*A UNIT OF WORK IS COMPLETE WHEN ALL THE DETAILS, DTL STATUS,     09080037
090900*SHIPT, SHIPT STATUS, HEADER & HEADER STATUS RECORDS HAVE BEEN    09090037
091000*INSERTED FOR A PARTICULAR HDR DFCT-ORD-ID.                       09100037
091100     SET PS-UNIT-OF-WORK-COMPLETE-NO  TO TRUE.                    09110037
091200                                                                  09120037
091300     IF PS-END-OF-HDR-INPUT-NO  OR PS-END-OF-DTL-INPUT-NO         09130037
091400*MAKE SURE THERE IS A HDR REC AND AT LEAST ONE DTL FOR AN ORDER ID09140037
091500        IF RV050-DFCT-ORD-ID NOT EQUAL RV051-DFCT-ORD-ID          09150037
091600        AND (PS-END-OF-HDR-INPUT-NO OR PS-END-OF-DTL-INPUT-NO)    09160037
091700        AND PS-HDR-EXISTS-NO                                      09170037
091800           PERFORM 2100-CHECK-ORD-IDS                             09180037
091900             UNTIL RV050-DFCT-ORD-ID = RV051-DFCT-ORD-ID          09190037
092000                OR (PS-END-OF-HDR-INPUT-YES  AND                  09200037
092100                    PS-END-OF-DTL-INPUT-YES)                      09210037
092200        END-IF                                                    09220037
092300        PERFORM 1100-CONTINUE-PROCESSING                          09230037
092400     ELSE                                                         09240037
092500        IF PS-HDR-EXISTS-YES AND PA-TOT-RECS-READ > 0             09250037
092600           DISPLAY ' '                                            09260037
092700           DISPLAY '****** ALL HDR RECS EXIST ON TDFCTOR ********'09270037
092800           DISPLAY ' '                                            09280037
092900           PERFORM 7004-ZERO-OUT-SUM-TOTS                         09290037
093000           PERFORM 7005-INSERT-DTL-SUM-TO-ERR-TBL                 09300037
093100        ELSE                                                      09310037
093200           IF PS-END-OF-HDR-INPUT-YES AND PS-END-OF-DTL-INPUT-YES 09320037
093300              DISPLAY ' '                                         09330037
093400              DISPLAY '***** NO RECORDS ON EITHER INPUT FILE ****'09340037
093500              DISPLAY ' '                                         09350037
093600              PERFORM 7004-ZERO-OUT-SUM-TOTS                      09360037
093700              PERFORM 7005-INSERT-DTL-SUM-TO-ERR-TBL              09370037
093800           END-IF                                                 09380037
093900        END-IF                                                    09390037
094000        MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE            09400037
094100        PERFORM 6570-UPDATE-TCKRSTCNTL                            09410037
094200        CLOSE RTV-HEADER-FILE                                     09420037
094300              RTV-DETAIL-FILE                                     09430037
094400     END-IF.                                                      09440037
094500                                                                  09450039
094600**  RPK 12/16/2022  BEG                                           09460039
094700     MOVE PV-RTL-CHNG-AMT TO PV-DOLLAR-DISP.                      09470040
094800     DISPLAY ' '.                                                 09480039
094900     DISPLAY 'INCREASE IN RETAIL VALUE DUE TO ZERO RETAIL: '      09490040
095000             PV-DOLLAR-DISP.                                      09500040
095100     MOVE PV-RTL-CHNG-COUNT TO PV-RTL-CHNG-COUNT-DISP.            09510040
095200     DISPLAY 'NUMBER OF DETAIL ENTRIES CHANGED TO ONE PENNY '     09520040
095300             'DUE TO ZERO RETAIL: '                               09530040
095400             PV-RTL-CHNG-COUNT-DISP.                              09540040
095500     DISPLAY ' '.                                                 09550039
095600**  RPK 12/16/2022  END                                           09560039
095700                                                                  09570037
095800     DISPLAY '************  END OF RVKUP002  ***************'     09580037
095900**  JH  10/30/2011  BEG                                           09590037
096000     GOBACK.                                                      09600037
096100**  JH  10/30/2011  END                                           09610037
096200                                                                  09620037
096300******************************************************************09630037
096400* INITIALIZE VARIABLES.                                           09640037
096500* OPEN INPUT FILES.                                               09650037
096600* IF RUN TYPE IS NORMAL, UPDATE THE CKRSTCNTL TABLE STATUS CODE   09660037
096700* TO '9' WHICH MEANS RUN-IN-PROGRESS.                             09670037
096800* DO A PRIME READ FOR THE HDR & DTL FILES                         09680037
096900* SET THE FIRST COMMIT TIMESTAMP MARKER                           09690037
097000******************************************************************09700037
097100 1000-INITIALIZE.                                                 09710037
097200                                                                  09720037
097300     INITIALIZE   PA-PROGRAM-ACCUMULATORS                         09730037
097400                  CKPT-RESTART-INFO                               09740037
097500                  PV-PROGRAM-VARIABLES                            09750037
097600                  DCLTDFCTOR                                      09760037
097700                  DCLTDFMEIT                                      09770037
097800                  DCLTDFORCR                                      09780037
097900                  DCLRVT00002                                     09790037
098000                  DCLRVT00003                                     09800037
098100                  DCLXLT00003                                     09810037
098200                  DCLXLT00023                                     09820037
098300                  DCLXLT00006                                     09830037
098400                  DCLXLT00010                                     09840037
098500                  DCLXLT00014                                     09850037
098600                  DCLTCKRSTCNTL                                   09860037
098700                  DCLTCKRSTINF.                                   09870037
098800                                                                  09880037
098900     OPEN INPUT  RTV-HEADER-FILE                                  09890037
099000                 RTV-DETAIL-FILE.                                 09900037
099100                                                                  09910037
099200     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           09920037
099300                                                                  09930037
099400     PERFORM 6500-GET-CHECKPOINT-CNTL.                            09940037
099500     MOVE PV-CKPT-STAT-CODE  TO  PS-RUN-TYPE-SW.                  09950037
099600                                                                  09960037
099700     IF PS-RESTART-RUN                                            09970037
099800         PERFORM 6550-CHECKPOINT-RESTART                          09980037
099900     ELSE                                                         09990037
100000         MOVE PC-RUN-IN-PROGRESS-CODE    TO PV-CKPT-STAT-CODE     10000037
100100         PERFORM 6570-UPDATE-TCKRSTCNTL                           10010037
100200         PERFORM 2600-INITIALIZE-TCKRSTINF                        10020037
100300         PERFORM 6590-UPDATE-TCKRSTINF                            10030037
100400         PERFORM 6600-COMMIT                                      10040037
100500     END-IF.                                                      10050037
100600                                                                  10060037
100700**PRIME READ OF HDR FILE                                          10070037
100800     PERFORM 6000-READ-RTV-HDR-FILE.                              10080037
100900                                                                  10090037
101000**  CMS 10/30/2011  BEG                                           10100037
101100***  VALIDATE LOCATION ONLY WHEN THERE IS A VALID HEADER RECORD.  10110037
101200     IF PS-END-OF-HDR-INPUT-NO                                    10120037
101300         PERFORM 2210-VALIDATE-LOCATION                           10130037
101400     END-IF.                                                      10140037
101500**  CMS 10/30/2011  END                                           10150037
101600                                                                  10160037
101700     PERFORM 6100-CHECK-HDR-DFCT-ORD-ID.                          10170037
101800                                                                  10180037
101900**PRIME READ OF DTL FILE                                          10190037
102000     PERFORM 6001-READ-RTV-DTL-FILE.                              10200037
102100                                                                  10210037
102200**TALLY THE DTL RETURN-TYPES , COST AND RETAIL FIELDS             10220037
102300*    IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID                 10230037
102400*     AND PS-END-OF-DTL-INPUT-NO                                  10240037
102500*       PERFORM 6005-TALLY-AND-SUM                                10250037
102600*    END-IF.                                                      10260037
102700                                                                  10270037
102800**CHECK ORD ID'S FOR NUMERICS AND SYNCHRONICITY                   10280037
102900     PERFORM 2100-CHECK-ORD-IDS.                                  10290037
103000                                                                  10300037
103100**HDR DFCT-ORD-ID CHECK TO SEE IF IT ALREADY EXISTS               10310037
103200**    ANY EXISTING HDRS WILL BE WRITTEN TO ERROR TABLES           10320037
103300**    BYPASS ALL CORRESPONDING DTL RECS                           10330037
103400     SET PS-HDR-EXISTS-YES TO TRUE                                10340037
103500     PERFORM                                                      10350037
103600       UNTIL PS-HDR-EXISTS-NO OR PS-END-OF-HDR-INPUT-YES          10360037
103700             PERFORM 6100-CHECK-HDR-DFCT-ORD-ID                   10370037
103800             IF PS-HDR-EXISTS-YES                                 10380037
103900                SET PS-HDR-ALREADY-EXISTS                         10390037
104000                    RV018-CRITICAL     TO TRUE                    10400037
104100                PERFORM 7000-INSERT-HDR-TO-ERR-TBL                10410037
104200                SET PS-CONTINUE-THIS-REC-NO TO TRUE               10420037
104300                ADD +1 TO PA-TOT-HDRS-BYPASSED                    10430037
104400                IF RV050-DFCT-ORD-ID = RV051-DFCT-ORD-ID          10440037
104500                   PERFORM                                        10450037
104600                     UNTIL (RV050-DFCT-ORD-ID NOT EQUAL           10460037
104700                                            RV051-DFCT-ORD-ID)    10470037
104800                                            OR                    10480037
104900                            PS-END-OF-DTL-INPUT-YES               10490037
105000                           ADD +1 TO PA-TOT-DTLS-BYPASSED         10500037
105100                           PERFORM 7015-SUM-ERROR-VALUES          10510037
105200                           PERFORM 6001-READ-RTV-DTL-FILE         10520037
105300*                          IF RV050-DFCT-ORD-ID EQUAL             10530037
105400*                                             RV051-DFCT-ORD-ID   10540037
105500*                            AND PS-END-OF-DTL-INPUT-NO           10550037
105600*                             PERFORM 6005-TALLY-AND-SUM          10560037
105700*                          END-IF                                 10570037
105800                   END-PERFORM                                    10580037
105900                   IF PS-END-OF-HDR-INPUT-NO                      10590037
106000                      PERFORM 6000-READ-RTV-HDR-FILE              10600037
106100                      PERFORM 6100-CHECK-HDR-DFCT-ORD-ID          10610037
106200*                     IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID10620037
106300*                      AND PS-END-OF-DTL-INPUT-NO                 10630037
106400*                        PERFORM 6005-TALLY-AND-SUM               10640037
106500*                     END-IF                                      10650037
106600                   END-IF                                         10660037
106700                END-IF                                            10670037
106800             END-IF                                               10680037
106900     END-PERFORM.                                                 10690037
107000                                                                  10700037
107100**GET THE CURRENT MKOUT-ORD-ID IN CASE MOS RECORDS ARE SENT       10710037
107200**THIS IS INCREMENTED INTERNALLY AND THE LAST MKOUT-ORD-ID        10720037
107300**WILL BE UPDATED IN TDFORCR AT THE END OF PROCESSING             10730037
107400     PERFORM 7050-GET-MKOUT-ORD-ID.                               10740037
107500     MOVE DFORCR-MKOUT-ORD-ID                                     10750037
107600         TO PV-CURRENT-MKOUT-ORD-ID                               10760037
107700              CR-CURRENT-MKOUT-ORD-ID                             10770037
107800              PV-FIRST-MKOUT-ORD-ID.                              10780037
107900                                                                  10790037
108000*SET THE FIRST COMMIT TIMESTAMP MARKER                            10800037
108100     PERFORM 2800-SET-COMMIT-TIMESTAMP.                           10810037
108200                                                                  10820037
108300******************************************************************10830037
108400* PERFORM MAIN LOOP UNTIL EOF                                     10840037
108500* EOJ TASKS                                                       10850037
108600******************************************************************10860037
108700 1100-CONTINUE-PROCESSING.                                        10870037
108800                                                                  10880037
108900*PROCESS INPUT FILES TO EOF                                       10890037
109000     PERFORM 2000-PROCESS-RETURNS                                 10900037
109100       UNTIL PS-END-OF-HDR-INPUT-YES AND PS-END-OF-DTL-INPUT-YES. 10910037
109200                                                                  10920037
109300*END OF INPUT PROCESSING.                                         10930037
109400     PERFORM 8000-EOJ-ROUTINE.                                    10940037
109500                                                                  10950037
109600******************************************************************10960037
109700** 1) THERE MUST BE AT LEAST ONE DETAIL FOR EACH HEADER RECORD.   10970037
109800** 2) EDIT HDR RECORD FOR VALID NUMERICS AND DATES                10980037
109900** 3) EDIT DTL RECORD FOR VALID NUMERICS AND DATES                10990037
110000** 4) INSERT THE HDR REC TO TDFCTOR                               11000037
110100** 5) INSERT THE CORRESPONDING HDR STATUS ROW TO RVT_DFCT_STAT    11010037
110200** 6) IF MOS (MARK OUT OF STOCK) RETURN, CALC NEW MKOUT_ORD_ID    11020037
110300*     FOR THE DETAIL RECS BY:                                     11030037
110400** 7) SELECTING THE ONLY ROW FROM TDFORCR, ADDING +1 TO THE       11040037
110500*     MKOUT_ORD_ID, THEN EVENTUALLY UPDATING THE SAME ROW         11050037
110600****> NOTE: THE MKOUT-ORD-ID CAN BE USED FOR 60 ITEMS, BEYOND     11060037
110700*     THAT, ANOTHER MKOUT-ORD-ID MUST BE CREATED FOR EACH         11070037
110800*     SUBSEQUENT 60 ITEMS WITH THE SAME DCFT-ORD-ID. THE          11080037
110900*     CALCULATION OF THE MKOUT-ORD-ID IS KEPT INTERNALLY IN THE   11090037
111000*     PROGRAM AND THAT SINGLE ROW IS UPDATED IN TDFCORCR WITH THE 11100037
111100*     LAST USED MKOUT-ORD-ID RIGHT BEFORE THE COMMIT.             11110037
111200** 8) INSERT THE DTL RECS TO TDFMEIT                              11120037
111300** 9) INSERT THE CORRESPONDING DTL STAT ROWS TO RVT_DFCT_ITM_STAT 11130037
111400**10) CHECK FOR COMMIT                                            11140037
111500****> NOTE: A UNIT OF WORK IS THE COMPLETE LOADING OF THE HDR     11150037
111600*     AND ALL ASSOCIATED DTL RECS FOR A DFCT-ORD-ID AND           11160037
111700*     10 SECONDS ELASPING.                                        11170037
111800**11) READ ANOTHER HDR RECORD                                     11180037
111900******************************************************************11190037
112000 2000-PROCESS-RETURNS.                                            11200037
112100                                                                  11210037
112200*USE THIS SWITCH TO CALC A NEW MKOUT-ORD-ID FOR 'M' RETURN-TYPES. 11220037
112300*THIS IS DONE FOR THE FIRST MOS REC HDR ENCOUNTERED AND THEN AGAIN11230037
112400*AFTER EACH COMMIT INTERVAL. THE PV-CURRENT-MKOUT-ORD-ID IS       11240037
112500*MAINTAINED INTERNALLY ACROSS N NBR OF HDRS/DTLS BECAUSE IT IS    11250037
112600*UPDATED IN TDFORCR RIGHT BEFORE THE COMMIT.                      11260037
112700     SET PS-CALC-NEW-MKOUT-ORD-ID-YES TO TRUE.                    11270037
112800                                                                  11280037
112900*USE THIS SWITCH TO BYPASS PROCESS STEPS IF A REC FAILS THE EDIT. 11290037
113000     SET PS-CONTINUE-THIS-REC-YES TO TRUE.                        11300037
113100                                                                  11310037
113200*EDIT THE HEADER RECORD                                           11320037
113300     PERFORM 2200-EDIT-HDR-REC                                    11330037
113400                                                                  11340037
113500*EDIT ALL THE DTLS FOR A DFCT-ORD-ID HDR & LOAD TO INTERNAL TABLE 11350037
113600*OR IF THERE IS A BAD HDR, EDIT DTLS & WRITE ERRS IF NECESSARY    11360037
113700     IF PS-CONTINUE-THIS-REC-YES                                  11370037
113800        SET DTL-INDEX TO +1                                       11380037
113900        MOVE +1 TO  PV-MOS-LINE-COUNT                             11390037
114000                    PA-DTLS-IN-INT-TBL                            11400037
114100        PERFORM 7008-INITIALIZE-GOOD-VALUES                       11410037
114200        PERFORM                                                   11420037
114300          UNTIL (RV050-DFCT-ORD-ID NOT EQUAL                      11430037
114400                RV051-DFCT-ORD-ID) OR PS-END-OF-DTL-INPUT-YES     11440037
114500                PERFORM 2300-EDIT-DTL-REC                         11450037
114600**THIS IS TO LOAD DETAILS INTO INT TABLE FOR INSERTS              11460037
114700                IF PS-CONTINUE-THIS-REC-YES                       11470037
114800                   PERFORM 7010-SUM-GOOD-VALUES                   11480037
114900                   PERFORM 6001-READ-RTV-DTL-FILE                 11490037
115000*                  IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID   11500037
115100*                   AND PS-END-OF-DTL-INPUT-NO                    11510037
115200*                     PERFORM 6005-TALLY-AND-SUM                  11520037
115300*                  END-IF                                         11530037
115400                   IF (RV050-DFCT-ORD-ID EQUAL                    11540037
115500                       RV051-DFCT-ORD-ID)                         11550037
115600*ONLY INCREMENT IF THE CSR IS NOT SITTING ON THE NEXT DFCT-ORD-ID 11560037
115700                    AND RV050-DFCT-ORD-ID EQUAL                   11570037
115800                           TBL-DFCT-ORD-ID (DTL-INDEX)            11580037
115900                    AND PS-END-OF-DTL-INPUT-NO                    11590037
116000                        SET DTL-INDEX UP BY +1                    11600037
116100                        ADD +1 TO PA-DTLS-IN-INT-TBL              11610037
116200                   END-IF                                         11620037
116300                ELSE                                              11630037
116400                   PERFORM 7012-SUM-GOOD-TO-ERRORS                11640037
116500**THIS IS TO EDIT THE DTLS FOR A RECORD THAT IS NOT BEING LOADED  11650037
116600**TO THE DB2 TABLES - JUST TO REPORT ON THE ERRORS THAT MAY EXIST 11660037
116700                   PERFORM                                        11670037
116800                     UNTIL (RV050-DFCT-ORD-ID NOT EQUAL           11680037
116900                           RV051-DFCT-ORD-ID)                     11690037
117000                           OR  RV051-DFCT-ORD-ID NOT EQUAL        11700037
117100                                  TBL-DFCT-ORD-ID (DTL-INDEX)     11710037
117200                           OR PS-END-OF-DTL-INPUT-YES             11720037
117300                           ADD +1 TO PA-TOT-DTLS-BYPASSED         11730037
117400                           PERFORM 7015-SUM-ERROR-VALUES          11740037
117500                           PERFORM 6001-READ-RTV-DTL-FILE         11750037
117600*                          IF RV050-DFCT-ORD-ID EQUAL             11760037
117700*                                           RV051-DFCT-ORD-ID     11770037
117800*                            AND PS-END-OF-DTL-INPUT-NO           11780037
117900*                             PERFORM 6005-TALLY-AND-SUM          11790037
118000*                          END-IF                                 11800037
118100                           IF RV050-DFCT-ORD-ID EQUAL             11810037
118200                               RV051-DFCT-ORD-ID                  11820037
118300                             AND PS-END-OF-DTL-INPUT-NO           11830037
118400                              PERFORM 2300-EDIT-DTL-REC           11840037
118500                           END-IF                                 11850037
118600                   END-PERFORM                                    11860037
118700                END-IF                                            11870037
118800        END-PERFORM                                               11880037
118900     ELSE                                                         11890037
119000        PERFORM                                                   11900037
119100          UNTIL (RV050-DFCT-ORD-ID NOT EQUAL                      11910037
119200                RV051-DFCT-ORD-ID) OR PS-END-OF-DTL-INPUT-YES     11920037
119300                PERFORM 2300-EDIT-DTL-REC                         11930037
119400                PERFORM 7015-SUM-ERROR-VALUES                     11940037
119500                PERFORM 6001-READ-RTV-DTL-FILE                    11950037
119600*               IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID      11960037
119700*                AND PS-END-OF-DTL-INPUT-NO                       11970037
119800*                  PERFORM 6005-TALLY-AND-SUM                     11980037
119900*               END-IF                                            11990037
120000                ADD +1 TO PA-TOT-DTLS-BYPASSED                    12000037
120100        END-PERFORM                                               12010037
120200     END-IF.                                                      12020037
120300                                                                  12030037
120400*BEFORE THE HEADER IS INSERTED, IT IS NECESSARY TO CHECK          12040037
120500*A JOIN BETWEEN TDFCTOR & RVT_DFCT_SHIPT USING THE SCAC ON THE    12050037
120600*HDR INPUT TO KEY TO THE SCAC ON RVT_DFCT_SHIPT AND THE           12060037
120700*HDR INPUT CARR_TRKG_ID TO KEY TO THE CARR_TRKG_ID ON TDFCTOR     12070037
120800*WHERE THE DFCT_ORD_IDS ON BOTH TABLES ARE EQUAL.                 12080037
120900*IF A ROW IS FOUND, MOVE THE DFCT_SHIPT_ID FROM RVT_DFCT_SHIPT TO 12090037
121000*THE DFCT_SHIPT_ID ON THE HDR INPUT FOR THE INSERT. IF A ROW IS   12100037
121100*NOT FOUND, GENERATE A RANDOM NUMBER TO CREATE A ROW ON           12110037
121200*RVT_DFCT_SHIPT AND RVT_SHIPT_STAT AND FOR THE DFCT_SHIPT_ID      12120037
121300*FOR THE HDR INSERT.                                              12130037
121400*NOTE: EITHER WAY, THE HDR INPUT FILE DFCT-SHIPT-ID IS NOT GOING  12140037
121500*===== TO BE USED ON THE HDR INSERT, THE FIELD IS EITHER GENERATED12150037
121600*      OR IS OBTAINED FROM THE RVT_DFCT_SHIPT JOIN TO TDFCTOR     12160037
121700     IF PS-CONTINUE-THIS-REC-YES                                  12170037
121800**NO SHIPPING ROWS SHOULD BE INSERTED FOR RETURN-TYPE 'D' WHEN    12180037
121900**IT IS DEBIT & DAMAGED - NO PRO-NBR (CARR-TRKG-ID) SENT          12190037
122000**(NOTE) THE DFCT_SHIPT-ID, CARR-TRKG-ID &                        12200037
122100**TRLR-ID SHOULD BE SPACES ON THE RECORD FOR DEBIT & DAMAGED.     12210037
122200**AN ASSUMPTION IS MADE THAT GENCO HAS THAT CORRECT - IT IS NOT   12220037
122300**EDITED OR ENFORCED IN THE CODE                                  12230037
122400        IF RV050-RETURN-TYPE = PC-D                               12240037
122500          AND RV050-CARR-TRKG-ID EQUAL PC-SPACE                   12250037
122600           SET PS-INSERT-RVT-DFCT-SHIPT-NO TO TRUE                12260037
122700        ELSE                                                      12270037
122800           PERFORM 7300-CHECK-RVT-DFCT-SHIPT                      12280037
122900        END-IF                                                    12290037
123000** RETURN-TYPE 'D' - DEBIT & DISPOSE AND 'R' AND 'M' ALL          12300037
123100** GET SHIPPING ROWS ADDED TO THE TABLES IF THE CARR/SCAC         12310037
123200** COMBO DOES NOT ALREADY EXIST.                                  12320037
123300        IF PS-INSERT-RVT-DFCT-SHIPT-YES                           12330037
123400           PERFORM 7320-GENER-RANDOM-NBR                          12340037
123500           MOVE PV-RANDOM-NBR TO PV-DFCT-SHIPT-ID                 12350037
123600           PERFORM 7340-INSERT-RVT-DFCT-SHIPT                     12360037
123700           PERFORM 7360-INSERT-RVT-SHIPT-STATUS                   12370037
123800        END-IF                                                    12380037
123900     END-IF.                                                      12390037
124000                                                                  12400037
124100*INSERT THE HDR REC AND ITS CORRESPONDING STATUS ROW              12410037
124200     IF PS-CONTINUE-THIS-REC-YES                                  12420037
124300        PERFORM 7400-INSERT-TDFCTOR                               12430037
124400        PERFORM 7500-INSERT-RVT-DFCT-STAT                         12440037
124500        SET PS-UNIT-OF-WORK-COMPLETE-YES  TO TRUE                 12450037
124600     ELSE                                                         12460037
124700        ADD +1 TO PA-TOT-HDRS-BYPASSED                            12470037
124800     END-IF.                                                      12480037
124900                                                                  12490037
125000*INSERT DETAILS TO TDFMEIT & RVT_DFCT_ITM_STAT FROM INTERNAL TABLE12500037
125100*IF THE HDR RETURN-TYPE IS 'M' FOR "MOS - MARK OUT OF STOCK", THEN12510037
125200*A MKOUT-ORD-ID MUST BE CALCULATED NEW FOR EVERY 60 DTLS          12520037
125300*ASSOCIATED WITH A HDR DFCT-ORD-ID.                               12530037
125400*NOTE: GET THE CURRENT MKOUT-ORD-ID FROM TDFORCR, THEN ADD +1.    12540037
125500*      MOVE THAT VALUE TO PV-CURRENT-MKOUT-ORD-ID. IF THERE ARE   12550037
125600*      MORE THAN 60 DTLS ASSOCIATED WITH A HDR DFCT-ORD-ID,       12560037
125700*      THEN INCREMENT THE PV-CURRENT-MKOUT-ORD-ID AGAIN, AND AGAIN12570037
125800*      FOR EACH SUBSEQUENT 60 DETAILS, ETC OR FOR EVERY DEPT      12580037
125900*      CHANGE WITHIN A DFCT-ORD-ID.  THE TDFORCR                  12590037
126000*      MKOUT-ORD-ID IS UPDATED AFTER EACH UNIT OF WORK IS         12600037
126100*      COMPLETED (ALL DETAILS FOR A HDR REC AND HDR ARE INSERTED  12610037
126200*      INTO THE TABLES, THEIR RESPECTIVE STATUS TABLES AND        12620037
126300*      RVT_DFCT_SHIPT CHECK. SO THIS MUST BE CALCULATED NEW       12630037
126400*      BY SELECTING TDFORCR AFTER EACH COMMIT.                    12640037
126500     IF PS-CONTINUE-THIS-REC-YES                                  12650037
126600** RESET INT TBL INDEX                                            12660037
126700        SET DTL-INDEX TO +1                                       12670037
126800        MOVE TBL-MDSE-DEPT-NBR (DTL-INDEX)                        12680037
126900                         TO PV-HOLD-CURRENT-DEPT                  12690037
127000        PERFORM                                                   12700037
127100           PA-DTLS-IN-INT-TBL TIMES                               12710037
127200                IF RV050-RETURN-TYPE = PC-M                       12720037
127300** HOLD THE LAST MOS DFCT ORD ID TO USE FOR THE UPDATE OF TDFORCR 12730037
127400                   MOVE RV050-DFCT-ORD-ID                         12740037
127500                            TO PV-HOLD-LAST-MOS-DFCT-ORD-ID       12750037
127600                   SET PS-A-MOS-IN-COMMIT-CYCLE-YES TO TRUE       12760037
127700                   IF PS-CALC-NEW-MKOUT-ORD-ID-YES                12770037
127800                      ADD +1 TO PV-CURRENT-MKOUT-ORD-ID           12780037
127900                      MOVE PV-CURRENT-MKOUT-ORD-ID                12790037
128000                             TO CR-CURRENT-MKOUT-ORD-ID           12800037
128100                      SET PS-CALC-NEW-MKOUT-ORD-ID-NO TO TRUE     12810037
128200                   ELSE                                           12820037
128300                      IF PV-MOS-LINE-COUNT =                      12830037
128400                                     (PC-MOS-DTL-LIMIT + 1)       12840037
128500                       OR TBL-MDSE-DEPT-NBR (DTL-INDEX)           12850037
128600                                  NOT EQUAL PV-HOLD-CURRENT-DEPT  12860037
128700                         ADD +1 TO PV-CURRENT-MKOUT-ORD-ID        12870037
128800                         MOVE PV-CURRENT-MKOUT-ORD-ID             12880037
128900                                TO CR-CURRENT-MKOUT-ORD-ID        12890037
129000                         MOVE +1 TO PV-MOS-LINE-COUNT             12900037
129100                         MOVE TBL-MDSE-DEPT-NBR (DTL-INDEX)       12910037
129200                                TO PV-HOLD-CURRENT-DEPT           12920037
129300                      END-IF                                      12930037
129400                   END-IF                                         12940037
129500                END-IF                                            12950037
129600                SET PS-TDFMEIT-INSERT-NO TO TRUE                  12960037
129700                PERFORM 7100-INSERT-TDFMEIT                       12970037
129800                  IF PS-TDFMEIT-INSERT-YES                        12980037
129900                    PERFORM 7150-SUM-APPLIED-VALUES               12990037
130000                  END-IF                                          13000037
130100                PERFORM 7200-INSERT-RVT-DFCT-ITM-STAT             13010037
130200**INCREMENT INT TBL INDEX                                         13020037
130300                SET DTL-INDEX UP BY +1                            13030037
130400**INCREMENT MOS DTL COUNTER                                       13040037
130500                IF RV050-RETURN-TYPE = PC-M                       13050037
130600                   ADD +1 TO PV-MOS-LINE-COUNT                    13060037
130700                END-IF                                            13070037
130800        END-PERFORM                                               13080037
130900     END-IF.                                                      13090037
131000                                                                  13100037
131100*CHECKPOINT RESTART TEST                                          13110037
131200*SET THE DFCT_ORD_ID, RUN SLOWLY FROM FILE MANAGER E.T.DT,        13120037
131300*SET A BREAKPOINT ON THIS IF STATEMENT AND F12 UNTIL              13130037
131400*RV050-DFCT-ORD-ID IS JUST THE LAST ID BEFORE THE ONE YOU         13140037
131500*SET IN THE PARAGRAPH BELOW, WAIT TEN SECONDS, THEN F12 AGAIN,    13150037
131600*LET THE PROGRAM ABEND, THEN JUST RUN FROM JCL - TO FINISH        13160037
131700*    IF PS-NORMAL-RUN                                             13170037
131800*     AND RV050-DFCT-ORD-ID = 800203                              13180037
131900*         PERFORM 9200-NON-SQL-ABEND                              13190037
132000*    END-IF.                                                      13200037
132100*CHECKPOINT RESTART TEST                                          13210037
132200                                                                  13220037
132300*CHECK FOR CHECKPOINTING.                                         13230037
132400     PERFORM 2700-CHECKPOINT-CHECK.                               13240037
132500     IF PS-CONTINUE-THIS-REC-YES AND PV-TMST > PV-HOLD-TMST       13250037
132600        IF PS-A-MOS-IN-COMMIT-CYCLE-YES                           13260037
132700           PERFORM 7600-UPDATE-TDFORCR                            13270037
132800        END-IF                                                    13280037
132900        PERFORM 2500-CHCKPT-LOGIC                                 13290037
133000     END-IF.                                                      13300037
133100                                                                  13310037
133200*READ NEXT HEADER RECORD.                                         13320037
133300     IF PS-END-OF-HDR-INPUT-NO                                    13330037
133400        PERFORM 6000-READ-RTV-HDR-FILE                            13340037
133500        PERFORM 6100-CHECK-HDR-DFCT-ORD-ID                        13350037
133600*       IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID              13360037
133700*        AND PS-END-OF-DTL-INPUT-NO                               13370037
133800*          PERFORM 6005-TALLY-AND-SUM                             13380037
133900*       END-IF                                                    13390037
134000     END-IF.                                                      13400037
134100                                                                  13410037
134200*CHECK TO BE SURE THE HDR DOES NOT EXIST ON TDFCTOR. IF IT DOES   13420037
134300*BYPASS ALL THE ASSOCIATED DETAILS IF THEY WERE SENT AND CONTINUE 13430037
134400*THE WHOLE BYPASS PROCESS UNTIL A HDR IS FOUND THAT DOES NOT EXIST13440037
134500                                                                  13450037
134600     SET PS-HDR-EXISTS-YES TO TRUE.                               13460037
134700     PERFORM                                                      13470037
134800       UNTIL PS-HDR-EXISTS-NO OR PS-END-OF-HDR-INPUT-YES          13480037
134900             PERFORM 6100-CHECK-HDR-DFCT-ORD-ID                   13490037
135000             IF PS-HDR-EXISTS-YES                                 13500037
135100                SET PS-HDR-ALREADY-EXISTS                         13510037
135200                    RV018-CRITICAL     TO TRUE                    13520037
135300                PERFORM 7000-INSERT-HDR-TO-ERR-TBL                13530037
135400                ADD +1 TO PA-TOT-HDRS-BYPASSED                    13540037
135500                IF PS-END-OF-HDR-INPUT-NO                         13550037
135600                   PERFORM 6000-READ-RTV-HDR-FILE                 13560037
135700*                  IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID   13570037
135800*                   AND PS-END-OF-DTL-INPUT-NO                    13580037
135900*                     PERFORM 6005-TALLY-AND-SUM                  13590037
136000*                  END-IF                                         13600037
136100                END-IF                                            13610037
136200             END-IF                                               13620037
136300     END-PERFORM.                                                 13630037
136400                                                                  13640037
136500*BYPASS ANY DETAILS THAT CORRESPOND TO HDRS THAT ARE BYPASSED     13650037
136600     IF RV050-DFCT-ORD-ID NOT EQUAL RV051-DFCT-ORD-ID             13660037
136700      OR RV050-DFCT-ORD-ID > RV051-DFCT-ORD-ID                    13670037
136800        PERFORM                                                   13680037
136900          UNTIL (RV050-DFCT-ORD-ID =                              13690037
137000                                 RV051-DFCT-ORD-ID)               13700037
137100                                 OR                               13710037
137200                (RV051-DFCT-ORD-ID > RV050-DFCT-ORD-ID)           13720037
137300                                 OR                               13730037
137400                 PS-END-OF-DTL-INPUT-YES                          13740037
137500                PERFORM 7015-SUM-ERROR-VALUES                     13750037
137600                PERFORM 6001-READ-RTV-DTL-FILE                    13760037
137700*               IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID      13770037
137800*                AND PS-END-OF-DTL-INPUT-NO                       13780037
137900*                  PERFORM 6005-TALLY-AND-SUM                     13790037
138000*               END-IF                                            13800037
138100                ADD +1 TO PA-TOT-DTLS-BYPASSED                    13810037
138200        END-PERFORM                                               13820037
138300     END-IF.                                                      13830037
138400                                                                  13840037
138500*MAKE SURE THE HDR & DTL DFCT-ORD-ID'S ARE IN SYNC.               13850037
138600     PERFORM 2100-CHECK-ORD-IDS.                                  13860037
138700                                                                  13870037
138800******************************************************************13880037
138900* CHECK THE DEFECT ORDER IDS ON THE HEADER AND DETAIL FILES TO    13890037
139000* MAKE SURE THERE IS A HEADER ASSOCIATED WITH THE CORRESPONDING   13900037
139100* DETAIL RECORDS AND THAT THERE ARE NO DETAIL RECORDS THAT DO NOT 13910037
139200* HAVE A HEADER.                                                  13920037
139300* THE FILES ARE SORTED ON THE FIELDS AS FOLLOWS:                  13930037
139400* HDR: DFCT_ORD_ID                                                13940037
139500* DTL: DFCT_ORD_ID, DEPT_NBR, SUB_CLASS, SKU                      13950037
139600* ERROR RECORDS WILL BE WRITTEN TO THE ERROR WORK TABLE IN THE    13960037
139700* EVENT A HDR IS W/O A DTL OR VICE VERSA.                         13970037
139800******************************************************************13980037
139900 2100-CHECK-ORD-IDS.                                              13990037
140000                                                                  14000037
140100**** EDIT THE HDR DFCT-ORD-ID TO MAKE SURE IT IS NUMERIC          14010037
140200**** BEFORE TRYING TO MATCH IT TO THE DTL DFCT-ORD-ID             14020037
140300     IF RV050-DFCT-ORD-ID IS NUMERIC                              14030037
140400        CONTINUE                                                  14040037
140500     ELSE                                                         14050037
140600        SET PS-HDR-DFCT-ORD-ID-NON-NUM                            14060037
140700            RV018-CRITICAL       TO TRUE                          14070037
140800        PERFORM UNTIL RV050-DFCT-ORD-ID IS NUMERIC                14080037
140900                   OR PS-END-OF-HDR-INPUT-YES                     14090037
141000                ADD +1 TO PA-TOT-HDRS-BYPASSED                    14100037
141100                PERFORM 7000-INSERT-HDR-TO-ERR-TBL                14110037
141200                PERFORM 6000-READ-RTV-HDR-FILE                    14120037
141300*               IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID      14130037
141400*                AND PS-END-OF-DTL-INPUT-NO                       14140037
141500*                  PERFORM 6005-TALLY-AND-SUM                     14150037
141600*               END-IF                                            14160037
141700        END-PERFORM                                               14170037
141800     END-IF.                                                      14180037
141900                                                                  14190037
142000**** EDIT THE DTL DFCT-ORD-ID TO MAKE SURE IT IS NUMERIC          14200037
142100**** BEFORE TRYING TO MATCH IT TO THE HDR DFCT-ORD-ID             14210037
142200     IF RV051-DFCT-ORD-ID IS NUMERIC                              14220037
142300        CONTINUE                                                  14230037
142400     ELSE                                                         14240037
142500        SET PS-DTL-DFCT-ORD-ID-NON-NUM                            14250037
142600            RV019-CRITICAL       TO TRUE                          14260037
142700        PERFORM UNTIL RV051-DFCT-ORD-ID NUMERIC                   14270037
142800                   OR PS-END-OF-DTL-INPUT-YES                     14280037
142900                ADD +1 TO PA-TOT-DTLS-BYPASSED                    14290037
143000                PERFORM 7001-INSERT-DTL-TO-ERR-TBL                14300037
143100                PERFORM 7015-SUM-ERROR-VALUES                     14310037
143200                PERFORM 6001-READ-RTV-DTL-FILE                    14320037
143300*               IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID      14330037
143400*                AND PS-END-OF-DTL-INPUT-NO                       14340037
143500*                  PERFORM 6005-TALLY-AND-SUM                     14350037
143600*               END-IF                                            14360037
143700        END-PERFORM                                               14370037
143800     END-IF.                                                      14380037
143900                                                                  14390037
144000**** IF HDR DFCT-ORD-ID > DTL DFCT-ORD-ID                         14400037
144100**** THEN A HDR REC IS MISSING FOR THE CURRENT DTL DFCT-ORD-ID    14410037
144200     IF RV050-DFCT-ORD-ID > RV051-DFCT-ORD-ID                     14420037
144300        SET PS-HDR-REC-MISSING-FOR-DTL                            14430037
144400            RV019-CRITICAL             TO TRUE                    14440037
144500        PERFORM                                                   14450037
144600           UNTIL (RV050-DFCT-ORD-ID = RV051-DFCT-ORD-ID) OR       14460037
144700                 PS-END-OF-DTL-INPUT-YES                          14470037
144800                 ADD +1 TO PA-TOT-DTLS-BYPASSED                   14480037
144900                 PERFORM 7001-INSERT-DTL-TO-ERR-TBL               14490037
145000                 PERFORM 7015-SUM-ERROR-VALUES                    14500037
145100                 IF PS-END-OF-DTL-INPUT-NO                        14510037
145200                    PERFORM 6001-READ-RTV-DTL-FILE                14520037
145300*                   IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID  14530037
145400*                    AND PS-END-OF-DTL-INPUT-NO                   14540037
145500*                      PERFORM 6005-TALLY-AND-SUM                 14550037
145600*                   END-IF                                        14560037
145700                 END-IF                                           14570037
145800        END-PERFORM                                               14580037
145900     END-IF.                                                      14590037
146000                                                                  14600037
146100**WRITE OUT ERRORS FOR ANY HDRS THAT MAY EXIST WITHOUT DTL RECS   14610037
146200     IF RV050-DFCT-ORD-ID > RV051-DFCT-ORD-ID                     14620037
146300     AND PS-END-OF-DTL-INPUT-YES                                  14630037
146400     AND PS-END-OF-HDR-INPUT-NO                                   14640037
146500        SET PS-DTL-REC-MISSING-FOR-HDR                            14650037
146600            RV018-CRITICAL          TO TRUE                       14660037
146700        PERFORM                                                   14670037
146800          UNTIL PS-END-OF-HDR-INPUT-YES                           14680037
146900                ADD +1 TO PA-TOT-HDRS-BYPASSED                    14690037
147000                PERFORM 7000-INSERT-HDR-TO-ERR-TBL                14700037
147100                IF PS-END-OF-HDR-INPUT-NO                         14710037
147200                   PERFORM 6000-READ-RTV-HDR-FILE                 14720037
147300*                  IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID   14730037
147400*                   AND PS-END-OF-DTL-INPUT-NO                    14740037
147500*                     PERFORM 6005-TALLY-AND-SUM                  14750037
147600*                  END-IF                                         14760037
147700                END-IF                                            14770037
147800        END-PERFORM                                               14780037
147900     END-IF.                                                      14790037
148000                                                                  14800037
148100**** IF HDR DFCT-ORD-ID < DTL DFCT-ORD-ID                         14810037
148200**** THEN A DTL REC IS MISSING FOR THE CURRENT HDR DFCT-ORD-ID    14820037
148300     IF RV050-DFCT-ORD-ID < RV051-DFCT-ORD-ID                     14830037
148400        SET PS-DTL-REC-MISSING-FOR-HDR                            14840037
148500            RV018-CRITICAL          TO TRUE                       14850037
148600        PERFORM                                                   14860037
148700           UNTIL (RV050-DFCT-ORD-ID = RV051-DFCT-ORD-ID) OR       14870037
148800                 PS-END-OF-HDR-INPUT-YES                          14880037
148900                 ADD +1 TO PA-TOT-HDRS-BYPASSED                   14890037
149000                 PERFORM 7000-INSERT-HDR-TO-ERR-TBL               14900037
149100                 IF PS-END-OF-HDR-INPUT-NO                        14910037
149200                    PERFORM 6000-READ-RTV-HDR-FILE                14920037
149300*                   IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID  14930037
149400*                    AND PS-END-OF-DTL-INPUT-NO                   14940037
149500*                      PERFORM 6005-TALLY-AND-SUM                 14950037
149600*                   END-IF                                        14960037
149700                 END-IF                                           14970037
149800        END-PERFORM                                               14980037
149900     END-IF.                                                      14990037
150000                                                                  15000037
150100**WRITE OUT ERRORS FOR ANY DTLS THAT MAY EXIST WITHOUT HDR RECS   15010037
150200     IF RV050-DFCT-ORD-ID < RV051-DFCT-ORD-ID                     15020037
150300     AND PS-END-OF-DTL-INPUT-NO                                   15030037
150400     AND PS-END-OF-HDR-INPUT-YES                                  15040037
150500        SET PS-DTL-REC-MISSING-FOR-HDR                            15050037
150600            RV018-CRITICAL             TO TRUE                    15060037
150700        PERFORM                                                   15070037
150800          UNTIL PS-END-OF-DTL-INPUT-YES                           15080037
150900                ADD +1 TO PA-TOT-DTLS-BYPASSED                    15090037
151000                PERFORM 7001-INSERT-DTL-TO-ERR-TBL                15100037
151100                PERFORM 7015-SUM-ERROR-VALUES                     15110037
151200                IF PS-END-OF-DTL-INPUT-NO                         15120037
151300                   PERFORM 6001-READ-RTV-DTL-FILE                 15130037
151400*                  IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID   15140037
151500*                   AND PS-END-OF-DTL-INPUT-NO                    15150037
151600*                     PERFORM 6005-TALLY-AND-SUM                  15160037
151700*                  END-IF                                         15170037
151800                END-IF                                            15180037
151900        END-PERFORM                                               15190037
152000     END-IF.                                                      15200037
152100                                                                  15210037
152200**** IF END OF HDR INPUT & THE LAST HDR EXISTS, THEN SPIN THE     15220037
152300**** DTL FILE TO END TO DROP OUT OF MAIN 2000- PROCESS LOOP.      15230037
152400     IF PS-HDR-EXISTS-YES AND PS-END-OF-HDR-INPUT-YES             15240037
152500        PERFORM UNTIL PS-END-OF-DTL-INPUT-YES                     15250037
152600                PERFORM 7015-SUM-ERROR-VALUES                     15260037
152700                PERFORM 6001-READ-RTV-DTL-FILE                    15270037
152800*               IF RV050-DFCT-ORD-ID EQUAL RV051-DFCT-ORD-ID      15280037
152900*                AND PS-END-OF-DTL-INPUT-NO                       15290037
153000*                  PERFORM 6005-TALLY-AND-SUM                     15300037
153100*               END-IF                                            15310037
153200                ADD +1 TO PA-TOT-DTLS-BYPASSED                    15320037
153300        END-PERFORM                                               15330037
153400     END-IF.                                                      15340037
153500                                                                  15350037
153600**THIS IS USED TO COUNT THE DTLS OF EACH RETURN TYPE              15360037
153700**BECAUSE AT THIS POINT THE RECORDS SHOULD BE IN SYNC             15370037
153800     MOVE RV050-RETURN-TYPE TO PV-HOLD-RETURN-TYPE.               15380037
153900     MOVE RV051-DFCT-ORD-ID TO PV-HOLD-DTL-DFCT-ORD-ID.           15390037
154000                                                                  15400037
154100                                                                  15410037
154200******************************************************************15420037
154300* EDIT THE HEADER REC FOR VALID DATES, NUMERICS & REQUIRED FIELDS 15430037
154400******************************************************************15440037
154500 2200-EDIT-HDR-REC.                                               15450037
154600                                                                  15460037
154700     SET PS-HDR-CRITICAL-ERR-NO TO TRUE.                          15470037
154800** BYPASS CALLBACKS - WHICH ARE RETURN TYPE OF "C"                15480037
154900     IF RV050-RETURN-TYPE EQUAL PC-C                              15490037
155000        ADD +1 TO PA-TOT-CALLBACKS                                15500037
155100        SET PS-CONTINUE-THIS-REC-NO TO TRUE                       15510037
155200     ELSE                                                         15520037
155300**DFCT-ORD-ID MUST BE > 0                                         15530037
155400        IF RV050-DFCT-ORD-ID = 0                                  15540037
155500           SET PS-HDR-DFCT-ORD-ID-ZERO                            15550037
155600               PS-HDR-CRITICAL-ERR-YES                            15560037
155700               RV018-CRITICAL       TO TRUE                       15570037
155800           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     15580037
155900           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    15590037
156000        END-IF                                                    15600037
156100                                                                  15610037
156200**DFCT-ORD-ID MUST BE NUMERIC                                     15620037
156300        IF RV050-DFCT-ORD-ID NOT NUMERIC                          15630037
156400           SET PS-HDR-DFCT-ORD-ID-NON-NUM                         15640037
156500               PS-HDR-CRITICAL-ERR-YES                            15650037
156600               RV018-CRITICAL       TO TRUE                       15660037
156700           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     15670037
156800           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    15680037
156900        END-IF                                                    15690037
157000                                                                  15700037
157100**VENDOR-DUNS-NBR CANNOT BE BLANK FOR RETURN-TYPES 'R' OR 'D'     15710037
157200**VENDOR-DUNS-NBR IS NOT REQUIRED FOR 'M' RETURN-TYPES            15720037
157300        IF RV050-VENDOR-DUNS-NBR EQUAL PC-SPACE                   15730037
157400         AND (RV050-RETURN-TYPE EQUAL PC-R OR                     15740037
157500              RV050-RETURN-TYPE EQUAL PC-D)                       15750037
157600           SET PS-VENDOR-DUNS-NBR-BLANK                           15760037
157700               PS-HDR-CRITICAL-ERR-YES                            15770037
157800               RV018-CRITICAL       TO TRUE                       15780037
157900           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     15790037
158000           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    15800037
158100        END-IF                                                    15810037
158200                                                                  15820037
158300**IF VENDOR-DUNS-NBR SENT, VALIDATE IT...                         15830037
158400        IF RV050-VENDOR-DUNS-NBR > PC-SPACE                       15840037
158500           PERFORM 2225-VALIDATE-DUNS-NBR                         15850037
158600**A VALID DUNS NBR IS REQUIRED FOR RETURN-TYPES 'R' OR 'D'        15860037
158700           IF PS-DUNS-VALID-NO                                    15870037
158800             AND (RV050-RETURN-TYPE EQUAL PC-R OR                 15880037
158900                 RV050-RETURN-TYPE EQUAL PC-D)                    15890037
159000              SET PS-VENDOR-DUNS-NBR-INVALID                      15900037
159100                  PS-HDR-CRITICAL-ERR-YES                         15910037
159200                  RV018-CRITICAL       TO TRUE                    15920037
159300              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  15930037
159400              SET PS-CONTINUE-THIS-REC-NO TO TRUE                 15940037
159500           END-IF                                                 15950037
159600        END-IF                                                    15960037
159700                                                                  15970037
159800**WHEN RET TYP 'M' AND NO DUNS NBR, MOVE THE GENERIC NOT FOUND MSG15980037
159900**VENDOR-NAME CANNOT BE BLANK ON RETURN-TYPE 'R' OR 'D'           15990037
160000        IF (RV050-VENDOR-DUNS-NBR EQUAL PC-SPACE                  16000037
160100         OR RV050-VENDOR-DUNS-NBR < PC-SPACE)                     16010037
160200         AND RV050-RETURN-TYPE = PC-M                             16020037
160300           MOVE PC-VNDR-NAME-NOT-FOUND TO RV050-VEND-NAME         16030037
160400        ELSE                                                      16040037
160500           IF (RV050-RETURN-TYPE EQUAL PC-R OR                    16050037
160600               RV050-RETURN-TYPE EQUAL PC-D)                      16060037
160700              AND (RV050-VEND-NAME = PC-SPACE                     16070037
160800                 OR RV050-VEND-NAME < PC-SPACE)                   16080037
160900              SET PS-VENDOR-NAME-BLANK                            16090037
161000                  RV018-WARNING     TO TRUE                       16100037
161100              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  16110037
161200              IF PS-DUNS-VALID-YES                                16120037
161300                 MOVE ENTNME-ENT-NAME-DESC TO RV050-VEND-NAME     16130037
161400              END-IF                                              16140037
161500           END-IF                                                 16150037
161600        END-IF                                                    16160037
161700                                                                  16170037
161800** RESET THE SWITCH TO TRACK RETURN-TYPE                          16180037
161900        MOVE PC-SPACE TO PS-RETURN-TYPE-SW                        16190037
162000                                                                  16200037
162100**RETURN TYPE MUST BE 'R', 'D' OR 'M'                             16210037
162200        IF RV050-RETURN-TYPE EQUAL PC-R                           16220037
162300        OR RV050-RETURN-TYPE EQUAL PC-D                           16230037
162400        OR RV050-RETURN-TYPE EQUAL PC-M                           16240037
162500           EVALUATE TRUE                                          16250037
162600              WHEN RV050-RETURN-TYPE EQUAL PC-R                   16260037
162700                   SET PS-RETURN-TYPE-RETURN TO TRUE              16270037
162800              WHEN RV050-RETURN-TYPE EQUAL PC-D                   16280037
162900                   SET PS-RETURN-TYPE-DEBIT-DISPOSE TO TRUE       16290037
163000              WHEN RV050-RETURN-TYPE EQUAL PC-M                   16300037
163100                   SET PS-RETURN-TYPE-MARK-OUT TO TRUE            16310037
163200           END-EVALUATE                                           16320037
163300        ELSE                                                      16330037
163400           SET PS-RETURN-TYPE-UNK                                 16340037
163500               PS-HDR-CRITICAL-ERR-YES                            16350037
163600               RV018-CRITICAL  TO TRUE                            16360037
163700           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     16370037
163800           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    16380037
163900        END-IF                                                    16390037
164000                                                                  16400037
164100**ORD-DTE CHECK                                                   16410037
164200        MOVE RV050-ORD-DTE TO PV-CCYYMMDD-CHECK                   16420037
164300        PERFORM 2900-KOHLS-CALENDAR-ROUTINE                       16430037
164400                                                                  16440037
164500        IF PS-DATE-IS-VALID-YES                                   16450037
164600           CONTINUE                                               16460037
164700        ELSE                                                      16470037
164800           SET PS-ORD-DTE-INVALID                                 16480037
164900               PS-HDR-CRITICAL-ERR-YES                            16490037
165000               RV018-CRITICAL  TO TRUE                            16500037
165100           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     16510037
165200           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    16520037
165300        END-IF                                                    16530037
165400                                                                  16540037
165500**  JH  10/30/2011 BEG                                            16550037
165600**OPER-UNT-ID - GENCO SHOULD BE SENDING 0810 OR WE MOVE 0810      16560037
165700**      IF RV050-OPER-UNT-ID NOT EQUAL  PC-OPER-UNT-ID            16570037
165800**         MOVE PC-OPER-UNT-ID  TO RV050-OPER-UNT-ID              16580037
165900**      END-IF                                                    16590037
166000**  JH  10/30/2011 END                                            16600037
166100                                                                  16610037
166200**MOVE SPACE IF NULLS                                             16620037
166300     IF RV050-LOC-ID < SPACE                                      16630037
166400        MOVE PC-SPACE            TO RV050-LOC-ID                  16640037
166500     END-IF                                                       16650037
166600                                                                  16660037
166700**STATUS-CHG-DTE CHECK                                            16670037
166800        MOVE RV050-STATUS-CHG-DTE TO PV-CCYYMMDD-CHECK            16680037
166900        PERFORM 2900-KOHLS-CALENDAR-ROUTINE                       16690037
167000                                                                  16700037
167100        IF PS-DATE-IS-VALID-YES                                   16710037
167200           CONTINUE                                               16720037
167300        ELSE                                                      16730037
167400           SET PS-STATUS-CHG-DTE-INVALID                          16740037
167500               PS-HDR-CRITICAL-ERR-YES                            16750037
167600               RV018-CRITICAL            TO TRUE                  16760037
167700           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     16770037
167800           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    16780037
167900        END-IF                                                    16790037
168000                                                                  16800037
168100**DFCT-ORD-STAT-CDE MUST BE 'S' OR 'D'                            16810037
168200        IF RV050-DFCT-ORD-STAT-CDE EQUAL PC-S                     16820037
168300        OR RV050-DFCT-ORD-STAT-CDE EQUAL PC-D                     16830037
168400           CONTINUE                                               16840037
168500        ELSE                                                      16850037
168600           SET PS-DFCT-ORD-STAT-CDE-UNK                           16860037
168700               PS-HDR-CRITICAL-ERR-YES                            16870037
168800               RV018-CRITICAL           TO TRUE                   16880037
168900           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     16890037
169000           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    16900037
169100        END-IF                                                    16910037
169200                                                                  16920037
169300**SHIPT-DTE CHECK                                                 16930037
169400        MOVE RV050-SHIPT-DTE TO PV-CCYYMMDD-CHECK                 16940037
169500        PERFORM 2900-KOHLS-CALENDAR-ROUTINE                       16950037
169600                                                                  16960037
169700        IF PS-DATE-IS-VALID-YES                                   16970037
169800           CONTINUE                                               16980037
169900        ELSE                                                      16990037
170000           SET PS-SHIPT-DTE-INVALID                               17000037
170100               PS-HDR-CRITICAL-ERR-YES                            17010037
170200               RV018-CRITICAL       TO TRUE                       17020037
170300           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     17030037
170400           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    17040037
170500        END-IF                                                    17050037
170600                                                                  17060037
170700**SHIPT-STAT-CDE CANNOT BE BLANK                                  17070037
170800        IF RV050-SHIPT-STAT-CDE NOT EQUAL PC-S                    17080037
170900           MOVE PC-S TO RV050-SHIPT-STAT-CDE                      17090037
171000        END-IF                                                    17100037
171100                                                                  17110037
171200**CART-QTY MUST BE NUMERIC IF SENT                                17120037
171300        IF RV050-CART-QTY NOT NUMERIC                             17130037
171400           SET PS-CART-QTY-NON-NUM                                17140037
171500               RV018-WARNING       TO TRUE                        17150037
171600           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     17160037
171700           MOVE 0 TO RV050-CART-QTY                               17170037
171800        END-IF                                                    17180037
171900                                                                  17190037
172000**VND-AUTH-DTE CHECK                                              17200037
172100**NO NEED TO VALIDATE THE AUTH-DTE FOR 'M' RETURN-TYPES BECAUSE   17210037
172200**NULLS WILL ALWAYS BE MOVED TO THIS FIELD FOR THE HDR INSERT     17220037
172300        IF RV050-RETURN-TYPE = PC-M                               17230037
172400           MOVE -1 TO NI-VND-AUTH-DTE                             17240037
172500        ELSE                                                      17250037
172600           MOVE 0 TO NI-VND-AUTH-DTE                              17260037
172700           MOVE RV050-VND-AUTH-DTE TO PV-CCYYMMDD-CHECK           17270037
172800           PERFORM 2900-KOHLS-CALENDAR-ROUTINE                    17280037
172900        END-IF                                                    17290037
173000                                                                  17300037
173100**!!! THIS EDIT MUST FOLLOW THE DATE ROUTINE CHECK FOR            17310037
173200**!!! VND-AUTH-DTE BECAUSE LOGIC TESTS THE VALIDITY SWITCH        17320037
173300**VND-AUTH-NBR MUST BE > SPACE AND BE COUPLED WITH A VALID        17330037
173400**VND-AUTH-DTE SENT FROM GENCO IF RETURN-TYP-CDE IS 'R' OR 'D'    17340037
173500        IF RV050-RETURN-TYPE EQUAL PC-R OR                        17350037
173600           RV050-RETURN-TYPE EQUAL PC-D                           17360037
173700           IF RV050-VND-AUTH-NBR < PC-SPACE                       17370037
173800            OR RV050-VND-AUTH-NBR EQUAL PC-SPACE                  17380037
173900              SET PS-MISSING-VND-AUTH-NBR                         17390037
174000                  PS-HDR-CRITICAL-ERR-YES                         17400037
174100                  RV018-CRITICAL       TO TRUE                    17410037
174200              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  17420037
174300              SET PS-CONTINUE-THIS-REC-NO TO TRUE                 17430037
174400           END-IF                                                 17440037
174500           IF PS-DATE-IS-VALID-NO                                 17450037
174600              SET PS-VND-AUTH-DTE-INVALID                         17460037
174700                  PS-HDR-CRITICAL-ERR-YES                         17470037
174800                  RV018-CRITICAL       TO TRUE                    17480037
174900              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  17490037
175000              SET PS-CONTINUE-THIS-REC-NO TO TRUE                 17500037
175100           END-IF                                                 17510037
175200        END-IF                                                    17520037
175300                                                                  17530037
175400**INBD-RET-FRGT-SIGN MUST BE '-' OR BLANK                         17540037
175500        IF RV050-INBD-RET-FRGT-SIGN EQUAL PC-DASH                 17550037
175600        OR RV050-INBD-RET-FRGT-SIGN EQUAL PC-SPACE                17560037
175700**INBD-RET-FRGT-AMT MUST BE NUMERIC IF SENT                       17570037
175800           IF RV050-INBD-RET-FRGT-AMT NOT NUMERIC                 17580037
175900              SET PS-INBD-RET-FRGT-AMT-NON-NUM                    17590037
176000                  RV018-WARNING                TO TRUE            17600037
176100              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  17610037
176200              MOVE 0 TO RV050-INBD-RET-FRGT-AMT                   17620037
176300           END-IF                                                 17630037
176400        ELSE                                                      17640037
176500           SET PS-INBD-RET-FRGT-SIGN-UNK                          17650037
176600               RV018-WARNING             TO TRUE                  17660037
176700           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     17670037
176800           MOVE 0 TO RV050-INBD-RET-FRGT-AMT                      17680037
176900        END-IF                                                    17690037
177000                                                                  17700037
177100**OTBND-RET-FRGT-SIGN MUST BE '-' OR BLANK                        17710037
177200        IF RV050-OTBND-RET-FRGT-SIGN EQUAL PC-DASH                17720037
177300        OR RV050-OTBND-RET-FRGT-SIGN EQUAL PC-SPACE               17730037
177400**OTBND-RET-FRGT-AMT MUST NUMERIC IF SENT                         17740037
177500           IF RV050-OTBND-RET-FRGT-AMT NOT NUMERIC                17750037
177600              SET PS-OTBND-RET-FRGT-AMT-NON-NUM                   17760037
177700                  RV018-WARNING                 TO TRUE           17770037
177800              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  17780037
177900              MOVE 0 TO RV050-OTBND-RET-FRGT-AMT                  17790037
178000           END-IF                                                 17800037
178100        ELSE                                                      17810037
178200           SET PS-OTBND-RET-FRGT-SIGN-UNK                         17820037
178300               RV018-WARNING              TO TRUE                 17830037
178400           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     17840037
178500           MOVE 0 TO RV050-OTBND-RET-FRGT-AMT                     17850037
178600        END-IF                                                    17860037
178700                                                                  17870037
178800**DED-CHRG-SIGN MUST BE '-' OR BLANK                              17880037
178900        IF RV050-DED-CHRG-SIGN EQUAL PC-DASH                      17890037
179000        OR RV050-DED-CHRG-SIGN EQUAL PC-SPACE                     17900037
179100**DED-CHRG-AMT MUST BE NUMERIC IF SENT                            17910037
179200           IF RV050-DED-CHRG-AMT NOT NUMERIC                      17920037
179300              SET PS-DED-CHRG-AMT-NON-NUM                         17930037
179400                  RV018-WARNING           TO TRUE                 17940037
179500              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  17950037
179600              MOVE 0 TO RV050-DED-CHRG-AMT                        17960037
179700           END-IF                                                 17970037
179800        ELSE                                                      17980037
179900           SET PS-DED-CHRG-SIGN-UNK                               17990037
180000               RV018-WARNING        TO TRUE                       18000037
180100           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     18010037
180200           MOVE 0 TO RV050-DED-CHRG-AMT                           18020037
180300        END-IF                                                    18030037
180400                                                                  18040037
180500**DISC-PCT-SIGN MUST BE '-' OR BLANK                              18050037
180600        IF RV050-DISC-PCT-SIGN EQUAL PC-DASH                      18060037
180700        OR RV050-DISC-PCT-SIGN EQUAL PC-SPACE                     18070037
180800**DISC-PCT MUST BE NUMERIC IF SENT                                18080037
180900           IF RV050-DISC-PCT NOT NUMERIC                          18090037
181000              SET PS-DISC-PCT-NON-NUM                             18100037
181100                  RV018-WARNING       TO TRUE                     18110037
181200              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  18120037
181300              MOVE 0 TO RV050-DISC-PCT                            18130037
181400           END-IF                                                 18140037
181500        ELSE                                                      18150037
181600           SET PS-DISC-PCT-SIGN-UNK                               18160037
181700               RV018-WARNING        TO TRUE                       18170037
181800           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     18180037
181900           MOVE 0 TO RV050-DISC-PCT                               18190037
182000        END-IF                                                    18200037
182100                                                                  18210037
182200**DISC-AMT-SIGN MUST BE '-' OR BLANK                              18220037
182300        IF RV050-DISC-AMT-SIGN EQUAL PC-DASH                      18230037
182400        OR RV050-DISC-AMT-SIGN EQUAL PC-SPACE                     18240037
182500**DISC-AMT MUST BE NUMERIC IF SENT                                18250037
182600           IF RV050-DISC-AMT NOT NUMERIC                          18260037
182700              SET PS-DISC-AMT-NON-NUM                             18270037
182800                  RV018-WARNING       TO TRUE                     18280037
182900              PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  18290037
183000              MOVE 0 TO RV050-DISC-AMT                            18300037
183100           END-IF                                                 18310037
183200        ELSE                                                      18320037
183300           SET PS-DISC-AMT-SIGN-UNK                               18330037
183400               RV018-WARNING        TO TRUE                       18340037
183500           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     18350037
183600           MOVE 0 TO RV050-DISC-AMT                               18360037
183700        END-IF                                                    18370037
183800                                                                  18380037
183900**WEIGHT MUST BE NUMERIC IF SENT                                  18390037
184000        IF RV050-WEIGHT NOT NUMERIC                               18400037
184100           SET PS-WEIGHT-NON-NUM                                  18410037
184200               RV018-WARNING     TO TRUE                          18420037
184300           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     18430037
184400           MOVE 0 TO RV050-WEIGHT                                 18440037
184500        END-IF                                                    18450037
184600                                                                  18460037
184700**RET-RSN-CDE MUST BE A VALUE OF 1 THRU 9 IF SENT                 18470037
184800        IF RV050-RET-RSN-CDE EQUAL PC-1                           18480037
184900        OR RV050-RET-RSN-CDE EQUAL PC-2                           18490037
185000        OR RV050-RET-RSN-CDE EQUAL PC-3                           18500037
185100        OR RV050-RET-RSN-CDE EQUAL PC-4                           18510037
185200        OR RV050-RET-RSN-CDE EQUAL PC-5                           18520037
185300        OR RV050-RET-RSN-CDE EQUAL PC-6                           18530037
185400        OR RV050-RET-RSN-CDE EQUAL PC-7                           18540037
185500        OR RV050-RET-RSN-CDE EQUAL PC-8                           18550037
185600        OR RV050-RET-RSN-CDE EQUAL PC-9                           18560037
185700           CONTINUE                                               18570037
185800        ELSE                                                      18580037
185900           SET PS-RET-RSN-CDE-UNK                                 18590037
186000               RV018-WARNING      TO TRUE                         18600037
186100           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     18610037
186200           MOVE PC-9 TO RV050-RET-RSN-CDE                         18620037
186300        END-IF                                                    18630037
186400*060607                                                           18640037
186500*060607 SIMPLIFY THIS EDIT -- IF NOT 'P' OR 'C' REPLACE WITH 'P'  18650037
186600*060607 NO MATTER WHAT THE RETURN TYPE IS                         18660037
186700**PAYT-TYP-CDE MUST 'P' OR 'C' FOR RET-TYP 'R', 'M' OR ('D' WHERE 18670037
186800**THERE IS A CARR_TRKG_ID PRESENT). PATY-TYP-CDE SHOULD BE SPACE  18680037
186900**WHERE RET-TYP IS 'D' AND THERE IS NO CARR_TRKG_ID (DESTROYED)   18690037
187000                                                                  18700037
187100**THIS IS A DEBIT&DESTROY                                         18710037
187200*060607 IF RV050-RETURN-TYPE EQUAL PC-D                           18720037
187300*060607  AND RV050-CARR-TRKG-ID = PC-SPACE                        18730037
187400*060607  AND RV050-PAYT-TYP-CDE NOT EQUAL PC-SPACE                18740037
187500*060607    SET PS-PAYT-TYP-INV-DESTROY                            18750037
187600*060607        RV018-WARNING       TO TRUE                        18760037
187700*060607    PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     18770037
187800*060607    MOVE PC-SPACE TO RV050-PAYT-TYP-CDE                    18780037
187900*060607 ELSE                                                      18790037
188000**THIS IS A DEBIT&DAMAGED OR RETURN OR MARK-OUT-OF-STOCK          18800037
188100*060607    IF (((RV050-RETURN-TYPE EQUAL PC-D OR                  18810037
188200*060607         RV050-RETURN-TYPE EQUAL PC-M) AND                 18820037
188300*060607        RV050-CARR-TRKG-ID > PC-SPACE)                     18830037
188400*060607      OR RV050-RETURN-TYPE EQUAL PC-R)                     18840037
188500*060607      AND RV050-PAYT-TYP-CDE NOT EQUAL PC-P                18850037
188600*060607      AND RV050-PAYT-TYP-CDE NOT EQUAL PC-C                18860037
188700*060607       SET PS-PAYT-TYP-INV-NON-DESTROY                     18870037
188800*060607           RV018-WARNING       TO TRUE                     18880037
188900*060607       PERFORM 7000-INSERT-HDR-TO-ERR-TBL                  18890037
189000*060607       MOVE PC-P TO RV050-PAYT-TYP-CDE                     18900037
189100*060607    END-IF                                                 18910037
189200*060607 END-IF                                                    18920037
189300                                                                  18930037
189400        IF RV050-PAYT-TYP-CDE EQUAL PC-P OR PC-C                  18940037
189500            CONTINUE                                              18950037
189600        ELSE                                                      18960037
189700            MOVE PC-P TO RV050-PAYT-TYP-CDE                       18970037
189800        END-IF                                                    18980037
189810                                                                  18981044
189900*GB 03/15/23                                                      18990044
189910        IF RV050-PAYT-TYP-CDE = 'P'                               18991044
189920           MOVE +0   TO RV050-OTBND-RET-FRGT-AMT                  18992044
189930        END-IF                                                    18993044
189940*GB 03/15/23                                                      18994044
189950                                                                  18995044
190000*060607 SIMPLIFY THIS EDIT -- IF NOT 'P' OR 'C' REPLACE WITH 'P'  19000037
190100*060607 NO MATTER WHAT THE RETURN TYPE IS                         19010037
190200                                                                  19020037
190300**GENCO IS SENDING THE PRO NBR IN THE CARR_TRKG_ID FIELD. THIS    19030037
190400**IS NECESSARY TO USE TO JOIN TDFCTOR TO RVT_DFCT_SHIPT IN ORDER  19040037
190500**TO DETERMINE IF NEW SHIPPING ROWS NEED TO BE ADDED TO           19050037
190600**RVT_DFCT_SHIPT & RVT_SHIPT_STAT WHEN A HDR IS INSERTED          19060037
190700**FOR 'D' RETURN-TYPES, CARR-TRKG-ID (PRO NUMBER) IS NOT SENT,    19070037
190800**SO BYPASS THE CRITICAL ERROR FOR THIS RETURN-TYPE               19080037
190900**ALSO BYPASS WHEN 'M' RETURN-TYPE AND 'S' DFCT-ORD-STAT-CDE,     19090037
191000**MARK OUT OF STOCK THAT WAS SHIPPED.                             19100037
191100        IF RV050-CARR-TRKG-ID = PC-SPACE                          19110037
191200           IF ((RV050-RETURN-TYPE = PC-D)                         19120047
191300                          OR                                      19130047
191400             (RV050-RETURN-TYPE EQUAL PC-M                        19140047
191500              AND RV050-DFCT-ORD-STAT-CDE = 'D'))                 19150047
191600                CONTINUE                                          19160047
191700           ELSE                                                   19170037
191710             MOVE 'NO PRO NUMBER'  TO RV050-CARR-TRKG-ID          19171047
191800*GB          SET PS-CARR-TRKG-ID-BLANK                            19180047
191900*GB              PS-HDR-CRITICAL-ERR-YES                          19190047
192000*GB              RV018-CRITICAL      TO TRUE                      19200047
192100*GB          PERFORM 7000-INSERT-HDR-TO-ERR-TBL                   19210047
192200*GB          SET PS-CONTINUE-THIS-REC-NO TO TRUE                  19220047
192300           END-IF                                                 19230037
192400        END-IF                                                    19240037
192500                                                                  19250037
192600**USR-ID CANNOT BE BLANK                                          19260037
192700        IF RV050-USR-ID EQUAL PC-SPACE                            19270037
192800           MOVE PC-DEFAULT-USR-ID TO RV050-USR-ID                 19280037
192900        END-IF                                                    19290037
193000                                                                  19300037
193100**TRLR_ID CANNOT BE NULL                                          19310037
193200        IF RV050-TRLR-ID < 0                                      19320037
193300           MOVE PC-SPACE TO RV050-TRLR-ID                         19330037
193400        END-IF                                                    19340037
193500                                                                  19350037
193600**EDIT SCAC CDE FOR VALID KOHL'S CARRIER BY MATCHING TO THE       19360037
193700**SCAC ON TEXTENT                                                 19370037
193800        PERFORM 2250-VALIDATE-SCAC                                19380037
193900        IF PS-SCAC-VALID-NO                                       19390037
194000           SET PS-SCAC-INVALID                                    19400037
194100               PS-HDR-CRITICAL-ERR-YES                            19410037
194200               RV018-CRITICAL  TO TRUE                            19420037
194300           PERFORM 7000-INSERT-HDR-TO-ERR-TBL                     19430037
194400           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    19440037
194500        END-IF                                                    19450037
194600                                                                  19460037
194700**ZIPCODE MUST BE NUMERIC IF SENT                                 19470037
194800        IF RV050-ZIPCODE IS NUMERIC                               19480037
194900           CONTINUE                                               19490037
195000        ELSE                                                      19500037
195100           MOVE 0 TO RV050-ZIPCODE                                19510037
195200        END-IF                                                    19520037
195300                                                                  19530037
195400**PHN_AREA_CODE MUST BE NUMERIC IF SENT                           19540037
195500        IF RV050-PHN-AREA-CDE IS NUMERIC                          19550037
195600           CONTINUE                                               19560037
195700        ELSE                                                      19570037
195800           MOVE 0 TO RV050-PHN-AREA-CDE                           19580037
195900        END-IF                                                    19590037
196000                                                                  19600037
196100**PHN_EXCH_NBR MUST BE NUMERIC IF SENT                            19610037
196200        IF RV050-PHN-EXCH-NBR IS NUMERIC                          19620037
196300           CONTINUE                                               19630037
196400        ELSE                                                      19640037
196500           MOVE 0 TO RV050-PHN-EXCH-NBR                           19650037
196600        END-IF                                                    19660037
196700                                                                  19670037
196800**PHN_NBR MUST BE NUMERIC IF SENT                                 19680037
196900        IF RV050-PHN-NBR IS NUMERIC                               19690037
197000           CONTINUE                                               19700037
197100        ELSE                                                      19710037
197200           MOVE 0 TO RV050-PHN-NBR                                19720037
197300        END-IF                                                    19730037
197400                                                                  19740037
197500**FAX_PHN_AREA_CDE MUST BE NUMERIC IF SENT                        19750037
197600        IF RV050-FAX-PHN-AREA-CDE IS NUMERIC                      19760037
197700           CONTINUE                                               19770037
197800        ELSE                                                      19780037
197900           MOVE 0 TO RV050-FAX-PHN-AREA-CDE                       19790037
198000        END-IF                                                    19800037
198100                                                                  19810037
198200**FAX_EXCH_NBR MUST BE NUMERIC IF SENT                            19820037
198300        IF RV050-FAX-EXCH-NBR IS NUMERIC                          19830037
198400           CONTINUE                                               19840037
198500        ELSE                                                      19850037
198600           MOVE 0 TO RV050-FAX-EXCH-NBR                           19860037
198700        END-IF                                                    19870037
198800                                                                  19880037
198900**FAX_PHN_NBR MUST BE NUMERIC IF SENT                             19890037
199000        IF RV050-FAX-PHN-NBR IS NUMERIC                           19900037
199100           CONTINUE                                               19910037
199200        ELSE                                                      19920037
199300           MOVE 0 TO RV050-FAX-PHN-NBR                            19930037
199400        END-IF                                                    19940037
199500     END-IF.                                                      19950037
199600                                                                  19960037
199700**  JH  10/30/2011 BEG                                            19970037
199800******************************************************************19980037
199900* VALIDATE THE LOCATION, MOVE LOC, NAME TO REPORT                *19990037
200000******************************************************************20000037
200100 2210-VALIDATE-LOCATION.                                          20010037
200200                                                                  20020037
200300     INITIALIZE DCLXLT00010.                                      20030037
200400     MOVE RV050-OPER-UNT-ID TO PV-LOC-NBR.                        20040037
200500                                                                  20050037
200600     EXEC SQL                                                     20060037
200700         SELECT  LOC_NBR                                          20070037
200800                ,LOC_10_ABBR_NM                                   20080037
200900           INTO  :XLT00010-LOC-NBR                                20090037
201000                ,:XLT00010-LOC-10-ABBR-NM                         20100037
201100           FROM XLT_LOC                                           20110037
201200         WHERE LOC_TYP_CDE = 'RV' AND                             20120037
201300               LOC_NBR = :PV-LOC-NBR                              20130037
201400     END-EXEC.                                                    20140037
201500                                                                  20150037
201600     EVALUATE TRUE                                                20160037
201700         WHEN SQLCODE = +0                                        20170037
201800             MOVE XLT00010-LOC-10-ABBR-NM TO PV-LOC-NAME          20180037
201900             CONTINUE                                             20190037
202000         WHEN SQLCODE = +100                                      20200037
202100         WHEN SQLWARN0 NOT EQUAL SPACE                            20210037
202200         WHEN SQLCODE  NOT EQUAL ZERO                             20220037
202300             DISPLAY '------------------------------------'       20230037
202400             DISPLAY 'INVALID LOCATION FOUND' RV050-OPER-UNT-ID   20240037
202500             SET PS-INVALID-LOCATION-FOUND TO TRUE                20250037
202600             SET PS-HDR-CRITICAL-ERR-YES TO TRUE                  20260037
202700             SET RV018-CRITICAL TO TRUE                           20270037
202800             PERFORM 7000-INSERT-HDR-TO-ERR-TBL                   20280037
202900             SET PS-CONTINUE-THIS-REC-NO TO TRUE                  20290037
203000     END-EVALUATE.                                                20300037
203100                                                                  20310037
203200**  JH 10/30/2011 END                                             20320037
203300                                                                  20330037
203400******************************************************************20340037
203500* VALIDATE THE VENDOR_DUNS_NBR, BRING BACK ENT NAME IF NEEDED     20350037
203600******************************************************************20360037
203700 2225-VALIDATE-DUNS-NBR.                                          20370037
203800                                                                  20380037
203900     SET PS-DUNS-VALID-NO  TO TRUE.                               20390037
204000                                                                  20400037
204100     EXEC SQL                                                     20410037
204200        SELECT TENTNME.ENT_ID                                     20420037
204300              ,TENTNME.ENT_NAME_DESC                              20430037
204400         INTO  :ENTNME-ENT-ID                                     20440037
204500              ,:ENTNME-ENT-NAME-DESC                              20450037
204600         FROM  TEXTENT                                            20460037
204700              ,TENTNME                                            20470037
204800        WHERE  DUN_NBR          = :RV050-VENDOR-DUNS-NBR          20480037
204900          AND  TENTNME.ENT_ID   = TEXTENT.ENT_ID                  20490037
205000          AND  TENTNME.TYPE_CDE = :PC-01                          20500037
205100     END-EXEC.                                                    20510037
205200                                                                  20520037
205300     EVALUATE TRUE                                                20530037
205400         WHEN SQLCODE = ZERO                                      20540037
205500             SET PS-DUNS-VALID-YES  TO TRUE                       20550037
205600         WHEN SQLCODE = +100                                      20560037
205700             CONTINUE                                             20570037
205800                                                                  20580037
205900         WHEN SQLWARN0 NOT EQUAL SPACE                            20590037
206000         WHEN (SQLCODE NOT EQUAL ZERO AND                         20600037
206100               SQLCODE NOT EQUAL 100)                             20610037
206200             DISPLAY '**************************************'     20620037
206300             DISPLAY '** ABEND                            **'     20630037
206400             DISPLAY '** PROGRAM = RVKUP002               **'     20640037
206500             DISPLAY '** PARAGRAPH = 2225-VALIDATE-DUNS-NBR*'     20650037
206600             DISPLAY '** SELECT FROM TENTNME & TEXTENT    **'     20660037
206700             DISPLAY '** HDR DFCT ORD ID: ' RV050-DFCT-ORD-ID     20670037
206800             DISPLAY '** VENDOR-DUNS-NBR: ' RV050-VENDOR-DUNS-NBR 20680037
206900             DISPLAY '**************************************'     20690037
207000             PERFORM 9100-SQL-ABEND                               20700037
207100     END-EVALUATE.                                                20710037
207200                                                                  20720037
207300******************************************************************20730037
207400* VALIDATE THE SCAC ON TEXTENT                                    20740037
207500******************************************************************20750037
207600 2250-VALIDATE-SCAC.                                              20760037
207700                                                                  20770037
207800     SET PS-SCAC-VALID-NO  TO TRUE.                               20780037
207900                                                                  20790037
208000     EXEC SQL                                                     20800037
208100        SELECT ENT_ID                                             20810037
208200         INTO  :EXTENT-ENT-ID                                     20820037
208300         FROM  TEXTENT                                            20830037
208400        WHERE  SCAC_CDE         = :RV050-SCAC-CDE                 20840037
208500          AND  CARRIER_IND      = :PC-Y                           20850037
208600     END-EXEC.                                                    20860037
208700                                                                  20870037
208800     EVALUATE TRUE                                                20880037
208900         WHEN SQLCODE = ZERO                                      20890037
209000             SET PS-SCAC-VALID-YES  TO TRUE                       20900037
209010         WHEN SQLCODE = +100                                      20901049
209011             DISPLAY 'RVKUP002-ORDER ID ' RV050-DFCT-ORD-ID       20901150
209012             DISPLAY 'SCAC UPDATED FROM ' RV050-SCAC-CDE          20901250
209020             MOVE 'MISC' TO RV050-SCAC-CDE                        20902049
209030             SET PS-SCAC-VALID-YES  TO TRUE                       20903049
209200         WHEN SQLWARN0 NOT EQUAL SPACE                            20920037
209300         WHEN (SQLCODE NOT EQUAL ZERO AND                         20930037
209400               SQLCODE NOT EQUAL 100)                             20940037
209500             DISPLAY '**************************************'     20950037
209600             DISPLAY '** ABEND                            **'     20960037
209700             DISPLAY '** PROGRAM = RVKUP002               **'     20970037
209800             DISPLAY '** PARAGRAPH = 2250-VALIDATE-SCAC   **'     20980037
209900             DISPLAY '** SELECT FROM TEXTENT              **'     20990037
210000             DISPLAY '** HDR DFCT ORD ID: ' RV050-DFCT-ORD-ID     21000037
210100             DISPLAY '** VENDOR-DUNS-NBR: ' RV050-SCAC-CDE        21010037
210200             DISPLAY '**************************************'     21020037
210300             PERFORM 9100-SQL-ABEND                               21030037
210400     END-EVALUATE.                                                21040037
210500                                                                  21050037
210600******************************************************************21060037
210700* EDIT THE DETAIL REC FOR VALID DATES, NUMERICS & REQUIRED FIELDS 21070037
210800******************************************************************21080037
210900 2300-EDIT-DTL-REC.                                               21090037
211000                                                                  21100037
211100     SET PS-DTL-CRITICAL-ERR-NO TO TRUE.                          21110037
211200                                                                  21120037
211300     INITIALIZE PV-TBL-DTL-ROW (DTL-INDEX).                       21130037
211400                                                                  21140037
211500*RETURN TYPE IS CHECKED EARLIER ON THE HEADER RECORD AND A        21150037
211600*CRITICAL ERROR IS WRITTEN AT THAT TIME. THIS STOPS PROCESSING    21160037
211700*OF THE ENTIRE DEFECTIVE ORDER ID. THEREFORE, THE FOLLOWING       21170037
211800*IF STATEMENT SHOULD ALWAYS FIND AN 'R', 'M' OR 'D' AND ERRORS    21180037
211900*AREN'T WRITTEN FOR DETAILS WITH A DIFFERENT CODE.                21190037
212000                                                                  21200037
212100     IF RV051-DTL-RETURN-TYPE =  PC-M OR                          21210037
212200        RV051-DTL-RETURN-TYPE =  PC-R OR                          21220037
212300        RV051-DTL-RETURN-TYPE =  PC-D                             21230037
212400        MOVE RV051-DTL-RETURN-TYPE TO                             21240037
212500             TBL-DTL-RETURN-TYPE (DTL-INDEX)                      21250037
212600     ELSE MOVE SPACE TO                                           21260037
212700             TBL-DTL-RETURN-TYPE (DTL-INDEX)                      21270037
212800     END-IF.                                                      21280037
212900                                                                  21290037
213000**DFCT-ORD-ID MUST BE > 0                                         21300037
213100     IF RV051-DFCT-ORD-ID = 0                                     21310037
213200        SET PS-DTL-DFCT-ORD-ID-ZERO                               21320037
213300            PS-DTL-CRITICAL-ERR-YES                               21330037
213400            RV019-CRITICAL          TO TRUE                       21340037
213500        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        21350037
213600        SET PS-CONTINUE-THIS-REC-NO TO TRUE                       21360037
213700     ELSE                                                         21370037
213800**DFCT-ORD-ID MUST NUMERIC                                        21380037
213900        IF RV051-DFCT-ORD-ID NOT NUMERIC                          21390037
214000           SET PS-DTL-DFCT-ORD-ID-NON-NUM                         21400037
214100               PS-DTL-CRITICAL-ERR-YES                            21410037
214200               RV019-CRITICAL        TO TRUE                      21420037
214300           PERFORM 7001-INSERT-DTL-TO-ERR-TBL                     21430037
214400           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    21440037
214500        ELSE                                                      21450037
214600           MOVE RV051-DFCT-ORD-ID TO TBL-DFCT-ORD-ID (DTL-INDEX)  21460037
214700        END-IF                                                    21470037
214800     END-IF.                                                      21480037
214900                                                                  21490037
215000**SEQ-NBR MUST BE > 0                                             21500037
215100     IF RV051-SEQ-NBR = 0                                         21510037
215200        SET PS-SEQ-NBR-ZERO                                       21520037
215300            PS-DTL-CRITICAL-ERR-YES                               21530037
215400            RV019-CRITICAL  TO TRUE                               21540037
215500        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        21550037
215600        SET PS-CONTINUE-THIS-REC-NO TO TRUE                       21560037
215700     ELSE                                                         21570037
215800**SEQ-NBR MUST BE NUMERIC                                         21580037
215900        IF RV051-SEQ-NBR NOT NUMERIC                              21590037
216000           SET PS-SEQ-NBR-NOT-NUM                                 21600037
216100           PS-DTL-CRITICAL-ERR-YES                                21610037
216200           RV019-CRITICAL   TO TRUE                               21620037
216300           PERFORM 7001-INSERT-DTL-TO-ERR-TBL                     21630037
216400           SET PS-CONTINUE-THIS-REC-NO TO TRUE                    21640037
216500        ELSE                                                      21650037
216600           MOVE RV051-SEQ-NBR  TO TBL-SEQ-NBR (DTL-INDEX)         21660037
216700        END-IF                                                    21670037
216800     END-IF.                                                      21680037
216900                                                                  21690037
217000*             IF RV051-SKU = '05281130'                           21700037
217100*                DISPLAY 'RV051-SKU: ' RV051-SKU                  21710037
217200*             END-IF                                              21720037
217300**SKU CANNOT BE BLANK                                             21730037
217400     IF RV051-SKU EQUAL PC-SPACE                                  21740037
217500        SET PS-SKU-BLANK                                          21750037
217600            PS-DTL-CRITICAL-ERR-YES                               21760037
217700            RV019-CRITICAL TO TRUE                                21770037
217800        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        21780037
217900        SET PS-CONTINUE-THIS-REC-NO TO TRUE                       21790037
218000     ELSE                                                         21800037
218100**SKU CAN BE A DUMMY (LAST THREE SKU DIGITS ARE ZEROES)           21810037
218200       MOVE RV051-SKU TO PV-SKU-REDEFINE                          21820037
218300         IF PV-INPUT-SKU-SEQ = PC-DUMMY-SKU-IND                   21830037
218400           MOVE ZEROS TO TBL-DFCT-ITEM-NBR (DTL-INDEX)            21840037
218500         ELSE                                                     21850037
218600           PERFORM 2325-VALIDATE-SKU                              21860037
218700           IF XL001-SKU-SQLCODE = +100                            21870037
218800             SET PS-SKU-CANNOT-BE-VALIDATED                       21880037
218900                 PS-DTL-CRITICAL-ERR-YES                          21890037
219000                 RV019-CRITICAL        TO TRUE                    21900037
219100             PERFORM 7001-INSERT-DTL-TO-ERR-TBL                   21910037
219200             SET PS-CONTINUE-THIS-REC-NO TO TRUE                  21920037
219300           ELSE                                                   21930037
219400**MOVE ITEM NUMBER FROM CALLED PROGRAM TO INTERNAL TABLE          21940037
219500              MOVE XL001-ITM-NBR TO TBL-DFCT-ITEM-NBR (DTL-INDEX) 21950037
219600           END-IF                                                 21960037
219700         END-IF                                                   21970037
219800         PERFORM 2315-VALIDATE-DEPT-CLS                           21980037
219900         IF PS-DEPT-CLS-VALID-YES                                 21990037
220000**THIS REFORMATTING PARSES THE DEPT FROM CHAR10 TO CHAR03         22000037
220100            MOVE RV051-DEPT-NBR  TO PV-DEPT-REDEFINE              22010037
220200            MOVE PV-INPUT-DEPT TO TBL-MDSE-DEPT-NBR (DTL-INDEX)   22020037
220300**    !!!!!!!!!   IMPORTANT NOTE: !!!!!!!!!!!!!!!                 22030037
220400*     EVEN THOUGH TDFMEIT.MDSE_CLASS_NBR SAYS "CLASS", IT IS      22040037
220500*     REALLY LOADED WITH THE SUB CLASS - THIS WAS THIS WAY        22050037
220600*     BEFORE THE GENCO PROJECT. HERE PV-INPUT-SUBCLASS IS         22060037
220700*     MOVED TO THE INTERNAL TABLE CLASS FIELD                     22070037
220800*     !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!                 22080037
220900**THIS REFORMATTING PARSES THE SUBCLASS FROM CHAR10 TO CHAR02     22090037
221000            MOVE RV051-SUB-CLASS-NBR TO PV-SUBCLASS-REDEFINE      22100037
221100            MOVE PV-INPUT-SUBCLASS   TO                           22110037
221200                                TBL-MDSE-CLASS-NBR (DTL-INDEX)    22120037
221300         ELSE                                                     22130037
221400           SET PS-INVALID-DEPT-SUBCLASS                           22140037
221500               PS-DTL-CRITICAL-ERR-YES                            22150037
221600               RV019-CRITICAL        TO TRUE                      22160037
221700            PERFORM 7001-INSERT-DTL-TO-ERR-TBL                    22170037
221800            SET PS-CONTINUE-THIS-REC-NO TO TRUE                   22180037
221900         END-IF                                                   22190037
222000     END-IF.                                                      22200037
222100                                                                  22210037
222200**DFCT-RET-DTE CHECK - (USE DEFAULT IF NOT VALID)                 22220037
222300     MOVE RV051-DFCT-RET-DTE TO PV-CCYYMMDD-CHECK.                22230037
222400     PERFORM 2900-KOHLS-CALENDAR-ROUTINE.                         22240037
222500                                                                  22250037
222600     IF PS-DATE-IS-VALID-YES                                      22260037
222700        MOVE RV051-DFCT-RET-DTE TO TBL-DFCT-RET-DTE (DTL-INDEX)   22270037
222800     ELSE                                                         22280037
222900        SET PS-DFCT-RET-DTE-INVALID                               22290037
223000            RV019-WARNING           TO TRUE                       22300037
223100        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        22310037
223200        MOVE PC-DEFAULT-DATE TO TBL-DFCT-RET-DTE (DTL-INDEX)      22320037
223300     END-IF.                                                      22330037
223400                                                                  22340037
223500**RTL-COST-AMT MUST BE > 0                                        22350037
223600     IF RV051-RTL-COST-AMT = 0                                    22360037
223700        SET PS-RTL-COST-AMT-ZERO                                  22370037
223800            PS-DTL-CRITICAL-ERR-YES                               22380037
223900            RV019-CRITICAL       TO TRUE                          22390037
224000        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        22400037
224100        SET PS-CONTINUE-THIS-REC-NO TO TRUE                       22410037
224200     ELSE                                                         22420037
224300        MOVE RV051-RTL-COST-AMT TO TBL-RTL-COST-AMT (DTL-INDEX)   22430037
224400     END-IF.                                                      22440037
224500                                                                  22450037
224600**RTL-COST-AMT MUST BE NUMERIC                                    22460037
224700     IF RV051-RTL-COST-AMT IS NUMERIC                             22470037
224800        CONTINUE                                                  22480037
224900     ELSE                                                         22490037
225000        SET PS-RTL-COST-AMT-NON-NUM                               22500037
225100            PS-DTL-CRITICAL-ERR-YES                               22510037
225200            RV019-CRITICAL          TO TRUE                       22520037
225300        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        22530037
225400        SET PS-CONTINUE-THIS-REC-NO TO TRUE                       22540037
225500     END-IF.                                                      22550037
225600                                                                  22560037
225700**UNIT-COST-AMT MUST BE NUMERIC                                   22570037
225800     IF RV051-UNIT-COST-AMT NUMERIC                               22580037
225900        MOVE RV051-UNIT-COST-AMT TO TBL-UNIT-COST-AMT (DTL-INDEX) 22590037
226000     ELSE                                                         22600037
226100        SET PS-UNIT-COST-AMT-NOT-NUM                              22610037
226200            RV019-WARNING            TO TRUE                      22620037
226300        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        22630037
226400        MOVE 0 TO TBL-UNIT-COST-AMT (DTL-INDEX)                   22640037
226500     END-IF.                                                      22650037
226600                                                                  22660037
226700**GENCO SHOULD SEND ZERO IN THE MKOUT-ORD-ID FOR DTLS THAT ARE    22670037
226800**NOT RETURNS (RETURN-TYP = 'R') AND NOT D&D'S (RETURN-TYP = 'D') 22680037
226900     IF RV050-RETURN-TYPE EQUAL PC-R                              22690037
227000     OR RV050-RETURN-TYPE EQUAL PC-D                              22700037
227100        MOVE RV051-MKOUT-ORD-ID TO TBL-MKOUT-ORD-ID (DTL-INDEX)   22710037
227200     END-IF.                                                      22720037
227300                                                                  22730037
227400**MKOUT-ORD-STAT-CDE MUST BE 'S' AND IS REQUIRED FOR 'MOS' RETURNS22740037
227500     IF RV050-RETURN-TYPE EQUAL PC-M                              22750037
227600     AND RV051-MKOUT-ORD-STAT-CDE NOT EQUAL  PC-S                 22760037
227700        SET PS-MKOUT-ORD-STAT-CDE-MISSING                         22770037
227800            RV019-WARNING                 TO TRUE                 22780037
227900        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        22790037
228000        MOVE PC-S TO TBL-MKOUT-ORD-STAT-CDE (DTL-INDEX)           22800037
228100     ELSE                                                         22810037
228200        IF RV050-RETURN-TYPE EQUAL PC-M                           22820037
228300           MOVE PC-S TO TBL-MKOUT-ORD-STAT-CDE (DTL-INDEX)        22830037
228400        ELSE                                                      22840037
228500           IF (RV050-RETURN-TYPE EQUAL PC-D OR                    22850037
228600                 RV050-RETURN-TYPE EQUAL PC-R)                    22860037
228700               MOVE PC-SPACE TO TBL-MKOUT-ORD-STAT-CDE (DTL-INDEX)22870037
228800           END-IF                                                 22880037
228900        END-IF                                                    22890037
229000     END-IF.                                                      22900037
229100                                                                  22910037
229200**DEPT-NBR CANNOT BE BLANK                                        22920037
229300     IF RV051-DEPT-NBR EQUAL PC-SPACE                             22930037
229400        SET PS-DEPT-NBR-BLANK                                     22940037
229500            PS-DTL-CRITICAL-ERR-YES                               22950037
229600            RV019-CRITICAL    TO TRUE                             22960037
229700        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        22970037
229800        SET PS-CONTINUE-THIS-REC-NO TO TRUE                       22980037
229900     END-IF.                                                      22990037
230000                                                                  23000037
230100**SUB-CLASS-NBR CANNOT BE BLANK                                   23010037
230200     IF RV051-SUB-CLASS-NBR EQUAL PC-SPACE                        23020037
230300        SET PS-SUB-CLASS-NBR-BLANK                                23030037
230400            PS-DTL-CRITICAL-ERR-YES                               23040037
230500            RV019-CRITICAL         TO TRUE                        23050037
230600        PERFORM 7001-INSERT-DTL-TO-ERR-TBL                        23060037
230700        SET PS-CONTINUE-THIS-REC-NO TO TRUE                       23070037
230800     END-IF.                                                      23080037
230900                                                                  23090037
231000**LOC-NBR MUST BE NUMERIC IF SENT                                 23100037
231100     IF RV051-LOC-NBR (1:4) IS NUMERIC                            23110037
231200        MOVE RV051-LOC-NBR (1:4) TO TBL-LOC-NBR (DTL-INDEX)       23120037
231300     ELSE                                                         23130037
231400        MOVE 0 TO TBL-LOC-NBR (DTL-INDEX)                         23140037
231500     END-IF.                                                      23150037
231600                                                                  23160037
231700*    IF PS-HDR-CRITICAL-ERR-NO AND                                23170037
231800*       PS-DTL-CRITICAL-ERR-NO                                    23180037
231900*        CONTINUE                                                 23190037
232000*    ELSE                                                         23200037
232100*       PERFORM 7015-SUM-ERROR-VALUES                             23210037
232200*    END-IF.                                                      23220037
232300                                                                  23230037
232400******************************************************************23240037
232500* VALIDATE THE DUMMY SKU DEPT AND SUBCLASS SENT FROM GENCO - WE  *23250037
232600* SEND THEM THE DATA AND THEY S/B SENDING IT BACK - BUT VALIDATE *23260037
232700* THEIR FORMATTING AND ACCURACY.                                 *23270037
232800******************************************************************23280037
232900 2315-VALIDATE-DEPT-CLS.                                          23290037
233000                                                                  23300037
233100     SET PS-DEPT-CLS-VALID-NO TO TRUE.                            23310037
233200                                                                  23320037
233300**THIS REFORMATTING PARSES THE DEPT FROM CHAR10, THEN MOVES       23330037
233400**CHAR03 TO NUM03, THEN MOVES NUM03 TO COMP3.                     23340037
233500     MOVE RV051-DEPT-NBR          TO PV-DEPT-REDEFINE.            23350037
233600     MOVE PV-INPUT-DEPT           TO PV-INPUT-DEPT-9.             23360037
233700     MOVE PV-INPUT-DEPT-9         TO PV-INPUT-DEPT-COMP3.         23370037
233800                                                                  23380037
233900**THIS REFORMATTING PARSES THE SUBCLASS FROM CHAR10, THEN MOVES   23390037
234000**CHAR02 TO NUM02, THEN MOVES NUM02 TO COMP3.                     23400037
234100     MOVE RV051-SUB-CLASS-NBR     TO PV-SUBCLASS-REDEFINE.        23410037
234200     MOVE PV-INPUT-SUBCLASS       TO PV-INPUT-SUBCLASS-9.         23420037
234300     MOVE PV-INPUT-SUBCLASS-9     TO PV-INPUT-SUBCLASS-COMP3.     23430037
234400                                                                  23440037
234500*    DISPLAY '**************BEFORE**********************'         23450037
234600*    DISPLAY '*PARAGRAPH = 2315-VALIDATE-DEPT-CLS'                23460037
234700*    DISPLAY '*RV050-DFCT-ORD-ID       =' RV050-DFCT-ORD-ID       23470037
234800*    DISPLAY '*RV051-DFCT-ORD-ID       =' RV051-DFCT-ORD-ID       23480037
234900*    DISPLAY '*RV051-DEPT-NBR          =' RV051-DEPT-NBR          23490037
235000*    DISPLAY '*PV-DEPT-REDEFINE        =' PV-DEPT-REDEFINE        23500037
235100*    DISPLAY '*PV-INPUT-DEPT           =' PV-INPUT-DEPT           23510037
235200*    DISPLAY '*PV-INPUT-DEPT-9         =' PV-INPUT-DEPT-9         23520037
235300*    DISPLAY '*PV-INPUT-DEPT-COMP3     =' PV-INPUT-DEPT-COMP3     23530037
235400*    DISPLAY '*RV051-SUB-CLASS-NBR     =' RV051-SUB-CLASS-NBR     23540037
235500*    DISPLAY '*PV-SUBCLASS-REDEFINE    =' PV-SUBCLASS-REDEFINE    23550037
235600*    DISPLAY '*PV-INPUT-SUBCLASS       =' PV-INPUT-SUBCLASS       23560037
235700*    DISPLAY '*PV-INPUT-SUBCLASS-9     =' PV-INPUT-SUBCLASS-9     23570037
235800*    DISPLAY '*PV-INPUT-SUBCLASS-COMP3 =' PV-INPUT-SUBCLASS-COMP3 23580037
235900*    DISPLAY '******************************************'         23590037
236000                                                                  23600037
236100     EXEC SQL                                                     23610037
236200         SELECT  DEPT_NBR                                         23620037
236300              ,  SUB_CL_NBR                                       23630037
236400           INTO  :XLT00023-DEPT-NBR                               23640037
236500              ,  :XLT00023-SUB-CL-NBR                             23650037
236600         FROM  XLT_SUB_CL                                         23660037
236700          WHERE (DEPT_NBR   =  :PV-INPUT-DEPT-COMP3               23670037
236800            AND  SUB_CL_NBR =  :PV-INPUT-SUBCLASS-COMP3)          23680037
236900     END-EXEC.                                                    23690037
237000                                                                  23700037
237100     EVALUATE TRUE                                                23710037
237200         WHEN SQLCODE = +0                                        23720037
237300         WHEN SQLCODE = -811                                      23730037
237400              SET PS-DEPT-CLS-VALID-YES TO TRUE                   23740037
237500         WHEN SQLCODE = +100                                      23750037
237600              CONTINUE                                            23760037
237700         WHEN SQLWARN0 NOT EQUAL SPACE                            23770037
237800         WHEN SQLCODE NOT EQUAL ZERO                              23780037
237900             DISPLAY '******************************************' 23790037
238000             DISPLAY '** ABEND                                **' 23800037
238100             DISPLAY '** PROGRAM = RVKUP002                   **' 23810037
238200             DISPLAY '** PARAGRAPH = 2315-VALIDATE-DEPT-CLS'      23820037
238300             DISPLAY '** DEPT_NBR   =  '  XLT00023-DEPT-NBR       23830037
238400             DISPLAY '** SUB_CL_NBR =  '  XLT00023-SUB-CL-NBR     23840037
238500             DISPLAY '** CHECKING DUMMY SKU DEPT & SUBCLASS   **' 23850037
238600             DISPLAY '******************************************' 23860037
238700             PERFORM 9100-SQL-ABEND                               23870037
238800     END-EVALUATE.                                                23880037
238900*         DISPLAY '*******AFTER******************************'    23890037
239000*         DISPLAY '** SQLCODE    =  '  SQLCODE                    23900037
239100*         DISPLAY '** DEPT_NBR   =  '  XLT00023-DEPT-NBR          23910037
239200*         DISPLAY '** SUB_CL_NBR =  '  XLT00023-SUB-CL-NBR        23920037
239300*         DISPLAY '*RV050-DFCT-ORD-ID       =' RV050-DFCT-ORD-ID  23930037
239400*         DISPLAY '*RV051-DFCT-ORD-ID       =' RV051-DFCT-ORD-ID  23940037
239500*            DISPLAY '******************************************'.23950037
239600                                                                  23960037
239700******************************************************************23970037
239800* CALL MODULE XLKUT001 TO VALIDATE THE SKU AND GET DEPT, SUB CLASS23980037
239900******************************************************************23990037
240000 2325-VALIDATE-SKU.                                               24000037
240100                                                                  24010037
240200     INITIALIZE XL001-ITEM-COMMAREA.                              24020037
240300                                                                  24030037
240400     MOVE RV051-SKU (1:8)      TO XL001-KEY-SKU.                  24040037
240500                                                                  24050037
240600     SET  XL001-BY-NUMERIC-SKU                                    24060037
240700          XL001-SELECT-SKU TO TRUE.                               24070037
240800                                                                  24080037
240900     CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               24090037
241000                                                                  24100037
241100     EVALUATE TRUE                                                24110037
241200                                                                  24120037
241300      WHEN XL001-SKU-SQLCODE = +0                                 24130037
241400        CONTINUE                                                  24140037
241500                                                                  24150037
241600      WHEN XL001-SKU-SQLCODE = +100                               24160037
241700        CONTINUE                                                  24170037
241800                                                                  24180037
241900      WHEN XL001-SKU-CONTENTION                                   24190037
242000        MOVE '2325-VALIDATE-SKU'                                  24200037
242100                               TO PV-PARAGRAPH-NAME               24210037
242200        MOVE 'XL001-SKU-CONTENTION'                               24220037
242300                               TO PV-ABEND-MESSAGE                24230037
242400        MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                      24240037
242500        MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME                24250037
242600        PERFORM 9100-SQL-ABEND                                    24260037
242700                                                                  24270037
242800      WHEN OTHER                                                  24280037
242900        MOVE '2325-VALIDATE-SKU'                                  24290037
243000                               TO PV-PARAGRAPH-NAME               24300037
243100        MOVE 'SELECT ROW FROM XLV_SKU'                            24310037
243200                               TO PV-ABEND-MESSAGE                24320037
243300        MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                      24330037
243400        MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME                24340037
243500        PERFORM 9100-SQL-ABEND                                    24350037
243600                                                                  24360037
243700     END-EVALUATE.                                                24370037
243800                                                                  24380037
243900******************************************************************24390037
244000* THIS IS PERFORMED AT EACH COMMIT INTERVAL.                      24400037
244100******************************************************************24410037
244200 2500-CHCKPT-LOGIC.                                               24420037
244300                                                                  24430037
244400*SAVE DATA FOR RESTART                                            24440037
244500     PERFORM 6580-SAVE-DATA-FOR-RESTART.                          24450037
244600                                                                  24460037
244700*CHECKPOINT UPDATES                                               24470037
244800     PERFORM 6590-UPDATE-TCKRSTINF.                               24480037
244900                                                                  24490037
245000*COMMIT                                                           24500037
245100     PERFORM 6600-COMMIT.                                         24510037
245200                                                                  24520037
245300*SET A NEW COMMIT TIMESTAMP MARKER                                24530037
245400     PERFORM 2800-SET-COMMIT-TIMESTAMP.                           24540037
245500                                                                  24550037
245600*USE THIS TO OBTAIN THE LAST COMMITED MKOUT-ORD-ID FOR MOS RECS.  24560037
245700     SET PS-CALC-NEW-MKOUT-ORD-ID-YES TO TRUE.                    24570037
245800                                                                  24580037
245900******************************************************************24590037
246000* THIS WILL INITIALIZE THE WORKING STORAGE DESC TEXT THAT IS      24600037
246100* UPDATED DURING A NORMAL PROGRAM RUN AND USED TO RESTART IN CASE 24610037
246200* OF AN ABEND. THIS PARAGRAPH IS ONLY EXECUTED DURING A NORMAL RUN24620037
246300******************************************************************24630037
246400 2600-INITIALIZE-TCKRSTINF.                                       24640037
246500                                                                  24650037
246600      MOVE ZEROES      TO CKPT-RESTART-INFO.                      24660037
246700                                                                  24670037
246800******************************************************************24680037
246900* SET THE COMMIT TIMESTAMP BY GETTING THE CURRENT TIMESTAMP PLUS  24690037
247000* THE NUMBER OF SECONDS DETERMINED IN THE CHECKPOINT TABLE. WHEN  24700037
247100* IT IS TIME TO DO A CHECKPOINT CHECK, IF THE CURRENT TIMESTAMP   24710037
247200* IS GREATER THAN THE PV-HOLD-TIMESTAMP, THEN IT IS COMMIT TIME.  24720037
247300******************************************************************24730037
247400 2700-CHECKPOINT-CHECK.                                           24740037
247500                                                                  24750037
247600      EXEC SQL                                                    24760037
247700        SET :PV-TMST = CURRENT TIMESTAMP                          24770037
247800      END-EXEC.                                                   24780037
247900                                                                  24790037
248000     EVALUATE TRUE                                                24800037
248100         WHEN SQLCODE = ZERO                                      24810037
248200             CONTINUE                                             24820037
248300                                                                  24830037
248400         WHEN SQLWARN0 NOT EQUAL SPACE                            24840037
248500         WHEN SQLCODE NOT EQUAL ZERO                              24850037
248600             DISPLAY '**************************************'     24860037
248700             DISPLAY '** ABEND                            **'     24870037
248800             DISPLAY '** PROGRAM = RVKUP002               **'     24880037
248900             DISPLAY '** PARAGRAPH = 2700-CHECKPOINT-CHECK**'     24890037
249000             DISPLAY '** GET DB2 CURRENT TIMESTAMP        **'     24900037
249100             DISPLAY '** HDR DFCT ORD ID: ' RV050-DFCT-ORD-ID     24910037
249200             DISPLAY '**************************************'     24920037
249300             PERFORM 9100-SQL-ABEND                               24930037
249400     END-EVALUATE.                                                24940037
249500                                                                  24950037
249600******************************************************************24960037
249700* SET THE COMMIT TIMESTAMP BY GETTING THE CURRENT TIMESTAMP PLUS  24970037
249800* THE NUMBER OF SECONDS DETERMINED IN THE CHECKPOINT TABLE. WHEN  24980037
249900* IT IS TIME TO DO A CHECKPOINT CHECK, IF THE CURRENT TIMESTAMP   24990037
250000* IS GREATER THAN THE PV-HOLD-TIMESTAMP, THEN IT IS COMMIT TIME.  25000037
250100******************************************************************25010037
250200 2800-SET-COMMIT-TIMESTAMP.                                       25020037
250300                                                                  25030037
250400      EXEC SQL                                                    25040037
250500          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    25050037
250600          INTO :PV-HOLD-TMST                                      25060037
250700          FROM TCKRSTCNTL                                         25070037
250800          WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME              25080037
250900            AND JOB_NAME  = :CC-JOB-NAME                          25090037
251000      END-EXEC.                                                   25100037
251100                                                                  25110037
251200     EVALUATE TRUE                                                25120037
251300         WHEN SQLCODE = ZERO                                      25130037
251400             CONTINUE                                             25140037
251500                                                                  25150037
251600         WHEN SQLWARN0 NOT EQUAL SPACE                            25160037
251700         WHEN SQLCODE NOT EQUAL ZERO                              25170037
251800             DISPLAY '**************************************'     25180037
251900             DISPLAY '** ABEND                            **'     25190037
252000             DISPLAY '** PROGRAM = RVKUP002               **'     25200037
252100             DISPLAY '** PARAGRAPH = 2800-SET-COMMIT-TIMESTAMP'   25210037
252200             DISPLAY '** SELECT FROM TCKRSTCNTL           **'     25220037
252300             DISPLAY '** HDR DFCT ORD ID: ' RV050-DFCT-ORD-ID     25230037
252400             DISPLAY '**************************************'     25240037
252500             PERFORM 9100-SQL-ABEND                               25250037
252600     END-EVALUATE.                                                25260037
252700                                                                  25270037
252800******************************************************************25280037
252900*                                                                 25290037
253000*                                                                 25300037
253100******************************************************************25310037
253200 2900-KOHLS-CALENDAR-ROUTINE.                                     25320037
253300                                                                  25330037
253400     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              25340037
253500                                                                  25350037
253600     SET DPG51-ACTUAL-CALENDAR-ONLY                               25360037
253700         DPG52-LK-DTE-ISO-FMT                                     25370037
253800         PS-DATE-IS-VALID-NO        TO TRUE.                      25380037
253900                                                                  25390037
254000     MOVE PV-CCYYMMDD-CHECK         TO DPG52-LK-DATE-INPUT.       25400037
254100                                                                  25410037
254200     CALL DP500-KOHLS-CALENDAR-ROUTINE                            25420037
254300          USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              25430037
254400                                                                  25440037
254500     EVALUATE TRUE                                                25450037
254600        WHEN DPG54-NO-ERROR                                       25460037
254700             SET PS-DATE-IS-VALID-YES  TO TRUE                    25470037
254800        WHEN DPG54-ERROR-MESSAGE = PC-INVALID-DATE-RTN-MSG        25480037
254900             SET PS-DATE-IS-VALID-NO   TO TRUE                    25490037
255000        WHEN OTHER                                                25500037
255100             DISPLAY '**********************'                     25510037
255200             DISPLAY '  DATE ROUTINE ERROR  '                     25520037
255300             DISPLAY '**********************'                     25530037
255400             DISPLAY 'ERROR MESSAGE: ' DPG54-ERROR-MESSAGE        25540037
255500             DISPLAY 'DATE ENTERED : ' DPG52-LK-DATE-INPUT        25550037
255600             DISPLAY 'HDR DFCT-ORDID : ' RV050-DFCT-ORD-ID        25560037
255700             DISPLAY '**********************'                     25570037
255800             PERFORM 9200-NON-SQL-ABEND                           25580037
255900     END-EVALUATE.                                                25590037
256000                                                                  25600037
256100******************************************************************25610037
256200* READ THE RTV HEADER FILE                                       *25620037
256300******************************************************************25630037
256400 6000-READ-RTV-HDR-FILE.                                          25640037
256500                                                                  25650037
256600     READ RTV-HEADER-FILE                                         25660037
256700         INTO RV050-GENCO-RTV-HEADER-RECORD                       25670037
256800         AT END                                                   25680037
256900           SET PS-END-OF-HDR-INPUT-YES TO TRUE.                   25690037
257000                                                                  25700037
257100     IF PS-END-OF-HDR-INPUT-NO                                    25710037
257200        ADD +1  TO PA-TOT-RECS-READ                               25720037
257300                   PA-TOT-HDR-RECS-READ                           25730037
257400     END-IF.                                                      25740037
257500                                                                  25750037
257600**KEEP THIS SET TO YES UNTIL IT IS CERTAIN THE HDR DOES NOT EXIST 25760037
257700     SET PS-BYPASS-HDR-YES TO TRUE.                               25770037
257800                                                                  25780037
257900     MOVE RV050-RETURN-TYPE TO PV-LAST-HDR-RETURN-TYPE.           25790037
258000                                                                  25800037
258100******************************************************************25810037
258200* READ THE RTV DETAIL FILE                                       *25820037
258300******************************************************************25830037
258400 6001-READ-RTV-DTL-FILE.                                          25840037
258500                                                                  25850037
258600     READ RTV-DETAIL-FILE                                         25860037
258700         INTO RV051-GENCO-RTV-DETAIL-RECORD                       25870037
258800         AT END                                                   25880037
258900           SET PS-END-OF-DTL-INPUT-YES TO TRUE.                   25890037
259000                                                                  25900037
259100     IF PS-END-OF-DTL-INPUT-NO                                    25910037
259200        ADD +1  TO PA-TOT-RECS-READ                               25920037
259300                   PA-TOT-DTL-RECS-READ                           25930037
259400**  RPK 12/16/2022  BEG                                           25940039
259500        IF RV051-DTL-RETURN-TYPE = PC-C                           25950039
259600           NEXT SENTENCE                                          25960039
259700        ELSE                                                      25970039
259800           IF  RV051-RTL-COST-AMT = ZERO                          25980039
259900               MOVE .01 TO RV051-RTL-COST-AMT                     25990040
260000               MOVE RV051-RTL-COST-AMT TO PV-DOLLAR-DISP          26000041
260100               MOVE RV051-UNIT-COST-AMT TO PV-DOLLAR-DISP2        26010041
260200               DISPLAY 'ZERO RETAIL CHANGED - '                   26020039
260300                       'ORDER: ' RV051-DFCT-ORD-ID                26030039
260400                       ' TYPE: ' RV051-DTL-RETURN-TYPE            26040039
260500                       ' SKU: ' RV051-SKU                         26050039
260600                       ' COST: ' PV-DOLLAR-DISP2                  26060041
260700                       ' NEW RTL: ' PV-DOLLAR-DISP                26070041
260800               ADD .01 TO PV-RTL-CHNG-AMT                         26080040
260900               ADD 1   TO PV-RTL-CHNG-COUNT                       26090040
261000        END-IF                                                    26100039
261100**  RPK 12/16/2022  END                                           26110039
261200        PERFORM 6005-TALLY-AND-SUM                                26120037
261300     END-IF.                                                      26130037
261400                                                                  26140037
261500******************************************************************26150037
261600**TALLY THE DTL RETURN-TYPES , COST AND RETAIL FIELDS             26160037
261700* FOR THE ENTIRE FILE                                             26170037
261800******************************************************************26180037
261900 6005-TALLY-AND-SUM.                                              26190037
262000                                                                  26200037
262100*    DISPLAY '**************************************'             26210037
262200*    DISPLAY '6005-TALLY-AND-SUM - GOT INTO CODE****'             26220037
262300*    DISPLAY '** PS-BYPASS-HDR-SW:' PS-BYPASS-HDR-SW              26230037
262400*    DISPLAY '** PS-END-OF-DTL-INPUT-SW:' PS-END-OF-DTL-INPUT-SW  26240037
262500*    DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID                 26250037
262600*    DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE             26260037
262700*    DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT                26270037
262800*    DISPLAY '** TOTAL RETAL: ' PA-TOT-DD-RTL-RCVD                26280037
262900*    DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT               26290037
263000*    DISPLAY '** TOTAL UNIT : ' PA-TOT-DD-UNT-RCVD                26300037
263100*    DISPLAY '**************************************'             26310037
263200                                                                  26320037
263300*    IF PS-BYPASS-HDR-NO                                          26330037
263400        IF RV051-DTL-RETURN-TYPE = PC-D                           26340037
263500         AND PS-END-OF-DTL-INPUT-NO                               26350037
263600           ADD +1  TO PA-TOT-DD-COUNT-RCVD                        26360037
263700*            DISPLAY '**************************************'     26370037
263800*            DISPLAY '***BEFORE*****************************'     26380037
263900*            DISPLAY '** PARAGRAPH = 6005-TALLY-AND-SUM*'         26390037
264000*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         26400037
264100*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     26410037
264200*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        26420037
264300*            DISPLAY '** TOTAL RETAL: ' PA-TOT-DD-RTL-RCVD        26430037
264400*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       26440037
264500*            DISPLAY '** TOTAL UNIT : ' PA-TOT-DD-UNT-RCVD        26450037
264600*            DISPLAY '**************************************'     26460037
264700           IF RV051-RTL-COST-AMT NUMERIC                          26470037
264800             COMPUTE PA-TOT-DD-RTL-RCVD =                         26480037
264900                     PA-TOT-DD-RTL-RCVD + RV051-RTL-COST-AMT      26490037
265000           END-IF                                                 26500037
265100                                                                  26510037
265200           IF RV051-UNIT-COST-AMT NUMERIC                         26520037
265300             COMPUTE PA-TOT-DD-UNT-RCVD =                         26530037
265400                     PA-TOT-DD-UNT-RCVD + RV051-UNIT-COST-AMT     26540037
265500           END-IF                                                 26550037
265600*            DISPLAY '**************************************'     26560037
265700*            DISPLAY '***AFTER******************************'     26570037
265800*            DISPLAY '** PARAGRAPH = 6005-TALLY-AND-SUM*'         26580037
265900*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         26590037
266000*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     26600037
266100*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        26610037
266200*            DISPLAY '** TOTAL RETAL: ' PA-TOT-DD-RTL-RCVD        26620037
266300*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       26630037
266400*            DISPLAY '** TOTAL UNIT : ' PA-TOT-DD-UNT-RCVD        26640037
266500*            DISPLAY '**************************************'     26650037
266600        END-IF                                                    26660037
266700                                                                  26670037
266800        IF RV051-DTL-RETURN-TYPE = PC-M                           26680037
266900         AND PS-END-OF-DTL-INPUT-NO                               26690037
267000           ADD +1  TO PA-TOT-MOS-COUNT-RCVD                       26700037
267100*            DISPLAY '**************************************'     26710037
267200*            DISPLAY '***BEFORE*****************************'     26720037
267300*            DISPLAY '** PARAGRAPH = 6005-TALLY-AND-SUM*'         26730037
267400*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         26740037
267500*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     26750037
267600*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        26760037
267700*            DISPLAY '** TOTAL RETAL: ' PA-TOT-MOS-RTL-RCVD       26770037
267800*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       26780037
267900*            DISPLAY '** TOTAL UNIT : ' PA-TOT-MOS-UNT-RCVD       26790037
268000*            DISPLAY '**************************************'     26800037
268100           IF RV051-RTL-COST-AMT NUMERIC                          26810037
268200             COMPUTE PA-TOT-MOS-RTL-RCVD =                        26820037
268300                   PA-TOT-MOS-RTL-RCVD + RV051-RTL-COST-AMT       26830037
268400           END-IF                                                 26840037
268500                                                                  26850037
268600           IF RV051-UNIT-COST-AMT NUMERIC                         26860037
268700             COMPUTE PA-TOT-MOS-UNT-RCVD =                        26870037
268800                   PA-TOT-MOS-UNT-RCVD + RV051-UNIT-COST-AMT      26880037
268900           END-IF                                                 26890037
269000*            DISPLAY '**************************************'     26900037
269100*            DISPLAY '***AFTER******************************'     26910037
269200*            DISPLAY '** PARAGRAPH = 6005-TALLY-AND-SUM*'         26920037
269300*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         26930037
269400*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     26940037
269500*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        26950037
269600*            DISPLAY '** TOTAL RETAL: ' PA-TOT-MOS-RTL-RCVD       26960037
269700*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       26970037
269800*            DISPLAY '** TOTAL UNIT : ' PA-TOT-MOS-UNT-RCVD       26980037
269900*            DISPLAY '**************************************'     26990037
270000        END-IF                                                    27000037
270100                                                                  27010037
270200        IF RV051-DTL-RETURN-TYPE = PC-R                           27020037
270300         AND PS-END-OF-DTL-INPUT-NO                               27030037
270400           ADD +1  TO PA-TOT-RTV-COUNT-RCVD                       27040037
270500*            DISPLAY '**************************************'     27050037
270600*            DISPLAY '***BEFORE*****************************'     27060037
270700*            DISPLAY '** PARAGRAPH = 6005-TALLY-AND-SUM*'         27070037
270800*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         27080037
270900*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     27090037
271000*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        27100037
271100*            DISPLAY '** TOTAL RETAL: ' PA-TOT-RTV-RTL-RCVD       27110037
271200*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       27120037
271300*            DISPLAY '** TOTAL UNIT : ' PA-TOT-RTV-UNT-RCVD       27130037
271400*            DISPLAY '**************************************'     27140037
271500                                                                  27150037
271600           IF RV051-RTL-COST-AMT NUMERIC                          27160037
271700             COMPUTE PA-TOT-RTV-RTL-RCVD =                        27170037
271800                     PA-TOT-RTV-RTL-RCVD + RV051-RTL-COST-AMT     27180037
271900           END-IF                                                 27190037
272000                                                                  27200037
272100           IF RV051-UNIT-COST-AMT NUMERIC                         27210037
272200             COMPUTE PA-TOT-RTV-UNT-RCVD =                        27220037
272300                     PA-TOT-RTV-UNT-RCVD + RV051-UNIT-COST-AMT    27230037
272400           END-IF                                                 27240037
272500*            DISPLAY '**************************************'     27250037
272600*            DISPLAY '***AFTER******************************'     27260037
272700*            DISPLAY '** PARAGRAPH = 6005-TALLY-AND-SUM*'         27270037
272800*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         27280037
272900*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     27290037
273000*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        27300037
273100*            DISPLAY '** TOTAL RETAL: ' PA-TOT-RTV-RTL-RCVD       27310037
273200*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       27320037
273300*            DISPLAY '** TOTAL UNIT : ' PA-TOT-RTV-UNT-RCVD       27330037
273400*            DISPLAY '**************************************'     27340037
273500        END-IF.                                                   27350037
273600*    END-IF.                                                      27360037
273700                                                                  27370037
273800******************************************************************27380037
273900* CHECK THE INPUT DFCT-ORD-ID AGAINST THE TDFCTOR TABLE TO SEE   *27390037
274000* IF IT ALREADY EXISTS.                                          *27400037
274100******************************************************************27410037
274200 6100-CHECK-HDR-DFCT-ORD-ID.                                      27420037
274300                                                                  27430037
274400     MOVE RV050-DFCT-ORD-ID TO DFCTOR-DFCT-ORD-ID.                27440037
274500                                                                  27450037
274600     EXEC SQL                                                     27460037
274700      SELECT DFCT_ORD_ID                                          27470037
274800       INTO :DFCTOR-DFCT-ORD-ID                                   27480037
274900       FROM TDFCTOR                                               27490037
275000       WHERE DFCT_ORD_ID = :DFCTOR-DFCT-ORD-ID                    27500037
275100     END-EXEC.                                                    27510037
275200                                                                  27520037
275300     EVALUATE TRUE                                                27530037
275400         WHEN SQLCODE = +0                                        27540037
275500              SET PS-HDR-EXISTS-YES TO TRUE                       27550037
275600         WHEN SQLCODE = +100                                      27560037
275700              SET PS-HDR-EXISTS-NO                                27570037
275800                  PS-BYPASS-HDR-NO TO TRUE                        27580037
275900         WHEN SQLWARN0 NOT EQUAL SPACE                            27590037
276000         WHEN SQLCODE NOT EQUAL ZERO                              27600037
276100             DISPLAY '******************************************' 27610037
276200             DISPLAY '** ABEND                                **' 27620037
276300             DISPLAY '** PROGRAM = RVKUP002                   **' 27630037
276400             DISPLAY '** PARAGRAPH = 6100-CHECK-HDR-DFCT-ORD-ID*' 27640037
276500             DISPLAY '** CHECKING IF ORD ID IS THERE ALREADY  **' 27650037
276600             DISPLAY '******************************************' 27660037
276700             PERFORM 9100-SQL-ABEND                               27670037
276800     END-EVALUATE.                                                27680037
276900                                                                  27690037
277000******************************************************************27700037
277100* SELECT CHECKPOINT RESTART CONTROL VALUE TO SEE IF THIS RUN     *27710037
277200* IS NORMAL (0) OR A RESTART (9).                                *27720037
277300******************************************************************27730037
277400 6500-GET-CHECKPOINT-CNTL.                                        27740037
277500                                                                  27750037
277600     EXEC SQL                                                     27760037
277700      SELECT CKPT_STAT_CODE                                       27770037
277800           , CKPT_FRQNCY_QTY                                      27780037
277900       INTO :PV-CKPT-STAT-CODE                                    27790037
278000           ,:TCKRSTCNTL-CKPT-FRQNCY-QTY                           27800037
278100       FROM TCKRSTCNTL                                            27810037
278200       WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                 27820037
278300         AND JOB_NAME  = :CC-JOB-NAME                             27830037
278400     END-EXEC.                                                    27840037
278500                                                                  27850037
278600     EVALUATE TRUE                                                27860037
278700         WHEN SQLWARN0 NOT EQUAL SPACE                            27870037
278800         WHEN SQLCODE NOT EQUAL ZERO                              27880037
278900             DISPLAY '******************************************' 27890037
279000             DISPLAY '** ABEND                                **' 27900037
279100             DISPLAY '** PROGRAM = RVKUP002                   **' 27910037
279200             DISPLAY '** PARAGRAPH = 6500-GET-CHECKPOINT-CNTL **' 27920037
279300             DISPLAY '** CHECKING IF RUN IS NORMAL OR RESTART **' 27930037
279400             DISPLAY '******************************************' 27940037
279500             PERFORM 9100-SQL-ABEND                               27950037
279600     END-EVALUATE.                                                27960037
279700                                                                  27970037
279800******************************************************************27980037
279900* CHECKPOINT-RESTART                                             *27990037
280000* RETRIEVE THE WORKING STORAGE FIELDS FROM THE DB2 TABLE, THEN   *28000037
280100* MOVE THE STORED ACCUMULATOR VALUES BACK TO WORKING STORAGE     *28010037
280200* BEFORE THE PROCESSING FOR THE RESTART CONTINUES. THIS IS DONE  *28020037
280300* SO THE REPORT STATISTICS IN THE SYSOUT ARE ACCURATE AFTER A    *28030037
280400* RESTART IS DONE, OTHERWISE THE SYSOUT WOULD ONLY REFLECT WHAT  *28040037
280500* WAS PROCESSED FROM THE RESTART POINT.                          *28050037
280600******************************************************************28060037
280700 6550-CHECKPOINT-RESTART.                                         28070037
280800                                                                  28080037
280900     PERFORM 6560-GET-CHECKPOINT-WK-STORG.                        28090037
281000     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.     28100037
281100                                                                  28110037
281200     PERFORM 6000-READ-RTV-HDR-FILE CR-TOT-HDR-RECS-READ TIMES.   28120037
281300** REMEMBER, THAT THE DTL FILE IS PROCESSED UNTIL THE DTL         28130037
281400** DFCT-ORD-ID IS > THE HDR DFCT-ORD-ID, SO IT IS 1 FARTHER AT    28140037
281500** THE TIME OF COMMIT - SO SUBTRACT THAT 1, THEN SPIN THE DTL FILE28150037
281600**                                                                28160037
281700** INTRODUCED THE CHECK FOR NOT CAUSING THE FIRST RECORD BEING    28170037
281800** SKIPPED FROM THE PROCESSING                                    28180037
281900**                                                                28190037
282000     IF CR-TOT-DTL-RECS-READ > ZERO                               28200037
282100        COMPUTE PV-NBR-DTLS-TO-PASS = (CR-TOT-DTL-RECS-READ - 1)  28210037
282200     END-IF.                                                      28220037
282300**                                                                28230037
282400     PERFORM 6001-READ-RTV-DTL-FILE PV-NBR-DTLS-TO-PASS TIMES.    28240037
282500                                                                  28250037
282600**ADJUSTMENT FOR 1 DTL REC                                        28260037
282700     MOVE CR-TOT-RECS-READ           TO PA-TOT-RECS-READ.         28270037
282800**                                                                28280037
282900** INTRODUCED THE CHECK FOR NOT DISPLAYING NEGATIVE VALUES        28290037
283000** IN THE SYSOUT                                                  28300037
283100**                                                                28310037
283200     IF CR-TOT-RECS-READ > ZERO                                   28320037
283300        COMPUTE PA-TOT-RECS-READ = (CR-TOT-RECS-READ - 1)         28330037
283400     END-IF.                                                      28340037
283500**                                                                28350037
283600     MOVE CR-TOT-HDR-RECS-READ       TO PA-TOT-HDR-RECS-READ.     28360037
283700     MOVE CR-TOT-HDR-INS             TO PA-TOT-HDR-INS.           28370037
283800     MOVE CR-TOT-HDRSTAT-INS         TO PA-TOT-HDRSTAT-INS.       28380037
283900     MOVE CR-TOT-DTL-RECS-READ       TO PA-TOT-DTL-RECS-READ.     28390037
284000**                                                                28400037
284100** INTRODUCED THE CHECK FOR NOT DISPLAYING NEGATIVE VALUES        28410037
284200** IN THE SYSOUT                                                  28420037
284300**                                                                28430037
284400     IF CR-TOT-DTL-RECS-READ > ZERO                               28440037
284500        COMPUTE PA-TOT-DTL-RECS-READ = (CR-TOT-DTL-RECS-READ - 1) 28450037
284600     END-IF.                                                      28460037
284700**                                                                28470037
284800     MOVE CR-TOT-DTL-INS             TO PA-TOT-DTL-INS.           28480037
284900     MOVE CR-TOT-DTLSTAT-INS         TO PA-TOT-DTLSTAT-INS.       28490037
285000     MOVE CR-TOT-SHIPT-INS           TO PA-TOT-SHIPT-INS.         28500037
285100     MOVE CR-TOT-SHIPTSTAT-INS       TO PA-TOT-SHIPTSTAT-INS.     28510037
285200     MOVE CR-TOT-MKOUT-ORD-ID-UPD    TO PA-TOT-MKOUT-ORD-ID-UPD.  28520037
285300     MOVE CR-TOT-HDRS-BYPASSED       TO PA-TOT-HDRS-BYPASSED.     28530037
285400     MOVE CR-TOT-CALLBACKS           TO PA-TOT-CALLBACKS.         28540037
285500     MOVE CR-CURRENT-MKOUT-ORD-ID    TO PV-CURRENT-MKOUT-ORD-ID.  28550037
285600     MOVE CR-TOT-COMMITS-TAKEN       TO PA-TOT-COMMITS-TAKEN.     28560037
285700     MOVE CR-TOT-RTV-COUNT-RCVD      TO PA-TOT-RTV-COUNT-RCVD.    28570037
285800     MOVE CR-TOT-MOS-COUNT-RCVD      TO PA-TOT-MOS-COUNT-RCVD.    28580037
285900     MOVE CR-TOT-DD-COUNT-RCVD       TO PA-TOT-DD-COUNT-RCVD.     28590037
286000     MOVE CR-TOT-RTV-RTL-RCVD        TO PA-TOT-RTV-RTL-RCVD.      28600037
286100     MOVE CR-TOT-MOS-RTL-RCVD        TO PA-TOT-MOS-RTL-RCVD.      28610037
286200     MOVE CR-TOT-DD-RTL-RCVD         TO PA-TOT-DD-RTL-RCVD.       28620037
286300     MOVE CR-TOT-RTV-UNT-RCVD        TO PA-TOT-RTV-UNT-RCVD.      28630037
286400     MOVE CR-TOT-MOS-UNT-RCVD        TO PA-TOT-MOS-UNT-RCVD.      28640037
286500     MOVE CR-TOT-DD-UNT-RCVD         TO PA-TOT-DD-UNT-RCVD.       28650037
286600     MOVE CR-TOT-RTV-COUNT-ERR       TO PA-TOT-RTV-COUNT-ERR.     28660037
286700     MOVE CR-TOT-MOS-COUNT-ERR       TO PA-TOT-MOS-COUNT-ERR.     28670037
286800     MOVE CR-TOT-DD-COUNT-ERR        TO PA-TOT-DD-COUNT-ERR.      28680037
286900     MOVE CR-TOT-RTV-RTL-ERR         TO PA-TOT-RTV-RTL-ERR.       28690037
287000     MOVE CR-TOT-MOS-RTL-ERR         TO PA-TOT-MOS-RTL-ERR.       28700037
287100     MOVE CR-TOT-DD-RTL-ERR          TO PA-TOT-DD-RTL-ERR.        28710037
287200     MOVE CR-TOT-RTV-UNT-ERR         TO PA-TOT-RTV-UNT-ERR.       28720037
287300     MOVE CR-TOT-MOS-UNT-ERR         TO PA-TOT-MOS-UNT-ERR.       28730037
287400     MOVE CR-TOT-DD-UNT-ERR          TO PA-TOT-DD-UNT-ERR.        28740037
287500     MOVE CR-TOT-UNK-COUNT-UNK       TO PA-TOT-UNK-COUNT-UNK.     28750037
287600     MOVE CR-TOT-UNK-RTL-UNK         TO PA-TOT-UNK-RTL-UNK.       28760037
287700     MOVE CR-TOT-UNK-UNT-UNK         TO PA-TOT-UNK-UNT-UNK.       28770037
287800     MOVE CR-TOT-RTV-COUNT-GOOD      TO PA-TOT-RTV-COUNT-GOOD.    28780037
287900     MOVE CR-TOT-MOS-COUNT-GOOD      TO PA-TOT-MOS-COUNT-GOOD.    28790037
288000     MOVE CR-TOT-DD-COUNT-GOOD       TO PA-TOT-DD-COUNT-GOOD.     28800037
288100     MOVE CR-TOT-RTV-RTL-GOOD        TO PA-TOT-RTV-RTL-GOOD.      28810037
288200     MOVE CR-TOT-MOS-RTL-GOOD        TO PA-TOT-MOS-RTL-GOOD.      28820037
288300     MOVE CR-TOT-DD-RTL-GOOD         TO PA-TOT-DD-RTL-GOOD.       28830037
288400     MOVE CR-TOT-RTV-UNT-GOOD        TO PA-TOT-RTV-UNT-GOOD.      28840037
288500     MOVE CR-TOT-MOS-UNT-GOOD        TO PA-TOT-MOS-UNT-GOOD.      28850037
288600     MOVE CR-TOT-DD-UNT-GOOD         TO PA-TOT-DD-UNT-GOOD.       28860037
288700     MOVE CR-TOT-UNK-COUNT-GOOD      TO PA-TOT-UNK-COUNT-GOOD.    28870037
288800     MOVE CR-TOT-UNK-RTL-GOOD        TO PA-TOT-UNK-RTL-GOOD.      28880037
288900     MOVE CR-TOT-UNK-UNT-GOOD        TO PA-TOT-UNK-UNT-GOOD.      28890037
289000     MOVE CR-TOT-RTV-COUNT-APPLID    TO PA-TOT-RTV-COUNT-APPLID.  28900037
289100     MOVE CR-TOT-RTV-RTL-APPLID      TO PA-TOT-RTV-RTL-APPLID.    28910037
289200     MOVE CR-TOT-RTV-UNT-APPLID      TO PA-TOT-RTV-UNT-APPLID.    28920037
289300     MOVE CR-TOT-MOS-COUNT-APPLID    TO PA-TOT-MOS-COUNT-APPLID.  28930037
289400     MOVE CR-TOT-MOS-RTL-APPLID      TO PA-TOT-MOS-RTL-APPLID.    28940037
289500     MOVE CR-TOT-MOS-UNT-APPLID      TO PA-TOT-MOS-UNT-APPLID.    28950037
289600     MOVE CR-TOT-DD-COUNT-APPLID     TO PA-TOT-DD-COUNT-APPLID.   28960037
289700     MOVE CR-TOT-DD-RTL-APPLID       TO PA-TOT-DD-RTL-APPLID.     28970037
289800     MOVE CR-TOT-DD-UNT-APPLID       TO PA-TOT-DD-UNT-APPLID.     28980037
289900                                                                  28990037
290000     DISPLAY '***********************************************'.   29000037
290100     DISPLAY '**        RVKUP002 CHECKPOINT RESTART        **'.   29010037
290200     DISPLAY '**   ------------------------------------    **'.   29020037
290300     MOVE PA-TOT-RECS-READ            TO PV-DISPLAY-RECORD.       29030037
290400     DISPLAY '** TOTAL RECORDS BYPASSED = ' PV-DISPLAY-RECORD.    29040037
290500     MOVE CR-TOT-HDR-RECS-READ TO PV-DISPLAY-RECORD               29050037
290600     DISPLAY '** TOTAL HDR RECORDS BYPASSED = ' PV-DISPLAY-RECORD.29060037
290700     MOVE PA-TOT-DTL-RECS-READ TO PV-DISPLAY-RECORD               29070037
290800     DISPLAY '** TOTAL DTL RECORDS BYPASSED = ' PV-DISPLAY-RECORD.29080037
290900     MOVE PA-TOT-CALLBACKS     TO PV-DISPLAY-RECORD               29090037
291000     DISPLAY '** TOTAL CALLBACKS BYPASSED   = ' PV-DISPLAY-RECORD.29100037
291100     DISPLAY '***********************************************'.   29110037
291200                                                                  29120037
291300                                                                  29130037
291400     DISPLAY '***********************************************'.   29140037
291500     DISPLAY '**        RVKUP002 CHECKPOINT RESTART        **'.   29150037
291600     DISPLAY '**   ------------------------------------    **'.   29160037
291700     DISPLAY '**         STATS FROM TCKRSTINF DESC         **'.   29170037
291800     DISPLAY '**   ------------------------------------    **'.   29180037
291900     DISPLAY '** TOT RECS READ       :' PA-TOT-RECS-READ.         29190037
292000     DISPLAY '** TOT HDR RECS READ   :' PA-TOT-HDR-RECS-READ.     29200037
292100     DISPLAY '** TOT HDR INS         :' PA-TOT-HDR-INS.           29210037
292200     DISPLAY '** TOT HDRSTAT INS     :' PA-TOT-HDRSTAT-INS.       29220037
292300     DISPLAY '** TOT DTL RECS READ   :' PA-TOT-DTL-RECS-READ.     29230037
292400     DISPLAY '** TOT DTL INS         :' PA-TOT-DTL-INS.           29240037
292500     DISPLAY '** TOT DTLSTAT INS     :' PA-TOT-DTLSTAT-INS.       29250037
292600     DISPLAY '** TOT SHIPT INS       :' PA-TOT-SHIPT-INS.         29260037
292700     DISPLAY '** TOT SHIPTSTAT INS   :' PA-TOT-SHIPTSTAT-INS.     29270037
292800     DISPLAY '** CUR MKOUT ID        :' PV-CURRENT-MKOUT-ORD-ID.  29280037
292900     DISPLAY '** TOT MKOUT ID UPD    :' PA-TOT-MKOUT-ORD-ID-UPD.  29290037
293000     DISPLAY '** TOT HDRS BYPASSED   :' PA-TOT-HDRS-BYPASSED.     29300037
293100     DISPLAY '** TOT DTLS BYPASSED   :' PA-TOT-DTLS-BYPASSED.     29310037
293200     DISPLAY '** TOT CALLBACKS       :' PA-TOT-CALLBACKS.         29320037
293300     DISPLAY '** TOT COMMITS         :' PA-TOT-COMMITS-TAKEN.     29330037
293400     DISPLAY '** ------------------  :'                           29340037
293500     DISPLAY '** TOT D&D DTLS RCVD   :' PA-TOT-DD-COUNT-RCVD.     29350037
293600     DISPLAY '** TOT D&D RTL CST RCVD:' PA-TOT-DD-RTL-RCVD.       29360037
293700     DISPLAY '** TOT D&D UNT CST RCVD:' PA-TOT-DD-UNT-RCVD.       29370037
293800     DISPLAY '                        '.                          29380037
293900     DISPLAY '** TOT MOS DTLS RCVD   :' PA-TOT-MOS-COUNT-RCVD.    29390037
294000     DISPLAY '** TOT MOS RTL CST RCVD:' PA-TOT-MOS-RTL-RCVD.      29400037
294100     DISPLAY '** TOT MOS UNT CST RCVD:' PA-TOT-MOS-UNT-RCVD.      29410037
294200     DISPLAY '                        '.                          29420037
294300     DISPLAY '** TOT RTV DTLS RCVD   :' PA-TOT-RTV-COUNT-RCVD.    29430037
294400     DISPLAY '** TOT RTV RTL CST RCVD:' PA-TOT-RTV-RTL-RCVD.      29440037
294500     DISPLAY '** TOT RTV UNT CST RCVD:' PA-TOT-RTV-UNT-RCVD.      29450037
294600     DISPLAY '**                     :' .                         29460037
294700     DISPLAY '** TOT D&D DTLS ERR    :' PA-TOT-DD-COUNT-ERR.      29470037
294800     DISPLAY '** TOT D&D RTL COST ERR:' PA-TOT-DD-RTL-ERR.        29480037
294900     DISPLAY '** TOT D&D UNT COST ERR:' PA-TOT-DD-UNT-ERR.        29490037
295000     DISPLAY '                        '.                          29500037
295100     DISPLAY '** TOT MOS DTLS ERR    :' PA-TOT-MOS-COUNT-ERR.     29510037
295200     DISPLAY '** TOT MOS RTL COST ERR:' PA-TOT-MOS-RTL-ERR.       29520037
295300     DISPLAY '** TOT MOS UNT COST ERR:' PA-TOT-MOS-UNT-ERR.       29530037
295400     DISPLAY '                        '.                          29540037
295500     DISPLAY '** TOT RTV DTLS ERR    :' PA-TOT-RTV-COUNT-ERR.     29550037
295600     DISPLAY '** TOT RTV RTL COST ERR:' PA-TOT-RTV-RTL-ERR.       29560037
295700     DISPLAY '** TOT RTV UNT COST ERR:' PA-TOT-RTV-UNT-ERR.       29570037
295800     DISPLAY '                        '.                          29580037
295900     DISPLAY '** TOT UNK DTLS        :' PA-TOT-UNK-COUNT-UNK.     29590037
296000     DISPLAY '** TOT UNK RTL COST    :' PA-TOT-UNK-RTL-UNK.       29600037
296100     DISPLAY '** TOT UNK UNT COST    :' PA-TOT-UNK-UNT-UNK.       29610037
296200     DISPLAY '**                     :' .                         29620037
296300     DISPLAY '** TOT D&D DTLS GOOD    :' PA-TOT-DD-COUNT-GOOD     29630037
296400     DISPLAY '** TOT D&D RTL COST GOOD:' PA-TOT-DD-RTL-GOOD       29640037
296500     DISPLAY '** TOT D&D UNT COST GOOD:' PA-TOT-DD-UNT-GOOD       29650037
296600     DISPLAY '                        '.                          29660037
296700     DISPLAY '** TOT MOS DTLS GOOD    :' PA-TOT-MOS-COUNT-GOOD    29670037
296800     DISPLAY '** TOT MOS RTL COST GOOD:' PA-TOT-MOS-RTL-GOOD      29680037
296900     DISPLAY '** TOT MOS UNT COST GOOD:' PA-TOT-MOS-UNT-GOOD      29690037
297000     DISPLAY '                        '.                          29700037
297100     DISPLAY '** TOT RTV DTLS GOOD    :' PA-TOT-RTV-COUNT-GOOD    29710037
297200     DISPLAY '** TOT RTV RTL COST GOOD:' PA-TOT-RTV-RTL-GOOD      29720037
297300     DISPLAY '** TOT RTV UNT COST GOOD:' PA-TOT-RTV-UNT-GOOD      29730037
297400     DISPLAY '                        '.                          29740037
297500     DISPLAY '** TOT UNK DTLS GOOD    :' PA-TOT-UNK-COUNT-GOOD    29750037
297600     DISPLAY '** TOT UNK RTL COST GOOD:' PA-TOT-UNK-RTL-GOOD      29760037
297700     DISPLAY '** TOT UNK UNT COST GOOD:' PA-TOT-UNK-UNT-GOOD.     29770037
297800     DISPLAY '***********************************************'.   29780037
297900                                                                  29790037
298000******************************************************************29800037
298100*    SELECT CHECKPOINT RESTART WORKING STORAGE INFORMATION.      *29810037
298200*    THIS FIELD ON THE DCLGEN IS LVC. IT HAS A LENGTH OF 4022    *29820037
298300*    AND MAY BE VARIABLE. IT HOLDS CHARACTER OR NUMERIC DATA.    *29830037
298400******************************************************************29840037
298500 6560-GET-CHECKPOINT-WK-STORG.                                    29850037
298600                                                                  29860037
298700     EXEC SQL                                                     29870037
298800      SELECT WORK_STRG_DESC                                       29880037
298900       INTO :TCKRSTINF-WORK-STRG-DESC                             29890037
299000       FROM TCKRSTINF                                             29900037
299100      WHERE PLAN_NAME = :PC-CURRENT-PROGRAM-NAME                  29910037
299200        AND JOB_NAME  = :CC-JOB-NAME                              29920037
299300     END-EXEC.                                                    29930037
299400                                                                  29940037
299500     EVALUATE TRUE                                                29950037
299600         WHEN SQLWARN0 NOT EQUAL SPACE                            29960037
299700         WHEN SQLCODE NOT EQUAL ZERO                              29970037
299800            DISPLAY '*******************************************' 29980037
299900            DISPLAY '** ABEND                                 **' 29990037
300000            DISPLAY '** PROGRAM = RVKUP002                    **' 30000037
300100            DISPLAY '** PARAGRAPH = 6560-GET-CHECKPOINT-WK-STORG' 30010037
300200            DISPLAY '** GETTING RESTART WORKING STORAGE INFO  **' 30020037
300300            DISPLAY '*******************************************' 30030037
300400            PERFORM 9100-SQL-ABEND                                30040037
300500     END-EVALUATE.                                                30050037
300600                                                                  30060037
300700******************************************************************30070037
300800*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *30080037
300900*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *30090037
301000******************************************************************30100037
301100 6570-UPDATE-TCKRSTCNTL.                                          30110037
301200                                                                  30120037
301300     EXEC SQL                                                     30130037
301400       UPDATE TCKRSTCNTL                                          30140037
301500       SET CKPT_STAT_CODE   = :PV-CKPT-STAT-CODE                  30150037
301600       WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME            30160037
301700         AND JOB_NAME       = :CC-JOB-NAME                        30170037
301800     END-EXEC.                                                    30180037
301900                                                                  30190037
302000     EVALUATE TRUE                                                30200037
302100         WHEN SQLWARN0 NOT EQUAL SPACE                            30210037
302200         WHEN SQLCODE NOT EQUAL ZERO                              30220037
302300             DISPLAY '*******************************************'30230037
302400             DISPLAY '** ABEND                                 **'30240037
302500             DISPLAY '** PROGRAM = RVKUP002                    **'30250037
302600             DISPLAY '** PARAGRAPH = 6570-UPDATE-TCKRSTCNTL    **'30260037
302700             DISPLAY '** UPDATING CKPT STAT CODE               **'30270037
302800             DISPLAY '*******************************************'30280037
302900             PERFORM 9100-SQL-ABEND                               30290037
303000     END-EVALUATE.                                                30300037
303100                                                                  30310037
303200******************************************************************30320037
303300* THE DATA FROM THESE FIELDS WILL BE STORED IN THE CHECKPOINT    *30330037
303400* RESTART INFO DESC, AND IT WILL BE USED FOR RESTARTS.           *30340037
303500******************************************************************30350037
303600 6580-SAVE-DATA-FOR-RESTART.                                      30360037
303700                                                                  30370037
303800     MOVE PA-TOT-RECS-READ        TO CR-TOT-RECS-READ.            30380037
303900     MOVE PA-TOT-HDR-RECS-READ    TO CR-TOT-HDR-RECS-READ.        30390037
304000     MOVE PA-TOT-DTL-RECS-READ    TO CR-TOT-DTL-RECS-READ.        30400037
304100     MOVE PA-TOT-HDR-INS          TO CR-TOT-HDR-INS.              30410037
304200     MOVE PA-TOT-DTL-INS          TO CR-TOT-DTL-INS.              30420037
304300     MOVE PA-TOT-SHIPT-INS        TO CR-TOT-SHIPT-INS.            30430037
304400     MOVE PA-TOT-SHIPTSTAT-INS    TO CR-TOT-SHIPTSTAT-INS.        30440037
304500     MOVE PA-TOT-HDRSTAT-INS      TO CR-TOT-HDRSTAT-INS.          30450037
304600     MOVE PA-TOT-DTLSTAT-INS      TO CR-TOT-DTLSTAT-INS.          30460037
304700     MOVE PA-TOT-SHIPTSTAT-INS    TO CR-TOT-SHIPTSTAT-INS.        30470037
304800     MOVE PA-TOT-MKOUT-ORD-ID-UPD TO CR-TOT-MKOUT-ORD-ID-UPD.     30480037
304900     MOVE PA-TOT-HDRS-BYPASSED    TO CR-TOT-HDRS-BYPASSED.        30490037
305000     MOVE PA-TOT-DTLS-BYPASSED    TO CR-TOT-DTLS-BYPASSED.        30500037
305100     MOVE PA-TOT-CALLBACKS        TO CR-TOT-CALLBACKS.            30510037
305200     MOVE PV-CURRENT-MKOUT-ORD-ID TO CR-CURRENT-MKOUT-ORD-ID.     30520037
305300     MOVE PA-TOT-COMMITS-TAKEN    TO CR-TOT-COMMITS-TAKEN.        30530037
305400     MOVE PA-TOT-RTV-COUNT-RCVD   TO CR-TOT-RTV-COUNT-RCVD.       30540037
305500     MOVE PA-TOT-MOS-COUNT-RCVD   TO CR-TOT-MOS-COUNT-RCVD.       30550037
305600     MOVE PA-TOT-DD-COUNT-RCVD    TO CR-TOT-DD-COUNT-RCVD.        30560037
305700     MOVE PA-TOT-RTV-RTL-RCVD     TO CR-TOT-RTV-RTL-RCVD.         30570037
305800     MOVE PA-TOT-MOS-RTL-RCVD     TO CR-TOT-MOS-RTL-RCVD.         30580037
305900     MOVE PA-TOT-DD-RTL-RCVD      TO CR-TOT-DD-RTL-RCVD.          30590037
306000     MOVE PA-TOT-RTV-UNT-RCVD     TO CR-TOT-RTV-UNT-RCVD.         30600037
306100     MOVE PA-TOT-MOS-UNT-RCVD     TO CR-TOT-MOS-UNT-RCVD.         30610037
306200     MOVE PA-TOT-DD-UNT-RCVD      TO CR-TOT-DD-UNT-RCVD.          30620037
306300     MOVE PA-TOT-RTV-COUNT-ERR    TO CR-TOT-RTV-COUNT-ERR.        30630037
306400     MOVE PA-TOT-MOS-COUNT-ERR    TO CR-TOT-MOS-COUNT-ERR.        30640037
306500     MOVE PA-TOT-DD-COUNT-ERR     TO CR-TOT-DD-COUNT-ERR.         30650037
306600     MOVE PA-TOT-RTV-RTL-ERR      TO CR-TOT-RTV-RTL-ERR.          30660037
306700     MOVE PA-TOT-MOS-RTL-ERR      TO CR-TOT-MOS-RTL-ERR.          30670037
306800     MOVE PA-TOT-DD-RTL-ERR       TO CR-TOT-DD-RTL-ERR.           30680037
306900     MOVE PA-TOT-RTV-UNT-ERR      TO CR-TOT-RTV-UNT-ERR.          30690037
307000     MOVE PA-TOT-MOS-UNT-ERR      TO CR-TOT-MOS-UNT-ERR.          30700037
307100     MOVE PA-TOT-DD-UNT-ERR       TO CR-TOT-DD-UNT-ERR.           30710037
307200     MOVE PA-TOT-UNK-COUNT-UNK    TO CR-TOT-UNK-COUNT-UNK.        30720037
307300     MOVE PA-TOT-UNK-RTL-UNK      TO CR-TOT-UNK-RTL-UNK.          30730037
307400     MOVE PA-TOT-UNK-UNT-UNK      TO CR-TOT-UNK-UNT-UNK.          30740037
307500     MOVE PA-TOT-RTV-COUNT-GOOD   TO CR-TOT-RTV-COUNT-GOOD.       30750037
307600     MOVE PA-TOT-MOS-COUNT-GOOD   TO CR-TOT-MOS-COUNT-GOOD.       30760037
307700     MOVE PA-TOT-DD-COUNT-GOOD    TO CR-TOT-DD-COUNT-GOOD.        30770037
307800     MOVE PA-TOT-RTV-RTL-GOOD     TO CR-TOT-RTV-RTL-GOOD.         30780037
307900     MOVE PA-TOT-MOS-RTL-GOOD     TO CR-TOT-MOS-RTL-GOOD.         30790037
308000     MOVE PA-TOT-DD-RTL-GOOD      TO CR-TOT-DD-RTL-GOOD.          30800037
308100     MOVE PA-TOT-RTV-UNT-GOOD     TO CR-TOT-RTV-UNT-GOOD.         30810037
308200     MOVE PA-TOT-MOS-UNT-GOOD     TO CR-TOT-MOS-UNT-GOOD.         30820037
308300     MOVE PA-TOT-DD-UNT-GOOD      TO CR-TOT-DD-UNT-GOOD.          30830037
308400     MOVE PA-TOT-UNK-COUNT-GOOD   TO CR-TOT-UNK-COUNT-GOOD.       30840037
308500     MOVE PA-TOT-UNK-RTL-GOOD     TO CR-TOT-UNK-RTL-GOOD.         30850037
308600     MOVE PA-TOT-UNK-UNT-GOOD     TO CR-TOT-UNK-UNT-GOOD.         30860037
308700     MOVE PA-TOT-RTV-COUNT-APPLID TO CR-TOT-RTV-COUNT-APPLID.     30870037
308800     MOVE PA-TOT-RTV-RTL-APPLID   TO CR-TOT-RTV-RTL-APPLID.       30880037
308900     MOVE PA-TOT-RTV-UNT-APPLID   TO CR-TOT-RTV-UNT-APPLID.       30890037
309000     MOVE PA-TOT-MOS-COUNT-APPLID TO CR-TOT-MOS-COUNT-APPLID.     30900037
309100     MOVE PA-TOT-MOS-RTL-APPLID   TO CR-TOT-MOS-RTL-APPLID.       30910037
309200     MOVE PA-TOT-MOS-UNT-APPLID   TO CR-TOT-MOS-UNT-APPLID.       30920037
309300     MOVE PA-TOT-DD-COUNT-APPLID  TO CR-TOT-DD-COUNT-APPLID.      30930037
309400     MOVE PA-TOT-DD-RTL-APPLID    TO CR-TOT-DD-RTL-APPLID.        30940037
309500     MOVE PA-TOT-DD-UNT-APPLID    TO CR-TOT-DD-UNT-APPLID.        30950037
309600                                                                  30960037
309700******************************************************************30970037
309800*  UPDATES THE CHECKPOINT RESTART INFORMATION TABLE.  THIS       *30980037
309900*  INFORMATION WOULD BE USED TO RESTART JOB IN CASE OF AN ABEND  *30990037
310000******************************************************************31000037
310100 6590-UPDATE-TCKRSTINF.                                           31010037
310200                                                                  31020037
310300     MOVE CKPT-RESTART-INFO    TO TCKRSTINF-WORK-STRG-DESC-TEXT.  31030037
310400     MOVE 4022                 TO TCKRSTINF-WORK-STRG-DESC-LEN.   31040037
310500                                                                  31050037
310600     EXEC SQL                                                     31060037
310700        UPDATE TCKRSTINF                                          31070037
310800         SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC         31080037
310900         WHERE PLAN_NAME      = :PC-CURRENT-PROGRAM-NAME          31090037
311000           AND JOB_NAME       = :CC-JOB-NAME                      31100037
311100     END-EXEC.                                                    31110037
311200                                                                  31120037
311300     EVALUATE TRUE                                                31130037
311400         WHEN SQLCODE EQUAL ZERO                                  31140037
311500            CONTINUE                                              31150037
311600         WHEN SQLWARN0 NOT EQUAL SPACE                            31160037
311700         WHEN SQLCODE NOT EQUAL ZERO                              31170037
311800             DISPLAY '*****************************************'  31180037
311900             DISPLAY '** ABEND                               **'  31190037
312000             DISPLAY '** PROGRAM = RVKUP002                  **'  31200037
312100             DISPLAY '** PARAGRAPH = 6590-UPDATE-TCKRSTINF   **'  31210037
312200             DISPLAY '** UNSUCCESSFUL UPDATE TCKRSTINF       **'  31220037
312300             DISPLAY '*****************************************'  31230037
312400             PERFORM 9100-SQL-ABEND                               31240037
312500     END-EVALUATE.                                                31250037
312600                                                                  31260037
312700******************************************************************31270037
312800* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     31280037
312900******************************************************************31290037
313000 6600-COMMIT.                                                     31300037
313100                                                                  31310037
313200     EXEC SQL                                                     31320037
313300         COMMIT                                                   31330037
313400     END-EXEC.                                                    31340037
313500                                                                  31350037
313600     EVALUATE TRUE                                                31360037
313700         WHEN SQLCODE EQUAL ZERO                                  31370037
313800              SET PS-A-MOS-IN-COMMIT-CYCLE-NO TO TRUE             31380037
313900              ADD +1 TO PA-TOT-COMMITS-TAKEN                      31390037
314000                                                                  31400037
314100         WHEN SQLWARN0 NOT EQUAL SPACE                            31410037
314200         WHEN SQLCODE NOT EQUAL ZERO                              31420037
314300                                                                  31430037
314400       DISPLAY '********** CHECKPOINT **************************' 31440037
314500       DISPLAY 'TOT RECS READ         :' PA-TOT-RECS-READ         31450037
314600       DISPLAY 'HDR RECS READ         :' PA-TOT-HDR-RECS-READ     31460037
314700       DISPLAY 'TOT RECS READ         :' PA-TOT-DTL-RECS-READ     31470037
314800       DISPLAY '************************************************' 31480037
314900       DISPLAY '****************************'                     31490037
315000       DISPLAY '** ABEND                  **'                     31500037
315100       DISPLAY '** PROGRAM = RVKUP002     **'                     31510037
315200       DISPLAY '** PARAGRAPH = 6600-COMMIT**'                     31520037
315300       DISPLAY '** UNSUCCESSFUL COMMIT    **'                     31530037
315400       DISPLAY '****************************'                     31540037
315500       PERFORM 9100-SQL-ABEND                                     31550037
315600                                                                  31560037
315700     END-EVALUATE.                                                31570037
315800                                                                  31580037
315900******************************************************************31590037
316000* INSERT A HDR REC INTO THE ERROR WORK TABLE (RVTW_DFCTOR_ERR)    31600037
316100******************************************************************31610037
316200 7000-INSERT-HDR-TO-ERR-TBL.                                      31620037
316300                                                                  31630037
316400     INITIALIZE RVT00006-RTV-3RD-PTY-ERR.                         31640037
316500                                                                  31650037
316600     SET RV018-HEADER-REC        TO TRUE.                         31660037
316700                                                                  31670037
316800     IF RV050-DFCT-ORD-ID NUMERIC                                 31680037
316900        MOVE RV050-DFCT-ORD-ID      TO RV018-DFCT-ORD-ID          31690037
317000     ELSE                                                         31700037
317100        MOVE RV050-DFCT-ORD-ID-X    TO RV018-DFCT-ORD-ID-X        31710037
317200     END-IF.                                                      31720037
317300     MOVE RV050-VENDOR-DUNS-NBR  TO RV018-VENDOR-DUNS-NBR.        31730037
317400     MOVE RV050-VEND-NAME        TO RV018-VEND-NAME.              31740037
317500     MOVE RV050-RETURN-TYPE      TO RV018-RETURN-TYPE.            31750037
317600     MOVE RV050-ORD-DTE          TO RV018-ORD-DTE.                31760037
317700     MOVE PS-ERROR-TEXT          TO RV018-ERROR-MSG.              31770037
317800                                                                  31780037
317900**  JH 10/30/2011 BEG                                             31790037
318000     MOVE RV050-OPER-UNT-ID      TO RV018-RTV-LOC.                31800037
318100     MOVE PV-LOC-NAME            TO RV018-RTV-LOC-NME.            31810037
318200**  JH 10/30/2011 END                                             31820037
318300                                                                  31830037
318400     MOVE RV018-HDR-ERROR-RECORD TO RVT00006-RTV-3RD-PTY-ERR.     31840037
318500                                                                  31850037
318600     PERFORM                                                      31860037
318700       WITH TEST AFTER                                            31870037
318800       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       31880037
318900       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              31890037
319000               SQLCODE = ZERO                                     31900037
319100                                                                  31910037
319200     EXEC SQL                                                     31920037
319300         INSERT INTO RVTW_DFCTOR_ERR                              31930037
319400             ( RTV_3RD_PTY_ERR                                    31940037
319500             )                                                    31950037
319600            VALUES                                                31960037
319700             (:RVT00006-RTV-3RD-PTY-ERR                           31970037
319800             )                                                    31980037
319900     END-EXEC                                                     31990037
320000                                                                  32000037
320100         EVALUATE TRUE                                            32010037
320200             WHEN SQLCODE = ZERO                                  32020037
320300                 ADD +1   TO PA-TOT-ERR-TBL-INS                   32030037
320400                                                                  32040037
320500             WHEN SQLWARN0 NOT EQUAL SPACE                        32050037
320600             WHEN SQLCODE NOT EQUAL ZERO                          32060037
320700                 DISPLAY '**************************************' 32070037
320800                 DISPLAY '** ABEND                            **' 32080037
320900                 DISPLAY '** PROGRAM = RVKUP002               **' 32090037
321000               DISPLAY '** PARAGRAPH = 7000-INSERT-HDR-TO-ERR-TBL'32100037
321100                 DISPLAY '** INSERT INTO RVTW_DFCTOR_ERR      **' 32110037
321200                 DISPLAY '** HDR DFCT ORD ID: ' RV050-DFCT-ORD-ID 32120037
321300                 DISPLAY '**************************************' 32130037
321400                 PERFORM 9100-SQL-ABEND                           32140037
321500         END-EVALUATE                                             32150037
321600     END-PERFORM.                                                 32160037
321700                                                                  32170037
321800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    32180037
321900         (SQLCODE NOT = ZERO)                                     32190037
322000        DISPLAY '********************************************'    32200037
322100        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    32210037
322200        DISPLAY '** INSERT TO RVTW_DFCTOR_ERR              **'    32220037
322300        DISPLAY '** PARAGRAPH = 7000-INSERT-HDR-TO-ERR-TBL **'    32230037
322400        DISPLAY '** HDR DFCT ORD ID: ' RV050-DFCT-ORD-ID          32240037
322500        DISPLAY '********************************************'    32250037
322600      PERFORM 9100-SQL-ABEND                                      32260037
322700     END-IF.                                                      32270037
322800                                                                  32280037
322900******************************************************************32290037
323000* INSERT A DTL REC INTO THE ERROR WORK TABLE (RVTW_DFCTOR_ERR)    32300037
323100******************************************************************32310037
323200 7001-INSERT-DTL-TO-ERR-TBL.                                      32320037
323300                                                                  32330037
323400**IF THIS IS A CRITICAL ERROR, COUNT THE RECORD AND ADD THE       32340037
323500**RTL_COST_AMT & UNIT_COST_AMOUNT TO THE SUMMARY BUCKETS          32350037
323600**THE SEVERITY SWITCH WAS SET BY THE SENDING PARAGRAPH            32360037
323700     INITIALIZE RVT00006-RTV-3RD-PTY-ERR.                         32370037
323800                                                                  32380037
323900     SET RV019-DETAIL-REC          TO TRUE.                       32390037
324000     MOVE RV051-DTL-RETURN-TYPE    TO RV019-RETURN-TYPE           32400037
324100                                                                  32410037
324200     IF RV051-DFCT-ORD-ID NUMERIC                                 32420037
324300        MOVE RV051-DFCT-ORD-ID      TO RV019-DFCT-ORD-ID          32430037
324400     ELSE                                                         32440037
324500        MOVE RV051-DFCT-ORD-ID-X    TO RV019-DFCT-ORD-ID-X        32450037
324600     END-IF.                                                      32460037
324700                                                                  32470037
324800     IF RV051-SEQ-NBR NUMERIC                                     32480037
324900        MOVE RV051-SEQ-NBR            TO RV019-SEQ-NBR            32490037
325000     ELSE                                                         32500037
325100        MOVE RV051-SEQ-NBR-X          TO RV019-SEQ-NBR-X          32510037
325200     END-IF.                                                      32520037
325300**  JH 10/30/2011 BEG                                             32530037
325400     MOVE RV050-OPER-UNT-ID         TO RV019-RTV-LOC.             32540037
325500     MOVE PV-LOC-NAME               TO RV019-RTV-LOC-NME.         32550037
325600**  JH 10/30/2011 END                                             32560037
325700                                                                  32570037
325800     MOVE RV051-DEPT-NBR (2:3)      TO RV019-DEPT-NBR.            32580037
325900     MOVE RV051-SUB-CLASS-NBR (3:2) TO RV019-SUB-CLASS-NBR.       32590037
326000     MOVE RV051-SKU                 TO RV019-SKU.                 32600037
326100     MOVE RV051-DFCT-RET-DTE        TO RV019-DFCT-RET-DTE.        32610037
326200     MOVE PS-ERROR-TEXT             TO RV019-ERROR-MSG.           32620037
326300                                                                  32630037
326400     MOVE RV019-DTL-ERROR-RECORD TO RVT00006-RTV-3RD-PTY-ERR      32640037
326500                                                                  32650037
326600     PERFORM                                                      32660037
326700       WITH TEST AFTER                                            32670037
326800       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       32680037
326900       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              32690037
327000               SQLCODE = ZERO                                     32700037
327100                                                                  32710037
327200     EXEC SQL                                                     32720037
327300         INSERT INTO RVTW_DFCTOR_ERR                              32730037
327400             ( RTV_3RD_PTY_ERR                                    32740037
327500             )                                                    32750037
327600            VALUES                                                32760037
327700             (:RVT00006-RTV-3RD-PTY-ERR                           32770037
327800             )                                                    32780037
327900     END-EXEC                                                     32790037
328000                                                                  32800037
328100         EVALUATE TRUE                                            32810037
328200             WHEN SQLCODE = ZERO                                  32820037
328300                 ADD +1   TO PA-TOT-ERR-TBL-INS                   32830037
328400                                                                  32840037
328500             WHEN SQLWARN0 NOT EQUAL SPACE                        32850037
328600             WHEN SQLCODE NOT EQUAL ZERO                          32860037
328700                 DISPLAY '**************************************' 32870037
328800                 DISPLAY '** ABEND                            **' 32880037
328900                 DISPLAY '** PROGRAM = RVKUP002               **' 32890037
329000               DISPLAY '** PARAGRAPH = 7001-INSERT-DTL-TO-ERR-TBL'32900037
329100                 DISPLAY '** INSERT INTO RVTW_DFCTOR_ERR      **' 32910037
329200                 DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID 32920037
329300                 DISPLAY '**************************************' 32930037
329400                 PERFORM 9100-SQL-ABEND                           32940037
329500         END-EVALUATE                                             32950037
329600     END-PERFORM.                                                 32960037
329700                                                                  32970037
329800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    32980037
329900         (SQLCODE NOT = ZERO)                                     32990037
330000        DISPLAY '********************************************'    33000037
330100        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    33010037
330200        DISPLAY '** INSERT TO RVTW_DFCTOR_ERR              **'    33020037
330300        DISPLAY '** PARAGRAPH = 7001-INSERT-DTL-TO-ERR-TBL **'    33030037
330400        DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33040037
330500        DISPLAY '********************************************'    33050037
330600      PERFORM 9100-SQL-ABEND                                      33060037
330700     END-IF.                                                      33070037
330800                                                                  33080037
330900******************************************************************33090037
331000* INSERT A DTL SUM REC INTO THE ERROR WORK TABLE (RVTW_DFCTOR_ERR)33100037
331100******************************************************************33110037
331200 7004-ZERO-OUT-SUM-TOTS.                                          33120037
331300*       DISPLAY '********************************************'    33130037
331400*       DISPLAY '** 7004-ZERO-OUT-SUM-TOTS WAS EXECUTED'          33140037
331500*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33150037
331600*       DISPLAY '********************************************'    33160037
331700                                                                  33170037
331800     MOVE 0 TO PA-TOT-RTV-COUNT-RCVD                              33180037
331900               PA-TOT-RTV-RTL-RCVD                                33190037
332000               PA-TOT-RTV-UNT-RCVD                                33200037
332100               PA-TOT-MOS-COUNT-RCVD                              33210037
332200               PA-TOT-MOS-RTL-RCVD                                33220037
332300               PA-TOT-MOS-UNT-RCVD                                33230037
332400               PA-TOT-DD-COUNT-RCVD                               33240037
332500               PA-TOT-DD-RTL-RCVD                                 33250037
332600               PA-TOT-DD-UNT-RCVD.                                33260037
332700                                                                  33270037
332800******************************************************************33280037
332900* INSERT A DTL SUM REC INTO THE ERROR WORK TABLE (RVTW_DFCTOR_ERR)33290037
333000******************************************************************33300037
333100 7005-INSERT-DTL-SUM-TO-ERR-TBL.                                  33310037
333200                                                                  33320037
333300     INITIALIZE RVT00006-RTV-3RD-PTY-ERR.                         33330037
333400                                                                  33340037
333500     SET RV020-SUMMARY-REC TO TRUE.                               33350037
333600                                                                  33360037
333700     MOVE PA-TOT-RTV-COUNT-RCVD     TO RV020-RTV-DTLS-RCVD.       33370037
333800*       DISPLAY '********************************************'    33380037
333900*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33390037
334000*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33400037
334100*       DISPLAY '** TOT RTV RTL CNT RCVD:' PA-TOT-RTV-COUNT-RCVD  33410037
334200*       DISPLAY '********************************************'    33420037
334300     MOVE PA-TOT-RTV-RTL-RCVD       TO RV020-RTV-RTL-DLRS-RCVD.   33430037
334400*       DISPLAY '********************************************'    33440037
334500*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33450037
334600*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33460037
334700*       DISPLAY '** TOT RTV RTL CST RCVD:' PA-TOT-RTV-RTL-RCVD    33470037
334800*       DISPLAY '********************************************'    33480037
334900     MOVE PA-TOT-RTV-UNT-RCVD       TO RV020-RTV-UNT-DLRS-RCVD.   33490037
335000*       DISPLAY '********************************************'    33500037
335100*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33510037
335200*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33520037
335300*       DISPLAY '** TOT RTV UNT CST RCVD:' PA-TOT-RTV-UNT-RCVD    33530037
335400*       DISPLAY '********************************************'    33540037
335500     MOVE PA-TOT-MOS-COUNT-RCVD     TO RV020-MOS-DTLS-RCVD.       33550037
335600*       DISPLAY '********************************************'    33560037
335700*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33570037
335800*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33580037
335900*       DISPLAY '** TOT MOS UNT CNT RCVD:' PA-TOT-MOS-COUNT-RCVD  33590037
336000*       DISPLAY '********************************************'    33600037
336100     MOVE PA-TOT-MOS-RTL-RCVD       TO RV020-MOS-RTL-DLRS-RCVD.   33610037
336200*       DISPLAY '********************************************'    33620037
336300*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33630037
336400*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33640037
336500*       DISPLAY '** TOT MOS RTL AMT RCVD:' PA-TOT-MOS-RTL-RCVD    33650037
336600*       DISPLAY '********************************************'    33660037
336700     MOVE PA-TOT-MOS-UNT-RCVD       TO RV020-MOS-UNT-DLRS-RCVD.   33670037
336800*       DISPLAY '********************************************'    33680037
336900*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33690037
337000*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33700037
337100*       DISPLAY '** TOT MOS UNT AMT RCVD:' PA-TOT-MOS-UNT-RCVD    33710037
337200*       DISPLAY '********************************************'    33720037
337300     MOVE PA-TOT-DD-COUNT-RCVD      TO RV020-DD-DTLS-RCVD.        33730037
337400*       DISPLAY '********************************************'    33740037
337500*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33750037
337600*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33760037
337700*       DISPLAY '** TOT DD UNT CNT RCVD:' PA-TOT-DD-COUNT-RCVD    33770037
337800*       DISPLAY '********************************************'    33780037
337900     MOVE PA-TOT-DD-RTL-RCVD        TO RV020-DD-RTL-DLRS-RCVD.    33790037
338000*       DISPLAY '********************************************'    33800037
338100*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33810037
338200*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33820037
338300*       DISPLAY '** TOT DD RTL CST RCVD:' PA-TOT-DD-RTL-RCVD      33830037
338400*       DISPLAY '********************************************'    33840037
338500     MOVE PA-TOT-DD-UNT-RCVD        TO RV020-DD-UNT-DLRS-RCVD.    33850037
338600*       DISPLAY '********************************************'    33860037
338700*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33870037
338800*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33880037
338900*       DISPLAY '** TOT DD UNT CST RCVD:' PA-TOT-DD-UNT-RCVD      33890037
339000*       DISPLAY '********************************************'    33900037
339100                                                                  33910037
339200     MOVE PA-TOT-RTV-COUNT-ERR      TO RV020-RTV-DTLS-ERR.        33920037
339300*       DISPLAY '********************************************'    33930037
339400*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      33940037
339500*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          33950037
339600*       DISPLAY '** TOT RTV COUNT ERROR :' PA-TOT-RTV-COUNT-ERR   33960037
339700*       DISPLAY '********************************************'    33970037
339800     MOVE PA-TOT-RTV-RTL-ERR        TO RV020-RTV-RTL-DLRS-ERR.    33980037
339900*       DISPLAY '********************************************'    33990037
340000*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      34000037
340100*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          34010037
340200*       DISPLAY '** TOT RTV RETAIL ERROR:' PA-TOT-RTV-RTL-ERR     34020037
340300*       DISPLAY '********************************************'    34030037
340400     MOVE PA-TOT-RTV-UNT-ERR        TO RV020-RTV-UNT-DLRS-ERR.    34040037
340500*       DISPLAY '********************************************'    34050037
340600*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      34060037
340700*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          34070037
340800*       DISPLAY '** TOT RTV UNIT ERROR:' PA-TOT-RTV-UNT-ERR       34080037
340900*       DISPLAY '********************************************'    34090037
341000     MOVE PA-TOT-MOS-COUNT-ERR      TO RV020-MOS-DTLS-ERR.        34100037
341100*       DISPLAY '********************************************'    34110037
341200*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      34120037
341300*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          34130037
341400*       DISPLAY '** TOT MOS COUNT ERR :' PA-TOT-MOS-COUNT-ERR     34140037
341500*       DISPLAY '********************************************'    34150037
341600     MOVE PA-TOT-MOS-RTL-ERR        TO RV020-MOS-RTL-DLRS-ERR.    34160037
341700*       DISPLAY '********************************************'    34170037
341800*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      34180037
341900*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          34190037
342000*       DISPLAY '** TOT MOS RETAIL ERR:' PA-TOT-MOS-RTL-ERR       34200037
342100*       DISPLAY '********************************************'    34210037
342200     MOVE PA-TOT-MOS-UNT-ERR        TO RV020-MOS-UNT-DLRS-ERR.    34220037
342300*       DISPLAY '********************************************'    34230037
342400*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      34240037
342500*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          34250037
342600*       DISPLAY '** TOT MOS UNIT ERR:' PA-TOT-MOS-UNT-ERR         34260037
342700*       DISPLAY '********************************************'    34270037
342800     MOVE PA-TOT-DD-COUNT-ERR       TO RV020-DD-DTLS-ERR.         34280037
342900*       DISPLAY '********************************************'    34290037
343000*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      34300037
343100*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          34310037
343200*       DISPLAY '** TOT DD COUNT ERR:' PA-TOT-DD-COUNT-ERR        34320037
343300*       DISPLAY '********************************************'    34330037
343400     MOVE PA-TOT-DD-RTL-ERR         TO RV020-DD-RTL-DLRS-ERR.     34340037
343500*       DISPLAY '********************************************'    34350037
343600*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      34360037
343700*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          34370037
343800*       DISPLAY '** TOT DD RETAIL ERR:' PA-TOT-DD-RTL-ERR         34380037
343900*       DISPLAY '********************************************'    34390037
344000     MOVE PA-TOT-DD-UNT-ERR         TO RV020-DD-UNT-DLRS-ERR.     34400037
344100*       DISPLAY '********************************************'    34410037
344200*       DISPLAY '** 7005-INSERT-DTL-SUM-TO-ERR-TBL EXECUTED'      34420037
344300*       DISPLAY '** DTL DFCT ORD ID: ' RV051-DFCT-ORD-ID          34430037
344400*       DISPLAY '** TOT DD UNIT  ERR:' PA-TOT-DD-UNT-ERR          34440037
344500*       DISPLAY '********************************************'    34450037
344600                                                                  34460037
344700     MOVE PA-TOT-UNK-COUNT-UNK      TO RV020-UNK-DTLS-UNK.        34470037
344800     MOVE PA-TOT-UNK-RTL-UNK        TO RV020-UNK-RTL-DLRS-UNK.    34480037
344900     MOVE PA-TOT-UNK-UNT-UNK        TO RV020-UNK-UNT-DLRS-UNK.    34490037
345000                                                                  34500037
345100     MOVE PA-TOT-RTV-COUNT-APPLID TO RV020-RTV-DTLS-APPLID.       34510037
345200     MOVE PA-TOT-RTV-RTL-APPLID   TO RV020-RTV-RTL-DLRS-APPLID.   34520037
345300     MOVE PA-TOT-RTV-UNT-APPLID   TO RV020-RTV-UNT-DLRS-APPLID.   34530037
345400     MOVE PA-TOT-MOS-COUNT-APPLID TO RV020-MOS-DTLS-APPLID.       34540037
345500     MOVE PA-TOT-MOS-RTL-APPLID   TO RV020-MOS-RTL-DLRS-APPLID.   34550037
345600     MOVE PA-TOT-MOS-UNT-APPLID   TO RV020-MOS-UNT-DLRS-APPLID.   34560037
345700     MOVE PA-TOT-DD-COUNT-APPLID  TO RV020-DD-DTLS-APPLID.        34570037
345800     MOVE PA-TOT-DD-RTL-APPLID    TO RV020-DD-RTL-DLRS-APPLID.    34580037
345900     MOVE PA-TOT-DD-UNT-APPLID    TO RV020-DD-UNT-DLRS-APPLID.    34590037
346000**  JH 10/30/2011 BEG                                             34600037
346100     MOVE RV050-OPER-UNT-ID       TO RV020-RTV-LOC.               34610037
346200     MOVE PV-LOC-NAME             TO RV020-RTV-LOC-NME.           34620037
346300**  JH 10/30/2011 END                                             34630037
346400                                                                  34640037
346500     MOVE RV020-DTL-SUMMARY-RECORD TO RVT00006-RTV-3RD-PTY-ERR.   34650037
346600                                                                  34660037
346700     PERFORM                                                      34670037
346800       WITH TEST AFTER                                            34680037
346900       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       34690037
347000       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              34700037
347100               SQLCODE = ZERO                                     34710037
347200                                                                  34720037
347300     EXEC SQL                                                     34730037
347400         INSERT INTO RVTW_DFCTOR_ERR                              34740037
347500             ( RTV_3RD_PTY_ERR                                    34750037
347600             )                                                    34760037
347700            VALUES                                                34770037
347800             (:RVT00006-RTV-3RD-PTY-ERR                           34780037
347900             )                                                    34790037
348000     END-EXEC                                                     34800037
348100                                                                  34810037
348200         EVALUATE TRUE                                            34820037
348300             WHEN SQLCODE = ZERO                                  34830037
348400                 ADD +1   TO PA-TOT-ERR-TBL-INS                   34840037
348500                                                                  34850037
348600             WHEN SQLWARN0 NOT EQUAL SPACE                        34860037
348700             WHEN SQLCODE NOT EQUAL ZERO                          34870037
348800                 DISPLAY '**************************************' 34880037
348900                 DISPLAY '** ABEND                            **' 34890037
349000                 DISPLAY '** PROGRAM = RVKUP002               **' 34900037
349100           DISPLAY '** PARAGRAPH = 7005-INSERT-DTL-SUM-TO-ERR-TBL'34910037
349200                 DISPLAY '** INSERT INTO RVTW_DFCTOR_ERR      **' 34920037
349300                 DISPLAY '**************************************' 34930037
349400                 PERFORM 9100-SQL-ABEND                           34940037
349500         END-EVALUATE                                             34950037
349600     END-PERFORM.                                                 34960037
349700                                                                  34970037
349800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    34980037
349900         (SQLCODE NOT = ZERO)                                     34990037
350000        DISPLAY '********************************************'    35000037
350100        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    35010037
350200        DISPLAY '** INSERT TO RVTW_DFCTOR_ERR              **'    35020037
350300        DISPLAY '** PARAGRAPH = 7005-INSERT-DTL-SUM-TO-ERR-TBL'   35030037
350400        DISPLAY '********************************************'    35040037
350500      PERFORM 9100-SQL-ABEND                                      35050037
350600     END-IF.                                                      35060037
350700                                                                  35070037
350800******************************************************************35080037
350900* INITIALIZE 'GOOD' VALUES FOR 7010-SUM-GOOD-VALUES.             *35090037
351000* THESE ARE VALUES THAT WOULD BE APPLIED IF THERE HADN'T BEEN AN *35100037
351100* ERROR IN A DETAIL AFTER THIS/THESE RECORDS ON THE DETAIL FILE. *35110037
351200******************************************************************35120037
351300 7008-INITIALIZE-GOOD-VALUES.                                     35130037
351400                                                                  35140037
351500     INITIALIZE PA-TOT-DD-COUNT-GOOD.                             35150037
351600     INITIALIZE PA-TOT-DD-RTL-GOOD.                               35160037
351700     INITIALIZE PA-TOT-DD-UNT-GOOD.                               35170037
351800     INITIALIZE PA-TOT-MOS-COUNT-GOOD                             35180037
351900     INITIALIZE PA-TOT-MOS-RTL-GOOD.                              35190037
352000     INITIALIZE PA-TOT-MOS-UNT-GOOD.                              35200037
352100     INITIALIZE PA-TOT-RTV-COUNT-GOOD                             35210037
352200     INITIALIZE PA-TOT-RTV-RTL-GOOD.                              35220037
352300     INITIALIZE PA-TOT-RTV-UNT-GOOD.                              35230037
352400     INITIALIZE PA-TOT-UNK-COUNT-GOOD                             35240037
352500     INITIALIZE PA-TOT-UNK-RTL-GOOD.                              35250037
352600     INITIALIZE PA-TOT-UNK-UNT-GOOD.                              35260037
352700                                                                  35270037
352800******************************************************************35280037
352900* FOR EACH RETURN-TYPE, D&D, RTV AND MOS, TABULATE THE REC COUNT,*35290037
353000* AND TOT OF RTL_COST_AMT AND UNIT_COST_AMT FOR THE RECORDS.    .*35300037
353100* WE MAY NEED THESE TOTALS IF WE HIT AN ERROR DETAIL RECORD.    .*35310037
353200******************************************************************35320037
353300 7010-SUM-GOOD-VALUES.                                            35330037
353400                                                                  35340037
353500     IF RV051-DTL-RETURN-TYPE = PC-D                              35350037
353600      OR RV051-DTL-RETURN-TYPE = PC-M                             35360037
353700      OR RV051-DTL-RETURN-TYPE = PC-R                             35370037
353800        IF RV051-DTL-RETURN-TYPE = PC-D                           35380037
353900           ADD +1 TO PA-TOT-DD-COUNT-GOOD                         35390037
354000*            DISPLAY '**************************************'     35400037
354100*            DISPLAY '***BEFORE*****************************'     35410037
354200*            DISPLAY '** PARAGRAPH = 7010-SUMGOOD-VALUES*'        35420037
354300*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         35430037
354400*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     35440037
354500*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        35450037
354600*            DISPLAY '** TOTAL RETAL: ' PA-TOT-DD-RTL-GOOD        35460037
354700*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       35470037
354800*            DISPLAY '** TOTAL UNIT : ' PA-TOT-DD-UNT-GOOD        35480037
354900*            DISPLAY '**************************************'     35490037
355000           IF RV051-RTL-COST-AMT NUMERIC                          35500037
355100             COMPUTE PA-TOT-DD-RTL-GOOD =                         35510037
355200                     PA-TOT-DD-RTL-GOOD + RV051-RTL-COST-AMT      35520037
355300           END-IF                                                 35530037
355400           IF RV051-UNIT-COST-AMT NUMERIC                         35540037
355500             COMPUTE PA-TOT-DD-UNT-GOOD =                         35550037
355600                     PA-TOT-DD-UNT-GOOD + RV051-UNIT-COST-AMT     35560037
355700           END-IF                                                 35570037
355800*            DISPLAY '**************************************'     35580037
355900*            DISPLAY '***AFTER******************************'     35590037
356000*            DISPLAY '** PARAGRAPH = 7010-SUM-GOOD-VALUES*'       35600037
356100*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         35610037
356200*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     35620037
356300*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        35630037
356400*            DISPLAY '** TOTAL RETAL: ' PA-TOT-DD-RTL-GOOD        35640037
356500*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       35650037
356600*            DISPLAY '** TOTAL UNIT : ' PA-TOT-DD-UNT-GOOD        35660037
356700*            DISPLAY '**************************************'     35670037
356800        END-IF                                                    35680037
356900        IF RV051-DTL-RETURN-TYPE = PC-M                           35690037
357000           ADD +1 TO PA-TOT-MOS-COUNT-GOOD                        35700037
357100*            DISPLAY '**************************************'     35710037
357200*            DISPLAY '***BEFORE*****************************'     35720037
357300*            DISPLAY '** PARAGRAPH = 7010-SUM-GOOD-VALUES*'       35730037
357400*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         35740037
357500*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     35750037
357600*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        35760037
357700*            DISPLAY '** TOTAL RETAL: ' PA-TOT-MOS-RTL-GOOD       35770037
357800*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       35780037
357900*            DISPLAY '** TOTAL UNIT : ' PA-TOT-MOS-UNT-GOOD       35790037
358000*            DISPLAY '**************************************'     35800037
358100                                                                  35810037
358200           IF RV051-RTL-COST-AMT NUMERIC                          35820037
358300           COMPUTE PA-TOT-MOS-RTL-GOOD =                          35830037
358400                   PA-TOT-MOS-RTL-GOOD + RV051-RTL-COST-AMT       35840037
358500           END-IF                                                 35850037
358600                                                                  35860037
358700           IF RV051-UNIT-COST-AMT NUMERIC                         35870037
358800           COMPUTE PA-TOT-MOS-UNT-GOOD =                          35880037
358900                   PA-TOT-MOS-UNT-GOOD + RV051-UNIT-COST-AMT      35890037
359000           END-IF                                                 35900037
359100*            DISPLAY '**************************************'     35910037
359200*            DISPLAY '***AFTER******************************'     35920037
359300*            DISPLAY '** PARAGRAPH = 7010-SUM-GOOD-VALUES*'       35930037
359400*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         35940037
359500*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     35950037
359600*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        35960037
359700*            DISPLAY '** TOTAL RETAL: ' PA-TOT-MOS-RTL-GOOD       35970037
359800*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       35980037
359900*            DISPLAY '** TOTAL UNIT : ' PA-TOT-MOS-UNT-GOOD       35990037
360000*            DISPLAY '**************************************'     36000037
360100                                                                  36010037
360200        END-IF                                                    36020037
360300                                                                  36030037
360400        IF RV051-DTL-RETURN-TYPE = PC-R                           36040037
360500           ADD +1 TO PA-TOT-RTV-COUNT-GOOD                        36050037
360600*            DISPLAY '**************************************'     36060037
360700*            DISPLAY '***BEFORE*****************************'     36070037
360800*            DISPLAY '** PARAGRAPH = 7010-SUM-GOOD-VALUES*'       36080037
360900*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         36090037
361000*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     36100037
361100*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        36110037
361200*            DISPLAY '** TOTAL RETAL: ' PA-TOT-RTV-RTL-GOOD       36120037
361300*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       36130037
361400*            DISPLAY '** TOTAL UNIT : ' PA-TOT-RTV-UNT-GOOD       36140037
361500*            DISPLAY '**************************************'     36150037
361600           IF RV051-RTL-COST-AMT NUMERIC                          36160037
361700             COMPUTE PA-TOT-RTV-RTL-GOOD =                        36170037
361800                     PA-TOT-RTV-RTL-GOOD + RV051-RTL-COST-AMT     36180037
361900           END-IF                                                 36190037
362000                                                                  36200037
362100           IF RV051-UNIT-COST-AMT NUMERIC                         36210037
362200             COMPUTE PA-TOT-RTV-UNT-GOOD =                        36220037
362300                     PA-TOT-RTV-UNT-GOOD + RV051-UNIT-COST-AMT    36230037
362400           END-IF                                                 36240037
362500*            DISPLAY '**************************************'     36250037
362600*            DISPLAY '***AFTER******************************'     36260037
362700*            DISPLAY '** PARAGRAPH = 7010-SUM-ERROR-VALUES*'      36270037
362800*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         36280037
362900*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     36290037
363000*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        36300037
363100*            DISPLAY '** TOTAL RETAL: ' PA-TOT-RTV-RTL-GOOD       36310037
363200*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       36320037
363300*            DISPLAY '** TOTAL UNIT : ' PA-TOT-RTV-UNT-GOOD       36330037
363400*            DISPLAY '**************************************'     36340037
363500                                                                  36350037
363600        END-IF                                                    36360037
363700     ELSE                                                         36370037
363800      ADD +1 TO PA-TOT-UNK-COUNT-GOOD                             36380037
363900*            DISPLAY '**************************************'     36390037
364000*            DISPLAY '***BEFORE*****************************'     36400037
364100*            DISPLAY '** PARAGRAPH = 7010-SUM-ERROR-VALUES*'      36410037
364200*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         36420037
364300*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     36430037
364400*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        36440037
364500*            DISPLAY '** TOTAL RETAL: ' PA-TOT-UNK-RTL-GOOD       36450037
364600*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       36460037
364700*            DISPLAY '** TOTAL UNIT : ' PA-TOT-UNK-UNT-GOOD       36470037
364800*            DISPLAY '**************************************'     36480037
364900      IF RV051-RTL-COST-AMT NUMERIC                               36490037
365000      COMPUTE PA-TOT-UNK-RTL-GOOD =                               36500037
365100              PA-TOT-UNK-RTL-GOOD + RV051-RTL-COST-AMT            36510037
365200      END-IF                                                      36520037
365300                                                                  36530037
365400      IF RV051-UNIT-COST-AMT NUMERIC                              36540037
365500      COMPUTE PA-TOT-UNK-UNT-GOOD =                               36550037
365600              PA-TOT-UNK-UNT-GOOD + RV051-UNIT-COST-AMT           36560037
365700      END-IF                                                      36570037
365800*            DISPLAY '**************************************'     36580037
365900*            DISPLAY '***AFTER******************************'     36590037
366000*            DISPLAY '** PARAGRAPH = 7010-SUM-ERROR-VALUES*'      36600037
366100*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         36610037
366200*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     36620037
366300*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        36630037
366400*            DISPLAY '** TOTAL RETAL: ' PA-TOT-UNK-RTL-GOOD       36640037
366500*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       36650037
366600*            DISPLAY '** TOTAL UNIT : ' PA-TOT-UNK-UNT-GOOD       36660037
366700*            DISPLAY '**************************************'     36670037
366800                                                                  36680037
366900     END-IF.                                                      36690037
367000                                                                  36700037
367100******************************************************************36710037
367200* FOR EACH RETURN-TYPE, D&D, RTV AND MOS, TABULATE THE REC COUNT,*36720037
367300* AND TOT OF RTL_COST_AMT AND UNIT_COST_AMT FOR THE 'GOOD' RECS  *36730037
367400* TO THE ERROR RECORDS.  THE GOOD RECORDS REFER TO THOSE RECORDS *36740037
367500* ON THE DETAIL FILE THAT DIDN'T HAVE ERRORS BEFORE A RECORD     *36750037
367600* ON THE SAME FILE THAT DID HAVE ERRORS.  WE ONLY LOAD WHEN ALL  *36760037
367700* RECORDS BOTH HEADER AND DETAIL ARE WITH OUT CRITICAL ERRORS.   *36770037
367800******************************************************************36780037
367900 7012-SUM-GOOD-TO-ERRORS.                                         36790037
368000                                                                  36800037
368100     IF RV051-DTL-RETURN-TYPE = PC-D                              36810037
368200      OR RV051-DTL-RETURN-TYPE = PC-M                             36820037
368300      OR RV051-DTL-RETURN-TYPE = PC-R                             36830037
368400                                                                  36840037
368500        IF RV051-DTL-RETURN-TYPE = PC-D                           36850037
368600           COMPUTE PA-TOT-DD-COUNT-ERR =                          36860037
368700                   PA-TOT-DD-COUNT-ERR + PA-TOT-DD-COUNT-GOOD     36870037
368800           COMPUTE PA-TOT-DD-RTL-ERR =                            36880037
368900                   PA-TOT-DD-RTL-ERR   + PA-TOT-DD-RTL-GOOD       36890037
369000           COMPUTE PA-TOT-DD-UNT-ERR =                            36900037
369100                   PA-TOT-DD-UNT-ERR   + PA-TOT-DD-UNT-GOOD       36910037
369200        END-IF                                                    36920037
369300                                                                  36930037
369400        IF RV051-DTL-RETURN-TYPE = PC-M                           36940037
369500           COMPUTE PA-TOT-MOS-COUNT-ERR =                         36950037
369600                   PA-TOT-MOS-COUNT-ERR + PA-TOT-MOS-COUNT-GOOD   36960037
369700           COMPUTE PA-TOT-MOS-RTL-ERR =                           36970037
369800                   PA-TOT-MOS-RTL-ERR   + PA-TOT-MOS-RTL-GOOD     36980037
369900           COMPUTE PA-TOT-MOS-UNT-ERR =                           36990037
370000                   PA-TOT-MOS-UNT-ERR   + PA-TOT-MOS-UNT-GOOD     37000037
370100        END-IF                                                    37010037
370200                                                                  37020037
370300        IF RV051-DTL-RETURN-TYPE = PC-R                           37030037
370400           COMPUTE PA-TOT-RTV-COUNT-ERR =                         37040037
370500                   PA-TOT-RTV-COUNT-ERR + PA-TOT-RTV-COUNT-GOOD   37050037
370600           COMPUTE PA-TOT-RTV-RTL-ERR =                           37060037
370700                   PA-TOT-RTV-RTL-ERR   + PA-TOT-RTV-RTL-GOOD     37070037
370800           COMPUTE PA-TOT-RTV-UNT-ERR =                           37080037
370900                   PA-TOT-RTV-UNT-ERR   + PA-TOT-RTV-UNT-GOOD     37090037
371000        END-IF                                                    37100037
371100     ELSE                                                         37110037
371200           COMPUTE PA-TOT-UNK-COUNT-UNK =                         37120037
371300                   PA-TOT-UNK-COUNT-UNK + PA-TOT-UNK-COUNT-GOOD   37130037
371400           COMPUTE PA-TOT-UNK-RTL-UNK   =                         37140037
371500                   PA-TOT-UNK-RTL-UNK   + PA-TOT-UNK-RTL-GOOD     37150037
371600           COMPUTE PA-TOT-UNK-UNT-UNK   =                         37160037
371700                   PA-TOT-UNK-UNT-UNK   + PA-TOT-UNK-UNT-GOOD     37170037
371800     END-IF.                                                      37180037
371900                                                                  37190037
372000******************************************************************37200037
372100* FOR EACH RETURN-TYPE, D&D, RTV AND MOS, TABULATE THE REC COUNT,*37210037
372200* AND TOT OF RTL_COST_AMT AND UNIT_COST_AMT FOR THE ERRORED RECS.*37220037
372300******************************************************************37230037
372400 7015-SUM-ERROR-VALUES.                                           37240037
372500                                                                  37250037
372600     IF RV051-DTL-RETURN-TYPE = PC-D                              37260037
372700      OR RV051-DTL-RETURN-TYPE = PC-M                             37270037
372800      OR RV051-DTL-RETURN-TYPE = PC-R                             37280037
372900        IF RV051-DTL-RETURN-TYPE = PC-D                           37290037
373000           ADD +1 TO PA-TOT-DD-COUNT-ERR                          37300037
373100*            DISPLAY '**************************************'     37310037
373200*            DISPLAY '***BEFORE*****************************'     37320037
373300*            DISPLAY '** PARAGRAPH = 7015-SUM-ERROR-VALUES*'      37330037
373400*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         37340037
373500*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     37350037
373600*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        37360037
373700*            DISPLAY '** TOTAL RETAL: ' PA-TOT-DD-RTL-ERR         37370037
373800*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       37380037
373900*            DISPLAY '** TOTAL UNIT : ' PA-TOT-DD-UNT-ERR         37390037
374000*            DISPLAY '**************************************'     37400037
374100           IF RV051-RTL-COST-AMT NUMERIC                          37410037
374200             COMPUTE PA-TOT-DD-RTL-ERR =                          37420037
374300                     PA-TOT-DD-RTL-ERR + RV051-RTL-COST-AMT       37430037
374400           END-IF                                                 37440037
374500           IF RV051-UNIT-COST-AMT NUMERIC                         37450037
374600             COMPUTE PA-TOT-DD-UNT-ERR =                          37460037
374700                     PA-TOT-DD-UNT-ERR + RV051-UNIT-COST-AMT      37470037
374800           END-IF                                                 37480037
374900*            DISPLAY '**************************************'     37490037
375000*            DISPLAY '***AFTER******************************'     37500037
375100*            DISPLAY '** PARAGRAPH = 7015-SUM-ERROR-VALUES*'      37510037
375200*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         37520037
375300*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     37530037
375400*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        37540037
375500*            DISPLAY '** TOTAL RETAL: ' PA-TOT-DD-RTL-ERR         37550037
375600*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       37560037
375700*            DISPLAY '** TOTAL UNIT : ' PA-TOT-DD-UNT-ERR         37570037
375800*            DISPLAY '**************************************'     37580037
375900        END-IF                                                    37590037
376000        IF RV051-DTL-RETURN-TYPE = PC-M                           37600037
376100           ADD +1 TO PA-TOT-MOS-COUNT-ERR                         37610037
376200*            DISPLAY '**************************************'     37620037
376300*            DISPLAY '***BEFORE*****************************'     37630037
376400*            DISPLAY '** PARAGRAPH = 7015-SUM-ERROR-VALUES*'      37640037
376500*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         37650037
376600*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     37660037
376700*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        37670037
376800*            DISPLAY '** TOTAL RETAL: ' PA-TOT-MOS-RTL-ERR        37680037
376900*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       37690037
377000*            DISPLAY '** TOTAL UNIT : ' PA-TOT-MOS-UNT-ERR        37700037
377100*            DISPLAY '**************************************'     37710037
377200                                                                  37720037
377300           IF RV051-RTL-COST-AMT NUMERIC                          37730037
377400           COMPUTE PA-TOT-MOS-RTL-ERR =                           37740037
377500                   PA-TOT-MOS-RTL-ERR + RV051-RTL-COST-AMT        37750037
377600           END-IF                                                 37760037
377700                                                                  37770037
377800           IF RV051-UNIT-COST-AMT NUMERIC                         37780037
377900           COMPUTE PA-TOT-MOS-UNT-ERR =                           37790037
378000                   PA-TOT-MOS-UNT-ERR + RV051-UNIT-COST-AMT       37800037
378100           END-IF                                                 37810037
378200*            DISPLAY '**************************************'     37820037
378300*            DISPLAY '***AFTER******************************'     37830037
378400*            DISPLAY '** PARAGRAPH = 7015-SUM-ERROR-VALUES*'      37840037
378500*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         37850037
378600*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     37860037
378700*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        37870037
378800*            DISPLAY '** TOTAL RETAL: ' PA-TOT-MOS-RTL-ERR        37880037
378900*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       37890037
379000*            DISPLAY '** TOTAL UNIT : ' PA-TOT-MOS-UNT-ERR        37900037
379100*            DISPLAY '**************************************'     37910037
379200                                                                  37920037
379300        END-IF                                                    37930037
379400                                                                  37940037
379500        IF RV051-DTL-RETURN-TYPE = PC-R                           37950037
379600           ADD +1 TO PA-TOT-RTV-COUNT-ERR                         37960037
379700*            DISPLAY '**************************************'     37970037
379800*            DISPLAY '***BEFORE*****************************'     37980037
379900*            DISPLAY '** PARAGRAPH = 7015-SUM-ERROR-VALUES*'      37990037
380000*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         38000037
380100*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     38010037
380200*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        38020037
380300*            DISPLAY '** TOTAL RETAL: ' PA-TOT-RTV-RTL-ERR        38030037
380400*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       38040037
380500*            DISPLAY '** TOTAL UNIT : ' PA-TOT-RTV-UNT-ERR        38050037
380600*            DISPLAY '**************************************'     38060037
380700           IF RV051-RTL-COST-AMT NUMERIC                          38070037
380800             COMPUTE PA-TOT-RTV-RTL-ERR =                         38080037
380900                     PA-TOT-RTV-RTL-ERR + RV051-RTL-COST-AMT      38090037
381000           END-IF                                                 38100037
381100                                                                  38110037
381200           IF RV051-UNIT-COST-AMT NUMERIC                         38120037
381300             COMPUTE PA-TOT-RTV-UNT-ERR =                         38130037
381400                     PA-TOT-RTV-UNT-ERR + RV051-UNIT-COST-AMT     38140037
381500           END-IF                                                 38150037
381600*            DISPLAY '**************************************'     38160037
381700*            DISPLAY '***AFTER******************************'     38170037
381800*            DISPLAY '** PARAGRAPH = 7015-SUM-ERROR-VALUES*'      38180037
381900*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         38190037
382000*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     38200037
382100*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        38210037
382200*            DISPLAY '** TOTAL RETAL: ' PA-TOT-RTV-RTL-ERR        38220037
382300*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       38230037
382400*            DISPLAY '** TOTAL UNIT : ' PA-TOT-RTV-UNT-ERR        38240037
382500*            DISPLAY '**************************************'     38250037
382600                                                                  38260037
382700        END-IF                                                    38270037
382800     ELSE                                                         38280037
382900      ADD +1 TO PA-TOT-UNK-COUNT-UNK                              38290037
383000*            DISPLAY '**************************************'     38300037
383100*            DISPLAY '***BEFORE*****************************'     38310037
383200*            DISPLAY '** PARAGRAPH = 7015-SUM-ERROR-VALUES*'      38320037
383300*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         38330037
383400*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     38340037
383500*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        38350037
383600*            DISPLAY '** TOTAL RETAL: ' PA-TOT-UNK-RTL-UNK        38360037
383700*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       38370037
383800*            DISPLAY '** TOTAL UNIT : ' PA-TOT-UNK-UNT-UNK        38380037
383900*            DISPLAY '**************************************'     38390037
384000      IF RV051-RTL-COST-AMT NUMERIC                               38400037
384100      COMPUTE PA-TOT-UNK-RTL-UNK =                                38410037
384200              PA-TOT-UNK-RTL-UNK + RV051-RTL-COST-AMT             38420037
384300      END-IF                                                      38430037
384400                                                                  38440037
384500      IF RV051-UNIT-COST-AMT NUMERIC                              38450037
384600      COMPUTE PA-TOT-UNK-UNT-UNK =                                38460037
384700              PA-TOT-UNK-UNT-UNK + RV051-UNIT-COST-AMT            38470037
384800      END-IF                                                      38480037
384900*            DISPLAY '**************************************'     38490037
385000*            DISPLAY '***AFTER******************************'     38500037
385100*            DISPLAY '** PARAGRAPH = 7015-SUM-ERROR-VALUES*'      38510037
385200*            DISPLAY '** DTL DFCT ORD:' RV051-DFCT-ORD-ID         38520037
385300*            DISPLAY '** RETURN TYPE: ' RV051-DTL-RETURN-TYPE     38530037
385400*            DISPLAY '** RETAIL COST: ' RV051-RTL-COST-AMT        38540037
385500*            DISPLAY '** TOTAL RETAL: ' PA-TOT-UNK-RTL-UNK        38550037
385600*            DISPLAY '** UNIT   COST: ' RV051-UNIT-COST-AMT       38560037
385700*            DISPLAY '** TOTAL UNIT : ' PA-TOT-UNK-UNT-UNK        38570037
385800*            DISPLAY '**************************************'     38580037
385900                                                                  38590037
386000     END-IF.                                                      38600037
386100                                                                  38610037
386200******************************************************************38620037
386300* GET THE CURRENT MKOUT-ORD-ID                                   *38630037
386400******************************************************************38640037
386500 7050-GET-MKOUT-ORD-ID.                                           38650037
386600                                                                  38660037
386700     PERFORM                                                      38670037
386800       WITH TEST AFTER                                            38680037
386900       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       38690037
387000       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              38700037
387100               SQLCODE = ZERO                                     38710037
387200                                                                  38720037
387300     EXEC SQL                                                     38730037
387400      SELECT DFCT_ORD_ID                                          38740037
387500            ,MKOUT_ORD_ID                                         38750037
387600       INTO :DFORCR-DFCT-ORD-ID                                   38760037
387700           ,:DFORCR-MKOUT-ORD-ID                                  38770037
387800       FROM TDFORCR                                               38780037
387900     END-EXEC                                                     38790037
388000                                                                  38800037
388100         EVALUATE TRUE                                            38810037
388200             WHEN SQLCODE = ZERO                                  38820037
388300                 MOVE DFORCR-DFCT-ORD-ID                          38830037
388400                                 TO PV-HOLD-DFORCR-DFCT-ORD-ID    38840037
388500                                                                  38850037
388600             WHEN SQLWARN0 NOT EQUAL SPACE                        38860037
388700             WHEN SQLCODE NOT EQUAL ZERO                          38870037
388800                 DISPLAY '**************************************' 38880037
388900                 DISPLAY '** ABEND                            **' 38890037
389000                 DISPLAY '** PROGRAM = RVKUP002               **' 38900037
389100                 DISPLAY '** PARAGRAPH = 7050-GET-MKOUT-ORD-ID**' 38910037
389200                 DISPLAY '** SELECT TDFORCR                   **' 38920037
389300                 DISPLAY '** DTL DFCT-ORD-ID: ' RV051-DFCT-ORD-ID 38930037
389400                 DISPLAY '** DTL REC SEQ NBR: ' RV051-SEQ-NBR     38940037
389500                 DISPLAY '**************************************' 38950037
389600                 PERFORM 9100-SQL-ABEND                           38960037
389700         END-EVALUATE                                             38970037
389800     END-PERFORM.                                                 38980037
389900                                                                  38990037
390000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    39000037
390100         (SQLCODE NOT = ZERO)                                     39010037
390200        DISPLAY '********************************************'    39020037
390300        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    39030037
390400        DISPLAY '** SELECT TDFORCR                         **'    39040037
390500        DISPLAY '** PARAGRAPH = 7050-GET-MKOUT-ORD-ID      **'    39050037
390600        DISPLAY '** DTL DFCT-ORD-ID: ' RV051-DFCT-ORD-ID          39060037
390700        DISPLAY '** DTL REC SEQ NBR: ' RV051-SEQ-NBR              39070037
390800        DISPLAY '********************************************'    39080037
390900      PERFORM 9100-SQL-ABEND                                      39090037
391000     END-IF.                                                      39100037
391100                                                                  39110037
391200******************************************************************39120037
391300* INSERT A ROW INTO TDFMEIT                                      *39130037
391400******************************************************************39140037
391500 7100-INSERT-TDFMEIT.                                             39150037
391600                                                                  39160037
391700     INITIALIZE DCLTDFMEIT.                                       39170037
391800     PERFORM 7105-LOAD-DCLTDFMEIT.                                39180037
391900                                                                  39190037
392000     PERFORM                                                      39200037
392100       WITH TEST AFTER                                            39210037
392200       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       39220037
392300       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              39230037
392400               SQLCODE = ZERO                                     39240037
392500                                                                  39250037
392600     EXEC SQL                                                     39260037
392700         INSERT INTO TDFMEIT                                      39270037
392800             ( DFCT_ORD_ID                                        39280037
392900              ,SEQ_NBR                                            39290037
393000              ,DFCT_ITEM_NBR                                      39300037
393100              ,DFCT_RET_DTE                                       39310037
393200              ,RTL_COST_AMT                                       39320037
393300              ,UNIT_COST_AMT                                      39330037
393400              ,MKOUT_ORD_ID                                       39340037
393500              ,MKOUT_ORD_STAT_CDE                                 39350037
393600              ,MDSE_DEPT_NBR                                      39360037
393700              ,MDSE_CLASS_NBR                                     39370037
393800              ,LOC_NBR                                            39380037
393900             )                                                    39390037
394000            VALUES                                                39400037
394100             (:DFMEIT-DFCT-ORD-ID                                 39410037
394200             ,:DFMEIT-SEQ-NBR                                     39420037
394300             ,:DFMEIT-DFCT-ITEM-NBR                               39430037
394400             ,:DFMEIT-DFCT-RET-DTE                                39440037
394500             ,:DFMEIT-RTL-COST-AMT                                39450037
394600             ,:DFMEIT-UNIT-COST-AMT                               39460037
394700             ,:DFMEIT-MKOUT-ORD-ID                                39470037
394800             ,:DFMEIT-MKOUT-ORD-STAT-CDE                          39480037
394900             ,:DFMEIT-MDSE-DEPT-NBR                               39490037
395000             ,:DFMEIT-MDSE-CLASS-NBR                              39500037
395100             ,:DFMEIT-LOC-NBR                                     39510037
395200             )                                                    39520037
395300     END-EXEC                                                     39530037
395400                                                                  39540037
395500         EVALUATE TRUE                                            39550037
395600             WHEN SQLCODE = ZERO                                  39560037
395700                 SET PS-TDFMEIT-INSERT-YES TO TRUE                39570037
395800                 ADD +1    TO PA-TOT-DTL-INS                      39580037
395900                                                                  39590037
396000             WHEN SQLWARN0 NOT EQUAL SPACE                        39600037
396100             WHEN SQLCODE NOT EQUAL ZERO                          39610037
396200         DISPLAY '**************************************'         39620037
396300         DISPLAY '** ABEND                            **'         39630037
396400         DISPLAY '** PROGRAM = RVKUP002               **'         39640037
396500         DISPLAY '** PARAGRAPH = 7100-INSERT-TDFMEIT  **'         39650037
396600         DISPLAY '** INSERT INTO TDFMEIT              **'         39660037
396700         DISPLAY ' DTL DFCT-ORD-ID: ' TBL-DFCT-ORD-ID (DTL-INDEX) 39670037
396800         DISPLAY ' DTL REC SEQ NBR: ' TBL-SEQ-NBR (DTL-INDEX)     39680037
396900         DISPLAY '**************************************'         39690037
397000         PERFORM 9100-SQL-ABEND                                   39700037
397100         END-EVALUATE                                             39710037
397200     END-PERFORM.                                                 39720037
397300                                                                  39730037
397400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    39740037
397500         (SQLCODE NOT = ZERO)                                     39750037
397600        DISPLAY '********************************************'    39760037
397700        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    39770037
397800        DISPLAY '** INSERT TO TDFMEIT                      **'    39780037
397900        DISPLAY '** PARAGRAPH = 7100-INSERT-TDFMEIT        **'    39790037
398000        DISPLAY '** DTL DFCT-ORD-ID: ' TBL-DFCT-ORD-ID (DTL-INDEX)39800037
398100        DISPLAY '** DTL REC SEQ NBR: ' TBL-SEQ-NBR (DTL-INDEX)    39810037
398200        DISPLAY '********************************************'    39820037
398300      PERFORM 9100-SQL-ABEND                                      39830037
398400     END-IF.                                                      39840037
398500                                                                  39850037
398600******************************************************************39860037
398700* LOAD FIELDS FOR THE TDFMEIT INSERT                             *39870037
398800******************************************************************39880037
398900 7105-LOAD-DCLTDFMEIT.                                            39890037
399000                                                                  39900037
399100     MOVE TBL-DFCT-ORD-ID (DTL-INDEX)   TO DFMEIT-DFCT-ORD-ID.    39910037
399200     MOVE TBL-SEQ-NBR (DTL-INDEX)       TO DFMEIT-SEQ-NBR.        39920037
399300     MOVE TBL-DFCT-ITEM-NBR (DTL-INDEX) TO DFMEIT-DFCT-ITEM-NBR.  39930037
399400     MOVE TBL-DFCT-RET-DTE (DTL-INDEX)  TO DFMEIT-DFCT-RET-DTE.   39940037
399500     MOVE TBL-RTL-COST-AMT (DTL-INDEX)  TO DFMEIT-RTL-COST-AMT.   39950037
399600     MOVE TBL-UNIT-COST-AMT (DTL-INDEX) TO DFMEIT-UNIT-COST-AMT.  39960037
399700     IF PS-RETURN-TYPE-MARK-OUT                                   39970037
399800        MOVE PV-CURRENT-MKOUT-ORD-ID    TO DFMEIT-MKOUT-ORD-ID    39980037
399900     ELSE                                                         39990037
400000        MOVE TBL-MKOUT-ORD-ID (DTL-INDEX) TO DFMEIT-MKOUT-ORD-ID  40000037
400100     END-IF.                                                      40010037
400200     MOVE TBL-MKOUT-ORD-STAT-CDE (DTL-INDEX)                      40020037
400300                                     TO DFMEIT-MKOUT-ORD-STAT-CDE.40030037
400400     MOVE TBL-MDSE-DEPT-NBR (DTL-INDEX)  TO DFMEIT-MDSE-DEPT-NBR. 40040037
400500     MOVE TBL-MDSE-CLASS-NBR (DTL-INDEX) TO DFMEIT-MDSE-CLASS-NBR.40050037
400600     MOVE TBL-LOC-NBR (DTL-INDEX)        TO DFMEIT-LOC-NBR.       40060037
400700     MOVE PC-SPACE                       TO DFMEIT-HAZ-TYP-CDE.   40070037
400800                                                                  40080037
400900******************************************************************40090037
401000* FOR EACH RETURN-TYPE, D&D, RTV AND MOS, TABULATE THE REC COUNT,*40100037
401100* AND TOT OF RTL_COST_APPLID AND UNIT_COST_APPLIED FOR THE       *40110037
401200* APPLIED RECORDS.                                               *40120037
401300******************************************************************40130037
401400 7150-SUM-APPLIED-VALUES.                                         40140037
401500                                                                  40150037
401600     IF RV051-DTL-RETURN-TYPE  = PC-D                             40160037
401700      OR RV051-DTL-RETURN-TYPE = PC-M                             40170037
401800      OR RV051-DTL-RETURN-TYPE = PC-R                             40180037
401900                                                                  40190037
402000        IF TBL-DTL-RETURN-TYPE (DTL-INDEX) = PC-D                 40200037
402100           ADD +1 TO PA-TOT-DD-COUNT-APPLID                       40210037
402200           COMPUTE PA-TOT-DD-RTL-APPLID =                         40220037
402300            PA-TOT-DD-RTL-APPLID + TBL-RTL-COST-AMT (DTL-INDEX)   40230037
402400*                  PA-TOT-DD-RTL-APPLID + RV051-RTL-COST-AMT      40240037
402500           COMPUTE PA-TOT-DD-UNT-APPLID =                         40250037
402600            PA-TOT-DD-UNT-APPLID + TBL-UNIT-COST-AMT (DTL-INDEX)  40260037
402700*                  PA-TOT-DD-UNT-APPLID + RV051-UNIT-COST-AMT     40270037
402800        END-IF                                                    40280037
402900                                                                  40290037
403000        IF TBL-DTL-RETURN-TYPE (DTL-INDEX) = PC-M                 40300037
403100           ADD +1 TO PA-TOT-MOS-COUNT-APPLID                      40310037
403200           COMPUTE PA-TOT-MOS-RTL-APPLID =                        40320037
403300            PA-TOT-MOS-RTL-APPLID + TBL-RTL-COST-AMT (DTL-INDEX)  40330037
403400*                  PA-TOT-MOS-RTL-APPLID + RV051-RTL-COST-AMT     40340037
403500           COMPUTE PA-TOT-MOS-UNT-APPLID =                        40350037
403600            PA-TOT-MOS-UNT-APPLID + TBL-UNIT-COST-AMT (DTL-INDEX) 40360037
403700*                  PA-TOT-MOS-UNT-APPLID + RV051-UNIT-COST-AMT    40370037
403800        END-IF                                                    40380037
403900                                                                  40390037
404000        IF TBL-DTL-RETURN-TYPE (DTL-INDEX) = PC-R                 40400037
404100           ADD +1 TO PA-TOT-RTV-COUNT-APPLID                      40410037
404200             COMPUTE PA-TOT-RTV-RTL-APPLID =                      40420037
404300              PA-TOT-RTV-RTL-APPLID + TBL-RTL-COST-AMT (DTL-INDEX)40430037
404400*                 PA-TOT-RTV-RTL-APPLID + RV051-RTL-COST-AMT      40440037
404500             COMPUTE PA-TOT-RTV-UNT-APPLID =                      40450037
404600             PA-TOT-RTV-UNT-APPLID + TBL-UNIT-COST-AMT (DTL-INDEX)40460037
404700*                 PA-TOT-RTV-UNT-APPLID + RV051-UNIT-COST-AMT     40470037
404800        END-IF                                                    40480037
404900*    ELSE                                                         40490037
405000*     ADD +1 TO PA-TOT-UNK-COUNT-APPLID                           40500037
405100*     IF RV051-RTL-COST-APPLID NUMERIC                            40510037
405200*     COMPUTE PA-TOT-UNK-RTL-APPLID=                              40520037
405300*             PA-TOT-UNK-RTL-APPLID + RV051-RTL-COST-AMT          40530037
405400*     END-IF                                                      40540037
405500*                                                                 40550037
405600*     IF RV051-UNIT-COST-APPLID NUMERIC                           40560037
405700*     COMPUTE PA-TOT-UNK-UNT-APPLID=                              40570037
405800*             PA-TOT-UNK-UNT-APPLID + RV051-UNIT-COST-AMT         40580037
405900*     END-IF                                                      40590037
406000     END-IF.                                                      40600037
406100******************************************************************40610037
406200* INSERT A ROW INTO RVT_DFCT_ITM_STAT                            *40620037
406300******************************************************************40630037
406400 7200-INSERT-RVT-DFCT-ITM-STAT.                                   40640037
406500                                                                  40650037
406600     INITIALIZE DCLRVT00002.                                      40660037
406700     PERFORM 7205-LOAD-DCLRVT00002.                               40670037
406800                                                                  40680037
406900     PERFORM                                                      40690037
407000       WITH TEST AFTER                                            40700037
407100       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       40710037
407200       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              40720037
407300               SQLCODE = ZERO                                     40730037
407400                                                                  40740037
407500     EXEC SQL                                                     40750037
407600         INSERT INTO RVT_DFCT_ITM_STAT                            40760037
407700             ( DFCT_ORD_ID                                        40770037
407800              ,SEQ_NBR                                            40780037
407900              ,SCND_TMST                                          40790037
408000              ,USR_ID                                             40800037
408100             )                                                    40810037
408200            VALUES                                                40820037
408300             (:RVT00002-DFCT-ORD-ID                               40830037
408400             ,:RVT00002-SEQ-NBR                                   40840037
408500             ,:RVT00002-SCND-TMST                                 40850037
408600             ,:RVT00002-USR-ID                                    40860037
408700             )                                                    40870037
408800     END-EXEC                                                     40880037
408900                                                                  40890037
409000         EVALUATE TRUE                                            40900037
409100             WHEN SQLCODE = ZERO                                  40910037
409200                 ADD +1    TO PA-TOT-DTLSTAT-INS                  40920037
409300                                                                  40930037
409400             WHEN SQLWARN0 NOT EQUAL SPACE                        40940037
409500             WHEN SQLCODE NOT EQUAL ZERO                          40950037
409600                 DISPLAY '**************************************' 40960037
409700                 DISPLAY '** ABEND                            **' 40970037
409800                 DISPLAY '** PROGRAM = RVKUP002               **' 40980037
409900            DISPLAY '** PARAGRAPH = 7200-INSERT-RVT-DFCT-ITM-STAT'40990037
410000                 DISPLAY '** INSERT INTO TDFMEIT              **' 41000037
410100                 DISPLAY '** DTL DFCT-ORD-ID: ' RV051-DFCT-ORD-ID 41010037
410200                 DISPLAY '** DTL REC SEQ NBR: ' RV051-SEQ-NBR     41020037
410300                 DISPLAY '**************************************' 41030037
410400                 PERFORM 9100-SQL-ABEND                           41040037
410500         END-EVALUATE                                             41050037
410600     END-PERFORM.                                                 41060037
410700                                                                  41070037
410800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    41080037
410900         (SQLCODE NOT = ZERO)                                     41090037
411000        DISPLAY '********************************************'    41100037
411100        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    41110037
411200        DISPLAY '** INSERT TO RVT_DFCT_ITM_STAT            **'    41120037
411300        DISPLAY '** PARAGRAPH = 7200-INSERT-RVT-DFCT-ITM-STAT'    41130037
411400        DISPLAY '** DTL DFCT-ORD-ID: ' RV051-DFCT-ORD-ID          41140037
411500        DISPLAY '** DTL REC SEQ NBR: ' RV051-SEQ-NBR              41150037
411600        DISPLAY '********************************************'    41160037
411700      PERFORM 9100-SQL-ABEND                                      41170037
411800     END-IF.                                                      41180037
411900                                                                  41190037
412000******************************************************************41200037
412100* LOAD FIELDS FOR THE RVT_DFCT_ITM_STAT INSERT                    41210037
412200******************************************************************41220037
412300 7205-LOAD-DCLRVT00002.                                           41230037
412400                                                                  41240037
412500     MOVE TBL-DFCT-ORD-ID (DTL-INDEX) TO RVT00002-DFCT-ORD-ID.    41250037
412600     MOVE TBL-SEQ-NBR (DTL-INDEX)     TO RVT00002-SEQ-NBR.        41260037
412700     MOVE TBL-DFCT-RET-DTE (DTL-INDEX)                            41270037
412800                                   TO RVT00002-SCND-TMST (1:10).  41280037
412900     MOVE PC-DEFAULT-TIME-2400     TO RVT00002-SCND-TMST (11:16). 41290037
413000     MOVE PC-DEFAULT-USR-ID        TO RVT00002-USR-ID.            41300037
413100                                                                  41310037
413200******************************************************************41320037
413300* CHECK RVT_DFTC_SHIPT TO SEE IF A ROW ALREADY EXISTS            *41330037
413400******************************************************************41340037
413500 7300-CHECK-RVT-DFCT-SHIPT.                                       41350037
413600                                                                  41360037
413700     SET PS-INSERT-RVT-DFCT-SHIPT-YES   TO TRUE.                  41370037
413800                                                                  41380037
413900     EXEC SQL                                                     41390037
414000      SELECT S.DFCT_SHIPT_ID                                      41400037
414100       INTO :RVT00001-DFCT-SHIPT-ID                               41410037
414200       FROM RVT_DFCT_SHIPT S                                      41420037
414300           ,TDFCTOR  H                                            41430037
414400       WHERE H.DFCT_SHIPT_ID  = S.DFCT_SHIPT_ID                   41440037
414500         AND H.CARR_TRKG_ID = :RV050-CARR-TRKG-ID                 41450037
414600         AND S.SCAC_CDE     = :RV050-SCAC-CDE                     41460037
414700     END-EXEC.                                                    41470037
414800                                                                  41480037
414900     EVALUATE TRUE                                                41490037
415000         WHEN SQLCODE = +0                                        41500037
415100         WHEN SQLCODE = -811                                      41510037
415200              SET PS-INSERT-RVT-DFCT-SHIPT-NO  TO TRUE            41520037
415300         WHEN SQLCODE = +100                                      41530037
415400              CONTINUE                                            41540037
415500         WHEN SQLWARN0 NOT EQUAL SPACE                            41550037
415600         WHEN SQLCODE NOT EQUAL ZERO                              41560037
415700             DISPLAY '******************************************' 41570037
415800             DISPLAY '** ABEND                                **' 41580037
415900             DISPLAY '** PROGRAM = RVKUP002                   **' 41590037
416000             DISPLAY '** PARAGRAPH = 7300-CHECK-RVT-DFCT-SHIPT**' 41600037
416100             DISPLAY '** CHECKING IF SHIPT ID IS ALREADY THERE**' 41610037
416200             DISPLAY '** HDR DFCT ORD ID  : ' RV050-DFCT-ORD-ID   41620037
416300             DISPLAY '** HDR CARR TRKG ID : ' RV050-CARR-TRKG-ID  41630037
416400             DISPLAY '** HDR SCAC CDE     : ' RV050-SCAC-CDE      41640037
416500             DISPLAY '******************************************' 41650037
416600             PERFORM 9100-SQL-ABEND                               41660037
416700     END-EVALUATE.                                                41670037
416800                                                                  41680037
416900******************************************************************41690037
417000* GENERATE A RANDOM NUMBER FOR THE DFCT_SHIPT_ID BASED ON THE    *41700037
417100* CURRENT DATE AND TIME VIA KOHL'S RANDOM NUMBER ROUTINE.        *41710037
417200******************************************************************41720037
417300 7320-GENER-RANDOM-NBR.                                           41730037
417400                                                                  41740037
417500     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     41750037
417600     CALL PC-RANDOM-NBR-GENERATOR USING                           41760037
417700                            DP902-RANDNBR-ROUTINE-FIELDS.         41770037
417800                                                                  41780037
417900                                                                  41790037
418000     IF DP902-SUCCESSFUL                                          41800037
418100         MOVE DP902-RANDOM-NUMBER   TO PV-RANDOM-NBR              41810037
418200     ELSE                                                         41820037
418300         MOVE '7320-GENER-RANDOM-NBR' TO PV-PARAGRAPH-NAME        41830037
418400         MOVE 'RANDOM NBR SUBROUINE FAILURE'                      41840037
418500                                      TO PV-ABEND-MESSAGE         41850037
418600         PERFORM 9200-NON-SQL-ABEND                               41860037
418700     END-IF.                                                      41870037
418800                                                                  41880037
418900******************************************************************41890037
419000* INSERT A ROW INTO RVT_DFCT_SHIPT                               *41900037
419100******************************************************************41910037
419200 7340-INSERT-RVT-DFCT-SHIPT.                                      41920037
419300                                                                  41930037
419400     INITIALIZE DCLRVT00000.                                      41940037
419500     PERFORM 7345-LOAD-DCLRVT00000.                               41950037
419600                                                                  41960037
419700     PERFORM                                                      41970037
419800       WITH TEST AFTER                                            41980037
419900       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       41990037
420000       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              42000037
420100               SQLCODE = ZERO                                     42010037
420200                                                                  42020037
420300     EXEC SQL                                                     42030037
420400         INSERT INTO RVT_DFCT_SHIPT                               42040037
420500             ( DFCT_SHIPT_ID                                      42050037
420600              ,TRLR_ID                                            42060037
420700              ,SCAC_CDE                                           42070037
420800              ,ACTL_SHIPT_DTE                                     42080037
420900             )                                                    42090037
421000            VALUES                                                42100037
421100             (:RVT00000-DFCT-SHIPT-ID                             42110037
421200             ,:RVT00000-TRLR-ID                                   42120037
421300             ,:RVT00000-SCAC-CDE                                  42130037
421400             ,:RVT00000-ACTL-SHIPT-DTE                            42140037
421500             )                                                    42150037
421600     END-EXEC                                                     42160037
421700                                                                  42170037
421800         EVALUATE TRUE                                            42180037
421900             WHEN SQLCODE = ZERO                                  42190037
422000                 ADD +1    TO PA-TOT-SHIPT-INS                    42200037
422100                                                                  42210037
422200             WHEN SQLCODE = -803                                  42220037
422300               DISPLAY '**************************************'   42230037
422400               DISPLAY '** PROGRAM = RVKUP002               **'   42240037
422500               DISPLAY '** PARAGRAPH = 7340-INSERT-RVT-DFCT-SHIPT'42250037
422600               DISPLAY '** INSERT INTO RVT_DFCT_SHIPT       **'   42260037
422700               DISPLAY '** DFCT SHIPT ID  : ' PV-DFCT-SHIPT-ID    42270037
422800               DISPLAY '**************************************'   42280037
422900               PERFORM 7320-GENER-RANDOM-NBR                      42290037
423000               MOVE PV-RANDOM-NBR    TO PV-DFCT-SHIPT-ID          42300037
423100               MOVE PV-DFCT-SHIPT-ID TO RVT00000-DFCT-SHIPT-ID    42310037
423200               DISPLAY '** NEW GENRATED NUMBER: ' PV-DFCT-SHIPT-ID42320038
423300               DISPLAY '**************************************'   42330038
423400                                                                  42340037
423500             WHEN SQLWARN0 NOT EQUAL SPACE                        42350037
423600             WHEN SQLCODE NOT EQUAL ZERO                          42360037
423700               DISPLAY '**************************************'   42370037
423800               DISPLAY '** ABEND                            **'   42380037
423900               DISPLAY '** PROGRAM = RVKUP002               **'   42390037
424000               DISPLAY '** PARAGRAPH = 7340-INSERT-RVT-DFCT-SHIPT'42400037
424100               DISPLAY '** INSERT INTO RVT_DFCT_SHIPT       **'   42410037
424200               DISPLAY '** HDR DFCT-ORD-ID: ' RV050-DFCT-ORD-ID   42420037
424300               DISPLAY '** DFCT SHIPT ID  : ' PV-DFCT-SHIPT-ID    42430037
424400               DISPLAY '**************************************'   42440037
424500               PERFORM 9100-SQL-ABEND                             42450037
424600         END-EVALUATE                                             42460037
424700     END-PERFORM.                                                 42470037
424800                                                                  42480037
424900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    42490037
425000         (SQLCODE NOT = ZERO)                                     42500037
425100        DISPLAY '********************************************'    42510037
425200        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    42520037
425300        DISPLAY '** INSERT TO RVT_DFCT_SHIPT               **'    42530037
425400        DISPLAY '** PARAGRAPH = 7340-INSERT-RVT-DFCT-SHIPT'       42540037
425500        DISPLAY '** HDR DFCT-ORD-ID: ' RV050-DFCT-ORD-ID          42550037
425600        DISPLAY '** DFCT SHIPT ID  : ' PV-DFCT-SHIPT-ID           42560037
425700        DISPLAY '********************************************'    42570037
425800      PERFORM 9100-SQL-ABEND                                      42580037
425900     END-IF.                                                      42590037
426000                                                                  42600037
426100******************************************************************42610037
426200* LOAD FIELDS FOR THE RVT_DFCT_SHIPT INSERT                       42620037
426300******************************************************************42630037
426400 7345-LOAD-DCLRVT00000.                                           42640037
426500                                                                  42650037
426600     MOVE PV-DFCT-SHIPT-ID         TO RVT00000-DFCT-SHIPT-ID.     42660037
426700     MOVE RV050-TRLR-ID            TO RVT00000-TRLR-ID.           42670037
426800     MOVE RV050-SCAC-CDE           TO RVT00000-SCAC-CDE.          42680037
426900     MOVE RV050-SHIPT-DTE          TO RVT00000-ACTL-SHIPT-DTE.    42690037
427000                                                                  42700037
427100******************************************************************42710037
427200* INSERT A ROW INTO RVT_SHIPT_STAT                               *42720037
427300******************************************************************42730037
427400 7360-INSERT-RVT-SHIPT-STATUS.                                    42740037
427500                                                                  42750037
427600     INITIALIZE DCLRVT00001.                                      42760037
427700     PERFORM 7365-LOAD-DCLRVT00001.                               42770037
427800                                                                  42780037
427900     PERFORM                                                      42790037
428000       WITH TEST AFTER                                            42800037
428100       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       42810037
428200       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              42820037
428300               SQLCODE = ZERO                                     42830037
428400                                                                  42840037
428500     EXEC SQL                                                     42850037
428600         INSERT INTO RVT_SHIPT_STAT                               42860037
428700             ( DFCT_SHIPT_ID                                      42870037
428800              ,CRE_TMST                                           42880037
428900              ,SHIPT_STAT_CDE                                     42890037
429000              ,USR_ID                                             42900037
429100             )                                                    42910037
429200            VALUES                                                42920037
429300             (:RVT00001-DFCT-SHIPT-ID                             42930037
429400             , CURRENT TIMESTAMP                                  42940037
429500             ,:RVT00001-SHIPT-STAT-CDE                            42950037
429600             ,:RVT00001-USR-ID                                    42960037
429700             )                                                    42970037
429800     END-EXEC                                                     42980037
429900                                                                  42990037
430000         EVALUATE TRUE                                            43000037
430100             WHEN SQLCODE = ZERO                                  43010037
430200                 ADD +1    TO PA-TOT-SHIPTSTAT-INS                43020037
430300                                                                  43030037
430400             WHEN SQLWARN0 NOT EQUAL SPACE                        43040037
430500             WHEN SQLCODE NOT EQUAL ZERO                          43050037
430600                 DISPLAY '**************************************' 43060037
430700                 DISPLAY '** ABEND                            **' 43070037
430800                 DISPLAY '** PROGRAM = RVKUP002               **' 43080037
430900               DISPLAY '** PARAGRAPH = 7360-INSERT-RVT-SHIPT-STAT'43090037
431000                 DISPLAY '** INSERT INTO RVT_SHIPT_STAT       **' 43100037
431100                 DISPLAY '** HDR DFCT-ORD-ID: ' RV050-DFCT-ORD-ID 43110037
431200                 DISPLAY '** DFCT SHIPT ID  : ' PV-DFCT-SHIPT-ID  43120037
431300                 DISPLAY '**************************************' 43130037
431400                 PERFORM 9100-SQL-ABEND                           43140037
431500         END-EVALUATE                                             43150037
431600     END-PERFORM.                                                 43160037
431700                                                                  43170037
431800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43180037
431900         (SQLCODE NOT = ZERO)                                     43190037
432000        DISPLAY '********************************************'    43200037
432100        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    43210037
432200        DISPLAY '** INSERT TO RVT_SHIPT_STAT               **'    43220037
432300        DISPLAY '** PARAGRAPH = 7360-INSERT-RVT-SHIPT-STAT'       43230037
432400        DISPLAY '** HDR DFCT-ORD-ID: ' RV050-DFCT-ORD-ID          43240037
432500        DISPLAY '** DFCT SHIPT ID  : ' PV-DFCT-SHIPT-ID           43250037
432600        DISPLAY '********************************************'    43260037
432700      PERFORM 9100-SQL-ABEND                                      43270037
432800     END-IF.                                                      43280037
432900                                                                  43290037
433000******************************************************************43300037
433100* LOAD FIELDS FOR THE RVT_SHIPT_STAT INSERT                       43310037
433200******************************************************************43320037
433300 7365-LOAD-DCLRVT00001.                                           43330037
433400     MOVE PV-DFCT-SHIPT-ID         TO RVT00001-DFCT-SHIPT-ID.     43340037
433500                                                                  43350037
433600     MOVE PC-S                     TO RVT00001-SHIPT-STAT-CDE.    43360037
433700                                                                  43370037
433800     MOVE PC-CURRENT-PROGRAM-NAME  TO RVT00001-USR-ID.            43380037
433900                                                                  43390037
434000******************************************************************43400037
434100* INSERT A ROW INTO TDFCTOR                                      *43410037
434200******************************************************************43420037
434300 7400-INSERT-TDFCTOR.                                             43430037
434400                                                                  43440037
434500     INITIALIZE DCLTDFCTOR.                                       43450037
434600     PERFORM 7405-LOAD-DCLTDFCTOR.                                43460037
434700                                                                  43470037
434800     PERFORM                                                      43480037
434900       WITH TEST AFTER                                            43490037
435000       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       43500037
435100       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              43510037
435200               SQLCODE = ZERO                                     43520037
435300                                                                  43530037
435400     EXEC SQL                                                     43540037
435500         INSERT INTO TDFCTOR                                      43550037
435600             ( DFCT_ORD_ID                                        43560037
435700              ,VENDOR_DUNS_NBR                                    43570037
435800              ,ORD_DTE                                            43580037
435900              ,DFCT_UID_NBR                                       43590037
436000              ,VEND_ATTN_NAME                                     43600037
436100              ,VEND_NAME                                          43610037
436200              ,VEND_ADDR_DESC                                     43620037
436300              ,VEND_CITY_NAME                                     43630037
436400              ,VEND_STATE_CDE                                     43640037
436500              ,VEND_ZIP_CDE                                       43650037
436600              ,PHN_AREA_CDE                                       43660037
436700              ,PHN_EXCH_NBR                                       43670037
436800              ,PHN_NBR                                            43680037
436900              ,FAX_PHN_AREA_CDE                                   43690037
437000              ,FAX_EXCH_NBR                                       43700037
437100              ,FAX_PHN_NBR                                        43710037
437200              ,OPER_UNT_ID                                        43720037
437300              ,LOC_ID                                             43730037
437400              ,DFCT_ORD_ID_CDE                                    43740037
437500              ,STATUS_CHG_DTE                                     43750037
437600              ,DFCT_ORD_STAT_CDE                                  43760037
437700              ,DFCT_SHIPT_ID                                      43770037
437800              ,VND_AUTH_ID                                        43780037
437900              ,VND_AUTH_DTE                                       43790037
438000              ,RET_RSN_CDE                                        43800037
438100              ,PAYT_TYP_CDE                                       43810037
438200              ,CART_QTY                                           43820037
438300              ,INBD_RET_FRGT_AMT                                  43830037
438400              ,OTBND_RET_FRGT_AMT                                 43840037
438500              ,DED_CHRG_AMT                                       43850037
438600              ,DFCT_WT_QTY                                        43860037
438700              ,DISC_PCT                                           43870037
438800              ,DISC_AMT                                           43880037
438900              ,SPC_INSTR_TXT                                      43890037
439000              ,VND_EMAIL_ADDR                                     43900037
439100              ,CARR_TRKG_ID                                       43910037
439200             )                                                    43920037
439300            VALUES                                                43930037
439400             (:DFCTOR-DFCT-ORD-ID                                 43940037
439500             ,:DFCTOR-VENDOR-DUNS-NBR                             43950037
439600             ,:DFCTOR-ORD-DTE                                     43960037
439700             ,:DFCTOR-DFCT-UID-NBR                                43970037
439800             ,:DFCTOR-VEND-ATTN-NAME                              43980037
439900             ,:DFCTOR-VEND-NAME                                   43990037
440000             ,:DFCTOR-VEND-ADDR-DESC                              44000037
440100             ,:DFCTOR-VEND-CITY-NAME                              44010037
440200             ,:DFCTOR-VEND-STATE-CDE                              44020037
440300             ,:DFCTOR-VEND-ZIP-CDE                                44030037
440400             ,:DFCTOR-PHN-AREA-CDE                                44040037
440500             ,:DFCTOR-PHN-EXCH-NBR                                44050037
440600             ,:DFCTOR-PHN-NBR                                     44060037
440700             ,:DFCTOR-FAX-PHN-AREA-CDE                            44070037
440800             ,:DFCTOR-FAX-EXCH-NBR                                44080037
440900             ,:DFCTOR-FAX-PHN-NBR                                 44090037
441000             ,:DFCTOR-OPER-UNT-ID                                 44100037
441100             ,:DFCTOR-LOC-ID                                      44110037
441200             ,:DFCTOR-DFCT-ORD-ID-CDE                             44120037
441300             ,:DFCTOR-STATUS-CHG-DTE                              44130037
441400             ,:DFCTOR-DFCT-ORD-STAT-CDE                           44140037
441500             ,:DFCTOR-DFCT-SHIPT-ID:NI-DFCT-SHIPT-ID              44150037
441600             ,:DFCTOR-VND-AUTH-ID                                 44160037
441700             ,:DFCTOR-VND-AUTH-DTE:NI-VND-AUTH-DTE                44170037
441800             ,:DFCTOR-RET-RSN-CDE                                 44180037
441900             ,:DFCTOR-PAYT-TYP-CDE                                44190037
442000             ,:DFCTOR-CART-QTY                                    44200037
442100             ,:DFCTOR-INBD-RET-FRGT-AMT                           44210037
442200             ,:DFCTOR-OTBND-RET-FRGT-AMT                          44220037
442300             ,:DFCTOR-DED-CHRG-AMT                                44230037
442400             ,:DFCTOR-DFCT-WT-QTY                                 44240037
442500             ,:DFCTOR-DISC-PCT                                    44250037
442600             ,:DFCTOR-DISC-AMT                                    44260037
442700             ,:DFCTOR-SPC-INSTR-TXT                               44270037
442800             ,:DFCTOR-VND-EMAIL-ADDR                              44280037
442900             ,:DFCTOR-CARR-TRKG-ID                                44290037
443000             )                                                    44300037
443100     END-EXEC                                                     44310037
443200                                                                  44320037
443300         EVALUATE TRUE                                            44330037
443400             WHEN SQLCODE = ZERO                                  44340037
443500                 ADD +1    TO PA-TOT-HDR-INS                      44350037
443600                                                                  44360037
443700             WHEN SQLWARN0 NOT EQUAL SPACE                        44370037
443800             WHEN SQLCODE NOT EQUAL ZERO                          44380037
443900                 DISPLAY '**************************************' 44390037
444000                 DISPLAY '** ABEND                            **' 44400037
444100                 DISPLAY '** PROGRAM = RVKUP002               **' 44410037
444200                 DISPLAY '** PARAGRAPH = 7400-INSERT-TDFCTOR  **' 44420037
444300                 DISPLAY '** INSERT INTO TDFCTOR              **' 44430037
444400                 DISPLAY '** HDR DFCT-ORD-ID : ' RV050-DFCT-ORD-ID44440037
444500                 DISPLAY '** HDR DFCT-SHIPT-ID: ' PV-DFCT-SHIPT-ID44450037
444600                 DISPLAY '**************************************' 44460037
444700                 PERFORM 9100-SQL-ABEND                           44470037
444800         END-EVALUATE                                             44480037
444900     END-PERFORM.                                                 44490037
445000                                                                  44500037
445100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44510037
445200         (SQLCODE NOT = ZERO)                                     44520037
445300        DISPLAY '********************************************'    44530037
445400        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    44540037
445500        DISPLAY '** INSERT TO TDFCTOR                      **'    44550037
445600        DISPLAY '** PARAGRAPH = 7400-INSERT-TDFCTOR        **'    44560037
445700        DISPLAY '** HDR DFCT-ORD-ID  : ' RV050-DFCT-ORD-ID        44570037
445800        DISPLAY '** HDR DFCT-SHIPT-ID: ' PV-DFCT-SHIPT-ID         44580037
445900        DISPLAY '********************************************'    44590037
446000      PERFORM 9100-SQL-ABEND                                      44600037
446100     END-IF.                                                      44610037
446200                                                                  44620037
446300******************************************************************44630037
446400* LOAD FIELDS FOR THE TDFCTOR INSERT                              44640037
446500******************************************************************44650037
446600 7405-LOAD-DCLTDFCTOR.                                            44660037
446700                                                                  44670037
446800     MOVE RV050-DFCT-ORD-ID        TO DFCTOR-DFCT-ORD-ID.         44680037
446900     MOVE RV050-VENDOR-DUNS-NBR    TO DFCTOR-VENDOR-DUNS-NBR.     44690037
447000     MOVE RV050-ORD-DTE            TO DFCTOR-ORD-DTE.             44700037
447100     MOVE PC-DEFAULT-USR-ID        TO DFCTOR-DFCT-UID-NBR.        44710037
447200     MOVE RV050-VEND-ATTN-NAME     TO DFCTOR-VEND-ATTN-NAME.      44720037
447300     MOVE RV050-VEND-NAME          TO DFCTOR-VEND-NAME.           44730037
447400     MOVE RV050-VEND-ADDR-DESC     TO DFCTOR-VEND-ADDR-DESC.      44740037
447500     MOVE RV050-CITY               TO DFCTOR-VEND-CITY-NAME.      44750037
447600     MOVE RV050-STATE-CDE          TO DFCTOR-VEND-STATE-CDE.      44760037
447700     MOVE RV050-ZIPCODE            TO DFCTOR-VEND-ZIP-CDE.        44770037
447800     MOVE RV050-PHN-AREA-CDE       TO DFCTOR-PHN-AREA-CDE.        44780037
447900     MOVE RV050-PHN-EXCH-NBR       TO DFCTOR-PHN-EXCH-NBR.        44790037
448000     MOVE RV050-PHN-NBR            TO DFCTOR-PHN-NBR.             44800037
448100     MOVE RV050-FAX-PHN-AREA-CDE   TO DFCTOR-FAX-PHN-AREA-CDE.    44810037
448200     MOVE RV050-FAX-EXCH-NBR       TO DFCTOR-FAX-EXCH-NBR.        44820037
448300     MOVE RV050-FAX-PHN-NBR        TO DFCTOR-FAX-PHN-NBR.         44830037
448400     MOVE RV050-OPER-UNT-ID        TO DFCTOR-OPER-UNT-ID.         44840037
448500     MOVE RV050-LOC-ID             TO DFCTOR-LOC-ID.              44850037
448600     MOVE RV050-RETURN-TYPE        TO DFCTOR-DFCT-ORD-ID-CDE.     44860037
448700     MOVE RV050-STATUS-CHG-DTE     TO DFCTOR-STATUS-CHG-DTE.      44870037
448800     MOVE RV050-DFCT-ORD-STAT-CDE  TO DFCTOR-DFCT-ORD-STAT-CDE.   44880037
448900** THE PV-DFCT-SHIPT-ID IS THE RAND NBR GENERATED FIELD           44890037
449000     IF PS-INSERT-RVT-DFCT-SHIPT-YES                              44900037
449100        MOVE PV-DFCT-SHIPT-ID      TO DFCTOR-DFCT-SHIPT-ID        44910037
449200     ELSE                                                         44920037
449300        MOVE RVT00001-DFCT-SHIPT-ID TO DFCTOR-DFCT-SHIPT-ID       44930037
449400     END-IF.                                                      44940037
449500***WHEN RETURN-TYPE = 'D' & CARR-TRKG-ID NOT SENT, THEN THIS IS   44950037
449600***A DEBIT & DISPOSED - SO THERE ARE NO SHIPPING ROWS AND         44960037
449700***THE DFCT-SHIPT-ID SHOULD BE NULLS TO AVOID REFERENTIAL         44970037
449800***INTEGRITY ISSUES BETWEEN TDFCTOR & RVT_DFCT_SHIPT -            44980037
449900***OTHERWISE MOVE 0 TO THE NULL IND SO THE DFCT-SHIPT-ID          44990037
450000***CAN EITHER BE THEMATCH THAT WAS FOUND FROM THE RVT_DFCT_SHIPT  45000037
450100***TBL OR THE GENERATED RANDOM NBR                                45010037
450200     IF RV050-RETURN-TYPE = PC-D                                  45020037
450300      AND (RV050-CARR-TRKG-ID < PC-SPACE OR                       45030037
450400            RV050-CARR-TRKG-ID = PC-SPACE)                        45040037
450500        MOVE -1 TO NI-DFCT-SHIPT-ID                               45050037
450600     ELSE                                                         45060037
450700        MOVE 0 TO NI-DFCT-SHIPT-ID                                45070037
450800     END-IF.                                                      45080037
450900     MOVE RV050-VND-AUTH-NBR       TO DFCTOR-VND-AUTH-ID.         45090037
451000     MOVE RV050-VND-AUTH-DTE       TO DFCTOR-VND-AUTH-DTE.        45100037
451100     MOVE RV050-RET-RSN-CDE        TO DFCTOR-RET-RSN-CDE.         45110037
451200     MOVE RV050-PAYT-TYP-CDE       TO DFCTOR-PAYT-TYP-CDE.        45120037
451300     MOVE RV050-CART-QTY           TO DFCTOR-CART-QTY.            45130037
451400     IF RV050-INBD-RET-FRGT-SIGN = PC-NEG                         45140037
451500        COMPUTE DFCTOR-INBD-RET-FRGT-AMT =                        45150037
451600                (RV050-INBD-RET-FRGT-AMT * (-1))                  45160037
451700     ELSE                                                         45170037
451800        MOVE RV050-INBD-RET-FRGT-AMT  TO DFCTOR-INBD-RET-FRGT-AMT 45180037
451900     END-IF.                                                      45190037
452000                                                                  45200037
452100     IF RV050-OTBND-RET-FRGT-SIGN = PC-NEG                        45210037
452200        COMPUTE DFCTOR-OTBND-RET-FRGT-AMT =                       45220037
452300                (RV050-OTBND-RET-FRGT-AMT * (-1))                 45230037
452400     ELSE                                                         45240037
452500        MOVE RV050-OTBND-RET-FRGT-AMT TO DFCTOR-OTBND-RET-FRGT-AMT45250037
452600     END-IF.                                                      45260037
452700                                                                  45270037
452800     IF RV050-DED-CHRG-SIGN = PC-NEG                              45280037
452900        COMPUTE DFCTOR-DED-CHRG-AMT =                             45290037
453000                (RV050-DED-CHRG-AMT * (-1))                       45300037
453100     ELSE                                                         45310037
453200        MOVE RV050-DED-CHRG-AMT    TO DFCTOR-DED-CHRG-AMT         45320037
453300     END-IF.                                                      45330037
453400                                                                  45340037
453500     MOVE RV050-WEIGHT             TO DFCTOR-DFCT-WT-QTY.         45350037
453600                                                                  45360037
453700     IF RV050-DISC-PCT-SIGN = PC-NEG                              45370037
453800        COMPUTE DFCTOR-DISC-PCT =                                 45380037
453900                (RV050-DISC-PCT * (-1))                           45390037
454000     ELSE                                                         45400037
454100        MOVE RV050-DISC-PCT        TO DFCTOR-DISC-PCT             45410037
454200     END-IF.                                                      45420037
454300                                                                  45430037
454400     IF RV050-DISC-AMT-SIGN = PC-NEG                              45440037
454500        COMPUTE DFCTOR-DISC-AMT =                                 45450037
454600                (RV050-DISC-AMT * (-1))                           45460037
454700     ELSE                                                         45470037
454800        MOVE RV050-DISC-AMT        TO DFCTOR-DISC-AMT             45480037
454900     END-IF.                                                      45490037
455000                                                                  45500037
455100     MOVE PC-SPACE                 TO DFCTOR-SPC-INSTR-TXT.       45510037
455200     MOVE PC-EMAIL-ADDR-LENGTH     TO DFCTOR-VND-EMAIL-ADDR-LEN.  45520037
455300     MOVE RV050-VND-EMAIL-ADDR     TO DFCTOR-VND-EMAIL-ADDR-TEXT. 45530037
455400     MOVE RV050-CARR-TRKG-ID       TO DFCTOR-CARR-TRKG-ID.        45540037
455500                                                                  45550037
455600******************************************************************45560037
455700* INSERT A ROW INTO RVT_DFCT_STAT                                *45570037
455800******************************************************************45580037
455900 7500-INSERT-RVT-DFCT-STAT.                                       45590037
456000                                                                  45600037
456100     INITIALIZE DCLRVT00003.                                      45610037
456200     PERFORM 7505-LOAD-RVT00003.                                  45620037
456300                                                                  45630037
456400     PERFORM                                                      45640037
456500       WITH TEST AFTER                                            45650037
456600       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       45660037
456700       UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES  OR              45670037
456800               SQLCODE = ZERO                                     45680037
456900                                                                  45690037
457000     EXEC SQL                                                     45700037
457100         INSERT INTO RVT_DFCT_STAT                                45710037
457200             ( DFCT_ORD_ID                                        45720037
457300              ,CHGD_TMST                                          45730037
457400              ,DFCT_ORD_STAT_CDE                                  45740037
457500              ,USR_ID                                             45750037
457600             )                                                    45760037
457700            VALUES                                                45770037
457800             (:RVT00003-DFCT-ORD-ID                               45780037
457900             ,:RVT00003-CHGD-TMST                                 45790037
458000             ,:RVT00003-DFCT-ORD-STAT-CDE                         45800037
458100             ,:RVT00003-USR-ID                                    45810037
458200             )                                                    45820037
458300     END-EXEC                                                     45830037
458400                                                                  45840037
458500         EVALUATE TRUE                                            45850037
458600             WHEN SQLCODE = ZERO                                  45860037
458700                 ADD +1    TO PA-TOT-HDRSTAT-INS                  45870037
458800                                                                  45880037
458900             WHEN SQLWARN0 NOT EQUAL SPACE                        45890037
459000             WHEN SQLCODE NOT EQUAL ZERO                          45900037
459100                 DISPLAY '**************************************' 45910037
459200                 DISPLAY '** ABEND                            **' 45920037
459300                 DISPLAY '** PROGRAM = RVKUP002               **' 45930037
459400                DISPLAY '** PARAGRAPH = 7500-INSERT-RVT-DFCT-STAT'45940037
459500                 DISPLAY '** INSERT INTO TDFCTOR              **' 45950037
459600                 DISPLAY '** HDR DFCT-ORD-ID : ' RV050-DFCT-ORD-ID45960037
459700                 DISPLAY '**************************************' 45970037
459800                 PERFORM 9100-SQL-ABEND                           45980037
459900         END-EVALUATE                                             45990037
460000     END-PERFORM.                                                 46000037
460100                                                                  46010037
460200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    46020037
460300         (SQLCODE NOT = ZERO)                                     46030037
460400        DISPLAY '********************************************'    46040037
460500        DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO     **'    46050037
460600        DISPLAY '** INSERT TO RVT_DFCT_STAT                **'    46060037
460700        DISPLAY '** PARAGRAPH = 7500-INSERT-RVT-DFCT-STAT  **'    46070037
460800        DISPLAY '** HDR DFCT-ORD-ID  : ' RV050-DFCT-ORD-ID        46080037
460900        DISPLAY '********************************************'    46090037
461000      PERFORM 9100-SQL-ABEND                                      46100037
461100     END-IF.                                                      46110037
461200                                                                  46120037
461300******************************************************************46130037
461400* LOAD FIELDS FOR THE RVT_DFCT_STAT INSERT                        46140037
461500******************************************************************46150037
461600 7505-LOAD-RVT00003.                                              46160037
461700                                                                  46170037
461800     MOVE RV050-DFCT-ORD-ID        TO RVT00003-DFCT-ORD-ID.       46180037
461900     MOVE RV050-STATUS-CHG-DTE     TO RVT00003-CHGD-TMST (1:10).  46190037
462000     MOVE PC-DEFAULT-TIME-2400     TO RVT00003-CHGD-TMST (11:16). 46200037
462100     MOVE RV050-DFCT-ORD-STAT-CDE  TO RVT00003-DFCT-ORD-STAT-CDE. 46210037
462200     MOVE PC-CURRENT-PROGRAM-NAME  TO RVT00003-USR-ID.            46220037
462300                                                                  46230037
462400******************************************************************46240037
462500*  UPDATE THE HIGHEST USED MKOUT-ORD-ID AS THE LST TRANSACTION   *46250037
462600*  BEFORE THE COMMIT.                                            *46260037
462700******************************************************************46270037
462800 7600-UPDATE-TDFORCR.                                             46280037
462900                                                                  46290037
463000     MOVE PV-CURRENT-MKOUT-ORD-ID TO DFORCR-MKOUT-ORD-ID.         46300037
463100     MOVE PV-HOLD-LAST-MOS-DFCT-ORD-ID                            46310037
463200                                  TO DFCTOR-DFCT-ORD-ID.          46320037
463300                                                                  46330037
463400     EXEC SQL                                                     46340037
463500        UPDATE TDFORCR                                            46350037
463600         SET MKOUT_ORD_ID     = :DFORCR-MKOUT-ORD-ID              46360037
463700            ,DFCT_ORD_ID      = :DFCTOR-DFCT-ORD-ID               46370037
463800     END-EXEC.                                                    46380037
463900                                                                  46390037
464000     EVALUATE TRUE                                                46400037
464100         WHEN SQLCODE EQUAL ZERO                                  46410037
464200              ADD +1 TO PA-TOT-MKOUT-ORD-ID-UPD                   46420037
464300                                                                  46430037
464400         WHEN SQLWARN0 NOT EQUAL SPACE                            46440037
464500         WHEN SQLCODE NOT EQUAL ZERO                              46450037
464600             DISPLAY '*****************************************'  46460037
464700             DISPLAY '** ABEND                               **'  46470037
464800             DISPLAY '** PROGRAM = RVKUP002                  **'  46480037
464900             DISPLAY '** PARAGRAPH = 7600-UPDATE-TDFORCR     **'  46490037
465000             DISPLAY '** UNSUCCESSFUL UPDATE TDFORCR         **'  46500037
465100             DISPLAY '*****************************************'  46510037
465200             PERFORM 9100-SQL-ABEND                               46520037
465300     END-EVALUATE.                                                46530037
465400                                                                  46540037
465500******************************************************************46550037
465600* DO A FINAL UPDATE ON THE CHECKPOINT RESTART INFO.               46560037
465700* A FINAL COMMIT IS PERFORMED. THE SUMMARY STATS FOR THE PROGRAM  46570037
465800* ARE DISPLAYED.                                                  46580037
465900******************************************************************46590037
466000 8000-EOJ-ROUTINE.                                                46600037
466100                                                                  46610037
466200**MAKE SURE THE MARK-OUT ID IS UPDATED BEFORE COMMIT              46620037
466300      IF PS-A-MOS-IN-COMMIT-CYCLE-YES                             46630037
466400         PERFORM 7600-UPDATE-TDFORCR                              46640037
466500      END-IF.                                                     46650037
466600**INSERT THE DTL SUMMARY ROW BEFORE THE COMMIT.                   46660037
466700      PERFORM 7005-INSERT-DTL-SUM-TO-ERR-TBL.                     46670037
466800                                                                  46680037
466900      PERFORM 6580-SAVE-DATA-FOR-RESTART.                         46690037
467000      PERFORM 6590-UPDATE-TCKRSTINF.                              46700037
467100      PERFORM 6600-COMMIT.                                        46710037
467200                                                                  46720037
467300      MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.             46730037
467400      PERFORM 6570-UPDATE-TCKRSTCNTL.                             46740037
467500                                                                  46750037
467600      CLOSE RTV-HEADER-FILE                                       46760037
467700            RTV-DETAIL-FILE.                                      46770037
467800                                                                  46780037
467900     DISPLAY '***********************************************'.   46790037
468000     DISPLAY '**    * RVKUP002 SUMMARY STATISTICS *        **'.   46800037
468100     DISPLAY '**                                           **'.   46810037
468200     DISPLAY '**      ---------------------------          **'.   46820037
468300     DISPLAY '**           GENCO RTV LOAD                  **'.   46830037
468400     DISPLAY '**      ---------------------------          **'.   46840037
468500     DISPLAY '** TOT RECS READ       :' PA-TOT-RECS-READ.         46850037
468600     DISPLAY '** TOT HDR RECS READ   :' PA-TOT-HDR-RECS-READ.     46860037
468700     DISPLAY '** TOT HDR INS         :' PA-TOT-HDR-INS.           46870037
468800     DISPLAY '** TOT HDRSTAT INS     :' PA-TOT-HDRSTAT-INS.       46880037
468900     DISPLAY '** TOT DTL RECS READ   :' PA-TOT-DTL-RECS-READ.     46890037
469000     DISPLAY '** TOT DTL INS         :' PA-TOT-DTL-INS.           46900037
469100     DISPLAY '** TOT DTLSTAT INS     :' PA-TOT-DTLSTAT-INS.       46910037
469200     DISPLAY '** TOT SHIPT INS       :' PA-TOT-SHIPT-INS.         46920037
469300     DISPLAY '** TOT SHIPTSTAT INS   :' PA-TOT-SHIPTSTAT-INS.     46930037
469400     DISPLAY '** TOT MKOUT ID UPD    :' PA-TOT-MKOUT-ORD-ID-UPD.  46940037
469500     DISPLAY '** 1ST EXISTING MOS ID :' PV-FIRST-MKOUT-ORD-ID.    46950037
469600     DISPLAY '** LAST MOS ID UPDATED :' PV-CURRENT-MKOUT-ORD-ID.  46960037
469700     DISPLAY '** TOT HDRS BYPASSED   :' PA-TOT-HDRS-BYPASSED.     46970037
469800     DISPLAY '** TOT DTLS BYPASSED   :' PA-TOT-DTLS-BYPASSED.     46980037
469900     DISPLAY '** TOT CALLBACK HDRS   :' PA-TOT-CALLBACKS.         46990037
470000     DISPLAY '** TOT COMMITS         :' PA-TOT-COMMITS-TAKEN.     47000037
470100     DISPLAY '** ------------------- :' .                         47010037
470200     DISPLAY '** TOT D&D DTLS RCVD   :' PA-TOT-DD-COUNT-RCVD.     47020037
470300     DISPLAY '** TOT D&D RTL CST RCVD:' PA-TOT-DD-RTL-RCVD.       47030037
470400     DISPLAY '** TOT D&D UNT CST RCVD:' PA-TOT-DD-UNT-RCVD.       47040037
470500     DISPLAY '                        '.                          47050037
470600     DISPLAY '** TOT MOS DTLS RCVD   :' PA-TOT-MOS-COUNT-RCVD.    47060037
470700     DISPLAY '** TOT MOS RTL CST RCVD:' PA-TOT-MOS-RTL-RCVD.      47070037
470800     DISPLAY '** TOT MOS UNT CST RCVD:' PA-TOT-MOS-UNT-RCVD.      47080037
470900     DISPLAY '                        '.                          47090037
471000     DISPLAY '** TOT RTV DTLS RCVD   :' PA-TOT-RTV-COUNT-RCVD.    47100037
471100     DISPLAY '** TOT RTV RTL CST RCVD:' PA-TOT-RTV-RTL-RCVD.      47110037
471200     DISPLAY '** TOT RTV UNT CST RCVD:' PA-TOT-RTV-UNT-RCVD.      47120037
471300     DISPLAY '**                     :' .                         47130037
471400     DISPLAY '** TOT D&D DTLS ERR    :' PA-TOT-DD-COUNT-ERR.      47140037
471500     DISPLAY '** TOT D&D RTL COST ERR:' PA-TOT-DD-RTL-ERR.        47150037
471600     DISPLAY '** TOT D&D UNT COST ERR:' PA-TOT-DD-UNT-ERR.        47160037
471700     DISPLAY '                        '.                          47170037
471800     DISPLAY '** TOT MOS DTLS ERR    :' PA-TOT-MOS-COUNT-ERR.     47180037
471900     DISPLAY '** TOT MOS RTL COST ERR:' PA-TOT-MOS-RTL-ERR.       47190037
472000     DISPLAY '** TOT MOS UNT COST ERR:' PA-TOT-MOS-UNT-ERR.       47200037
472100     DISPLAY '                        '.                          47210037
472200     DISPLAY '** TOT RTV DTLS ERR    :' PA-TOT-RTV-COUNT-ERR.     47220037
472300     DISPLAY '** TOT RTV RTL COST ERR:' PA-TOT-RTV-RTL-ERR.       47230037
472400     DISPLAY '** TOT RTV UNT COST ERR:' PA-TOT-RTV-UNT-ERR.       47240037
472500     DISPLAY '                        '.                          47250037
472600     DISPLAY '** TOT UNK DTLS        :' PA-TOT-UNK-COUNT-UNK.     47260037
472700     DISPLAY '** TOT UNK RTL COST    :' PA-TOT-UNK-RTL-UNK.       47270037
472800     DISPLAY '** TOT UNK UNT COST    :' PA-TOT-UNK-UNT-UNK.       47280037
472900     DISPLAY '***********************************************'.   47290037
473000                                                                  47300037
473100******************************************************************47310037
473200* PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    *47320037
473300* ERROR OR WARNING CODE OCCURS.                                  *47330037
473400******************************************************************47340037
473500 9100-SQL-ABEND.                                                  47350037
473600******************************************************************47360037
473700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *47370037
473800* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *47380037
473900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *47390037
474000* FORMAT.                                                        *47400037
474100******************************************************************47410037
474200                                                                  47420037
474300     COPY DPPD004.                                                47430037
474400                                                                  47440037
474500     DISPLAY '***********************************'.               47450037
474600     DISPLAY '      GENCO RTV LOAD ABEND         '.               47460037
474700     DISPLAY '***********************************'.               47470037
474800     DISPLAY '* CURRENT STATS AT TIME OF ABEND  *'.               47480037
474900     DISPLAY '***********************************'.               47490037
475000     DISPLAY '** TOT RECS READ       :' PA-TOT-RECS-READ.         47500037
475100     DISPLAY '** TOT HDR RECS READ   :' PA-TOT-HDR-RECS-READ.     47510037
475200     DISPLAY '** TOT HDR INS         :' PA-TOT-HDR-INS.           47520037
475300     DISPLAY '** TOT HDRSTAT INS     :' PA-TOT-HDRSTAT-INS.       47530037
475400     DISPLAY '** TOT DTL RECS READ   :' PA-TOT-DTL-RECS-READ.     47540037
475500     DISPLAY '** TOT DTL INS         :' PA-TOT-DTL-INS.           47550037
475600     DISPLAY '** TOT DTLSTAT INS     :' PA-TOT-DTLSTAT-INS.       47560037
475700     DISPLAY '** TOT SHIPT INS       :' PA-TOT-SHIPT-INS.         47570037
475800     DISPLAY '** TOT SHIPTSTAT INS   :' PA-TOT-SHIPTSTAT-INS.     47580037
475900     DISPLAY '** TOT MKOUT ID UPD    :' PA-TOT-MKOUT-ORD-ID-UPD.  47590037
476000     DISPLAY '** 1ST EXISTING MOS ID :' PV-FIRST-MKOUT-ORD-ID.    47600037
476100     DISPLAY '** LAST MOS ID UPDATED :' PV-CURRENT-MKOUT-ORD-ID.  47610037
476200     DISPLAY '** TOT HDRS BYPASSED   :' PA-TOT-HDRS-BYPASSED.     47620037
476300     DISPLAY '** TOT DTLS BYPASSED   :' PA-TOT-DTLS-BYPASSED.     47630037
476400     DISPLAY '** TOT CALLBACK HDRS   :' PA-TOT-CALLBACKS.         47640037
476500     DISPLAY '** TOT COMMITS         :' PA-TOT-COMMITS-TAKEN.     47650037
476600     DISPLAY '** ------------------- :' .                         47660037
476700     DISPLAY '** TOT D&D DTLS RCVD   :' PA-TOT-DD-COUNT-RCVD.     47670037
476800     DISPLAY '** TOT D&D RTL CST RCVD:' PA-TOT-DD-RTL-RCVD.       47680037
476900     DISPLAY '** TOT D&D UNT CST RCVD:' PA-TOT-DD-UNT-RCVD.       47690037
477000     DISPLAY '                        '.                          47700037
477100     DISPLAY '** TOT MOS DTLS RCVD   :' PA-TOT-MOS-COUNT-RCVD.    47710037
477200     DISPLAY '** TOT MOS RTL CST RCVD:' PA-TOT-MOS-RTL-RCVD.      47720037
477300     DISPLAY '** TOT MOS UNT CST RCVD:' PA-TOT-MOS-UNT-RCVD.      47730037
477400     DISPLAY '                        '.                          47740037
477500     DISPLAY '** TOT RTV DTLS RCVD   :' PA-TOT-RTV-COUNT-RCVD.    47750037
477600     DISPLAY '** TOT RTV RTL CST RCVD:' PA-TOT-RTV-RTL-RCVD.      47760037
477700     DISPLAY '** TOT RTV UNT CST RCVD:' PA-TOT-RTV-UNT-RCVD.      47770037
477800     DISPLAY '**                     :' .                         47780037
477900     DISPLAY '** TOT D&D DTLS ERR    :' PA-TOT-DD-COUNT-ERR.      47790037
478000     DISPLAY '** TOT D&D RTL COST ERR:' PA-TOT-DD-RTL-ERR.        47800037
478100     DISPLAY '** TOT D&D UNT COST ERR:' PA-TOT-DD-UNT-ERR.        47810037
478200     DISPLAY '                        '.                          47820037
478300     DISPLAY '** TOT MOS DTLS ERR    :' PA-TOT-MOS-COUNT-ERR.     47830037
478400     DISPLAY '** TOT MOS RTL COST ERR:' PA-TOT-MOS-RTL-ERR.       47840037
478500     DISPLAY '** TOT MOS UNT COST ERR:' PA-TOT-MOS-UNT-ERR.       47850037
478600     DISPLAY '                        '.                          47860037
478700     DISPLAY '** TOT RTV DTLS ERR    :' PA-TOT-RTV-COUNT-ERR.     47870037
478800     DISPLAY '** TOT RTV RTL COST ERR:' PA-TOT-RTV-RTL-ERR.       47880037
478900     DISPLAY '** TOT RTV UNT COST ERR:' PA-TOT-RTV-UNT-ERR.       47890037
479000     DISPLAY '                        '.                          47900037
479100     DISPLAY '** TOT UNK DTLS        :' PA-TOT-UNK-COUNT-UNK.     47910037
479200     DISPLAY '** TOT UNK RTL COST    :' PA-TOT-UNK-RTL-UNK.       47920037
479300     DISPLAY '** TOT UNK UNT COST    :' PA-TOT-UNK-UNT-UNK.       47930037
479400     DISPLAY '***********************************************'.   47940037
479500     DISPLAY '** ABEND PARAGRAPH **  ' PV-PARAGRAPH-NAME.         47950037
479600     DISPLAY '** ERROR MESSAGE   **  ' PV-ABEND-MESSAGE.          47960037
479700     DISPLAY '** SQLCODE         **  ' PV-SQLCODE.                47970037
479800     DISPLAY '** VIEW  NAME      **  ' PV-DB2-VIEW-NAME.          47980037
479900     DISPLAY '***********************************************'.   47990037
480000     DISPLAY ' '.                                                 48000037
480100     MOVE +4013 TO ABEND-CODE.                                    48010037
480200     CALL 'ILBOABN0' USING ABEND-CODE.                            48020037
480300                                                                  48030037
480400****************************************************************  48040037
480500** PERFORM NON SQL ABEND PROCESSING                               48050037
480600****************************************************************  48060037
480700 9200-NON-SQL-ABEND.                                              48070037
480800                                                                  48080037
480900     DISPLAY '************************************************'.  48090037
481000     DISPLAY '********** NON SQL PROGRAM ABEND ***************'.  48100037
481100     DISPLAY '** PROGRAM:    ', PC-CURRENT-PROGRAM-NAME.          48110037
481200     DISPLAY '** ABEND CODE: ', PV-ABEND-CODE.                    48120037
481300     DISPLAY '** PARAGRAPH:  ', PV-PARAGRAPH-NAME.                48130037
481400     DISPLAY '** MESSAGE:    ', PV-ABEND-MESSAGE.                 48140037
481500     DISPLAY '***********************************'.               48150037
481600     DISPLAY '* CURRENT STATS AT TIME OF ABEND  *'.               48160037
481700     DISPLAY '***********************************'.               48170037
481800     DISPLAY '** TOT RECS READ       :' PA-TOT-RECS-READ.         48180037
481900     DISPLAY '** TOT HDR RECS READ   :' PA-TOT-HDR-RECS-READ.     48190037
482000     DISPLAY '** TOT HDR INS         :' PA-TOT-HDR-INS.           48200037
482100     DISPLAY '** TOT HDRSTAT INS     :' PA-TOT-HDRSTAT-INS.       48210037
482200     DISPLAY '** TOT DTL RECS READ   :' PA-TOT-DTL-RECS-READ.     48220037
482300     DISPLAY '** TOT DTL INS         :' PA-TOT-DTL-INS.           48230037
482400     DISPLAY '** TOT DTLSTAT INS     :' PA-TOT-DTLSTAT-INS.       48240037
482500     DISPLAY '** TOT SHIPT INS       :' PA-TOT-SHIPT-INS.         48250037
482600     DISPLAY '** TOT SHIPTSTAT INS   :' PA-TOT-SHIPTSTAT-INS.     48260037
482700     DISPLAY '** TOT MKOUT ID UPD    :' PA-TOT-MKOUT-ORD-ID-UPD.  48270037
482800     DISPLAY '** 1ST EXISTING MOS ID :' PV-FIRST-MKOUT-ORD-ID.    48280037
482900     DISPLAY '** LAST MOS ID UPDATED :' PV-CURRENT-MKOUT-ORD-ID.  48290037
483000     DISPLAY '** TOT HDRS BYPASSED   :' PA-TOT-HDRS-BYPASSED.     48300037
483100     DISPLAY '** TOT DTLS BYPASSED   :' PA-TOT-DTLS-BYPASSED.     48310037
483200     DISPLAY '** TOT CALLBACK HDRS   :' PA-TOT-CALLBACKS.         48320037
483300     DISPLAY '** TOT COMMITS         :' PA-TOT-COMMITS-TAKEN.     48330037
483400     DISPLAY '** ------------------- :' .                         48340037
483500     DISPLAY '** TOT D&D DTLS RCVD   :' PA-TOT-DD-COUNT-RCVD.     48350037
483600     DISPLAY '** TOT D&D RTL CST RCVD:' PA-TOT-DD-RTL-RCVD.       48360037
483700     DISPLAY '** TOT D&D UNT CST RCVD:' PA-TOT-DD-UNT-RCVD.       48370037
483800     DISPLAY '                        '.                          48380037
483900     DISPLAY '** TOT MOS DTLS RCVD   :' PA-TOT-MOS-COUNT-RCVD.    48390037
484000     DISPLAY '** TOT MOS RTL CST RCVD:' PA-TOT-MOS-RTL-RCVD.      48400037
484100     DISPLAY '** TOT MOS UNT CST RCVD:' PA-TOT-MOS-UNT-RCVD.      48410037
484200     DISPLAY '                        '.                          48420037
484300     DISPLAY '** TOT RTV DTLS RCVD   :' PA-TOT-RTV-COUNT-RCVD.    48430037
484400     DISPLAY '** TOT RTV RTL CST RCVD:' PA-TOT-RTV-RTL-RCVD.      48440037
484500     DISPLAY '** TOT RTV UNT CST RCVD:' PA-TOT-RTV-UNT-RCVD.      48450037
484600     DISPLAY '**                     :' .                         48460037
484700     DISPLAY '** TOT D&D DTLS ERR    :' PA-TOT-DD-COUNT-ERR.      48470037
484800     DISPLAY '** TOT D&D RTL COST ERR:' PA-TOT-DD-RTL-ERR.        48480037
484900     DISPLAY '** TOT D&D UNT COST ERR:' PA-TOT-DD-UNT-ERR.        48490037
485000     DISPLAY '                        '.                          48500037
485100     DISPLAY '** TOT MOS DTLS ERR    :' PA-TOT-MOS-COUNT-ERR.     48510037
485200     DISPLAY '** TOT MOS RTL COST ERR:' PA-TOT-MOS-RTL-ERR.       48520037
485300     DISPLAY '** TOT MOS UNT COST ERR:' PA-TOT-MOS-UNT-ERR.       48530037
485400     DISPLAY '                        '.                          48540037
485500     DISPLAY '** TOT RTV DTLS ERR    :' PA-TOT-RTV-COUNT-ERR.     48550037
485600     DISPLAY '** TOT RTV RTL COST ERR:' PA-TOT-RTV-RTL-ERR.       48560037
485700     DISPLAY '** TOT RTV UNT COST ERR:' PA-TOT-RTV-UNT-ERR.       48570037
485800     DISPLAY '                        '.                          48580037
485900     DISPLAY '** TOT UNK DTLS        :' PA-TOT-UNK-COUNT-UNK.     48590037
486000     DISPLAY '** TOT UNK RTL COST    :' PA-TOT-UNK-RTL-UNK.       48600037
486100     DISPLAY '** TOT UNK UNT COST    :' PA-TOT-UNK-UNT-UNK.       48610037
486200     DISPLAY '***********************************************'.   48620037
486300     MOVE +4013 TO ABEND-CODE.                                    48630037
486400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         48640037
486500                                                                  48650037
486600******************************************************************48660037
486700*                       END OF PROGRAM                            48670037
486800******************************************************************48680037
