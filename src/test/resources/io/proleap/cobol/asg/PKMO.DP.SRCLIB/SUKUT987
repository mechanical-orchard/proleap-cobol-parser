000100***************************************************************** 00010009
000200 IDENTIFICATION DIVISION.                                         00020009
000300***************************************************************** 00030009
000400                                                                  00040009
000500 PROGRAM-ID.             SUKUT987.                                00050009
000600 AUTHOR.                 GERMAN BANDA.                            00060009
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070009
000800 DATE-WRITTEN            FEBRUARY 2002.                           00080009
000900 DATE-COMPILED.                                                   00090009
001000***************************************************************** 00100009
001100***************************************************************** 00110009
001200*                                                               * 00120009
001300*  THIS PROGRAM WILL READ THE TRIP ID AND PO NUMBER FROM THE      00130009
001400*  CONTROL CARD TKMA.CONTROL(SUCC987), AND DELETE FROM THE        00140009
001410*  FOLLOWING TABLES:      TSHUNLO                                 00141009
001420*                         TSULBXF                                 00142009
001430*                         TLBVRMG                                 00143009
001440*                         TSUNAUD                                 00144009
001441*                         TSUATRN                                 00144109
001442*                         TSUAUPC                                 00144209
001450*                         SUT_PO_AUD_REQ                          00145009
001460*  THE PROGRAM WILL ALSO UPDATE TLBVRDA                           00146009
001500***************************************************************** 00150009
001600*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00160009
001700*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00170009
001800*                                                               * 00180009
001900***************************************************************** 00190009
002000***************************************************************** 00200009
002100 ENVIRONMENT DIVISION.                                            00210009
002200***************************************************************** 00220009
002300                                                                  00230009
002400 CONFIGURATION SECTION.                                           00240009
002500                                                                  00250009
002600 SOURCE-COMPUTER.        IBM-3090.                                00260009
002700 OBJECT-COMPUTER.        IBM-3090.                                00270009
002800                                                                  00280009
002900 INPUT-OUTPUT SECTION.                                            00290009
003000                                                                  00300009
003100 FILE-CONTROL.                                                    00310009
003200*                                                                 00320009
003300     SELECT PO-TRIP-ID-DEL-FILE                                   00330009
003400         ASSIGN TO INP01.                                         00340009
003500                                                                  00350009
003600*                                                                 00360009
003700***************************************************************** 00370009
003800 DATA DIVISION.                                                   00380009
003900***************************************************************** 00390009
004000*                                                                 00400009
004100 FILE SECTION.                                                    00410009
004200*                                                                 00420009
004300 FD  PO-TRIP-ID-DEL-FILE                                          00430009
004400     LABEL RECORDS ARE STANDARD                                   00440009
004500     RECORDING MODE IS F                                          00450009
004600     BLOCK CONTAINS 0 RECORDS                                     00460009
004700     RECORD CONTAINS 80 CHARACTERS.                               00470009
004710                                                                  00471009
004800 01  PO-TRIP-ID-DEL-RECORD           PIC X(80).                   00480009
005100*                                                                 00510009
005200                                                                  00520009
005300 WORKING-STORAGE SECTION.                                         00530009
005400*                                                                 00540009
005500 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00550009
005600                                                   COMP SYNC.     00560009
005700*                                                                 00570009
005800 01  PROGRAM-SWITCHES.                                            00580009
005900     05  PS-DATA-IND                 PIC  X(01)  VALUE 'N'.       00590009
006000         88  PS-DATA                             VALUE 'Y'.       00600009
006100         88  PS-NO-DATA                          VALUE 'N'.       00610009
006200     05  PS-END-OF-CARTON-CURSOR-SW  PIC  X(01)    VALUE 'N'.     00620009
006300         88  PS-END-OF-CARTON-CURSOR               VALUE 'Y'.     00630009
006400         88  PS-NOT-END-OF-CARTON-CURSOR          VALUE 'N'.      00640009
006401     05  PS-END-OF-TRIP-CURSOR-SW  PIC  X(01)      VALUE 'N'.     00640180
006402         88  PS-END-OF-TRIP-CURSOR                 VALUE 'Y'.     00640209
006403         88  PS-NOT-END-OF-TRIP-CURSOR            VALUE 'N'.      00640309
006500     05  PS-END-OF-AUDIT-CURSOR-SW PIC    X(01)    VALUE 'N'.     00650009
006600         88  PS-END-OF-AUDIT-CURSOR                VALUE 'Y'.     00660009
006700         88  PS-NOT-END-OF-AUDIT-CURSOR            VALUE 'N'.     00670009
006710     05  PS-END-OF-OTBND-CURSOR-SW  PIC  X(01)     VALUE 'N'.     00671010
006720         88  PS-END-OF-OTBND-CURSOR                VALUE 'Y'.     00672010
006730         88  PS-NOT-END-OF-OTBND-CURSOR            VALUE 'N'.     00673010
006740     05  PS-END-OF-PO-CURSOR-SW     PIC  X(01)     VALUE 'N'.     00674016
006750         88  PS-END-OF-PO-CURSOR                   VALUE 'Y'.     00675016
006760         88  PS-NOT-END-OF-PO-CURSOR               VALUE 'N'.     00676016
006800     05  PS-END-OF-DELETE-FILE-SW   PIC   X(01)    VALUE 'N'.     00680009
006900         88  PS-END-OF-DELETE-FILE                 VALUE 'Y'.     00690009
007000         88  PS-NOT-END-OF-DELETE-FILE             VALUE 'N'.     00700009
007010     05  PS-CRTNS-CHKED-IN-SW        PIC   X(01)   VALUE 'Y'.     00701022
007020         88  PS-CRTNS-CHKED-IN-YES                 VALUE 'Y'.     00702021
007030         88  PS-CRTNS-CHKED-IN-NO                  VALUE 'N'.     00703021
007100*                                                                 00710009
007120 01  WS-LOCAL-SERVER.                                             00712081
007130     05  WS-SUBSYS                   PIC X(04)  VALUE SPACES.     00713081
007140     05  FILLER                      PIC X(12)  VALUE SPACES.     00714081
007150*                                                                 00715081
007200 01  PC-CONSTANTS.                                                00720009
007300     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00730009
007400     05  PC-1                        PIC S9(03)    VALUE +1       00740009
007500                                                   COMP-3.        00750009
007600     05  PC-13                       PIC S9(03)    VALUE +13      00760009
007700                                                   COMP-3.        00770009
007710     05  PC-90                       PIC S9(04)    COMP           00771081
007720                                                   VALUE 90.      00772081
007800     05  PC-A                        PIC  X(01)    VALUE 'A'.     00780009
007900     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00790009
008000     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   00800009
008100     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00810009
008200         'SUKUT987'.                                              00820009
008300     05  PC-KHL                      PIC  X(03)    VALUE 'KHL'.   00830081
008400     05  PC-PRDCHK                   PIC  X(06)    VALUE 'PRDCHK'.00840081
008500     05  PC-PARM-TEXT                PIC  X(25)    VALUE          00850081
008600         'LOWER LEVEL ONLY         '.                             00860081
008800*                                                                 00880009
008900 01  PV-MISC-FIELDS.                                              00890009
009600     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00960009
009700                                                   COMP SYNC.     00970009
009800     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  00980009
009900     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00990009
010000     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01000009
010100     05  PV-TRIP-ID-X                PIC  X(09).                  01010009
010200     05  PV-TRIP-ID REDEFINES PV-TRIP-ID-X                        01020009
010300                                     PIC  9(09).                  01030009
010600     05  PV-WRITE-COUNT              PIC S9(09)    COMP.          01060009
010700     05  PV-QTY-RECV                 PIC S9(09)    COMP.          01070009
010800     05  PV-HOLD-PO-NBR              PIC S9(09)    COMP.          01080009
010900     05  PV-HOLD-REC-SEQ-NBR         PIC S9(09)    COMP.          01090009
010910*                                                                 01091009
010911     05  PV-DISPLAY-FIELD            PIC 9(18).                   01091124
010912*                                                                 01091224
010920     05  PV-DEL-UNLO-XREF-OTBND      PIC X(01).                   01092010
011000     05  PV-UPD-TLBVRDA              PIC X(01).                   01100009
011100     05  PV-DEL-TLBVRMG              PIC X(01).                   01110009
011200     05  PV-DEL-TSUNAUD              PIC X(01).                   01120009
011300     05  PV-DEL-TSUATRN              PIC X(01).                   01130009
011400     05  PV-DEL-TSUAUPC              PIC X(01).                   01140009
011500     05  PV-DEL-SUT-PO-AUD-REQ       PIC X(01).                   01150009
011600     05  PV-DEL-OTBND-P2L-128        PIC X(01).                   01160018
011700     05  PV-DEL-CSEPK                PIC X(01).                   01170049
012400 EJECT                                                            01240009
012500*                                                                 01250009
012600 01  DK-DB-KEYS.                                                  01260009
012700    05  DK-SHIPT-UNT-ID             PIC S9(18) COMP-3.            01270009
012800    05  DK-TRIP-ID                  PIC S9(09) COMP.              01280009
012900    05  DK-PO-NBR                   PIC S9(09) COMP.              01290009
012910    05  DK-RECEIVER                 PIC S9(09) COMP.              01291009
013000    05  DK-AUD-CNTL-NBR             PIC S9(09) COMP.              01300009
013100                                                                  01310009
013200 01  DN-DB2-NULL-INDICATORS.                                      01320080
013300     05  DN-RWRK                    PIC S9(04) COMP               01330080
013301                                     VALUE ZEROES.                01330180
013302 01  DELETE-RECORD-INPUT.                                         01330209
013303     05  FILLER                      PIC X(06).                   01330309
013310     05  DR-TRIP-ID                  PIC 9(09).                   01331009
013400     05  FILLER                      PIC X(01).                   01340009
013500     05  DR-PO-NBR                   PIC 9(09).                   01350009
013600     05  FILLER                      PIC 9(01).                   01360009
013700     05  DR-RECEIVER                 PIC 9(04).                   01370009
013800     05  FILLER                      PIC 9(01).                   01380009
013900     05  DR-DEL-SHUNLO-XREF          PIC X(01).                   01390009
014000     05  DR-UPD-TLBVRDA              PIC X(01).                   01400009
014100     05  DR-DEL-TLBVRMG              PIC X(01).                   01410009
014110     05  DR-DEL-TSUNAUD              PIC X(01).                   01411009
014120     05  DR-DEL-TSUATRN              PIC X(01).                   01412009
014130     05  DR-DEL-TSUAUPC              PIC X(01).                   01413009
014140     05  DR-DEL-SUT-PO-AUD-REQ       PIC X(01).                   01414009
014141     05  DR-DEL-OTBND-P2L-128        PIC X(01).                   01414118
014142     05  DR-DEL-CSEPK                PIC X(01).                   01414249
014150     05  FILLER                      PIC X(41).                   01415013
014200*                                                                 01420009
015200******************************************************************01520009
015300*  DB2 FORMATTED MESSAGE AREA                                     01530009
015400******************************************************************01540009
015500     COPY DPWS004.                                                01550024
015600*                                                                 01560009
015700*                                                                 01570009
015800*  COPY BOOK FOR DB2 TABLE                                        01580009
015900*                                                                 01590009
015910     EXEC SQL                                                     01591081
015920          INCLUDE TKRPRPM                                         01592081
015930     END-EXEC.                                                    01593081
015940                                                                  01594081
015950*  COPY BOOK FOR DB2 TABLE                                        01595081
015960*                                                                 01596081
016000     EXEC SQL                                                     01600009
016100          INCLUDE TSHUUPC                                         01610009
016200     END-EXEC.                                                    01620009
016300                                                                  01630009
016400*  COPY BOOK FOR DB2 TABLE                                        01640009
016500*                                                                 01650009
016600     EXEC SQL                                                     01660009
016700          INCLUDE TSHUNLO                                         01670009
016800     END-EXEC.                                                    01680009
016900                                                                  01690009
017000*  COPY BOOK FOR DB2 TABLE                                        01700009
017100*                                                                 01710009
017200     EXEC SQL                                                     01720009
017300          INCLUDE TSULBXF                                         01730009
017400     END-EXEC.                                                    01740009
017500*  COPY BOOK FOR DB2 TABLE                                        01750009
017600*                                                                 01760009
017700     EXEC SQL                                                     01770009
017800          INCLUDE TLBVRDA                                         01780009
017900     END-EXEC.                                                    01790009
018000*  COPY BOOK FOR DB2 TABLE                                        01800009
018100*                                                                 01810009
018200     EXEC SQL                                                     01820009
018300          INCLUDE TLBVRMG                                         01830009
018400     END-EXEC.                                                    01840009
018500                                                                  01850009
018600*  COPY BOOK FOR DB2 TABLE                                        01860009
018700*                                                                 01870009
018800     EXEC SQL                                                     01880009
018900          INCLUDE SUT00015                                        01890009
019000     END-EXEC.                                                    01900009
019100                                                                  01910009
019200*  COPY BOOK FOR DB2 TABLE                                        01920009
019300*                                                                 01930009
019400     EXEC SQL                                                     01940009
019500          INCLUDE TSUNAUD                                         01950009
019600     END-EXEC.                                                    01960009
019700                                                                  01970009
019800*  COPY BOOK FOR DB2 TABLE                                        01980009
019900*                                                                 01990009
020000     EXEC SQL                                                     02000009
020100          INCLUDE TSUATRN                                         02010009
020200     END-EXEC.                                                    02020009
020300                                                                  02030009
020400*  COPY BOOK FOR DB2 TABLE                                        02040009
020500*                                                                 02050009
020600     EXEC SQL                                                     02060009
020700          INCLUDE TSUAUPC                                         02070009
020800     END-EXEC.                                                    02080009
020900                                                                  02090009
020910*  COPY BOOK FOR DB2 TABLE                                        02091010
020920*                                                                 02092010
020930     EXEC SQL                                                     02093010
020940          INCLUDE SUT00024                                        02094011
020950     END-EXEC.                                                    02095010
020960                                                                  02096010
020970*  COPY BOOK FOR DB2 TABLE                                        02097011
020980*                                                                 02098011
020990     EXEC SQL                                                     02099011
020991          INCLUDE SUT00028                                        02099111
020992     END-EXEC.                                                    02099211
020993                                                                  02099311
020994*  COPY BOOK FOR DB2 TABLE                                        02099416
020995*                                                                 02099516
020996     EXEC SQL                                                     02099616
020997          INCLUDE TPKSLIP                                         02099716
020998     END-EXEC.                                                    02099816
020999                                                                  02099916
021000*  COPY BOOK FOR DB2 TABLE                                        02100016
021001                                                                  02100116
021002     EXEC SQL                                                     02100216
021003          INCLUDE TINPKSU                                         02100316
021004     END-EXEC.                                                    02100416
021005                                                                  02100516
021010                                                                  02101016
021011     EXEC SQL                                                     02101149
021012          INCLUDE TDISTHD                                         02101216
021013     END-EXEC.                                                    02101316
021014                                                                  02101416
021015     EXEC SQL                                                     02101516
021016          INCLUDE TDISTDT                                         02101616
021017     END-EXEC.                                                    02101716
021018                                                                  02101816
021019     EXEC SQL                                                     02101980
021020          INCLUDE TSHPTPO                                         02102016
021021     END-EXEC.                                                    02102116
021022                                                                  02102216
021023     EXEC SQL                                                     02102316
021024          INCLUDE TSUQADJ                                         02102416
021025     END-EXEC.                                                    02102516
021026                                                                  02102616
021027     EXEC SQL                                                     02102716
021028          INCLUDE TVHTRIP                                         02102816
021029     END-EXEC.                                                    02102916
021030                                                                  02103016
021031     EXEC SQL                                                     02103116
021032          INCLUDE TRECEIV                                         02103216
021033     END-EXEC.                                                    02103316
021034                                                                  02103416
021035     EXEC SQL                                                     02103516
021036          INCLUDE TSHIPMT                                         02103616
021037     END-EXEC.                                                    02103716
021038                                                                  02103816
021039** SUT_FINCL_ADJ                                                  02103949
021040     EXEC SQL                                                     02104016
021041          INCLUDE SUT00030                                        02104116
021042     END-EXEC.                                                    02104216
021043                                                                  02104316
021044** SUT_PRC_MSG_CNTL                                               02104449
021045     EXEC SQL                                                     02104516
021046          INCLUDE SUT00094                                        02104616
021047     END-EXEC.                                                    02104716
021048                                                                  02104816
021049                                                                  02104916
021100 EJECT                                                            02110009
021200*  DB2 COMMUNICATION AREA                                         02120009
021300*                                                                 02130009
021400     EXEC SQL                                                     02140009
021500         INCLUDE SQLCA                                            02150009
021600     END-EXEC.                                                    02160009
021700 EJECT                                                            02170009
021800*  DB2 COMMUNICATION AREA2                                        02180009
021900*                                                                 02190009
022000     COPY SQLCA2.                                                 02200024
022100 EJECT                                                            02210009
022200                                                                  02220009
022300     EXEC SQL                                                     02230009
022400       DECLARE CARTON-TRIP-CSR CURSOR WITH HOLD FOR               02240030
022500         SELECT A.SHIPT_UNT_ID                                    02250009
022600          FROM  TSHUNLO A                                         02260009
022900          WHERE A.TRIP_ID          = :DK-TRIP-ID                  02290009
023000     END-EXEC.                                                    02300009
023100                                                                  02310009
023110     EXEC SQL                                                     02311030
023120       DECLARE TRIP-RCVR-CSR   CURSOR WITH HOLD FOR               02312030
023121             SELECT                                               02312180
023122                  C.PO_NBR                                        02312227
023123                , C.REC_SEQ_NBR                                   02312327
023124            FROM  TVHTRIP A                                       02312427
023125                , TSHIPMT B                                       02312527
023126                , TSHPTPO C                                       02312627
023127                , TRECEIV D                                       02312727
023128            WHERE A.TRIP_ID           = :DK-TRIP-ID               02312827
023129              AND A.TRIP_ID           = B.TRIP_ID                 02312927
023130              AND C.SHIPT_ID          = B.SHIPT_ID                02313027
023131              AND C.PO_NBR          = D.ORD_NBR                   02313127
023132              AND C.REC_SEQ_NBR     = D.REC_SEQ_NBR               02313227
023133              AND D.VER_STATUS_CDE  = 'A'                         02313327
023160     END-EXEC.                                                    02316030
023170                                                                  02317030
023171     EXEC SQL                                                     02317180
023172       DECLARE CARTON-RCVR-CSR CURSOR WITH HOLD FOR               02317230
023173         SELECT A.SHIPT_UNT_ID                                    02317330
023174          FROM  TSHUNLO A                                         02317430
023175               ,TINPKSU B                                         02317530
023176               ,TPKSLIP C                                         02317630
023177**        WHERE A.TRIP_ID          = :DK-TRIP-ID                  02317730
023178          WHERE C.PO_NBR           = :DK-PO-NBR                   02317832
023179            AND C.REC_SEQ_NBR      = :DK-RECEIVER                 02317932
023180            AND C.VER_STAT_CDE     = 'A'                          02318032
023181            AND B.PO_NBR           = C.PO_NBR                     02318132
023182            AND B.SEQ_NBR          = C.SEQ_NBR                    02318232
023183            AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID               02318332
023184     END-EXEC.                                                    02318430
023185                                                                  02318530
023200                                                                  02320009
023300                                                                  02330009
023400     EXEC SQL                                                     02340009
023500       DECLARE AUDIT-CSR CURSOR WITH HOLD FOR                     02350009
023600         SELECT AUD_CNTL_NBR                                      02360009
023700              , CRE_TMST                                          02370080
023701              , RWRK_AUD_CNTL_NBR                                 02370180
023702          FROM  SUT_PO_AUD_REQ                                    02370209
023800          WHERE PO_NBR        = :DK-PO-NBR                        02380009
023900            AND INBND_TRIP_ID = :DK-TRIP-ID                       02390009
023910          ORDER BY CRE_TMST  ASC                                  02391080
024000     END-EXEC.                                                    02400009
024100*                                                                 02410009
024101     EXEC SQL                                                     02410131
024102       DECLARE AUDIT-RCVR-CSR CURSOR WITH HOLD FOR                02410231
024103         SELECT AUD_CNTL_NBR                                      02410331
024104              , CRE_TMST                                          02410480
024105              , RWRK_AUD_CNTL_NBR                                 02410580
024106          FROM  SUT_PO_AUD_REQ                                    02410631
024107          WHERE PO_NBR        = :DK-PO-NBR                        02410731
024108            AND RCVR_SEQ_NBR  = :DK-RECEIVER                      02410831
024109          ORDER BY CRE_TMST  ASC                                  02410980
024110     END-EXEC.                                                    02411031
024111*                                                                 02411131
024112                                                                  02411210
024120     EXEC SQL                                                     02412010
024130       DECLARE OTBND-P2L-128-CSR CURSOR WITH HOLD FOR             02413018
024131          SELECT DISTINCT(A.SHIPT_UNT_ID)                         02413120
024132          FROM                                                    02413210
024133             SUT_OTBND_CART A                                     02413310
024134            ,SUT_OTBND_UPC B                                      02413410
024135         WHERE B.TRN_NBR          = :DK-PO-NBR                    02413510
024136            AND B.RCVR_SEQ_NBR    = :DK-RECEIVER                  02413610
024139            AND A.SHIPT_UNT_ID    =  B.SHIPT_UNT_ID               02413910
024142            AND A.CART_SRC_CDE    = 'P2L'                         02414218
024180     END-EXEC.                                                    02418010
024190*                                                                 02419010
024193     EXEC SQL                                                     02419314
024194       DECLARE PO-CURSOR CURSOR WITH HOLD FOR                     02419415
024195         SELECT C.TRIP_ID, A.PO_NBR, A.REC_SEQ_NBR                02419514
024196         FROM TPKSLIP A                                           02419614
024197            , TINPKSU B                                           02419714
024198            , TSHUNLO C                                           02419814
024199         WHERE A.PO_NBR        = :DK-PO-NBR                       02419914
024200           AND A.REC_SEQ_NBR   > 0                                02420014
024201           AND A.VER_STAT_CDE  = 'A'                              02420114
024202           AND A.PKSL_STAT_CDE = 'AC'                             02420214
024203           AND B.PO_NBR        = A.PO_NBR                         02420314
024204           AND B.SEQ_NBR       = A.SEQ_NBR                        02420414
024205           AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                   02420514
024206         GROUP BY A.PO_NBR, A.REC_SEQ_NBR, C.TRIP_ID              02420614
024207         ORDER BY 1, 2, 3                                         02420714
024208     END-EXEC.                                                    02420814
024209*                                                                 02420914
024227*                                                                 02422714
024230 PROCEDURE DIVISION.                                              02423014
024300*                                                                 02430009
024400 0000-MAINLINE-PROCESSING.                                        02440009
024500******************************************************************02450009
024600**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      02460009
024700******************************************************************02470009
024800*                                                                 02480009
024900     PERFORM 1000-INITIALIZATION.                                 02490009
025000*                                                                 02500009
025100     IF PS-NOT-END-OF-DELETE-FILE                                 02510009
025200         PERFORM 2000-PROCESS-CARTON                              02520009
025300            UNTIL PS-END-OF-DELETE-FILE                           02530009
025400     END-IF.                                                      02540009
025500     PERFORM 9000-EOJ-ROUTINE.                                    02550009
025600*                                                                 02560009
025700     GOBACK.                                                      02570009
025800*                                                                 02580009
025900*                                                                 02590009
026000 1000-INITIALIZATION.                                             02600009
026100******************************************************************02610009
026200**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               02620009
026300******************************************************************02630009
026310                                                                  02631081
026320     PERFORM 1100-GET-DB2-INSTANCE.                               02632081
026330     PERFORM 1200-CHECK-IF-PRODUCTION.                            02633081
026400                                                                  02640009
026500     OPEN INPUT  PO-TRIP-ID-DEL-FILE                              02650009
026600                                                                  02660009
026700     PERFORM 7000-READ-DELETE-FILE.                               02670009
026800                                                                  02680009
026900                                                                  02690009
027000*    DISPLAY 'TRIP ID  : '  DR-TRIP-ID                            02700009
027100*    DISPLAY 'PO NUMBER: '  DR-PO-NBR.                            02710009
027300                                                                  02730009
027900*                                                                 02790009
027920 1100-GET-DB2-INSTANCE.                                           02792081
027930                                                                  02793081
027940     MOVE '1100-GET-DB2-INSTANCE'                                 02794081
027950          TO PV-PARAGRAPH-NAME.                                   02795081
027960     MOVE 'GET DB2 INSTANCE'                                      02796081
027970          TO PV-DB2-OPERATION-ATTEMPTED.                          02797081
027980                                                                  02798081
027990     EXEC SQL                                                     02799081
027991         SELECT CURRENT SERVER INTO :WS-LOCAL-SERVER              02799181
027992             FROM SYSIBM.SYSDUMMY1 WITH UR                        02799281
027993     END-EXEC.                                                    02799381
027994                                                                  02799481
027995     EVALUATE TRUE                                                02799581
027996         WHEN SQLCODE = +0                                        02799681
027997             CONTINUE                                             02799781
027998         WHEN SQLWARN0 NOT = SPACES                               02799881
027999         WHEN SQLCODE < +0                                        02799981
028000         WHEN SQLCODE > +0                                        02800081
028001             PERFORM 9100-SQL-ABEND                               02800181
028002     END-EVALUATE.                                                02800281
028003*                                                                 02800381
028004 1200-CHECK-IF-PRODUCTION.                                        02800481
028005                                                                  02800581
028006     MOVE '1200-CHECK-IF-PRODUCTION'                              02800681
028007          TO PV-PARAGRAPH-NAME.                                   02800781
028008     MOVE 'SELECT PRDCHK TKRPRPM '                                02800881
028009          TO PV-DB2-OPERATION-ATTEMPTED.                          02800981
028010                                                                  02801081
028011     EXEC SQL                                                     02801181
028012       SELECT FUNC_TXT                                            02801281
028013         INTO :KRPRPM-FUNC-TXT                                    02801381
028014       FROM   TKRPRPM                                             02801481
028015       WHERE  SYS_PRC_FUNC_CDE  = :PC-PRDCHK                      02801581
028016         AND  INTFC_SYS_CDE     = :PC-KHL                         02801681
028017         AND  LOC_ID            = :PC-90                          02801781
028018         AND  FUNC_TXT          = :PC-PARM-TEXT                   02801881
028019     END-EXEC                                                     02801981
028020                                                                  02802081
028021     EVALUATE TRUE                                                02802181
028022         WHEN SQLCODE = +0                                        02802281
028023             CONTINUE                                             02802381
028024         WHEN SQLCODE = +100                                      02802481
028025             DISPLAY '*******************************************'02802581
028026             DISPLAY '** ABEND - DO NOT RUN THIS SUKUT987 PROGRAM'02802681
028027             DISPLAY '** ABEND - AGAINST PRODUCTION'              02802781
028028             DISPLAY '** ABEND - THIS SHOULD ONLY EVER BE'        02802881
028029             DISPLAY '** ABEND - RUN AGAINST TEST DATA'           02802981
028030             DISPLAY '*******************************************'02803081
028031             DISPLAY '** ABEND - THIS RUN IS GOING AGAINST'       02803181
028032             DISPLAY '** ABEND - DB2 INSTANCE:  '                 02803281
028033                     WS-LOCAL-SERVER                              02803381
028034             DISPLAY '*******************************************'02803481
028035             PERFORM 9100-SQL-ABEND                               02803581
028036                                                                  02803681
028037         WHEN SQLWARN0 NOT = SPACES                               02803781
028038         WHEN SQLCODE < +0                                        02803881
028039         WHEN SQLCODE > +0                                        02803981
028040             PERFORM 9100-SQL-ABEND                               02804081
028041     END-EVALUATE.                                                02804181
028042                                                                  02804281
028050 2000-PROCESS-CARTON.                                             02805009
028070                                                                  02807009
028080     SET PS-CRTNS-CHKED-IN-YES TO TRUE.                           02808049
028081                                                                  02808149
028082     IF DK-TRIP-ID > 0                                            02808214
028090        PERFORM 2015-PROCESS-DELETES                              02809016
028091     ELSE                                                         02809114
028092        IF DK-RECEIVER > 0                                        02809214
028094           IF PS-CRTNS-CHKED-IN-YES                               02809421
028095              DISPLAY 'ENTERING 2016-'                            02809564
028096              PERFORM 2016-PROCESS-DELETES-RCVR                   02809633
028097           END-IF                                                 02809723
028098       ELSE                                                       02809823
028099           SET PS-NOT-END-OF-PO-CURSOR  TO TRUE                   02809916
028100           PERFORM 4100-OPEN-PO-CURSOR                            02810016
028101           PERFORM 4200-FETCH-PO-CURSOR                           02810116
028102               UNTIL PS-END-OF-PO-CURSOR                          02810216
028103           PERFORM 4400-CLOSE-PO-CURSOR                           02810316
028104        END-IF                                                    02810414
028105     END-IF                                                       02810514
028200                                                                  02820014
029410     PERFORM 7000-READ-DELETE-FILE.                               02941009
029500                                                                  02950009
029510 2015-PROCESS-DELETES.                                            02951016
029520     SET PS-NOT-END-OF-TRIP-CURSOR TO TRUE.                       02952080
029530     PERFORM 2101-OPEN-TRIP-CURSOR.                               02953080
029540     PERFORM 2201-FETCH-TRIP-CURSOR                               02954080
029550           UNTIL PS-END-OF-TRIP-CURSOR                            02955080
029560     PERFORM 2401-CLOSE-TRIP-CURSOR.                              02956080
029570                                                                  02957080
029619                                                                  02961916
029620 2016-PROCESS-DELETES-RCVR.                                       02962030
029621     SET PS-NOT-END-OF-CARTON-CURSOR TO TRUE.                     02962130
029622     IF PV-DEL-UNLO-XREF-OTBND  =  'Y'                            02962230
029623        PERFORM 2150-OPEN-CARTON-RCVR-CURSOR                      02962331
029624        PERFORM 2250-FETCH-CARTON-RCVR-CURSOR                     02962431
029625            UNTIL PS-END-OF-CARTON-CURSOR                         02962530
029626        PERFORM 2450-CLOSE-CARTON-RCVR-CURSOR                     02962631
029627     END-IF                                                       02962730
029628                                                                  02962830
029629     IF PV-UPD-TLBVRDA  =  'Y'                                    02962930
029630        PERFORM 2550-UPDATE-TLBVRDA                               02963031
029631     END-IF                                                       02963130
029632                                                                  02963230
029633     IF PV-DEL-TLBVRMG  =  'Y'                                    02963330
029634        PERFORM 2600-DELETE-TLBVRMG                               02963430
029635     END-IF                                                       02963530
029636                                                                  02963630
029642                                                                  02964230
029643     SET PS-NOT-END-OF-AUDIT-CURSOR TO TRUE.                      02964331
029644     PERFORM 2750-OPEN-AUDIT-RCVR-CURSOR.                         02964431
029645     PERFORM 2850-FETCH-AUDIT-RCVR-CURSOR                         02964531
029646         UNTIL PS-END-OF-AUDIT-CURSOR.                            02964631
029647     PERFORM 3150-CLOSE-AUDIT-RCVR-CURSOR.                        02964731
029648                                                                  02964830
029649     SET PS-NOT-END-OF-OTBND-CURSOR TO TRUE                       02964930
029650     IF PV-DEL-OTBND-P2L-128  =  'Y'                              02965030
029651        PERFORM 3200-OPEN-OTBND-P2L-128                           02965130
029652        PERFORM 3250-FETCH-OTBND-P2L-128                          02965230
029653            UNTIL PS-END-OF-OTBND-CURSOR                          02965330
029654        PERFORM 3400-CLOSE-OTBND-P2L-128                          02965430
029655     END-IF.                                                      02965530
029656                                                                  02965630
029657     IF PV-DEL-CSEPK = 'Y'                                        02965749
029658        PERFORM 4500-DELETE-DISTDT                                02965849
029659        PERFORM 4550-DELETE-DISTHD                                02965949
029660     END-IF.                                                      02966049
029661                                                                  02966149
031700 2101-OPEN-TRIP-CURSOR.                                           03170080
031701     MOVE '2101-OPEN-TRIP-CURSOR   '                              03170180
031702                                 TO PV-ABEND-PARAGRAPH.           03170209
031703     EXEC SQL                                                     03170309
031704         OPEN TRIP-RCVR-CSR                                       03170430
031705     END-EXEC.                                                    03170509
031706     EVALUATE TRUE                                                03170609
031707         WHEN SQLCODE = ZERO                                      03170710
031708         WHEN SQLCODE = -904                                      03170810
031709         WHEN SQLCODE = -911                                      03170909
031710             CONTINUE                                             03171009
031711         WHEN SQLWARN0 NOT = SPACES                               03171109
031712         WHEN SQLCODE < ZERO                                      03171209
031713         WHEN SQLCODE > ZERO                                      03171309
031714             MOVE '2101-OPEN-TRIP-CURSOR           '              03171409
031715                             TO PV-PARAGRAPH-NAME                 03171509
031716             MOVE 'OPEN THE TRIP-RCVR-CSR         '               03171609
031717                             TO PV-DB2-OPERATION-ATTEMPTED        03171709
031718             DISPLAY 'TRIP  ' DK-TRIP-ID                          03171830
031719             PERFORM 9100-SQL-ABEND                               03171909
031720     END-EVALUATE.                                                03172009
031721                                                                  03172109
031722 2150-OPEN-CARTON-RCVR-CURSOR.                                    03172230
031723     MOVE '2150-OPEN-CARTON-RCVR-CURSOR '                         03172330
031724                                 TO PV-ABEND-PARAGRAPH.           03172430
031725     EXEC SQL                                                     03172530
031726         OPEN CARTON-RCVR-CSR                                     03172630
031727     END-EXEC.                                                    03172730
031728     EVALUATE TRUE                                                03172830
031729         WHEN SQLCODE = ZERO                                      03172930
031730         WHEN SQLCODE = -904                                      03173030
031731         WHEN SQLCODE = -911                                      03173130
031732             CONTINUE                                             03173230
031733         WHEN SQLWARN0 NOT = SPACES                               03173330
031734         WHEN SQLCODE < ZERO                                      03173430
031735         WHEN SQLCODE > ZERO                                      03173530
031736             MOVE '2150-OPEN-CARTON-RCVR-CURSOR    '              03173630
031737                             TO PV-PARAGRAPH-NAME                 03173730
031738             MOVE 'OPEN THE CARTON_RCVR-CURSOR    '               03173830
031739                             TO PV-DB2-OPERATION-ATTEMPTED        03173930
031740             DISPLAY 'PO NBR ' DK-PO-NBR 'RCVR ' DK-RECEIVER      03174030
031741             PERFORM 9100-SQL-ABEND                               03174130
031742     END-EVALUATE.                                                03174230
031743                                                                  03174330
034200 2201-FETCH-TRIP-CURSOR.                                          03420080
034201     MOVE '2201-FETCH-TRIP-CURSOR   '                             03420180
034202                                 TO PV-ABEND-PARAGRAPH.           03420209
034203     EXEC SQL                                                     03420309
034204          FETCH TRIP-RCVR-CSR                                     03420430
034205          INTO  :SHPTPO-PO-NBR                                    03420509
034206              , :SHPTPO-REC-SEQ-NBR                               03420609
034207     END-EXEC.                                                    03420709
034208                                                                  03420809
034209     EVALUATE TRUE                                                03420909
034210       WHEN SQLCODE = ZEROS                                       03421009
034220           MOVE SHPTPO-PO-NBR TO DK-PO-NBR                        03422080
034230           MOVE SHPTPO-REC-SEQ-NBR TO DK-RECEIVER                 03423080
034231           PERFORM 2016-PROCESS-DELETES-RCVR                      03423180
034232       WHEN SQLCODE = +100                                        03423209
034233           SET PS-END-OF-TRIP-CURSOR TO TRUE                      03423380
034234       WHEN SQLWARN0 NOT = SPACES                                 03423409
034235       WHEN SQLCODE < ZERO                                        03423509
034236       WHEN SQLCODE > ZERO                                        03423609
034237           MOVE '2201-FETCH-TRIP-CURSOR  '                        03423709
034238                               TO PV-PARAGRAPH-NAME               03423809
034239           MOVE 'FETCH TRIP   CURSOR '                            03423909
034240                               TO PV-DB2-OPERATION-ATTEMPTED      03424009
034241             DISPLAY 'TRIP  ' DK-TRIP-ID                          03424130
034242           PERFORM 9100-SQL-ABEND                                 03424209
034243     END-EVALUATE.                                                03424309
034244                                                                  03424409
034245 2250-FETCH-CARTON-RCVR-CURSOR.                                   03424530
034246     MOVE '2250-FETCH-CARTON-RCVR-CURSOR '                        03424630
034247                                 TO PV-ABEND-PARAGRAPH.           03424730
034248     EXEC SQL                                                     03424830
034249          FETCH CARTON-RCVR-CSR                                   03424930
034250          INTO  :SHUNLO-SHIPT-UNT-ID                              03425030
034251     END-EXEC.                                                    03425130
034252                                                                  03425230
034253     EVALUATE TRUE                                                03425330
034254       WHEN SQLCODE = ZEROS                                       03425430
034255          PERFORM 2300-DELETE-TSHUNLO                             03425530
034256          PERFORM 2350-DELETE-TSULBXF                             03425630
034257          PERFORM 2360-DELETE-OTBND-UCC128                        03425730
034258       WHEN SQLCODE = +100                                        03425830
034259           SET PS-END-OF-CARTON-CURSOR TO TRUE                    03425930
034260       WHEN SQLWARN0 NOT = SPACES                                 03426030
034261       WHEN SQLCODE < ZERO                                        03426130
034262       WHEN SQLCODE > ZERO                                        03426230
034263           MOVE '2250-FETCH-CARTON-RCVR-CURSOR '                  03426330
034264                               TO PV-PARAGRAPH-NAME               03426430
034265           MOVE 'FETCH CARTON RCVR CURSOR '                       03426530
034266                               TO PV-DB2-OPERATION-ATTEMPTED      03426630
034267             DISPLAY 'PO NBR ' DK-PO-NBR 'RCVR ' DK-RECEIVER      03426730
034268           PERFORM 9100-SQL-ABEND                                 03426830
034269     END-EVALUATE.                                                03426930
034270                                                                  03427030
034280 2300-DELETE-TSHUNLO.                                             03428030
034300                                                                  03430009
034400     EXEC SQL                                                     03440009
034500          DELETE FROM TSHUNLO                                     03450009
034600           WHERE SHIPT_UNT_ID    = :SHUNLO-SHIPT-UNT-ID           03460009
034700     END-EXEC.                                                    03470009
034800                                                                  03480009
034900     EVALUATE TRUE                                                03490009
035000         WHEN SQLCODE = ZERO                                      03500009
035100         WHEN SQLCODE = +100                                      03510009
035200              CONTINUE                                            03520009
035300         WHEN OTHER                                               03530009
035400             MOVE '2300-DELETE-TSHUNLO '                          03540009
035500                             TO PV-PARAGRAPH-NAME                 03550009
035600             MOVE 'DELETE TSHUNLO                 '               03560009
035700                             TO PV-DB2-OPERATION-ATTEMPTED        03570009
035800             DISPLAY 'SHIPT ID   ' SHUNLO-SHIPT-UNT-ID            03580009
035900             PERFORM 9100-SQL-ABEND                               03590009
036000     END-EVALUATE.                                                03600009
036100 2350-DELETE-TSULBXF.                                             03610009
036200     EXEC SQL                                                     03620009
036300          DELETE FROM TSULBXF                                     03630009
036400           WHERE SHIPT_UNT_ID    = :SHUNLO-SHIPT-UNT-ID           03640009
036500     END-EXEC.                                                    03650009
036600                                                                  03660009
036700     EVALUATE TRUE                                                03670009
036800         WHEN SQLCODE = ZERO                                      03680009
036900         WHEN SQLCODE = +100                                      03690009
037000              CONTINUE                                            03700009
037100         WHEN OTHER                                               03710009
037200             MOVE '2350-DELETE-TSULBXF '                          03720009
037300                             TO PV-PARAGRAPH-NAME                 03730009
037400             MOVE 'DELETE TSULBXF                 '               03740009
037500                             TO PV-DB2-OPERATION-ATTEMPTED        03750009
037600             DISPLAY 'SHIPT ID   ' SHUNLO-SHIPT-UNT-ID            03760009
037700             PERFORM 9100-SQL-ABEND                               03770009
037800     END-EVALUATE.                                                03780009
037801                                                                  03780109
037802                                                                  03780209
037810 2360-DELETE-OTBND-UCC128.                                        03781009
037811                                                                  03781151
037859                                                                  03785951
037860     EXEC SQL                                                     03786051
037861          SELECT SHIPT_UNT_ID                                     03786151
037862          INTO   :SUT00024-SHIPT-UNT-ID                           03786251
037863          FROM SUT_OTBND_CART                                     03786351
037864           WHERE ORIG_CART_ID    = :SHUNLO-SHIPT-UNT-ID           03786451
037865           AND   ACTV_IND  = 'Y'                                  03786559
037866     END-EXEC.                                                    03786651
037867                                                                  03786709
037868     EVALUATE TRUE                                                03786855
037869         WHEN SQLCODE = ZERO                                      03786955
037870         WHEN SQLCODE = +100                                      03787055
037871         WHEN SQLCODE = -811                                      03787180
037872              CONTINUE                                            03787262
037873         WHEN OTHER                                               03787363
037874             MOVE '2360-DELETE-OTBND-UCC128'                      03787463
037875                             TO PV-PARAGRAPH-NAME                 03787563
037876             MOVE 'SELECT OTBND CRTN DATA'                        03787663
037877                             TO PV-DB2-OPERATION-ATTEMPTED        03787763
037878             DISPLAY 'SHIPT ID   ' SHUNLO-SHIPT-UNT-ID            03787863
037879             PERFORM 9100-SQL-ABEND                               03787963
037880     END-EVALUATE.                                                03788063
037881                                                                  03788163
037890     EXEC SQL                                                     03789063
037891          DELETE FROM SUT_PRC_MSG_CNTL                            03789163
037892           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         03789263
037893     END-EXEC.                                                    03789363
037894                                                                  03789463
037895     EVALUATE TRUE                                                03789563
037896         WHEN SQLCODE = ZERO                                      03789663
037897         WHEN SQLCODE = +100                                      03789763
037898         WHEN SQLCODE = -310                                      03789863
037899              CONTINUE                                            03789963
037900         WHEN OTHER                                               03790063
037901             MOVE '2360-DELETE-OTBND-UCC128'                      03790163
037902                             TO PV-PARAGRAPH-NAME                 03790263
037903             MOVE 'DELETE SUT_PRC_MSG_CNTL'                       03790363
037904                             TO PV-DB2-OPERATION-ATTEMPTED        03790463
037905             DISPLAY 'SHIPT ID   ' SUT00024-SHIPT-UNT-ID          03790563
037906             DISPLAY 'PO ' DK-PO-NBR ' RECEIVER ' DK-RECEIVER     03790663
037907             PERFORM 9100-SQL-ABEND                               03790763
037908     END-EVALUATE.                                                03790863
037909                                                                  03790909
037910     EXEC SQL                                                     03791049
037911          DELETE FROM SUT_FINCL_ADJ                               03791109
037912           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         03791249
037913     END-EXEC.                                                    03791309
037914                                                                  03791409
037915     EVALUATE TRUE                                                03791509
037916         WHEN SQLCODE = ZERO                                      03791609
037917         WHEN SQLCODE = +100                                      03791709
037918         WHEN SQLCODE = -310                                      03791809
037919              CONTINUE                                            03791909
037920         WHEN OTHER                                               03792009
037921             MOVE '2360-DELETE-OTBND-UCC128'                      03792109
037922                             TO PV-PARAGRAPH-NAME                 03792209
037923             MOVE 'DELETE SUT_FINCL_ADJ '                         03792312
037924                             TO PV-DB2-OPERATION-ATTEMPTED        03792409
037925             DISPLAY 'SHIPT ID   ' SUT00024-SHIPT-UNT-ID          03792549
037926             DISPLAY 'PO ' DK-PO-NBR ' RECEIVER ' DK-RECEIVER     03792649
037927             PERFORM 9100-SQL-ABEND                               03792709
037928     END-EVALUATE.                                                03792809
037929                                                                  03792909
037930     EXEC SQL                                                     03793009
037940          DELETE FROM TSUQADJ                                     03794049
037941           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         03794149
037942     END-EXEC.                                                    03794209
037943                                                                  03794309
037944     EVALUATE TRUE                                                03794409
037945         WHEN SQLCODE = ZERO                                      03794509
037946         WHEN SQLCODE = +100                                      03794609
037947         WHEN SQLCODE = -310                                      03794709
037948              CONTINUE                                            03794809
037949         WHEN OTHER                                               03794909
037950             MOVE '2360-DELETE-OTBND-UCC128'                      03795009
037951                             TO PV-PARAGRAPH-NAME                 03795109
037952             MOVE 'DELETE TSUQADJ       '                         03795212
037953                             TO PV-DB2-OPERATION-ATTEMPTED        03795309
037954             DISPLAY 'SHIPT ID   ' SHUNLO-SHIPT-UNT-ID            03795409
037955             PERFORM 9100-SQL-ABEND                               03795509
037956     END-EVALUATE.                                                03795609
037957                                                                  03795709
037958     EXEC SQL                                                     03795859
037959          DELETE FROM SUT_OTBND_CART                              03795959
037960           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         03796059
037962     END-EXEC.                                                    03796259
037963                                                                  03796309
037964     EVALUATE TRUE                                                03796459
037965         WHEN SQLCODE = ZERO                                      03796559
037966         WHEN SQLCODE = +100                                      03796659
037967         WHEN SQLCODE = -310                                      03796763
037968              CONTINUE                                            03796862
037969         WHEN OTHER                                               03796962
037970             MOVE '2360-DELETE-OTBND-UCC128'                      03797062
037971                             TO PV-PARAGRAPH-NAME                 03797162
037972             MOVE 'DELETE OTBND 128 DATA'                         03797262
037973                             TO PV-DB2-OPERATION-ATTEMPTED        03797362
037974             DISPLAY 'SHIPT ID   ' SHUNLO-SHIPT-UNT-ID            03797462
037975             PERFORM 9100-SQL-ABEND                               03797562
037976     END-EVALUATE.                                                03797662
037977                                                                  03797762
037978*    EXEC SQL                                                     03797862
037979*        UPDATE SUT_OTBND_CART                                    03797962
037980*        SET ACTV_IND          = 'I'                              03798062
037981*        WHERE ORIG_CART_ID    = :SHUNLO-SHIPT-UNT-ID             03798162
037982*    END-EXEC.                                                    03798262
037983*                                                                 03798362
037984*    EVALUATE TRUE                                                03798462
037985*        WHEN SQLCODE = ZERO                                      03798562
037986*        WHEN SQLCODE = +100                                      03798662
037987*             CONTINUE                                            03798762
037988*        WHEN OTHER                                               03798862
037989*            MOVE '2360-DELETE-OTBND-UCC128'                      03798962
037990*                            TO PV-PARAGRAPH-NAME                 03799062
037991*            MOVE 'UPDATE OTBND 128 DATA'                         03799162
037992*                            TO PV-DB2-OPERATION-ATTEMPTED        03799262
037993*            DISPLAY 'SHIPT ID   ' SHUNLO-SHIPT-UNT-ID            03799362
037994*            PERFORM 9100-SQL-ABEND                               03799462
037995*    END-EVALUATE.                                                03799562
037996                                                                  03799662
040100 2401-CLOSE-TRIP-CURSOR.                                          04010080
040101     MOVE '2401-CLOSE-TRIP-CURSOR   '                             04010180
040102                                 TO PV-ABEND-PARAGRAPH.           04010209
040103     EXEC SQL                                                     04010309
040104         CLOSE TRIP-RCVR-CSR                                      04010430
040105     END-EXEC.                                                    04010509
040106     EVALUATE TRUE                                                04010609
040107         WHEN SQLCODE = -904                                      04010709
040108         WHEN SQLCODE = -911                                      04010809
040109             CONTINUE                                             04010909
040110         WHEN SQLWARN0 NOT = SPACES                               04011009
040111         WHEN SQLCODE < ZERO                                      04011109
040112         WHEN SQLCODE > ZERO                                      04011209
040113             MOVE '2401-CLOSE-CURSOR '                            04011309
040114                             TO PV-PARAGRAPH-NAME                 04011409
040115             MOVE 'CLOSE THE TRIP-RCVR-CURSOR     '               04011509
040116                             TO PV-DB2-OPERATION-ATTEMPTED        04011609
040117             PERFORM 9100-SQL-ABEND                               04011709
040118          WHEN SQLCODE = ZERO                                     04011809
040119              CONTINUE                                            04011909
040120     END-EVALUATE.                                                04012009
040121*                                                                 04012109
040122 2450-CLOSE-CARTON-RCVR-CURSOR.                                   04012231
040123     MOVE '2450-CLOSE-CARTON-RCVR-CURSOR   '                      04012331
040124                                 TO PV-ABEND-PARAGRAPH.           04012431
040125     EXEC SQL                                                     04012531
040126         CLOSE CARTON-RCVR-CSR                                    04012631
040127     END-EXEC.                                                    04012731
040128     EVALUATE TRUE                                                04012831
040129         WHEN SQLCODE = -904                                      04012931
040130         WHEN SQLCODE = -911                                      04013031
040131             CONTINUE                                             04013131
040132         WHEN SQLWARN0 NOT = SPACES                               04013231
040133         WHEN SQLCODE < ZERO                                      04013331
040134         WHEN SQLCODE > ZERO                                      04013431
040135             MOVE '2450-CLOSE-CARTON-RCVR-CURSOR   '              04013531
040136                             TO PV-PARAGRAPH-NAME                 04013631
040137             MOVE 'CLOSE THE CARTON_RCVR_CURRSOR        '         04013731
040138                             TO PV-DB2-OPERATION-ATTEMPTED        04013831
040139             PERFORM 9100-SQL-ABEND                               04013931
040140          WHEN SQLCODE = ZERO                                     04014031
040141              CONTINUE                                            04014131
040142     END-EVALUATE.                                                04014231
040143*                                                                 04014331
042110 2550-UPDATE-TLBVRDA.                                             04211031
042120     EXEC SQL                                                     04212031
042130          UPDATE TLBVRDA                                          04213031
042140             SET                                                  04214031
042150                  LBL_ASG_IND        = 'N'                        04215031
042160           WHERE  PO_NBR             = :DK-PO-NBR                 04216031
042161           AND    RCVR_SEQ_NBR       = :DK-RECEIVER               04216131
042170     END-EXEC.                                                    04217031
042180                                                                  04218031
042190     EVALUATE TRUE                                                04219031
042191         WHEN SQLCODE = ZERO                                      04219131
042192         WHEN SQLCODE = +100                                      04219231
042193              CONTINUE                                            04219331
042194         WHEN OTHER                                               04219431
042195             MOVE '2550-UPDATE-TLBVRDA '                          04219531
042196                             TO PV-PARAGRAPH-NAME                 04219631
042197             MOVE 'UPDATE TLBVRDA '                               04219731
042198                             TO PV-DB2-OPERATION-ATTEMPTED        04219831
042199             DISPLAY 'PO NUMBER  ' DK-PO-NBR ' RECEIVER '         04219931
042200                  DK-RECEIVER                                     04220031
042201             PERFORM 9100-SQL-ABEND                               04220131
042202     END-EVALUATE.                                                04220231
042203                                                                  04220331
042210 2600-DELETE-TLBVRMG.                                             04221031
042300     EXEC SQL                                                     04230009
042400          DELETE FROM TLBVRMG                                     04240009
042500           WHERE PO_NBR          = :DK-PO-NBR                     04250009
042600     END-EXEC.                                                    04260009
042700                                                                  04270009
042800     EVALUATE TRUE                                                04280009
042900         WHEN SQLCODE = ZERO                                      04290009
043000         WHEN SQLCODE = +100                                      04300009
043100              CONTINUE                                            04310009
043200         WHEN OTHER                                               04320009
043300             MOVE '2600-DELETE-TLBVRMG '                          04330009
043400                             TO PV-PARAGRAPH-NAME                 04340009
043500             MOVE 'DELETE TLBVRMG'                                04350009
043600                             TO PV-DB2-OPERATION-ATTEMPTED        04360009
043700             DISPLAY 'PO NUMBER  ' DK-PO-NBR                      04370009
043800             PERFORM 9100-SQL-ABEND                               04380009
043900     END-EVALUATE.                                                04390009
046000                                                                  04600009
046010 2750-OPEN-AUDIT-RCVR-CURSOR.                                     04601031
046020     MOVE '2750-OPEN-AUDIT-RCVR-CURSOR   '                        04602031
046030                                 TO PV-ABEND-PARAGRAPH.           04603031
046040     EXEC SQL                                                     04604031
046050         OPEN AUDIT-RCVR-CSR                                      04605031
046060     END-EXEC.                                                    04606031
046070     EVALUATE TRUE                                                04607031
046080         WHEN SQLCODE = ZERO                                      04608031
046090         WHEN SQLCODE = -904                                      04609031
046091         WHEN SQLCODE = -911                                      04609131
046092             CONTINUE                                             04609231
046093         WHEN SQLWARN0 NOT = SPACES                               04609331
046094         WHEN SQLCODE < ZERO                                      04609431
046095         WHEN SQLCODE > ZERO                                      04609531
046096            MOVE '2750-OPEN-AUDIT-RCVR-CURSOR   '                 04609631
046098                             TO PV-PARAGRAPH-NAME                 04609831
046099             MOVE 'OPEN THE AUDIT_RCVR-CUROSR         '           04609931
046100                             TO PV-DB2-OPERATION-ATTEMPTED        04610031
046101             DISPLAY 'PO ' DK-PO-NBR ' RECEIVER ' DK-RECEIVER     04610131
046102             PERFORM 9100-SQL-ABEND                               04610231
046103     END-EVALUATE.                                                04610331
046104                                                                  04610431
048810 2850-FETCH-AUDIT-RCVR-CURSOR.                                    04881031
048820     MOVE '2850-FETCH-AUDIT-RCVR-CURSOR   '                       04882031
048830                                 TO PV-ABEND-PARAGRAPH.           04883031
048840     EXEC SQL                                                     04884031
048850          FETCH AUDIT-RCVR-CSR                                    04885031
048860          INTO  :SUT00015-AUD-CNTL-NBR                            04886031
048870              , :SUT00015-CRE-TMST                                04887080
048871              , :SUT00015-RWRK-AUD-CNTL-NBR :DN-RWRK              04887180
048872     END-EXEC.                                                    04887231
048880                                                                  04888031
048890     EVALUATE TRUE                                                04889031
048891       WHEN SQLCODE = ZEROS                                       04889131
048892          IF PV-DEL-SUT-PO-AUD-REQ = 'Y'                          04889231
048893             PERFORM 3050-DELETE-SUT-PO-AUD-REQ                   04889331
048894             IF SUT00015-RWRK-AUD-CNTL-NBR > 0                    04889480
048895                PERFORM 3060-DELETE-SUT-PO-AUD-RWRK               04889580
048896             END-IF                                               04889680
048897          END-IF                                                  04889731
048898          IF PV-DEL-TSUNAUD = 'Y'                                 04889831
048899             PERFORM 2900-DELETE-TSUNAUD                          04889931
048900          END-IF                                                  04890031
048901          IF PV-DEL-TSUATRN = 'Y'                                 04890131
048902             PERFORM 2950-DELETE-TSUATRN                          04890231
048903          END-IF                                                  04890331
048904          IF PV-DEL-TSUAUPC = 'Y'                                 04890431
048905             PERFORM 3000-DELETE-TSUAUPC                          04890531
048906          END-IF                                                  04890631
048907       WHEN SQLCODE = +100                                        04890731
048908           SET PS-END-OF-AUDIT-CURSOR TO TRUE                     04890831
048909       WHEN SQLWARN0 NOT = SPACES                                 04890931
048910       WHEN SQLCODE < ZERO                                        04891031
048911       WHEN SQLCODE > ZERO                                        04891131
048912           MOVE '2850-FETCH-AUDIT-RCVR-CURSOR'                    04891231
048913                               TO PV-PARAGRAPH-NAME               04891331
048914           MOVE 'FETCH AUDIT RCVR  CURSOR '                       04891431
048915                               TO PV-DB2-OPERATION-ATTEMPTED      04891531
048916             DISPLAY 'PO ' DK-PO-NBR ' RECEIVER ' DK-RECEIVER     04891631
048917           PERFORM 9100-SQL-ABEND                                 04891731
048918     END-EVALUATE.                                                04891831
048919                                                                  04891931
048920 2900-DELETE-TSUNAUD.                                             04892031
049000                                                                  04900009
049100     EXEC SQL                                                     04910009
049200          DELETE FROM TSUNAUD                                     04920009
049300           WHERE AUD_CNTL_NBR    = :SUT00015-AUD-CNTL-NBR         04930009
049400     END-EXEC.                                                    04940009
049500                                                                  04950009
049600     EVALUATE TRUE                                                04960009
049700         WHEN SQLCODE = ZERO                                      04970009
049800         WHEN SQLCODE = +100                                      04980009
049900              CONTINUE                                            04990009
050000         WHEN OTHER                                               05000009
050100             MOVE '2900-DELETE-TSUNAUD '                          05010009
050200                             TO PV-PARAGRAPH-NAME                 05020009
050300             MOVE 'DELETE TSUNAUD'                                05030009
050400                             TO PV-DB2-OPERATION-ATTEMPTED        05040009
050500             DISPLAY 'AUDIT NUMBER' SUT00015-AUD-CNTL-NBR         05050009
050600             PERFORM 9100-SQL-ABEND                               05060009
050700     END-EVALUATE.                                                05070009
050710                                                                  05071009
050720                                                                  05072009
050800 2950-DELETE-TSUATRN.                                             05080009
050900                                                                  05090009
051000     EXEC SQL                                                     05100009
051100          DELETE FROM TSUATRN                                     05110009
051200           WHERE AUD_CNTL_NBR    = :SUT00015-AUD-CNTL-NBR         05120009
051300     END-EXEC.                                                    05130009
051400                                                                  05140009
051500     EVALUATE TRUE                                                05150009
051600         WHEN SQLCODE = ZERO                                      05160009
051700         WHEN SQLCODE = +100                                      05170009
051800              CONTINUE                                            05180009
051900         WHEN OTHER                                               05190009
052000             MOVE '2950-DELETE-TSUATRN '                          05200009
052100                             TO PV-PARAGRAPH-NAME                 05210009
052200             MOVE 'DELETE TSUATRN'                                05220009
052300                             TO PV-DB2-OPERATION-ATTEMPTED        05230009
052400             DISPLAY 'AUD NUMBER ' SUT00015-AUD-CNTL-NBR          05240009
052500             PERFORM 9100-SQL-ABEND                               05250009
052600     END-EVALUATE.                                                05260009
052700 3000-DELETE-TSUAUPC.                                             05270009
052800                                                                  05280009
052900     EXEC SQL                                                     05290009
053000          DELETE FROM TSUAUPC                                     05300009
053100           WHERE AUD_CNTL_NBR    = :SUT00015-AUD-CNTL-NBR         05310009
053200     END-EXEC.                                                    05320009
053300                                                                  05330009
053400     EVALUATE TRUE                                                05340009
053500         WHEN SQLCODE = ZERO                                      05350009
053600         WHEN SQLCODE = +100                                      05360009
053700              CONTINUE                                            05370009
053800         WHEN OTHER                                               05380009
053900             MOVE '2900-DELETE-TSUAUPC '                          05390009
054000                             TO PV-PARAGRAPH-NAME                 05400009
054100             MOVE 'DELETE TSUAUPC'                                05410009
054200                             TO PV-DB2-OPERATION-ATTEMPTED        05420009
054300             DISPLAY 'AUDIT NUMBER' SUT00015-AUD-CNTL-NBR         05430009
054400             PERFORM 9100-SQL-ABEND                               05440009
054500     END-EVALUATE.                                                05450009
054600 3050-DELETE-SUT-PO-AUD-REQ.                                      05460009
054700     DISPLAY '3050-DELETE-SUT-PO-AUD-REQ'                         05470009
054710     DISPLAY 'AUD CNTL NBR  ' SUT00015-AUD-CNTL-NBR               05471080
054800     EXEC SQL                                                     05480009
054900          DELETE FROM SUT_PO_AUD_REQ                              05490009
055000           WHERE AUD_CNTL_NBR  = :SUT00015-AUD-CNTL-NBR           05500009
055100     END-EXEC.                                                    05510009
055200                                                                  05520009
055300     EVALUATE TRUE                                                05530009
055400         WHEN SQLCODE = ZERO                                      05540009
055500         WHEN SQLCODE = +100                                      05550009
055600              CONTINUE                                            05560009
055700         WHEN OTHER                                               05570009
055800             MOVE '3050-DELETE-SUT-PO-AUD-REQ'                    05580009
055900                             TO PV-PARAGRAPH-NAME                 05590009
056000             MOVE 'DELETE SUT00015 '                              05600009
056100                             TO PV-DB2-OPERATION-ATTEMPTED        05610009
056200             DISPLAY 'AUDIT NUMBER' SUT00015-AUD-CNTL-NBR         05620009
056300             PERFORM 9100-SQL-ABEND                               05630009
056400     END-EVALUATE.                                                05640009
056500                                                                  05650009
056600                                                                  05660009
056700                                                                  05670009
056701 3060-DELETE-SUT-PO-AUD-RWRK.                                     05670180
056702     DISPLAY ' 3060-DELETE-SUT-PO-AUD-RWRK'                       05670209
056703     EXEC SQL                                                     05670309
056704          DELETE FROM SUT_PO_AUD_REQ                              05670409
056705           WHERE RWRK_AUD_CNTL_NBR = :SUT00015-RWRK-AUD-CNTL-NBR  05670509
056706            AND PO_NBR        = :DK-PO-NBR                        05670680
056707            AND RCVR_SEQ_NBR  = :DK-RECEIVER                      05670780
056708     END-EXEC.                                                    05670809
056709                                                                  05670909
056710     EVALUATE TRUE                                                05671009
056711         WHEN SQLCODE = ZERO                                      05671109
056712         WHEN SQLCODE = +100                                      05671209
056713              CONTINUE                                            05671309
056714         WHEN OTHER                                               05671409
056715             MOVE '3060-DELETE-SUT-PO-AUD-REQ-RWRK'               05671509
056716                             TO PV-PARAGRAPH-NAME                 05671609
056717             MOVE 'DELETE SUT00015 '                              05671709
056718                             TO PV-DB2-OPERATION-ATTEMPTED        05671809
056719             DISPLAY 'AUDIT NUMBER' SUT00015-AUD-CNTL-NBR         05671909
056720             PERFORM 9100-SQL-ABEND                               05672009
056721     END-EVALUATE.                                                05672109
056722                                                                  05672209
056723                                                                  05672309
056724                                                                  05672409
056800                                                                  05680009
059010                                                                  05901010
059011 3150-CLOSE-AUDIT-RCVR-CURSOR.                                    05901133
059012     MOVE '3150-CLOSE-AUDIT-RCVR-CURSOR   '                       05901233
059013                                 TO PV-ABEND-PARAGRAPH.           05901333
059014     EXEC SQL                                                     05901433
059015         CLOSE AUDIT-RCVR-CSR                                     05901533
059016     END-EXEC.                                                    05901633
059017     EVALUATE TRUE                                                05901733
059018         WHEN SQLCODE = -904                                      05901833
059019         WHEN SQLCODE = -911                                      05901933
059020             CONTINUE                                             05902033
059021         WHEN SQLWARN0 NOT = SPACES                               05902133
059022         WHEN SQLCODE < ZERO                                      05902233
059023         WHEN SQLCODE > ZERO                                      05902333
059024             MOVE '3150-CLOSE-RCVR-CURSOR '                       05902433
059025                             TO PV-PARAGRAPH-NAME                 05902533
059026             MOVE 'CLOSE THE AUDIT_RCVR-CURSOR        '           05902633
059027                             TO PV-DB2-OPERATION-ATTEMPTED        05902733
059028             PERFORM 9100-SQL-ABEND                               05902833
059029          WHEN SQLCODE = ZERO                                     05902933
059030              CONTINUE                                            05903033
059031     END-EVALUATE.                                                05903133
059032                                                                  05903233
059033                                                                  05903333
059034                                                                  05903433
059035 3200-OPEN-OTBND-P2L-128.                                         05903533
059036                                                                  05903633
059037     MOVE '3200-OPEN-OTBND-P2L-128    '                           05903733
059038                                 TO PV-ABEND-PARAGRAPH.           05903833
059039     EXEC SQL                                                     05903933
059040         OPEN OTBND-P2L-128-CSR                                   05904033
059041     END-EXEC.                                                    05904133
059042                                                                  05904233
059043     EVALUATE TRUE                                                05904333
059044         WHEN SQLCODE = ZERO                                      05904433
059045         WHEN SQLCODE = -904                                      05904533
059046         WHEN SQLCODE = -911                                      05904633
059047             CONTINUE                                             05904733
059048         WHEN SQLWARN0 NOT = SPACES                               05904833
059049         WHEN SQLCODE < ZERO                                      05904933
059050         WHEN SQLCODE > ZERO                                      05905033
059051             MOVE '3200-OPEN-OTBND-P2L-128 '                      05905133
059052                             TO PV-PARAGRAPH-NAME                 05905233
059053             MOVE 'OPEN THE OTBND CURSOR         '                05905333
059054                             TO PV-DB2-OPERATION-ATTEMPTED        05905433
059055             DISPLAY 'PO NUMBER   ' DK-PO-NBR                     05905533
059056             PERFORM 9100-SQL-ABEND                               05905633
059057     END-EVALUATE.                                                05905733
059058                                                                  05905833
059059 3250-FETCH-OTBND-P2L-128.                                        05905933
059060                                                                  05906033
059061     MOVE '3250-FETCH-OTBND-P2L-128    '                          05906133
059062                                 TO PV-ABEND-PARAGRAPH.           05906233
059063     EXEC SQL                                                     05906333
059064         FETCH OTBND-P2L-128-CSR                                  05906433
059065         INTO  :SUT00024-SHIPT-UNT-ID                             05906533
059066     END-EXEC.                                                    05906633
059067                                                                  05906733
059068     EVALUATE TRUE                                                05906833
059069       WHEN SQLCODE = ZEROS                                       05906933
059070          PERFORM 3300-DELETE-OTBND-P2L-128                       05907033
059071       WHEN SQLCODE = +100                                        05907133
059072           SET PS-END-OF-OTBND-CURSOR TO TRUE                     05907233
059073         WHEN SQLCODE = -904                                      05907333
059074         WHEN SQLCODE = -911                                      05907433
059075             CONTINUE                                             05907533
059076         WHEN SQLWARN0 NOT = SPACES                               05907633
059077         WHEN SQLCODE < ZERO                                      05907733
059078         WHEN SQLCODE > ZERO                                      05907833
059079             MOVE '3250-FETCH-OTBND-P2L-128'                      05907933
059080                             TO PV-PARAGRAPH-NAME                 05908033
059081             MOVE 'FETCH OTBND NO 128 CURSOR     '                05908133
059082                             TO PV-DB2-OPERATION-ATTEMPTED        05908233
059083             DISPLAY 'PO NUMBER   ' DK-PO-NBR                     05908333
059084             PERFORM 9100-SQL-ABEND                               05908433
059085     END-EVALUATE.                                                05908533
059086                                                                  05908633
059087 3300-DELETE-OTBND-P2L-128.                                       05908733
059088                                                                  05908833
059089     EXEC SQL                                                     05908933
059090          DELETE FROM SUT_OTBND_UPC                               05909033
059091           WHERE SHIPT_UNT_ID  = :SUT00024-SHIPT-UNT-ID           05909133
059092             AND TRN_NBR        = :DK-PO-NBR                      05909233
059093             AND RCVR_SEQ_NBR   = :DK-RECEIVER                    05909333
059094     END-EXEC.                                                    05909433
059095                                                                  05909533
059096     EVALUATE TRUE                                                05909633
059097         WHEN SQLCODE = ZERO                                      05909733
059098         WHEN SQLCODE = +100                                      05909833
059099              CONTINUE                                            05909933
059100         WHEN OTHER                                               05910033
059101             MOVE '3300-DELETE-OTBND-P2L-128'                     05910133
059102                             TO PV-PARAGRAPH-NAME                 05910233
059103             MOVE 'DELETE OTBND CART NO 128'                      05910333
059104                             TO PV-DB2-OPERATION-ATTEMPTED        05910433
059105             MOVE SUT00024-SHIPT-UNT-ID TO                        05910533
059106                  PV-DISPLAY-FIELD                                05910633
059107             DISPLAY 'SHIP UNIT ID ' PV-DISPLAY-FIELD             05910733
059108             PERFORM 9100-SQL-ABEND                               05910833
059109     END-EVALUATE.                                                05910933
059110                                                                  05911033
059111 3400-CLOSE-OTBND-P2L-128.                                        05911133
059112     MOVE '3400-CLOSE-OTBND-P2L-128   '                           05911233
059113                                 TO PV-ABEND-PARAGRAPH.           05911333
059114     EXEC SQL                                                     05911433
059115         CLOSE OTBND-P2L-128-CSR                                  05911533
059116     END-EXEC.                                                    05911633
059117                                                                  05911733
059118     EVALUATE TRUE                                                05911833
059119         WHEN SQLCODE = ZERO                                      05911933
059120         WHEN SQLCODE = -904                                      05912033
059121         WHEN SQLCODE = -911                                      05912133
059122             CONTINUE                                             05912233
059123         WHEN SQLWARN0 NOT = SPACES                               05912333
059124         WHEN SQLCODE < ZERO                                      05912433
059125         WHEN SQLCODE > ZERO                                      05912533
059126             MOVE '3400-CLOSE-OTBND-P2L-128'                      05912633
059127                             TO PV-PARAGRAPH-NAME                 05912733
059128             MOVE 'CLOSE THE OTBND NO 128 CURSOR '                05912833
059129                             TO PV-DB2-OPERATION-ATTEMPTED        05912933
059130             PERFORM 9100-SQL-ABEND                               05913033
059131          WHEN SQLCODE = ZERO                                     05913133
059132              CONTINUE                                            05913233
059133     END-EVALUATE.                                                05913333
059134                                                                  05913433
059135*                                                                 05913533
059171 4100-OPEN-PO-CURSOR.                                             05917133
059172     MOVE '4100-OPEN-PO-CURSOR  '                                 05917233
059173                                 TO PV-ABEND-PARAGRAPH.           05917333
059174     EXEC SQL                                                     05917433
059175         OPEN PO-CURSOR                                           05917533
059176     END-EXEC.                                                    05917633
059177     EVALUATE TRUE                                                05917733
059178         WHEN SQLCODE = ZERO                                      05917833
059179         WHEN SQLCODE = -904                                      05917933
059180         WHEN SQLCODE = -911                                      05918033
059181             CONTINUE                                             05918133
059182         WHEN SQLWARN0 NOT = SPACES                               05918233
059183         WHEN SQLCODE < ZERO                                      05918333
059184         WHEN SQLCODE > ZERO                                      05918433
059185             MOVE '4100-OPEN-PO-CURSOR   '                        05918533
059186                             TO PV-PARAGRAPH-NAME                 05918633
059187             MOVE 'OPEN THE CARTON_CUROSR         '               05918733
059188                             TO PV-DB2-OPERATION-ATTEMPTED        05918833
059189             DISPLAY 'PO NUMBER     ' DK-PO-NBR                   05918933
059190             PERFORM 9100-SQL-ABEND                               05919033
059191     END-EVALUATE.                                                05919133
059192                                                                  05919233
059193 4200-FETCH-PO-CURSOR.                                            05919333
059194     MOVE '4200-FETCH-PO-CURSOR    '                              05919433
059195                                 TO PV-ABEND-PARAGRAPH.           05919533
059196     EXEC SQL                                                     05919633
059197          FETCH PO-CURSOR                                         05919733
059198          INTO  :SHUNLO-TRIP-ID                                   05919833
059199               ,:PKSLIP-PO-NBR                                    05919933
059200               ,:PKSLIP-REC-SEQ-NBR                               05920033
059201     END-EXEC.                                                    05920133
059202                                                                  05920233
059203     EVALUATE TRUE                                                05920333
059204       WHEN SQLCODE = ZEROS                                       05920433
059205            MOVE SHUNLO-TRIP-ID  TO DK-TRIP-ID                    05920533
059206*           PERFORM 2015-PROCESS-DELETES                          05920633
059207       WHEN SQLCODE = +100                                        05920733
059208           SET PS-END-OF-PO-CURSOR TO TRUE                        05920833
059209       WHEN SQLWARN0 NOT = SPACES                                 05920933
059210       WHEN SQLCODE < ZERO                                        05921033
059211       WHEN SQLCODE > ZERO                                        05921133
059212           MOVE '4200-FETCH-PO-CURSOR  '                          05921233
059213                               TO PV-PARAGRAPH-NAME               05921333
059214           MOVE 'FETCH PO CURSOR '                                05921433
059215                               TO PV-DB2-OPERATION-ATTEMPTED      05921533
059216           DISPLAY 'PO NUMBER   ' DK-PO-NBR                       05921633
059217           PERFORM 9100-SQL-ABEND                                 05921733
059218     END-EVALUATE.                                                05921833
059219                                                                  05921933
059220 4400-CLOSE-PO-CURSOR.                                            05922033
059221     MOVE '4400-CLOSE-CARTON-CURSOR   '                           05922133
059222                                 TO PV-ABEND-PARAGRAPH.           05922233
059223     EXEC SQL                                                     05922333
059224         CLOSE PO-CURSOR                                          05922433
059225     END-EXEC.                                                    05922533
059226     EVALUATE TRUE                                                05922633
059227         WHEN SQLCODE = -904                                      05922733
059228         WHEN SQLCODE = -911                                      05922833
059229             CONTINUE                                             05922933
059230         WHEN SQLWARN0 NOT = SPACES                               05923033
059231         WHEN SQLCODE < ZERO                                      05923133
059232         WHEN SQLCODE > ZERO                                      05923233
059233             MOVE '4400-CLOSE-PO-CURSOR  '                        05923333
059234                             TO PV-PARAGRAPH-NAME                 05923433
059235             MOVE 'CLOSE THE PO CURSOR  '                         05923533
059236                             TO PV-DB2-OPERATION-ATTEMPTED        05923633
059237             PERFORM 9100-SQL-ABEND                               05923733
059238          WHEN SQLCODE = ZERO                                     05923833
059239              CONTINUE                                            05923933
059240     END-EVALUATE.                                                05924033
059241                                                                  05924133
059242                                                                  05924233
059243 4500-DELETE-DISTDT.                                              05924349
059244     MOVE '4500-DELETE-DISTDT         '                           05924433
059245                                 TO PV-ABEND-PARAGRAPH.           05924533
059246     EXEC SQL                                                     05924633
059247         DELETE                                                   05924733
059248          FROM   TDISTDT                                          05924849
059249          WHERE  ORD_NBR = :DK-PO-NBR                             05924949
059250          AND    RCVR_SEQ_NBR = :DK-RECEIVER                      05925049
059251     END-EXEC.                                                    05925133
059252     EVALUATE TRUE                                                05925233
059253          WHEN SQLCODE = ZERO                                     05925333
059254          WHEN SQLCODE = +100                                     05925433
059255              CONTINUE                                            05925533
059256         WHEN SQLCODE = -904                                      05925633
059257         WHEN SQLCODE = -911                                      05925733
059258             CONTINUE                                             05925833
059259         WHEN SQLWARN0 NOT = SPACES                               05925933
059260         WHEN SQLCODE < ZERO                                      05926033
059261         WHEN SQLCODE > ZERO                                      05926133
059262             MOVE '4500-DELETE-DISTDT    '                        05926233
059263                             TO PV-PARAGRAPH-NAME                 05926333
059264             MOVE 'DELETE FROM DISTDT   '                         05926433
059265                             TO PV-DB2-OPERATION-ATTEMPTED        05926533
059266             PERFORM 9100-SQL-ABEND                               05926633
059267             DISPLAY 'PO NUMBER   ' DK-PO-NBR ' RECEIVER '        05926733
059268              DK-RECEIVER                                         05926849
059269     END-EVALUATE.                                                05926933
059270                                                                  05927033
059271 4550-DELETE-DISTHD.                                              05927133
059272     MOVE '4550-DELETE-DISTHD         '                           05927233
059273                                 TO PV-ABEND-PARAGRAPH.           05927333
059274     EXEC SQL                                                     05927433
059275         DELETE                                                   05927533
059276          FROM   TDISTHD                                          05927649
059277          WHERE  ORD_NBR = :DK-PO-NBR                             05927749
059278          AND    RCVR_SEQ_NBR = :DK-RECEIVER                      05927849
059279     END-EXEC.                                                    05927933
059280     EVALUATE TRUE                                                05928033
059281          WHEN SQLCODE = ZERO                                     05928133
059282          WHEN SQLCODE = +100                                     05928233
059283              CONTINUE                                            05928333
059284         WHEN SQLCODE = -904                                      05928433
059285         WHEN SQLCODE = -911                                      05928533
059286             CONTINUE                                             05928633
059287         WHEN SQLWARN0 NOT = SPACES                               05928733
059288         WHEN SQLCODE < ZERO                                      05928833
059289         WHEN SQLCODE > ZERO                                      05928933
059290             MOVE '4550-DELETE-DISTHD    '                        05929033
059291                             TO PV-PARAGRAPH-NAME                 05929133
059292             MOVE 'DELETE FROM DISTHD   '                         05929233
059293                             TO PV-DB2-OPERATION-ATTEMPTED        05929333
059294             PERFORM 9100-SQL-ABEND                               05929433
059295             DISPLAY 'PO NUMBER   ' DK-PO-NBR ' RECEIVER '        05929533
059296              DK-RECEIVER                                         05929649
059297     END-EVALUATE.                                                05929733
059298                                                                  05929833
059299     EXEC SQL                                                     05929933
059300         DELETE                                                   05930033
059400          FROM   TLBVRDA                                          05940049
059500          WHERE  PO_NBR = :DK-PO-NBR                              05950049
059501          AND    RCVR_SEQ_NBR = :DK-RECEIVER                      05950149
059502     END-EXEC.                                                    05950233
059503     EVALUATE TRUE                                                05950333
059504          WHEN SQLCODE = ZERO                                     05950433
059505          WHEN SQLCODE = +100                                     05950533
059506              CONTINUE                                            05950633
059507         WHEN SQLCODE = -904                                      05950733
059508         WHEN SQLCODE = -911                                      05950833
059509             CONTINUE                                             05950933
059510         WHEN SQLWARN0 NOT = SPACES                               05951033
059511         WHEN SQLCODE < ZERO                                      05951133
059512         WHEN SQLCODE > ZERO                                      05951233
059513             MOVE '4550-DELETE-DISTHD    '                        05951333
059514                             TO PV-PARAGRAPH-NAME                 05951433
059515             MOVE 'DELETE FROM LBVRDA   '                         05951533
059516                             TO PV-DB2-OPERATION-ATTEMPTED        05951633
059517             PERFORM 9100-SQL-ABEND                               05951733
059518             DISPLAY 'PO NUMBER   ' DK-PO-NBR ' RECEIVER '        05951833
059519              DK-RECEIVER                                         05951949
059520     END-EVALUATE.                                                05952033
059521                                                                  05952133
059522 7000-READ-DELETE-FILE.                                           05952233
059523******************************************************************05952309
059524                                                                  05952409
059525     READ PO-TRIP-ID-DEL-FILE INTO DELETE-RECORD-INPUT            05952509
059526        AT END                                                    05952609
059600           SET PS-END-OF-DELETE-FILE TO TRUE.                     05960009
059700                                                                  05970009
059710     IF PS-NOT-END-OF-DELETE-FILE                                 05971009
059800        MOVE DR-TRIP-ID            TO DK-TRIP-ID                  05980009
059900        MOVE DR-PO-NBR             TO DK-PO-NBR                   05990009
059901        MOVE DR-RECEIVER           TO DK-RECEIVER                 05990109
059910                                                                  05991009
059911        DISPLAY 'PO NBR  ' DK-PO-NBR ' RCVR ' DK-RECEIVER         05991149
059912        ' TRIP ' DK-TRIP-ID                                       05991280
059913                                                                  05991309
060000        MOVE DR-DEL-SHUNLO-XREF    TO PV-DEL-UNLO-XREF-OTBND      06000009
060100        MOVE DR-UPD-TLBVRDA        TO PV-UPD-TLBVRDA              06010009
060200        MOVE DR-DEL-TLBVRMG        TO PV-DEL-TLBVRMG              06020009
060210        MOVE DR-DEL-TSUNAUD        TO PV-DEL-TSUNAUD              06021009
060220        MOVE DR-DEL-TSUATRN        TO PV-DEL-TSUATRN              06022009
060230        MOVE DR-DEL-TSUAUPC        TO PV-DEL-TSUAUPC              06023009
060240        MOVE DR-DEL-SUT-PO-AUD-REQ TO PV-DEL-SUT-PO-AUD-REQ       06024009
060241        MOVE DR-DEL-OTBND-P2L-128  TO PV-DEL-OTBND-P2L-128        06024118
060242        MOVE DR-DEL-CSEPK          TO PV-DEL-CSEPK                06024249
060250     END-IF.                                                      06025009
060300*                                                                 06030009
060400*                                                                 06040009
060500 9000-EOJ-ROUTINE.                                                06050009
060600                                                                  06060009
060700     CLOSE PO-TRIP-ID-DEL-FILE.                                   06070009
060900                                                                  06090009
061000 9100-SQL-ABEND.                                                  06100009
061100******************************************************************06110009
061200*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    06120009
061300*  ERROR OR WARNING CODE OCCURS.                                  06130009
061400******************************************************************06140009
061500     DISPLAY '** ABEND     **'.                                   06150009
061600     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        06160009
061700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              06170009
061800     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     06180009
061900                                                                  06190009
062000******************************************************************06200009
062100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    06210009
062200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         06220009
062300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     06230009
062400* FORMAT.                                                         06240009
062500******************************************************************06250009
062600     COPY DPPD004.                                                06260009
062700                                                                  06270009
062800     MOVE +4013                  TO ABEND-CODE.                   06280009
062900     CALL 'ILBOABN0' USING ABEND-CODE.                            06290009
