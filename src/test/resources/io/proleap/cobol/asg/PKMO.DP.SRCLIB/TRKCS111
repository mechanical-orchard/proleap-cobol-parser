000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    TRKCS111.                                         00020000
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  11-11-93.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800*---------------------------------------------------------------* 00080000
000900*    Y111 - TRAILER LIST                                        * 00090000
001000*                                                               * 00100000
001100*    THIS PROGRAM GENERATES A LIST OF TRAILERS BASED UPON THE   * 00110000
001200*    SELECTION CRITERIA SPECIFIED.                              * 00120000
001300*                                                               * 00130000
001400*---------------------------------------------------------------* 00140000
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697         00142016
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00143016
263697* MAKING THE CALL DYNAMIC VS STATIC.                              00144016
263697*---------------------------------------------------------------* 00145016
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495         00146017
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00147017
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00148017
CICS  *-----------------------------------------------------------------00149017
001500                                                                  00150000
001600/                                                                 00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800                                                                  00180000
001900 DATA DIVISION.                                                   00190000
002000                                                                  00200000
002100 WORKING-STORAGE SECTION.                                         00210000
002200                                                                  00220000
002300 01  DK-DB2-KEYS.                                                 00230000
002400     05  DK-OPER-UNT-ID            PIC S9(4) COMP VALUE +0.       00240000
002500     05  DK-OPER-UNT-ID-B          PIC S9(4) COMP VALUE +0.       00250000
002600     05  DK-OPER-UNT-ID-E          PIC S9(4) COMP VALUE +0.       00260000
002700     05  DK-FCLTY-ID-B             PIC S9(4) COMP VALUE +0.       00270000
002800     05  DK-FCLTY-ID-E             PIC S9(4) COMP VALUE +0.       00280000
002900     05  DK-FCLTY-AREA-ID-B        PIC X(06) VALUE SPACES.        00290000
003000     05  DK-FCLTY-AREA-ID-E        PIC X(06) VALUE SPACES.        00300000
003100     05  DK-SUBAREA-OF-ID-B        PIC X(06) VALUE SPACES.        00310000
003200     05  DK-SUBAREA-OF-ID-E        PIC X(06) VALUE SPACES.        00320000
003300     05  DK-DEST-OPER-UNT-ID-B     PIC S9(4) COMP VALUE +0.       00330000
003400     05  DK-DEST-OPER-UNT-ID-E     PIC S9(4) COMP VALUE +0.       00340000
003500     05  DK-DEST-FCLTY-ID-B        PIC S9(4) COMP VALUE +0.       00350000
003600     05  DK-DEST-FCLTY-ID-E        PIC S9(4) COMP VALUE +0.       00360000
003700     05  DK-STATUS-IND-B           PIC X(02) VALUE SPACES.        00370000
003800     05  DK-STATUS-IND-E           PIC X(02) VALUE SPACES.        00380000
003900     05  DK-STATUS-IND-1           PIC X(02) VALUE SPACES.        00390000
004000     05  DK-STATUS-IND-2           PIC X(02) VALUE SPACES.        00400000
004100     05  DK-STATUS-IND-3           PIC X(02) VALUE SPACES.        00410000
004200     05  DK-STATUS-IND-4           PIC X(02) VALUE SPACES.        00420000
004300     05  DK-STATUS-IND-5           PIC X(02) VALUE SPACES.        00430000
004400     05  DK-SCHD-FROM-DTE          PIC X(10) VALUE SPACES.        00440000
004500     05  DK-SCHD-TO-DTE            PIC X(10) VALUE SPACES.        00450000
004600     05  DK-SCHD-FROM-TME          PIC X(08) VALUE SPACES.        00460000
004700     05  DK-SCHD-TO-TME            PIC X(08) VALUE SPACES.        00470000
004800     05  DK-USAGE-IND-B            PIC X(03) VALUE SPACES.        00480000
004900     05  DK-USAGE-IND-E            PIC X(03) VALUE SPACES.        00490000
005000     05  DK-USAGE-IND-1            PIC X(03) VALUE SPACES.        00500000
005100     05  DK-USAGE-IND-2            PIC X(03) VALUE SPACES.        00510000
005200     05  DK-USAGE-IND-3            PIC X(03) VALUE SPACES.        00520000
005300     05  DK-OWNER-SCAC-ID-B        PIC X(04) VALUE SPACES.        00530000
005400     05  DK-OWNER-SCAC-ID-E        PIC X(04) VALUE SPACES.        00540000
005500     05  DK-VEH-NBR-B              PIC X(10) VALUE SPACES.        00550000
005600     05  DK-VEH-NBR-E              PIC X(10) VALUE SPACES.        00560000
005700     05  DK-TRIP-ID                PIC S9(9) COMP VALUE +0.       00570000
005800     05  DK-ETA-TMST-B             PIC X(26).                     00580000
005900     05  DK-ETA-TMST-E             PIC X(26).                     00590000
006000                                                                  00600000
006100 01  DN-NULL-INDICATORS.                                          00610000
006200     05  DN-EST-AR-TMST            PIC S9(4) COMP VALUE -1.       00620000
006300*    05  DN-SUBAREA-OF-ID          PIC S9(4) COMP VALUE -1.       00630000
006400                                                                  00640000
006500 01  PC-PROGRAM-CONSTANTS.                                        00650000
006600     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00660000
006700                                                    'TR111A  '.   00670000
006800     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00680000
006900                                                    'TRKM111 '.   00690000
007000     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00700000
007100                                                    'TRKCS111'.   00710000
007200     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00720000
007300                                                    COMP.         00730000
007400     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00740000
007500     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00750000
007600     05  PC-INTER-APPL-CODES.                                     00760000
007700         10 PC-INTER-APPL-CRIT-SPEC     PIC  X(01)  VALUE '1'.    00770000
007800         10 PC-INTER-APPL-LIST          PIC  X(01)  VALUE '5'.    00780000
007900     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +15     00790000
008000                                                    COMP SYNC.    00800000
008100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00810000
008200                                                    COMP SYNC.    00820000
008300     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00830000
008400                                                    +1000000      00840000
008500                                                    COMP-3.       00850000
008600     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00860000
008700                                                    COMP SYNC.    00870000
008800     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00880000
008900                                                    COMP-3.       00890000
009000     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00900000
009100     05  PC-ADD                         PIC  X(03)  VALUE 'ADD'.  00910000
009200     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00920000
009300     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00930000
009400     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00940000
009500     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00950000
009600                                                                  00960000
009700     05  PC-TSYMSG-NUMBERS.                                       00970000
009800         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  00980000
009900         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00990000
010000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01000000
010100         10  PC-TSYMSG-00014            PIC  9(05)  VALUE 00014.  01010000
010200         10  PC-TSYMSG-00017            PIC  9(05)  VALUE 00017.  01020000
010300         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  01030000
010400         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01040000
010500         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01050000
010600         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01060000
010700         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01070000
010800         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01080000
010900         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01090000
011000         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01100000
011100         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01110000
011200         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01120000
011300         10  PC-TSYMSG-00083            PIC  9(05)  VALUE 00083.  01130000
011400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01140000
011500         10  PC-TSYMSG-00168            PIC  9(05)  VALUE 00168.  01150000
011600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01160000
011700         10  PC-TSYMSG-00310            PIC  9(05)  VALUE 00310.  01170000
011800         10  PC-TSYMSG-00330            PIC  9(05)  VALUE 00330.  01180000
011900         10  PC-TSYMSG-00338            PIC  9(05)  VALUE 00338.  01190000
012000         10  PC-TSYMSG-00486            PIC  9(05)  VALUE 00486.  01200000
012100         10  PC-TSYMSG-00587            PIC  9(05)  VALUE 00587.  01210000
012200         10  PC-TSYMSG-00588            PIC  9(05)  VALUE 00588.  01220000
012300         10  PC-TSYMSG-00643            PIC  9(05)  VALUE 00643.  01230000
012400         10  PC-TSYMSG-00649            PIC  9(05)  VALUE 00649.  01240000
012500                                                                  01250000
012600 01  PS-PROGRAM-SWITCHES.                                         01260000
012700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01270000
012800         88  PS-NO-ERROR                            VALUE 'Y'.    01280000
012900         88  PS-ERROR                               VALUE 'N'.    01290000
013000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01300000
013100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01310000
013200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01320000
013300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01330000
013400         88  PS-DONE                                VALUE 'Y'.    01340000
013500         88  PS-NOT-DONE                            VALUE 'N'.    01350000
013600                                                                  01360000
013700 01  PV-PROGRAM-VARIABLES.                                        01370000
013800     05  PV-SUB                         PIC S9(04)  VALUE +0      01380000
013900                                                    COMP SYNC.    01390000
014000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01400000
014100                                                    COMP SYNC.    01410000
014200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01420000
014300                                                    COMP-3.       01430000
014400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01440000
014500                                                    COMP-3.       01450000
014600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01460000
014700                                                    COMP-3.       01470000
014800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01480000
014900                                                    COMP-3.       01490000
015000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01500000
015100                                                    COMP-3.       01510000
015200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01520000
015300                                                    COMP-3.       01530000
015400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01540000
015500                                                    COMP-3.       01550000
015600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01560000
015700                                                    COMP SYNC.    01570000
015800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01580000
015900                                                    COMP SYNC.    01590000
016000     05  PV-ITEM                        PIC S9(04)  VALUE +0      01600000
016100                                                    COMP SYNC.    01610000
016200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01620000
016300                                                    COMP SYNC.    01630000
016400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01640000
016500                                                    COMP SYNC.    01650000
016600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01660000
016700                                                    COMP SYNC.    01670000
016800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01680000
016900                                                    COMP SYNC.    01690000
017000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01700000
017100                                                    COMP SYNC.    01710000
017200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01720000
017300                                                    COMP SYNC.    01730000
017400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01740000
017500                                                    COMP SYNC.    01750000
017600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01760000
017700                                                    COMP SYNC.    01770000
017800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01780000
017900                                                    COMP SYNC.    01790000
018000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01800000
018100                                                    COMP SYNC.    01810000
018200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01820000
018300                                                    COMP SYNC.    01830000
018400     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01840000
018500                                                    COMP SYNC.    01850000
018600     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      01860000
018700                                                    COMP-3.       01870000
018800     05  PV-EDIT-DATE.                                            01880000
018900         10  PV-EDIT-DATE-CC            PIC X(02).                01890000
019000         10  PV-EDIT-DATE-YY            PIC X(02).                01900000
019100         10  FILLER                     PIC X(01).                01910000
019200         10  PV-EDIT-DATE-MM            PIC X(02).                01920000
019300         10  FILLER                     PIC X(01).                01930000
019400         10  PV-EDIT-DATE-DD            PIC X(02).                01940000
019500     05  PV-EDIT-TIME.                                            01950000
019600         10  PV-EDIT-TIME-HH            PIC X(02).                01960000
019700         10  FILLER                     PIC X(01).                01970000
019800         10  PV-EDIT-TIME-MM            PIC X(02).                01980000
019900         10  FILLER                     PIC X(01).                01990000
020000         10  PV-EDIT-TIME-SS            PIC X(02).                02000000
020100     05  PV-ETA-TMST.                                             02010000
020200         10  PV-ETA-DATE.                                         02020000
020300             15  PV-ETA-CC                  PIC X(02).            02030014
020310             15  PV-ETA-YY                  PIC X(02).            02031014
020400             15  FILLER                     PIC X(01).            02040000
020500             15  PV-ETA-MM                  PIC X(02).            02050000
020600             15  FILLER                     PIC X(01).            02060000
020700             15  PV-ETA-DD                  PIC X(02).            02070000
020800         10  PV-ETA-TIME.                                         02080000
020900             15  FILLER                     PIC X(01).            02090000
021000             15  PV-ETA-HH-MM               PIC X(05).            02100000
021100             15  FILLER                     PIC X(01).            02110000
021200             15  PV-ETA-SS                  PIC X(02).            02120000
021300         10  FILLER                         PIC X(07).            02130000
021400     05  PV-ETA-DTE-TME.                                          02140000
021500         10  PV-ETA-DT-YY               PIC X(02).                02150014
021600         10  FILLER                     PIC X(01)  VALUE '/'.     02160000
021610         10  PV-ETA-DT-MM               PIC X(02).                02161014
021620         10  FILLER                     PIC X(01)  VALUE '/'.     02162014
021700         10  PV-ETA-DT-DD               PIC X(02).                02170000
021800         10  FILLER                     PIC X(01)  VALUE SPACES.  02180000
021900         10  PV-ETA-DT-HH-MM            PIC X(05).                02190000
022000     05  PV-CURR-LOC.                                             02200000
022100         10  PV-CURR-OPER               PIC ZZZ9.                 02210000
022400     05  PV-DEST.                                                 02240000
022500         10  PV-DEST-OPER               PIC ZZZZ.                 02250000
022800     05  PV-TRIP-STOP-NBR               PIC Z(02).                02280000
022900     05  PV-ETA-TMST-B.                                           02290000
023000         10  PV-ETA-DTE-B          PIC X(10) VALUE SPACES.        02300000
023100         10  PV-ETA-TME-B          PIC X(16) VALUE                02310000
023200                                            '-00.00.00.000000'.   02320000
023300     05  PV-ETA-TMST-E.                                           02330000
023400         10  PV-ETA-DTE-E          PIC X(10) VALUE SPACES.        02340000
023500         10  PV-ETA-TME-E          PIC X(16) VALUE                02350000
023600                                            '-24.00.00.000000'.   02360000
023700                                                                  02370000
023800                                                                  02380000
023900                                                                  02390000
024000*---------------------------------------------------------------* 02400000
024100*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 02410000
024200*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 02420000
024300*   APPLICATION-SPECIFIC COMMAREA.                              * 02430000
024400*---------------------------------------------------------------* 02440000
024500 01  LQW-LIST-QUEUE-WORK-AREA.                                    02450000
024600     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  02460000
024700     05  LQW-ITEM-ENTRIES               OCCURS 15 TIMES           02470000
024800                                        INDEXED BY LQW-IDX.       02480000
024900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02490000
025000         10  LQW-TEMP-SELECTED-SW       PIC X(01).                02500000
025100         10  LQW-SELECTED-SW            PIC X(01).                02510000
025200             88  LQW-SELECT                         VALUE 'S'.    02520000
025300             88  LQW-DESELECT                       VALUE ' '.    02530000
025400         10  LQW-CARR-SCAC-CDE          PIC X(04).                02540000
025500         10  LQW-TRLR-NBR               PIC X(10).                02550000
025600         10  LQW-TRIP-STOP              PIC X(02).                02560000
025700         10  LQW-STAT                   PIC X(02).                02570000
025710         10  LQW-STAT-USERID            PIC X(08).                02571002
025800         10  LQW-MANIFEST               PIC X(10).                02580000
025900         10  LQW-USE                    PIC X(03).                02590000
026000         10  LQW-LGTH                   PIC X(02).                02600000
026100         10  LQW-CURR-LOC-1             PIC X(04).                02610009
026200         10  LQW-CURR-LOC-2             PIC X(04).                02620009
026300         10  LQW-DEST                   PIC X(04).                02630009
026400         10  LQW-ETA-DTE-TME            PIC X(14).                02640014
026600         10  LQW-OPER-UNT-ID            PIC S9(04) COMP.          02660000
026700         10  LQW-FCLTY-ID               PIC S9(04) COMP.          02670000
026800         10  LQW-DEST-OPER-UNT-ID       PIC S9(04) COMP.          02680000
026900         10  LQW-DEST-FCLTY-ID          PIC S9(04) COMP.          02690000
027000         10  LQW-TRIP-ID                PIC S9(09) COMP.          02700000
027100                                                                  02710000
027200/                                                                 02720000
027300*---------------------------------------------------------------* 02730000
027400*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 02740000
027500*---------------------------------------------------------------* 02750000
027600                                                                  02760000
027700     COPY TRWS006.                                                02770000
027800                                                                  02780000
027900/                                                                 02790000
028000*---------------------------------------------------------------* 02800000
028100*    MAP LAYOUT                                                 * 02810000
028200*---------------------------------------------------------------* 02820000
028300                                                                  02830000
028400     COPY TRKM111.                                                02840000
028500                                                                  02850000
028600 01  MR-OCCURS-LAYOUT                   REDEFINES  TR111AO.       02860000
028700     05  FILLER                         PIC X(48).                02870013
028800                                                                  02880000
028900     05  MR-SCROLL-AREA                 OCCURS 15 TIMES.          02890000
029000         10  MR-SELECTL                 PIC S9(04) COMP.          02900000
029100         10  MR-SELECTA                 PIC X(01).                02910000
029200         10  MR-SELECTC                 PIC X(01).                02920000
029300         10  MR-SELECTH                 PIC X(01).                02930000
029400         10  MR-SELECT                  PIC X(01).                02940000
029500                                                                  02950000
029600         10  FILLER                     PIC X(05).                02960000
029700         10  MR-CARR-SCAC-CDE           PIC X(04).                02970000
029800                                                                  02980000
029900         10  FILLER                     PIC X(05).                02990000
030000         10  MR-TRLR-NBR                PIC X(10).                03000000
030100                                                                  03010000
030200         10  FILLER                     PIC X(05).                03020000
030300         10  MR-TRIP-STOP               PIC X(02).                03030000
030400                                                                  03040000
030500         10  FILLER                     PIC X(05).                03050000
030600         10  MR-STAT                    PIC X(02).                03060000
030700                                                                  03070000
030710         10  FILLER                     PIC X(05).                03071001
030720         10  MR-USER                    PIC X(08).                03072001
030730                                                                  03073001
030800         10  FILLER                     PIC X(05).                03080000
030900         10  MR-MANIFEST                PIC X(08).                03090000
031000                                                                  03100000
031100         10  FILLER                     PIC X(05).                03110000
031200         10  MR-USE                     PIC X(03).                03120000
031300                                                                  03130000
031400         10  FILLER                     PIC X(05).                03140000
031500         10  MR-LGTH                    PIC X(02).                03150000
031600                                                                  03160000
031700         10  FILLER                     PIC X(05).                03170000
031800         10  MR-CURR-LOC-1              PIC X(04).                03180001
031900                                                                  03190000
032000         10  FILLER                     PIC X(05).                03200000
032100         10  MR-CURR-LOC-2              PIC X(04).                03210001
032200                                                                  03220000
032300         10  FILLER                     PIC X(05).                03230000
032400         10  MR-DEST                    PIC X(04).                03240001
032500                                                                  03250000
032600         10  FILLER                     PIC X(05).                03260000
032700         10  MR-ETA-DTE-TME             PIC X(14).                03270014
032800                                                                  03280000
033100                                                                  03310000
033110     05  FILLER                         PIC X(11).                03311008
033200/                                                                 03320000
033300*---------------------------------------------------------------* 03330000
033400*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03340000
033500*---------------------------------------------------------------* 03350000
033600                                                                  03360000
033700     COPY DPWS015.                                                03370000
033800                                                                  03380000
033900*---------------------------------------------------------------* 03390000
034000*    FUNCTION KEYS COPYBOOK.                                    * 03400000
034100*---------------------------------------------------------------* 03410000
034200                                                                  03420000
034300     COPY DPWS016.                                                03430000
034400                                                                  03440000
034500*---------------------------------------------------------------* 03450000
034600*    NUMERIC EDIT LAYOUT.                                       * 03460000
034700*---------------------------------------------------------------* 03470000
034800                                                                  03480000
034900     COPY DPWS010I.                                               03490000
035000                                                                  03500000
035100/                                                                 03510000
035200*---------------------------------------------------------------* 03520000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 03530017
035400*---------------------------------------------------------------* 03540000
035500                                                                  03550000
035600     COPY DPWS030.                                                03560000
CICS       COPY DPWS930.                                                03570017
035800/                                                                 03580000
035900*---------------------------------------------------------------* 03590000
036000*    STANDARD COMMAREA.                                         * 03600000
036100*---------------------------------------------------------------* 03610000
036200                                                                  03620000
036300     COPY DPWS020.                                                03630000
036400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03640000
036500                                                                  03650000
036600*---------------------------------------------------------------* 03660000
036700* INTER-APPLICATION COMMAREA.                                   * 03670000
036800*---------------------------------------------------------------* 03680000
036900                                                                  03690000
037000         10  INTER-APPL-COMM-AREA       PIC X(200).               03700000
037100     COPY TRWS005.                                                03710000
037200     COPY TRWS007.                                                03720000
037300*---------------------------------------------------------------* 03730000
037400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03740000
037500*---------------------------------------------------------------* 03750000
037600         10  ASC-SPECIFIC-COMMAREA.                               03760000
037700             15  ASC-LIST-KEYS.                                   03770000
037800                 20  ASC-KEY-OPER-UNT-ID       PIC S9(4) COMP.    03780000
037900                 20  ASC-KEY-FCLTY-ID          PIC S9(4) COMP.    03790000
038000                 20  ASC-KEY-FCLTY-AREA-ID     PIC X(06).         03800000
038100                 20  ASC-KEY-SUBAREA-OF-ID     PIC X(06).         03810000
038200                 20  ASC-KEY-STATUS-BEG        PIC X(02).         03820000
038300                 20  ASC-KEY-STATUS-END        PIC X(02).         03830000
038400                 20  ASC-KEY-STATUS-IND-1      PIC X(02).         03840000
038500                 20  ASC-KEY-STATUS-IND-2      PIC X(02).         03850000
038600                 20  ASC-KEY-STATUS-IND-3      PIC X(02).         03860000
038700                 20  ASC-KEY-STATUS-IND-4      PIC X(02).         03870000
038800                 20  ASC-KEY-STATUS-IND-5      PIC X(02).         03880000
038900                 20  ASC-KEY-SCHD-FROM-DTE     PIC X(10).         03890000
039000                 20  ASC-KEY-SCHD-TO-DTE       PIC X(10).         03900000
039100                 20  ASC-KEY-USAGE-BEG         PIC X(03).         03910000
039200                 20  ASC-KEY-USAGE-END         PIC X(03).         03920000
039300                 20  ASC-KEY-USAGE-IND-1       PIC X(03).         03930000
039400                 20  ASC-KEY-USAGE-IND-2       PIC X(03).         03940000
039500                 20  ASC-KEY-USAGE-IND-3       PIC X(03).         03950000
039600                 20  ASC-KEY-OWNER-SCAC-ID     PIC X(04).         03960000
039700                 20  ASC-KEY-VEH-NBR           PIC X(10).         03970000
039800                 20  ASC-KEY-DEST-OPER-UNT-ID  PIC S9(4) COMP.    03980000
039900                 20  ASC-KEY-DEST-FCLTY-ID     PIC S9(4) COMP.    03990000
040000             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           04000000
040100                 20  ASC-BLOCK-MODIFIED-SW                        04010000
040200                                        PIC X(01).                04020000
040300                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     04030000
040400                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     04040000
040500                                                                  04050000
040600                 20  ASC-ITEM-ARRAY.                              04060000
040700                     25  ASC-ITEM-ENTRIES OCCURS 15 TIMES.        04070000
040800                         30  ASC-LIST-ITEM-NUMBER                 04080000
040900                                        PIC S9(09) COMP-3.        04090000
041000                         30  ASC-TEMP-SELECTED-SW                 04100000
041100                                        PIC X(01).                04110000
041200                             88  ASC-VALID-SELECT  VALUE ' '      04120000
041300                                                         'S'      04130000
041400                                                         'B'      04140000
041500                                                         'E'.     04150000
041600                             88  ASC-TEMP-NO-SELECT               04160000
041700                                                   VALUE ' '.     04170000
041800                             88  ASC-TEMP-SELECT   VALUE 'S'.     04180000
041900                             88  ASC-TEMP-BEGIN    VALUE 'B'.     04190000
042000                             88  ASC-TEMP-END      VALUE 'E'.     04200000
042100                         30  ASC-SELECTED-SW                      04210000
042200                                        PIC X(01).                04220000
042300                             88  ASC-NO-SELECT     VALUE ' '.     04230000
042400                             88  ASC-SELECT        VALUE 'S'.     04240000
042500                             88  ASC-BEGIN         VALUE 'B'.     04250000
042600                             88  ASC-END           VALUE 'E'.     04260000
042700                         30  ASC-CARR-SCAC-CDE  PIC X(04).        04270000
042800                         30  ASC-TRLR-NBR       PIC X(10).        04280000
042900                         30  ASC-TRIP-STOP      PIC X(02).        04290000
043000                         30  ASC-STAT           PIC X(02).        04300000
043010                         30  ASC-STAT-USERID    PIC X(08).        04301002
043100                         30  ASC-MANIFEST       PIC X(10).        04310000
043200                         30  ASC-USE            PIC X(03).        04320000
043300                         30  ASC-LGTH           PIC X(02).        04330000
043400                         30  ASC-CURR-LOC-1     PIC X(04).        04340001
043500                         30  ASC-CURR-LOC-2     PIC X(04).        04350001
043600                         30  ASC-DEST           PIC X(04).        04360001
043700                         30  ASC-ETA-DTE-TME    PIC X(14).        04370014
043900                         30  ASC-OPER-UNT-ID    PIC S9(04) COMP.  04390000
044000                         30  ASC-FCLTY-ID       PIC S9(04) COMP.  04400000
044100                         30  ASC-DEST-OPER-UNT-ID PIC S9(04) COMP.04410000
044200                         30  ASC-DEST-FCLTY-ID  PIC S9(04) COMP.  04420000
044300                         30  ASC-TRIP-ID        PIC S9(09) COMP.  04430000
044400                                                                  04440000
044500             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     04450000
044600             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     04460000
044700             15  ASC-SEL-SUB            PIC S9(04) COMP.          04470000
044800             15  ASC-SEL-ITEM           PIC S9(04) COMP.          04480000
044900             15  ASC-NUMBER-OF-ITEMS-READ                         04490000
045000                                        PIC S9(09) COMP-3.        04500000
045100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04510000
045200                                        PIC S9(09) COMP-3.        04520000
045300             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        04530000
045400             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        04540000
045500             15  ASC-ITEM-AT-TOP-OF-PANEL                         04550000
045600                                        PIC S9(09) COMP-3.        04560000
045700             15  ASC-ITEM-AT-BOT-OF-PANEL                         04570000
045800                                        PIC S9(09) COMP-3.        04580000
045900             15  ASC-HIGHEST-BLOCK-WRITTEN                        04590000
046000                                        PIC S9(04) COMP SYNC.     04600000
046100             15  ASC-START-OF-SELECTED-RANGE                      04610000
046200                                        PIC S9(09) COMP-3.        04620000
046300             15  ASC-END-OF-SELECTED-RANGE                        04630000
046400                                        PIC S9(09) COMP-3.        04640000
046500             15  ASC-ITEMS-LEFT-INDICATOR                         04650000
046600                                        PIC X(01).                04660000
046700                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04670000
046800                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04680000
046900             15  ASC-TEMP-QUEUE-UPDATE-SW                         04690000
047000                                        PIC X(01).                04700000
047100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04710000
047200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04720000
047300             15  ASC-LIST-QUEUE-NAME.                             04730000
047400                 20  ASC-LIST-TERM-ID   PIC X(04).                04740000
047500                 20  ASC-LIST-TASK-NUMBER                         04750000
047600                                        PIC S9(05) COMP-3.        04760000
047700                 20  ASC-LIST-SEQ       PIC 9(01).                04770000
047800             15  ASC-SEL-QUEUE-NAME-IN   PIC X(08).               04780000
047900             15  ASC-SEL-QUEUE-NAME-OUT.                          04790000
048000                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               04800000
048100                 20  ASC-SEL-TASK-NUMBER-OUT                      04810000
048200                                         PIC S9(05) COMP-3.       04820000
048300                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               04830000
048400                                                                  04840000
048500             15  ASC-CURSOR-SW          PIC X(02).                04850000
048600                 88  ASC-DOCK-CURSOR               VALUE 'D '.    04860000
048700                 88  ASC-SCAC-CURSOR               VALUE 'S '.    04870000
048800                 88  ASC-TRLR-CURSOR               VALUE 'T '.    04880000
048900                 88  ASC-EMPTY-CURSOR              VALUE 'M '.    04890000
049000                 88  ASC-ETA-CURSOR                VALUE 'E '.    04900000
049100             15  ASC-START-ITEM-REQUEST.                          04910000
049200                 20  ASC-START-ITEM-REQUEST-N  PIC 9(07).         04920000
049300             15  ASC-USE-SELECTION-QUEUE-IND   PIC X(01).         04930000
049400                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         04940000
049500             15  ASC-FCLTY-NME                 PIC X(25).         04950000
049600/                                                                 04960000
049700*---------------------------------------------------------------* 04970000
049800*    ABEND PROCESSING COPYBOOK.                                 * 04980000
049900*---------------------------------------------------------------* 04990000
050000                                                                  05000000
050100     COPY DPWS013.                                                05010000
050200                                                                  05020000
050300/                                                                 05030000
050400*---------------------------------------------------------------* 05040000
050500*    DB2 AREA FOR THE FACLITY TABLE                             * 05050000
050600*---------------------------------------------------------------* 05060000
050700     EXEC SQL                                                     05070000
050800          INCLUDE TFACLTY                                         05080000
050900     END-EXEC.                                                    05090000
051000                                                                  05100000
051100/                                                                 05110000
051200*---------------------------------------------------------------* 05120000
051300*    DB2 AREA FOR THE FACLITY AREA TABLE                        * 05130000
051400*---------------------------------------------------------------* 05140000
051500     EXEC SQL                                                     05150000
051600          INCLUDE TFLAREA                                         05160000
051700     END-EXEC.                                                    05170000
051800                                                                  05180000
051900/                                                                 05190000
052000*---------------------------------------------------------------* 05200000
052100*    DB2 AREA FOR THE FACLITY AREA TYPE CODE TABLE              * 05210000
052200*---------------------------------------------------------------* 05220000
052300     EXEC SQL                                                     05230000
052400          INCLUDE TFLTYPE                                         05240000
052500     END-EXEC.                                                    05250000
052600                                                                  05260000
052700/                                                                 05270000
052800*---------------------------------------------------------------* 05280000
052900*    DB2 AREA FOR THE VEHICLE TABLE                             * 05290000
053000*---------------------------------------------------------------* 05300000
053100     EXEC SQL                                                     05310000
053200          INCLUDE TVEHICL                                         05320000
053300     END-EXEC.                                                    05330000
053400                                                                  05340000
053500/                                                                 05350000
053600*---------------------------------------------------------------* 05360000
053700*    DB2 AREA FOR THE VEHICLE AUDIT TABLE                       * 05370000
053800*---------------------------------------------------------------* 05380000
053900     EXEC SQL                                                     05390000
054000          INCLUDE TAUVHCL                                         05400000
054100     END-EXEC.                                                    05410000
054200                                                                  05420000
054300/                                                                 05430000
054400*---------------------------------------------------------------* 05440000
054500*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * 05450000
054600*---------------------------------------------------------------* 05460000
054700     EXEC SQL                                                     05470000
054800          INCLUDE TVHTRIP                                         05480000
054900     END-EXEC.                                                    05490000
055000                                                                  05500000
055100/                                                                 05510000
055200*---------------------------------------------------------------* 05520000
055300*    DB2 AREA FOR THE TRIP STATUS TABLE                         * 05530000
055400*---------------------------------------------------------------* 05540000
055500     EXEC SQL                                                     05550000
055600          INCLUDE TTRIPST                                         05560000
055700     END-EXEC.                                                    05570000
055800                                                                  05580000
055900/                                                                 05590000
056000*---------------------------------------------------------------* 05600000
056100*    DB2 AREA FOR THE TRIP STATUS CODE TABLE                    * 05610000
056200*---------------------------------------------------------------* 05620000
056300     EXEC SQL                                                     05630000
056400          INCLUDE TTRSTYP                                         05640000
056500     END-EXEC.                                                    05650000
056600                                                                  05660000
056700/                                                                 05670000
057600*---------------------------------------------------------------* 05760000
057700*    DB2 AREA FOR COMMUNICATIONS                                * 05770000
057800*---------------------------------------------------------------* 05780000
057900     EXEC SQL                                                     05790000
058000          INCLUDE SQLCA                                           05800000
058100     END-EXEC.                                                    05810000
058200                                                                  05820000
058300/                                                                 05830000
058400*---------------------------------------------------------------* 05840000
058500*  CURSOR TO LIST TRAILERS BY DOCK AREA                         * 05850000
058600*---------------------------------------------------------------* 05860000
058700                                                                  05870000
058800     EXEC SQL                                                     05880000
058900          DECLARE DOCK-CSR CURSOR FOR                             05890000
059000           SELECT A.CURR_OPER_UNT_ID                              05900000
059100                 ,A.CURR_FCLTY_ID                                 05910000
059200                 ,A.CURR_FAC_AREA_ID                              05920000
059300                 ,A.OWNER_SCAC_ID                                 05930000
059400                 ,A.VEH_NBR                                       05940000
059500                 ,A.USAGE_CDE                                     05950000
059600                 ,A.VEH_SIZE_CDE                                  05960000
059700                 ,A.CURR_STATUS_CDE                               05970000
059800                 ,A.CURR_STATUS_DTE                               05980000
059900                 ,A.CURR_STATUS_TME                               05990000
060000                 ,F.TRIP_ID                                       06000000
060100                 ,F.MANIFEST_NBR                                  06010000
060200                 ,F.PLND_TRIP_SEQ                                 06020000
060300                 ,F.REF_TRIP_ID                                   06030000
060400                 ,G.OPER_UNT_ID                                   06040000
060500                 ,G.FCLTY_ID                                      06050000
060600                 ,G.FCLTY_AREA_ID                                 06060000
060700                 ,F.EST_AR_TMST                                   06070000
060800                 ,D.PRTY_CDE                                      06080000
060900           FROM   TVEHICL A                                       06090000
061000                 ,TVHTRIP B                                       06100000
061100                 ,TTRSTYP D                                       06110000
061200                 ,TTRIPST E                                       06120000
061300                 ,TVHTRIP F                                       06130000
061400                 ,TTRIPST G                                       06140000
061500                 ,TFLAREA H                                       06150000
061600            WHERE A.CURR_OPER_UNT_ID BETWEEN :DK-OPER-UNT-ID-B    06160000
061700                                         AND :DK-OPER-UNT-ID-E    06170000
061800             AND  A.CURR_STATUS_CDE ^= 'ET'                       06180000
061900             AND  A.CURR_FCLTY_ID    BETWEEN :DK-FCLTY-ID-B       06190000
062000                                         AND :DK-FCLTY-ID-E       06200000
062100             AND  A.CURR_FAC_AREA_ID BETWEEN :DK-FCLTY-AREA-ID-B  06210000
062200                                         AND :DK-FCLTY-AREA-ID-E  06220000
062300             AND (H.SUBAREA_OF_ID IS NOT NULL                     06230000
062400             AND  H.SUBAREA_OF_ID BETWEEN :DK-SUBAREA-OF-ID-B     06240000
062500                                      AND :DK-SUBAREA-OF-ID-E)    06250000
062600             AND  A.CURR_OPER_UNT_ID = H.OPER_UNT_ID              06260000
062700             AND  A.CURR_FCLTY_ID    = H.FCLTY_ID                 06270000
062800             AND  A.CURR_FAC_AREA_ID = H.FCLTY_AREA_ID            06280000
062900             AND  E.OPER_UNT_ID    BETWEEN :DK-DEST-OPER-UNT-ID-B 06290000
063000                                       AND :DK-DEST-OPER-UNT-ID-E 06300000
063100             AND  E.FCLTY_ID       BETWEEN :DK-DEST-FCLTY-ID-B    06310000
063200                                       AND :DK-DEST-FCLTY-ID-E    06320000
063300             AND  A.OWNER_SCAC_ID  BETWEEN :DK-OWNER-SCAC-ID-B    06330000
063400                                       AND :DK-OWNER-SCAC-ID-E    06340000
063500             AND  B.VEH_NBR IS NOT NULL                           06350000
063600             AND ((A.CURR_STATUS_CDE BETWEEN :DK-STATUS-IND-B     06360000
063700                                         AND :DK-STATUS-IND-E)    06370000
063800              OR   A.CURR_STATUS_CDE IN (:DK-STATUS-IND-1         06380000
063900                                        ,:DK-STATUS-IND-2         06390000
064000                                        ,:DK-STATUS-IND-3         06400000
064100                                        ,:DK-STATUS-IND-4         06410000
064200                                        ,:DK-STATUS-IND-5))       06420000
064300             AND ((A.USAGE_CDE BETWEEN :DK-USAGE-IND-B            06430000
064400                                   AND :DK-USAGE-IND-E)           06440000
064500              OR   A.USAGE_CDE IN (:DK-USAGE-IND-1                06450000
064600                                  ,:DK-USAGE-IND-2                06460000
064700                                  ,:DK-USAGE-IND-3))              06470000
064800             AND  A.CURR_STATUS_CDE = D.TRIP_STATUS_CDE           06480000
064900             AND  A.CURR_TRIP_ID    = B.TRIP_ID                   06490000
065000             AND  A.CURR_TRIP_ID = E.TRIP_ID                      06500000
065100             AND  E.TRIP_STATUS_CDE = 'EN'                        06510000
065200             AND  B.REF_TRIP_ID = F.REF_TRIP_ID                   06520000
065300             AND  F.TRIP_ID     = G.TRIP_ID                       06530000
065400             AND  G.TRIP_STATUS_CDE = 'EN'                        06540000
065500         ORDER BY D.PRTY_CDE                                      06550000
065600                 ,A.CURR_STATUS_DTE DESC                          06560000
065700                 ,A.CURR_STATUS_TME DESC                          06570000
065800                 ,F.PLND_TRIP_SEQ                                 06580000
065900     END-EXEC.                                                    06590000
066000                                                                  06600000
066100/                                                                 06610000
066200*---------------------------------------------------------------* 06620000
066300*  CURSOR TO LIST TRAILERS BY SCAC AND TRAILER                  * 06630000
066400*---------------------------------------------------------------* 06640000
066500                                                                  06650000
066600     EXEC SQL                                                     06660000
066700          DECLARE SCAC-CSR CURSOR FOR                             06670000
066800           SELECT A.CURR_OPER_UNT_ID                              06680000
066900                 ,A.CURR_FCLTY_ID                                 06690000
067000                 ,A.CURR_FAC_AREA_ID                              06700000
067100                 ,A.OWNER_SCAC_ID                                 06710000
067200                 ,A.VEH_NBR                                       06720000
067300                 ,A.USAGE_CDE                                     06730000
067400                 ,A.VEH_SIZE_CDE                                  06740000
067500                 ,A.CURR_STATUS_CDE                               06750000
067600                 ,A.CURR_STATUS_DTE                               06760000
067700                 ,A.CURR_STATUS_TME                               06770000
067800                 ,F.TRIP_ID                                       06780000
067900                 ,F.MANIFEST_NBR                                  06790000
068000                 ,F.PLND_TRIP_SEQ                                 06800000
068100                 ,F.REF_TRIP_ID                                   06810000
068200                 ,G.OPER_UNT_ID                                   06820000
068300                 ,G.FCLTY_ID                                      06830000
068400                 ,G.FCLTY_AREA_ID                                 06840000
068500                 ,F.EST_AR_TMST                                   06850000
068600                 ,D.PRTY_CDE                                      06860000
068700           FROM   TVEHICL A                                       06870000
068800                 ,TVHTRIP B                                       06880000
068900                 ,TTRSTYP D                                       06890000
069000                 ,TTRIPST E                                       06900000
069100                 ,TVHTRIP F                                       06910000
069200                 ,TTRIPST G                                       06920000
069300           WHERE  A.OWNER_SCAC_ID BETWEEN :DK-OWNER-SCAC-ID-B     06930000
069400                                      AND :DK-OWNER-SCAC-ID-E     06940000
069500             AND  A.VEH_NBR       BETWEEN :DK-VEH-NBR-B           06950000
069600                                      AND :DK-VEH-NBR-E           06960000
069700             AND  A.CURR_OPER_UNT_ID BETWEEN :DK-OPER-UNT-ID-B    06970000
069800                                         AND :DK-OPER-UNT-ID-E    06980000
069900             AND  A.CURR_FCLTY_ID BETWEEN :DK-FCLTY-ID-B          06990000
070000                                      AND :DK-FCLTY-ID-E          07000000
070100             AND  E.OPER_UNT_ID BETWEEN :DK-DEST-OPER-UNT-ID-B    07010000
070200                                    AND :DK-DEST-OPER-UNT-ID-E    07020000
070300             AND  E.FCLTY_ID BETWEEN :DK-DEST-FCLTY-ID-B          07030000
070400                                 AND :DK-DEST-FCLTY-ID-E          07040000
070500             AND ((A.USAGE_CDE BETWEEN :DK-USAGE-IND-B            07050000
070600                                   AND :DK-USAGE-IND-E)           07060000
070700              OR   A.USAGE_CDE IN (:DK-USAGE-IND-1                07070000
070800                                  ,:DK-USAGE-IND-2                07080000
070900                                  ,:DK-USAGE-IND-3))              07090000
071000             AND  A.CURR_STATUS_CDE ^= 'ET'                       07100000
071100             AND ((A.CURR_STATUS_CDE BETWEEN :DK-STATUS-IND-B     07110000
071200                                         AND :DK-STATUS-IND-E)    07120000
071300              OR   A.CURR_STATUS_CDE IN (:DK-STATUS-IND-1         07130000
071400                                        ,:DK-STATUS-IND-2         07140000
071500                                        ,:DK-STATUS-IND-3         07150000
071600                                        ,:DK-STATUS-IND-4         07160000
071700                                        ,:DK-STATUS-IND-5))       07170000
071800             AND  A.CURR_STATUS_CDE = D.TRIP_STATUS_CDE           07180000
071900             AND  B.VEH_NBR IS NOT NULL                           07190000
072000             AND  A.CURR_TRIP_ID     = B.TRIP_ID                  07200000
072100             AND  A.CURR_TRIP_ID = E.TRIP_ID                      07210000
072200             AND  E.TRIP_STATUS_CDE = 'EN'                        07220000
072300             AND  B.REF_TRIP_ID = F.REF_TRIP_ID                   07230000
072400             AND  F.TRIP_ID     = G.TRIP_ID                       07240000
072500             AND  G.TRIP_STATUS_CDE = 'EN'                        07250000
072600         ORDER BY A.OWNER_SCAC_ID                                 07260000
072700                 ,A.VEH_NBR                                       07270000
072800                 ,F.PLND_TRIP_SEQ                                 07280000
072900     END-EXEC.                                                    07290000
073000                                                                  07300000
073100/                                                                 07310000
073200*---------------------------------------------------------------* 07320000
073300*  CURSOR TO LIST TRAILERS BY PURPOSE AND STATUS CODE           * 07330000
073400*---------------------------------------------------------------* 07340000
073500                                                                  07350000
073600     EXEC SQL                                                     07360000
073700          DECLARE TRLR-CSR CURSOR FOR                             07370000
073800           SELECT A.CURR_OPER_UNT_ID                              07380000
073900                 ,A.CURR_FCLTY_ID                                 07390000
074000                 ,A.CURR_FAC_AREA_ID                              07400000
074100                 ,A.OWNER_SCAC_ID                                 07410000
074200                 ,A.VEH_NBR                                       07420000
074300                 ,A.USAGE_CDE                                     07430000
074400                 ,A.VEH_SIZE_CDE                                  07440000
074500                 ,A.CURR_STATUS_CDE                               07450000
074600                 ,A.CURR_STATUS_DTE                               07460000
074700                 ,A.CURR_STATUS_TME                               07470000
074800                 ,F.TRIP_ID                                       07480000
074900                 ,F.MANIFEST_NBR                                  07490000
075000                 ,F.PLND_TRIP_SEQ                                 07500000
075100                 ,F.REF_TRIP_ID                                   07510000
075200                 ,G.OPER_UNT_ID                                   07520000
075300                 ,G.FCLTY_ID                                      07530000
075400                 ,G.FCLTY_AREA_ID                                 07540000
075500                 ,F.EST_AR_TMST                                   07550000
075600                 ,D.PRTY_CDE                                      07560000
075700           FROM   TVEHICL A                                       07570000
075800                 ,TVHTRIP B                                       07580000
075900                 ,TTRSTYP D                                       07590000
076000                 ,TTRIPST E                                       07600000
076100                 ,TVHTRIP F                                       07610000
076200                 ,TTRIPST G                                       07620000
076300            WHERE A.CURR_OPER_UNT_ID BETWEEN :DK-OPER-UNT-ID-B    07630000
076400                                         AND :DK-OPER-UNT-ID-E    07640000
076500             AND  A.CURR_FCLTY_ID BETWEEN :DK-FCLTY-ID-B          07650000
076600                                      AND :DK-FCLTY-ID-E          07660000
076700             AND  E.OPER_UNT_ID BETWEEN :DK-DEST-OPER-UNT-ID-B    07670000
076800                                    AND :DK-DEST-OPER-UNT-ID-E    07680000
076900             AND  E.FCLTY_ID BETWEEN :DK-DEST-FCLTY-ID-B          07690000
077000                                 AND :DK-DEST-FCLTY-ID-E          07700000
077100             AND ((A.USAGE_CDE BETWEEN :DK-USAGE-IND-B            07710000
077200                                   AND :DK-USAGE-IND-E)           07720000
077300              OR   A.USAGE_CDE IN (:DK-USAGE-IND-1                07730000
077400                                  ,:DK-USAGE-IND-2                07740000
077500                                  ,:DK-USAGE-IND-3))              07750000
077600             AND  A.CURR_STATUS_CDE ^= 'ET'                       07760000
077700             AND ((A.CURR_STATUS_CDE BETWEEN :DK-STATUS-IND-B     07770000
077800                                         AND :DK-STATUS-IND-E)    07780000
077900              OR   A.CURR_STATUS_CDE IN (:DK-STATUS-IND-1         07790000
078000                                        ,:DK-STATUS-IND-2         07800000
078100                                        ,:DK-STATUS-IND-3         07810000
078200                                        ,:DK-STATUS-IND-4         07820000
078300                                        ,:DK-STATUS-IND-5))       07830000
078400             AND A.CURR_STATUS_DTE BETWEEN :DK-SCHD-FROM-DTE      07840000
078500                                       AND :DK-SCHD-TO-DTE        07850000
078600             AND  A.CURR_STATUS_CDE = D.TRIP_STATUS_CDE           07860000
078700             AND  B.VEH_NBR IS NOT NULL                           07870000
078800             AND  A.CURR_TRIP_ID     = B.TRIP_ID                  07880000
078900             AND  A.CURR_TRIP_ID = E.TRIP_ID                      07890000
079000             AND  E.TRIP_STATUS_CDE = 'EN'                        07900000
079100             AND  B.REF_TRIP_ID = F.REF_TRIP_ID                   07910000
079200             AND  F.TRIP_ID     = G.TRIP_ID                       07920000
079300             AND  G.TRIP_STATUS_CDE = 'EN'                        07930000
079400         ORDER BY D.PRTY_CDE                                      07940000
079500                 ,A.CURR_STATUS_DTE                               07950000
079600                 ,A.CURR_STATUS_TME                               07960000
079700                 ,F.PLND_TRIP_SEQ                                 07970000
079800     END-EXEC.                                                    07980000
079900                                                                  07990000
080000/                                                                 08000000
080100*---------------------------------------------------------------* 08010000
080200*  CURSOR TO LIST TRAILERS BY ETA TIME STAMP                    * 08020000
080300*---------------------------------------------------------------* 08030000
080400                                                                  08040000
080500     EXEC SQL                                                     08050000
080600          DECLARE ETA-CSR CURSOR FOR                              08060000
080700           SELECT A.CURR_OPER_UNT_ID                              08070000
080800                 ,A.CURR_FCLTY_ID                                 08080000
080900                 ,A.CURR_FAC_AREA_ID                              08090000
081000                 ,A.OWNER_SCAC_ID                                 08100000
081100                 ,A.VEH_NBR                                       08110000
081200                 ,A.USAGE_CDE                                     08120000
081300                 ,A.VEH_SIZE_CDE                                  08130000
081400                 ,A.CURR_STATUS_CDE                               08140000
081500                 ,A.CURR_STATUS_DTE                               08150000
081600                 ,A.CURR_STATUS_TME                               08160000
081700                 ,F.TRIP_ID                                       08170000
081800                 ,F.MANIFEST_NBR                                  08180000
081900                 ,F.PLND_TRIP_SEQ                                 08190000
082000                 ,F.REF_TRIP_ID                                   08200000
082100                 ,G.OPER_UNT_ID                                   08210000
082200                 ,G.FCLTY_ID                                      08220000
082300                 ,G.FCLTY_AREA_ID                                 08230000
082400                 ,F.EST_AR_TMST                                   08240000
082500                 ,D.PRTY_CDE                                      08250000
082600                 ,F.EST_AR_TMST                                   08260000
082700           FROM   TVEHICL A                                       08270000
082800                 ,TVHTRIP B                                       08280000
082900                 ,TTRSTYP D                                       08290000
083000                 ,TTRIPST E                                       08300000
083100                 ,TVHTRIP F                                       08310000
083200                 ,TTRIPST G                                       08320000
083300           WHERE  A.OWNER_SCAC_ID BETWEEN :DK-OWNER-SCAC-ID-B     08330000
083400                                      AND :DK-OWNER-SCAC-ID-E     08340000
083500             AND  A.VEH_NBR       BETWEEN :DK-VEH-NBR-B           08350000
083600                                      AND :DK-VEH-NBR-E           08360000
083700             AND  A.CURR_OPER_UNT_ID BETWEEN :DK-OPER-UNT-ID-B    08370000
083800                                         AND :DK-OPER-UNT-ID-E    08380000
083900             AND  A.CURR_FCLTY_ID BETWEEN :DK-FCLTY-ID-B          08390000
084000                                      AND :DK-FCLTY-ID-E          08400000
084100             AND  E.OPER_UNT_ID BETWEEN :DK-DEST-OPER-UNT-ID-B    08410000
084200                                    AND :DK-DEST-OPER-UNT-ID-E    08420000
084300             AND  E.FCLTY_ID BETWEEN :DK-DEST-FCLTY-ID-B          08430000
084400                                 AND :DK-DEST-FCLTY-ID-E          08440000
084500             AND ((A.USAGE_CDE BETWEEN :DK-USAGE-IND-B            08450000
084600                                   AND :DK-USAGE-IND-E)           08460000
084700              OR   A.USAGE_CDE IN (:DK-USAGE-IND-1                08470000
084800                                  ,:DK-USAGE-IND-2                08480000
084900                                  ,:DK-USAGE-IND-3))              08490000
085000             AND  A.CURR_STATUS_CDE ^= 'ET'                       08500000
085100             AND ((A.CURR_STATUS_CDE BETWEEN :DK-STATUS-IND-B     08510000
085200                                         AND :DK-STATUS-IND-E)    08520000
085300              OR   A.CURR_STATUS_CDE IN (:DK-STATUS-IND-1         08530000
085400                                        ,:DK-STATUS-IND-2         08540000
085500                                        ,:DK-STATUS-IND-3         08550000
085600                                        ,:DK-STATUS-IND-4         08560000
085700                                        ,:DK-STATUS-IND-5))       08570000
085800             AND  A.CURR_STATUS_CDE = D.TRIP_STATUS_CDE           08580000
085900             AND  B.VEH_NBR IS NOT NULL                           08590000
086000             AND  A.CURR_TRIP_ID     = B.TRIP_ID                  08600000
086100             AND  A.CURR_TRIP_ID = E.TRIP_ID                      08610000
086200             AND  E.TRIP_STATUS_CDE = 'EN'                        08620000
086300             AND  B.REF_TRIP_ID = F.REF_TRIP_ID                   08630000
086400             AND  F.TRIP_ID     = G.TRIP_ID                       08640000
086500             AND  G.TRIP_STATUS_CDE = 'EN'                        08650000
086600             AND  F.EST_AR_TMST IS NOT NULL                       08660000
086700             AND  F.EST_AR_TMST    BETWEEN :DK-ETA-TMST-B         08670000
086800                                       AND :DK-ETA-TMST-E         08680000
086900         ORDER BY F.EST_AR_TMST                                   08690000
091500     END-EXEC.                                                    09150000
091600                                                                  09160000
091700/                                                                 09170000
091800*---------------------------------------------------------------* 09180000
091900*  CURSOR TO LIST TRAILERS BY 'ET' STATUS (EMPTY TRAILERS)      * 09190000
092000*---------------------------------------------------------------* 09200000
092100                                                                  09210000
092200     EXEC SQL                                                     09220000
092300          DECLARE EMPTY-CSR CURSOR FOR                            09230000
092400           SELECT A.CURR_OPER_UNT_ID                              09240000
092500                 ,A.CURR_FCLTY_ID                                 09250000
092600                 ,A.CURR_FAC_AREA_ID                              09260000
092700                 ,A.OWNER_SCAC_ID                                 09270000
092800                 ,A.VEH_NBR                                       09280000
092900                 ,A.USAGE_CDE                                     09290000
093000                 ,A.VEH_SIZE_CDE                                  09300000
093100                 ,A.CURR_STATUS_CDE                               09310000
093200                 ,A.CURR_STATUS_DTE                               09320000
093300                 ,A.CURR_STATUS_TME                               09330000
093400                 ,0                                               09340000
093500                 ,'          '                                    09350000
093600                 ,0                                               09360000
093700                 ,0                                               09370000
093800                 ,0                                               09380000
093900                 ,0                                               09390000
094000                 ,'      '                                        09400000
094100                 ,'0001-01-01-00-00.000000'                       09410000
094200                 ,'  '                                            09420000
094300           FROM   TVEHICL A                                       09430000
094400           WHERE  A.CURR_STATUS_CDE = 'ET'                        09440000
094500             AND  A.OWNER_SCAC_ID BETWEEN :DK-OWNER-SCAC-ID-B     09450000
094600                                      AND :DK-OWNER-SCAC-ID-E     09460000
094700             AND  A.VEH_NBR       BETWEEN :DK-VEH-NBR-B           09470000
094800                                      AND :DK-VEH-NBR-E           09480000
094900             AND  A.CURR_OPER_UNT_ID BETWEEN :DK-OPER-UNT-ID-B    09490000
095000                                         AND :DK-OPER-UNT-ID-E    09500000
095100             AND  A.CURR_FCLTY_ID BETWEEN :DK-FCLTY-ID-B          09510000
095200                                      AND :DK-FCLTY-ID-E          09520000
095300             AND ((A.USAGE_CDE BETWEEN :DK-USAGE-IND-B            09530000
095400                                   AND :DK-USAGE-IND-E)           09540000
095500              OR   A.USAGE_CDE IN (:DK-USAGE-IND-1                09550000
095600                                  ,:DK-USAGE-IND-2                09560000
095700                                  ,:DK-USAGE-IND-3))              09570000
095800              AND A.CURR_STATUS_DTE BETWEEN :DK-SCHD-FROM-DTE     09580000
095900                                        AND :DK-SCHD-TO-DTE       09590000
096000         ORDER BY A.CURR_OPER_UNT_ID                              09600000
096100                 ,A.CURR_FCLTY_ID                                 09610000
096200                 ,A.OWNER_SCAC_ID                                 09620000
096300                 ,A.VEH_NBR                                       09630000
096400     END-EXEC.                                                    09640000
096500                                                                  09650000
096600/                                                                 09660000
096700*---------------------------------------------------------------* 09670000
096800*  CURSOR TO LIST TRAILERS BY DOCK AREA - HISTORY               * 09680000
096900*---------------------------------------------------------------* 09690000
097000                                                                  09700000
097100/                                                                 09710000
097200 LINKAGE SECTION.                                                 09720000
097300                                                                  09730000
097400 01  DFHCOMMAREA.                                                 09740000
097500     05  FILLER                         OCCURS  1 TO 4072 TIMES   09750000
097600                                        DEPENDING ON EIBCALEN.    09760000
097700         10  FILLER                     PIC X.                    09770000
097800                                                                  09780000
097900/                                                                 09790000
098000 PROCEDURE DIVISION.                                              09800000
098100*---------------------------------------------------------------* 09810000
098200*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 09820000
098300*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 09830000
098400*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 09840000
098500*---------------------------------------------------------------* 09850000
098600 0000-MAIN-MODULE.                                                09860000
098700                                                                  09870000
098800     INITIALIZE DP030-CICS-API-FIELDS.                            09880000
098900                                                                  09890000
099000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09900000
099100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09910000
099200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09920000
099300                                                                  09930000
099400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09940000
099500                                                                  09950000
099600     MOVE LENGTH OF TR111AI        TO DP030-MAP-LENGTH (1).       09960000
099700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09970000
099800                                                                  09980000
099900     PERFORM 0001-CALL-CICS-ARCH-API.                             09990000
100000     PERFORM 1000-CONTROL-PROCESSING                              10000000
100100                                                                  10010000
100200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10020000
100300     PERFORM 0001-CALL-CICS-ARCH-API.                             10030000
100400                                                                  10040000
100500*---------------------------------------------------------------* 10050000
100600*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 10060000
100700*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 10070000
100800*---------------------------------------------------------------* 10080000
100900 0001-CALL-CICS-ARCH-API.                                         10090000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10100017
101100                                    DFHCOMMAREA                   10110017
101200                                    DP030-CICS-API-FIELDS         10120017
101300                                    DP020-STANDARD-COMMAREA       10130017
101400                                    TR111AI.                      10140017
101500                                                                  10150000
101600     IF  DP030-RC-CALL-SUCCESSFUL                                 10160000
101700         CONTINUE                                                 10170000
101800     ELSE                                                         10180000
101900         SET DP013-NO-ROLLBACK                                    10190000
102000             DP013-XCTL-DISPLAY-RESTART                           10200000
102100             DP013-CICS-ABEND      TO TRUE                        10210000
102200         MOVE '0001-CALL-CICS-ARCH-API'                           10220000
102300                                   TO DP013-PARAGRAPH             10230000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10240017
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10250017
102600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10260000
102700         PERFORM DP013-0000-PROCESS-ABEND                         10270000
102800     END-IF.                                                      10280000
102900                                                                  10290000
103000*----------------------------------------------------------------*10300000
103100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10310000
103200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10320000
103300*                                                                *10330000
103400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10340000
103500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10350000
103600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10360000
103700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10370000
103800*----------------------------------------------------------------*10380000
103900                                                                  10390000
104000 1000-CONTROL-PROCESSING.                                         10400000
104100                                                                  10410000
104200     EVALUATE TRUE                                                10420000
104300         WHEN DP020-NEXT-ACT-INITIAL                              10430000
104400             INITIALIZE ASC-SPECIFIC-COMMAREA                     10440000
104500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10450000
104600                                      ASC-SEL-TERM-ID-OUT         10460000
104700             MOVE DP020-SRC-TASK-NUMBER                           10470000
104800                                   TO ASC-LIST-TASK-NUMBER        10480000
104900                                      ASC-SEL-TASK-NUMBER-OUT     10490000
105000             MOVE PC-LIST-QUEUE-SEQ                               10500000
105100                                   TO ASC-LIST-SEQ                10510000
105200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             10520000
105300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10530000
105400             IF  PS-COMMAREA-NOT-VALID                            10540000
105500                 SET DP020-MSG-FATAL                              10550000
105600                     DP020-NEXT-ACT-APPL-ERROR                    10560000
105700                                   TO TRUE                        10570000
105800             ELSE                                                 10580000
105900                 PERFORM 4000-BUILD-INITIAL-PANEL                 10590000
106000             END-IF                                               10600000
106100                                                                  10610000
106200         WHEN DP020-NEXT-ACT-READ-MAP                             10620000
106300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10630000
106400                                   TO PV-TOP-ITEM                 10640000
106500             PERFORM 2000-PROCESS-PANEL                           10650000
106600                                                                  10660000
106700         WHEN DP020-NEXT-ACT-RETURN                               10670000
106800             PERFORM 2050-DELETE-LIST-QUEUE                       10680000
106900             PERFORM 4000-BUILD-INITIAL-PANEL                     10690000
107000                                                                  10700000
107100         WHEN OTHER                                               10710000
107200             SET DP013-LOGIC-ABEND TO TRUE                        10720000
107300             SET DP013-NO-ROLLBACK TO TRUE                        10730000
107400             MOVE '1000-CONTROL-PROCESSING'                       10740000
107500                                   TO DP013-PARAGRAPH             10750000
107600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10760000
107700                                   TO DP013-MESSAGE-TEXT(1)       10770000
107800             PERFORM DP013-0000-PROCESS-ABEND                     10780000
107900     END-EVALUATE.                                                10790000
108000                                                                  10800000
108100/                                                                 10810000
108200*----------------------------------------------------------------*10820000
108300* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *10830000
108400*----------------------------------------------------------------*10840000
108500                                                                  10850000
108600 1100-PROCESS-INTER-APPL-COMM.                                    10860000
108700                                                                  10870000
108800     SET PS-COMMAREA-VALID         TO TRUE.                       10880000
108900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     10890000
109000                                                                  10900000
109100     EVALUATE DP020-INT-APPL-FORMAT-IND                           10910000
109200                                                                  10920000
109300         WHEN PC-INTER-APPL-CRIT-SPEC                             10930000
109400             IF  PS-NO-ERROR                                      10940000
109500             AND (TR005-CURR-YARD-LOC-ID  > SPACES                10950000
109600             AND  TR005-CURR-DOCK-AREA    > SPACES)               10960000
109700             OR  (TR005-CURR-SPACE-LOC-ID > SPACES                10970000
109800             AND  TR005-CURR-DOCK-DOOR    > SPACES)               10980000
109900                 IF  TR005-OPER-UNT-ID = ZEROES                   10990000
110000                     MOVE PC-TSYMSG-00007  TO                     11000000
110100                                      DP020-MSG-NUMBER            11010000
110200                     SET PS-ERROR                                 11020000
110300                         PS-COMMAREA-NOT-VALID                    11030000
110400                         DP020-MSG-FATAL   TO TRUE                11040000
110500                 ELSE                                             11050000
110600                     MOVE PC-TSYMSG-00643                         11060000
110700                                     TO DP020-MSG-NUMBER          11070000
110800                     SET PS-ERROR                                 11080000
110900                         PS-COMMAREA-NOT-VALID                    11090000
111000                         DP020-MSG-FATAL TO TRUE                  11100000
111100                 END-IF                                           11110000
111200             END-IF                                               11120000
111300             IF  PS-NO-ERROR                                      11130000
111400             AND TR005-DELIVERY-SCAC-CDE > SPACES                 11140000
111500             AND TR005-PRO-NBR-SCAC-CDE  > SPACES                 11150000
111600                 MOVE PC-TSYMSG-00649                             11160000
111700                                 TO DP020-MSG-NUMBER              11170000
111800                 SET PS-ERROR                                     11180000
111900                     PS-COMMAREA-NOT-VALID                        11190000
112000                     DP020-MSG-FATAL TO TRUE                      11200000
112100             END-IF                                               11210000
112200             IF  PS-NO-ERROR                                      11220000
112300                 MOVE TR005-OPER-UNT-ID TO ASC-KEY-OPER-UNT-ID    11230000
112400                 MOVE TR005-FCLTY-ID    TO ASC-KEY-FCLTY-ID       11240000
112500                 EVALUATE TRUE                                    11250000
112600                   WHEN TR005-CURR-YARD-LOC-ID > SPACES           11260000
112700                        MOVE TR005-CURR-YARD-LOC-ID TO            11270000
112800                             ASC-KEY-SUBAREA-OF-ID                11280000
112900                   WHEN TR005-CURR-DOCK-AREA > SPACES             11290000
113000                        MOVE TR005-CURR-DOCK-AREA TO              11300000
113100                             ASC-KEY-SUBAREA-OF-ID                11310000
113200                 END-EVALUATE                                     11320000
113300                 EVALUATE TRUE                                    11330000
113400                   WHEN TR005-CURR-SPACE-LOC-ID > SPACES          11340000
113500                        MOVE TR005-CURR-SPACE-LOC-ID TO           11350000
113600                             ASC-KEY-FCLTY-AREA-ID                11360000
113700                   WHEN TR005-CURR-DOCK-DOOR > SPACES             11370000
113800                        MOVE TR005-CURR-DOCK-DOOR TO              11380000
113900                             ASC-KEY-FCLTY-AREA-ID                11390000
114000                 END-EVALUATE                                     11400000
114100                 MOVE TR005-STATUS-IND-1                          11410000
114200                                  TO ASC-KEY-STATUS-IND-1         11420000
114300                 MOVE TR005-STATUS-IND-2                          11430000
114400                                  TO ASC-KEY-STATUS-IND-2         11440000
114500                 MOVE TR005-STATUS-IND-3                          11450000
114600                                  TO ASC-KEY-STATUS-IND-3         11460000
114700                 MOVE TR005-STATUS-IND-4                          11470000
114800                                  TO ASC-KEY-STATUS-IND-4         11480000
114900                 MOVE TR005-STATUS-IND-5                          11490000
115000                                  TO ASC-KEY-STATUS-IND-5         11500000
115100                 MOVE TR005-TRLR-STAT-FROM-DTE                    11510000
115200                             TO ASC-KEY-SCHD-FROM-DTE             11520000
115300                 MOVE TR005-TRLR-STAT-TO-DTE                      11530000
115400                             TO ASC-KEY-SCHD-TO-DTE               11540000
115500                 MOVE TR005-USAGE-IND-1                           11550000
115600                                   TO ASC-KEY-USAGE-IND-1         11560000
115700                 MOVE TR005-USAGE-IND-2                           11570000
115800                                   TO ASC-KEY-USAGE-IND-2         11580000
115900                 MOVE TR005-USAGE-IND-3                           11590000
116000                                   TO ASC-KEY-USAGE-IND-3         11600000
116100                 MOVE TR005-DELIVERY-SCAC-CDE                     11610000
116200                                     TO ASC-KEY-OWNER-SCAC-ID     11620000
116300                 MOVE TR005-TRLR-NBR TO ASC-KEY-VEH-NBR           11630000
116400                 MOVE TR005-DEST-OPER-UNT-ID                      11640000
116500                                 TO ASC-KEY-DEST-OPER-UNT-ID      11650000
116600                 MOVE TR005-DEST-FCLTY-ID                         11660003
116700                                 TO ASC-KEY-DEST-FCLTY-ID         11670003
116800             END-IF                                               11680000
116900                                                                  11690000
117000         WHEN PC-INTER-APPL-LIST                                  11700000
117100              SET ASC-USE-SELECTION-QUEUE                         11710000
117200                                   TO TRUE                        11720000
117300              MOVE TR007-NUMBER-OF-SELECTED-ITEMS                 11730000
117400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS11740000
117500              MOVE TR007-NUMBER-OF-TS-ITEMS                       11750000
117600                                   TO ASC-NUMBER-OF-TS-ITEMS      11760000
117700              MOVE TR007-SEL-QUEUE-NAME                           11770000
117800                                   TO ASC-SEL-QUEUE-NAME-IN       11780000
117900              PERFORM 1120-PREPARE-LIST-ENTRY                     11790000
118000                                                                  11800000
118100     END-EVALUATE.                                                11810000
118200                                                                  11820000
118300*----------------------------------------------------------------*11830000
118400*  ENTRY IS FROM A LIST. GET THE KEYS FROM THE TEMP STORAGE      *11840000
118500*  QUEUE PASSED FROM THE LIST.                                   *11850000
118600*----------------------------------------------------------------*11860000
118700                                                                  11870000
118800 1120-PREPARE-LIST-ENTRY.                                         11880000
118900      MOVE TR006-MAX-ITEMS         TO ASC-SEL-SUB.                11890000
119000      MOVE ZERO                    TO ASC-SEL-ITEM.               11900000
119100      PERFORM 2300-GET-NEXT-RECORD.                               11910000
119200                                                                  11920000
119300/                                                                 11930000
119400*----------------------------------------------------------------*11940000
119500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11950000
119600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11960000
119700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11970000
119800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11980000
119900* FUNCTION KEYS CAN GET THIS FAR.                                *11990000
120000*----------------------------------------------------------------*12000000
120100                                                                  12010000
120200 2000-PROCESS-PANEL.                                              12020000
120300     EVALUATE TRUE                                                12030000
120400         WHEN DP020-SRC-AID = DP016-CLEAR                         12040000
120500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12050000
120600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12060000
120700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12070000
120800                                                                  12080000
120900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12090000
121000             PERFORM 2050-DELETE-LIST-QUEUE                       12100000
121100             PERFORM 4000-BUILD-INITIAL-PANEL                     12110000
121200                                                                  12120000
121300         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   12130000
121400             PERFORM 2140-DESELECT-ALL-ITEMS                      12140000
121500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12150000
121600                                                                  12160000
121700         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 12170000
121800              PERFORM 2150-SELECT-ALL-ITEMS                       12180000
121900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                12190000
122000                                                                  12200000
122100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12210000
122200             IF ASC-USE-SELECTION-QUEUE                           12220000
122300                 PERFORM 6200-DEL-LIST-QUEUE                      12230000
122400                 PERFORM 2300-GET-NEXT-RECORD                     12240000
122500                 PERFORM 4000-BUILD-INITIAL-PANEL                 12250000
122600                 PERFORM 3200-RESET-ATTRIBUTES                    12260000
122700             ELSE                                                 12270000
122800*                --- BOTTOM OF LIST ---                           12280000
122900                 MOVE PC-TSYMSG-00070                             12290000
123000                                   TO DP020-MSG-NUMBER            12300000
123100                 SET DP020-MSG-INFORMATIONAL                      12310000
123200                                   TO TRUE                        12320000
123300             END-IF                                               12330000
123400                                                                  12340000
123500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12350000
123600             IF ASC-USE-SELECTION-QUEUE                           12360000
123700                 PERFORM 6200-DEL-LIST-QUEUE                      12370000
123800                 PERFORM 2310-GET-PREV-RECORD                     12380000
123900                 PERFORM 4000-BUILD-INITIAL-PANEL                 12390000
124000                 PERFORM 3200-RESET-ATTRIBUTES                    12400000
124100             ELSE                                                 12410000
124200*                --- TOP OF LIST ---                              12420000
124300                 MOVE PC-TSYMSG-00069                             12430000
124400                                   TO DP020-MSG-NUMBER            12440000
124500                 SET DP020-MSG-INFORMATIONAL                      12450000
124600                                   TO TRUE                        12460000
124700             END-IF                                               12470000
124800         WHEN OTHER                                               12480000
124900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12490000
125000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12500000
125100             IF  PS-NO-ERROR                                      12510000
125200                 SET DP030-CONTINUE-GO TO TRUE                    12520000
125300                 PERFORM 2100-CHECK-FUNCTION-KEY                  12530000
125400             ELSE                                                 12540000
125500                 SET DP030-OVERRIDE-GO TO TRUE                    12550000
125600             END-IF                                               12560000
125700     END-EVALUATE.                                                12570000
125800                                                                  12580000
125900/                                                                 12590000
126000*----------------------------------------------------------------*12600000
126100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12610000
126200*----------------------------------------------------------------*12620000
126300 2050-DELETE-LIST-QUEUE.                                          12630000
126400                                                                  12640000
126500     EXEC CICS                                                    12650000
126600         DELETEQ TS                                               12660000
126700           QUEUE (ASC-LIST-QUEUE-NAME)                            12670000
126800            RESP (PV-CICS-RESP)                                   12680000
126900     END-EXEC.                                                    12690000
127000                                                                  12700000
127100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12710000
127200        (PV-CICS-RESP = DFHRESP(QIDERR))                          12720000
127300         CONTINUE                                                 12730000
127400     ELSE                                                         12740000
127500         SET DP013-CICS-ABEND      TO TRUE                        12750000
127600         SET DP013-NO-ROLLBACK     TO TRUE                        12760000
127700                                                                  12770000
127800         MOVE '2050-DELETE-LIST-QUEUE'                            12780000
127900                                   TO DP013-PARAGRAPH             12790000
128000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12800000
128100                                   TO DP013-MESSAGE-TEXT (1)      12810000
128200         PERFORM DP013-0000-PROCESS-ABEND                         12820000
128300     END-IF.                                                      12830000
128400                                                                  12840000
128500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12850000
128600                                                                  12860000
128700/                                                                 12870000
128800*----------------------------------------------------------------*12880000
128900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12890000
129000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12900000
129100* CICS ARCHITECTURE API.                                         *12910000
129200*----------------------------------------------------------------*12920000
129300 2100-CHECK-FUNCTION-KEY.                                         12930000
129400                                                                  12940000
129500     EVALUATE TRUE                                                12950000
129600         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 12960000
129700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12970000
129800                 INITIALIZE TR007-INTER-APPL-COMMAREA             12980000
129900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12990000
130000                             TO TR007-NUMBER-OF-SELECTED-ITEMS    13000000
130100                 MOVE ASC-KEY-OPER-UNT-ID                         13010000
130200                                   TO TR007-OPER-UNT-ID           13020000
130300                 MOVE ASC-KEY-FCLTY-ID                            13030003
130400                                   TO TR007-FCLTY-ID              13040003
130500                 PERFORM 5000-PREPARE-SEL-QUEUE                   13050000
130600             ELSE                                                 13060000
130700                 SET DP030-OVERRIDE-GO                            13070000
130800                                   TO TRUE                        13080000
130900                 MOVE PC-TSYMSG-00057                             13090000
131000                                   TO DP020-MSG-NUMBER            13100000
131100                 SET DP020-MSG-WARNING                            13110000
131200                                   TO TRUE                        13120000
131300             END-IF                                               13130000
131400                                                                  13140000
131500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13150000
131600             MOVE +1               TO PV-TOP-ITEM                 13160000
131700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13170000
131800             PERFORM 3200-RESET-ATTRIBUTES                        13180000
131900                                                                  13190000
132000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13200000
132100             PERFORM 2110-BROWSE-BACKWARD                         13210000
132200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13220000
132300             PERFORM 3200-RESET-ATTRIBUTES                        13230000
132400                                                                  13240000
132500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13250000
132600             PERFORM 2120-BROWSE-FORWARD                          13260000
132700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13270000
132800             PERFORM 3200-RESET-ATTRIBUTES                        13280000
132900                                                                  13290000
133000         WHEN DP020-SRC-AID = DP016-ENTER                         13300000
133100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13310000
133200             IF  PS-ERROR                                         13320000
133300                 CONTINUE                                         13330000
133400             ELSE                                                 13340000
133500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13350000
133600             END-IF                                               13360000
133700                                                                  13370000
133800         WHEN OTHER                                               13380000
133900             SET DP013-NO-ROLLBACK                                13390000
134000                 DP013-XCTL-DISPLAY-RESTART                       13400000
134100                 DP013-CICS-ABEND  TO TRUE                        13410000
134200             MOVE '2100-CHECK-FUNCTION-KEY'                       13420000
134300                                   TO DP013-PARAGRAPH             13430000
134400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13440000
134500                                   TO DP013-MESSAGE-TEXT (1)      13450000
134600             PERFORM DP013-0000-PROCESS-ABEND                     13460000
134700     END-EVALUATE.                                                13470000
134800                                                                  13480000
134900/                                                                 13490000
135000*----------------------------------------------------------------*13500000
135100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13510000
135200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13520000
135300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13530000
135400*    MESSAGE.                                                    *13540000
135500*----------------------------------------------------------------*13550000
135600                                                                  13560000
135700 2110-BROWSE-BACKWARD.                                            13570000
135800                                                                  13580000
135900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13590000
136000         GIVING PV-TOP-ITEM.                                      13600000
136100                                                                  13610000
136200     IF  ((PV-TOP-ITEM < +1)                                      13620000
136300       OR (PV-TOP-ITEM = +1))                                     13630000
136400         MOVE +1                   TO PV-TOP-ITEM                 13640000
136500*        -- TOP OF LIST --                                        13650000
136600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13660000
136700         SET DP020-MSG-INFORMATIONAL                              13670000
136800                                   TO TRUE                        13680000
136900     END-IF.                                                      13690000
137000                                                                  13700000
137100/                                                                 13710000
137200*----------------------------------------------------------------*13720000
137300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13730000
137400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13740000
137500*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13750000
137600*----------------------------------------------------------------*13760000
137700                                                                  13770000
137800 2120-BROWSE-FORWARD.                                             13780000
137900                                                                  13790000
138000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13800000
138100         GIVING PV-TOP-ITEM.                                      13810000
138200                                                                  13820000
138300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13830000
138400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13840000
138500                                   TO PV-TOP-ITEM                 13850000
138600*        -- BOTTOM OF LIST --                                     13860000
138700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13870000
138800         SET DP020-MSG-INFORMATIONAL                              13880000
138900                                   TO TRUE                        13890000
139000     ELSE                                                         13900000
139100         COMPUTE PV-BOTTOM-ITEM =                                 13910000
139200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13920000
139300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13930000
139400*            -- BOTTOM OF LIST --                                 13940000
139500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13950000
139600             SET DP020-MSG-INFORMATIONAL                          13960000
139700                                   TO TRUE                        13970000
139800         END-IF                                                   13980000
139900     END-IF.                                                      13990000
140000                                                                  14000000
140100/                                                                 14010000
140200*----------------------------------------------------------------*14020000
140300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14030000
140400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14040000
140500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14050000
140600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14060000
140700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14070000
140800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14080000
140900*----------------------------------------------------------------*14090000
141000                                                                  14100000
141100 2130-CHECK-FOR-JUMP-BROWSE.                                      14110000
141200                                                                  14120000
141300     SET PS-NO-ERROR               TO TRUE.                       14130000
141400     IF (ASC-START-ITEM-REQUEST = SPACE)                          14140000
141500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14150000
141600                                   TO PV-TOP-ITEM                 14160000
141700     ELSE                                                         14170000
141800         MOVE ASC-START-ITEM-REQUEST                              14180000
141900                                   TO DP010I-UNEDITED-FIELD       14190000
142000         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       14200000
142100         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     14210000
142200         SET DP010I-NEGATIVE-NOT-ALLOWED                          14220000
142300                                   TO TRUE                        14230000
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14241016
263697              USING DP010I-NUMERIC-EDIT-AREA                      14242016
142500                                                                  14250000
142600         IF  NOT DP010I-ERROR-DETECTED                            14260000
142700             MOVE DP010I-NUMERIC-FIELD                            14270000
142800                                   TO ASC-START-ITEM-REQUEST-N    14280000
142900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  14290000
143000                 IF  ASC-START-ITEM-REQUEST-N >                   14300000
143100                                          ASC-NUMBER-OF-ITEMS-READ14310000
143200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         14320000
143300                     COMPUTE PV-TOP-ITEM =                        14330000
143400                             ASC-NUMBER-OF-ITEMS-READ             14340000
143500                             - PC-ITEMS-PER-PANEL + 1             14350000
143600                     IF  PV-TOP-ITEM < +1                         14360000
143700                         MOVE +1   TO PV-TOP-ITEM                 14370000
143800                         MOVE PC-TSYMSG-00070                     14380000
143900                                   TO DP020-MSG-NUMBER            14390000
144000                         SET DP020-MSG-INFORMATIONAL              14400000
144100                                   TO TRUE                        14410000
144200                     END-IF                                       14420000
144300                 ELSE                                             14430000
144400                     MOVE ASC-START-ITEM-REQUEST-N                14440000
144500                                   TO PV-TOP-ITEM                 14450000
144600                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      14460000
144700                     COMPUTE PV-BOTTOM-ITEM =                     14470000
144800                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     14480000
144900                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ14490000
145000*                        -- BOTTOM OF LIST --                     14500000
145100                         MOVE PC-TSYMSG-00070                     14510000
145200                                   TO DP020-MSG-NUMBER            14520000
145300                         SET DP020-MSG-INFORMATIONAL              14530000
145400                                   TO TRUE                        14540000
145500                     END-IF                                       14550000
145600                 END-IF                                           14560000
145700             ELSE                                                 14570000
145800*                --- VALUE OUT OF RANGE ----                      14580000
145900                 MOVE PC-TSYMSG-00101                             14590000
146000                                   TO DP020-MSG-NUMBER            14600000
146100                 MOVE -1           TO ASTRTITL                    14610000
146200                 SET DP030-SET-CURSOR-APPL-1                      14620000
146300                                   TO TRUE                        14630000
146400                 MOVE DP015-REVERSE                               14640000
146500                                   TO ASTRTITH                    14650000
146600                 MOVE DP015-RED    TO ASTRTITC                    14660000
146700                 MOVE DP015-UNP-NUM-BRT-MDT                       14670000
146800                                   TO ASTRTITA                    14680000
146900                 SET DP020-MSG-FATAL                              14690000
147000                                   TO TRUE                        14700000
147100                 SET PS-ERROR      TO TRUE                        14710000
147200             END-IF                                               14720000
147300                                                                  14730000
147400         ELSE                                                     14740000
147500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14750000
147600             MOVE -1               TO ASTRTITL                    14760000
147700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14770000
147800             MOVE DP015-REVERSE    TO ASTRTITH                    14780000
147900             MOVE DP015-RED        TO ASTRTITC                    14790000
148000             MOVE DP015-UNP-NUM-BRT-MDT                           14800000
148100                                   TO ASTRTITA                    14810000
148200             SET DP020-MSG-FATAL   TO TRUE                        14820000
148300             SET PS-ERROR          TO TRUE                        14830000
148400         END-IF                                                   14840000
148500     END-IF.                                                      14850000
148600                                                                  14860000
148700/                                                                 14870000
148800*----------------------------------------------------------------*14880000
148900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14890000
149000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14900000
149100*----------------------------------------------------------------*14910000
149200 2140-DESELECT-ALL-ITEMS.                                         14920000
149300                                                                  14930000
149400     MOVE +1                       TO ASC-BLK-SUB.                14940000
149500                                                                  14950000
149600     PERFORM 2141-CLEAR-SELECTED-INDS                             14960000
149700         VARYING ASC-ITEM-SUB                                     14970000
149800         FROM 1 BY 1                                              14980000
149900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14990000
150000                                                                  15000000
150100     ADD +1                        TO ASC-BLK-SUB.                15010000
150200                                                                  15020000
150300     PERFORM 2141-CLEAR-SELECTED-INDS                             15030000
150400         VARYING ASC-ITEM-SUB                                     15040000
150500         FROM 1 BY 1                                              15050000
150600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15060000
150700                                                                  15070000
150800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15080000
150900                                   TO PV-LIST-ITEM-NUMBER.        15090000
151000                                                                  15100000
151100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15110000
151200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15120000
151300                                                                  15130000
151400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15140000
151500        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      15150000
151600         MOVE +1                   TO ASC-BLK-SUB                 15160000
151700                                                                  15170000
151800         PERFORM 5100-WRITE-TEMP-STORAGE                          15180000
151900                                                                  15190000
152000         MOVE +1                   TO PV-BLOCK-NUMBER             15200000
152100                                                                  15210000
152200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15220000
152300             PV-FIRST-BLOCK-IN-ARRAY - 1                          15230000
152400                                                                  15240000
152500         PERFORM                                                  15250000
152600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15260000
152700                                                                  15270000
152800             PERFORM 4410-READ-TEMP-STORAGE                       15280000
152900                                                                  15290000
153000             PERFORM 2141-CLEAR-SELECTED-INDS                     15300000
153100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 15310000
153200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15320000
153300                                                                  15330000
153400             PERFORM 5100-WRITE-TEMP-STORAGE                      15340000
153500                                                                  15350000
153600             ADD +1                TO PV-BLOCK-NUMBER             15360000
153700                                                                  15370000
153800         END-PERFORM                                              15380000
153900                                                                  15390000
154000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15400000
154100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15410000
154200                                                                  15420000
154300         PERFORM                                                  15430000
154400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15440000
154500                   ASC-HIGHEST-BLOCK-WRITTEN                      15450000
154600                                                                  15460000
154700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15470000
154800                                   TO PV-BLOCK-NUMBER             15480000
154900                                                                  15490000
155000             PERFORM 4410-READ-TEMP-STORAGE                       15500000
155100                                                                  15510000
155200             PERFORM 2141-CLEAR-SELECTED-INDS                     15520000
155300                 VARYING ASC-ITEM-SUB                             15530000
155400                 FROM 1 BY 1                                      15540000
155500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15550000
155600                                                                  15560000
155700             PERFORM 5100-WRITE-TEMP-STORAGE                      15570000
155800                                                                  15580000
155900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15590000
156000                                                                  15600000
156100         END-PERFORM                                              15610000
156200                                                                  15620000
156300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15630000
156400                                   TO PV-BLOCK-NUMBER             15640000
156500                                                                  15650000
156600         PERFORM 4410-READ-TEMP-STORAGE                           15660000
156700     END-IF.                                                      15670000
156800                                                                  15680000
156900                                                                  15690000
157000     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS15700000
157100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.15710000
157200     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  15720000
157300                                                                  15730000
157400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15740000
157500                                                                  15750000
157600/                                                                 15760000
157700*----------------------------------------------------------------*15770000
157800*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15780000
157900*----------------------------------------------------------------*15790000
158000                                                                  15800000
158100 2141-CLEAR-SELECTED-INDS.                                        15810000
158200                                                                  15820000
158300     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          15830000
158400             NOT EQUAL ZERO                                       15840000
158500         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15850000
158600             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15860000
158700                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    15870000
158800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15880000
158900                                   TO TRUE                        15890000
159000         END-IF                                                   15900000
159100     END-IF.                                                      15910000
159200                                                                  15920000
159300/                                                                 15930000
159400*----------------------------------------------------------------*15940000
159500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15950000
159600*  FOR ALL ITEMS.                                                *15960000
159700*----------------------------------------------------------------*15970000
159800                                                                  15980000
159900 2150-SELECT-ALL-ITEMS.                                           15990000
160000                                                                  16000000
160100     MOVE +1                       TO ASC-BLK-SUB.                16010000
160200                                                                  16020000
160300     PERFORM 2151-SET-SELECTED-INDS                               16030000
160400         VARYING ASC-ITEM-SUB                                     16040000
160500         FROM 1 BY 1                                              16050000
160600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16060000
160700                                                                  16070000
160800     ADD +1                        TO ASC-BLK-SUB.                16080000
160900                                                                  16090000
161000     PERFORM 2151-SET-SELECTED-INDS                               16100000
161100         VARYING ASC-ITEM-SUB                                     16110000
161200         FROM 1 BY 1                                              16120000
161300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16130000
161400                                                                  16140000
161500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16150000
161600                                   TO PV-LIST-ITEM-NUMBER.        16160000
161700                                                                  16170000
161800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16180000
161900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16190000
162000                                                                  16200000
162100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16210000
162200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    16220000
162300         MOVE +1                   TO ASC-BLK-SUB                 16230000
162400                                                                  16240000
162500         PERFORM 5100-WRITE-TEMP-STORAGE                          16250000
162600                                                                  16260000
162700         MOVE +1                   TO PV-BLOCK-NUMBER             16270000
162800                                                                  16280000
162900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16290000
163000             PV-FIRST-BLOCK-IN-ARRAY - 1                          16300000
163100                                                                  16310000
163200         PERFORM                                                  16320000
163300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16330000
163400                                                                  16340000
163500             PERFORM 4410-READ-TEMP-STORAGE                       16350000
163600                                                                  16360000
163700             PERFORM 2151-SET-SELECTED-INDS                       16370000
163800                 VARYING ASC-ITEM-SUB                             16380000
163900                 FROM 1 BY 1                                      16390000
164000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16400000
164100                                                                  16410000
164200             PERFORM 5100-WRITE-TEMP-STORAGE                      16420000
164300                                                                  16430000
164400             ADD +1                TO PV-BLOCK-NUMBER             16440000
164500         END-PERFORM                                              16450000
164600                                                                  16460000
164700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16470000
164800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16480000
164900                                                                  16490000
165000         PERFORM                                                  16500000
165100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16510000
165200                   ASC-HIGHEST-BLOCK-WRITTEN                      16520000
165300                                                                  16530000
165400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16540000
165500                                   TO PV-BLOCK-NUMBER             16550000
165600                                                                  16560000
165700             PERFORM 4410-READ-TEMP-STORAGE                       16570000
165800                                                                  16580000
165900             PERFORM 2151-SET-SELECTED-INDS                       16590000
166000                 VARYING ASC-ITEM-SUB                             16600000
166100                 FROM 1 BY 1                                      16610000
166200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16620000
166300                                                                  16630000
166400             PERFORM 5100-WRITE-TEMP-STORAGE                      16640000
166500                                                                  16650000
166600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16660000
166700         END-PERFORM                                              16670000
166800                                                                  16680000
166900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16690000
167000                                   TO PV-BLOCK-NUMBER             16700000
167100                                                                  16710000
167200         PERFORM 4410-READ-TEMP-STORAGE                           16720000
167300     END-IF.                                                      16730000
167400                                                                  16740000
167500     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             16750000
167600          ASC-NUMBER-OF-SELECTED-ITEMS.                           16760000
167700                                                                  16770000
167800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16780000
167900                                                                  16790000
168000/                                                                 16800000
168100*----------------------------------------------------------------*16810000
168200*    MARK EACH ITEM AS BEING SELECTED.                           *16820000
168300*----------------------------------------------------------------*16830000
168400                                                                  16840000
168500 2151-SET-SELECTED-INDS.                                          16850000
168600                                                                  16860000
168700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16870000
168800             NOT EQUAL ZERO                                       16880000
168900         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16890000
169000             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16900000
169100                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16910000
169200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16920000
169300                                   TO TRUE                        16930000
169400         END-IF                                                   16940000
169500     END-IF.                                                      16950000
169600                                                                  16960000
169700/                                                                 16970000
169800*----------------------------------------------------------------*16980000
169900*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *16990000
170000*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *17000000
170100*----------------------------------------------------------------*17010000
170200 2200-MOVE-SCREEN-TO-COMMAREA.                                    17020000
170300                                                                  17030000
170400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             17040000
170500     MOVE +1                       TO PV-SUB.                     17050000
170600                                                                  17060000
170700     PERFORM 3100-SET-SUBSCRIPTS.                                 17070000
170800                                                                  17080000
170900     IF  ASTRTITL > ZERO                                          17090000
171000         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      17100000
171100     ELSE                                                         17110000
171200         IF  ASTRTITF = DP015-ERASE-EOF                           17120000
171300             INITIALIZE ASC-START-ITEM-REQUEST                    17130000
171400         END-IF                                                   17140000
171500     END-IF.                                                      17150000
171600                                                                  17160000
171700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          17170000
171800         VARYING PV-SUB                                           17180000
171900         FROM 1 BY 1                                              17190000
172000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      17200000
172100                                                                  17210000
172200/                                                                 17220000
172300*----------------------------------------------------------------*17230000
172400*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *17240000
172500*----------------------------------------------------------------*17250000
172600 2210-MOVE-LINES-TO-COMMAREA.                                     17260000
172700                                                                  17270000
172800     IF  MR-SELECTL (PV-SUB) > ZERO                               17280000
172900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     17290000
173000                                   TO TRUE                        17300000
173100         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        17310000
173200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17320000
173300     ELSE                                                         17330000
173400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                17340000
173500             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         17350000
173600             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        17360000
173700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17370000
173800         END-IF                                                   17380000
173900     END-IF.                                                      17390000
174000                                                                  17400000
174100     ADD +1                        TO ASC-ITEM-SUB.               17410000
174200                                                                  17420000
174300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        17430000
174400         ADD +1                    TO ASC-BLK-SUB                 17440000
174500         MOVE +1                   TO ASC-ITEM-SUB                17450000
174600     END-IF.                                                      17460000
174700                                                                  17470000
174800/                                                                 17480000
174900******************************************************************17490000
175000* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *17500000
175100* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *17510000
175200******************************************************************17520000
175300 2300-GET-NEXT-RECORD.                                            17530000
175400                                                                  17540000
175500     ADD +1                        TO ASC-SEL-SUB.                17550000
175600     IF ASC-SEL-SUB > TR006-MAX-ITEMS                             17560000
175700         ADD +1                    TO ASC-SEL-ITEM                17570000
175800         MOVE +1                   TO ASC-SEL-SUB                 17580000
175900     END-IF.                                                      17590000
176000     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 17600000
176100         PERFORM 9100-READ-SEL-QUEUE                              17610000
176200         IF TR006-ITEM (ASC-SEL-SUB) > ZERO                       17620000
176300             MOVE TR006-OPER-UNT-ID (ASC-SEL-SUB)                 17630000
176400                                   TO ASC-KEY-OPER-UNT-ID         17640000
176500             MOVE TR006-FCLTY-ID (ASC-SEL-SUB)                    17650000
176600                                   TO ASC-KEY-FCLTY-ID            17660000
176700             SET TR006-INQ (ASC-SEL-SUB)                          17670000
176800                                   TO TRUE                        17680000
176900             PERFORM 9200-REWRITE-LIST-QUEUE                      17690000
177000         ELSE                                                     17700000
177100             SUBTRACT +1 FROM ASC-SEL-SUB                         17710000
177200*            --- BOTTOM OF LIST ---                               17720000
177300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            17730000
177400             SET DP020-MSG-INFORMATIONAL                          17740000
177500                                   TO TRUE                        17750000
177600         END-IF                                                   17760000
177700     ELSE                                                         17770000
177800         SUBTRACT +1 FROM ASC-SEL-ITEM                            17780000
177900         MOVE TR006-MAX-ITEMS      TO ASC-SEL-SUB                 17790000
178000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            17800000
178100         SET DP020-MSG-INFORMATIONAL                              17810000
178200                                   TO TRUE                        17820000
178300     END-IF.                                                      17830000
178400                                                                  17840000
178500/                                                                 17850000
178600******************************************************************17860000
178700* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *17870000
178800* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *17880000
178900******************************************************************17890000
179000 2310-GET-PREV-RECORD.                                            17900000
179100                                                                  17910000
179200     SUBTRACT +1 FROM ASC-SEL-SUB.                                17920000
179300     IF ASC-SEL-SUB < +1                                          17930000
179400         SUBTRACT +1 FROM ASC-SEL-ITEM                            17940000
179500         MOVE TR006-MAX-ITEMS      TO ASC-SEL-SUB                 17950000
179600     END-IF.                                                      17960000
179700                                                                  17970000
179800     IF ASC-SEL-ITEM > ZERO                                       17980000
179900         PERFORM 9100-READ-SEL-QUEUE                              17990000
180000         MOVE TR006-OPER-UNT-ID (ASC-SEL-SUB)                     18000000
180100                                   TO ASC-KEY-OPER-UNT-ID         18010000
180200         MOVE TR006-FCLTY-ID (ASC-SEL-SUB)                        18020000
180300                                   TO ASC-KEY-FCLTY-ID            18030000
180400     ELSE                                                         18040000
180500         MOVE +1                   TO ASC-SEL-ITEM                18050000
180600                                      ASC-SEL-SUB                 18060000
180700*        --- TOP OF LIST ---                                      18070000
180800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            18080000
180900         SET DP020-MSG-INFORMATIONAL                              18090000
181000                                   TO TRUE                        18100000
181100     END-IF.                                                      18110000
181200                                                                  18120000
181300/                                                                 18130000
181400*----------------------------------------------------------------*18140000
181500*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *18150000
181600*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *18160000
181700*----------------------------------------------------------------*18170000
181800 3000-EDIT-DATA-IN-COMMAREA.                                      18180000
181900                                                                  18190000
182000     SET PS-NO-ERROR               TO TRUE.                       18200000
182100                                                                  18210000
182200     PERFORM 3200-RESET-ATTRIBUTES.                               18220000
182300                                                                  18230000
182400     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     18240000
182500**                                                                18250000
182600* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              18260000
182700* EDITTING IS DONE FROM THE BOTTOM UP.                            18270000
182800**                                                                18280000
182900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       18290000
183000         ASC-ITEMS-DISPLAYED - 1.                                 18300000
183100                                                                  18310000
183200     PERFORM 3100-SET-SUBSCRIPTS.                                 18320000
183300     PERFORM 3300-EDIT-SELECTIONS                                 18330000
183400         VARYING PV-SUB                                           18340000
183500         FROM PV-SUB BY -1                                        18350000
183600         UNTIL PV-SUB < +1                                        18360000
183700                                                                  18370000
183800     IF  PS-NO-ERROR                                              18380000
183900         PERFORM 3400-CHECK-RANGE-SEQUENCE                        18390000
184000     END-IF.                                                      18400000
184100                                                                  18410000
184200     IF  ((PS-NO-ERROR)                                           18420000
184300       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   18430000
184400       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    18440000
184500             PERFORM 3500-MARK-RANGE-AS-SELECTED                  18450000
184600     END-IF.                                                      18460000
184700                                                                  18470000
184800/                                                                 18480000
184900*----------------------------------------------------------------*18490000
185000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18500000
185100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18510000
185200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18520000
185300*                                                                *18530000
185400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18540000
185500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18550000
185600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18560000
185700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18570000
185800*----------------------------------------------------------------*18580000
185900                                                                  18590000
186000 3100-SET-SUBSCRIPTS.                                             18600000
186100                                                                  18610000
186200     COMPUTE ASC-ITEM-SUB =                                       18620000
186300         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18630000
186400                                                                  18640000
186500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18650000
186600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18660000
186700                                                                  18670000
186800         MOVE PC-MAX-BLOCKS-IN-ARRAY                              18680000
186900                                   TO ASC-BLK-SUB                 18690000
187000     ELSE                                                         18700000
187100         MOVE +1                   TO ASC-BLK-SUB                 18710000
187200     END-IF.                                                      18720000
187300                                                                  18730000
187400*----------------------------------------------------------------*18740000
187500*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *18750000
187600*----------------------------------------------------------------*18760000
187700                                                                  18770000
187800 3200-RESET-ATTRIBUTES.                                           18780000
187900                                                                  18790000
188000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   18800000
188100     MOVE DP015-GREEN              TO ASTRTITC.                   18810000
188200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18820000
188300                                                                  18830000
188400     IF DP020-NEXT-ACT-RETURN                                     18840000
188500     OR DP020-NEXT-ACT-READ-MAP                                   18850000
188600        PERFORM                                                   18860000
188700            VARYING PV-SUB                                        18870000
188800            FROM 1 BY 1                                           18880000
188900            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    18890000
189000            MOVE DP015-UNP-ALP-NOR-OFF                            18900000
189100                                      TO MR-SELECTA (PV-SUB)      18910000
189200            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      18920000
189300            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      18930000
189400        END-PERFORM                                               18940000
189500     ELSE                                                         18950000
189600        PERFORM                                                   18960000
189700            VARYING PV-SUB                                        18970000
189800            FROM 1 BY 1                                           18980000
189900            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     18990000
190000            MOVE DP015-UNP-ALP-NOR-OFF                            19000000
190100                                      TO MR-SELECTA (PV-SUB)      19010000
190200            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      19020000
190300            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      19030000
190400        END-PERFORM                                               19040000
190500     END-IF.                                                      19050000
190600                                                                  19060000
190700/                                                                 19070000
190800*----------------------------------------------------------------*19080000
190900*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *19090000
191000*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *19100000
191100*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *19110000
191200*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *19120000
191300*----------------------------------------------------------------*19130000
191400 3300-EDIT-SELECTIONS.                                            19140000
191500                                                                  19150000
191600     EVALUATE TRUE                                                19160000
191700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19170000
191800             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         19180000
191900                 CONTINUE                                         19190000
192000                                                                  19200000
192100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         19210000
192200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        19220000
192300                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS19230000
192400                 MOVE ASC-TEMP-SELECTED-SW                        19240000
192500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19250000
192600                                   TO ASC-SELECTED-SW             19260000
192700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19270000
192800             END-IF                                               19280000
192900                                                                  19290000
193000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19300000
193100                 = SPACE                                          19310000
193200             EVALUATE TRUE                                        19320000
193300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       19330000
193400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS19340000
193500                     MOVE SPACE    TO ASC-SELECTED-SW             19350000
193600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19360000
193700                                                                  19370000
193800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19380000
193900                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 19390000
194000                     MOVE SPACE    TO ASC-SELECTED-SW             19400000
194100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19410000
194200                                                                  19420000
194300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19430000
194400                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   19440000
194500                     MOVE SPACE    TO ASC-SELECTED-SW             19450000
194600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19460000
194700             END-EVALUATE                                         19470000
194800                                                                  19480000
194900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19490000
195000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19500000
195100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19510000
195200             END-IF                                               19520000
195300             PERFORM 3310-EDIT-RANGE                              19530000
195400                                                                  19540000
195500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19550000
195600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19560000
195700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19570000
195800             END-IF                                               19580000
195900             PERFORM 3310-EDIT-RANGE                              19590000
196000                                                                  19600000
196100         WHEN OTHER                                               19610000
196200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            19620000
196300             SET DP020-MSG-FATAL   TO TRUE                        19630000
196400             MOVE -1               TO MR-SELECTL (PV-SUB)         19640000
196500             SET DP030-SET-CURSOR-APPL-1                          19650000
196600                                   TO TRUE                        19660000
196700             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         19670000
196800             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         19680000
196900             SET PS-ERROR          TO TRUE                        19690000
197000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19700000
197100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19710000
197200                 MOVE SPACE        TO ASC-SELECTED-SW             19720000
197300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19730000
197400             END-IF                                               19740000
197500     END-EVALUATE.                                                19750000
197600                                                                  19760000
197700     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             19770000
197800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19780000
197900                                                                  19790000
198000     IF  ASC-ITEM-SUB < 1                                         19800000
198100         SUBTRACT +1 FROM ASC-BLK-SUB                             19810000
198200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                19820000
198300     END-IF.                                                      19830000
198400                                                                  19840000
198500*----------------------------------------------------------------*19850000
198600*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *19860000
198700*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *19870000
198800*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *19880000
198900*  THE ENDING.                                                   *19890000
199000*----------------------------------------------------------------*19900000
199100 3310-EDIT-RANGE.                                                 19910000
199200                                                                  19920000
199300     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                19930000
199400         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   19940000
199500             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)19950000
199600                                   TO ASC-SELECTED-SW             19960000
199700                                        (ASC-BLK-SUB ASC-ITEM-SUB)19970000
199800             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 19980000
199900         ELSE                                                     19990000
200000             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     20000000
200100                 CONTINUE                                         20010000
200200             ELSE                                                 20020000
200300*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        20030000
200400                 MOVE PC-TSYMSG-00054                             20040000
200500                                   TO DP020-MSG-NUMBER            20050000
200600                 SET DP020-MSG-FATAL                              20060000
200700                                   TO TRUE                        20070000
200800                 MOVE -1           TO MR-SELECTL (PV-SUB)         20080000
200900                 SET DP030-SET-CURSOR-APPL-1                      20090000
201000                                   TO TRUE                        20100000
201100                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         20110000
201200                 MOVE DP015-UNDERLINE                             20120000
201300                                   TO MR-SELECTH (PV-SUB)         20130000
201400                 SET PS-ERROR      TO TRUE                        20140000
201500             END-IF                                               20150000
201600         END-IF                                                   20160000
201700     ELSE                                                         20170000
201800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20180000
201900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20190000
202000                                   TO ASC-SELECTED-SW             20200000
202100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20210000
202200             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20220000
202300         ELSE                                                     20230000
202400             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20240000
202500                 CONTINUE                                         20250000
202600             ELSE                                                 20260000
202700*                -- ONLY ONE END-OF-RANGE ALLOWED --              20270000
202800                 MOVE PC-TSYMSG-00055                             20280000
202900                                   TO DP020-MSG-NUMBER            20290000
203000                 SET DP020-MSG-FATAL                              20300000
203100                                   TO TRUE                        20310000
203200                 MOVE -1           TO MR-SELECTL (PV-SUB)         20320000
203300                 SET DP030-SET-CURSOR-APPL-1                      20330000
203400                                   TO TRUE                        20340000
203500                 SET PS-ERROR      TO TRUE                        20350000
203600             END-IF                                               20360000
203700         END-IF                                                   20370000
203800     END-IF.                                                      20380000
203900                                                                  20390000
204000*----------------------------------------------------------------*20400000
204100*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *20410000
204200*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *20420000
204300*----------------------------------------------------------------*20430000
204400 3400-CHECK-RANGE-SEQUENCE.                                       20440000
204500                                                                  20450000
204600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20460000
204700       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20470000
204800       AND  ASC-START-OF-SELECTED-RANGE >                         20480000
204900                                         ASC-END-OF-SELECTED-RANGE20490000
205000*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20500000
205100         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            20510000
205200         SET DP020-MSG-FATAL       TO TRUE                        20520000
205300         SET PS-ERROR              TO TRUE                        20530000
205400         PERFORM 3410-POSITION-AT-ERROR                           20540000
205500     END-IF.                                                      20550000
205600                                                                  20560000
205700*----------------------------------------------------------------*20570000
205800*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *20580000
205900*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *20590000
206000*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *20600000
206100*----------------------------------------------------------------*20610000
206200 3410-POSITION-AT-ERROR.                                          20620000
206300                                                                  20630000
206400     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       20640000
206500                                                                  20650000
206600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20660000
206700                    - PV-TOP-ITEM + 1.                            20670000
206800                                                                  20680000
206900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20690000
207000         CONTINUE                                                 20700000
207100     ELSE                                                         20710000
207200         MOVE -1                   TO MR-SELECTL (PV-SUB)         20720000
207300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20730000
207400         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20740000
207500     END-IF.                                                      20750000
207600                                                                  20760000
207700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20770000
207800                    - PV-TOP-ITEM + 1.                            20780000
207900                                                                  20790000
208000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20800000
208100         CONTINUE                                                 20810000
208200     ELSE                                                         20820000
208300         MOVE -1                   TO MR-SELECTL (PV-SUB)         20830000
208400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20840000
208500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20850000
208600     END-IF.                                                      20860000
208700                                                                  20870000
208800/                                                                 20880000
208900*----------------------------------------------------------------*20890000
209000*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *20900000
209100*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *20910000
209200*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *20920000
209300*----------------------------------------------------------------*20930000
209400                                                                  20940000
209500 3500-MARK-RANGE-AS-SELECTED.                                     20950000
209600                                                                  20960000
209700     MOVE +1                       TO ASC-BLK-SUB.                20970000
209800                                                                  20980000
209900     PERFORM 3510-MARK-SELECTED-INDS                              20990000
210000         VARYING ASC-ITEM-SUB                                     21000000
210100         FROM 1 BY 1                                              21010000
210200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21020000
210300                                                                  21030000
210400     ADD +1                        TO ASC-BLK-SUB.                21040000
210500                                                                  21050000
210600     PERFORM 3510-MARK-SELECTED-INDS                              21060000
210700         VARYING ASC-ITEM-SUB                                     21070000
210800         FROM 1 BY 1                                              21080000
210900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21090000
211000                                                                  21100000
211100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21110000
211200                                   TO PV-LIST-ITEM-NUMBER.        21120000
211300                                                                  21130000
211400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21140000
211500         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         21150000
211600               PC-ITEMS-PER-PANEL).                               21160000
211700                                                                  21170000
211800     MOVE ASC-START-OF-SELECTED-RANGE                             21180000
211900                                   TO PV-START-OF-SELECTED-RANGE. 21190000
212000                                                                  21200000
212100     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            21210000
212200         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21220000
212300               PC-ITEMS-PER-PANEL).                               21230000
212400                                                                  21240000
212500     MOVE ASC-END-OF-SELECTED-RANGE                               21250000
212600                                   TO PV-END-OF-SELECTED-RANGE.   21260000
212700                                                                  21270000
212800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21280000
212900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21290000
213000               PC-ITEMS-PER-PANEL).                               21300000
213100                                                                  21310000
213200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21320000
213300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21330000
213400                                                                  21340000
213500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21350000
213600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21360000
213700         MOVE +1                   TO ASC-BLK-SUB                 21370000
213800         PERFORM 5100-WRITE-TEMP-STORAGE                          21380000
213900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21390000
214000             PV-FIRST-BLOCK-IN-ARRAY - 1                          21400000
214100                                                                  21410000
214200         PERFORM                                                  21420000
214300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21430000
214400                   PV-PREV-BLOCK-IN-ARRAY                         21440000
214500             MOVE PV-FIRST-BLOCK-IN-RANGE                         21450000
214600                                   TO PV-BLOCK-NUMBER             21460000
214700             PERFORM 4410-READ-TEMP-STORAGE                       21470000
214800             PERFORM 3510-MARK-SELECTED-INDS                      21480000
214900                 VARYING ASC-ITEM-SUB                             21490000
215000                 FROM 1 BY 1                                      21500000
215100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21510000
215200             PERFORM 5100-WRITE-TEMP-STORAGE                      21520000
215300             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21530000
215400         END-PERFORM                                              21540000
215500                                                                  21550000
215600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21560000
215700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21570000
215800         PERFORM                                                  21580000
215900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21590000
216000                   PV-LAST-BLOCK-IN-RANGE                         21600000
216100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21610000
216200                                   TO PV-BLOCK-NUMBER             21620000
216300             PERFORM 4410-READ-TEMP-STORAGE                       21630000
216400             PERFORM 3510-MARK-SELECTED-INDS                      21640000
216500                 VARYING ASC-ITEM-SUB                             21650000
216600                 FROM 1 BY 1                                      21660000
216700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21670000
216800             PERFORM 5100-WRITE-TEMP-STORAGE                      21680000
216900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21690000
217000         END-PERFORM                                              21700000
217100                                                                  21710000
217200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21720000
217300                                   TO PV-BLOCK-NUMBER             21730000
217400         PERFORM 4410-READ-TEMP-STORAGE                           21740000
217500     END-IF.                                                      21750000
217600                                                                  21760000
217700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21770000
217800                                      ASC-END-OF-SELECTED-RANGE.  21780000
217900                                                                  21790000
218000/                                                                 21800000
218100*----------------------------------------------------------------*21810000
218200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21820000
218300*----------------------------------------------------------------*21830000
218400                                                                  21840000
218500 3510-MARK-SELECTED-INDS.                                         21850000
218600                                                                  21860000
218700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         21870000
218800         ASC-START-OF-SELECTED-RANGE)                             21880000
218900     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         21890000
219000         ASC-START-OF-SELECTED-RANGE)                             21900000
219100                                                                  21910000
219200         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     21920000
219300             ASC-END-OF-SELECTED-RANGE)                           21930000
219400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     21940000
219500             ASC-END-OF-SELECTED-RANGE)                           21950000
219600                                                                  21960000
219700             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21970000
219800                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   21980000
219900                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   21990000
220000                                   TO TRUE                        22000000
220100                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              22010000
220200                                   TO TRUE                        22020000
220300                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS22030000
220400             END-IF                                               22040000
220500         END-IF                                                   22050000
220600     END-IF.                                                      22060000
220700                                                                  22070000
220800/                                                                 22080000
220900*----------------------------------------------------------------*22090000
221000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *22100000
221100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *22110000
221200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *22120000
221300*    DISPLAY THE PANEL TO USER.                                  *22130000
221400*----------------------------------------------------------------*22140000
221500                                                                  22150000
221600 4000-BUILD-INITIAL-PANEL.                                        22160000
221700                                                                  22170000
221800     INITIALIZE ASC-BLOCK-ENTRIES (1)                             22180000
221900                ASC-BLOCK-ENTRIES (2).                            22190000
222000                                                                  22200000
222100     MOVE +1                       TO ASC-BLK-SUB.                22210000
222200                                                                  22220000
222300     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       22230000
222400                                                                  22240000
222500     MOVE +0                       TO ASC-ITEM-SUB                22250000
222600                                      ASC-NUMBER-OF-ITEMS-READ    22260000
222700                                      ASC-NUMBER-OF-SELECTED-ITEMS22270000
222800                                      ASC-HIGHEST-BLOCK-WRITTEN   22280000
222900                                      ASC-START-OF-SELECTED-RANGE 22290000
223000                                      ASC-END-OF-SELECTED-RANGE   22300000
223100                                      ASC-ITEM-AT-TOP-OF-PANEL.   22310000
223200                                                                  22320000
223300     PERFORM 4100-PREPARE-CURSOR.                                 22330000
223400                                                                  22340000
223500     PERFORM 4010-OPEN-CURSOR.                                    22350000
223600                                                                  22360000
223700     PERFORM 4300-READ-ITEMS-FROM-DB.                             22370000
223800                                                                  22380000
223900     PERFORM 4020-CLOSE-CURSOR.                                   22390000
224000                                                                  22400000
224100     MOVE +1                       TO PV-TOP-ITEM.                22410000
225400                                                                  22540000
225500     MOVE -1                   TO MR-SELECTL (1).                 22550000
225600     SET DP030-SET-CURSOR-APPL-1                                  22560000
225700                               TO TRUE.                           22570000
225800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        22580000
225900/                                                                 22590000
226000*----------------------------------------------------------------*22600000
226100* OPEN THE APPROPRIATE CURSOR                                    *22610000
226200*----------------------------------------------------------------*22620000
226300                                                                  22630000
226400 4010-OPEN-CURSOR.                                                22640000
226500                                                                  22650000
226600     PERFORM                                                      22660000
226700         WITH TEST AFTER                                          22670000
226800         VARYING PV-RETRY-COUNTER                                 22680000
226900         FROM 1 BY 1                                              22690000
227000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22700000
227100            OR (SQLCODE = +0))                                    22710000
227200                                                                  22720000
227300         EVALUATE TRUE                                            22730000
227400            WHEN  ASC-DOCK-CURSOR                                 22740000
227500                  EXEC SQL                                        22750000
227600                      OPEN DOCK-CSR                               22760000
227700                  END-EXEC                                        22770000
227800                  MOVE 'OPEN DOCK-CSR'                            22780000
227900                                   TO DP013-MESSAGE-TEXT (1)      22790000
228000                                                                  22800000
228100            WHEN  ASC-SCAC-CURSOR                                 22810000
228200                  EXEC SQL                                        22820000
228300                      OPEN SCAC-CSR                               22830000
228400                  END-EXEC                                        22840000
228500                  MOVE 'OPEN SCAC-CSR'                            22850000
228600                                   TO DP013-MESSAGE-TEXT (1)      22860000
228700                                                                  22870000
228800            WHEN  ASC-TRLR-CURSOR                                 22880000
228900                  EXEC SQL                                        22890000
229000                      OPEN TRLR-CSR                               22900000
229100                  END-EXEC                                        22910000
229200                  MOVE 'OPEN TRLR-CSR'                            22920000
229300                                   TO DP013-MESSAGE-TEXT (1)      22930000
229400                                                                  22940000
229500            WHEN  ASC-EMPTY-CURSOR                                22950000
229600                  EXEC SQL                                        22960000
229700                      OPEN EMPTY-CSR                              22970000
229800                  END-EXEC                                        22980000
229900                  MOVE 'OPEN EMPTY-CSR'                           22990000
230000                                   TO DP013-MESSAGE-TEXT (1)      23000000
230100                                                                  23010000
230200            WHEN  ASC-ETA-CURSOR                                  23020000
230300                  EXEC SQL                                        23030000
230400                      OPEN ETA-CSR                                23040000
230500                  END-EXEC                                        23050000
230600                  MOVE 'OPEN ETA-CSR'                             23060000
230700                                   TO DP013-MESSAGE-TEXT (1)      23070000
230800                                                                  23080000
230900         END-EVALUATE                                             23090000
231000                                                                  23100000
231100         EVALUATE TRUE                                            23110000
231200             WHEN SQLCODE = +0                                    23120000
231300                  CONTINUE                                        23130000
231400             WHEN SQLCODE = -904                                  23140000
231500             WHEN SQLCODE = -913                                  23150000
231600                  CONTINUE                                        23160000
231700             WHEN SQLWARN0 NOT = SPACE                            23170000
231800             WHEN SQLCODE  NOT = +0                               23180000
231900                  MOVE '4010-OPEN-CURSOR'                         23190000
232000                                   TO DP013-PARAGRAPH             23200000
232300                  MOVE SQLCA       TO DP013-SQLCA                 23230000
232400                  MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (1)    23240000
232500                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (2)    23250000
232600                  SET DP013-DB2-ABEND                             23260000
232700                                   TO TRUE                        23270000
232800                  PERFORM DP013-0000-PROCESS-ABEND                23280000
232900         END-EVALUATE                                             23290000
233000     END-PERFORM.                                                 23300000
233100                                                                  23310000
233200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23320000
233300         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             23330000
233400         MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'              23340000
233500                                   TO DP013-MESSAGE-TEXT (1)      23350000
233600         MOVE SQLCA                TO DP013-SQLCA                 23360000
233700         SET DP013-DB2-ABEND       TO TRUE                        23370000
233800         PERFORM DP013-0000-PROCESS-ABEND                         23380000
233900     END-IF.                                                      23390000
234000                                                                  23400000
234100/                                                                 23410000
234200*----------------------------------------------------------------*23420000
234300* CLOSE THE APPROPRIATE CURSOR                                   *23430000
234400*----------------------------------------------------------------*23440000
234500                                                                  23450000
234600 4020-CLOSE-CURSOR.                                               23460000
234700                                                                  23470000
234800     EVALUATE TRUE                                                23480000
234900        WHEN  ASC-DOCK-CURSOR                                     23490000
235000              EXEC SQL                                            23500000
235100                  CLOSE DOCK-CSR                                  23510000
235200              END-EXEC                                            23520000
235300                                                                  23530000
235400        WHEN  ASC-SCAC-CURSOR                                     23540000
235500              EXEC SQL                                            23550000
235600                  CLOSE SCAC-CSR                                  23560000
235700              END-EXEC                                            23570000
235800                                                                  23580000
235900        WHEN  ASC-TRLR-CURSOR                                     23590000
236000              EXEC SQL                                            23600000
236100                  CLOSE TRLR-CSR                                  23610000
236200              END-EXEC                                            23620000
236300                                                                  23630000
236400        WHEN  ASC-EMPTY-CURSOR                                    23640000
236500              EXEC SQL                                            23650000
236600                  CLOSE EMPTY-CSR                                 23660000
236700              END-EXEC                                            23670000
236800                                                                  23680000
236900        WHEN  ASC-ETA-CURSOR                                      23690000
237000              EXEC SQL                                            23700000
237100                  CLOSE ETA-CSR                                   23710000
237200              END-EXEC                                            23720000
237300                                                                  23730000
237400     END-EVALUATE.                                                23740000
237500                                                                  23750000
237600     EVALUATE TRUE                                                23760000
237700         WHEN SQLCODE = +0                                        23770000
237800              CONTINUE                                            23780000
237900         WHEN SQLWARN0 NOT = SPACE                                23790000
238000         WHEN SQLCODE  NOT = +0                                   23800000
238100              MOVE '4020-CLOSE-CURSOR'                            23810000
238200                                   TO DP013-PARAGRAPH             23820000
238300              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      23830000
238400              MOVE SQLCA           TO DP013-SQLCA                 23840000
238500              MOVE 'TVEHICL'       TO DP013-DB2-TABLE-NAME (1)    23850010
238700              SET DP013-DB2-ABEND  TO TRUE                        23870000
238800              PERFORM DP013-0000-PROCESS-ABEND                    23880000
238900     END-EVALUATE.                                                23890000
239000                                                                  23900000
239100/                                                                 23910000
239200*----------------------------------------------------------------*23920000
239300*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *23930000
239400*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *23940000
239500*----------------------------------------------------------------*23950000
239600                                                                  23960000
239700 4100-PREPARE-CURSOR.                                             23970000
239800                                                                  23980000
239900     IF  ASC-KEY-OPER-UNT-ID > ZERO                               23990000
240000         MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID-B         24000000
240100                                         DK-OPER-UNT-ID-E         24010000
240200     ELSE                                                         24020000
240300         MOVE ZEROS                   TO DK-OPER-UNT-ID-B         24030000
240400         MOVE 9999                    TO DK-OPER-UNT-ID-E         24040000
240500     END-IF.                                                      24050000
240600                                                                  24060000
240700     IF  ASC-KEY-FCLTY-ID > ZEROES                                24070000
240800         MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID-B                24080000
240900                                     DK-FCLTY-ID-E                24090000
241000     ELSE                                                         24100000
241100         MOVE ZEROES              TO DK-FCLTY-ID-B                24110000
241200         MOVE 9999                TO DK-FCLTY-ID-E                24120000
241300     END-IF.                                                      24130000
241400                                                                  24140000
241500     IF  ASC-KEY-FCLTY-AREA-ID > SPACES                           24150000
241600         MOVE ASC-KEY-FCLTY-AREA-ID TO DK-FCLTY-AREA-ID-B         24160000
241700                                       DK-FCLTY-AREA-ID-E         24170000
241800     ELSE                                                         24180000
241900         MOVE SPACES                TO DK-FCLTY-AREA-ID-B         24190000
242000         MOVE '999999'              TO DK-FCLTY-AREA-ID-E         24200000
242100     END-IF.                                                      24210000
242200                                                                  24220000
242300     IF  ASC-KEY-SUBAREA-OF-ID > SPACES                           24230000
242400         MOVE ASC-KEY-SUBAREA-OF-ID TO DK-SUBAREA-OF-ID-B         24240000
242500                                       DK-SUBAREA-OF-ID-E         24250000
242600     ELSE                                                         24260000
242700         MOVE SPACES                TO DK-SUBAREA-OF-ID-B         24270000
242800         MOVE '999999'              TO DK-SUBAREA-OF-ID-E         24280000
242900     END-IF.                                                      24290000
243000                                                                  24300000
243100     IF  ASC-KEY-DEST-OPER-UNT-ID > ZEROS                         24310000
243200         MOVE ASC-KEY-DEST-OPER-UNT-ID  TO DK-DEST-OPER-UNT-ID-B  24320000
243300                                           DK-DEST-OPER-UNT-ID-E  24330000
243400     ELSE                                                         24340000
243500         MOVE ZEROS                     TO DK-DEST-OPER-UNT-ID-B  24350000
243600         MOVE 9999                      TO DK-DEST-OPER-UNT-ID-E  24360000
243700     END-IF.                                                      24370000
243800                                                                  24380000
243900     IF  ASC-KEY-DEST-FCLTY-ID > ZEROES                           24390000
244000         MOVE ASC-KEY-DEST-FCLTY-ID     TO DK-DEST-FCLTY-ID-B     24400000
244100                                           DK-DEST-FCLTY-ID-E     24410000
244200     ELSE                                                         24420000
244300         MOVE ZEROES                    TO DK-DEST-FCLTY-ID-B     24430000
244400         MOVE 9999                      TO DK-DEST-FCLTY-ID-E     24440000
244500     END-IF.                                                      24450000
244600                                                                  24460000
244700     IF  ASC-KEY-STATUS-IND-1 = SPACES                            24470000
244800     AND ASC-KEY-STATUS-IND-2 = SPACES                            24480000
244900     AND ASC-KEY-STATUS-IND-3 = SPACES                            24490000
245000     AND ASC-KEY-STATUS-IND-4 = SPACES                            24500000
245100     AND ASC-KEY-STATUS-IND-5 = SPACES                            24510000
245200         MOVE SPACES                  TO DK-STATUS-IND-B          24520000
245300         MOVE '99'                    TO DK-STATUS-IND-E          24530000
245400     ELSE                                                         24540000
245500         MOVE ASC-KEY-STATUS-IND-1    TO DK-STATUS-IND-1          24550000
245600         MOVE ASC-KEY-STATUS-IND-2    TO DK-STATUS-IND-2          24560000
245700         MOVE ASC-KEY-STATUS-IND-3    TO DK-STATUS-IND-3          24570000
245800         MOVE ASC-KEY-STATUS-IND-4    TO DK-STATUS-IND-4          24580000
245900         MOVE ASC-KEY-STATUS-IND-5    TO DK-STATUS-IND-5          24590000
246000         MOVE '99'                    TO DK-STATUS-IND-B          24600000
246100         MOVE '99'                    TO DK-STATUS-IND-E          24610000
246200     END-IF.                                                      24620000
246300                                                                  24630000
246400     IF  ASC-KEY-STATUS-IND-1 = 'AG'                              24640000
246500      OR ASC-KEY-STATUS-IND-2 = 'AG'                              24650000
246600      OR ASC-KEY-STATUS-IND-3 = 'AG'                              24660000
246700      OR ASC-KEY-STATUS-IND-4 = 'AG'                              24670000
246800      OR ASC-KEY-STATUS-IND-5 = 'AG'                              24680000
246900         MOVE SPACES                  TO DK-STATUS-IND-1          24690000
247000         MOVE SPACES                  TO DK-STATUS-IND-2          24700000
247100         MOVE SPACES                  TO DK-STATUS-IND-3          24710000
247200         MOVE SPACES                  TO DK-STATUS-IND-4          24720000
247300         MOVE SPACES                  TO DK-STATUS-IND-5          24730000
247400         MOVE SPACES                  TO DK-STATUS-IND-B          24740000
247500         MOVE '99'                    TO DK-STATUS-IND-E          24750000
247600     END-IF.                                                      24760000
247700                                                                  24770000
247800     IF  ASC-KEY-SCHD-FROM-DTE > SPACES                           24780000
247900         MOVE ASC-KEY-SCHD-FROM-DTE TO PV-ETA-DTE-B               24790000
248000                                       DK-SCHD-FROM-DTE           24800000
248100         MOVE PV-ETA-TMST-B         TO DK-ETA-TMST-B              24810000
248200     ELSE                                                         24820000
248300         MOVE '0001-01-01-00.00.00.000000'                        24830000
248400                                    TO DK-ETA-TMST-B              24840000
248500         MOVE '0001-01-01'          TO DK-SCHD-FROM-DTE           24850000
248600     END-IF.                                                      24860000
248700                                                                  24870000
248800     IF  ASC-KEY-SCHD-TO-DTE > SPACES                             24880000
248900         MOVE ASC-KEY-SCHD-TO-DTE   TO PV-ETA-DTE-E               24890000
249000                                       DK-SCHD-TO-DTE             24900000
249100         MOVE PV-ETA-TMST-E         TO DK-ETA-TMST-E              24910000
249200     ELSE                                                         24920000
249300         MOVE '9999-12-31-24.00.00.000000'                        24930000
249400                                    TO DK-ETA-TMST-E              24940000
249500         MOVE '9999-12-31'          TO DK-SCHD-TO-DTE             24950000
249600     END-IF.                                                      24960000
249700                                                                  24970000
249800     IF  ASC-KEY-USAGE-IND-1 = SPACES                             24980000
249900     AND ASC-KEY-USAGE-IND-2 = SPACES                             24990000
250000     AND ASC-KEY-USAGE-IND-3 = SPACES                             25000000
250100         MOVE SPACES                  TO DK-USAGE-IND-B           25010000
250200         MOVE '999'                   TO DK-USAGE-IND-E           25020000
250300     ELSE                                                         25030000
250400         MOVE ASC-KEY-USAGE-IND-1     TO DK-USAGE-IND-1           25040000
250500         MOVE ASC-KEY-USAGE-IND-2     TO DK-USAGE-IND-2           25050000
250600         MOVE ASC-KEY-USAGE-IND-3     TO DK-USAGE-IND-3           25060000
250700         MOVE '999'                   TO DK-USAGE-IND-B           25070000
250800         MOVE '999'                   TO DK-USAGE-IND-E           25080000
250900     END-IF.                                                      25090000
251000                                                                  25100000
251100     IF  ASC-KEY-OWNER-SCAC-ID > SPACES                           25110000
251200         MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID-B         25120000
251300                                       DK-OWNER-SCAC-ID-E         25130000
251400     ELSE                                                         25140000
251500         MOVE SPACES                TO DK-OWNER-SCAC-ID-B         25150000
251600         MOVE '9999'                TO DK-OWNER-SCAC-ID-E         25160000
251700     END-IF.                                                      25170000
251800                                                                  25180000
251900     IF  ASC-KEY-VEH-NBR > SPACES                                 25190000
252000         MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR-B               25200000
252100                                       DK-VEH-NBR-E               25210000
252200     ELSE                                                         25220000
252300         MOVE SPACES                TO DK-VEH-NBR-B               25230000
252400         MOVE '9999999999'          TO DK-VEH-NBR-E               25240000
252500     END-IF.                                                      25250000
252600                                                                  25260000
252700*----------------------------------------------------------------*25270000
252800*    DECIDE WHICH OF THE FOUR  CURSORS WILL BE USED BASED ON     *25280000
252900*    CRITERIA PASSED.                                            *25290000
253000*----------------------------------------------------------------*25300000
253100                                                                  25310000
253200     EVALUATE TRUE                                                25320000
253300                                                                  25330000
253400        WHEN (ASC-KEY-STATUS-IND-1 = 'AG'                         25340000
253500          OR  ASC-KEY-STATUS-IND-2 = 'AG'                         25350000
253600          OR  ASC-KEY-STATUS-IND-3 = 'AG'                         25360000
253700          OR  ASC-KEY-STATUS-IND-4 = 'AG'                         25370000
253800          OR  ASC-KEY-STATUS-IND-5 = 'AG')                        25380000
253900              SET ASC-ETA-CURSOR  TO TRUE                         25390000
254000                                                                  25400000
254100        WHEN (ASC-KEY-STATUS-IND-1 = 'ET'                         25410000
254200          OR  ASC-KEY-STATUS-IND-2 = 'ET'                         25420000
254300          OR  ASC-KEY-STATUS-IND-3 = 'ET'                         25430000
254400          OR  ASC-KEY-STATUS-IND-4 = 'ET'                         25440000
254500          OR  ASC-KEY-STATUS-IND-5 = 'ET')                        25450000
254600              SET ASC-EMPTY-CURSOR TO TRUE                        25460000
254700                                                                  25470000
254800        WHEN ((ASC-KEY-FCLTY-AREA-ID > SPACES                     25480000
254900          OR  ASC-KEY-SUBAREA-OF-ID > SPACES)                     25490000
255000         AND  ASC-KEY-STATUS-IND-1 NOT = 'ET'                     25500000
255100         AND  ASC-KEY-STATUS-IND-2 NOT = 'ET'                     25510000
255200         AND  ASC-KEY-STATUS-IND-3 NOT = 'ET'                     25520000
255300         AND  ASC-KEY-STATUS-IND-4 NOT = 'ET'                     25530000
255400         AND  ASC-KEY-STATUS-IND-5 NOT = 'ET')                    25540000
255500                SET ASC-DOCK-CURSOR TO TRUE                       25550000
255600                                                                  25560000
255700        WHEN ((ASC-KEY-OWNER-SCAC-ID > SPACES                     25570000
255800          OR  ASC-KEY-VEH-NBR       > SPACES)                     25580000
255900         AND  ASC-KEY-STATUS-IND-1 NOT = 'ET'                     25590000
256000         AND  ASC-KEY-STATUS-IND-2 NOT = 'ET'                     25600000
256100         AND  ASC-KEY-STATUS-IND-3 NOT = 'ET'                     25610000
256200         AND  ASC-KEY-STATUS-IND-4 NOT = 'ET'                     25620000
256300         AND  ASC-KEY-STATUS-IND-5 NOT = 'ET')                    25630000
256400                SET ASC-SCAC-CURSOR TO TRUE                       25640000
256500                                                                  25650000
256600        WHEN (ASC-KEY-STATUS-IND-1 > SPACES                       25660000
256700          OR  ASC-KEY-STATUS-IND-2 > SPACES                       25670000
256800          OR  ASC-KEY-STATUS-IND-3 > SPACES                       25680000
256900          OR  ASC-KEY-STATUS-IND-4 > SPACES                       25690000
257000          OR  ASC-KEY-STATUS-IND-5 > SPACES)                      25700000
257100                SET ASC-TRLR-CURSOR TO TRUE                       25710000
257200                                                                  25720000
257300        WHEN OTHER                                                25730000
257400                SET ASC-TRLR-CURSOR TO TRUE                       25740000
257500                                                                  25750000
257600     END-EVALUATE.                                                25760000
257700                                                                  25770000
257800/                                                                 25780000
257900*----------------------------------------------------------------*25790000
258000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *25800000
258100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *25810000
258200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *25820000
258300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *25830000
258400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *25840000
258500*                                                                *25850000
258600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *25860000
258700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *25870000
258800*    UPON INITIALIZATION.                                        *25880000
258900*----------------------------------------------------------------*25890000
259000                                                                  25900000
259100 4300-READ-ITEMS-FROM-DB.                                         25910000
259200                                                                  25920000
259300     PERFORM                                                      25930000
259400         VARYING PV-READ-COUNT                                    25940000
259500         FROM 1 BY 1                                              25950000
259600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    25960000
259700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         25970000
259800                                                                  25980000
259900         PERFORM 4310-FETCH                                       25990000
260000                                                                  26000000
260100         IF  ASC-ITEMS-LEFT-ON-DB                                 26010000
260200             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                26020000
260300                 ADD +1            TO ASC-ITEM-SUB                26030000
260400             ELSE                                                 26040000
260500                 ADD +1            TO ASC-BLK-SUB                 26050000
260600                 MOVE +1           TO ASC-ITEM-SUB                26060000
260700                                                                  26070000
260800                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         26080000
260900                     MOVE +1       TO ASC-BLK-SUB                 26090000
261000                     SET ASC-BLOCK-MODIFIED (1)                   26100000
261100                                   TO TRUE                        26110000
261200                     PERFORM 5100-WRITE-TEMP-STORAGE              26120000
261300                     MOVE ASC-BLOCK-ENTRIES                       26130000
261400                               (PC-MAX-BLOCKS-IN-ARRAY)           26140000
261500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26150000
261600                     ADD +1        TO ASC-BLK-SUB                 26160000
261700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26170000
261800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26180000
261900                                   TO TRUE                        26190000
262000                 END-IF                                           26200000
262100             END-IF                                               26210000
262200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26220000
262300             MOVE ASC-NUMBER-OF-ITEMS-READ                        26230000
262400                                   TO ASC-LIST-ITEM-NUMBER        26240000
262500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26250000
262600             MOVE VEHICL-OWNER-SCAC-ID                            26260000
262700                                   TO ASC-CARR-SCAC-CDE           26270000
262800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26280000
262900             MOVE VEHICL-VEH-NBR   TO ASC-TRLR-NBR                26290000
263000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26300000
263100             MOVE VHTRIP-MANIFEST-NBR                             26310000
263200                                   TO ASC-MANIFEST                26320000
263300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26330000
263400             MOVE VEHICL-USAGE-CDE TO ASC-USE                     26340000
263500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26350000
263600             MOVE VEHICL-VEH-SIZE-CDE TO ASC-LGTH                 26360000
263700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26370000
263800             MOVE TRIPST-TRIP-STATUS-CDE                          26380000
263900                                   TO ASC-STAT                    26390000
264000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26400000
264010             MOVE TRIPST-STATUS-UID                               26401003
264020                                   TO ASC-STAT-USERID             26402003
264030                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26403003
264100             MOVE TRIPST-OPER-UNT-ID                              26410000
264200                                   TO PV-DEST-OPER                26420000
264400             MOVE PV-DEST          TO ASC-DEST                    26440000
264500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26450000
264600             COMPUTE PV-TRIP-STOP-NBR = VHTRIP-PLND-TRIP-SEQ + 1  26460000
264700             MOVE PV-TRIP-STOP-NBR TO ASC-TRIP-STOP               26470000
264800                                (ASC-BLK-SUB ASC-ITEM-SUB)        26480000
264900             MOVE VEHICL-CURR-OPER-UNT-ID                         26490000
265000                                   TO PV-CURR-OPER                26500000
265300             MOVE PV-CURR-LOC      TO ASC-CURR-LOC-1              26530000
265400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26540000
265500             MOVE VEHICL-CURR-FAC-AREA-ID                         26550000
265600                                   TO ASC-CURR-LOC-2              26560000
265700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26570000
265800                                                                  26580000
265900             MOVE VHTRIP-TRIP-ID   TO ASC-TRIP-ID                 26590000
266000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26600000
266100                                      DK-TRIP-ID                  26610000
266200                                                                  26620000
267100             IF  DN-EST-AR-TMST = -1                              26710000
267200                 MOVE SPACES       TO ASC-ETA-DTE-TME             26720000
267300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26730000
267400             ELSE                                                 26740000
267500                 MOVE VHTRIP-EST-AR-TMST                          26750000
267600                                       TO PV-ETA-TMST             26760015
267700                 MOVE PV-ETA-YY        TO PV-ETA-DT-YY            26770014
267710                 MOVE PV-ETA-MM        TO PV-ETA-DT-MM            26771014
267800                 MOVE PV-ETA-DD        TO PV-ETA-DT-DD            26780000
267900                 MOVE PV-ETA-HH-MM     TO PV-ETA-DT-HH-MM         26790000
268000                 MOVE PV-ETA-DTE-TME   TO ASC-ETA-DTE-TME         26800000
268100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26810000
268200             END-IF                                               26820000
268300             MOVE TRIPST-OPER-UNT-ID                              26830000
268400                                   TO ASC-DEST-OPER-UNT-ID        26840000
268500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26850000
268600             MOVE VEHICL-CURR-OPER-UNT-ID                         26860000
268700                                   TO ASC-OPER-UNT-ID             26870000
268800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26880000
268900             MOVE TRIPST-FCLTY-ID                                 26890000
269000                                   TO ASC-DEST-FCLTY-ID           26900000
269100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26910000
269200             MOVE VEHICL-CURR-FCLTY-ID                            26920000
269300                                   TO ASC-FCLTY-ID                26930000
269400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26940000
269500         END-IF                                                   26950000
269600     END-PERFORM.                                                 26960000
269700                                                                  26970000
269800     MOVE VEHICL-CURR-FCLTY-ID     TO DK-FCLTY-ID-B.              26980000
269900     PERFORM 4320-GET-FCLTY-NAME.                                 26990000
270000                                                                  27000000
270100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          27010000
270200         MOVE +1                   TO ASC-BLK-SUB                 27020000
270300         PERFORM 5100-WRITE-TEMP-STORAGE                          27030000
270400         ADD +1                    TO ASC-BLK-SUB                 27040000
270500         PERFORM 5100-WRITE-TEMP-STORAGE                          27050000
270600                                                                  27060000
270700         MOVE 1                    TO ASC-BLK-SUB                 27070000
270800                                      PV-BLOCK-NUMBER             27080000
270900         PERFORM 4410-READ-TEMP-STORAGE                           27090000
271000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27100000
271100             MOVE 2                TO ASC-BLK-SUB                 27110000
271200                                      PV-BLOCK-NUMBER             27120000
271300             PERFORM 4410-READ-TEMP-STORAGE                       27130000
271400         END-IF                                                   27140000
271500     END-IF.                                                      27150000
271600                                                                  27160000
271700/                                                                 27170000
271800*----------------------------------------------------------------*27180000
271900*    FETCH A VEHICLE ROW                                         *27190000
272000*----------------------------------------------------------------*27200000
272100                                                                  27210000
272200 4310-FETCH.                                                      27220000
272300                                                                  27230000
272400     EVALUATE TRUE                                                27240000
272500        WHEN  ASC-DOCK-CURSOR                                     27250000
272600              EXEC SQL                                            27260000
272700                  FETCH DOCK-CSR                                  27270000
272800                   INTO :VEHICL-CURR-OPER-UNT-ID                  27280000
272900                       ,:VEHICL-CURR-FCLTY-ID                     27290000
273000                       ,:VEHICL-CURR-FAC-AREA-ID                  27300000
273100                       ,:VEHICL-OWNER-SCAC-ID                     27310000
273200                       ,:VEHICL-VEH-NBR                           27320000
273300                       ,:VEHICL-USAGE-CDE                         27330000
273400                       ,:VEHICL-VEH-SIZE-CDE                      27340000
273500                       ,:VEHICL-CURR-STATUS-CDE                   27350000
273600                       ,:VEHICL-CURR-STATUS-DTE                   27360000
273700                       ,:VEHICL-CURR-STATUS-TME                   27370000
273800                       ,:VHTRIP-TRIP-ID                           27380000
273900                       ,:VHTRIP-MANIFEST-NBR                      27390000
274000                       ,:VHTRIP-PLND-TRIP-SEQ                     27400000
274100                       ,:VHTRIP-REF-TRIP-ID                       27410000
274200                       ,:TRIPST-OPER-UNT-ID                       27420000
274300                       ,:TRIPST-FCLTY-ID                          27430000
274400                       ,:TRIPST-FCLTY-AREA-ID                     27440000
274500                       ,:VHTRIP-EST-AR-TMST :DN-EST-AR-TMST       27450000
274600              END-EXEC                                            27460000
274700                                                                  27470000
274800        WHEN  ASC-SCAC-CURSOR                                     27480000
274900              EXEC SQL                                            27490000
275000                  FETCH SCAC-CSR                                  27500000
275100                   INTO :VEHICL-CURR-OPER-UNT-ID                  27510000
275200                       ,:VEHICL-CURR-FCLTY-ID                     27520000
275300                       ,:VEHICL-CURR-FAC-AREA-ID                  27530000
275400                       ,:VEHICL-OWNER-SCAC-ID                     27540000
275500                       ,:VEHICL-VEH-NBR                           27550000
275600                       ,:VEHICL-USAGE-CDE                         27560000
275700                       ,:VEHICL-VEH-SIZE-CDE                      27570000
275800                       ,:VEHICL-CURR-STATUS-CDE                   27580000
275900                       ,:VEHICL-CURR-STATUS-DTE                   27590000
276000                       ,:VEHICL-CURR-STATUS-TME                   27600000
276100                       ,:VHTRIP-TRIP-ID                           27610000
276200                       ,:VHTRIP-MANIFEST-NBR                      27620000
276300                       ,:VHTRIP-PLND-TRIP-SEQ                     27630000
276400                       ,:VHTRIP-REF-TRIP-ID                       27640000
276500                       ,:TRIPST-OPER-UNT-ID                       27650000
276600                       ,:TRIPST-FCLTY-ID                          27660000
276700                       ,:TRIPST-FCLTY-AREA-ID                     27670000
276800                       ,:VHTRIP-EST-AR-TMST :DN-EST-AR-TMST       27680000
276900              END-EXEC                                            27690000
277000                                                                  27700000
277100        WHEN  ASC-TRLR-CURSOR                                     27710000
277200              EXEC SQL                                            27720000
277300                  FETCH TRLR-CSR                                  27730000
277400                   INTO :VEHICL-CURR-OPER-UNT-ID                  27740000
277500                       ,:VEHICL-CURR-FCLTY-ID                     27750000
277600                       ,:VEHICL-CURR-FAC-AREA-ID                  27760000
277700                       ,:VEHICL-OWNER-SCAC-ID                     27770000
277800                       ,:VEHICL-VEH-NBR                           27780000
277900                       ,:VEHICL-USAGE-CDE                         27790000
278000                       ,:VEHICL-VEH-SIZE-CDE                      27800000
278100                       ,:VEHICL-CURR-STATUS-CDE                   27810000
278200                       ,:VEHICL-CURR-STATUS-DTE                   27820000
278300                       ,:VEHICL-CURR-STATUS-TME                   27830000
278400                       ,:VHTRIP-TRIP-ID                           27840000
278500                       ,:VHTRIP-MANIFEST-NBR                      27850000
278600                       ,:VHTRIP-PLND-TRIP-SEQ                     27860000
278700                       ,:VHTRIP-REF-TRIP-ID                       27870000
278800                       ,:TRIPST-OPER-UNT-ID                       27880000
278900                       ,:TRIPST-FCLTY-ID                          27890000
279000                       ,:TRIPST-FCLTY-AREA-ID                     27900000
279100                       ,:VHTRIP-EST-AR-TMST :DN-EST-AR-TMST       27910000
279200              END-EXEC                                            27920000
279300                                                                  27930000
279400        WHEN  ASC-ETA-CURSOR                                      27940000
279500              EXEC SQL                                            27950000
279600                  FETCH ETA-CSR                                   27960000
279700                   INTO :VEHICL-CURR-OPER-UNT-ID                  27970000
279800                       ,:VEHICL-CURR-FCLTY-ID                     27980000
279900                       ,:VEHICL-CURR-FAC-AREA-ID                  27990000
280000                       ,:VEHICL-OWNER-SCAC-ID                     28000000
280100                       ,:VEHICL-VEH-NBR                           28010000
280200                       ,:VEHICL-USAGE-CDE                         28020000
280300                       ,:VEHICL-VEH-SIZE-CDE                      28030000
280400                       ,:VEHICL-CURR-STATUS-CDE                   28040000
280500                       ,:VEHICL-CURR-STATUS-DTE                   28050000
280600                       ,:VEHICL-CURR-STATUS-TME                   28060000
280700                       ,:VHTRIP-TRIP-ID                           28070000
280800                       ,:VHTRIP-MANIFEST-NBR                      28080000
280900                       ,:VHTRIP-PLND-TRIP-SEQ                     28090000
281000                       ,:VHTRIP-REF-TRIP-ID                       28100000
281100                       ,:TRIPST-OPER-UNT-ID                       28110000
281200                       ,:TRIPST-FCLTY-ID                          28120000
281300                       ,:TRIPST-FCLTY-AREA-ID                     28130000
281400                       ,:VHTRIP-EST-AR-TMST :DN-EST-AR-TMST       28140000
281500              END-EXEC                                            28150000
281600                                                                  28160000
281700        WHEN  ASC-EMPTY-CURSOR                                    28170000
281800              EXEC SQL                                            28180000
281900                  FETCH EMPTY-CSR                                 28190000
282000                   INTO :VEHICL-CURR-OPER-UNT-ID                  28200000
282100                       ,:VEHICL-CURR-FCLTY-ID                     28210000
282200                       ,:VEHICL-CURR-FAC-AREA-ID                  28220000
282300                       ,:VEHICL-OWNER-SCAC-ID                     28230000
282400                       ,:VEHICL-VEH-NBR                           28240000
282500                       ,:VEHICL-USAGE-CDE                         28250000
282600                       ,:VEHICL-VEH-SIZE-CDE                      28260000
282700                       ,:VEHICL-CURR-STATUS-CDE                   28270000
282800                       ,:VEHICL-CURR-STATUS-DTE                   28280000
282900                       ,:VEHICL-CURR-STATUS-TME                   28290000
283000                       ,:VHTRIP-TRIP-ID                           28300000
283100                       ,:VHTRIP-MANIFEST-NBR                      28310000
283200                       ,:VHTRIP-PLND-TRIP-SEQ                     28320000
283300                       ,:VHTRIP-REF-TRIP-ID                       28330000
283400                       ,:TRIPST-OPER-UNT-ID                       28340000
283500                       ,:TRIPST-FCLTY-ID                          28350000
283600                       ,:TRIPST-FCLTY-AREA-ID                     28360000
283700                       ,:VHTRIP-EST-AR-TMST :DN-EST-AR-TMST       28370000
283800              END-EXEC                                            28380000
283900              MOVE -1                     TO DN-EST-AR-TMST       28390000
284000                                                                  28400000
284100     END-EVALUATE.                                                28410000
284200                                                                  28420000
284300     EVALUATE TRUE                                                28430000
284400         WHEN SQLCODE = +0                                        28440000
284500              MOVE VHTRIP-TRIP-ID    TO DK-TRIP-ID                28450000
284600              PERFORM 4360-GET-MAX-TRIP-STATUS                    28460000
284700                                                                  28470000
284800              IF ASC-EMPTY-CURSOR                                 28480000
284900                  MOVE  VEHICL-CURR-STATUS-CDE  TO                28490000
285000                           TRIPST-TRIP-STATUS-CDE                 28500000
285100              END-IF                                              28510000
285200                                                                  28520000
285300         WHEN SQLCODE = +100                                      28530000
285400              SET ASC-NO-ITEMS-LEFT-ON-DB                         28540000
285500                                   TO TRUE                        28550000
285600                                                                  28560000
285700         WHEN SQLWARN0 NOT = SPACE                                28570000
285800         WHEN SQLCODE < +0                                        28580000
285900         WHEN SQLCODE > +0                                        28590000
286000              MOVE '4310-FETCH-CURSOR'                            28600000
286100                                   TO DP013-PARAGRAPH             28610000
286200              MOVE 'FETCH TRAILER CURSOR'                         28620000
286300                                   TO DP013-MESSAGE-TEXT (1)      28630000
286400              MOVE SQLCA           TO DP013-SQLCA                 28640000
286500              MOVE 'TTRIPST'       TO DP013-DB2-TABLE-NAME (1)    28650000
286600              MOVE 'TTRSTTP'       TO DP013-DB2-TABLE-NAME (2)    28660000
286700              SET DP013-DB2-ABEND  TO TRUE                        28670000
286800              PERFORM DP013-0000-PROCESS-ABEND                    28680000
286900     END-EVALUATE.                                                28690000
287000                                                                  28700000
287100/                                                                 28710000
287200*----------------------------------------------------------------*28720000
287300*    GET THE FACILITY NAME                                       *28730000
287400*----------------------------------------------------------------*28740000
287500 4320-GET-FCLTY-NAME.                                             28750000
287600                                                                  28760000
287700     PERFORM                                                      28770000
287800         WITH TEST AFTER                                          28780000
287900         VARYING PV-RETRY-COUNTER                                 28790000
288000         FROM 1 BY 1                                              28800000
288100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28810000
288200             OR (SQLCODE = +0)                                    28820000
288300             OR (SQLCODE = +100))                                 28830000
288400                                                                  28840000
288500         EXEC SQL                                                 28850000
288600              SELECT FCLTY_NME                                    28860000
288700                INTO :FACLTY-FCLTY-NME                            28870000
288800                FROM TFACLTY                                      28880000
288900               WHERE OPER_UNT_ID = :DK-OPER-UNT-ID                28890000
289000                 AND FCLTY_ID    = :DK-FCLTY-ID-B                 28900000
289100         END-EXEC                                                 28910000
289200                                                                  28920000
289300         EVALUATE TRUE                                            28930000
289400             WHEN SQLCODE = +0                                    28940000
289500                  MOVE FACLTY-FCLTY-NME                           28950000
289600                                  TO ASC-FCLTY-NME                28960000
289700                                                                  28970000
289800             WHEN SQLCODE = +100                                  28980000
289900                  MOVE SPACES     TO ASC-FCLTY-NME                28990000
290000                                                                  29000000
290100             WHEN SQLCODE = -904                                  29010000
290200             WHEN SQLCODE = -913                                  29020000
290300                  CONTINUE                                        29030000
290400                                                                  29040000
290500             WHEN SQLWARN0 NOT = SPACES                           29050000
290600             WHEN SQLCODE < +0                                    29060000
290700             WHEN SQLCODE > +0                                    29070000
290800                  MOVE '4320-GET-FCLTY-NAME'                      29080000
290900                                  TO DP013-PARAGRAPH              29090000
291000                  MOVE 'UNSUCCESSFUL SELECT ON FACILITY TABLE'    29100000
291100                                  TO DP013-MESSAGE-TEXT (1)       29110000
291200                  MOVE SQLCA      TO DP013-SQLCA                  29120000
291300                  MOVE 'TFACLTY ' TO DP013-DB2-TABLE-NAME (1)     29130000
291400                  SET DP013-DB2-ABEND                             29140000
291500                      DP013-XCTL-DISPLAY-RESTART                  29150000
291600                                  TO TRUE                         29160000
291700                  PERFORM DP013-0000-PROCESS-ABEND                29170000
291800         END-EVALUATE                                             29180000
291900     END-PERFORM.                                                 29190000
292000                                                                  29200000
292100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29210000
292200         MOVE '4320-GET-FCLTY-NAME'                               29220000
292300                                  TO DP013-PARAGRAPH              29230000
292400         MOVE 'MAX RETRIES EXCEEDED ON SELECT FACILITY TABLE'     29240000
292500                                  TO DP013-MESSAGE-TEXT (1)       29250000
292600         MOVE SQLCA               TO DP013-SQLCA                  29260000
292700         MOVE 'TFACLTY'           TO DP013-DB2-TABLE-NAME (1)     29270000
292800         SET DP013-DB2-ABEND                                      29280000
292900             DP013-XCTL-DISPLAY-RESTART                           29290000
293000                                  TO TRUE                         29300000
293100         PERFORM DP013-0000-PROCESS-ABEND                         29310000
293200     END-IF.                                                      29320000
293300                                                                  29330000
293400/                                                                 29340000
312000*----------------------------------------------------------------*31200000
312100*    GET THE HIGHEST STATUS CODE FOR TRIP                        *31210000
312200*----------------------------------------------------------------*31220000
312300 4360-GET-MAX-TRIP-STATUS.                                        31230000
312400                                                                  31240000
312500     PERFORM                                                      31250000
312600         WITH TEST AFTER                                          31260000
312700         VARYING PV-RETRY-COUNTER                                 31270000
312800         FROM 1 BY 1                                              31280000
312900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31290000
313000             OR (SQLCODE = +0)                                    31300000
313100             OR (SQLCODE = +100))                                 31310000
313200                                                                  31320000
313300         EXEC SQL                                                 31330000
313400           SELECT DISTINCT                                        31340000
313500                  A.TRIP_STATUS_CDE                               31350000
313510                 ,A.STATUS_UID                                    31351005
313600           INTO   :TRIPST-TRIP-STATUS-CDE                         31360000
313610                 ,:TRIPST-STATUS-UID                              31361004
313700           FROM   TTRIPST A                                       31370000
313800                 ,TTRSTYP B                                       31380000
313900           WHERE  A.TRIP_ID     = :DK-TRIP-ID                     31390000
314000             AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE           31400000
314100             AND  B.PRTY_CDE =                                    31410000
314200                 (SELECT DISTINCT                                 31420000
314300                      MAX(D.PRTY_CDE)                             31430000
314400                   FROM   TTRIPST C                               31440000
314500                         ,TTRSTYP D                               31450000
314600                   WHERE  C.TRIP_ID     = :DK-TRIP-ID             31460000
314700                     AND  C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  31470000
314800         END-EXEC                                                 31480000
314900                                                                  31490000
315000         EVALUATE TRUE                                            31500000
315100             WHEN SQLCODE = +0                                    31510000
315200                  CONTINUE                                        31520000
315300             WHEN SQLCODE = +100                                  31530000
315400             WHEN SQLCODE = -904                                  31540000
315500             WHEN SQLCODE = -913                                  31550000
315600                  CONTINUE                                        31560000
315700                                                                  31570000
315800             WHEN SQLWARN0 NOT = SPACES                           31580000
315900             WHEN SQLCODE < +0                                    31590000
316000             WHEN SQLCODE > +0                                    31600000
316100                  MOVE '4360-GET-MAX-TRIP-STATUS'                 31610000
316200                                  TO DP013-PARAGRAPH              31620000
316300                  MOVE 'UNSUCCESSFUL SELECT ON TTRIPST TABLE'     31630000
316400                                  TO DP013-MESSAGE-TEXT (1)       31640000
316500                  MOVE SQLCA      TO DP013-SQLCA                  31650000
316600                  MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (1)     31660000
316700                  SET DP013-DB2-ABEND                             31670000
316800                      DP013-XCTL-DISPLAY-RESTART                  31680000
316900                                  TO TRUE                         31690000
317000                  PERFORM DP013-0000-PROCESS-ABEND                31700000
317100         END-EVALUATE                                             31710000
317200     END-PERFORM.                                                 31720000
317300                                                                  31730000
317400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31740000
317500         MOVE '4360-GET-MAX-TRIP-STATUS' TO DP013-PARAGRAPH       31750000
317600         MOVE 'SELECT ERROR'      TO DP013-MESSAGE-TEXT (1)       31760000
317700         MOVE SQLCA               TO DP013-SQLCA                  31770000
317800         MOVE 'TTRIPST & TTRSTYP' TO DP013-DB2-TABLE-NAME (1)     31780000
317900         SET DP013-DB2-ABEND                                      31790000
318000             DP013-XCTL-DISPLAY-RESTART                           31800000
318100                                  TO TRUE                         31810000
318200         PERFORM DP013-0000-PROCESS-ABEND                         31820000
318300     END-IF.                                                      31830000
318400                                                                  31840000
318500/                                                                 31850000
318600*----------------------------------------------------------------*31860000
318700* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31870000
318800*----------------------------------------------------------------*31880000
318900                                                                  31890000
319000 4400-MOVE-COMMAREA-TO-SCREEN.                                    31900000
319100                                                                  31910000
319200     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             31920000
319300         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          31930000
319400         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          31940000
319500             MOVE +1               TO ASC-BLK-SUB                 31950000
319600             PERFORM 5100-WRITE-TEMP-STORAGE                      31960000
319700             ADD +1                TO ASC-BLK-SUB                 31970000
319800             PERFORM 5100-WRITE-TEMP-STORAGE                      31980000
319900             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             31990000
320000                 GIVING PV-BLOCK-NUMBER                           32000000
320100                 REMAINDER PV-REMAINDER                           32010000
320200             IF  PV-REMAINDER > ZERO                              32020000
320300                 ADD +1            TO PV-BLOCK-NUMBER             32030000
320400             END-IF                                               32040000
320500             MOVE +1               TO ASC-BLK-SUB                 32050000
320600             PERFORM 4410-READ-TEMP-STORAGE                       32060000
320700             ADD +1                TO ASC-BLK-SUB                 32070000
320800                                      PV-BLOCK-NUMBER             32080000
320900             PERFORM 4410-READ-TEMP-STORAGE                       32090000
321000     END-IF.                                                      32100000
321100                                                                  32110000
321200     MOVE +1                       TO ASC-BLK-SUB.                32120000
321300                                                                  32130000
321400     COMPUTE ASC-ITEM-SUB =                                       32140000
321500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              32150000
321600         + PC-ITEMS-PER-PANEL).                                   32160000
321700                                                                  32170000
321800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        32180000
321900         ADD +1                    TO ASC-BLK-SUB                 32190000
322000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            32200000
322100     END-IF.                                                      32210000
322200                                                                  32220000
322300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           32230000
322400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                32240000
322500                                                                  32250000
322600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        32260000
322700     PERFORM 4420-FORMAT-LIST-LINES                               32270000
322800         VARYING PV-SUB                                           32280000
322900         FROM PC-ITEMS-PER-PANEL BY -1                            32290000
323000         UNTIL PV-SUB < +1.                                       32300000
323100                                                                  32310000
323200     COMPUTE ASC-ITEMS-DISPLAYED =                                32320000
323300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          32330000
323400                                                                  32340000
323500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    32350000
323600                                      ASTRTITO.                   32360000
323700                                                                  32370000
323800                                                                  32380000
323900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    32390000
324000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    32400000
324100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32410000
324200                                   TO ASELITO.                    32420000
324300                                                                  32430000
324400     IF  DP020-MSG-NUMBER-X = SPACE                               32440000
324500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  32450000
324600*            --- MORE ITEMS TO DISPLAY ----                       32460000
324700             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            32470000
324800             SET DP020-MSG-INFORMATIONAL                          32480000
324900                                   TO TRUE                        32490000
325000         END-IF                                                   32500000
325100     END-IF.                                                      32510000
325200                                                                  32520000
325300*----------------------------------------------------------------*32530000
325400*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *32540000
325500*----------------------------------------------------------------*32550000
325600                                                                  32560000
325700 4410-READ-TEMP-STORAGE.                                          32570000
325800                                                                  32580000
325900     EXEC CICS                                                    32590000
326000         READQ TS                                                 32600000
326100             QUEUE (ASC-LIST-QUEUE-NAME)                          32610000
326200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32620000
326300             ITEM  (PV-BLOCK-NUMBER)                              32630000
326400             RESP  (PV-CICS-RESP)                                 32640000
326500     END-EXEC.                                                    32650000
326600                                                                  32660000
326700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       32670000
326800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     32680000
326900         CONTINUE                                                 32690000
327000     ELSE                                                         32700000
327100         SET DP013-CICS-ABEND      TO TRUE                        32710000
327200         SET DP013-NO-ROLLBACK     TO TRUE                        32720000
327300         MOVE '4410-READ-TEMP-STORAGE'                            32730000
327400                                   TO DP013-PARAGRAPH             32740000
327500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      32750000
327600                                   TO DP013-MESSAGE-TEXT(1)       32760000
327700         PERFORM DP013-0000-PROCESS-ABEND                         32770000
327800     END-IF.                                                      32780000
327900                                                                  32790000
328000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      32800000
328100                                   TO TRUE.                       32810000
328200                                                                  32820000
328300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         32830000
328400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               32840000
328500     END-IF.                                                      32850000
328600                                                                  32860000
328700/                                                                 32870000
328800*----------------------------------------------------------------*32880000
328900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *32890000
329000*----------------------------------------------------------------*32900000
329100                                                                  32910000
329200 4420-FORMAT-LIST-LINES.                                          32920000
329300                                                                  32930000
329400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      32940000
329500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                32950000
329600         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         32960000
329700         MOVE SPACES               TO MR-SELECT  (PV-SUB)         32970000
329800                                      MR-CARR-SCAC-CDE (PV-SUB)   32980000
329900                                      MR-TRLR-NBR (PV-SUB)        32990000
330000                                      MR-TRIP-STOP (PV-SUB)       33000000
330100                                      MR-STAT (PV-SUB)            33010000
330110                                      MR-USER (PV-SUB)            33011001
330200                                      MR-MANIFEST (PV-SUB)        33020000
330300                                      MR-USE (PV-SUB)             33030000
330400                                      MR-LGTH (PV-SUB)            33040000
330500                                      MR-CURR-LOC-1 (PV-SUB)      33050000
330600                                      MR-CURR-LOC-2 (PV-SUB)      33060000
330700                                      MR-DEST (PV-SUB)            33070000
330800                                      MR-ETA-DTE-TME (PV-SUB)     33080000
331000     ELSE                                                         33100000
331100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33110000
331200                                                   > SPACE        33120000
331300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33130000
331400                                   TO MR-SELECT (PV-SUB)          33140000
331500         ELSE                                                     33150000
331600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33160000
331700                                   TO MR-SELECT (PV-SUB)          33170000
331800         END-IF                                                   33180000
331900                                                                  33190000
332000         IF  DP030-SET-CURSOR-TRAILER                             33200000
332100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33210000
332200                 > SPACE)                                         33220000
332300               OR (PV-SUB = 1))                                   33230000
332400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33240000
332500                MOVE -1            TO MR-SELECTL (PV-SUB)         33250000
332600             END-IF                                               33260000
332700         END-IF                                                   33270000
332800                                                                  33280000
332900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           33290000
333000             MOVE ASC-CARR-SCAC-CDE (ASC-BLK-SUB ASC-ITEM-SUB)    33300000
333100                                   TO MR-CARR-SCAC-CDE (PV-SUB)   33310000
333200             MOVE ASC-TRLR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         33320000
333300                                   TO MR-TRLR-NBR (PV-SUB)        33330000
333400             MOVE ASC-TRIP-STOP (ASC-BLK-SUB ASC-ITEM-SUB)        33340000
333500                                   TO MR-TRIP-STOP (PV-SUB)       33350000
333600             MOVE ASC-STAT (ASC-BLK-SUB ASC-ITEM-SUB)             33360000
333700                                   TO MR-STAT (PV-SUB)            33370000
333710             MOVE ASC-STAT-USERID (ASC-BLK-SUB ASC-ITEM-SUB)      33371003
333720                                   TO MR-USER (PV-SUB)            33372003
333800             MOVE ASC-MANIFEST (ASC-BLK-SUB ASC-ITEM-SUB)         33380000
333900                                   TO MR-MANIFEST (PV-SUB)        33390000
334000             MOVE ASC-USE (ASC-BLK-SUB ASC-ITEM-SUB)              33400000
334100                                   TO MR-USE (PV-SUB)             33410000
334200             MOVE ASC-LGTH (ASC-BLK-SUB ASC-ITEM-SUB)             33420000
334300                                   TO MR-LGTH (PV-SUB)            33430000
334400             MOVE ASC-CURR-LOC-1 (ASC-BLK-SUB ASC-ITEM-SUB)       33440000
334500                                   TO MR-CURR-LOC-1 (PV-SUB)      33450000
334600             MOVE ASC-CURR-LOC-2 (ASC-BLK-SUB ASC-ITEM-SUB)       33460000
334700                                   TO MR-CURR-LOC-2 (PV-SUB)      33470000
334800             MOVE ASC-ETA-DTE-TME (ASC-BLK-SUB ASC-ITEM-SUB)      33480000
334900                                   TO MR-ETA-DTE-TME (PV-SUB)     33490000
335000             MOVE ASC-DEST (ASC-BLK-SUB ASC-ITEM-SUB)             33500000
335100                                   TO MR-DEST (PV-SUB)            33510000
335400         END-IF                                                   33540000
335500     END-IF.                                                      33550000
335600                                                                  33560000
335700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               33570000
335800                                                                  33580000
335900     IF  ASC-ITEM-SUB < + 1                                       33590000
336000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                33600000
336100         MOVE +1                   TO ASC-BLK-SUB                 33610000
336200     END-IF.                                                      33620000
336300                                                                  33630000
336400*----------------------------------------------------------------*33640000
336500*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *33650000
336600*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *33660000
336700*  ISSUE A WARNING.                                              *33670000
336800*----------------------------------------------------------------*33680000
336900 4430-CHECK-FOR-BEGIN-AND-END.                                    33690000
337000                                                                  33700000
337100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       33710000
337200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     33720000
337300*            -- NO END-OF-RANGE SPECFIED ---                      33730000
337400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            33740000
337500             SET DP020-MSG-WARNING TO TRUE                        33750000
337600             PERFORM 4431-POSITION-AT-WARNING                     33760000
337700         END-IF                                                   33770000
337800     ELSE                                                         33780000
337900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     33790000
338000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                33800000
338100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            33810000
338200             SET DP020-MSG-WARNING TO TRUE                        33820000
338300             PERFORM 4431-POSITION-AT-WARNING                     33830000
338400         END-IF                                                   33840000
338500     END-IF.                                                      33850000
338600                                                                  33860000
338700*----------------------------------------------------------------*33870000
338800*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *33880000
338900*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *33890000
339000*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *33900000
339100*  POSITION THE CURSOR THERE.                                    *33910000
339200*----------------------------------------------------------------*33920000
339300 4431-POSITION-AT-WARNING.                                        33930000
339400                                                                  33940000
339500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 33950000
339600                    - PV-TOP-ITEM + 1.                            33960000
339700                                                                  33970000
339800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      33980000
339900         CONTINUE                                                 33990000
340000     ELSE                                                         34000000
340100         SET DP030-SET-CURSOR-APPL-1                              34010000
340200                                   TO TRUE                        34020000
340300         MOVE -1                   TO MR-SELECTL (PV-SUB)         34030000
340400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34040000
340500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34050000
340600     END-IF.                                                      34060000
340700                                                                  34070000
340800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34080000
340900                    - PV-TOP-ITEM + 1.                            34090000
341000                                                                  34100000
341100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34110000
341200         CONTINUE                                                 34120000
341300     ELSE                                                         34130000
341400         SET DP030-SET-CURSOR-APPL-1                              34140000
341500                                   TO TRUE                        34150000
341600         MOVE -1                   TO MR-SELECTL (PV-SUB)         34160000
341700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34170000
341800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34180000
341900     END-IF.                                                      34190000
342000                                                                  34200000
342100/                                                                 34210000
342200*----------------------------------------------------------------*34220000
342300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *34230000
342400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *34240000
342500* FOR THE SELECTED ITEMS QUEUE.                                  *34250000
342600*                                                                *34260000
342700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *34270000
342800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *34280000
342900* THE ARRAY IS FULL.                                             *34290000
343000*----------------------------------------------------------------*34300000
343100                                                                  34310000
343200 5000-PREPARE-SEL-QUEUE.                                          34320000
343300                                                                  34330000
343400     MOVE +1                       TO ASC-BLK-SUB.                34340000
343500     PERFORM 5100-WRITE-TEMP-STORAGE.                             34350000
343600     ADD +1                        TO ASC-BLK-SUB.                34360000
343700     PERFORM 5100-WRITE-TEMP-STORAGE.                             34370000
343800                                                                  34380000
343900     MOVE ASC-SEL-QUEUE-NAME-OUT   TO TR007-SEL-QUEUE-NAME.       34390000
344000     PERFORM 6010-DELETE-SEL-QUEUE.                               34400000
344100                                                                  34410000
344200     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      34420000
344300         SET ASC-UPDATE-TSQ        TO TRUE                        34430000
344400     END-IF.                                                      34440000
344500                                                                  34450000
344600     SET TR006-IDX                 TO 1.                          34460000
344700     MOVE ZERO                     TO TR007-NUMBER-OF-TS-ITEMS.   34470000
344800     INITIALIZE TR006-SELECTED-ITEM-ARRAY.                        34480000
344900                                                                  34490000
345000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           34500000
345100             VARYING PV-ITEM                                      34510000
345200             FROM 1 BY 1                                          34520000
345300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     34530000
345400                                                                  34540000
345500     IF  TR006-IDX > 1                                            34550000
345600         PERFORM 5205-WRITE-SEL-QUEUE                             34560000
345700         ADD +1                    TO TR007-NUMBER-OF-TS-ITEMS    34570000
345800     END-IF.                                                      34580000
345900                                                                  34590000
346000/                                                                 34600000
346100*----------------------------------------------------------------*34610000
346200*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *34620000
346300*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *34630000
346400*----------------------------------------------------------------*34640000
346500                                                                  34650000
346600 5100-WRITE-TEMP-STORAGE.                                         34660000
346700                                                                  34670000
346800     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     34680000
346900                                   TO PV-LIST-ITEM-NUMBER.        34690000
347000     COMPUTE PV-BLOCK-NUMBER =                                    34700000
347100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    34710000
347200                                                                  34720000
347300     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             34730000
347400     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             34740000
347500         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      34750000
347600             PERFORM 5105-REWRITE-ASC-LISTQ                       34760000
347700         END-IF                                                   34770000
347800     ELSE                                                         34780000
347900         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       34790000
348000         ASC-HIGHEST-BLOCK-WRITTEN + 1                            34800000
348100         PERFORM 5110-WRITE-ASC-LISTQ                             34810000
348200         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   34820000
348300     END-IF.                                                      34830000
348400                                                                  34840000
348500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      34850000
348600                                   TO TRUE.                       34860000
348700                                                                  34870000
348800/                                                                 34880000
348900*----------------------------------------------------------------*34890000
349000*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *34900000
349100*  SPECIFIC COMMAREA.                                            *34910000
349200*----------------------------------------------------------------*34920000
349300 5105-REWRITE-ASC-LISTQ.                                          34930000
349400                                                                  34940000
349500     EXEC CICS                                                    34950000
349600         WRITEQ TS                                                34960000
349700             QUEUE (ASC-LIST-QUEUE-NAME)                          34970000
349800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34980000
349900             ITEM  (PV-BLOCK-NUMBER)                              34990000
350000             REWRITE                                              35000000
350100             RESP  (PV-CICS-RESP)                                 35010000
350200     END-EXEC.                                                    35020000
350300                                                                  35030000
350400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35040000
350500         CONTINUE                                                 35050000
350600     ELSE                                                         35060000
350700         SET DP013-CICS-ABEND      TO TRUE                        35070000
350800         SET DP013-NO-ROLLBACK     TO TRUE                        35080000
350900         MOVE '5105-REWRITE-ASC-LISTQ'                            35090000
351000                                   TO DP013-PARAGRAPH             35100000
351100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     35110000
351200                                   TO DP013-MESSAGE-TEXT(1)       35120000
351300         PERFORM DP013-0000-PROCESS-ABEND                         35130000
351400     END-IF.                                                      35140000
351500                                                                  35150000
351600/                                                                 35160000
351700*----------------------------------------------------------------*35170000
351800*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *35180000
351900*  SPECIFIC COMMAREA.                                            *35190000
352000*----------------------------------------------------------------*35200000
352100 5110-WRITE-ASC-LISTQ.                                            35210000
352200                                                                  35220000
352300     EXEC CICS                                                    35230000
352400         WRITEQ TS                                                35240000
352500             QUEUE (ASC-LIST-QUEUE-NAME)                          35250000
352600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35260000
352700             ITEM  (PV-BLOCK-NUMBER)                              35270000
352800             RESP  (PV-CICS-RESP)                                 35280000
352900     END-EXEC.                                                    35290000
353000                                                                  35300000
353100     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      35310000
353200         SET DP013-CICS-ABEND      TO TRUE                        35320000
353300         SET DP013-NO-ROLLBACK     TO TRUE                        35330000
353400         MOVE '5110-WRITE-ASC-LISTQ'                              35340000
353500                                   TO DP013-PARAGRAPH             35350000
353600         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           35360000
353700                                   TO DP013-MESSAGE-TEXT(1)       35370000
353800         PERFORM DP013-0000-PROCESS-ABEND                         35380000
353900     END-IF.                                                      35390000
354000                                                                  35400000
354100/                                                                 35410000
354200*----------------------------------------------------------------*35420000
354300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *35430000
354400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *35440000
354500*----------------------------------------------------------------*35450000
354600                                                                  35460000
354700 5200-FILL-SEL-QUEUE-RECORD.                                      35470000
354800                                                                  35480000
354900     PERFORM 6112-READ-LIST-QUEUE.                                35490000
355000                                                                  35500000
355100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       35510000
355200         PERFORM                                                  35520000
355300         VARYING LQW-IDX                                          35530000
355400         FROM 1 BY 1                                              35540000
355500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            35550000
355600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          35560000
355700                                                                  35570000
355800             IF  LQW-SELECT (LQW-IDX)                             35580000
355900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              35590000
356000                                   TO TR006-ITEM (TR006-IDX)      35600000
356100                 MOVE LQW-CARR-SCAC-CDE (LQW-IDX)                 35610000
356200                           TO TR006-OWNER-SCAC-ID (TR006-IDX)     35620000
356300                 MOVE LQW-TRLR-NBR (LQW-IDX)                      35630000
356400                           TO TR006-VEH-NBR (TR006-IDX)           35640000
356500                 MOVE LQW-MANIFEST (LQW-IDX)                      35650000
356600                           TO TR006-MANIFEST-NBR (TR006-IDX)      35660000
356700                 MOVE LQW-OPER-UNT-ID (LQW-IDX)                   35670000
356800                           TO TR006-OPER-UNT-ID (TR006-IDX)       35680000
356900                 MOVE LQW-FCLTY-ID (LQW-IDX)                      35690000
357000                           TO TR006-FCLTY-ID (TR006-IDX)          35700000
357100                 MOVE LQW-DEST-OPER-UNT-ID (LQW-IDX)              35710000
357200                           TO TR006-DEST-OPER-UNT-ID (TR006-IDX)  35720000
357300                 MOVE LQW-DEST-FCLTY-ID (LQW-IDX)                 35730000
357400                           TO TR006-DEST-FCLTY-ID (TR006-IDX)     35740000
357500                 MOVE LQW-TRIP-ID (LQW-IDX)                       35750000
357600                           TO TR006-TRIP-ID (TR006-IDX)           35760000
357700                 MOVE LQW-STAT (LQW-IDX)                          35770000
357800                           TO TR006-STATUS-CDE (TR006-IDX)        35780000
357900                 MOVE SPACE        TO TR006-ACTION-SW (TR006-IDX) 35790000
358000                 SET TR006-IDX UP BY 1                            35800000
358100                 IF  TR006-IDX > TR006-MAX-ITEMS                  35810000
358200                     PERFORM 5205-WRITE-SEL-QUEUE                 35820000
358300                     ADD +1        TO TR007-NUMBER-OF-TS-ITEMS    35830000
358400                     INITIALIZE TR006-SELECTED-ITEM-ARRAY         35840000
358500                     SET TR006-IDX TO 1                           35850000
358600                 END-IF                                           35860000
358700             END-IF                                               35870000
358800         END-PERFORM                                              35880000
358900     END-IF.                                                      35890000
359000                                                                  35900000
359100/                                                                 35910000
359200*----------------------------------------------------------------*35920000
359300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *35930000
359400*----------------------------------------------------------------*35940000
359500                                                                  35950000
359600 5205-WRITE-SEL-QUEUE.                                            35960000
359700                                                                  35970000
359800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            35980000
359900                                   TO TR006-SELECTED-ITEMS.       35990000
360000                                                                  36000000
360100     EXEC CICS                                                    36010000
360200          WRITEQ TS                                               36020000
360300              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      36030000
360400              FROM  (TR006-DOCK-SCHEDULE-REC)                     36040000
360500              ITEM  (PV-SEL-QUEUE-ITEM)                           36050000
360600              RESP  (PV-CICS-RESP)                                36060000
360700     END-EXEC.                                                    36070000
360800                                                                  36080000
360900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36090000
361000         CONTINUE                                                 36100000
361100     ELSE                                                         36110000
361200         SET DP013-CICS-ABEND      TO TRUE                        36120000
361300         SET DP013-NO-ROLLBACK     TO TRUE                        36130000
361400         MOVE '5205-WRITE-SEL-QUEUE'                              36140000
361500                                   TO DP013-PARAGRAPH             36150000
361600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          36160000
361700                                   TO DP013-MESSAGE-TEXT(1)       36170000
361800         PERFORM DP013-0000-PROCESS-ABEND                         36180000
361900     END-IF.                                                      36190000
362000                                                                  36200000
362100/                                                                 36210000
362200*----------------------------------------------------------------*36220000
362300*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *36230000
362400*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *36240000
362500*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *36250000
362600*  THE USER.                                                     *36260000
362700*----------------------------------------------------------------*36270000
362800 6000-REFRESH-PANEL-FROM-TEMP.                                    36280000
362900                                                                  36290000
363000     IF  ASC-UPDATE-TSQ                                           36300000
363100         SET ASC-NO-TSQ-UPDATE     TO TRUE                        36310000
363200         MOVE ZERO                 TO PV-SAVE-ITEM                36320000
363300                                      PV-SEL-QUEUE-ITEM           36330000
363400         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        36340000
363500                                   TO PV-HOLD-SELECTED-ITEMS      36350000
363600         PERFORM 6100-UPDATE-TSQ                                  36360000
363700             UNTIL PV-ITEMS-PROCESSED >                           36370000
363800                                     ASC-NUMBER-OF-SELECTED-ITEMS 36380000
363900         PERFORM 6010-DELETE-SEL-QUEUE                            36390000
364000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         36400000
364100                    ASC-BLOCK-ENTRIES (2)                         36410000
364200     END-IF.                                                      36420000
364300                                                                  36430000
364400/                                                                 36440000
364500*----------------------------------------------------------------*36450000
364600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *36460000
364700*----------------------------------------------------------------*36470000
364800 6010-DELETE-SEL-QUEUE.                                           36480000
364900                                                                  36490000
365000     EXEC CICS                                                    36500000
365100         DELETEQ TS                                               36510000
365200             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       36520000
365300             RESP  (PV-CICS-RESP)                                 36530000
365400     END-EXEC.                                                    36540000
365500                                                                  36550000
365600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      36560000
365700         (PV-CICS-RESP = DFHRESP(QIDERR)))                        36570000
365800         CONTINUE                                                 36580000
365900     ELSE                                                         36590000
366000         SET DP013-CICS-ABEND      TO TRUE                        36600000
366100         SET DP013-NO-ROLLBACK     TO TRUE                        36610000
366200         MOVE '6010-DELETE-SEL-QUEUE'                             36620000
366300                                   TO DP013-PARAGRAPH             36630000
366400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         36640000
366500                                   TO DP013-MESSAGE-TEXT (1)      36650000
366600         PERFORM DP013-0000-PROCESS-ABEND                         36660000
366700     END-IF.                                                      36670000
366800                                                                  36680000
366900/                                                                 36690000
367000*----------------------------------------------------------------*36700000
367100*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *36710000
367200*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *36720000
367300*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *36730000
367400*    THE TEMP QUEUE.                                             *36740000
367500*----------------------------------------------------------------*36750000
367600                                                                  36760000
367700 6100-UPDATE-TSQ.                                                 36770000
367800                                                                  36780000
367900     ADD 1                         TO PV-SEL-QUEUE-ITEM.          36790000
368000     PERFORM 6105-READ-SEL-QUEUE.                                 36800000
368100                                                                  36810000
368200     PERFORM                                                      36820000
368300         VARYING TR006-IDX                                        36830000
368400         FROM 1 BY 1                                              36840000
368500         UNTIL ((PV-ITEMS-PROCESSED >                             36850000
368600                              PV-HOLD-SELECTED-ITEMS)             36860000
368700         OR (TR006-IDX GREATER THAN TR006-MAX-ITEMS))             36870000
368800         IF  TR006-ACTION-SW (TR006-IDX) > SPACE                  36880000
368900             PERFORM 6110-PROCESS-ITEMS                           36890000
369000         END-IF                                                   36900000
369100         ADD +1                    TO PV-ITEMS-PROCESSED          36910000
369200     END-PERFORM.                                                 36920000
369300                                                                  36930000
369400     PERFORM 6111-WRITE-LIST-QUEUE.                               36940000
369500                                                                  36950000
369600/                                                                 36960000
369700*----------------------------------------------------------------*36970000
369800*    READ THE LIST QUEUE RECORD.                                 *36980000
369900*----------------------------------------------------------------*36990000
370000                                                                  37000000
370100 6105-READ-SEL-QUEUE.                                             37010000
370200                                                                  37020000
370300     EXEC CICS                                                    37030000
370400          READQ TS                                                37040000
370500              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      37050000
370600              INTO  (TR006-DOCK-SCHEDULE-REC)                     37060000
370700              ITEM  (PV-SEL-QUEUE-ITEM)                           37070000
370800              RESP  (PV-CICS-RESP)                                37080000
370900     END-EXEC.                                                    37090000
371000                                                                  37100000
371100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37110000
371200         CONTINUE                                                 37120000
371300     ELSE                                                         37130000
371400         SET DP013-CICS-ABEND      TO TRUE                        37140000
371500         SET DP013-NO-ROLLBACK     TO TRUE                        37150000
371600         MOVE '6105-READ-SEL-QUEUE'                               37160000
371700                                   TO DP013-PARAGRAPH             37170000
371800         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           37180000
371900                                   TO DP013-MESSAGE-TEXT(1)       37190000
372000         PERFORM DP013-0000-PROCESS-ABEND                         37200000
372100     END-IF.                                                      37210000
372200                                                                  37220000
372300/                                                                 37230000
372400*----------------------------------------------------------------*37240000
372500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*37250000
372600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*37260000
372700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *37270000
372800*----------------------------------------------------------------*37280000
372900                                                                  37290000
373000 6110-PROCESS-ITEMS.                                              37300000
373100                                                                  37310000
373200     COMPUTE PV-ITEM = 1 + ((TR006-ITEM (TR006-IDX) - 1)          37320000
373300                     / PC-ITEMS-PER-PANEL).                       37330000
373400                                                                  37340000
373500     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           37350000
373600         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          37360000
373700             PERFORM 6111-WRITE-LIST-QUEUE                        37370000
373800         END-IF                                                   37380000
373900         MOVE PV-ITEM              TO PV-SAVE-ITEM                37390000
374000                                                                  37400000
374100         PERFORM 6112-READ-LIST-QUEUE                             37410000
374200         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               37420000
374300             CONTINUE                                             37430000
374400         END-IF                                                   37440000
374500     END-IF.                                                      37450000
374600                                                                  37460000
374700     COMPUTE PV-SUB = (TR006-ITEM (TR006-IDX)                     37470000
374800                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              37480000
374900                                                                  37490000
375000     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       37500000
375100     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        37510000
375200                                     (PV-SUB).                    37520000
375300                                                                  37530000
375400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                37540000
375500                                                                  37550000
375600/                                                                 37560000
375700*----------------------------------------------------------------*37570000
375800*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *37580000
375900*----------------------------------------------------------------*37590000
376000                                                                  37600000
376100 6111-WRITE-LIST-QUEUE.                                           37610000
376200                                                                  37620000
376300     EXEC CICS                                                    37630000
376400         WRITEQ TS                                                37640000
376500             QUEUE (ASC-LIST-QUEUE-NAME)                          37650000
376600             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     37660000
376700             ITEM  (PV-SAVE-ITEM)                                 37670000
376800             REWRITE                                              37680000
376900             RESP  (PV-CICS-RESP)                                 37690000
377000     END-EXEC.                                                    37700000
377100                                                                  37710000
377200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37720000
377300         CONTINUE                                                 37730000
377400     ELSE                                                         37740000
377500         SET DP013-CICS-ABEND      TO TRUE                        37750000
377600         SET DP013-NO-ROLLBACK     TO TRUE                        37760000
377700         MOVE '6111-WRITE-LIST-QUEUE'                             37770000
377800                                   TO DP013-PARAGRAPH             37780000
377900         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  37790000
378000                                   TO DP013-MESSAGE-TEXT(1)       37800000
378100         PERFORM DP013-0000-PROCESS-ABEND                         37810000
378200     END-IF.                                                      37820000
378300                                                                  37830000
378400/                                                                 37840000
378500*----------------------------------------------------------------*37850000
378600*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*37860000
378700*----------------------------------------------------------------*37870000
378800                                                                  37880000
378900 6112-READ-LIST-QUEUE.                                            37890000
379000                                                                  37900000
379100     EXEC CICS                                                    37910000
379200         READQ TS                                                 37920000
379300             QUEUE (ASC-LIST-QUEUE-NAME)                          37930000
379400             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     37940000
379500             ITEM  (PV-ITEM)                                      37950000
379600             RESP  (PV-CICS-RESP)                                 37960000
379700     END-EXEC.                                                    37970000
379800                                                                  37980000
379900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37990000
380000         CONTINUE                                                 38000000
380100     ELSE                                                         38010000
380200         SET DP013-CICS-ABEND      TO TRUE                        38020000
380300         SET DP013-NO-ROLLBACK     TO TRUE                        38030000
380400         MOVE '6112-READ-LIST-QUEUE'                              38040000
380500                                   TO DP013-PARAGRAPH             38050000
380600         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    38060000
380700                                   TO DP013-MESSAGE-TEXT(1)       38070000
380800         PERFORM DP013-0000-PROCESS-ABEND                         38080000
380900     END-IF.                                                      38090000
381000                                                                  38100000
381100/                                                                 38110000
381200******************************************************************38120000
381300* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *38130000
381400******************************************************************38140000
381500 6200-DEL-LIST-QUEUE.                                             38150000
381600                                                                  38160000
381700     EXEC CICS                                                    38170000
381800         DELETEQ TS                                               38180000
381900             QUEUE (ASC-LIST-QUEUE-NAME)                          38190000
382000             RESP  (PV-CICS-RESP)                                 38200000
382100     END-EXEC.                                                    38210000
382200                                                                  38220000
382300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      38230000
382400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         38240000
382500         CONTINUE                                                 38250000
382600     ELSE                                                         38260000
382700        SET DP013-CICS-ABEND       TO TRUE                        38270000
382800        SET DP013-NO-ROLLBACK      TO TRUE                        38280000
382900        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             38290000
383000        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               38300000
383100                                   TO DP013-MESSAGE-TEXT (1)      38310000
383200        PERFORM DP013-0000-PROCESS-ABEND                          38320000
383300     END-IF.                                                      38330000
383400                                                                  38340000
383500/                                                                 38350000
383600******************************************************************38360000
383700* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *38370000
383800******************************************************************38380000
383900 9100-READ-SEL-QUEUE.                                             38390000
384000     EXEC CICS                                                    38400000
384100         READQ TS                                                 38410000
384200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        38420000
384300             INTO  (TR006-DOCK-SCHEDULE-REC)                      38430000
384400             ITEM  (ASC-SEL-ITEM)                                 38440000
384500             RESP  (PV-CICS-RESP)                                 38450000
384600     END-EXEC.                                                    38460000
384700                                                                  38470000
384800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        38480000
384900         CONTINUE                                                 38490000
385000     ELSE                                                         38500000
385100         SET DP013-LOGIC-ABEND                                    38510000
385200             DP013-NO-ROLLBACK     TO TRUE                        38520000
385300         MOVE '9100-READ-SEL-QUEUE'                               38530000
385400                                   TO DP013-PARAGRAPH             38540000
385500         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    38550000
385600                                   TO DP013-MESSAGE-TEXT (1)      38560000
385700         PERFORM DP013-0000-PROCESS-ABEND                         38570000
385800     END-IF.                                                      38580000
385900                                                                  38590000
386000/                                                                 38600000
386100******************************************************************38610000
386200* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *38620000
386300******************************************************************38630000
386400 9200-REWRITE-LIST-QUEUE.                                         38640000
386500     EXEC CICS                                                    38650000
386600          WRITEQ TS                                               38660000
386700              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     38670000
386800              FROM    (TR006-DOCK-SCHEDULE-REC)                   38680000
386900              ITEM    (ASC-SEL-ITEM)                              38690000
387000              RESP    (PV-CICS-RESP)                              38700000
387100              REWRITE                                             38710000
387200     END-EXEC.                                                    38720000
387300                                                                  38730000
387400     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    38740000
387500         SET DP013-CICS-ABEND                                     38750000
387600             DP013-NO-ROLLBACK     TO TRUE                        38760000
387700         MOVE '9200-REWRITE-LIST-QUEUE'                           38770000
387800                                   TO DP013-PARAGRAPH             38780000
387900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   38790000
388000                                   TO DP013-MESSAGE-TEXT (1)      38800000
388100         PERFORM DP013-0000-PROCESS-ABEND                         38810000
388200     END-IF.                                                      38820000
388300                                                                  38830000
388400/                                                                 38840000
388500*----------------------------------------------------------------*38850000
388600*    ABEND PROCESSOR MODULE                                      *38860000
388700*----------------------------------------------------------------*38870000
388800                                                                  38880000
388900     COPY DPPD013.                                                38890000
