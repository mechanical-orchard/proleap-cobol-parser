000100 TITLE 'QUALITY SPOT CHECK STATISTICS REPORT'.                    00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300                                                                  00030000
000400 PROGRAM-ID.             SUKRP028.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            FEBRUARY, 2002.                          00070000
000800 DATE-COMPILED.                                                   00080000
000900*                                                                 00090000
001000 ENVIRONMENT DIVISION.                                            00100000
001100                                                                  00110000
001200 CONFIGURATION SECTION.                                           00120000
001300                                                                  00130000
001400 SOURCE-COMPUTER.        IBM-3090.                                00140000
001500 OBJECT-COMPUTER.        IBM-3090.                                00150000
001600                                                                  00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800                                                                  00180000
001900 FILE-CONTROL.                                                    00190000
002000     SELECT CARTON-AUDIT-EXTRACT-FILE                             00200000
002100         ASSIGN TO INP01.                                         00210000
002200                                                                  00220000
002300     SELECT REPORT-FILE                                           00230000
002400         ASSIGN TO RPT01.                                         00240000
002500                                                                  00250000
002600     SELECT TOTAL-FILE                                            00260000
002700         ASSIGN TO OUT01.                                         00270000
002800                                                                  00280000
002900 DATA DIVISION.                                                   00290000
003000                                                                  00300000
003100 FILE SECTION.                                                    00310000
003200 FD  CARTON-AUDIT-EXTRACT-FILE                                    00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     RECORDING MODE IS F                                          00340000
003500     BLOCK CONTAINS 0 RECORDS                                     00350000
003600     RECORD CONTAINS 150 CHARACTERS.                              00360000
003700 01  CARTON-AUDIT-EXTRACT-RECORD      PIC X(150).                 00370000
003800                                                                  00380000
003900 FD  REPORT-FILE                                                  00390000
004000     RECORDING MODE IS F                                          00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     BLOCK CONTAINS 0 RECORDS.                                    00420000
004300 01  REPORT-RECORD                   PIC X(132).                  00430000
004400*                                                                 00440000
004500 FD  TOTAL-FILE                                                   00450000
004600     RECORDING MODE IS F                                          00460000
004700     LABEL RECORDS ARE STANDARD                                   00470000
004800     BLOCK CONTAINS 0 RECORDS.                                    00480000
004900 01  TOTAL-RECORD                    PIC X(150).                  00490000
005000*                                                                 00500000
005100*                                                                 00510000
005200 WORKING-STORAGE SECTION.                                         00520000
005300 01  PROGRAM-SWITCHES.                                            00530000
005400                                                                  00540000
005500*    THESE SWITCHES SIGNAL WHEN END-OF-FILE IS REACHED            00550000
005600     05  PS-EOF-EXTRACT-SW            PIC X(01) VALUE 'N'.        00560000
005700         88  PS-EOF-EXTRACT                     VALUE 'Y'.        00570000
005800     05  PS-NO-DATA-SW                PIC X(01) VALUE 'Y'.        00580000
005900         88  PS-NO-DATA                         VALUE 'N'.        00590000
006000                                                                  00600000
006100*    CONTROLS PRINTING OF SUBHEADER RATHER THAN DETAIL LINE       00610000
006200     05  PS-SUBHEADER-SW              PIC X(01) VALUE 'N'.        00620000
006300         88  PS-PRINT-SUBHEADER                 VALUE 'Y'.        00630000
006400         88  PS-DONT-PRINT-SUBHEADER            VALUE 'N'.        00640000
006500*    CONTROLS PRINTING OF 'DC TOTAL:'                             00650000
006600     05  PS-SUBTOTAL-SW               PIC X(01) VALUE 'N'.        00660000
006700         88  PS-PRINT-DC-TOTAL                  VALUE 'Y'.        00670000
006800         88  PS-DONT-PRINT-DC-TOTAL             VALUE 'N'.        00680000
006900                                                                  00690000
007000/                                                                 00700000
007100*01  PV-DISPLAY-CRTN-COMPLT           PIC Z(09).                  00701001
007200*01  PV-DISPLAY-CRTN-CRTN             PIC Z(09).                  00701101
007210 01  PV-DISPLAY-CRTN-UNIT-QTY1        PIC Z(09).                  00701101
007211 01  PV-DISPLAY-CRTN-UNIT-QTY2        PIC Z(09).                  00701101
007230 01  PV-DISPLAY-SU030-CRTN-UNIT       PIC Z(09).                  00701101
007300 01  PV-CURR-KEY.                                                 00710000
007400     05  PV-OPER-UNT-ID-CURR          PIC 9(04) VALUE ZERO.       00720000
007500     05  PV-PKGNG-TYPE-CURR           PIC X(02) VALUE SPACES.     00730000
007600     05  PV-VENDOR-RANK-CURR          PIC X(06) VALUE SPACES.     00740000
007700 01  PV-PREV-KEY.                                                 00750000
007800     05  PV-OPER-UNT-ID-PREV          PIC 9(04) VALUE ZERO.       00760000
007900     05  PV-PKGNG-TYPE-PREV           PIC X(02) VALUE SPACES.     00770000
008000     05  PV-VENDOR-RANK-PREV          PIC X(06) VALUE SPACES.     00780000
008100 01  PV-PREV-KEY-A.                                               00790000
008200     05  PV-OPER-UNT-ID-A             PIC 9(04) VALUE ZERO.       00800000
008300     05  PV-PKGNG-TYPE-A              PIC X(02) VALUE SPACES.     00810000
008400     05  PV-VENDOR-RANK-A             PIC X(06) VALUE SPACES.     00820000
008500/                                                                 00830000
008600 01  PV-PROGRAM-VARIABLES.                                        00840000
008700     05  PV-PREV-REC-TYPE            PIC X(01) VALUE SPACE.       00850000
008800     05  PV-PAGE-COUNT               PIC S9(04)   VALUE ZERO      00860000
008900                                                  COMP-3.         00870000
009000     05  PV-LINE-COUNT               PIC S9(03)   VALUE ZERO      00880000
009100                                                  COMP-3.         00890000
009200                                                                  00900000
009300     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00910000
009400     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00920000
009500     05  PV-ERROR-MESSAGE-1          PIC X(50) VALUE SPACE.       00930000
009600     05  PV-ERROR-MESSAGE-2          PIC X(50) VALUE SPACE.       00940000
009700                                                                  00950000
009800     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00960000
009900                                                   COMP SYNC.     00970000
010000     05  PV-ABEND-PARA-NAME          PIC X(30)     VALUE SPACES.  00980000
010100     05  PV-DB2-OPERATION-MSG-1      PIC X(40)     VALUE SPACES.  00990000
010200     05  PV-DB2-OPERATION-MSG-2      PIC X(40)     VALUE SPACES.  01000000
010300     05  PV-DB2-TABLE-NAME           PIC X(12)     VALUE SPACES.  01010000
010400     05  PV-PERCENT                   PIC S9(4)V9(3) COMP-3       01020000
010500                                                     VALUE ZERO.  01030000
010600     05  PV-AUD-CRTN-QTY-COMPLT       PIC S9(9) COMP VALUE ZERO.  01040000
010700     05  PV-AUD-UNIT-QTY-COMPLT       PIC S9(9) COMP VALUE ZERO.  01050000
010800     05  PV-UNITS-PER-HOUR            PIC S9(6)V99                01060000
010900                                                COMP VALUE ZERO.  01070000
011000     05  PV-SAVE-VENDOR-RANK          PIC X(6) VALUE SPACES.      01080000
011100     05  PV-SAVE-PKGNG-TYPE           PIC X(2) VALUE SPACES.      01090000
011200                                                                  01100000
011300     05  PV-TOTAL-COMPLT-AUDITS       PIC S9(06) VALUE ZEROES.    01110000
011400     05  PV-GRAND-TOT-COMPLT-AUDIT    PIC S9(9) COMP-3.           01120000
011500                                                                  01130000
011600     05  PV-DISP-OPER                 PIC  9(04) VALUE ZEROES.    01140000
011700     05  PV-DISP-COMPLETE             PIC  9(06) VALUE ZEROES.    01150000
011800     05  PV-DISP-NUMERIC-1            PIC  9(09) VALUE ZEROES.    01160000
011900     05  PV-DISP-NUMERIC-2            PIC  9(09) VALUE ZEROES.    01170000
012000     05  PV-DISP-NUMERIC-3            PIC  9(09) VALUE ZEROES.    01180000
012100     05  PV-TMST                      PIC X(26) VALUE SPACES.             
012200                                                                  01190000
012300 01  PC-CONSTANTS.                                                01200000
012400     05  PC-MAX-RETRIES          PIC S9(4)     COMP SYNC VALUE +2.01210000
012500                                                                  01220000
012600     05  PC-END-OF-PAGE              PIC S9(3) COMP-3 VALUE +60.  01230000
012700     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     01240000
012800     05  PC-SPACE                    PIC  X(01)    VALUE ' '.     01250000
012900     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01260000
013000         'SUKRP028'.                                              01270000
013100     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01280000
013200                                                                  01290000
013300                                                                  01300000
013400     05 ABEND-CODE                    PIC S9(04) VALUE ZERO       01310000
013500                                                 COMP SYNC.       01320000
013600     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     01330000
013700                                                                  01340000
013800                                                                  01350000
013900     05  PV-TODAYS-DATE.                                          01360000
014000         10  PV-TODAYS-DATE-CCYY     PIC  9(04)    VALUE ZEROS.   01370000
014100         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   01380000
014200         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   01390000
014300     05  PV-TODAYS-TIME.                                          01400000
014400         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   01410000
014500         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   01420000
014600         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   01430000
014700         10  FILLER                  PIC  9(02)    VALUE ZEROS.   01440000
014800     05  PV-FORMAT-DATE.                                          01450000
014900         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01460000
015000         10  FILLER                  PIC  X(01)    VALUE '/'.     01470000
015100         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01480000
015200         10  FILLER                  PIC  X(01)    VALUE '/'.     01490000
015300         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01500000
015400                                                                  01510000
015500*                                                                 01520000
015600*                                                                 01530000
015700 01  WS-BATCH-PROC-DATE.                                          01540000
015800     05  WS-BATCH-PROC-CC            PIC X(02)     VALUE SPACE.   01550000
015900     05  WS-BATCH-PROC-YY            PIC X(02)     VALUE SPACE.   01560000
016000     05  FILLER                      PIC X(01)     VALUE SPACE.   01570000
016100     05  WS-BATCH-PROC-MM            PIC X(02)     VALUE SPACE.   01580000
016200     05  FILLER                      PIC X(01)     VALUE SPACE.   01590000
016300     05  WS-BATCH-PROC-DD            PIC X(02)     VALUE SPACE.   01600000
016400                                                                  01610000
016500 01 WS-CALC-FIELDS.                                               01620000
016600    05  WS-RECORDS-READ-QTY          PIC S9(07)    COMP-3         01630000
016700                                                   VALUE ZEROS.   01640000
016800    05  WS-RECORDS-WRITE-QTY         PIC S9(07)    COMP-3         01650000
016900                                                   VALUE ZEROS.   01660000
017000 01  PV-ABEND-FIELDS.                                             01670000
017100     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'SUKRP028'.01680000
017200     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01690000
017300     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01700000
017400     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01710000
017500     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01720000
017600     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01730000
017700     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    01740000
017800     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01750000
017900     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01760000
018000     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01770000
018100     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01780000
018200                                                                  01790000
018300/                                                                 01800000
018400*    DATE CONTROL CARD                                            01810000
018500     COPY SURD032.                                                01820000
018600                                                                  01830000
018700*RECORD LAYOUTS FOR INPUT FILES                                   01840000
018800     COPY SURD030.                                                01850000
018900/                                                                 01860000
019000*RECORD LAYOUTS FOR OPER UNIT TOTALS RECORD                       01870000
019100     COPY SURD035.                                                01880000
019200/                                                                 01890000
019300*  LOGISTICS DOMAIN LOCATION MODULE                               11601003
019400*                                                                 11602003
019500     COPY XLWS071.                                                11603003
019600/                                                                 01890000
019700*STANDARD REPORT HEADER FOR 132 COLUMN REPORT                     01900000
019800     COPY DPWS132.                                                01910000
019900                                                                  01920000
020000*MAIN HEADINGS                                                    01930000
020100 01  HEADING-LINE1.                                               01940000
020200     05  FILLER                  PIC  X(48)    VALUE SPACE.       01950000
020300     05  FILLER                  PIC  X(36)    VALUE              01960000
020400         'QUALITY SPOT CHECK STATISTICS REPORT'.                  01970000
020500     05  FILLER                  PIC  X(48)    VALUE SPACE.       01980000
020600                                                                  01990000
020700 01  HEADING-LINE2.                                               02000000
020800     05  FILLER                  PIC  X(54)    VALUE SPACE.       02010000
020900*        (SUCH AS 'WEEK', 'MONTH', 'YEAR')                        02020000
021000     05  HL2-PERIOD-TYPE         PIC  X(07)    VALUE              02030000
021100         '  WEEK '.                                               02040000
021200     05  FILLER                  PIC  X(07)    VALUE              02050000
021300         'ENDING '.                                               02060000
021400     05  HL2-WEEK-ENDING-DATE    PIC X(10)     VALUE SPACES.      02070000
021500     05  FILLER                  PIC  X(54)    VALUE SPACE.       02080000
021600                                                                  02090000
021700 01  HEADING-LINE3.                                               02100000
021800     05  FILLER                  PIC  X(11)    VALUE              02110000
021900         'OPER UNIT: '.                                           02120000
022000     05  HL3-OPER-UNT-ID         PIC  9(04)    BLANK ZERO.        02130000
022100     05  FILLER                  PIC X(01)     VALUE '-'.         02140000
022200     05  HL3-FCLTY-NME           PIC  X(25)    VALUE SPACE.       02150000
022300     05  FILLER                  PIC  X(91)    VALUE SPACE.       02160000
022400                                                                  02170000
022500 01  HEADING-LINE4.                                               02180000
022600     05  FILLER                  PIC  X(09)    VALUE SPACE.       02190000
022700     05  FILLER                  PIC  X(18)    VALUE ALL '-'.     02200000
022800     05  FILLER                  PIC  X(18)    VALUE              02210000
022900         ' NUMBER OF AUDITS '.                                    02220000
023000     05  FILLER                  PIC  X(19)    VALUE ALL '-'.     02230000
023100     05  FILLER                  PIC  X(16)    VALUE SPACES.      02240000
023200     05  FILLER                  PIC  X(19)    VALUE ALL '-'.     02250000
023300     05  FILLER                  PIC  X(15)    VALUE              02260000
023400         ' UNITS AUDITED '.                                       02270000
023500     05  FILLER                  PIC  X(18)    VALUE ALL '-'.     02280000
023600                                                                  02290000
023700 01  HEADING-LINE5.                                               02300000
023800     05  FILLER                  PIC  X(27)    VALUE              02310000
023900         '       TOTAL  TOTAL  PROMPT'.                           02320000
024000     05  FILLER                  PIC  X(29)    VALUE SPACES.      02330000
024100     05  FILLER                  PIC  X(36)    VALUE              02340000
024200         'AUDITS -- CARTONS --- --- UNITS ----'.                  02350000
024300     05  FILLER                  PIC  X(34)    VALUE SPACES.      02360000
024400     05  FILLER                  PIC  X(04)    VALUE              02370000
024500         'UNIT'.                                                  02380000
024600     05  FILLER                  PIC  X(02)    VALUE SPACES.      02390000
024700                                                                  02400000
024800 01  HEADING-LINE6.                                               02410000
024900     05  FILLER                  PIC  X(27)    VALUE              02420000
025000         '       PROMPT COMPLT COMPLT'.                           02430000
025100     05  FILLER                  PIC  X(35)    VALUE              02440000
025200         ' -- PASSED ---  -- FAILED -- W/CRTN'.                   02450000
025300     05  FILLER                  PIC  X(30)    VALUE              02460000
025400         ' -- AUDITED --- -- AUDITED ---'.                        02470000
025500     05  FILLER                  PIC  X(20)    VALUE SPACES.      02480000
025600     05  FILLER                  PIC  X(18)    VALUE              02490000
025700         'NOT    IN     PER'.                                     02500000
025800     05  FILLER                  PIC  X(02)    VALUE SPACES.      02510000
025900                                                                  02520000
026000 01  HEADING-LINE7.                                               02530000
026100     05  FILLER                  PIC  X(27)    VALUE              02540000
026200         '       COMPLT AUDITS PERCNT'.                           02550000
026300     05  FILLER                  PIC  X(35)    VALUE              02560000
026400         '   QTY  PERCNT   QTY  PERCNT REOPEN'.                   02570000
026500     05  FILLER                  PIC  X(38)    VALUE              02580000
026600         '   QTY   PERCNT   QTY   PERCNT  PROMPT'.                02590000
026700     05  FILLER                  PIC  X(30)    VALUE              02600000
026800         ' COMPLETE NEEDED  PROCESS HOUR'.                        02610000
026900     05  FILLER                  PIC  X(02)    VALUE SPACES.      02620000
027000                                                                  02630000
027100 01  SUBHEADING-LINE1.                                            02640000
027200     05  SH1-PKGNG-TYPE          PIC  X(17)    VALUE SPACES.      02650000
027300         88  SH1-BULK-CASEPACK                 VALUE              02660000
027400             '** BULK/CASEPACK:'.                                 02670000
027500         88  SH1-PREPACK                       VALUE              02680000
027600             '** PREPACK:      '.                                 02690000
027700         88  SH1-PACK-BY-STORE                 VALUE              02700000
027800             '** PACK BY STORE:'.                                 02710000
      *SB 12/11/13 - BEGIN PR#5148D                                             
027700         88  SH1-RFID                          VALUE              02700000
027800             '** RFID:         '.                                 02710000
      *SB 12/11/13 - END PR#5148D                                               
027900         88  SH1-DC-TOTALS                     VALUE              02720000
028000             '** DC TOTAL:     '.                                 02730000
028100     05  FILLER                  PIC  X(115)   VALUE SPACES.      02740000
028200                                                                  02750000
028300 01  DETAIL-LINES.                                                02760000
028400     05  DL-LINE1.                                                02770000
028500         10  DL1-VENDOR-RANK          PIC X(06) VALUE SPACES.     02780000
028600         10  FILLER                   PIC X(01) VALUE SPACES.     02790000
028700         10  DL1-TOT-PROMPT-AUDITS    PIC Z(5)9.                  02800000
028800         10  FILLER                   PIC X(01) VALUE SPACES.     02810000
028900         10  DL1-TOT-COMPLT-AUDITS    PIC Z(5)9.                  02820000
029000         10  FILLER                   PIC X(01) VALUE SPACES.     02830000
029100         10  DL1-PRMPT-COMPLT-PCT     PIC ZZ9.99.                 02840000
029200         10  FILLER                   PIC X(01) VALUE SPACES.     02850000
029300         10  DL1-AUD-PASSED-QTY       PIC Z(5)9.                  02860000
029400         10  FILLER                   PIC X(01) VALUE SPACES.     02870000
029500         10  DL1-AUD-PASSED-PCT       PIC ZZ9.99.                 02880000
029600         10  FILLER                   PIC X(01) VALUE SPACES.     02890000
029700         10  DL1-AUD-FAILED-QTY       PIC Z(5)9.                  02900000
029800         10  FILLER                   PIC X(01) VALUE SPACES.     02910000
029900         10  DL1-AUD-FAILED-PCT       PIC ZZ9.99.                 02920000
030000         10  FILLER                   PIC X(01) VALUE SPACES.     02930000
030100         10  DL1-AUD-REOPEN-QTY       PIC Z(5)9.                  02940000
030200         10  FILLER                   PIC X(01) VALUE SPACES.     02950000
030300         10  DL1-CTNS-AUDITED-QTY     PIC Z(6)9.                  02960000
030400         10  FILLER                   PIC X(01) VALUE SPACES.     02970000
030500         10  DL1-CTNS-AUDITED-PCT     PIC ZZ9.99.                 02980000
030600         10  FILLER                   PIC X(01) VALUE SPACES.     02990000
030700         10  DL1-UNIT-AUDITED-QTY     PIC Z(6)9.                  03000000
030800         10  FILLER                   PIC X(01) VALUE SPACES.     03010000
030900         10  DL1-UNIT-AUDITED-PCT     PIC ZZ9.99.                 03020000
031000         10  FILLER                   PIC X(01) VALUE SPACES.     03030000
031100         10  DL1-UNIT-PROMPT-QTY      PIC Z(6)9.                  03040000
031200         10  FILLER                   PIC X(01) VALUE SPACES.     03050000
031300         10  DL1-UNIT-COMPLETE-QTY    PIC Z(6)9.                  03060000
031400         10  FILLER                   PIC X(01) VALUE SPACES.     03070000
031500         10  DL1-UNIT-NOT-NEEDED-QTY  PIC Z(6)9.                  03080000
031600         10  FILLER                   PIC X(01) VALUE SPACES.     03090000
031700         10  DL1-UNIT-IN-PROCESS-QTY  PIC Z(6)9.                  03100000
031800         10  FILLER                   PIC X(01) VALUE SPACES.     03110000
031900         10  DL1-UNIT-PER-HOUR        PIC ZZZZ9.                  03120000
032000                                                                  03130000
032100*    THIS LINE RECAPS ALL THE VENDOR RANK TOTALS FOR THE DC       03140000
032200     05  DL-LINE2.                                                03150000
032300         10  DL2-VENDOR-RANKING       PIC X(06) VALUE SPACES.     03160000
032400         10  FILLER                   PIC X(01) VALUE SPACES.     03170000
032500         10  DL2-TOT-PROMPT-AUDITS    PIC Z(5)9.                  03180000
032600         10  FILLER                   PIC X(01) VALUE SPACES.     03190000
032700         10  DL2-TOT-COMPLT-AUDITS    PIC Z(5)9.                  03200000
032800         10  FILLER                   PIC X(01) VALUE SPACES.     03210000
032900         10  DL2-PRMPT-COMPLT-PCT     PIC ZZ9.99.                 03220000
033000         10  FILLER                   PIC X(01) VALUE SPACES.     03230000
033100         10  DL2-AUD-PASSED-QTY       PIC Z(5)9.                  03240000
033200         10  FILLER                   PIC X(01) VALUE SPACES.     03250000
033300         10  DL2-AUD-PASSED-PCT       PIC ZZ9.99.                 03260000
033400         10  FILLER                   PIC X(01) VALUE SPACES.     03270000
033500         10  DL2-AUD-FAILED-QTY       PIC Z(5)9.                  03280000
033600         10  FILLER                   PIC X(01) VALUE SPACES.     03290000
033700         10  DL2-AUD-FAILED-PCT       PIC ZZ9.99.                 03300000
033800         10  FILLER                   PIC X(01) VALUE SPACES.     03310000
033900         10  DL2-AUD-REOPEN-QTY       PIC Z(5)9.                  03320000
034000         10  FILLER                   PIC X(01) VALUE SPACES.     03330000
034100         10  DL2-CTNS-AUDITED-QTY     PIC Z(6)9.                  03340000
034200         10  FILLER                   PIC X(01) VALUE SPACES.     03350000
034300         10  DL2-CTNS-AUDITED-PCT     PIC ZZ9.99.                 03360000
034400         10  FILLER                   PIC X(01) VALUE SPACES.     03370000
034500         10  DL2-UNIT-AUDITED-QTY     PIC Z(6)9.                  03380000
034600         10  FILLER                   PIC X(01) VALUE SPACES.     03390000
034700         10  DL2-UNIT-AUDITED-PCT     PIC ZZ9.99.                 03400000
034800         10  FILLER                   PIC X(01) VALUE SPACES.     03410000
034900         10  DL2-UNIT-PROMPT-QTY      PIC Z(6)9.                  03420000
035000         10  FILLER                   PIC X(01) VALUE SPACES.     03430000
035100         10  DL2-UNIT-COMPLETE-QTY    PIC Z(6)9.                  03440000
035200         10  FILLER                   PIC X(01) VALUE SPACES.     03450000
035300         10  DL2-UNIT-NOT-NEEDED-QTY  PIC Z(6)9.                  03460000
035400         10  FILLER                   PIC X(01) VALUE SPACES.     03470000
035500         10  DL2-UNIT-IN-PROCESS-QTY  PIC Z(6)9.                  03480000
035600         10  FILLER                   PIC X(01) VALUE SPACES.     03490000
035700         10  DL2-UNIT-PER-HOUR        PIC ZZZZ9.                  03500000
035800                                                                  03510000
035900 01  TOTAL-LINES.                                                 03520000
036000     05  TL-LINE1.                                                03530000
036100         10  FILLER                   PIC X(06) VALUE 'TOTAL '.   03540000
036200         10  FILLER                   PIC X(07) VALUE SPACES.     03550000
036300         10  TL1-TOT-COMPLT-AUDITS    PIC Z(6)9.                  03560000
036400         10  FILLER                   PIC X(07) VALUE SPACES.     03570000
036500         10  TL1-AUD-PASSED-QTY       PIC Z(6)9.                  03580000
036600         10  FILLER                   PIC X(07) VALUE SPACES.     03590000
036700         10  TL1-AUD-FAILED-QTY       PIC Z(6)9.                  03600000
036800         10  FILLER                   PIC X(07) VALUE SPACES.     03610000
036900         10  TL1-AUD-REOPEN-QTY       PIC Z(6)9.                  03620000
037000         10  FILLER                   PIC X(09) VALUE SPACES.     03630000
037100         10  TL1-CTNS-AUDITED-PCT     PIC ZZ9.99.                 03640000
037200         10  FILLER                   PIC X(09) VALUE SPACES.     03650000
037300         10  TL1-UNIT-AUDITED-PCT     PIC ZZ9.99.                 03660000
037400         10  FILLER                   PIC X(08) VALUE SPACES.     03670000
037500         10  TL1-UNIT-COMPLETE-QTY    PIC Z(7)9.                  03680000
037600         10  FILLER                   PIC X(08) VALUE SPACES.     03690000
037700         10  TL1-UNIT-IN-PROCESS-QTY  PIC Z(7)9.                  03700000
037800                                                                  03710000
037900     05  TL-LINE2.                                                03720000
038000         10  FILLER                   PIC X(05) VALUE SPACES.     03730000
038100         10  TL2-TOT-PROMPT-AUDITS    PIC Z(7)9.                  03740000
038200         10  FILLER                   PIC X(08) VALUE SPACES.     03750000
038300         10  TL2-PRMPT-COMPLT-PCT     PIC ZZ9.99.                 03760000
038400         10  FILLER                   PIC X(08) VALUE SPACES.     03770000
038500         10  TL2-AUD-PASSED-PCT       PIC ZZ9.99.                 03780000
038600         10  FILLER                   PIC X(08) VALUE SPACES.     03790000
038700         10  TL2-AUD-FAILED-PCT       PIC ZZ9.99.                 03800000
038800         10  FILLER                   PIC X(07) VALUE SPACES.     03810000
038900         10  TL2-CTNS-AUDITED-QTY     PIC Z(7)9.                  03820000
039000         10  FILLER                   PIC X(07) VALUE SPACES.     03830000
039100         10  TL2-UNIT-AUDITED-QTY     PIC Z(7)9.                  03840000
039200         10  FILLER                   PIC X(07) VALUE SPACES.     03850000
039300         10  TL2-UNIT-PROMPT-QTY      PIC Z(7)9.                  03860000
039400         10  FILLER                   PIC X(08) VALUE SPACES.     03870000
039500         10  TL2-UNIT-NOT-NEEDED-QTY  PIC Z(7)9.                  03880000
039600         10  FILLER                   PIC X(08) VALUE SPACES.     03890000
039700         10  TL2-UNIT-PER-HOUR        PIC Z(5)9.                  03900000
039710                                                                          
039720     05  TL-LINE3.                                                        
039730         10  FILLER                   PIC X(61) VALUE SPACES.             
039740         10  FILLER                   PIC X(15) VALUE                     
039750                                      'CRTN UNIT QTY  '.                  
039760         10  TL3-CRTN-UNIT-QTY        PIC Z(8)9.                          
039770         10  FILLER                   PIC X(45) VALUE SPACES.             
039780                                                                          
039800                                                                  03910000
039900 01  MISCELLANEOUS-LINES.                                         03920000
040000     05  END-OF-REPORT-LINE.                                      03930000
040100         10  FILLER                  PIC  X(44)    VALUE SPACES.  03940000
040200         10  FILLER                  PIC  X(45)    VALUE          03950000
040300             '*******   E N D   O F   R E P O R T   *******'.     03960000
040400         10  FILLER                  PIC  X(43)    VALUE SPACES.  03970000
040500     05  NO-DATA-TO-REPORT-LINE.                                  03980000
040600         10  FILLER                  PIC  X(40)    VALUE SPACES.  03990000
040700         10  FILLER                  PIC  X(52)    VALUE          04000000
040800         '*******  N O   D A T A   T O   R E P O R T   *******'.  04010000
040900         10  FILLER                  PIC  X(40)    VALUE SPACES.  04020000
041000     05  BL-BLANK-LINE               PIC X(132)    VALUE SPACE.   04030000
041100                                                                  04040000
041200                                                                  04050000
041300                                                                  04060000
041400*    OCCURRENCE 1 IS FOR EACH PACKAGING TYPE                      04070000
041500*    OCCURRENCE 2 IS FOR THE WHOLE DC                             04080000
041600*    OCCURRENCES 3 THRU 20 ARE TO SUMMARIZE THE                   04090000
041700*         INDIVIDUAL VENDOR RANKS AT THE END OF EACH DC LISTING   04100000
041800 01  PT-TOTALS-TABLE.                                             04110000
041900     05  PT-TOTALS OCCURS 20 TIMES INDEXED BY PT-IDX,             04120000
042000                                              PT-SRCH-IDX,        04130000
042100                                              PT-END-IDX.         04140000
042200*    PT-END-IDX MARKS THE LAST VALID OCCURRENCE IN THE TABLE      04150000
042300         10  PT-VENDOR-RANK           PIC X(6).                   04160000
042400         10  PT-PROMPT-AUDITS         PIC S9(9) COMP.             04170000
042500         10  PT-COMPLETE-AUDITS       PIC S9(9) COMP.             04180000
042600         10  PT-AUD-CNT-COMPLT        PIC S9(9) COMP.             04190000
042700         10  PT-AUD-CNT-PROMPT        PIC S9(9) COMP.             04200000
042800         10  PT-PASSED-QTY            PIC S9(9) COMP.             04210000
042900         10  PT-FAILED-QTY            PIC S9(9) COMP.             04220000
043000         10  PT-REOPEN-QTY            PIC S9(9) COMP.             04230000
043100         10  PT-CRTNS-AUDITED-QTY     PIC S9(9) COMP.             04240000
043200         10  PT-UNITS-AUDITED-QTY     PIC S9(9) COMP.             04250000
043300         10  PT-UNITS-PROMPT-QTY      PIC S9(9) COMP.             04260000
043400         10  PT-UNITS-COMPLETE-QTY    PIC S9(9) COMP.             04270000
043500         10  PT-UNITS-NOT-NEEDED-QTY  PIC S9(9) COMP.             04280000
043600         10  PT-UNITS-INPROCESS-QTY   PIC S9(9) COMP.             04290000
043700         10  PT-UNITS-PER-HOUR        PIC S9(9) COMP.             04300000
043800         10  PT-AUD-CRTN-QTY-COMPLT   PIC S9(9) COMP.             04310000
043900         10  PT-TOTAL-MINUTES         PIC S9(14) COMP.            04320000
044000         10  PT-CRTN-CRTN-QTY         PIC S9(9) COMP.             04330000
044100         10  PT-CRTN-UNIT-QTY         PIC S9(9) COMP.             04340000
044200                                                                  04350000
044300         10  PT-PROMPT-COMPLETE-PCT   PIC S9(3)V99 COMP.          04360000
044400         10  PT-PASSED-PCT            PIC S9(3)V99 COMP.          04370000
044500         10  PT-FAILED-PCT            PIC S9(3)V99 COMP.          04380000
044600         10  PT-CARTONS-AUDITED-PCT   PIC S9(3)V99 COMP.          04390000
044700         10  PT-UNITS-AUDITED-PCT     PIC S9(3)V99 COMP.          04400000
044800/                                                                 04410000
044900     COPY DPWS004.                                                04470000
045000                                                                  04480000
045100     EXEC SQL                                                     04490000
045200          INCLUDE SQLCA                                           04500000
045300     END-EXEC.                                                    04510000
045400                                                                  04520000
045500     COPY SQLCA2.                                                 04530000
045600/                                                                 04540000
045700 PROCEDURE DIVISION.                                              04550000
045800                                                                  04560000
045900 0000-MAINLINE.                                                   04570000
046000     PERFORM 1000-INITIALIZE.                                     04580000
046100                                                                  04590000
046200     PERFORM 2000-MAIN-PROCESS                                    04600000
046300         UNTIL PS-EOF-EXTRACT                                     04610000
046400                                                                  04620000
046500     PERFORM 9000-END-PROCESS.                                    04630000
046600                                                                  04640000
046700     GOBACK.                                                      04650000
046800*                                                                 04660000
046900*                                                                 04670000
047000 1000-INITIALIZE.                                                 04680000
047100     OPEN INPUT CARTON-AUDIT-EXTRACT-FILE                         04690000
047200          OUTPUT REPORT-FILE                                      04700000
047300                 TOTAL-FILE.                                      04710000
047400                                                                  04720000
047500     EXEC SQL SET :PV-TMST = CURRENT TIMESTAMP END-EXEC           04720000
047600                                                                  04720000
047700     ACCEPT PV-TODAYS-DATE FROM DATE YYYYMMDD.                    04730000
047800     ACCEPT PV-TODAYS-TIME FROM TIME.                             04740000
047900                                                                  04750000
048000     MOVE PV-TODAYS-DATE-MM        TO DP132-RUN-MONTH.            04760000
048100     MOVE PV-TODAYS-DATE-DD        TO DP132-RUN-DAY.              04770000
048200     MOVE PV-TODAYS-DATE-CCYY      TO DP132-RUN-YEAR.             04780000
048300     MOVE PV-TODAYS-TIME-HH        TO DP132-RUN-HOUR.             04790000
048400     MOVE PV-TODAYS-TIME-MM        TO DP132-RUN-MINUTE.           04800000
048500     MOVE PC-CURRENT-PROGRAM-NAME  TO DP132-PROGRAM-NAME.         04810000
048600                                                                  04820000
048700     ACCEPT SU032-DATE-CONTROL-REC FROM SYSIN.                    04830000
048800                                                                  04840000
048900     DISPLAY 'CONTROL CARD IS:'                                   04850000
049000     DISPLAY SU032-DATE-CONTROL-REC                               04860000
049100                                                                  04870000
049200     STRING SU032-TO-DATE (6:2) '/'                               04880000
049300            SU032-TO-DATE (9:2) '/'                               04890000
049400            SU032-TO-DATE (1:4)                                   04900000
049500             DELIMITED BY SIZE                                    04910000
049600         INTO HL2-WEEK-ENDING-DATE                                04920000
049700                                                                  04930000
049800     EVALUATE SU032-RPT-TYPE                                      04940000
049900     WHEN 'W'                                                     04950000
050000         MOVE '  WEEK '               TO HL2-PERIOD-TYPE          04960000
050100     WHEN 'M'                                                     04970000
050200         MOVE ' MONTH '               TO HL2-PERIOD-TYPE          04980000
050300     WHEN 'S'                                                     04990000
050400         MOVE 'SEASON '               TO HL2-PERIOD-TYPE          05000000
050500     WHEN 'C'                                                     05010000
050600     WHEN 'F'                                                     05020000
050700         MOVE '  YEAR '               TO HL2-PERIOD-TYPE          05030000
050800     WHEN 'T'                                                     05031000
050900         MOVE '   YTD '               TO HL2-PERIOD-TYPE          05032000
051000     WHEN OTHER                                                   05033000
051100         MOVE '1000-INITIALIZE'       TO PV-PARAGRAPH-NAME        05034000
051200         MOVE 'INVALID REPORT TYPE  ' TO PV-ERROR-MESSAGE-1       05035000
051300         PERFORM 9200-ABEND                                       05036000
051400     END-EVALUATE                                                 05037000
051500                                                                  05038000
051600*    THE FIRST RECORD PROCESSED MUST BE AN AUDIT RECORD           05039000
051700     PERFORM 8000-READ-CARTON-EXTRACT                             05040000
051800         UNTIL SU030-AUDIT-RECORD                                 05050000
051900            OR PS-EOF-EXTRACT                                     05060000
052000                                                                  05070000
052100     IF PS-EOF-EXTRACT                                            05080000
052200         CONTINUE                                                 05090000
052300     ELSE                                                         05100000
052400*        MOVE SU030-DATE-CCYY                                     05110000
052500*                                     TO PV-FORMAT-DATE-YYYY      05120000
052600*        MOVE SU030-DATE-MM                                       05130000
052700*                                     TO PV-FORMAT-DATE-MM        05140000
052800*        MOVE SU030-DATE-DD                                       05150000
052900*                                     TO PV-FORMAT-DATE-DD        05160000
053000*        MOVE PV-FORMAT-DATE          TO HL2-WEEK-ENDING-DATE     05170000
053100         PERFORM 7000-SELECT-LOCATION                             05180000
053200         MOVE SU030-OPER-UNT-ID       TO HL3-OPER-UNT-ID          05190000
053300         MOVE XL071-LOC-NM            TO HL3-FCLTY-NME            05200000
053400     END-IF.                                                      05210000
053500                                                                  05220000
053600     PERFORM 8100-PRINT-REPORT-HEADINGS                           05230000
053700                                                                  05240000
053800     IF PS-EOF-EXTRACT                                            05250000
053900         SET PS-NO-DATA               TO TRUE                     05260000
054000         WRITE REPORT-RECORD                                      05270000
054100           FROM NO-DATA-TO-REPORT-LINE                            05280000
054200         AFTER ADVANCING 3 LINE                                   05290000
054300     ELSE                                                         05300000
054400                                                                  05310000
054500         MOVE PV-CURR-KEY             TO PV-PREV-KEY              05320000
054600         MOVE SU030-RECORD-TYPE       TO PV-PREV-REC-TYPE         05330000
054700         MOVE SU030-VENDOR-RANK       TO PV-SAVE-VENDOR-RANK      05340000
054800         MOVE SU030-PKGNG-TYPE        TO PV-SAVE-PKGNG-TYPE       05350000
054900                                                                  05360000
055000         SET PS-PRINT-SUBHEADER                                   05370000
055100         PS-DONT-PRINT-DC-TOTAL       TO TRUE                     05380000
055200                                                                  05390000
055300         INITIALIZE PT-TOTALS-TABLE                               05400000
055400     END-IF.                                                      05410000
055500     INITIALIZE SU035-RECORD.                                     05420000
055600                                                                  05430000
055700/                                                                 05440000
055800 2000-MAIN-PROCESS.                                               05450000
055900                                                                  05460000
056000*    C-RECORDS MUST HAVE MATCHING A-RECORDS.  A-RECORDS DO NOT    05470000
056100*    NEED MATCHING C-RECORDS                                      05480000
056200                                                                  05490000
056300     IF SU030-CARTON-RECORD AND                                   05500000
056400        PV-CURR-KEY > PV-PREV-KEY-A                               05510000
056500        CONTINUE                                                  05520000
056600     ELSE                                                         05530000
056700        EVALUATE TRUE                                             05540000
056800           WHEN PV-CURR-KEY = PV-PREV-KEY                         05550000
056900                PERFORM 2100-BUILD-DETAIL-LINE                    05560000
057000           WHEN PV-CURR-KEY > PV-PREV-KEY                         05570000
057100                PERFORM 3000-CONTROL-BREAKS                       05580000
057200        END-EVALUATE                                              05590000
057300     END-IF.                                                      05600000
057400                                                                  05610000
057500     MOVE SU030-RECORD-TYPE           TO PV-PREV-REC-TYPE.        05620000
057600     PERFORM 8000-READ-CARTON-EXTRACT.                            05630000
057700                                                                  05640000
057800 2100-BUILD-DETAIL-LINE.                                          05650000
057900                                                                  05660000
058000     IF PS-PRINT-SUBHEADER                                        05670000
058100         PERFORM 8300-SUBHEADER                                   05680000
058200     END-IF                                                       05690000
058300                                                                  05700000
058400     IF SU030-AUDIT-RECORD                                        05710000
058500         PERFORM 2110-MOVE-AUDIT-FIELDS                           05720000
058600     ELSE                                                         05730000
058700         IF SU030-CARTON-RECORD                                   05740000
058800             PERFORM 2120-MOVE-CARTON-FIELDS                      05750000
058900         END-IF                                                   05760000
059000     END-IF.                                                      05770000
059100                                                                  05780000
059200     PERFORM 4000-DETAIL-BUCKETS.                                 05790000
059300                                                                  05800000
059400 2110-MOVE-AUDIT-FIELDS.                                          05810000
059500                                                                  05820000
059600     MOVE SU030-PKGNG-TYPE            TO SU035-PKGNG-TYPE.        05830000
059700     MOVE SU030-VENDOR-RANK           TO SU035-VENDOR-RANKING.    05840000
059800     MOVE SU030-AUD-CNT-PRMT-CMPL-WEEK                            05850000
059900                                      TO DL1-TOT-PROMPT-AUDITS    05860000
060000                                         SU035-TOT-PROMPT-AUDITS. 05870000
060100                                                                  05880000
060200     MOVE SU030-AUD-CNT-COMPLT        TO DL1-TOT-COMPLT-AUDITS    05890000
060300                                         SU035-TOT-COMPLT-AUDITS. 05900000
060400                                                                  05910000
060500     EVALUATE SU032-RPT-TYPE                                      05920000
060600     WHEN 'W'                                                     05930000
060700         COMPUTE PV-PERCENT ROUNDED =                             05940000
060800            ( SU030-AUD-CNT-PRMT-CMPL-WEEK                        05950000
060900               / SU030-AUD-CNT-PROMPT ) * 100                     05960000
061000             ON SIZE ERROR                                        05970000
061100                 MOVE ZERO            TO DL1-PRMPT-COMPLT-PCT     05980000
061200             NOT ON SIZE ERROR                                    05990000
061300                 MOVE PV-PERCENT      TO DL1-PRMPT-COMPLT-PCT     06000000
061400         END-COMPUTE                                              06010000
061500     WHEN OTHER                                                   06020000
061600         COMPUTE PV-PERCENT ROUNDED =                             06030000
061700             ( ( SU030-AUD-CNT-PRMT-CMPL-MULT                     06040000
061800                             + SU030-AUD-CNT-PRMT-CMPL-WEEK)      06050000
061900               /  SU030-AUD-CNT-COMPLT ) * 100                    06060000
062000             ON SIZE ERROR                                        06070000
062100                 MOVE ZERO            TO DL1-PRMPT-COMPLT-PCT     06080000
062200             NOT ON SIZE ERROR                                    06090000
062300                 MOVE PV-PERCENT      TO DL1-PRMPT-COMPLT-PCT     06100000
062400         END-COMPUTE                                              06110000
062500     END-EVALUATE                                                 06120000
062600                                                                  06130000
062700     MOVE SU030-AUD-CNT-COMPLT-PASS   TO DL1-AUD-PASSED-QTY       06140000
062800                                         SU035-AUD-PASSED-QTY.    06150000
062900                                                                  06160000
063000     EVALUATE SU032-RPT-TYPE                                      06170000
063100     WHEN 'W'                                                     06180000
063200         COMPUTE PV-PERCENT ROUNDED =                             06190000
063300              ( SU030-AUD-CNT-COMPLT-PASS                         06200000
063400               /  SU030-AUD-CNT-COMPLT )                          06210000
063500                          * 100                                   06220000
063600             ON SIZE ERROR                                        06230000
063700                 MOVE ZERO                TO DL1-AUD-PASSED-PCT   06240000
063800             NOT ON SIZE ERROR                                    06250000
063900                 MOVE PV-PERCENT          TO DL1-AUD-PASSED-PCT   06260000
064000         END-COMPUTE                                              06270000
064100     WHEN OTHER                                                   06280000
064200         COMPUTE PV-PERCENT ROUNDED =                             06290000
064300              ( SU030-AUD-CNT-COMPLT-PASS                         06300000
064400               /  SU030-AUD-CNT-COMPLT)                           06310000
064500                          * 100                                   06320000
064600             ON SIZE ERROR                                        06330000
064700                 MOVE ZERO                TO DL1-AUD-PASSED-PCT   06340000
064800             NOT ON SIZE ERROR                                    06350000
064900                 MOVE PV-PERCENT          TO DL1-AUD-PASSED-PCT   06360000
065000         END-COMPUTE                                              06370000
065100     END-EVALUATE                                                 06380000
065200                                                                  06390000
065300                                                                  06400000
065400     MOVE SU030-AUD-CNT-COMPLT-FAIL   TO DL1-AUD-FAILED-QTY       06410000
065500                                         SU035-AUD-FAILED-QTY.    06420000
065600                                                                  06430000
065700     EVALUATE SU032-RPT-TYPE                                      06440000
065800     WHEN 'W'                                                     06450000
065900         COMPUTE PV-PERCENT ROUNDED =                             06460000
066000              ( SU030-AUD-CNT-COMPLT-FAIL                         06470000
066100               /   SU030-AUD-CNT-COMPLT)                          06480000
066200                              * 100                               06490000
066300             ON SIZE ERROR                                        06500000
066400                 MOVE ZERO            TO DL1-AUD-FAILED-PCT       06510000
066500             NOT ON SIZE ERROR                                    06520000
066600                 MOVE PV-PERCENT      TO DL1-AUD-FAILED-PCT       06530000
066700         END-COMPUTE                                              06540000
066800     WHEN OTHER                                                   06550000
066900         COMPUTE PV-PERCENT ROUNDED =                             06560000
067000              ( SU030-AUD-CNT-COMPLT-FAIL                         06570000
067100               /   SU030-AUD-CNT-COMPLT)                          06580000
067200                              * 100                               06590000
067300             ON SIZE ERROR                                        06600000
067400                 MOVE ZERO            TO DL1-AUD-FAILED-PCT       06610000
067500             NOT ON SIZE ERROR                                    06620000
067600                 MOVE PV-PERCENT      TO DL1-AUD-FAILED-PCT       06630000
067700         END-COMPUTE                                              06640000
067800     END-EVALUATE                                                 06650000
067900                                                                  06660000
068000     MOVE SU030-AUD-CNT-COMPLT-REOPEN TO DL1-AUD-REOPEN-QTY       06670000
068100                                         SU035-AUD-REOPEN-QTY.    06680000
068200                                                                  06690000
068300     MOVE SU030-AUD-CRTN-QTY-COMPLT   TO DL1-CTNS-AUDITED-QTY     06700000
068400                                         SU035-CTNS-AUDITED-QTY.  06710000
068500                                                                  06720000
068600     MOVE SU030-AUD-CRTN-QTY-COMPLT   TO PV-AUD-CRTN-QTY-COMPLT   06730000
068700                                        SU035-AUD-CRTN-QTY-COMPLT.06740000
068800                                                                  06750000
068900     MOVE SU030-AUD-UNIT-QTY-COMPLT   TO DL1-UNIT-AUDITED-QTY     06760000
069000                                         SU035-UNIT-AUDITED-QTY.  06770000
069100                                                                  06780000
069200     MOVE SU030-AUD-UNIT-QTY-COMPLT   TO PV-AUD-UNIT-QTY-COMPLT   06790000
069300                                                                  06800000
069400     MOVE SU030-UNIT-QTY-PROMPT       TO DL1-UNIT-PROMPT-QTY      06810000
069500                                         SU035-UNIT-PROMPT-QTY.   06820000
069600                                                                  06830000
069700     EVALUATE SU032-RPT-TYPE                                      06840000
069800     WHEN 'W'                                                     06850000
069900         MOVE SU030-UNIT-QTY-PRMT-CMPL-WEEK                       06860000
070000                                      TO DL1-UNIT-COMPLETE-QTY    06870000
070100                                         SU035-UNIT-COMPLETE-QTY  06880000
070200         MOVE SU030-UNIT-QTY-PRMT-NOND-WEEK                       06890000
070300                                      TO DL1-UNIT-NOT-NEEDED-QTY  06900000
070400                                         SU035-UNIT-NOT-NEEDED-QTY06910000
070500        MOVE SU030-UNIT-QTY-PRMT-INPR-WEEK                        06920000
070600                                      TO DL1-UNIT-IN-PROCESS-QTY  06930000
070700                                         SU035-UNIT-IN-PROCESS-QTY06940000
070800     WHEN OTHER                                                   06950000
070900         ADD SU030-UNIT-QTY-PRMT-CMPL-WEEK                        06960000
071000             SU030-UNIT-QTY-PRMT-CMPL-MULT                        06970000
071100                                  GIVING DL1-UNIT-COMPLETE-QTY    06980000
071200                                         SU035-UNIT-COMPLETE-QTY  06990000
071300         ADD SU030-UNIT-QTY-PRMT-NOND-WEEK                        07000000
071400              SU030-UNIT-QTY-PRMT-NOND-MULT                       07010000
071500                                  GIVING DL1-UNIT-NOT-NEEDED-QTY  07020000
071600                                         SU035-UNIT-NOT-NEEDED-QTY07030000
071700         ADD SU030-UNIT-QTY-PRMT-INPR-WEEK                        07040000
071800              SU030-UNIT-QTY-PRMT-INPR-MULT                       07050000
071900                                  GIVING DL1-UNIT-IN-PROCESS-QTY  07060000
072000                                         SU035-UNIT-IN-PROCESS-QTY07070000
072100     END-EVALUATE.                                                07080000
072200                                                                  07090000
072300     COMPUTE PV-UNITS-PER-HOUR ROUNDED =                          07100000
072400        (SU030-AUD-UNIT-QTY-COMPLT / SU030-TOTAL-MINUTES) * 60    07110000
072500         ON SIZE ERROR                                            07120000
072600             MOVE ZERO                TO DL1-UNIT-PER-HOUR        07130000
072700         NOT ON SIZE ERROR                                        07140000
072800             MOVE PV-UNITS-PER-HOUR   TO DL1-UNIT-PER-HOUR        07150000
072900     END-COMPUTE.                                                 07160000
073000                                                                  07170000
073100     MOVE SU030-AUD-CNT-PRMT-CMPL-MULT                            07180000
073200                                      TO SU035-COMPLETE-AUDITS.   07190000
073300     MOVE SU030-TOTAL-MINUTES         TO SU035-TOTAL-MINUTES.     07200000
073400     MOVE SU030-AUD-CNT-PROMPT        TO SU035-AUD-CNT-PROMPT.    07210000
073500                                                                  07220000
073600 2120-MOVE-CARTON-FIELDS.                                         07230000
073700     MOVE SU030-CRTN-CRTN-QTY         TO SU035-CRTN-CRTN-QTY.     07240000
073800     MOVE SU030-CRTN-UNIT-QTY         TO SU035-CRTN-UNIT-QTY.     07250000
073900     COMPUTE PV-PERCENT ROUNDED =                                 07260000
074000              ( PV-AUD-CRTN-QTY-COMPLT                            07270000
074100               / SU030-CRTN-CRTN-QTY)                             07280000
074200                              * 100                               07290000
074300         ON SIZE ERROR                                            07300000
074400             MOVE ZERO                TO DL1-CTNS-AUDITED-PCT     07310000
074500         NOT ON SIZE ERROR                                        07320000
074600             MOVE PV-PERCENT          TO DL1-CTNS-AUDITED-PCT     07330000
074700     END-COMPUTE.                                                 07340000
074800                                                                  07350000
074900*    MOVE PV-AUD-CRTN-QTY-COMPLT TO PV-DISPLAY-CRTN-COMPLT        07350100
075000*    MOVE SU030-CRTN-CRTN-QTY    TO PV-DISPLAY-CRTN-CRTN          07350200
075100*    DISPLAY  PV-DISPLAY-CRTN-COMPLT '/'                          07351000
075200*             PV-DISPLAY-CRTN-CRTN.                               07352001
075300                                                                  07353000
075400     COMPUTE PV-PERCENT ROUNDED =                                 07360000
075500              ( PV-AUD-UNIT-QTY-COMPLT                            07370000
075600               / SU030-CRTN-UNIT-QTY )                            07380000
075700                          * 100                                   07390000
075800         ON SIZE ERROR                                            07400000
075900             MOVE ZERO                TO DL1-UNIT-AUDITED-PCT     07410000
076000         NOT ON SIZE ERROR                                        07420000
076100             MOVE PV-PERCENT          TO DL1-UNIT-AUDITED-PCT     07430000
076200     END-COMPUTE.                                                 07440000
076300                                                                  07450000
076400                                                                  07451000
076500*    MOVE PV-AUD-UNIT-QTY-COMPLT TO PV-DISPLAY-CRTN-COMPLT        07452000
076600*    MOVE SU030-CRTN-UNIT-QTY    TO PV-DISPLAY-CRTN-CRTN          07453000
076700*    DISPLAY  PV-DISPLAY-CRTN-COMPLT '/'                          07454000
076800*             PV-DISPLAY-CRTN-CRTN.                               07455002
076900                                                                  07456000
077000 3000-CONTROL-BREAKS.                                             07460000
077100     EVALUATE TRUE                                                07470000
077200        WHEN PV-OPER-UNT-ID-CURR >  PV-OPER-UNT-ID-PREV           07480000
077300             PERFORM 3100-OPER-BREAK                              07490000
077400             MOVE SU030-PKGNG-TYPE        TO PV-SAVE-PKGNG-TYPE   07500000
077500        WHEN PV-PKGNG-TYPE-CURR  >  PV-PKGNG-TYPE-PREV            07510000
077600             PERFORM 3200-PKGNG-BREAK                             07520000
077700             MOVE SU030-PKGNG-TYPE        TO PV-SAVE-PKGNG-TYPE   07530000
077800        WHEN PV-VENDOR-RANK-CURR >  PV-VENDOR-RANK-PREV           07540000
077900             PERFORM 3300-RANK-BREAK                              07550000
078000     END-EVALUATE.                                                07560000
078100                                                                  07570000
078200 3100-OPER-BREAK.                                                 07580000
078300                                                                  07590000
078400     MOVE PV-SAVE-VENDOR-RANK         TO DL1-VENDOR-RANK          07600000
078500     PERFORM 8200-WRITE-DETAIL-LINE                               07610000
078600                                                                  07620000
078700     SET PT-IDX                       TO 1                        07630000
078800     PERFORM 4100-TOTALS                                          07640000
078900     INITIALIZE PT-TOTALS (1)                                     07650000
079000                                                                  07660000
079100     SET PS-PRINT-DC-TOTAL            TO TRUE                     07670000
079200     PERFORM 8300-SUBHEADER.                                      07680000
079300                                                                  07690000
079400                                                                  07700000
079500*    PRINT THE RECAP TOTALS FOR ALL VENDOR RANKINGS IN DC         07710000
079600     PERFORM VARYING PT-IDX FROM 3 BY 1                           07720000
079700                   UNTIL PT-IDX > PT-END-IDX                      07730000
079800         PERFORM 4200-TOTALS                                      07740000
079900         INITIALIZE PT-TOTALS (PT-IDX)                            07750000
080000     END-PERFORM                                                  07760000
080100                                                                  07770000
080200     SET PT-IDX                       TO 2                        07780000
080300     PERFORM 4100-TOTALS                                          07790000
080400     INITIALIZE PT-TOTALS (2)                                     07800000
080500                                                                  07810000
080600     IF PS-EOF-EXTRACT                                            07820000
080700         CONTINUE                                                 07830000
080800     ELSE                                                         07840000
080900         INITIALIZE PT-TOTALS-TABLE                               07850000
081000         PERFORM 7000-SELECT-LOCATION                             07860000
081100         MOVE SU030-OPER-UNT-ID       TO HL3-OPER-UNT-ID          07870000
081200         MOVE XL071-LOC-NM            TO HL3-FCLTY-NME            07880000
081300         PERFORM 8100-PRINT-REPORT-HEADINGS                       07890000
081400         MOVE PV-CURR-KEY             TO PV-PREV-KEY              07900000
081500         MOVE SU030-VENDOR-RANK       TO DL1-VENDOR-RANK          07910000
081600                                         PV-SAVE-VENDOR-RANK      07920000
081700         SET PS-PRINT-SUBHEADER       TO TRUE                     07930000
081800         PERFORM 2100-BUILD-DETAIL-LINE                           07940000
081900     END-IF.                                                      07950000
082000                                                                  07960000
082100 3200-PKGNG-BREAK.                                                07970000
082200                                                                  07980000
082300     MOVE PV-SAVE-VENDOR-RANK         TO DL1-VENDOR-RANK          07990000
082400     PERFORM 8200-WRITE-DETAIL-LINE                               08000000
082500                                                                  08010000
082600     SET PT-IDX                       TO 1                        08020000
082700     PERFORM 4100-TOTALS                                          08030000
082800     INITIALIZE PT-TOTALS (1)                                     08040000
082900                                                                  08050000
083500     SET PS-PRINT-SUBHEADER           TO TRUE.                    08110000
083000     INITIALIZE DL-LINE1                                          08060000
083100     MOVE PV-VENDOR-RANK-CURR         TO PV-VENDOR-RANK-PREV      08070000
083200     PERFORM 2100-BUILD-DETAIL-LINE                               08080000
083300     MOVE SU030-VENDOR-RANK           TO PV-SAVE-VENDOR-RANK.     08090000
083400                                                                  08100000
083600     MOVE PV-PKGNG-TYPE-CURR          TO PV-PKGNG-TYPE-PREV.      08120000
083700     MOVE PV-VENDOR-RANK-CURR         TO PV-VENDOR-RANK-PREV.     08130000
083800                                                                  08140000
083900 3300-RANK-BREAK.                                                 08150000
084000     MOVE PV-SAVE-VENDOR-RANK         TO DL1-VENDOR-RANK          08160000
084100     PERFORM 8200-WRITE-DETAIL-LINE                               08170000
084200                                                                  08180000
084300     INITIALIZE DL-LINE1                                          08190000
084400     MOVE PV-VENDOR-RANK-CURR         TO PV-VENDOR-RANK-PREV      08200000
084500     PERFORM 2100-BUILD-DETAIL-LINE                               08210000
084600     MOVE SU030-VENDOR-RANK           TO PV-SAVE-VENDOR-RANK.     08220000
084700                                                                  08230000
084800 4000-DETAIL-BUCKETS.                                             08240000
084900     IF SU030-AUDIT-RECORD                                        08250000
085000         PERFORM 4010-AUDIT-BUCKETS                               08260000
085100     ELSE                                                         08270000
085200         PERFORM 4020-CARTON-BUCKETS                              08280000
085300     END-IF.                                                      08290000
085400                                                                  08300000
085500 4010-AUDIT-BUCKETS.                                              08310000
085600     SET PT-SRCH-IDX                  TO 3                        08320000
085700                                                                  08330000
085800     SEARCH PT-TOTALS VARYING PT-SRCH-IDX                         08340000
085900     AT END                                                       08350000
086000         MOVE '2110-MOVE-AUDIT-FIELDS' TO PV-PARAGRAPH-NAME       08360000
086100         MOVE 'TABLE OVERFLOW       ' TO PV-ERROR-MESSAGE-1       08370000
086200         PERFORM 9200-ABEND                                       08380000
086300                                                                  08390000
086400     WHEN PT-VENDOR-RANK (PT-SRCH-IDX) = SPACES                   08400000
086500         MOVE SU030-VENDOR-RANK       TO PT-VENDOR-RANK           08410000
086600                                         (PT-SRCH-IDX)            08420000
086700         SET PT-END-IDX               TO PT-SRCH-IDX              08430000
086800     WHEN PT-VENDOR-RANK (PT-SRCH-IDX) = SU030-VENDOR-RANK        08440000
086900         CONTINUE                                                 08450000
087000     END-SEARCH.                                                  08460000
087100                                                                  08470000
087200     ADD SU030-AUD-CNT-PRMT-CMPL-WEEK TO PT-PROMPT-AUDITS (1)     08480000
087300                                         PT-PROMPT-AUDITS (2)     08490000
087400                                         PT-PROMPT-AUDITS         08500000
087500                                         (PT-SRCH-IDX).           08510000
087600     ADD SU030-AUD-CNT-PRMT-CMPL-MULT                             08520000
087700                                 TO PT-COMPLETE-AUDITS (1)        08530000
087800                                    PT-COMPLETE-AUDITS (2)        08540000
087900                                    PT-COMPLETE-AUDITS            08550000
088000                                         (PT-SRCH-IDX).           08560000
088100                                                                  08570000
088200     ADD SU030-AUD-CNT-COMPLT    TO PT-AUD-CNT-COMPLT (1)         08580000
088300                                    PT-AUD-CNT-COMPLT (2)         08590000
088400                                    PT-AUD-CNT-COMPLT             08600000
088500                                         (PT-SRCH-IDX).           08610000
088600                                                                  08620000
088700     ADD SU030-AUD-CNT-PROMPT    TO PT-AUD-CNT-PROMPT (1)         08630000
088800                                    PT-AUD-CNT-PROMPT (2)         08640000
088900                                    PT-AUD-CNT-PROMPT             08650000
089000                                         (PT-SRCH-IDX).           08660000
089100                                                                  08670000
089200     ADD SU030-AUD-CNT-COMPLT-PASS    TO PT-PASSED-QTY (1)        08680000
089300                                         PT-PASSED-QTY (2)        08690000
089400                                         PT-PASSED-QTY            08700000
089500                                         (PT-SRCH-IDX).           08710000
089600                                                                  08720000
089700     ADD SU030-AUD-CNT-COMPLT-FAIL    TO PT-FAILED-QTY (1)        08730000
089800                                         PT-FAILED-QTY (2)        08740000
089900                                         PT-FAILED-QTY            08750000
090000                                         (PT-SRCH-IDX).           08760000
090100                                                                  08770000
090200     ADD SU030-AUD-CNT-COMPLT-REOPEN  TO PT-REOPEN-QTY (1)        08780000
090300                                         PT-REOPEN-QTY (2)        08790000
090400                                         PT-REOPEN-QTY            08800000
090500                                         (PT-SRCH-IDX).           08810000
090600                                                                  08820000
090700     ADD SU030-AUD-CRTN-QTY-COMPLT                                08830000
090800                             TO PT-CRTNS-AUDITED-QTY (1)          08840000
090900                                PT-CRTNS-AUDITED-QTY (2)          08850000
091000                                PT-CRTNS-AUDITED-QTY              08860000
091100                                         (PT-SRCH-IDX).           08870000
091200                                                                  08880000
091300     ADD SU030-AUD-UNIT-QTY-COMPLT                                08890000
091400                                                                  08900000
091500                             TO PT-UNITS-AUDITED-QTY (1)          08910000
091600                                PT-UNITS-AUDITED-QTY (2)          08920000
091700                                PT-UNITS-AUDITED-QTY              08930000
091800                                         (PT-SRCH-IDX).           08940000
091900                                                                  08950000
092000     ADD SU030-UNIT-QTY-PROMPT                                    08960000
092100                             TO PT-UNITS-PROMPT-QTY (1)           08970000
092200                                PT-UNITS-PROMPT-QTY (2)           08980000
092300                                PT-UNITS-PROMPT-QTY               08990000
092400                                         (PT-SRCH-IDX).           09000000
092500                                                                  09010000
092600     EVALUATE SU032-RPT-TYPE                                      09020000
092700     WHEN 'W'                                                     09030000
092800         ADD SU030-UNIT-QTY-PRMT-CMPL-WEEK                        09040000
092900                                TO PT-UNITS-COMPLETE-QTY(1)       09050000
093000                                   PT-UNITS-COMPLETE-QTY(2)       09060000
093100                                   PT-UNITS-COMPLETE-QTY          09070000
093200                                         (PT-SRCH-IDX)            09080000
093300                                                                  09090000
093400         ADD SU030-UNIT-QTY-PRMT-NOND-WEEK                        09100000
093500                             TO PT-UNITS-NOT-NEEDED-QTY(1)        09110000
093600                                PT-UNITS-NOT-NEEDED-QTY(2)        09120000
093700                                PT-UNITS-NOT-NEEDED-QTY           09130000
093800                                         (PT-SRCH-IDX)            09140000
093900                                                                  09150000
094000         ADD SU030-UNIT-QTY-PRMT-INPR-WEEK                        09160000
094100                             TO PT-UNITS-INPROCESS-QTY(1)         09170000
094200                                PT-UNITS-INPROCESS-QTY(2)         09180000
094300                                PT-UNITS-INPROCESS-QTY            09190000
094400                                         (PT-SRCH-IDX)            09200000
094500                                                                  09210000
094600     WHEN OTHER                                                   09220000
094700         ADD SU030-UNIT-QTY-PRMT-CMPL-WEEK                        09230000
094800             SU030-UNIT-QTY-PRMT-CMPL-MULT                        09240000
094900                             TO PT-UNITS-COMPLETE-QTY(1)          09250000
095000                                PT-UNITS-COMPLETE-QTY(2)          09260000
095100                                PT-UNITS-COMPLETE-QTY             09270000
095200                                         (PT-SRCH-IDX)            09280000
095300                                                                  09290000
095400         ADD SU030-UNIT-QTY-PRMT-NOND-WEEK                        09300000
095500             SU030-UNIT-QTY-PRMT-NOND-MULT                        09310000
095600                             TO PT-UNITS-NOT-NEEDED-QTY(1)        09320000
095700                                PT-UNITS-NOT-NEEDED-QTY(2)        09330000
095800                                PT-UNITS-NOT-NEEDED-QTY           09340000
095900                                         (PT-SRCH-IDX)            09350000
096000                                                                  09360000
096100         ADD SU030-UNIT-QTY-PRMT-INPR-WEEK                        09370000
096200             SU030-UNIT-QTY-PRMT-INPR-MULT                        09380000
096300                             TO PT-UNITS-INPROCESS-QTY(1)         09390000
096400                                PT-UNITS-INPROCESS-QTY(2)         09400000
096500                                PT-UNITS-INPROCESS-QTY            09410000
096600                                         (PT-SRCH-IDX)            09420000
096700     END-EVALUATE.                                                09430000
096800                                                                  09440000
096900     ADD PV-AUD-CRTN-QTY-COMPLT                                   09450000
097000                             TO PT-AUD-CRTN-QTY-COMPLT (1)        09460000
097100                                PT-AUD-CRTN-QTY-COMPLT (2)        09470000
097200                                PT-AUD-CRTN-QTY-COMPLT            09480000
097300                                         (PT-SRCH-IDX).           09490000
097400                                                                  09500000
097500     ADD SU030-TOTAL-MINUTES TO PT-TOTAL-MINUTES (1)              09510000
097600                                PT-TOTAL-MINUTES (2)              09520000
097700                                PT-TOTAL-MINUTES                  09530000
097800                                         (PT-SRCH-IDX).           09540000
097900                                                                  09550000
098000 4020-CARTON-BUCKETS.                                             09560000
098100                                                                  09570000
098200     ADD SU030-CRTN-CRTN-QTY       TO PT-CRTN-CRTN-QTY (1)        09580000
098300                                      PT-CRTN-CRTN-QTY (2)        09590000
098400                                      PT-CRTN-CRTN-QTY            09600000
098500                                         (PT-SRCH-IDX).           09610000
098600     ADD SU030-CRTN-UNIT-QTY       TO PT-CRTN-UNIT-QTY (1)        09620000
098700                                      PT-CRTN-UNIT-QTY (2)        09630000
098800                                      PT-CRTN-UNIT-QTY            09640000
098900                                         (PT-SRCH-IDX).           09650000
098901                                                                          
098902** DMH - BEGIN                                                            
098910**   MOVE PT-CRTN-UNIT-QTY (1)                                            
098911**     TO PV-DISPLAY-CRTN-UNIT-QTY1                                       
098912**   MOVE PT-CRTN-UNIT-QTY (2)                                            
098913**     TO PV-DISPLAY-CRTN-UNIT-QTY2                                       
098920**   MOVE SU030-CRTN-UNIT-QTY                                             
098921**     TO PV-DISPLAY-SU030-CRTN-UNIT                                      
098922**   DISPLAY '***'                                                        
098923**           PV-DISPLAY-SU030-CRTN-UNIT                                   
098924**           '   '                                                        
098925**           PV-DISPLAY-CRTN-UNIT-QTY1                                    
098926**           '   '                                                        
098927**           PV-DISPLAY-CRTN-UNIT-QTY2.                                   
098931**                                                                13240000
098940** DMH - END                                                              
099000                                                                  09660000
099100 4100-TOTALS.                                                     09670000
099200                                                                  09680000
099300     MOVE PT-PROMPT-AUDITS (PT-IDX)   TO TL2-TOT-PROMPT-AUDITS    09690000
099400     MOVE PT-AUD-CNT-COMPLT (PT-IDX)  TO TL1-TOT-COMPLT-AUDITS    09700000
099500                                                                  09710000
099600     MOVE PT-PASSED-QTY (PT-IDX)      TO TL1-AUD-PASSED-QTY       09720000
099700                                                                  09730000
099800     MOVE PT-FAILED-QTY (PT-IDX)      TO TL1-AUD-FAILED-QTY       09740000
099900                                                                  09750000
100000     MOVE PT-REOPEN-QTY (PT-IDX)      TO TL1-AUD-REOPEN-QTY       09760000
100100                                                                  09770000
100200     MOVE PT-CRTNS-AUDITED-QTY (PT-IDX) TO TL2-CTNS-AUDITED-QTY   09780000
100300                                                                  09790000
100400     MOVE PT-UNITS-AUDITED-QTY (PT-IDX) TO TL2-UNIT-AUDITED-QTY   09800000
100410     MOVE PT-CRTN-UNIT-QTY (PT-IDX)     TO TL3-CRTN-UNIT-QTY      09800000
100500                                                                  09810000
100600     MOVE PT-UNITS-PROMPT-QTY (PT-IDX) TO TL2-UNIT-PROMPT-QTY     09820000
100700                                                                  09830000
100800     MOVE PT-UNITS-COMPLETE-QTY(PT-IDX) TO TL1-UNIT-COMPLETE-QTY  09840000
100900                                                                  09850000
101000     MOVE PT-UNITS-NOT-NEEDED-QTY (PT-IDX)                        09860000
101100                                      TO TL2-UNIT-NOT-NEEDED-QTY  09870000
101200                                                                  09880000
101300     MOVE PT-UNITS-INPROCESS-QTY (PT-IDX)                         09890000
101400                                      TO TL1-UNIT-IN-PROCESS-QTY  09900000
101500                                                                  09910000
101600     PERFORM 4110-COMPUTE-PERCENTAGES.                            09920000
101700                                                                  09930000
101800                                                                  09940000
101900 4110-COMPUTE-PERCENTAGES.                                        09950000
102000                                                                  09960000
102100     COMPUTE PV-PERCENT ROUNDED =                                 09970000
102200          ( PT-PROMPT-AUDITS (PT-IDX)                             09980000
102300           / PT-AUD-CNT-PROMPT (PT-IDX) ) * 100                   09990000
102400         ON SIZE ERROR                                            10000000
102500             MOVE ZERO                TO TL2-PRMPT-COMPLT-PCT     10010000
102600         NOT ON SIZE ERROR                                        10020000
102700             MOVE PV-PERCENT          TO TL2-PRMPT-COMPLT-PCT     10030000
102800     END-COMPUTE                                                  10040000
102900                                                                  10050000
103000                                                                  10060000
103100     COMPUTE PV-PERCENT ROUNDED =                                 10070000
103200          ( PT-PASSED-QTY (PT-IDX)                                10080000
103300           / PT-AUD-CNT-COMPLT (PT-IDX) )                         10090000
103400                          * 100                                   10100000
103500         ON SIZE ERROR                                            10110000
103600             MOVE ZERO                TO TL2-AUD-PASSED-PCT       10120000
103700         NOT ON SIZE ERROR                                        10130000
103800             MOVE PV-PERCENT          TO TL2-AUD-PASSED-PCT       10140000
103900     END-COMPUTE                                                  10150000
104000                                                                  10160000
104100                                                                  10170000
104200     COMPUTE PV-PERCENT ROUNDED =                                 10180000
104300          ( PT-FAILED-QTY (PT-IDX)                                10190000
104400           / PT-AUD-CNT-COMPLT (PT-IDX)  )                        10200000
104500                          * 100                                   10210000
104600         ON SIZE ERROR                                            10220000
104700             MOVE ZERO                TO TL2-AUD-FAILED-PCT       10230000
104800         NOT ON SIZE ERROR                                        10240000
104900             MOVE PV-PERCENT          TO TL2-AUD-FAILED-PCT       10250000
105000     END-COMPUTE                                                  10260000
105100                                                                  10270000
105200     COMPUTE PV-UNITS-PER-HOUR ROUNDED =                          10280000
105300        (PT-UNITS-AUDITED-QTY (PT-IDX)                            10290000
105400                   / PT-TOTAL-MINUTES (PT-IDX)) * 60              10300000
105500         ON SIZE ERROR                                            10310000
105600             MOVE ZERO                TO TL2-UNIT-PER-HOUR        10320000
105700         NOT ON SIZE ERROR                                        10330000
105800             MOVE PV-UNITS-PER-HOUR   TO TL2-UNIT-PER-HOUR        10340000
105900     END-COMPUTE.                                                 10350000
106000                                                                  10360000
106100* DMH                                                             10370000
106200     MOVE  PT-UNITS-AUDITED-QTY (PT-IDX)  TO  PV-DISP-NUMERIC-1.  10380000
106300     MOVE  PT-TOTAL-MINUTES (PT-IDX)      TO  PV-DISP-NUMERIC-2.  10390000
106400     MOVE  PV-UNITS-PER-HOUR              TO  PV-DISP-NUMERIC-3.  10400000
106500                                                                  10410000
106600*    DISPLAY '   UNITS - ' PV-DISP-NUMERIC-1                      10420000
106700*            '   MIN - '   PV-DISP-NUMERIC-2                      10430000
106800*            '   UPH - '   PV-DISP-NUMERIC-3.                     10440000
106900* DMH                                                             10450000
107000                                                                  10460000
107100     COMPUTE PV-PERCENT ROUNDED =                                 10470000
107200              ( PT-AUD-CRTN-QTY-COMPLT (PT-IDX)                   10480000
107300               / PT-CRTN-CRTN-QTY (PT-IDX) )                      10490000
107400                              * 100                               10500000
107500         ON SIZE ERROR                                            10510000
107600             MOVE ZERO                TO TL1-CTNS-AUDITED-PCT     10520000
107700         NOT ON SIZE ERROR                                        10530000
107800             MOVE PV-PERCENT          TO TL1-CTNS-AUDITED-PCT     10540000
107900     END-COMPUTE.                                                 10550000
108000                                                                  10560000
108100     COMPUTE PV-PERCENT ROUNDED =                                 10570000
108200              ( PT-UNITS-AUDITED-QTY (PT-IDX)                     10580000
108300               / PT-CRTN-UNIT-QTY (PT-IDX) )                      10590000
108400                          * 100                                   10600000
108500         ON SIZE ERROR                                            10610000
108600             MOVE ZERO                TO TL1-UNIT-AUDITED-PCT     10620000
108700         NOT ON SIZE ERROR                                        10630000
108800             MOVE PV-PERCENT          TO TL1-UNIT-AUDITED-PCT     10640000
108900     END-COMPUTE.                                                 10650000
109000                                                                  10660000
109100                                                                  10670000
109200     WRITE REPORT-RECORD FROM TL-LINE1 AFTER ADVANCING 2 LINES.   10680000
109300     WRITE REPORT-RECORD FROM TL-LINE2 AFTER ADVANCING 1 LINE.    10690000
109310     WRITE REPORT-RECORD FROM TL-LINE3 AFTER ADVANCING 1 LINE.    10690000
109400                                                                  10700000
109500*---------------------------------------------------------------  10710000
109600*   DC TOTALS                                                     10720000
109700*---------------------------------------------------------------  10730000
109800 4200-TOTALS.                                                     10740000
109900                                                                  10750000
110000     MOVE PT-VENDOR-RANK (PT-IDX)     TO DL2-VENDOR-RANKING       10760000
110100     MOVE PT-PROMPT-AUDITS (PT-IDX)   TO DL2-TOT-PROMPT-AUDITS    10770000
110200     MOVE PT-AUD-CNT-COMPLT(PT-IDX)   TO DL2-TOT-COMPLT-AUDITS    10780000
110300                                                                  10790000
110400     MOVE PT-PASSED-QTY (PT-IDX)      TO DL2-AUD-PASSED-QTY       10800000
110500                                                                  10810000
110600     MOVE PT-FAILED-QTY (PT-IDX)      TO DL2-AUD-FAILED-QTY       10820000
110700                                                                  10830000
110800     MOVE PT-REOPEN-QTY (PT-IDX)      TO DL2-AUD-REOPEN-QTY       10840000
110900                                                                  10850000
111000     MOVE PT-CRTNS-AUDITED-QTY (PT-IDX) TO DL2-CTNS-AUDITED-QTY   10860000
111100                                                                  10870000
111200     MOVE PT-UNITS-AUDITED-QTY(PT-IDX) TO DL2-UNIT-AUDITED-QTY    10880000
111300                                                                  10890000
111400     MOVE PT-UNITS-PROMPT-QTY (PT-IDX) TO DL2-UNIT-PROMPT-QTY     10891000
111500                                                                  10892000
111600     MOVE PT-UNITS-COMPLETE-QTY(PT-IDX) TO DL2-UNIT-COMPLETE-QTY  10893000
111700                                                                  10894000
111800     MOVE PT-UNITS-NOT-NEEDED-QTY (PT-IDX)                        10895000
111900                                      TO DL2-UNIT-NOT-NEEDED-QTY  10896000
112000                                                                  10897000
112100     MOVE PT-UNITS-INPROCESS-QTY (PT-IDX)                         10898000
112200                                      TO DL2-UNIT-IN-PROCESS-QTY  10899000
112300                                                                  10900000
112400     PERFORM 4210-COMPUTE-PERCENTAGES.                            10910000
112500                                                                  10920000
112600     WRITE REPORT-RECORD FROM DL-LINE2                            10930000
112700               AFTER ADVANCING 1 LINES.                           10940000
112800                                                                  10950000
112900 4210-COMPUTE-PERCENTAGES.                                        10960000
113000                                                                  10970000
113100     COMPUTE PV-PERCENT ROUNDED =                                 10980000
113200          ( PT-PROMPT-AUDITS (PT-IDX)                             10990000
113300           / PT-AUD-CNT-PROMPT (PT-IDX) ) * 100                   11000000
113400         ON SIZE ERROR                                            11010000
113500             MOVE ZERO                TO DL2-PRMPT-COMPLT-PCT     11020000
113600         NOT ON SIZE ERROR                                        11030000
113700             MOVE PV-PERCENT          TO DL2-PRMPT-COMPLT-PCT     11040000
113800     END-COMPUTE                                                  11050000
113900                                                                  11060000
114000                                                                  11070000
114100     COMPUTE PV-PERCENT ROUNDED =                                 11080000
114200          ( PT-PASSED-QTY (PT-IDX)                                11090000
114300           / PT-AUD-CNT-COMPLT (PT-IDX)  )                        11100000
114400                          * 100                                   11110000
114500         ON SIZE ERROR                                            11120000
114600             MOVE ZERO                TO DL2-AUD-PASSED-PCT       11130000
114700         NOT ON SIZE ERROR                                        11140000
114800             MOVE PV-PERCENT          TO DL2-AUD-PASSED-PCT       11150000
114900     END-COMPUTE                                                  11160000
115000                                                                  11170000
115100                                                                  11180000
115200     COMPUTE PV-PERCENT ROUNDED =                                 11190000
115300          ( PT-FAILED-QTY (PT-IDX)                                11200000
115400           / PT-AUD-CNT-COMPLT (PT-IDX)  )                        11210000
115500                          * 100                                   11220000
115600         ON SIZE ERROR                                            11230000
115700             MOVE ZERO                TO DL2-AUD-FAILED-PCT       11240000
115800         NOT ON SIZE ERROR                                        11250000
115900             MOVE PV-PERCENT          TO DL2-AUD-FAILED-PCT       11260000
116000     END-COMPUTE                                                  11270000
116100                                                                  11280000
116200     COMPUTE PV-UNITS-PER-HOUR ROUNDED =                          11290000
116300        (PT-UNITS-AUDITED-QTY (PT-IDX)                            11300000
116400                   / PT-TOTAL-MINUTES (PT-IDX)) * 60              11310000
116500         ON SIZE ERROR                                            11320000
116600             MOVE ZERO                TO DL2-UNIT-PER-HOUR        11330000
116700         NOT ON SIZE ERROR                                        11340000
116800             MOVE PV-UNITS-PER-HOUR   TO DL2-UNIT-PER-HOUR        11350000
116900     END-COMPUTE.                                                 11360000
117000                                                                  11370000
117100                                                                  11380000
117200     COMPUTE PV-PERCENT ROUNDED =                                 11390000
117300              ( PT-AUD-CRTN-QTY-COMPLT (PT-IDX)                   11400000
117400               / PT-CRTN-CRTN-QTY (PT-IDX) )                      11410000
117500                              * 100                               11420000
117600         ON SIZE ERROR                                            11430000
117700             MOVE ZERO                TO DL2-CTNS-AUDITED-PCT     11440000
117800         NOT ON SIZE ERROR                                        11450000
117900             MOVE PV-PERCENT          TO DL2-CTNS-AUDITED-PCT     11460000
118000     END-COMPUTE.                                                 11470000
118100                                                                  11480000
118200     COMPUTE PV-PERCENT ROUNDED =                                 11490000
118300              ( PT-UNITS-AUDITED-QTY (PT-IDX)                     11500000
118400               / PT-CRTN-UNIT-QTY (PT-IDX) )                      11510000
118500                          * 100                                   11520000
118600         ON SIZE ERROR                                            11530000
118700             MOVE ZERO                TO DL2-UNIT-AUDITED-PCT     11540000
118800         NOT ON SIZE ERROR                                        11550000
118900             MOVE PV-PERCENT          TO DL2-UNIT-AUDITED-PCT     11560000
119000     END-COMPUTE.                                                 11570000
119100                                                                  11580000
119200/                                                                 11590000
119300 7000-SELECT-LOCATION.                                            11600000
119400     INITIALIZE XL071-COMMAREA-REC.                               11605003
119500     MOVE SU030-OPER-UNT-ID     TO XL071-LOCATION-NUMBER          11606003
119600                                                                  11607003
119700     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         11608003
119800                                                                  11609003
119900     EVALUATE TRUE                                                11609103
120000     WHEN XL071-NO-ERRORS                                         11609203
120100         CONTINUE                                                         
120200     WHEN XL071-LOC-NOT-FOUND                                     11609403
120300     WHEN XL071-DC-ASGMT-NOT-FND                                  11609503
120400         MOVE 'UNKNOWN'             TO XL071-LOC-NM               11609603
120500     WHEN XL071-BAD-DB2-RETURN                                    11609703
120600         DISPLAY '7000-SELECT-LOCATION'                           11609803
120700         DISPLAY 'CALL LOCATION MOD '                             11609903
120800         DISPLAY 'XLT00010'                                       11610003
120900         MOVE XL071-SQLCA             TO SQLCA                    11610103
121000         PERFORM 9100-SQL-ABEND                                   11800000
121100     END-EVALUATE.                                                11610303
121200/                                                                 11820000
121300 8000-READ-CARTON-EXTRACT.                                        11830000
121400                                                                  11840000
121500     READ CARTON-AUDIT-EXTRACT-FILE INTO SU030-RECORD             11850000
121600         AT END                                                   11860000
121700             SET PS-EOF-EXTRACT       TO TRUE                     11870000
121800         NOT AT END                                               11880000
121900             IF SU030-AUDIT-RECORD                                11890000
122000                 MOVE SU030-OPER-UNT-ID TO PV-OPER-UNT-ID-A       11900000
122100                 MOVE SU030-PKGNG-TYPE TO PV-PKGNG-TYPE-A         11910000
122200                 MOVE SU030-VENDOR-RANK TO PV-VENDOR-RANK-A       11920000
122300                                                                  11930000
122400             END-IF                                               11940000
122500             MOVE SU030-OPER-UNT-ID   TO PV-OPER-UNT-ID-CURR      11950000
122600             MOVE SU030-PKGNG-TYPE    TO PV-PKGNG-TYPE-CURR       11960000
122700             MOVE SU030-VENDOR-RANK   TO PV-VENDOR-RANK-CURR      11970000
122800     END-READ.                                                    11980000
122900                                                                  11990000
123000/                                                                 12000000
123100 8100-PRINT-REPORT-HEADINGS.                                      12010000
123200     ADD 1                        TO PV-PAGE-COUNT.               12020000
123300     MOVE PV-PAGE-COUNT           TO DP132-PAGE-NUMBER.           12030000
123400                                                                  12040000
123500     MOVE ZERO                    TO PV-LINE-COUNT.               12050000
123600     MOVE 1                       TO DP132-REPORT-NUMBER.         12060000
123700                                                                  12070000
123800     WRITE REPORT-RECORD                                          12080000
123900       FROM DP132-STANDRD-HEADER-132-COLS                         12090000
124000         AFTER ADVANCING PAGE.                                    12100000
124100                                                                  12110000
124200     WRITE REPORT-RECORD                                          12120000
124300       FROM HEADING-LINE1                                         12130000
124400         AFTER ADVANCING 2 LINES.                                 12140000
124500                                                                  12150000
124600     WRITE REPORT-RECORD                                          12160000
124700       FROM HEADING-LINE2                                         12170000
124800         AFTER ADVANCING 1 LINE.                                  12180000
124900                                                                  12190000
125000     WRITE REPORT-RECORD                                          12200000
125100       FROM HEADING-LINE3                                         12210000
125200         AFTER ADVANCING 2 LINE.                                  12220000
125300                                                                  12230000
125400     WRITE REPORT-RECORD                                          12240000
125500       FROM HEADING-LINE4                                         12250000
125600         AFTER ADVANCING 1 LINE.                                  12260000
125700                                                                  12270000
125800     WRITE REPORT-RECORD                                          12280000
125900       FROM HEADING-LINE5                                         12290000
126000         AFTER ADVANCING 1 LINE.                                  12300000
126100                                                                  12310000
126200     WRITE REPORT-RECORD                                          12320000
126300       FROM HEADING-LINE6                                         12330000
126400         AFTER ADVANCING 1 LINE.                                  12340000
126500                                                                  12350000
126600     WRITE REPORT-RECORD                                          12360000
126700       FROM HEADING-LINE7                                         12370000
126800         AFTER ADVANCING 1 LINE.                                  12380000
126900                                                                  12390000
127000 8200-WRITE-DETAIL-LINE.                                          12400000
127100     IF  PV-LINE-COUNT > 43                                       12410000
127200       PERFORM 8100-PRINT-REPORT-HEADINGS                         12420000
127300     END-IF.                                                      12430000
127400                                                                  12440000
127500     WRITE REPORT-RECORD                                          12450000
127600       FROM DL-LINE1                                              12460000
127700         AFTER ADVANCING 1 LINE.                                  12470000
127800                                                                  12480000
127900     WRITE TOTAL-RECORD FROM SU035-RECORD.                        12490000
128000     INITIALIZE SU035-RECORD.                                     12500000
128100                                                                  12510000
128200 8300-SUBHEADER.                                                  12520000
128300                                                                  12530000
128400     IF PS-PRINT-DC-TOTAL                                         12540000
128500         SET SH1-DC-TOTALS            TO TRUE                     12550000
128600     ELSE                                                         12560000
128700     EVALUATE SU030-PKGNG-TYPE                                    12570000
128800         WHEN 'BC'                                                12580000
128900             SET SH1-BULK-CASEPACK    TO TRUE                     12590000
129000         WHEN 'PP'                                                12600000
129100             SET SH1-PREPACK          TO TRUE                     12610000
129200         WHEN 'PS'                                                12620000
129300             SET SH1-PACK-BY-STORE    TO TRUE                     12630000
      *SB 12/11/13 - BEGIN PR#5148D                                             
129200         WHEN 'RF'                                                12620000
129300             SET SH1-RFID             TO TRUE                     12630000
      *SB 12/11/13 - END PR#5148D                                               
129400     END-EVALUATE                                                 12640000
129500         SET PS-DONT-PRINT-SUBHEADER  TO TRUE                     12650000
129600     END-IF.                                                      12660000
129700                                                                  12670000
129800     IF PS-PRINT-DC-TOTAL                                         12680000
129900         SET PS-DONT-PRINT-DC-TOTAL   TO TRUE                     12690000
130000         WRITE REPORT-RECORD                                      12700000
130100             FROM SUBHEADING-LINE1                                12710000
130200                 AFTER ADVANCING 3 LINE                           12720000
130300     ELSE                                                         12730000
130400         WRITE REPORT-RECORD                                      12740000
130500             FROM SUBHEADING-LINE1                                12750000
130600                 AFTER ADVANCING 2 LINE                           12760000
130700     END-IF.                                                      12770000
130800                                                                  12780000
130900 9000-END-PROCESS.                                                12790000
131000                                                                  12800000
131100     IF PS-NO-DATA                                                12810000
131200         CONTINUE                                                 12820000
131300     ELSE                                                         12830000
131400         PERFORM 3100-OPER-BREAK                                  12840000
131500         WRITE REPORT-RECORD                                      12850000
131600             FROM END-OF-REPORT-LINE                              12860000
131700             AFTER ADVANCING 3 LINES                              12870000
131800     END-IF                                                       12880000
131900                                                                  12890000
132000                                                                  12900000
132100     CLOSE CARTON-AUDIT-EXTRACT-FILE                              12910000
132200           REPORT-FILE                                            12920000
132300           TOTAL-FILE.                                            12930000
132400                                                                  12940000
132500 9100-SQL-ABEND.                                                  12950000
132600     MOVE SQLCODE                     TO SQLCODE2.                12960000
132700     MOVE SQLERRD(3)                  TO SQLERRD3.                12970000
132800                                                                  12980000
132900     DISPLAY '** ABEND **         ** = SQLERROR'.                 12990000
133000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        13000000
133100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              13010000
133200     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                13020000
133300                                                                  13030000
133400     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                13040000
133500     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                13050000
133600     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 13060000
133700     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                13070000
133800                                                                  13080000
133900                                                                  13090000
134000     MOVE +4013                       TO ABEND-CODE.              13100000
134100     CALL 'ILBOABN0' USING ABEND-CODE.                            13110000
134200                                                                  13120000
134300 9200-ABEND.                                                      13130000
134400******************************************************************13140000
134500*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       13150000
134600******************************************************************13160000
134700     DISPLAY '***************************'.                       13170000
134800     DISPLAY '**       ABEND           **'.                       13180000
134900     DISPLAY '**  IN PROGRAM SUKRP028  **'.                       13190000
135000     DISPLAY '***************************'.                       13200000
135100     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        13210000
135200     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       13220000
135300     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       13230000
135400                                                                  13240000
135500     MOVE +4014                  TO PV-ABEND-CODE.                13250000
135600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         13260000
135700                                                                  13270000
