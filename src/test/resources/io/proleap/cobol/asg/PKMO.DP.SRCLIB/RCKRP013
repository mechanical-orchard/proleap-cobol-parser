000100***************************************************************** 00010072
000200 IDENTIFICATION DIVISION.                                         00020072
000300***************************************************************** 00030072
000400                                                                  00040072
000500 PROGRAM-ID.             RCKRP013.                                00050072
000600 AUTHOR.                 DENNIS STEFFEN - OMNI RESOURCES.         00060072
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070072
000800 DATE-WRITTEN            APRIL 1996.                              00080072
000900 DATE-COMPILED.                                                   00090072
001000                                                                  00100072
001100***************************************************************** 00110072
001200*                                                               * 00120072
001300*  THIS PROGRAM WILL CREATE THE WEEKLY VERIFIED POSTED RECEIPT  * 00130072
001400*  AUDIT REPORT FROM AN EXTRACT FILE.                           * 00140072
001500*                                                               * 00150072
001600***************************************************************** 00160072
001700*                                                               * 00170072
001800***************************************************************** 00180072
001900 ENVIRONMENT DIVISION.                                            00190072
002000***************************************************************** 00200072
002100                                                                  00210072
002200 CONFIGURATION SECTION.                                           00220072
002300                                                                  00230072
002400 SOURCE-COMPUTER.        IBM-3090.                                00240072
002500 OBJECT-COMPUTER.        IBM-3090.                                00250072
002600                                                                  00260072
002700 INPUT-OUTPUT SECTION.                                            00270072
002800                                                                  00280072
002900 FILE-CONTROL.                                                    00290072
003000                                                                  00300072
003100     SELECT CONDENSED-RC015-FILE                                  00310072
003200         ASSIGN TO IN01.                                          00320072
003300                                                                  00330072
003400     SELECT RECV-REPORT-FILE                                      00340072
003500         ASSIGN TO RPT01.                                         00350072
003600                                                                  00360072
003700                                                                  00370072
003800******************************************************************00380072
003900 DATA DIVISION.                                                   00390072
004000******************************************************************00400072
004100                                                                  00410072
004200 FILE SECTION.                                                    00420072
004300                                                                  00430072
004400 FD  CONDENSED-RC015-FILE                                         00440072
004500     RECORDING MODE IS F                                          00450072
004600     LABEL RECORDS ARE STANDARD                                   00460072
004700     BLOCK CONTAINS 0 RECORDS.                                    00470072
004800                                                                  00480072
004900 01  CONDENSED-RC015-RECORD      PIC X(135).                      00490072
005000                                                                  00500072
005100 FD  RECV-REPORT-FILE                                             00510072
005200     RECORDING MODE IS F                                          00520072
005300     BLOCK CONTAINS 0  RECORDS.                                   00530072
005400 01  RECV-REPORT-RECORD              PIC  X(132).                 00540072
005500                                                                  00550072
005600 WORKING-STORAGE SECTION.                                         00560072
005700                                                                  00570072
005800 01  FILLER.                                                      00580072
005900     05  FILLER                      PIC  X(36)    VALUE          00590072
006000         ' ***** WORKING STORAGE PGM=RCKRP013 '.                  00600072
006100     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   00610072
006200     05  FILLER                      PIC  X(10)    VALUE          00620072
006300         ' LOCATION='.                                            00630072
006400     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   00640072
006500     05  FILLER                      PIC  X(06)    VALUE          00650072
006600         ' *****'.                                                00660072
006700 EJECT                                                            00670072
006800 01  PROGRAM-SWITCHES.                                            00680072
006900     05  PS-NO-MORE-RECV-RECS-IND    PIC  X(01)    VALUE 'Y'.     00690072
007000         88  PS-MORE-RECV-RECS                     VALUE 'Y'.     00700072
007100         88  PS-NO-MORE-RECV-RECS                  VALUE 'N'.     00710072
007200     05  PS-END-OF-COMMENT-CSR-SW    PIC  X(01)    VALUE 'Y'.     00720072
007300         88  END-OF-COMMENT-CSR                    VALUE 'Y'.     00730072
007400         88  START-OF-COMMENT-CSR                  VALUE 'N'.     00740072
007500     05  PS-FIRST-COMMENT-PRT-SW     PIC  X(01)    VALUE 'Y'.     00750072
007600         88  FIRST-COMMENT-PRINTED                 VALUE 'Y'.     00760072
007700         88  FIRST-COMMENT-NOPRINT                 VALUE 'N'.     00770072
007800                                                                  00780072
007900 01  PC-CONSTANTS.                                                00790072
008000     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60.     00800072
008100     05  PC-2                        PIC S9(03)    VALUE +2       00810072
008200                                                   COMP-3.        00820072
008300     05  PC-4                        PIC S9(03)    VALUE +4       00830072
008400                                                   COMP-3.        00840072
008500     05  PC-60                       PIC S9(03)    VALUE +60      00850072
008600                                                   COMP-3.        00860072
008700     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00870072
008800                                                   'RCKRP013'.    00880072
008900     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       00890072
009000 EJECT                                                            00900072
009100                                                                  00910072
009200 01  PV-ACCUMULATOR-FIELDS.                                       00920072
009300     05  PV-SUB                  PIC S9(04) COMP VALUE ZERO.      00930072
009400     05  PV-PAGE-CNT             PIC S9(04)    VALUE ZERO         00940072
009500                                                   COMP-3.        00950072
009600     05  PV-LINE-CNT             PIC S9(04)    VALUE ZERO         00960072
009700                                                   COMP SYNC.     00970072
009800     05  PV-TABLE-STORE-COUNT    PIC S9(05)  VALUE ZERO           00980072
009900                                                     COMP-3.      00990072
010000     05  PV-TOT-ITM-QTY          PIC S9(7)    VALUE ZERO          01000072
010100                                                     COMP-3.      01010072
010200     05  PV-TOT-RTL-AMT          PIC S9(7)V99 VALUE ZERO          01020072
010300                                                     COMP-3.      01030072
010400     05  PV-ORD-NBR              PIC S9(9)    COMP.               01040072
010500     05  PV-ORD-LNE-NBR          PIC S9(9)    COMP.               01050072
010600     05  PV-REC-SEQ-NBR          PIC S9(9)    COMP.               01060072
010700 01  PV-SAVE-FIELDS.                                              01070072
010800     05  PV-SAVE-REC-LOC-CODE    PIC X(02)     VALUE SPACE.       01080072
010900     05  PV-SAVE-ADJ-CYC-NBR     PIC S9(9) COMP VALUE ZERO.       01090072
011000     05  PV-SAVE-TIMESTAMP.                                       01100072
011100         10  PV-SAVE-YYYY        PIC 9(04).                       01110072
011200         10  FILLER              PIC X.                           01120072
011300         10  PV-SAVE-MM          PIC 9(02).                       01130072
011400         10  FILLER              PIC X.                           01140072
011500         10  PV-SAVE-DD          PIC 9(02).                       01150072
011600     05  PV-SAVE-VERFYD-DATE.                                     01160072
011700         10  PV-SAVE-VERFYD-YYYY PIC 9(04) VALUE ZERO.            01170072
011800         10  PV-SAVE-VERFYD-MM   PIC 9(02) VALUE ZERO.            01180072
011900         10  PV-SAVE-VERFYD-DD   PIC 9(02) VALUE ZERO.            01190072
012000     05  PV-SAVE-VERFYD-UID      PIC X(08) VALUE SPACES.          01200072
012100     05  PV-SAVE-ADJUST-UID      PIC X(08) VALUE SPACES.          01210072
012200     05  PV-SAVE-PROCESS-AREA    PIC X(06) VALUE SPACES.          01220072
012300     05  PV-TEXT-EMPTY           PIC X(50) VALUE                  01230072
012400         '.                                                 '.    01240072
012500     05  PV-SAVE-NOTIF-NBR       PIC S9(9) COMP VALUE ZERO.       01250072
012600     05  PV-FREEFORM-TEXT        PIC X(250).                      01260072
012700     05  PV-TEXT-50  REDEFINES  PV-FREEFORM-TEXT                  01270072
012800                     OCCURS 5    PIC X(50).                       01280072
012900 EJECT                                                            01290072
013000                                                                  01300072
013100 01  PV-CONTROL-KEYS.                                             01310072
013200     05  PV-CURR-REC-LOC         PIC X(04) VALUE SPACES.          01320076
013300     05  PV-PREV-REC-LOC         PIC X(04).                       01330076
013400     05  PV-PREV-REC-LOC-N REDEFINES PV-PREV-REC-LOC              01340072
013500                                 PIC 9(04).                       01350076
013600     05  PV-CURR-KEY.                                             01360072
013700         10  PV-CURR-PO          PIC 9(08) VALUE ZERO.            01370072
013800         10  PV-CURR-RCVR        PIC 9(08) VALUE ZERO.            01380072
013900         10  PV-CURR-CYCLE-NBR   PIC S9(9) COMP VALUE ZERO.       01390072
014000         10  PV-CURR-LINE-NBR    PIC 9(08) VALUE ZERO.            01400072
014100     05  PV-PREV-KEY.                                             01410072
014200         10  PV-PREV-PO          PIC 9(08) VALUE ZERO.            01420072
014300         10  PV-PREV-RCVR        PIC 9(08) VALUE ZERO.            01430072
014400         10  PV-PREV-CYCLE-NBR   PIC S9(9) COMP VALUE ZERO.       01440072
014500         10  PV-PREV-LINE-NBR    PIC 9(08) VALUE ZERO.            01450072
014600     05  PV-PREV-PRINTED-PO-RCVR PIC X(12) VALUE SPACES.          01460072
014700                                                                  01470072
014800 01  PV-MISC-FIELDS.                                              01480072
014900     05  ABEND-CODE              PIC S9(04) VALUE ZERO            01490072
015000                                                   COMP SYNC.     01500072
015100     05  PV-ABEND-PARAGRAPH      PIC X(30) VALUE SPACES.          01510072
015200     05  PV-PARA                 PIC X(30) VALUE SPACES.          01520072
015300                                                                  01530072
015400     05  PV-PARAGRAPH-NAME       PIC X(30) VALUE SPACE.           01540072
015500     05  PV-DB2-OPERATION-ATTEMPTED                               01550072
015600                                 PIC X(30) VALUE SPACE.           01560072
015700     05  PV-OPER-UNT-ID          PIC S9(4) COMP.                  01570072
015800     05  PV-FCLTY-ID             PIC S9(4) COMP.                  01580072
015900                                                                  01590072
016000     05  PV-HOLD-UPD-TMST.                                        01600072
016100         10  PV-HOLD-UPD-TMST-CC     PIC X(02).                   01610072
016200         10  PV-HOLD-UPD-TMST-YY     PIC X(02).                   01620072
016300         10  FILLER                  PIC X(01).                   01630072
016400         10  PV-HOLD-UPD-TMST-MM     PIC X(02).                   01640072
016500         10  FILLER                  PIC X(01).                   01650072
016600         10  PV-HOLD-UPD-TMST-DD     PIC X(02).                   01660072
016700         10  FILLER                  PIC X(16).                   01670072
016800                                                                  01680072
016900     05  PV-HOLD-FORMAT-MMDDYY.                                   01690072
017000         10  PV-HOLD-FORMAT-MM       PIC X(02).                   01700072
017100         10  PV-HOLD-FORMAT-DD       PIC X(02).                   01710072
017200         10  PV-HOLD-FORMAT-YY       PIC X(02).                   01720072
017300                                                                  01730072
017400     05  PV-CURR-DATE-YYMMDD.                                     01740072
017500         10  PV-CURR-DATE-YY     PIC 9(02) VALUE ZERO.            01750072
017600         10  PV-CURR-DATE-MM     PIC 9(02) VALUE ZERO.            01760072
017700         10  PV-CURR-DATE-DD     PIC 9(02) VALUE ZERO.            01770072
017800                                                                  01780072
017900     05  PV-CURR-TIME.                                            01790072
018000         10  PV-CURR-TIME-HH     PIC 9(02)    VALUE ZERO.         01800072
018100         10  PV-CURR-TIME-MM     PIC 9(02)    VALUE ZERO.         01810072
018200         10  PV-CURR-TIME-SSHH   PIC 9(04)    VALUE ZERO.         01820072
018300                                                                  01830072
018400     05  PV-HOLD-CURR-DATE-MMDDYY    PIC  9(06)    VALUE ZERO.    01840072
018500     05  PV-HOLD-CURR-DATE-MMDDYY-X  REDEFINES                    01850072
018600         PV-HOLD-CURR-DATE-MMDDYY.                                01860072
018700         10  PV-HOLD-CURR-DATE-MM    PIC  9(02).                  01870072
018800         10  PV-HOLD-CURR-DATE-DD    PIC  9(02).                  01880072
018900         10  PV-HOLD-CURR-DATE-YY    PIC  9(02).                  01890072
019700*                                                                 01900074
019100 01  SD-SYSTEM-DATE.                                              01910072
019200     05  SD-SYSTEM-YEAR                  PIC  9(02)  VALUE ZEROS. 01920072
019300     05  SD-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. 01930072
019400     05  SD-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. 01940072
019500                                                                  01950072
019600 EJECT                                                            01960072
019700*                                                                 01970072
019800*  WORK AREA FOR FISCAL CALENDAR ROUTINE.                         01980072
019900*                                                                 01990072
020000     COPY DPWS500.                                                02000072
020100 EJECT                                                            02010072
020200     COPY DPWS004.                                                02020072
020300******************************************************************02030072
020400*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02040072
020500******************************************************************02050072
020600     COPY DPWS132O.                                               02060072
020700                                                                  02070072
020800 01  HEADING-LINES.                                               02080072
020900     05  HEADING-LINE-0.                                          02090072
021000         10  FILLER                  PIC  X(36)    VALUE SPACES.  02100072
021100         10  FILLER                  PIC  X(44)    VALUE          02110072
021200             'WEEKLY AUDIT OF ADJUSTMENTS MADE TO VERIFIED'.      02120072
021300         10  FILLER                  PIC  X(16)    VALUE          02130072
021400             ' POSTED RECEIPTS'.                                  02140072
021500         10  FILLER                  PIC  X(36)    VALUE SPACES.  02150072
021600                                                                  02160072
021700     05 LOCATION-HEADER.                                          02170072
021800         10  FILLER                  PIC X(21)     VALUE          02180072
021900             'RECEIVING LOCATION - '.                             02190072
022000         10  HLX-LOCATION            PIC X(12)     VALUE SPACES.  02200072
022100                                                                  02210072
022200     05  HEADING-LINE-1.                                          02220072
022300         10  FILLER                  PIC  X(16)    VALUE SPACES.  02230072
022400         10  FILLER                  PIC  X(44)    VALUE          02240072
022500             'PROCESS   LINE     ADJ        ADJ           '.      02250072
022600         10  FILLER                  PIC  X(16)    VALUE          02260072
022700             'VERIFY          '.                                  02270072
022800         10  FILLER                  PIC  X(56)    VALUE SPACES.  02280072
022900                                                                  02290072
023000     05  HEADING-LINE-2.                                          02300072
023100         10  FILLER                  PIC  X(46)    VALUE          02310072
023200             'P.O. NUMBER      AREA      NO      UNITS      '.    02320072
023300         10  FILLER                  PIC  X(46)    VALUE          02330072
023400             'RETAIL          DATE      VERIFIED BY         '.    02340072
023500         10  FILLER                  PIC  X(40)    VALUE SPACES.  02350072
023600                                                                  02360072
023700     05  HEADING-LINE-3.                                          02370072
023800         10  FILLER                  PIC  X(55)    VALUE SPACES.  02380072
023900         10  FILLER                  PIC  X(14)    VALUE          02390072
024000             'WEEK ENDING - '.                                    02400072
024100         10 HL3-WEEK-END-DATE        PIC  X(08)  VALUE SPACE.     02410072
024200         10  FILLER                  PIC  X(55)    VALUE SPACES.  02420072
024300                                                                  02430072
024400     05  DETAIL-LINE-1.                                           02440072
024500         10  DTL-PO-RCVR.                                         02450072
024600             15 DTL-PO               PIC X(08)     VALUE SPACES.  02460072
024700             15 DTL-DASH             PIC X(01)     VALUE '-'.     02470072
024800             15 DTL-RCVR-SEQ         PIC 9(03)     VALUE ZERO.    02480072
024900         10  FILLER                  PIC X(04)     VALUE SPACES.  02490072
025000         10  DTL-PROCESS-AREA        PIC X(06)     VALUE SPACES.  02500072
025100         10  FILLER                  PIC X(05)     VALUE SPACES.  02510072
025200         10  DTL-LINE-NBR            PIC 9(03)     VALUE ZEROES.  02520072
025300         10  FILLER                  PIC X(03)     VALUE SPACES.  02530072
025400         10  DTL-ADJ-UNITS           PIC ZZ,ZZ9-.                 02540072
025500         10  FILLER                  PIC X(04)     VALUE SPACES.  02550072
025600         10  DTL-ADJ-RETAIL          PIC ZZZ,ZZ9.99-.             02560072
025700         10  FILLER                  PIC X(03)     VALUE SPACES.  02570072
025800         10  DTL-VER-DATE.                                        02580072
025900             15  DTL-VER-MM          PIC 9(02).                   02590072
026000             15  DTL-SLASH-1         PIC X(01).                   02600072
026100             15  DTL-VER-DD          PIC 9(02).                   02610072
026200             15  DTL-SLASH-2         PIC X(01).                   02620072
026300             15  DTL-VER-YYYY        PIC 9(04).                   02630072
026400         10  FILLER                  PIC X(03)     VALUE SPACES.  02640072
026500         10  DTL-VERIFY-NAME.                                     02650072
026600             15  DTL-VER-FIRST-NAME  PIC X(12)     VALUE SPACES.  02660072
026700             15  FILLER              PIC X(01)     VALUE SPACES.  02670072
026800*            15  DTL-VER-MI          PIC X(01)     VALUE SPACES.  02680072
026900*            15  FILLER              PIC X(01)     VALUE SPACES.  02690072
027000             15  DTL-VER-LAST-NAME   PIC X(18)     VALUE SPACES.  02700072
027100                                                                  02710072
027200     05  DETAIL-ADJ-DATE-LINE.                                    02720072
027300         10  FILLER                  PIC X(15)     VALUE SPACES.  02730072
027400         10  FILLER                  PIC X(15)     VALUE          02740072
027500             'ADJUSTED:  ON: '.                                   02750072
027600         10  DTL-ADJ-DATE.                                        02760072
027700             15  DTL-ADJ-MM          PIC 9(02).                   02770072
027800             15  DTL-SLASH-3         PIC X(01).                   02780072
027900             15  DTL-ADJ-DD          PIC 9(02).                   02790072
028000             15  DTL-SLASH-4         PIC X(01).                   02800072
028100             15  DTL-ADJ-YYYY        PIC 9(04).                   02810072
028200         10  FILLER                  PIC X(06)     VALUE          02820072
028300             '  BY: '.                                            02830072
028400         10  DTL-ADJUST-NAME.                                     02840072
028500             15  DTL-ADJ-FIRST-NAME  PIC X(12)     VALUE SPACES.  02850072
028600             15  FILLER              PIC X(01)     VALUE SPACES.  02860072
028700*            15  DTL-ADJ-MI          PIC X(01)     VALUE SPACES.  02870072
028800*            15  FILLER              PIC X(01)     VALUE SPACES.  02880072
028900             15  DTL-ADJ-LAST-NAME   PIC X(18)     VALUE SPACES.  02890072
029000                                                                  02900072
029100     05  DETAIL-COMMENTS-LINE.                                    02910072
029200         10  FILLER                  PIC X(15)     VALUE SPACES.  02920072
029300         10  DTL-COMMENTS-HDR        PIC X(11)     VALUE          02930072
029400             'COMMENTS:  '.                                       02940072
029500         10  DTL-COMMENTS            PIC X(50)     VALUE SPACES.  02950072
029600                                                                  02960072
029700     05  DETAIL-REASON-LINE.                                      02970072
029800         10  FILLER                  PIC X(15)     VALUE SPACES.  02980072
029900         10  FILLER                  PIC X(11)     VALUE          02990072
030000             'REASON:    '.                                       03000072
030100         10  DTL-REASON-CODE         PIC 9(03).                   03010072
030200         10  FILLER                  PIC X(03)     VALUE ' - '.   03020072
030300         10  DTL-REASON-TEXT         PIC X(20)     VALUE SPACES.  03030072
030400         10  FILLER                  PIC X(14)     VALUE SPACES.  03040072
030500                                                                  03050072
030600                                                                  03060072
030700 01  MISCELLANEOUS-LINES.                                         03070072
030800     05  END-OF-REPORT-LINE.                                      03080072
030900         10  FILLER                  PIC  X(44)    VALUE SPACES.  03090072
031000         10  FILLER                  PIC  X(45)    VALUE          03100072
031100             '*******   E N D   O F   R E P O R T   *******'.     03110072
031200         10  FILLER                  PIC  X(43)    VALUE SPACES.  03120072
031300                                                                  03130072
031400     05  BLANK-LINE                  PIC X(132)    VALUE SPACES.  03140072
031500                                                                  03150072
031600******************************************************************03160072
031700*    RECDIS AUDIT EXTRACT FILE LAYOUT                             03170072
031800******************************************************************03180072
031900     COPY RCRD015.                                                03190072
032000******************************************************************03200072
032100*  DB2 COMMUNICATION AREA.                                        03210072
032200******************************************************************03220072
032300     EXEC SQL                                                     03230072
032400          INCLUDE SQLCA                                           03240072
032500     END-EXEC.                                                    03250072
032600     EJECT                                                        03260072
032700******************************************************************03270072
032800*  RECEIVER ITEM TALBE                                            03280072
032900******************************************************************03290072
033000     EXEC SQL                                                     03300072
033100          INCLUDE TRECITM                                         03310072
033200     END-EXEC.                                                    03320072
033300                                                                  03330072
033400     EJECT                                                        03340072
033500******************************************************************03350072
033600*  TROUBLE NOTIFICATION TABLE                                     03360072
033700******************************************************************03370072
033800     EXEC SQL                                                     03380072
033900          INCLUDE TTRBNTF                                         03390072
034000     END-EXEC.                                                    03400072
034100 EJECT                                                            03410072
034200******************************************************************03420072
034300*  TROUBLE DETAIL TABLE                                           03430072
034400******************************************************************03440072
034500     EXEC SQL                                                     03450072
034600          INCLUDE TTRBDTL                                         03460072
034700     END-EXEC.                                                    03470072
034800                                                                  03480072
034900                                                                  03490072
035000     EXEC SQL                                                     03500072
035100          DECLARE COMMENT-CSR CURSOR FOR                          03510072
035200          SELECT A.NOTIF_NBR                                      03520072
035300               , A.FREEFORM_TEXT                                  03530072
035400               , A.CRE_TMST                                       03540072
035500          FROM  TTRBDTL A                                         03550072
035600          WHERE A.NOTIF_NBR      =  :PV-SAVE-NOTIF-NBR            03560072
035700          ORDER BY                                                03570072
035800                A.CRE_TMST                                        03580072
035900     END-EXEC.                                                    03590072
036000                                                                  03600024
036100 EJECT                                                            03610072
036200******************************************************************03620072
036300*  TROUBLE REASON TABLE                                           03630072
036400******************************************************************03640072
036500     EXEC SQL                                                     03650072
036600          INCLUDE TTRBRSN                                         03660072
036700     END-EXEC.                                                    03670072
036800 EJECT                                                            03680072
036900******************************************************************03690072
037000*  WORKER TABLE                                                   03700072
037100******************************************************************03710072
037200     EXEC SQL                                                     03720072
037300          INCLUDE TWORKER                                         03730072
037400     END-EXEC.                                                    03740072
037500 EJECT                                                            03750072
037700*  XLT_LOC TABLE                                                  03760076
034300                                                                  03770076
034000     EXEC SQL                                                     03780076
034100          INCLUDE XLT00010                                        03790076
034200     END-EXEC.                                                    03800076
034300                                                                  03810076
034400     EXEC SQL                                                     03820076
034500         DECLARE STR-NBR-CSR  CURSOR FOR                          03830076
034600             SELECT LOC_NBR                                       03840076
034700                  , LOC_5_ABBR_NM                                 03850076
034800               FROM XLT_LOC                                       03860076
034900              WHERE                                               03870076
035000                   LOC_TYP_CDE IN ('DS', 'DC', 'CS', 'RV')        03880076
035100           ORDER BY LOC_NBR                                       03890076
035200     END-EXEC.                                                    03900076
035300                                                                  03910076
039300 EJECT                                                            03920072
039400 01  ST-STORE-TABLE.                                              03930072
039500     05  ST-STORE-ENTRY          OCCURS 1 TO 2000 TIMES           03940076
039600                                 DEPENDING ON                     03950072
039700                                 PV-TABLE-STORE-COUNT             03960072
039800                                 ASCENDING KEY IS                 03970072
039900                                 ST-STR-NBR                       03980072
040000                                 INDEXED BY ST-STR-IDX.           03990072
040100         10  ST-STR-NBR                  PIC S9(04) COMP.         04000076
040200         10  ST-CHAR10-ABBR-NAME         PIC X(10).               04010072
040300***************************************************************** 04020072
040400* PROCEDURE DIVISION.                                           * 04030072
040500***************************************************************** 04040072
040600 PROCEDURE DIVISION.                                              04050072
040700                                                                  04060072
040800 0000-MAINLINE-PROCESSING.                                        04070072
040900                                                                  04080072
041000     PERFORM 1000-INITIALIZATION.                                 04090072
041100                                                                  04100072
041200     PERFORM 2000-PROCESS-RECV-RPT-RECS                           04110072
041300       UNTIL PS-NO-MORE-RECV-RECS.                                04120072
041400                                                                  04130072
041500     PERFORM 2200-CYCLE-BREAK                                     04140072
041600                                                                  04150072
041700     WRITE RECV-REPORT-RECORD                                     04160072
041800       FROM END-OF-REPORT-LINE                                    04170072
041900         AFTER ADVANCING 2 LINES.                                 04180072
042000                                                                  04190072
042100     CLOSE CONDENSED-RC015-FILE                                   04200072
042200           RECV-REPORT-FILE.                                      04210072
042300                                                                  04220072
042400     STOP RUN.                                                    04230072
042500                                                                  04240072
042600 EJECT                                                            04250072
042700******************************************************************04260072
042800** READ THE DB2 CONTROL TABLE AND READ THE FIRST ASN EXTRACT REC *04270072
042900******************************************************************04280072
043000 1000-INITIALIZATION.                                             04290072
043100                                                                  04300072
043200     OPEN INPUT CONDENSED-RC015-FILE                              04310072
043300          OUTPUT RECV-REPORT-FILE.                                04320072
043400                                                                  04330072
043500     ACCEPT PV-CURR-DATE-YYMMDD FROM DATE.                        04340072
043600     MOVE PV-CURR-DATE-YY TO PV-HOLD-CURR-DATE-YY                 04350072
043700                             SD-SYSTEM-YEAR                       04360072
043800     MOVE PV-CURR-DATE-MM TO PV-HOLD-CURR-DATE-MM                 04370072
043900                             SD-SYSTEM-MONTH                      04380072
044000     MOVE PV-CURR-DATE-DD TO PV-HOLD-CURR-DATE-DD                 04390072
044100                             SD-SYSTEM-DAY                        04400072
044200                                                                  04410072
044300     ACCEPT PV-CURR-TIME FROM TIME.                               04420072
044400                                                                  04430072
044500     MOVE PV-CURR-DATE-MM        TO DP132O-RUN-MONTH.             04440072
044600     MOVE PV-CURR-DATE-DD        TO DP132O-RUN-DAY.               04450072
044700     MOVE PV-CURR-DATE-YY        TO DP132O-RUN-YEAR.              04460072
044800                                                                  04470072
044900     MOVE PV-CURR-TIME-HH        TO DP132O-RUN-HOUR.              04480072
045000     MOVE PV-CURR-TIME-MM        TO DP132O-RUN-MINUTE.            04490072
045100     MOVE PC-CURRENT-PROGRAM-NAME                                 04500072
045200                                 TO DP132O-PROGRAM-NAME.          04510072
045300                                                                  04520072
045400     PERFORM 7100-READ-INPUT.                                     04530072
045500     MOVE PV-CURR-REC-LOC        TO PV-PREV-REC-LOC.              04540072
045600     MOVE PV-CURR-KEY            TO PV-PREV-KEY.                  04550072
045700                                                                  04560072
045800     IF  PS-NO-MORE-RECV-RECS                                     04570072
045900         PERFORM 1100-GET-WEEK-END-DATE                           04580072
046000     ELSE                                                         04590072
046100         PERFORM 1110-GET-WEEK-END-DATE.                          04600072
046200                                                                  04610072
046300*  BUILD TABLE OF STORES                                          04620072
046400     PERFORM 7000-OPEN-STR-NBR-CSR.                               04630072
046500     PERFORM 7010-FETCH-STR-NBR-CSR.                              04640072
046600                                                                  04650072
046700     PERFORM 1200-LOAD-STR-NBR-TBL                                04660072
046800         VARYING ST-STR-IDX FROM 1 BY 1                           04670072
046900         UNTIL SQLCODE = +100                                     04680072
047000         OR ST-STR-IDX > 2000                                     04690080
047100     IF ST-STR-IDX > 2000                                         04700080
047200         PERFORM 7020-CLOSE-STR-NBR-CSR                           04710072
047300         MOVE '1200-LOAD-STR-NBR-TBL'                             04720072
047400                                 TO PV-PARAGRAPH-NAME             04730072
047500         MOVE 'WORKING STORAGE TABLE OVERFLOW'                    04740072
047600                                 TO PV-DB2-OPERATION-ATTEMPTED    04750072
047700         PERFORM 9100-SQL-ABEND                                   04760072
047800     END-IF.                                                      04770072
047900     PERFORM 7020-CLOSE-STR-NBR-CSR.                              04780072
048000                                                                  04790072
048100     PERFORM 8000-PRINT-HEADINGS.                                 04800072
048200 EJECT                                                            04810072
048300******************************************************************04820072
048400* 1100-GET-WEEK-END-DATE  USES DPKUT500 TO DETERMIN THE WEEK END  04830072
048500*      DATE.  THIS WILL BE USED IF THE INPUT FILE IS EMPTY.       04840072
048600******************************************************************04850072
048700 1100-GET-WEEK-END-DATE.                                          04860072
048800                                                                  04870024
048900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04880072
049000                                                                  04890072
049100     MOVE SD-SYSTEM-DATE            TO DPG51-SYSTEM-DATE          04900072
049200     MOVE PV-HOLD-CURR-DATE-MMDDYY  TO DPG52-LK-DATE-INPUT        04910072
049300                                                                  04920072
049400     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      04930072
049500*                                                                 04940072
049600     SET DPG51-DECREMENT-DATE       TO TRUE.                      04950072
049700     SET DPG52-LK-DTE-GREG          TO TRUE.                      04960072
049800                                                                  04970072
049900     MOVE 7                         TO DPG51-INCR-DECR-DAYS-9.    04980072
050000                                                                  04990072
050100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    05000072
050200                            DPG54 DPG55 DPG56.                    05010072
050300                                                                  05020072
050400     EVALUATE TRUE                                                05030073
050500* ************************************************************** *05040073
050600* *  THESE 3 CONDITIONS ARE MUTUALLY EXCLUSIVE BECAUSE THEY    * *05050073
050700* *  EACH DESCRIBE A POSSIBLE VALUE FOR THE SAME INDICATOR.    * *05060073
050800* ************************************************************** *05070073
050900         WHEN DPG54-NO-ERROR                                      05080073
051000             MOVE  DPG55-LAST-WKDY-GREG-FMT                       05090073
051100                                    TO HL3-WEEK-END-DATE          05100073
051200                                                                  05110073
051300         WHEN DPG54-WARNING-ERROR                                 05120073
051400             DISPLAY                                              05130073
051500            '** PROGRAM = RCKRP013 -- CALLED MODULE DPKUT500  **' 05140073
051600             DISPLAY                                              05150073
051700            '**                       RETURNED WARNING ERROR. **' 05160073
051800             DISPLAY                                              05170073
051900            '** PARAGRAPH = 1100-GET-WEEK-END-DATE            **' 05180073
052000             DISPLAY                                              05190073
052100            '** ERROR MESSAGE FROM CALLED MODULE ON NEXT LINE.**' 05200073
052200             DISPLAY                                              05210073
052300            '** ' DPG54-ERROR-MESSAGE                             05220073
052400             DISPLAY                                              05230073
052500            '** CALLING PARMLISTS DISPLAYED ON NEXT 2 LINES.  **' 05240073
052600             DISPLAY                                              05250073
052700            '** DPG51 : ' DPG51                                   05260073
052800             DISPLAY                                              05270073
052900            '** DPG52 : ' DPG52                                   05280073
053000             DISPLAY                                              05290073
053100            '** PLEASE INVESTIGATE FURTHER.                   **' 05300073
053200            '** '                                                 05310073
053300                                                                  05320073
053400         WHEN DPG54-SEVERE-ERROR                                  05330073
053500* ************************************************************** *05340073
053600* *      EXAMINE THE "SEVERE ERROR" RESPONSE FROM THE DATE RTN.* *05350073
053700* *      THESE CONDITIONS ARE *NOT* MUTUALLY EXCLUSIVE;        * *05360073
053800* *      EACH CONDITION IS DESCRIBED BY A SEPARATE INDICATOR.  * *05370073
053900* ****************************************************************05380073
054000             IF  DPG54-CALENDAR-TYPE-INVALID                      05390073
054100                 DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'         05400073
054200             END-IF                                               05410073
054300                                                                  05420073
054400             IF  DPG54-DATE-INVALID                               05430073
054500                 DISPLAY '** DPG54-DATE-INVALID'                  05440073
054600             END-IF                                               05450073
054700                                                                  05460073
054800             IF  DPG54-INCR-DECR-INVALID                          05470073
054900                 DISPLAY '** DPG54-INCR-DECR-INVALID'             05480073
055000             END-IF                                               05490073
055100                                                                  05500073
055200*            *************************************************** *05510073
055300*            * FOR "SEVERE ERROR" OF ANY REASON, ABEND         * *05520073
055400*            *************************************************** *05530073
055500             DISPLAY '** ABEND **'                                05540073
055600             DISPLAY                                              05550073
055700            '** PROGRAM = RCKRP013 -- CALLED MODULE DPKUT500  **' 05560073
055800             DISPLAY                                              05570073
055900            '**                       RETURNED SEVERE ERROR.  **' 05580073
056000             DISPLAY                                              05590073
056100            '** PARAGRAPH = 1100-GET-WEEK-END-DATE            **' 05600073
056200             DISPLAY                                              05610073
056300            '** ERROR MESSAGE FROM CALLED MODULE ON NEXT LINE.**' 05620073
056400             DISPLAY                                              05630073
056500            '** ' DPG54-ERROR-MESSAGE                             05640073
056600             DISPLAY                                              05650073
056700            '** CALLING PARMLISTS DISPLAYED ON NEXT 2 LINES.  **' 05660073
056800             DISPLAY                                              05670073
056900            '** DPG51 : ' DPG51                                   05680073
057000             DISPLAY                                              05690073
057100            '** DPG52 : ' DPG52                                   05700073
057200             DISPLAY                                              05710073
057300            '** '                                                 05720073
057400             MOVE +4003 TO ABEND-CODE                             05730073
057500             CALL 'ILBOABN0' USING ABEND-CODE                     05740073
057600                                                                  05750073
057700     END-EVALUATE.                                                05760073
057800                                                                  05770072
057900 EJECT                                                            05780072
058000******************************************************************05790072
058100* 1110-GET-WEEK-END-DATE  USES DPKUT500 TO DETERMIN THE WEEK END  05800072
058200*      DATE.  THIS WILL BE USED IF THE INPUT FILE HAS DATA.       05810072
058300******************************************************************05820072
058400 1110-GET-WEEK-END-DATE.                                          05830072
058500                                                                  05840024
058600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05850072
058700                                                                  05860072
058800     MOVE SD-SYSTEM-DATE            TO DPG51-SYSTEM-DATE          05870072
058900     MOVE RC015-UPD-TMST            TO PV-HOLD-UPD-TMST.          05880072
059000     MOVE PV-HOLD-UPD-TMST-MM       TO PV-HOLD-FORMAT-MM.         05890072
059100     MOVE PV-HOLD-UPD-TMST-DD       TO PV-HOLD-FORMAT-DD.         05900072
059200     MOVE PV-HOLD-UPD-TMST-YY       TO PV-HOLD-FORMAT-YY.         05910072
059300     MOVE PV-HOLD-FORMAT-MMDDYY     TO DPG52-LK-DATE-INPUT        05920072
059400                                                                  05930072
059500     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      05940072
059600     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     05950072
059700     SET DPG52-LK-DTE-GREG          TO TRUE.                      05960072
059800                                                                  05970072
059900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    05980072
060000                            DPG54 DPG55 DPG56.                    05990072
060100                                                                  06000072
060200     EVALUATE TRUE                                                06010073
060300* ************************************************************** *06020073
060400* *  THESE 3 CONDITIONS ARE MUTUALLY EXCLUSIVE BECAUSE THEY    * *06030073
060500* *  EACH DESCRIBE A POSSIBLE VALUE FOR THE SAME INDICATOR.    * *06040073
060600* ************************************************************** *06050073
060700         WHEN DPG54-NO-ERROR                                      06060073
060800             MOVE  DPG55-LAST-WKDY-GREG-FMT                       06070073
060900                                    TO HL3-WEEK-END-DATE          06080073
061000                                                                  06090073
061100         WHEN DPG54-WARNING-ERROR                                 06100073
061200             DISPLAY                                              06110073
061300            '** PROGRAM = RCKRP013 -- CALLED MODULE DPKUT500  **' 06120073
061400             DISPLAY                                              06130073
061500            '**                       RETURNED WARNING ERROR. **' 06140073
061600             DISPLAY                                              06150073
061700            '** PARAGRAPH = 1110-GET-WEEK-END-DATE            **' 06160073
061800             DISPLAY                                              06170073
061900            '** ERROR MESSAGE FROM CALLED MODULE ON NEXT LINE.**' 06180073
062000             DISPLAY                                              06190073
062100            '** ' DPG54-ERROR-MESSAGE                             06200073
062200             DISPLAY                                              06210073
062300            '** CALLING PARMLISTS DISPLAYED ON NEXT 2 LINES.  **' 06220073
062400             DISPLAY                                              06230073
062500            '** DPG51 : ' DPG51                                   06240073
062600             DISPLAY                                              06250073
062700            '** DPG52 : ' DPG52                                   06260073
062800             DISPLAY                                              06270073
062900            '** PLEASE INVESTIGATE FURTHER.                   **' 06280073
063000            '** '                                                 06290073
063100                                                                  06300073
063200         WHEN DPG54-SEVERE-ERROR                                  06310073
063300* ************************************************************** *06320073
063400* *      EXAMINE THE "SEVERE ERROR" RESPONSE FROM THE DATE RTN.* *06330073
063500* *      THESE CONDITIONS ARE *NOT* MUTUALLY EXCLUSIVE;        * *06340073
063600* *      EACH CONDITION IS DESCRIBED BY A SEPARATE INDICATOR.  * *06350073
063700* ****************************************************************06360073
063800             IF  DPG54-CALENDAR-TYPE-INVALID                      06370073
063900                 DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'         06380073
064000             END-IF                                               06390073
064100                                                                  06400073
064200             IF  DPG54-DATE-INVALID                               06410073
064300                 DISPLAY '** DPG54-DATE-INVALID'                  06420073
064400             END-IF                                               06430073
064500                                                                  06440073
064600             IF  DPG54-INCR-DECR-INVALID                          06450073
064700                 DISPLAY '** DPG54-INCR-DECR-INVALID'             06460073
064800             END-IF                                               06470073
064900                                                                  06480073
065000*            *************************************************** *06490073
065100*            * FOR "SEVERE ERROR" OF ANY REASON, ABEND         * *06500073
065200*            *************************************************** *06510073
065300             DISPLAY '** ABEND **'                                06520073
065400             DISPLAY                                              06530073
065500            '** PROGRAM = RCKRP013 -- CALLED MODULE DPKUT500  **' 06540073
065600             DISPLAY                                              06550073
065700            '**                       RETURNED SEVERE ERROR.  **' 06560073
065800             DISPLAY                                              06570073
065900            '** PARAGRAPH = 1110-GET-WEEK-END-DATE            **' 06580073
066000             DISPLAY                                              06590073
066100            '** ERROR MESSAGE FROM CALLED MODULE ON NEXT LINE.**' 06600073
066200             DISPLAY                                              06610073
066300            '** ' DPG54-ERROR-MESSAGE                             06620073
066400             DISPLAY                                              06630073
066500            '** CALLING PARMLISTS DISPLAYED ON NEXT 2 LINES.  **' 06640073
066600             DISPLAY                                              06650073
066700            '** DPG51 : ' DPG51                                   06660073
066800             DISPLAY                                              06670073
066900            '** DPG52 : ' DPG52                                   06680073
067000             DISPLAY                                              06690073
067100            '** '                                                 06700073
067200             MOVE +4003 TO ABEND-CODE                             06710073
067300             CALL 'ILBOABN0' USING ABEND-CODE                     06720073
067400                                                                  06730073
067500     END-EVALUATE.                                                06740073
067600                                                                  06750072
067700 EJECT                                                            06760072
067800 1200-LOAD-STR-NBR-TBL.                                           06770072
067900                                                                  06780072
068000     MOVE XLT00010-LOC-NBR       TO ST-STR-NBR (ST-STR-IDX)       06790076
068200     MOVE XLT00010-LOC-5-ABBR-NM TO ST-CHAR10-ABBR-NAME           06800076
068300                                   (ST-STR-IDX)                   06810072
068400                                                                  06820072
068500     ADD +1                      TO PV-TABLE-STORE-COUNT          06830072
068600                                                                  06840072
068700     PERFORM 7010-FETCH-STR-NBR-CSR.                              06850072
068800     EJECT                                                        06860072
068900 2000-PROCESS-RECV-RPT-RECS.                                      06870072
069000                                                                  06880072
069100     IF PV-CURR-REC-LOC = PV-PREV-REC-LOC                         06890072
069200         EVALUATE TRUE                                            06900072
069300         WHEN PV-CURR-KEY = PV-PREV-KEY                           06910072
069400             PERFORM 2400-ACCUM-FIELDS                            06920072
069500         WHEN OTHER                                               06930072
069600             IF PV-CURR-CYCLE-NBR NOT = PV-PREV-CYCLE-NBR         06940072
069700                 PERFORM 2200-CYCLE-BREAK                         06950072
069800                 MOVE PV-CURR-KEY TO PV-PREV-KEY                  06960072
069900                 INITIALIZE PV-TOT-ITM-QTY                        06970072
070000                            PV-TOT-RTL-AMT                        06980072
070100                 PERFORM 2400-ACCUM-FIELDS                        06990072
070200             ELSE                                                 07000072
070300             IF PV-CURR-LINE-NBR NOT = PV-PREV-LINE-NBR           07010072
070400                 PERFORM 2100-LINE-BREAK                          07020072
070500                 INITIALIZE PV-TOT-ITM-QTY                        07030072
070600                            PV-TOT-RTL-AMT                        07040072
070700                 PERFORM 2400-ACCUM-FIELDS                        07050072
070800             END-IF                                               07060072
070900             END-IF                                               07070072
071000             END-EVALUATE                                         07080072
071100     ELSE                                                         07090072
071200         PERFORM 2200-CYCLE-BREAK                                 07100072
071300         ADD 1 TO PC-LINE-LIMIT GIVING PV-LINE-CNT                07110072
071400         MOVE ZERO               TO PV-PAGE-CNT                   07120072
071500         MOVE PV-CURR-KEY        TO PV-PREV-KEY                   07130072
071600         MOVE PV-CURR-REC-LOC    TO PV-PREV-REC-LOC               07140072
071700         INITIALIZE PV-TOT-ITM-QTY                                07150072
071800                    PV-TOT-RTL-AMT                                07160072
071900         PERFORM 2400-ACCUM-FIELDS                                07170072
072000     END-IF                                                       07180072
072100                                                                  07190072
072200     PERFORM 7100-READ-INPUT.                                     07200072
072300                                                                  07210072
072400 2100-LINE-BREAK.                                                 07220072
072500     MOVE PV-PREV-PO             TO DTL-PO                        07230072
072600     MOVE '-'                    TO DTL-DASH                      07240072
072700     MOVE PV-PREV-RCVR           TO DTL-RCVR-SEQ                  07250072
072800     IF PV-PREV-PRINTED-PO-RCVR = DTL-PO-RCVR                     07260072
072900*         AND PV-CURR-CYCLE-NBR = PV-PREV-CYCLE-NBR               07270072
073000         MOVE SPACES             TO DTL-PO-RCVR                   07280072
073100                                    DTL-VER-DATE                  07290072
073200                                    DTL-VERIFY-NAME               07300072
073300                                    DTL-PROCESS-AREA              07310072
073400     ELSE                                                         07320072
073500         MOVE DTL-PO-RCVR        TO PV-PREV-PRINTED-PO-RCVR       07330072
073600         MOVE PV-SAVE-PROCESS-AREA                                07340072
073700                                 TO DTL-PROCESS-AREA              07350072
073800         MOVE PV-SAVE-VERFYD-MM  TO DTL-VER-MM                    07360072
073900         MOVE PV-SAVE-VERFYD-DD  TO DTL-VER-DD                    07370072
074000         MOVE PV-SAVE-VERFYD-YYYY                                 07380072
074100                                 TO DTL-VER-YYYY                  07390072
074200         MOVE '/'                TO DTL-SLASH-1                   07400072
074300                                    DTL-SLASH-2                   07410072
074400         PERFORM 7300-SELECT-TRECITM                              07420072
074500         IF RECITM-VRFD-USR-ID > SPACES                           07430072
074600             MOVE RECITM-VRFD-USR-ID TO WORKER-UID-NBR            07440072
074700             PERFORM 7200-GET-WORKER-NAME                         07450072
074800             IF SQLCODE = ZERO                                    07460072
074900                 MOVE WORKER-LAST-NAME                            07470072
075000                                 TO DTL-VER-LAST-NAME             07480072
075100                 MOVE WORKER-FIR-NAME                             07490072
075200                                 TO DTL-VER-FIRST-NAME            07500072
075300*                MOVE WORKER-MID-INIT-NAME                        07510072
075400*                                TO DTL-VER-MI                    07520072
075500             ELSE                                                 07530072
075600                 MOVE RECITM-VRFD-USR-ID                          07540072
075700                                 TO DTL-VERIFY-NAME               07550072
075800             END-IF                                               07560072
075900         ELSE                                                     07570072
076000             MOVE 'UNKNOWN'      TO DTL-VERIFY-NAME               07580072
076100         END-IF                                                   07590072
076200     END-IF.                                                      07600072
076300                                                                  07610072
076400     PERFORM 3000-PRINT-DTL-LINES.                                07620072
076500     MOVE PV-CURR-LINE-NBR       TO PV-PREV-LINE-NBR.             07630072
076600                                                                  07640072
076700 2200-CYCLE-BREAK.                                                07650072
076800     PERFORM 2100-LINE-BREAK                                      07660072
076900                                                                  07670072
077000     MOVE PV-SAVE-YYYY            TO DTL-ADJ-YYYY                 07680072
077100     MOVE PV-SAVE-MM              TO DTL-ADJ-MM                   07690072
077200     MOVE PV-SAVE-DD              TO DTL-ADJ-DD                   07700072
077300     MOVE '/'                     TO DTL-SLASH-3                  07710072
077400                                     DTL-SLASH-4                  07720072
077500                                                                  07730072
077600     IF PV-SAVE-ADJUST-UID > SPACES                               07740072
077700         MOVE PV-SAVE-ADJUST-UID TO WORKER-UID-NBR                07750072
077800         PERFORM 7200-GET-WORKER-NAME                             07760072
077900         IF SQLCODE = ZERO                                        07770072
078000             MOVE WORKER-LAST-NAME                                07780072
078100                                 TO DTL-ADJ-LAST-NAME             07790072
078200             MOVE WORKER-FIR-NAME                                 07800072
078300                                 TO DTL-ADJ-FIRST-NAME            07810072
078400*            MOVE WORKER-MID-INIT-NAME                            07820072
078500*                                TO DTL-ADJ-MI                    07830072
078600         ELSE                                                     07840072
078700             MOVE PV-SAVE-ADJUST-UID                              07850072
078800                                 TO DTL-ADJUST-NAME               07860072
078900         END-IF                                                   07870072
079000     ELSE                                                         07880072
079100         MOVE 'UNKNOWN'          TO DTL-ADJUST-NAME               07890072
079200     END-IF                                                       07900072
079300                                                                  07910072
079400                                                                  07920072
079500     WRITE RECV-REPORT-RECORD                                     07930072
079600       FROM DETAIL-ADJ-DATE-LINE                                  07940072
079700         AFTER ADVANCING 2 LINES.                                 07950072
079800     ADD +2                       TO PV-LINE-CNT.                 07960072
079900                                                                  07970072
080000     PERFORM 2220-TROUBLE.                                        07980072
080100                                                                  07990072
080200     PERFORM 2300-TROUBLE-COMMENTS.                               08000024
080300                                                                  08010072
080400     MOVE TRBRSN-TRBL-RSN-CDE    TO DTL-REASON-CODE               08020072
080500     MOVE TRBRSN-TRBL-LONG-DESC  TO DTL-REASON-TEXT               08030072
080600                                                                  08040072
080700     WRITE RECV-REPORT-RECORD                                     08050072
080800       FROM DETAIL-REASON-LINE                                    08060072
080900         AFTER ADVANCING 1 LINE.                                  08070072
081000     ADD +1 TO PV-LINE-CNT.                                       08080072
081100                                                                  08090072
081200     WRITE RECV-REPORT-RECORD                                     08100072
081300       FROM BLANK-LINE                                            08110072
081400         AFTER ADVANCING 1 LINE.                                  08120072
081500     ADD +1 TO PV-LINE-CNT.                                       08130072
081600                                                                  08140072
081700     MOVE PV-CURR-CYCLE-NBR      TO PV-PREV-CYCLE-NBR.            08150072
081800     MOVE SPACES TO PV-PREV-PRINTED-PO-RCVR.                      08160072
081900                                                                  08170072
082000 2400-ACCUM-FIELDS.                                               08180072
082100     ADD RC015-ADJ-ITM-QTY       TO PV-TOT-ITM-QTY                08190072
082200     ADD RC015-ADJ-RTL-EXTN-AMT  TO PV-TOT-RTL-AMT                08200072
082300                                                                  08210072
082400     MOVE RC015-ADJ-CYC-NBR      TO PV-SAVE-ADJ-CYC-NBR.          08220072
082500     MOVE RC015-UPD-TMST         TO PV-SAVE-TIMESTAMP             08230072
082600     MOVE RC015-VERFYD-DATE      TO PV-SAVE-VERFYD-DATE           08240072
082700     MOVE RC015-UPD-UID          TO PV-SAVE-ADJUST-UID            08250072
082800                                                                  08260072
082900     MOVE RC015-PRC-FCLTY-AREA-ID                                 08270072
083000                                 TO PV-SAVE-PROCESS-AREA.         08280072
083100                                                                  08290072
083200 3000-PRINT-DTL-LINES.                                            08300072
083300******************************************************************08310072
083400*  THIS PARAGRAPH WILL PRINT THE DETAIL LINE FOR A DEPARTMENT    *08320072
083500******************************************************************08330072
083600                                                                  08340072
083700     IF  PV-LINE-CNT > PC-LINE-LIMIT                              08350072
083800         PERFORM 8000-PRINT-HEADINGS                              08360072
083900     END-IF.                                                      08370072
084000                                                                  08380072
084100     MOVE PV-PREV-LINE-NBR       TO DTL-LINE-NBR                  08390072
084200     MOVE PV-TOT-ITM-QTY         TO DTL-ADJ-UNITS                 08400072
084300     MOVE PV-TOT-RTL-AMT         TO DTL-ADJ-RETAIL                08410072
084400     WRITE RECV-REPORT-RECORD                                     08420072
084500       FROM DETAIL-LINE-1                                         08430072
084600         AFTER ADVANCING 1 LINE.                                  08440072
084700     ADD +1 TO PV-LINE-CNT.                                       08450072
084800                                                                  08460072
084900 2220-TROUBLE.                                                    08470072
085000     INITIALIZE DCLTTRBNTF                                        08480072
085100                DCLTTRBDTL                                        08490072
085200                DCLTTRBRSN                                        08500072
085300                PV-FREEFORM-TEXT                                  08510072
085400                                                                  08520072
085500     MOVE  PV-PREV-CYCLE-NBR   TO TRBNTF-NOTIF-NBR                08530072
085600                                  PV-SAVE-NOTIF-NBR.              08540072
085700                                                                  08550072
085800      EXEC SQL                                                    08560072
085900         SELECT  C.TRBL_LONG_DESC                                 08570072
086000               , C.TRBL_RSN_CDE                                   08580072
086100           INTO :TRBRSN-TRBL-LONG-DESC                            08590072
086200              , :TRBRSN-TRBL-RSN-CDE                              08600072
086300           FROM  TTRBNTF A                                        08610072
086400               , TTRBRSN C                                        08620072
086500          WHERE  A.NOTIF_NBR = :TRBNTF-NOTIF-NBR                  08630072
086600            AND  A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                  08640072
086700      END-EXEC.                                                   08650072
086800                                                                  08660072
086900      EVALUATE TRUE                                               08670072
087000          WHEN SQLCODE = ZERO                                     08680072
087100          WHEN SQLCODE = +100                                     08690072
087200          WHEN SQLCODE = -904                                     08700072
087300          WHEN SQLCODE = -913                                     08710072
087400              CONTINUE                                            08720072
087500                                                                  08730072
087600          WHEN SQLWARN0 NOT = SPACES                              08740072
087700          WHEN SQLCODE < +0                                       08750072
087800          WHEN SQLCODE > +0                                       08760072
087900             MOVE '2220-TROUBLE-COMMENTS'                         08770072
088000                                 TO PV-PARAGRAPH-NAME             08780072
088100             MOVE 'ERROR ON SELECT TO TTRBNTF TABLE'              08790072
088200                                 TO PV-DB2-OPERATION-ATTEMPTED    08800072
088300             PERFORM 9100-SQL-ABEND                               08810072
088400      END-EVALUATE.                                               08820072
088500 EJECT                                                            08830072
088600                                                                  08840024
088700 2300-TROUBLE-COMMENTS.                                           08850072
088800                                                                  08860024
088900     SET START-OF-COMMENT-CSR TO TRUE.                            08870072
089000     SET FIRST-COMMENT-NOPRINT TO TRUE.                           08880072
089100     PERFORM 2310-OPEN-DETAIL-CURSOR.                             08890072
089200     PERFORM 2320-FETCH-DETAIL-CURSOR.                            08900072
089300     PERFORM 2330-PROCESS-DETAIL-CURSOR                           08910072
089400         UNTIL END-OF-COMMENT-CSR.                                08920072
089500     PERFORM 2340-CLOSE-DETAIL-CURSOR.                            08930072
089600                                                                  08940072
089700 EJECT                                                            08950072
089800 2310-OPEN-DETAIL-CURSOR.                                         08960072
089900                                                                  08970072
090000     MOVE '2310-OPEN-DETAIL-CURSOR'                               08980072
090100                                 TO PV-ABEND-PARAGRAPH.           08990072
090200     MOVE 'ERROR ON OPEN OF TTRBDTL CURSOR '                      09000072
090300                                 TO PV-DB2-OPERATION-ATTEMPTED.   09010024
090400     EXEC SQL                                                     09020072
090500         OPEN COMMENT-CSR                                         09030072
090600     END-EXEC.                                                    09040072
090700     EVALUATE TRUE                                                09050072
090800       WHEN SQLCODE = ZEROS                                       09060072
090900         CONTINUE                                                 09070072
091000       WHEN OTHER                                                 09080072
091100         DISPLAY PV-ABEND-PARAGRAPH                               09090072
091200         PERFORM 9100-SQL-ABEND                                   09100072
091300     END-EVALUATE.                                                09110072
091400 EJECT                                                            09120072
091500 2320-FETCH-DETAIL-CURSOR.                                        09130072
091600                                                                  09140072
091700     MOVE '3200-FETCH-CURSOR   '                                  09150072
091800                                 TO PV-ABEND-PARAGRAPH.           09160072
091900     MOVE 'ERROR ON FETCH OF TTRBDTL CURSOR'                      09170072
092000                                 TO PV-DB2-OPERATION-ATTEMPTED.   09180024
092100     EXEC SQL                                                     09190072
092200          FETCH COMMENT-CSR                                       09200072
092300          INTO  :TRBDTL-NOTIF-NBR                                 09210072
092400               ,:PV-FREEFORM-TEXT                                 09220072
092500               ,:TRBDTL-CRE-TMST                                  09230072
092600     END-EXEC.                                                    09240072
092700                                                                  09250072
092800     EVALUATE TRUE                                                09260072
092900       WHEN SQLCODE = ZEROS                                       09270072
093000         CONTINUE                                                 09280072
093100       WHEN SQLCODE = +100                                        09290072
093200           SET END-OF-COMMENT-CSR TO TRUE                         09300072
093300       WHEN OTHER                                                 09310072
093400         DISPLAY PV-ABEND-PARAGRAPH                               09320072
093500         PERFORM 9100-SQL-ABEND                                   09330072
093600     END-EVALUATE.                                                09340072
093700 EJECT                                                            09350072
093800 2330-PROCESS-DETAIL-CURSOR.                                      09360072
093900                                                                  09370072
094000     IF PV-TEXT-50 (1) > SPACES AND                               09380072
094100        PV-TEXT-50 (1) NOT = PV-TEXT-EMPTY                        09390072
094200         IF FIRST-COMMENT-PRINTED                                 09400072
094300             MOVE  '               '                              09410072
094400                                 TO DTL-COMMENTS-HDR              09420072
094500         ELSE                                                     09430072
094600             MOVE  'COMMENTS:      '                              09440072
094700                                 TO DTL-COMMENTS-HDR              09450072
094800             SET FIRST-COMMENT-PRINTED TO TRUE                    09460072
094900         END-IF                                                   09470072
095000         MOVE PV-TEXT-50 (1) TO DTL-COMMENTS                      09480072
095100         WRITE RECV-REPORT-RECORD                                 09490072
095200               FROM DETAIL-COMMENTS-LINE                          09500072
095300               AFTER ADVANCING 1 LINE                             09510072
095400               ADD +1 TO PV-LINE-CNT                              09520072
095500     END-IF                                                       09530072
095600                                                                  09540072
095700     IF PV-TEXT-50 (1) > SPACES AND                               09550072
095800        PV-TEXT-50 (1) NOT = PV-TEXT-EMPTY                        09560072
095900         IF PV-TEXT-50 (2) > SPACES                               09570072
096000             MOVE SPACES TO DTL-COMMENTS-HDR                      09580072
096100             MOVE PV-TEXT-50 (2) TO DTL-COMMENTS                  09590072
096200             WRITE RECV-REPORT-RECORD                             09600072
096300                   FROM DETAIL-COMMENTS-LINE                      09610072
096400                   AFTER ADVANCING 1 LINE                         09620072
096500                   ADD +1 TO PV-LINE-CNT                          09630072
096600         END-IF                                                   09640072
096700         IF PV-TEXT-50 (3) > SPACES                               09650072
096800             MOVE SPACES TO DTL-COMMENTS-HDR                      09660072
096900             MOVE PV-TEXT-50 (3) TO DTL-COMMENTS                  09670072
097000             WRITE RECV-REPORT-RECORD                             09680072
097100                   FROM DETAIL-COMMENTS-LINE                      09690072
097200                   AFTER ADVANCING 1 LINE                         09700072
097300                   ADD +1 TO PV-LINE-CNT                          09710072
097400         END-IF                                                   09720072
097500         IF PV-TEXT-50 (4) > SPACES                               09730072
097600             MOVE SPACES TO DTL-COMMENTS-HDR                      09740072
097700             MOVE PV-TEXT-50 (4) TO DTL-COMMENTS                  09750072
097800             WRITE RECV-REPORT-RECORD                             09760072
097900                   FROM DETAIL-COMMENTS-LINE                      09770072
098000                   AFTER ADVANCING 1 LINE                         09780072
098100                   ADD +1 TO PV-LINE-CNT                          09790072
098200         END-IF                                                   09800072
098300         IF PV-TEXT-50 (5) > SPACES                               09810072
098400             MOVE SPACES TO DTL-COMMENTS-HDR                      09820072
098500             MOVE PV-TEXT-50 (5) TO DTL-COMMENTS                  09830072
098600             WRITE RECV-REPORT-RECORD                             09840072
098700                   FROM DETAIL-COMMENTS-LINE                      09850072
098800                   AFTER ADVANCING 1 LINE                         09860072
098900                   ADD +1 TO PV-LINE-CNT                          09870072
099000         END-IF                                                   09880072
099100     END-IF.                                                      09890072
099200                                                                  09900072
099300     PERFORM 2320-FETCH-DETAIL-CURSOR.                            09910072
099400 EJECT                                                            09920072
099500 2340-CLOSE-DETAIL-CURSOR.                                        09930072
099600                                                                  09940072
099700     MOVE '2340-CLOSE-DETAIL-CURSOR'                              09950072
099800                                 TO PV-ABEND-PARAGRAPH.           09960072
099900     MOVE 'ERROR ON CLOSE OF TTRBDTL CURSOR'                      09970072
100000                                 TO PV-DB2-OPERATION-ATTEMPTED.   09980072
100100     EXEC SQL                                                     09990072
100200         CLOSE COMMENT-CSR                                        10000072
100300     END-EXEC.                                                    10010072
100400     EVALUATE TRUE                                                10020072
100500       WHEN SQLCODE = ZEROS                                       10030072
100600         CONTINUE                                                 10040072
100700       WHEN OTHER                                                 10050072
100800         DISPLAY PV-ABEND-PARAGRAPH                               10060072
100900         PERFORM 9100-SQL-ABEND                                   10070072
101000     END-EVALUATE.                                                10080072
101100 EJECT                                                            10090072
101200 7000-OPEN-STR-NBR-CSR.                                           10100072
101300     EXEC SQL                                                     10110072
101400         OPEN STR-NBR-CSR                                         10120072
101500     END-EXEC.                                                    10130072
101600                                                                  10140072
101700     EVALUATE TRUE                                                10150072
101800         WHEN SQLCODE = ZERO                                      10160072
101900             CONTINUE                                             10170072
102000         WHEN SQLWARN0 NOT = SPACE                                10180072
102100         WHEN SQLCODE < ZERO                                      10190072
102200         WHEN SQLCODE > ZERO                                      10200072
102300             MOVE '7000-OPEN-STR-NBR-CSR'                         10210072
102400                                 TO PV-PARAGRAPH-NAME             10220072
102500             MOVE 'ERROR ON OPEN OF STORE-CURSOR'                 10230072
102600                                 TO PV-DB2-OPERATION-ATTEMPTED    10240072
102700             PERFORM 9100-SQL-ABEND                               10250072
102800     END-EVALUATE.                                                10260072
102900*                                                                 10270072
103000     SKIP3                                                        10280072
103100 7010-FETCH-STR-NBR-CSR.                                          10290072
103200     INITIALIZE DCLXLT00010                                       10300076
103300                                                                  10310072
103400     EXEC SQL                                                     10320072
103500         FETCH  STR-NBR-CSR                                       10330072
103600          INTO  :XLT00010-LOC-NBR                                 10340076
103700             ,  :XLT00010-LOC-5-ABBR-NM                           10350076
103800     END-EXEC.                                                    10360072
103900                                                                  10370072
104000     EVALUATE TRUE                                                10380072
104100         WHEN SQLCODE = ZERO                                      10390072
104200         WHEN SQLCODE = +100                                      10400072
104300             CONTINUE                                             10410072
104400         WHEN SQLWARN0 NOT = SPACE                                10420072
104500         WHEN SQLCODE < ZERO                                      10430072
104600         WHEN SQLCODE > ZERO                                      10440072
104700             MOVE '7010-FETCH-STR-NBR-CSR'                        10450072
104800                 TO PV-PARAGRAPH-NAME                             10460072
104900             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 10470072
105000-                 'FROM THE STR-NBR-CSR'                          10480072
105100                              TO  PV-DB2-OPERATION-ATTEMPTED      10490072
105200             PERFORM 9100-SQL-ABEND                               10500072
105300     END-EVALUATE.                                                10510072
105400     SKIP3                                                        10520072
105500 7020-CLOSE-STR-NBR-CSR.                                          10530072
105600     EXEC SQL                                                     10540072
105700         CLOSE STR-NBR-CSR                                        10550072
105800     END-EXEC.                                                    10560072
105900                                                                  10570072
106000     EVALUATE TRUE                                                10580072
106100         WHEN SQLCODE = ZERO                                      10590072
106200             CONTINUE                                             10600072
106300         WHEN SQLWARN0 NOT = SPACE                                10610072
106400         WHEN SQLCODE < ZERO                                      10620072
106500         WHEN SQLCODE > ZERO                                      10630072
106600             MOVE '7020-CLOSE-STR-NBR-CSR'                        10640072
106700                                 TO PV-PARAGRAPH-NAME             10650072
106800             MOVE 'ATTEMPTING TO CLOSE STR-NBR-CSR'               10660072
106900                                 TO PV-DB2-OPERATION-ATTEMPTED    10670072
107000             PERFORM 9100-SQL-ABEND                               10680072
107100     END-EVALUATE.                                                10690072
107200 EJECT                                                            10700072
107300                                                                  10710072
107400******************************************************************10720072
107500*  READ THE AUDIT EXTRACT FILE.                                  *10730072
107600******************************************************************10740072
107700 7100-READ-INPUT.                                                 10750072
107800                                                                  10760072
107900     MOVE '7000'                  TO PGM-LOCATION.                10770072
108000     MOVE '7100-READ-INPUT           '                            10780072
108100                                  TO PV-ABEND-PARAGRAPH.          10790072
108200                                                                  10800072
108300     READ CONDENSED-RC015-FILE INTO RC015-TRECDIS-ADJ-RECORD      10810072
108400         AT END                                                   10820072
108500           SET PS-NO-MORE-RECV-RECS                               10830072
108600                                 TO TRUE                          10840072
108700         NOT AT END                                               10850072
108800           MOVE RC015-REC-LOC-CDE-4CH                             10860076
108900                                 TO PV-CURR-REC-LOC               10870072
109000           MOVE RC015-ORD-NBR    TO PV-CURR-PO                    10880072
109100           MOVE RC015-REC-SEQ-NBR                                 10890072
109200                                 TO PV-CURR-RCVR                  10900072
109300           MOVE RC015-ADJ-CYC-NBR                                 10910072
109400                                 TO PV-CURR-CYCLE-NBR             10920072
109500           MOVE RC015-ORD-LNE-NBR                                 10930072
109600                                 TO PV-CURR-LINE-NBR              10940072
109700     END-READ.                                                    10950072
109800/                                                                 10960072
109900 7200-GET-WORKER-NAME.                                            10970072
110000                                                                  10980072
110100     EXEC SQL                                                     10990072
110200         SELECT LAST_NAME                                         11000072
110300               , FIR_NAME                                         11010072
110400               , MID_INIT_NAME                                    11020072
110500         INTO    :WORKER-LAST-NAME                                11030072
110600               , :WORKER-FIR-NAME                                 11040072
110700               , :WORKER-MID-INIT-NAME                            11050072
110800         FROM TWORKER                                             11060072
110900         WHERE UID_NBR = :WORKER-UID-NBR AND                      11070072
111000                 OPERCO_NBR = '03'                                11080072
111100     END-EXEC.                                                    11090072
111200                                                                  11100072
111300     EVALUATE TRUE                                                11110072
111400         WHEN SQLCODE = ZERO                                      11120072
111500         WHEN SQLCODE = +100                                      11130072
111600         WHEN SQLCODE = -811                                      11140072
111700             CONTINUE                                             11150072
111800         WHEN SQLWARN0 NOT = SPACE                                11160072
111900         WHEN SQLCODE < ZERO                                      11170072
112000         WHEN SQLCODE > ZERO                                      11180072
112100             MOVE '7200-GET-WORKER-NAME'                          11190072
112200                                 TO PV-PARAGRAPH-NAME             11200072
112300             MOVE 'ERROR ON SELECT TWORKER DATA'                  11210072
112400                                 TO PV-DB2-OPERATION-ATTEMPTED    11220072
112500             PERFORM 9100-SQL-ABEND                               11230072
112600     END-EVALUATE.                                                11240072
112700*                                                                 11250072
112800 7300-SELECT-TRECITM.                                             11260072
112900                                                                  11270072
113000     MOVE DTL-PO   TO PV-ORD-NBR.                                 11280072
113100     MOVE DTL-RCVR-SEQ TO PV-REC-SEQ-NBR.                         11290072
113200     MOVE PV-PREV-LINE-NBR TO PV-ORD-LNE-NBR.                     11300072
113300                                                                  11310072
113400     EXEC SQL                                                     11320072
113500         SELECT VRFD_USR_ID                                       11330072
113600         INTO  :RECITM-VRFD-USR-ID                                11340072
113700         FROM   TRECITM                                           11350072
113800         WHERE  ORD_NBR = :PV-ORD-NBR                             11360072
113900           AND  ORD_LNE_NBR = :PV-ORD-LNE-NBR                     11370072
114000           AND  REC_SEQ_NBR = :PV-REC-SEQ-NBR                     11380072
114100     END-EXEC.                                                    11390072
114200                                                                  11400072
114300     EVALUATE TRUE                                                11410072
114400         WHEN SQLCODE = ZERO                                      11420072
114500              CONTINUE                                            11430072
114600         WHEN SQLCODE = +100                                      11440072
114700              MOVE SPACES TO RECITM-VRFD-USR-ID                   11450072
114800         WHEN SQLCODE = -811                                      11460072
114900             DISPLAY PV-ORD-NBR PV-ORD-LNE-NBR PV-REC-SEQ-NBR     11470072
115000         WHEN SQLWARN0 NOT = SPACE                                11480072
115100         WHEN SQLCODE < ZERO                                      11490072
115200         WHEN SQLCODE > ZERO                                      11500072
115300             MOVE '7300-GET-TRECITM'                              11510072
115400                                 TO PV-PARAGRAPH-NAME             11520072
115500             MOVE 'ERROR ON SELECT TWORKER DATA'                  11530072
115600                                 TO PV-DB2-OPERATION-ATTEMPTED    11540072
115700             PERFORM 9100-SQL-ABEND                               11550072
115800     END-EVALUATE.                                                11560072
115900*                                                                 11570072
116000/                                                                 11580072
116100 8000-PRINT-HEADINGS.                                             11590072
116200     ADD 1                        TO PV-PAGE-CNT.                 11600072
116300                                                                  11610072
116400     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          11620072
116500                                                                  11630072
116600     MOVE PC-REPORT-NBR-1        TO DP132O-REPORT-NUMBER.         11640072
116700                                                                  11650072
116800* KOHLS GENERIC HEADER                                            11660072
116900     WRITE RECV-REPORT-RECORD                                     11670072
117000       FROM DP132O-STANDRD-HEADER-132-COLS                        11680072
117100         AFTER ADVANCING PAGE.                                    11690072
117200                                                                  11700072
117300* REPORT TITLE                                                    11710072
117400     WRITE RECV-REPORT-RECORD                                     11720072
117500       FROM HEADING-LINE-0                                        11730072
117600         AFTER ADVANCING 2 LINE.                                  11740072
117700     MOVE 2                       TO PV-LINE-CNT.                 11750072
117800                                                                  11760072
117900*  WEEK ENDING                                                    11770072
118000     WRITE RECV-REPORT-RECORD                                     11780072
118100       FROM HEADING-LINE-3                                        11790072
118200         AFTER ADVANCING 1 LINES.                                 11800072
118300     ADD +2                       TO PV-LINE-CNT.                 11810072
118400                                                                  11820072
118500* RECEIVING LOCATION                                              11830072
118600     MOVE SPACES               TO HLX-LOCATION                    11840072
118700     IF PV-PREV-REC-LOC = 'DS'                                    11850072
118800         MOVE 'DIRECT STR'     TO HLX-LOCATION                    11860072
118900     ELSE                                                         11870072
                                                                        11880078
119000     IF PV-PREV-REC-LOC-N NUMERIC                                 11890078
119100         SEARCH ALL ST-STORE-ENTRY                                11900072
               AT END                                                   11910077
119400             MOVE ALL '?'      TO HLX-LOCATION                    11920079
119200         WHEN  ST-STR-NBR (ST-STR-IDX) = PV-PREV-REC-LOC-N        11930072
119300             MOVE ST-CHAR10-ABBR-NAME (ST-STR-IDX)                11940072
119400                               TO HLX-LOCATION                    11950072
119500         END-SEARCH                                               11960072
119600     END-IF.                                                      11970072
119700     WRITE RECV-REPORT-RECORD                                     11980072
119800       FROM LOCATION-HEADER                                       11990072
119900         AFTER ADVANCING 2 LINES.                                 12000072
120000     ADD +2 TO PV-LINE-CNT.                                       12010072
120100                                                                  12020072
120200* FIRST COLUMN HEADERS                                            12030072
120300     WRITE RECV-REPORT-RECORD                                     12040072
120400       FROM HEADING-LINE-1                                        12050072
120500         AFTER ADVANCING 2 LINES.                                 12060072
120600     ADD +2                       TO PV-LINE-CNT.                 12070072
120700                                                                  12080072
120800* FIRST COLUMN HEADERS                                            12090072
120900     WRITE RECV-REPORT-RECORD                                     12100072
121000       FROM HEADING-LINE-2                                        12110072
121100         AFTER ADVANCING 1 LINES.                                 12120072
121200     ADD +2                       TO PV-LINE-CNT.                 12130072
121300                                                                  12140072
121400* SPACER LINE BEFORE DETAILS                                      12150072
121500     WRITE RECV-REPORT-RECORD                                     12160072
121600       FROM BLANK-LINE                                            12170072
121700         AFTER ADVANCING 1 LINE.                                  12180072
121800     ADD +1 TO PV-LINE-CNT.                                       12190072
121900/                                                                 12200072
122000******************************************************************12210072
122100* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      12220072
122200* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 12230072
122300******************************************************************12240072
122400 9100-SQL-ABEND.                                                  12250072
122500     DISPLAY '** ABEND     **'.                                   12260072
122600     DISPLAY '** PROGRAM   ** = RCKRP013'.                        12270072
122700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              12280072
122800     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     12290072
122900                                                                  12300072
123000******************************************************************12310072
123100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    12320072
123200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         12330072
123300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     12340072
123400* FORMAT.                                                         12350072
123500******************************************************************12360072
123600     COPY DPPD004.                                                12370072
123700                                                                  12380072
123800     MOVE +4013 TO ABEND-CODE.                                    12390072
123900     CALL 'ILBOABN0' USING ABEND-CODE.                            12400072
124000                                                                  12410072
124100******************************************************************12420072
124200******************************************************************12430072
124300******************************************************************12440072
124400******************************************************************12450072
124500***************************************************************** 12460024
124600                                                                  12470072
124700                                                                  12480072
