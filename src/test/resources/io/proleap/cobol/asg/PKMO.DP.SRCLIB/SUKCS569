000100 TITLE 'STORE TRAILER DEPARTMENT SUMMARY'.                        00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.    SUKCS569.                                         00030000
000400 AUTHOR.        DENNIS STEFFEN.                                   00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  SPRING 2002.                                      00060000
000700 DATE-COMPILED.                                                   00070000
263968*---------------------------------------------------------------* 00071016
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00072016
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00073016
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00074016
001130*                                                                 00074117
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00074217
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00074317
263968*---------------------------------------------------------------* 00075016
000800 ENVIRONMENT DIVISION.                                            00080000
000900 DATA DIVISION.                                                   00090000
001000                                                                  00100000
001100 WORKING-STORAGE SECTION.                                         00110000
001200                                                                  00120000
001300 01  DK-DB2-KEYS.                                                 00130000
001400     05  DK-TRIP-OCRNC-ID             PIC S9(9) COMP VALUE ZERO.  00140000
001500     05  DK-OTBND-TRIP-ID             PIC S9(9) COMP VALUE ZERO.  00150000
001600     05  DK-STATUS-CODE-1             PIC X(02) VALUE SPACE.      00160000
001700     05  DK-STATUS-CODE-2             PIC X(02) VALUE SPACE.      00170000
001800     05  DK-STATUS-CODE-3             PIC X(02) VALUE SPACE.      00180000
001900     05  DK-STATUS-CODE-4             PIC X(02) VALUE SPACE.      00190000
002000     05  DK-FROM-DATE                 PIC X(10) VALUE SPACE.      00200000
002100     05  DK-TO-DATE                   PIC X(10) VALUE SPACE.      00210000
002110     05  DK-DEPT-NBR                  PIC S9(4) COMP-3.           00211014
002120     05  DK-BUS-AREA-ID               PIC S9(4) COMP-3.           00212014
002130                                                                  00213014
002140 01  PC-PROGRAM-CONSTANTS.                                        00214014
002150     05  PC-INTER-APPL-CODES.                                     00215014
002160         10  PC-INTER-APPL-CRIT-SPEC    PIC  X(01)  VALUE '1'.    00216014
002170         10  PC-INTER-APPL-LIST         PIC  X(01)  VALUE '2'.    00217014
002180         10  PC-INTER-APPL-DEPT-LIST    PIC  X(01)  VALUE '3'.    00218014
002190     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00219014
002200                                                    'SU569A  '.   00220014
002300     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00230014
002400                                                    'SUKM569 '.   00240014
002500     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00250014
002600                                                    'SUKCS569'.   00260014
002700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00270014
002800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00280014
002900     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00290014
003000     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00300014
003100                                                    COMP SYNC.    00310014
003200     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00320014
003300                                                    COMP SYNC.    00330014
003400     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00340014
003500                                                    +1000000      00350014
003600                                                    COMP-3.       00360014
003700     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00370014
003800                                                    COMP SYNC.    00380014
003900     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00390014
004000     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00400014
004100     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00410014
004200     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00420014
004300     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00430014
004400*                                                                 00440014
004500     05  PC-TSYMSG-NUMBERS.                                       00450014
004600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00460014
004700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00470014
004800         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00480014
004900         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00490014
005000         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00500014
005100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00510014
005200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00520014
005300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00530014
005400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00540014
005500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00550014
005600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00560014
005700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00570014
005800         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  00580014
005900         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00590014
006000         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  00600014
006100         10  PC-TSYMSG-02816            PIC  9(05)  VALUE 02816.  00610014
006200         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00620014
006300*                                                                 00630014
006400 01  PS-PROGRAM-SWITCHES.                                         00640014
006500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    00650014
006600         88  PS-NO-ERROR                            VALUE 'N'.    00660014
006700         88  PS-ERROR                               VALUE 'Y'.    00670014
006800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00680014
006900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00690014
007000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00700014
007100     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00710014
007200         88  PS-DONE                                VALUE 'Y'.    00720014
007300         88  PS-NOT-DONE                            VALUE 'N'.    00730014
007400     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        00740014
007500         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        00750014
007600         88  PS-NEXT-SCREEN                     VALUE 'Y'.        00760014
007700     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       00770014
007800         88  PS-LIST-END                         VALUE 'Y'.       00780014
007900         88  PS-NO-LIST-END                      VALUE 'N'.       00790014
008000*                                                                 00800014
008100 01  PV-PROGRAM-VARIABLES.                                        00810014
008200     05  PV-SUB                         PIC S9(04)  VALUE +0      00820014
008300                                                    COMP SYNC.    00830014
008400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00840014
008500                                                    COMP SYNC.    00850014
008600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00860014
008700                                                    COMP-3.       00870014
008800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00880014
008900                                                    COMP-3.       00890014
009000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      00900014
009100                                                    COMP-3.       00910014
009200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      00920014
009300                                                    COMP-3.       00930014
009400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      00940014
009500                                                    COMP-3.       00950014
009600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      00960014
009700                                                    COMP-3.       00970014
009800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      00980014
009900                                                    COMP-3.       00990014
010000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01000014
010100                                                    COMP SYNC.    01010014
010200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01020014
010300                                                    COMP SYNC.    01030014
010400     05  PV-ITEM                        PIC S9(04)  VALUE +0      01040014
010500                                                    COMP SYNC.    01050014
010600*    05  PV-SEL-QUEUE-NAME              PIC X(08).                01060014
010700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01070014
010800                                                    COMP SYNC.    01080014
010900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01090014
011000                                                    COMP SYNC.    01100014
011100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01110014
011110                                                    COMP SYNC.    01111014
011120     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01112014
011130                                                    COMP SYNC.    01113014
011140     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01114014
011150                                                    COMP SYNC.    01115014
011160     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01116014
011170                                                    COMP SYNC.    01117014
011180     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01118014
011190                                                    COMP SYNC.    01119014
011200     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01120014
011300                                                    COMP SYNC.    01130014
011400     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01140014
011500                                                    COMP SYNC.    01150014
011600     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01160014
011700                                                    COMP SYNC.    01170014
011800     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01180014
011900                                                    COMP SYNC.    01190014
012000     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01200014
012100                                                    COMP SYNC.    01210014
012200     05  PV-DB2-DATE.                                             01220014
012300         10  PV-DB2-MM                PIC XX VALUE ZERO.          01230014
012400         10  FILLER                   PIC X VALUE '/'.            01240014
012500         10  PV-DB2-DD                PIC XX VALUE ZERO.          01250014
012600         10  FILLER                   PIC X VALUE '/'.            01260014
012700         10  PV-DB2-YY                PIC XX VALUE ZERO.          01270014
012800     05  PV-DATE                      PIC X(10) VALUE SPACES.     01280014
012900     05  PV-TIME                      PIC X(08) VALUE SPACES.     01290014
013000     05  PV-DB2-COUNT                 PIC S9(8) COMP VALUE ZERO.  01300014
013100                                                                  01310014
013200******************************************************************01320014
013300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01330014
013400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01340014
013500**  APPLICATION-SPECIFIC COMMAREA.                              **01350014
013600******************************************************************01360014
013700 01  LQW-LIST-QUEUE-WORK-AREA.                                    01370014
013800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01380014
013900     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           01390014
014000                                        INDEXED BY LQW-IDX.       01400014
014100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01410014
014200         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01420014
014300         10  LQW-SELECTED-SW          PIC  X(01).                 01430014
014400             88  LQW-SELECT                         VALUE 'S'.    01440014
014500             88  LQW-DESELECT                       VALUE ' '.    01450014
014600         10  LQW-ACTION               PIC X(03).                  01460014
014700         10  LQW-DEPT                 PIC 9(04).                  01470014
014800         10  LQW-DEPT-DESC            PIC X(18).                  01480014
014900         10  LQW-BUS-AREA             PIC X(15).                  01490014
015000         10  LQW-CARTONS              PIC S9(07) COMP-3.          01500014
015100         10  LQW-UNITS                PIC S9(07) COMP-3.          01510014
015200         10  LQW-SKU-COUNT            PIC S9(09) COMP-3.          01520014
015300         10  LQW-AD                   PIC X(01).                  01530014
015400                                                                  01540014
015500                                                                  01550014
015600*        10  LQW-TRAILER-STAT         PIC X(10).                  01560014
015700*        10  LQW-STAT-DATE            PIC X(08).                  01570014
015800*        10  LQW-SCAC                 PIC X(04).                  01580014
015900*        10  LQW-TRAILER-ID           PIC X(12).                  01590014
016000*        10  LQW-SERIAL               PIC 9(09).                  01600014
016100*        10  LQW-PCT-FULL             PIC 9(03).                  01610014
016200*        10  LQW-JEWELRY              PIC X(01).                  01620014
016300*        10  LQW-CART-QTY             PIC 9(06).                  01630014
016400*        10  LQW-UNT-QTY              PIC S9(07) COMP-3.          01640014
016500*        10  LQW-OTBND-TRIP-ID        PIC S9(9) COMP.             01650014
016600*        10  LQW-TRIP-STAT-CDE        PIC X(02).                  01660014
016700*        10  LQW-TRIP-OCRNC-ID        PIC S9(9) COMP.             01670014
016800*        10  LQW-CRE-TMST             PIC X(26).                  01680014
016900/                                                                 01690014
017000*---------------------------------------------------------------* 01700014
017100*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 01710014
017200*---------------------------------------------------------------* 01720014
017300                                                                  01730014
017400     COPY SUWS013.                                                01740014
017500                                                                  01750014
017600/                                                                 01760014
017700*---------------------------------------------------------------* 01770014
017800*    MAP LAYOUT                                                 * 01780014
017900*---------------------------------------------------------------* 01790014
018000                                                                  01800014
018100     COPY SUKM569.                                                01810014
018200*                                                                 01820014
018300 01  MR-OCCURS-LAYOUT                   REDEFINES  SU569AO.       01830014
018400     05  FILLER                         PIC X(248).               01840014
018500     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          01850014
018600         10  MR-SELECTL                 PIC S9(04) COMP.          01860014
018700         10  MR-SELECTA                 PIC  X(01).               01870014
018800         10  MR-SELECTC                 PIC  X(01).               01880014
018900         10  MR-SELECTH                 PIC  X(01).               01890014
019000         10  MR-SELECTI                 PIC  X(01).               01900014
019100                                                                  01910014
019200         10  MR-ACTIONL                 PIC S9(04) COMP.          01920014
019300         10  MR-ACTIONA                 PIC  X(01).               01930014
019400         10  MR-ACTIONC                 PIC  X(01).               01940014
019500         10  MR-ACTIONH                 PIC  X(01).               01950014
019600         10  MR-ACTION                  PIC  X(03).               01960014
019700                                                                  01970014
019800         10  MR-DEPT-L                  PIC S9(04) COMP.          01980014
019900         10  MR-DEPT-A                  PIC  X(01).               01990014
020000         10  MR-DEPT-C                  PIC  X(01).               02000014
020100         10  MR-DEPT-H                  PIC  X(01).               02010014
020200         10  MR-DEPT                    PIC  ZZZ9.                02020014
020300                                                                  02030014
020400         10  MR-DEPT-DESC-L             PIC S9(04) COMP.          02040014
020500         10  MR-DEPT-DESC-A             PIC  X(01).               02050014
020600         10  MR-DEPT-DESC-C             PIC  X(01).               02060014
020700         10  MR-DEPT-DESC-H             PIC  X(01).               02070014
020800         10  MR-DEPT-DESC               PIC  X(18).               02080014
020900                                                                  02090014
021000         10  MR-BUS-AREA-L              PIC S9(04) COMP.          02100014
021100         10  MR-BUS-AREA-A              PIC  X(01).               02110014
021200         10  MR-BUS-AREA-C              PIC  X(01).               02120014
021300         10  MR-BUS-AREA-H              PIC  X(01).               02130014
021400         10  MR-BUS-AREA                PIC  X(15).               02140014
021500                                                                  02150014
021600         10  MR-CARTONS-L               PIC S9(04) COMP.          02160014
021700         10  MR-CARTONS-A               PIC  X(01).               02170014
021800         10  MR-CARTONS-C               PIC  X(01).               02180014
021900         10  MR-CARTONS-H               PIC  X(01).               02190014
022000         10  MR-CARTONS                 PIC  ZZZ,ZZZ.             02200014
022100                                                                  02210014
022200         10  MR-UNITS-L                 PIC S9(04) COMP.          02220014
022300         10  MR-UNITS-A                 PIC  X(01).               02230014
022400         10  MR-UNITS-C                 PIC  X(01).               02240014
022500         10  MR-UNITS-H                 PIC  X(01).               02250014
022600         10  MR-UNITS                   PIC  ZZZ,ZZZ.             02260014
022700                                                                  02270014
022800         10  MR-SKU-COUNT-L             PIC S9(04) COMP.          02280014
022900         10  MR-SKU-COUNT-A             PIC  X(01).               02290014
023000         10  MR-SKU-COUNT-C             PIC  X(01).               02300014
023100         10  MR-SKU-COUNT-H             PIC  X(01).               02310014
023200         10  MR-SKU-COUNT               PIC  Z,ZZZ,ZZZ.           02320014
023300                                                                  02330014
023400         10  MR-AD-L                    PIC S9(04) COMP.          02340014
023500         10  MR-AD-A                    PIC  X(01).               02350014
023600         10  MR-AD-C                    PIC  X(01).               02360014
023700         10  MR-AD-H                    PIC  X(01).               02370014
023800         10  MR-AD                      PIC  X(01).               02380014
023900     05  FILLER                         PIC X(023).               02390014
024000/                                                                 02400014
024100*---------------------------------------------------------------* 02410014
024200*    ATTRIBUTE SETTINGS                                           02420014
024300*---------------------------------------------------------------* 02430014
024400                                                                  02440014
024500     COPY DPWS015.                                                02450014
024600                                                                  02460014
024700*---------------------------------------------------------------* 02470014
024800*    FUNCTION KEYS                                                02480014
024900*---------------------------------------------------------------* 02490014
025000                                                                  02500014
025100     COPY DPWS016.                                                02510014
025200                                                                  02520014
025300*---------------------------------------------------------------* 02530014
025400*    NUMERIC EDIT LAYOUT.                                       * 02540014
025500*---------------------------------------------------------------* 02550014
025600                                                                  02560014
025700     COPY DPWS010I.                                               02570014
025800/                                                                 02580014
025900*---------------------------------------------------------------* 02590014
026000*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 02600017
026100*---------------------------------------------------------------* 02610014
026200                                                                  02620014
026300     COPY DPWS030.                                                02630014
026300     COPY DPWS930.                                                02631017
026400/                                                                 02640014
026500*---------------------------------------------------------------* 02650014
026600*    STANDARD COMMAREA.                                         * 02660014
026700*---------------------------------------------------------------* 02670014
026800                                                                  02680014
026900     COPY DPWS020.                                                02690014
027000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02700014
027100                                                                  02710014
027200*---------------------------------------------------------------* 02720014
027300* INTER-APPLICATION COMMAREA.                                   * 02730014
027400*   DPWS054 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02740014
027500*             SPEC SCREEN.                                      * 02750014
027600*   DPWS056 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02760014
027700*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 02770014
027800*---------------------------------------------------------------* 02780014
027900                                                                  02790014
028000         10  INTER-APPL-COMM-AREA       PIC X(200).               02800014
028100                                                                  02810014
028200*  INPUT FROM CRIT SPEC SCREEN, SUKCS566                          02820014
028300     COPY SUWS011.                                                02830014
028400                                                                  02840014
028500*  OUTPUT TO LIST SCREEN, SUKCS572                                02850014
028600     COPY SUWS012.                                                02860014
028700*---------------------------------------------------------------* 02870014
028800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02880014
028900*---------------------------------------------------------------* 02890014
029000         10  ASC-SPECIFIC-COMMAREA.                               02900014
029100             15  ASC-INT-APPL-FORMAT-IND    PIC  X(01).           02910014
029200                 88  ASC-AREA-DEPT-LIST     VALUE '2'.            02920014
029300                 88  ASC-DEPT-DIRCT-LIST    VALUE '3'.            02930014
029400             15  ASC-LIST-KEYS.                                   02940014
029500                 20  ASC-KEY-TRIP-ID        PIC S9(09) COMP.      02950014
029600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                02960014
029700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  02970014
029800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   02980014
029900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   02990014
030000                                                                  03000014
030100                 20  ASC-ITEM-ARRAY.                              03010014
030200                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        03020014
030300                         30  ASC-LIST-ITEM-NUMBER                 03030014
030400                                                     PIC S9(09)   03040014
030500                                                     COMP-3.      03050014
030600                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03060014
030700                             88  ASC-VALID-SELECT    VALUE ' '    03070014
030800                                                           'S'    03080014
030900                                                           'B'    03090014
031000                                                           'E'.   03100014
031100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03110014
031200                             88  ASC-TEMP-SELECT     VALUE 'S'.   03120014
031300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03130014
031400                             88  ASC-TEMP-END        VALUE 'E'.   03140014
031500                         30  ASC-SELECTED-SW         PIC  X(01).  03150014
031600                             88  ASC-NO-SELECT       VALUE ' '.   03160014
031700                             88  ASC-SELECT          VALUE 'S'.   03170014
031800                             88  ASC-BEGIN           VALUE 'B'.   03180014
031900                             88  ASC-END             VALUE 'E'.   03190014
032000                         30  ASC-ACTION              PIC  X(03).  03200014
032100                         30  ASC-DEPT-NBR  PIC 9(04).             03210014
032200                         30  ASC-DEPT-DESC PIC X(18).             03220014
032300                         30  ASC-BUS-AREA  PIC X(15).             03230014
032400                         30  ASC-CART-QTY  PIC S9(07) COMP-3.     03240014
032500                         30  ASC-UNT-QTY   PIC S9(07) COMP-3.     03250014
032600                         30  ASC-SKU-COUNT PIC S9(09) COMP-3.     03260014
032700                         30  ASC-AD        PIC X(01).             03270014
032800                                                                  03280014
032900             15  ASC-TRAILER-STAT  PIC X(10).                     03290014
033000             15  ASC-STAT-DATE     PIC X(08).                     03300014
033100*            15  ASC-SCAC          PIC X(04).                     03310014
033200             15  ASC-SERIAL        PIC 9(09).                     03320014
033300             15  ASC-PCT-FULL      PIC 9(03).                     03330014
033400             15  ASC-JEWELRY       PIC X(01).                     03340014
033500*            15  ASC-CART-QTY      PIC 9(06).                     03350014
033600             15  ASC-OTBND-TRIP-ID PIC S9(9) COMP.                03360014
033700             15  ASC-TRIP-STAT-CDE PIC X(02).                     03370014
033800*            15  ASC-TRIP-OCRNC-ID PIC S9(9) COMP.                03380014
033900             15  ASC-CRE-TMST      PIC X(26).                     03390014
034000                                                                  03400014
034100             15  ASC-BLK-SUB          PIC S9(04) COMP SYNC.       03410014
034200             15  ASC-ITEM-SUB         PIC S9(04) COMP SYNC.       03420014
034300             15  ASC-NUMBER-OF-ITEMS-READ      PIC S9(09) COMP-3. 03430014
034400             15  ASC-NUMBER-OF-SELECTED-ITEMS  PIC S9(09) COMP-3. 03440014
034500             15  ASC-ITEMS-DISPLAYED           PIC S9(03) COMP-3. 03450014
034600             15  ASC-ITEM-AT-TOP-OF-PANEL      PIC S9(09) COMP-3. 03460014
034700             15  ASC-ITEM-AT-BOT-OF-PANEL      PIC S9(09) COMP-3. 03470014
034800             15  ASC-HIGHEST-BLOCK-WRITTEN     PIC S9(04) COMP    03480014
034900                                                          SYNC.   03490014
035000             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03500014
035100                                                          COMP-3. 03510014
035200             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03520014
035300                                                          COMP-3. 03530014
035400             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03540014
035500                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03550014
035600                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03560014
035700             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03570014
035800                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03580014
035900                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03590014
036000             15  ASC-LIST-QUEUE-NAME.                             03600014
036100                 20  ASC-LIST-TERM-ID                PIC  X(04).  03610014
036200                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03620014
036300                                                          COMP-3. 03630014
036400                 20  ASC-LIST-SEQ                    PIC  9(01).  03640014
036500             15  ASC-SEL-QUEUE-NAME-IN.                           03650014
036600                 20  ASC-SEL-TERM-ID-IN              PIC  X(04).  03660014
036700                 20  ASC-SEL-TASK-NUMBER-IN          PIC S9(05)   03670014
036800                                                          COMP-3. 03680014
036900                 20  ASC-SEL-SEQ-IN                  PIC  9(01).  03690014
037000             15  ASC-SEL-QUEUE-NAME-OUT.                          03700014
037100                 20  ASC-SEL-TERM-ID-OUT             PIC  X(04).  03710014
037200                 20  ASC-SEL-TASK-NUMBER-OUT         PIC S9(05)   03720014
037300                                                          COMP-3. 03730014
037400                 20  ASC-SEL-SEQ-OUT                 PIC  9(01).  03740014
037500                                                                  03750014
037600             15  ASC-USE-SELECTION-QUEUE-IND                      03760014
037700                                                 PIC  X(01).      03770014
037800                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03780014
037900             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    03790014
038000             15  ASC-SEL-SUB               PIC S9(04)  COMP.      03800014
038100             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      03810014
038200             15  ASC-START-ITEM-REQUEST.                          03820014
038300                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  03830014
038400                                                                  03840014
038500                                                                  03850014
038600*            15  ASC-CURR-OPER-UNT-ID PIC S9(04) COMP.            03860014
038700             15  ASC-SERVICE-DC-NAME  PIC X(20).                  03870014
038800             15  ASC-STR-NAME         PIC X(25).                  03880014
038900             15  ASC-STR-NBR          PIC S9(04) COMP.            03890014
039000             15  ASC-TRLR-SRL-NBR     PIC S9(09) COMP.            03900014
039100             15  ASC-TRIP-OCRNC-ID    PIC S9(09) COMP.            03910014
039200             15  ASC-BUS-AREA-ID      PIC S9(4) COMP-3.           03920014
039300             15  ASC-SCAC             PIC X(04).                  03930014
039400             15  ASC-TRLR-ID          PIC X(12).                  03940014
039500             15  ASC-TRIP-STAT-DESC   PIC X(10).                  03950014
039600             15  ASC-TOTAL-CARTONS    PIC S9(07) COMP-3.          03960014
039700             15  ASC-TOTAL-UNITS      PIC S9(07) COMP-3.          03970014
039800             15  ASC-SUMMARY-DATE     PIC X(10).                  03980014
039900             15  ASC-SUMMARY-TIME     PIC X(08).                  03990014
040000             15  ASC-SCREEN-SEQUENCE  PIC X(01).                  04000014
040100                 88  ASC-DEPT-SEQ                VALUE 'D'.       04010014
040200                 88  ASC-UNIT-SEQ                VALUE 'U'.       04020014
040300             15  ASC-SEQ-DESC         PIC X(20).                  04030014
040400/                                                                 04040014
040500*    XLKUT073 COPYBOOK                                            04050015
040600     COPY XLWS073.                                                04060015
040700/                                                                 04070014
040800*    ABEND PROCESSING                                             04080014
040900                                                                  04090014
041000     COPY DPWS013.                                                04100014
041100/                                                                 04110014
041200     EXEC SQL                                                     04120014
041300          INCLUDE TSUOBTR                                         04130014
041400     END-EXEC.                                                    04140014
041500                                                                  04150014
041600*    DEPT SUMMARY                                                 04160014
041700     EXEC SQL                                                     04170014
041800          INCLUDE SUT00009                                        04180014
041900     END-EXEC.                                                    04190014
042000                                                                  04200014
042100*    MAJOR CLASS AD DATE                                          04210014
042200     EXEC SQL                                                     04220014
042300          INCLUDE SUT00011                                        04230014
042400     END-EXEC.                                                    04240014
042500/                                                                 04250014
042600*    DOMAIN BUSINESS AREA                                         04260014
042700     EXEC SQL                                                     04270014
042800          INCLUDE XLT00000                                        04280014
042900     END-EXEC.                                                    04290014
043000                                                                  04300014
043100*    DOMAIN BUSINESS GROUP                                        04310014
043200     EXEC SQL                                                     04320014
043300          INCLUDE XLT00001                                        04330014
043400     END-EXEC.                                                    04340014
043500                                                                  04350014
043600*    DOMAIN DEPARTMENT                                            04360014
043700     EXEC SQL                                                     04370014
043800          INCLUDE XLT00002                                        04380014
043900     END-EXEC.                                                    04390014
043901                                                                  04390114
043902*    DOMAIN LOCATION                                              04390200
043903     EXEC SQL                                                     04390300
043904          INCLUDE XLT00010                                        04390414
043905     END-EXEC.                                                    04390514
043906                                                                  04390614
043907     EXEC SQL                                                     04390714
043908         DECLARE AREA-DEPT-CSR CURSOR FOR                         04390814
043909            SELECT                                                04390914
043910                 DSUM.DEPT_NBR                                    04391014
043920               , DSUM.BUS_AREA_ID                                 04392014
043930               , DSUM.UNT_QTY                                     04393014
043940               , DSUM.SKU_QTY                                     04394014
043950               , DSUM.CART_QTY                                    04395014
043960               , DSUM.RTL_DOL_AMT                                 04396014
043970         FROM SUT_DEPT_SUM DSUM                                   04397014
043980         WHERE                                                    04398014
043990              DSUM.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID              04399014
044000             AND DSUM.BUS_AREA_ID = :DK-BUS-AREA-ID               04400014
044100         ORDER BY                                                 04410014
044200              DSUM.DEPT_NBR                                       04420014
044300     END-EXEC.                                                    04430014
044400                                                                  04440014
044500     EXEC SQL                                                     04450014
044600         DECLARE AREA-DEPT-CSR-ALT CURSOR FOR                     04460014
044700            SELECT                                                04470014
044800                 DSUM.DEPT_NBR                                    04480014
044900               , DSUM.BUS_AREA_ID                                 04490014
045000               , DSUM.UNT_QTY                                     04500014
045100               , DSUM.SKU_QTY                                     04510014
045200               , DSUM.CART_QTY                                    04520014
045300               , DSUM.RTL_DOL_AMT                                 04530014
045400         FROM SUT_DEPT_SUM DSUM                                   04540014
045500         WHERE                                                    04550014
045600              DSUM.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID              04560014
045700             AND DSUM.BUS_AREA_ID = :DK-BUS-AREA-ID               04570014
045800         ORDER BY                                                 04580014
045900              DSUM.UNT_QTY DESC                                   04590014
046000         ,    DSUM.DEPT_NBR                                       04600014
046100     END-EXEC.                                                    04610014
046200                                                                  04620014
046300                                                                  04630014
046400     EXEC SQL                                                     04640014
046500         DECLARE DEPT-DIRCT-CSR CURSOR FOR                        04650014
046600            SELECT                                                04660014
046700                 DSUM.DEPT_NBR                                    04670014
046800               , DSUM.BUS_AREA_ID                                 04680014
046900               , DSUM.UNT_QTY                                     04690014
047000               , DSUM.SKU_QTY                                     04700014
047100               , DSUM.CART_QTY                                    04710014
047200               , DSUM.RTL_DOL_AMT                                 04720014
047300         FROM SUT_DEPT_SUM DSUM                                   04730014
047400         WHERE                                                    04740014
047500              DSUM.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID              04750014
047510         ORDER BY                                                 04751014
047520              DSUM.DEPT_NBR                                       04752014
047530     END-EXEC.                                                    04753014
047540                                                                  04754014
047550     EXEC SQL                                                     04755014
047560         DECLARE DEPT-DIRCT-CSR-ALT CURSOR FOR                    04756014
047570            SELECT                                                04757014
047580                 DSUM.DEPT_NBR                                    04758014
047590               , DSUM.BUS_AREA_ID                                 04759014
047600               , DSUM.UNT_QTY                                     04760014
047601               , DSUM.SKU_QTY                                     04760114
047602               , DSUM.CART_QTY                                    04760214
047603               , DSUM.RTL_DOL_AMT                                 04760314
047604         FROM SUT_DEPT_SUM DSUM                                   04760414
047605         WHERE                                                    04760514
047606              DSUM.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID              04760614
047607         ORDER BY                                                 04760714
047608              DSUM.UNT_QTY DESC                                   04760814
047609         ,    DSUM.DEPT_NBR                                       04760914
047610     END-EXEC.                                                    04761014
047611                                                                  04761114
047612/                                                                 04761214
047613*---------------------------------------------------------------* 04761314
047614*    DB2 AREA FOR COMMUNICATIONS                                * 04761414
047615*---------------------------------------------------------------* 04761514
047616     EXEC SQL                                                     04761614
047617          INCLUDE SQLCA                                           04761714
047618     END-EXEC.                                                    04761814
047619                                                                  04761914
047620/                                                                 04762014
047630 LINKAGE SECTION.                                                 04763014
047640                                                                  04764014
047650 01  DFHCOMMAREA.                                                 04765014
047660     05  FILLER                         OCCURS  1 TO 4072 TIMES   04766014
047670                                        DEPENDING ON EIBCALEN.    04767014
047680         10  FILLER                     PIC X.                    04768014
047690                                                                  04769014
047700 EJECT                                                            04770014
047800 PROCEDURE DIVISION.                                              04780014
047900******************************************************************04790014
048000**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **04800014
048100**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **04810014
048200**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **04820014
048300******************************************************************04830014
048400 0000-MAIN-MODULE.                                                04840014
048500     INITIALIZE DP030-CICS-API-FIELDS.                            04850014
048600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04860014
048700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04870014
048800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04880014
048900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04890014
049000     MOVE LENGTH OF SU569AI        TO DP030-MAP-LENGTH (1).       04900014
049100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04910014
049200     PERFORM 0001-CALL-CICS-ARCH-API.                             04920014
049300*                                                                 04930014
049400     PERFORM 1000-CONTROL-PROCESSING                              04940014
049500*                                                                 04950014
049600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04960014
049700     PERFORM 0001-CALL-CICS-ARCH-API.                             04970014
049800                                                                  04980014
049900******************************************************************04990014
050000**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **05000014
050100**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **05010014
050200******************************************************************05020014
050300 0001-CALL-CICS-ARCH-API.                                         05030014
050400*    CALL 'DPKCS030' USING DFHEIBLK                               05040017
050400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05041017
050500                           DFHCOMMAREA                            05050014
050600                           DP030-CICS-API-FIELDS                  05060014
050700                           DP020-STANDARD-COMMAREA                05070014
050800                           SU569AI.                               05080014
050900*                                                                 05090014
051000     IF  DP030-RC-CALL-SUCCESSFUL                                 05100014
051100         CONTINUE                                                 05110014
051200     ELSE                                                         05120014
051300         SET DP013-NO-ROLLBACK                                    05130014
051400             DP013-XCTL-DISPLAY-RESTART                           05140014
051500             DP013-CICS-ABEND      TO TRUE                        05150014
051600         MOVE '0001-CALL-CICS-ARCH-API'                           05160014
051700                                   TO DP013-PARAGRAPH             05170014
051800*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX05180017
051900*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      05190017
051800         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O05191017
051900-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05192017
052000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05200014
052100         PERFORM DP013-0000-PROCESS-ABEND                         05210014
052200     END-IF.                                                      05220014
052300*----------------------------------------------------------------*05230014
052400* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05240014
052500* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05250014
052600*                                                                *05260014
052700* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05270014
052800*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05280014
052900*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05290014
053000*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05300014
053100*----------------------------------------------------------------*05310014
053200                                                                  05320014
053300 1000-CONTROL-PROCESSING.                                         05330014
053400                                                                  05340014
053500     EVALUATE TRUE                                                05350014
053600         WHEN DP020-NEXT-ACT-INITIAL                              05360014
053700             INITIALIZE ASC-SPECIFIC-COMMAREA                     05370014
053800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            05380014
053900                                      ASC-SEL-TERM-ID-OUT         05390014
054000             MOVE DP020-SRC-TASK-NUMBER                           05400014
054100                                   TO ASC-LIST-TASK-NUMBER        05410014
054200                                      ASC-SEL-TASK-NUMBER-OUT     05420014
054300             MOVE PC-LIST-QUEUE-SEQ                               05430014
054400                                   TO ASC-LIST-SEQ                05440014
054500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             05450014
054600             SET PS-COMMAREA-VALID TO TRUE                        05460014
054700                                                                  05470014
054800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05480014
054900                                                                  05490014
055000             IF  PS-ERROR                                         05500014
055100                 CONTINUE                                         05510014
055200             ELSE                                                 05520014
055300                 PERFORM 4000-BUILD-INITIAL-PANEL                 05530014
055400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05540014
055500             END-IF                                               05550014
055600                                                                  05560014
055700***-----$TEMPLATE NOTE$-------------------------------------------05570014
055800*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05580014
055900*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05590014
056000*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05600014
056100***---------------------------------------------------------------05610014
056200             IF  PS-COMMAREA-NOT-VALID                            05620014
056300***              MOVE PC-TSYMSG-99901                             05630014
056400***                                TO DP020-MSG-NUMBER            05640014
056500***              SET DP020-MSG-FATAL                              05650014
056600***                                TO TRUE                        05660014
056700                 SET DP020-NEXT-ACT-APPL-ERROR                    05670014
056800                                   TO TRUE                        05680014
056900             ELSE                                                 05690014
057000                 PERFORM 4000-BUILD-INITIAL-PANEL                 05700014
057100             END-IF                                               05710014
057200                                                                  05720014
057300         WHEN DP020-NEXT-ACT-READ-MAP                             05730014
057400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05740014
057500                                   TO PV-TOP-ITEM                 05750014
057600             PERFORM 2000-PROCESS-PANEL                           05760014
057700                                                                  05770014
057800         WHEN DP020-NEXT-ACT-RETURN                               05780014
057900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05790014
058000                                   TO PV-TOP-ITEM                 05800014
058100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    05810014
058200             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 05820014
058300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05830014
058400                                                                  05840014
058500*            MOVE ASC-STR-NBR          TO SU011-CURR-OPER-UNT-ID  05850014
058600*            PERFORM 2050-DELETE-LIST-QUEUE                       05860014
058700*            PERFORM 4000-BUILD-INITIAL-PANEL                     05870014
058800                                                                  05880014
058900                                                                  05890014
059000         WHEN OTHER                                               05900014
059100             SET DP013-LOGIC-ABEND TO TRUE                        05910014
059200             SET DP013-NO-ROLLBACK TO TRUE                        05920014
059300             MOVE '1000-CONTROL-PROCESSING'                       05930014
059400                                   TO DP013-PARAGRAPH             05940014
059500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05950014
059600                                   TO DP013-MESSAGE-TEXT(1)       05960014
059700             PERFORM DP013-0000-PROCESS-ABEND                     05970014
059800     END-EVALUATE.                                                05980014
059900                                                                  05990014
060000 EJECT                                                            06000014
060100*----------------------------------------------------------------*06010014
060200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06020014
060300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06030014
060400*----------------------------------------------------------------*06040014
060500                                                                  06050014
060600 1100-PROCESS-INTER-APPL-COMM.                                    06060014
060700                                                                  06070014
060800     SET PS-COMMAREA-VALID         TO TRUE.                       06080014
060900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     06090014
061000     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND    06100014
061100     EVALUATE DP020-INT-APPL-FORMAT-IND                           06110014
061200                                                                  06120014
061300         WHEN PC-INTER-APPL-LIST                                  06130014
061400         WHEN PC-INTER-APPL-DEPT-LIST                             06140014
061500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  06150014
061600             MOVE SU012-NUMBER-OF-SELECTED-ITEMS                  06160014
061700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS06170014
061800             MOVE SU012-NUMBER-OF-TS-ITEMS                        06180014
061900                                    TO ASC-NUMBER-OF-TS-ITEMS     06190014
062000             MOVE SU012-SEL-QUEUE-NAME                            06200014
062100                                    TO ASC-SEL-QUEUE-NAME-IN      06210014
062200             MOVE SU012-STR-NBR   TO ASC-STR-NBR                  06220014
062300             MOVE SU012-STR-NAME  TO ASC-STR-NAME                 06230014
062400             MOVE SU012-SERVICING-DC TO ASC-SERVICE-DC-NAME       06240014
062500             PERFORM 1101-SCREEN-SEQUENCE                         06250014
062600                                                                  06260014
062700             PERFORM 1120-PREPARE-LIST-ENTRY                      06270014
062800                                                                  06280014
062900         WHEN OTHER                                               06290014
063000             MOVE PC-TSYMSG-00148                                 06300014
063100                                     TO DP020-MSG-NUMBER          06310014
063200             SET DP020-MSG-FATAL                                  06320014
063300                 DP020-NEXT-ACT-APPL-ERROR                        06330014
063400                                     TO TRUE                      06340014
063500     END-EVALUATE.                                                06350014
063600 1101-SCREEN-SEQUENCE.                                            06360014
063700     EVALUATE TRUE                                                06370014
063800         WHEN SU012-DEPT-SEQ                                      06380014
063900             MOVE 'DEPARTMENT SEQUENCE' TO ASC-SEQ-DESC           06390014
064000                                                                  06400014
064100         WHEN SU012-UNIT-SEQ                                      06410014
064200             MOVE 'UNIT SEQUENCE'       TO ASC-SEQ-DESC           06420014
064300         WHEN OTHER                                               06430014
064400             SET SU012-DEPT-SEQ         TO TRUE                   06440014
064500             MOVE 'DEPARTMENT SEQUENCE' TO ASC-SEQ-DESC           06450014
064600     END-EVALUATE.                                                06460014
064700     MOVE SU012-SCREEN-SEQUENCE TO ASC-SCREEN-SEQUENCE.           06470014
064800/                                                                 06480014
064900 1120-PREPARE-LIST-ENTRY.                                         06490014
065000     MOVE SU013-MAX-ITEMS          TO ASC-SEL-SUB.                06500014
065100     MOVE ZERO                     TO ASC-SEL-ITEM.               06510014
065200     PERFORM 2110-GET-NEXT-MESSAGE.                               06520014
065300/                                                                 06530014
065400 2110-GET-NEXT-MESSAGE.                                           06540014
065500     ADD +1                        TO ASC-SEL-SUB.                06550014
065600     IF  ASC-SEL-SUB > SU013-MAX-ITEMS                            06560014
065700         ADD +1                    TO ASC-SEL-ITEM                06570014
065800         MOVE +1                   TO ASC-SEL-SUB                 06580014
065900     END-IF.                                                      06590014
066000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                06600014
066100         PERFORM 9100-READ-SEL-QUEUE                              06610014
066200         IF  SU013-ITEM (ASC-SEL-SUB) > ZERO                      06620014
066300             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               06630014
066400                                   TO ASC-TRIP-OCRNC-ID           06640014
066500             MOVE SU013-BUS-GP-NBR  (ASC-SEL-SUB)                 06650014
066600                                   TO ASC-BUS-AREA-ID             06660014
066700             MOVE SU013-TRLR-SRL-NBR (ASC-SEL-SUB)                06670014
066800                                   TO ASC-TRLR-SRL-NBR            06680014
066900             MOVE SU013-SCAC (ASC-SEL-SUB)                        06690014
067000                                   TO ASC-SCAC                    06700014
067100             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     06710014
067200                                   TO ASC-TRLR-ID                 06720014
067300                                                                  06730014
067400             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     06740014
067500                                   TO DK-OTBND-TRIP-ID            06750014
067600                                      ASC-OTBND-TRIP-ID           06760014
067700                                                                  06770014
067800             MOVE SU013-TRIP-STAT-DESC (ASC-SEL-SUB)              06780014
067900                                   TO ASC-TRIP-STAT-DESC          06790014
068000             MOVE SU013-CARTON-CNT (ASC-SEL-SUB)                  06800014
068100                                   TO ASC-TOTAL-CARTONS           06810014
068200             MOVE SU013-UNIT-COUNT (ASC-SEL-SUB)                  06820014
068300                                   TO ASC-TOTAL-UNITS             06830014
068400                                                                  06840014
068500             MOVE SU013-TRLR-SRL-NBR (SU013-IDX)                  06850014
068600                                      TO ASC-SERIAL               06860014
068700             MOVE SU013-TRIP-STAT-DESC (SU013-IDX)                06870014
068800                                      TO  ASC-TRAILER-STAT        06880014
068900             MOVE SU013-STAT-DATE (SU013-IDX) TO  ASC-STAT-DATE   06890014
069000                                                                  06900014
069100             IF ASC-SERVICE-DC-NAME = SPACES                      06910014
069200                 PERFORM 7000-SELECT-SERVICING-DC                 06920014
069300             END-IF                                               06930014
069400             MOVE ASC-SERVICE-DC-NAME TO AOPERO                   06940014
069500                                         SU012-SERVICING-DC       06950014
069600                                                                  06960014
069700             PERFORM 7001-CONVERT-DATES                           06970014
069800             MOVE ASC-SUMMARY-DATE TO ASUMDTEO                    06980014
069900             MOVE ASC-SUMMARY-TIME TO ASUMTMEO                    06990014
070000                                                                  07000014
070100             SET SU013-INQ (ASC-SEL-SUB)                          07010014
070200                                   TO TRUE                        07020014
070300             PERFORM 9200-REWRITE-LIST-QUEUE                      07030014
070400         ELSE                                                     07040014
070500             SUBTRACT +1 FROM ASC-SEL-SUB                         07050014
070600*            --- BOTTOM OF LIST ---                               07060014
070700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07070014
070800             SET DP020-MSG-INFORMATIONAL                          07080014
070900                                   TO TRUE                        07090014
071000         END-IF                                                   07100014
071100     ELSE                                                         07110014
071200         SUBTRACT +1 FROM ASC-SEL-ITEM                            07120014
071300         MOVE SU013-MAX-ITEMS      TO ASC-SEL-SUB                 07130014
071400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07140014
071500         SET DP020-MSG-INFORMATIONAL                              07150014
071600                                   TO TRUE                        07160014
071700     END-IF.                                                      07170014
071800                                                                  07180014
071900 2120-GET-PREV-MESSAGE.                                           07190014
072000     SUBTRACT +1                   FROM ASC-SEL-SUB.              07200014
072100     IF  ASC-SEL-SUB < 1                                          07210014
072200         SUBTRACT 1                FROM ASC-SEL-ITEM              07220014
072300         MOVE SU013-MAX-ITEMS      TO ASC-SEL-SUB                 07230014
072400     END-IF.                                                      07240014
072500     IF  ASC-SEL-ITEM  > ZERO                                     07250014
072600         PERFORM 9100-READ-SEL-QUEUE                              07260014
072700         IF  SU013-ITEM (ASC-SEL-SUB) > ZERO                      07270014
072800             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               07280014
072900                                   TO ASC-TRIP-OCRNC-ID           07290014
073000             MOVE SU013-BUS-GP-NBR  (ASC-SEL-SUB)                 07300014
073100                                   TO ASC-BUS-AREA-ID             07310014
073200             MOVE SU013-TRLR-SRL-NBR (ASC-SEL-SUB)                07320014
073300                                   TO ASC-TRLR-SRL-NBR            07330014
073400             MOVE SU013-SCAC (ASC-SEL-SUB)                        07340014
073500                                   TO ASC-SCAC                    07350014
073600             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     07360014
073700                                   TO ASC-TRLR-ID                 07370014
073800                                                                  07380014
073900             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     07390014
074000                                   TO DK-OTBND-TRIP-ID            07400014
074100                                      ASC-OTBND-TRIP-ID           07410014
074200                                                                  07420014
074300             MOVE SU013-TRIP-STAT-DESC (ASC-SEL-SUB)              07430014
074400                                   TO ASC-TRIP-STAT-DESC          07440014
074500             MOVE SU013-CARTON-CNT (ASC-SEL-SUB)                  07450014
074600                                   TO ASC-TOTAL-CARTONS           07460014
074700             MOVE SU013-UNIT-COUNT (ASC-SEL-SUB)                  07470014
074800                                   TO ASC-TOTAL-UNITS             07480014
074900                                                                  07490014
075000             MOVE SU013-TRLR-SRL-NBR (SU013-IDX)                  07500014
075100                                      TO ASC-SERIAL               07510014
075200             MOVE SU013-TRIP-STAT-DESC (SU013-IDX)                07520014
075300                                      TO  ASC-TRAILER-STAT        07530014
075400             MOVE SU013-STAT-DATE (SU013-IDX) TO  ASC-STAT-DATE   07540014
075500                                                                  07550014
075600             PERFORM 7000-SELECT-SERVICING-DC                     07560014
075700             MOVE ASC-SERVICE-DC-NAME TO AOPERO                   07570014
075800                                         SU012-SERVICING-DC       07580014
075900                                                                  07590014
076000             PERFORM 7001-CONVERT-DATES                           07600014
076100             MOVE ASC-SUMMARY-DATE TO ASUMDTEO                    07610014
076200             MOVE ASC-SUMMARY-TIME TO ASUMTMEO                    07620014
076300                                                                  07630014
076400             SET SU013-INQ (ASC-SEL-SUB)                          07640014
076500                                   TO TRUE                        07650014
076600             PERFORM 9200-REWRITE-LIST-QUEUE                      07660014
076700         ELSE                                                     07670014
076800             MOVE +1               TO ASC-SEL-ITEM                07680014
076900                                      ASC-SEL-SUB                 07690014
077000*            --- TOP OF LIST ---                                  07700014
077100             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            07710014
077200             SET DP020-MSG-INFORMATIONAL                          07720014
077300                                   TO TRUE                        07730014
077400         END-IF                                                   07740014
077500     END-IF.                                                      07750014
077600*----------------------------------------------------------------*07760014
077700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *07770014
077800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *07780014
077900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *07790014
078000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *07800014
078100* FUNCTION KEYS CAN GET THIS FAR.                                *07810014
078200*----------------------------------------------------------------*07820014
078300                                                                  07830014
078400 2000-PROCESS-PANEL.                                              07840014
078500     SET PS-NEXT-SCREEN TO TRUE.                                  07850014
078600     EVALUATE TRUE                                                07860014
078700         WHEN DP020-SRC-AID = DP016-CLEAR                         07870014
078800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    07880014
078900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07890014
079000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07900014
079100                                                                  07910014
079200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    07920014
079300             PERFORM 2050-DELETE-LIST-QUEUE                       07930014
079400             PERFORM 4000-BUILD-INITIAL-PANEL                     07940014
079500                                                                  07950014
079600         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    07960014
079700             PERFORM 2140-DESELECT-ALL-ITEMS                      07970014
079800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07980014
079900                                                                  07990014
080000         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  08000014
080100             PERFORM 2150-SELECT-ALL-ITEMS                        08010014
080200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08020014
080300                                                                  08030014
080400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08040014
080500                                                                  08050014
080600             IF ASC-USE-SELECTION-QUEUE                           08060014
080700                 PERFORM 2110-GET-NEXT-MESSAGE                    08070014
080800                 IF PS-LIST-END                                   08080014
080900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08090014
081000                     SET PS-NO-LIST-END TO TRUE                   08100014
081100                 ELSE                                             08110014
081200                     PERFORM 2050-DELETE-LIST-QUEUE               08120014
081300                     PERFORM 3200-RESET-ATTRIBUTES                08130014
081400                     PERFORM 4000-BUILD-INITIAL-PANEL             08140014
081500                 END-IF                                           08150014
081600               ELSE                                               08160014
081700*            --- BOTTOM OF LIST ---                               08170014
081800                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         08180014
081900                 SET DP020-MSG-INFORMATIONAL TO TRUE              08190014
082000                 SET PS-LIST-END      TO TRUE                     08200014
082100             END-IF                                               08210014
082200                                                                  08220014
082300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08230014
082400                                                                  08240014
082500             EVALUATE TRUE                                        08250014
082600                 WHEN PS-LIST-END                                 08260014
082700*                    --- TOP OF LIST ---                          08270014
082800                     MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER08280014
082900                     SET DP020-MSG-INFORMATIONAL                  08290014
083000                         DP030-SET-CURSOR-APPL-1                  08300014
083100                                   TO TRUE                        08310014
083200                     MOVE -1       TO MR-SELECTL (1)              08320014
083300                 WHEN ASC-SEL-ITEM = ZERO                         08330014
083400                     MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER    08340014
083500                     SET DP020-MSG-INFORMATIONAL                  08350014
083600                         DP030-SET-CURSOR-APPL-1                  08360014
083700                                   TO TRUE                        08370014
083800                     MOVE -1       TO MR-SELECTL (1)              08380014
083900                 WHEN ASC-SEL-ITEM >  ZERO                        08390014
084000                     PERFORM 2120-GET-PREV-MESSAGE                08400014
084100                     IF ASC-SEL-ITEM >  ZERO                      08410014
084200                         PERFORM 2050-DELETE-LIST-QUEUE           08420014
084300                         PERFORM 3200-RESET-ATTRIBUTES            08430014
084400                         PERFORM 4000-BUILD-INITIAL-PANEL         08440014
084500                     ELSE                                         08450014
084600                         MOVE PC-TSYMSG-00069                     08460014
084700                                           TO DP020-MSG-NUMBER    08470014
084800                         SET DP020-MSG-INFORMATIONAL              08480014
084900                             DP030-SET-CURSOR-APPL-1              08490014
085000                                           TO TRUE                08500014
085100                         MOVE -1   TO MR-SELECTL (1)              08510014
085200                     END-IF                                       08520014
085300             END-EVALUATE                                         08530014
085400                                                                  08540014
085500         WHEN OTHER                                               08550014
085600             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08560014
085700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08570014
085800             IF  PS-NO-ERROR                                      08580014
085900                 SET DP030-CONTINUE-GO                            08590014
086000                                 TO TRUE                          08600014
086100                 PERFORM 2100-CHECK-FUNCTION-KEY                  08610014
086200             ELSE                                                 08620014
086300                 SET DP030-OVERRIDE-GO                            08630014
086400                                 TO TRUE                          08640014
086500             END-IF                                               08650014
086600     END-EVALUATE.                                                08660014
086700 EJECT                                                            08670014
086800*----------------------------------------------------------------*08680014
086900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *08690014
087000*----------------------------------------------------------------*08700014
087100 2050-DELETE-LIST-QUEUE.                                          08710014
087200                                                                  08720014
087300     EXEC CICS                                                    08730014
087400         DELETEQ TS                                               08740014
087500             QUEUE (ASC-LIST-QUEUE-NAME)                          08750014
087600             RESP  (PV-CICS-RESP)                                 08760014
087700     END-EXEC.                                                    08770014
087800                                                                  08780014
087900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       08790014
088000        (PV-CICS-RESP = DFHRESP(QIDERR))                          08800014
088100         CONTINUE                                                 08810014
088200     ELSE                                                         08820014
088300         SET DP013-CICS-ABEND      TO TRUE                        08830014
088400         SET DP013-NO-ROLLBACK     TO TRUE                        08840014
088500                                                                  08850014
088600         MOVE '2050-DELETE-LIST-QUEUE'                            08860014
088700                                   TO DP013-PARAGRAPH             08870014
088800         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    08880014
088900                                   TO DP013-MESSAGE-TEXT (1)      08890014
089000         PERFORM DP013-0000-PROCESS-ABEND                         08900014
089100     END-IF.                                                      08910014
089200                                                                  08920014
089300     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  08930014
089400/                                                                 08940014
089500*----------------------------------------------------------------*08950014
089600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*08960014
089700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *08970014
089800* CICS ARCHITECTURE API.                                         *08980014
089900*----------------------------------------------------------------*08990014
090000 2100-CHECK-FUNCTION-KEY.                                         09000014
090100     SET PS-NEXT-SCREEN TO TRUE.                                  09010014
090200     EVALUATE TRUE                                                09020014
090300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09030014
090400             PERFORM 2050-DELETE-LIST-QUEUE                       09040014
090500             SET ASC-UNIT-SEQ                                     09050014
090600                 SU012-UNIT-SEQ TO TRUE                           09060014
090700             PERFORM 1101-SCREEN-SEQUENCE                         09070014
090800             PERFORM 4000-BUILD-INITIAL-PANEL                     09080014
090900                                                                  09090014
091000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09100014
091100             PERFORM 2050-DELETE-LIST-QUEUE                       09110014
091200             SET ASC-DEPT-SEQ                                     09120014
091300                 SU012-DEPT-SEQ TO TRUE                           09130014
091400             PERFORM 1101-SCREEN-SEQUENCE                         09140014
091500             PERFORM 4000-BUILD-INITIAL-PANEL                     09150014
091600                                                                  09160014
091700         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  09170014
091800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09180014
091900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              09190014
092000                 INITIALIZE SU012-INTER-APPL-COMMAREA             09200014
092100                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09210014
092200                                TO SU012-NUMBER-OF-SELECTED-ITEMS 09220014
092300                 MOVE ASC-STR-NBR      TO SU012-STR-NBR           09230014
092400                 MOVE ASC-STR-NAME     TO SU012-STR-NAME          09240014
092500                 MOVE ASC-SUMMARY-DATE TO SU012-SUMMARY-DATE      09250014
092600                 MOVE ASC-SUMMARY-TIME TO SU012-SUMMARY-TIME      09260014
092700                 MOVE ASC-SERVICE-DC-NAME TO                      09270014
092800                                          SU012-SERVICING-DC      09280014
092900                 MOVE ASC-SCREEN-SEQUENCE TO                      09290014
093000                                          SU012-SCREEN-SEQUENCE   09300014
093100                 PERFORM 5000-PREPARE-SEL-QUEUE                   09310014
093200             ELSE                                                 09320014
093300                 SET DP030-OVERRIDE-GO                            09330014
093400                                   TO TRUE                        09340014
093500                 MOVE PC-TSYMSG-00057                             09350014
093600                                   TO DP020-MSG-NUMBER            09360014
093700                 SET DP020-MSG-WARNING                            09370014
093800                                   TO TRUE                        09380014
093900                 MOVE -1           TO MR-SELECTL(1)               09390014
094000                 SET DP030-SET-CURSOR-APPL-1                      09400014
094100                                   TO TRUE                        09410014
094200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09420014
094300             END-IF                                               09430014
094400                                                                  09440014
094500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  09450014
094600             MOVE +1               TO PV-TOP-ITEM                 09460014
094700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09470014
094800                                                                  09480014
094900         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   09490014
095000             PERFORM 2110-BROWSE-BACKWARD                         09500014
095100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09510014
095200                                                                  09520014
095300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   09530014
095400             PERFORM 2120-BROWSE-FORWARD                          09540014
095500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09550014
095600                                                                  09560014
095700         WHEN DP020-SRC-AID = DP016-ENTER                         09570014
095800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   09580014
095900             IF  PS-ERROR                                         09590014
096000                 CONTINUE                                         09600014
096100             ELSE                                                 09610014
096200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09620014
096300             END-IF                                               09630014
096400                                                                  09640014
096500         WHEN OTHER                                               09650014
096600             SET DP013-NO-ROLLBACK                                09660014
096700                 DP013-XCTL-DISPLAY-RESTART                       09670014
096800                 DP013-CICS-ABEND  TO TRUE                        09680014
096900             MOVE '2100-CHECK-FUNCTION-KEY'                       09690014
097000                                   TO DP013-PARAGRAPH             09700014
097100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09710014
097200                                   TO DP013-MESSAGE-TEXT (1)      09720014
097300             PERFORM DP013-0000-PROCESS-ABEND                     09730014
097400     END-EVALUATE.                                                09740014
097500*                                                                 09750014
097600*----------------------------------------------------------------*09760014
097700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *09770014
097800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *09780014
097900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *09790014
098000*    MESSAGE.                                                    *09800014
098100*----------------------------------------------------------------*09810014
098200                                                                  09820014
098300 2110-BROWSE-BACKWARD.                                            09830014
098400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    09840014
098500         GIVING PV-TOP-ITEM.                                      09850014
098600*                                                                 09860014
098700     IF  ((PV-TOP-ITEM < +1)                                      09870014
098800       OR (PV-TOP-ITEM = +1))                                     09880014
098900         MOVE +1                   TO PV-TOP-ITEM                 09890014
099000*        -- TOP OF LIST --                                        09900014
099100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            09910014
099200         SET DP020-MSG-INFORMATIONAL TO TRUE                      09920014
099300     END-IF.                                                      09930014
099400                                                                  09940014
099500 EJECT                                                            09950014
099600*----------------------------------------------------------------*09960014
099700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *09970014
099800*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *09980014
099900*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *09990014
100000*----------------------------------------------------------------*10000014
100100                                                                  10010014
100200 2120-BROWSE-FORWARD.                                             10020014
100300                                                                  10030014
100400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              10040014
100500         GIVING PV-TOP-ITEM.                                      10050014
100600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   10060014
100700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10070014
100800                                   TO PV-TOP-ITEM                 10080014
100900*        -- BOTTOM OF LIST --                                     10090014
101000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10100014
101100         SET DP020-MSG-INFORMATIONAL                              10110014
101200                                   TO TRUE                        10120014
101300     ELSE                                                         10130014
101400         COMPUTE PV-BOTTOM-ITEM =                                 10140014
101500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 10150014
101600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            10160014
101700*            -- BOTTOM OF LIST --                                 10170014
101800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            10180014
101900             SET DP020-MSG-INFORMATIONAL                          10190014
102000                                   TO TRUE                        10200014
102100         END-IF                                                   10210014
102200     END-IF.                                                      10220014
102300 EJECT                                                            10230014
102400*----------------------------------------------------------------*10240014
102500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *10250014
102600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *10260014
102700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *10270014
102800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *10280014
102900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *10290014
103000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *10300014
103100*----------------------------------------------------------------*10310014
103200                                                                  10320014
103300 2130-CHECK-FOR-JUMP-BROWSE.                                      10330014
103400     SET PS-NO-ERROR               TO TRUE.                       10340014
103500     IF (ASC-START-ITEM-REQUEST = SPACE)                          10350014
103600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10360014
103700                                   TO PV-TOP-ITEM                 10370014
103800     ELSE                                                         10380014
103900         MOVE ASC-START-ITEM-REQUEST                              10390014
104000                                   TO DP010I-UNEDITED-FIELD       10400014
104100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       10410014
104200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     10420014
104300         SET DP010I-NEGATIVE-NOT-ALLOWED                          10430014
104400                                   TO TRUE                        10440014
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10451016
263968              USING DP010I-NUMERIC-EDIT-AREA                      10452016
104600                                                                  10460014
104700         IF  NOT DP010I-ERROR-DETECTED                            10470014
104800             MOVE DP010I-NUMERIC-FIELD                            10480014
104900                                   TO  ASC-START-ITEM-REQUEST-N   10490014
105000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  10500014
105100                 IF  ASC-START-ITEM-REQUEST-N >                   10510014
105200                                          ASC-NUMBER-OF-ITEMS-READ10520014
105300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         10530014
105400                     COMPUTE PV-TOP-ITEM =                        10540014
105500                             ASC-NUMBER-OF-ITEMS-READ             10550014
105600                             - PC-ITEMS-PER-PANEL + 1             10560014
105700                     IF  PV-TOP-ITEM < +1                         10570014
105800                         MOVE +1   TO PV-TOP-ITEM                 10580014
105900                         MOVE PC-TSYMSG-00070                     10590014
106000                                   TO DP020-MSG-NUMBER            10600014
106100                         SET DP020-MSG-INFORMATIONAL              10610014
106200                                   TO TRUE                        10620014
106300                     END-IF                                       10630014
106400                 ELSE                                             10640014
106500                     MOVE ASC-START-ITEM-REQUEST-N                10650014
106600                                   TO PV-TOP-ITEM                 10660014
106700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      10670014
106800                     COMPUTE PV-BOTTOM-ITEM =                     10680014
106900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     10690014
107000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ10700014
107100*                        -- BOTTOM OF LIST --                     10710014
107200                         MOVE PC-TSYMSG-00070                     10720014
107300                                   TO DP020-MSG-NUMBER            10730014
107400                         SET DP020-MSG-INFORMATIONAL              10740014
107500                                   TO TRUE                        10750014
107600                     END-IF                                       10760014
107700                 END-IF                                           10770014
107800             ELSE                                                 10780014
107900*                --- VALUE OUT OF RANGE ----                      10790014
108000                 MOVE PC-TSYMSG-00101                             10800014
108100                                   TO DP020-MSG-NUMBER            10810014
108200                 MOVE -1           TO ASTRTITL                    10820014
108300                 SET DP030-SET-CURSOR-APPL-1                      10830014
108400                                   TO TRUE                        10840014
108500                 MOVE DP015-REVERSE                               10850014
108600                                   TO ASTRTITH                    10860014
108700                 MOVE DP015-RED    TO ASTRTITC                    10870014
108800                 MOVE DP015-UNP-NUM-BRT-MDT                       10880014
108900                                   TO ASTRTITA                    10890014
109000                 SET DP020-MSG-FATAL                              10900014
109100                                   TO TRUE                        10910014
109200                 SET PS-ERROR      TO TRUE                        10920014
109300             END-IF                                               10930014
109400                                                                  10940014
109500         ELSE                                                     10950014
109600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            10960014
109700             MOVE -1               TO ASTRTITL                    10970014
109800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10980014
109900             MOVE DP015-REVERSE    TO ASTRTITH                    10990014
110000             MOVE DP015-RED        TO ASTRTITC                    11000014
110100             MOVE DP015-UNP-NUM-BRT-MDT                           11010014
110200                                   TO ASTRTITA                    11020014
110300             SET DP020-MSG-FATAL   TO TRUE                        11030014
110400             SET PS-ERROR          TO TRUE                        11040014
110500         END-IF                                                   11050014
110600     END-IF.                                                      11060014
110700 EJECT                                                            11070014
110800*----------------------------------------------------------------*11080014
110900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *11090014
111000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *11100014
111100*----------------------------------------------------------------*11110014
111200 2140-DESELECT-ALL-ITEMS.                                         11120014
111300     MOVE +1                       TO ASC-BLK-SUB.                11130014
111400                                                                  11140014
111500     PERFORM 2141-CLEAR-SELECTED-INDS                             11150014
111600         VARYING ASC-ITEM-SUB                                     11160014
111700         FROM 1 BY 1                                              11170014
111800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11180014
111900                                                                  11190014
112000     ADD +1                        TO ASC-BLK-SUB.                11200014
112100                                                                  11210014
112200     PERFORM 2141-CLEAR-SELECTED-INDS                             11220014
112300         VARYING ASC-ITEM-SUB                                     11230014
112400         FROM 1 BY 1                                              11240014
112500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 11250014
112600                                                                  11260014
112700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               11270014
112800                                   TO PV-LIST-ITEM-NUMBER.        11280014
112900                                                                  11290014
113000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            11300014
113100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    11310014
113200                                                                  11320014
113300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     11330014
113400        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      11340014
113500         MOVE +1                   TO ASC-BLK-SUB                 11350014
113600                                                                  11360014
113700         PERFORM 5100-WRITE-TEMP-STORAGE                          11370014
113800                                                                  11380014
113900         MOVE +1                   TO PV-BLOCK-NUMBER             11390014
114000                                                                  11400014
114100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         11410014
114200             PV-FIRST-BLOCK-IN-ARRAY - 1                          11420014
114300                                                                  11430014
114400         PERFORM                                                  11440014
114500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       11450014
114600                                                                  11460014
114700             PERFORM 4410-READ-TEMP-STORAGE                       11470014
114800                                                                  11480014
114900             PERFORM 2141-CLEAR-SELECTED-INDS                     11490014
115000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 11500014
115100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11510014
115200                                                                  11520014
115300             PERFORM 5100-WRITE-TEMP-STORAGE                      11530014
115400                                                                  11540014
115500             ADD +1                TO PV-BLOCK-NUMBER             11550014
115600                                                                  11560014
115700         END-PERFORM                                              11570014
115800                                                                  11580014
115900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         11590014
116000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     11600014
116100                                                                  11610014
116200         PERFORM                                                  11620014
116300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       11630014
116400                   ASC-HIGHEST-BLOCK-WRITTEN                      11640014
116500                                                                  11650014
116600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          11660014
116700                                   TO PV-BLOCK-NUMBER             11670014
116800                                                                  11680014
116900             PERFORM 4410-READ-TEMP-STORAGE                       11690014
117000                                                                  11700014
117100             PERFORM 2141-CLEAR-SELECTED-INDS                     11710014
117200                 VARYING ASC-ITEM-SUB                             11720014
117300                 FROM 1 BY 1                                      11730014
117400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          11740014
117500                                                                  11750014
117600             PERFORM 5100-WRITE-TEMP-STORAGE                      11760014
117700                                                                  11770014
117800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      11780014
117900                                                                  11790014
118000         END-PERFORM                                              11800014
118100                                                                  11810014
118200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             11820014
118300                                   TO PV-BLOCK-NUMBER             11830014
118400                                                                  11840014
118500         PERFORM 4410-READ-TEMP-STORAGE                           11850014
118600     END-IF.                                                      11860014
118700                                                                  11870014
118800                                                                  11880014
118900     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 11890014
119000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.11900014
119100     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  11910014
119200                                                                  11920014
119300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11930014
119400                                                                  11940014
119500 EJECT                                                            11950014
119600*----------------------------------------------------------------*11960014
119700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *11970014
119800*----------------------------------------------------------------*11980014
119900                                                                  11990014
120000 2141-CLEAR-SELECTED-INDS.                                        12000014
120100                                                                  12010014
120200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           12020014
120300             NOT EQUAL ZERO                                       12030014
120400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12040014
120500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12050014
120600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    12060014
120700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  12070014
120800                                   TO TRUE                        12080014
120900         END-IF                                                   12090014
121000     END-IF.                                                      12100014
121100                                                                  12110014
121200/                                                                 12120014
121300*----------------------------------------------------------------*12130014
121400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *12140014
121500*  FOR ALL ITEMS.                                                *12150014
121600*----------------------------------------------------------------*12160014
121700                                                                  12170014
121800 2150-SELECT-ALL-ITEMS.                                           12180014
121900                                                                  12190014
122000     MOVE +1                       TO ASC-BLK-SUB.                12200014
122100                                                                  12210014
122200     PERFORM 2151-SET-SELECTED-INDS                               12220014
122300         VARYING ASC-ITEM-SUB                                     12230014
122400         FROM 1 BY 1                                              12240014
122500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12250014
122600                                                                  12260014
122700     ADD +1                        TO ASC-BLK-SUB.                12270014
122800                                                                  12280014
122900     PERFORM 2151-SET-SELECTED-INDS                               12290014
123000         VARYING ASC-ITEM-SUB                                     12300014
123100         FROM 1 BY 1                                              12310014
123200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12320014
123300                                                                  12330014
123400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12340014
123500                                   TO PV-LIST-ITEM-NUMBER.        12350014
123600                                                                  12360014
123700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12370014
123800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12380014
123900                                                                  12390014
124000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12400014
124100        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    12410014
124200         MOVE +1                   TO ASC-BLK-SUB                 12420014
124300                                                                  12430014
124400         PERFORM 5100-WRITE-TEMP-STORAGE                          12440014
124500                                                                  12450014
124600         MOVE +1                   TO PV-BLOCK-NUMBER             12460014
124700                                                                  12470014
124800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12480014
124900             PV-FIRST-BLOCK-IN-ARRAY - 1                          12490014
125000                                                                  12500014
125100         PERFORM                                                  12510014
125200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12520014
125300                                                                  12530014
125400             PERFORM 4410-READ-TEMP-STORAGE                       12540014
125500                                                                  12550014
125600             PERFORM 2151-SET-SELECTED-INDS                       12560014
125700                 VARYING ASC-ITEM-SUB                             12570014
125800                 FROM 1 BY 1                                      12580014
125900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12590014
126000                                                                  12600014
126100             PERFORM 5100-WRITE-TEMP-STORAGE                      12610014
126200                                                                  12620014
126300             ADD +1                TO PV-BLOCK-NUMBER             12630014
126400                                                                  12640014
126500         END-PERFORM                                              12650014
126600                                                                  12660014
126700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12670014
126800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12680014
126900                                                                  12690014
127000         PERFORM                                                  12700014
127100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12710014
127200                   ASC-HIGHEST-BLOCK-WRITTEN                      12720014
127300                                                                  12730014
127400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12740014
127500                                   TO PV-BLOCK-NUMBER             12750014
127600                                                                  12760014
127700             PERFORM 4410-READ-TEMP-STORAGE                       12770014
127800                                                                  12780014
127900             PERFORM 2151-SET-SELECTED-INDS                       12790014
128000                 VARYING ASC-ITEM-SUB                             12800014
128100                 FROM 1 BY 1                                      12810014
128200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12820014
128300                                                                  12830014
128400             PERFORM 5100-WRITE-TEMP-STORAGE                      12840014
128500                                                                  12850014
128600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12860014
128700                                                                  12870014
128800         END-PERFORM                                              12880014
128900                                                                  12890014
129000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12900014
129100                                   TO PV-BLOCK-NUMBER             12910014
129200                                                                  12920014
129300         PERFORM 4410-READ-TEMP-STORAGE                           12930014
129400     END-IF.                                                      12940014
129500                                                                  12950014
129600                                                                  12960014
129700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             12970014
129800                       ASC-NUMBER-OF-SELECTED-ITEMS.              12980014
129900                                                                  12990014
130000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13000014
130100                                                                  13010014
130200 EJECT                                                            13020014
130300*----------------------------------------------------------------*13030014
130400*    MARK EACH ITEM AS BEING SELECTED.                           *13040014
130500*----------------------------------------------------------------*13050014
130600                                                                  13060014
130700 2151-SET-SELECTED-INDS.                                          13070014
130800                                                                  13080014
130900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13090014
131000             NOT EQUAL ZERO                                       13100014
131100         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13110014
131200             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             13120014
131300                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        13130014
131400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13140014
131500                               TO  TRUE                           13150014
131600         END-IF                                                   13160014
131700     END-IF.                                                      13170014
131800******************************************************************13180014
131900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **13190014
132000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **13200014
132100******************************************************************13210014
132200 2200-MOVE-SCREEN-TO-COMMAREA.                                    13220014
132300                                                                  13230014
132400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             13240014
132500     MOVE +1                       TO PV-SUB.                     13250014
132600*                                                                 13260014
132700     PERFORM 3100-SET-SUBSCRIPTS.                                 13270014
132800     IF  ASTRTITL > ZERO                                          13280014
132900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          13290014
133000     ELSE                                                         13300014
133100         IF  ASTRTITF = DP015-ERASE-EOF                           13310014
133200             INITIALIZE ASC-START-ITEM-REQUEST                    13320014
133300         END-IF                                                   13330014
133400     END-IF.                                                      13340014
133500     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          13350014
133600         VARYING PV-SUB                                           13360014
133700         FROM 1 BY 1                                              13370014
133800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      13380014
133900******************************************************************13390014
134000** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**13400014
134100******************************************************************13410014
134200 2210-MOVE-LINES-TO-COMMAREA.                                     13420014
134300     IF  MR-SELECTL (PV-SUB) > ZERO                               13430014
134400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             13440014
134500         MOVE MR-SELECTI (PV-SUB)                                 13450014
134600                                   TO ASC-TEMP-SELECTED-SW        13460014
134700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      13470014
134800     ELSE                                                         13480014
134900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                13490014
135000                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     13500014
135100                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        13510014
135200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      13520014
135300         END-IF                                                   13530014
135400     END-IF.                                                      13540014
135500     ADD +1                        TO ASC-ITEM-SUB.               13550014
135600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        13560014
135700         ADD +1                    TO ASC-BLK-SUB                 13570014
135800         MOVE +1                   TO ASC-ITEM-SUB                13580014
135900     END-IF.                                                      13590014
136000******************************************************************13600014
136100** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **13610014
136200** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **13620014
136300******************************************************************13630014
136400 3000-EDIT-DATA-IN-COMMAREA.                                      13640014
136500     SET PS-NO-ERROR               TO TRUE.                       13650014
136600     PERFORM 3200-RESET-ATTRIBUTES.                               13660014
136700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     13670014
136800**                                                                13680014
136900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              13690014
137000* EDITTING IS DONE FROM THE BOTTOM UP.                            13700014
137100**                                                                13710014
137200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       13720014
137300         ASC-ITEMS-DISPLAYED - 1.                                 13730014
137400     PERFORM 3100-SET-SUBSCRIPTS.                                 13740014
137500     PERFORM 3300-EDIT-SELECTIONS                                 13750014
137600         VARYING PV-SUB                                           13760014
137700         FROM PV-SUB BY -1                                        13770014
137800         UNTIL PV-SUB < +1                                        13780014
137900*                                                                 13790014
138000     IF  PS-NO-ERROR                                              13800014
138100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        13810014
138200     END-IF.                                                      13820014
138300*                                                                 13830014
138400     IF  ((PS-NO-ERROR)                                           13840014
138500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   13850014
138600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    13860014
138700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  13870014
138800     END-IF.                                                      13880014
138900 EJECT                                                            13890014
139000*----------------------------------------------------------------*13900014
139100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *13910014
139200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*13920014
139300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *13930014
139400*                                                                *13940014
139500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *13950014
139600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *13960014
139700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *13970014
139800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *13980014
139900*----------------------------------------------------------------*13990014
140000                                                                  14000014
140100 3100-SET-SUBSCRIPTS.                                             14010014
140200                                                                  14020014
140300     COMPUTE ASC-ITEM-SUB =                                       14030014
140400         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        14040014
140500                                                                  14050014
140600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         14060014
140700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            14070014
140800                                                                  14080014
140900         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               14090014
141000     ELSE                                                         14100014
141100         MOVE +1                     TO ASC-BLK-SUB               14110014
141200     END-IF.                                                      14120014
141300******************************************************************14130014
141400** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **14140014
141500******************************************************************14150014
141600                                                                  14160014
141700 3200-RESET-ATTRIBUTES.                                           14170014
141800     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   14180014
141900     MOVE DP015-GREEN              TO ASTRTITC.                   14190014
142000     MOVE DP015-UNDERLINE          TO ASTRTITH.                   14200014
142100*                                                                 14210014
142200     PERFORM                                                      14220014
142300         VARYING PV-SUB                                           14230014
142400         FROM 1 BY 1                                              14240014
142500         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        14250014
142600         MOVE DP015-UNP-ALP-NOR-OFF                               14260014
142700                                   TO MR-SELECTA (PV-SUB)         14270014
142800         MOVE DP015-ASK-NOR-OFF    TO MR-DEPT-A (PV-SUB)          14280014
142900                                      MR-DEPT-DESC-A (PV-SUB)     14290014
143000                                      MR-BUS-AREA-A (PV-SUB)      14300014
143100                                      MR-CARTONS-A (PV-SUB)       14310014
143200                                      MR-UNITS-A (PV-SUB)         14320014
143300                                      MR-SKU-COUNT-A (PV-SUB)     14330014
143400                                      MR-AD-A (PV-SUB)            14340014
143500         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         14350014
143600         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         14360014
143700     END-PERFORM.                                                 14370014
143800******************************************************************14380014
143900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **14390014
144000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **14400014
144100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **14410014
144200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **14420014
144300******************************************************************14430014
144400 3300-EDIT-SELECTIONS.                                            14440014
144500     EVALUATE TRUE                                                14450014
144600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14460014
144700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         14470014
144800                 CONTINUE                                         14480014
144900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         14490014
145000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14500014
145100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   14510014
145200                 MOVE ASC-TEMP-SELECTED-SW                        14520014
145300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14530014
145400                                TO ASC-SELECTED-SW                14540014
145500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14550014
145600             END-IF                                               14560014
145700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     14570014
145800                 = SPACE                                          14580014
145900             EVALUATE TRUE                                        14590014
146000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       14600014
146100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS14610014
146200                     MOVE SPACE TO ASC-SELECTED-SW                14620014
146300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14630014
146400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        14640014
146500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    14650014
146600                     MOVE SPACE TO ASC-SELECTED-SW                14660014
146700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14670014
146800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          14680014
146900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      14690014
147000                     MOVE SPACE TO ASC-SELECTED-SW                14700014
147100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  14710014
147200             END-EVALUATE                                         14720014
147300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           14730014
147400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14740014
147500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14750014
147600             END-IF                                               14760014
147700             PERFORM 3310-EDIT-RANGE                              14770014
147800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             14780014
147900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14790014
148000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    14800014
148100             END-IF                                               14810014
148200             PERFORM 3310-EDIT-RANGE                              14820014
148300         WHEN OTHER                                               14830014
148400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           14840014
148500             SET DP020-MSG-FATAL    TO TRUE                       14850014
148600             MOVE -1                TO MR-SELECTL (PV-SUB)        14860014
148700             SET DP030-SET-CURSOR-APPL-1                          14870014
148800                                    TO TRUE                       14880014
148900             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        14890014
149000             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        14900014
149100             SET PS-ERROR TO TRUE                                 14910014
149200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            14920014
149300                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     14930014
149400                 MOVE SPACE         TO ASC-SELECTED-SW            14940014
149500                                        (ASC-BLK-SUB ASC-ITEM-SUB)14950014
149600             END-IF                                               14960014
149700     END-EVALUATE.                                                14970014
149800                                                                  14980014
149900     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 14990014
150000     SUBTRACT +1 FROM ASC-ITEM-SUB.                               15000014
150100     IF  ASC-ITEM-SUB < 1                                         15010014
150200         SUBTRACT +1 FROM ASC-BLK-SUB                             15020014
150300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                15030014
150400     END-IF.                                                      15040014
150500                                                                  15050014
150600******************************************************************15060014
150700** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **15070014
150800** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **15080014
150900** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**15090014
151000** THE ENDING.                                                  **15100014
151100******************************************************************15110014
151200 3310-EDIT-RANGE.                                                 15120014
151300     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                15130014
151400         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   15140014
151500             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)15150014
151600                                   TO ASC-SELECTED-SW             15160014
151700                                        (ASC-BLK-SUB ASC-ITEM-SUB)15170014
151800             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 15180014
151900         ELSE                                                     15190014
152000             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     15200014
152100                 CONTINUE                                         15210014
152200             ELSE                                                 15220014
152300*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        15230014
152400                 MOVE PC-TSYMSG-00054                             15240014
152500                                   TO DP020-MSG-NUMBER            15250014
152600                 SET DP020-MSG-FATAL                              15260014
152700                                   TO TRUE                        15270014
152800                 MOVE -1           TO MR-SELECTL (PV-SUB)         15280014
152900                 SET DP030-SET-CURSOR-APPL-1                      15290014
153000                                   TO TRUE                        15300014
153100                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         15310014
153200                 MOVE DP015-UNDERLINE                             15320014
153300                                   TO MR-SELECTH (PV-SUB)         15330014
153400                 SET PS-ERROR      TO TRUE                        15340014
153500             END-IF                                               15350014
153600         END-IF                                                   15360014
153700     ELSE                                                         15370014
153800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     15380014
153900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 15390014
154000                                   TO ASC-SELECTED-SW             15400014
154100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   15410014
154200             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   15420014
154300         ELSE                                                     15430014
154400             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       15440014
154500                 CONTINUE                                         15450014
154600             ELSE                                                 15460014
154700*                -- ONLY ONE END-OF-RANGE ALLOWED --              15470014
154800                 MOVE PC-TSYMSG-00055                             15480014
154900                                   TO DP020-MSG-NUMBER            15490014
155000                 SET DP020-MSG-FATAL                              15500014
155100                                   TO TRUE                        15510014
155200                 MOVE -1           TO MR-SELECTL (PV-SUB)         15520014
155300                 SET DP030-SET-CURSOR-APPL-1                      15530014
155400                                   TO TRUE                        15540014
155500                 SET PS-ERROR      TO TRUE                        15550014
155600             END-IF                                               15560014
155700         END-IF                                                   15570014
155800     END-IF.                                                      15580014
155900*                                                                 15590014
156000******************************************************************15600014
156100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **15610014
156200** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **15620014
156300******************************************************************15630014
156400 3400-CHECK-RANGE-SEQUENCE.                                       15640014
156500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       15650014
156600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      15660014
156700       AND  ASC-START-OF-SELECTED-RANGE >                         15670014
156800                                         ASC-END-OF-SELECTED-RANGE15680014
156900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                15690014
157000         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 15700014
157100         SET DP020-MSG-FATAL TO TRUE                              15710014
157200         SET PS-ERROR TO TRUE                                     15720014
157300         PERFORM 3410-POSITION-AT-ERROR                           15730014
157400     END-IF.                                                      15740014
157500******************************************************************15750014
157600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **15760014
157700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **15770014
157800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **15780014
157900******************************************************************15790014
158000 3410-POSITION-AT-ERROR.                                          15800014
158100     SET DP030-SET-CURSOR-APPL-1                                  15810014
158200                                   TO TRUE.                       15820014
158300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 15830014
158400                    - PV-TOP-ITEM + 1.                            15840014
158500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15850014
158600         CONTINUE                                                 15860014
158700     ELSE                                                         15870014
158800         MOVE -1                   TO MR-SELECTL (PV-SUB)         15880014
158900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         15890014
159000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         15900014
159100     END-IF.                                                      15910014
159200*                                                                 15920014
159300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   15930014
159400                    - PV-TOP-ITEM + 1.                            15940014
159500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      15950014
159600         CONTINUE                                                 15960014
159700     ELSE                                                         15970014
159800         MOVE -1                   TO MR-SELECTL (PV-SUB)         15980014
159900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         15990014
160000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         16000014
160100     END-IF.                                                      16010014
160200 EJECT                                                            16020014
160300*----------------------------------------------------------------*16030014
160400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *16040014
160500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *16050014
160600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *16060014
160700*----------------------------------------------------------------*16070014
160800                                                                  16080014
160900 3500-MARK-RANGE-AS-SELECTED.                                     16090014
161000     MOVE +1                       TO  ASC-BLK-SUB.               16100014
161100     PERFORM 3510-MARK-SELECTED-INDS                              16110014
161200         VARYING ASC-ITEM-SUB                                     16120014
161300         FROM 1 BY 1                                              16130014
161400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16140014
161500                                                                  16150014
161600     ADD +1                        TO ASC-BLK-SUB.                16160014
161700     PERFORM 3510-MARK-SELECTED-INDS                              16170014
161800         VARYING ASC-ITEM-SUB                                     16180014
161900         FROM 1 BY 1                                              16190014
162000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16200014
162100                                                                  16210014
162200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16220014
162300                                   TO  PV-LIST-ITEM-NUMBER.       16230014
162400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16240014
162500         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         16250014
162600               PC-ITEMS-PER-PANEL).                               16260014
162700                                                                  16270014
162800     MOVE ASC-START-OF-SELECTED-RANGE                             16280014
162900                                   TO PV-START-OF-SELECTED-RANGE. 16290014
163000     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            16300014
163100         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  16310014
163200               PC-ITEMS-PER-PANEL).                               16320014
163300                                                                  16330014
163400     MOVE ASC-END-OF-SELECTED-RANGE                               16340014
163500                                   TO  PV-END-OF-SELECTED-RANGE.  16350014
163600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             16360014
163700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    16370014
163800               PC-ITEMS-PER-PANEL).                               16380014
163900     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             16390014
164000         PV-FIRST-BLOCK-IN-ARRAY + 1.                             16400014
164100                                                                  16410014
164200     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    16420014
164300        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        16430014
164400         MOVE +1                   TO ASC-BLK-SUB                 16440014
164500         PERFORM 5100-WRITE-TEMP-STORAGE                          16450014
164600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16460014
164700             PV-FIRST-BLOCK-IN-ARRAY - 1                          16470014
164800                                                                  16480014
164900         PERFORM                                                  16490014
165000             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      16500014
165100                   PV-PREV-BLOCK-IN-ARRAY                         16510014
165200             MOVE PV-FIRST-BLOCK-IN-RANGE                         16520014
165300                                   TO PV-BLOCK-NUMBER             16530014
165400             PERFORM 4410-READ-TEMP-STORAGE                       16540014
165500             PERFORM 3510-MARK-SELECTED-INDS                      16550014
165600                 VARYING ASC-ITEM-SUB                             16560014
165700                 FROM 1 BY 1                                      16570014
165800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16580014
165900             PERFORM 5100-WRITE-TEMP-STORAGE                      16590014
166000             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     16600014
166100         END-PERFORM                                              16610014
166200                                                                  16620014
166300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16630014
166400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16640014
166500         PERFORM                                                  16650014
166600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16660014
166700                   PV-LAST-BLOCK-IN-RANGE                         16670014
166800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16680014
166900                                   TO PV-BLOCK-NUMBER             16690014
167000             PERFORM 4410-READ-TEMP-STORAGE                       16700014
167100             PERFORM 3510-MARK-SELECTED-INDS                      16710014
167200                 VARYING ASC-ITEM-SUB                             16720014
167300                 FROM 1 BY 1                                      16730014
167400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16740014
167500             PERFORM 5100-WRITE-TEMP-STORAGE                      16750014
167600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16760014
167700         END-PERFORM                                              16770014
167800                                                                  16780014
167900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16790014
168000                                   TO PV-BLOCK-NUMBER             16800014
168100         PERFORM 4410-READ-TEMP-STORAGE                           16810014
168200     END-IF.                                                      16820014
168300                                                                  16830014
168400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 16840014
168500                                      ASC-END-OF-SELECTED-RANGE.  16850014
168600                                                                  16860014
168700/                                                                 16870014
168800*----------------------------------------------------------------*16880014
168900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *16890014
169000*----------------------------------------------------------------*16900014
169100                                                                  16910014
169200 3510-MARK-SELECTED-INDS.                                         16920014
169300                                                                  16930014
169400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16940014
169500                                ASC-ITEM-SUB) >                   16950014
169600         ASC-START-OF-SELECTED-RANGE)                             16960014
169700     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         16970014
169800                                ASC-ITEM-SUB) =                   16980014
169900         ASC-START-OF-SELECTED-RANGE)                             16990014
170000                                                                  17000014
170100         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17010014
170200                                    ASC-ITEM-SUB) <               17020014
170300             ASC-END-OF-SELECTED-RANGE)                           17030014
170400         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17040014
170500                                    ASC-ITEM-SUB) =               17050014
170600             ASC-END-OF-SELECTED-RANGE)                           17060014
170700                                                                  17070014
170800             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17080014
170900                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   17090014
171000                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   17100014
171100                               TO TRUE                            17110014
171200                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              17120014
171300                               TO TRUE                            17130014
171400                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    17140014
171500             END-IF                                               17150014
171600         END-IF                                                   17160014
171700     END-IF.                                                      17170014
171800                                                                  17180014
171900 EJECT                                                            17190014
172000*----------------------------------------------------------------*17200014
172100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *17210014
172200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *17220014
172300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *17230014
172400*    DISPLAY THE PANEL TO USER.                                  *17240014
172500*----------------------------------------------------------------*17250014
172600                                                                  17260014
172700 4000-BUILD-INITIAL-PANEL.                                        17270014
172800                                                                  17280014
172900     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            17290014
173000                                 ASC-BLOCK-ENTRIES (2).           17300014
173100     MOVE +1                 TO ASC-BLK-SUB.                      17310014
173200     SET ASC-ITEMS-LEFT-ON-DB                                     17320014
173300                             TO TRUE.                             17330014
173400                                                                  17340014
173500     MOVE ZERO               TO ASC-ITEM-SUB                      17350014
173600                                ASC-NUMBER-OF-ITEMS-READ          17360014
173700                                ASC-NUMBER-OF-SELECTED-ITEMS      17370014
173800                                ASC-HIGHEST-BLOCK-WRITTEN         17380014
173900                                ASC-START-OF-SELECTED-RANGE       17390014
174000                                ASC-END-OF-SELECTED-RANGE         17400014
174100                                ASC-ITEM-AT-TOP-OF-PANEL.         17410014
174200                                                                  17420014
174300     MOVE SU012-STR-NBR          TO ASC-STR-NBR                   17430014
174400                                                                  17440014
174500     PERFORM 4100-PREPARE-CURSOR                                  17450014
174600                                                                  17460014
174700     PERFORM 4010-OPEN-CURSOR.                                    17470014
174800                                                                  17480014
174900     PERFORM 4300-READ-ITEMS-FROM-DB.                             17490014
175000                                                                  17500014
175100     PERFORM 4020-CLOSE-CURSOR.                                   17510014
175200                                                                  17520014
175300     MOVE +1                   TO  PV-TOP-ITEM.                   17530014
175400                                                                  17540014
175500*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        17550014
175600*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   17560014
175700*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      17570014
175800*    THE ORIGINAL SCREEN.                                         17580014
175900     EVALUATE TRUE                                                17590014
176000         WHEN SU013-SELECTED-ITEMS > 1                            17600014
176100             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  17610014
176200                 SET DP020-MSG-WARNING TO  TRUE                   17620014
176300                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       17630014
176400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17640014
176500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17650014
176600             ELSE                                                 17660014
176700                 MOVE -1               TO MR-SELECTL (1)          17670014
176800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17680014
176900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17690014
177000             END-IF                                               17700014
177100         WHEN OTHER                                               17710014
177200             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  17720014
177300                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            17730014
177400                 SET DP020-MSG-FATAL   TO  TRUE                   17740014
177500                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       17750014
177600             ELSE                                                 17760014
177700                 MOVE -1               TO MR-SELECTL (1)          17770014
177800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              17780014
177900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             17790014
178000             END-IF                                               17800014
178001     END-EVALUATE.                                                17800114
178002/                                                                 17800200
178003 4010-OPEN-CURSOR.                                                17800300
178004                                                                  17800400
178005     EVALUATE TRUE                                                17800500
178006         WHEN ASC-AREA-DEPT-LIST                                  17800606
178007             EVALUATE TRUE                                        17800714
178008             WHEN ASC-DEPT-SEQ                                    17800800
178009                 MOVE 'CURSOR:  DEPT CSR'                         17800900
178010                                   TO DP013-MESSAGE-TEXT (2)      17801000
178020                 EXEC SQL                                         17802000
178030                     OPEN AREA-DEPT-CSR                           17803014
178040                 END-EXEC                                         17804014
178050                                                                  17805014
178060             WHEN ASC-UNIT-SEQ                                    17806014
178070                 MOVE 'CURSOR:  UNIT CSR'                         17807014
178080                                   TO DP013-MESSAGE-TEXT (2)      17808014
178090                 EXEC SQL                                         17809014
178100                     OPEN AREA-DEPT-CSR-ALT                       17810014
178200                 END-EXEC                                         17820014
178300                                                                  17830014
178301             END-EVALUATE                                         17830114
178302         WHEN ASC-DEPT-DIRCT-LIST                                 17830206
178303             EVALUATE TRUE                                        17830314
178304             WHEN ASC-DEPT-SEQ                                    17830400
178305                 MOVE 'CURSOR: DEPT-DIRCT CSR'                    17830500
178306                                   TO DP013-MESSAGE-TEXT (2)      17830600
178307                 EXEC SQL                                         17830700
178308                     OPEN DEPT-DIRCT-CSR                          17830806
178309                 END-EXEC                                         17830900
178310                                                                  17831000
178320             WHEN ASC-UNIT-SEQ                                    17832014
178330                 MOVE 'CURSOR: DEPT-DIRCT-ALT CSR'                17833014
178340                                   TO DP013-MESSAGE-TEXT (2)      17834014
178350                 EXEC SQL                                         17835014
178360                     OPEN DEPT-DIRCT-CSR-ALT                      17836014
178370                 END-EXEC                                         17837014
178380                                                                  17838014
178390             END-EVALUATE                                         17839014
178400     END-EVALUATE                                                 17840014
178500                                                                  17850014
178600     EVALUATE TRUE                                                17860014
178700         WHEN SQLCODE = ZERO                                      17870014
178800             CONTINUE                                             17880014
178900         WHEN SQLCODE = -904                                      17890014
179000         WHEN SQLCODE = -911                                      17900014
179100         WHEN SQLCODE = -913                                      17910014
179200             PERFORM 9900-SOFT-ABORT                              17920014
179300         WHEN SQLWARN0 NOT = SPACES                               17930014
179400         WHEN SQLCODE < ZERO                                      17940014
179500         WHEN SQLCODE > ZERO                                      17950014
179600             MOVE '4010-OPEN-CURSOR'                              17960014
179700                                   TO DP013-PARAGRAPH             17970014
179800             MOVE 'OPEN TRAILER STATUS CURSOR - '                 17980014
179900                                   TO DP013-MESSAGE-TEXT (1)      17990014
180000             MOVE SQLCA        TO DP013-SQLCA                     18000014
180100             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        18010014
180200             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        18020014
180300             SET DP013-DB2-ABEND                                  18030014
180400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18040014
180500             PERFORM DP013-0000-PROCESS-ABEND                     18050014
180600     END-EVALUATE.                                                18060014
180700/                                                                 18070014
180800 4020-CLOSE-CURSOR.                                               18080014
180801                                                                  18080114
180802     EVALUATE TRUE                                                18080200
180803         WHEN ASC-AREA-DEPT-LIST                                  18080306
180804             EVALUATE TRUE                                        18080414
180805             WHEN ASC-DEPT-SEQ                                    18080500
180806                 MOVE 'CURSOR:  DEPT CSR'                         18080600
180807                                   TO DP013-MESSAGE-TEXT (2)      18080700
180808                 EXEC SQL                                         18080800
180809                     CLOSE AREA-DEPT-CSR                          18080906
180810                 END-EXEC                                         18081000
180811                                                                  18081100
180812             WHEN ASC-UNIT-SEQ                                    18081200
180813                 MOVE 'CURSOR:  UNIT CSR'                         18081300
180814                                   TO DP013-MESSAGE-TEXT (2)      18081400
180815                 EXEC SQL                                         18081500
180816                     CLOSE AREA-DEPT-CSR-ALT                      18081606
180817                 END-EXEC                                         18081700
180818                                                                  18081800
180819             END-EVALUATE                                         18081900
180820         WHEN ASC-DEPT-DIRCT-LIST                                 18082006
180821             EVALUATE TRUE                                        18082114
180822             WHEN ASC-DEPT-SEQ                                    18082200
180823                 MOVE 'CURSOR: DEPT-DIRCT CSR'                    18082300
180824                                   TO DP013-MESSAGE-TEXT (2)      18082400
180825                 EXEC SQL                                         18082500
180826                     CLOSE DEPT-DIRCT-CSR                         18082606
180827                 END-EXEC                                         18082700
180828                                                                  18082800
180829             WHEN ASC-UNIT-SEQ                                    18082900
180830                 MOVE 'CURSOR: DEPT-DIRCT-ALT CSR'                18083000
180831                                   TO DP013-MESSAGE-TEXT (2)      18083100
180832                 EXEC SQL                                         18083200
180833                     CLOSE DEPT-DIRCT-CSR-ALT                     18083306
180834                 END-EXEC                                         18083400
180835                                                                  18083500
180836             END-EVALUATE                                         18083600
180837     END-EVALUATE                                                 18083700
180838*                                                                 18083814
180839     EVALUATE TRUE                                                18083914
180840         WHEN SQLCODE = ZERO                                      18084014
180850             CONTINUE                                             18085014
180860         WHEN SQLCODE = -904                                      18086014
180870         WHEN SQLCODE = -911                                      18087014
180880         WHEN SQLCODE = -913                                      18088014
180890             PERFORM 9900-SOFT-ABORT                              18089014
180900         WHEN SQLWARN0 NOT = SPACES                               18090014
181000         WHEN SQLCODE < ZERO                                      18100014
181100         WHEN SQLCODE > ZERO                                      18110014
181200             MOVE '4020-CLOSE-CURSOR'                             18120014
181300                               TO DP013-PARAGRAPH                 18130014
181400             MOVE 'CLOSE CURSOR '                                 18140014
181500                               TO DP013-MESSAGE-TEXT (1)          18150014
181600             MOVE SQLCA        TO DP013-SQLCA                     18160014
181700             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        18170014
181800             SET DP013-DB2-ABEND                                  18180014
181900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18190014
182000             PERFORM DP013-0000-PROCESS-ABEND                     18200014
182100     END-EVALUATE.                                                18210014
182200                                                                  18220014
182300 EJECT                                                            18230014
182400*----------------------------------------------------------------*18240014
182500*    SET UP THE HOST VARIABLES.                                  *18250014
182600*----------------------------------------------------------------*18260014
182700                                                                  18270014
182800 4100-PREPARE-CURSOR.                                             18280014
182900                                                                  18290014
183000     MOVE ASC-TRIP-OCRNC-ID  TO DK-TRIP-OCRNC-ID                  18300014
183100     MOVE ASC-BUS-AREA-ID    TO DK-BUS-AREA-ID                    18310014
183200                                                                  18320014
183300     EVALUATE TRUE                                                18330014
183400         WHEN SU012-DEPT-SEQ                                      18340014
183500             SET ASC-DEPT-SEQ         TO TRUE                     18350014
183600         WHEN SU012-UNIT-SEQ                                      18360014
183700             SET ASC-UNIT-SEQ         TO TRUE                     18370014
183800     END-EVALUATE.                                                18380014
183900                                                                  18390014
184000/                                                                 18400014
184100*----------------------------------------------------------------*18410014
184200*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *18420014
184300*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *18430014
184400*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *18440014
184500*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *18450014
184600*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *18460014
184700*                                                                *18470014
184800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *18480014
184900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *18490014
185000*    UPON INITIALIZATION.                                        *18500014
185100*----------------------------------------------------------------*18510014
185200                                                                  18520014
185300 4300-READ-ITEMS-FROM-DB.                                         18530014
185400                                                                  18540014
185500     PERFORM                                                      18550014
185600         VARYING PV-READ-COUNT                                    18560014
185700         FROM 1 BY 1                                              18570014
185800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    18580014
185900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         18590014
186000                                                                  18600014
186100         PERFORM 4310-FETCH                                       18610014
186200                                                                  18620014
186300         IF  ASC-ITEMS-LEFT-ON-DB                                 18630014
186400             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                18640014
186500                 ADD +1            TO ASC-ITEM-SUB                18650014
186600             ELSE                                                 18660014
186700                 ADD +1            TO ASC-BLK-SUB                 18670014
186800                 MOVE +1           TO ASC-ITEM-SUB                18680014
186900                                                                  18690014
187000                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         18700014
187100                     MOVE +1       TO ASC-BLK-SUB                 18710014
187200                     SET ASC-BLOCK-MODIFIED (1)                   18720014
187300                                   TO TRUE                        18730014
187400                     PERFORM 5100-WRITE-TEMP-STORAGE              18740014
187500                     MOVE ASC-BLOCK-ENTRIES                       18750014
187600                               (PC-MAX-BLOCKS-IN-ARRAY)           18760014
187700                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 18770014
187800                     ADD +1        TO ASC-BLK-SUB                 18780014
187900                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   18790014
188000                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      18800014
188100                                   TO TRUE                        18810014
188200                 END-IF                                           18820014
188300             END-IF                                               18830014
188400             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18840014
188500             PERFORM 4300A-MOVE-TO-COMMAREA                       18850014
188600         END-IF                                                   18860014
188700     END-PERFORM.                                                 18870014
188800                                                                  18880014
188900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          18890014
189000         MOVE +1               TO ASC-BLK-SUB                     18900014
189100         PERFORM 5100-WRITE-TEMP-STORAGE                          18910014
189200         ADD +1                TO ASC-BLK-SUB                     18920014
189300         PERFORM 5100-WRITE-TEMP-STORAGE                          18930014
189400                                                                  18940014
189500         MOVE 1                TO ASC-BLK-SUB                     18950014
189600                                  PV-BLOCK-NUMBER                 18960014
189700         PERFORM 4410-READ-TEMP-STORAGE                           18970014
189800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             18980014
189900             MOVE 2            TO ASC-BLK-SUB                     18990014
190000                                  PV-BLOCK-NUMBER                 19000014
190100             PERFORM 4410-READ-TEMP-STORAGE                       19010014
190200         END-IF                                                   19020014
190300     END-IF.                                                      19030014
190400/                                                                 19040014
190500 4300A-MOVE-TO-COMMAREA.                                          19050014
190600                                                                  19060014
190700     MOVE ASC-NUMBER-OF-ITEMS-READ    TO ASC-LIST-ITEM-NUMBER     19070014
190800                                        (ASC-BLK-SUB ASC-ITEM-SUB)19080014
190900                                                                  19090014
191000     MOVE SUT00009-DEPT-NBR      TO ASC-DEPT-NBR                  19100014
191100                                        (ASC-BLK-SUB ASC-ITEM-SUB)19110014
191200                                                                  19120014
191300     IF SUT00009-DEPT-NBR = 9999                                  19130014
191400         MOVE 'UNKNOWN'          TO ASC-DEPT-DESC                 19140014
191500                                        (ASC-BLK-SUB ASC-ITEM-SUB)19150014
191600                                     ASC-BUS-AREA                 19160014
191700                                        (ASC-BLK-SUB ASC-ITEM-SUB)19170014
191800     ELSE                                                         19180014
191900         PERFORM 4300B1-DEPT-NAME                                 19190014
192000         MOVE XL073-DEPT-NAME    TO ASC-DEPT-DESC                 19200015
192100                                        (ASC-BLK-SUB ASC-ITEM-SUB)19210014
192200         PERFORM 4300D-BUS-AREA-NAME                              19220014
192300         MOVE XLT00000-BUS-AREA-DESC                              19230014
192400                                  TO ASC-BUS-AREA                 19240014
192500                                        (ASC-BLK-SUB ASC-ITEM-SUB)19250014
192600     END-IF                                                       19260014
192700                                                                  19270014
192800     MOVE SUT00009-UNT-QTY       TO ASC-UNT-QTY                   19280014
192900                                        (ASC-BLK-SUB ASC-ITEM-SUB)19290014
193000     MOVE SUT00009-SKU-QTY       TO ASC-SKU-COUNT                 19300014
193100                                        (ASC-BLK-SUB ASC-ITEM-SUB)19310014
193200     MOVE SUT00009-CART-QTY      TO ASC-CART-QTY                  19320014
193300                                        (ASC-BLK-SUB ASC-ITEM-SUB)19330014
193400                                                                  19340014
193500     PERFORM 4300C-AD-DATES.                                      19350014
193600     IF PV-DB2-COUNT > ZERO                                       19360014
193700         MOVE 'Y'           TO ASC-AD (ASC-BLK-SUB ASC-ITEM-SUB)  19370014
193800     END-IF.                                                      19380014
193900                                                                  19390014
194000 4300B1-DEPT-NAME.                                                19400014
194100                                                                  19410014
194200     INITIALIZE XL073-COMMAREA-REC                                19420015
194300     MOVE SUT00009-DEPT-NBR           TO XL073-DEPT-NBR           19430015
194400     CALL XL073-DEPT-CL-MODULE USING DFHEIBLK                     19440015
194500                                     XL073-COMMAREA               19450015
194600                                     XL073-COMMAREA-REC           19460015
194700     EVALUATE TRUE                                                19470014
194800         WHEN XL073-NO-ERRORS                                     19480015
194810         WHEN XL073-DEPT-NOT-FND                                  19481015
194820         WHEN XL073-MAJ-CL-NOT-FND                                19482015
194900         WHEN XL073-SUB-CL-NOT-FND                                19490015
195100             CONTINUE                                             19510014
195200         WHEN OTHER                                               19520014
195210              MOVE XL073-SQLCODE  TO SQLCODE                      19521015
195220              MOVE XL073-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    19522015
195300              MOVE '4300B1-DEPT-NAME'                             19530014
195400                               TO DP013-PARAGRAPH                 19540014
195500              MOVE 'CALL TO XLKUT073'                             19550015
195600                               TO DP013-MESSAGE-TEXT (1)          19560014
195700              MOVE SQLCA       TO DP013-SQLCA                     19570014
195800              SET DP013-DB2-ABEND                                 19580014
195900                               TO TRUE                            19590014
196000              PERFORM DP013-0000-PROCESS-ABEND                    19600014
196100     END-EVALUATE.                                                19610014
196200                                                                  19620014
196300 4300C-AD-DATES.                                                  19630014
196400                                                                  19640014
196500     MOVE SUT00009-DEPT-NBR      TO DK-DEPT-NBR.                  19650014
196600                                                                  19660014
196700     EXEC SQL                                                     19670014
196800         SELECT COUNT (*)                                         19680014
196900         INTO                                                     19690014
197000           :PV-DB2-COUNT                                          19700014
197100         FROM                                                     19710014
197200           SUT_MAJ_CL_AD_DTE A                                    19720014
197300         WHERE                                                    19730014
197400           A.TRIP_OCRNC_ID       = :DK-TRIP-OCRNC-ID              19740014
197500         AND                                                      19750014
197600           A.DEPT_NBR            = :DK-DEPT-NBR                   19760014
197700         AND                                                      19770014
197800           (DATE(A.AD_EVNT_DTE) >= (CURRENT DATE - 5 DAYS))       19780014
197900           AND                                                    19790014
198000           (DATE(A.AD_EVNT_DTE) <= (CURRENT DATE + 5 DAYS))       19800014
198100     END-EXEC.                                                    19810014
198200                                                                  19820014
198300     EVALUATE TRUE                                                19830014
198400         WHEN SQLCODE = ZERO                                      19840014
198500         WHEN SQLCODE = +100                                      19850014
198600              CONTINUE                                            19860014
198700         WHEN SQLCODE = -904                                      19870014
198800         WHEN SQLCODE = -911                                      19880014
198900         WHEN SQLCODE = -913                                      19890014
199000             PERFORM 9900-SOFT-ABORT                              19900014
199100         WHEN SQLWARN0 NOT = SPACE                                19910014
199200         WHEN SQLCODE NOT = ZERO                                  19920014
199300              MOVE '4300C-AD-DATES'                               19930014
199400                               TO DP013-PARAGRAPH                 19940014
199500              MOVE 'SELECT '                                      19950014
199600                               TO DP013-MESSAGE-TEXT (1)          19960014
199700              MOVE SQLCA       TO DP013-SQLCA                     19970014
199800              SET DP013-DB2-ABEND                                 19980014
199900                               TO TRUE                            19990014
200000              PERFORM DP013-0000-PROCESS-ABEND                    20000014
200100     END-EVALUATE.                                                20010014
200200                                                                  20020014
200300 4300D-BUS-AREA-NAME.                                             20030014
200400     EXEC SQL                                                     20040014
200500     SELECT                                                       20050014
200600         AREA.BUS_AREA_DESC                                       20060014
200700     INTO                                                         20070014
200800         :XLT00000-BUS-AREA-DESC                                  20080014
200900     FROM                                                         20090014
201000         XLT_BUS_AREA AREA                                        20100014
201100                                                                  20110014
201200     WHERE                                                        20120014
201300         AREA.BUS_AREA_ID    = :SUT00009-BUS-AREA-ID              20130014
201400     END-EXEC.                                                    20140014
201500                                                                  20150014
201600     EVALUATE TRUE                                                20160014
201700         WHEN SQLCODE = ZERO                                      20170014
201800              CONTINUE                                            20180014
201900         WHEN SQLCODE = +100                                      20190014
202000              MOVE 'UNKNOWN'  TO XLT00000-BUS-AREA-DESC           20200014
202100         WHEN SQLCODE = -904                                      20210014
202200         WHEN SQLCODE = -911                                      20220014
202201         WHEN SQLCODE = -913                                      20220114
202202             PERFORM 9900-SOFT-ABORT                              20220214
202203         WHEN SQLWARN0 NOT = SPACE                                20220314
202204         WHEN SQLCODE NOT = ZERO                                  20220414
202205              MOVE '4300D-BUS-AREA-NAME'                          20220514
202206                               TO DP013-PARAGRAPH                 20220614
202207              MOVE 'SELECT '                                      20220714
202208                               TO DP013-MESSAGE-TEXT (1)          20220814
202209              MOVE SQLCA       TO DP013-SQLCA                     20220914
202210              SET DP013-DB2-ABEND                                 20221014
202211                               TO TRUE                            20221114
202212              PERFORM DP013-0000-PROCESS-ABEND                    20221214
202213     END-EVALUATE.                                                20221314
202214*----------------------------------------------------------------*20221414
202215*    FETCH THE MESSAGE CURSOR.                                   *20221514
202216*----------------------------------------------------------------*20221614
202217                                                                  20221714
202218 4310-FETCH.                                                      20221814
202219                                                                  20221914
202220     EVALUATE TRUE                                                20222000
202230         WHEN ASC-AREA-DEPT-LIST                                  20223006
202231             EVALUATE TRUE                                        20223114
202232             WHEN ASC-DEPT-SEQ                                    20223200
202233                 EXEC SQL                                         20223314
202234                     FETCH AREA-DEPT-CSR                          20223414
202235                     INTO                                         20223514
202236                     :SUT00009-DEPT-NBR                           20223614
202237                   , :SUT00009-BUS-AREA-ID                        20223714
202238                   , :SUT00009-UNT-QTY                            20223814
202239                   , :SUT00009-SKU-QTY                            20223914
202240                   , :SUT00009-CART-QTY                           20224014
202250                   , :SUT00009-RTL-DOL-AMT                        20225014
202251                 END-EXEC                                         20225114
202252                                                                  20225200
202253             WHEN ASC-UNIT-SEQ                                    20225300
202254                 EXEC SQL                                         20225414
202255                     FETCH AREA-DEPT-CSR-ALT                      20225514
202256                     INTO                                         20225614
202257                     :SUT00009-DEPT-NBR                           20225714
202258                   , :SUT00009-BUS-AREA-ID                        20225814
202259                   , :SUT00009-UNT-QTY                            20225914
202260                   , :SUT00009-SKU-QTY                            20226014
202270                   , :SUT00009-CART-QTY                           20227014
202280                   , :SUT00009-RTL-DOL-AMT                        20228014
202281                 END-EXEC                                         20228114
202282             END-EVALUATE                                         20228200
202283                                                                  20228300
202284         WHEN ASC-DEPT-DIRCT-LIST                                 20228406
202285             EVALUATE TRUE                                        20228514
202286             WHEN ASC-DEPT-SEQ                                    20228600
202287                 EXEC SQL                                         20228714
202288                     FETCH DEPT-DIRCT-CSR                         20228814
202289                     INTO                                         20228914
202290                     :SUT00009-DEPT-NBR                           20229014
202300                   , :SUT00009-BUS-AREA-ID                        20230014
202400                   , :SUT00009-UNT-QTY                            20240014
202500                   , :SUT00009-SKU-QTY                            20250014
202600                   , :SUT00009-CART-QTY                           20260014
202700                   , :SUT00009-RTL-DOL-AMT                        20270014
202701                 END-EXEC                                         20270114
202702                                                                  20270200
202703             WHEN ASC-UNIT-SEQ                                    20270300
202704              EXEC SQL                                            20270414
202705                 FETCH DEPT-DIRCT-CSR-ALT                         20270514
202706                 INTO                                             20270614
202707                     :SUT00009-DEPT-NBR                           20270714
202708                   , :SUT00009-BUS-AREA-ID                        20270814
202709                   , :SUT00009-UNT-QTY                            20270914
202710                   , :SUT00009-SKU-QTY                            20271014
202720                   , :SUT00009-CART-QTY                           20272014
202730                   , :SUT00009-RTL-DOL-AMT                        20273014
202731              END-EXEC                                            20273114
202732                                                                  20273200
202733             END-EVALUATE                                         20273300
202734     END-EVALUATE                                                 20273400
202735*                                                                 20273500
202736     EVALUATE TRUE                                                20273614
202737         WHEN SQLCODE = ZERO                                      20273714
202738         WHEN SQLCODE = +100                                      20273814
202739              CONTINUE                                            20273914
202740         WHEN SQLCODE = -904                                      20274014
202750         WHEN SQLCODE = -911                                      20275014
202760         WHEN SQLCODE = -913                                      20276014
202770             PERFORM 9900-SOFT-ABORT                              20277014
202780         WHEN SQLWARN0 NOT = SPACE                                20278014
202790         WHEN SQLCODE NOT = ZERO                                  20279014
202800              MOVE '4310-FETCH-CURSOR'                            20280014
202900                               TO DP013-PARAGRAPH                 20290014
203000              MOVE 'FETCH MESSAGE CURSOR'                         20300014
203100                               TO DP013-MESSAGE-TEXT (1)          20310014
203200              MOVE SQLCA       TO DP013-SQLCA                     20320014
203300              SET DP013-DB2-ABEND                                 20330014
203400                               TO TRUE                            20340014
203500              PERFORM DP013-0000-PROCESS-ABEND                    20350014
203600     END-EVALUATE.                                                20360014
203700                                                                  20370014
203800     IF  SQLCODE EQUAL +100                                       20380014
203900         SET ASC-NO-ITEMS-LEFT-ON-DB                              20390014
204000                                   TO TRUE                        20400014
204100     END-IF.                                                      20410014
204200                                                                  20420014
204300 EJECT                                                            20430014
204400*----------------------------------------------------------------*20440014
204500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *20450014
204600*----------------------------------------------------------------*20460014
204700                                                                  20470014
204800 4400-MOVE-COMMAREA-TO-SCREEN.                                    20480014
204900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             20490014
205000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          20500014
205100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          20510014
205200             MOVE +1    TO ASC-BLK-SUB                            20520014
205300             PERFORM 5100-WRITE-TEMP-STORAGE                      20530014
205400             ADD +1     TO ASC-BLK-SUB                            20540014
205500             PERFORM 5100-WRITE-TEMP-STORAGE                      20550014
205600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             20560014
205700                 GIVING PV-BLOCK-NUMBER                           20570014
205800                 REMAINDER PV-REMAINDER                           20580014
205900             IF  PV-REMAINDER > ZERO                              20590014
206000                 ADD +1 TO PV-BLOCK-NUMBER                        20600014
206100             END-IF                                               20610014
206200             MOVE +1    TO ASC-BLK-SUB                            20620014
206300             PERFORM 4410-READ-TEMP-STORAGE                       20630014
206400             ADD +1     TO ASC-BLK-SUB                            20640014
206500                           PV-BLOCK-NUMBER                        20650014
206600             PERFORM 4410-READ-TEMP-STORAGE                       20660014
206700     END-IF.                                                      20670014
206800     MOVE +1            TO ASC-BLK-SUB.                           20680014
206900     COMPUTE ASC-ITEM-SUB =                                       20690014
207000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              20700014
207100         + PC-ITEMS-PER-PANEL).                                   20710014
207200*                                                                 20720014
207300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20730014
207400         ADD +1         TO ASC-BLK-SUB                            20740014
207500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            20750014
207600     END-IF.                                                      20760014
207700*                                                                 20770014
207800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           20780014
207900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                20790014
208000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        20800014
208100     PERFORM 4420-FORMAT-LIST-LINES                               20810014
208200         VARYING PV-SUB                                           20820014
208300         FROM PC-ITEMS-PER-PANEL BY -1                            20830014
208400         UNTIL PV-SUB < +1.                                       20840014
208500*                                                                 20850014
208600     COMPUTE ASC-ITEMS-DISPLAYED =                                20860014
208700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          20870014
208800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    20880014
208900                                      ASTRTITO.                   20890014
209000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    20900014
209100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    20910014
209200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            20920014
209300                                   TO ASELITO.                    20930014
209400*                                                                 20940014
209500     IF  DP020-MSG-NUMBER-X = SPACE                               20950014
209600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  20960014
209700*            --- MORE ITEMS TO DISPLAY ----                       20970014
209800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            20980014
209900             SET DP020-MSG-INFORMATIONAL TO TRUE                  20990014
210000         END-IF                                                   21000014
210100     END-IF.                                                      21010014
210200                                                                  21020014
210300     MOVE ASC-STR-NBR                 TO ASTOREO                  21030014
210400     MOVE ASC-STR-NAME                TO ASTNMEO.                 21040014
210500     MOVE ASC-SEQ-DESC                TO ASEQO.                   21050014
210600     MOVE ASC-SCAC                    TO ASCACO.                  21060014
210700     MOVE ASC-TRLR-SRL-NBR            TO ASERIALO                 21070014
210800     MOVE ASC-TRLR-ID                 TO ATRLRO.                  21080014
210900     MOVE ASC-TRIP-STAT-DESC          TO ASTATUSO.                21090014
211000     MOVE ASC-TOTAL-CARTONS           TO ACTNSO.                  21100014
211100     MOVE ASC-TOTAL-UNITS             TO AUNITSO.                 21110014
211200     MOVE ASC-SERVICE-DC-NAME         TO AOPERO                   21120014
211300     MOVE ASC-SUMMARY-DATE            TO ASUMDTEO.                21130014
211400     MOVE ASC-SUMMARY-TIME            TO ASUMTMEO.                21140014
211500                                                                  21150014
211600*----------------------------------------------------------------*21160014
211700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *21170014
211800*----------------------------------------------------------------*21180014
211900                                                                  21190014
212000 4410-READ-TEMP-STORAGE.                                          21200014
212100                                                                  21210014
212200     EXEC CICS                                                    21220014
212300         READQ TS                                                 21230014
212400             QUEUE (ASC-LIST-QUEUE-NAME)                          21240014
212500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21250014
212600             ITEM  (PV-BLOCK-NUMBER)                              21260014
212700             RESP  (PV-CICS-RESP)                                 21270014
212800     END-EXEC.                                                    21280014
212900                                                                  21290014
213000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       21300014
213100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     21310014
213200         CONTINUE                                                 21320014
213300     ELSE                                                         21330014
213400         SET DP013-CICS-ABEND     TO TRUE                         21340014
213500         SET DP013-NO-ROLLBACK    TO TRUE                         21350014
213600         MOVE '4410-READ-TEMP-STORAGE'                            21360014
213700                                  TO DP013-PARAGRAPH              21370014
213800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      21380014
213900                                  TO DP013-MESSAGE-TEXT(1)        21390014
214000         PERFORM DP013-0000-PROCESS-ABEND                         21400014
214100     END-IF.                                                      21410014
214200                                                                  21420014
214300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             21430014
214400*                                                                 21440014
214500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         21450014
214600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               21460014
214700     END-IF.                                                      21470014
214800 EJECT                                                            21480014
214900*----------------------------------------------------------------*21490014
215000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *21500014
215100*----------------------------------------------------------------*21510014
215200                                                                  21520014
215300 4420-FORMAT-LIST-LINES.                                          21530014
215400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      21540014
215500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                21550014
215600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           21560014
215700                                    MR-DEPT-A (PV-SUB)            21570014
215800                                    MR-DEPT-DESC-A (PV-SUB)       21580014
215900                                    MR-BUS-AREA-A (PV-SUB)        21590014
216000                                    MR-CARTONS-A (PV-SUB)         21600014
216100                                    MR-UNITS-A (PV-SUB)           21610014
216200                                    MR-SKU-COUNT-A (PV-SUB)       21620014
216300                                    MR-AD-A (PV-SUB)              21630014
216400         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           21640014
216500         MOVE SPACE              TO MR-SELECTI (PV-SUB)           21650014
216600                                    MR-ACTION (PV-SUB)            21660014
216700     ELSE                                                         21670014
216800         PERFORM 4420A-FILL-SCREEN                                21680014
216900*                                                                 21690014
217000         IF  DP030-SET-CURSOR-TRAILER                             21700014
217100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)21710014
217200                 > SPACE)                                         21720014
217300               OR (PV-SUB = 1))                                   21730014
217400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               21740014
217500                MOVE -1          TO MR-SELECTL (PV-SUB)           21750014
217600             END-IF                                               21760014
217700         END-IF                                                   21770014
217800*                                                                 21780014
217900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           21790014
218000             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           21800014
218100                                 TO MR-ACTION (PV-SUB)            21810014
218200         END-IF                                                   21820014
218300     END-IF.                                                      21830014
218400     SUBTRACT +1 FROM ASC-ITEM-SUB                                21840014
218500     IF  ASC-ITEM-SUB < + 1                                       21850014
218600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  21860014
218700         MOVE +1                 TO ASC-BLK-SUB                   21870014
218800     END-IF.                                                      21880014
218900                                                                  21890014
219000 4420A-FILL-SCREEN.                                               21900014
219100     IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          21910014
219200                                                   > SPACE        21920014
219300         MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21930014
219400                                 TO MR-SELECTI (PV-SUB)           21940014
219500     ELSE                                                         21950014
219600         MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          21960014
219700                                 TO MR-SELECTI (PV-SUB)           21970014
219800     END-IF                                                       21980014
219900                                                                  21990014
220000                                                                  22000014
220100     MOVE ASC-DEPT-NBR(ASC-BLK-SUB ASC-ITEM-SUB)                  22010014
220200                                      TO MR-DEPT (PV-SUB)         22020014
220300     MOVE ASC-DEPT-DESC(ASC-BLK-SUB ASC-ITEM-SUB)                 22030014
220400                                      TO MR-DEPT-DESC (PV-SUB)    22040014
220500     MOVE ASC-BUS-AREA (ASC-BLK-SUB ASC-ITEM-SUB)                 22050014
220600                                      TO MR-BUS-AREA (PV-SUB)     22060014
220700                                                                  22070014
220800     MOVE ASC-CART-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                  22080014
220900                                      TO MR-CARTONS(PV-SUB).      22090014
221000     MOVE ASC-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                   22100014
221100                                      TO MR-UNITS(PV-SUB).        22110014
221200     MOVE ASC-SKU-COUNT(ASC-BLK-SUB ASC-ITEM-SUB)                 22120014
221300                                      TO MR-SKU-COUNT(PV-SUB).    22130014
221400     MOVE ASC-AD(ASC-BLK-SUB ASC-ITEM-SUB)                        22140014
221500                                      TO MR-AD(PV-SUB).           22150014
221600                                                                  22160014
221700                                                                  22170014
221800                                                                  22180014
221900******************************************************************22190014
222000** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **22200014
222100** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **22210014
222200** ISSUE A WARNING.                                             **22220014
222300******************************************************************22230014
222400 4430-CHECK-FOR-BEGIN-AND-END.                                    22240014
222500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       22250014
222600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     22260014
222700*            -- NO END-OF-RANGE SPECFIED ---                      22270014
222800             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            22280014
222900             SET DP020-MSG-WARNING TO TRUE                        22290014
223000             PERFORM 4431-POSITION-AT-WARNING                     22300014
223100         END-IF                                                   22310014
223200     ELSE                                                         22320014
223300         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     22330014
223400*            -- NO BEGINNING-OF-RANGE SPECFIED ---                22340014
223500             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            22350014
223600             SET DP020-MSG-WARNING TO TRUE                        22360014
223700             PERFORM 4431-POSITION-AT-WARNING                     22370014
223800         END-IF                                                   22380014
223900     END-IF.                                                      22390014
224000******************************************************************22400014
224100** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **22410014
224200** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **22420014
224300** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **22430014
224400** POSITION THE CURSOR THERE.                                   **22440014
224500******************************************************************22450014
224600 4431-POSITION-AT-WARNING.                                        22460014
224700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22470014
224800                    - PV-TOP-ITEM + 1.                            22480014
224900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22490014
225000         CONTINUE                                                 22500014
225100     ELSE                                                         22510014
225200         SET DP030-SET-CURSOR-APPL-1                              22520014
225300                                   TO TRUE                        22530014
225400         MOVE -1                   TO MR-SELECTL (PV-SUB)         22540014
225500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22550014
225600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         22560014
225700     END-IF.                                                      22570014
225800*                                                                 22580014
225900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22590014
226000                    - PV-TOP-ITEM + 1.                            22600014
226100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22610014
226200         CONTINUE                                                 22620014
226300     ELSE                                                         22630014
226400         SET DP030-SET-CURSOR-APPL-1                              22640014
226500                                   TO TRUE                        22650014
226600         MOVE -1                   TO MR-SELECTL (PV-SUB)         22660014
226700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22670014
226800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         22680014
226900     END-IF.                                                      22690014
227000 EJECT                                                            22700014
227100*----------------------------------------------------------------*22710014
227200* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *22720014
227300* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *22730014
227400* FOR THE SELECTED ITEMS QUEUE.                                  *22740014
227500*                                                                *22750014
227600* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *22760014
227700* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *22770014
227800* THE ARRAY IS FULL.                                             *22780014
227900*----------------------------------------------------------------*22790014
228000                                                                  22800014
228100 5000-PREPARE-SEL-QUEUE.                                          22810014
228200                                                                  22820014
228300     MOVE +1                   TO  ASC-BLK-SUB.                   22830014
228400     PERFORM 5100-WRITE-TEMP-STORAGE.                             22840014
228500     ADD +1                    TO  ASC-BLK-SUB.                   22850014
228600     PERFORM 5100-WRITE-TEMP-STORAGE.                             22860014
228700                                                                  22870014
228800     MOVE ASC-SEL-QUEUE-NAME-OUT TO  SU012-SEL-QUEUE-NAME.        22880014
228900     PERFORM 6010-DELETE-SEL-QUEUE.                               22890014
229000                                                                  22900014
229100     SET ASC-UPDATE-TSQ        TO  TRUE.                          22910014
229200                                                                  22920014
229300     SET SU013-IDX             TO  1.                             22930014
229400     MOVE ZERO                 TO SU012-NUMBER-OF-TS-ITEMS.       22940014
229500     INITIALIZE SU013-SELECTED-ITEM-ARRAY.                        22950014
229600                                                                  22960014
229700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           22970014
229800             VARYING PV-ITEM                                      22980014
229900             FROM 1 BY 1                                          22990014
230000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     23000014
230100                                                                  23010014
230200     IF  SU013-IDX > 1                                            23020014
230300         PERFORM 5205-WRITE-SEL-QUEUE                             23030014
230400         ADD +1                TO SU012-NUMBER-OF-TS-ITEMS        23040014
230500     END-IF.                                                      23050014
230600/                                                                 23060014
230700*----------------------------------------------------------------*23070014
230800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *23080014
230900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *23090014
231000*----------------------------------------------------------------*23100014
231100                                                                  23110014
231200 5100-WRITE-TEMP-STORAGE.                                         23120014
231300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     23130014
231400                                   TO PV-LIST-ITEM-NUMBER.        23140014
231500     COMPUTE PV-BLOCK-NUMBER =                                    23150014
231600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    23160014
231700                                                                  23170014
231800     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             23180014
231900     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             23190014
232000         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      23200014
232100             PERFORM 5105-REWRITE-ASC-LISTQ                       23210014
232200         END-IF                                                   23220014
232300     ELSE                                                         23230014
232400         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       23240014
232500         ASC-HIGHEST-BLOCK-WRITTEN + 1                            23250014
232600         PERFORM 5110-WRITE-ASC-LISTQ                             23260014
232700         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   23270014
232800     END-IF.                                                      23280014
232900                                                                  23290014
233000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             23300014
233100******************************************************************23310014
233200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **23320014
233300** SPECIFIC COMMAREA.                                           **23330014
233400******************************************************************23340014
233500 5105-REWRITE-ASC-LISTQ.                                          23350014
233600     EXEC CICS                                                    23360014
233700         WRITEQ TS                                                23370014
233800             QUEUE (ASC-LIST-QUEUE-NAME)                          23380014
233900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23390014
234000             ITEM  (PV-BLOCK-NUMBER)                              23400014
234100             REWRITE                                              23410014
234200             RESP  (PV-CICS-RESP)                                 23420014
234300     END-EXEC.                                                    23430014
234400                                                                  23440014
234500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           23450014
234600         CONTINUE                                                 23460014
234700     ELSE                                                         23470014
234800         SET DP013-CICS-ABEND            TO TRUE                  23480014
234900         SET DP013-NO-ROLLBACK           TO TRUE                  23490014
235000         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       23500014
235100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     23510014
235200                                         TO DP013-MESSAGE-TEXT(1) 23520014
235300         PERFORM DP013-0000-PROCESS-ABEND                         23530014
235400     END-IF.                                                      23540014
235500                                                                  23550014
235600******************************************************************23560014
235700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **23570014
235800** SPECIFIC COMMAREA.                                           **23580014
235900******************************************************************23590014
236000 5110-WRITE-ASC-LISTQ.                                            23600014
236100     EXEC CICS                                                    23610014
236200         WRITEQ TS                                                23620014
236300             QUEUE (ASC-LIST-QUEUE-NAME)                          23630014
236400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23640014
236500             ITEM  (PV-BLOCK-NUMBER)                              23650014
236600             RESP  (PV-CICS-RESP)                                 23660014
236700     END-EXEC.                                                    23670014
236800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      23680014
236900         SET DP013-CICS-ABEND      TO TRUE                        23690014
237000         SET DP013-NO-ROLLBACK     TO TRUE                        23700014
237100         MOVE '5110-WRITE-ASC-LISTQ'                              23710014
237200                                   TO DP013-PARAGRAPH             23720014
237300         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           23730014
237400                                   TO DP013-MESSAGE-TEXT(1)       23740014
237500         PERFORM DP013-0000-PROCESS-ABEND                         23750014
237600     END-IF.                                                      23760014
237700 EJECT                                                            23770014
237800*----------------------------------------------------------------*23780014
237900* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *23790014
238000* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *23800014
238100*----------------------------------------------------------------*23810014
238200                                                                  23820014
238300 5200-FILL-SEL-QUEUE-RECORD.                                      23830014
238400                                                                  23840014
238500                                                                  23850014
238600     PERFORM 6112-READ-LIST-QUEUE.                                23860014
238700                                                                  23870014
238800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       23880014
238900         PERFORM                                                  23890014
239000         VARYING LQW-IDX                                          23900014
239100         FROM 1 BY 1                                              23910014
239200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            23920014
239300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          23930014
239400                                                                  23940014
239500             IF  LQW-SELECT (LQW-IDX)                             23950014
239600                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              23960014
239700                                   TO SU013-ITEM (SU013-IDX)      23970014
239800                 MOVE SPACE        TO SU013-ACTION-SW (SU013-IDX) 23980014
239900                 MOVE ASC-TRIP-OCRNC-ID   TO SU013-TRIP-OCRNC-ID  23990014
240000                                         (SU013-IDX)              24000014
240100                 MOVE ASC-BUS-AREA-ID     TO SU013-BUS-GP-NBR     24010014
240200                                         (SU013-IDX)              24020014
240300                 MOVE ASC-OTBND-TRIP-ID TO SU013-TRIP-ID          24030014
240400                                         (SU013-IDX)              24040014
240500                 MOVE ASC-SCAC        TO SU013-SCAC (SU013-IDX)   24050014
240600                 MOVE ASC-TRLR-ID     TO SU013-TRLR-ID(SU013-IDX) 24060014
240700                 MOVE ASC-SERIAL      TO SU013-TRLR-SRL-NBR       24070014
240800                                         (SU013-IDX)              24080014
240900                 MOVE ASC-TRAILER-STAT TO SU013-TRIP-STAT-DESC    24090014
241000                                         (SU013-IDX)              24100014
241100                 MOVE ASC-STAT-DATE   TO SU013-STAT-DATE          24110014
241200                                         (SU013-IDX)              24120014
241300                                                                  24130014
241400*              LOAD SELECTIONS TO SEL-QUEUE                       24140014
241500                 MOVE LQW-DEPT (LQW-IDX)                          24150014
241600                                      TO SU013-DEPT-NBR           24160014
241700                                         (SU013-IDX)              24170014
241800                 MOVE LQW-DEPT-DESC (LQW-IDX)                     24180014
241900                                      TO SU013-DEPT-NAME          24190014
242000                                         (SU013-IDX)              24200014
242100                 MOVE LQW-AD(LQW-IDX)                             24210014
242200                                      TO SU013-AD-MDSE-IND        24220014
242300                                         (SU013-IDX)              24230014
242400                                                                  24240014
242500*                MOVE LQW-PCT-FULL(LQW-IDX)                       24250014
242600*                                     TO SU013-CAPCTY-PCT         24260014
242700*                                        (SU013-IDX)              24270014
242800*                MOVE LQW-JEWELRY(LQW-IDX)                        24280014
242900*                                     TO SU013-JWLRY-IND          24290014
243000*                                        (SU013-IDX)              24300014
243100*                MOVE LQW-OTBND-TRIP-ID(LQW-IDX)                  24310014
243200*                                     TO SU013-TRIP-ID            24320014
243300*                                        (SU013-IDX)              24330014
243400*                MOVE LQW-TRIP-STAT-CDE(LQW-IDX)                  24340014
243500*                                     TO SU013-TRIP-STAT-CDE      24350014
243600*                                        (SU013-IDX)              24360014
243700*                MOVE LQW-CRE-TMST(LQW-IDX)                       24370014
243800*                                     TO SU013-SUMMARY-TMST       24380014
243900*                                        (SU013-IDX)              24390014
244000                 MOVE LQW-UNITS (LQW-IDX)                         24400014
244100                                      TO SU013-UNIT-COUNT         24410014
244200                                         (SU013-IDX)              24420014
244300                 MOVE LQW-CARTONS (LQW-IDX)                       24430014
244400                                      TO SU013-CARTON-CNT         24440014
244500                                         (SU013-IDX)              24450014
244600                                                                  24460014
244700                 SET SU013-IDX UP BY 1                            24470014
244800                 IF  SU013-IDX > SU013-MAX-ITEMS                  24480014
244900                     PERFORM 5205-WRITE-SEL-QUEUE                 24490014
245000                     ADD +1        TO SU012-NUMBER-OF-TS-ITEMS    24500014
245100                     INITIALIZE SU013-SELECTED-ITEM-ARRAY         24510014
245200                     SET SU013-IDX TO  1                          24520014
245300                 END-IF                                           24530014
245400             END-IF                                               24540014
245500         END-PERFORM                                              24550014
245600     END-IF.                                                      24560014
245700                                                                  24570014
245800*----------------------------------------------------------------*24580014
245900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *24590014
246000*----------------------------------------------------------------*24600014
246100                                                                  24610014
246200 5205-WRITE-SEL-QUEUE.                                            24620014
246300                                                                  24630014
246400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            24640014
246500                                   TO SU013-SELECTED-ITEMS.       24650014
246600                                                                  24660014
246700     EXEC CICS                                                    24670014
246800          WRITEQ TS                                               24680014
246900              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      24690014
247000              FROM  (SU013-SELECT-RECORD)                         24700014
247100              ITEM  (PV-SEL-QUEUE-ITEM)                           24710014
247200              RESP  (PV-CICS-RESP)                                24720014
247300     END-EXEC.                                                    24730014
247400                                                                  24740014
247500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          24750014
247600         CONTINUE                                                 24760014
247700     ELSE                                                         24770014
247800         SET DP013-CICS-ABEND      TO TRUE                        24780014
247900         SET DP013-NO-ROLLBACK     TO TRUE                        24790014
248000         MOVE '5205-WRITE-SEL-QUEUE'                              24800014
248100                                   TO DP013-PARAGRAPH             24810014
248200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          24820014
248300                                   TO DP013-MESSAGE-TEXT(1)       24830014
248400         PERFORM DP013-0000-PROCESS-ABEND                         24840014
248500     END-IF.                                                      24850014
248600 EJECT                                                            24860014
248700******************************************************************24870014
248800** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **24880014
248900** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **24890014
249000** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **24900014
249100** THE USER.                                                    **24910014
249200******************************************************************24920014
249300 6000-REFRESH-PANEL-FROM-TEMP.                                    24930014
249400     IF  ASC-UPDATE-TSQ                                           24940014
249500         SET ASC-NO-TSQ-UPDATE TO TRUE                            24950014
249600         MOVE ZERO                 TO PV-SAVE-ITEM                24960014
249700                                      PV-SEL-QUEUE-ITEM           24970014
249800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        24980014
249900                                   TO PV-HOLD-SELECTED-ITEMS      24990014
250000         MOVE +1                   TO PV-ITEMS-PROCESSED          25000014
250100         PERFORM 6100-UPDATE-TSQ                                  25010014
250200             UNTIL PV-ITEMS-PROCESSED >                           25020014
250300                                     PV-HOLD-SELECTED-ITEMS       25030014
250400         PERFORM 6010-DELETE-SEL-QUEUE                            25040014
250500         INITIALIZE ASC-BLOCK-ENTRIES (1)                         25050014
250600                    ASC-BLOCK-ENTRIES (2)                         25060014
250700     END-IF.                                                      25070014
250800                                                                  25080014
250900*----------------------------------------------------------------*25090014
251000*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *25100014
251100*----------------------------------------------------------------*25110014
251200 6010-DELETE-SEL-QUEUE.                                           25120014
251300                                                                  25130014
251400     EXEC CICS                                                    25140014
251500         DELETEQ TS                                               25150014
251600             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       25160014
251700             RESP  (PV-CICS-RESP)                                 25170014
251800     END-EXEC.                                                    25180014
251900*                                                                 25190014
252000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      25200014
252100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         25210014
252200         CONTINUE                                                 25220014
252300     ELSE                                                         25230014
252400         SET DP013-CICS-ABEND TO TRUE                             25240014
252500         SET DP013-NO-ROLLBACK TO TRUE                            25250014
252600         MOVE '6010-DELETE-SEL-QUEUE'                             25260014
252700                        TO DP013-PARAGRAPH                        25270014
252800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         25280014
252900                        TO DP013-MESSAGE-TEXT (1)                 25290014
253000         PERFORM DP013-0000-PROCESS-ABEND                         25300014
253100     END-IF.                                                      25310014
253200                                                                  25320014
253300*----------------------------------------------------------------*25330014
253400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *25340014
253500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *25350014
253600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *25360014
253700*    THE TEMP QUEUE.                                             *25370014
253800*----------------------------------------------------------------*25380014
253900                                                                  25390014
254000 6100-UPDATE-TSQ.                                                 25400014
254100                                                                  25410014
254200     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             25420014
254300     PERFORM 6105-READ-SEL-QUEUE.                                 25430014
254400     PERFORM                                                      25440014
254500         VARYING SU013-IDX                                        25450014
254600         FROM 1 BY 1                                              25460014
254700         UNTIL ((PV-ITEMS-PROCESSED >                             25470014
254800                              PV-HOLD-SELECTED-ITEMS)             25480014
254900         OR (SU013-IDX GREATER THAN SU013-MAX-ITEMS))             25490014
255000         IF  SU013-ACTION-SW (SU013-IDX) > SPACE                  25500014
255100             PERFORM 6110-PROCESS-ITEMS                           25510014
255200         END-IF                                                   25520014
255300         ADD +1                TO PV-ITEMS-PROCESSED              25530014
255400     END-PERFORM.                                                 25540014
255500     PERFORM 6111-WRITE-LIST-QUEUE.                               25550014
255600*----------------------------------------------------------------*25560014
255700*    READ THE LIST QUEUE RECORD.                                 *25570014
255800*----------------------------------------------------------------*25580014
255900                                                                  25590014
256000 6105-READ-SEL-QUEUE.                                             25600014
256100                                                                  25610014
256200     EXEC CICS                                                    25620014
256300          READQ TS                                                25630014
256400              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      25640014
256500              INTO  (SU013-SELECT-RECORD)                         25650014
256600              ITEM  (PV-SEL-QUEUE-ITEM)                           25660014
256700              RESP  (PV-CICS-RESP)                                25670014
256800     END-EXEC.                                                    25680014
256900*                                                                 25690014
257000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          25700014
257100         CONTINUE                                                 25710014
257200     ELSE                                                         25720014
257300         SET DP013-CICS-ABEND      TO  TRUE                       25730014
257400         SET DP013-NO-ROLLBACK     TO  TRUE                       25740014
257500         MOVE '6105-READ-SEL-QUEUE'                               25750014
257600                                   TO  DP013-PARAGRAPH            25760014
257700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           25770014
257800                                   TO  DP013-MESSAGE-TEXT(1)      25780014
257900         PERFORM DP013-0000-PROCESS-ABEND                         25790014
258000     END-IF.                                                      25800014
258100 EJECT                                                            25810014
258200*----------------------------------------------------------------*25820014
258300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*25830014
258400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*25840014
258500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *25850014
258600*----------------------------------------------------------------*25860014
258700                                                                  25870014
258800 6110-PROCESS-ITEMS.                                              25880014
258900                                                                  25890014
259000     COMPUTE PV-ITEM = 1 + ((SU013-ITEM (SU013-IDX) - 1)          25900014
259100                     / PC-ITEMS-PER-PANEL).                       25910014
259200                                                                  25920014
259300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           25930014
259400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          25940014
259500             PERFORM 6111-WRITE-LIST-QUEUE                        25950014
259600         END-IF                                                   25960014
259700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    25970014
259800                                                                  25980014
259900         PERFORM 6112-READ-LIST-QUEUE                             25990014
260000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               26000014
260100             CONTINUE                                             26010014
260200         END-IF                                                   26020014
260300     END-IF.                                                      26030014
260400                                                                  26040014
260500     COMPUTE PV-SUB = (SU013-ITEM (SU013-IDX)                     26050014
260600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              26060014
260700     SET LQW-DESELECT (PV-SUB) TO    TRUE                         26070014
260800     MOVE LQW-SELECTED-SW (PV-SUB)                                26080014
260900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  26090014
261000     EVALUATE TRUE                                                26100014
261100         WHEN SU013-INQ (SU013-IDX)                               26110014
261200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             26120014
261300                                                                  26130014
261400         WHEN SU013-UPD (SU013-IDX)                               26140014
261500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             26150014
261600                                                                  26160014
261700         WHEN SU013-DEL (SU013-IDX)                               26170014
261800              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             26180014
261900                                                                  26190014
262000         WHEN SU013-ERR (SU013-IDX)                               26200014
262100              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             26210014
262200     END-EVALUATE.                                                26220014
262300                                                                  26230014
262400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                26240014
262500                                                                  26250014
262600*----------------------------------------------------------------*26260014
262700*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *26270014
262800*----------------------------------------------------------------*26280014
262900                                                                  26290014
263000 6111-WRITE-LIST-QUEUE.                                           26300014
263100                                                                  26310014
263200     EXEC CICS                                                    26320014
263300         WRITEQ TS                                                26330014
263400             QUEUE (ASC-LIST-QUEUE-NAME)                          26340014
263500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     26350014
263600             ITEM  (PV-SAVE-ITEM)                                 26360014
263700             REWRITE                                              26370014
263800             RESP  (PV-CICS-RESP)                                 26380014
263900     END-EXEC.                                                    26390014
264000*                                                                 26400014
264100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26410014
264200         CONTINUE                                                 26420014
264300     ELSE                                                         26430014
264400         SET DP013-CICS-ABEND  TO  TRUE                           26440014
264500         SET DP013-NO-ROLLBACK TO  TRUE                           26450014
264600         MOVE '6111-WRITE-LIST-QUEUE'                             26460014
264700                               TO  DP013-PARAGRAPH                26470014
264800         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  26480014
264900                               TO  DP013-MESSAGE-TEXT(1)          26490014
265000         PERFORM DP013-0000-PROCESS-ABEND                         26500014
265100     END-IF.                                                      26510014
265200                                                                  26520014
265300 EJECT                                                            26530014
265400*----------------------------------------------------------------*26540014
265500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*26550014
265600*----------------------------------------------------------------*26560014
265700                                                                  26570014
265800 6112-READ-LIST-QUEUE.                                            26580014
265900                                                                  26590014
266000     EXEC CICS                                                    26600014
266100         READQ TS                                                 26610014
266200             QUEUE (ASC-LIST-QUEUE-NAME)                          26620014
266300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     26630014
266400             ITEM  (PV-ITEM)                                      26640014
266500             RESP  (PV-CICS-RESP)                                 26650014
266600     END-EXEC.                                                    26660014
266700*                                                                 26670014
266800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26680014
266900         CONTINUE                                                 26690014
267000     ELSE                                                         26700014
267100         SET DP013-CICS-ABEND        TO TRUE                      26710014
267200         SET DP013-NO-ROLLBACK       TO TRUE                      26720014
267300         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           26730014
267400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    26740014
267500                                     TO DP013-MESSAGE-TEXT(1)     26750014
267600         PERFORM DP013-0000-PROCESS-ABEND                         26760014
267700     END-IF.                                                      26770014
267800/                                                                 26780014
267900 7000-SELECT-SERVICING-DC.                                        26790014
268000                                                                  26800014
268100     EXEC SQL                                                     26810014
268200         SELECT  STR.LOC_NM                                       26820014
268300             ,   STR.LOC_NBR                                      26830014
268400         INTO                                                     26840014
268500                :XLT00010-LOC-NM                                  26850014
268600             ,  :XLT00010-LOC-NBR                                 26860014
268700         FROM  TSUOBTR OBTR                                       26870014
268800             , XLT_LOC STR                                        26880014
268900         WHERE OBTR.ORGN_OPER_UNT_ID  =   STR.LOC_NBR             26890014
269000         AND   OBTR.OTBND_TRIP_ID     =  :DK-OTBND-TRIP-ID        26900014
269100     END-EXEC.                                                    26910014
269200                                                                  26920014
269300     EVALUATE TRUE                                                26930014
269400         WHEN SQLCODE = ZERO                                      26940014
269500              MOVE XLT00010-LOC-NM    TO  ASC-SERVICE-DC-NAME     26950014
269600         WHEN SQLCODE = +100                                      26960014
269700              MOVE SPACES              TO XLT00010-LOC-NM         26970014
269800                                          ASC-SERVICE-DC-NAME     26980014
269900         WHEN SQLCODE = -904                                      26990014
270000         WHEN SQLCODE = -911                                      27000014
270100         WHEN SQLCODE = -913                                      27010014
270200             PERFORM 9900-SOFT-ABORT                              27020014
270300         WHEN SQLWARN0 NOT = SPACE                                27030014
270400         WHEN SQLCODE NOT = ZERO                                  27040014
270500              MOVE '7000-SELECT-SERVICING-DC'                     27050014
270600                               TO DP013-PARAGRAPH                 27060014
270700              MOVE 'SELECT'    TO DP013-MESSAGE-TEXT (1)          27070014
270800              MOVE SQLCA       TO DP013-SQLCA                     27080014
270900              SET DP013-DB2-ABEND                                 27090014
271000                               TO TRUE                            27100014
271100              PERFORM DP013-0000-PROCESS-ABEND                    27110014
271200     END-EVALUATE.                                                27120014
271300                                                                  27130014
271400 7001-CONVERT-DATES.                                              27140014
271500                                                                  27150014
271600     MOVE SU013-SUMMARY-TIME (ASC-SEL-SUB)                        27160014
271700                                   TO PV-TIME                     27170014
271800     MOVE SU013-SUMMARY-DATE (ASC-SEL-SUB)                        27180014
271900                                   TO PV-DATE                     27190014
272000                                                                  27200014
272100     EXEC SQL                                                     27210014
272200      SELECT                                                      27220014
272300         CHAR ( DATE (:PV-DATE),USA)                              27230014
272400     ,   CHAR ( TIME (:PV-TIME),JIS)                              27240014
272500      INTO                                                        27250014
272600         :ASC-SUMMARY-DATE                                        27260014
272700     ,   :ASC-SUMMARY-TIME                                        27270014
272800     FROM SYSIBM.SYSDUMMY1                                        27280014
272900     END-EXEC.                                                    27290014
273000                                                                  27300014
273100     EVALUATE TRUE                                                27310014
273200         WHEN SQLCODE = ZERO                                      27320014
273300             CONTINUE                                             27330014
273400         WHEN SQLCODE = -180                                      27340014
273500              MOVE SPACES      TO ASC-SUMMARY-DATE                27350014
273600                                  ASC-SUMMARY-TIME                27360014
273700         WHEN SQLCODE = -904                                      27370014
273800         WHEN SQLCODE = -911                                      27380014
273900         WHEN SQLCODE = -913                                      27390014
274000             PERFORM 9900-SOFT-ABORT                              27400014
274100         WHEN SQLWARN0 NOT = SPACE                                27410014
274200         WHEN SQLCODE NOT = ZERO                                  27420014
274300              MOVE '7001-CONVERT-DATES'                           27430014
274400                               TO DP013-PARAGRAPH                 27440014
274500              MOVE 'SELECT'    TO DP013-MESSAGE-TEXT (1)          27450014
274600              MOVE SQLCA       TO DP013-SQLCA                     27460014
274700              SET DP013-DB2-ABEND                                 27470014
274800                               TO TRUE                            27480014
274900              PERFORM DP013-0000-PROCESS-ABEND                    27490014
275000     END-EVALUATE.                                                27500014
275100/                                                                 27510014
275200 9100-READ-SEL-QUEUE.                                             27520014
275300     EXEC CICS                                                    27530014
275400         READQ TS                                                 27540014
275500             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        27550014
275600             INTO  (SU013-SELECT-RECORD)                          27560014
275700             ITEM  (ASC-SEL-ITEM)                                 27570014
275800             RESP  (PV-CICS-RESP)                                 27580014
275900     END-EXEC.                                                    27590014
276000                                                                  27600014
276100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       27610014
276200         CONTINUE                                                 27620014
276300     ELSE                                                         27630014
276400         SET DP013-LOGIC-ABEND                                    27640014
276500             DP013-NO-ROLLBACK     TO TRUE                        27650014
276600         MOVE '9100-READ-SEL-QUEUE'                               27660014
276700                                   TO DP013-PARAGRAPH             27670014
276800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   27680014
276900                                   TO DP013-MESSAGE-TEXT (1)      27690014
277000         PERFORM DP013-0000-PROCESS-ABEND                         27700014
277100     END-IF.                                                      27710014
277200/                                                                 27720014
277300*-----------------------------------------------------------      27730014
277400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.        27740014
277500*-----------------------------------------------------------      27750014
277600 9200-REWRITE-LIST-QUEUE.                                         27760014
277700           EXEC CICS                                              27770014
277800                WRITEQ TS                                         27780014
277900                    QUEUE  (ASC-SEL-QUEUE-NAME-IN)                27790014
278000                    FROM   (SU013-SELECT-RECORD)                  27800014
278100                    ITEM   (ASC-SEL-ITEM)                         27810014
278200                    RESP   (PV-CICS-RESP)                         27820014
278300                    REWRITE                                       27830014
278400           END-EXEC.                                              27840014
278500                                                                  27850014
278600     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   27860014
278700         SET DP013-CICS-ABEND                                     27870014
278800             DP013-NO-ROLLBACK     TO TRUE                        27880014
278900         MOVE '9200-REWRITE-LIST-QUEUE'                           27890014
279000                                         TO DP013-PARAGRAPH       27900014
279100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   27910014
279200                                         TO DP013-MESSAGE-TEXT (1)27920014
279300         PERFORM DP013-0000-PROCESS-ABEND                         27930014
279400     END-IF.                                                      27940014
279500                                                                  27950014
279600 9900-SOFT-ABORT.                                                 27960014
279700     SET PS-ERROR         TO TRUE.                                27970014
279800     SET DP020-MSG-FATAL  TO TRUE.                                27980014
279900     MOVE 'THROUGH SOFT-ABORT PARA'                               27990014
280000                            TO DP013-MESSAGE-TEXT (1)             28000014
280100     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    28010014
280200     IF PS-NO-NEXT-SCREEN                                         28020014
280300         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    28030014
280400     END-IF.                                                      28040014
280500                                                                  28050014
280600     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          28060014
280700     PERFORM 0001-CALL-CICS-ARCH-API.                             28070014
280800                                                                  28080014
280900 EJECT                                                            28090014
281000*----------------------------------------------------------------*28100014
281100*    ABEND PROCESSOR MODULE                                      *28110014
281200*----------------------------------------------------------------*28120014
281300                                                                  28130014
281400     COPY DPPD013.                                                28140014
