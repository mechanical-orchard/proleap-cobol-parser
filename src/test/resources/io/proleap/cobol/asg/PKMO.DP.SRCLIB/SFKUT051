       IDENTIFICATION DIVISION.                                         00010048
       PROGRAM-ID.      SFKUT051.                                       00020048
       AUTHOR.          KOHLS.                                          00030048
       DATE-WRITTEN.    APRIL 18, 2011.                                 00040048
                                                                        00050048
      *-----------------------------------------------------------      00060048
      *                STORE MANIFEST DATA/STAT FILE FORMATTER          00070048
      *-----------------------------------------------------------      00080048
      *   THIS PROGRAM WILL FORMAT THE MANIFEST RECORDS BEING SENT      00090048
      *   TO THE STORES AS PART OF THE MLS PROCESS. 2 TYPES OF          00100048
      *   RECORDS ARE PROCESSED: MANIFEST DATA AND MANIFEST STATUS.     00110048
      *   EACH TYPE WILL HAVE IT'S OWN HEADER, BUT, BOTH WILL BE        00120048
      *   OUTPUT TO THE SAME OUTPUT FILE. THE MIDTIER SERVER WILL       00130048
      *   DISTRIBUTE THEM TO THE STORES.                                00140048
      *-----------------------------------------------------------      00150048
      * HISTORY LOG:                                                    00160048
      *-----------------------------------------------------------      00170048
      * DATE:                                                           00180048
      * WR/IR#:                                                         00190048
      * PROGRAMMER:                                                     00200048
      * DESCRIPTION:                                                    00210048
      *                                                                 00220048
      *----------------------------------------------------------       00230048
       ENVIRONMENT DIVISION.                                            00240048
      *----------------------------------------------------------       00250048
       CONFIGURATION SECTION.                                           00260048
       SOURCE-COMPUTER.        IBM-3090.                                00270048
       OBJECT-COMPUTER.        IBM-3090.                                00280048
                                                                        00290048
       INPUT-OUTPUT SECTION.                                            00300048
                                                                        00310048
       FILE-CONTROL.                                                    00320048
                                                                        00330048
           SELECT MNFST-DATA-FILE                                       00340048
                  ASSIGN TO INP01.                                      00350048
           SELECT MNFST-STAT-FILE                                       00360048
                  ASSIGN TO INP02.                                      00370048
           SELECT FRMTD-MNFST                                           00380048
                  ASSIGN TO OUT01.                                      00390048
                                                                        00400048
       DATA DIVISION.                                                   00410048
       FILE SECTION.                                                    00420048
                                                                        00430048
       FD  MNFST-DATA-FILE                                              00440048
           RECORDING MODE F                                             00450048
           BLOCK CONTAINS 0 RECORDS                                     00460048
           LABEL RECORDS ARE OMITTED                                    00470048
           DATA RECORD IS MNFST-DATA-RECORD.                            00480048
164325*01  MNFST-DATA-RECORD               PIC X(100).                  00490084
164325 01  MNFST-DATA-RECORD               PIC X(110).                  00491084
                                                                        00500048
       FD  MNFST-STAT-FILE                                              00510048
           RECORDING MODE F                                             00520048
           BLOCK CONTAINS 0 RECORDS                                     00530048
           LABEL RECORDS ARE OMITTED                                    00540048
           DATA RECORD IS MNFST-STAT-RECORD.                            00550048
       01  MNFST-STAT-RECORD               PIC X(60).                   00560048
                                                                        00570048
       FD  FRMTD-MNFST                                                  00580048
           RECORDING MODE IS V                                          00590048
           RECORD IS VARYING IN SIZE                                    00600048
164325     FROM 1 TO 150 CHARACTERS                                     00610048
           DEPENDING ON PV-BYTE-COUNT                                   00620048
           LABEL RECORDS ARE OMITTED                                    00630048
           DATA RECORD IS FRMTD-MNFST-RECORD.                           00640048
       01  FRMTD-MNFST-RECORD.                                          00650048
           05  FORM-SU-HR-FLD                  PIC X(01)                00660048
164325         OCCURS 150 TIMES                                         00670048
                    INDEXED BY                                          00680048
                    FORM-EP-HR-LEN.                                     00690048
                                                                        00700048
       WORKING-STORAGE SECTION.                                         00710048
      *-----------------------------------------------------------      00720048
      * PS- PROGRAM SWITCHES                                            00730048
      *-----------------------------------------------------------      00740048
       01  PS-PROGRAM-SWITCHES.                                         00750048
           05  PS-STAT-HDR-REC-WRITEN-SW PIC X(01) VALUE 'N'.           00760048
               88  PS-STAT-HDR-REC-WRITEN         VALUE 'Y'.            00770048
               88  PS-STAT-HDR-REC-NOT-WRITEN     VALUE 'N'.            00780048
           05  PS-DATA-HDR-REC-WRITEN-SW PIC X(01) VALUE 'N'.           00790048
               88  PS-DATA-HDR-REC-WRITEN         VALUE 'Y'.            00800048
               88  PS-DATA-HDR-REC-NOT-WRITEN     VALUE 'N'.            00810048
           05  PS-END-OF-MNFST-FL-SW    PIC X(01) VALUE 'N'.            00820048
               88  PS-END-OF-MNFST-FL             VALUE 'Y'.            00830048
               88  PS-NOT-END-OF-MNFST-FL         VALUE 'N'.            00840048
           05  PS-END-OF-MNFST-ST-SW    PIC X(01) VALUE 'N'.            00850048
               88  PS-END-OF-MNFST-ST             VALUE 'Y'.            00860048
               88  PS-NOT-END-OF-MNFST-ST         VALUE 'N'.            00870048
           05  PS-MNFST-HDR-NOT-WRITEN-SW  PIC X(01) VALUE 'N'.         00880048
               88  PS-MNFST-HDR-WRITEN            VALUE 'N'.            00890048
               88  PS-MNFST-HDR-NOT-WRITEN        VALUE 'Y'.            00900048
169947     05  PS-STORE-SCANNING-SW        PIC X(01) VALUE 'N'.         00910079
169947         88  PS-ALL-STORES                     VALUE 'A'.         00920079
169947         88  PS-SOME-STORES                    VALUE 'S'.         00930079
169947         88  PS-NO-STORES                      VALUE 'N'.         00940079
                                                                        00950048
      *-----------------------------------------------------------      00960048
      * PROGRAM CONSTANTS                                               00970048
      *-----------------------------------------------------------      00980048
       01  PC-PROGRAM-CONSTANTS.                                        00990048
           05  PC-CURRENT-PROGRAM-NAME  PIC X(08) VALUE 'SFKUT051'.     01000048
           05  PC-CSV-DELIMITER             PIC X(01) VALUE '|'.        01010048
           05  PC-UNDER-SCORE               PIC X(01) VALUE '_'.        01020048
           05  PC-ONE-SPACE                 PIC X(01) VALUE ' '.        01030048
           05  PC-ONE-ZERO                  PIC X(01) VALUE '0'.        01040048
           05  PC-STR-GRP-ID-99991          PIC X(05) VALUE '99991'.    01050048
           05  PC-STR-GRP-ID-5000           PIC X(05) VALUE '05000'.    01060048
           05  PC-STR-GRP-ID-1000           PIC X(05) VALUE '01000'.    01070048
           05  PC-FIVE-ZERO                 PIC X(05) VALUE '00000'.    01080048
           05  PC-HDR-IND                   PIC X(03) VALUE 'HDR'.      01090048
           05  PC-FILE-APPLY-TYPE-FUL       PIC X(01) VALUE 'N'.        01100048
           05  PC-FILE-APPLY-TYPE-CHG       PIC X(01) VALUE 'C'.        01110048
169947     05  PC-STOTBNDUPD               PIC  X(10) VALUE             01120079
169947                                                     'STOTBNDUPD'.01130079
                                                                        01140048
      *-----------------------------------------------------------      01150048
      * PV- PROGRAM VARIABLES                                           01160048
      *-----------------------------------------------------------      01170048
       01  PV-PROGRAM-VARAIBLES.                                        01180048
164325     05  PV-FIELD-LENGTH          PIC 9(02)  VALUE ZERO.          01190048
           05  PV-RECORD-ACTION         PIC X      VALUE SPACE.         01200048
           05  PV-PREV-DEST-LOC-NBR     PIC S9(4) VALUE ZERO.           01210048
           05  PV-CURRENT-DATE          PIC X(10) VALUE SPACES.         01220048
           05  PV-FORMAT-CORR-ID.                                       01230048
               10  PV-FORMAT-MQ-CORR-ID PIC X(03).                      01240048
               10  PV-NULL-VALUE        PIC X(21).                      01250048
           05  PV-TALLY                     PIC S9(03) COMP-3 VALUE +0. 01260048
           05  PV-PIPE-COUNT                PIC  9(04) VALUE ZERO.      01270048
           05  PV-BYTE-COUNT                PIC  9(04) VALUE ZERO.      01280048
           05  PV-RECORD-COUNT              PIC  9(09) VALUE ZERO.      01290048
           05  PV-SPACE                     PIC  X(01).                 01300048
           05  PV-DISPLAY-INDEX             PIC S9(04) COMP.            01310048
           05  PV-STR-GRP-TYP-CDE           PIC 9(05) VALUE ZERO.       01320048
           05  PV-STR-GRP-ID-GRP.                                       01330048
               10  PV-FIRST-BYTES           PIC 9(05) VALUE ZERO.       01340048
               10  PV-STR-GRP-ID            PIC 9(05) VALUE ZERO.       01350048
                                                                        01360048
           05  PV-VARIABLE-OUTPUT-FIELD.                                01370048
               10  PV-BIT-VARIABLE          PIC X(01)                   01380048
                                                VALUE SPACES            01390048
                                                OCCURS 20 TIMES         01400048
                                                INDEXED BY              01410048
                                                PV-BIT-IDX              01420048
                                                PV-EOF-IDX.             01430048
                                                                        01440048
           05  PV-VARIABLE-CHAR-FIELD.                                  01450048
               10  PV-BIT-CHR-VARIABLE      PIC X(01)                   01460048
                                                VALUE SPACES            01470048
                                                OCCURS 260 TIMES        01480048
                                                INDEXED BY              01490048
                                                PV-CHR-BIT-IDX          01500048
                                                PV-CHR-EOF-IDX.         01510048
                                                                        01520048
           05  PV-SAVE-PREV-LOC-NBR         PIC X(05) VALUE SPACES.     01530048
           05  PV-RUN-TIME.                                             01540048
               15  R-HR                    PIC 99.                      01550048
               15  R-MIN                   PIC 99.                      01560048
               15  R-SEC                   PIC 99.                      01570048
               15  R-TH                    PIC 99.                      01580048
                                                                        01590048
           05  PV-DATE-IN.                                              01600048
               15 DATE-IN-CC               PIC XX.                      01610048
               15 DATE-IN-YY               PIC XX.                      01620048
               15 DATE-IN-MM               PIC XX.                      01630048
               15 DATE-IN-DD               PIC XX.                      01640048
           05  PV-TIMESTAMP                 PIC X(26) VALUE SPACES.     01650048
           05  PV-CURRENT-TMST REDEFINES    PV-TIMESTAMP.               01660048
               10  PV-CURR-YYYY             PIC 9(04).                  01670048
               10  FILLER                   PIC X(01).                  01680048
               10  PV-CURR-MO               PIC 9(02).                  01690048
               10  FILLER                   PIC X(01).                  01700048
               10  PV-CURR-DD               PIC 9(02).                  01710048
               10  FILLER                   PIC X(01).                  01720048
               10  PV-CURR-HH               PIC 9(02).                  01730048
               10  FILLER                   PIC X(01).                  01740048
               10  PV-CURR-MM               PIC 9(02).                  01750048
               10  FILLER                   PIC X(01).                  01760048
               10  PV-CURR-SS               PIC 9(02).                  01770048
               10  FILLER                   PIC X(01).                  01780048
               10  PV-CURR-SSSSSS           PIC 9(06).                  01790048
                                                                        01800048
           05  PV-HEADER-TMST.                                          01810048
               10  PV-HEADER-YYYY           PIC 9(04).                  01820048
               10  PV-HEADER-YYYY-RED REDEFINES PV-HEADER-YYYY.         01830048
                15  PV-HEADER-CC            PIC 9(02).                  01840048
                15  PV-HEADER-YY            PIC 9(02).                  01850048
               10  PV-HEADER-MO             PIC 9(02)  VALUE ZERO.      01860048
               10  PV-HEADER-DD             PIC 9(02)  VALUE ZERO.      01870048
               10  PV-HEADER-HH             PIC 9(02)  VALUE ZERO.      01880048
               10  PV-HEADER-MM             PIC 9(02)  VALUE ZERO.      01890048
               10  PV-HEADER-SS             PIC 9(02)  VALUE ZERO.      01900048
           05  PV-QUOTIENT                  PIC 9(04)  VALUE ZERO.      01910048
           05  PV-RMDR-4                    PIC 9(04)  VALUE ZERO.      01920048
           05  PV-RMDR-100                  PIC 9(04)  VALUE ZERO.      01930048
169947     05  DK-STR-NBR                   PIC S9(04) COMP VALUE ZERO. 01940079
169947     05  PV-STR-NBR                   PIC  9(05) VALUE ZERO.      01950079
169947     05  PV-CODE-ERROR1.                                          01960079
169947         10  FILLER                  PIC  X(27) VALUE             01970079
169947             'VALID VALUES ARE A, E AND N'.                       01980079
169947     05  PV-CODE-ERROR2.                                          01990079
169947         10  FILLER                  PIC  X(17) VALUE             02000079
169947             'QUERY RETURNED - '.                                 02010079
169947         10  PV-INCORRECT-CODE       PIC  X(02) VALUE SPACES.     02020079
                                                                        02030050
      *----------------------------------------------------------       02040048
      * COPYBOOK  EPRD217 LAYOUT (HEADER LAYOUT)                        02050048
      *----------------------------------------------------------       02060048
           COPY EPRD217.                                                02070048
                                                                        02080048
      *----------------------------------------------------------       02090048
      * COPYBOOK  SURD102 MANIFEST STATUS LAYOUT (INPUT FILE)           02100048
      *----------------------------------------------------------       02110048
           COPY SURD102.                                                02120048
                                                                        02130048
      *----------------------------------------------------------       02140048
      * COPYBOOK  SURD103 MANFIEST DATA LAYOUT (INPUT FILE)             02150048
      *----------------------------------------------------------       02160048
           COPY SURD103.                                                02170048
                                                                        02180048
      *----------------------------------------------------------       02190048
      * COPYBOOK  SFRD104 MANIFEST STATUS LAYOUT (MANFIFEST STAT)       02200048
      *           ALL NUMERIC FIELDS ARE UNPACKED FOR FORMATTING        02210048
      *----------------------------------------------------------       02220048
           COPY SFRD104.                                                02230048
                                                                        02240048
      *----------------------------------------------------------       02250048
      * COPYBOOK  SFRD105 MANFIEST DATA LAYOUT (INPUT FILE)             02260048
      *           ALL NUMERIC FIELDS ARE UNPACKED FOR FORMATTING        02270048
      *----------------------------------------------------------       02280048
           COPY SFRD105.                                                02290048
                                                                        02300048
      *----------------------------------------------------------       02310048
      * DATE ROUTINE COPY MEMBERS                                       02320048
      *----------------------------------------------------------       02330048
           COPY DPWS500.                                                02340048
                                                                        02350048
169947*----------------------------------------------------------       02360079
169947*   ABEND ROUTINE INFORMATION                                     02370079
169947*----------------------------------------------------------       02380079
169947     COPY DPWS004.                                                02390079
                                                                        02400066
      *-----------------------------------------------------------      02410048
      * PROGRAM COUNTERS                                                02420048
      *-----------------------------------------------------------      02430048
       01  PC-PROGRAM-COUNTERS.                                         02440048
           05  PC-MESSAGE-WRITTEN-TO-FILE   PIC 9(09) VALUE ZEROS.      02450048
           05  PC-MESSAGE-FROM-DATA-FILE    PIC 9(09) VALUE ZEROS.      02460048
           05  PC-MESSAGE-FROM-STAT-FILE    PIC 9(09) VALUE ZEROS.      02470048
169947     05  PC-MASTER-PROCESSED-COUNT    PIC 9(09) VALUE ZEROS.      02480080
169947     05  PC-MASTER-BYPASSED-COUNT     PIC 9(09) VALUE ZEROS.      02490080
                                                                        02500048
      *-----------------------------------------------------------      02510048
      * ERROR HANDLING                                                  02520048
      *-----------------------------------------------------------      02530048
       01  PV-MISC-ABEND-FIELDS.                                        02540048
           05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      02550048
           05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      02560048
           05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      02570048
           05  PV-COMPLETION-CODE           PIC S9(09) BINARY.          02580048
           05  PV-REASON                    PIC S9(09) BINARY.          02590048
           05  PV-REASON-TEXT               PIC X(030) VALUE SPACES.    02600048
       01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 02610048
           88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           02620048
           88  ABEND-4020-MQ-ERROR               VALUE +4020.           02630048
169947     88  ABEND-DB2-ERROR                   VALUE +4013.           02640079
                                                                        02650048
169947 01  PV-ABEND-VARIABLES.                                          02660079
169947     05  PV-SQLCODE                   PIC S9(9).                  02670079
169947     05  PV-DISPLAY-SQLCODE           PIC -------999.             02680079
169947     05  PV-ABEND-PROGRAM             PIC X(08)  VALUE 'SFKUT051'.02690079
169947     05  PV-ABEND-PARAGRAPH           PIC X(25)  VALUE SPACES.    02700079
169947     05  PV-ABEND-OPER-MESSAGE-1      PIC X(79)  VALUE SPACES.    02710079
169947     05  PV-ABEND-OPER-MESSAGE-2      PIC X(79)  VALUE SPACES.    02720079
169947     05  PV-ABEND-OPER-MESSAGE-3      PIC X(79)  VALUE SPACES.    02730079
169947     05  PV-ABEND-TABLE-1             PIC X(19)  VALUE SPACES.    02740079
169947     05  PV-ABEND-TABLE-2             PIC X(19)  VALUE SPACES.    02750079
169947     05  PV-ABEND-TABLE-3             PIC X(19)  VALUE SPACES.    02760079
169947     05  PV-DB2-OPERATION-MESSAGE-1   PIC X(79)  VALUE SPACES.    02770079
169947                                                                  02780079
169947******************************************************************02790079
169947* DB2 MESSAGE AREA                                                02800079
169947******************************************************************02810079
169947     COPY SQLCA2.                                                 02820079
169947                                                                  02830079
169947******************************************************************02840079
169947* SQL MESSAGE AREA                                                02850079
169947******************************************************************02860079
169947     EXEC SQL                                                     02870079
169947         INCLUDE SQLCA                                            02880079
169947     END-EXEC.                                                    02890079
169947                                                                  02900079
169947***************************************************************** 02910079
169947*   DB2 TABLE DECLARATION - TKRPRPM                               02920079
169947***************************************************************** 02930079
169947     EXEC SQL                                                     02940079
169947         INCLUDE TKRPRPM                                          02950079
169947     END-EXEC.                                                    02960079
169947                                                                  02970079
169947***************************************************************** 02980079
169947*   DB2 TABLE DECLARATION - WST_INTGRTN_TYP                       02990079
169947***************************************************************** 03000079
169947     EXEC SQL                                                     03010079
169947          INCLUDE WST00008                                        03020079
169947     END-EXEC.                                                    03030079
169947                                                                  03040079
169947***************************************************************** 03050079
169947*   DB2 TABLE DECLARATION - WST_ATTR_DEFN                         03060079
169947***************************************************************** 03070079
169947     EXEC SQL                                                     03080079
169947          INCLUDE WST00009                                        03090079
169947     END-EXEC.                                                    03100079
169947                                                                  03110079
169947***************************************************************** 03120079
169947*   DB2 TABLE DECLARATION - WST_ATTR_ELEM                         03130079
169947***************************************************************** 03140079
169947     EXEC SQL                                                     03150079
169947          INCLUDE WST00010                                        03160079
169947     END-EXEC.                                                    03170079
                                                                        03180050
      *----------------------------------------------------------       03190049
       PROCEDURE DIVISION.                                              03200048
      *----------------------------------------------------------       03210048
       0000-MAINLINE.                                                   03220048
                                                                        03230048
           PERFORM 1000-INITIALIZATION.                                 03240048
                                                                        03250048
           PERFORM 2000-PROCESS-RECORDS.                                03260048
                                                                        03270048
           PERFORM 9000-WRAPUP.                                         03280048
                                                                        03290048
           GOBACK.                                                      03300048
                                                                        03310048
                                                                        03320048
      *----------------------------------------------------------       03330048
      * 1000-INITIALIZATION.                                            03340048
      *     INITIALIZATION AREA -                                       03350048
      *               INITIALIZES PROGRAM COUNTERS                      03360048
      *----------------------------------------------------------       03370048
       1000-INITIALIZATION.                                             03380048
                                                                        03390048
                                                                        03400048
           INITIALIZE PC-PROGRAM-COUNTERS.                              03410048
           SET PS-NOT-END-OF-MNFST-FL TO TRUE.                          03420048
           SET PS-NOT-END-OF-MNFST-ST TO TRUE.                          03430048
      *** SET UP TIMESTAMP    INFORMATION FOR HEADER                    03440048
                                                                        03450048
           ACCEPT PV-RUN-TIME FROM TIME.                                03460048
           ACCEPT PV-DATE-IN  FROM DATE YYYYMMDD.                       03470048
           MOVE DATE-IN-CC           TO PV-HEADER-CC.                   03480048
                                                                        03490048
           MOVE DATE-IN-YY           TO PV-HEADER-YY.                   03500048
                                                                        03510048
           MOVE DATE-IN-MM           TO PV-HEADER-MO.                   03520048
                                                                        03530048
           MOVE DATE-IN-DD           TO PV-HEADER-DD.                   03540048
                                                                        03550048
           MOVE R-HR                 TO PV-HEADER-HH.                   03560048
                                                                        03570048
           MOVE R-MIN                TO PV-HEADER-MM.                   03580048
                                                                        03590048
           MOVE R-SEC                TO PV-HEADER-SS.                   03600048
           DISPLAY 'TMST= ' PV-HEADER-TMST ' - ' PV-DATE-IN.            03610048
                                                                        03620048
           OPEN INPUT  MNFST-DATA-FILE                                  03630048
                       MNFST-STAT-FILE                                  03640048
                OUTPUT FRMTD-MNFST.                                     03650048
                                                                        03660048
                                                                        03670048
      *----------------------------------------------------------       03680048
      * 2000-PROCESS-RECORDS.                                           03690048
      *----------------------------------------------------------       03700048
       2000-PROCESS-RECORDS.                                            03710048
                                                                        03720048
      *                                                                 03730048
      * READ MESSAGES FROM FILE                                         03740048
      *                                                                 03750048
                                                                        03760048
      *** PROCESS MANIFEST RECORDS FROM INPUT FILE                      03770048
           DISPLAY 'MANFIFEST DATA PROCESS'.                            03780048
                                                                        03790048
           PERFORM 4200-READ-MNFST-DATA-FILE.                           03800048
                                                                        03810048
           PERFORM UNTIL PS-END-OF-MNFST-FL                             03820048
      **** MOVES ARE TO UNPACK NUMERIC DATA                             03830048
             MOVE SU103-DEST-LOC-NBR   TO SF105-DEST-LOC-NBR            03840048
             MOVE SU103-OTBND-TRIP-ID  TO SF105-OTBND-TRIP-ID           03850048
             MOVE SU103-SHIPPED-TMST   TO SF105-SHIPPED-TMST            03860048
             MOVE SU103-SHIPT-UNT-ID   TO SF105-SHIPT-UNT-ID            03870048
             MOVE SU103-SKU-NBR        TO SF105-SKU-NBR                 03880048
             MOVE SU103-SHPD-UNT-QTY   TO SF105-SHPD-UNT-QTY            03890048
164325       MOVE SU103-TRLR-SEAL-ID   TO SF105-TRLR-SEAL-ID            03900048
164325       MOVE SU103-SML-TYPE       TO SF105-SML-TYPE                03910048
164325       MOVE SU103-MSTR-UNT-ID    TO SF105-MSTR-UNT-ID             03920048
164325       MOVE SU103-VENDOR-STYLE   TO SF105-VENDOR-STYLE            03930048
164325       MOVE SU103-CATEGORY       TO SF105-CATEGORY                03940048
164325       MOVE SU103-OPC-SET-IND    TO SF105-OPC-SET-IND             03941081
164325       MOVE SU103-VENDOR-CART-ID TO SF105-VENDOR-CART-ID          03942083
      ****                                                              03950048
             IF SU103-DEST-LOC-NBR NOT = PV-PREV-DEST-LOC-NBR           03960058
169947           INITIALIZE WST00010-ATTR-ELEM-NBR                      03970079
169947           PERFORM 7000-STORE-SCAN-RTN                            03980079
169947           IF PS-SOME-STORES                                      03990079
169947              PERFORM 7400-CHECK-STOTBND-SCAN                     04000079
169947           END-IF                                                 04010079
                 PERFORM 3150-FRMT-MNFST-DATA-HDR-REC                   04020056
                 MOVE SU103-DEST-LOC-NBR TO PV-PREV-DEST-LOC-NBR        04030056
             END-IF                                                     04040051
                                                                        04050056
169947       IF SU103-SML-TYPE = 'MST'                                  04060079
169947          IF ( PS-ALL-STORES                                      04070079
169947          OR  WST00010-ATTR-ELEM-NBR = SU103-DEST-LOC-NBR)        04080079
169947             ADD 1 TO PC-MASTER-PROCESSED-COUNT                   04090080
                   PERFORM 2200-FRMT-MNFST-DATA-RECS                    04100059
169947          ELSE                                                    04110079
169947             ADD 1 TO PC-MASTER-BYPASSED-COUNT                    04120079
169947       ELSE                                                       04130079
                 PERFORM 2200-FRMT-MNFST-DATA-RECS                      04140058
169947       END-IF                                                     04150079
             PERFORM 4200-READ-MNFST-DATA-FILE                          04160048
           END-PERFORM.                                                 04170048
                                                                        04180048
           DISPLAY 'MANFIFEST STATUS PROCESS'.                          04190048
      *                                                                 04200048
      * READ MESSAGES FROM QUEUE                                        04210048
      *                                                                 04220048
      *** PROCESS STATUS RECORDS FROM MQ                                04230065
           PERFORM 4100-READ-MNFST-STAT-FILE.                           04240048
           PERFORM UNTIL PS-END-OF-MNFST-ST                             04250048
      **** MOVES ARE TO UNPACK NUMERIC DATA                             04260048
             MOVE SU102-DEST-LOC-NBR  TO SF104-DEST-LOC-NBR             04270048
             MOVE SU102-OTBND-TRIP-ID TO SF104-OTBND-TRIP-ID            04280048
             MOVE SU102-SHIPPED-TMST  TO SF104-SHIPPED-TMST             04290048
             MOVE SU102-TRIP-STAT-CDE TO SF104-TRIP-STAT-CDE            04300048
      ****                                                              04310048
             IF SU102-DEST-LOC-NBR NOT = PV-PREV-DEST-LOC-NBR           04320048
               PERFORM 3100-FRMT-MNFST-STAT-HDR-REC                     04330048
               MOVE SU102-DEST-LOC-NBR TO PV-PREV-DEST-LOC-NBR          04340048
             END-IF                                                     04350048
             PERFORM 2100-FRMT-MNFST-STAT-RECS                          04360048
             PERFORM 4100-READ-MNFST-STAT-FILE                          04370048
           END-PERFORM.                                                 04380048
                                                                        04390048
      *-------------------------------------------------------------    04400048
      * 2100-FRMT-MNFST-STAT-RECS.                                      04410048
      *     THIS PARAGRAPH WILL FORMAT MANIFEST STATUS RECORDS          04420048
      *-------------------------------------------------------------    04430048
       2100-FRMT-MNFST-STAT-RECS.                                       04440048
                                                                        04450048
           SET FORM-EP-HR-LEN TO +1.                                    04460048
           MOVE 0 TO PV-BYTE-COUNT.                                     04470048
           INITIALIZE FRMTD-MNFST-RECORD.                               04480048
           MOVE 'A'                  TO PV-RECORD-ACTION.               04490048
           PERFORM 3200-MOVE-DELIMITER.                                 04500048
           PERFORM 3600-MOVE-RECORD-ACTION.                             04510048
           PERFORM 3200-MOVE-DELIMITER.                                 04520048
                                                                        04530048
      **-- FORMAT SF104-DEST-LOC-NBR                                    04540048
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         04550048
           EVALUATE TRUE                                                04560048
               WHEN SF104-DEST-LOC-NBR = 0                              04570048
                  PERFORM 3700-MOVE-ZERO                                04580048
               WHEN OTHER                                               04590048
                  INITIALIZE PV-TALLY                                   04600048
                  INSPECT SF104-DEST-LOC-NBR TALLYING PV-TALLY          04610048
                      FOR LEADING ZERO                                  04620048
                  SET PV-BIT-IDX TO PV-TALLY                            04630048
                  SET PV-BIT-IDX UP BY +1                               04640048
                  MOVE SF104-DEST-LOC-NBR TO PV-VARIABLE-OUTPUT-FIELD   04650048
                  PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     04660048
                     FROM PV-BIT-IDX BY +1                              04670048
                     UNTIL PV-EOF-IDX > 5                               04680048
           END-EVALUATE.                                                04690048
                                                                        04700048
           PERFORM 3200-MOVE-DELIMITER.                                 04710048
                                                                        04720048
      **-- FORMAT SF104-OTBND-TRIP-ID                                   04730048
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         04740048
           EVALUATE TRUE                                                04750048
               WHEN SF104-OTBND-TRIP-ID = 0                             04760048
                  PERFORM 3700-MOVE-ZERO                                04770048
               WHEN OTHER                                               04780048
                  INITIALIZE PV-TALLY                                   04790048
                  INSPECT SF104-OTBND-TRIP-ID TALLYING PV-TALLY         04800048
                      FOR LEADING ZERO                                  04810048
                  SET PV-BIT-IDX TO PV-TALLY                            04820048
                  SET PV-BIT-IDX UP BY +1                               04830048
                  MOVE SF104-OTBND-TRIP-ID TO PV-VARIABLE-OUTPUT-FIELD  04840048
                  PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     04850048
                     FROM PV-BIT-IDX BY +1                              04860048
                     UNTIL PV-EOF-IDX > 9                               04870048
           END-EVALUATE.                                                04880048
                                                                        04890048
           PERFORM 3200-MOVE-DELIMITER.                                 04900048
                                                                        04910048
      **-- FORMAT SF104-SHIPPED-TMST                                    04920048
                                                                        04930048
           INITIALIZE PV-VARIABLE-CHAR-FIELD.                           04940048
           INSPECT SF104-SHIPPED-TMST                                   04950048
               REPLACING ALL '.'  BY  ':'                               04960048
           MOVE ' ' TO SF104-SHIPPED-TMST (11:1).                       04970048
           MOVE SF104-SHIPPED-TMST TO PV-VARIABLE-CHAR-FIELD.           04980048
           SET PV-CHR-EOF-IDX TO +26.                                   04990048
                                                                        05000048
           PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX           05010048
              FROM 1 BY 1                                               05020048
              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                     05030048
                                                                        05040048
           PERFORM 3200-MOVE-DELIMITER.                                 05050048
                                                                        05060048
      **-- FORMAT SF104-TRIP-STAT-CDE                                   05070048
           INITIALIZE PV-VARIABLE-CHAR-FIELD.                           05080048
           MOVE SF104-TRIP-STAT-CDE TO PV-VARIABLE-CHAR-FIELD.          05090048
           SET PV-CHR-EOF-IDX TO +2.                                    05100048
                                                                        05110048
           PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX           05120048
              FROM 1 BY 1                                               05130048
              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                     05140048
                                                                        05150048
           PERFORM 3200-MOVE-DELIMITER.                                 05160048
                                                                        05170048
           PERFORM 6000-WRITE-FRMTD-MNFST.                              05180048
                                                                        05190048
      *-------------------------------------------------------------    05200048
      * 2200-FRMT-MNFST-DATA-RECS.                                      05210048
      *     THIS PARAGRAPH WILL FORMAT MANIFEST STATUS RECORDS          05220048
      *-------------------------------------------------------------    05230048
       2200-FRMT-MNFST-DATA-RECS.                                       05240048
                                                                        05250048
           SET FORM-EP-HR-LEN TO +1.                                    05260048
           MOVE 0 TO PV-BYTE-COUNT.                                     05270048
           INITIALIZE FRMTD-MNFST-RECORD.                               05280048
           MOVE 'A'                  TO PV-RECORD-ACTION.               05290048
           PERFORM 3200-MOVE-DELIMITER.                                 05300048
           PERFORM 3600-MOVE-RECORD-ACTION.                             05310048
           PERFORM 3200-MOVE-DELIMITER.                                 05320048
                                                                        05330048
      **-- FORMAT SF105-DEST-LOC-NBR                                    05340048
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         05350048
           EVALUATE TRUE                                                05360048
               WHEN SF105-DEST-LOC-NBR = 0                              05370048
                  PERFORM 3700-MOVE-ZERO                                05380048
               WHEN OTHER                                               05390048
                  INITIALIZE PV-TALLY                                   05400048
                  INSPECT SF105-DEST-LOC-NBR TALLYING PV-TALLY          05410048
                      FOR LEADING ZERO                                  05420048
                  SET PV-BIT-IDX TO PV-TALLY                            05430048
                  SET PV-BIT-IDX UP BY +1                               05440048
                  MOVE SF105-DEST-LOC-NBR TO PV-VARIABLE-OUTPUT-FIELD   05450048
                  PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     05460048
                     FROM PV-BIT-IDX BY +1                              05470048
                     UNTIL PV-EOF-IDX > 5                               05480048
           END-EVALUATE.                                                05490048
                                                                        05500048
           PERFORM 3200-MOVE-DELIMITER.                                 05510048
                                                                        05520048
      **-- FORMAT SF105-OTBND-TRIP-ID                                   05530048
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         05540048
           EVALUATE TRUE                                                05550048
               WHEN SF105-OTBND-TRIP-ID = 0                             05560048
                  PERFORM 3700-MOVE-ZERO                                05570048
               WHEN OTHER                                               05580048
                  INITIALIZE PV-TALLY                                   05590048
                  INSPECT SF105-OTBND-TRIP-ID TALLYING PV-TALLY         05600048
                      FOR LEADING ZERO                                  05610048
                  SET PV-BIT-IDX TO PV-TALLY                            05620048
                  SET PV-BIT-IDX UP BY +1                               05630048
                  MOVE SF105-OTBND-TRIP-ID TO PV-VARIABLE-OUTPUT-FIELD  05640048
                  PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     05650048
                     FROM PV-BIT-IDX BY +1                              05660048
                     UNTIL PV-EOF-IDX > 9                               05670048
           END-EVALUATE.                                                05680048
                                                                        05690048
           PERFORM 3200-MOVE-DELIMITER.                                 05700048
                                                                        05710048
      **-- FORMAT SF105-SHIPPED-TMST                                    05720048
                                                                        05730048
           INITIALIZE PV-VARIABLE-CHAR-FIELD.                           05740048
           INSPECT SF105-SHIPPED-TMST                                   05750048
               REPLACING ALL '.'  BY  ':'                               05760048
           MOVE ' ' TO SF105-SHIPPED-TMST (11:1).                       05770048
           MOVE SF105-SHIPPED-TMST TO PV-VARIABLE-CHAR-FIELD.           05780048
           SET PV-CHR-EOF-IDX TO +26.                                   05790048
                                                                        05800048
           PERFORM 3500-MOVE-CHAR-DATA VARYING PV-CHR-BIT-IDX           05810048
              FROM 1 BY 1                                               05820048
              UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                     05830048
                                                                        05840048
           PERFORM 3200-MOVE-DELIMITER.                                 05850048
                                                                        05860048
      **-- FORMAT SF105-SHIPT-UNT-ID                                    05870048
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         05880048
                                                                        05890048
           EVALUATE TRUE                                                05900048
               WHEN SF105-SHIPT-UNT-ID = 0                              05910048
                  PERFORM 3700-MOVE-ZERO                                05920048
               WHEN OTHER                                               05930048
                  INITIALIZE PV-TALLY                                   05940048
                  INSPECT SF105-SHIPT-UNT-ID TALLYING PV-TALLY          05950048
                      FOR LEADING ZERO                                  05960048
                  SET PV-BIT-IDX TO PV-TALLY                            05970048
                  SET PV-BIT-IDX UP BY +1                               05980048
                                                                        05990048
                  MOVE SF105-SHIPT-UNT-ID TO PV-VARIABLE-OUTPUT-FIELD   06000048
                                                                        06010048
                  PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     06020048
                     FROM PV-BIT-IDX BY +1                              06030048
                     UNTIL PV-EOF-IDX > 18                              06040048
           END-EVALUATE.                                                06050048
                                                                        06060048
           PERFORM 3200-MOVE-DELIMITER.                                 06070048
                                                                        06080048
      **-- FORMAT SF105-SKU-NBR                                         06090048
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         06100048
                                                                        06110048
           EVALUATE TRUE                                                06120048
               WHEN SF105-SKU-NBR = 0                                   06130048
                  PERFORM 3700-MOVE-ZERO                                06140048
               WHEN OTHER                                               06150048
                  INITIALIZE PV-TALLY                                   06160048
                  INSPECT SF105-SKU-NBR TALLYING PV-TALLY               06170048
                      FOR LEADING ZERO                                  06180048
                  SET PV-BIT-IDX TO PV-TALLY                            06190048
                  SET PV-BIT-IDX UP BY +1                               06200048
                                                                        06210048
                  MOVE SF105-SKU-NBR TO PV-VARIABLE-OUTPUT-FIELD        06220048
                                                                        06230048
                  PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     06240048
                     FROM PV-BIT-IDX BY +1                              06250048
                     UNTIL PV-EOF-IDX > 8                               06260048
           END-EVALUATE.                                                06270048
                                                                        06280048
           PERFORM 3200-MOVE-DELIMITER.                                 06290048
                                                                        06300048
      **-- FORMAT SF105-SHPD-UNT-QTY                                    06310048
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         06320048
                                                                        06330048
           EVALUATE TRUE                                                06340048
               WHEN SF105-SHPD-UNT-QTY = 0                              06350048
                  PERFORM 3700-MOVE-ZERO                                06360048
               WHEN OTHER                                               06370048
                  INITIALIZE PV-TALLY                                   06380048
                  INSPECT SF105-SHPD-UNT-QTY TALLYING PV-TALLY          06390048
                      FOR LEADING ZERO                                  06400048
                  SET PV-BIT-IDX TO PV-TALLY                            06410048
                  SET PV-BIT-IDX UP BY +1                               06420048
                                                                        06430048
                  MOVE SF105-SHPD-UNT-QTY TO PV-VARIABLE-OUTPUT-FIELD   06440048
                                                                        06450048
                  PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     06460048
                     FROM PV-BIT-IDX BY +1                              06470048
                     UNTIL PV-EOF-IDX > 9                               06480048
           END-EVALUATE.                                                06490048
                                                                        06500048
           PERFORM 3200-MOVE-DELIMITER.                                 06510048
                                                                        06520048
164325**-- FORMAT SF105-TRLR-SEAL-ID                                    06530048
164325     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           06540048
164325                                                                  06550048
164325     MOVE SF105-TRLR-SEAL-ID TO PV-VARIABLE-CHAR-FIELD.           06560048
164325     MOVE LENGTH OF SF105-TRLR-SEAL-ID                            06570048
164325                             TO PV-FIELD-LENGTH.                  06580048
164325                                                                  06590048
164325     PERFORM                                                      06600048
164325       VARYING PV-TALLY FROM PV-FIELD-LENGTH BY -1                06610048
164325         UNTIL PV-TALLY < 2                                       06620048
164325            OR PV-BIT-CHR-VARIABLE (PV-TALLY) > SPACE             06630048
164325     END-PERFORM.                                                 06640048
164325                                                                  06650048
164325     SET PV-CHR-EOF-IDX TO PV-TALLY.                              06660048
164325                                                                  06670048
164325     PERFORM 3500-MOVE-CHAR-DATA                                  06680048
164325        VARYING PV-CHR-BIT-IDX                                    06690048
164325          FROM 1 BY 1                                             06700048
164325            UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX.                06710048
164325                                                                  06720048
164325     PERFORM 3200-MOVE-DELIMITER.                                 06730048
164325                                                                  06740048
164325**-- FORMAT SF105-SML-TYPE                                        06750048
164325     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           06760048
164325                                                                  06770048
164325     MOVE SF105-SML-TYPE     TO PV-VARIABLE-CHAR-FIELD.           06780048
164325     MOVE LENGTH OF SF105-SML-TYPE                                06790048
164325                             TO PV-FIELD-LENGTH.                  06800048
164325                                                                  06810048
164325     PERFORM                                                      06820048
164325       VARYING PV-TALLY FROM PV-FIELD-LENGTH BY -1                06830048
164325         UNTIL PV-TALLY < 2                                       06840048
164325            OR PV-BIT-CHR-VARIABLE (PV-TALLY) > SPACE             06850048
164325     END-PERFORM.                                                 06860048
164325                                                                  06870048
164325     SET PV-CHR-EOF-IDX TO PV-TALLY.                              06880048
164325     PERFORM 3500-MOVE-CHAR-DATA                                  06890048
164325        VARYING PV-CHR-BIT-IDX                                    06900048
164325          FROM 1 BY 1                                             06910048
164325            UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                 06920048
164325                                                                  06930048
164325     PERFORM 3200-MOVE-DELIMITER.                                 06940048
164325                                                                  06950048
164325**-- FORMAT SF105-MSTR-UNT-ID                                     06960048
164325     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         06970048
164325                                                                  06980048
164325     EVALUATE TRUE                                                06990048
164325         WHEN SF105-MSTR-UNT-ID = 0                               07000048
164325            PERFORM 3700-MOVE-ZERO                                07010048
164325         WHEN OTHER                                               07020048
164325            INITIALIZE PV-TALLY                                   07030048
164325            INSPECT SF105-MSTR-UNT-ID TALLYING PV-TALLY           07040048
164325                FOR LEADING ZERO                                  07050048
164325            SET PV-BIT-IDX TO PV-TALLY                            07060048
164325            SET PV-BIT-IDX UP BY +1                               07070048
164325                                                                  07080048
164325            MOVE SF105-MSTR-UNT-ID TO PV-VARIABLE-OUTPUT-FIELD    07090048
164325                                                                  07100048
164325            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     07110048
164325               FROM PV-BIT-IDX BY +1                              07120048
164325               UNTIL PV-EOF-IDX > 18                              07130048
164325     END-EVALUATE.                                                07140048
164325                                                                  07150048
164325     PERFORM 3200-MOVE-DELIMITER.                                 07160048
164325                                                                  07170048
164325**-- FORMAT SF105-VENDOR-STYLE                                    07180048
164325     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         07190048
164325                                                                  07200048
164325     EVALUATE TRUE                                                07210048
164325         WHEN SF105-VENDOR-STYLE = 0                              07220048
164325            PERFORM 3700-MOVE-ZERO                                07230048
164325         WHEN OTHER                                               07240048
164325            INITIALIZE PV-TALLY                                   07250048
164325            INSPECT SF105-VENDOR-STYLE TALLYING PV-TALLY          07260048
164325                FOR LEADING ZERO                                  07270048
164325            SET PV-BIT-IDX TO PV-TALLY                            07280048
164325            SET PV-BIT-IDX UP BY +1                               07290048
164325                                                                  07300048
164325            MOVE SF105-VENDOR-STYLE TO PV-VARIABLE-OUTPUT-FIELD   07310048
164325                                                                  07320048
164325            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     07330048
164325               FROM PV-BIT-IDX BY +1                              07340048
164325               UNTIL PV-EOF-IDX > 9                               07350048
164325     END-EVALUATE.                                                07360048
164325                                                                  07370048
164325     PERFORM 3200-MOVE-DELIMITER.                                 07380048
164325                                                                  07390048
164325**-- FORMAT SF105-CATEGORY                                        07400048
164325     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         07410048
164325                                                                  07420048
164325     EVALUATE TRUE                                                07430048
164325         WHEN SF105-CATEGORY = 0                                  07440048
164325            PERFORM 3700-MOVE-ZERO                                07450048
164325         WHEN OTHER                                               07460048
164325            INITIALIZE PV-TALLY                                   07470048
164325            INSPECT SF105-CATEGORY TALLYING PV-TALLY              07480048
164325                FOR LEADING ZERO                                  07490048
164325            SET PV-BIT-IDX TO PV-TALLY                            07500048
164325            SET PV-BIT-IDX UP BY +1                               07510048
164325                                                                  07520048
164325            MOVE SF105-CATEGORY TO PV-VARIABLE-OUTPUT-FIELD       07530048
164325                                                                  07540048
164325            PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     07550048
164325               FROM PV-BIT-IDX BY +1                              07560048
164325               UNTIL PV-EOF-IDX > 5                               07570048
164325     END-EVALUATE.                                                07580048
164325                                                                  07590048
164325     PERFORM 3200-MOVE-DELIMITER.                                 07600048
164325                                                                  07610048
164325**-- FORMAT SF105-OPC-SET-IND                                     07611081
164325     INITIALIZE PV-VARIABLE-CHAR-FIELD.                           07612081
164325                                                                  07613081
164325     MOVE SF105-OPC-SET-IND  TO PV-VARIABLE-CHAR-FIELD.           07614081
164325     MOVE LENGTH OF SF105-OPC-SET-IND                             07615081
164325                             TO PV-FIELD-LENGTH.                  07616081
164325                                                                  07617081
164325     PERFORM                                                      07618081
164325       VARYING PV-TALLY FROM PV-FIELD-LENGTH BY -1                07619081
164325         UNTIL PV-TALLY < 2                                       07619181
164325            OR PV-BIT-CHR-VARIABLE (PV-TALLY) > SPACE             07619281
164325     END-PERFORM.                                                 07619381
164325                                                                  07619481
164325     SET PV-CHR-EOF-IDX TO PV-TALLY.                              07619581
164325     PERFORM 3500-MOVE-CHAR-DATA                                  07619681
164325        VARYING PV-CHR-BIT-IDX                                    07619781
164325          FROM 1 BY 1                                             07619881
164325            UNTIL PV-CHR-BIT-IDX > PV-CHR-EOF-IDX                 07619981
164325                                                                  07620081
164325     PERFORM 3200-MOVE-DELIMITER.                                 07620181
164325                                                                  07620281
      **-- FORMAT SF105-VENDOR-CART-ID                                  07620382
           INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         07620482
                                                                        07620582
           EVALUATE TRUE                                                07620682
               WHEN SF105-VENDOR-CART-ID = 0                            07620782
                  PERFORM 3700-MOVE-ZERO                                07620882
               WHEN OTHER                                               07620982
                  INITIALIZE PV-TALLY                                   07621082
                  INSPECT SF105-VENDOR-CART-ID TALLYING PV-TALLY        07621182
                      FOR LEADING ZERO                                  07621282
                  SET PV-BIT-IDX TO PV-TALLY                            07621382
                  SET PV-BIT-IDX UP BY +1                               07621482
                                                                        07621582
                  MOVE SF105-VENDOR-CART-ID TO                          07621682
                                            PV-VARIABLE-OUTPUT-FIELD    07621782
                                                                        07621882
                  PERFORM 3400-MOVE-NUMERIC-DATA VARYING PV-EOF-IDX     07621982
                     FROM PV-BIT-IDX BY +1                              07622082
                     UNTIL PV-EOF-IDX > 18                              07622182
           END-EVALUATE.                                                07622282
                                                                        07622382
           PERFORM 3200-MOVE-DELIMITER.                                 07622482
                                                                        07622582
           PERFORM 6000-WRITE-FRMTD-MNFST.                              07623048
                                                                        07630048
      *-------------------------------------------------------------    07640048
      * 3100-FRMT-MNFST-STAT-HDR-REC.                                   07650048
      *     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA   07660048
      *     FOR MNFST STATUS RECORD                                     07670048
      *-------------------------------------------------------------    07680048
       3100-FRMT-MNFST-STAT-HDR-REC.                                    07690048
                                                                        07700048
           SET EP217-FILE-MLS-INITIATIVE TO TRUE.                       07710048
           SET EP217-MLS-MNFST-STAT    TO TRUE.                         07720048
           MOVE SF104-DEST-LOC-NBR     TO PV-STR-GRP-ID.                07730048
           MOVE 'CHG'                  TO EP217-FILE-NAME-TYPE.         07740048
           MOVE SF104-DEST-LOC-NBR     TO EP217-STORE-NBR.              07750048
           MOVE PC-FIVE-ZERO           TO PV-FIRST-BYTES.               07760048
           MOVE PC-STR-GRP-ID-5000     TO PV-STR-GRP-TYP-CDE.           07770048
                                                                        07780048
           MOVE PC-HDR-IND             TO EP217-HDR-INDICATOR.          07790048
           MOVE PV-STR-GRP-TYP-CDE     TO EP217-STR-GRP-TYP.            07800048
           MOVE PV-STR-GRP-ID-GRP      TO EP217-STR-GRP-ID.             07810048
           MOVE PC-FIVE-ZERO           TO EP217-EXCO-STR-NBR.           07820048
           MOVE PV-DATE-IN             TO EP217-FILE-DIST-DATE.         07830048
           MOVE 'CHG'                  TO EP217-FILE-TYPE-APPLY.        07840048
      * PT-NBR-FULL-FILE-STRS > MEANS THAT A FILE OF STORES FOR WHICH   07850048
      * FULL FILES HAVE BEEN REQUESTED WAS FOUND AND READ AND THEREFORE 07860048
      * THIS IS A FULL FILE RUN AND NOT A CHANGE. THE CHANGE PROCESS    07870048
      * WILL HAVE THE FILE 'DUMMIED' OUT, SO NO STORE RECORDS CAN BE    07880048
      * FOUND.                                                          07890048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-1.           07900048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-2.           07910048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-3.           07920048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-4.           07930048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-5.           07940048
           MOVE PV-HEADER-TMST         TO EP217-CRT-TIMESTAMP.          07950048
                                                                        07960048
           PERFORM 3900-WRITE-HEADER-REC.                               07970048
           SET PS-STAT-HDR-REC-WRITEN TO TRUE.                          07980048
                                                                        07990048
      *-------------------------------------------------------------    08000048
      * 3150-FRMT-MNFST-DATA-HDR-REC.                                   08010048
      *     THIS PARAGRAPH WILL ADD HEADER RECORD AND FORMAT THE DATA   08020048
      *     FOR MNFST STATUS RECORD                                     08030048
      *-------------------------------------------------------------    08040048
       3150-FRMT-MNFST-DATA-HDR-REC.                                    08050048
                                                                        08060048
           SET EP217-FILE-MLS-INITIATIVE TO TRUE.                       08070048
           SET EP217-MLS-MNFST-DATA      TO TRUE.                       08080048
           MOVE SF105-DEST-LOC-NBR     TO PV-STR-GRP-ID.                08090048
           MOVE 'CHG'                  TO EP217-FILE-NAME-TYPE.         08100048
           MOVE SF105-DEST-LOC-NBR     TO EP217-STORE-NBR.              08110048
           MOVE PC-FIVE-ZERO           TO PV-FIRST-BYTES.               08120048
           MOVE PC-STR-GRP-ID-5000     TO PV-STR-GRP-TYP-CDE.           08130048
                                                                        08140048
           MOVE PC-HDR-IND             TO EP217-HDR-INDICATOR.          08150048
           MOVE PV-STR-GRP-TYP-CDE     TO EP217-STR-GRP-TYP.            08160048
           MOVE PV-STR-GRP-ID-GRP      TO EP217-STR-GRP-ID.             08170048
           MOVE PC-FIVE-ZERO           TO EP217-EXCO-STR-NBR.           08180048
           MOVE PV-DATE-IN             TO EP217-FILE-DIST-DATE.         08190048
           MOVE 'C'                    TO EP217-FILE-TYPE-APPLY.        08200048
      * PT-NBR-FULL-FILE-STRS > MEANS THAT A FILE OF STORES FOR WHICH   08210048
      * FULL FILES HAVE BEEN REQUESTED WAS FOUND AND READ AND THEREFORE 08220048
      * THIS IS A FULL FILE RUN AND NOT A CHANGE. THE CHANGE PROCESS    08230048
      * WILL HAVE THE FILE 'DUMMIED' OUT, SO NO STORE RECORDS CAN BE    08240048
      * FOUND.                                                          08250048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-1.           08260048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-2.           08270048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-3.           08280048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-4.           08290048
           MOVE PC-UNDER-SCORE         TO EP217-UNDERSCORE-5.           08300048
           MOVE PV-HEADER-TMST         TO EP217-CRT-TIMESTAMP.          08310048
                                                                        08320048
           PERFORM 3900-WRITE-HEADER-REC.                               08330048
           SET PS-DATA-HDR-REC-WRITEN TO TRUE.                          08340048
                                                                        08350048
      *-----------------------------------------------------------------08360048
      * 3200-MOVE-DELIMITER                                             08370048
      *  THIS PARAGRAPH WILL MOVE '|' TO THE OUTPUT FILE VARIABLE       08380048
      *----------------------------------------------------------------*08390048
       3200-MOVE-DELIMITER.                                             08400048
                                                                        08410048
           MOVE PC-CSV-DELIMITER                                        08420048
             TO FORM-SU-HR-FLD(FORM-EP-HR-LEN).                         08430048
           SET FORM-EP-HR-LEN                                           08440048
             UP BY +1.                                                  08450048
           ADD 1                                                        08460048
             TO PV-BYTE-COUNT.                                          08470048
                                                                        08480048
                                                                        08490048
      *-----------------------------------------------------------------08500048
      * 3300-MOVE-SPACE                                                 08510048
      *  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE       08520048
      *----------------------------------------------------------------*08530048
      *3300-MOVE-SPACE.                                                 08540048
      *                                                                 08550048
      *    MOVE PC-ONE-SPACE                                            08560048
      *      TO FORM-SU-HR-FLD(FORM-EP-HR-LEN).                         08570048
      *    SET FORM-EP-HR-LEN                                           08580048
      *      UP BY +1.                                                  08590048
      *    ADD 1                                                        08600048
      *      TO PV-BYTE-COUNT.                                          08610048
                                                                        08620048
                                                                        08630048
      *-----------------------------------------------------------------08640048
      * 3400-MOVE-NUMERIC-DATA                                          08650048
      *  THIS PARAGRAPH WILL NUMERIC DATA TO THE OUTPUT FILE VARIABLE   08660048
      *----------------------------------------------------------------*08670048
       3400-MOVE-NUMERIC-DATA.                                          08680048
                                                                        08690048
           MOVE PV-BIT-VARIABLE(PV-EOF-IDX)                             08700048
             TO FORM-SU-HR-FLD(FORM-EP-HR-LEN).                         08710048
           SET FORM-EP-HR-LEN                                           08720048
             UP BY +1.                                                  08730048
           ADD 1                                                        08740048
             TO PV-BYTE-COUNT.                                          08750048
                                                                        08760048
                                                                        08770048
      *-----------------------------------------------------------------08780048
      * 3500-MOVE-CHAR-DATA                                             08790048
      *  THIS PARAGRAPH WILL MOVE ' ' TO THE OUTPUT FILE VARIABLE       08800048
      *----------------------------------------------------------------*08810048
       3500-MOVE-CHAR-DATA.                                             08820048
                                                                        08830048
           MOVE PV-BIT-CHR-VARIABLE(PV-CHR-BIT-IDX)                     08840048
             TO FORM-SU-HR-FLD(FORM-EP-HR-LEN).                         08850048
           SET FORM-EP-HR-LEN                                           08860048
             UP BY +1.                                                  08870048
           ADD 1                                                        08880048
             TO PV-BYTE-COUNT.                                          08890048
                                                                        08900048
      *-----------------------------------------------------------------08910048
      * 3600-MOVE-RECORD-ACTION                                         08920048
      *  THIS PARAGRAPH WILL MOVE ACTION CDE TO THE OUTPUT FILE VARIABLE08930048
      *----------------------------------------------------------------*08940048
       3600-MOVE-RECORD-ACTION.                                         08950048
                                                                        08960048
           MOVE PV-RECORD-ACTION                                        08970048
             TO FORM-SU-HR-FLD(FORM-EP-HR-LEN).                         08980048
           SET FORM-EP-HR-LEN                                           08990048
             UP BY +1.                                                  09000048
           ADD 1                                                        09010048
             TO PV-BYTE-COUNT.                                          09020048
                                                                        09030048
                                                                        09040048
      *-----------------------------------------------------------------09050048
      * 3700-MOVE-ZERO                                                  09060048
      *  THIS PARAGRAPH WILL MOVE '0' TO THE OUTPUT FILE VARIABLE       09070048
      *----------------------------------------------------------------*09080048
       3700-MOVE-ZERO.                                                  09090048
                                                                        09100048
           MOVE PC-ONE-ZERO                                             09110048
             TO FORM-SU-HR-FLD(FORM-EP-HR-LEN).                         09120048
           SET FORM-EP-HR-LEN                                           09130048
             UP BY +1.                                                  09140048
           ADD 1                                                        09150048
             TO PV-BYTE-COUNT.                                          09160048
                                                                        09170048
      *-------------------------------------------------------------    09180048
      * 3900-WRITE-HEADER-REC.                                          09190048
      *     FORMAT AND WRITE THE HEADER RECORD.                         09200048
      *-------------------------------------------------------------    09210048
       3900-WRITE-HEADER-REC.                                           09220048
                                                                        09230048
           PERFORM 3950-INCR-HEADER-TIMESTAMP.                          09240048
                                                                        09250048
           MOVE 64                                                      09260048
             TO PV-BYTE-COUNT.                                          09270048
           WRITE FRMTD-MNFST-RECORD                                     09280048
             FROM EP217-HEADER-RECORD.                                  09290048
                                                                        09300048
                                                                        09310048
      *-------------------------------------------------------------    09320048
      * 3950-INCR-HEADER-TIMESTAMP.                                     09330048
      *     THIS PARAGRAPH WILL INCREMENT THE TIMESTAMP BY 1 SECOND     09340048
      *     THIS WOULD ENSURE THE HEADER RECORDS TO BE 1 SECOND APART   09350048
      *     WHICH IS MID-TIER REQUIREMENT.                              09360048
      *-------------------------------------------------------------    09370048
       3950-INCR-HEADER-TIMESTAMP.                                      09380048
                                                                        09390048
           ADD 1                                                        09400048
             TO PV-HEADER-SS.                                           09410048
           IF PV-HEADER-SS GREATER 59                                   09420048
               MOVE ZERO                                                09430048
                 TO PV-HEADER-SS                                        09440048
               ADD 1                                                    09450048
                 TO PV-HEADER-MM                                        09460048
           END-IF.                                                      09470048
                                                                        09480048
           IF PV-HEADER-MM GREATER 59                                   09490048
               MOVE ZERO                                                09500048
                 TO PV-HEADER-MM                                        09510048
               ADD 1                                                    09520048
                 TO PV-HEADER-HH                                        09530048
           END-IF.                                                      09540048
                                                                        09550048
           IF PV-HEADER-HH GREATER 23                                   09560048
               MOVE ZERO                                                09570048
                 TO PV-HEADER-HH                                        09580048
               ADD 1                                                    09590048
                 TO PV-HEADER-DD                                        09600048
           END-IF.                                                      09610048
                                                                        09620048
           IF PV-HEADER-MO = 01                                         09630048
             OR PV-HEADER-MO = 03                                       09640048
               OR PV-HEADER-MO = 05                                     09650048
                 OR PV-HEADER-MO = 07                                   09660048
                   OR PV-HEADER-MO = 08                                 09670048
                     OR PV-HEADER-MO = 10                               09680048
                       OR PV-HEADER-MO = 12                             09690048
               IF PV-HEADER-DD GREATER 31                               09700048
                   MOVE 1                                               09710048
                     TO PV-HEADER-DD                                    09720048
                   ADD 1                                                09730048
                     TO PV-HEADER-MO                                    09740048
               END-IF                                                   09750048
           ELSE                                                         09760048
               IF PV-HEADER-MO = 04                                     09770048
                 OR PV-HEADER-MO = 06                                   09780048
                   OR PV-HEADER-MO = 09                                 09790048
                     OR PV-HEADER-MO = 11                               09800048
                   IF PV-HEADER-DD GREATER 30                           09810048
                       MOVE 1                                           09820048
                         TO PV-HEADER-DD                                09830048
                       ADD 1                                            09840048
                         TO PV-HEADER-MO                                09850048
                   END-IF                                               09860048
               ELSE                                                     09870048
                   IF PV-HEADER-MO = 02                                 09880048
                       DIVIDE PV-HEADER-YYYY BY 100                     09890048
                         GIVING PV-QUOTIENT                             09900048
                           REMAINDER PV-RMDR-100                        09910048
                       DIVIDE PV-HEADER-YYYY BY 4                       09920048
                         GIVING PV-QUOTIENT                             09930048
                           REMAINDER PV-RMDR-4                          09940048
                       IF PV-RMDR-100 = 0                               09950048
                           IF PV-HEADER-DD GREATER 28                   09960048
                               MOVE 1                                   09970048
                                 TO PV-HEADER-DD                        09980048
                               ADD 1                                    09990048
                                 TO PV-HEADER-MO                        10000048
                           END-IF                                       10010048
                       ELSE                                             10020048
                           IF PV-RMDR-4 = 0                             10030048
                               IF PV-HEADER-DD GREATER 29               10040048
                                   MOVE 1                               10050048
                                     TO PV-HEADER-DD                    10060048
                                   ADD 1                                10070048
                                     TO PV-HEADER-MO                    10080048
                               END-IF                                   10090048
                           ELSE                                         10100048
                               IF PV-HEADER-DD GREATER 28               10110048
                                   MOVE 1                               10120048
                                     TO PV-HEADER-DD                    10130048
                                   ADD 1                                10140048
                                     TO PV-HEADER-MO                    10150048
                               END-IF                                   10160048
                           END-IF                                       10170048
                       END-IF                                           10180048
                   END-IF                                               10190048
               END-IF                                                   10200048
           END-IF.                                                      10210048
                                                                        10220048
           IF PV-HEADER-MO GREATER 12                                   10230048
               MOVE 1                                                   10240048
                 TO PV-HEADER-MO                                        10250048
               ADD 1                                                    10260048
                 TO PV-HEADER-YYYY                                      10270048
           END-IF.                                                      10280048
                                                                        10290048
                                                                        10300048
                                                                        10310048
                                                                        10320048
      *----------------------------------------------------------       10330048
      * 4100-READ-MNFST-STAT-FILE.                                      10340048
      *----------------------------------------------------------       10350048
       4100-READ-MNFST-STAT-FILE.                                       10360048
                                                                        10370048
           READ MNFST-STAT-FILE INTO SU102-EXTRACT-RECORD               10380048
               AT END                                                   10390048
                   SET PS-END-OF-MNFST-ST TO TRUE.                      10400048
           IF PS-NOT-END-OF-MNFST-ST                                    10410048
             ADD +1 TO PC-MESSAGE-FROM-STAT-FILE.                       10420048
                                                                        10430048
      *----------------------------------------------------------       10440048
      * 4200-READ-MNFST-DATA-FILE.                                      10450048
      *----------------------------------------------------------       10460048
       4200-READ-MNFST-DATA-FILE.                                       10470048
                                                                        10480048
           READ MNFST-DATA-FILE INTO SU103-EXTRACT-RECORD               10490048
               AT END                                                   10500048
                   SET PS-END-OF-MNFST-FL TO TRUE.                      10510048
           IF PS-NOT-END-OF-MNFST-FL                                    10520048
             ADD +1 TO PC-MESSAGE-FROM-DATA-FILE.                       10530048
                                                                        10540048
      *----------------------------------------------------------       10550048
      * 6000-WRITE-FRMTD-MNFST.                                         10560048
      *     WRITES THE MESSAGE TO A ERROR LOG.                          10570048
      *----------------------------------------------------------       10580048
       6000-WRITE-FRMTD-MNFST.                                          10590048
                                                                        10600048
           WRITE FRMTD-MNFST-RECORD.                                    10610048
                                                                        10620048
           ADD +1 TO PC-MESSAGE-WRITTEN-TO-FILE.                        10630048
                                                                        10640048
169947******************************************************************10650079
169947 7000-STORE-SCAN-RTN.                                             10660079
169947                                                                  10670079
169947     PERFORM 7200-CHECK-SCANNING-PARM.                            10680079
169947     EVALUATE TRUE                                                10690079
169947         WHEN KRPRPM-FUNC-TXT  = 'A'                              10700079
169947              SET PS-ALL-STORES  TO TRUE                          10710079
169947                                                                  10720079
169947         WHEN KRPRPM-FUNC-TXT  = 'E'                              10730079
169947              SET PS-SOME-STORES TO TRUE                          10740079
169947                                                                  10750079
169947         WHEN KRPRPM-FUNC-TXT  = 'N'                              10760079
169947              SET PS-NO-STORES   TO TRUE                          10770079
169947                                                                  10780079
169947         WHEN OTHER                                               10790079
169947              MOVE '7000-STORE-SCAN-RTN'                          10800079
169947                               TO PV-ABEND-PARAGRAPH              10810079
169947              MOVE 'CHECK PARM TABLE FOR SECURITY LEVEL'          10820079
169947                               TO PV-ABEND-OPER-MESSAGE-1         10830079
169947              MOVE PV-CODE-ERROR1                                 10840079
169947                               TO PV-ABEND-OPER-MESSAGE-2         10850079
169947              MOVE KRPRPM-FUNC-TXT                                10860079
169947                               TO PV-INCORRECT-CODE               10870079
169947              MOVE PV-CODE-ERROR2                                 10880079
169947                               TO PV-ABEND-OPER-MESSAGE-3         10890079
169947              MOVE 'TKRPRPM'   TO PV-ABEND-TABLE-1                10900079
169947              PERFORM 9200-SQL-ERROR                              10910079
169947     END-EVALUATE.                                                10920079
169947                                                                  10930079
169947******************************************************************10940079
169947* THIS PARM IS USED TO INDICATE IF THE PROCESS TO RELIEVE STORE * 10950079
169947* EXPECTED BASED ON THE CARTON SCANS FROM STORES IS BEING USED, * 10960079
169947* AND IF IT IS BEING USED, IS IT BEING DONE AT ALL STORES('A'), * 10970079
169947* CERTAIN STORES('E') OR NO STORES('N').                        * 10980079
169947******************************************************************10990079
169947 7200-CHECK-SCANNING-PARM.                                        11000079
169947                                                                  11010079
169947       EXEC SQL                                                   11020079
169947           SELECT FUNC_TXT                                        11030079
169947             INTO :KRPRPM-FUNC-TXT                                11040079
169947             FROM TKRPRPM                                         11050079
169947            WHERE LOC_ID            =  90                         11060079
169947              AND INTFC_SYS_CDE     = 'KHL'                       11070079
169947              AND FUNC_PRC_STAT_CDE = 'AC'                        11080079
169947              AND SYS_PRC_FUNC_CDE  = 'STRSCN'                    11090079
169947           WITH UR                                                11100079
169947       END-EXEC.                                                  11110079
169947                                                                  11120079
169947       EVALUATE TRUE                                              11130079
169947           WHEN SQLCODE = ZERO                                    11140079
169947                CONTINUE                                          11150079
169947                                                                  11160079
169947           WHEN SQLCODE = +100                                    11170079
169947                MOVE 'E'         TO KRPRPM-FUNC-TXT               11180079
169947                                                                  11190079
169947           WHEN SQLWARN0 NOT = SPACE                              11200079
169947           WHEN SQLCODE NOT = ZERO                                11210079
169947                MOVE '7200-CHECK-SCANNING-PARM'                   11220079
169947                                 TO PV-ABEND-PARAGRAPH            11230079
169947                MOVE 'CHECK THE -STRSCN- PARM'                    11240079
169947                                 TO PV-ABEND-OPER-MESSAGE-1       11250079
169947                MOVE 'TKRPRPM'   TO PV-ABEND-TABLE-1              11260079
169947                PERFORM 9200-SQL-ERROR                            11270079
169947       END-EVALUATE.                                              11280079
169947                                                                  11290079
169947****************************************************************  11300079
169947* CHECK IF THIS IS A SCANNING STORE.                              11310079
169947****************************************************************  11320079
169947 7400-CHECK-STOTBND-SCAN.                                         11330079
169947                                                                  11340079
169947       MOVE SU103-DEST-LOC-NBR TO DK-STR-NBR.                     11350079
169947                                                                  11360079
169947       EXEC SQL                                                   11370079
169947           SELECT C.ATTR_ELEM_NBR                                 11380079
169947             INTO :WST00010-ATTR-ELEM-NBR                         11390079
169947             FROM WST_INTGRTN_TYP   A                             11400079
169947                , WST_ATTR_DEFN     B                             11410079
169947                , WST_ATTR_ELEM     C                             11420079
169947                , WST_ATTR_ELEM     D                             11430079
169947            WHERE C.ATTR_ELEM_NBR      = :DK-STR-NBR              11440079
169947              AND A.INTGRTN_TYP_CDE    = :PC-STOTBNDUPD           11450079
169947              AND A.INTGRTN_TYP_CDE    = B.INTGRTN_TYP_CDE        11460079
169947              AND B.ATTR_DEFN_SEQ_NBR  = 1                        11470079
169947              AND B.INTGRTN_TYP_CDE    = C.INTGRTN_TYP_CDE        11480079
169947              AND C.ATTR_DEFN_SEQ_NBR  = 1                        11490079
169947              AND B.INTGRTN_TYP_CDE    = D.INTGRTN_TYP_CDE        11500079
169947              AND D.ATTR_DEFN_SEQ_NBR  = 3                        11510079
169947              AND C.INTGRTN_TYP_CDE    = D.INTGRTN_TYP_CDE        11520079
169947              AND C.ATTR_ELEM_SEQ_NBR  = D.ATTR_ELEM_SEQ_NBR      11530079
169947              AND D.ATTR_ELEM_TMST    <= :SU103-SHIPPED-TMST      11540079
169947       END-EXEC.                                                  11550079
169947                                                                  11560079
169947       EVALUATE TRUE                                              11570079
169947           WHEN SQLCODE = ZERO                                    11580079
169947                CONTINUE                                          11590079
169947                                                                  11600079
169947           WHEN SQLCODE = +100                                    11610079
169947                MOVE ZERO            TO WST00010-ATTR-ELEM-NBR    11620079
169947                                                                  11630079
169947           WHEN SQLWARN0 NOT = SPACE                              11640079
169947           WHEN SQLCODE  NOT = ZERO                               11650079
169947                MOVE '7400-CHECK-STOTBND-SCAN'                    11660079
169947                                     TO PV-ABEND-PARAGRAPH        11670079
169947                MOVE 'GET -STOTBNDUPD- ATTR ELEM'                 11680079
169947                                     TO PV-ABEND-OPER-MESSAGE-1   11690079
169947                MOVE DK-STR-NBR      TO PV-STR-NBR                11700079
169947                STRING 'STR-NBR = ' PV-STR-NBR                    11710079
169947                      DELIMITED BY SIZE                           11720079
169947                                   INTO PV-ABEND-OPER-MESSAGE-2   11730079
169947                STRING 'SHIPPED-TMST = ' SU103-SHIPPED-TMST       11740079
169947                      DELIMITED BY SIZE                           11750079
169947                                    INTO PV-ABEND-OPER-MESSAGE-3  11760079
169947                MOVE 'WST_INTGRTN_TYP'                            11770079
169947                                     TO PV-ABEND-TABLE-1          11780079
169947                MOVE 'WST_ATTR_DEFN' TO PV-ABEND-TABLE-2          11790079
169947                MOVE 'WST_ATTR_ELEM' TO PV-ABEND-TABLE-3          11800079
169947                PERFORM 9200-SQL-ERROR                            11810079
169947       END-EVALUATE.                                              11820079
                                                                        11830048
      *----------------------------------------------------------       11840048
      * 9000-WRAPUP.                                                    11850048
      *     END OF PROGRAM ROUTINE.                                     11860048
      *     CLOSES ALL FILES, AND                                       11870048
      *     DISPLAYS ALL DATA.                                          11880048
      *----------------------------------------------------------       11890048
       9000-WRAPUP.                                                     11900048
                                                                        11910048
                                                                        11920048
           CLOSE MNFST-DATA-FILE                                        11930048
                 MNFST-STAT-FILE                                        11940048
                 FRMTD-MNFST.                                           11950048
                                                                        11960048
           DISPLAY ' '.                                                 11970048
           DISPLAY '*********************************************'.     11980048
           DISPLAY 'PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.            11990048
           DISPLAY '*********************************************'.     12000048
           DISPLAY 'MESSAGES READ FROM DATA FILE:   '                   12010048
                           PC-MESSAGE-FROM-DATA-FILE.                   12020048
           DISPLAY '*********************************************'.     12030048
           DISPLAY 'MESSAGES READ FROM STAT FILE:   '                   12040048
                           PC-MESSAGE-FROM-STAT-FILE.                   12050048
           DISPLAY '*********************************************'.     12060048
           DISPLAY 'MESSAGES WRITTEN TO FORMATTED FILE: '               12070048
                           PC-MESSAGE-WRITTEN-TO-FILE.                  12080048
           DISPLAY '*********************************************'.     12090048
169947     DISPLAY '*********************************************'.     12100079
169947     DISPLAY '--MASTER-- RECORDS PROCESSED:       '               12110080
169947                     PC-MASTER-PROCESSED-COUNT.                   12120080
169947     DISPLAY '--MASTER-- RECORDS BYPASSED:        '               12130080
169947                     PC-MASTER-BYPASSED-COUNT.                    12140080
169947     DISPLAY '*********************************************'.     12150079
169947                                                                  12160079
169947*-----------------------------------------------------------------12170079
169947*SQL WARNING OR ERROR PROCESSING.                                 12180079
169947*-----------------------------------------------------------------12190079
169947 9200-SQL-ERROR.                                                  12200079
169947                                                                  12210079
169947     MOVE SQLCODE    TO PV-SQLCODE.                               12220079
169947     MOVE PV-SQLCODE TO PV-DISPLAY-SQLCODE.                       12230079
169947     DISPLAY ' '.                                                 12240079
169947     DISPLAY '******* START OF SFKUT051 ERROR DISPLAY *******'.   12250079
169947     DISPLAY '*** DB2 ERROR ***'.                                 12260079
169947     DISPLAY '*** SQLCODE   = ' PV-DISPLAY-SQLCODE.               12270079
169947     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 12280079
169947     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               12290079
169947     DISPLAY '*** OPERATION = ' PV-ABEND-OPER-MESSAGE-1.          12300079
169947     DISPLAY '***           = ' PV-ABEND-OPER-MESSAGE-2.          12310079
169947     DISPLAY '***           = ' PV-ABEND-OPER-MESSAGE-3.          12320079
169947                                                                  12330079
169947     DISPLAY '*** TABLE 1   = ' PV-ABEND-TABLE-1.                 12340079
169947     DISPLAY '*** TABLE 2   = ' PV-ABEND-TABLE-2.                 12350079
169947     DISPLAY '*** TABLE 3   = ' PV-ABEND-TABLE-3.                 12360079
169947***************************************************************** 12370079
169947*    COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED  12380079
169947*    TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.   12390079
169947***************************************************************** 12400079
169947     COPY DPPD004.                                                12410079
169947     SET ABEND-DB2-ERROR TO TRUE.                                 12420079
169947     CALL 'ILBOABN0' USING ABEND-CODE.                            12430079
